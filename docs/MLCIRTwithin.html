<!DOCTYPE html><html><head><title>Help for package MLCIRTwithin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MLCIRTwithin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#blkdiag'><p>Build block diagonal matrices</p></a></li>
<li><a href='#coef.est_multi_poly_between'><p>Display the estimated model parameters of est_multi_poly_between object</p></a></li>
<li><a href='#coef.est_multi_poly_within'><p>Display the estimated model parameters of est_multi_poly_within object</p></a></li>
<li><a href='#confint.est_multi_poly_between'><p>Display the estimated confidence intervals of the model parameters of est_multi_poly_between object</p></a></li>
<li><a href='#confint.est_multi_poly_within'><p>Display the estimated confidence intervals of the model parameters of est_multi_poly_within object</p></a></li>
<li><a href='#est_multi_glob_genZ'><p>Fit marginal regression models for categorical responses</p></a></li>
<li><a href='#est_multi_poly_between'><p>Estimate latent class item response theory (LC-IRT)  models for dichotomous and polytomous responses under between-item multidimensionality</p></a></li>
<li><a href='#est_multi_poly_within'><p>Estimate latent class item response theory (LC-IRT) models for dichotomous and polytomous responses under within-item multidimensionality</p></a></li>
<li><a href='#lk_obs_score_between'><p>Compute observed log-likelihood and score</p></a></li>
<li><a href='#lk_obs_score_within'><p>Compute observed log-likelihood and score</p></a></li>
<li><a href='#logLik.est_multi_poly_between'><p>Display the log-likelihood at convergence of est_multi_poly_between object</p></a></li>
<li><a href='#logLik.est_multi_poly_within'><p>Display the log-likelihood at convergence of est_multi_poly_within object</p></a></li>
<li><a href='#MLCIRTwithin-package'><p>Latent Class Item Response Theory (LC-IRT) Models under Within-Item Multidimensionality</p></a></li>
<li><a href='#print.est_multi_poly_between'><p>Print the output of est_multi_poly_between object</p></a></li>
<li><a href='#print.est_multi_poly_within'><p>Print the call of est_multi_poly_within object</p></a></li>
<li><a href='#prob_multi_glob_gen'><p>Global probabilities</p></a></li>
<li><a href='#RLMS'><p>RLMS dataset</p></a></li>
<li><a href='#search.model_between'><p>Search for the global maximum of the log-likelihood of between-item muldimensional models</p></a></li>
<li><a href='#search.model_within'><p>Search for the global maximum of the log-likelihood of within-item muldimensional models</p></a></li>
<li><a href='#SF12'><p>SF12 dataset</p></a></li>
<li><a href='#SF12_nomiss'><p>SF12 dataset without missing responses</p></a></li>
<li><a href='#summary.est_multi_poly_between'><p>Print the output of est_multi_poly_between object</p></a></li>
<li><a href='#summary.est_multi_poly_within'><p>Print the output of est_multi_poly_within object</p></a></li>
<li><a href='#vcov.est_multi_poly_between'><p>Display the estimated variance-and-covariance matrix of est_multi_poly_between object</p></a></li>
<li><a href='#vcov.est_multi_poly_within'><p>Display the estimated variance-and-covariance matrix of est_multi_poly_within object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Latent Class Item Response Theory (LC-IRT) Models under
Within-Item Multidimensionality</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francesco Bartolucci &lt;bart@stat.unipg.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Framework for the Item Response Theory analysis of dichotomous and ordinal polytomous outcomes under the assumption of within-item multidimensionality and discreteness of the latent traits. The fitting algorithms allow for missing responses and for different item parametrizations and are based on the Expectation-Maximization paradigm. Individual covariates affecting the class weights may be included in the new version together with possibility of constraints on all model parameters.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.0.0), MASS, limSolve, MultiLCIRT</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-30 12:50:50 UTC; francescobartolucci</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-30 15:20:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='blkdiag'>Build block diagonal matrices</h2><span id='topic+blkdiag'></span>

<h3>Description</h3>

<p>Function that given two matrices builds the corresponding block diagonal matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>blkdiag(A, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blkdiag_+3A_a">A</code></td>
<td>
<p>first matrix to be included</p>
</td></tr>
<tr><td><code id="blkdiag_+3A_b">B</code></td>
<td>
<p>second matrix to be included</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>C</code></td>
<td>
<p>resulting block diagonal matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='coef.est_multi_poly_between'>Display the estimated model parameters of est_multi_poly_between object</h2><span id='topic+coef.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, estimated abilities, item parameters, and regression coefficients are displayed</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
coef(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.est_multi_poly_between_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="coef.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='coef.est_multi_poly_within'>Display the estimated model parameters of est_multi_poly_within object</h2><span id='topic+coef.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, estimated abilities, item parameters, and regression coefficients are displayed for the 1st and the 2nd latent variable</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
coef(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.est_multi_poly_within_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="coef.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='confint.est_multi_poly_between'>Display the estimated confidence intervals of the model parameters of est_multi_poly_between object</h2><span id='topic+confint.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, the inferior and superior limits of confidence intervals at a given level are displayed for abilities, item parameters, and regression coefficients</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
confint(object, parm, level=0.95, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.est_multi_poly_between_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_between_+3A_parm">parm</code></td>
<td>
<p>empity object</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_between_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='confint.est_multi_poly_within'>Display the estimated confidence intervals of the model parameters of est_multi_poly_within object</h2><span id='topic+confint.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, the inferior and superior limits of confidence intervals at a given level are displayed for abilities, item parameters, and regression coefficients for the 1st and the 2nd latent variable</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
confint(object, parm, level=0.95, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.est_multi_poly_within_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_within_+3A_parm">parm</code></td>
<td>
<p>empity object</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_within_+3A_level">level</code></td>
<td>
<p>confidence level</p>
</td></tr>
<tr><td><code id="confint.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='est_multi_glob_genZ'>Fit marginal regression models for categorical responses</h2><span id='topic+est_multi_glob_genZ'></span>

<h3>Description</h3>

<p>It estimates marginal regression models to datasets consisting of a categorical response and one or more covariates by a Fisher-scoring algorithm; this is an internal function that also works with response variables having a different number of response categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_glob_genZ(Y, X, model = c("m","l","g"), ind = 1:nrow(Y), de = NULL,
                    Z = NULL, z = NULL, Dis = NULL, dis = NULL, disp=FALSE,
                    only_sc = FALSE, Int = NULL, der_single = FALSE, maxit = 10)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_glob_genZ_+3A_y">Y</code></td>
<td>
<p>matrix of response configurations</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_x">X</code></td>
<td>
<p>array of all distinct covariate configurations</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_model">model</code></td>
<td>
<p>type of logit (m = multinomial, l = local, g = global)</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_ind">ind</code></td>
<td>
<p>vector to link responses to covariates</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_de">de</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_z">Z</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_z">z</code></td>
<td>
<p>intercept associated with the design matrix</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_dis">Dis</code></td>
<td>
<p>matrix for inequality constraints on de</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_dis">dis</code></td>
<td>
<p>vector for inequality constraints on de</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_disp">disp</code></td>
<td>
<p>to display partial output</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_only_sc">only_sc</code></td>
<td>
<p>to exit giving only the score</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_int">Int</code></td>
<td>
<p>matrix of the fixed intercepts</p>
</td></tr>  
<tr><td><code id="est_multi_glob_genZ_+3A_der_single">der_single</code></td>
<td>
<p>to require single derivatives</p>
</td></tr>
<tr><td><code id="est_multi_glob_genZ_+3A_maxit">maxit</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>be</code></td>
<td>
<p>estimated vector of regression coefficients</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood at convergence</p>
</td></tr>
<tr><td><code>Pdis</code></td>
<td>
<p>matrix of the probabilities for each distinct covariate configuration</p>
</td></tr>  
<tr><td><code>P</code></td>
<td>
<p>matrix of the probabilities for each covariate configuration</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score for the vector of regression coefficients</p>
</td></tr>
<tr><td><code>FI</code></td>
<td>
<p>Fisher information matrix</p>
</td></tr>
<tr><td><code>de</code></td>
<td>
<p>estimated vector of (free) regression coefficients</p>
</td></tr>
<tr><td><code>scde</code></td>
<td>
<p>score for the vector of (free) regression coefficients</p>
</td></tr>
<tr><td><code>FIde</code></td>
<td>
<p>Fisher information matrix for the vector of (free) regression coefficients</p>
</td></tr>
<tr><td><code>Sc</code></td>
<td>
<p>matrix of individual scores for the vector of regression coefficients (if der_single=TRUE)</p>
</td></tr>
<tr><td><code>Scde</code></td>
<td>
<p>matrix of individual scores for the vector of (free) regression coefficients (if der_single=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive
association of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='est_multi_poly_between'>Estimate latent class item response theory (LC-IRT)  models for dichotomous and polytomous responses under between-item multidimensionality</h2><span id='topic+est_multi_poly_between'></span>

<h3>Description</h3>

<p>The function performs maximum likelihood estimation of the parameters of the IRT models
assuming a discrete distribution for the ability and between-item multidimensionality. Every ability level corresponds to a latent
class of subjects in the reference population. The class of models is based on a between-item multidimensional formulation with each item loading on a dimension of a given latent variable. Maximum likelihood estimation is based on Expectation-
Maximization algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_poly_between(S, yv = rep(1, ns), k, X = NULL, start = c("deterministic",
                       "random","external"), link = c("global","local"), disc = FALSE,
                       difl = FALSE, multi = 1:J, Phi = NULL, gat = NULL, De = NULL,
                       fort = FALSE, tol = 10^-10, maxitc = 10^4, disp = FALSE,
                       output = FALSE, out_se = FALSE, glob = FALSE, Zth=NULL,zth=NULL,
                       Zbe=NULL, zbe=NULL,Zga=NULL,zga=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_poly_between_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing responses)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_k">k</code></td>
<td>
<p>number of ability levels (or latent classes) for the latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_x">X</code></td>
<td>
<p>matrix of covariates that affects the weights</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_start">start</code></td>
<td>
<p>method of initialization of the algorithm</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_link">link</code></td>
<td>
<p>type of link function (&quot;global&quot; for global logits, &quot;local&quot; for local logits); with global logits a graded response model results; with local logits a  partial credit model results (with dichotomous responses, global logits is the same as using local logits resulting in the Rasch or the 2PL model depending on the value assigned to disc)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (FALSE = all equal to one, TRUE = free)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (FALSE = free, TRUE = rating scale parametrization); difl = TRUE is only admitted in the presence of items with the same number of categories</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_multi">multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row for the latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_phi">Phi</code></td>
<td>
<p>initial value of the matrix of the conditional response probabilities (if start=&quot;external&quot;)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_gat">gat</code></td>
<td>
<p>initial value of the vector of free discriminating indices (if start=&quot;external&quot;)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_de">De</code></td>
<td>
<p>initial value of regression coefficients for the covariates (if start=&quot;external&quot;)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_fort">fort</code></td>
<td>
<p>to use Fortran routines when possible</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_maxitc">maxitc</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>	         
<tr><td><code id="est_multi_poly_between_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Piv,Pp,lkv, Xlabel, XXdis)</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_out_se">out_se</code></td>
<td>
<p>to return standard errors</p>
</td></tr>
<tr><td><code id="est_multi_poly_between_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr> 
<tr><td><code id="est_multi_poly_between_+3A_zth">Zth</code></td>
<td>
<p>matrix for the specification of constraints on the support points</p>
</td></tr>  
<tr><td><code id="est_multi_poly_between_+3A_zth">zth</code></td>
<td>
<p>vector for the specification of constraints on the support points</p>
</td></tr>  
<tr><td><code id="est_multi_poly_between_+3A_zbe">Zbe</code></td>
<td>
<p>matrix for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="est_multi_poly_between_+3A_zbe">zbe</code></td>
<td>
<p>vector for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="est_multi_poly_between_+3A_zga">Zga</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices</p>
</td></tr>  
<tr><td><code id="est_multi_poly_between_+3A_zga">zga</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>piv</code></td>
<td>
<p>estimated vector of weights of the latent classes (average of the weights in case of model with covariates)</p>
</td></tr>
<tr><td><code>fv</code></td>
<td>
<p>vector indicating the reference item chosen for each latent dimension of the latent variable</p>
</td></tr>
<tr><td><code>tht</code></td>
<td>
<p>estimated matrix of free ability levels for each dimension</p>
</td></tr>
<tr><td><code>Th</code></td>
<td>
<p>complete matrix of free and constrained ability levels for each dimension and latent class of the latent variable</p>
</td></tr>
<tr><td><code>bet</code></td>
<td>
<p>estimated vector of free difficulty levels for every item (split in two vectors if difl=TRUE)</p>
</td></tr>
<tr><td><code>Bec</code></td>
<td>
<p>complete vector of free and constrained difficulty levels for every item (split in two vectors if difl=TRUE)</p>
</td></tr>
<tr><td><code>gat</code></td>
<td>
<p>estimated vector of free discriminating indices for every item (with all elements equal to 1
if disc=FALSE)</p>
</td></tr>
<tr><td><code>gac</code></td>
<td>
<p>complete vector of free and constrained discriminating indices for every item (with all elements equal to 1
if disc=FALSE)</p>
</td></tr>
<tr><td><code>De</code></td>
<td>
<p>matrix of regression coefficients for the multinomial (or global if glob=TRUE) logit model on the class weights</p>
</td></tr>	       
<tr><td><code>Phi</code></td>
<td>
<p>array of the conditional response probabilities for every item and each of the k latent classes</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelhood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion index</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion index</p>
</td></tr>
<tr><td><code>ent</code></td>
<td>
<p>entropy index to measure the separation of classes</p>
</td></tr>
<tr><td><code>pivs</code></td>
<td>
<p>estimated vector of (ordered) weights of the latent classes (average of the weights in case of model with covariates)</p>
</td></tr>
<tr><td><code>Ths</code></td>
<td>
<p>standardized ability levels</p>
</td></tr>
<tr><td><code>Becs</code></td>
<td>
<p>standardized values of item difficulty parameters</p>
</td></tr>
<tr><td><code>gacs</code></td>
<td>
<p>standardized values of item discriminating indices</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>call of function</p>
</td></tr>
<tr><td><code>Pp</code></td>
<td>
<p>matrix of the posterior probabilities for each response configuration and latent class
(if output=TRUE)</p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>vector to trace the log-likelihood evolution across iterations (if output=TRUE)</p>
</td></tr>
<tr><td><code>Xlabel</code></td>
<td>
<p>structure of the design matrix, for internal use (if output=TRUE)</p>
</td></tr>
<tr><td><code>XXdis</code></td>
<td>
<p>design matrix for the covariates affecting the latent variable (if output=TRUE)</p>
</td></tr>
<tr><td><code>Piv</code></td>
<td>
<p>matrix of the weights for every response configuration (if output=TRUE)</p>
</td></tr>
<tr><td><code>setht</code></td>
<td>
<p>standard errors for vector tht (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seTh</code></td>
<td>
<p>standard errors for vector Th (if out_se=TRUE)</p>
</td></tr>  
<tr><td><code>sebet</code></td>
<td>
<p>standard errors for vector bet (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seBec</code></td>
<td>
<p>standard errors for vector Bec (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>segat</code></td>
<td>
<p>standard errors for vector gat (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>segac</code></td>
<td>
<p>standard errors for vector gac (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seDe</code></td>
<td>
<p>standard errors for vector De (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>Vnt</code></td>
<td>
<p>estimated variance-covariance matrix for free parameter estimates (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>Vn</code></td>
<td>
<p>estimated variance-covariance matrix for all parameter estimates (if out_se=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bacci, S., Bartolucci, F. and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Fit a Graded response model with two dimensions (free discrimination
# and difficulty parameters; three latent classes):
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]
multi0 = rbind(c(1:5, 8), c(6:7,9:12))
k=3

out1 =  est_multi_poly_between(S=S,k=k,X=X,link="global",disc=TRUE,
                               multi=multi0,fort=TRUE,disp=TRUE,out_se=TRUE) 

# Display output:
summary(out1)
out1$lk
out1$Th
out1$piv
out1$De

## End(Not run)

## Not run: 
## Fit the model under different external constraints on abilities and/or item parameters
# Fixed ability levels; all item parameters can be free  
S1 = pmin(as.matrix(S),2) # all items have the same number of categories
Zth = matrix(0,nrow(multi0)*k,0)
zth = c(rep(-1, times=nrow(multi0)), rep(0, times=nrow(multi0)),  rep(1, times=nrow(multi0)))
Zbe = diag(ncol(S1)*2)  # free item difficulties: 12*2  = 24 (12 items with 3 categories)
Zga = diag(ncol(S1));  # free item discriminating parameters = 12 items loading on U
outc1 = est_multi_poly_between(S=S1,k=k,X=X,link="global",disc=TRUE, multi=multi0,disp=TRUE,
                               out_se=TRUE,Zth=Zth,zth=zth,Zbe=Zbe,Zga=Zga) 
outc1$Th
outc1$tht
outc1$Bec                                                          

# Add equality constraints on item parameters                         
# Same difficulties for pairs of items 1-7, 2-8, 3-9, 4-10, 5-11, 6-12; 
# same discriminating indices for items 2 and 3;
# free ability levels
Zbe = (matrix(1,2,1)%x%diag(12))[,-1]
Zga = as.matrix(rep(0, times=12)); Zga[2,1] = 1; Zga[3,1] = 1; 
Zga1p1 = matrix(0, nrow=3, ncol=9); Zga1p2 = diag(9); Zga1p = rbind(Zga1p1, Zga1p2)
Zga = cbind(Zga, Zga1p)
# discriminating index of item 1 constrained to 1 for the model identifiability
zga = rep(0,nrow(Zga)); zga[1] = 1 
outc2 = est_multi_poly_between(S=S1,k=k,X=X,link="global",disc=TRUE, 
                             multi = multi0,disp=TRUE,tol=10^-4,
                             out_se=TRUE,Zbe=Zbe, Zga=Zga, zga=zga)
outc2$tht
outc2$Th
outc2$Ths
outc2$Bec
outc2$Becs
outc2$gac 
outc2$gacs

## End(Not run)

</code></pre>

<hr>
<h2 id='est_multi_poly_within'>Estimate latent class item response theory (LC-IRT) models for dichotomous and polytomous responses under within-item multidimensionality</h2><span id='topic+est_multi_poly_within'></span>

<h3>Description</h3>

<p>The function performs maximum likelihood estimation of the parameters of the two-tier IRT models
assuming a discrete distribution for the ability and within-item multidimensionality. Every ability level corresponds to a latent
class of subjects in the reference population. The class of models is based on a particular within-item multidimensional formulation with each item loading on at most two uncorrelated latent variables. Maximum likelihood estimation is based on the Expectation-
Maximization algorithm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_multi_poly_within(S, yv = rep(1, ns), k1, k2, X = NULL,
                      start = c("deterministic","random","external"), link = c("global",
                      "local"), disc = FALSE, difl = FALSE, multi1, multi2, Phi = NULL,
                      ga1t = NULL, ga2t = NULL, De1 = NULL, De2 = NULL, fort = FALSE,
                      tol = 10^-10, maxitc = 10^4, disp = FALSE, output = FALSE,
                      out_se = FALSE, glob = FALSE, Zth1 = NULL, zth1 = NULL, Zth2=NULL,
                      zth2=NULL, Zbe=NULL, zbe=NULL, Zga1=NULL, zga1=NULL, Zga2=NULL,
                      zga2=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="est_multi_poly_within_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing responses)</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_k1">k1</code></td>
<td>
<p>number of ability levels (or latent classes) for the 1st latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_k2">k2</code></td>
<td>
<p>number of ability levels (or latent classes) for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_x">X</code></td>
<td>
<p>matrix of covariates that affects the weights</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_start">start</code></td>
<td>
<p>method of initialization of the algorithm</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_link">link</code></td>
<td>
<p>type of link function (&quot;global&quot; for global logits, &quot;local&quot; for local logits);
with global logits a graded response model results; with local logits a  partial credit model results (with dichotomous responses, global logits is the same as using local logits resulting in the Rasch or the 2PL model depending on the value assigned to disc)</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (FALSE = all equal to one, TRUE = free)</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (FALSE = free, TRUE = rating scale parametrization); difl = TRUE is only admitted in the presence of items with the same number of categories</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_multi1">multi1</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row for the 1st latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_multi2">multi2</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_phi">Phi</code></td>
<td>
<p>initial value of the matrix of the conditional response probabilities (if start=&quot;external&quot;)</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_ga1t">ga1t</code></td>
<td>
<p>initial value of the vector of free discriminating indices (if start=&quot;external&quot;) for the 1st latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_ga2t">ga2t</code></td>
<td>
<p>initial value of the vector of free discriminating indices (if start=&quot;external&quot;) for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_de1">De1</code></td>
<td>
<p>initial value of regression coefficients for the covariates (if start=&quot;external&quot;) affecting the 1st latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_de2">De2</code></td>
<td>
<p>initial value of regression coefficients for the covariates (if start=&quot;external&quot;) affecting the 2nd latent variable</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_fort">fort</code></td>
<td>
<p>to use Fortran routines when possible</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_tol">tol</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_maxitc">maxitc</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>  	         
<tr><td><code id="est_multi_poly_within_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Piv1, Piv2, Pp1, Pp2, lkv, Xlabel, XX1dis, XX2dis)</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_out_se">out_se</code></td>
<td>
<p>to return standard errors</p>
</td></tr>
<tr><td><code id="est_multi_poly_within_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zth1">Zth1</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zth1">zth1</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zth2">Zth2</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zth2">zth2</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zbe">Zbe</code></td>
<td>
<p>matrix for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zbe">zbe</code></td>
<td>
<p>vector for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zga1">Zga1</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zga1">zga1</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zga2">Zga2</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="est_multi_poly_within_+3A_zga2">zga2</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>In order to ensure the model identifiability,  the following conditions must hold. First, suitable  constraints on the item parameters are required: one discriminanting index must be equal to 1 and one difficulty parameter must be equal to 0 for each dimension. The constrained items  may be  chosen  in an arbitrary way: by default the algorithm selects the first element of each row of <code>multi1</code> and <code>multi2</code>. As a consequence, the user must pay attention to specify matrices <code>multi1</code> and <code>multi2</code> so that different items are constrained for each dimension. Second, the maximum number of items shared by the two latent variables is equal to the total number of items minus one, that is, the union of rows of <code>multi1</code> must differ from the union of rows of <code>multi2</code>.  
These conditions may be skipped specifying in a suitable way the entries of <code>Zth1</code>, <code>zth1</code>, <code>Zth2</code>, <code>zth2</code>, <code>Zbe</code>, <code>zbe</code>, <code>Zga1</code>, <code>zga1</code>, <code>Zga2</code>, and <code>zga2</code>, according to the following equations: 
</p>
<p>Th1  =  Zth1 %*% th1t + zth1 
</p>
<p>Th2  =  Zth2 %*% th2t + zth2 
</p>
<p>Bec  =  Zbe %*% bet + zbe 
</p>
<p>ga1c  =  Zga1 %*% ga1t + zga1 
</p>
<p>ga2c  =  Zga2 %*% ga2t + zga2, 
</p>
<p>where Th1, Th2, Bec, ga1c, ga2c denote the complete matrices/vectors of support points (Th1, Th2), item difficulties (Bec), and item discriminating indices (ga1c, ga2c), whereas th1t, th2t, bet, ga1t, ga2t are the corresponding matrices/vectors of free (i.e., unconstrained) parameters. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>piv1</code></td>
<td>
<p>estimated vector of weights of the latent classes (average of the weights in case of model with covariates) for the 1st latent variable</p>
</td></tr>
<tr><td><code>piv2</code></td>
<td>
<p>estimated vector of weights of the latent classes (average of the weights in case of model with covariates) for the 2nd latent variable</p>
</td></tr>
<tr><td><code>fv1</code></td>
<td>
<p>vector indicating the reference item chosen for each latent dimension for the 1st latent variable</p>
</td></tr>
<tr><td><code>fv2</code></td>
<td>
<p>vector indicating the reference item chosen for each latent dimension for the 2nd latent variable</p>
</td></tr>
<tr><td><code>th1t</code></td>
<td>
<p>estimated matrix of free ability levels for each dimension and for the 1st latent variable</p>
</td></tr>
<tr><td><code>th2t</code></td>
<td>
<p>estimated matrix of free ability levels for each dimension and for the 2nd latent variable</p>
</td></tr>
<tr><td><code>Th1</code></td>
<td>
<p>complete matrix of free and constrained ability levels for each dimension and latent class for the 1st latent variable</p>
</td></tr>
<tr><td><code>Th2</code></td>
<td>
<p>complete matrix of free and constrained ability levels for each dimension and latent class for the 2nd latent variable</p>
</td></tr>
<tr><td><code>bet</code></td>
<td>
<p>estimated vector of free difficulty levels for every item (split in two vectors if difl=TRUE)</p>
</td></tr>
<tr><td><code>Bec</code></td>
<td>
<p>complete vector of free and constrained difficulty levels for every item (split in two vectors if difl=TRUE)</p>
</td></tr>
<tr><td><code>ga1t</code></td>
<td>
<p>estimated vector of free discriminating indices for every item (with all elements equal to 1
if disc=FALSE) for the 1st latent variable</p>
</td></tr>
<tr><td><code>ga2t</code></td>
<td>
<p>estimated vector of free discriminating indices for every item (with all elements equal to 1
if disc=FALSE) for the 2nd latent variable</p>
</td></tr>
<tr><td><code>ga1c</code></td>
<td>
<p>complete vector of free and constrained discriminating indices for every item  for the 1st latent variable (with all 			elements equal to 1 if disc=FALSE and NA for items that do not load on the 1st latent variable)</p>
</td></tr>
<tr><td><code>ga2c</code></td>
<td>
<p>complete vector of free and constrained discriminating indices for every item  for the 2nd latent variable (with all 			elements equal to 1 if disc=FALSE and NA for items that do not load on the 2nd latent variable)</p>
</td></tr>
<tr><td><code>De1</code></td>
<td>
<p>matrix of regression coefficients for the multinomial (or global if glob=TRUE) logit model on the class weights for the 1st latent variable</p>
</td></tr>
<tr><td><code>De2</code></td>
<td>
<p>matrix of regression coefficients for the multinomial (or global if glob=TRUE) logit model on the class weights for the 2nd latent variable</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>array of the conditional response probabilities for every item and each of the k1*k2 latent classes</p>
</td></tr>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood at convergence of the EM algorithm</p>
</td></tr>
<tr><td><code>np</code></td>
<td>
<p>number of free parameters</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>Akaike Information Criterion index</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Bayesian Information Criterion index</p>
</td></tr>
<tr><td><code>ent</code></td>
<td>
<p>entropy index to measure the separation of classes</p>
</td></tr>
<tr><td><code>piv1s</code></td>
<td>
<p>estimated vector of (ordered) weights of the latent classes (average of the weights in case of model with covariates) for the 1st standardized latent variable</p>
</td></tr>
<tr><td><code>piv2s</code></td>
<td>
<p>estimated vector of (ordered) weights of the latent classes (average of the weights in case of model with covariates) for the 2nd standardized latent variable</p>
</td></tr>
<tr><td><code>Th1s</code></td>
<td>
<p>standardized ability levels for the 1st latent variable, ordered according to the first dimension</p>
</td></tr>
<tr><td><code>Th2s</code></td>
<td>
<p>standardized ability levels for the 2nd latent variable, ordered according to the first dimension</p>
</td></tr>
<tr><td><code>Becs</code></td>
<td>
<p>standardized values of item difficulty parameters</p>
</td></tr>
<tr><td><code>ga1cs</code></td>
<td>
<p>standardized values of item discriminating indices for the 1st latent variable</p>
</td></tr>
<tr><td><code>ga2cs</code></td>
<td>
<p>standardized values of item discriminating indices for the 2nd latent variable</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>call of function</p>
</td></tr>  
<tr><td><code>Pp1</code></td>
<td>
<p>matrix of the posterior probabilities for each response configuration and latent class for the 1st latent variable
(if output=TRUE)</p>
</td></tr>
<tr><td><code>Pp2</code></td>
<td>
<p>matrix of the posterior probabilities for each response configuration and latent class for the 2nd latent variable
(if output=TRUE)</p>
</td></tr>	      
<tr><td><code>lkv</code></td>
<td>
<p>vector to trace the log-likelihood evolution across iterations (if output=TRUE)</p>
</td></tr>
<tr><td><code>Xlabel</code></td>
<td>
<p>structure of the design matrix, for internal use (if output=TRUE)</p>
</td></tr>
<tr><td><code>XX1dis</code></td>
<td>
<p>design matrix for the covariates affecting the 1st latent variable (if output=TRUE)</p>
</td></tr>
<tr><td><code>XX2dis</code></td>
<td>
<p>design matrix for the covariates affecting the 2nd latent variable  (if output=TRUE)</p>
</td></tr>	      
<tr><td><code>Piv1</code></td>
<td>
<p>matrix of the weights for every covariate pattern configuration for the 1st latent variable (if output=TRUE)</p>
</td></tr>
<tr><td><code>Piv2</code></td>
<td>
<p>matrix of the weights for every covariate pattern configuration for the 2nd latent variable (if output=TRUE)</p>
</td></tr>
<tr><td><code>seth1t</code></td>
<td>
<p>standard errors for vector th1t (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seth2t</code></td>
<td>
<p>standard errors for vector th2t (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seTh1</code></td>
<td>
<p>standard errors for vector Th1 (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seTh2</code></td>
<td>
<p>standard errors for vector Th2 (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sebet</code></td>
<td>
<p>standard errors for vector bet (if out_se=TRUE)</p>
</td></tr> 
<tr><td><code>seBec</code></td>
<td>
<p>standard errors for vector Bec (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sega1t</code></td>
<td>
<p>standard errors for vector ga1t (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sega2t</code></td>
<td>
<p>standard errors for vector ga2t (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sega1c</code></td>
<td>
<p>standard errors for vector ga1c (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>sega2c</code></td>
<td>
<p>standard errors for vector ga2c (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seDe1</code></td>
<td>
<p>standard errors for vector De1 (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>seDe2</code></td>
<td>
<p>standard errors for vector De2 (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>Vnt</code></td>
<td>
<p>estimated variance-covariance matrix for free parameters (if out_se=TRUE)</p>
</td></tr>
<tr><td><code>Vn</code></td>
<td>
<p>complete variance-covariance matrix for all parameters (if out_se=TRUE)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bacci, S.  and Bartolucci, F. (2015), A multidimensional finite mixture SEM for non-ignorable missing responses to test items, <em>Structural Equation Modeling</em>, <b>22</b>, 352-365.
</p>
<p>Bacci, S., Bartolucci, F., and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>
<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bonifay, W. E. (2015), An illustration of the two-tier item factor analysis model, in S. P. Reise and D. A. Revicki (eds), Handbook of Item Response Theory Modeling, p. 207-225, Routledge.
</p>
<p>Cai, L. (2010), A two-tier full-information item factor analysis model with applications, Psychometrika, 75, 581-612.
</p>
<p>Cai, L., Yang, J. S., and Hansen, M. (2011), Generalized full-information item bifactor analysis, Psychological Methods, 16, 221-248.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Fit the model under different within-item multidimensional structures
# for SF12_nomiss data
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]

# Graded response model with two latent variables sharing six items (free
# discrimination and difficulty parameters; two latent classes for each
# latent variable; one covariate):
multi1 = c(1:5, 8:12)
multi2 = c(6:12, 1)
tol = 10^-6  # decrease tolerance to obtain more reliable results
out1 = est_multi_poly_within(S=S,k1=2,k2=2,X=X,link="global",disc=TRUE,
                             multi1=multi1,multi2=multi2,disp=TRUE,
                             out_se=TRUE,tol=tol) 
                             
# Partial credit model with two latent variables sharing eleven items
# (free discrimination and difficulty parameters; two latent classes for
# the 1st latent variable and three latent classes for the 2nd latent
# variable; one covariate):
multi1 = 1:12
multi2 = 2:12
out2 = est_multi_poly_within(S=S,k1=2,k2=3,X=X,link="local",disc=TRUE,
                             multi1=multi1,multi2=multi2,disp=TRUE,tol=tol)
                               
# Display output:
summary(out2)
out2$lk
out2$Th1 
out2$Th1s
out2$piv1
out2$Th2
out2$Th2s
out2$piv2
out2$De1
out2$De2

## End(Not run)

## Not run: 
## Fit the model under different situations for RLMS data
# Example of use of the function to account for non-ignorable missing
# item responses 
data(RLMS)
X = RLMS[,1:4]
Y = RLMS[,6:9]
YR = cbind(Y,1*(!is.na(Y)))
multi1 = 1:4
multi2 = 5:8
tol = 10^-6  # decrease tolerance to obtain more reliable results

# MAR model
out0 = est_multi_poly_within(YR,k1=3,k2=2,X=X,link="global",
                 disc=TRUE,multi1=multi1,multi2=multi2,disp=TRUE,
                 out_se=TRUE,glob=TRUE,tol=tol) 
                 
# NMAR model
multi1 = 1:8
out1 = est_multi_poly_within(YR,k1=3,k2=2,X=X,link="global",
                 disc=TRUE,multi1=multi1,multi2=multi2,disp=TRUE,
                 out_se=TRUE,glob=TRUE,tol=tol)
                   
# testing effect of the latent trait on missingness
c(out0$bic,out1$bic)
(test1 = out1$ga1c[-1]/out1$sega1c[-1])

## End(Not run)

## Not run: 
## Fit the model under different external constraints on abilities and/or item parameters
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]
multi1m = rbind(1:5, 8:12) # two dimensions for the 1st latent variable 
multi2m = rbind(6:9, c(10:12, 1)) # two dimensions for the 2nd latent variable 
k1 = 2
k2 = 2

# Fixed ability levels; all item parameters can be free
Zth1 = matrix(0,nrow(multi1m)*k1,0)
zth1 = c(rep(-1, times=nrow(multi1m)),  rep(1, times=nrow(multi1m)))
Zth2 = matrix(0,nrow(multi2m)*k2,0)
zth2 = c(rep(-1, times=nrow(multi2m)),  rep(1, times=nrow(multi2m)))  
# item difficulties: 10*4 + 2*2 = 44 (10 items with 5 categories plus 2 items with 3 categories)
Zbe = diag(44)
# item discriminating parameters = 10 items loading on the 1st latent variable plus 8 items loading
# on the 2nd latent variable
Zga1 = diag(10); Zga2 = diag(8) 
zga1 = rep(0,nrow(Zga1)); zga1[1] = 1
zga2 = rep(0,nrow(Zga2)); zga2[1] = 1
out1c = est_multi_poly_within(S=S,k1=k1,k2=k2,X=X,link="global",disc=TRUE,multi1=multi1m,
                              multi2=multi2m,disp=TRUE,out_se=TRUE,Zth1=Zth1,zth1=zth1,Zth2=Zth2,
                              zth2=zth2,Zbe=Zbe,Zga1=Zga1,zga1=zga1,Zga2=Zga2,zga2=zga2)   
summary(out1c)
out1c$Bec                             

# Constraint difficulties of the first threshold to be equal for all items 
# and difficulties of the second threshold to be equal for all items; 
# free ability levels
multi1u = c(1:3, 6:10) # one dimension for the 1st latent variable 
multi2u = c(4:10, 1)  # one dimension for the 2nd latent variable
S1 = pmin(as.matrix(S[, -c(2,3)]),2)  # all items have the same number of categories
Zbe = as.matrix((matrix(1,10,1)%x%diag(2))[,-1])  
out2c = est_multi_poly_within(S=S1,k1=2,k2=2,X=X,link="global",disc=TRUE,
                             multi1=multi1u,multi2=multi2u,disp=TRUE,
                             out_se=TRUE,Zbe=Zbe)
out2c$Bec   

# Same difficulties for pairs of items 1-6, 2-7, 3-8, 4-9, 5-10; 
# free ability levels
Zbe = (matrix(1,2,1)%x%diag(10))[,-1]
out3c = est_multi_poly_within(S=S1,k1=2,k2=2,X=X,link="global",disc=TRUE,
                             multi1=multi1u,multi2=multi2u,disp=TRUE,
                             out_se=TRUE,Zbe=Zbe)
out3c$Bec  

# Add equality constraints on some discriminating indices for the 1st latent variable
Zbe = (matrix(1,2,1)%x%diag(10))[,-1]
Zga1 = diag(length(multi1u)); 
# discriminating index of item 1 constrained to 1 for the model identifiability
# discriminating index of item 3 equal to discriminating index of item 2
Zga1 = Zga1[, -c(1, 3)];
Zga1[3, 1] = 1 
zga1 = rep(0,nrow(Zga1)); zga1[1] = 1
out4c = est_multi_poly_within(S=S1,k1=2,k2=2,X=X,link="global",disc=TRUE,
                             multi1=multi1u,multi2=multi2u,disp=TRUE,tol=10^-4,
                             out_se=TRUE,Zbe=Zbe, Zga1=Zga1, zga1=zga1)   
out4c$Bec 
out4c$ga1c
out4c$ga1t                                                           

## End(Not run)
</code></pre>

<hr>
<h2 id='lk_obs_score_between'>Compute observed log-likelihood and score</h2><span id='topic+lk_obs_score_between'></span>

<h3>Description</h3>

<p>Function used within <code>est_multi_poly_between</code> to compute observed log-likelihood and score.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lk_obs_score_between(part_comp, lde, lpart, lgat, S, R, yv, k, rm, lv,
                     J, fv, disc, glob, refitem, miss,
                     ltype, XXdis, Xlabel, ZZ0,fort, Zpar, zpar, Zga, zga, items)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lk_obs_score_between_+3A_part_comp">part_comp</code></td>
<td>
<p>complete vector of parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_lde">lde</code></td>
<td>
<p>length of de</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_lpart">lpart</code></td>
<td>
<p>length of part</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_lgat">lgat</code></td>
<td>
<p>length of gat</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_s">S</code></td>
<td>
<p>matrix of responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_r">R</code></td>
<td>
<p>matrix of observed responses indicator</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_k">k</code></td>
<td>
<p>number of latent classes for the latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_rm">rm</code></td>
<td>
<p>number of dimensions for the latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_lv">lv</code></td>
<td>
<p>number of response categories for each item</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_j">J</code></td>
<td>
<p>number of items</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_fv">fv</code></td>
<td>
<p>indicator of constrained parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_disc">disc</code></td>
<td>
<p>presence of discrimination parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_glob">glob</code></td>
<td>
<p>indicator of global parametrization for the covariates</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_refitem">refitem</code></td>
<td>
<p>vector of reference items</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_miss">miss</code></td>
<td>
<p>indicator of presence of missing responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_ltype">ltype</code></td>
<td>
<p>type of logit</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_xxdis">XXdis</code></td>
<td>
<p>array of covariates for the latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_xlabel">Xlabel</code></td>
<td>
<p>indicator for covariate configuration</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_zz0">ZZ0</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_fort">fort</code></td>
<td>
<p>to use Fortran</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_zpar">Zpar</code></td>
<td>
<p>array for the specification of constraints on the support points of the latent variable and for the item difficulty parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_zpar">zpar</code></td>
<td>
<p>vector for the specification of constraints on the support points of the latent variable and for the item difficulty parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_zga">Zga</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_zga">zga</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices</p>
</td></tr>
<tr><td><code id="lk_obs_score_between_+3A_items">items</code></td>
<td>
<p>items affected by the latent variable</p>
</td></tr>    
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='lk_obs_score_within'>Compute observed log-likelihood and score</h2><span id='topic+lk_obs_score_within'></span>

<h3>Description</h3>

<p>Function used within <code>est_multi_poly_within</code> to compute observed log-likelihood and score.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lk_obs_score_within(part_comp, lde1, lde2, lpart, lga1t, lga2t, S, R, yv, k1, k2, 
                    rm1, rm2, lv, J, fv, disc, glob, refitem, miss, ltype, XX1dis, XX2dis,
                    Xlabel, ZZ0, fort, Zpar, zpar, Zga1, zga1, Zga2, zga2, items1, items2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lk_obs_score_within_+3A_part_comp">part_comp</code></td>
<td>
<p>complete vector of parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lde1">lde1</code></td>
<td>
<p>length of de1</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lde2">lde2</code></td>
<td>
<p>length of de2</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lpart">lpart</code></td>
<td>
<p>length of part</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lga1t">lga1t</code></td>
<td>
<p>length of ga1t</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lga2t">lga2t</code></td>
<td>
<p>length of ga2t</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_s">S</code></td>
<td>
<p>matrix of responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_r">R</code></td>
<td>
<p>matrix of observed responses indicator</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_yv">yv</code></td>
<td>
<p>vector of frequencies</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_k1">k1</code></td>
<td>
<p>number of latent classes for the 1st latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_k2">k2</code></td>
<td>
<p>number of latent classes for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_rm1">rm1</code></td>
<td>
<p>number of dimensions for the 1st latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_rm2">rm2</code></td>
<td>
<p>number of dimensions for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_lv">lv</code></td>
<td>
<p>number of response categories for each item</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_j">J</code></td>
<td>
<p>number of items</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_fv">fv</code></td>
<td>
<p>indicator of constrained parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_disc">disc</code></td>
<td>
<p>presence of discrimination parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_glob">glob</code></td>
<td>
<p>indicator of global parametrization for the covariates</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_refitem">refitem</code></td>
<td>
<p>vector of reference items</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_miss">miss</code></td>
<td>
<p>indicator of presence of missing responses</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_ltype">ltype</code></td>
<td>
<p>type of logit</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_xx1dis">XX1dis</code></td>
<td>
<p>array of covariates for the 1st latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_xx2dis">XX2dis</code></td>
<td>
<p>array of covariates for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_xlabel">Xlabel</code></td>
<td>
<p>indicator for covariate configuration</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zz0">ZZ0</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_fort">fort</code></td>
<td>
<p>to use Fortran</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zpar">Zpar</code></td>
<td>
<p>array for the specification of constraints on the support points of the 1st and the 2nd latent variable and for the item difficulty parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zpar">zpar</code></td>
<td>
<p>vector for the specification of constraints on the support points of the 1st and the 2nd latent variable and for the item difficulty parameters</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zga1">Zga1</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zga1">zga1</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zga2">Zga2</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_zga2">zga2</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="lk_obs_score_within_+3A_items1">items1</code></td>
<td>
<p>items affected by the 1st latent variable</p>
</td></tr> 
<tr><td><code id="lk_obs_score_within_+3A_items2">items2</code></td>
<td>
<p>items affected by the 2nd latent variable</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>lk</code></td>
<td>
<p>log-likelihood function</p>
</td></tr>
<tr><td><code>sc</code></td>
<td>
<p>score vector</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='logLik.est_multi_poly_between'>Display the log-likelihood at convergence of est_multi_poly_between object</h2><span id='topic+logLik.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, the log-likelihood at convergence is displayed</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
logLik(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.est_multi_poly_between_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="logLik.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='logLik.est_multi_poly_within'>Display the log-likelihood at convergence of est_multi_poly_within object</h2><span id='topic+logLik.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, the log-likelihood at convergence is displayed</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
logLik(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.est_multi_poly_within_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="logLik.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='MLCIRTwithin-package'>Latent Class Item Response Theory (LC-IRT) Models under Within-Item Multidimensionality</h2><span id='topic+MLCIRTwithin-package'></span><span id='topic+MLCIRTwithin'></span>

<h3>Description</h3>

<p>This package provides a flexible framework for the estimation of discrete two-tier Item Response Theory (IRT)  models for the analysis of dichotomous and ordinal polytomous item responses. The class of models at issue is based on the assumption that one or more items are shared by (at most) two latent traits (i.e., within-item multidimensionality) and on the discreteness of latent traits (abilities). 
Every level of the abilities identify a latent class of subjects. The fitting algorithms are based on the Expectation-Maximization (EM) paradigm and allow for missing responses and for different item parametrizations. The package also allows for the inclusion of individual covariates affecting the class weights together with possibility of constraints on all model parameters.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MultiLCIRT</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-09-30</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Function <code>est_multi_poly_within</code> performs the parameter estimation of the same model considered in the <code>R</code> package <code>MultiLCIRT</code> when one or more items are shared by two latent traits (within-item multidimensionality); in addition, fixed values and constraints on support points and item parameters are allowed.
</p>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)
</p>
<p>Maintainer: Francesco Bartolucci &lt;bart@stat.unipg.it&gt;
</p>


<h3>References</h3>

<p>Adams, R., Wilson, M., and Wang, W. (1997), The multidimensional random coefficients multinomial logit, <em>Applied Psychological Measurement</em>, <b>21</b>, 1-24.
</p>
<p>Bacci, S.  and Bartolucci, F. (2015), A multidimensional finite mixture SEM for non-ignorable missing responses to test items, <em>Structural Equation Modeling</em>, <b>22</b>, 352-365.
</p>
<p>Bacci, S., Bartolucci, F., and Gnaldi, M. (2014), A class of Multidimensional Latent Class IRT models for 
ordinal polytomous item responses, <em>Communications in Statistics - Theory and Methods</em>, <b>43</b>, 787-800.
</p>
<p>Bartolucci, F. (2007), A class of multidimensional IRT models for testing unidimensionality and clustering
items, <em>Psychometrika</em>, <b>72</b>, 141-157.
</p>
<p>Bartolucci, F., Bacci, S., and Gnaldi, M. (2015), <em>Statistical Analysis of Questionnaires: A Unified Approach Based on R and Stata</em>, Chapman and Hall/CRC press.
</p>
<p>Bartolucci, F., Bacci, S., and Gnaldi, M. (2014), MultiLCIRT: An R package for multidimensional latent class item response models, <em>Computational Statistics and Data Analysis</em>, <b>71</b>, 971-985.
</p>
<p>Bock, R.D., Gibbons, R., and Muraki, E. (1988), Full-information item factor analysis, <em>Applied Psychological Measurement</em>, <b>12</b>, 261-280.
</p>
<p>Bonifay, W. E. (2015), An illustration of the two-tier item factor analysis model, in S. P. Reise and D. A. Revicki (eds), Handbook of Item Response Theory Modeling, p. 207-225, Routledge.
</p>
<p>Cai, L. (2010), A two-tier full-information item factor analysis model with applications, <em>Psychometrika</em>, <b>75</b>, 581-612.
</p>
<p>Cai, L., Yang, J. S., and Hansen, M. (2011), Generalized full-information item bifactor analysis, <em>Psychological Methods</em>, <b>16</b>, 221-248.
</p>
<p>Gibbons, R. D., Darrell, R. B., Hedeker, D., Weiss, D. J., Segawa, E., Bhaumik, D. K., and Stover, A. (2007), Full-information item bifactor analysis of graded response data, <em>Applied Psychological Measurement</em>,  <b>31</b>, 4-19.
</p>
<p>Gibbons, R. D. and Hedeker, D. R. (1992), Full-information item bi-factor analysis, <em>Psychometrika</em>, <b>57</b>, 423-436.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Estimation of a two-tier LC-IRT model 
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]
# Define matrices to allocate each item on the latent variables  
multi1=rbind(1:6, 7:12)
multi2=rbind(4:8, c(2:3, 10:12))
# Graded response model with two primary latent variables, each of them
# having two dimensions (free discrimination and difficulty parameters;
# two latent classes for both the latent variables; one covariate):
tol = 10^-6 # decrease the tolerance to obtain more reliable results
out1 = est_multi_poly_within(S=S,k1=2,k2=2,X=X,link="global",disc=TRUE,
                             multi1=multi1,multi2=multi2,tol=tol,
                             disp=TRUE,out_se=FALSE) 
# Display output
summary(out1)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.est_multi_poly_between'>Print the output of est_multi_poly_between object</h2><span id='topic+print.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, the call of it is written</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.est_multi_poly_between_+3A_x">x</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="print.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='print.est_multi_poly_within'>Print the call of est_multi_poly_within object</h2><span id='topic+print.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, the call of it is written</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
print(x, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.est_multi_poly_within_+3A_x">x</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="print.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='prob_multi_glob_gen'>Global probabilities</h2><span id='topic+prob_multi_glob_gen'></span>

<h3>Description</h3>

<p>It provides matrix of probabilities under different parametrizations and for the case of response variables having a different number of categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_multi_glob_gen(X, model, be, ind=(1:dim(X)[3]))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prob_multi_glob_gen_+3A_x">X</code></td>
<td>
<p>array of all distinct covariate configurations</p>
</td></tr>
<tr><td><code id="prob_multi_glob_gen_+3A_model">model</code></td>
<td>
<p>type of logit (g = global, l = local, m = multinomial)</p>
</td></tr>
<tr><td><code id="prob_multi_glob_gen_+3A_be">be</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="prob_multi_glob_gen_+3A_ind">ind</code></td>
<td>
<p>vector to link responses to covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Pdis</code></td>
<td>
<p>matrix of distinct probability vectors</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>matrix of the probabilities for each covariate configuration</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Colombi, R. and Forcina, A. (2001), Marginal regression models for the analysis of positive
association of ordinal response variables, <em>Biometrika</em>, <b>88</b>, 1007-1019.
</p>
<p>Glonek, G. F. V. and McCullagh, P. (1995), Multivariate logistic models, <em>Journal of the Royal 
Statistical Society, Series B</em>, <b>57</b>, 533-546.</p>

<hr>
<h2 id='RLMS'>RLMS dataset</h2><span id='topic+RLMS'></span>

<h3>Description</h3>

<p>This dataset contains the data about job satisfaction described in:
Bartolucci, F., Bacci, S., and Gnaldi, M. (2015), Statistical Analysis of Questionnaires: A Unified Approach Based on R and Stata, Chapman and Hall/CRC press</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RLMS)</code></pre>


<h3>Format</h3>

<p>A data frame with 1485 observations about four polytomous items with covariates:
</p>

<dl>
<dt><code>marital</code></dt><dd><p>marital status of the respondent</p>
</dd>
<dt><code>education</code></dt><dd><p>educational level of the respondent</p>
</dd>
<dt><code>gender</code></dt><dd><p>gender of the respondent</p>
</dd>
<dt><code>age</code></dt><dd><p>age of the respondent</p>
</dd>
<dt><code>work</code></dt><dd><p>work status of the respondent</p>
</dd>
<dt><code>Y1</code></dt><dd><p>1st item response</p>
</dd>
<dt><code>Y2</code></dt><dd><p>2nd item response</p>
</dd>
<dt><code>Y3</code></dt><dd><p>3rd item response</p>
</dd>
<dt><code>Y4</code></dt><dd><p>4th item response</p>
</dd>
</dl>



<h3>References</h3>

<p>Bartolucci, F., Bacci, S., and Gnaldi, M. (2015), <em>Statistical Analysis of Questionnaires: A Unified Approach Based on R and Stata</em>, Chapman and Hall/CRC press
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(RLMS)
 ## maybe str(RLMS)
 str(RLMS)
 </code></pre>

<hr>
<h2 id='search.model_between'>Search for the global maximum of the log-likelihood of between-item muldimensional models</h2><span id='topic+search.model_between'></span>

<h3>Description</h3>

<p>It searches for the global maximum of the log-likelihood of between-item muldimensional models given a vector of possible number of classes to try for.</p>


<h3>Usage</h3>

<pre><code class='language-R'>search.model_between(S, yv = rep(1, ns), kv, X = NULL,
                     link = c("global","local"), disc = FALSE, difl = FALSE,
                     multi = 1:J, fort = FALSE, tol1 = 10^-6, tol2 = 10^-10,
                     glob = FALSE, disp = FALSE, output = FALSE,
                     out_se = FALSE, nrep = 2, Zth=NULL,zth=NULL,
                     Zbe=NULL, zbe=NULL,Zga=NULL,zga=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search.model_between_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing responses)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="search.model_between_+3A_kv">kv</code></td>
<td>
<p>vector of the possible numbers of latent classes</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_x">X</code></td>
<td>
<p>matrix of covariates affecting the weights</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_link">link</code></td>
<td>
<p>type of link function (&quot;global&quot; for global logits, &quot;local&quot; for local logits);
with global logits a graded response model results; with local logits a  partial credit model results
(with dichotomous responses, global logits is the same as using local logits resulting in the Rasch or
the 2PL model depending on the value assigned to disc)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (FALSE = all equal to one, TRUE = free)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (FALSE = free, TRUE = rating scale parametrization)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_multi">multi</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row
equal to the indices of the items measuring the dimension corresponding to that row for the latent variable</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_fort">fort</code></td>
<td>
<p>to use Fortran routines when possible</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_tol1">tol1</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (initial check based on random starting values)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_tol2">tol2</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (final converngece)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Piv,Pp,lkv)</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_out_se">out_se</code></td>
<td>
<p>to return standard errors</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_nrep">nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td></tr>
<tr><td><code id="search.model_between_+3A_zth">Zth</code></td>
<td>
<p>matrix for the specification of constraints on the support points</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_zth">zth</code></td>
<td>
<p>vector for the specification of constraints on the support points</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_zbe">Zbe</code></td>
<td>
<p>matrix for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_zbe">zbe</code></td>
<td>
<p>vector for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_zga">Zga</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices</p>
</td></tr>  
<tr><td><code id="search.model_between_+3A_zga">zga</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices</p>
</td></tr>         
</table>


<h3>Value</h3>

<table>
<tr><td><code>out.single</code></td>
<td>
<p>output of each single model for each <code>k</code> in <code>kv</code>; it is similar to output from est_multi_poly_between, with the addition of values of number of latent classes  (<code>k</code>)  and the sequence of log-likelihoods (<code>lktrace</code>) for the deterministic start, for each random start, and for the final estimation obtained with  a tolerance level equal to <code>tol2</code></p>
</td></tr>	
<tr><td><code>aicv</code></td>
<td>
<p>Akaike Information Criterion index for each <code>k</code> in <code>kv</code></p>
</td></tr>
<tr><td><code>bicv</code></td>
<td>
<p>Bayesian Information Criterion index for each <code>k</code> in <code>kv</code></p>
</td></tr>
<tr><td><code>entv</code></td>
<td>
<p>Entropy index for each <code>k</code> in <code>kv</code></p>
</td></tr>
<tr><td><code>necv</code></td>
<td>
<p>NEC index for each <code>k</code> in <code>kv</code></p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood at convergence of the EM algorithm  for each <code>k</code> in <code>kv</code></p>
</td></tr>
<tr><td><code>errv</code></td>
<td>
<p>trace of any errors occurred during the estimation process for each <code>k</code> in <code>kv</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Bacci, S. and Gnaldi, M. (2014), MultiLCIRT: An R package for multidimensional latent class item response models,
<em>Computational Statistics &amp; Data Analysis</em>, <b>71</b>, 971-985.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Fit a Graded response model with two latent variables (free discrimination
# and difficulty parameters; two latent classes):
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]
multi0 = rbind(c(1:5, 8), c(6:7,9:12))
out1 = search.model_between(S=S,kv=1:3,X=X,link="global",disc=TRUE,
                               multi=multi0,fort=TRUE,disp=TRUE,out_se=TRUE) 

# Display output
out1$lkv
out1$bicv

# Display output with 2 classes:
out1$out.single[[2]]
out1$out.single[[2]]$lktrace
out1$out.single[[2]]$Th
out1$out.single[[2]]$piv
out1$out.single[[2]]$gac
out1$out.single[[2]]$Bec


## End(Not run)

</code></pre>

<hr>
<h2 id='search.model_within'>Search for the global maximum of the log-likelihood of within-item muldimensional models</h2><span id='topic+search.model_within'></span>

<h3>Description</h3>

<p>It searches for the global maximum of the log-likelihood of within-item muldimensional models given a vector of possible number of classes to try for.</p>


<h3>Usage</h3>

<pre><code class='language-R'>search.model_within(S, yv = rep(1, ns), kv1, kv2, X = NULL, 
                    link = c("global","local"), disc = FALSE, difl = FALSE, 
                    multi1, multi2, fort = FALSE, tol1 = 10^-6, tol2 = 10^-10,
                    glob = FALSE, disp = FALSE, output = FALSE, out_se = FALSE, 
                    nrep = 2, Zth1 = NULL, zth1 = NULL, Zth2=NULL, zth2=NULL, 
                    Zbe=NULL, zbe=NULL, Zga1=NULL, zga1=NULL, Zga2=NULL, 
                    zga2=NULL)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search.model_within_+3A_s">S</code></td>
<td>
<p>matrix of all response sequences observed at least once in the sample and listed row-by-row
(use NA for missing responses)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_yv">yv</code></td>
<td>
<p>vector of the frequencies of every response configuration in <code>S</code></p>
</td></tr>
<tr><td><code id="search.model_within_+3A_kv1">kv1</code></td>
<td>
<p>vector of the possible numbers of ability levels (or latent classes) for the 1st latent variable</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_kv2">kv2</code></td>
<td>
<p>vector of the possible numbers of ability levels (or latent classes) for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_x">X</code></td>
<td>
<p>matrix of covariates affecting the weights</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_link">link</code></td>
<td>
<p>type of link function (&quot;global&quot; for global logits, &quot;local&quot; for local logits);
with global logits a graded response model results; with local logits a  partial credit model results
(with dichotomous responses, global logits is the same as using local logits resulting in the Rasch or
the 2PL model depending on the value assigned to disc)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_disc">disc</code></td>
<td>
<p>indicator of constraints on the discriminating indices (FALSE = all equal to one, TRUE = free)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_difl">difl</code></td>
<td>
<p>indicator of constraints on the difficulty levels (FALSE = free, TRUE = rating scale parametrization)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_multi1">multi1</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row equal to
the indices of the items measuring the dimension corresponding to that row for the 1st latent variable</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_multi2">multi2</code></td>
<td>
<p>matrix with a number of rows equal to the number of dimensions and elements in each row equal to
the indices of the items measuring the dimension corresponding to that row for the 2nd latent variable</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_fort">fort</code></td>
<td>
<p>to use Fortran routines when possible</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_tol1">tol1</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (initial check based on random starting values)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_tol2">tol2</code></td>
<td>
<p>tolerance level for checking convergence of the algorithm as relative difference between 
consecutive log-likelihoods (final convergence)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_glob">glob</code></td>
<td>
<p>to use global logits in the covariates</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_disp">disp</code></td>
<td>
<p>to display the likelihood evolution step by step</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_output">output</code></td>
<td>
<p>to return additional outputs (Piv,Pp,lkv)</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_out_se">out_se</code></td>
<td>
<p>to return standard errors</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_nrep">nrep</code></td>
<td>
<p>number of repetitions of each random initialization</p>
</td></tr>
<tr><td><code id="search.model_within_+3A_zth1">Zth1</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zth1">zth1</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zth2">Zth2</code></td>
<td>
<p>matrix for the specification of constraints on the support points for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zth2">zth2</code></td>
<td>
<p>vector for the specification of constraints on the support points for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zbe">Zbe</code></td>
<td>
<p>matrix for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zbe">zbe</code></td>
<td>
<p>vector for the specification of constraints on the item difficulty parameters</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zga1">Zga1</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zga1">zga1</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 1st latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zga2">Zga2</code></td>
<td>
<p>matrix for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>  
<tr><td><code id="search.model_within_+3A_zga2">zga2</code></td>
<td>
<p>vector for the specification of constraints on the item discriminating indices for the 2nd latent variable</p>
</td></tr>    
</table>


<h3>Value</h3>

<table>
<tr><td><code>out.single</code></td>
<td>
<p>output of each single model for each <code>k</code> in <code>kv1</code> and <code>kv2</code>; it is similar to output from est_multi_poly_within, with the addition of values of number of latent classes for the 1st latent variable (<code>k1</code>) and the 2nd latent variable (<code>k2</code>) and the sequence of log-likelihoods (<code>lktrace</code>) for the deterministic start, for each random start, and for the final estimation obtained with  a tolerance level equal to <code>tol2</code></p>
</td></tr>	
<tr><td><code>aicv</code></td>
<td>
<p>Akaike Information Criterion index  for each  <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
<tr><td><code>bicv</code></td>
<td>
<p>Bayesian Information Criterion index  for each <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
<tr><td><code>entv</code></td>
<td>
<p>Entropy index for each <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
<tr><td><code>necv</code></td>
<td>
<p>NEC index for each <code>k</code> in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
<tr><td><code>lkv</code></td>
<td>
<p>log-likelihood at convergence of the EM algorithm  for each  <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
<tr><td><code>errv</code></td>
<td>
<p>trace of any errors occurred during the estimation process for each  <code>k</code>  in <code>kv1</code> and <code>kv2</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci, Silvia Bacci - University of Perugia (IT)</p>


<h3>References</h3>

<p>Bartolucci, F., Bacci, S. and Gnaldi, M. (2014), MultiLCIRT: An R package for multidimensional latent class item response models,
<em>Computational Statistics &amp; Data Analysis</em>, <b>71</b>, 971-985.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# Fit the model under different within-item multidimensional structures
# for SF12_nomiss data
data(SF12_nomiss)
S = SF12_nomiss[,1:12]
X = SF12_nomiss[,13]

# Partial credit model with two latent variables sharing six items 
# (free difficulty parameters and constrained discriminating parameters; 
# 1 to 3 latent classes for the 1st latent variable and 1 to 2 classes for the 2nd latent variable; 
# one covariate):
multi1 = c(1:5, 8:12)
multi2 = c(6:12, 1)
out1 = search.model_within(S=S,kv1=1:3,kv2=1:2,X=X,link="global",disc=FALSE,
                             multi1=multi1,multi2=multi2,disp=TRUE,
                             out_se=TRUE,tol1=10^-4, tol2=10^-7, nrep=1)
                             
# Main output
out1$lkv 
out1$aicv
out1$bicv 
# Model with 2 latent classes for each latent variable
out1$out.single[[4]]$k1 
out1$out.single[[4]]$k2 
out1$out.single[[4]]$Th1          
out1$out.single[[4]]$Th2 
out1$out.single[[4]]$piv1 
out1$out.single[[4]]$piv2   
out1$out.single[[4]]$ga1c
out1$out.single[[4]]$ga2c   
out1$out.single[[4]]$Bec            

## End(Not run)

</code></pre>

<hr>
<h2 id='SF12'>SF12 dataset</h2><span id='topic+SF12'></span>

<h3>Description</h3>

<p>This data set contains the responses  of 620 oncological patients to 12 ordinal polytomous items that measure the health-related quality of life, according to   the Italian release of Short-Form 12 version 2 (SF-12v2); patient's age is also provided.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SF12)</code></pre>


<h3>Format</h3>

<p>A dataframe with  620 observations on 12 items and one covariate: 
</p>

<dl>
<dt><code>Y1</code></dt><dd><p>general health</p>
</dd>
<dt><code>Y2</code></dt><dd><p>limits in moderate activities</p>
</dd>
<dt><code>Y3</code></dt><dd><p>limits in climbing several flights of stairs</p>
</dd>
<dt><code>Y4</code></dt><dd><p>accomplished less than he/she would like, as a result of his/her physical health</p>
</dd>
<dt><code>Y5</code></dt><dd><p>limited in the kind of work or daily activities, as a result of his/her physical health</p>
</dd>
<dt><code>Y6</code></dt><dd><p>accomplished less than he/she would like, as a result of his/her emotional health</p>
</dd>
<dt><code>Y7</code></dt><dd><p>did work less carefully than usual, as a result of his/her emotional health</p>
</dd>
<dt><code>Y8</code></dt><dd><p>how much did pain interfere with normal work</p>
</dd>
<dt><code>Y9</code></dt><dd><p>how much of the time have he/she felt calm and peaceful</p>
</dd>
<dt><code>Y10</code></dt><dd><p>how much of the time did he/she have a lot of energy</p>
</dd>
<dt><code>Y11</code></dt><dd><p>how much of the time have he/she felt downhearted and depressed</p>
</dd>
<dt><code>Y12</code></dt><dd><p>how much of the time physical health or emotional health interfered with social activities</p>
</dd>
<dt><code>age</code></dt><dd><p>age of the respondent</p>
</dd>    
</dl>



<h3>Details</h3>

<p>All items have 5 response categories, with the exception of items Y2 and Y3 having 3 response categories:  the minimum value 0 correspond to a low  level of quality of life, whereas the maximum value corresponds to a high level of quality of life. A proportion of 0.205 patients (127 out of 620) has missing responses (NA) on one or more items.
</p>


<h3>References</h3>

<p>Ware, J., Kosinski, M., Turner-Bowker, D. and Gandek, B. (2002), <em>SF-12v2. How to score version 2 of the SF-12 health survey</em>, QualityMetric Incorporated: Lincoln.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(SF12)
 dim(SF12)
 ## maybe str(SF12)
 str(SF12)
 </code></pre>

<hr>
<h2 id='SF12_nomiss'>SF12 dataset without missing responses</h2><span id='topic+SF12_nomiss'></span>

<h3>Description</h3>

<p>This data set contains the responses  of 493 oncological patients to 12 ordinal polytomous items that measure the health-related quality of life, according to   the Italian release of Short-Form 12 version 2 (SF-12v2); patient's age is also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SF12)</code></pre>


<h3>Format</h3>

<p>A dataframe with  493 observations on 12 items and one covariate: 
</p>

<dl>
<dt><code>Y1</code></dt><dd><p>general health</p>
</dd>
<dt><code>Y2</code></dt><dd><p>limits in moderate activities</p>
</dd>
<dt><code>Y3</code></dt><dd><p>limits in climbing several flights of stairs</p>
</dd>
<dt><code>Y4</code></dt><dd><p>accomplished less than he/she would like, as a result of his/her physical health</p>
</dd>
<dt><code>Y5</code></dt><dd><p>limited in the kind of work or daily activities, as a result of his/her physical health</p>
</dd>
<dt><code>Y6</code></dt><dd><p>accomplished less than he/she would like, as a result of his/her emotional health</p>
</dd>
<dt><code>Y7</code></dt><dd><p>did work less carefully than usual, as a result of his/her emotional health</p>
</dd>
<dt><code>Y8</code></dt><dd><p>how much did pain interfere with normal work</p>
</dd>
<dt><code>Y9</code></dt><dd><p>how much of the time have he/she felt calm and peaceful</p>
</dd>
<dt><code>Y10</code></dt><dd><p>how much of the time did he/she have a lot of energy</p>
</dd>
<dt><code>Y11</code></dt><dd><p>how much of the time have he/she felt downhearted and depressed</p>
</dd>
<dt><code>Y12</code></dt><dd><p>how much of the time physical health or emotional health interfered with social activities</p>
</dd>
<dt><code>age</code></dt><dd><p>age of the respondent</p>
</dd>    
</dl>



<h3>Details</h3>

<p>All items have 5 response categories, with the exception of items Y2 and Y3 having 3 response categories:  the minimum value 0 correspond to a low  level of quality of life, whereas the maximum value corresponds to a high level of quality of life. All records are complete.
</p>


<h3>References</h3>

<p>Ware, J., Kosinski, M., Turner-Bowker, D. and Gandek, B. (2002), <em>SF-12v2. How to score version 2 of the SF-12 health survey</em>, QualityMetric Incorporated: Lincoln.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(SF12_nomiss)
 dim(SF12_nomiss)
 ## maybe str(SF12_nomiss)
 str(SF12_nomiss)
 </code></pre>

<hr>
<h2 id='summary.est_multi_poly_between'>Print the output of est_multi_poly_between object</h2><span id='topic+summary.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.est_multi_poly_between_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="summary.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='summary.est_multi_poly_within'>Print the output of est_multi_poly_within object</h2><span id='topic+summary.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, it is written in a readable form</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
summary(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.est_multi_poly_within_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="summary.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='vcov.est_multi_poly_between'>Display the estimated variance-and-covariance matrix of est_multi_poly_between object</h2><span id='topic+vcov.est_multi_poly_between'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_between, the estimated variance-and-covariance matrix is displayed</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_between'
vcov(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.est_multi_poly_between_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_between</p>
</td></tr>
<tr><td><code id="vcov.est_multi_poly_between_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

<hr>
<h2 id='vcov.est_multi_poly_within'>Display the estimated variance-and-covariance matrix of est_multi_poly_within object</h2><span id='topic+vcov.est_multi_poly_within'></span>

<h3>Description</h3>

<p>Given the output from est_multi_poly_within, the estimated variance-and-covariance matrix is displayed</p>


<h3>Usage</h3>

<pre><code class='language-R'>	## S3 method for class 'est_multi_poly_within'
vcov(object, ...)
	</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.est_multi_poly_within_+3A_object">object</code></td>
<td>
<p>output from est_multi_poly_within</p>
</td></tr>
<tr><td><code id="vcov.est_multi_poly_within_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Francesco Bartolucci - University of Perugia (IT)</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
