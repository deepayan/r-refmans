<!DOCTYPE html><html><head><title>Help for package faoutlier</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {faoutlier}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#faoutlier'><p>Influential case detection methods for FA and SEM</p></a></li>
<li><a href='#forward.search'><p>Forward search algorithm for outlier detection</p></a></li>
<li><a href='#gCD'><p>Generalized Cook's Distance</p></a></li>
<li><a href='#GOF'><p>Goodness of Fit Distance</p></a></li>
<li><a href='#holzinger'><p>Description of holzinger data</p></a></li>
<li><a href='#holzinger.outlier'><p>Description of holzinger data with 1 outlier</p></a></li>
<li><a href='#LD'><p>Likelihood Distance</p></a></li>
<li><a href='#obs.resid'><p>Model predicted residual outliers</p></a></li>
<li><a href='#robustMD'><p>Robust Mahalanobis</p></a></li>
<li><a href='#setCluster'><p>Define a parallel cluster object to be used in internal functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.7.6</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Influential Case Detection Methods for Factor Analysis and
Structural Equation Models</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Phil Chalmers &lt;rphilip.chalmers@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for detecting and summarize influential cases that
    can affect exploratory and confirmatory factor analysis models as well as
    structural equation models more generally (Chalmers, 2015, &lt;<a href="https://doi.org/10.1177%2F0146621615597894">doi:10.1177/0146621615597894</a>&gt;; 
    Flora, D. B., LaBrish, C. &amp; Chalmers, R. P., 2012, &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2012.00055">doi:10.3389/fpsyg.2012.00055</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), sem, mvtnorm, parallel</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, lattice, lavaan, mirt (&ge; 1.32.1), MASS, pbapply (&ge;
1.3-0)</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/philchalmers/faoutlier">https://github.com/philchalmers/faoutlier</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-01-10 04:04:31 UTC; phil</td>
</tr>
<tr>
<td>Author:</td>
<td>Phil Chalmers [aut, cre]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-01-10 15:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='faoutlier'>Influential case detection methods for FA and SEM</h2><span id='topic+faoutlier'></span>

<h3>Description</h3>

<p>Influential case detection methods for factor analysis and SEM
</p>


<h3>Details</h3>

<p>Implements robust Mahalanobis methods, generalized Cook's distances,
likelihood ratio tests, model implied residuals, and various
graphical methods to help detect and summarize influential
cases that can affect exploratory and confirmatory factor analyses.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting 
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data 
screening and assumption testing for exploratory and confirmatory factor analysis. 
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>

<hr>
<h2 id='forward.search'>Forward search algorithm for outlier detection</h2><span id='topic+forward.search'></span><span id='topic+print.forward.search'></span><span id='topic+plot.forward.search'></span>

<h3>Description</h3>

<p>The forward search algorithm begins by selecting a homogeneous subset
of cases based on a maximum likelihood criteria and continues to add individual
cases at each iteration given an acceptance criteria. By default the function
will add cases that contribute most to the likelihood function and that have
the closest robust Mahalanobis distance, however model implied residuals
may be included as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forward.search(
  data,
  model,
  criteria = c("GOF", "mah"),
  n.subsets = 1000,
  p.base = 0.4,
  print.messages = TRUE,
  ...
)

## S3 method for class 'forward.search'
print(x, ncases = 10, stat = "GOF", ...)

## S3 method for class 'forward.search'
plot(
  x,
  y = NULL,
  stat = "GOF",
  main = "Forward Search",
  type = c("p", "h"),
  ylab = "obs.resid",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="forward.search_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="forward.search_+3A_model">model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis. If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead</p>
</td></tr>
<tr><td><code id="forward.search_+3A_criteria">criteria</code></td>
<td>
<p>character strings indicating the forward search method
Can contain <code>'GOF'</code> for goodness of fit distance, <code>'mah'</code> for Mahalanobis
distance, or <code>'res'</code> for model implied residuals</p>
</td></tr>
<tr><td><code id="forward.search_+3A_n.subsets">n.subsets</code></td>
<td>
<p>a scalar indicating how many samples to draw to find
a homogeneous starting base group</p>
</td></tr>
<tr><td><code id="forward.search_+3A_p.base">p.base</code></td>
<td>
<p>proportion of sample size to use as the base group</p>
</td></tr>
<tr><td><code id="forward.search_+3A_print.messages">print.messages</code></td>
<td>
<p>logical; print how many iterations are remaining?</p>
</td></tr>
<tr><td><code id="forward.search_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed</p>
</td></tr>
<tr><td><code id="forward.search_+3A_x">x</code></td>
<td>
<p>an object of class <code>forward.search</code></p>
</td></tr>
<tr><td><code id="forward.search_+3A_ncases">ncases</code></td>
<td>
<p>number of final cases to print in the sequence</p>
</td></tr>
<tr><td><code id="forward.search_+3A_stat">stat</code></td>
<td>
<p>type of statistic to use. Could be 'GOF', 'RMR', or 'gCD' for
the model chi squared value, root mean square residual, or generalized Cook's distance,
respectively</p>
</td></tr>
<tr><td><code id="forward.search_+3A_y">y</code></td>
<td>
<p>a <code>null</code> value ignored by <code>plot</code></p>
</td></tr>
<tr><td><code id="forward.search_+3A_main">main</code></td>
<td>
<p>the main title of the plot</p>
</td></tr>
<tr><td><code id="forward.search_+3A_type">type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td></tr>
<tr><td><code id="forward.search_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>forward.search</code> is not limited to confirmatory factor analysis and
can apply to nearly any model being studied
where detection of influential observations is important.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>
<p>Mavridis, D., &amp; Moustaki, I. (2008). Detecting Outliers in Factor Analysis Using the
Forward Search Algorithm. <em>Multivariate Behavioral Research, 43</em>, 453-475,
doi: <a href="https://doi.org/10.1080/00273170802285909">10.1080/00273170802285909</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gCD">gCD</a></code>, <code><a href="#topic+GOF">GOF</a></code>, <code><a href="#topic+LD">LD</a></code>,
<code><a href="#topic+robustMD">robustMD</a></code>, <code><a href="#topic+setCluster">setCluster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#run all internal gCD and GOF functions using multiple cores
setCluster()

#Exploratory
nfact &lt;- 3
(FS &lt;- forward.search(holzinger, nfact))
(FS.outlier &lt;- forward.search(holzinger.outlier, nfact))
plot(FS)
plot(FS.outlier)

#Confirmatory with sem
model &lt;- sem::specifyModel()
  F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam41
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1


(FS &lt;- forward.search(holzinger, model))
(FS.outlier &lt;- forward.search(holzinger.outlier, model))
plot(FS)
plot(FS.outlier)

#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(FS &lt;- forward.search(holzinger, model))
(FS.outlier &lt;- forward.search(holzinger.outlier, model))
plot(FS)
plot(FS.outlier)



## End(Not run)
</code></pre>

<hr>
<h2 id='gCD'>Generalized Cook's Distance</h2><span id='topic+gCD'></span><span id='topic+print.gCD'></span><span id='topic+plot.gCD'></span>

<h3>Description</h3>

<p>Compute generalize Cook's distances (gCD's) for exploratory
and confirmatory FA. Can return DFBETA matrix if requested.
If mirt is used, then the values will be associated with the unique response patterns instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gCD(data, model, progress = TRUE, ...)

## S3 method for class 'gCD'
print(x, ncases = 10, DFBETAS = FALSE, ...)

## S3 method for class 'gCD'
plot(
  x,
  y = NULL,
  main = "Generalized Cook Distance",
  type = c("p", "h"),
  ylab = "gCD",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gCD_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="gCD_+3A_model">model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis (requires complete dataset, i.e., no missing).
If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead</p>
</td></tr>
<tr><td><code id="gCD_+3A_progress">progress</code></td>
<td>
<p>logical; display the progress of the computations in the console?</p>
</td></tr>
<tr><td><code id="gCD_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed</p>
</td></tr>
<tr><td><code id="gCD_+3A_x">x</code></td>
<td>
<p>an object of class <code>gCD</code></p>
</td></tr>
<tr><td><code id="gCD_+3A_ncases">ncases</code></td>
<td>
<p>number of extreme cases to display</p>
</td></tr>
<tr><td><code id="gCD_+3A_dfbetas">DFBETAS</code></td>
<td>
<p>logical; return DFBETA matrix in addition to gCD? If TRUE, a list is returned</p>
</td></tr>
<tr><td><code id="gCD_+3A_y">y</code></td>
<td>
<p>a <code>NULL</code> value ignored by the plotting function</p>
</td></tr>
<tr><td><code id="gCD_+3A_main">main</code></td>
<td>
<p>the main title of the plot</p>
</td></tr>
<tr><td><code id="gCD_+3A_type">type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td></tr>
<tr><td><code id="gCD_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>gCD</code> is not limited to confirmatory factor analysis and
can apply to nearly any model being studied
where detection of influential observations is important.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LD">LD</a></code>, <code><a href="#topic+obs.resid">obs.resid</a></code>, <code><a href="#topic+robustMD">robustMD</a></code>, <code><a href="#topic+setCluster">setCluster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#run all gCD functions using multiple cores
setCluster()

#Exploratory
nfact &lt;- 3
(gCDresult &lt;- gCD(holzinger, nfact))
(gCDresult.outlier &lt;- gCD(holzinger.outlier, nfact))
plot(gCDresult)
plot(gCDresult.outlier)

#-------------------------------------------------------------------
#Confirmatory with sem
model &lt;- sem::specifyModel()
   F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam41
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1

(gCDresult2 &lt;- gCD(holzinger, model))
(gCDresult2.outlier &lt;- gCD(holzinger.outlier, model))
plot(gCDresult2)
plot(gCDresult2.outlier)

#-------------------------------------------------------------------
#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(gCDresult2 &lt;- gCD(holzinger, model, orthogonal=TRUE))
(gCDresult2.outlier &lt;- gCD(holzinger.outlier, model, orthogonal=TRUE))
plot(gCDresult2)
plot(gCDresult2.outlier)

# categorical data with mirt
library(mirt)
data(LSAT7)
dat &lt;- expand.table(LSAT7)
model &lt;- mirt.model('F = 1-5')
result &lt;- gCD(dat, model)
plot(result)

mod &lt;- mirt(dat, model)
res &lt;- residuals(mod, type = 'exp')
cbind(res, gCD=round(result$gCD, 3))


## End(Not run)
</code></pre>

<hr>
<h2 id='GOF'>Goodness of Fit Distance</h2><span id='topic+GOF'></span><span id='topic+print.GOF'></span><span id='topic+plot.GOF'></span>

<h3>Description</h3>

<p>Compute Goodness of Fit distances between models when removing the <code class="reqn">i_{th}</code> case.
If mirt is used, then the values will be associated with the unique response patterns instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GOF(data, model, M2 = TRUE, progress = TRUE, ...)

## S3 method for class 'GOF'
print(x, ncases = 10, digits = 5, ...)

## S3 method for class 'GOF'
plot(
  x,
  y = NULL,
  main = "Goodness of Fit Distance",
  type = c("p", "h"),
  ylab = "GOF",
  absolute = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GOF_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="GOF_+3A_model">model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis (requires complete dataset, i.e., no missing).
If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead. Finally, if the model is defined with
<code>mirt::mirt.model()</code> then distances will be computed for categorical data with the
mirt package</p>
</td></tr>
<tr><td><code id="GOF_+3A_m2">M2</code></td>
<td>
<p>logical; use the M2 statistic for when using mirt objects instead of G2?</p>
</td></tr>
<tr><td><code id="GOF_+3A_progress">progress</code></td>
<td>
<p>logical; display the progress of the computations in the console?</p>
</td></tr>
<tr><td><code id="GOF_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed</p>
</td></tr>
<tr><td><code id="GOF_+3A_x">x</code></td>
<td>
<p>an object of class <code>GOF</code></p>
</td></tr>
<tr><td><code id="GOF_+3A_ncases">ncases</code></td>
<td>
<p>number of extreme cases to display</p>
</td></tr>
<tr><td><code id="GOF_+3A_digits">digits</code></td>
<td>
<p>number of digits to round in the printed result</p>
</td></tr>
<tr><td><code id="GOF_+3A_y">y</code></td>
<td>
<p>a <code>NULL</code> value ignored by the plotting function</p>
</td></tr>
<tr><td><code id="GOF_+3A_main">main</code></td>
<td>
<p>the main title of the plot</p>
</td></tr>
<tr><td><code id="GOF_+3A_type">type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td></tr>
<tr><td><code id="GOF_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot</p>
</td></tr>
<tr><td><code id="GOF_+3A_absolute">absolute</code></td>
<td>
<p>logical; use absolute values instead of deviations?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>GOF</code> is not limited to confirmatory factor analysis and
can apply to nearly any model being studied
where detection of influential observations is important.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gCD">gCD</a></code>, <code><a href="#topic+LD">LD</a></code>, <code><a href="#topic+obs.resid">obs.resid</a></code>,
<code><a href="#topic+robustMD">robustMD</a></code>, <code><a href="#topic+setCluster">setCluster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#run all GOF functions using multiple cores
setCluster()

#Exploratory
nfact &lt;- 3
(GOFresult &lt;- GOF(holzinger, nfact))
(GOFresult.outlier &lt;- GOF(holzinger.outlier, nfact))
plot(GOFresult)
plot(GOFresult.outlier)

## include a progress bar
GOFresult &lt;- GOF(holzinger, nfact, progress = TRUE)

#-------------------------------------------------------------------
#Confirmatory with sem
model &lt;- sem::specifyModel()
  F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam42
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1

(GOFresult &lt;- GOF(holzinger, model))
(GOFresult.outlier &lt;- GOF(holzinger.outlier, model))
plot(GOFresult)
plot(GOFresult.outlier)

#-------------------------------------------------------------------
#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(GOFresult &lt;- GOF(holzinger, model, orthogonal=TRUE))
(GOFresult.outlier &lt;- GOF(holzinger.outlier, model, orthogonal=TRUE))
plot(GOFresult)
plot(GOFresult.outlier)


# categorical data with mirt
library(mirt)
data(LSAT7)
dat &lt;- expand.table(LSAT7)
model &lt;- mirt.model('F = 1-5')
result &lt;- GOF(dat, model)
plot(result)


## End(Not run)
</code></pre>

<hr>
<h2 id='holzinger'>Description of holzinger data</h2><span id='topic+holzinger'></span>

<h3>Description</h3>

<p>A sample of 100 simulated cases from the infamous Holzinger dataset
using 9 variables.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting 
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data 
screening and assumption testing for exploratory and confirmatory factor analysis. 
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>

<hr>
<h2 id='holzinger.outlier'>Description of holzinger data with 1 outlier</h2><span id='topic+holzinger.outlier'></span>

<h3>Description</h3>

<p>A sample of 100 simulated cases from the infamous Holzinger dataset
using 9 variables, but with 1 outlier added to the dataset. The first row was replaced
by adding 2 to five of the observed variables (odd-numbered items) and subtracting 2 from
the other four observed variables (even-numbered items).
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting 
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data 
screening and assumption testing for exploratory and confirmatory factor analysis. 
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>

<hr>
<h2 id='LD'>Likelihood Distance</h2><span id='topic+LD'></span><span id='topic+print.LD'></span><span id='topic+plot.LD'></span>

<h3>Description</h3>

<p>Compute likelihood distances between models when removing the <code class="reqn">i_{th}</code> case. If there are no
missing data then the <code><a href="#topic+GOF">GOF</a></code> will often provide equivalent results. If mirt is used,
then the values will be associated with the unique response patterns instead.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LD(data, model, progress = TRUE, ...)

## S3 method for class 'LD'
print(x, ncases = 10, digits = 5, ...)

## S3 method for class 'LD'
plot(
  x,
  y = NULL,
  main = "Likelihood Distance",
  type = c("p", "h"),
  ylab = "LD",
  absolute = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LD_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="LD_+3A_model">model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis (requires complete dataset, i.e., no missing).
If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead. Finally, if the model is defined with
<code>mirt::mirt.model()</code> then distances will be computed for categorical data with the
mirt package</p>
</td></tr>
<tr><td><code id="LD_+3A_progress">progress</code></td>
<td>
<p>logical; display the progress of the computations in the console?</p>
</td></tr>
<tr><td><code id="LD_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed</p>
</td></tr>
<tr><td><code id="LD_+3A_x">x</code></td>
<td>
<p>an object of class <code>LD</code></p>
</td></tr>
<tr><td><code id="LD_+3A_ncases">ncases</code></td>
<td>
<p>number of extreme cases to display</p>
</td></tr>
<tr><td><code id="LD_+3A_digits">digits</code></td>
<td>
<p>number of digits to round in the printed result</p>
</td></tr>
<tr><td><code id="LD_+3A_y">y</code></td>
<td>
<p>a <code>NULL</code> value ignored by the plotting function</p>
</td></tr>
<tr><td><code id="LD_+3A_main">main</code></td>
<td>
<p>the main title of the plot</p>
</td></tr>
<tr><td><code id="LD_+3A_type">type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td></tr>
<tr><td><code id="LD_+3A_ylab">ylab</code></td>
<td>
<p>the y label of the plot</p>
</td></tr>
<tr><td><code id="LD_+3A_absolute">absolute</code></td>
<td>
<p>logical; use absolute values instead of deviations?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that <code>LD</code> is not limited to confirmatory factor analysis and
can apply to nearly any model being studied
where detection of influential observations is important.
</p>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gCD">gCD</a></code>, <code><a href="#topic+GOF">GOF</a></code>, <code><a href="#topic+obs.resid">obs.resid</a></code>,
<code><a href="#topic+robustMD">robustMD</a></code>, <code><a href="#topic+setCluster">setCluster</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#run all LD functions using multiple cores
setCluster()

#Exploratory
nfact &lt;- 3
(LDresult &lt;- LD(holzinger, nfact))
(LDresult.outlier &lt;- LD(holzinger.outlier, nfact))
plot(LDresult)
plot(LDresult.outlier)

## add a progress meter
LDresult &lt;- LD(holzinger, nfact, progress = TRUE)

#-------------------------------------------------------------------
#Confirmatory with sem
model &lt;- sem::specifyModel()
  F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam42
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1

(LDresult &lt;- LD(holzinger, model))
(LDresult.outlier &lt;- LD(holzinger.outlier, model))
plot(LDresult)
plot(LDresult.outlier)

#-------------------------------------------------------------------
#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(LDresult &lt;- LD(holzinger, model, orthogonal=TRUE))
(LDresult.outlier &lt;- LD(holzinger.outlier, model, orthogonal=TRUE))
plot(LDresult)
plot(LDresult.outlier)

# categorical data with mirt
library(mirt)
data(LSAT7)
dat &lt;- expand.table(LSAT7)
model &lt;- mirt.model('F = 1-5')
LDresult &lt;- LD(dat, model)
plot(LDresult)


## End(Not run)
</code></pre>

<hr>
<h2 id='obs.resid'>Model predicted residual outliers</h2><span id='topic+obs.resid'></span><span id='topic+print.obs.resid'></span><span id='topic+plot.obs.resid'></span>

<h3>Description</h3>

<p>Compute model predicted residuals for each variable using regression
estimated factor scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obs.resid(data, model, ...)

## S3 method for class 'obs.resid'
print(x, restype = "obs", ...)

## S3 method for class 'obs.resid'
plot(
  x,
  y = NULL,
  main = "Observed Residuals",
  type = c("p", "h"),
  restype = "obs",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="obs.resid_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_model">model</code></td>
<td>
<p>if a single numeric number declares number of factors to extract in
exploratory factor analysis. If <code>class(model)</code> is a sem (semmod), or lavaan (character),
then a confirmatory approach is performed instead</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_...">...</code></td>
<td>
<p>additional parameters to be passed</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_x">x</code></td>
<td>
<p>an object of class <code>obs.resid</code></p>
</td></tr>
<tr><td><code id="obs.resid_+3A_restype">restype</code></td>
<td>
<p>type of residual used, either <code>'obs'</code> for observation value
(inner product), <code>'res'</code> or <code>'std_res'</code> for unstandardized and standardized
for each variable, respectively</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_y">y</code></td>
<td>
<p>a <code>NULL</code> value ignored by the plotting function</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_main">main</code></td>
<td>
<p>the main title of the plot</p>
</td></tr>
<tr><td><code id="obs.resid_+3A_type">type</code></td>
<td>
<p>type of plot to use, default displays points and lines</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data
screening and assumption testing for exploratory and confirmatory factor analysis.
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gCD">gCD</a></code>, <code><a href="#topic+LD">LD</a></code>, <code><a href="#topic+robustMD">robustMD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(holzinger)
data(holzinger.outlier)

#Exploratory
nfact &lt;- 3
(ORresult &lt;- obs.resid(holzinger, nfact))
(ORresult.outlier &lt;- obs.resid(holzinger.outlier, nfact))
plot(ORresult)
plot(ORresult.outlier)

#-------------------------------------------------------------------
#Confirmatory with sem
model &lt;- sem::specifyModel()
   F1 -&gt; Remndrs,    lam11
	  F1 -&gt; SntComp,    lam21
	  F1 -&gt; WrdMean,    lam31
	  F2 -&gt; MissNum,    lam41
	  F2 -&gt; MxdArit,    lam52
	  F2 -&gt; OddWrds,    lam62
	  F3 -&gt; Boots,      lam73
  F3 -&gt; Gloves,     lam83
	  F3 -&gt; Hatchts,    lam93
	  F1 &lt;-&gt; F1,   NA,     1
	  F2 &lt;-&gt; F2,   NA,     1
	  F3 &lt;-&gt; F3,   NA,     1

(ORresult &lt;- obs.resid(holzinger, model))
(ORresult.outlier &lt;- obs.resid(holzinger.outlier, model))
plot(ORresult)
plot(ORresult.outlier)

#-------------------------------------------------------------------
#Confirmatory with lavaan
model &lt;- 'F1 =~  Remndrs + SntComp + WrdMean
F2 =~ MissNum + MxdArit + OddWrds
F3 =~ Boots + Gloves + Hatchts'

(obs.resid2 &lt;- obs.resid(holzinger, model, orthogonal=TRUE))
(obs.resid2.outlier &lt;- obs.resid(holzinger.outlier, model, orthogonal=TRUE))
plot(obs.resid2)
plot(obs.resid2.outlier)


## End(Not run)
</code></pre>

<hr>
<h2 id='robustMD'>Robust Mahalanobis</h2><span id='topic+robustMD'></span><span id='topic+print.robmah'></span><span id='topic+plot.robmah'></span>

<h3>Description</h3>

<p>Obtain Mahalanobis distances using the robust
computing methods found in the <code>MASS</code> package. This function is generally only applicable
to models with continuous variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robustMD(data, method = "mve", ...)

## S3 method for class 'robmah'
print(x, ncases = 10, digits = 5, ...)

## S3 method for class 'robmah'
plot(x, y = NULL, type = "xyplot", main, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robustMD_+3A_data">data</code></td>
<td>
<p>matrix or data.frame</p>
</td></tr>
<tr><td><code id="robustMD_+3A_method">method</code></td>
<td>
<p>type of estimation for robust means and covariance
(see <code><a href="MASS.html#topic+cov.rob">cov.rob</a></code>)</p>
</td></tr>
<tr><td><code id="robustMD_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code>MASS::cov.rob()</code></p>
</td></tr>
<tr><td><code id="robustMD_+3A_x">x</code></td>
<td>
<p>an object of class <code>robmah</code></p>
</td></tr>
<tr><td><code id="robustMD_+3A_ncases">ncases</code></td>
<td>
<p>number of extreme cases to print</p>
</td></tr>
<tr><td><code id="robustMD_+3A_digits">digits</code></td>
<td>
<p>number of digits to round in the final result</p>
</td></tr>
<tr><td><code id="robustMD_+3A_y">y</code></td>
<td>
<p>empty parameter passed to <code>plot</code></p>
</td></tr>
<tr><td><code id="robustMD_+3A_type">type</code></td>
<td>
<p>type of plot to display, can be either <code>'qqplot'</code> or <code>'xyplot'</code></p>
</td></tr>
<tr><td><code id="robustMD_+3A_main">main</code></td>
<td>
<p>title for plot. If missing titles will be generated automatically</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting 
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data 
screening and assumption testing for exploratory and confirmatory factor analysis. 
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gCD">gCD</a></code>, <code><a href="#topic+obs.resid">obs.resid</a></code>, <code><a href="#topic+LD">LD</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(holzinger)
output &lt;- robustMD(holzinger)
output
plot(output)
plot(output, type = 'qqplot')

## End(Not run)
</code></pre>

<hr>
<h2 id='setCluster'>Define a parallel cluster object to be used in internal functions</h2><span id='topic+setCluster'></span>

<h3>Description</h3>

<p>This function defines a object that is placed in a relevant internal environment defined in faoutlier.
Internal functions will utilize this object automatically to capitalize on parallel
processing architecture. The object defined is a call from <code>parallel::makeCluster()</code>. Note that
if you are defining other parallel objects (for simulation designs, for example) it is not recommended
to define a cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setCluster(spec, ..., remove = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setCluster_+3A_spec">spec</code></td>
<td>
<p>input that is passed to <code>parallel::makeCluster()</code>. If no input is given the
maximum number of available local cores will be used</p>
</td></tr>
<tr><td><code id="setCluster_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code>parallel::makeCluster</code></p>
</td></tr>
<tr><td><code id="setCluster_+3A_remove">remove</code></td>
<td>
<p>logical; remove previously defined cluster object?</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Phil Chalmers <a href="mailto:rphilip.chalmers@gmail.com">rphilip.chalmers@gmail.com</a>
</p>


<h3>References</h3>

<p>Chalmers, R. P. &amp; Flora, D. B. (2015). faoutlier: An R Package for Detecting 
Influential Cases in Exploratory and Confirmatory Factor Analysis.
<em>Applied Psychological Measurement, 39</em>, 573-574. doi: <a href="https://doi.org/10.1177/0146621615597894">10.1177/0146621615597894</a>
</p>
<p>Flora, D. B., LaBrish, C. &amp; Chalmers, R. P. (2012). Old and new ideas for data 
screening and assumption testing for exploratory and confirmatory factor analysis. 
<em>Frontiers in Psychology, 3</em>, 1-21. doi: <a href="https://doi.org/10.3389/fpsyg.2012.00055">10.3389/fpsyg.2012.00055</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

#make 4 cores available for parallel computing
setCluster(4)

#' #stop and remove cores
setCluster(remove = TRUE)

#use all available cores
setCluster()


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
