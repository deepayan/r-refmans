<!DOCTYPE html><html><head><title>Help for package mDAG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mDAG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#example_data'><p>Example data</p></a></li>
<li><a href='#mDAG'><p>Inferring Causal Network from Mixed Observational Data Using a Directed Acyclic Graph</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inferring Causal Network from Mixed Observational Data Using a
Directed Acyclic Graph</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-8-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Wujuan Zhong, Li Dong, Quefeng Li, Xiaojing Zheng</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wujuan Zhong &lt;zhongwujuan@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Learning a mixed directed acyclic graph based on both continuous and categorical data.</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.14), pcalg, mgm, bnlearn, methods, nnet</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), logistf</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-20 14:17:48 UTC; Fox</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-20 15:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='example_data'>Example data</h2><span id='topic+example_data'></span>

<h3>Description</h3>

<p>An example data, including 5 variables (4 continuous variables and 1 binary variable) and 100 samples. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(example_data)
</code></pre>

<hr>
<h2 id='mDAG'>Inferring Causal Network from Mixed Observational Data Using a Directed Acyclic Graph</h2><span id='topic+mDAG'></span>

<h3>Description</h3>

<p>This function learns a mixed directed acyclic graph based on both continuous and categorical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mDAG(data, type, level, SNP = rep(0, ncol(data)), lambdaGam = 0.25,
  ruleReg = "OR", threshold = "LW", weights = rep(1, nrow(data)),
  alpha = 0.05, nperm = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mDAG_+3A_data">data</code></td>
<td>
<p>A n x p matrix. Each row is a sample; each column is a variable.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_type">type</code></td>
<td>
<p>A string vector of length p, indicating the type of variable for each column in <code>data</code>. 'g' for Gaussian, 'c' for categorical.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_level">level</code></td>
<td>
<p>A vector of length p, indicating the number of categories of each variable. For continuous variables, set it to 1.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_snp">SNP</code></td>
<td>
<p>A vector of length p, indicating which variable is a SNP.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_lambdagam">lambdaGam</code></td>
<td>
<p>Hyperparameter <code class="reqn">\gamma</code> in the EBIC if <code>lambdaSel = 'EBIC'</code>. Defaults is <code>lambdaGam = 0.25</code>.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_rulereg">ruleReg</code></td>
<td>
<p>Default is <code>'OR'</code>. Rule used to combine two estimates from nodewise regression (one from regressing A on B and the other from B on A). ruleReg = <code>'AND'</code> requires both estimates to be nonzero in order to set the edge to be present. ruleReg = <code>'OR'</code>
requires at least one estiamte to be nonzero in order to set the edge to be present.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_threshold">threshold</code></td>
<td>
<p>Default is <code>'LW'</code>. A threshold below which the combined estimates from nodewise regression are put to zero. threshold = <code>'LW'</code> refers to the threshold in Loh and Wainwright (2012). threshold = <code>'HW'</code> refers to the threshold in Haslbeck and Waldorp (2016). If threshold = <code>'none'</code> no thresholding is applied.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_weights">weights</code></td>
<td>
<p>A vector of length n, indicating weights for observations.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for permutation test of conditional independece. Default is 0.05.</p>
</td></tr>
<tr><td><code id="mDAG_+3A_nperm">nperm</code></td>
<td>
<p>The number of permutations in the permutation test of conditional independece. Default is 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following components:
</p>

<ul>
<li> <p><code>arcs</code>: A two-column matrix, indicating arcs of the DAG. 
</p>
</li>
<li> <p><code>nodes</code>: A list. Each element is named after a node and contains the following elements.
 </p>
<ul>
<li> <p><code>nbr</code>: a string vector indicating the neighbourhood of the node.
</p>
</li>
<li> <p><code>parents</code>: a string vector indicating the parents of the node.
</p>
</li>
<li> <p><code>children</code>: a string vector indicating the children of the node.</p>
</li></ul>

</li>
<li> <p><code>skeleton</code>: A p x p adjacency matrix. If there is an edge from node i to node j, its <code>(i,j)</code> th entry = 1; otherwise = 0. 
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Wujuan Zhong, Li Dong, Quefeng Li, Xiaojing Zheng
</p>


<h3>References</h3>

<p>Jonas M. B. Haslbeck, Lourens J. Waldorp (2016). mgm: Structure Estimation for Time-Varying Mixed Graphical Models in high-dimensional Data arXiv preprint:1510.06871v2
</p>
<p>Markus Kalisch, Martin Maechler, Diego Colombo, Marloes H. Maathuis, Peter Buehlmann (2012). Causal Inference Using Graphical Models with the R Package pcalg. Journal of Statistical Software, 47(11), 1-26.
</p>
<p>Loh, P. L., &amp; Wainwright, M. J. (2012, December). Structure estimation for discrete graphical models: Generalized covariance matrices and their inverses. In NIPS (pp. 2096-2104).
</p>
<p>Haslbeck, J., &amp; Waldorp, L. J. (2016). mgm: Structure Estimation for time-varying Mixed Graphical Models in high-dimensional Data. arXiv preprint arXiv:1510.06871.
</p>
<p>Marco Scutari (2010). Learning Bayesian Networks with the bnlearn R Package. Journal of Statistical Software, 35(3), 1-22.
</p>
<p>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics with S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0
</p>
<p>Georg Heinze and Meinhard Ploner (2018). logistf: Firth's Bias-Reduced Logistic Regression. R package version 1.23.
</p>
<p>Min Jin Ha (2013). PenPC: A Two-step Approach to Estimate the Skeletons of High Dimensional Directed Acyclic Graphs. R package version 0.99.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# load package
library(mDAG)
type=c("g","g","g","g","c")
level=c(1,1,1,1,2)
# To save time for running example, we set nperm as 150. 
# Use default nperm=10000 to generate a more reliable DAG for your own data.
dag=mDAG(data=example_data, type=type, level=level, nperm=150)
print(dag$skeleton)
# draw the DAG
# library(bnlearn)
# bnlearn:::graphviz.backend(nodes=names(dag$nodes),arcs=dag$arcs,shape="rectangle")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
