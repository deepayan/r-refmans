<!DOCTYPE html><html><head><title>Help for package mbRes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mbRes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mbRes-package'><p>mbRes: Exploration of Multiple Biomarker Responses using Effect Size</p></a></li>
<li><a href='#beliaeff2002'><p>Compute Integrated Biomarker Index</p></a></li>
<li><a href='#blaise2002'><p>Compute Rank Sum Biomarker Index</p></a></li>
<li><a href='#cliff'><p>Compute Effect Size</p></a></li>
<li><a href='#compare'><p>Compare RSI, IBR, and Cliff's delta</p></a></li>
<li><a href='#ggdot'><p>Make Dot Plot</p></a></li>
<li><a href='#ggheat'><p>Make Heatmap</p></a></li>
<li><a href='#mbr'><p>Compute Cliff's delta and S-value</p></a></li>
<li><a href='#mbr.cliff'><p>Compute Cliff's delta simplified</p></a></li>
<li><a href='#mbr.glass'><p>Compute Glass's delta simplified</p></a></li>
<li><a href='#plotsam'><p>Visualize Hypothetical Samples</p></a></li>
<li><a href='#resampling'><p>Measure Statistical Uncertainty</p></a></li>
<li><a href='#setpop'><p>Define Hypothetical Populations</p></a></li>
<li><a href='#simul'><p>Generate Hypothetical Samples</p></a></li>
<li><a href='#visual'><p>Visualize Cliff's delta and S-value</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exploration of Multiple Biomarker Responses using Effect Size</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Summarize multiple biomarker responses of aquatic organisms to
    contaminants using Cliff’s delta, as described in Pham &amp; Sokolova (2023)
    &lt;<a href="https://doi.org/10.1002%2Fieam.4676">doi:10.1002/ieam.4676</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, ggplot2 (&ge; 3.4.1), cowplot (&ge; 1.1.1), magrittr (&ge;
2.0.3), tibble (&ge; 3.2.1), dplyr (&ge; 1.1.1), forcats (&ge;
1.0.0), tidyr (&ge; 1.3.0), purrr (&ge; 1.0.1), data.table (&ge;
1.14.8), scales (&ge; 1.2.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RProbSup (&ge; 3.0)</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/phamdn/mbRes/issues">https://github.com/phamdn/mbRes/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-29 05:42:49 UTC; nghia</td>
</tr>
<tr>
<td>Author:</td>
<td>Duy Nghia Pham <a href="https://orcid.org/0000-0003-1349-1710"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Inna M. Sokolova <a href="https://orcid.org/0000-0002-2068-4302"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Duy Nghia Pham &lt;nghiapham@yandex.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-29 11:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='mbRes-package'>mbRes: Exploration of Multiple Biomarker Responses using Effect Size</h2><span id='topic+mbRes-package'></span>

<h3>Description</h3>

<p>Summarize multiple biomarker responses of aquatic organisms to contaminants
using Cliff’s delta, as described in Pham &amp; Sokolova (2023)
<a href="https://doi.org/10.1002/ieam.4676">doi:10.1002/ieam.4676</a>.
</p>


<h3>Guidelines</h3>

<p><code><a href="#topic+mbr">mbr</a></code> and <code><a href="#topic+visual">visual</a></code> are the main
functions to compute and visualize Cliff’s delta and S-value which are
results of <code><a href="#topic+cliff">cliff</a></code> and <code><a href="#topic+resampling">resampling</a></code>.
<code><a href="#topic+setpop">setpop</a></code>, <code><a href="#topic+simul">simul</a></code>, and <code><a href="#topic+plotsam">plotsam</a></code>
simulate and visualize a hypothetical dataset. <code><a href="#topic+compare">compare</a></code>
compares the results of Cliff’s delta and two other integrated indices
published earlier (i.e., RSI and IBR, see <code><a href="#topic+blaise2002">blaise2002</a></code> and
<code><a href="#topic+beliaeff2002">beliaeff2002</a></code>). The others (<code><a href="#topic+ggheat">ggheat</a></code> and
<code><a href="#topic+ggdot">ggdot</a></code>) are helper functions and are not meant to be called
directly by users.
</p>


<h3>Updates</h3>

<p><code><a href="#topic+mbr.cliff">mbr.cliff</a></code> and <code><a href="#topic+mbr.glass">mbr.glass</a></code> simply
compute and visualize Cliff’s delta and Glass's delta.
</p>


<h3>Copyright</h3>

<p>mbRes: Exploration of Multiple Biomarker Responses using
Effect Size. <br /> Copyright (C) 2021-2023 Duy Nghia Pham &amp; Inna M. Sokolova
<br /> <br /> mbRes is free software: you can redistribute it and/or modify it
under the terms of the GNU General Public License as published by the Free
Software Foundation, either version 3 of the License, or (at your option)
any later version. <br /> <br /> mbRes is distributed in the hope that it will be
useful, but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General
Public License for more details. <br /> <br /> You should have received a copy of
the GNU General Public License along with mbRes.  If not, see
<a href="https://www.gnu.org/licenses/">https://www.gnu.org/licenses/</a>.
</p>


<h3>Author(s)</h3>

<p>Duy Nghia Pham &amp; Inna M. Sokolova
</p>

<hr>
<h2 id='beliaeff2002'>Compute Integrated Biomarker Index</h2><span id='topic+beliaeff2002'></span>

<h3>Description</h3>

<p><code>beliaeff2002</code> calculates IBR in the hypothetical case study. This is
not meant to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beliaeff2002(sam_mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beliaeff2002_+3A_sam_mean">sam_mean</code></td>
<td>
<p>a data frame, the third output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>beliaeff2002</code> returns a data frame of IBR.
</p>


<h3>References</h3>

<p>Beliaeff, B., &amp; Burgeot, T. (2002). Integrated biomarker
response: A useful tool for ecological risk assessment. Environmental
Toxicology and Chemistry, 21(6), 1316–1322. <a href="https://doi.org/10.1002/etc.5620210629">doi:10.1002/etc.5620210629</a>.
</p>

<hr>
<h2 id='blaise2002'>Compute Rank Sum Biomarker Index</h2><span id='topic+blaise2002'></span>

<h3>Description</h3>

<p><code>blaise2002</code> calculates RSI in the hypothetical case study. This is not
meant to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>blaise2002(sam, sam_mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="blaise2002_+3A_sam">sam</code></td>
<td>
<p>a data frame, the first output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
<tr><td><code id="blaise2002_+3A_sam_mean">sam_mean</code></td>
<td>
<p>a data frame, the third output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>blaise2002</code> returns a data frame of RSI.
</p>


<h3>References</h3>

<p>Blaise, C., Gagné, F., Pellerin, J., Hansen, P.-D., &amp; Trottier,
S. (2002). Molluscan shellfish biomarker study of the Quebec, Canada,
Saguenay Fjord with the soft-shell clam, Mya arenaria. Environmental
Toxicology, 17(3), 170–186. <a href="https://doi.org/10.1002/tox.10048">doi:10.1002/tox.10048</a>.
</p>

<hr>
<h2 id='cliff'>Compute Effect Size</h2><span id='topic+cliff'></span>

<h3>Description</h3>

<p><code>cliff</code> calculates Cliff's delta statistic using the rank sum method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cliff(v1, v0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cliff_+3A_v1">v1</code></td>
<td>
<p>a vector, biomarker values from the treatment group.</p>
</td></tr>
<tr><td><code id="cliff_+3A_v0">v0</code></td>
<td>
<p>a vector, biomarker values from the control group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>cliff</code> returns a numeric that is the Cliff's delta of the
treatment group.
</p>


<h3>References</h3>

<p>Cliff, N. (1993). Dominance statistics: Ordinal analyses to
answer ordinal questions. Psychological Bulletin, 114(3), 494–509.
<a href="https://doi.org/10.1037/0033-2909.114.3.494">doi:10.1037/0033-2909.114.3.494</a>. <br /> <br /> Vargha, A., &amp; Delaney, H. D.
(2000). A Critique and Improvement of the CL Common Language Effect Size
Statistics of McGraw and Wong. Journal of Educational and Behavioral
Statistics, 25(2), 101–132. <a href="https://doi.org/10.3102/10769986025002101">doi:10.3102/10769986025002101</a>. <br /> <br />
Ruscio, J., &amp; Mullen, T. (2012). Confidence Intervals for the Probability
of Superiority Effect Size Measure and the Area Under a Receiver Operating
Characteristic Curve. Multivariate Behavioral Research, 47(2), 201–223.
<a href="https://doi.org/10.1080/00273171.2012.658329">doi:10.1080/00273171.2012.658329</a>.
</p>


<h3>See Also</h3>

<p><code><a href="RProbSup.html#topic+CalcA1">CalcA1</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
cliff(subset(temp$sam, Site == "S1", Bmk1, drop = TRUE),
subset(temp$sam, Site == "S0", Bmk1, drop = TRUE))


</code></pre>

<hr>
<h2 id='compare'>Compare RSI, IBR, and Cliff's delta</h2><span id='topic+compare'></span>

<h3>Description</h3>

<p><code>compare</code> calculates RSI assigned values, IBR translated scores, and
Cliff's delta in the hypothetical case study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare(sam, sam_mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_+3A_sam">sam</code></td>
<td>
<p>a data frame, the first output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
<tr><td><code id="compare_+3A_sam_mean">sam_mean</code></td>
<td>
<p>a data frame, the third output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>compare</code> returns a list of length 5: </p>
<table>
<tr><td><code>blaise</code></td>
<td>
<p>RSI
assigned values and final RSI.</p>
</td></tr> <tr><td><code>beliaeff</code></td>
<td>
<p>IBR translated
scores and final IBR.</p>
</td></tr> <tr><td><code>pham</code></td>
<td>
<p>Cliff's delta and the average of
absolute Cliff’s delta.</p>
</td></tr> <tr><td><code>fig1</code></td>
<td>
<p>ggplot object of comparisions
among RSI assigned values, IBR translated scores, and Cliff's delta.</p>
</td></tr>
<tr><td><code>fig2</code></td>
<td>
<p>ggplot object of comparision among RSI, IBR, and the
average of absolute Cliff’s delta.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Blaise, C., Gagné, F., Pellerin, J., Hansen, P.-D., &amp; Trottier,
S. (2002). Molluscan shellfish biomarker study of the Quebec, Canada,
Saguenay Fjord with the soft-shell clam, Mya arenaria. Environmental
Toxicology, 17(3), 170–186. <a href="https://doi.org/10.1002/tox.10048">doi:10.1002/tox.10048</a>.  <br /> <br /> Beliaeff, B.,
&amp; Burgeot, T. (2002). Integrated biomarker response: A useful tool for
ecological risk assessment. Environmental Toxicology and Chemistry, 21(6),
1316–1322. <a href="https://doi.org/10.1002/etc.5620210629">doi:10.1002/etc.5620210629</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
compare(temp$sam, temp$sam_mean)
 #might take more than 5s in some machines

</code></pre>

<hr>
<h2 id='ggdot'>Make Dot Plot</h2><span id='topic+ggdot'></span>

<h3>Description</h3>

<p><code>ggdot</code> creates dot plot of the average of absolute Cliff’s delta. This
is not meant to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggdot(dat, hax, vax)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggdot_+3A_dat">dat</code></td>
<td>
<p>a data frame with at least two columns.</p>
</td></tr>
<tr><td><code id="ggdot_+3A_hax">hax</code></td>
<td>
<p>a character, name of the column to be used as the horizontal axis.</p>
</td></tr>
<tr><td><code id="ggdot_+3A_vax">vax</code></td>
<td>
<p>a character, name of the column to be used as the vertical axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggdot</code> returns a ggplot object.
</p>

<hr>
<h2 id='ggheat'>Make Heatmap</h2><span id='topic+ggheat'></span>

<h3>Description</h3>

<p><code>ggheat</code> creates heatmaps of the Cliff's delta and S-value. This is not
meant to be called directly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggheat(
  dat,
  hax,
  vax,
  cell,
  nm,
  lim,
  lo,
  hi,
  diverging = FALSE,
  env = parent.frame()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggheat_+3A_dat">dat</code></td>
<td>
<p>a data frame with at least three columns.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_hax">hax</code></td>
<td>
<p>a character, name of the column to be used as the horizontal axis.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_vax">vax</code></td>
<td>
<p>a character, name of the column to be used as the vertical axis.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_cell">cell</code></td>
<td>
<p>a character, name of the column to be used as the cells.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_nm">nm</code></td>
<td>
<p>a character, name of the heatmap.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_lim">lim</code></td>
<td>
<p>a numeric vector, limits of the color scale.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_lo">lo</code></td>
<td>
<p>a character, color of the color scale low end.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_hi">hi</code></td>
<td>
<p>a character, color of the color scale high end.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_diverging">diverging</code></td>
<td>
<p>a logical, whether to use diverging color gradient.</p>
</td></tr>
<tr><td><code id="ggheat_+3A_env">env</code></td>
<td>
<p>an environment, to access outer scope variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ggheat</code> returns a ggplot object.
</p>

<hr>
<h2 id='mbr'>Compute Cliff's delta and S-value</h2><span id='topic+mbr'></span>

<h3>Description</h3>

<p><code>mbr</code> summarizes Cliff's delta and S-value for multiple groups and
multiple biomarkers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbr(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbr_+3A_df">df</code></td>
<td>
<p>a data frame with the name of experimental groups or biomonitoring
sites as the first column and the measurement of biomarkers as the
remaining columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The header of the first column can be any character, for example,
'group' or 'site'. The first name appearing in the first column will
determine the control group or the reference site. The other names will be
treatment groups or test sites. The header of the remaining columns will
define the list of biomarkers.
</p>


<h3>Value</h3>

<p><code>mbr</code> returns a list of length 3: </p>
<table>
<tr><td><code>mess</code></td>
<td>
<p>a list of
length 3 confirms the information about <code>df</code>.</p>
</td></tr><tr><td><code>es</code></td>
<td>
<p>a data
frame with 9 columns:</p>
 <dl>
<dt><code>test_site</code></dt><dd><p>treatment groups or
test sites.</p>
</dd> <dt><code>ref_site </code></dt><dd><p>control group or reference site.</p>
</dd>
<dt><code>t_size </code></dt><dd><p>the sample size of treatment group or test sites.</p>
</dd>
<dt><code>r_size </code></dt><dd><p>the sample size of control group or reference site.</p>
</dd>
<dt><code>biomarker</code></dt><dd><p>individual biomarker.</p>
</dd> <dt><code>delta</code></dt><dd><p>the
Cliff's delta of treatment group or reference site.</p>
</dd>
<dt><code>delta.abs</code></dt><dd><p>the absolute Cliff's delta.</p>
</dd> <dt><code>pval</code></dt><dd><p>the
P-Value.</p>
</dd> <dt><code>sval</code></dt><dd><p>the surprisal or S-Value.</p>
</dd></dl>
</td></tr>
<tr><td><code>idx</code></td>
<td>
<p>a data frame summarizes <code>delta.abs</code> and their
average.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
mbr(temp$sam)
 #might take more than 5s in some machines

</code></pre>

<hr>
<h2 id='mbr.cliff'>Compute Cliff's delta simplified</h2><span id='topic+mbr.cliff'></span>

<h3>Description</h3>

<p><code>mbr.cliff</code> summarizes Cliff's delta for multiple groups and
multiple biomarkers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbr.cliff(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbr.cliff_+3A_df">df</code></td>
<td>
<p>a data frame with the name of experimental groups or biomonitoring
sites as the first column and the measurement of biomarkers as the
remaining columns.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
mbr.cliff(temp$sam)
 #might take more than 5s in some machines

</code></pre>

<hr>
<h2 id='mbr.glass'>Compute Glass's delta simplified</h2><span id='topic+mbr.glass'></span>

<h3>Description</h3>

<p><code>mbr.glass</code> summarizes Glass's delta for multiple groups and
multiple biomarkers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbr.glass(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbr.glass_+3A_df">df</code></td>
<td>
<p>a data frame with the name of experimental groups or biomonitoring
sites as the first column and the measurement of biomarkers as the
remaining columns.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
mbr.glass(temp$sam)
 #might take more than 5s in some machines

</code></pre>

<hr>
<h2 id='plotsam'>Visualize Hypothetical Samples</h2><span id='topic+plotsam'></span>

<h3>Description</h3>

<p><code>plotsam</code> plots the sample dataset of biomarker responses. This is used
for the hypothetical case study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotsam(pop_mean_long, pop_profile, sam_long)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotsam_+3A_pop_mean_long">pop_mean_long</code></td>
<td>
<p>a data frame, the second output of <code><a href="#topic+setpop">setpop</a></code>.</p>
</td></tr>
<tr><td><code id="plotsam_+3A_pop_profile">pop_profile</code></td>
<td>
<p>a data frame, the third output of <code><a href="#topic+setpop">setpop</a></code>.</p>
</td></tr>
<tr><td><code id="plotsam_+3A_sam_long">sam_long</code></td>
<td>
<p>a data frame, the second output of <code><a href="#topic+simul">simul</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>plotsam</code> returns a ggplot object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
plotsam(setting$pop_mean_long, setting$pop_profile, temp$sam_long)

</code></pre>

<hr>
<h2 id='resampling'>Measure Statistical Uncertainty</h2><span id='topic+resampling'></span>

<h3>Description</h3>

<p><code>resampling</code> performs randomization test to calculate P-value and
S-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resampling(v1, v0, nrand = 1999, seed = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="resampling_+3A_v1">v1</code></td>
<td>
<p>a vector, biomarker values from the treatment group.</p>
</td></tr>
<tr><td><code id="resampling_+3A_v0">v0</code></td>
<td>
<p>a vector, biomarker values from the control group.</p>
</td></tr>
<tr><td><code id="resampling_+3A_nrand">nrand</code></td>
<td>
<p>an integer, the number of randomization samples. The default
value is 1999.</p>
</td></tr>
<tr><td><code id="resampling_+3A_seed">seed</code></td>
<td>
<p>an integer, the seed for random number generation. Setting a seed
ensures the reproducibility of the result. See <code><a href="base.html#topic+set.seed">set.seed</a></code> for
more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>resampling</code> returns a one-row data frame with 3 numerics:
</p>
<table>
<tr><td><code>delta</code></td>
<td>
<p>the Cliff's delta of the treatment group.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>the observed P-value p under the null hypothesis.</p>
</td></tr>
<tr><td><code>sval</code></td>
<td>
<p>the S-value s calculated from P-value p.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Greenland, S. (2019). Valid P-Values Behave Exactly as They
Should: Some Misleading Criticisms of P-Values and Their Resolution With
S-Values. The American Statistician, 73(sup1), 106–114.
<a href="https://doi.org/10.1080/00031305.2018.1529625">doi:10.1080/00031305.2018.1529625</a>. <br /> <br /> Phipson, B., &amp; Smyth, G. K.
(2010). Permutation P-values Should Never Be Zero: Calculating Exact
P-values When Permutations Are Randomly Drawn. Statistical Applications in
Genetics and Molecular Biology, 9(1). <a href="https://doi.org/10.2202/1544-6115.1585">doi:10.2202/1544-6115.1585</a>.
</p>


<h3>See Also</h3>

<p><code><a href="RProbSup.html#topic+A1">A1</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
resampling(subset(temp$sam, Site == "S1", Bmk1, drop = TRUE),
subset(temp$sam, Site == "S0", Bmk1, drop = TRUE))

</code></pre>

<hr>
<h2 id='setpop'>Define Hypothetical Populations</h2><span id='topic+setpop'></span>

<h3>Description</h3>

<p><code>setpop</code> sets the true means of biomarker responses in populations. This
is used for the hypothetical case study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setpop()
</code></pre>


<h3>Value</h3>

<p><code>setpop</code> returns a list of length 3:
</p>
<table>
<tr><td><code>pop_mean</code></td>
<td>
<p>true means of biomarker responses in populations.</p>
</td></tr>
<tr><td><code>pop_mean_long</code></td>
<td>
<p>true means of biomarker responses in long format.</p>
</td></tr>
<tr><td><code>pop_profile</code></td>
<td>
<p>profile of biomarkers.</p>
</td></tr>
</table>

<hr>
<h2 id='simul'>Generate Hypothetical Samples</h2><span id='topic+simul'></span>

<h3>Description</h3>

<p><code>simul</code> yields a sample dataset of biomarker responses. This
is used for the hypothetical case study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simul(pop_mean, size = 75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simul_+3A_pop_mean">pop_mean</code></td>
<td>
<p>a data frame, the first output of <code>setpop</code>.</p>
</td></tr>
<tr><td><code id="simul_+3A_size">size</code></td>
<td>
<p>an integer, the sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>simul</code> returns a list of length 3:
</p>
<table>
<tr><td><code>sam</code></td>
<td>
<p>sample dataset.</p>
</td></tr>
<tr><td><code>sam_long</code></td>
<td>
<p>sample dataset in long format.</p>
</td></tr>
<tr><td><code>sam_mean</code></td>
<td>
<p>sample means of biomarker responses.</p>
</td></tr>
</table>

<hr>
<h2 id='visual'>Visualize Cliff's delta and S-value</h2><span id='topic+visual'></span>

<h3>Description</h3>

<p><code>visual</code> plots Cliff's delta and S-value for multiple groups and
multiple biomarkers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>visual(rs, rotate = FALSE, display = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="visual_+3A_rs">rs</code></td>
<td>
<p>a list, output of <code><a href="#topic+mbr">mbr</a></code>.</p>
</td></tr>
<tr><td><code id="visual_+3A_rotate">rotate</code></td>
<td>
<p>a logical, whether to rotate the biomarker labels in figures.</p>
</td></tr>
<tr><td><code id="visual_+3A_display">display</code></td>
<td>
<p>a logical, whether to display cell values in heatmaps.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>visual</code> returns a list of ggplot objects:
</p>
<table>
<tr><td><code>fig.delta</code></td>
<td>
<p>heatmap of Cliff's delta.</p>
</td></tr>
<tr><td><code>fig.sval</code></td>
<td>
<p>heatmap of S-value.</p>
</td></tr> <tr><td><code>fig.avg</code></td>
<td>
<p>dot plot
of the average of absolute Cliff’s delta.</p>
</td></tr> <tr><td><code>mbr_fig</code></td>
<td>
<p>combined
heatmaps of Cliff's delta and S-value.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1)
setting &lt;- setpop()
temp &lt;- simul(setting$pop_mean)
mbr_result &lt;- mbr(temp$sam)
visual(mbr_result)
 #might take more than 5s in some machines

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
