<!DOCTYPE html><html lang="en"><head><title>Help for package ref.ICAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ref.ICAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#probs.icar'><p>OLM and ICAR model probabilities for areal data</p></a></li>
<li><a href='#ref.analysis'><p>MCMC Analysis and Summaries for Reference Prior on an Intrinsic Autoregressive Model for Areal Data</p></a></li>
<li><a href='#ref.MCMC'><p>MCMC for Reference Prior on an Intrinsic Conditional Autoregressive Random Effects Model for Areal Data</p></a></li>
<li><a href='#ref.plot'><p>Trace Plots for Parameters in ICAR Model</p></a></li>
<li><a href='#ref.summary'><p>Parameter Summaries for MCMC Analysis</p></a></li>
<li><a href='#reg.summary'><p>Regional Summaries for Areal Data Modeled by ICAR Reference Prior Model</p></a></li>
<li><a href='#shape.H'><p>Creating a Neighborhood Matrix for Areal Data from a Shapefile</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Objective Bayes Intrinsic Conditional Autoregressive Model for
Areal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Erica M. Porter &lt;emporte@clemson.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements an objective Bayes intrinsic conditional autoregressive 
    prior. This model provides an objective Bayesian approach for modeling spatially 
    correlated areal data using an intrinsic conditional autoregressive prior on a vector of 
    spatial random effects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>sf, sp, spdep, mvtnorm, coda, MCMCglmm, Rdpack, graphics,
pracma, stats, classInt, dplyr, ggplot2, gtools</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>maps, MASS, knitr, rmarkdown, RColorBrewer, rcrossref,
spData, formatR</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BuildManual:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-22 14:50:57 UTC; emporte</td>
</tr>
<tr>
<td>Author:</td>
<td>Erica M. Porter [aut, cre],
  Matthew J. Keefe [aut],
  Christopher T. Franck [aut],
  Marco A.R. Ferreira [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-22 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='probs.icar'>OLM and ICAR model probabilities for areal data</h2><span id='topic+probs.icar'></span>

<h3>Description</h3>

<p>Performs simultaneous selection of covariates and spatial model structure for areal data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probs.icar(
  Y,
  X,
  H,
  H.spectral = NULL,
  Sig_phi = NULL,
  b = 0.05,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probs.icar_+3A_y">Y</code></td>
<td>
<p>A vector of responses.</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_x">X</code></td>
<td>
<p>A matrix of covariates, which should include a column of 1's for models with a non-zero intercept</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_h">H</code></td>
<td>
<p>Neighborhood matrix for spatial subregions.</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_h.spectral">H.spectral</code></td>
<td>
<p>Spectral decomposition of neighborhood matrix, if user wants to pre-compute it to save time.</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_sig_phi">Sig_phi</code></td>
<td>
<p>Pseudo inverse of the neighborhood matrix, if user wants to pre-compute it to save time.</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_b">b</code></td>
<td>
<p>Training fraction for the fractional Bayes factor (FBF) approach.</p>
</td></tr>
<tr><td><code id="probs.icar_+3A_verbose">verbose</code></td>
<td>
<p>If FALSE, marginal likelihood progress is not printed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a data frame with all posterior model probabilities and other selection information.
</p>
<table role = "presentation">
<tr><td><code>probs.mat</code></td>
<td>
<p>Data frame containing posterior model probabilities for all candidate OLMs and ICAR models from the data.</p>
</td></tr>
<tr><td><code>mod.prior</code></td>
<td>
<p>Vector of model priors used to obtain the posterior model probabilities.</p>
</td></tr>
<tr><td><code>logmargin.all</code></td>
<td>
<p>Vector of all (log) fractional integrated likelihoods.</p>
</td></tr>
<tr><td><code>base.model</code></td>
<td>
<p>Maximum (log) fractional integrated likelihood among all candidate models.  All fractional Bayes factors are obtained with respect to this model.</p>
</td></tr>
<tr><td><code>BF.vec</code></td>
<td>
<p>Vector of fractional Bayes factors for all candidate models.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>References</h3>

<p>Porter EM, Franck CT, Ferreira MAR (2024).
&ldquo;Objective Bayesian model selection for spatial hierarchical models with intrinsic conditional autoregressive priors.&rdquo;
<em>Bayesian Analysis</em>, <b>19</b>(4), 985&ndash;1011.
<a href="https://doi.org/10.1214/23-BA1375">doi:10.1214/23-BA1375</a>.
</p>

<hr>
<h2 id='ref.analysis'>MCMC Analysis and Summaries for Reference Prior on an Intrinsic Autoregressive Model for Areal Data</h2><span id='topic+ref.analysis'></span>

<h3>Description</h3>

<p>Performs analysis on a geographical areal data set using the objective prior
for intrinsic conditional autoregressive (ICAR) random effects
(Keefe et al. 2019).  It takes a shapefile, data, and region names to
construct a neighborhood matrix and perform Markov chain Monte Carlo sampling on the
unstructured and spatial random effects.  Finally, the function obtains regional estimates and
performs posterior inference on the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ref.analysis(
  shape.file,
  X,
  y,
  x.reg.names,
  y.reg.names,
  shp.reg.names = NULL,
  iters = 10000,
  burnin = 5000,
  verbose = TRUE,
  tauc.start = 1,
  beta.start = 1,
  sigma2.start = 1,
  step.tauc = 0.5,
  step.sigma2 = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ref.analysis_+3A_shape.file">shape.file</code></td>
<td>
<p>A shapefile corresponding to the regions for analysis.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_x">X</code></td>
<td>
<p>A matrix of covariates, which should include a column of 1's for models with a non-zero intercept</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_y">y</code></td>
<td>
<p>A vector of responses.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_x.reg.names">x.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in <code>X</code>.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_y.reg.names">y.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in <code>y</code>.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_shp.reg.names">shp.reg.names</code></td>
<td>
<p>A vector specifying the order of region names contained in the shapefile, if there is not a NAME column in the file.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_iters">iters</code></td>
<td>
<p>Number of MCMC iterations to perform.  Defaults to 10,000.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_burnin">burnin</code></td>
<td>
<p>Number of MCMC iterations to discard as burn-in.  Defaults to 5,000.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_verbose">verbose</code></td>
<td>
<p>If FALSE, MCMC progress is not printed.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_tauc.start">tauc.start</code></td>
<td>
<p>Starting MCMC value for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_beta.start">beta.start</code></td>
<td>
<p>Starting MCMC value for the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_sigma2.start">sigma2.start</code></td>
<td>
<p>Starting MCMC value for the variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_step.tauc">step.tauc</code></td>
<td>
<p>Step size for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code id="ref.analysis_+3A_step.sigma2">step.sigma2</code></td>
<td>
<p>Step size for the variance of the unstructured random effects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>H</code>, MCMC chains, parameter summaries, fitted regional values,
and regional summaries.
</p>
<table role = "presentation">
<tr><td><code>H</code></td>
<td>
<p>The neighborhood matrix.</p>
</td></tr>
<tr><td><code>MCMC</code></td>
<td>
<p>Matrix of MCMC chains for all model parameters.</p>
</td></tr>
<tr><td><code>beta.median</code></td>
<td>
<p>Posterior medians of the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code>beta.hpd</code></td>
<td>
<p>Highest Posterior Density intervals for the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code>tauc.median</code></td>
<td>
<p>Posterior median of the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>tauc.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>sigma2.median</code></td>
<td>
<p>Posterior median of the unstructured random effects variance.</p>
</td></tr>
<tr><td><code>sigma2.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the unstructured random effects variance.</p>
</td></tr>
<tr><td><code>tauc.accept</code></td>
<td>
<p>Final acceptance rate for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>sigma2.accept</code></td>
<td>
<p>Final acceptance rate for the unstructured random effects variance.</p>
</td></tr>
<tr><td><code>fit.dist</code></td>
<td>
<p>Matrix of fitted posterior values for each region in the data.</p>
</td></tr>
<tr><td><code>reg.medians</code></td>
<td>
<p>Vector of posterior medians for fitted response by region.</p>
</td></tr>
<tr><td><code>reg.hpd</code></td>
<td>
<p>Data frame of Highest Posterior Density intervals by region.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Refer to the vignette attached to the package.

</code></pre>

<hr>
<h2 id='ref.MCMC'>MCMC for Reference Prior on an Intrinsic Conditional Autoregressive Random Effects Model for Areal Data</h2><span id='topic+ref.MCMC'></span>

<h3>Description</h3>

<p>Implements the Metropolis-within-Gibbs sampling algorithm proposed by Ferreira et al. (2021),
to perform posterior inference for the intrinsic conditional autoregressive model with spatial
random effects.  This algorithm uses the spectral domain for the hierarchical model to create the
Spectral Gibbs Sampler (SGS), which provides notable speedups to the MCMC algorithm proposed by Keefe et al (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ref.MCMC(
  y,
  X,
  H,
  iters = 10000,
  burnin = 5000,
  verbose = TRUE,
  tauc.start = 1,
  beta.start = 1,
  sigma2.start = 1,
  step.tauc = 0.5,
  step.sigma2 = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ref.MCMC_+3A_y">y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_x">X</code></td>
<td>
<p>Matrix of covariates.  This should include a column of 1's for models with a non-zero intercept.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_h">H</code></td>
<td>
<p>The neighborhood matrix.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_iters">iters</code></td>
<td>
<p>Number of MCMC iterations to perform.  Defaults to 10,000.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_burnin">burnin</code></td>
<td>
<p>Number of MCMC iterations to discard as burn-in.  Defaults to 5,000.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_verbose">verbose</code></td>
<td>
<p>If FALSE, MCMC progress is not printed.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_tauc.start">tauc.start</code></td>
<td>
<p>Starting value for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_beta.start">beta.start</code></td>
<td>
<p>Starting value for the vector of fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_sigma2.start">sigma2.start</code></td>
<td>
<p>Starting value for the variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_step.tauc">step.tauc</code></td>
<td>
<p>Step size for the spatial dependence parameter</p>
</td></tr>
<tr><td><code id="ref.MCMC_+3A_step.sigma2">step.sigma2</code></td>
<td>
<p>Step size for the variance of the unstructured random effects.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing MCMC chains and parameter summaries.
</p>
<table role = "presentation">
<tr><td><code>MCMCchain</code></td>
<td>
<p>Matrix of MCMC chains.</p>
</td></tr>
<tr><td><code>tauc.MCMC</code></td>
<td>
<p>MCMC chains for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>sigma2.MCMC</code></td>
<td>
<p>MCMC chains for the variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code>phi.MCMC</code></td>
<td>
<p>MCMC chains for the spatial random effects.</p>
</td></tr>
<tr><td><code>beta.MCMC</code></td>
<td>
<p>MCMC chains for the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code>accept.sigma2</code></td>
<td>
<p>Final acceptance number for variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code>accept.tauc</code></td>
<td>
<p>Final acceptance number for spatial dependence parameter.</p>
</td></tr>
<tr><td><code>accept.phi</code></td>
<td>
<p>Final acceptance number for spatial random effects.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>References</h3>

<p>Keefe MJ, Ferreira MAR, Franck CT (2019).
&ldquo;Objective Bayesian analysis for Gaussian hierarchical models with intrinsic conditional autoregressive priors.&rdquo;
<em>Bayesian Analysis</em>, <b>14</b>(1), 181 &ndash; 209.
<a href="https://doi.org/10.1214/18-BA1107">doi:10.1214/18-BA1107</a>.
</p>
<p>Keefe MJ, Ferreira MAR, Franck CT (2018).
&ldquo;On the formal specification of sum-zero constrained intrinsic conditional autoregressive models.&rdquo;
<em>Spatial Statistics</em>, <b>24</b>, 54&ndash;65.
<a href="https://doi.org/10.1016/j.spasta.2018.03.007">doi:10.1016/j.spasta.2018.03.007</a>.
</p>
<p>Ferreira MAR, Porter EM, Franck CT (2021).
&ldquo;Fast and scalable computations for Gaussian hierarchical models with intrinsic conditional autoregressive spatial random effects.&rdquo;
<em>Computational Statistics and Data Analysis</em>, <b>162</b>, 107264.
ISSN 0167-9473, <a href="https://doi.org/10.1016/j.csda.2021.107264">doi:10.1016/j.csda.2021.107264</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Fit the model for simulated areal data on a grid ####

### Load extra libraries
library(sp)
library(methods)
library(spdep)
library(mvtnorm)

### Generate areal data on a grid
rows=5; cols=5
tauc=1
sigma2=2; beta=c(1,5)

### Create grid
grid &lt;- GridTopology(c(1,1), c(1,1), c(cols,rows))
polys &lt;- as(grid, "SpatialPolygons")
spgrid &lt;- SpatialPolygonsDataFrame(polys,data=data.frame(row.names=row.names(polys)))

### Create neighborhood matrix
grid.nb &lt;- poly2nb(spgrid,queen=FALSE)
W &lt;- nb2mat(grid.nb, style="B")

### Put spatially correlated data in grid
p &lt;- length(beta)
num.reg &lt;- (rows*cols)
if(p&gt;1){x1&lt;-rmvnorm(n=num.reg,mean=rep(0,p-1),sigma=diag(p-1))} else{x1&lt;-NULL}
X &lt;- cbind(rep(1,num.reg),x1)
Dmat &lt;- diag(apply(W,1,sum))
H &lt;- Dmat - W
row.names(H) &lt;- NULL

### Obtain true response vector
theta_true &lt;- rnorm(num.reg,mean=0,sd=sqrt(sigma2))
Q &lt;- eigen(H,symmetric=TRUE)$vectors
eigH &lt;- eigen(H,symmetric=TRUE)$values
D &lt;- diag(eigH)
Qmat &lt;- Q[,1:(num.reg-1)]
phimat &lt;- diag(1/sqrt(eigH[1:(num.reg-1)]))
z &lt;- t(rmvnorm(1,mean=rep(0,num.reg-1),sigma=diag(num.reg-1)))
phi_true &lt;- sqrt((1/tauc)*sigma2)*(Qmat%*%phimat%*%z)
Y &lt;- X%*%beta + theta_true + phi_true

### Fit the model
set.seed(5432)
model &lt;- ref.MCMC(y=Y,X=X,H=H,iters=15000,burnin=5000,verbose=TRUE,tauc.start=.1,beta.start=-1,
sigma2.start=.1,step.tauc=0.5,
      step.sigma2=0.5)
      

#### Small example for checking
model &lt;- ref.MCMC(y=Y,X=X,H=H,iters=1000,burnin=50,verbose=TRUE,tauc.start=.1,beta.start=-1,
sigma2.start=.1,step.tauc=0.5,
      step.sigma2=0.5)
</code></pre>

<hr>
<h2 id='ref.plot'>Trace Plots for Parameters in ICAR Model</h2><span id='topic+ref.plot'></span>

<h3>Description</h3>

<p>This function creates trace plots for the parameters in
the ICAR reference prior model (Keefe et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ref.plot(MCMCchain, X, burnin, num.reg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ref.plot_+3A_mcmcchain">MCMCchain</code></td>
<td>
<p>Matrix of MCMC chains for the model parameters.</p>
</td></tr>
<tr><td><code id="ref.plot_+3A_x">X</code></td>
<td>
<p>Matrix of covariates.</p>
</td></tr>
<tr><td><code id="ref.plot_+3A_burnin">burnin</code></td>
<td>
<p>Number of MCMC iterations from <code>MCMCchain</code> discarded as burn-in.</p>
</td></tr>
<tr><td><code id="ref.plot_+3A_num.reg">num.reg</code></td>
<td>
<p>Number of regions in the areal data set.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Trace plots for the fixed effect regression coefficients, the precision parameter,
and the unstructured random effects variance.
</p>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Refer to the vignette attached to the package.
</code></pre>

<hr>
<h2 id='ref.summary'>Parameter Summaries for MCMC Analysis</h2><span id='topic+ref.summary'></span>

<h3>Description</h3>

<p>Takes a matrix of MCMC chains, iterations, and acceptance values
to return posterior summaries of the parameters, including posterior medians, intervals,
and acceptance rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ref.summary(
  MCMCchain,
  tauc.MCMC,
  sigma2.MCMC,
  beta.MCMC,
  phi.MCMC,
  accept.phi,
  accept.sigma2,
  accept.tauc,
  iters = 10000,
  burnin = 5000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ref.summary_+3A_mcmcchain">MCMCchain</code></td>
<td>
<p>Matrix of MCMC chains for the ICAR model parameters.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_tauc.mcmc">tauc.MCMC</code></td>
<td>
<p>MCMC chains for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_sigma2.mcmc">sigma2.MCMC</code></td>
<td>
<p>MCMC chains for the variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_beta.mcmc">beta.MCMC</code></td>
<td>
<p>MCMC chains for the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_phi.mcmc">phi.MCMC</code></td>
<td>
<p>MCMC chains for the spatial random effects.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_accept.phi">accept.phi</code></td>
<td>
<p>Final acceptance number for spatial random effects.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_accept.sigma2">accept.sigma2</code></td>
<td>
<p>Final acceptance number for variance of the unstructured random effects.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_accept.tauc">accept.tauc</code></td>
<td>
<p>Final acceptance number for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_iters">iters</code></td>
<td>
<p>Number of MCMC iterations in <code>MCMCchain</code>.</p>
</td></tr>
<tr><td><code id="ref.summary_+3A_burnin">burnin</code></td>
<td>
<p>Number of MCMC iterations discarded as burn-in for <code>MCMCchain</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Parameter summaries
</p>
<table role = "presentation">
<tr><td><code>beta.median</code></td>
<td>
<p>Posterior medians of the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code>beta.hpd</code></td>
<td>
<p>Highest Posterior Density intervals for the fixed effect regression coefficients.</p>
</td></tr>
<tr><td><code>tauc.median</code></td>
<td>
<p>Posterior median of the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>tauc.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>sigma2.median</code></td>
<td>
<p>Posterior median of the unstructured random effects variance.</p>
</td></tr>
<tr><td><code>sigma2.hpd</code></td>
<td>
<p>Highest Posterior Density interval for the unstructured random effects variance.</p>
</td></tr>
<tr><td><code>tauc.accept</code></td>
<td>
<p>Final acceptance rate for the spatial dependence parameter.</p>
</td></tr>
<tr><td><code>sigma2.accept</code></td>
<td>
<p>Final acceptance rate for the unstructured random effects variance.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Refer to the vignette attached to the package.
</code></pre>

<hr>
<h2 id='reg.summary'>Regional Summaries for Areal Data Modeled by ICAR Reference Prior Model</h2><span id='topic+reg.summary'></span>

<h3>Description</h3>

<p>This function takes data and sampled MCMC chains for an areal data set
and gives fitted posterior values and summaries by region using the model by (Keefe et al. 2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.summary(MCMCchain, X, Y, burnin)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reg.summary_+3A_mcmcchain">MCMCchain</code></td>
<td>
<p>Matrix of MCMC chains, using the sampling from (Keefe et al. 2019).</p>
</td></tr>
<tr><td><code id="reg.summary_+3A_x">X</code></td>
<td>
<p>Matrix of covariates.</p>
</td></tr>
<tr><td><code id="reg.summary_+3A_y">Y</code></td>
<td>
<p>Vector of responses.</p>
</td></tr>
<tr><td><code id="reg.summary_+3A_burnin">burnin</code></td>
<td>
<p>Number of MCMC iterations discarded as burn-in in <code>MCMCchain</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the fitted distributions by region, and medians and credible intervals by region.
</p>
<table role = "presentation">
<tr><td><code>fit.dist</code></td>
<td>
<p>Matrix of fitted posterior values for each region in the data.</p>
</td></tr>
<tr><td><code>reg.medians</code></td>
<td>
<p>Vector of posterior medians for fitted response by region.</p>
</td></tr>
<tr><td><code>reg.cred</code></td>
<td>
<p>Data frame of credbile intervals by region.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Refer to the vignette attached to the package.
</code></pre>

<hr>
<h2 id='shape.H'>Creating a Neighborhood Matrix for Areal Data from a Shapefile</h2><span id='topic+shape.H'></span>

<h3>Description</h3>

<p>Takes a path to a shape file and creates a neighborhood matrix.  This neighborhood
matrix can be used with the objective ICAR model (Keefe et al. 2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shape.H(shape.file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="shape.H_+3A_shape.file">shape.file</code></td>
<td>
<p>File path to a shapefile.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a neighborhood matrix and the SpatialPolygonsDataFrame object
corresponding to the shape file.
</p>
<table role = "presentation">
<tr><td><code>H</code></td>
<td>
<p>A neighborhood matrix.</p>
</td></tr>
<tr><td><code>map</code></td>
<td>
<p>SpatialPolygonsDataFrame object from the provided shapefile.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Erica M. Porter, Matthew J. Keefe, Christopher T. Franck, and Marco A.R. Ferreira
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### Load extra libraries
library(sp)
library(sf)

### Read in a shapefile of the contiguous U.S. from package data
system.path &lt;- system.file("extdata", "us.shape48.shp", package = "ref.ICAR", mustWork = TRUE)
shp.layer &lt;- gsub('.shp','',basename(system.path))
shp.path &lt;- dirname(system.path)
us.shape48 &lt;- st_read(dsn = path.expand(shp.path), layer = shp.layer)

shp.data &lt;- shape.H(system.path)
names(shp.data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
