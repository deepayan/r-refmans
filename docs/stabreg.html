<!DOCTYPE html><html><head><title>Help for package stabreg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stabreg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.stabreg'><p>AIC.stabreg</p></a></li>
<li><a href='#predict.stabreg'><p>predict.stabreg</p></a></li>
<li><a href='#print.stabreg'><p>print.stabreg</p></a></li>
<li><a href='#stable_glm'><p>Generalized linear-model fitting with Stable residuals</p></a></li>
<li><a href='#stable_lm'><p>Linear-model fitting with Stable residuals</p></a></li>
<li><a href='#stable_mle_fit'><p>Fit a stable distribution to a sample using maximum likelihood</p></a></li>
<li><a href='#stable_pdf'><p>Compute values of a (normalized) stable density</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Linear Regression with the Stable Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Oleg Kopylov &lt;okopy@protonmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficient regression for heavy-tailed and skewed data following a stable distribution. Generalized regression where the skewness and tail parameter of residuals are dependent on regressors is also available. Includes fast calculation of stable densities. Calculation of densities is based on efficient numerical methods from Ament and O'Neil (2017) &lt;<a href="https://doi.org/10.1007%2Fs11222-017-9725-y">doi:10.1007/s11222-017-9725-y</a>&gt;. Parts of the code have been ported to C from Ament's 'Matlab' code available at <a href="https://gitlab.com/s_ament/qastable">https://gitlab.com/s_ament/qastable</a>.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-06-05 17:21:06 UTC; oleg</td>
</tr>
<tr>
<td>Author:</td>
<td>Oleg Kopylov [aut, cre],
  Sebastian Ament [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-06-06 14:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.stabreg'>AIC.stabreg</h2><span id='topic+AIC.stabreg'></span>

<h3>Description</h3>

<p>Akaike's Information Criterion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stabreg'
AIC(object, ..., k = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.stabreg_+3A_object">object</code></td>
<td>
<p>a stabreg object</p>
</td></tr>
<tr><td><code id="AIC.stabreg_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
<tr><td><code id="AIC.stabreg_+3A_k">k</code></td>
<td>
<p>AIC penalty</p>
</td></tr>
</table>

<hr>
<h2 id='predict.stabreg'>predict.stabreg</h2><span id='topic+predict.stabreg'></span>

<h3>Description</h3>

<p>Calculate predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stabreg'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.stabreg_+3A_object">object</code></td>
<td>
<p>a stabreg object</p>
</td></tr>
<tr><td><code id="predict.stabreg_+3A_...">...</code></td>
<td>
<p>passed to model.matrix</p>
</td></tr>
</table>

<hr>
<h2 id='print.stabreg'>print.stabreg</h2><span id='topic+print.stabreg'></span>

<h3>Description</h3>

<p>print method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stabreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.stabreg_+3A_x">x</code></td>
<td>
<p>a stabreg object</p>
</td></tr>
<tr><td><code id="print.stabreg_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>

<hr>
<h2 id='stable_glm'>Generalized linear-model fitting with Stable residuals</h2><span id='topic+stable_glm'></span>

<h3>Description</h3>

<p>Fitting of a generalized linear model with stable residuals. Allows for regression formulas for all 4 parameters of the stable distribution. NAs not allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stable_glm(y_name, formulas, data, output_se, calc_confbounds, conf, trace, optim_control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stable_glm_+3A_y_name">y_name</code></td>
<td>
<p>character string denoting column name in input data, containing dependent variable</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_formulas">formulas</code></td>
<td>
<p>list for formulas for the regression. See Details</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_data">data</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_output_se">output_se</code></td>
<td>
<p>logical - whether to calculate standard errors (will entail calculation and inversion of final Hessian)</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_calc_confbounds">calc_confbounds</code></td>
<td>
<p>logical - whether to calculate exact confidence bounds. See Details</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_conf">conf</code></td>
<td>
<p>confidence level for confidence bounds. Default 0.95</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_trace">trace</code></td>
<td>
<p>trace level</p>
</td></tr>
<tr><td><code id="stable_glm_+3A_optim_control">optim_control</code></td>
<td>
<p>list passed to <code>nlminb</code>'s control argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lowest possible estimate for alpha is 1.1.
</p>
<p>The <code>formulas</code> argument is a list of formulas, where each name in the list is either &quot;loc&quot;, &quot;scale&quot;, &quot;beta&quot;, or &quot;alpha&quot;. For each of these, a formula is supplied without any dependent variable. E.g. in a regression for the alpha parameter the <code>formulas</code> list will look like <code> formulas = list( alpha = formula(~ x1 + x2) ) </code>
</p>
<p>By default, <code>output_se = TRUE</code>, which will calculate standard errors and approximate confidence bounds. These will be approximate in the sense that the likelihood will typically not be symmetric, and thus these confidence bounds will only provide an indicative measure of confidence. To calculate exact confidence bounds use <code>calc_confbounds = TRUE</code>. However, exact confidence bounds calculation is very time consuming as this requires repeated computation of profile likelihoods for each regression variable. If N is the number of regressors in the model, then the expected time to compute all confidence bounds is about 200N times the time it takes to just fit the model. Currently, confidence bounds are calculated only for the regressors and not the parameters of the distribution of the residuals (i.e. alpha, beta, and scale).
</p>
<p>Note that standard errors and t-scores for alpha, beta, and scale parameters are calculated in transformed space and cannot be interpreted as-is. All confidence bounds (both approximate and exact), however, are transformed back to the original space and can be interpreted as-is.
</p>
<p>In the case that alpha is estimated to be numerically equal to 2, beta is automatically set to 0. In this boundary case calculation of standard errors will fail and return the default maximum range for alpha, i.e. 1.1 to 2. This should be interpreted as the residuals having a Normal distribution, in which case OLS regression would be preferable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate some data: y = 4x - 1 + epsilon
# where epsilon is heavy-tailed student-t with 5 df
set.seed(123)
df &lt;- data.frame(x = rnorm(500))
df$y &lt;- 4 * df$x - 1 + rt(500, df = 5)

# regress both location and skew:
formulas &lt;- list(
    "loc" = formula( ~ x),
    "beta" = formula( ~ x)
)

sfit &lt;- stable_glm("y", formulas, data = df)
print(sfit)
</code></pre>

<hr>
<h2 id='stable_lm'>Linear-model fitting with Stable residuals</h2><span id='topic+stable_lm'></span>

<h3>Description</h3>

<p>Fitting of a linear model with stable residuals. Regresses only location of the distribution. NAs not allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stable_lm(formula, data, trace, output_se, calc_confbounds, conf, optim_control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stable_lm_+3A_formula">formula</code></td>
<td>
<p>regression formula for location</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_data">data</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_trace">trace</code></td>
<td>
<p>trace level</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_output_se">output_se</code></td>
<td>
<p>logical - whether to calculate standard errors (will entail calculation and inversion of final Hessian)</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_calc_confbounds">calc_confbounds</code></td>
<td>
<p>logical - whether to calculate exact confidence bounds. See Details</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_conf">conf</code></td>
<td>
<p>confidence level for confidence bounds. Default 0.95</p>
</td></tr>
<tr><td><code id="stable_lm_+3A_optim_control">optim_control</code></td>
<td>
<p>list passed to <code>nlminb</code>'s control argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lowest possible estimate for alpha is 1.1.
</p>
<p>By default, <code>output_se = TRUE</code>, which will calculate standard errors and approximate confidence bounds. These will be approximate in the sense that the likelihood will typically not be symmetric, and thus these confidence bounds will only provide an indicative measure of confidence. To calculate exact confidence bounds use <code>calc_confbounds = TRUE</code>. However, exact confidence bounds calculation is very time consuming as this requires repeated computation of profile likelihoods for each regression variable. If N is the number of regressors in the model, then the expected time to compute all confidence bounds is about 200N times the time it takes to just fit the model. Currently, confidence bounds are calculated only for the regressors and not the parameters of the distribution of the residuals (i.e. alpha, beta, and scale).
</p>
<p>Note that standard errors and t-scores for alpha, beta, and scale parameters are calculated in transformed space and cannot be interpreted as-is. All confidence bounds (both approximate and exact), however, are transformed back to the original space and can be interpreted as-is.
</p>
<p>In the case that alpha is estimated to be numerically equal to 2, beta is automatically set to 0. In this boundary case calculation of standard errors will fail and return the default maximum range for alpha, i.e. 1.1 to 2. This should be interpreted as the residuals having a Normal distribution, in which case OLS regression would be preferable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate some data: y = 4x - 1 + epsilon
# where epsilon is heavy-tailed student-t with 5 df
set.seed(123)
df &lt;- data.frame(x = rnorm(1000))
df$y &lt;- 4 * df$x - 1 + rt(1000, df = 5)

sfit &lt;- stable_lm(y ~ x, data = df)
print(sfit)
</code></pre>

<hr>
<h2 id='stable_mle_fit'>Fit a stable distribution to a sample using maximum likelihood</h2><span id='topic+stable_mle_fit'></span>

<h3>Description</h3>

<p>Fit a stable distribution to a sample using maximum likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stable_mle_fit(x, init_vals, trace)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stable_mle_fit_+3A_x">x</code></td>
<td>
<p>sample vector</p>
</td></tr>
<tr><td><code id="stable_mle_fit_+3A_init_vals">init_vals</code></td>
<td>
<p>initial guess for parameters. Defaults to NULL in which case these are set to defaults</p>
</td></tr>
<tr><td><code id="stable_mle_fit_+3A_trace">trace</code></td>
<td>
<p>trace level</p>
</td></tr>
</table>

<hr>
<h2 id='stable_pdf'>Compute values of a (normalized) stable density</h2><span id='topic+stable_pdf'></span>

<h3>Description</h3>

<p>Compute stable pdf values. Admissible range for beta is -1 to 1. If <code>b</code> is not 0, admissible values of alpha are <code>0.5 &lt; a &lt; 0.9</code> and <code>1.1 &lt; a &lt;= 2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stable_pdf(x, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stable_pdf_+3A_x">x</code></td>
<td>
<p>values at which to evaluate the density</p>
</td></tr>
<tr><td><code id="stable_pdf_+3A_a">a</code></td>
<td>
<p>alpha value. Either a scalar or vector of length equal to <code>x</code> if different values for each observations are assumed</p>
</td></tr>
<tr><td><code id="stable_pdf_+3A_b">b</code></td>
<td>
<p>beta value. Either a scalar or vector of length equal to <code>x</code> if different values for each observations are assumed</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
