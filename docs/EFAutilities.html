<!DOCTYPE html><html lang="en"><head><title>Help for package EFAutilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EFAutilities}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Align.Matrix'><p>Factor Alignment</p></a></li>
<li><a href='#BFI228'><p>Ordinal Data of the Big Five Inventory (BFI)</p></a></li>
<li><a href='#CPAI537'><p>Composite Scores of the Chinese Personality Assessment Inventory (CPAI)</p></a></li>
<li><a href='#efa'><p>Exploratory Factor Analysis</p></a></li>
<li><a href='#efaMR'><p>Exploratory Factor Analysis with Multiple Rotations</p></a></li>
<li><a href='#ssem'><p>Simplifying Factor Strcutral Paths by Factor Rotation: Saturated Structural Equation Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Utility Functions for Exploratory Factor Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Guangjian Zhang, Ge Jiang, Minami Hattori, Lauren Trichtinger</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guangjian Zhang &lt;gzhang3@nd.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Description:</td>
<td>A number of utility function for exploratory factor analysis are included in this package. In particular, it computes standard errors for parameter estimates and factor correlations under a variety of conditions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>GPArotation, plyr, graphics, stats, utils, MASS, mvtnorm</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-26 15:53:54 UTC; gzhang3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-26 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Align.Matrix'>Factor Alignment</h2><span id='topic+Align.Matrix'></span>

<h3>Description</h3>

<p>The function is to align a factor solution according to an order matrix.  The output matrix is a (p+m+1) by m matrix, where the first p rows are factor loadings of the best match, the next m rows are factor correlations of the best match, and the last row contains the sums of squared deviations for the best match and the second best match. The difference between the best match and the second best match could be considered as a confidence on the success of the aligning procedure (a computationally more efficient method exists for some conditions; whenever this occurs we only report that of the best match).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Align.Matrix(Order.Matrix, Input.Matrix, Weight.Matrix=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Align.Matrix_+3A_order.matrix">Order.Matrix</code></td>
<td>
<p>A p by m matrix: p is the number of manifest variables and m is the number of latent factors</p>
</td></tr>
<tr><td><code id="Align.Matrix_+3A_input.matrix">Input.Matrix</code></td>
<td>
<p>A (p+m) by m matrix, the first p rows are factor loadings, the last m rows are factor correlations</p>
</td></tr>
<tr><td><code id="Align.Matrix_+3A_weight.matrix">Weight.Matrix</code></td>
<td>
<p>A p by m matrix that assigns weight to the order matrix: NULL (default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Align.Matrix is an R function to reflect and interchange columns of Input.Matrix to match those of Order.Matrix. Because it considers all possible permutations of columns of Input.Matrix,the best match in terms of the smallest sum of squared deviations between these two matrices can always be found. It may be slow if there are too many factors. 
</p>


<h3>Author(s)</h3>

<p>Guangjian Zhang</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Order Matrix
A &lt;- matrix(c(0.8,0.7,0,0,0,0,0.8,0.7),nrow=4,ncol=2)

#Input.Matrix
B &lt;-matrix(c(0,0,-0.8,-0.7,1,-0.2,0.8,0.7,0,0,-0.2,1),nrow=6,ncol=2)

Align.Matrix(Order.Matrix=A, Input.Matrix=B)

</code></pre>

<hr>
<h2 id='BFI228'>Ordinal Data of the Big Five Inventory (BFI)
</h2><span id='topic+BFI228'></span>

<h3>Description</h3>

<p>The BFI228 is part of the study on personality and relationship satisfaction (Luo, 2005).  The participants were 228 undergraduate students at a large public university in the US.  The data were participants' self ratings on the 44 items of the Big Five Inventory (John, Donahue, &amp; Kentle, 1991). These items are Likert variables: disagree strongly (1), disagree a little (2), neither agree nor disagree (3), agree a little (4), and agree strongly (5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BFI228)</code></pre>


<h3>Format</h3>

<p>The format is a n by p matrix of ordinal variables, where n is the number of participants (228) and p is the number of manifest variables (44).
</p>


<h3>Details</h3>

<p>The variables were ordered such that indicators of the same factor are grouped together. Note that  reverse-coded items are denoted by '_R'.
</p>
<p>V01 to V08 are variables for the factor extraversion: talkative, reserved_R, fullenergy, enthusiastic, quiet_R, assertive, shy_R, and outgoing.
</p>
<p>V09 to V17 are variables for the factor agreeableness: findfault_R, helpful, quarrels_R, forgiving, trusting, cold_R, considerate, rude_R, and cooperative.
</p>
<p>V18 to V26 are variables for the factor conscientiousness are: thorough, careless_R, reliable, disorganized_R, lazy_R, persevere, efficient, plans, and distracted_R.
</p>
<p>V27 to V34 are variables for the factor neuroticism: blue, relaxed_R, tense, worries, emostable_R, moody, calm_R, and nervous.
</p>
<p>V35 to V44 are variables for the factor openness: ideas, curious, ingenious, imagination, inventive, artistic, routine_R, reflect, nonartistic, and sophisticated.
</p>


<h3>References</h3>

<p>John, O. P., Donahue, E. M., &amp; Kentle, R. L. (1991). The Big Five Inventory  versions 4a and 54. Berkeley, CA: University of California,Berkeley, Institute of Personality and Social Research.
</p>
<p>Luo, S. (2005): unpublished study on personality traits and relationship satisfaction.
</p>


<hr>
<h2 id='CPAI537'>Composite Scores of the Chinese Personality Assessment Inventory (CPAI)
</h2><span id='topic+CPAI537'></span>

<h3>Description</h3>

<p>CPAI537 is part of a big survey study on martial satisfaction (Luo et al., 2008). The participants were 537 urban Chinese couples in the first year of their marriage. Included here are 28 composite scores of the CPAI (Cheung et al., 1996) for the 537 wives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(CPAI537)</code></pre>


<h3>Format</h3>

<p>The format is a n by p matrix, where n is the number of participants (537) and p is the number of manifest variables (28).
</p>


<h3>Details</h3>

<p>The column names stand for the following variable names:<br />
Nov - Novelty<br />
Div - Diversity<br />
Dit - Diverse thinking<br />
LEA - Leadership<br />
L_A - Logical orientation vs affective orientation<br />
AES - Aesthetics<br />
E_I - Extroversion-Introversion<br />
ENT - Enterprise<br />
RES - Responsibility<br />
EMO - Emotionality<br />
I_S - Inferiority vs. self-acceptance<br />
PRA - Practical mindedness<br />
O_P - Optimistic vs. pessimistic<br />
MET - Meticulousness<br />
FAC - Face<br />
I_E - Internal control vs. external control<br />
FAM - Family orientation<br />
DEF - Defensiveness<br />
G_M - Graciousness vs. meanness<br />
INT - Interpersonal tolerance<br />
S_S - Self orientation vs. social orientation<br />
V_S - Veraciousness vs. slickness<br />
T_M - Traditionalism vs. modernity<br />
REN - Relationship orientation<br />
SOC - Social sensitivity<br />
DIS - Discipline<br />
HAR - Harmony<br />
T_E - Thrift vs. extravagance<br />
</p>


<h3>References</h3>

<p>Cheung, F. M., Leung, K., Fan, R., Song, W., Zhang, J., &amp; Zhang, J. (1996). Development of the Chinese Personality Assessment Inventory (CPAI). Journal of Cross-Cultural Psychology, 27 ,181-199.
</p>
<p>Luo, S., Chen, H., Yue, G., Zhang, G., Zhaoyang, R., &amp; Xu, D. (2008). Predicting marital satisfaction from self, partner, and couple characteristics: Is it me, you, or us? Journal of Personality, 76 ,1231-1266.
</p>

<hr>
<h2 id='efa'>Exploratory Factor Analysis</h2><span id='topic+efa'></span>

<h3>Description</h3>

<p>Performs exploratory factor analysis under a variety of conditions. In particular, it provides standard errors for rotated factor loadings and factor correlations for normal variables, nonnormal continuous variables, and Likert scale variables with and without model error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efa(x=NULL, factors=NULL, covmat=NULL, acm=NULL, n.obs=NULL, dist='normal',
fm='ols', mtest = TRUE, rtype='oblique', rotation='CF-varimax', normalize=FALSE,
maxit=1000, geomin.delta=NULL, MTarget=NULL, MWeight=NULL,PhiWeight = NULL,
PhiTarget = NULL, useorder=FALSE, se='sandwich', LConfid=c(0.95,0.90),
CItype='pse', Ib=2000, mnames=NULL, fnames=NULL, merror='YES', wxt2 = 1e0,
I.cr=NULL, PowerParam = c(0.05,0.3))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="efa_+3A_x">x</code></td>
<td>
<p>The raw data: an n-by-p matrix where n is number of participants and p is the number of manifest variables.</p>
</td></tr>
<tr><td><code id="efa_+3A_factors">factors</code></td>
<td>
<p>The number of factors m: specified by the researcher; the default one is the Kaiser rule which is the number of eigenvalues of covmat larger than one.</p>
</td></tr>
<tr><td><code id="efa_+3A_covmat">covmat</code></td>
<td>
<p>A p-by-p manifest variable correlation matrix.</p>
</td></tr>
<tr><td><code id="efa_+3A_acm">acm</code></td>
<td>
<p>A p(p-1)/2 by p(p-1)/2 asymptotic covariance matrix of correlations: specified by the researcher.  </p>
</td></tr>
<tr><td><code id="efa_+3A_n.obs">n.obs</code></td>
<td>
<p>The number of participants used in calculating the correlation matrix. This is not required when the raw data (x) is provided.</p>
</td></tr>
<tr><td><code id="efa_+3A_dist">dist</code></td>
<td>
<p>Manifest variable distributions: 'normal'(default), 'continuous', 'ordinal' and 'ts'. 'normal' stands for normal distribution.
'continuous' stands for nonnormal continuous distributions.  'ordinal' stands for Likert scale variable.
'ts' stands for distributions for time-series data.</p>
</td></tr>
<tr><td><code id="efa_+3A_fm">fm</code></td>
<td>
<p>Factor extraction methods: 'ols' (default) and 'ml'</p>
</td></tr>
<tr><td><code id="efa_+3A_mtest">mtest</code></td>
<td>
<p>Whether the test statistic is computed: TRUE (default) and FALSE</p>
</td></tr>
<tr><td><code id="efa_+3A_rtype">rtype</code></td>
<td>
<p>Factor rotation types: 'oblique' (default) and 'orthogonal'. Factors are correlated in 'oblique' rotation, and they are uncorrelated in 'orthogonal' rotation.</p>
</td></tr>
<tr><td><code id="efa_+3A_rotation">rotation</code></td>
<td>
<p> Factor rotation criteria: 'CF-varimax' (default), 'CF-quartimax', 'CF-equamax', 'CF-facparsim', 'CF-parsimax','target', and 'geomin'. These rotation criteria can be used in both orthogonal and oblique rotation. In addition, a fifth rotation criterion 'xtarget'(extended target) rotation is available for oblique rotation. The extended target rotation allows targets to be specified on both factor loadings and factor correlations.</p>
</td></tr>
<tr><td><code id="efa_+3A_normalize">normalize</code></td>
<td>
<p>Row standardization in factor rotation: FALSE (default) and TRUE (Kaiser standardization).</p>
</td></tr>
<tr><td><code id="efa_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in factor rotation: 1000 (default)</p>
</td></tr>
<tr><td><code id="efa_+3A_geomin.delta">geomin.delta</code></td>
<td>
<p>The controlling parameter in Geomin rotation, 0.01 as the default value.</p>
</td></tr>
<tr><td><code id="efa_+3A_mtarget">MTarget</code></td>
<td>
<p>The p-by-m target matrix for the factor loading matrix in target rotation and xtarget rotation.</p>
</td></tr>
<tr><td><code id="efa_+3A_mweight">MWeight</code></td>
<td>
<p>The p-by-m weight matrix for the factor loading matrix in target rotation and xtarget rotation. Optional</p>
</td></tr>
<tr><td><code id="efa_+3A_phiweight">PhiWeight</code></td>
<td>
<p>The m-by-m target matrix for the factor correlation matrix in xtarget rotation. Optional</p>
</td></tr>
<tr><td><code id="efa_+3A_phitarget">PhiTarget</code></td>
<td>
<p>The m-by-m weight matrix for the factor correlation matrix in xtarget rotation</p>
</td></tr>
<tr><td><code id="efa_+3A_useorder">useorder</code></td>
<td>
<p>Whether an order matrix is used for factor alignment: FALSE (default) and TRUE</p>
</td></tr>
<tr><td><code id="efa_+3A_se">se</code></td>
<td>
<p>Methods for estimating standard errors for rotated factor loadings and factor correlations, 'information', 'sandwich', 'bootstrap', and 'jackknife'. For normal variables and ml estimation, the default method is 'information'. For all other situations, the default method is 'sandwich'. In addition, the 'bootstrap' and 'jackknife' methods require raw data.</p>
</td></tr>
<tr><td><code id="efa_+3A_lconfid">LConfid</code></td>
<td>
<p>Confidence levels for model parameters (factor loadings and factor correlations) and RMSEA, respectively: c(.95, .90) as default.</p>
</td></tr>
<tr><td><code id="efa_+3A_citype">CItype</code></td>
<td>
<p>Type of confidence intervals: 'pse' (default) or 'percentile'. CIs with 'pse' are based on point and standard error estimates; CIs with 'percentile' are based on bootstrap percentiles.</p>
</td></tr>
<tr><td><code id="efa_+3A_ib">Ib</code></td>
<td>
<p>The number of bootstrap samples when se='bootstrap': 2000 (default)</p>
</td></tr>
<tr><td><code id="efa_+3A_mnames">mnames</code></td>
<td>
<p>Names of p manifest variables: Null (default)</p>
</td></tr>
<tr><td><code id="efa_+3A_fnames">fnames</code></td>
<td>
<p>Names of m factors: Null (default)</p>
</td></tr>
<tr><td><code id="efa_+3A_merror">merror</code></td>
<td>
<p> Model error: 'YES' (default) or 'NO'. In general, we expect our model is a parsimonious representation to the complex real world. Thus, some amount of model error is unavailable. When merror = 'NO', the efa model is assumed to fit perfectly in the population.</p>
</td></tr>
<tr><td><code id="efa_+3A_wxt2">wxt2</code></td>
<td>
<p>The relative weight for factor correlations in 'xtarget' (extended target) rotation: 1 (default)</p>
</td></tr>
<tr><td><code id="efa_+3A_i.cr">I.cr</code></td>
<td>
<p>a n.cr-by-2 matrix for specifying correlated residuals: each row corresponds to such a residual, the two columns specify the row and the column of the residual.</p>
</td></tr>
<tr><td><code id="efa_+3A_powerparam">PowerParam</code></td>
<td>
<p>Power analysis related parameters: (0.05, 0.30) as default. The alpha level of the tests is 0.05, and a salient loading is at least 0.30.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+efa">efa</a></code> conducts exploratory factor analysis (EFA) (Gorsuch, 1983) in a variety of conditions. Data can be normal variables, non-normal continuous variables, and Likert variables. Our implementation of EFA includes three major steps: factor extraction, factor rotation, and estimating standard errors for rotated factor loadings and factor correlations.
</p>
<p>Factors can be extracted using two methods: maximum likelihood estimation (ml) and ordinary least squares (ols). These factor loading matrices are referred to as unrotated factor loading matrices. The ml unrotated factor loading matrix is obtained using <code><a href="stats.html#topic+factanal">factanal</a></code>. The ols unrotated factor loading matrix is obtained using <code><a href="stats.html#topic+optim">optim</a></code> where the residual sum of squares is minimized. The starting values for communalities are squared multiple correlations (SMCs). The test statistic and model fit measures are provided.
</p>
<p>Seven rotation criteria (CF-varimax, CF-quartimax, 'CF-equamax', 'CF-facparsim', 'CF-parsimax',geomin, and target) are available for both orthogonal rotation and oblique rotation (Browne, 2001). Additionally, a new rotation criteria, xtarget, can be specified for oblique rotation. The factor rotation methods are achieved by calling functions in the package GPArotation. CF-varimax, CF-quartimax, CF-equamax, CF-facparsim, and CF-parsimax are members of the Crawford-Fugersion family (Crawford, &amp; Ferguson, 1970) whose kappa is 1/p, 0, m/2p, 1, and (m-1)/(p+m-2) respectively where p is the number of manifest variables and m is the number of factors.  CF-varimax and CF-quartimax are equivalent to varimax and quartimax rotation in orthogonal rotation. The equivalence does not carry over to oblique rotation, however. Although varimax and quartimax often fail to give satisfactory results in oblique rotation, CF-varimax and CF-quartimax do give satisfactory results in many oblique rotation applications. CF-quartimax rotation is equivalent to direct oblimin rotation for oblique rotation. The target matrix in target rotation can either be a fully specified matrix or a partially specified matrix. Target rotation can be considered as a procedure which is located between EFA and CFA. In CFA, if a factor loading is specified to be zero, its value is fixed to be zero; if target rotation, if a factor loading is specified to be zero, it is made to zero as close as possible. In xtarget rotation, target values can be specified on both factor loadings and factor correlations.
</p>
<p>Confidence intervals for rotated factor loadings and correlation matrices are constructed using point estimates and their standard error estimates. Standard errors for rotated factor loadings and factor correlations are computed using a sandwich method (Ogasawara, 1998; Yuan, Marshall, &amp; Bentler, 2002), which generalizes the augmented information method (Jennrich, 1974). The sandwich standard error are consistent estimates even when the data distribution is non-normal and model error exists in the population. Sandwich standard error estimates require a consistent estimate of the asymptotic covariance matrix of manifest variable correlations. Such estimates are described in Browne &amp; Shapiro (1986) for non-normal continuous variables and in Yuan &amp; Schuster (2013) for Likert variables. Estimation of the asymptotic covariance matrix of polychoric correlations is slow if the EFA model involves a large number of Likert variables.
</p>
<p>When manifest variables are normally distributed (dist = 'normal') and model error does not exist (merror = 'NO'), the sandwich standard errors are equivalent to the usual standard error estimates, which come from the inverse of the information matrix. The information standard error estimates in EFA is available CEFA (Browne, Cudeck, Tateneni, &amp; Mels, 2010) and SAS Proc Factor. Mplus (Muthen &amp; Muthen, 2015) also implemented a version of sandwich standard errors for EFA, which are robust against non-normal distribution but not model error. Sandwich standard errors computed in <code><a href="#topic+efa">efa</a></code> tend to be larger than those computed in Mplus. Sandwich standard errors for non-normal distributions and with model error are equivalent to the infinitesimal jackknife standard errors described in Zhang, Preacher, &amp; Jennrich (2012). Two computationally intensive standard error methods (se='bootstrap' and se='jackknife') are also implemented. More details on standard error estimation methods in EFA are documented in Zhang (2014).
</p>


<h3>Value</h3>

<p>An object of class efa, which includes:
</p>
<table role = "presentation">
<tr><td><code>details</code></td>
<td>
<p>summary information about the analysis such as number of manifest variables, number of factors, sample size, factor extraction method, factor rotation method, target values for target rotation and xtarget rotation, and levels for confidence intervals.</p>
</td></tr>
<tr><td><code>unrotated</code></td>
<td>
<p>the unrotated factor loading matrix</p>
</td></tr>
<tr><td><code>fdiscrepancy</code></td>
<td>
<p>discrepancy function value used in factor extraction</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>whether the factor extraction stage converged successfully, successful convergence indicated by 0</p>
</td></tr>
<tr><td><code>heywood</code></td>
<td>
<p>the number of heywood cases</p>
</td></tr>
<tr><td><code>i.boundary.cr</code></td>
<td>
<p>the number of boundary estimates of residual correlations</p>
</td></tr>
<tr><td><code>nq</code></td>
<td>
<p>the number of model parameters</p>
</td></tr>
<tr><td><code>compsi</code></td>
<td>
<p>Eigenvalues, SMCs (starting values for communality), communality, and unique variance</p>
</td></tr>
<tr><td><code>R0</code></td>
<td>
<p>the sample correlation matrix</p>
</td></tr>
<tr><td><code>Phat</code></td>
<td>
<p>the model implied correlation matrix</p>
</td></tr>
<tr><td><code>Psi</code></td>
<td>
<p>Unique variances (and Residual Correlations)</p>
</td></tr>
<tr><td><code>Residual</code></td>
<td>
<p>the residual correlation matrix</p>
</td></tr>
<tr><td><code>rotated</code></td>
<td>
<p>the rotated factor loadings</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>the rotated factor correlations</p>
</td></tr>
<tr><td><code>rotatedse</code></td>
<td>
<p>the standard errors for rotated factor loadings</p>
</td></tr>
<tr><td><code>Phise</code></td>
<td>
<p>the standard errors for rotated factor correlations</p>
</td></tr>
<tr><td><code>Psise</code></td>
<td>
<p>the standard errors for Unique variances (and Residual Correlations)</p>
</td></tr>
<tr><td><code>ModelF</code></td>
<td>
<p>the test statistic and measures of model fit</p>
</td></tr>
<tr><td><code>rotatedlow</code></td>
<td>
<p>the lower bound of confidence levels for factor loadings</p>
</td></tr>
<tr><td><code>rotatedupper</code></td>
<td>
<p>the upper bound of confidence levels for factor loadings</p>
</td></tr>
<tr><td><code>Philow</code></td>
<td>
<p>the lower bound of confidence levels for factor correlations</p>
</td></tr>
<tr><td><code>Phiupper</code></td>
<td>
<p>the lower bound of confidence levels for factor correlations</p>
</td></tr>
<tr><td><code>Psilow</code></td>
<td>
<p>the lower bound of confidence levels for unique variances (and residual correlations)</p>
</td></tr>
<tr><td><code>Psiupper</code></td>
<td>
<p>the upper bound of confidence levels for unique variances (and residual correlations)</p>
</td></tr>
<tr><td><code>N0Lambda</code></td>
<td>
<p>The required sample sizes for signficant factor loadings (H0: lambda=0)</p>
</td></tr>
<tr><td><code>N1Lambda</code></td>
<td>
<p>The required sample sizes for signficant factor loadings (H0: lambda=Salient)</p>
</td></tr>
<tr><td><code>N0Phi</code></td>
<td>
<p>The required sample sizes for signficant factor correlations (H0: rho=0)</p>
</td></tr>
<tr><td><code>N1Phi</code></td>
<td>
<p>The required sample sizes for signficant factor correlations (H0: rho=salient)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guangjian Zhang, Ge Jiang, Minami Hattori, and Lauren Trichtinger</p>


<h3>References</h3>

<p>Browne, M. W. (2001). An overview of analytic rotation in exploratory factor analysis. Multivariate Behavioral Research, 36, 111-150.
</p>
<p>Browne, M. W., Cudeck, R., Tateneni, K., &amp; Mels, G. (2010). CEFA 3.04: Comprehensive Exploratory Factor Analysis. Retrieved from http://faculty.psy.ohio-state.edu/browne/.
</p>
<p>Browne, M. W., &amp; Shapiro, A. (1986). The asymptotic covariance matrix of sample correlation coefficients under general conditions. Linear Algebra and its applications, 82, 169-176.
</p>
<p>Crawford, C. B., &amp; Ferguson, G. A. (1970). A general rotation criterion and its use in orthogonal
rotation. Psychometrika, 35 , 321-332.
</p>
<p>Engle, R. W., Tuholsjki, S.W., Laughlin, J.E., &amp; Conway, A. R. A. (1999). Working memory, short-term memory, and general fluid intelligence: a latent-variable approach. Journal of Experimental Psychology: General, 309-331.
</p>
<p>Gorsuch, R. L. (1983). Factor analysis (2nd ed.). Mahwah, NJ: Lawrence Erlbaum Associates.
</p>
<p>Jennrich, R. I. (1974). Simplified formula for standard errors in maximum-likelihood factor analysis. British Journal of Mathematical and Statistical Psychology, 27, 122-131.
</p>
<p>Jennrich, R. I. (2002). A simple general method for oblique rotation. Psychometrika, 67, 7-19.
</p>
<p>Muthen, L. K., &amp; Muthen, B. O. (1998-2015). Mplus user's guide (7th ed.). Los Angeles, CA:
Muthen &amp; Muthen.
</p>
<p>Ogasawara, H. (1998). Standard errors of several indices for unrotated and rotated factors. Economic Review, Otaru University of Commerce, 49(1), 21-69.
</p>
<p>Yuan, K., Marshall, L. L., &amp; Bentler, P. M. (2002). A unified approach to exploratory factor analysis with missing data, nonnormal data, and in the presence of outliers. Psychometrika , 67 , 95-122.
</p>
<p>Yuan, K.-H., &amp; Schuster, C. (2013). Overview of statistical estimation methods. In T. D. Little (Ed.), The Oxford handbook of quantitative methods (pp. 361-387). New York, NY: Oxford University Press.
</p>
<p>Zhang, G. (2014). Estimating standard errors in exploratory factor analysis. Multivariate Behavioral Research, 49, 339-353.
</p>
<p>Zhang, G., Preacher, K. J., &amp; Jennrich, R. I. (2012). The infinitesimal jackknife with exploratory
factor analysis. Psychometrika, 77 , 634-648.
</p>
<p>Zhang, G., Preacher, K., Hattori, M., Ge, J., &amp; Trichtinger, L (2019). A sandwich standard error estimator for exploratory factor analysis with nonnormal data and imperfect models. Applied Psychological Measurement,45, 360-373.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Examples using the data sets included in the packages:

data("CPAI537")    # Chinese personality assessment inventory (N = 537)

#1a) normal, ml, oblique, CF-varimax, information, merror='NO'
#res1 &lt;- efa(x=CPAI537,factors=4, fm='ml')
#res1

#1b) confidence intervals: normal, ml, oblique, CF-varimax, information, merror='NO'
#res1$rotatedlow     # lower bound for 95 percent confidence intervals for factor loadings
#res1$rotatedupper   # upper bound for 95 percent confidence intervals for factor loadings
#res1$Philow         # lower bound for 95 percent confidence intervals for factor correlations
#res1$Phiupper       # upper bound for 95 percent confidence intervals for factor correlations

#2) continuous, ml, oblique, CF-quartimax, sandwich, merror='YES'
#efa(x=CPAI537, factors=4, dist='continuous',fm='ml',rotation='CF-quartimax', merror='YES')

#3) continuous, ml, oblique, CF-equamax, sandwich, merror='YES'
#efa(x = CPAI537, factors = 4, dist = 'continuous',
#fm = 'ml', rotation = 'CF-equamax', merror ='YES')

#4) continuous, ml, oblique, CF-facparism, sandwich, merror='YES'
#efa(x = CPAI537, factors = 4, fm = 'ml',
#dist = 'continuous', rotation = 'CF-facparsim', merror='YES')

#5)continuous, ml, orthogonal, CF-parsimax, sandwich, merror='YES'
#efa(x = CPAI537, factors = 4, fm = 'ml', rtype = 'orthogonal',
#dist = 'continuous', rotation = 'CF-parsimax', merror = 'YES')

#6) continuous, ols, orthogonal, geomin, sandwich, merror='Yes'
#efa(x=CPAI537, factors=4, dist='continuous',
#rtype= 'orthogonal',rotation='geomin', merror='YES')

#7) ordinal, ols, oblique, CF-varimax, sandwich, merror='Yes'
#data("BFI228")      # Big-five inventory (N = 228)
# For ordinal data, estimating SE with the sandwich method
#   can take time with a dataset with 44 variables
#reduced2 &lt;- BFI228[,1:17] # extracting 17 variables corresponding to the first 2 factors
#efa(x=reduced2, factors=2, dist='ordinal', merror='YES')

#8) continuous, ml, oblique, Cf-varimax, jackknife
#efa(x=CPAI537,factors=4, dist='continuous',fm='ml', merror='YES', se= 'jackknife')

#9) extracting the test statistic
#res2 &lt;-efa(x=CPAI537,factors=4)
#res2
#res2$ModelF$f.stat

#10) extended target rotation, ml
# # The data come from Engle et al. (1999) on memory and intelligence.
# datcor &lt;- matrix(c(1.00, 0.51, 0.47, 0.35, 0.37, 0.38, 0.28, 0.34,
#                    0.51, 1.00, 0.32, 0.35, 0.35, 0.31, 0.24, 0.28,
#                    0.47, 0.32, 1.00, 0.43, 0.31, 0.31, 0.29, 0.32,
#                    0.35, 0.35, 0.43, 1.00, 0.54, 0.44, 0.19, 0.27,
#                    0.37, 0.35, 0.31, 0.54, 1.00, 0.59, 0.05, 0.19,
#                    0.38, 0.31, 0.31, 0.44, 0.59, 1.00, 0.20, 0.21,
#                    0.28, 0.24, 0.29, 0.19, 0.05, 0.20, 1.00, 0.68,
#                    0.34, 0.28, 0.32, 0.27, 0.19, 0.21, 0.68, 1.00),
#                  ncol = 8)
#
# # Prepare target and weight matrices for lambda -------
# MTarget1 &lt;- matrix(c(9, 0, 0,
#                      9, 0, 0,
#                      9, 0, 0, # 0 corresponds to targets
#                      0, 9, 0,
#                      0, 9, 0,
#                      0, 9, 0,
#                      0, 0, 9,
#                      0, 0, 9), ncol = 3, byrow = TRUE)
# MWeight1 &lt;- matrix(0, ncol = 3, nrow = 8)
# MWeight1[MTarget1 == 0] &lt;- 1 # 1 corresponds to targets
#
# # Prepare target and weight matrices for phi ---------
# PhiTarget1 &lt;- matrix(c(1, 9, 9,
#                        9, 1, 0,
#                        9, 0, 1), ncol = 3)
# PhiWeight1 &lt;- matrix(0, ncol = 3, nrow = 3)
# PhiWeight1[PhiTarget1 == 0] &lt;- 1
#
# # Conduct extended target rotation -------------------
# mod.xtarget &lt;- efa(covmat = datcor, factors = 3, n.obs = 133,
#                    rotation ='xtarget', fm = 'ml', useorder = T,
#                    MTarget = MTarget1, MWeight = MWeight1,
#                    PhiTarget = PhiTarget1, PhiWeight = PhiWeight1)
# mod.xtarget
#

#11) EFA with correlated residuals
# The data is a subset of the study reported by Watson Clark &amp; Tellegen, A. (1988).

# xcor &lt;- matrix(c(
#  1.00,  0.37,  0.29,  0.43, -0.07, -0.05, -0.04, -0.01,
#  0.37,  1.00,  0.51,  0.37, -0.03, -0.03, -0.06, -0.03,
#  0.29,  0.51,  1.00,  0.37, -0.03, -0.01, -0.02, -0.04,
#  0.43,  0.37,  0.37,  1.00, -0.03, -0.03, -0.02, -0.01,
# -0.07, -0.03, -0.03, -0.03,  1.00,  0.61,  0.41,  0.32,
# -0.05, -0.03, -0.01, -0.03,  0.61,  1.00,  0.47,  0.38,
# -0.04, -0.06, -0.02, -0.02,  0.41,  0.47,  1.00,  0.47,
# -0.01, -0.03, -0.04, -0.01,  0.32,  0.38,  0.47,  1.00),
# ncol=8)

# n.cr=2
# I.cr = matrix(0,n.cr,2)

# I.cr[1,1] = 5
# I.cr[1,2] = 6
# I.cr[2,1] = 7
# I.cr[2,2] = 8

# efa (covmat=xcor,factors=2, n.obs=1657, I.cr=I.cr)


</code></pre>

<hr>
<h2 id='efaMR'>Exploratory Factor Analysis with Multiple Rotations</h2><span id='topic+efaMR'></span>

<h3>Description</h3>

<p>The function compares EFA solutions from  multiple random starts or from multiple rotation criteria.</p>


<h3>Usage</h3>

<pre><code class='language-R'>efaMR(x=NULL, factors=NULL, covmat=NULL, n.obs=NULL, 
      dist='normal', fm='ols', rtype='oblique', rotation = 'CF-varimax', 
      input.A=NULL, additionalRC = NULL, 
      nstart = 100, compare = 'First', plot = T, cex = .5,
      normalize = FALSE, geomin.delta = .01, 
      MTarget = NULL, MWeight = NULL, PhiTarget = NULL, PhiWeight = NULL, 
      useorder = FALSE, mnames = NULL, fnames = NULL, wxt2 = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="efaMR_+3A_x">x</code></td>
<td>
<p>The raw data: an n-by-p matrix where n is number of participants and p is the number of manifest variables.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_factors">factors</code></td>
<td>
<p>The number of factors m: specified by a researcher; the default one is the Kaiser rule which is the number of eigenvalues of covmat larger than one.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_covmat">covmat</code></td>
<td>
<p>A p-by-p manifest variable correlation matrix.</p>
</td></tr>  
<tr><td><code id="efaMR_+3A_n.obs">n.obs</code></td>
<td>
<p>The number of participants used in calculating the correlation matrix. This is not required when the raw data (x) is provided.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_dist">dist</code></td>
<td>
<p>Manifest variable distributions: 'normal'(default), 'continuous', 'ordinal' and 'ts'. 'normal' stands for normal distribution. 'continuous' stands for nonnormal continuous distributions.  'ordinal' stands for Likert scale variable. &quot;ts&quot; stands for distributions for time-series data.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_fm">fm</code></td>
<td>
<p>Factor extraction methods: 'ols' (default) and 'ml'</p>
</td></tr> 
<tr><td><code id="efaMR_+3A_rtype">rtype</code></td>
<td>
<p>Factor rotation types: 'oblique' (default) and 'orthogonal'. Factors are correlated in 'oblique' rotation, and they are uncorrelated in 'orthogonal' rotation.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_rotation">rotation</code></td>
<td>
<p>Factor rotation criteria: 'CF-varimax' (default), 'CF-quartimax', 'CF-equamax', 'CF-facparsim', 'CF-parsimax','target', and 'geomin'. These rotation criteria can be used in both orthogonal and oblique rotation. In addition, a fifth rotation criterion 'xtarget'(extended target) rotation is available for oblique rotation. The extended target rotation allows targets to be specified on both factor loadings and factor correlations.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_input.a">input.A</code></td>
<td>
<p>A p-by-m unrotated factor loading matrix. It can replace x or covmat as input arguments. Only factor rotation will be conducted; factor extraction will not be conducted.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_additionalrc">additionalRC</code></td>
<td>
<p>A string of factor extraction methods against which the main rotation is compared. Required only when nstart = 1. See details. </p>
</td></tr>
<tr><td><code id="efaMR_+3A_nstart">nstart</code></td>
<td>
<p>The number random orthogonal starts used, with 100 as the default value.  With nstart = 1, only one random start is used.  See details.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_compare">compare</code></td>
<td>
<p>'First' (default) or 'All': The global solution is compared against all local solutions with 'First'; All solutions are compared with each other with 'All'.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_plot">plot</code></td>
<td>
<p>Whether a bar graph that shows the number and frequencies of local solutions or not: TRUE (default) and FALSE.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_cex">cex</code></td>
<td>
<p>A tuning parameter if the plot is produced: .5 (default)</p>
</td></tr>
<tr><td><code id="efaMR_+3A_normalize">normalize</code></td>
<td>
<p>Row standardization in factor rotation: FALSE (default) and TRUE (Kaiser standardization).</p>
</td></tr>   
<tr><td><code id="efaMR_+3A_geomin.delta">geomin.delta</code></td>
<td>
<p>The controlling parameter in Geomin rotation, 0.01 as the default value.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_mtarget">MTarget</code></td>
<td>
<p>The p-by-m target matrix for the factor loading matrix in target rotation or xtarget rotation.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_mweight">MWeight</code></td>
<td>
<p>The p-by-m weight matrix for the factor loading matrix in target rotation or xtarget rotation.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_phitarget">PhiTarget</code></td>
<td>
<p>The m-by-m target matrix for the factor correlation matrix in xtarget rotation.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_phiweight">PhiWeight</code></td>
<td>
<p>The m-by-m weight matrix for the factor correlation matrix in xtarget rotation.</p>
</td></tr>
<tr><td><code id="efaMR_+3A_useorder">useorder</code></td>
<td>
<p>Whether an order matrix is used for factor alignment: FALSE (default) and TRUE</p>
</td></tr>
<tr><td><code id="efaMR_+3A_mnames">mnames</code></td>
<td>
<p>Names of p manifest variables: Null (default)</p>
</td></tr> 
<tr><td><code id="efaMR_+3A_fnames">fnames</code></td>
<td>
<p>Names of m factors: Null (default)</p>
</td></tr>
<tr><td><code id="efaMR_+3A_wxt2">wxt2</code></td>
<td>
<p>The relative weight for factor correlations in 'xtarget' (extended target) rotation: 1 (default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>efaMR performs EFA with multiple rotation using random starts.  
</p>
<p>Geomin rotation, in particular, is known to produce multiple local solutions; the use of random starts is advised (Hattori, Zhang, &amp; Preacher, 2018). 
</p>
<p>The p-by-m unrotated factor loading matrix is post-multiplied by an m-by-m random orthogonal matrices before rotation. 
</p>
<p>The number of random starts can be specified with the default value of nstart = 100. 
Bar plot that represents frequencies of each solution is provided. 
If multiple solutions are found, they are compared with each other using congruence coefficient. 
</p>
<p>If nstart = 1, no random start is used. The solution is compared against solutions using additional rotation criterion provided by additionalRC. 
</p>
<p>For example, with rotation = geomin, additionalRC = c('CF-varimax', 'CF-quartimax), the geomin solution is compared against those with CF-varimax and CF-quartimax. 
</p>
<p>Estimation of standard errors and construction of confidence intervals are disabled with the function efaMR(). They are available with a function efa(). 
</p>


<h3>Author(s)</h3>

<p>Minami Hattori, Guangjian Zhang</p>


<h3>References</h3>

<p>Hattori, M., Zhang, G., &amp; Preacher, K. J. (2017).  Multiple local solutions and geomin rotation. Multivariate Behavioral Research, 720&ndash;731.  doi: 10.1080/00273171.2017.1361312</p>


<h3>Examples</h3>

<pre><code class='language-R'>#data("CPAI537")    # Chinese personality assessment inventory (N = 537)

# # Example 1: Oblique geomin rotation with 10 random starts
# res1 &lt;- efaMR(CPAI537, factors = 5, fm = 'ml', 
#               rtype = 'oblique', rotation = 'geomin',
#               geomin.delta = .01, nstart = 10)
# res1
# summary(res1)
# res1$MultipleSolutions
# res1$Comparisons

# In practice, we recommend nstart = 100 or more (Hattori, Zhang, &amp; Preacher, 2018).   


# Example 2: Oblique geomin rotation (no random starts)
#            compared against CF-varimax and CF-quartimax rotation solutions
# res2 &lt;- efaMR(CPAI537, factors = 5, fm = 'ml', 
#               rtype = 'oblique', rotation = 'geomin',
#               additionalRC = c('CF-varimax', 'CF-quartimax'), 
#               geomin.delta = .01, nstart = 1)
# res2$MultipleSolutions
# res2$Comparisons


# Example 3: Obtaining multiple solutions from the unrotated factor loading matrix as input
# res3 &lt;- efa(CPAI537, factors = 5, fm = 'ml', 
#             rtype = 'oblique', rotation = 'geomin')
# set.seed(2017)
# res3MR &lt;- efaMR(input.A = res3$unrotated, rtype = 'oblique',
#                 rotation = 'geomin', geomin.delta = .01)
# res3MR$MultipleSolutions
# res3MR$Comparisons
</code></pre>

<hr>
<h2 id='ssem'>Simplifying Factor Strcutral Paths by Factor Rotation: Saturated Structural Equation Models</h2><span id='topic+ssem'></span>

<h3>Description</h3>

<p>This function simplifies factor structural paths by factor rotation. We refer to the method as FSP or SSEM (saturated structural equation modeling). It re-parameterizes the obliquely rotated factor correlation matrix such that factors can be either endogenous or exogenous.  In comparison, all factors are exogenous in exploratory factor analysis. Manifest variables can be normal variables, nonnormal variables, nonnormal continuous variable, Likert scale variables and time series. It also provides standard errors and confidence intervals for rotated factor loadings and structural parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssem(x=NULL, factors=NULL, exfactors=1, covmat=NULL,
acm=NULL, n.obs=NULL, dist='normal', fm='ml', mtest = TRUE,
rotation='semtarget', normalize=FALSE, maxit=1000, geomin.delta=NULL,
MTarget=NULL, MWeight=NULL, BGWeight = NULL, BGTarget = NULL,
PhiWeight = NULL, PhiTarget = NULL, useorder=TRUE, se='sandwich',
LConfid=c(0.95,0.90), CItype='pse', Ib=2000, mnames=NULL, fnames=NULL,
merror='YES', wxt2 = 1e0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ssem_+3A_x">x</code></td>
<td>
<p>The raw data: an n-by-p matrix where n is number of participants and p is the number of manifest variables.</p>
</td></tr>
<tr><td><code id="ssem_+3A_factors">factors</code></td>
<td>
<p>The number of factors m: specified by a researcher; the default one is the Kaiser rule which is the number of eigenvalues of covmat larger than one.</p>
</td></tr>
<tr><td><code id="ssem_+3A_exfactors">exfactors</code></td>
<td>
<p>The number of exogenous factors: 1 (default)</p>
</td></tr>
<tr><td><code id="ssem_+3A_covmat">covmat</code></td>
<td>
<p>A p-by-p manifest variable correlation matrix.</p>
</td></tr>
<tr><td><code id="ssem_+3A_acm">acm</code></td>
<td>
<p>A p(p-1)/2 by p(p-1)/2 asymptotic covariance matrix of correlations: specified by the researcher.  </p>
</td></tr>
<tr><td><code id="ssem_+3A_n.obs">n.obs</code></td>
<td>
<p>The number of participants used in calculating the correlation matrix. This is not required when the raw data (x) is provided.</p>
</td></tr>
<tr><td><code id="ssem_+3A_dist">dist</code></td>
<td>
<p>Manifest variable distributions: 'normal'(default), 'continuous', 'ordinal' and 'ts'. 'normal' stands for normal distribution.
'continuous' stands for nonnormal continuous distributions.  'ordinal' stands for Likert scale variable.
'ts' stands for distributions for time-series data.</p>
</td></tr>
<tr><td><code id="ssem_+3A_fm">fm</code></td>
<td>
<p>Factor extraction methods: 'ml' (default) and 'ols'</p>
</td></tr>
<tr><td><code id="ssem_+3A_mtest">mtest</code></td>
<td>
<p>Whether the test statistic is computed: TRUE (default) and FALSE</p>
</td></tr>
<tr><td><code id="ssem_+3A_rotation">rotation</code></td>
<td>
<p> Factor rotation criteria: 'semtarget' (default),'CF-varimax', 'CF-quartimax', 'CF-equamax', 'CF-parsimax', 'CF-facparsim','target', and 'geomin'. These rotation criteria can be used in both orthogonal and oblique rotation. In addition, a fifth rotation criterion 'xtarget'(extended target) rotation is available for oblique rotation. The ssem target rotation allows targets to be specified on both factor loadings and factor structural parameters.</p>
</td></tr>
<tr><td><code id="ssem_+3A_normalize">normalize</code></td>
<td>
<p>Row standardization in factor rotation: FALSE (default) and TRUE (Kaiser standardization).</p>
</td></tr>
<tr><td><code id="ssem_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations in factor rotation: 1000 (default)</p>
</td></tr>
<tr><td><code id="ssem_+3A_geomin.delta">geomin.delta</code></td>
<td>
<p>The controlling parameter in Geomin rotation, 0.01 as the default value.</p>
</td></tr>
<tr><td><code id="ssem_+3A_mtarget">MTarget</code></td>
<td>
<p>The p-by-m target matrix for the factor loading matrix in target rotation and semtarget rotation.</p>
</td></tr>
<tr><td><code id="ssem_+3A_mweight">MWeight</code></td>
<td>
<p>The p-by-m weight matrix for the factor loading matrix in target rotation and semtarget rotation. Optional</p>
</td></tr>
<tr><td><code id="ssem_+3A_bgweight">BGWeight</code></td>
<td>
<p>The m1-by-m weight matrix for the [Beta | Gamma] matrix in semtarget rotation (see details) Optional</p>
</td></tr>
<tr><td><code id="ssem_+3A_bgtarget">BGTarget</code></td>
<td>
<p>The m1-by-m target matrix for the [Beta | Gamma] matrix in semtarget rotation where m1 is the number of endogenous factors (see details)</p>
</td></tr>
<tr><td><code id="ssem_+3A_phiweight">PhiWeight</code></td>
<td>
<p>The m2-by-m2 target matrix for the exogenous factor correlation matrix in semtarget rotation.Optional</p>
</td></tr>
<tr><td><code id="ssem_+3A_phitarget">PhiTarget</code></td>
<td>
<p>The m2-by-m2 weight matrix for the exogenous factor correlation matrix in semtarget rotation</p>
</td></tr>
<tr><td><code id="ssem_+3A_useorder">useorder</code></td>
<td>
<p>Whether an order matrix is used for factor alignment: TRUE (default) and FALSE</p>
</td></tr>
<tr><td><code id="ssem_+3A_se">se</code></td>
<td>
<p>Methods for estimating standard errors for rotated factor loadings and factor correlations, 'sandwich' (default),'information',  'bootstrap', and 'jackknife'. The 'bootstrap' and 'jackknife' methods require raw data.</p>
</td></tr>
<tr><td><code id="ssem_+3A_lconfid">LConfid</code></td>
<td>
<p>Confidence levels for model parameters (rotated factor loadings and structural parameters) and RMSEA, respectively: c(.95, .90) as default.</p>
</td></tr>
<tr><td><code id="ssem_+3A_citype">CItype</code></td>
<td>
<p>Type of confidence intervals: 'pse' (default) or 'percentile'. CIs with 'pse' are based on point and standard error estimates; CIs with 'percentile' are based on bootstrap percentiles.</p>
</td></tr>
<tr><td><code id="ssem_+3A_ib">Ib</code></td>
<td>
<p>The Number of bootstrap samples when se='bootstrap': 2000 (default)</p>
</td></tr>
<tr><td><code id="ssem_+3A_mnames">mnames</code></td>
<td>
<p>Names of p manifest variables: Null (default)</p>
</td></tr>
<tr><td><code id="ssem_+3A_fnames">fnames</code></td>
<td>
<p>Names of m factors: Null (default)</p>
</td></tr>
<tr><td><code id="ssem_+3A_merror">merror</code></td>
<td>
<p> Model error: 'YES' (default) or 'NO'. In general, we expect our model is a parsimonious representation to the complex real world. Thus, some amount of model error is unavailable. When merror = 'NO', the ssem model is assumed to fit perfectly in the population.</p>
</td></tr>
<tr><td><code id="ssem_+3A_wxt2">wxt2</code></td>
<td>
<p>The relative weight for structural parameters in 'semtarget' rotation: 1 (default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code><a href="#topic+ssem">ssem</a></code> conducts saturated structural equation modeling (ssem) in a variety of conditions. Data can be normal variables, non-normal continuous variables, and Likert variables. Our implementation of SSEM includes three major steps: factor extraction, factor rotation, and estimating standard errors for rotated factor loadings and factor correlations.
</p>
<p>Factors can be extracted using two methods: maximum likelihood estimation (ml) and ordinary least squares (ols). These factor loading matrices are referred to as unrotated factor loading matrices. The ml unrotated factor loading matrix is obtained using <code><a href="stats.html#topic+factanal">factanal</a></code>. The ols unrotated factor loading matrix is obtained using <code><a href="stats.html#topic+optim">optim</a></code> where the residual sum of squares is minimized. The starting values for communalities are squared multiple correlations (SMCs). The test statistic and model fit measures are provided.
</p>
<p>Eight rotation criteria (semtarget, CF-varimax, CF-quartimax, CF-equamax, CF-parsimax, CF-facparsim, target, and geomin) are available for oblique rotation (Browne, 2001). Additionally, a new rotation criteria, ssemtarget, can be specified for oblique rotation. The factor rotation methods are achieved by calling functions in the package GPArotation. CF-varimax, CF-quartimax, CF-equamax, CF-parsimax, and CF-facparsim are members of the Crawford-Fugersion family (Crawford, &amp; Ferguson, 1970) whose kappa = 1/p and kappa = 0, respectively.  The target matrix in target rotation can either be a fully specified matrix or a partially specified matrix. Target rotation can be considered as a procedure which is located between EFA and CFA. In CFA, if a factor loading is specified to be zero, its value is fixed to be zero; if target rotation, if a factor loading is specified to be zero, it is made to zero as close as possible. In xtarget rotation, target values can be specified on both factor loadings and factor correlations. In ssemtarget, target values can be specified for the [Beta | Gamma] matrix where Beta is the regression weights of the endogenous factors on itself and the Gamma is the regression weights of the endogenous factors on the exogenous factors.
</p>
<p>Confidence intervals for rotated factor loadings and correlation matrices are constructed using point estimates and their standard error estimates. Standard errors for rotated factor loadings and factor correlations are computed using a sandwich method (Ogasawara, 1998; Yuan, Marshall, &amp; Bentler, 2002), which generalizes the augmented information method (Jennrich, 1974). The sandwich standard error are consistent estimates even when the data distribution is non-normal and model error exists in the population. Sandwich standard error estimates require a consistent estimate of the asymptotic covariance matrix of manifest variable correlations. Such estimates are described in Browne &amp; Shapiro (1986) for non-normal continuous variables and in Yuan &amp; Schuster (2013) for Likert variables. Estimation of the asymptotic covariance matrix of polychoric correlations is slow if the EFA model involves a large number of Likert variables.
</p>
<p>When manifest variables are normally distributed (dist = 'normal') and model error does not exist (merror = 'NO'), the sandwich standard errors are equivalent to the usual standard error estimates, which come from the inverse of the information matrix. The information standard error estimates in EFA is available CEFA (Browne, Cudeck, Tateneni, &amp; Mels, 2010) and SAS Proc Factor. Mplus (Muthen &amp; Muthen, 2015) also implemented a version of sandwich standard errors for EFA, which are robust against non-normal distribution but not model error. Sandwich standard errors computed in <code><a href="#topic+efa">efa</a></code> tend to be larger than those computed in Mplus. Sandwich standard errors for non-normal distributions and with model error are equivalent to the infinitesimal jackknife standard errors described in Zhang, Preacher, &amp; Jennrich (2012). Two computationally intensive standard error methods (se='bootstrap' and se='jackknife') are also implemented. More details on standard error estimation methods in EFA are documented in Zhang (2014).
</p>


<h3>Value</h3>

<p>An object of class ssem, which includes:
</p>
<table role = "presentation">
<tr><td><code>details</code></td>
<td>
<p>summary information about the analysis such as number of manifest variables, number of factors, number of endogenous factors, number of exogenous factors, sample size, distribution, factor extraction method, factor rotation method, target values for target rotation, xtarget rotation and ssemtarget rotation, and levels for confidence intervals.</p>
</td></tr>
<tr><td><code>unrotated</code></td>
<td>
<p>the unrotated factor loading matrix</p>
</td></tr>
<tr><td><code>fdiscrepancy</code></td>
<td>
<p>discrepancy function value used in factor extraction</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>whether the factor extraction stage converged successfully, successful convergence indicated by 0</p>
</td></tr>
<tr><td><code>heywood</code></td>
<td>
<p>the number of heywood cases</p>
</td></tr>
<tr><td><code>nq</code></td>
<td>
<p>the number of effective parameters</p>
</td></tr>
<tr><td><code>compsi</code></td>
<td>
<p>contains eigenvalues, SMCs, communalities, and unique variances</p>
</td></tr>
<tr><td><code>R0</code></td>
<td>
<p>the sample correlation matrix</p>
</td></tr>
<tr><td><code>Phat</code></td>
<td>
<p>the model implied correlation matrix</p>
</td></tr>
<tr><td><code>Residual</code></td>
<td>
<p>the residual correlation matrix</p>
</td></tr>
<tr><td><code>rotated</code></td>
<td>
<p>the rotated factor loadings</p>
</td></tr>
<tr><td><code>Phi</code></td>
<td>
<p>the rotated factor correlations</p>
</td></tr>
<tr><td><code>BG</code></td>
<td>
<p>the [Beta | Gamma] latent regression coefficients</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>the endogenous residuals</p>
</td></tr>
<tr><td><code>Phi.xi</code></td>
<td>
<p>the exogenous correlation</p>
</td></tr>
<tr><td><code>rotatedse</code></td>
<td>
<p>the standard errors for rotated factor loadings</p>
</td></tr>
<tr><td><code>Phise</code></td>
<td>
<p>the standard errors for rotated factor correlations</p>
</td></tr>
<tr><td><code>BGse</code></td>
<td>
<p>the standard errors for the [Beta | Gamma] latent regression coefficients</p>
</td></tr>
<tr><td><code>psise</code></td>
<td>
<p>the standard errors for the endogenous residuals</p>
</td></tr>
<tr><td><code>Phi.xise</code></td>
<td>
<p>the standard errors for the exogenous correlation</p>
</td></tr>
<tr><td><code>ModelF</code></td>
<td>
<p>the test statistic and measures of model fit</p>
</td></tr>
<tr><td><code>rotatedlow</code></td>
<td>
<p>the lower bound of confidence levels for factor loadings</p>
</td></tr>
<tr><td><code>rotatedupper</code></td>
<td>
<p>the upper bound of confidence levels for factor loadings</p>
</td></tr>
<tr><td><code>Philow</code></td>
<td>
<p>the lower bound of confidence levels for factor correlations</p>
</td></tr>
<tr><td><code>Phiupper</code></td>
<td>
<p>the lower bound of confidence levels for factor correlations</p>
</td></tr>
<tr><td><code>BGlower</code></td>
<td>
<p>the lower bound of the [Beta | Gamma] latent regression coefficients</p>
</td></tr>
<tr><td><code>BGupper</code></td>
<td>
<p>the upper bound of the [Beta | Gamma] latent regression coefficients</p>
</td></tr>
<tr><td><code>psilower</code></td>
<td>
<p>the lower bound of the endogenous residuals</p>
</td></tr>
<tr><td><code>psiupper</code></td>
<td>
<p>the upper bound of the endogenous residuals</p>
</td></tr>
<tr><td><code>Phixilower</code></td>
<td>
<p>the lower bound of the exogenous correlation</p>
</td></tr>
<tr><td><code>Phixiupper</code></td>
<td>
<p>the upper bound of the exogenous correlation</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Guangjian Zhang, Minami Hattori, and Lauren Trichtinger</p>


<h3>References</h3>

<p>Browne, M. W. (2001). An overview of analytic rotation in exploratory factor analysis. Multivariate Behavioral Research, 36, 111-150.
</p>
<p>Browne, M. W., Cudeck, R., Tateneni, K., &amp; Mels, G. (2010). CEFA 3.04: Comprehensive Exploratory Factor Analysis. Retrieved from http://faculty.psy.ohio-state.edu/browne/.
</p>
<p>Browne, M. W., &amp; Shapiro, A. (1986). The asymptotic covariance matrix of sample correlation coefficients under general conditions. Linear Algebra and its applications, 82, 169-176.
</p>
<p>Crawford, C. B., &amp; Ferguson, G. A. (1970). A general rotation criterion and its use in orthogonal
rotation. Psychometrika, 35 , 321-332.
</p>
<p>Engle, R. W., Tuholsjki, S.W., Laughlin, J.E., &amp; Conway, A. R. A. (1999). Working memory, short-term memory, and general fluid intelligence: a latent-variable approach. Journal of Experimental Psychology: General, 309-331.
</p>
<p>Gorsuch, R. L. (1983). Factor analysis (2nd ed.). Mahwah, NJ: Lawrence Erlbaum Associates.
</p>
<p>Jennrich, R. I. (1974). Simplified formula for standard errors in maximum-likelihood factor analysis. British Journal of Mathematical and Statistical Psychology, 27, 122-131.
</p>
<p>Jennrich, R. I. (2002). A simple general method for oblique rotation. Psychometrika, 67, 7-19.
</p>
<p>Muthen, L. K., &amp; Muthen, B. O. (1998-2015). Mplus user's guide (7th ed.). Los Angeles, CA:
Muthen &amp; Muthen.
</p>
<p>Ogasawara, H. (1998). Standard errors of several indices for unrotated and rotated factors. Economic Review, Otaru University of Commerce, 49(1), 21-69.
</p>
<p>Yuan, K., Marshall, L. L., &amp; Bentler, P. M. (2002). A unified approach to exploratory factor analysis with missing data, nonnormal data, and in the presence of outliers. Psychometrika , 67 , 95-122.
</p>
<p>Yuan, K.-H., &amp; Schuster, C. (2013). Overview of statistical estimation methods. In T. D. Little (Ed.), The Oxford handbook of quantitative methods (pp. 361-387). New York, NY: Oxford University Press.
</p>
<p>Zhang, G. (2014). Estimating standard errors in exploratory factor analysis. Multivariate Behavioral Research, 49, 339-353.
</p>
<p>Zhang, G., Preacher, K. J., &amp; Jennrich, R. I. (2012). The infinitesimal jackknife with exploratory
factor analysis. Psychometrika, 77 , 634-648.
</p>
<p>Zhang, G., Hattori, M., Trichtinger, L (In press). Rotating factors to simplify their structural paths. Psychometrika. DOI: 10.1007/s11336-022-09877-3
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#cormat &lt;- matrix(c(1, .865, .733, .511, .412, .647, -.462, -.533, -.544,
#                   .865, 1, .741, .485, .366, .595, -.406, -.474, -.505,
#                   .733, .741, 1, .316, .268, .497, -.303, -.372, -.44,
#                   .511, .485, .316, 1, .721, .731, -.521, -.531, -.621,
#                   .412, .366, .268, .721, 1, .599, -.455, -.425, -.455,
#                   .647, .595, .497, .731, .599, 1, -.417, -.47, -.521,
#                  -.462, -.406, -.303, -.521, -.455, -.417, 1, .747, .727,
#                   -.533, -.474, -.372, -.531, -.425, -.47, .747, 1, .772,
#                   -.544, -.505, -.44, -.621, -.455, -.521, .727, .772, 1),
#                 ncol = 9)


#p &lt;- 9      # a number of manifest variables

#m &lt;- 3      # a total number of factors

#m1 &lt;- 2     # a number of endogenous variables
#N &lt;- 138    # a sample size

#mvnames &lt;- c("H1_likelihood", "H2_certainty", "H3_amount", "S1_sympathy",
#             "S2_pity", "S3_concern", "C1_controllable", "C2_responsible", "C3_fault")

#fnames &lt;- c('H', 'S', 'C')
# Step 2: Preparing target and weight matrices =========================
# a 9 x 3 matrix for lambda; p = 9, m = 3

#MT &lt;- matrix(0, p, m, dimnames = list(mvnames, fnames))

#MT[c(1:3,6),1] &lt;- 9

#MT[4:6,2] &lt;- 9

#MT[7:9,3] &lt;- 9

#MW &lt;- matrix(0, p, m, dimnames = list(mvnames, fnames))

#MW[MT == 0] &lt;- 1

# a 2 x 3 matrix for [B|G]; m1 = 2, m = 3

# m1 = 2
#BGT &lt;- matrix(0, m1, m, dimnames = list(fnames[1:m1], fnames))

#BGT[1,2] &lt;- 9

#BGT[2,3] &lt;- 9

#BGT[1,3] &lt;- 9

#BGW &lt;- matrix(0, m1, m, dimnames = list(fnames[1:m1], fnames))

#BGW[BGT == 0] &lt;- 1

#BGW[,1] &lt;- 0

#BGW[2,2] &lt;- 0
# a 1 x 1 matrix for Phi.xi; m - m1 = 1 (only one exogenous factor)

#PhiT &lt;- matrix(9, m - m1, m - m1)

#PhiW &lt;- matrix(0, m - m1, m - m1)
#SSEMres &lt;- ssem(covmat = cormat, factors = m, exfactors = m - m1,
#                dist = 'normal', n.obs = N, fm = 'ml', rotation = 'semtarget',
#                maxit = 10000,
#                MTarget = MT, MWeight = MW, BGTarget = BGT, BGWeight = BGW,
#                PhiTarget = PhiT, PhiWeight = PhiW,  useorder = TRUE, se = 'information',
#                mnames = mvnames, fnames = fnames)
#</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
