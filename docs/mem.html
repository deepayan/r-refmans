<!DOCTYPE html><html><head><title>Help for package mem</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mem}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add.alpha'><p>Add an alpha value to a colour</p>
http://www.magesblog.com/2013/04/how-to-change-alpha-value-of-colours-in.html</a></li>
<li><a href='#calcular.indicadores'><p>Calculates specificity and sensitivity</p></a></li>
<li><a href='#calcular.indicadores.2.timings'><p>Calculates specificity and sensitivity</p></a></li>
<li><a href='#calcular.map'><p>calculates map curve</p></a></li>
<li><a href='#calcular.optimo'><p>calculates optimum generic function</p></a></li>
<li><a href='#calcular.optimo.criterio'><p>calculates optimum: fixed criteria for slope</p></a></li>
<li><a href='#calcular.optimo.derivada'><p>calculates optimum: second derivative equals 0 (change signs from - to +, or + to -)</p></a></li>
<li><a href='#calcular.optimo.original'><p>calculates optimum: original method: second derivative + axis change</p></a></li>
<li><a href='#calcular.optimo.pendiente'><p>calculates optimum: slope matches the overall slope</p></a></li>
<li><a href='#comparar.metodos'><p>Compares outputs from two methods of locating the epidemic</p></a></li>
<li><a href='#create.calendar'><p>create epidemiological calendar</p></a></li>
<li><a href='#epimem'><p>Deprecated function(s) in the mem package</p></a></li>
<li><a href='#epitiming'><p>Deprecated function(s) in the mem package</p></a></li>
<li><a href='#extraer.datos.curva.map'><p>Extract map curve</p></a></li>
<li><a href='#extraer.datos.epi'><p>Extract epidemic hightest rates</p></a></li>
<li><a href='#extraer.datos.optimo.map'><p>Extract optimum</p></a></li>
<li><a href='#extraer.datos.post.epi'><p>Extract post-epidemic hightest rates</p></a></li>
<li><a href='#extraer.datos.pre.epi'><p>Extract pre-epidemic hightest rates</p></a></li>
<li><a href='#fill.missing'><p>fills in missing values inside the season with smoothing regression</p></a></li>
<li><a href='#flucyl'><p>Castilla y Leon influenza crude rates</p></a></li>
<li><a href='#flucylraw'><p>Castilla y Leon influenza standarised rates</p></a></li>
<li><a href='#full.series.graph'><p>Creates the historical series graph of the datasets</p></a></li>
<li><a href='#get.dates'><p>create epidemiological calendar</p></a></li>
<li><a href='#get.epiweek'><p>create epidemiological calendar</p></a></li>
<li><a href='#iconfianza'><p>generic confidence interval calculation function</p></a></li>
<li><a href='#iconfianza.aritmetica'><p>confidence interval for the arithmetic mean using the normal approximation</p></a></li>
<li><a href='#iconfianza.completo'><p>Int. Confianza de 2 y 1 cola, por encima y por debajo. De la media y el punto.</p></a></li>
<li><a href='#iconfianza.geometrica'><p>confidence interval for the geometric mean using the log-normal approximation</p></a></li>
<li><a href='#iconfianza.logx'><p>confidence interval for a point (using log transformation and geometric mean)</p></a></li>
<li><a href='#iconfianza.percentil.boot'><p>confidence interval por the median using bootstrap methods</p></a></li>
<li><a href='#iconfianza.percentil.eqnpar'><p>confidence interval por the median using KC Method</p></a></li>
<li><a href='#iconfianza.percentil.kc'><p>confidence interval por the median using KC Method</p></a></li>
<li><a href='#iconfianza.x'><p>confidence interval for a point (using arithmetic mean)</p></a></li>
<li><a href='#maxFixNA'><p>max function, removing Inf and -Inf</p></a></li>
<li><a href='#maxnvalores'><p>highest n values of a data set, removing Inf and -Inf</p></a></li>
<li><a href='#mem-package'><p>mem: The Moving Epidemic Method</p></a></li>
<li><a href='#memevolution'><p>Evolution of estimators</p></a></li>
<li><a href='#memgoodness'><p>Goodness of fit of the mem</p></a></li>
<li><a href='#memintensity'><p>Thresholds for influenza intensity</p></a></li>
<li><a href='#memmodel'><p>Methods for influenza modelization</p></a></li>
<li><a href='#memstability'><p>Stability of indicators</p></a></li>
<li><a href='#memsurveillance'><p>Creates the surveillance graph of the current season</p></a></li>
<li><a href='#memsurveillance.animated'><p>Creates the animated  graph of the surveillance of the current season</p></a></li>
<li><a href='#memtiming'><p>Influenza Epidemic Timing</p></a></li>
<li><a href='#memtrend'><p>Methods for influenza trend calculation</p></a></li>
<li><a href='#minFixNA'><p>min function, removing Inf and -Inf</p></a></li>
<li><a href='#minnvalores'><p>lowest n values of a data set, removing Inf and -Inf</p></a></li>
<li><a href='#missings.inside'><p>returns position of missing values inside the season. Leading and trailing missing values are not considered.</p></a></li>
<li><a href='#normalizar'><p>standarize data to [0,1] interval</p></a></li>
<li><a href='#optimal.tickmarks'><p>Find tickmarks for a given range of the y-axis that best fit an optimal number of tickmarks</p>
you decide. f.i: what if i want to have a graph with 8 tickmarks in a range of 34 to 345</a></li>
<li><a href='#optimum.by.inspection'><p>Inspection calcultation of the optimum</p></a></li>
<li><a href='#output.ci'><p>function to format output</p></a></li>
<li><a href='#percentage.added'><p>For use with transformseries.multiple</p></a></li>
<li><a href='#processPlots'><p>Full process plots for mem</p></a></li>
<li><a href='#roc.analysis'><p>Analysis of different indicators to find the optimum value of the window parameter</p></a></li>
<li><a href='#semana.absoluta'><p>Transforms relative weeks to absolute weeks in a 1-52 normal season</p></a></li>
<li><a href='#suavizado'><p>smoothing regression function</p></a></li>
<li><a href='#transformdata'><p>Data transformation</p></a></li>
<li><a href='#transformdata.back'><p>Data transformation</p></a></li>
<li><a href='#transformseries'><p>Transformation of series of data</p></a></li>
<li><a href='#transformseries.loess'><p>loess transformation</p></a></li>
<li><a href='#transformseries.moving.average'><p>moving average transformation</p></a></li>
<li><a href='#transformseries.multiple'><p>divide a series in parts</p></a></li>
<li><a href='#transformseries.odd'><p>odd transformation</p></a></li>
<li><a href='#transformseries.spline'><p>spline transformation</p></a></li>
<li><a href='#transformseries.twowaves'><p>adjust a mixed model of two normal distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.18</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-20</td>
</tr>
<tr>
<td>Title:</td>
<td>The Moving Epidemic Method</td>
</tr>
<tr>
<td>Description:</td>
<td>The Moving Epidemic Method, created by T Vega and JE Lozano (2012, 2015) &lt;<a href="https://doi.org/10.1111%2Fj.1750-2659.2012.00422.x">doi:10.1111/j.1750-2659.2012.00422.x</a>&gt;, &lt;<a href="https://doi.org/10.1111%2Firv.12330">doi:10.1111/irv.12330</a>&gt;, allows the weekly assessment of the epidemic and intensity status to help in routine respiratory infections surveillance in health systems. Allows the comparison of different epidemic indicators, timing and shape with past epidemics and across different regions or countries with different surveillance systems. Also, it gives a measure of the performance of the method in terms of sensitivity and specificity of the alert week.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sm, boot, RColorBrewer, mclust, ggplot2, tidyr, dplyr, purrr,
RcppRoll, EnvStats, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>magick</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/lozalojo/mem">https://github.com/lozalojo/mem</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/lozalojo/mem/issues">https://github.com/lozalojo/mem/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-20 10:49:36 UTC; lozalojo</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose E. Lozano [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jose E. Lozano &lt;lozalojo@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-20 11:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='add.alpha'>Add an alpha value to a colour
http://www.magesblog.com/2013/04/how-to-change-alpha-value-of-colours-in.html</h2><span id='topic+add.alpha'></span>

<h3>Description</h3>

<p>Add an alpha value to a colour
http://www.magesblog.com/2013/04/how-to-change-alpha-value-of-colours-in.html
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add.alpha(col, alpha = 1)
</code></pre>

<hr>
<h2 id='calcular.indicadores'>Calculates specificity and sensitivity</h2><span id='topic+calcular.indicadores'></span>

<h3>Description</h3>

<p>Calculates specificity and sensitivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.indicadores(
  i.current,
  i.umbral.pre,
  i.umbral.pos = NA,
  i.intensidades,
  i.duracion.intensidad = 10,
  i.equal = F,
  i.metodo.calculo = "default",
  i.semanas.por.encima = 1,
  i.valores.parametro.deteccion = seq(0.1, 5, 0.1),
  i.output = ".",
  i.graph = F,
  i.graph.name = "",
  i.mem.info = T
)
</code></pre>

<hr>
<h2 id='calcular.indicadores.2.timings'>Calculates specificity and sensitivity</h2><span id='topic+calcular.indicadores.2.timings'></span>

<h3>Description</h3>

<p>Calculates specificity and sensitivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.indicadores.2.timings(
  i.current,
  i.timing.1,
  i.timing.2,
  i.timing.absolute = F,
  i.timing.labels,
  i.output = ".",
  i.graph.title = "",
  i.graph.file = F,
  i.graph.file.name = "",
  i.mem.info = T
)
</code></pre>

<hr>
<h2 id='calcular.map'>calculates map curve</h2><span id='topic+calcular.map'></span>

<h3>Description</h3>

<p>calculates map curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.map(i.datos)
</code></pre>

<hr>
<h2 id='calcular.optimo'>calculates optimum generic function</h2><span id='topic+calcular.optimo'></span>

<h3>Description</h3>

<p>calculates optimum generic function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.optimo(i.curva.map, i.metodo = 2, i.parametro = 2.8)
</code></pre>

<hr>
<h2 id='calcular.optimo.criterio'>calculates optimum: fixed criteria for slope</h2><span id='topic+calcular.optimo.criterio'></span>

<h3>Description</h3>

<p>calculates optimum: fixed criteria for slope
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.optimo.criterio(i.curva.map, i.criterio = 2.8)
</code></pre>

<hr>
<h2 id='calcular.optimo.derivada'>calculates optimum: second derivative equals 0 (change signs from - to +, or + to -)</h2><span id='topic+calcular.optimo.derivada'></span>

<h3>Description</h3>

<p>calculates optimum: second derivative equals 0 (change signs from - to +, or + to -)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.optimo.derivada(i.curva.map)
</code></pre>

<hr>
<h2 id='calcular.optimo.original'>calculates optimum: original method: second derivative + axis change</h2><span id='topic+calcular.optimo.original'></span>

<h3>Description</h3>

<p>calculates optimum: original method: second derivative + axis change
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.optimo.original(i.curva.map)
</code></pre>

<hr>
<h2 id='calcular.optimo.pendiente'>calculates optimum: slope matches the overall slope</h2><span id='topic+calcular.optimo.pendiente'></span>

<h3>Description</h3>

<p>calculates optimum: slope matches the overall slope
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcular.optimo.pendiente(i.curva.map)
</code></pre>

<hr>
<h2 id='comparar.metodos'>Compares outputs from two methods of locating the epidemic</h2><span id='topic+comparar.metodos'></span>

<h3>Description</h3>

<p>Compares outputs from two methods of locating the epidemic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparar.metodos(i.data)
</code></pre>

<hr>
<h2 id='create.calendar'>create epidemiological calendar</h2><span id='topic+create.calendar'></span>

<h3>Description</h3>

<p>create epidemiological calendar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.calendar(
  i.ini = as.POSIXct("1980-01-01"),
  i.fin = as.POSIXct(paste(format(Sys.Date(), "%Y"), "12", "31", sep = "-"))
)
</code></pre>

<hr>
<h2 id='epimem'>Deprecated function(s) in the mem package</h2><span id='topic+epimem'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older version of
the mem package.  They may eventually be completely
removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epimem(
  i.data,
  i.tails = 1,
  i.levels = c(0.4, 0.9, 0.975),
  i.type = 2,
  i.level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epimem_+3A_i.data">i.data</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epimem_+3A_i.tails">i.tails</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epimem_+3A_i.levels">i.levels</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epimem_+3A_i.type">i.type</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epimem_+3A_i.level">i.level</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epimem_+3A_...">...</code></td>
<td>
<p>Parameters (that have not changed) to be passed to the modern version of the function</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: right;">
  <code>epimem</code> </td><td style="text-align: left;"> now a synonym for <code><a href="#topic+memmodel">memmodel</a></code>
</td>
</tr>

</table>


<hr>
<h2 id='epitiming'>Deprecated function(s) in the mem package</h2><span id='topic+epitiming'></span>

<h3>Description</h3>

<p>These functions are provided for compatibility with older version of
the mem package.  They may eventually be completely
removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epitiming(i.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="epitiming_+3A_i.data">i.data</code></td>
<td>
<p>Original parameter deprecated in the new version</p>
</td></tr>
<tr><td><code id="epitiming_+3A_...">...</code></td>
<td>
<p>Parameters (that have not changed) to be passed to the modern version of the function</p>
</td></tr>
</table>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: right;">
  <code>epitiming</code> </td><td style="text-align: left;"> now a synonym for <code><a href="#topic+memtiming">memtiming</a></code>
</td>
</tr>

</table>


<hr>
<h2 id='extraer.datos.curva.map'>Extract map curve</h2><span id='topic+extraer.datos.curva.map'></span>

<h3>Description</h3>

<p>Extract map curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extraer.datos.curva.map(i.epi, i.val)
</code></pre>

<hr>
<h2 id='extraer.datos.epi'>Extract epidemic hightest rates</h2><span id='topic+extraer.datos.epi'></span>

<h3>Description</h3>

<p>Extract epidemic hightest rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extraer.datos.epi(i.epi)
</code></pre>

<hr>
<h2 id='extraer.datos.optimo.map'>Extract optimum</h2><span id='topic+extraer.datos.optimo.map'></span>

<h3>Description</h3>

<p>Extract optimum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extraer.datos.optimo.map(i.epi)
</code></pre>

<hr>
<h2 id='extraer.datos.post.epi'>Extract post-epidemic hightest rates</h2><span id='topic+extraer.datos.post.epi'></span>

<h3>Description</h3>

<p>Extract post-epidemic hightest rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extraer.datos.post.epi(i.epi)
</code></pre>

<hr>
<h2 id='extraer.datos.pre.epi'>Extract pre-epidemic hightest rates</h2><span id='topic+extraer.datos.pre.epi'></span>

<h3>Description</h3>

<p>Extract pre-epidemic hightest rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extraer.datos.pre.epi(i.epi)
</code></pre>

<hr>
<h2 id='fill.missing'>fills in missing values inside the season with smoothing regression</h2><span id='topic+fill.missing'></span>

<h3>Description</h3>

<p>fills in missing values inside the season with smoothing regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'missing'
fill(i.datos)
</code></pre>

<hr>
<h2 id='flucyl'>Castilla y Leon influenza crude rates</h2><span id='topic+flucyl'></span>

<h3>Description</h3>

<p>This data set contains <em>Influenza Like Illness</em> (ILI) rates, in cases per 100,000
inhabitants collected by the <em>Influenza Surveillance Programme</em> of the
<b>Castilla y Leon Health Sentinel Network</b> (CyLHSN) from 2001 to 2008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(flucyl)
</code></pre>


<h3>Format</h3>

<p>A data frame with 33 observations on 8 variables. Each observation is one surveillance
week, and each variable is an influenza season.
</p>

<ul>
<li><p><code>2001/2002</code> a numeric vector - 2001/2002 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2002/2003</code> a numeric vector - 2002/2003 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2003/2004</code> a numeric vector - 2003/2004 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2004/2005</code> a numeric vector - 2004/2005 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2005/2006</code> a numeric vector - 2005/2006 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2006/2007</code> a numeric vector - 2006/2007 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2007/2008</code> a numeric vector - 2007/2008 rates per 100,000 inhabitants.
</p>
</li>
<li><p><code>2008/2009</code> a numeric vector - 2008/2009 rates per 100,000 inhabitants.
</p>
</li></ul>



<h3>Details</h3>

<p>The <b>Castilla y Leon Health Sentinel Network</b> is a spanish regional influenza
surveillance system based upon volunteer health professionals. The <em>Influenza
Surveillance Programme</em> consists on a random sample of general practitioners (covering
30,000 population) which collect ILI cases weekly from 40th week (October) to 20th
week (May) of the following year to provide estimations of the ILI weekly rate for the
entire region.
</p>
<p>The data set contains 8 surveillance seasons, from 2001/2002 to 2008/2009.
</p>


<h3>Source</h3>

<p>Influenza Surveillance Programme. Castilla y Leon Health Sentinel Network. Consejeria
de Sanidad. Junta de Castilla y Leon 2001-2008.
</p>


<h3>References</h3>

<p>Castilla y Leon Health Sentinel Network Reports (Informes de la Red Centinela Sanitaria
de Castilla y Leon).<br />
Influenza Surveillance Programme (Programa de vigilancia de la gripe).<br />
<a href="https://www.saludcastillayleon.es/profesionales/es/centinelas">https://www.saludcastillayleon.es/profesionales/es/centinelas</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(flucyl)
plot(flucyl[,1],type="l")
</code></pre>

<hr>
<h2 id='flucylraw'>Castilla y Leon influenza standarised rates</h2><span id='topic+flucylraw'></span>

<h3>Description</h3>

<p>This data set contains <em>Influenza Like Illness</em> (ILI) rates, in cases per 100,000
inhabitants collected by the <em>Influenza Surveillance Programme</em> of the
<b>Castilla y Leon Health Sentinel Network</b> (CyLHSN) from 2001 to 2008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(flucylraw)
</code></pre>


<h3>Format</h3>

<p>A data frame with 267 observations on 2 variables. Each observation is one surveillance
week and rate,
</p>

<dl>
<dt><code>year</code></dt><dd><p>a numeric vector - year.</p>
</dd>
<dt><code>week</code></dt><dd><p>a numeric vector - week.</p>
</dd>
<dt><code>rates</code></dt><dd><p>a numeric vector - standarised rates per 100,000 inhabitants.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <b>Castilla y Leon Health Sentinel Network</b> is a spanish regional influenza
surveillance system based upon volunteer health professionals. The <em>Influenza
Surveillance Programme</em> consists on a random sample of general practitioners (covering
30,000 population) which collect ILI cases weekly from 40th week (October) to 20th
week (May) of the following year to provide estimations of the ILI weekly rate for the
entire region.<br />
The data set contains 8 surveillance seasons, from 2001/2002 to 2008/2009.
</p>


<h3>Source</h3>

<p>Influenza Surveillance Programme. Castilla y Leon Health Sentinel Network. Consejeria
de Sanidad. Junta de Castilla y Leon 2001-2008.
</p>


<h3>References</h3>

<p>Castilla y Leon Health Sentinel Network Reports (Informes de la Red Centinela Sanitaria
de Castilla y Leon).<br />
Influenza Surveillance Programme (Programa de vigilancia de la gripe).<br />
<a href="https://www.saludcastillayleon.es/profesionales/es/centinelas">https://www.saludcastillayleon.es/profesionales/es/centinelas</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(flucylraw)
plot(flucylraw$rates,type="l")
</code></pre>

<hr>
<h2 id='full.series.graph'>Creates the historical series graph of the datasets</h2><span id='topic+full.series.graph'></span>

<h3>Description</h3>

<p>Function <code>full.series.graph</code> creates a graph with the whole dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>full.series.graph(
  i.data,
  i.range.x = NA,
  i.range.y = NA,
  i.output = ".",
  i.graph.title = "",
  i.graph.subtitle = "",
  i.graph.file = T,
  i.graph.file.name = "",
  i.plot.timing = F,
  i.plot.intensity = F,
  i.alternative.thresholds = NA,
  i.color.pattern = c("#C0C0C0", "#606060", "#000000", "#808080", "#000000", "#001933",
    "#00C000", "#800080", "#FFB401", "#8c6bb1", "#88419d", "#810f7c", "#4d004b"),
  i.mem.info = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="full.series.graph_+3A_i.data">i.data</code></td>
<td>
<p>Historical data series.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.range.x">i.range.x</code></td>
<td>
<p>Range x (surveillance weeks) of graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.range.y">i.range.y</code></td>
<td>
<p>Range y of graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.output">i.output</code></td>
<td>
<p>Directory where graph is saved.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.graph.title">i.graph.title</code></td>
<td>
<p>Title of the graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.graph.subtitle">i.graph.subtitle</code></td>
<td>
<p>Subtitle of the graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.graph.file">i.graph.file</code></td>
<td>
<p>Graph to a file.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.graph.file.name">i.graph.file.name</code></td>
<td>
<p>Name of the graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.plot.timing">i.plot.timing</code></td>
<td>
<p>Plot the timing of epidemics.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.plot.intensity">i.plot.intensity</code></td>
<td>
<p>Plot the intensity levels.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.alternative.thresholds">i.alternative.thresholds</code></td>
<td>
<p>Use alternative thresholds, instead of the ones modelled by the input data (epidemic + 3 intensity thresholds)</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.color.pattern">i.color.pattern</code></td>
<td>
<p>colors to use in the graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_i.mem.info">i.mem.info</code></td>
<td>
<p>include information about the package in the graph.</p>
</td></tr>
<tr><td><code id="full.series.graph_+3A_...">...</code></td>
<td>
<p>other parameters passed to memmodel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data must be a data.frame with each column a surveillance season and each
row a week.
</p>
<p>The resulting graph is a time series-like plot showing all the columns in the
original dataset one after another.
</p>
<p>Color codes:
</p>

<ol>
<li><p> Axis.
</p>
</li>
<li><p> Tickmarks.
</p>
</li>
<li><p> Axis labels.
</p>
</li>
<li><p> Series line.
</p>
</li>
<li><p> Series dots (default).
</p>
</li>
<li><p> Title and subtitle.
</p>
</li>
<li><p> Series dots (pre-epidemic).
</p>
</li>
<li><p> Series dots (epidemic).
</p>
</li>
<li><p> Series dots (post-epidemic).
</p>
</li>
<li><p> Epidemic threshold.
</p>
</li>
<li><p> Medium threshold.
</p>
</li>
<li><p> High threshold.
</p>
</li>
<li><p> Very high threshold.
</p>
</li></ol>



<h3>Value</h3>

<p><code>full.series.graph</code> writes a tiff graph of the full series of the dataset.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Castilla y Leon Influenza Rates data
data(flucyl)
# Data of the last season
# uncomment to execute
# full.series.graph(flucyl)


</code></pre>

<hr>
<h2 id='get.dates'>create epidemiological calendar</h2><span id='topic+get.dates'></span>

<h3>Description</h3>

<p>create epidemiological calendar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.dates(i.yrweek)
</code></pre>

<hr>
<h2 id='get.epiweek'>create epidemiological calendar</h2><span id='topic+get.epiweek'></span>

<h3>Description</h3>

<p>create epidemiological calendar
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.epiweek(i.date = as.POSIXct(as.POSIXlt(Sys.Date()), tz = "CET"))
</code></pre>

<hr>
<h2 id='iconfianza'>generic confidence interval calculation function</h2><span id='topic+iconfianza'></span>

<h3>Description</h3>

<p>generic confidence interval calculation function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza(
  datos,
  nivel = 0.95,
  tipo = 1,
  ic = T,
  tipo.boot = "normal",
  iteraciones.boot = 10000,
  colas = 2,
  use.t = F
)
</code></pre>

<hr>
<h2 id='iconfianza.aritmetica'>confidence interval for the arithmetic mean using the normal approximation</h2><span id='topic+iconfianza.aritmetica'></span>

<h3>Description</h3>

<p>confidence interval for the arithmetic mean using the normal approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.aritmetica(datos, nivel = 0.95, ic = T, colas = 2, use.t = F)
</code></pre>

<hr>
<h2 id='iconfianza.completo'>Int. Confianza de 2 y 1 cola, por encima y por debajo. De la media y el punto.</h2><span id='topic+iconfianza.completo'></span>

<h3>Description</h3>

<p>Int. Confianza de 2 y 1 cola, por encima y por debajo. De la media y el punto.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.completo(i.datos, tipo = 1, i.nivel = 0.95, use.t = F)
</code></pre>

<hr>
<h2 id='iconfianza.geometrica'>confidence interval for the geometric mean using the log-normal approximation</h2><span id='topic+iconfianza.geometrica'></span>

<h3>Description</h3>

<p>confidence interval for the geometric mean using the log-normal approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.geometrica(datos, nivel = 0.95, ic = T, colas = 2, use.t = F)
</code></pre>

<hr>
<h2 id='iconfianza.logx'>confidence interval for a point (using log transformation and geometric mean)</h2><span id='topic+iconfianza.logx'></span>

<h3>Description</h3>

<p>confidence interval for a point (using log transformation and geometric mean)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.logx(datos, nivel = 0.95, ic = T, colas = 2, use.t = F)
</code></pre>

<hr>
<h2 id='iconfianza.percentil.boot'>confidence interval por the median using bootstrap methods</h2><span id='topic+iconfianza.percentil.boot'></span>

<h3>Description</h3>

<p>confidence interval por the median using bootstrap methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.percentil.boot(
  datos,
  q = 0.5,
  nivel = 0.95,
  ic = T,
  tipo.boot = "norm",
  iteraciones.boot = 10000,
  colas = 2
)
</code></pre>

<hr>
<h2 id='iconfianza.percentil.eqnpar'>confidence interval por the median using KC Method</h2><span id='topic+iconfianza.percentil.eqnpar'></span>

<h3>Description</h3>

<p>confidence interval por the median using KC Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.percentil.eqnpar(datos, q = 0.5, nivel = 0.95, ic = T, colas = 2)
</code></pre>

<hr>
<h2 id='iconfianza.percentil.kc'>confidence interval por the median using KC Method</h2><span id='topic+iconfianza.percentil.kc'></span>

<h3>Description</h3>

<p>confidence interval por the median using KC Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.percentil.kc(
  datos,
  q = 0.5,
  nivel = 0.95,
  ic = T,
  colas = 2,
  use.t = F
)
</code></pre>

<hr>
<h2 id='iconfianza.x'>confidence interval for a point (using arithmetic mean)</h2><span id='topic+iconfianza.x'></span>

<h3>Description</h3>

<p>confidence interval for a point (using arithmetic mean)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iconfianza.x(datos, nivel = 0.95, ic = T, colas = 2, use.t = F)
</code></pre>

<hr>
<h2 id='maxFixNA'>max function, removing Inf and -Inf</h2><span id='topic+maxFixNA'></span>

<h3>Description</h3>

<p>max function, removing Inf and -Inf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxFixNA(minputdata)
</code></pre>

<hr>
<h2 id='maxnvalores'>highest n values of a data set, removing Inf and -Inf</h2><span id='topic+maxnvalores'></span>

<h3>Description</h3>

<p>highest n values of a data set, removing Inf and -Inf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxnvalores(mis.datos, n.max = 1)
</code></pre>

<hr>
<h2 id='mem-package'>mem: The Moving Epidemic Method</h2><span id='topic+mem'></span><span id='topic+mem-package'></span>

<h3>Description</h3>

<p>The Moving Epidemic Method, created by T Vega and JE Lozano (2012, 2015) <a href="https://doi.org/10.1111/j.1750-2659.2012.00422.x">doi:10.1111/j.1750-2659.2012.00422.x</a>, <a href="https://doi.org/10.1111/irv.12330">doi:10.1111/irv.12330</a>, allows the weekly assessment of the epidemic and intensity status to help in routine respiratory infections surveillance in health systems. Allows the comparison of different epidemic indicators, timing and shape with past epidemics and across different regions or countries with different surveillance systems. Also, it gives a measure of the performance of the method in terms of sensitivity and specificity of the alert week.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/lozalojo/mem">https://github.com/lozalojo/mem</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/lozalojo/mem/issues">https://github.com/lozalojo/mem/issues</a>
</p>
</li></ul>


<hr>
<h2 id='memevolution'>Evolution of estimators</h2><span id='topic+memevolution'></span>

<h3>Description</h3>

<p>Function <code>memevolution</code> analyzes the evolution of mem estimators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memevolution(
  i.data,
  i.evolution.seasons = 10,
  i.evolution.method = "sequential",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memevolution_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="memevolution_+3A_i.evolution.seasons">i.evolution.seasons</code></td>
<td>
<p>Maximum number of seasons to use.</p>
</td></tr>
<tr><td><code id="memevolution_+3A_i.evolution.method">i.evolution.method</code></td>
<td>
<p>method to calculate evolution.</p>
</td></tr>
<tr><td><code id="memevolution_+3A_...">...</code></td>
<td>
<p>other parameters passed to memmodel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shows the evolution of some indicators across time. The indicators are: duration of the epidemic,
start of the epidemic, epidemic percentage, pre-epidemic, post-epidemic and intensity thresholds.
</p>
<p>Values per season are the estimates of the indicator for this specific season calculated according the
<a href="#topic+memmodel">memmodel</a> options: cross or sequential (validation option), maximum number of seasons to use in calculations.
In <a href="#topic+memmodel">memmodel</a> is it also possible to select the method used to calculate indicators and the level of
confidence of the confidence intervals.
</p>
<p>To clarify how it is calculated, the <code>evolution.seasons</code> showss for each x-axis point the seasons
selected to calculate thresholds. Each row is a different season and in each column it is shown if that
specific season has been used to calculate the indicators. If <code>TRUE</code>, it has been used, if <code>NO</code>, it hasn't.
In the last row, called Next, the indicators are calculated for the upcoming next season.
</p>
<p>Note that if you select sequential validation, first points in the graphs calculate thresholds
using less data (there are less seasons before the current data than the max. seasons value), and
this will affect the range of confidence intervals.
</p>
<p>There are four indicators:
</p>

<ul>
<li><p> Duration: Average duration of the epidemic and its confidence interval.
</p>
</li>
<li><p> Start: Average start of the epidemic and its confidence interval.
</p>
</li>
<li><p> Epidemic percentage: The sum of the values (cases/rates) in the epidemic period
divided by the total sum of values of the whole surveillance period. It's a coverage percentage
of the epidemic period. And its confidence interval.
</p>
</li>
<li><p> Thresholds: Pre-epidemic, post-epidemic and intensity thresholds.
</p>
</li></ul>

<p>The confidence intervals for these indicators are calculated using the other CI and other CI.
level parameters of <a href="#topic+memmodel">memmodel</a>.
</p>


<h3>Value</h3>

<p><code>memevolution</code> returns a list.
A list containing at least the following components:
</p>

<ul>
<li><p>evolution.data data for each value analysed.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# evolution of estimators
evolution &lt;- memevolution(flucyl)
evolution$evolution.data
</code></pre>

<hr>
<h2 id='memgoodness'>Goodness of fit of the mem</h2><span id='topic+memgoodness'></span>

<h3>Description</h3>

<p>Function <code>memgoodness</code> calculates different indicators related to the goodness of the MEM
for detecting the epidemics, using data from the model and using all data in the original dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memgoodness(
  i.data,
  i.seasons = 10,
  i.type.threshold = 5,
  i.level.threshold = 0.95,
  i.tails.threshold = 1,
  i.type.intensity = 6,
  i.level.intensity = c(0.4, 0.9, 0.975),
  i.tails.intensity = 1,
  i.type.curve = 2,
  i.level.curve = 0.95,
  i.type.other = 2,
  i.level.other = 0.95,
  i.method = 2,
  i.param = 2.8,
  i.n.max = -1,
  i.type.boot = "norm",
  i.iter.boot = 10000,
  i.calculation.method = "default",
  i.goodness.method = "cross",
  i.goodness.threshold = NA,
  i.goodness.intensity = NA,
  i.detection.values = seq(1, 5, 0.1),
  i.weeks.above = 1,
  i.output = ".",
  i.graph = F,
  i.prefix = "",
  i.min.seasons = 6
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memgoodness_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.seasons">i.seasons</code></td>
<td>
<p>Maximum number of seasons to use.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.type.threshold">i.type.threshold</code></td>
<td>
<p>Type of confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.level.threshold">i.level.threshold</code></td>
<td>
<p>Level of confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.tails.threshold">i.tails.threshold</code></td>
<td>
<p>Tails for the confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.type.intensity">i.type.intensity</code></td>
<td>
<p>Type of confidence interval to calculate the intensity thresholds.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.level.intensity">i.level.intensity</code></td>
<td>
<p>Levels of confidence interval to calculate the intensity thresholds.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.tails.intensity">i.tails.intensity</code></td>
<td>
<p>Tails for the confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.type.curve">i.type.curve</code></td>
<td>
<p>Type of confidence interval to calculate the modelled curve.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.level.curve">i.level.curve</code></td>
<td>
<p>Level of confidence interval to calculate the modelled curve.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.type.other">i.type.other</code></td>
<td>
<p>Type of confidence interval to calculate length, start and percentages.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.level.other">i.level.other</code></td>
<td>
<p>Level of confidence interval to calculate length, start and percentages.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.method">i.method</code></td>
<td>
<p>Method to calculate the optimal timing of the epidemic.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.param">i.param</code></td>
<td>
<p>Parameter to calculate the optimal timing of the epidemic.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.n.max">i.n.max</code></td>
<td>
<p>Number of pre-epidemic values used to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.type.boot">i.type.boot</code></td>
<td>
<p>Type of bootstrap technique.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.iter.boot">i.iter.boot</code></td>
<td>
<p>Number of bootstrap iterations.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.calculation.method">i.calculation.method</code></td>
<td>
<p>method of determining true/false positives and true/false negatives.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.goodness.method">i.goodness.method</code></td>
<td>
<p>method to calculate goodness.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.goodness.threshold">i.goodness.threshold</code></td>
<td>
<p>pre/post epidemic thresholds for threshold goodness method.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.goodness.intensity">i.goodness.intensity</code></td>
<td>
<p>intensitie thresholds (medium, high, very high) for threshold goodness method.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.detection.values">i.detection.values</code></td>
<td>
<p>values to use in the i.param value of <code>memtiming</code>.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.weeks.above">i.weeks.above</code></td>
<td>
<p>number of weeks over the threshold to give the alert.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.output">i.output</code></td>
<td>
<p>output directory for graphs.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.graph">i.graph</code></td>
<td>
<p>whether the graphs must be written or not.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.prefix">i.prefix</code></td>
<td>
<p>prefix used for naming graphs.</p>
</td></tr>
<tr><td><code id="memgoodness_+3A_i.min.seasons">i.min.seasons</code></td>
<td>
<p>minimum number of seasons to perform goodness, default=6.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The indicators calculated are sensitivity, specificity, positive predictive value, negative
predictive value, percent agreement and the Matthews correlation coefficient.
</p>
<p>How goodness is calculated:
</p>
<p>MEM calculates goodness indicators in an iterative process. In each iteration:
</p>

<ol>
<li><p> For one particular season the timing is calculated to determine which weeks are inside
the pre, post and epidemic periods. This is used as the real data: a real positive outcome
(epidemic weeks) and a real negative outcome (pre and post-epidemic weeks).
</p>
</li>
<li><p> With a set of seasons, pre-epidemic threshold is calculated. This threshold is compared
with values from the season selected in the first step and see if values are above or below the
threshold. This is used as the observed data: an observed positive outcome (week value above
the threshold), and observed negative outcome (week value below the threshold).
</p>
</li>
<li><p> Each week has a real and an observed outcome, so it can be classified in:
</p>

<ul>
<li><p> True positives (TP): real positive, observed positive: values of the epidemic period above the threshold.
</p>
</li>
<li><p> True negatives (TN): real negative, observed negative: values of the non-epidemic period below the threshold.
</p>
</li>
<li><p> False positives (FP): real negative, observed positive: values of the non-epidemic period above the threshold.
</p>
</li>
<li><p> False negatives (FN): real positive, observed negative: values of the epidemic period below the threshold.
</p>
</li></ul>

</li>
<li><p> The process is repeated for each season in the dataset (each iteration a different value
until all seasons have been processed).
</p>
</li>
<li><p> All TP, TN, FP and FN are pooled together and sensitivity, specificity, positive predictive value,
negative predictive value, percent agreement and the Matthews correlation coefficient are calculated.
</p>
</li></ol>

<p>There are two ways of deciding the set of seasons used to calculate the pre-epidemic threshold in each
iteration and it is determined by the <code>i.goodness.method</code>.
</p>

<ul>
<li><p> cross: For each value, the surrounding seasons (after or before the current value) are selected up
to the number of Max. seasons (parameter of the Model box). To calculate the thresholds for season 2010/2011,
data from 2005/2006 to 2009/2010 and from 2011/20012 to 2015/2016 will be taken.
</p>
</li>
<li><p> sequential: Only preceding seasons are used (before the current value) up to the number of Max. seasons.
To calculate the thresholds for season 2010/2011, data from 2000/2001 to 2009/2010 are taken.
</p>
</li>
<li><p> threshold: The pre/post epidemic and intensity thresholds are fixed values for all the seasons and
are compared with the epidemic as determined by MEM algorithm.
</p>
</li></ul>

<p>The <code>i.calculation.method</code> is used to determine when the alert based on the epidemic threshold.
The &quot;default&quot; method sets all values above the threshold as epidemic, and all the values below as non-epidemic.
Pre-epidemic threshold is used for values before the peak, and post-epidemic threshold for values after
the peak.
The &quot;alternative&quot; method sets an epidemic start and epidemic end, all the values in between are epidemic values.
The epidemic start is when <code>i.weeks.above</code> (default=1) consecutive weeks are above the pre-epidemic threshold.
The epidemic end is the first week below the post-epidemic threshold after the epidemic start.
Note that if no post-epidemic threshold is provided, the pre-epidemic value is used instead.
</p>


<h3>Value</h3>

<p><code>memgoodness</code> returns a list.
A list containing at least the following components:
</p>

<ul>
<li><p>validity.data data for each value analysed.
</p>
</li>
<li><p>results Total weeks, non-missing weeks, true positives, false positives
true negatives, false negatives, sensitivity, specificity .
</p>
</li>
<li><p>peaks distribution of the levels of intensity of the peaks.
</p>
</li>
<li><p>peaks.data Peak value, week of the peak value, epidemic and intensity thresholds and intensity level of each season analysed.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Goodness of fit
epi.good &lt;- memgoodness(flucyl, i.detection.values = seq(2.6, 2.8, 0.1))
epi.good$results
epi.good$peaks
</code></pre>

<hr>
<h2 id='memintensity'>Thresholds for influenza intensity</h2><span id='topic+memintensity'></span>

<h3>Description</h3>

<p>Function <code>memintensity</code> is used to calculate the thresholds for influenza activity
using historical records (surveillance rates).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memintensity(i.flu)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memintensity_+3A_i.flu">i.flu</code></td>
<td>
<p>An object of class <code>mem</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is based on the Moving Epidemics Method (MEM) used to monitor influenza
activity in a weekly surveillance system.
</p>
<p>Input data is a data frame containing rates that represent historical influenza surveillance
data. It can start and end at any given week (tipically at week 40th), and rates can be
expressed as per 100,000 inhabitants (or per consultations, if population is not
available) or any other scale.
</p>
<p>MEM is used to locate the epidemic for each season. Then confidence intervals are
calculated at different levels.
</p>
<p>The parameter <code>i.levels</code>, define the three levels of the confidence intervals
used to calculate thresholds.
</p>
<p>The <code>i.n.max</code> parameter indicates how many epidemic values to use to calculate
the thresholds. A value of -1 indicates the program to use an appropiate number of
points depending on the number of seasons provided as input.
</p>
<p>The <code>i.seasons</code> parameter indicates how many seasons are used for calculating
thresholds. A value of -1 indicates the program to use as many as possible. If there
are less than this parameter, the program used all seasons avalaible.
</p>
<p>Intensity thresholds and Epidemic threshold defines 5 levels of intensity:
</p>

<ol>
<li><p> Baseline level - Below epidemic threshold.
</p>
</li>
<li><p> Low level - Above epidemic threshold and below low intensity threshold.
</p>
</li>
<li><p> Medium level - Above low intensity threshold and below medium intensity threshold.
</p>
</li>
<li><p> High level - Above medium intensity threshold and below high intensity threshold.
</p>
</li>
<li><p> Very high level - Above high intensity threshold.
</p>
</li></ol>



<h3>Value</h3>

<p><code>memintensity</code> returns a list with three objects, two of them are the parameters
used (<code>param.levels</code> and <code>param.seasons</code>) and the third one
(<code>intensity.thresholds</code>) is a matrix 1x4 with the epidemic and intensity thresholds.
</p>

<ol>
<li><p> Epidemic threshold.
</p>
</li>
<li><p> Low intensity threshold.
</p>
</li>
<li><p> Medium intensity threshold.
</p>
</li>
<li><p> High intensity threshold.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# mem model
flucyl.mem &lt;- memmodel(flucyl)
# Calculates intensity thresholds
intensity &lt;- memintensity(flucyl.mem)
intensity
</code></pre>

<hr>
<h2 id='memmodel'>Methods for influenza modelization</h2><span id='topic+memmodel'></span><span id='topic+summary.flu+2Cplot.flu+2Cprint.flu'></span>

<h3>Description</h3>

<p>Function <code>memmodel</code> is used to calculate the threshold for influenza epidemic using historical
records (surveillance rates).
</p>
<p>The method to calculate the threshold is described in the Moving Epidemics Method (MEM) used to
monitor influenza activity in a weekly surveillance system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memmodel(
  i.data,
  i.seasons = 10,
  i.type.threshold = 5,
  i.level.threshold = 0.95,
  i.tails.threshold = 1,
  i.type.intensity = 6,
  i.level.intensity = c(0.4, 0.9, 0.975),
  i.tails.intensity = 1,
  i.type.curve = 2,
  i.level.curve = 0.95,
  i.type.other = 3,
  i.level.other = 0.95,
  i.method = 2,
  i.param = 2.8,
  i.centering = -1,
  i.n.max = -1,
  i.type.boot = "norm",
  i.iter.boot = 10000,
  i.mem.info = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memmodel_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.seasons">i.seasons</code></td>
<td>
<p>Maximum number of seasons to use.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.type.threshold">i.type.threshold</code></td>
<td>
<p>Type of confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.level.threshold">i.level.threshold</code></td>
<td>
<p>Level of confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.tails.threshold">i.tails.threshold</code></td>
<td>
<p>Tails for the confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.type.intensity">i.type.intensity</code></td>
<td>
<p>Type of confidence interval to calculate the intensity thresholds.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.level.intensity">i.level.intensity</code></td>
<td>
<p>Levels of confidence interval to calculate the intensity thresholds.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.tails.intensity">i.tails.intensity</code></td>
<td>
<p>Tails for the confidence interval to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.type.curve">i.type.curve</code></td>
<td>
<p>Type of confidence interval to calculate the modelled curve.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.level.curve">i.level.curve</code></td>
<td>
<p>Level of confidence interval to calculate the modelled curve.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.type.other">i.type.other</code></td>
<td>
<p>Type of confidence interval to calculate length, start and percentages.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.level.other">i.level.other</code></td>
<td>
<p>Level of confidence interval to calculate length, start and percentages.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.method">i.method</code></td>
<td>
<p>Method to calculate the optimal timing of the epidemic.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.param">i.param</code></td>
<td>
<p>Parameter to calculate the optimal timing of the epidemic.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.centering">i.centering</code></td>
<td>
<p>Number of weeks to center the moving seasons.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.n.max">i.n.max</code></td>
<td>
<p>Number of pre-epidemic values used to calculate the threshold.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.type.boot">i.type.boot</code></td>
<td>
<p>Type of bootstrap technique.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.iter.boot">i.iter.boot</code></td>
<td>
<p>Number of bootstrap iterations.</p>
</td></tr>
<tr><td><code id="memmodel_+3A_i.mem.info">i.mem.info</code></td>
<td>
<p>include information about the package in the graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data is a data frame containing rates that represent historical influenza surveillance
data. It can start and end at any given week (tipically at week 40th), and rates can be
expressed as per 100,000 inhabitants (or per consultations, if population is not
available) or any other scale.
</p>
<p>Parameters <code>i.type</code>, <code>i.type.threshold</code> and <code>i.type.curve</code> defines how to
calculate confidence intervals along the process.
</p>
<p><code>i.type.curve</code> is used for calculating the typical influenza curve,
<code>i.type.threshold</code> is used to calculate the pre and post epidemic threshold and
<code>i.type</code> is used for any other confidende interval used in the method.
</p>
<p>All three parameters must be a number between <code>1</code> and <code>6</code>:
</p>

<ul>
<li><p>1 Arithmetic mean and mean confidence interval.
</p>
</li>
<li><p>2 Geometric mean and mean confidence interval.
</p>
</li>
<li><p>3 Median and the Nyblom/normal aproximation confidence interval.
</p>
</li>
<li><p>4 Median and bootstrap confidence interval.
</p>
</li>
<li><p>5 Arithmetic mean and point confidence interval (standard deviations).
</p>
</li>
<li><p>6 Geometric mean and point confidence interval (standard deviations).
</p>
</li></ul>

<p>Option <code>3</code> uses the Hettmansperger and Sheather (1986) and Nyblom (1992) method,
when there is enough sample size. If sample size is small, then the normal aproximation
will be used as described in Conover, 1980, p. 112. Refer to EnvStats package for
more information.
</p>
<p>Option <code>4</code> uses two more parameters: <code>i.type.boot</code> indicates which bootstrap
method to use. The values are the same of those of the <code><a href="boot.html#topic+boot.ci">boot.ci</a></code> function.
Parameter <code>i.iter.boot</code> indicates the number of bootstrap samples to use. See
<code><a href="boot.html#topic+boot">boot</a></code> for more information about this topic.
</p>
<p>Parameters <code>i.level</code>, <code>i.level.threshold</code> and <code>i.level.curve</code> indicates,
respectively, the level of the confidence intervals described above.
</p>
<p>The <code>i.n.max</code> parameter indicates how many pre epidemic values to use to calculate
the threshold. A value of -1 indicates the program to use an appropiate number of points
depending on the number of seasons provided as input. <code>i.tails</code> tells the program
to use 1 or 2 tailed confidence intervals when calculating the threshold (1 is
recommended).
</p>
<p>Parameters <code>i.method</code> and <code>i.param</code> indicates how to find the optimal timing
of the epidemics. See <code><a href="#topic+memtiming">memtiming</a></code> for details on the values this parameters
can have.
</p>
<p>It is important to know how to arrange information in order to use with memapp. The key points are:
</p>

<ul>
<li><p> One single epidemic wave each season.
</p>
</li>
<li><p> Never delete a rate inside an epidemic.
</p>
</li>
<li><p> Accommodate week 53.
</p>
</li>
<li><p> Do not inflate missing values with zeroes.
</p>
</li></ul>

<p>Data must contain information from the historical series. Surveillance period can start and end at
any given week (typically start at week 40th and ends at week 20th), and data can have any units and
can be expressed in any scale (typically rates per 100,000 inhabitants or consultations).
</p>
<p>The table must have one row per epidemiological week and one column per surveillance season. A season
is a full surveillance period from the beginning to the end, where occurs at some point one single
epidemic wave on it. No epidemic wave can be spared in two consecutive seasons. If so, you have to
redefine the start and end of the season defined in your dataset. If a season have two waves, it must
be split in two periods and must be named accordingly with the seasons name conventions described
below. Each cell contains the value for a given week in a given season.
</p>
<p>The first column should contain the names of the weeks. When the season contains two different calendar
years, the week will go from 40th of the first year to 52nd, and then from 1st to 20th. When the season
contains one year, the weeks will go from 1st to 52nd.
</p>
<p>Note: If there is no column with week names, the application will name the weeks numbering from 1 to
the number of rows.
</p>

<ul>
<li><p> In the northern hemisphere countries, the surveillance period usually goes from
week 40 to 20 of the following year (notation: season 2016/2017).
</p>
</li>
<li><p> In the southern hemisphere countries, the surveillance period usually goes from
week 18 to 39 same year (notation: season 2017).
</p>
</li></ul>

<p>The first row must contain the names of the seasons. This application understand the naming of a
season when it contains one or two four digits year separated by / and one one-digit number
between parenthesis to identify the wave number. The wave number part in a name of a season is
used when a single surveillance period has two epidemic waves that have to be separated in order
to have reliable results. In this case, each wave is placed in different columns and named ending
with (1) for the first period, (2) for the second, and so on.
</p>


<h3>Value</h3>

<p><code>memmodel</code> returns an object of class <code>mem</code>.
An object of class <code>mem</code> is a list containing at least the following components:
</p>

<ul>
<li><p>i.data input data
</p>
</li>
<li><p>pre.post.intervals Pre/post confidence intervals (Threhold is the upper limit
of the confidence interval).
</p>
</li>
<li><p>ci.length Mean epidemic length confidence interval.
</p>
</li>
<li><p>ci.percent Mean covered percentage confidence interval.
</p>
</li>
<li><p>mean.length Mean length.
</p>
</li>
<li><p>moving.epidemics Moving epidemic rates.
</p>
</li>
<li><p>mean.start Mean epidemic start.
</p>
</li>
<li><p>epi.intervals Epidemic levels of intensity.
</p>
</li>
<li><p>typ.curve Typical epidemic curve.
</p>
</li>
<li><p>n.max Effective number of pre epidemic values.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>
<p>Hettmansperger, T. P., and S. J Sheather. 1986. Confidence Intervals Based on Interpolated Order
Statistics. Statistics and Probability Letters 4: 75-79. doi:10.1016/0167-7152(86)90021-0.
</p>
<p>Nyblom, J. 1992. Note on Interpolated Order Statistics. Statistics and Probability Letters 14:
129-31. doi:10.1016/0167-7152(92)90076-H.
</p>
<p>Conover, W.J. (1980). Practical Nonparametric Statistics. Second Edition. John Wiley and Sons, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Finds the timing of the first season: 2001/2002
epi &lt;- memmodel(flucyl)
print(epi)
summary(epi)
plot(epi)
</code></pre>

<hr>
<h2 id='memstability'>Stability of indicators</h2><span id='topic+memstability'></span>

<h3>Description</h3>

<p>Function <code>memstability</code> perform an analisys of stability of estimators
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memstability(i.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memstability_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="memstability_+3A_...">...</code></td>
<td>
<p>other parameters passed to memmodel.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Shows the stability of the main indicators according the number of seasons used to calculate them.
That allows to decide the minimum and maximum number of seasons to be included in the model for this
specific country and parameter.
</p>
<p>These indicators are calculated for the next upcoming season, so for all the iterations are used the
last number of seasons determined by the x-axis, so that 2 means 'last two seasons', 10 means
'last ten seasons' and so on.
</p>
<p>The <code>stability.seasons</code> output shows data used to calculate each particular point in the graph.
</p>


<h3>Value</h3>

<p><code>memstability</code> returns a list.
A list containing at least the following components:
</p>

<ul>
<li><p>stability.data data for each value analysed.
</p>
</li>
<li><p>stability.seasons seasons used for each iteration.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Stability
stability &lt;- memstability(flucyl)
stability$stability.data
</code></pre>

<hr>
<h2 id='memsurveillance'>Creates the surveillance graph of the current season</h2><span id='topic+memsurveillance'></span>

<h3>Description</h3>

<p>Function <code>memsurveillance</code> creates a surveillance graph for the current season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memsurveillance(
  i.current,
  i.epidemic.thresholds = NA,
  i.intensity.thresholds = NA,
  i.mean.length = 10,
  i.force.length = F,
  i.output = ".",
  i.graph.title = "",
  i.graph.subtitle = "",
  i.graph.file = T,
  i.graph.file.name = "",
  i.week.report = NA,
  i.equal = F,
  i.pos.epidemic = F,
  i.no.epidemic = F,
  i.no.intensity = F,
  i.epidemic.start = NA,
  i.range.x = c(40, 20),
  i.range.x.53 = F,
  i.range.y = NA,
  i.no.labels = F,
  i.start.end.marks = T,
  i.mem.info = T
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memsurveillance_+3A_i.current">i.current</code></td>
<td>
<p>Current season weekly rates.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.epidemic.thresholds">i.epidemic.thresholds</code></td>
<td>
<p>Pre and post epidemic threholds.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.intensity.thresholds">i.intensity.thresholds</code></td>
<td>
<p>Intensity thresholds.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.mean.length">i.mean.length</code></td>
<td>
<p>Mean length of epidemic.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.force.length">i.force.length</code></td>
<td>
<p>If you want to force the epidemic to be exactly as the mean length.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.output">i.output</code></td>
<td>
<p>Directory where graph is saved.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.graph.title">i.graph.title</code></td>
<td>
<p>Title of the graph.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.graph.subtitle">i.graph.subtitle</code></td>
<td>
<p>Subtitle of the graph.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.graph.file">i.graph.file</code></td>
<td>
<p>Graph to a file.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.graph.file.name">i.graph.file.name</code></td>
<td>
<p>Name of the graph.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.week.report">i.week.report</code></td>
<td>
<p>Week to use in the report.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.equal">i.equal</code></td>
<td>
<p>If post epidemic and preepidemic thresholds must be equal (force post epidemic to be equal to the pre epidemic threshold).</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.pos.epidemic">i.pos.epidemic</code></td>
<td>
<p>Print post epidemic threhsold.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.no.epidemic">i.no.epidemic</code></td>
<td>
<p>Force no start of the epidemic, print only the epidemic threshold.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.no.intensity">i.no.intensity</code></td>
<td>
<p>Do not print intensity threholds.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.epidemic.start">i.epidemic.start</code></td>
<td>
<p>Week to force start of the epidemic.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.range.x">i.range.x</code></td>
<td>
<p>Range of weeks.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.range.x.53">i.range.x.53</code></td>
<td>
<p>Is there a week 53 this season.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.range.y">i.range.y</code></td>
<td>
<p>Range of graph.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.no.labels">i.no.labels</code></td>
<td>
<p>Do not use labels.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.start.end.marks">i.start.end.marks</code></td>
<td>
<p>Do not place start and end marks of the epidemic.</p>
</td></tr>
<tr><td><code id="memsurveillance_+3A_i.mem.info">i.mem.info</code></td>
<td>
<p>include information about the package in the graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data must be the current season and an object of class <code>mem</code>. The output
graph contains the weekly rates series along with the epidemic and intensity threshols
located at the exact situation where the epidemic started. If there is no epidemic yet,
only the epidemic threshold is placed.
</p>
<p>Surveillance consist on:
</p>

<ol>
<li><p> Draw weekly values along with the pre-epidemic threshold.
</p>
</li>
<li><p> When the weekly value rises above the threshold a marker of the start of
the epidemic is placed and the intensity thresholds are drawn.
</p>
</li>
<li><p> When the weekly value goes down the post-epidemic threshold, the marker of
the end of the epidemic is placed and the post-epidemic threshold is added to the graph.
</p>
</li></ol>

<p>The Surveillance Week allows select the week to use in the surveillance, the values of
the surveillance season are shown only up to this week, and the program will ignore
values past this week.
</p>
<p>The Force epidemic start allows to force the placement of the epidemic start marker
at a given week instead of using the first week above the epidemic threshold.
</p>


<h3>Value</h3>

<p><code>memsurveillance</code> writes a tiff graph of the surveillance of this season.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Castilla y Leon Influenza Rates data
data(flucyl)
# Data of the last season
cur &lt;- flucyl[8]
# The model
epi &lt;- memmodel(flucyl[1:7])
# Epidemic thresholds
e.thr &lt;- epi$epidemic.thresholds
# Intensity threhsolds
i.thr &lt;- epi$intensity.thresholds
# Set the working directory to whererever you want to store the graph file
setwd(".")
# The graph, default values
# uncomment to execute
# m1 &lt;- memsurveillance(cur, e.thr, i.thr,
#    i.graph.file = TRUE,
#    i.graph.file.name = "graph 1"
# )
# No intensity levels
# m2 &lt;- memsurveillance(cur, e.thr, i.thr,
#    i.graph.file = TRUE,
#    i.graph.file.name = "graph 2", i.no.intensity = TRUE
# )
# No start/end tickmarks
# m3 &lt;- memsurveillance(cur, e.thr, i.thr,
#    i.graph.file = TRUE,
#    i.graph.file.name = "graph 3", i.start.end.marks = FALSE
# )
# Post-epidemic threshold
# m4 &lt;- memsurveillance(cur, e.thr, i.thr,
#    i.graph.file = TRUE,
#    i.graph.file.name = "graph 4", i.pos.epidemic = TRUE
# )
# Report for week 2, instead of all data
# m5 &lt;- memsurveillance(cur, e.thr, i.thr,
#    i.graph.file = TRUE,
#    i.graph.file.name = "graph 5", i.week.report = 2
# )


</code></pre>

<hr>
<h2 id='memsurveillance.animated'>Creates the animated  graph of the surveillance of the current season</h2><span id='topic+memsurveillance.animated'></span>

<h3>Description</h3>

<p>Function <code>memsurveillance.animated</code> creates an animated surveillance graph for the current season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memsurveillance.animated(
  i.current,
  i.epidemic.thresholds = NA,
  i.intensity.thresholds = NA,
  i.output = ".",
  i.animated.graph.file = T,
  i.animated.graph.file.name = "animated",
  i.fps = 2,
  i.loop = 0,
  i.remove = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memsurveillance.animated_+3A_i.current">i.current</code></td>
<td>
<p>Current season weekly rates.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.epidemic.thresholds">i.epidemic.thresholds</code></td>
<td>
<p>Pre and post epidemic threholds.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.intensity.thresholds">i.intensity.thresholds</code></td>
<td>
<p>Intensity thresholds.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.output">i.output</code></td>
<td>
<p>Directory where graph is saved.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.animated.graph.file">i.animated.graph.file</code></td>
<td>
<p>If a animated gif should be produced, or just the intermediate graphics</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.animated.graph.file.name">i.animated.graph.file.name</code></td>
<td>
<p>Name of the animated graph.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.fps">i.fps</code></td>
<td>
<p>Number of frames per second of the animated gif.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.loop">i.loop</code></td>
<td>
<p>Number of loops for the animated dif, 0 for Infinite.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_i.remove">i.remove</code></td>
<td>
<p>Remove partial graphs.</p>
</td></tr>
<tr><td><code id="memsurveillance.animated_+3A_...">...</code></td>
<td>
<p>Additional parameters parsed to memsurveillance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data must be the current season and an object of class <code>mem</code>. The output
graph contains the weekly rates series along with the epidemic and intensity threshols
located at the exact situation where the epidemic started. If there is no epidemic yet,
only the epidemic threshold is placed.
</p>
<p>See <a href="#topic+memsurveillance">memsurveillance</a> for more details
</p>


<h3>Value</h3>

<p><code>memsurveillance.animated</code> writes a gif graph of the surveillance of this season.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Castilla y Leon Influenza Rates data
data(flucyl)
# Data of the last season
cur &lt;- flucyl[8]
# The model
epi &lt;- memmodel(flucyl[1:7])
# Epidemic thresholds
e.thr &lt;- epi$epidemic.thresholds
# Intensity threhsolds
i.thr &lt;- epi$intensity.thresholds
# Set the working directory to whererever you want to store the graph file
setwd(".")
# uncomment to execute
# m1 &lt;- memsurveillance.animated(cur,
#    i.animated.graph.file.name = "Animated",
#    i.epidemic.thresholds = e.thr, i.intensity.thresholds = i.thr, i.pos.epidemic = TRUE,
#    i.animated.graph.file = FALSE
# )


</code></pre>

<hr>
<h2 id='memtiming'>Influenza Epidemic Timing</h2><span id='topic+memtiming'></span><span id='topic+summary.epidemic+2Cplot.epidemic+2Cprint.epidemic'></span>

<h3>Description</h3>

<p>Function <code>memtiming</code> is used to find the optimal timing of an influenza epidemic
in a set of weekly influenza surveillance rates. It provides the start and the end of
the epidemic, also it returns a list of pre-epidemic and post-epidemic rates that can
be used to calculate influenza baselines and thresholds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memtiming(i.data, i.n.values = 5, i.method = 2, i.param = 2.8, i.mem.info = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memtiming_+3A_i.data">i.data</code></td>
<td>
<p>a numeric object  (or one that can be coerced to that class).</p>
</td></tr>
<tr><td><code id="memtiming_+3A_i.n.values">i.n.values</code></td>
<td>
<p>a number, which indicates how many pre-epidemic values are taken from the pre-epidemic period.</p>
</td></tr>
<tr><td><code id="memtiming_+3A_i.method">i.method</code></td>
<td>
<p>a number from 1 to 4, to select which optimization method to use.</p>
</td></tr>
<tr><td><code id="memtiming_+3A_i.param">i.param</code></td>
<td>
<p>an optional parameter used by the method.</p>
</td></tr>
<tr><td><code id="memtiming_+3A_i.mem.info">i.mem.info</code></td>
<td>
<p>include information about the package in the graph.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The method to calculate the optimal timing of an epidemic is described as part of the
<em>Moving Epidemics Method</em> (MEM), used to monitor influenza activity in a weekly
surveillance system.
</p>
<p>Input data is a vector of rates that represent a full influenza surveillance season.
It can start and end at any week (tipically at week 40th), and rates can be expressed
as per 100,000 inhabitants (or per consultations, if population is not available) or
any other scale.
</p>
<p>The <code>i.n.values</code> parameter is used to get information from the pre-epidemic and
post-epidemic period. The function will extract the highest pre/post values in order
to use it later to calculate other influenza indicators, such as baseline activity or
threshold for influenza epidemic.
</p>
<p>Depending of the value <code>i.method</code>, the function will use a different method to
calculate the optimum epidemic timing.
</p>

<ul>
<li><p>1 original method
</p>
</li>
<li><p>2 fixed criterium method
</p>
</li>
<li><p>3 slope method
</p>
</li>
<li><p>4 second derivative method
</p>
</li></ul>

<p>All methods are based upon the MAP curve, as described in the MEM Method.
</p>
<p>The <em>original method</em> uses the process shown in the original paper, which describes
the MEM as it was created. The <em>fixed criterium method</em> is an update of the MEM
that uses the slope of the MAP curve fo find the optimum, which is the point where the
slope is lower than a predefined value. The <em>slope method</em> also calculates the
slope of the MAP curve, but the optimum is the one that matches the global/mean slope.
The <em>second derivative method</em> calculates the second derivative and equals to zero
to search an inflexion point in the original curve.
</p>
<p>Two of the four methods require an additional parameter <code>i.param</code>: for the
<em>fixed criterium method</em> is the predefined value to find the optimum, which
typically is 2.5-3.0%, and for the <em>original method</em> it is needed the window
parameter to smooth the map curve. A value of <code>-1</code> indicates it should use
<code><a href="sm.html#topic+h.select">h.select</a></code> to select the window parameter. See <code><a href="sm.html#topic+sm">sm</a></code> for more
information about this topic.
</p>


<h3>Value</h3>

<p><code>memtiming</code> returns an object of class <code>epidemic</code>.
An object of class <code>epidemic</code> is a list containing at least the following components:
</p>

<ul>
<li><p>i.data input data
</p>
</li>
<li><p>data data with missing rates filled with data from smothing regression
</p>
</li>
<li><p>map.curve MAP curve
</p>
</li>
<li><p>slope.curve slope of the MAP curve
</p>
</li>
<li><p>optimum.map optimum
</p>
</li>
<li><p>pre.epi pre-epidemic highest rates
</p>
</li>
<li><p>epi epidemic highest rates
</p>
</li>
<li><p>post.epi post-epidemic highest rates
</p>
</li>
<li><p>pre.epi.data pre-epidemic rates
</p>
</li>
<li><p>epi.data epidemic rates
</p>
</li>
<li><p>post.epi.data post-epidemic rates
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Finds the timing of the first season: 2001/2002
tim &lt;- memtiming(flucyl[1])
print(tim)
summary(tim)
plot(tim)
</code></pre>

<hr>
<h2 id='memtrend'>Methods for influenza trend calculation</h2><span id='topic+memtrend'></span>

<h3>Description</h3>

<p>Function <code>memtrend</code> is used to calculate the two parameters for defining the
current influenza trend.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>memtrend(
  i.flu,
  i.type = 1,
  i.level = 0.95,
  i.type.boot = "norm",
  i.iter.boot = 10000
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="memtrend_+3A_i.flu">i.flu</code></td>
<td>
<p>An object of class <code>mem</code>.</p>
</td></tr>
<tr><td><code id="memtrend_+3A_i.type">i.type</code></td>
<td>
<p>Type of confidence interval to calculate the trend thresholds.</p>
</td></tr>
<tr><td><code id="memtrend_+3A_i.level">i.level</code></td>
<td>
<p>Level of confidence interval to calculate the trend thresholds.</p>
</td></tr>
<tr><td><code id="memtrend_+3A_i.type.boot">i.type.boot</code></td>
<td>
<p>Type of bootstrap technique.</p>
</td></tr>
<tr><td><code id="memtrend_+3A_i.iter.boot">i.iter.boot</code></td>
<td>
<p>Number of bootstrap iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is based on the Moving Epidemics Method (MEM) used to monitor influenza
activity in a weekly surveillance system.
</p>
<p>Input data is a data frame containing rates that represent historical influenza surveillance
data. It can start and end at any given week (tipically at week 40th), and rates can be
expressed as per 100,000 inhabitants (or per consultations, if population is not
available) or any other scale.
</p>
<p>The <code>i.seasons</code> parameter indicates how many seasons are used for calculating
thresholds. A value of -1 indicates the program to use as many as possible. If there
are less than this parameter, the program used all seasons avalaible.
</p>
<p>There are three different states for trend, to determine the state, the current rate
and the difference of the current and last weekly rate are needed:
</p>

<ul>
<li><p>2 Ascending - When the weekly rate is above the epidemic threshold and
the difference of the current and last weekly rate is higher than Delta OR this is the
first time the rate is above the epidemic threshold.
</p>
</li>
<li><p>3 Descending - When the weekly rate is above the epidemic threshold
and the difference of the current and last weekly rate is lower than Eta OR this is the
first time the rate is below the epidemic threshold after having been above it.
</p>
</li>
<li><p>1 Stable - Otherwise.
</p>
</li></ul>



<h3>Value</h3>

<p><code>memtrend</code> returns a list with two objects, the first one is the parameter used in
the calculations (<code>param.seasons</code>) and the second one (<code>trend.thresholds</code>) is
a matrix 1x2 with the Ascending (Delta) and Descending parameters (Eta).
</p>

<ol>
<li><p> Delta - Ascending parameter.
</p>
</li>
<li><p> Eta - Descending parameter.
</p>
</li></ol>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# mem model
flucyl.mem &lt;- memmodel(flucyl)
# Calculates trend thresholds
trend &lt;- memtrend(flucyl.mem)
trend
</code></pre>

<hr>
<h2 id='minFixNA'>min function, removing Inf and -Inf</h2><span id='topic+minFixNA'></span>

<h3>Description</h3>

<p>min function, removing Inf and -Inf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minFixNA(minputdata)
</code></pre>

<hr>
<h2 id='minnvalores'>lowest n values of a data set, removing Inf and -Inf</h2><span id='topic+minnvalores'></span>

<h3>Description</h3>

<p>lowest n values of a data set, removing Inf and -Inf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>minnvalores(mis.datos, n.min = 1)
</code></pre>

<hr>
<h2 id='missings.inside'>returns position of missing values inside the season. Leading and trailing missing values are not considered.</h2><span id='topic+missings.inside'></span>

<h3>Description</h3>

<p>returns position of missing values inside the season. Leading and trailing missing values are not considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>missings.inside(a)
</code></pre>

<hr>
<h2 id='normalizar'>standarize data to [0,1] interval</h2><span id='topic+normalizar'></span>

<h3>Description</h3>

<p>standarize data to [0,1] interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizar(normalizar.i.datos)
</code></pre>

<hr>
<h2 id='optimal.tickmarks'>Find tickmarks for a given range of the y-axis that best fit an optimal number of tickmarks
you decide. f.i: what if i want to have a graph with 8 tickmarks in a range of 34 to 345</h2><span id='topic+optimal.tickmarks'></span>

<h3>Description</h3>

<p>Find tickmarks for a given range of the y-axis that best fit an optimal number of tickmarks
you decide. f.i: what if i want to have a graph with 8 tickmarks in a range of 34 to 345
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimal.tickmarks(
  i.min,
  i.max,
  i.number.ticks = 10,
  i.valid.ticks = apply(expand.grid(c(1, 2, 2.5, 5), 10^(-10:10)), 1, FUN = function(x)
    {
     x[1] * x[2]
 }),
  i.include.min = F,
  i.include.max = F
)
</code></pre>

<hr>
<h2 id='optimum.by.inspection'>Inspection calcultation of the optimum</h2><span id='topic+optimum.by.inspection'></span>

<h3>Description</h3>

<p>Function <code>optimum.by.inspection</code> perform an analysis of mem parameters
to find the one that fits better a panel of experts inspection criterium.
</p>
<p>To be written
</p>


<h3>Usage</h3>

<pre><code class='language-R'>optimum.by.inspection(
  i.data,
  i.param.values = seq(1, 5, 0.1),
  i.graph = F,
  i.graph.file = F,
  i.graph.file.name = "",
  i.graph.title = "",
  i.graph.subtitle = "",
  i.output = "."
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="optimum.by.inspection_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.param.values">i.param.values</code></td>
<td>
<p>values to use in the i.param value of <code>memtiming</code>.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.graph">i.graph</code></td>
<td>
<p>create a graph with the outputs (T/F).</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.graph.file">i.graph.file</code></td>
<td>
<p>write the graph to a file.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.graph.file.name">i.graph.file.name</code></td>
<td>
<p>name of the output file.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.graph.title">i.graph.title</code></td>
<td>
<p>title of the graph.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.graph.subtitle">i.graph.subtitle</code></td>
<td>
<p>subtitle of the graph.</p>
</td></tr>
<tr><td><code id="optimum.by.inspection_+3A_i.output">i.output</code></td>
<td>
<p>output directory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>optimum.by.inspection</code> returns a list.
An object of class <code>mem</code> is a list containing at least the following components:
</p>
<table>
<tr><td><code>optimum</code></td>
<td>
<p>optimum value.</p>
</td></tr>
<tr><td><code>optimum.data</code></td>
<td>
<p>Data related to the optimum value.</p>
</td></tr>
<tr><td><code>summary.data</code></td>
<td>
<p>Data for all values tested.</p>
</td></tr>
<tr><td><code>inspection.data</code></td>
<td>
<p>Detailed results of each iteration.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Castilla y Leon Influenza Rates data
data(flucyl)
# Inspection. It runs interactively (uncomment to run)
# if (interactive()) {
#   opt.ins &lt;- optimum.by.inspection(flucyl, i.param.values = seq(2.0, 3.0, 0.1))
#   opt.ins$optimum
# }


</code></pre>

<hr>
<h2 id='output.ci'>function to format output</h2><span id='topic+output.ci'></span>

<h3>Description</h3>

<p>function to format output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>output.ci(i.type, i.level, i.tails)
</code></pre>

<hr>
<h2 id='percentage.added'>For use with transformseries.multiple</h2><span id='topic+percentage.added'></span>

<h3>Description</h3>

<p>For use with transformseries.multiple
</p>


<h3>Usage</h3>

<pre><code class='language-R'>percentage.added(i.data, i.n)
</code></pre>

<hr>
<h2 id='processPlots'>Full process plots for mem</h2><span id='topic+processPlots'></span>

<h3>Description</h3>

<p>Function <code>processPlots</code> creates graphs of all mem process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>processPlots(i.flu, i.output = ".", i.prefix = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="processPlots_+3A_i.flu">i.flu</code></td>
<td>
<p>Object of class flu.</p>
</td></tr>
<tr><td><code id="processPlots_+3A_i.output">i.output</code></td>
<td>
<p>Output directory.</p>
</td></tr>
<tr><td><code id="processPlots_+3A_i.prefix">i.prefix</code></td>
<td>
<p>Prefix for all files to be output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create plots related to the process of calculating MEM indicators to an
output directory, showing the MAP curves and the slope of the MAP curve
and how the timing is calculated.
</p>


<h3>Value</h3>

<p><code>processPlots</code> prints a set of graphs.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Castilla y Leon Influenza Rates data
data(flucyl)
# Graphs
epi &lt;- memmodel(flucyl)
# uncomment to execute
# processPlots(epi)


</code></pre>

<hr>
<h2 id='roc.analysis'>Analysis of different indicators to find the optimum value of the window parameter</h2><span id='topic+roc.analysis'></span>

<h3>Description</h3>

<p>Function <code>roc.analysis</code> perform a ROC analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roc.analysis(
  i.data,
  i.param.values = seq(1, 5, 0.1),
  i.min.seasons = 6,
  i.graph = F,
  i.graph.file = F,
  i.graph.file.name = "",
  i.graph.title = "",
  i.graph.subtitle = "",
  i.output = ".",
  i.mem.info = T,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roc.analysis_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.param.values">i.param.values</code></td>
<td>
<p>range of i.param values to test.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.min.seasons">i.min.seasons</code></td>
<td>
<p>minimum number of seasons to perform the analysis, default=6.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.graph">i.graph</code></td>
<td>
<p>create a graph with the outputs (T/F).</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.graph.file">i.graph.file</code></td>
<td>
<p>write the graph to a file.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.graph.file.name">i.graph.file.name</code></td>
<td>
<p>name of the output file.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.graph.title">i.graph.title</code></td>
<td>
<p>title of the graph.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.graph.subtitle">i.graph.subtitle</code></td>
<td>
<p>subtitle of the graph.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.output">i.output</code></td>
<td>
<p>output directory.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_i.mem.info">i.mem.info</code></td>
<td>
<p>include information about the package in the graph.</p>
</td></tr>
<tr><td><code id="roc.analysis_+3A_...">...</code></td>
<td>
<p>other paramaters to be used by memgoodness function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Optimize is an iterative process that calculates goodness indicators using different window
parameters for the fixed criterium and compares all estimators in order to find the optimum
window parameter.
</p>
<p>The output shows the different window parameters and their respective indicators to decide
which one is better for your data.
</p>


<h3>Value</h3>

<p><code>roc.analysis</code> returns a list.
An object of class <code>mem</code> is a list containing at least the following components:
</p>

<ul>
<li><p>optimum optimum value.
</p>
</li>
<li><p>results Detailed results of each iteration.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# ROC analysis
epi.roc &lt;- roc.analysis(flucyl,
  i.param.values = seq(2.6, 2.8, 0.1),
  i.detection.values = seq(2.6, 2.8, 0.1)
)
epi.roc$results
</code></pre>

<hr>
<h2 id='semana.absoluta'>Transforms relative weeks to absolute weeks in a 1-52 normal season</h2><span id='topic+semana.absoluta'></span>

<h3>Description</h3>

<p>Transforms relative weeks to absolute weeks in a 1-52 normal season
</p>


<h3>Usage</h3>

<pre><code class='language-R'>semana.absoluta(i.semana, i.semana.inicio)
</code></pre>

<hr>
<h2 id='suavizado'>smoothing regression function</h2><span id='topic+suavizado'></span>

<h3>Description</h3>

<p>smoothing regression function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suavizado(i.datos, hsuav = -1)
</code></pre>

<hr>
<h2 id='transformdata'>Data transformation</h2><span id='topic+transformdata'></span>

<h3>Description</h3>

<p>Function <code>transformdata</code> transforms data from year,week,rate to week,rate1,...,rateN
suitable to use with mem.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformdata(
  i.data,
  i.range.x = NA,
  i.name = "rates",
  i.max.na.per = 100,
  i.function = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformdata_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="transformdata_+3A_i.range.x">i.range.x</code></td>
<td>
<p>First and last surveillance week.</p>
</td></tr>
<tr><td><code id="transformdata_+3A_i.name">i.name</code></td>
<td>
<p>Name of the column to transform.</p>
</td></tr>
<tr><td><code id="transformdata_+3A_i.max.na.per">i.max.na.per</code></td>
<td>
<p>maximum percentage of na's in a season allowable, otherwise, the season is removed</p>
</td></tr>
<tr><td><code id="transformdata_+3A_i.function">i.function</code></td>
<td>
<p>function used to aggregate data when duplicate values are found for the same season and week, defaults to NULL (no aggregate function)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transform data from format year, week, rate to a format suitable to be used
with <a href="#topic+mem">mem</a>, that is, one column with each season in the dataset and the
week names as rownames of the data.frame.
</p>


<h3>Value</h3>

<p><code>transformdata</code> returns a data.frame where each column has a different season and
rownames are the name of the epidemiological week.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucylraw)
# Transform data
newdata &lt;- transformdata(flucylraw, i.range.x = c(40, 20))$data
epi &lt;- memmodel(newdata)
print(epi)
summary(epi)
plot(epi)
</code></pre>

<hr>
<h2 id='transformdata.back'>Data transformation</h2><span id='topic+transformdata.back'></span>

<h3>Description</h3>

<p>Function <code>transformdata.back</code> transforms data from week,rate1,...,rateN to year,week,rate
format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformdata.back(
  i.data,
  i.name = "rates",
  i.cutoff.original = NA,
  i.range.x.final = NA,
  i.fun = mean
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformdata.back_+3A_i.data">i.data</code></td>
<td>
<p>Data frame of input data.</p>
</td></tr>
<tr><td><code id="transformdata.back_+3A_i.name">i.name</code></td>
<td>
<p>Name of the column that contains the values.</p>
</td></tr>
<tr><td><code id="transformdata.back_+3A_i.cutoff.original">i.cutoff.original</code></td>
<td>
<p>Cutoff point between seasons when they have two years</p>
</td></tr>
<tr><td><code id="transformdata.back_+3A_i.range.x.final">i.range.x.final</code></td>
<td>
<p>Range of the surveillance period in the output dataset</p>
</td></tr>
<tr><td><code id="transformdata.back_+3A_i.fun">i.fun</code></td>
<td>
<p>sumarize function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Transforms data from the season in each column format (the one that uses <a href="#topic+mem">mem</a>)
to the format year, week, rate in a 3 columns data.frame.
</p>
<p>Allows to set the cutoff point to separate between two seasons when one season has
two different years.
</p>


<h3>Value</h3>

<p><code>transformdata.back</code> returns a data.frame with three columns, year, week and rate.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Transform data
newdata &lt;- transformdata.back(flucyl)$data
</code></pre>

<hr>
<h2 id='transformseries'>Transformation of series of data</h2><span id='topic+transformseries'></span>

<h3>Description</h3>

<p>Function <code>transformseries</code> transforms whole datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries(i.data, i.transformation = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transformseries_+3A_i.data">i.data</code></td>
<td>
<p>Historical data series.</p>
</td></tr>
<tr><td><code id="transformseries_+3A_i.transformation">i.transformation</code></td>
<td>
<p>Transformation to apply to the dataset.</p>
</td></tr>
<tr><td><code id="transformseries_+3A_...">...</code></td>
<td>
<p>other paramaters to be used by functions to fit two waves.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data must be a data.frame with each column a surveillance season and each
row a week.
</p>
<p>Transformation options:
</p>

<ul>
<li><p>1 No transformation
</p>
</li>
<li><p>2 Odd
</p>
</li>
<li><p>3 Fill missing data
</p>
</li>
<li><p>4 Smoothing regression
</p>
</li>
<li><p>5 Two waves (observed)
</p>
</li>
<li><p>6 Two waves (expected)
</p>
</li>
<li><p>7 Loess
</p>
</li>
<li><p>8 Spline
</p>
</li>
<li><p>9 Moving Average
</p>
</li></ul>

<p>Fill missings sustitute missing values with predicted values from a loess regression fit.
If does not impute leading or trailing missings, only missings in the middle of the season.
</p>
<p>Odd calculates the odd: p divided by 1-p.
</p>
<p>Loess substitute the dataset with predicted values from a loess regression fit.
</p>
<p>Spline fits a cubic smoothing spline to the supplied data.
</p>
<p>Two waves (observed) is used when there are two waves per season. It divides the original
dataset in two using a mixture of two normal distributions. The expected option uses the
same procedure but also substitutes all data with predicted values of the mixture fit.
</p>
<p>Moving Average has an additional parameter i.number for the number of observation to 
calculate the average.
</p>


<h3>Value</h3>

<p><code>transformseries</code> The transformed dataset.
</p>


<h3>Author(s)</h3>

<p>Jose E. Lozano <a href="mailto:lozalojo@gmail.com">lozalojo@gmail.com</a>
</p>


<h3>References</h3>

<p>Vega T, Lozano JE, Ortiz de Lejarazu R, Gutierrez Perez M. Modelling influenza epidemic - can we
detect the beginning and predict the intensity and duration? Int Congr Ser. 2004 Jun;1263:281-3.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Mott J, Ortiz de Lejarazu R, et al. Influenza surveillance
in Europe: establishing epidemic thresholds by the moving epidemic method. Influenza Other Respir
Viruses. 2013 Jul;7(4):546-58. DOI:10.1111/j.1750-2659.2012.00422.x.
</p>
<p>Vega T, Lozano JE, Meerhoff T, Snacken R, Beaute J, Jorgensen P, et al. Influenza surveillance in
Europe: comparing intensity levels calculated using the moving epidemic method. Influenza Other
Respir Viruses. 2015 Sep;9(5):234-46. DOI:10.1111/irv.12330.
</p>
<p>Lozano JE. lozalojo/mem: Second release of the MEM R library. Zenodo [Internet]. [cited 2017 Feb 1];
Available from: <a href="https://zenodo.org/record/165983">https://zenodo.org/record/165983</a>. DOI:10.5281/zenodo.165983
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Castilla y Leon Influenza Rates data
data(flucyl)
# Data of the last season
transformseries(flucyl, 2)
</code></pre>

<hr>
<h2 id='transformseries.loess'>loess transformation</h2><span id='topic+transformseries.loess'></span>

<h3>Description</h3>

<p>loess transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.loess(i.x, i.positive = F, ...)
</code></pre>

<hr>
<h2 id='transformseries.moving.average'>moving average transformation</h2><span id='topic+transformseries.moving.average'></span>

<h3>Description</h3>

<p>moving average transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.moving.average(x, i.number = 3)
</code></pre>

<hr>
<h2 id='transformseries.multiple'>divide a series in parts</h2><span id='topic+transformseries.multiple'></span>

<h3>Description</h3>

<p>divide a series in parts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.multiple(
  i.data,
  i.max.epidemic.duration = NA,
  i.max.season.duration = NA,
  i.waves = NA,
  i.waves.range = NA,
  i.intra.param = 3,
  i.inter.param = 2,
  i.min.separation = 1,
  i.output = NA,
  i.prefix = "Multiple waves",
  i.force.smooth = F,
  i.split.top = 3,
  ...
)
</code></pre>

<hr>
<h2 id='transformseries.odd'>odd transformation</h2><span id='topic+transformseries.odd'></span>

<h3>Description</h3>

<p>odd transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.odd(x)
</code></pre>

<hr>
<h2 id='transformseries.spline'>spline transformation</h2><span id='topic+transformseries.spline'></span>

<h3>Description</h3>

<p>spline transformation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.spline(i.x, i.positive = F, ...)
</code></pre>

<hr>
<h2 id='transformseries.twowaves'>adjust a mixed model of two normal distributions</h2><span id='topic+transformseries.twowaves'></span>

<h3>Description</h3>

<p>adjust a mixed model of two normal distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transformseries.twowaves(
  i.data,
  i.scale = 10000,
  i.model = "V",
  i.output = NA,
  i.prefix = "two waves",
  i.proportion = 0.15
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
