<!DOCTYPE html><html><head><title>Help for package alpaca</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {alpaca}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpaca-package'><p>alpaca: A package for fitting glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</p></a></li>
<li><a href='#biasCorr'><p>Asymptotic bias correction after fitting binary choice models with a one-/two-/three-way error</p>
component</a></li>
<li><a href='#coef.APEs'><p>Extract estimates of average partial effects</p></a></li>
<li><a href='#coef.feglm'><p>Extract estimates of structural parameters</p></a></li>
<li><a href='#coef.summary.APEs'><p>Extract coefficient matrix for average partial effects</p></a></li>
<li><a href='#coef.summary.feglm'><p>Extract coefficient matrix for structural parameters</p></a></li>
<li><a href='#feglm'><p>Efficiently fit glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</p></a></li>
<li><a href='#feglm.nb'><p>Efficiently fit negative binomial glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</p></a></li>
<li><a href='#feglmControl'><p>Set <code>feglm</code> Control Parameters</p></a></li>
<li><a href='#fitted.feglm'><p>Extract <code>feglm</code> fitted values</p></a></li>
<li><a href='#getAPEs'><p>Compute average partial effects after fitting binary choice models with a one-/two-/three-way error</p>
component</a></li>
<li><a href='#getFEs'><p>Efficiently recover estimates of the fixed effects after fitting <code>feglm</code></p></a></li>
<li><a href='#predict.feglm'><p>Predict method for <code>feglm</code> fits</p></a></li>
<li><a href='#print.APEs'><p>Print <code>APEs</code></p></a></li>
<li><a href='#print.feglm'><p>Print <code>feglm</code></p></a></li>
<li><a href='#print.summary.APEs'><p>Print <code>summary.APEs</code></p></a></li>
<li><a href='#print.summary.feglm'><p>Print <code>summary.feglm</code></p></a></li>
<li><a href='#simGLM'><p>Generate an artificial data set for some GLM's with two-way fixed effects</p></a></li>
<li><a href='#summary.APEs'><p>Summarizing models of class <code>APEs</code></p></a></li>
<li><a href='#summary.feglm'><p>Summarizing models of class <code>feglm</code></p></a></li>
<li><a href='#vcov.APEs'><p>Compute covariance matrix after estimating <code>APEs</code></p></a></li>
<li><a href='#vcov.feglm'><p>Compute covariance matrix after fitting <code>feglm</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fit GLM's with High-Dimensional k-Way Fixed Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a routine to partial out factors with many levels during the optimization of the log-likelihood function of the corresponding generalized linear model (glm). The package is based on the algorithm described in Stammann (2018) &lt;<a href="https://arxiv.org/abs/1707.01815">arXiv:1707.01815</a>&gt; and is restricted to glm's that are based on maximum likelihood estimation and nonlinear. It also offers an efficient algorithm to recover estimates of the fixed effects in a post-estimation routine and includes robust and multi-way clustered standard errors. Further the package provides analytical bias corrections for binary choice models derived by Fernandez-Val and Weidner (2016) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2015.12.014">doi:10.1016/j.jeconom.2015.12.014</a>&gt; and Hinz, Stammann, and Wanner (2020) &lt;<a href="https://arxiv.org/abs/2004.12655">arXiv:2004.12655</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, Formula, MASS, Rcpp, stats, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/amrei-stammann/alpaca">https://github.com/amrei-stammann/alpaca</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/amrei-stammann/alpaca/issues">https://github.com/amrei-stammann/alpaca/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bife, car, knitr, lfe, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-10 13:56:07 UTC; daniel</td>
</tr>
<tr>
<td>Author:</td>
<td>Amrei Stammann [aut, cre],
  Daniel Czarnowske <a href="https://orcid.org/0000-0002-0030-929X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Amrei Stammann &lt;amrei.stammann@rub.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-10 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpaca-package'>alpaca: A package for fitting glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</h2><span id='topic+alpaca-package'></span>

<h3>Description</h3>

<p>Provides a routine to partial out factors with many levels during the optimization of the log-likelihood 
function of the corresponding generalized linear model (glm). The package is based on the algorithm 
described in Stammann (2018) and is restricted to glm's that are based on maximum likelihood estimation 
and nonlinear. It also offers an efficient algorithm to recover estimates of the fixed effects in a 
post-estimation routine and includes robust and multi-way clustered standard errors. Further the package 
provides analytical bias corrections for binary choice models derived by Fernández-Val and Weidner (2016) 
and Hinz, Stammann, and Wanner (2020).
</p>
<p><strong>Note:</strong> Linear models are also beyond the scope of this package since there is already a
comprehensive procedure available <a href="lfe.html#topic+felm">felm</a>.
</p>

<hr>
<h2 id='biasCorr'>Asymptotic bias correction after fitting binary choice models with a one-/two-/three-way error
component</h2><span id='topic+biasCorr'></span>

<h3>Description</h3>

<p><code><a href="#topic+biasCorr">biasCorr</a></code> is a post-estimation routine that can be used to substantially reduce the 
incidental parameter bias problem (Neyman and Scott (1948)) present in nonlinear fixed effects 
models (see Fernández-Val and Weidner (2018) for an overview). The command applies the analytical 
bias correction derived by Fernández-Val and Weidner (2016) and Hinz, Stammann, and Wanner (2020) 
to obtain bias-corrected estimates of the structural parameters and is currently restricted to 
<code><a href="stats.html#topic+binomial">binomial</a></code> with one-, two-, and three-way fixed effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biasCorr(object = NULL, L = 0L, panel.structure = c("classic", "network"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biasCorr_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>; currently restricted to <code><a href="stats.html#topic+binomial">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="biasCorr_+3A_l">L</code></td>
<td>
<p>unsigned integer indicating a bandwidth for the estimation of spectral densities proposed by 
Hahn and Kuersteiner (2011). Default is zero, which should be used if all regressors are 
assumed to be strictly exogenous with respect to the idiosyncratic error term. In the presence of 
weakly exogenous regressors, e.g. lagged outcome variables, Fernández-Val and Weidner (2016, 2018) 
suggest to choose a bandwidth between one and four. Note that the order of factors to be partialed 
out is important for bandwidths larger than zero (see vignette for details).</p>
</td></tr>
<tr><td><code id="biasCorr_+3A_panel.structure">panel.structure</code></td>
<td>
<p>a string equal to <code>"classic"</code> or <code>"network"</code> which determines the 
structure of the panel used. <code>"classic"</code> denotes panel structures where for example the same
cross-sectional units are observed several times (this includes pseudo panels). 
<code>"network"</code> denotes panel structures where for example bilateral trade flows are observed 
for several time periods. Default is <code>"classic"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+biasCorr">biasCorr</a></code> returns a named list of classes <code>"biasCorr"</code> and 
<code>"feglm"</code>.
</p>


<h3>References</h3>

<p>Czarnowske, D. and A. Stammann (2020). &quot;Fixed Effects Binary Choice Models: Estimation and Inference
with Long Panels&quot;. ArXiv e-prints.
</p>
<p>Fernández-Val, I. and M. Weidner (2016). &quot;Individual and time effects in nonlinear panel models 
with large N, T&quot;. Journal of Econometrics, 192(1), 291-312.
</p>
<p>Fernández-Val, I. and M. Weidner (2018). &quot;Fixed effects estimation of large-t panel data 
models&quot;. Annual Review of Economics, 10, 109-138.
</p>
<p>Hahn, J. and G. Kuersteiner (2011). &quot;Bias reduction for dynamic nonlinear panel models with 
fixed effects&quot;. Econometric Theory, 27(6), 1152-1191.
</p>
<p>Hinz, J., A. Stammann, and J. Wanner (2020). &quot;State Dependence and Unobserved Heterogeneity
in the Extensive Margin of Trade&quot;. ArXiv e-prints.
</p>
<p>Neyman, J. and E. L. Scott (1948). &quot;Consistent estimates based on partially consistent 
observations&quot;. Econometrica, 16(1), 1-32.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate an artificial data set for logit models
library(alpaca)
data &lt;- simGLM(1000L, 20L, 1805L, model = "logit")

# Fit 'feglm()'
mod &lt;- feglm(y ~ x1 + x2 + x3 | i + t, data)

# Apply analytical bias correction
mod.bc &lt;- biasCorr(mod)
summary(mod.bc)

</code></pre>

<hr>
<h2 id='coef.APEs'>Extract estimates of average partial effects</h2><span id='topic+coef.APEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+coef.APEs">coef.APEs</a></code> is a generic function which extracts estimates of the average partial 
effects from objects returned by <code><a href="#topic+getAPEs">getAPEs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'APEs'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.APEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"APEs"</code>.</p>
</td></tr>
<tr><td><code id="coef.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+coef.APEs">coef.APEs</a></code> returns a named vector of estimates of the average partial 
effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='coef.feglm'>Extract estimates of structural parameters</h2><span id='topic+coef.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+coef.feglm">coef.feglm</a></code> is a generic function which extracts estimates of the structural parameters
from objects returned by <code><a href="#topic+feglm">feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="coef.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+coef.feglm">coef.feglm</a></code> returns a named vector of estimates of the structural 
parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='coef.summary.APEs'>Extract coefficient matrix for average partial effects</h2><span id='topic+coef.summary.APEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+coef.summary.APEs">coef.summary.APEs</a></code> is a generic function which extracts a coefficient matrix for 
average partial effects from objects returned by <code><a href="#topic+getAPEs">getAPEs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.APEs'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.summary.APEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"summary.APEs"</code>.</p>
</td></tr>
<tr><td><code id="coef.summary.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+coef.summary.APEs">coef.summary.APEs</a></code> returns a named matrix of estimates related to the
average partial effects.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='coef.summary.feglm'>Extract coefficient matrix for structural parameters</h2><span id='topic+coef.summary.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+coef.summary.feglm">coef.summary.feglm</a></code> is a generic function which extracts a coefficient matrix for 
structural parameters from objects returned by <code><a href="#topic+feglm">feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.feglm'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.summary.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"summary.feglm"</code>.</p>
</td></tr>
<tr><td><code id="coef.summary.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+coef.summary.feglm">coef.summary.feglm</a></code> returns a named matrix of estimates related to the
structural parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='feglm'>Efficiently fit glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</h2><span id='topic+feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+feglm">feglm</a></code> can be used to fit generalized linear models with many high-dimensional fixed
effects. The estimation procedure is based on unconditional maximum likelihood and can be
interpreted as a &ldquo;weighted demeaning&rdquo; approach that combines the work of Gaure (2013) and
Stammann et. al. (2016). For technical details see Stammann (2018). The routine is well suited
for large data sets that would be otherwise infeasible to use due to memory limitations.
</p>
<p><strong>Remark:</strong> The term fixed effect is used in econometrician's sense of having intercepts for
each level in each category.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feglm(
  formula = NULL,
  data = NULL,
  family = binomial(),
  weights = NULL,
  beta.start = NULL,
  eta.start = NULL,
  control = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feglm_+3A_formula">formula</code></td>
<td>
<p>an object of class <code>"formula"</code>: a symbolic description of the model to be fitted.
<code>formula</code> must be of type <code>y ~ x | k</code>, where the second part of the formula refers to
factors to be concentrated out. It is also possible to pass additional variables to 
<code><a href="#topic+feglm">feglm</a></code> (e.g. to cluster standard errors). This can be done by specifying the third 
part of the formula: <code>y ~ x | k | add</code>.</p>
</td></tr>
<tr><td><code id="feglm_+3A_data">data</code></td>
<td>
<p>an object of class <code>"data.frame"</code> containing the variables in the model.</p>
</td></tr>
<tr><td><code id="feglm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the model. 
Similar to <code><a href="stats.html#topic+glm.fit">glm.fit</a></code> this has to be the result of a call to a family 
function. Default is <code>binomial()</code>. See <code><a href="stats.html#topic+family">family</a></code> for details of family 
functions.</p>
</td></tr>
<tr><td><code id="feglm_+3A_weights">weights</code></td>
<td>
<p>an optional string with the name of the 'prior weights' variable in <code>data</code>.</p>
</td></tr>
<tr><td><code id="feglm_+3A_beta.start">beta.start</code></td>
<td>
<p>an optional vector of starting values for the structural parameters in the linear 
predictor. Default is <code class="reqn">\boldsymbol{\beta} = \mathbf{0}</code>.</p>
</td></tr>
<tr><td><code id="feglm_+3A_eta.start">eta.start</code></td>
<td>
<p>an optional vector of starting values for the linear predictor.</p>
</td></tr>
<tr><td><code id="feglm_+3A_control">control</code></td>
<td>
<p>a named list of parameters for controlling the fitting process. See 
<code><a href="#topic+feglmControl">feglmControl</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code><a href="#topic+feglm">feglm</a></code> does not converge this is often a sign of linear dependence between 
one or more regressors and a fixed effects category. In this case, you should carefully inspect 
your model specification.
</p>


<h3>Value</h3>

<p>The function <code><a href="#topic+feglm">feglm</a></code> returns a named list of class <code>"feglm"</code>.
</p>


<h3>References</h3>

<p>Gaure, S. (2013). &quot;OLS with Multiple High Dimensional Category Variables&quot;. Computational
Statistics and Data Analysis, 66.
</p>
<p>Marschner, I. (2011). &quot;glm2: Fitting generalized linear models with convergence problems&quot;. 
The R Journal, 3(2).
</p>
<p>Stammann, A., F. Heiss, and D. McFadden (2016). &quot;Estimating Fixed Effects Logit Models with 
Large Panel Data&quot;. Working paper.
</p>
<p>Stammann, A. (2018). &quot;Fast and Feasible Estimation of Generalized Linear Models with
High-Dimensional k-Way Fixed Effects&quot;. ArXiv e-prints.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate an artificial data set for logit models
library(alpaca)
data &lt;- simGLM(1000L, 20L, 1805L, model = "logit")

# Fit 'feglm()'
mod &lt;- feglm(y ~ x1 + x2 + x3 | i + t, data)
summary(mod)

</code></pre>

<hr>
<h2 id='feglm.nb'>Efficiently fit negative binomial glm's with high-dimensional <code class="reqn">k</code>-way fixed effects</h2><span id='topic+feglm.nb'></span>

<h3>Description</h3>

<p><code>feglm.nb</code> can be used to fit negative binomial generalized linear models with many 
high-dimensional fixed effects (see <code><a href="#topic+feglm">feglm</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feglm.nb(
  formula = NULL,
  data = NULL,
  weights = NULL,
  beta.start = NULL,
  eta.start = NULL,
  init.theta = NULL,
  link = c("log", "identity", "sqrt"),
  control = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feglm.nb_+3A_formula">formula</code>, <code id="feglm.nb_+3A_data">data</code>, <code id="feglm.nb_+3A_weights">weights</code>, <code id="feglm.nb_+3A_beta.start">beta.start</code>, <code id="feglm.nb_+3A_eta.start">eta.start</code>, <code id="feglm.nb_+3A_control">control</code></td>
<td>
<p>see <code><a href="#topic+feglm">feglm</a></code>.</p>
</td></tr>
<tr><td><code id="feglm.nb_+3A_init.theta">init.theta</code></td>
<td>
<p>an optional initial value for the theta parameter (see <code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>).</p>
</td></tr>
<tr><td><code id="feglm.nb_+3A_link">link</code></td>
<td>
<p>the link function. Must be one of <code>"log"</code>, <code>"sqrt"</code>, or <code>"identity"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>feglm.nb</code> does not converge this is usually a sign of linear dependence between one or 
more regressors and a fixed effects category. In this case, you should carefully inspect your
model specification.
</p>


<h3>Value</h3>

<p>The function <code>feglm.nb</code> returns a named list of class <code>"feglm"</code>.
</p>


<h3>References</h3>

<p>Gaure, S. (2013). &quot;OLS with Multiple High Dimensional Category Variables&quot;. Computational
Statistics and Data Analysis. 66.
</p>
<p>Marschner, I. (2011). &quot;glm2: Fitting generalized linear models with convergence problems&quot;. 
The R Journal, 3(2).
</p>
<p>Stammann, A., F. Heiss, and D. McFadden (2016). &quot;Estimating Fixed Effects Logit Models with Large
Panel Data&quot;. Working paper.
</p>
<p>Stammann, A. (2018). &quot;Fast and Feasible Estimation of Generalized Linear Models with
High-Dimensional k-Way Fixed Effects&quot;. ArXiv e-prints.
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+glm.nb">glm.nb</a></code>, <code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='feglmControl'>Set <code>feglm</code> Control Parameters</h2><span id='topic+feglmControl'></span><span id='topic+feglm.control'></span>

<h3>Description</h3>

<p>Set and change parameters used for fitting <code><a href="#topic+feglm">feglm</a></code>.
</p>
<p><strong>Note:</strong> <code><a href="#topic+feglm.control">feglm.control</a></code> is deprecated and will be removed soon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feglmControl(
  dev.tol = 1e-08,
  center.tol = 1e-08,
  iter.max = 25L,
  limit = 10L,
  trace = FALSE,
  drop.pc = TRUE,
  keep.mx = TRUE,
  conv.tol = NULL,
  rho.tol = NULL,
  pseudo.tol = NULL,
  step.tol = NULL
)

feglm.control(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feglmControl_+3A_dev.tol">dev.tol</code></td>
<td>
<p>tolerance level for the first stopping condition of the maximization routine. The 
stopping condition is based on the relative change of the deviance in iteration <code class="reqn">r</code>
and can be expressed as follows:
<code class="reqn">|dev_{r} - dev_{r - 1}| / (0.1 + |dev_{r}|) &lt; tol</code>.
Default is <code>1.0e-08</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_center.tol">center.tol</code></td>
<td>
<p>tolerance level for the stopping condition of the centering algorithm.
The stopping condition is based on the relative change of the centered variable similar to
<a href="lfe.html#topic+felm">felm</a>. Default is <code>1.0e-08</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_iter.max">iter.max</code></td>
<td>
<p>unsigned integer indicating the maximum number of iterations in the maximization
routine. Default is <code>25L</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_limit">limit</code></td>
<td>
<p>unsigned integer indicating the maximum number of iterations of 
<code><a href="MASS.html#topic+theta.ml">theta.ml</a></code>. Default is <code>10L</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_trace">trace</code></td>
<td>
<p>logical indicating if output should be produced in each iteration. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_drop.pc">drop.pc</code></td>
<td>
<p>logical indicating to drop observations that are perfectly classified/separated and hence 
do not contribute to the log-likelihood. This option is useful to reduce the computational costs of
the maximization problem and improves the numerical stability of the algorithm. Note that dropping
perfectly separated observations does not affect the estimates. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_keep.mx">keep.mx</code></td>
<td>
<p>logical indicating if the centered regressor matrix should be stored. The centered regressor
matrix is required for some covariance estimators, bias corrections, and average partial effects. This
option saves some computation time at the cost of memory. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_conv.tol">conv.tol</code>, <code id="feglmControl_+3A_rho.tol">rho.tol</code></td>
<td>
<p>deprecated; step-halving is now similar to <code>glm.fit2</code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_pseudo.tol">pseudo.tol</code></td>
<td>
<p>deprecated; use <code>center.tol</code> instead.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_step.tol">step.tol</code></td>
<td>
<p>deprecated; termination conditions is now similar to <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="feglmControl_+3A_...">...</code></td>
<td>
<p>arguments passed to the deprecated function <code><a href="#topic+feglm.control">feglm.control</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+feglmControl">feglmControl</a></code> returns a named list of control 
parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='fitted.feglm'>Extract <code>feglm</code> fitted values</h2><span id='topic+fitted.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+fitted.feglm">fitted.feglm</a></code> is a generic function which extracts fitted values from an object 
returned by <code><a href="#topic+feglm">feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="fitted.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+fitted.feglm">fitted.feglm</a></code> returns a vector of fitted values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='getAPEs'>Compute average partial effects after fitting binary choice models with a one-/two-/three-way error 
component</h2><span id='topic+getAPEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code> is a post-estimation routine that can be used to estimate average partial 
effects with respect to all covariates in the model and the corresponding covariance matrix. The 
estimation of the covariance is based on a linear approximation (delta method) plus an optional 
finite population correction. Note that the command automatically determines which of the regressors 
are binary or non-binary.
</p>
<p><strong>Remark:</strong> The routine currently does not allow to compute average partial effects based 
on functional forms like interactions and polynomials.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAPEs(
  object = NULL,
  n.pop = NULL,
  panel.structure = c("classic", "network"),
  sampling.fe = c("independence", "unrestricted"),
  weak.exo = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getAPEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"biasCorr"</code> or <code>"feglm"</code>; currently restricted to 
<code><a href="stats.html#topic+binomial">binomial</a></code>.</p>
</td></tr>
<tr><td><code id="getAPEs_+3A_n.pop">n.pop</code></td>
<td>
<p>unsigned integer indicating a finite population correction for the estimation of the 
covariance matrix of the average partial effects proposed by 
Cruz-Gonzalez, Fernández-Val, and Weidner (2017). The correction factor is computed as follows: 
<code class="reqn">(n^{\ast} - n) / (n^{\ast} - 1)</code>, 
where <code class="reqn">n^{\ast}</code> and <code class="reqn">n</code> are the sizes of the entire 
population and the full sample size. Default is <code>NULL</code>, which refers to a factor of zero and 
a covariance obtained by the delta method.</p>
</td></tr>
<tr><td><code id="getAPEs_+3A_panel.structure">panel.structure</code></td>
<td>
<p>a string equal to <code>"classic"</code> or <code>"network"</code> which determines the 
structure of the panel used. <code>"classic"</code> denotes panel structures where for example the same
cross-sectional units are observed several times (this includes pseudo panels). 
<code>"network"</code> denotes panel structures where for example bilateral trade flows are observed 
for several time periods. Default is <code>"classic"</code>.</p>
</td></tr>
<tr><td><code id="getAPEs_+3A_sampling.fe">sampling.fe</code></td>
<td>
<p>a string equal to <code>"independence"</code> or <code>"unrestricted"</code> which imposes 
sampling assumptions about the unobserved effects. <code>"independence"</code> imposes that all 
unobserved effects are independent sequences. <code>"unrestricted"</code> does not impose any
sampling assumptions. Note that this option only affects the optional finite population correction. 
Default is <code>"independence"</code>.</p>
</td></tr>
<tr><td><code id="getAPEs_+3A_weak.exo">weak.exo</code></td>
<td>
<p>logical indicating if some of the regressors are assumed to be weakly exogenous (e. g. 
predetermined). If object is of class <code>"biasCorr"</code>, the option will be automatically set to 
<code>TRUE</code> if the chosen bandwidth parameter is larger than zero. Note that this option only 
affects the estimation of the covariance matrix. Default is <code>FALSE</code>, which assumes that all 
regressors are strictly exogenous.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+getAPEs">getAPEs</a></code> returns a named list of class <code>"APEs"</code>.
</p>


<h3>References</h3>

<p>Cruz-Gonzalez, M., I. Fernández-Val, and M. Weidner (2017). &quot;Bias corrections for probit and 
logit models with two-way fixed effects&quot;. The Stata Journal, 17(3), 517-545.
</p>
<p>Czarnowske, D. and A. Stammann (2020). &quot;Fixed Effects Binary Choice Models: Estimation and Inference
with Long Panels&quot;. ArXiv e-prints.
</p>
<p>Fernández-Val, I. and M. Weidner (2016). &quot;Individual and time effects in nonlinear panel models 
with large N, T&quot;. Journal of Econometrics, 192(1), 291-312.
</p>
<p>Fernández-Val, I. and M. Weidner (2018). &quot;Fixed effects estimation of large-t panel data 
models&quot;. Annual Review of Economics, 10, 109-138.
</p>
<p>Hinz, J., A. Stammann, and J. Wanner (2020). &quot;State Dependence and Unobserved Heterogeneity
in the Extensive Margin of Trade&quot;. ArXiv e-prints.
</p>
<p>Neyman, J. and E. L. Scott (1948). &quot;Consistent estimates based on partially consistent 
observations&quot;. Econometrica, 16(1), 1-32.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+biasCorr">biasCorr</a></code>, <code><a href="#topic+feglm">feglm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate an artificial data set for logit models
library(alpaca)
data &lt;- simGLM(1000L, 20L, 1805L, model = "logit")

# Fit 'feglm()'
mod &lt;- feglm(y ~ x1 + x2 + x3 | i + t, data)

# Compute average partial effects
mod.ape &lt;- getAPEs(mod)
summary(mod.ape)

# Apply analytical bias correction
mod.bc &lt;- biasCorr(mod)
summary(mod.bc)

# Compute bias-corrected average partial effects
mod.ape.bc &lt;- getAPEs(mod.bc)
summary(mod.ape.bc)

</code></pre>

<hr>
<h2 id='getFEs'>Efficiently recover estimates of the fixed effects after fitting <code>feglm</code></h2><span id='topic+getFEs'></span>

<h3>Description</h3>

<p>Recover estimates of the fixed effects by alternating between the normal equations of the fixed 
effects as shown by Stammann (2018).
</p>
<p><strong>Remark</strong>: The system might not have a unique solution since we do not take collinearity
into account. If the solution is not unique, an estimable function has to be applied to our
solution to get meaningful estimates of the fixed effects. See Gaure (n. d.) for an extensive
treatment of this issue.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getFEs(object = NULL, alpha.tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getFEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="getFEs_+3A_alpha.tol">alpha.tol</code></td>
<td>
<p>tolerance level for the stopping condition. The algorithm is stopped in iteration
<code class="reqn">i</code> if <code class="reqn">||\boldsymbol{\alpha}_{i} - \boldsymbol{\alpha}_{i - 1}||_{2} &lt; 
tol ||\boldsymbol{\alpha}_{i - 1}||_{2}</code>.
Default is <code>1.0e-08</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+getFEs">getFEs</a></code> returns a named list containing named vectors of estimated 
fixed effects.
</p>


<h3>References</h3>

<p>Gaure, S. (n. d.). &quot;Multicollinearity, identification, and estimable 
functions&quot;. Unpublished.
</p>
<p>Stammann, A. (2018). &quot;Fast and Feasible Estimation of Generalized Linear Models with 
High-Dimensional k-way Fixed Effects&quot;. ArXiv e-prints.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='predict.feglm'>Predict method for <code>feglm</code> fits</h2><span id='topic+predict.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+predict.feglm">predict.feglm</a></code> is a generic function which obtains predictions from an object 
returned by <code><a href="#topic+feglm">feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
predict(object, type = c("link", "response"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="predict.feglm_+3A_type">type</code></td>
<td>
<p>the type of prediction required. <code>"link"</code> is on the scale of the linear predictor
whereas <code>"response"</code> is on the scale of the response variable. Default is <code>"link"</code>.</p>
</td></tr>
<tr><td><code id="predict.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+predict.feglm">predict.feglm</a></code> returns a vector of predictions.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='print.APEs'>Print <code>APEs</code></h2><span id='topic+print.APEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+print.APEs">print.APEs</a></code> is a generic function which displays some minimal information from 
objects returned by <code><a href="#topic+getAPEs">getAPEs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'APEs'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.APEs_+3A_x">x</code></td>
<td>
<p>an object of class <code>"APEs"</code>.</p>
</td></tr>
<tr><td><code id="print.APEs_+3A_digits">digits</code></td>
<td>
<p>unsigned integer indicating the number of decimal places. Default is 
<code>max(3L, getOption("digits") - 3L)</code>.</p>
</td></tr>
<tr><td><code id="print.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='print.feglm'>Print <code>feglm</code></h2><span id='topic+print.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+print.feglm">print.feglm</a></code> is a generic function which displays some minimal information from 
objects returned by <code><a href="#topic+feglm">feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.feglm_+3A_x">x</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="print.feglm_+3A_digits">digits</code></td>
<td>
<p>unsigned integer indicating the number of decimal places. Default is 
<code>max(3L, getOption("digits") - 3L)</code>.</p>
</td></tr>
<tr><td><code id="print.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='print.summary.APEs'>Print <code>summary.APEs</code></h2><span id='topic+print.summary.APEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+print.summary.APEs">print.summary.APEs</a></code> is a generic function which displays summary statistics from 
objects returned by <code><a href="#topic+summary.APEs">summary.APEs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.APEs'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.APEs_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.APEs"</code>.</p>
</td></tr>
<tr><td><code id="print.summary.APEs_+3A_digits">digits</code></td>
<td>
<p>unsigned integer indicating the number of decimal places. Default is 
<code>max(3L, getOption("digits") - 3L)</code>.</p>
</td></tr>
<tr><td><code id="print.summary.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='print.summary.feglm'>Print <code>summary.feglm</code></h2><span id='topic+print.summary.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+print.summary.feglm">print.summary.feglm</a></code> is a generic function which displays summary statistics from 
objects returned by <code><a href="#topic+summary.feglm">summary.feglm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.feglm'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.feglm_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.feglm"</code>.</p>
</td></tr>
<tr><td><code id="print.summary.feglm_+3A_digits">digits</code></td>
<td>
<p>unsigned integer indicating the number of decimal places. Default is 
<code>max(3L, getOption("digits") - 3L)</code>.</p>
</td></tr>
<tr><td><code id="print.summary.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='simGLM'>Generate an artificial data set for some GLM's with two-way fixed effects</h2><span id='topic+simGLM'></span>

<h3>Description</h3>

<p>Constructs an artificial data set with <code class="reqn">n</code> cross-sectional units observed for <code class="reqn">t</code> time
periods for logit, poisson, or gamma models. The &ldquo;true&rdquo; linear predictor
(<code class="reqn">\boldsymbol{\eta}</code>) is generated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\eta_{it} = \mathbf{x}_{it}^{\prime} \boldsymbol{\beta} +
 \alpha_{i} + \gamma_{t} \, ,</code>
</p>

<p>where <code class="reqn">\mathbf{X}</code> consists of three independent standard normally distributed regressors.
Both parameter referring to the unobserved heterogeneity (<code class="reqn">\alpha_{i}</code> and 
<code class="reqn">\gamma_{t}</code>) are generated as iid. standard normal and the structural parameters are
set to <code class="reqn">\boldsymbol{\beta} = [1, - 1, 1]^{\prime}</code>.
</p>
<p><strong>Note:</strong> The poisson and gamma model are based on the logarithmic link function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simGLM(n = NULL, t = NULL, seed = NULL, model = c("logit", "poisson", "gamma"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simGLM_+3A_n">n</code></td>
<td>
<p>a strictly positive integer equal to the number of cross-sectional units.</p>
</td></tr>
<tr><td><code id="simGLM_+3A_t">t</code></td>
<td>
<p>a strictly positive integer equal to the number of time periods.</p>
</td></tr>
<tr><td><code id="simGLM_+3A_seed">seed</code></td>
<td>
<p>a seed to ensure reproducibility.</p>
</td></tr>
<tr><td><code id="simGLM_+3A_model">model</code></td>
<td>
<p>a string equal to <code>"logit"</code>, <code>"poisson"</code>, or <code>"gamma"</code>. Default is 
<code>"logit"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+simGLM">simGLM</a></code> returns a data.frame with 6 variables.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='summary.APEs'>Summarizing models of class <code>APEs</code></h2><span id='topic+summary.APEs'></span>

<h3>Description</h3>

<p>Summary statistics for objects of class <code>"APEs"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'APEs'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.APEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"APEs"</code>.</p>
</td></tr>
<tr><td><code id="summary.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class <code>"summary.APEs"</code> which is a list of summary statistics of 
<code>object</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='summary.feglm'>Summarizing models of class <code>feglm</code></h2><span id='topic+summary.feglm'></span>

<h3>Description</h3>

<p>Summary statistics for objects of class <code>"feglm"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
summary(
  object,
  type = c("hessian", "outer.product", "sandwich", "clustered"),
  cluster = NULL,
  cluster.vars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="summary.feglm_+3A_type">type</code></td>
<td>
<p>the type of covariance estimate required. <code>"hessian"</code> refers to the inverse
of the negative expected Hessian after convergence and is the default option. 
<code>"outer.product"</code> is the outer-product-of-the-gradient estimator, 
<code>"sandwich"</code> is the sandwich estimator (sometimes also refered as robust estimator), 
and <code>"clustered"</code> computes a clustered covariance matrix given some cluster variables.</p>
</td></tr>
<tr><td><code id="summary.feglm_+3A_cluster">cluster</code></td>
<td>
<p>a symbolic description indicating the clustering of observations.</p>
</td></tr>
<tr><td><code id="summary.feglm_+3A_cluster.vars">cluster.vars</code></td>
<td>
<p>deprecated; use <code>cluster</code> instead.</p>
</td></tr>
<tr><td><code id="summary.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multi-way clustering is done using the algorithm of Cameron, Gelbach, and Miller (2011). An 
example is provided in the vignette &quot;Replicating an Empirical Example of International Trade&quot;.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>"summary.feglm"</code> which is a list of summary statistics of
<code>object</code>.
</p>


<h3>References</h3>

<p>Cameron, C., J. Gelbach, and D. Miller (2011). &quot;Robust Inference With Multiway Clustering&quot;.
Journal of Business &amp; Economic Statistics 29(2).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

<hr>
<h2 id='vcov.APEs'>Compute covariance matrix after estimating <code>APEs</code></h2><span id='topic+vcov.APEs'></span>

<h3>Description</h3>

<p><code><a href="#topic+vcov.APEs">vcov.APEs</a></code> estimates the covariance matrix for the estimator of the
average partial effects from objects returned by <code><a href="#topic+getAPEs">getAPEs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'APEs'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.APEs_+3A_object">object</code></td>
<td>
<p>an object of class <code>"APEs"</code>.</p>
</td></tr>
<tr><td><code id="vcov.APEs_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+vcov.APEs">vcov.APEs</a></code> returns a named matrix of covariance estimates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getAPEs">getAPEs</a></code>
</p>

<hr>
<h2 id='vcov.feglm'>Compute covariance matrix after fitting <code>feglm</code></h2><span id='topic+vcov.feglm'></span>

<h3>Description</h3>

<p><code><a href="#topic+vcov.feglm">vcov.feglm</a></code> estimates the covariance matrix for the estimator of the
structural parameters from objects returned by <code><a href="#topic+feglm">feglm</a></code>. The covariance is computed
from the Hessian, the scores, or a combination of both after convergence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'feglm'
vcov(
  object,
  type = c("hessian", "outer.product", "sandwich", "clustered"),
  cluster = NULL,
  cluster.vars = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.feglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"feglm"</code>.</p>
</td></tr>
<tr><td><code id="vcov.feglm_+3A_type">type</code></td>
<td>
<p>the type of covariance estimate required. <code>"hessian"</code> refers to the inverse
of the negative expected Hessian after convergence and is the default option. 
<code>"outer.product"</code> is the outer-product-of-the-gradient estimator, 
<code>"sandwich"</code> is the sandwich estimator (sometimes also referred as robust estimator), 
and <code>"clustered"</code> computes a clustered covariance matrix given some cluster variables.</p>
</td></tr>
<tr><td><code id="vcov.feglm_+3A_cluster">cluster</code></td>
<td>
<p>a symbolic description indicating the clustering of observations.</p>
</td></tr>
<tr><td><code id="vcov.feglm_+3A_cluster.vars">cluster.vars</code></td>
<td>
<p>deprecated; use <code>cluster</code> instead.</p>
</td></tr>
<tr><td><code id="vcov.feglm_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multi-way clustering is done using the algorithm of Cameron, Gelbach, and Miller (2011). An 
example is provided in the vignette &quot;Replicating an Empirical Example of International Trade&quot;.
</p>


<h3>Value</h3>

<p>The function <code><a href="#topic+vcov.feglm">vcov.feglm</a></code> returns a named matrix of covariance estimates.
</p>


<h3>References</h3>

<p>Cameron, C., J. Gelbach, and D. Miller (2011). &quot;Robust Inference With Multiway Clustering&quot;.
Journal of Business &amp; Economic Statistics 29(2).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+feglm">feglm</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
