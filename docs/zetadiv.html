<!DOCTYPE html><html lang="en"><head><title>Help for package zetadiv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {zetadiv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bird.env.coarse'><p>South-East Australia Environmental Dataset at Coarse Scale</p></a></li>
<li><a href='#bird.env.fine'><p>South-East Australia Environmental Dataset at Fine Scale</p></a></li>
<li><a href='#bird.spec.coarse'><p>Australia Bird Atlas Species Occurrence Dataset at Coarse Scale over South-East Australia</p></a></li>
<li><a href='#bird.spec.fine'><p>Australia Bird Atlas Species Occurrence Dataset at Fine Scale over South-East Australia</p></a></li>
<li><a href='#glm.cons'><p>Fitting Generalized Linear Models with constraint on the coefficients signs</p></a></li>
<li><a href='#glm.fit.cons'><p>Generalized Linear Models fitting method with negative coefficients constraint</p></a></li>
<li><a href='#Ispline'><p>Transform data using I-splines</p></a></li>
<li><a href='#Marion.env'><p>Marion Island Environmental Dataset</p></a></li>
<li><a href='#Marion.species'><p>Marion Island Species Presence-Absence Dataset</p></a></li>
<li><a href='#pie.neg'><p>Pie Chart, considering negative values as zeros</p></a></li>
<li><a href='#Plot.ispline'><p>Plots I-splines for Multi-Site Generalised Dissimilarity Modelling</p></a></li>
<li><a href='#Plot.zeta.ddecay'><p>Zeta distance-decay plotting</p></a></li>
<li><a href='#Plot.zeta.ddecays'><p>Zeta distance-decay plotting for multiple orders</p></a></li>
<li><a href='#Plot.zeta.decline'><p>Zeta diversity decline plotting</p></a></li>
<li><a href='#Plot.zeta.scale.min.dist'><p>Plotting of zeta diversity scaling with sample grain dependency based on the minimum distance between sites</p></a></li>
<li><a href='#Plot.zeta.scale.regular'><p>Plotting of zeta diversity scaling with sample grain using hierarchical increases in grain size</p></a></li>
<li><a href='#Predict.msgdm'><p>Predict zeta values for new environmental and distance data</p></a></li>
<li><a href='#Reg.ispline'><p>Perform an I-spline regression</p></a></li>
<li><a href='#rescale.min.dist'><p>Rescaling of data based on the minimum distance between sites</p></a></li>
<li><a href='#rescale.regular'><p>Rescaling of data following a hierarchical increase in grain size</p></a></li>
<li><a href='#Return.ispline'><p>Computing splines coordinates from I-spline-based multi-site generalised dissimilarity modelling</p></a></li>
<li><a href='#Zeta.ddecay'><p>Zeta distance decay for a specific number of assemblages or sites</p></a></li>
<li><a href='#Zeta.ddecays'><p>Zeta distance decay for a range of numbers of assemblages or sites</p></a></li>
<li><a href='#Zeta.decline.ex'><p>Expectation of zeta diversity decline</p></a></li>
<li><a href='#Zeta.decline.mc'><p>Zeta diversity decline using Monte Carlo sampling</p></a></li>
<li><a href='#Zeta.msgdm'><p>Multi-site generalised dissimilarity modelling for a set of environmental variables and distances</p></a></li>
<li><a href='#Zeta.order.ex'><p>Expectation of zeta diversity for a specific number of assemblages or sites</p></a></li>
<li><a href='#Zeta.order.mc'><p>Zeta diversity for a specific number of assemblages or sites using Monte Carlo sampling</p></a></li>
<li><a href='#Zeta.order.mc.mult'><p>Number of species in common between a specific number of assemblages or sites using Monte Carlo sampling, for multiple combinations and several groups of taxa</p></a></li>
<li><a href='#Zeta.sam.sensitivity'><p>Sensitivity analysis for the sample size of zeta</p></a></li>
<li><a href='#Zeta.scale.min.dist'><p>Zeta diversity scaling with sample grain dependency based on the minimum distance between sites</p></a></li>
<li><a href='#Zeta.scale.regular'><p>Zeta diversity scaling with sample grain using hierarchical increases in grain size</p></a></li>
<li><a href='#Zeta.varpart'><p>Variation partitioning for zeta diversity</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Functions to Compute Compositional Turnover Using Zeta Diversity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-08</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to compute compositional turnover using zeta-diversity,
    the number of species shared by multiple assemblages. The package includes
    functions to compute zeta-diversity for a specific number of
    assemblages and to compute zeta-diversity for a range of numbers of
    assemblages. It also includes functions to explain how zeta-diversity
    varies with distance and with differences in environmental variables
    between assemblages, using generalised linear models, linear models
    with negative constraints, generalised additive models,shape
    constrained additive models, and I-splines.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), scam</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, graphics, grDevices, utils, car, mgcv, vegan, geodist,
nnls, glm2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-10 09:40:10 UTC; guillaumelatombe</td>
</tr>
<tr>
<td>Author:</td>
<td>Guillaume Latombe [aut, cre],
  Melodie A. McGeoch [aut],
  David A. Nipperess [aut],
  Cang Hui [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guillaume Latombe &lt;latombe.guillaume@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-10 22:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bird.env.coarse'>South-East Australia Environmental Dataset at Coarse Scale</h2><span id='topic+bird.env.coarse'></span>

<h3>Description</h3>

<p>Projected coordinates and environmental variables in 123, 100 x 100 km sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bird.env.coarse)
</code></pre>


<h3>Format</h3>

<p>A data frame with 123 rows (sites) and 9 columns (xy coordinates and environmental variables).
</p>


<h3>Details</h3>

<p>The data set contains the following variables:
</p>

<ul>
<li><p>x: x-position in meters in UTM 53 South projection
</p>
</li>
<li><p>y: y-position in meters in UTM 53 South projection
</p>
</li>
<li><p>Natural: Proportion of area of conservation and natural environments
</p>
</li>
<li><p>Irrigated: Proportion of area of production from irrigated agriculture and plantations
</p>
</li>
<li><p>Water: Proportion of area of water features
</p>
</li>
<li><p>Elevation: Elevation
</p>
</li>
<li><p>ApP: Area per person
</p>
</li>
<li><p>Temp: Temperature
</p>
</li>
<li><p>Precip: Precipitation
</p>
</li></ul>

<p>Location: Australia &ndash; 51째 27' 2.27&quot; S, 135째 21' 35.19&quot; E
</p>
<p>Data owners: ABARES, Australian Bureau of Statistics,GEBCO, WorldClim
</p>


<h3>References</h3>

<p>http://data.daff.gov.au/anrdl/metadata_files/pa_luav4g9abl07811a00.xml
</p>
<p>http://www.gebco.net/
</p>
<p>http://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/1270.0.55.0072011?
</p>
<p>http://www.worldclim.org/
</p>
<p>Hijmans, R.J., Cameron, S.E., Parra, J.L., Jones, P.G. &amp; Jarvis, A. (2005) Very high resolution interpolated climate surfaces for global land areas. International journal of climatology, 25, 1965-1978.
</p>

<hr>
<h2 id='bird.env.fine'>South-East Australia Environmental Dataset at Fine Scale</h2><span id='topic+bird.env.fine'></span>

<h3>Description</h3>

<p>Projected coordinates and environmental variables in 604, 25 x 25 km contiguous sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bird.env.fine)
</code></pre>


<h3>Format</h3>

<p>A data frame with 604 rows (sites) and 9 columns (xy coordinates and environmental variables).
</p>


<h3>Details</h3>

<p>The data set contains the following variables:
</p>

<ul>
<li><p>x: x-position in meters in UTM 53 South projection
</p>
</li>
<li><p>y: y-position in meters in UTM 53 South projection
</p>
</li>
<li><p>Natural: Proportion of area of conservation and natural environments
</p>
</li>
<li><p>Irrigated: Proportion of area of production from irrigated agriculture and plantations
</p>
</li>
<li><p>Water: Proportion of area of water features
</p>
</li>
<li><p>Elevation: Elevation
</p>
</li>
<li><p>ApP: Area per person
</p>
</li>
<li><p>Temp: Temperature
</p>
</li>
<li><p>Precip: Precipitation
</p>
</li></ul>

<p>Location: Australia &ndash; 50째 33' 5.03&quot; S, 135째 21' 10.40&quot; E
</p>
<p>Data owners: ABARES, Australian Bureau of Statistics,GEBCO, WorldClim
</p>


<h3>References</h3>

<p>http://data.daff.gov.au/anrdl/metadata_files/pa_luav4g9abl07811a00.xml
</p>
<p>http://www.gebco.net/
</p>
<p>http://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/1270.0.55.0072011?
</p>
<p>http://www.worldclim.org/
</p>
<p>Hijmans, R.J., Cameron, S.E., Parra, J.L., Jones, P.G. &amp; Jarvis, A. (2005) Very high resolution interpolated climate surfaces for global land areas. International journal of climatology, 25, 1965-1978.
</p>

<hr>
<h2 id='bird.spec.coarse'>Australia Bird Atlas Species Occurrence Dataset at Coarse Scale over South-East Australia</h2><span id='topic+bird.spec.coarse'></span>

<h3>Description</h3>

<p>Inventory of bird species occurrence in 123, 100 x 100 km sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bird.spec.coarse)
</code></pre>


<h3>Format</h3>

<p>A data frame with 123 rows (sites) and 193 columns (xy coordinates and species).
</p>


<h3>Details</h3>


<ul>
<li><p>x: x-position in meters in UTM 53 South projection
</p>
</li>
<li><p>y: y-position in meters in UTM 53 South projection
</p>
</li>
<li><p>columns 3-193: bird species occurrence
</p>
</li></ul>

<p>The original bird occurrence data were arranged into a continuous grid covering South-East Australia. Only cells whose richness was within 10 percents of real estimated richness are included here, so that the data corresponds to presence-absence data.
</p>
<p>Location: Australia &ndash; 51째 27' 2.27&quot; S, 135째 21' 35.19&quot; E
</p>
<p>Data owner: BirdLife Australia
</p>


<h3>References</h3>

<p>Barrett, G., Silcocks, A., Barry, S., Cunningham, R. &amp; Poulter, R. (2003) The new atlas of Australian birds. Royal Australasian Ornithologists Union, Melbourne, 1-824.
</p>

<hr>
<h2 id='bird.spec.fine'>Australia Bird Atlas Species Occurrence Dataset at Fine Scale over South-East Australia</h2><span id='topic+bird.spec.fine'></span>

<h3>Description</h3>

<p>Inventory of bird species occurrence in 604, 25 x 25 km sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bird.spec.fine)
</code></pre>


<h3>Format</h3>

<p>A data frame with 604 rows (sites) and 193 columns (xy coordinates and species).
</p>


<h3>Details</h3>


<ul>
<li><p>x: x-position in meters in UTM 53 South projection
</p>
</li>
<li><p>y: y-position in meters in UTM 53 South projection
</p>
</li>
<li><p>columns 3-192: bird species occurrence
</p>
</li></ul>

<p>Location: Australia &ndash; 50째 33' 5.03&quot; S, 135째 21' 10.40&quot; E
</p>
<p>Data owner: BirdLife Australia
</p>
<p>The original bird occurrence data were arranged into a continuous grid covering South-East Australia. Only cells whose richness was within 10 percents of real estimated richness are included here, so that the data corresponds to presence-absence data.
</p>


<h3>References</h3>

<p>Barrett, G., Silcocks, A., Barry, S., Cunningham, R. &amp; Poulter, R. (2003) The new atlas of Australian birds. Royal Australasian Ornithologists Union, Melbourne, 1-824.
</p>

<hr>
<h2 id='glm.cons'>Fitting Generalized Linear Models with constraint on the coefficients signs</h2><span id='topic+glm.cons'></span>

<h3>Description</h3>

<p><code>glm.cons</code> is an adaptation of function <code>glm2</code> from package {glm2} in which the least squares estimation is replaced by a regression with signs constraint on the coefficients using function <code>nnnpls</code> from package {nnls}.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.cons(
  formula,
  family = stats::gaussian(),
  data,
  weights,
  subset,
  na.action,
  start = NULL,
  etastart,
  mustart,
  offset,
  control = list(...),
  model = TRUE,
  method = "glm.fit.cons",
  cons = -1,
  cons.inter = 1,
  x = FALSE,
  y = TRUE,
  contrasts = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.cons_+3A_formula">formula</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_family">family</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_data">data</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_weights">weights</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_subset">subset</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_na.action">na.action</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_start">start</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_etastart">etastart</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_mustart">mustart</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_offset">offset</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_control">control</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_model">model</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_method">method</code></td>
<td>
<p>the method used in fitting the model. The default method &quot;<code>glm.fit.cons</code>&quot; uses function nnnpls from package nnls instead of <code>lm.fit</code> to impose the sign of the coefficients. As in <code>glm</code>, the alternative method &quot;<code>model.frame</code>&quot; returns the model frame and does no fitting.</p>
</td></tr>
<tr><td><code id="glm.cons_+3A_cons">cons</code></td>
<td>
<p>type of constraint. Default is -1 for negative coefficients on the predictors. The other option is 1 for positive coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="glm.cons_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="glm.cons_+3A_x">x</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_y">y</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_contrasts">contrasts</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="glm.cons_+3A_...">...</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned by <code>glm.cons</code> has exactly the same structure as the value returned by <code>glm</code> and <code>glm.2</code>.
</p>


<h3>References</h3>

<p>Marschner, I.C. (2011) glm2: Fitting generalized linear models with convergence problems. <em>The R Journal</em>, 3(2), 12-15.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="glm2.html#topic+glm2">glm2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Dobson (1990) Page 93: Randomized Controlled Trial :
counts &lt;- c(18,17,15,20,10,20,25,13,12)
outcome &lt;- gl(3,1,9)
treatment &lt;- gl(3,3)
print(d.AD &lt;- data.frame(treatment, outcome, counts))
glm.D93 &lt;- glm.cons(counts ~ outcome + treatment, family = poisson())
glm.D93.ngl &lt;- glm.cons(counts ~ outcome + treatment, family = poisson(),
   method="glm.fit.cons")
summary(glm.D93)
summary(glm.D93.ngl)
</code></pre>

<hr>
<h2 id='glm.fit.cons'>Generalized Linear Models fitting method with negative coefficients constraint</h2><span id='topic+glm.fit.cons'></span>

<h3>Description</h3>

<p><code>glm.fit.cons</code> is an adaptation of function <code>glm.fit2</code> from package {glm2} in which the least squares estimation is replaced by a non-positive regression using function <code>nnnpls</code> from package {nnls}.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.fit.cons(
  x,
  y,
  weights = rep(1, nobs),
  cons = -1,
  cons.inter = 1,
  start = NULL,
  etastart = NULL,
  mustart = NULL,
  offset = rep(0, nobs),
  family = stats::gaussian(),
  control = list(),
  intercept = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm.fit.cons_+3A_x">x</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_y">y</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_weights">weights</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_cons">cons</code></td>
<td>
<p>type of constraint. Default is -1 for negative coefficients on the predictors. The other option is 1 for positive coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_start">start</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_etastart">etastart</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_mustart">mustart</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_offset">offset</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_family">family</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_control">control</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
<tr><td><code id="glm.fit.cons_+3A_intercept">intercept</code></td>
<td>
<p>as for <code><a href="stats.html#topic+glm.fit">glm.fit</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value returned by <code>glm.fit.cons</code> has exactly the same structure as the value returned by <code>glm.fit</code> and <code>glm.fit2</code>.
</p>


<h3>References</h3>

<p>Marschner, I.C. (2011) glm2: Fitting generalized linear models with convergence problems. <em>The R Journal</em>, 3(2), 12-15.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm.fit">glm.fit</a></code>, <code><a href="glm2.html#topic+glm.fit2">glm.fit2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Dobson (1990) Page 93: Randomized Controlled Trial :
counts &lt;- c(18,17,15,20,10,20,25,13,12)
outcome &lt;- gl(3,1,9)
treatment &lt;- gl(3,3)
print(d.AD &lt;- data.frame(treatment, outcome, counts))
glm.D93 &lt;- glm.cons(counts ~ outcome + treatment, family = poisson())
glm.D93.ngl &lt;- glm.cons(counts ~ outcome + treatment, family = poisson(),
   method="glm.fit.cons")
summary(glm.D93)
summary(glm.D93.ngl)
</code></pre>

<hr>
<h2 id='Ispline'>Transform data using I-splines</h2><span id='topic+Ispline'></span>

<h3>Description</h3>

<p>Evaluates the I-splines for all variables of a data frame, as performed in <code>Zeta.msgdm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Ispline(dat, order.ispline = 2, kn.ispline = 1, rescale = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Ispline_+3A_dat">dat</code></td>
<td>
<p>A data frame whose columns are variables to be transformed using I-splines.</p>
</td></tr>
<tr><td><code id="Ispline_+3A_order.ispline">order.ispline</code></td>
<td>
<p>Order of the I-spline.</p>
</td></tr>
<tr><td><code id="Ispline_+3A_kn.ispline">kn.ispline</code></td>
<td>
<p>Number of knots in the I-spline.</p>
</td></tr>
<tr><td><code id="Ispline_+3A_rescale">rescale</code></td>
<td>
<p>Indicates how to rescale the values between 0 and 1. Default is 0, which divides the data by the maximum value. Any other value corresponds to setting the minimum value to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Ispline</code> returns a data frame with the same number of rows as dat and
</p>
<p><code>ncol(dat)</code> * <code>(order.ispline</code> + <code>kn.ispline)</code> columns.
</p>


<h3>References</h3>

<p>Ramsay, J. O. (1988). Monotone regression splines in action. <em>Statistical Science</em>, 425-441.
</p>
<p>Ferrier, S., Manion, G., Elith, J., &amp; Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. <em>Diversity and Distributions</em>, 13(3), 252-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.env.coarse)
data.env &lt;- bird.env.coarse[,3:9]
data.env.splines &lt;- Ispline(data.env)
</code></pre>

<hr>
<h2 id='Marion.env'>Marion Island Environmental Dataset</h2><span id='topic+Marion.env'></span>

<h3>Description</h3>

<p>Geographic coordinates, altitude and island side (East, West) at 12 plots (4 transects and 3 altitudes) on Marion Island.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Marion.env)
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 rows (plots) and 4 columns (variables).
</p>


<h3>Details</h3>

<p>The data set contains the following variables:
</p>

<ul>
<li><p>x: x-position in meters in UTM 37 projection
</p>
</li>
<li><p>y: y-position in meters in UTM 37 projection
</p>
</li>
<li><p>Altitude: mean elevation
</p>
</li>
<li><p>Side: cardinal (East or West) side of the island
</p>
</li></ul>

<p>Location: Marion Island &ndash; 46째 53' 34.2&quot; S, 37 degrees 45' 02.3&quot; E
</p>
<p>Data owner: Melodie A. McGeoch
</p>


<h3>References</h3>

<p>Nyakatya, M.J. &amp; McGeoch, M.A. (2008). Temperature variation across Marion Island associated with a keystone plant species (<em>Azorella selago</em> Hook. (Apiaceae)). Polar Biology, 31, 139-151.
</p>
<p>McGeoch, M.A., Le Roux, P.C., Hugo, E.A. &amp; Nyakatya, M.J. (2008). Spatial variation in the terrestrial biotic system. The Prince Edward Islands: Land-Sea Interactions in a Changing World (ed. by S.L. Chown and P.W. Froneman), pp. 245-276. African SunMedia, Stellenbosch.
</p>

<hr>
<h2 id='Marion.species'>Marion Island Species Presence-Absence Dataset</h2><span id='topic+Marion.species'></span>

<h3>Description</h3>

<p>Inventory of springtails and mite species presence-absence in 12 plots (4 transects and 3 altitudes) on Marion Island.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Marion.species)
</code></pre>


<h3>Format</h3>

<p>A data frame with 12 rows (plots) and 33 columns (species).
</p>


<h3>Details</h3>

<p>The data set contains the following variables:
</p>

<ul>
<li><p>x: x-position in meters in UTM 37 South projection
</p>
</li>
<li><p>y: y-position in meters in UTM 37 South projection
</p>
</li>
<li><p>columns 3-24: mite species presence absence
</p>
</li>
<li><p>columns 25-33: springtail species presence absence
</p>
</li></ul>

<p>Location: Marion Island &ndash; 46째 53' 34.2&quot; S, 37 degrees 45' 02.3&quot; E
</p>
<p>Data owner: Melodie A. McGeoch
</p>


<h3>References</h3>

<p>Nyakatya, M.J. &amp; McGeoch, M.A. (2008). Temperature variation across Marion Island associated with a keystone plant species (<em>Azorella selago</em> Hook. (Apiaceae)). Polar Biology, 31, 139-151.
</p>
<p>McGeoch, M.A., Le Roux, P.C., Hugo, E.A. &amp; Nyakatya, M.J. (2008). Spatial variation in the terrestrial biotic system. The Prince Edward Islands: Land-Sea Interactions in a Changing World (ed. by S.L. Chown and P.W. Froneman), pp. 245-276. African SunMedia, Stellenbosch.
</p>

<hr>
<h2 id='pie.neg'>Pie Chart, considering negative values as zeros</h2><span id='topic+pie.neg'></span>

<h3>Description</h3>

<p>Plots a pie chart, considering negative values as zeros, for the purpose of illustrating variation partitioning.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pie.neg(
  x,
  labels = names(x),
  edges = 200,
  radius = 0.8,
  clockwise = FALSE,
  init.angle = if (clockwise) 90 else 0,
  density = NULL,
  angle = 45,
  col = NULL,
  border = NULL,
  lty = NULL,
  main = NULL,
  warning = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pie.neg_+3A_x">x</code></td>
<td>
<p>A vector of non-negative numerical quantities. The values in x are displayed as the areas of pie slices.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_labels">labels</code></td>
<td>
<p>One or more expressions or character strings giving names for the slices. Other objects are coerced by <code><a href="grDevices.html#topic+as.graphicsAnnot">as.graphicsAnnot</a></code>. For empty or NA (after coercion to character) labels, no label nor pointing line is drawn.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_edges">edges</code></td>
<td>
<p>The circular outline of the pie is approximated by a polygon with this many edges.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_radius">radius</code></td>
<td>
<p>The pie is drawn centered in a square box whose sides range from -1 to 1. If the character strings labeling the slices are long it may be necessary to use a smaller radius.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_clockwise">clockwise</code></td>
<td>
<p>Logical indicating if slices are drawn clockwise or counter clockwise (i.e., mathematically positive direction, used by default).</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_init.angle">init.angle</code></td>
<td>
<p>number specifying the starting angle (in degrees) for the slices. Defaults to 0 (i.e., '3 o'clock') unless clockwise is true where init.angle defaults to 90 (degrees), (i.e., '12 o'clock').</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_density">density</code></td>
<td>
<p>The density of shading lines, in lines per inch. The default value of NULL means that no shading lines are drawn. Non-positive values of density also inhibit the drawing of shading lines.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_angle">angle</code></td>
<td>
<p>The slope of shading lines, given as an angle in degrees (counter-clockwise).</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_col">col</code></td>
<td>
<p>A vector of colors to be used in filling or shading the slices. If missing a set of 6 pastel colours is used, unless density is specified when par(&quot;fg&quot;) is used.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_border">border</code>, <code id="pie.neg_+3A_lty">lty</code></td>
<td>
<p>(possibly vectors) arguments passed to polygon which draws each slice.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_main">main</code></td>
<td>
<p>An overall title for the plot.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_warning">warning</code></td>
<td>
<p>Boolean value. Set to FALSE to avoid displaying a warning if some values are negative and set to 0.</p>
</td></tr>
<tr><td><code id="pie.neg_+3A_...">...</code></td>
<td>
<p>Graphical parameters can be given as arguments to pie. They will affect the main title and labels only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is identical to the function <code><a href="graphics.html#topic+pie">pie</a></code> in {graphics}, except that it considers all negative values as zeros, to allow for plotting variation partitioning outputs. The original <code><a href="graphics.html#topic+pie">pie</a></code> function returns an error when negative values are present. However, variation partitioning can return negative values, which can then be treated as zeros (Legendre &amp; Legendre, 2008). This function allows direct use of the results from <code><a href="#topic+Zeta.varpart">Zeta.varpart</a></code> without editing the data.
</p>


<h3>References</h3>

<p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988). <em>The new S language</em>. Wadsworth &amp; Brooks/Cole.
</p>
<p>Cleveland, W. S. (1985). <em>The elements of graphing data</em>. Wadsworth: Monterey, CA, USA.
</p>
<p>Legendre, P. &amp;  Legendre, L.F. (2012). <em>Numerical ecology</em>, 3rd English edition. Elsevier Science BV, Amsterdam.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pie">pie</a></code>, <code><a href="#topic+Zeta.varpart">Zeta.varpart</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pie.neg(rep(1, 24), col = rainbow(24), radius = 0.9)
</code></pre>

<hr>
<h2 id='Plot.ispline'>Plots I-splines for Multi-Site Generalised Dissimilarity Modelling</h2><span id='topic+Plot.ispline'></span>

<h3>Description</h3>

<p>Plots I-splines computed by <code>Return.ispline</code>, or calls <code>Return.ispline</code> if the outputs from <code>Zeta.msgdm</code> are provided before plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.ispline(
  isplines = NULL,
  msgdm,
  data.env,
  distance = FALSE,
  biotic = 0,
  pch = NULL,
  lty = NULL,
  legend = TRUE,
  lwd = 1,
  cex = 1,
  num.quantiles = 11
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.ispline_+3A_isplines">isplines</code></td>
<td>
<p>Output of function <code>Return.ispline</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_msgdm">msgdm</code></td>
<td>
<p>Output of function <code>Zeta.msgdm</code> computed with <code>reg.type = ispline</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_data.env">data.env</code></td>
<td>
<p>Site-by-variable data frame used for the computation of <code>msgdm</code>, with sites as rows and environmental variables as columns.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_distance">distance</code></td>
<td>
<p>Boolean, indicates is distance was used in the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_biotic">biotic</code></td>
<td>
<p>Boolean, indicates is zeta diversity from another community was used in the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_pch">pch</code></td>
<td>
<p>Shapes of the points to be used in the plotting. If nothing is provided, <code>pch</code> is a sequence of integers from 1 to the number of variables used for the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_lty">lty</code></td>
<td>
<p>Line types to be used in the plotting. If nothing is provided, <code>lty</code> is a sequence of integers from 1 to the number of variables used for the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_legend">legend</code></td>
<td>
<p>Boolean, indicates if the legend must be drawn.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_lwd">lwd</code></td>
<td>
<p>Line width.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_cex">cex</code></td>
<td>
<p>Point size.</p>
</td></tr>
<tr><td><code id="Plot.ispline_+3A_num.quantiles">num.quantiles</code></td>
<td>
<p>Number of points to plot on the I-splines. Default is 11 to plot a point every 10 percents of the range of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Plot.ispline</code> returns a data frame with the same number of rows as dat and <code>ncol(dat)</code> * <code>(order.ispline</code> + <code>kn.ispline)</code> columns.
</p>


<h3>References</h3>

<p>Ramsay, J. O. (1988). Monotone regression splines in action. <em>Statistical Science</em>, 425-441.
</p>
<p>Ferrier, S., Manion, G., Elith, J., &amp; Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. <em>Diversity and Distributions</em>, 13(3), 252-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]
data.spec.marion &lt;- Marion.species[3:33]

utils::data(Marion.env)
data.env.marion &lt;- Marion.env[3]

zeta.ispline &lt;- Zeta.msgdm(data.spec.marion, data.env.marion, xy.marion, sam = 100,
    order = 3, normalize = "Jaccard", reg.type = "ispline")
zeta.ispline
zeta.ispline.r &lt;- Return.ispline(zeta.ispline, data.env.marion, distance = TRUE)
zeta.ispline.r

dev.new()
Plot.ispline(isplines = zeta.ispline.r, distance = TRUE)

dev.new()
Plot.ispline(msgdm = zeta.ispline, data.env = data.env.marion, distance = TRUE)


</code></pre>

<hr>
<h2 id='Plot.zeta.ddecay'>Zeta distance-decay plotting</h2><span id='topic+Plot.zeta.ddecay'></span>

<h3>Description</h3>

<p>Plots the output of the function <code>Zeta.ddecay</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.zeta.ddecay(zeta.ddecay)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.zeta.ddecay_+3A_zeta.ddecay">zeta.ddecay</code></td>
<td>
<p>A list produced by the function <code>Zeta.ddecay</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the zeta distance-decay with distance on the x-axis and the value of zeta on the y-axis.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.ddecay">Zeta.ddecay</a></code>,
</p>
<p><code><a href="#topic+Zeta.ddecays">Zeta.ddecays</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new()
zeta.ddecay.bird &lt;- Zeta.ddecay(xy.bird, data.spec.bird, sam = 100, order = 3,
    confint.level = 0.95,plot=FALSE)
Plot.zeta.ddecay(zeta.ddecay.bird)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

zeta.ddecay.marion &lt;- Zeta.ddecay(xy.marion, data.spec.marion, sam = 100, order = 3,
    confint.level = 0.95, trsf = "log", normalize = "Jaccard",plot=FALSE)
dev.new()
Plot.zeta.ddecay(zeta.ddecay.marion)

</code></pre>

<hr>
<h2 id='Plot.zeta.ddecays'>Zeta distance-decay plotting for multiple orders</h2><span id='topic+Plot.zeta.ddecays'></span>

<h3>Description</h3>

<p>Plots the output of the function <code>Zeta.ddecays</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.zeta.ddecays(zeta.ddecays)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.zeta.ddecays_+3A_zeta.ddecays">zeta.ddecays</code></td>
<td>
<p>A list produced by the function <code>Zeta.ddecays</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the zeta distance-decay with the orders on the x-axis and the slope of the linear distance-decays on the y-axis.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.ddecays">Zeta.ddecays</a></code>,
</p>
<p><code><a href="#topic+Zeta.ddecay">Zeta.ddecay</a></code>, <code><a href="#topic+Plot.zeta.ddecay">Plot.zeta.ddecay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new()
zeta.ddecays.bird &lt;- Zeta.ddecays(xy.bird, data.spec.bird, sam = 100, orders = 2:5,
    plot = FALSE, confint.level = 0.95)
Plot.zeta.ddecays(zeta.ddecays.bird)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new()
zeta.ddecays.marion &lt;- Zeta.ddecays(xy.marion, data.spec.marion, sam = 100,
   orders = 2:5, plot = FALSE, confint.level = 0.95)
Plot.zeta.ddecays(zeta.ddecays.marion)

</code></pre>

<hr>
<h2 id='Plot.zeta.decline'>Zeta diversity decline plotting</h2><span id='topic+Plot.zeta.decline'></span>

<h3>Description</h3>

<p>Plots the output of the functions <code>Zeta.decline.mc</code> and <code>Zeta.decline.ex</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.zeta.decline(zeta, sd.plot = TRUE, arrange.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.zeta.decline_+3A_zeta">zeta</code></td>
<td>
<p>A list produced by the function <code>Zeta.decline.mc</code> or <code>Zeta.decline.ex</code>.</p>
</td></tr>
<tr><td><code id="Plot.zeta.decline_+3A_sd.plot">sd.plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation of each zeta diversity value must be plotted.</p>
</td></tr>
<tr><td><code id="Plot.zeta.decline_+3A_arrange.plots">arrange.plots</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the graphics device must be divided into 4 subplots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the zeta decline with 4 subplots displaying (i) the raw decline, (ii) the ratios of the zeta values (computed as <code class="reqn">\zeta_i / \zeta_{i-1}</code>), (iii) the fit in a log plot and (iv) the fit in a log-log plot.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[1:2]
data.spec.bird &lt;- bird.spec.coarse[3:193]

dev.new(width = 12, height = 4)
zeta.bird &lt;- Zeta.decline.mc(data.spec.bird, orders = 1:5, sam=100, plot = FALSE)
Plot.zeta.decline(zeta.bird)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]
data.spec.marion &lt;- Marion.species[3:33]

dev.new(width = 12, height = 4)
zeta.marion &lt;- Zeta.decline.ex(data.spec.marion, orders = 1:5, plot = FALSE)
Plot.zeta.decline(zeta.marion)

</code></pre>

<hr>
<h2 id='Plot.zeta.scale.min.dist'>Plotting of zeta diversity scaling with sample grain dependency based on the minimum distance between sites</h2><span id='topic+Plot.zeta.scale.min.dist'></span>

<h3>Description</h3>

<p>Plots the output of the function <code>Zeta.scale.min.dist</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.zeta.scale.min.dist(
  zeta.scale.irreg,
  size.init = 1,
  add = FALSE,
  ylim = NULL,
  col = "black"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.zeta.scale.min.dist_+3A_zeta.scale.irreg">zeta.scale.irreg</code></td>
<td>
<p>A list generated by the function <code>Zeta.scale.min.dist</code>.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.min.dist_+3A_size.init">size.init</code></td>
<td>
<p>Initial size of the plots before aggregation.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.min.dist_+3A_add">add</code></td>
<td>
<p>Boolean value indicating if the graph must be plotted in a new graphics device or added to the active one.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.min.dist_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length 2, giving the range of y values.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.min.dist_+3A_col">col</code></td>
<td>
<p>String indicating the color of the graph.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the zeta diversity scaling with the mapping grain m (the number of sites combined to generate data at a coarser grain) on the x-axis and the value of zeta on the y-axis.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>,
</p>
<p><code><a href="#topic+Zeta.scale.min.dist">Zeta.scale.min.dist</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>, <code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>,
</p>
<p><code><a href="#topic+Plot.zeta.scale.regular">Plot.zeta.scale.regular</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

zeta.scale.irreg.species &lt;- Zeta.scale.min.dist(xy.marion, data.spec.marion, m = 1:3,
    order = 3, reorder = 3, sam = 50, normalize = "Jaccard",plot=FALSE)
dev.new()
Plot.zeta.scale.min.dist(zeta.scale.irreg.species)
</code></pre>

<hr>
<h2 id='Plot.zeta.scale.regular'>Plotting of zeta diversity scaling with sample grain using hierarchical increases in grain size</h2><span id='topic+Plot.zeta.scale.regular'></span>

<h3>Description</h3>

<p>Plots the output of the function <code>Zeta.scale.regular</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Plot.zeta.scale.regular(
  zeta.scale.reg,
  size.init = 1,
  add = FALSE,
  ylim = NULL,
  col = "black"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Plot.zeta.scale.regular_+3A_zeta.scale.reg">zeta.scale.reg</code></td>
<td>
<p>A list generated by the function <code>Zeta.scale.regular</code>.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.regular_+3A_size.init">size.init</code></td>
<td>
<p>initial Size of the plots before aggregation.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.regular_+3A_add">add</code></td>
<td>
<p>Boolean value indicating if the graph must be plotted in a new graphics device or added to the active one.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.regular_+3A_ylim">ylim</code></td>
<td>
<p>Numeric vectors of length 2, giving the range of y values.</p>
</td></tr>
<tr><td><code id="Plot.zeta.scale.regular_+3A_col">col</code></td>
<td>
<p>String indicating the color of the graph.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the zeta diversity scaling with the mapping grain <code>n</code> x <code>n</code> (the number of sites combined to generate data at a coarser grain) on the x-axis and the value of zeta on the y-axis.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>,
</p>
<p><code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code>, <code><a href="#topic+Zeta.scale.min.dist">Zeta.scale.min.dist</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>,
</p>
<p><code><a href="#topic+Plot.zeta.scale.min.dist">Plot.zeta.scale.min.dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.fine)
xy.bird &lt;- bird.spec.fine[1:400,1:2]
data.spec.bird &lt;- bird.spec.fine[1:400,3:192]

##sam = 25 is used here for fast execution, but a higher value is advised
zeta.scale.reg &lt;- Zeta.scale.regular(xy.bird, data.spec.bird, n = 1:3, order = 3,
    sam = 25, normalize = "Jaccard",plot=FALSE)
dev.new()
Plot.zeta.scale.regular(zeta.scale.reg)
</code></pre>

<hr>
<h2 id='Predict.msgdm'>Predict zeta values for new environmental and distance data</h2><span id='topic+Predict.msgdm'></span>

<h3>Description</h3>

<p>Predict the zeta values for new environmental and distance data from the models returned by <code>Zeta.msgdm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Predict.msgdm(model.msgdm, reg.type, newdata, type = "response")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Predict.msgdm_+3A_model.msgdm">model.msgdm</code></td>
<td>
<p>A model returned by <code>Zeta.msgdm</code>. The class of the model depends on the type of regression used in <code>Zeta.msgdm</code>.</p>
</td></tr>
<tr><td><code id="Predict.msgdm_+3A_reg.type">reg.type</code></td>
<td>
<p>Type of regression used in <code>Zeta.msgdm</code>. Options are &quot;<code>glm</code>&quot; for generalised linear models, &quot;<code>ngls</code>&quot; for negative linear models, &quot;<code>gam</code>&quot; for generalised additive models, &quot;<code>scam</code>&quot; for shape constrained additive models (with monotonic decreasing by default), and &quot;<code>ispline</code>&quot; for I-spline models (forcing monotonic decreasing), as recommended in generalised dissimilarity modelling by Ferrier <em>et al</em>. (2007).</p>
</td></tr>
<tr><td><code id="Predict.msgdm_+3A_newdata">newdata</code></td>
<td>
<p>A data frame with the new environmental and distance data. The names of the columns must be the same as the names used in the data frame used in <code>Zeta.msgdm</code>. For I-splines, the data frame must be generated beforehand from the original data by the function <code><a href="#topic+Ispline">Ispline</a></code>.</p>
</td></tr>
<tr><td><code id="Predict.msgdm_+3A_type">type</code></td>
<td>
<p>The type of prediction required, as for <code>predict.glm</code>. The default is on the scale of the response variable; the alternative &quot;link&quot; is on the scale of the linear predictors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Predict.msgdm</code> returns a vector of predicted zeta values.
</p>


<h3>References</h3>

<p>Ramsay, J. O. (1988). Monotone regression splines in action. <em>Statistical Science</em>, 425-441.
</p>
<p>Ferrier, S., Manion, G., Elith, J., &amp; Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. <em>Diversity and Distributions</em>, 13(3), 252-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.fine)
xy.bird &lt;- bird.spec.fine[1:500,1:2]
data.spec.bird &lt;- bird.spec.fine[1:500,3:192]
utils::data(bird.env.fine)
data.env.bird &lt;- bird.env.fine[1:500,3:9]

zeta.glm &lt;- Zeta.msgdm(data.spec.bird, data.env.bird, sam = 100, order = 3)
newdata &lt;- data.frame(matrix(NA,100,ncol(data.env.bird)))
names(newdata) &lt;- names(data.env.bird)
for(z in 1:100){
  samp &lt;- sample(1:104, 3, replace = FALSE)
  newdata[z,] &lt;- apply(apply(bird.env.fine[501:604,3:9][samp,], 2,
     stats::dist), 2, mean)
}
##rescale the data like during MS-GDM
newdata &lt;- newdata/matrix(rep(zeta.glm$rescale.factor,100),
   100,length(zeta.glm$rescale.factor),byrow=TRUE)
new.zeta.glm &lt;- Predict.msgdm(model.msgdm = zeta.glm$model, reg.type = "glm",
   newdata = newdata)



zeta.ngls &lt;- Zeta.msgdm(data.spec.bird, data.env.bird, sam = 100, order = 3,
   reg.type = "ngls", normalize = "Jaccard")
newdata &lt;- data.frame(matrix(NA,100,ncol(data.env.bird)))
names(newdata) &lt;- names(data.env.bird)
for(z in 1:100){
  samp &lt;- sample(1:104, 3, replace = FALSE)
  newdata[z,] &lt;- apply(apply(bird.env.fine[501:604,3:9][samp,], 2, stats::dist),
     2, mean)
}
##rescale the data like during MS-GDM
newdata &lt;- newdata/matrix(rep(zeta.ngls$rescale.factor,100),
   100,length(zeta.ngls$rescale.factor),byrow=TRUE)
new.zeta.ngls &lt;- Predict.msgdm(model.msgdm = zeta.ngls$model, reg.type = "ngls",
   newdata = newdata)
</code></pre>

<hr>
<h2 id='Reg.ispline'>Perform an I-spline regression</h2><span id='topic+Reg.ispline'></span>

<h3>Description</h3>

<p>Evaluates the I-splines for all variables of a data frame of predictor variables, and perform a generalised linear regression with constraint on the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reg.ispline(
  response,
  predictor,
  order.ispline = 2,
  kn.ispline = 1,
  family = stats::gaussian(),
  method.glm = "glm.fit.cons",
  cons = 1,
  cons.inter = 1,
  control = list(),
  Plot = TRUE,
  lty = NULL,
  lwd = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Reg.ispline_+3A_response">response</code></td>
<td>
<p>A vector of numeric values representing the response variable.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_predictor">predictor</code></td>
<td>
<p>A data frame of numeric variables representing the predictors.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_order.ispline">order.ispline</code></td>
<td>
<p>Order of the I-spline.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_kn.ispline">kn.ispline</code></td>
<td>
<p>Number of knots in the I-spline.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the <code>glm</code> model (see <code><a href="stats.html#topic+family">family</a></code> for details of family functions).</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_method.glm">method.glm</code></td>
<td>
<p>Method used in fitting the generalised linear model. The default method <br /> &quot;glm.fit.cons&quot; is an adaptation of method <code>glm.fit2</code> from package <code>glm2</code> using a constrained least squares regression in the reweighted least squares. Another option is &quot;glm.fit2&quot;, which calls <code>glm.fit2</code>; see help documentation for glm.fit2 in package <code>glm2</code>.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_cons">cons</code></td>
<td>
<p>type of constraint in the glm if <code>method.glm = "glm.fit.cons"</code>. Default is 1 for positive coefficients on the predictors. The other option is -1 for negative coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_control">control</code></td>
<td>
<p>As for <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_plot">Plot</code></td>
<td>
<p>Boolean value indicating if the I-splines must be plotted.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_lty">lty</code></td>
<td>
<p>Line types to be used in the plotting. If nothing is provided, <code>lty</code> is a sequence of integers from 1 to the number of variables used for the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Reg.ispline_+3A_lwd">lwd</code></td>
<td>
<p>Line width.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Reg.ispline</code> performs a non-linear regression using a combination of GLM and I-splines. It can, for example, be used to compare regression outputs when using MS-GDM with I-splines on environmental variables and biotic variables as in <code>Zetya.msgdm</code> to the same regression approach without environmental variables.
</p>


<h3>Value</h3>

<p><code>Reg.ispline</code> returns a list of the following elements:
</p>
<table role = "presentation">
<tr><td><code>splines</code></td>
<td>
<p>A data frame in which each columns contains the value resulting from the transformation of the predictors into individual I-splines. The number of columns of <code>splines</code> is the number of predictors times the number of splines (determined as the sum of <code>order.ispline</code> and <code>kn.ispline</code>).</p>
</td></tr>
<tr><td><code>spline</code></td>
<td>
<p>A data frame in which each columns contains the value resulting from the combinations of the individual I-splines. This combination is obtained by multiplying the coefficients of <code>model</code> and the values of the individual I-splines <code>splines</code></p>
</td></tr></table>
<p>.
</p>
<table role = "presentation">
<tr><td><code>model</code></td>
<td>
<p>A <code><a href="stats.html#topic+glm">glm</a></code> model using <code>response</code> as the response variable, and <code>splines</code> as the predictors</p>
</td></tr></table>
<p>.
</p>


<h3>References</h3>

<p>Ramsay, J. O. (1988). Monotone regression splines in action. <em>Statistical Science</em>, 425-441.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>,<code><a href="#topic+Ispline">Ispline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]

data.spec.marion &lt;- Marion.species[3:33]

##random other communities
data.spec.marion2a &lt;- data.spec.marion
data.spec.marion2a[which(data.spec.marion2a==1,arr.ind=TRUE)] &lt;- 0
for(i in 1:ncol(data.spec.marion2a))
  data.spec.marion2a[sample(nrow(data.spec.marion2a),8),i] &lt;- 1
data.spec.marion2b &lt;- data.spec.marion
data.spec.marion2b[which(data.spec.marion2b==1,arr.ind=TRUE)] &lt;- 0
for(i in 1:ncol(data.spec.marion2b))
data.spec.marion2b[sample(nrow(data.spec.marion2b),8),i] &lt;- 1

dat.spec.tot &lt;- list(data.spec.marion,data.spec.marion2a,data.spec.marion2b)
zeta.tot &lt;- Zeta.order.mc.mult(data.spec=dat.spec.tot,order=3,sam=200)
zeta.splines &lt;- Ispline(zeta.tot$zeta.val[,2:3])
data.tot &lt;- data.frame(zeta.val=zeta.tot$zeta.val[,1],zeta.splines$splines)

dev.new()
Reg.ispline(response = zeta.tot$zeta.val[,1], predictor = zeta.tot$zeta.val[,2:3], lwd=2, cons=1)
</code></pre>

<hr>
<h2 id='rescale.min.dist'>Rescaling of data based on the minimum distance between sites</h2><span id='topic+rescale.min.dist'></span>

<h3>Description</h3>

<p>Combines sites based on the minimum distance between them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rescale.min.dist(
  xy,
  data.spec,
  data.env = NULL,
  m,
  distance.type = "Euclidean",
  dist.custom = NULL,
  method = "mean",
  shuffle = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rescale.min.dist_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_data.env">data.env</code></td>
<td>
<p>Site-by-variable data frame, with sites as rows and environmental variables as columns.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_m">m</code></td>
<td>
<p>Mapping grain (the number of sites combined to generate data at a coarser grain). The <code>m</code> closest sites are grouped together.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_distance.type">distance.type</code></td>
<td>
<p>Method to compute distance. Default is &quot;<code>Euclidean</code>&quot;, for Euclidean distance. The other options are (i) &quot;<code>ortho</code>&quot; for orthodromic distance, if xy correspond to longitudes and latitudes (orthodromic distance is computed using the <code>geodist</code> function from package <code>geodist</code>); and (ii) &quot;<code>custom</code>&quot;, in which case the user must provide a distance matrix for <code>dist.custom</code>.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_dist.custom">dist.custom</code></td>
<td>
<p>Distance matrix provided by the user when <code>distance.type</code> = <code>"custom"</code>.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the coordinates and the environmental variables. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="rescale.min.dist_+3A_shuffle">shuffle</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the order of the sites must be randomised, which can have an impact on the outputs if some distances are equal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The nearest neighbouring sites (plots, quadrates, or areas of varying shapes) are grouped as spatial clusters of 2, 3, 4, etc. sites, based on the minimum distance between them. Since the procedure is based on the relative distance between sites, the site order can have an impact on the output. This function is suitable for both regularly and irregularly spaced sites, contiguous or non contiguous. For regularly spaced sites, the use of <code><a href="#topic+rescale.regular">rescale.regular</a></code> is recommended.
</p>


<h3>Value</h3>

<p><code>rescale.min.dist</code> returns a data frame with the rescaled data.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>,
</p>
<p><code><a href="#topic+Zeta.scale.min.dist">Zeta.scale.min.dist</a></code>, <code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

data.rescale &lt;- rescale.min.dist(xy.marion, data.spec.marion, m=2)

</code></pre>

<hr>
<h2 id='rescale.regular'>Rescaling of data following a hierarchical increase in grain size</h2><span id='topic+rescale.regular'></span>

<h3>Description</h3>

<p>Increases grain by hierarchically nesting regularly spaced sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rescale.regular(xy, data.spec, data.env = NULL, method = "mean", n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rescale.regular_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="rescale.regular_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="rescale.regular_+3A_data.env">data.env</code></td>
<td>
<p>Site-by-variable data frame, with sites as rows and environmental variables as columns.</p>
</td></tr>
<tr><td><code id="rescale.regular_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the coordinates and the environmental variables. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="rescale.regular_+3A_n">n</code></td>
<td>
<p>Mapping grain (the number of sites combined to generate data at a coarser grain). Regularly spaced sites are grouped as <code>n</code> x <code>n</code> sites.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sites (plots or quadrates) are aggregated as nearest neighbouring groups of <code>n</code> x <code>n</code> sites, using a nested approach, starting from the lowest x and y, to increase the grain. The sites can be spatially contiguous or discontiguous, as long as they are regularly spaced. This function is not suitable for irregularly spaced sites. If the total number of sites is not a multiple of <code>n</code> x <code>n</code>, the extra sites are discarded.
</p>


<h3>Value</h3>

<p><code>rescale.regular</code> returns a data frame with the rescaled data.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code>, <code><a href="#topic+Zeta.scale.min.dist">Zeta.scale.min.dist</a></code>, <code><a href="#topic+rescale.min.dist">rescale.min.dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(bird.spec.fine)
xy.bird &lt;- bird.spec.fine[1:2]
data.spec.bird &lt;- bird.spec.fine[3:192]

data.rescale &lt;- rescale.regular(xy.bird, data.spec.bird, n = 4)
</code></pre>

<hr>
<h2 id='Return.ispline'>Computing splines coordinates from I-spline-based multi-site generalised dissimilarity modelling</h2><span id='topic+Return.ispline'></span>

<h3>Description</h3>

<p>Stores the coordinates of the I-splines resulting from <code>Zeta.msgdm</code> for plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Return.ispline(msgdm, data.env, distance = FALSE, biotic = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Return.ispline_+3A_msgdm">msgdm</code></td>
<td>
<p>Output of function <code>Zeta.msgdm</code> computed with <code>reg.type = ispline</code>.</p>
</td></tr>
<tr><td><code id="Return.ispline_+3A_data.env">data.env</code></td>
<td>
<p>Site-by-variable data frame used for the computation of <code>msgdm</code>, with sites as rows and environmental variables as columns.</p>
</td></tr>
<tr><td><code id="Return.ispline_+3A_distance">distance</code></td>
<td>
<p>Boolean, indicates is distance was used in the computation of <code>msgdm</code>.</p>
</td></tr>
<tr><td><code id="Return.ispline_+3A_biotic">biotic</code></td>
<td>
<p>Integer, indicates the number of other groups of taxa for which zeta diversity was computed and used in the computation of <code>msgdm</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Return.ispline</code> allows to store the same number of coordinates for all I-splines, to average replicates and obtain confidence intervals.
</p>


<h3>Value</h3>

<p><code>Return.ispline</code> returns a list containing the following components used to plot the I-splines:
</p>
<table role = "presentation">
<tr><td><code>env</code></td>
<td>
<p>A data frame containing the rescaled environmental (numeric and factor), distance and biotic x-values.</p>
</td></tr>
<tr><td><code>Ispline</code></td>
<td>
<p>A data frame containing the I-spline values corresponding to the rescaled environmental (numeric and factor), distance and biotic x-values.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>, <code><a href="#topic+Ispline">Ispline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]
data.spec.marion &lt;- Marion.species[3:33]

utils::data(Marion.env)
data.env.marion &lt;- Marion.env[3]

zeta.ispline &lt;- Zeta.msgdm(data.spec.marion, data.env.marion, xy.marion, sam = 100,
    order = 3, normalize = "Jaccard", reg.type = "ispline")
zeta.ispline
zeta.ispline.r &lt;- Return.ispline(zeta.ispline, data.env.marion, distance = TRUE)
zeta.ispline.r

dev.new()
Plot.ispline(isplines = zeta.ispline.r, distance = TRUE)

dev.new()
Plot.ispline(msgdm = zeta.ispline, data.env = data.env.marion, distance = TRUE)

</code></pre>

<hr>
<h2 id='Zeta.ddecay'>Zeta distance decay for a specific number of assemblages or sites</h2><span id='topic+Zeta.ddecay'></span>

<h3>Description</h3>

<p>Computes the distance decay of zeta diversity for a specific order (number of assemblages or sites), using either a generalised linear model with possible constraint on the coefficients, a generalised additive model, or a shape constrained additive model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.ddecay(
  xy,
  data.spec,
  order = 2,
  sam = 1000,
  distance.type = "Euclidean",
  dist.custom = NULL,
  method = "mean",
  reg.type = "glm",
  family = stats::gaussian(),
  method.glm = "glm.fit.cons",
  cons = -1,
  cons.inter = 1,
  confint.level = 0.95,
  kn = -1,
  bs = "mpd",
  trsf = "NULL",
  cutoff = NULL,
  rescale = FALSE,
  normalize = FALSE,
  empty.row = "remove",
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.ddecay_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_distance.type">distance.type</code></td>
<td>
<p>Method to compute distance. Default is &quot;<code>Euclidean</code>&quot;, for Euclidean distance. The other options are (i) &quot;<code>ortho</code>&quot; for orthodromic distance, if xy correspond to longitudes and latitudes (orthodromic distance is computed using the <code>geodist</code> function from package <code>geodist</code>); and (ii) &quot;<code>custom</code>&quot;, in which case the user must provide a distance matrix for <code>dist.custom</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_dist.custom">dist.custom</code></td>
<td>
<p>Distance matrix provided by the user when <code>distance.type</code> = <code>"custom"</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the pairwise differences and distances for more than 3 sites. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_reg.type">reg.type</code></td>
<td>
<p>Type of regression. Options are &quot;<code>glm</code>&quot; for generalised linear models &quot;<code>gam</code>&quot; for generalised additive models and &quot;<code>scam</code>&quot; for shape constrained additive models (with monotonic decreasing by default).</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the <code>glm</code>, <code>gam</code> and <code>scam</code> models (see <code><a href="stats.html#topic+family">family</a></code> for details of family functions).</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_method.glm">method.glm</code></td>
<td>
<p>Method used in fitting the generalised linear model. The default method <br /> &quot;glm.fit.cons&quot; is an adaptation of method <code>glm.fit2</code> from package <code>glm2</code> using a negative least squares regression in the reweighted least squares. Another option is &quot;glm.fit2&quot;, which calls <code>glm.fit2</code>.; see help documentation for <code>glm.fit2</code> in package <code>glm</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_cons">cons</code></td>
<td>
<p>type of constraint in the glm if <code>method.glm = "glm.fit.cons"</code>. Default is -1 for negative coefficients on the predictors. The other option is 1 for positive coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_confint.level">confint.level</code></td>
<td>
<p>Percentage for the confidence intervals of the coefficients from the generalised linear models.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_kn">kn</code></td>
<td>
<p>Number of knots in the GAM and SCAM. Default is -1 for determining kn automatically using Generalized Cross-validation.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_bs">bs</code></td>
<td>
<p>A two-letter character string indicating the (penalized) smoothing basis to use in the scam model. Default is &quot;<code>mpd</code>&quot; for monotonic decreasing splines. see <code><a href="mgcv.html#topic+smooth.terms">smooth.terms</a></code> for an overview of what is available.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_trsf">trsf</code></td>
<td>
<p>Name of a function (as a string) indicating how to transform distance.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_cutoff">cutoff</code></td>
<td>
<p>If specified, maximum distance value for which the linear regression must be performed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity, and computation errors for the normalized version of zeta due to divisions by 0. Options are &quot;<code>empty</code>&quot; to let the data untreated, &quot;<code>remove</code>&quot; to remove the empty rows, 0 to set the normalized zeta to 0 when zeta is divided by 0 during normalization (sites share no species, so are completely dissimilar), and 1 to set the normalized zeta to 1 when zeta is divided by 0 during normalization (i.e. sites are perfectly similar).</p>
</td></tr>
<tr><td><code id="Zeta.ddecay_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Zeta.ddecay</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>order</code></td>
<td>
<p>The order of zeta for which the distance decay was computed.</p>
</td></tr>
<tr><td><code>reg.type</code></td>
<td>
<p>A character string indicating the type of regression that was performed.</p>
</td></tr>
<tr><td><code>reg</code></td>
<td>
<p>An object whose class depends on the type of regression (<code>glm</code>, <code>gam</code> or <code>scam</code>), corresponding to the regression over distance for the number of assemblages or sites specified in 'order'.</p>
</td></tr>
<tr><td><code>confint</code></td>
<td>
<p>The confidence intervals for the coefficients from the generalised linear model. <code>confint</code> is not generated for generalised additive models and shape constrained additive models.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>The values of zeta for the sampled sites used in the regression.</p>
</td></tr>
<tr><td><code>distance</code></td>
<td>
<p>The distances for the sampled sites used in the regression.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.ddecays">Zeta.ddecays</a></code>,
</p>
<p><code><a href="#topic+Plot.zeta.ddecay">Plot.zeta.ddecay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new()
zeta.ddecay.bird &lt;- Zeta.ddecay(xy.bird, data.spec.bird, sam = 100, order = 3,
    method.glm = "glm.fit2", confint.level = 0.95)
    
dev.new()
zeta.ddecay.bird &lt;- Zeta.ddecay(data.spec=data.spec.bird, distance.type = "custom",
    dist.custom = as.matrix(dist(xy.bird)), cutoff = 800000, sam = 100, order = 3,
    reg.type = "gam", confint.level = 0.95)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new()
zeta.ddecay.marion &lt;- Zeta.ddecay(xy.marion, data.spec.marion, sam = 100, order = 3,
    method.glm = "glm.fit2", confint.level = 0.95, trsf = "log", normalize = "Jaccard")

</code></pre>

<hr>
<h2 id='Zeta.ddecays'>Zeta distance decay for a range of numbers of assemblages or sites</h2><span id='topic+Zeta.ddecays'></span>

<h3>Description</h3>

<p>Computes the distance decay of zeta diversity for a range of orders (number of assemblages or sites), using generalised linear models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.ddecays(
  xy,
  data.spec,
  orders = 2:10,
  sam = 1000,
  family = stats::gaussian(),
  distance.type = "Euclidean",
  dist.custom = NULL,
  method = "mean",
  confint.level = 0.95,
  trsf = "NULL",
  cutoff = NULL,
  rescale = FALSE,
  normalize = FALSE,
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.ddecays_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_orders">orders</code></td>
<td>
<p>Range of number of assemblages or sites at which zeta diversity is computed. All the orders must be striclty greater than 1.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the generalised linear models (see <code><a href="stats.html#topic+family">family</a></code> for details of family functions).</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_distance.type">distance.type</code></td>
<td>
<p>Method to compute distance. Default is &quot;<code>Euclidean</code>&quot;, for Euclidean distance. The other options are (i) &quot;<code>ortho</code>&quot; for orthodromic distance, if xy correspond to longitudes and latitudes (orthodromic distance is computed using the <code>geodist</code> function from package <code>geodist</code>); and (ii) &quot;<code>custom</code>&quot;, in which case the user must provide a distance matrix for <code>dist.custom</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_dist.custom">dist.custom</code></td>
<td>
<p>Distance matrix provided by the user when <code>distance.type</code> = <code>"custom"</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the pairwise differences and distances for more than 3 sites. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_confint.level">confint.level</code></td>
<td>
<p>Percentage for the confidence intervals of the coefficients from the linear regression.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_trsf">trsf</code></td>
<td>
<p>Name of a function (as a string) indicating how to transform distance. Default is &quot;NULL&quot; for the identity transformation.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_cutoff">cutoff</code></td>
<td>
<p>If specified, maximum distance value for which the linear regression must be performed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.ddecays_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Zeta.ddecays</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>orders</code></td>
<td>
<p>Range of number of assemblages or sites at which zeta diversity was computed.</p>
</td></tr>
<tr><td><code>coefs</code></td>
<td>
<p>A vector of the coefficients from the generalised linear models for the numbers of sites specified by <code>orders</code>.</p>
</td></tr>
<tr><td><code>confint</code></td>
<td>
<p>The confidence intervals for the coefficients from the generalised linear models.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.ddecay">Zeta.ddecay</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new()
zeta.ddecays.bird &lt;- Zeta.ddecays(xy.bird, data.spec.bird, sam = 100, orders = 2:5,
    plot = TRUE, confint.level = 0.95)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new()
zeta.ddecays.marion &lt;- Zeta.ddecays(xy.marion, data.spec.marion, sam = 100,
   orders = 2:5, plot = TRUE, confint.level = 0.95)

</code></pre>

<hr>
<h2 id='Zeta.decline.ex'>Expectation of zeta diversity decline</h2><span id='topic+Zeta.decline.ex'></span>

<h3>Description</h3>

<p>Computes the expectation of zeta diversity, the number of species shared by multiple assemblages for a range of orders (number of assemblages or sites), using a formula based on the occupancy of the species, and fits the decline to an exponential and a power law relationship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.decline.ex(
  data.spec,
  orders = 1:10,
  sd.correct = TRUE,
  confint.level = 0.95,
  sd.plot = TRUE,
  rescale = FALSE,
  empty.row = "empty",
  plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.decline.ex_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_orders">orders</code></td>
<td>
<p>Range of number of assemblages or sites for which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_confint.level">confint.level</code></td>
<td>
<p>Percentage for the confidence intervals of the coefficients from the regressions.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_sd.plot">sd.plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation of each zeta diversity value must be plotted.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity. Options are  &quot;<code>empty</code>&quot; to let the data untreated or &quot;<code>remove</code>&quot; to remove the empty rows.</p>
</td></tr>
<tr><td><code id="Zeta.decline.ex_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Zeta.decline.ex</code> is much faster than <code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code> to compute the exact value of zeta diversity when the number of species is lower than <code class="reqn">C^N_{i}</code>, where <em>N</em> is the total number of sites and <em>i</em> is the order of zeta.
</p>
<p><code>sd.correct</code> should be set to <code>TRUE</code> if the assemblages represent a subsample of the whole system. It can be set to <code>FALSE</code> if the sampling is exhaustive, for example in case of a continuous regular grid covering the whole study area.
</p>
<p>The exponential and the power law fit are performed using linear regressions on log-transformed data (only the zeta values are log-transformed for the exponential fit, and both the orders and the zeta values are log-transformed for the power law fit).
</p>


<h3>Value</h3>

<p><code>Zeta.decline.ex</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>zeta.order</code></td>
<td>
<p>The number of assemblages or sites for which the zeta diversity was computed.</p>
</td></tr>
<tr><td><code>combinations</code></td>
<td>
<p>The number of possible combinations of sites for the chosen orders.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>The zeta diversity values.</p>
</td></tr>
<tr><td><code>zeta.val.sd</code></td>
<td>
<p>The zeta diversity standard deviation values.</p>
</td></tr>
<tr><td><code>zeta.ratio</code></td>
<td>
<p>The ratio of zeta diversity values by the zeta diversity values at the lower order <code class="reqn">\zeta_i / \zeta_{i-1}</code>.</p>
</td></tr>
<tr><td><code>zeta.exp</code></td>
<td>
<p>Object of class &quot;<code>lm</code>&quot;, containing the output of the exponential regression.</p>
</td></tr>
<tr><td><code>zeta.exp.confint</code></td>
<td>
<p>The confidence intervals of the coefficients of the exponential regression.</p>
</td></tr>
<tr><td><code>zeta.pl</code></td>
<td>
<p>Object of class &quot;<code>lm</code>&quot;, containing the output of the power law regression.</p>
</td></tr>
<tr><td><code>zeta.pl.confint</code></td>
<td>
<p>The confidence intervals of the coefficients of the power law regression.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC values for <code>zeta.exp</code> and <code>zeta.pl</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>McGeoch M. A., Latombe G., Andrew N. R., Nakagawa S., Nipperess D. A., Roige M., Marzinelli E. M., Campbell A. H., Verges A., Thomas T., Steinberg P. D., Selwood K. E., Henriksen M. V. &amp; Hui C. (2019). Measuring continuous compositional change using decline and decay in zeta diversity. <em>Ecology</em>, 100(11), e02832.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Plot.zeta.decline">Plot.zeta.decline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new(width = 12, height = 4)
zeta.bird &lt;- Zeta.decline.ex(data.spec.bird, orders = 1:5)
zeta.bird

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new(width = 12, height = 4)
zeta.marion &lt;- Zeta.decline.ex(data.spec.marion, orders = 1:5)
zeta.marion

</code></pre>

<hr>
<h2 id='Zeta.decline.mc'>Zeta diversity decline using Monte Carlo sampling</h2><span id='topic+Zeta.decline.mc'></span>

<h3>Description</h3>

<p>Computes zeta diversity, the number of species shared by multiple assemblages, for a range of orders (number of assemblages or sites), using combinations of sampled sites, and fits the decline to an exponential and a power law relationship.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.decline.mc(
  data.spec,
  xy = NULL,
  orders = 1:10,
  sam = 1000,
  sd.correct = TRUE,
  sd.correct.adapt = FALSE,
  confint.level = 0.95,
  sd.plot = TRUE,
  rescale = FALSE,
  normalize = FALSE,
  NON = FALSE,
  FPO = NULL,
  DIR = FALSE,
  empty.row = "empty",
  plot = TRUE,
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.decline.mc_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_xy">xy</code></td>
<td>
<p>Site coordinates. This is only used if <code>NON</code> = TRUE or <code>DIR</code> = TRUE.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_orders">orders</code></td>
<td>
<p>Range of number of assemblages or sites for which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed for each number of assemblages or sites.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_sd.correct.adapt">sd.correct.adapt</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) if <code>sam</code> is higher than the number of possible combinations, or not (using the number of site combinations as the denominator) if <code>sam</code> is lower than the number of possible combinations. If <code>sd.correct.adapt = TRUE</code>, it takes precedence over <code>sd.correct</code>.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_confint.level">confint.level</code></td>
<td>
<p>Percentage for the confidence intervals of the coefficients from the regressions.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_sd.plot">sd.plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation of each zeta diversity value must be plotted.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_non">NON</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the number of species in common should only be counted for the nearest neighbours.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_fpo">FPO</code></td>
<td>
<p>A vector with the coordinates of the fixed point origin from which the zeta diversity will be computed (overrides NON). In that case, <code class="reqn">\zeta_1</code> is the number of species in the closest site to the FPO, <code class="reqn">\zeta_2</code> is the number of species shared by the 2 closest sites, etc.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_dir">DIR</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if zeta diversity must be computed using a directed nearest neighbour scheme in the direction away from the FPO, starting from any site.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity, and computation errors for the normalized version of zeta due to divisions by 0. Options are &quot;<code>empty</code>&quot; to let the data untreated, &quot;<code>remove</code>&quot; to remove the empty rows, 0 to set the normalized zeta to 0 when zeta is divided by 0 during normalization (sites share no species, so are completely dissimilar), and 1 to set the normalized zeta to 1 when zeta is divided by 0 during normalization (i.e. sites are perfectly similar).</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
<tr><td><code id="Zeta.decline.mc_+3A_silent">silent</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if messages must be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of combinations of sites is lower than the value of the parameter <code>sam</code>, all the combinations are used and an exact solution is computed. In that case, using the number of site combinations as the denominator may be appropriate to compute the standard deviation, if all sites were sampled and the zeta values. This can be adjusted with parameters <code>sd.correct</code> and <code>sd.correct.adapt</code>.
</p>
<p><code>Zeta.decline.mc</code> is faster than <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code> to compute the exact value of zeta diversity when the number of species is higher than <code class="reqn">C^N_{i}</code>, where <em>N</em> is the total number of sites and <em>i</em> is the order of zeta.
</p>
<p>The exponential and the power law fit are performed using linear regressions on log-transformed data (only the zeta values are log-transformed for the exponential fit, and both the orders and the zeta values are log-transformed for the power law fit).
</p>
<p><code>Zeta.decline.mc</code> enables accomodating richness heterogeneity by setting <code>normalize = "Jaccard"</code>, <code>normalize = "Sorensen"</code> or <code>normalize = "Simpson"</code>. This cannot be performed by <br /> <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>.
</p>


<h3>Value</h3>

<p><code>Zeta.decline.mc</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>zeta.order</code></td>
<td>
<p>The number of assemblages or sites for which the zeta diversity was computed.</p>
</td></tr>
<tr><td><code>combinations</code></td>
<td>
<p>The number of possible combinations of sites for the chosen orders.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>The zeta diversity values.</p>
</td></tr>
<tr><td><code>zeta.val.sd</code></td>
<td>
<p>The zeta diversity standard deviation values.</p>
</td></tr>
<tr><td><code>zeta.ratio</code></td>
<td>
<p>The ratio of zeta diversity values by the zeta diversity values at the lower order <code class="reqn">\zeta_i / \zeta_{i-1}</code>.</p>
</td></tr>
<tr><td><code>zeta.exp</code></td>
<td>
<p>Object of class &quot;<code>lm</code>&quot;, containing the output of the exponential regression.</p>
</td></tr>
<tr><td><code>zeta.exp.confint</code></td>
<td>
<p>The confidence intervals of the coefficients of the exponential regression.</p>
</td></tr>
<tr><td><code>zeta.pl</code></td>
<td>
<p>Object of class &quot;<code>lm</code>&quot;, containing the output of the power law regression.</p>
</td></tr>
<tr><td><code>zeta.pl.confint</code></td>
<td>
<p>The confidence intervals of the coefficients of the power law regression.</p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p>AIC values for <code>zeta.exp</code> and <code>zeta.pl</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Plot.zeta.decline">Plot.zeta.decline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

dev.new(width = 12, height = 4)
zeta.bird &lt;- Zeta.decline.mc(data.spec.bird, xy.bird, orders = 1:5, sam = 100,
   NON = TRUE)
zeta.bird

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new(width = 12, height = 4)
zeta.marion &lt;- Zeta.decline.mc(data.spec.marion, orders = 1:5, sam = 100,
     normalize = "Jaccard")
zeta.marion

</code></pre>

<hr>
<h2 id='Zeta.msgdm'>Multi-site generalised dissimilarity modelling for a set of environmental variables and distances</h2><span id='topic+Zeta.msgdm'></span>

<h3>Description</h3>

<p>Computes a regression model of zeta diversity for a given order (number of assemblages or sites) against a set of environmental variables and distances between sites. The different regression models available are generalised linear models, generalised linear models with negative constraints, generalised additive models, shape constrained additive models, and I-splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.msgdm(
  data.spec,
  data.env,
  xy = NULL,
  data.spec.pred = NULL,
  order = 1,
  sam = 1000,
  reg.type = "glm",
  family = stats::gaussian(),
  method.glm = "glm.fit.cons",
  cons = -1,
  cons.inter = 1,
  confint.level = 0.95,
  bs = "mpd",
  kn = -1,
  order.ispline = 2,
  kn.ispline = 1,
  distance.type = "Euclidean",
  dist.custom = NULL,
  rescale = FALSE,
  rescale.pred = TRUE,
  method = "mean",
  normalize = FALSE,
  silent = FALSE,
  empty.row = 0,
  control = list(),
  glm.init = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.msgdm_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_data.env">data.env</code></td>
<td>
<p>Site-by-variable data frame, with sites as rows and environmental variables as columns.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_xy">xy</code></td>
<td>
<p>Site coordinates, to account for distances between sites.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_data.spec.pred">data.spec.pred</code></td>
<td>
<p>Site-by-species presence-absence data frame or list of data frames, with sites as rows and species as columns, for which zeta diversity will be computed and used as a predictor of the zeta diversity of <code>data.spec</code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_reg.type">reg.type</code></td>
<td>
<p>Type of regression used in the multi-site generalised dissimilarity modelling. Options are &quot;<code>glm</code>&quot; for generalised linear models, &quot;<code>ngls</code>&quot; for negative linear models, &quot;<code>gam</code>&quot; for generalised additive models, &quot;<code>scam</code>&quot; for shape constrained additive models (with monotonic decreasing by default), and &quot;<code>ispline</code>&quot; for I-spline models (forcing monotonic decline), as recommended in generalised dissimilarity modelling by Ferrier <em>et al</em>. (2007).</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the <code>glm</code>, <code>gam</code> and <code>scam</code> models (see <code><a href="stats.html#topic+family">family</a></code> for details of family functions).</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_method.glm">method.glm</code></td>
<td>
<p>Method used in fitting the generalised linear model. The default method <br /> &quot;glm.fit.cons&quot; is an adaptation of method <code>glm.fit2</code> from package <code>glm2</code> using a constrained least squares regression (default is negative coefficients) in the reweighted least squares. Another option is &quot;glm.fit2&quot;, which calls <code>glm.fit2</code>; see help documentation for glm.fit2 in package <code>glm2</code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_cons">cons</code></td>
<td>
<p>type of constraint in the glm if <code>method.glm = "glm.fit.cons"</code>. Default is -1 for negative coefficients on the predictors. The other option is 1 for positive coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_confint.level">confint.level</code></td>
<td>
<p>Percentage for the confidence intervals of the coefficients from the generalised linear models.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_bs">bs</code></td>
<td>
<p>A two-letter character string indicating the (penalized) smoothing basis to use in the scam model. Default is &quot;<code>mpd</code>&quot; for monotonic decreasing splines. see <code><a href="mgcv.html#topic+smooth.terms">smooth.terms</a></code> for an overview of what is available.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_kn">kn</code></td>
<td>
<p>Number of knots in the GAM and SCAM. Default is -1 for determining kn automatically using Generalized Cross-validation.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_order.ispline">order.ispline</code></td>
<td>
<p>Order of the I-spline.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_kn.ispline">kn.ispline</code></td>
<td>
<p>Number of knots in the I-spline.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_distance.type">distance.type</code></td>
<td>
<p>Method to compute distance. Default is &quot;<code>Euclidean</code>&quot;, for Euclidean distance. The other options are (i) &quot;<code>ortho</code>&quot; for orthodromic distance, if xy correspond to longitudes and latitudes (orthodromic distance is computed using the <code>geodist</code> function from package <code>geodist</code>); and (ii) &quot;<code>custom</code>&quot;, in which case the user must provide a distance matrix for <code>dist.custom</code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_dist.custom">dist.custom</code></td>
<td>
<p>Distance matrix provided by the user when <code>distance.type</code> = <code>"custom"</code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by the total number of species in the dataset, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_rescale.pred">rescale.pred</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the spatial distances and differences in environmental variables should be rescaled between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the pairwise differences and distances for more than 3 sites. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_silent">silent</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if warnings must be printed.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity, and computation errors for the normalized version of zeta due to divisions by 0. Options are &quot;<code>empty</code>&quot; to let the data untreated, &quot;<code>remove</code>&quot; to remove the empty rows, 0 to set the normalized zeta to 0 when zeta is divided by 0 during normalization (sites share no species, so are completely dissimilar), and 1 to set the normalized zeta to 1 when zeta is divided by 0 during normalization (i.e. sites are perfectly similar).</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_control">control</code></td>
<td>
<p>As for <code><a href="stats.html#topic+glm">glm</a></code>.</p>
</td></tr>
<tr><td><code id="Zeta.msgdm_+3A_glm.init">glm.init</code></td>
<td>
<p>Boolean value, indicating if the initial parameters for fitting the glm with constraint on the coefficients signs for <code>reg.type == "ispline"</code> should be initialised based on the correlation coefficients betwen the zeta values and the environmental difference or distance. <code>glm.init = TRUE</code> helps preventing the error message: <code>error: cannot find valid starting values:</code> <br /> <code>please specify some</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The environmental variables can be numeric or factorial.
</p>
<p>If <code>order = 1</code>, the variables are used as such in the regression, and factorial variables must be dummy for the output of the regression to be interpretable.
</p>
<p>For numeric variables, if <code>order&gt;1</code> the pairwise difference between sites is computed and combined according to <code>method</code>. For factorial variables, the distance corresponds to the number of unique values over the number of assemblages of sites specified by <code>order</code>.
</p>
<p>If <code>xy = NULL</code>, <code>Zeta.msgdm</code> only uses environmental variables in the regression. Otherwise, it also computes and uses euclidian distance (average or maximum distance between multiple sites, depending on the parameters <code>method</code>) as an explanatory variable.
</p>
<p>If <code>rescale.pred = TRUE</code>, zeta is regressed against the differences of values of the environmental variables divided by the maximum difference for each variable, to be rescaled between 0 and 1. If <code>!is.null(xy)</code>, distances between sites are also divided by the maximum distance. If <code>order = 1</code>, the variables are transformed by first subtracting their minimum value, and dividing by the difference of their maximum and minimum values.
</p>
<p>If <code>reg.type = "ispline"</code>, the variables are rescaled between 0 and 1 prior to computing the I-splines by subtracting their minimum value, and dividing by the difference of their maximum and minimum values.
</p>


<h3>Value</h3>

<p><code>Zeta.msgdm</code> returns a list whose component vary depending on the regression technique. The list can contain the following components:
</p>
<table role = "presentation">
<tr><td><code>val</code></td>
<td>
<p>Vector of zeta values used in the MS-GDM.</p>
</td></tr>
<tr><td><code>predictors</code></td>
<td>
<p>Data frame of the predictors used in the MS-GDM.</p>
</td></tr>
<tr><td><code>range.min</code></td>
<td>
<p>Vector containing the minimum values of the numeric variables, used for rescaling the variables between 0 and 1 for I-splines (see Details).</p>
</td></tr>
<tr><td><code>range.max</code></td>
<td>
<p>Vector containing the maximum values of the numeric variables, used for rescaling the variables between 0 and 1 for I-splines (see Details).</p>
</td></tr>
<tr><td><code>rescale.factor</code></td>
<td>
<p>Factor by which the predictors were divided if <code>rescale.pred = TRUE</code> and <code>order&gt;1</code>.</p>
</td></tr>
<tr><td><code>order.ispline</code></td>
<td>
<p>The value of the original parameter, to be used in <code>Plot.ispline</code>.</p>
</td></tr>
<tr><td><code>kn.ispline</code></td>
<td>
<p>The value of the original parameter, to be used in <code>Plot.ispline</code>.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>An object whose class depends on the type of regression (<code>glm</code>, <code>nnnpls</code>, <code>gam</code> or <code>scam</code>; I-splines return and object of class <code>glm</code>), corresponding to the regression over distance for the number of assemblages or sites specified in <code>order</code>.</p>
</td></tr>
<tr><td><code>confint</code></td>
<td>
<p>The confidence intervals for the coefficients from generalised linear models with no constraint. <code>confint</code> is not generated for the other types of regression.</p>
</td></tr>
<tr><td><code>vif</code></td>
<td>
<p>The variance inflation factors for all the variables for the generalised linear regression. <code>vif</code> is not generated for the other types of regression.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Ferrier, S., Manion, G., Elith, J., &amp; Richardson, K. (2007). Using generalized dissimilarity modelling to analyse and predict patterns of beta diversity in regional biodiversity assessment. <em>Diversity and Distributions</em>, 13(3), 252-264.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Predict.msgdm">Predict.msgdm</a></code>,
</p>
<p><code><a href="#topic+Ispline">Ispline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[1:2]
data.spec.bird &lt;- bird.spec.coarse[3:193]
utils::data(bird.env.coarse)
data.env.bird &lt;- bird.env.coarse[,3:9]

zeta.glm &lt;- Zeta.msgdm(data.spec.bird, data.env.bird, sam = 100, order = 3)
zeta.glm
dev.new()
graphics::plot(zeta.glm$model)

zeta.ngls &lt;- Zeta.msgdm(data.spec.bird, data.env.bird, xy.bird, sam = 100, order = 3,
    reg.type = "ngls", rescale = TRUE)
zeta.ngls

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]
data.spec.marion &lt;- Marion.species[3:33]
utils::data(Marion.env)
data.env.marion &lt;- Marion.env[3]

zeta.gam &lt;- Zeta.msgdm(data.spec.marion, data.env.marion, sam = 100, order = 3,
    reg.type = "gam")
zeta.gam
dev.new()
graphics::plot(zeta.gam$model)

zeta.ispline &lt;- Zeta.msgdm(data.spec.marion, data.env.marion, xy.marion, sam = 100,
    order = 3, normalize = "Jaccard", reg.type = "ispline")
zeta.ispline

zeta.ispline.r &lt;- Return.ispline(zeta.ispline, data.env.marion, distance = TRUE)
zeta.ispline.r

dev.new()
Plot.ispline(isplines = zeta.ispline.r, distance = TRUE)

dev.new()
Plot.ispline(msgdm = zeta.ispline, data.env = data.env.marion, distance = TRUE)

</code></pre>

<hr>
<h2 id='Zeta.order.ex'>Expectation of zeta diversity for a specific number of assemblages or sites</h2><span id='topic+Zeta.order.ex'></span>

<h3>Description</h3>

<p>Computes the expectation of zeta diversity, the number of species shared by multiple assemblages, for a specific order (number of assemblages or sites) using a formula based on the occupancy of the species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.order.ex(
  data.spec,
  order = 1,
  sd.correct = TRUE,
  rescale = FALSE,
  empty.row = "empty"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.order.ex_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.order.ex_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.order.ex_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.order.ex_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.order.ex_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity. Options are  &quot;empty&quot; to let the data untreated or &quot;remove&quot; to remove the empty rows.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Zeta.order.ex</code> is much faster than <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code> to compute the exact value of zeta diversity when the number of species is lower than <code class="reqn">C^N_{i}</code>, where <em>N</em> is the total number of sites and <em>i</em> is the order of zeta.
</p>
<p><code>sd.correct</code> should be set to <code>TRUE</code> if the assemblages represent a subsample of the whole system. It can be set to <code>FALSE</code> if the sampling is exhaustive, for example in case of a continuous regular grid covering the whole study area.
</p>


<h3>Value</h3>

<p><code>zeta.order.ex</code>  returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>zeta.order</code></td>
<td>
<p>The number of assemblages or sites for which the zeta diversity was computed.</p>
</td></tr>
<tr><td><code>combinations</code></td>
<td>
<p>The number of possible combinations of sites for the chosen order.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>The zeta diversity values.</p>
</td></tr>
<tr><td><code>zeta.val.sd</code></td>
<td>
<p>The standard deviation of zeta diversity.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>McGeoch M. A., Latombe G., Andrew N. R., Nakagawa S., Nipperess D. A., Roige M., Marzinelli E. M., Campbell A. H., Verges A., Thomas T., Steinberg P. D., Selwood K. E., Henriksen M. V. &amp; Hui C. (2019). Measuring continuous compositional change using decline and decay in zeta diversity. <em>Ecology</em>, 100(11), e02832.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(bird.spec.coarse)
data.spec.bird &lt;- bird.spec.coarse[,3:193]

zeta.bird &lt;- Zeta.order.ex(data.spec.bird, order = 3)
zeta.bird

##########
s
utils::data(Marion.species)
data.spec.marion &lt;- Marion.species[,3:33]

zeta.marion &lt;- Zeta.order.ex(data.spec.marion, order = 3)
zeta.marion

</code></pre>

<hr>
<h2 id='Zeta.order.mc'>Zeta diversity for a specific number of assemblages or sites using Monte Carlo sampling</h2><span id='topic+Zeta.order.mc'></span>

<h3>Description</h3>

<p>Computes zeta diversity, the number of species shared by multiple assemblages, for a specific order (number of assemblages or sites).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.order.mc(
  data.spec,
  xy = NULL,
  order = 1,
  sam = 1000,
  sd.correct = TRUE,
  sd.correct.adapt = FALSE,
  rescale = FALSE,
  normalize = FALSE,
  NON = FALSE,
  FPO = NULL,
  DIR = FALSE,
  empty.row = "empty",
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.order.mc_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_xy">xy</code></td>
<td>
<p>Site coordinates. This is only used if <code>NON</code> = TRUE or <code>DIR</code> = TRUE.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_sd.correct.adapt">sd.correct.adapt</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) if <code>sam</code> is higher than the number of possible combinations, or not (using the number of site combinations as the denominator) if <code>sam</code> is lower than the number of possible combinations. If <code>sd.correct.adapt == TRUE</code>, it takes precedence over <code>sd.correct</code>.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_non">NON</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the number of species in common should only be counted for the nearest neighbours.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_fpo">FPO</code></td>
<td>
<p>A vector with the coordinates of the fixed point origin from which the zeta diversity will be computed (overrides NON). In that case, <code class="reqn">\zeta_1</code> is the number of species in the closest site to the FPO, <code class="reqn">\zeta_2</code> is the number of species shared by the 2 closest sites, etc.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_dir">DIR</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if zeta diversity must be computed using a directed nearest neighbour scheme in the direction away from the FPO, starting from any site.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity, and computation errors for the normalized version of zeta due to divisions by 0. Options are &quot;<code>empty</code>&quot; to let the data untreated, &quot;<code>remove</code>&quot; to remove the empty rows, 0 to set the normalized zeta to 0 when zeta is divided by 0 during normalization (sites share no species, so are completely dissimilar), and 1 to set the normalized zeta to 1 when zeta is divided by 0 during normalization (i.e. sites are perfectly similar).</p>
</td></tr>
<tr><td><code id="Zeta.order.mc_+3A_silent">silent</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if messages must be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number of combinations of sites is lower than the value of the parameter <code>sam</code>, all the combinations are used and an exact solution is computed. In that case, using the number of site combinations as the denominator may be appropriate to compute the standard deviation, if all sites were sampled and the zeta values. This can be adjusted with parameters <code>sd.correct</code> and <code>sd.correct.adapt</code>.
</p>
<p><code>Zeta.order.mc</code> is faster than <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code> to compute the exact value of zeta diversity when the number of species is higher than <code class="reqn">C^N_{i}</code>, where <em>N</em> is the total number of sites and <em>i</em> is the order of zeta.
</p>
<p><code>Zeta.order.mc</code> enables accomodating richness heterogeneity by setting <code>normalize = "Jaccard"</code>, <code>normalize = "Sorensen"</code> or <code>normalize = "Simpson"</code>. This cannot be performed by <br /> <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>.
</p>


<h3>Value</h3>

<p><code>Zeta.order.mc</code>  returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>zeta.order</code></td>
<td>
<p>The number of assemblages or sites for which the zeta diversity was computed.</p>
</td></tr>
<tr><td><code>combinations</code></td>
<td>
<p>The number of possible combinations of sites for the chosen order.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>The zeta diversity values.</p>
</td></tr>
<tr><td><code>zeta.val.sd</code></td>
<td>
<p>The standard deviation of zeta diversity.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]

zeta.bird &lt;- Zeta.order.mc(data.spec.bird, order = 3, sam=100)
zeta.bird

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

zeta.marion &lt;- Zeta.order.mc(data.spec.marion, xy.marion, order = 3, sam = 100,
   NON = TRUE)
zeta.marion

</code></pre>

<hr>
<h2 id='Zeta.order.mc.mult'>Number of species in common between a specific number of assemblages or sites using Monte Carlo sampling, for multiple combinations and several groups of taxa</h2><span id='topic+Zeta.order.mc.mult'></span>

<h3>Description</h3>

<p>Computes the number of species shared by multiple assemblages, for a specific order (number of assemblages or sites), for multiple combinations and several groups of taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.order.mc.mult(
  data.spec,
  xy = NULL,
  order = 1,
  sam = 1000,
  sd.correct = TRUE,
  sd.correct.adapt = FALSE,
  rescale = FALSE,
  normalize = FALSE,
  NON = FALSE,
  FPO = NULL,
  DIR = FALSE,
  empty.row = "empty",
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.order.mc.mult_+3A_data.spec">data.spec</code></td>
<td>
<p>A list of site-by-species presence-absence data frames, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_xy">xy</code></td>
<td>
<p>Site coordinates. This is only used if <code>NON</code> = TRUE or <code>DIR</code> = TRUE.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_sd.correct.adapt">sd.correct.adapt</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) if <code>sam</code> is higher than the number of possible combinations, or not (using the number of site combinations as the denominator) if <code>sam</code> is lower than the number of possible combinations. If <code>sd.correct.adapt == TRUE</code>, it takes precedence over <code>sd.correct</code>.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_non">NON</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the number of species in common should only be counted for the nearest neighbours.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_fpo">FPO</code></td>
<td>
<p>A vector with the coordinates of the fixed point origin from which the zeta diversity will be computed (overrides NON). In that case, <code class="reqn">\zeta_1</code> is the number of species in the closest site to the FPO, <code class="reqn">\zeta_2</code> is the number of species shared by the 2 closest sites, etc.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_dir">DIR</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if zeta diversity must be computed using a directed nearest neighbour scheme in the direction away from the FPO, starting from any site.</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_empty.row">empty.row</code></td>
<td>
<p>Determines how to handle empty rows, i.e. sites with no species. Such sites can cause underestimations of zeta diversity, and computation errors for the normalized version of zeta due to divisions by 0. Options are &quot;<code>empty</code>&quot; to let the data untreated, &quot;<code>remove</code>&quot; to remove the empty rows, 0 to set the normalized zeta to 0 when zeta is divided by 0 during normalization (sites share no species, so are completely dissimilar), and 1 to set the normalized zeta to 1 when zeta is divided by 0 during normalization (i.e. sites are perfectly similar).</p>
</td></tr>
<tr><td><code id="Zeta.order.mc.mult_+3A_silent">silent</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if messages must be printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Contrary to <code>Zeta.order.mc</code>, the number of species shared by the different combinations of assemblages are not averaged, but returned as is. This is useful to then compare local zeta diversity for different groups of taxa.
</p>
<p>As for <code>Zeta.order.mc</code>, if the number of combinations of sites is lower than the value of the parameter <code>sam</code>, all the combinations are used and an exact solution is computed. In that case, using the number of site combinations as the denominator may be appropriate to compute the standard deviation, if all sites were sampled and the zeta values. This can be adjusted with parameters <code>sd.correct</code> and <code>sd.correct.adapt</code>.
</p>


<h3>Value</h3>

<p><code>Zeta.order.mc.mult</code>  returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>zeta.order</code></td>
<td>
<p>The number of assemblages or sites for which the zeta diversity was computed.</p>
</td></tr>
</table>
<p>#' @return </p>
<table role = "presentation">
<tr><td><code>sites</code></td>
<td>
<p>A matrix in which each row contains the indices of a given combination, i.e. of the specific  <code>sam</code> assemblages.</p>
</td></tr>
<tr><td><code>zeta.val</code></td>
<td>
<p>A data frame in which each column is the number of species shared by the assemblages.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]

data.spec.marion &lt;- Marion.species[3:33]

##random other communities
data.spec.marion2a &lt;- data.spec.marion
data.spec.marion2a[which(data.spec.marion2a==1,arr.ind=TRUE)] &lt;- 0
for(i in 1:ncol(data.spec.marion2a))
  data.spec.marion2a[sample(nrow(data.spec.marion2a),8),i] &lt;- 1
data.spec.marion2b &lt;- data.spec.marion
data.spec.marion2b[which(data.spec.marion2b==1,arr.ind=TRUE)] &lt;- 0
for(i in 1:ncol(data.spec.marion2b))
data.spec.marion2b[sample(nrow(data.spec.marion2b),8),i] &lt;- 1

dat.spec.tot &lt;- list(data.spec.marion,data.spec.marion2a,data.spec.marion2b)
zeta.tot &lt;- Zeta.order.mc.mult(data.spec=dat.spec.tot,order=3,sam=200)

</code></pre>

<hr>
<h2 id='Zeta.sam.sensitivity'>Sensitivity analysis for the sample size of zeta</h2><span id='topic+Zeta.sam.sensitivity'></span>

<h3>Description</h3>

<p>Computes zeta diversity for a given order (number of assemblages or sites) for a range of sample sizes, to assess the sensitivity to this parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.sam.sensitivity(
  data.spec,
  xy = NULL,
  order = 1,
  sam.seq,
  reps = 20,
  sd.correct = TRUE,
  sd.correct.adapt = FALSE,
  rescale = FALSE,
  normalize = FALSE,
  NON = FALSE,
  FPO = NULL,
  DIR = FALSE,
  display = TRUE,
  plot = TRUE,
  notch = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.sam.sensitivity_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_xy">xy</code></td>
<td>
<p>Site coordinates. This is only used if <code>NON</code> = TRUE or <code>DIR</code> = TRUE.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_sam.seq">sam.seq</code></td>
<td>
<p>Sequence of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_reps">reps</code></td>
<td>
<p>Number of replicates of zeta diversity computations for each sample size.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_sd.correct">sd.correct</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) or not (using the number of site combinations as the denominator).</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_sd.correct.adapt">sd.correct.adapt</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be computed with an unbiased estimator (using the number of site combinations - 1 as the denominator) if <code>sam</code> is higher than the number of possible combinations, or not (using the number of site combinations as the denominator) if <code>sam</code> is lower than the number of possible combinations. If <code>sd.correct.adapt == TRUE</code>, it takes precedence over <code>sd.correct</code>.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_non">NON</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the number of species in common should only be counted for the nearest neighbours.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_fpo">FPO</code></td>
<td>
<p>A vector with the coordinates of the fixed point origin from which the zeta diversity will be computed (overrides NON). In that case, <code class="reqn">\zeta_1</code> is the number of species in the closest site to the FPO, <code class="reqn">\zeta_2</code> is the number of species shared by the 2 closest sites, etc.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_dir">DIR</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if zeta diversity must be computed using a directed nearest neighbour scheme in the direction away from the FPO, starting from any site.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_display">display</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the current value of the sample size must be displayed. Acts as a counter.</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted as a boxplot of the zeta diversity distributions for each sample size</p>
</td></tr>
<tr><td><code id="Zeta.sam.sensitivity_+3A_notch">notch</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the notches must be plotted in the boxplot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the execution of <code>Zeta.sam.sensitivity</code> can be quite lengthy, because of the number of replicates needed.
</p>


<h3>Value</h3>

<p><code>Zeta.sam.sensitivity</code> returns a matrix with <code>(sam.max-sam.min)/sam.incr</code> columns and <code>reps</code> rows.
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Note that the sensitivity analyses in the following two examples are quite long to run,
#typically around 10 minutes for the first example and 1-2 minutes for the second.

utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[1:2]
data.spec.bird &lt;- bird.spec.coarse[3:193]

dev.new()
zeta.sens.bird &lt;- Zeta.sam.sensitivity(data.spec.bird, order = 3,
    sam.seq = seq(250,1000,250), reps = 20, display = TRUE, plot = TRUE, notch = TRUE)
zeta.sens.bird

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[1:2]
data.spec.marion &lt;- Marion.species[3:33]

dev.new()
zeta.sens.marion &lt;- Zeta.sam.sensitivity(data.spec.marion, order = 3,
    sam.seq = seq(50,250,50), reps = 20, plot = TRUE, notch = TRUE)
zeta.sens.marion


</code></pre>

<hr>
<h2 id='Zeta.scale.min.dist'>Zeta diversity scaling with sample grain dependency based on the minimum distance between sites</h2><span id='topic+Zeta.scale.min.dist'></span>

<h3>Description</h3>

<p>Computes zeta diversity scaling with sample grain for a specific order (number of assemblages or sites), increasing grain by sequentially adding sites based on the minimum distance between them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.scale.min.dist(
  xy,
  data.spec,
  m,
  order = 1,
  reorder = 100,
  shuffle = TRUE,
  sam = 1000,
  method = "mean",
  rescale = FALSE,
  normalize = FALSE,
  plot = TRUE,
  sd = TRUE,
  distance.type = "Euclidean",
  dist.custom = NULL,
  zeta.type = "exact"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.scale.min.dist_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_m">m</code></td>
<td>
<p>Vector of mapping grains: <code>m[i]</code> sites are grouped together to generate data at a coarser grain.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_reorder">reorder</code></td>
<td>
<p>Number of times the sites are rearranged and grouped together for the computation of zeta (see Details).</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_shuffle">shuffle</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the order of the sites must be randomised, which can have an impact on the outputs if some distances are equal.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the coordinates. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_sd">sd</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the standard deviation must be plotted for each grain.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_distance.type">distance.type</code></td>
<td>
<p>Method to compute distance. Default is &quot;<code>Euclidean</code>&quot;, for Euclidean distance. The other options are (i) &quot;<code>ortho</code>&quot; for orthodromic distance, if xy correspond to longitudes and latitudes (orthodromic distance is computed using the <code>geodist</code> function from package <code>geodist</code>); and (ii) &quot;<code>custom</code>&quot;, in which case the user must provide a distance matrix for <code>dist.custom</code>.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_dist.custom">dist.custom</code></td>
<td>
<p>Distance matrix provided by the user when <code>distance.type</code> = <code>"custom"</code>.</p>
</td></tr>
<tr><td><code id="Zeta.scale.min.dist_+3A_zeta.type">zeta.type</code></td>
<td>
<p>The function that must be used for the computation of zeta diversity. Default is &quot;<code>exact</code>&quot; for calling <code>Zeta.order.ex</code>. Use &quot;<code>monte carlo</code>&quot; for calling <code>Zeta.order.mc</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The nearest neighbouring sites (plots, quadrates, or areas of varying shapes) are grouped as spatial clusters of 2, 3, 4, etc. sites, based on the minimum distance between them. Since the procedure is based on the relative distance between sites, the site order can have an impact on the output. The procedure is therefore performed 'reorder' times, for which sites are randomly reordered each time, and the mean zeta is computed. This function is suitable for both regularly and irregularly spaced sites, contiguous or non contiguous (<em>sensu</em> Scheiner et al., 2011). For regularly spaced sites, the use of <code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code> is recommended.
</p>


<h3>Value</h3>

<p><code>zeta.scale.min.dist</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>order</code></td>
<td>
<p>The order of zeta.</p>
</td></tr>
<tr><td><code>m</code></td>
<td>
<p>The vector of mapping grains: m[i] sites are grouped together to generate data at a coarser grain.</p>
</td></tr>
<tr><td><code>values</code></td>
<td>
<p>A matrix containing the zeta diversity values over the '<code>reorder</code>' computations, for each grain.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>A matrix containing the standard deviation of zeta diversity over the '<code>reorder</code>' computations, for each grain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>,
</p>
<p><code><a href="#topic+Zeta.scale.regular">Zeta.scale.regular</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]

dev.new()
zeta.scale.irreg.species &lt;- Zeta.scale.min.dist(xy.marion, data.spec.marion, m = 1:3,
    order = 3, reorder = 3, sam = 50, normalize = "Jaccard")

</code></pre>

<hr>
<h2 id='Zeta.scale.regular'>Zeta diversity scaling with sample grain using hierarchical increases in grain size</h2><span id='topic+Zeta.scale.regular'></span>

<h3>Description</h3>

<p>Computes zeta diversity scaling with sample grain for a specific order (number of assemblages or sites), increasing grain by hierarchically nesting of regularly spaced sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.scale.regular(
  xy,
  data.spec,
  n,
  order = 1,
  sam = 1000,
  method = "mean",
  rescale = FALSE,
  normalize = FALSE,
  plot = TRUE,
  zeta.type = "exact"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.scale.regular_+3A_xy">xy</code></td>
<td>
<p>Site-by-coordinate data frame, with sites as rows and coordinates as columns.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_data.spec">data.spec</code></td>
<td>
<p>Site-by-species presence-absence data frame, with sites as rows and species as columns.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_n">n</code></td>
<td>
<p>Vector of mapping grains: regularly spaced sites are grouped as <code>n[i]</code> x <code>n[i]</code> sites to generate data at a coarser grain.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_order">order</code></td>
<td>
<p>Specific number of assemblages or sites at which zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_sam">sam</code></td>
<td>
<p>Number of samples for which the zeta diversity is computed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_method">method</code></td>
<td>
<p>Name of a function (as a string) indicating how to combine the coordinates. It can be a basic R-function such as &quot;<code>mean</code>&quot; or &quot;<code>max</code>&quot;, but also a custom function.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_rescale">rescale</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the zeta values should be divided by <code class="reqn">\zeta_1</code>, to get a range of values between 0 and 1. Has no effect if <code>normalize</code> != <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_normalize">normalize</code></td>
<td>
<p>Indicates if the zeta values for each sample should be divided by the total number of species for this specific sample (<code>normalize = "Jaccard"</code>), by the average number of species per site for this specific sample (<code>normalize = "Sorensen"</code>), or by the minimum number of species in the sites of this specific sample <br /> (<code>normalize = "Simpson"</code>). Default value is <code>FALSE</code>, indicating that no normalization is performed.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_plot">plot</code></td>
<td>
<p>Boolean value (TRUE or FALSE) indicating if the outputs must be plotted.</p>
</td></tr>
<tr><td><code id="Zeta.scale.regular_+3A_zeta.type">zeta.type</code></td>
<td>
<p>The function that must be used for the computation of zeta diversity. Default is &quot;<code>exact</code>&quot; for calling <code>Zeta.order.ex</code>. Use &quot;<code>monte carlo</code>&quot; for calling <code>Zeta.order.mc</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sites (plots or quadrates) are incrementally aggregated as nearest neighbouring groups of 4, 9, etc. sites, using a nested approach, starting from the lowest x and y, to increase the grain. The sites can be spatially contiguous or discontiguous, as long as they are regularly spaced (see Scheiner et al., 2011). If the total number of sites is not a multiple of <code>n[i]</code> x <code>n[i]</code>, the extra sites are discarded.
</p>


<h3>Value</h3>

<p><code>Zeta.scale.regular</code> returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>order</code></td>
<td>
<p>The order of zeta.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The vector of mapping grains: regularly spaced sites are grouped as <code>n[i]</code> x <code>n[i]</code> sites to generate data at a coarser grain.</p>
</td></tr>
<tr><td><code>values</code></td>
<td>
<p>The zeta diversity values for each grain.</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>The standard deviation of zeta diversity for each grain.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Scheiner S.M., Chiarucci A., Fox G.A., Helmus M.R., McGlinn D.J. &amp; Willig M.R. (2011). The underpinnings of the relationship of species richness with space and time. <em>Ecological Monographs</em>, 81, 195-213.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>
</p>
<p><code><a href="#topic+Zeta.scale.min.dist">Zeta.scale.min.dist</a></code>, <code><a href="#topic+rescale.regular">rescale.regular</a></code>, <code><a href="#topic+rescale.min.dist">rescale.min.dist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.fine)
xy.bird &lt;- bird.spec.fine[1:400,1:2]
data.spec.bird &lt;- bird.spec.fine[1:400,3:192]

dev.new()
##sam = 25 is used here for fast execution, but a higher value is advised
zeta.scale.reg &lt;- Zeta.scale.regular(xy.bird, data.spec.bird, n = 1:3, order = 3,
    sam = 25, normalize = "Jaccard", zeta.type="monte carlo")
</code></pre>

<hr>
<h2 id='Zeta.varpart'>Variation partitioning for zeta diversity</h2><span id='topic+Zeta.varpart'></span>

<h3>Description</h3>

<p>Variation partitioning of zeta diversity for a specific order (number of assemblages or sites) over distance and environmental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Zeta.varpart(
  msgdm.mod,
  num.part = 2,
  reg.type = "glm",
  family = stats::gaussian(),
  method.glm = "glm.fit.cons",
  cons = -1,
  cons.inter = 1,
  kn = -1,
  bs = "mpd"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Zeta.varpart_+3A_msgdm.mod">msgdm.mod</code></td>
<td>
<p>An object return by function <code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_num.part">num.part</code></td>
<td>
<p>Number of partitions of zeta diversity. Can be 2 or 3.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_reg.type">reg.type</code></td>
<td>
<p>Type of regression for the multi-site generalised dissimilarity modelling. Options are &quot;glm&quot; for generalised linear models, &quot;ngls&quot; for negative linear models, &quot;gam&quot; for generalised additive models, &quot;scam&quot; for shape constrained additive models, and &quot;ispline&quot; for I-spline models, as recommended in generalised dissimilarity modelling by Ferrier <em>et al</em>. (2007).</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the <code>glm</code>, <code>gam</code> and <code>scam</code> models (see <code><a href="stats.html#topic+family">family</a></code> for details of family functions).</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_method.glm">method.glm</code></td>
<td>
<p>Method used in fitting the generalised linear model. The default method <br /> &quot;glm.fit.cons&quot; is an adaptation of method <code>glm.fit2</code> from package <code>glm2</code> using a negative least squares regression in the reweighted least squares. Another option is &quot;glm.fit2&quot;, which corresponds to method <code>glm.fit2</code>; see help documentation for <code>glm.fit2</code> in package <code>glm</code>.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_cons">cons</code></td>
<td>
<p>type of constraint in the glm if <code>method.glm = "glm.fit.cons"</code>. Default is -1 for negative coefficients on the predictors. The other option is 1 for positive coefficients on the predictors.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_cons.inter">cons.inter</code></td>
<td>
<p>type of constraint for the intercept. Default is 1 for positive intercept, suitable for Gaussian family. The other option is -1 for negative intercept, suitable for binomial family.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_kn">kn</code></td>
<td>
<p>Number of knots in the GAM and SCAM. Default is -1 for determining kn automatically using Generalized Cross-validation.</p>
</td></tr>
<tr><td><code id="Zeta.varpart_+3A_bs">bs</code></td>
<td>
<p>A two-letter character string indicating the (penalized) smoothing basis to use in the scam model. Default is &quot;<code>mpd</code>&quot; for monotonic decreasing splines. see <code><a href="mgcv.html#topic+smooth.terms">smooth.terms</a></code> for an overview of what is available.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that, for a given regression, the variation explained is computed as 1-(RSS/TSS)*(v-1)/(v-p-1), where RSS is the residual sum of squares and TSS is the total sum of squares, v is the number of variables used in the regression (which is greater than the original number of variables for I-splines) and p is the number of samples. 1-(RSS/TSS) corresponds to the classical R-squared for linear regression only, and results for non-linear regressions should be interpreted with caution.
</p>
<p>The environmental variables can be numeric or factorial, and <code>order</code> must be greater than 1.
</p>
<p>For numeric variables, the pairwise difference between sites is computed and combined according to <code>method</code>. For factorial variables, the distance corresponds to the number of unique values over the number of assemblages of sites specified by <code>order</code>.
</p>
<p>Zeta is regressed against the differences of values of the environmental variables divided by the maximum difference for each variable, to be rescaled between 0 and 1. If <code>!is.null(xy)</code>, distances between sites are also divided by the maximum distance.
</p>


<h3>Value</h3>

<p><code>Zeta.varpart</code> returns a data frame with one column containing the variation explained by each component <code>a</code> (the variation explained by distance alone), <code>b</code> (the variation explained by either distance or the environment), <code>c</code> (the variation explained by the environment alone) and <code>d</code> (the unexplained variation).
</p>


<h3>References</h3>

<p>Hui C. &amp; McGeoch M.A. (2014). Zeta diversity as a concept and metric that unifies incidence-based biodiversity patterns. <em>The American Naturalist</em>, 184, 684-694.
</p>
<p>Borcard, D., Legendre, P. &amp; Drapeau, P. (1992). Partialling out the spatial component of ecological variation. <em>Ecology</em> 73, 1045-1055.
</p>
<p>Legendre, P. &amp;  Legendre, L.F. (2012). <em>Numerical ecology</em>, 3rd English edition. Elsevier Science BV, Amsterdam.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Zeta.decline.mc">Zeta.decline.mc</a></code>, <code><a href="#topic+Zeta.order.mc">Zeta.order.mc</a></code>, <code><a href="#topic+Zeta.decline.ex">Zeta.decline.ex</a></code>, <code><a href="#topic+Zeta.order.ex">Zeta.order.ex</a></code>, <code><a href="#topic+Zeta.msgdm">Zeta.msgdm</a></code>, <code><a href="#topic+pie.neg">pie.neg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>utils::data(bird.spec.coarse)
xy.bird &lt;- bird.spec.coarse[,1:2]
data.spec.bird &lt;- bird.spec.coarse[,3:193]
utils::data(bird.env.coarse)
data.env.bird &lt;- bird.env.coarse[,3:9]

zeta.bird &lt;- Zeta.msgdm(data.spec.bird, data.env.bird, xy.bird, sam = 100, order = 3)
zeta.varpart.bird &lt;- Zeta.varpart(zeta.bird, method.glm = "glm.fit2")
zeta.varpart.bird
dev.new()
pie.neg(zeta.varpart.bird[4:7,1], density = c(4, 0, 8, -1),
    angle = c(90, 0, 0, 0),
    labels = c("distance", "undistinguishable", "environment", "unexplained"),
    radius = 0.9)

##########

utils::data(Marion.species)
xy.marion &lt;- Marion.species[,1:2]
data.spec.marion &lt;- Marion.species[,3:33]
utils::data(Marion.env)
data.env.marion &lt;- Marion.env[3:4]

zeta.marion &lt;- Zeta.msgdm(data.spec.marion, data.env.marion, xy.marion, sam = 100,
    order = 3, normalize = "Jaccard")
zeta.varpart.marion &lt;- Zeta.varpart(zeta.marion, method.glm = "glm.fit2")
zeta.varpart.marion
dev.new()
pie.neg(zeta.varpart.marion[4:7,1], density = c(4, 0, 8, -1),
    angle = c(90, 0, 0, 0),
    labels = c("distance", "undistinguishable", "environment", "unexplained"),
    radius = 0.9)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
