<!DOCTYPE html><html><head><title>Help for package teal.code</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {teal.code}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.check_joinable'><p>If two <code>qenv</code> can be joined</p></a></li>
<li><a href='#concat'><p>Concatenate two <code>qenv</code> objects</p></a></li>
<li><a href='#dev_suppress'><p>Suppresses plot display in the IDE by opening a PDF graphics device</p></a></li>
<li><a href='#get_env'><p>Access environment included in <code>qenv</code></p></a></li>
<li><a href='#get_var'><p>Get object from <code>qenv</code></p></a></li>
<li><a href='#get_warnings'><p>Get warnings from <code>qenv</code> object</p></a></li>
<li><a href='#join'><p>Join <code>qenv</code> objects</p></a></li>
<li><a href='#lang2calls'><p>Separate calls</p></a></li>
<li><a href='#qenv'><p>Code tracking with <code>qenv</code> object</p></a></li>
<li><a href='#qenv-class'><p>Reproducible class with environment and code</p></a></li>
<li><a href='#show,qenv-method'><p>Display <code>qenv</code> object</p></a></li>
<li><a href='#teal.code-package'><p><code>teal.code</code>: Code storage and execution class for teal applications</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Code Storage and Execution Class for 'teal' Applications</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-10</td>
</tr>
<tr>
<td>Description:</td>
<td>Introduction of 'qenv' S4 class, that facilitates code
    execution and reproducibility in 'teal' applications.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://insightsengineering.github.io/teal.code/">https://insightsengineering.github.io/teal.code/</a>,
<a href="https://github.com/insightsengineering/teal.code">https://github.com/insightsengineering/teal.code</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/insightsengineering/teal.code/issues">https://github.com/insightsengineering/teal.code/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 2.1.0), grDevices, lifecycle (&ge; 0.2.0), rlang
(&ge; 1.1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cli (&ge; 3.4.0), knitr (&ge; 1.42), magrittr (&ge; 1.5), rmarkdown
(&ge; 2.19), shiny (&ge; 1.6.0), testthat (&ge; 3.1.5)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Config/Needs/verdepcheck:</td>
<td>mllg/checkmate, r-lib/lifecycle, r-lib/rlang,
rstudio/shiny, r-lib/styler, r-lib/cli, yihui/knitr,
tidyverse/magrittr, rstudio/rmarkdown, r-lib/testthat</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>insightsengineering/nesttemplate</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'qenv-class.R' 'qenv-errors.R' 'qenv-concat.R'
'qenv-constructor.R' 'qenv-eval_code.R' 'qenv-get_code.R'
'qenv-get_env.R' 'qenv-get_var.R' 'qenv-get_warnings.R'
'qenv-join.R' 'qenv-show.R' 'qenv-within.R'
'teal.code-package.R' 'utils.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-11 15:24:11 UTC; unardid</td>
</tr>
<tr>
<td>Author:</td>
<td>Dawid Kaledkowski [aut, cre],
  Aleksander Chlebowski [aut],
  Marcin Kosinski [aut],
  Pawel Rucki [aut],
  Nikolas Burkoff [aut],
  Mahmoud Hallal [aut],
  Maciej Nasinski [aut],
  Konrad Pagacz [aut],
  Junlue Zhao [aut],
  Chendi Liao [rev],
  Dony Unardi [rev],
  F. Hoffmann-La Roche AG [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dawid Kaledkowski &lt;dawid.kaledkowski@roche.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-11 17:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.check_joinable'>If two <code>qenv</code> can be joined</h2><span id='topic+.check_joinable'></span>

<h3>Description</h3>

<p>Checks if two <code>qenv</code> objects can be combined.
For more information, please see <code><a href="#topic+join">join</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.check_joinable(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".check_joinable_+3A_x">x</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id=".check_joinable_+3A_y">y</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if able to join or <code>character</code> used to print error message.
</p>

<hr>
<h2 id='concat'>Concatenate two <code>qenv</code> objects</h2><span id='topic+concat'></span><span id='topic+concat+2Cqenv+2Cqenv-method'></span><span id='topic+concat+2Cqenv.error+2CANY-method'></span><span id='topic+concat+2Cqenv+2Cqenv.error-method'></span>

<h3>Description</h3>

<p>Combine two <code>qenv</code> objects by simple concatenate their environments and the code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>concat(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concat_+3A_x">x</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id="concat_+3A_y">y</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We recommend to use the <code>join</code> method to have a stricter control
in case <code>x</code> and <code>y</code> contain duplicated bindings and code.
RHS argument content has priority over the LHS one.
</p>


<h3>Value</h3>

<p><code>qenv</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- qenv()
q1 &lt;- eval_code(q, expression(iris1 &lt;- iris, mtcars1 &lt;- mtcars))
q2 &lt;- q1
q1 &lt;- eval_code(q1, "iris2 &lt;- iris")
q2 &lt;- eval_code(q2, "mtcars2 &lt;- mtcars")
qq &lt;- concat(q1, q2)
get_code(qq)

</code></pre>

<hr>
<h2 id='dev_suppress'>Suppresses plot display in the IDE by opening a PDF graphics device</h2><span id='topic+dev_suppress'></span>

<h3>Description</h3>

<p>This function opens a PDF graphics device using <code><a href="grDevices.html#topic+pdf">grDevices::pdf</a></code> to suppress
the plot display in the IDE. The purpose of this function is to avoid opening graphic devices
directly in the IDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dev_suppress(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dev_suppress_+3A_x">x</code></td>
<td>
<p>lazy binding which generates the plot(s)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses <code><a href="base.html#topic+on.exit">base::on.exit</a></code> to ensure that the PDF graphics
device is closed (using <code><a href="grDevices.html#topic+dev">grDevices::dev.off</a></code>) when the function exits,
regardless of whether it exits normally or due to an error. This is necessary to
clean up the graphics device properly and avoid any potential issues.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dev_suppress(plot(1:10))
</code></pre>

<hr>
<h2 id='get_env'>Access environment included in <code>qenv</code></h2><span id='topic+get_env'></span><span id='topic+get_env+2Cqenv-method'></span><span id='topic+get_env+2Cqenv.error-method'></span>

<h3>Description</h3>

<p>The access of environment included in <code>qenv@env</code> allows to e.g. list object names included in <code>qenv@env</code> slot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_env(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_env_+3A_object">object</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>environment</code> stored in <code>qenv@env</code> slot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- qenv()
q1 &lt;- within(q, {
  a &lt;- 5
  b &lt;- data.frame(x = 1:10)
})
get_env(q1)
ls(get_env(q1))

</code></pre>

<hr>
<h2 id='get_var'>Get object from <code>qenv</code></h2><span id='topic+get_var'></span><span id='topic+get_var+2Cqenv+2Ccharacter-method'></span><span id='topic+get_var+2Cqenv.error+2CANY-method'></span><span id='topic++5B+5B+2Cqenv-method'></span>

<h3>Description</h3>

<p>Retrieve variables from the <code>qenv</code> environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_var(object, var)

## S4 method for signature 'qenv'
x[[i]]
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_var_+3A_object">object</code>, <code id="get_var_+3A_x">x</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id="get_var_+3A_var">var</code>, <code id="get_var_+3A_i">i</code></td>
<td>
<p>(<code>character(1)</code>) variable name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of required variable (<code>var</code>) within <code>qenv</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- qenv()
q1 &lt;- eval_code(q, code = quote(a &lt;- 1))
q2 &lt;- eval_code(q1, code = "b &lt;- a")
get_var(q2, "b")
q2[["b"]]

</code></pre>

<hr>
<h2 id='get_warnings'>Get warnings from <code>qenv</code> object</h2><span id='topic+get_warnings'></span><span id='topic+get_warnings+2Cqenv-method'></span><span id='topic+get_warnings+2Cqenv.error-method'></span><span id='topic+get_warnings+2CNULL-method'></span>

<h3>Description</h3>

<p>Retrieve all warnings raised during code evaluation in a <code>qenv</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_warnings(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_warnings_+3A_object">object</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>character</code> containing warning information or <code>NULL</code> if no warnings.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data_q &lt;- qenv()
data_q &lt;- eval_code(data_q, "iris_data &lt;- iris")
warning_qenv &lt;- eval_code(
  data_q,
  bquote(p &lt;- hist(iris_data[, .("Sepal.Length")], ff = ""))
)
cat(get_warnings(warning_qenv))

</code></pre>

<hr>
<h2 id='join'>Join <code>qenv</code> objects</h2><span id='topic+join'></span><span id='topic+join+2Cqenv+2Cqenv-method'></span><span id='topic+join+2Cqenv+2Cqenv.error-method'></span><span id='topic+join+2Cqenv.error+2CANY-method'></span>

<h3>Description</h3>

<p>Checks and merges two <code>qenv</code> objects into one <code>qenv</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>join(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="join_+3A_x">x</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id="join_+3A_y">y</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Any common code at the start of the <code>qenvs</code> is only placed once at the start of the joined <code>qenv</code>.
This allows consistent behavior when joining <code>qenvs</code> which share a common ancestor.
See below for an example.
</p>
<p>There are some situations where <code>join()</code> cannot be properly performed, such as these three scenarios:
</p>

<ol>
<li><p> Both <code>qenv</code> objects contain an object of the same name but are not identical.
</p>
<p>Example:
</p>
<div class="sourceCode r"><pre>x &lt;- eval_code(qenv(), expression(mtcars1 &lt;- mtcars))
y &lt;- eval_code(qenv(), expression(mtcars1 &lt;- mtcars['wt']))

z &lt;- join(x, y)
# Error message will occur
</pre></div>
<p>In this example, <code>mtcars1</code> object exists in both <code>x</code> and <code>y</code> objects but the content are not identical.
<code>mtcars1</code> in the <code style="white-space: pre;">&#8288;x qenv&#8288;</code> object has more columns than <code>mtcars1</code> in the <code style="white-space: pre;">&#8288;y qenv&#8288;</code> object (only has one column).
</p>
</li>
<li> <p><code>join()</code> will look for identical <code style="white-space: pre;">&#8288;@id&#8288;</code> values in both <code>qenv</code> objects.
The index position of these <code style="white-space: pre;">&#8288;@id&#8288;</code>s must be the same to determine the evaluation order.
Otherwise, <code>join()</code> will throw an error message.
</p>
<p>Example:
</p>
<div class="sourceCode r"><pre>common_q &lt;- eval_code(qenv(), expression(v &lt;- 1))
x &lt;- eval_code(
  common_q,
  "x &lt;- v"
)
y &lt;- eval_code(
  common_q,
  "y &lt;- v"
)
z &lt;- eval_code(
  y,
  "z &lt;- v"
)
q &lt;- join(x, y)
join_q &lt;- join(q, z)
# Error message will occur

# Check the order of evaluation based on the id slot
shared_ids &lt;- intersect(q@id, z@id)
match(shared_ids, q@id) # Output: 1 3
match(shared_ids, z@id) # Output: 1 2
</pre></div>
<p>The error occurs because the index position of identical <code style="white-space: pre;">&#8288;@id&#8288;</code> between the two objects is not the same.
</p>
</li>
<li><p> The usage of temporary variable in the code expression could cause <code>join()</code> to fail.
</p>
<p>Example:
</p>
<div class="sourceCode r"><pre>common_q &lt;- qenv()
x &lt;- eval_code(
  common_q,
  "x &lt;- numeric(0)
   for (i in 1:2) {
     x &lt;- c(x, i)
   }"
)
y &lt;- eval_code(
  common_q,
  "y &lt;- numeric(0)
   for (i in 1:3) {
     y &lt;- c(y, i)
   }"
)
q &lt;- join(x,y)
# Error message will occur

# Check the value of temporary variable i in both objects
x@env$i # Output: 2
y@env$i # Output: 3
</pre></div>
<p><code>join()</code> fails to provide a proper result because of the temporary variable <code>i</code> exists
in both objects but has different value.
To fix this, we can set <code>i &lt;- NULL</code> in the code expression for both objects.
</p>
<div class="sourceCode r"><pre>common_q &lt;- qenv()
x &lt;- eval_code(
  common_q,
  "x &lt;- numeric(0)
   for (i in 1:2) {
     x &lt;- c(x, i)
   }
   # dummy i variable to fix it
   i &lt;- NULL"
)
y &lt;- eval_code(
  common_q,
  "y &lt;- numeric(0)
   for (i in 1:3) {
     y &lt;- c(y, i)
   }
   # dummy i variable to fix it
   i &lt;- NULL"
)
q &lt;- join(x,y)
</pre></div>
</li></ol>



<h3>Value</h3>

<p><code>qenv</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- qenv()
q1 &lt;- eval_code(q, expression(iris1 &lt;- iris, mtcars1 &lt;- mtcars))
q2 &lt;- q1
q1 &lt;- eval_code(q1, "iris2 &lt;- iris")
q2 &lt;- eval_code(q2, "mtcars2 &lt;- mtcars")
qq &lt;- join(q1, q2)
get_code(qq)

common_q &lt;- eval_code(q, quote(x &lt;- 1))
y_q &lt;- eval_code(common_q, quote(y &lt;- x * 2))
z_q &lt;- eval_code(common_q, quote(z &lt;- x * 3))
join_q &lt;- join(y_q, z_q)
# get_code only has "x &lt;- 1" occurring once
get_code(join_q)

</code></pre>

<hr>
<h2 id='lang2calls'>Separate calls</h2><span id='topic+lang2calls'></span>

<h3>Description</h3>

<p>Converts language object or lists of language objects to list of simple calls.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lang2calls(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lang2calls_+3A_x">x</code></td>
<td>
<p><code>language</code> object or a list of thereof</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Given a <code>call</code>, an <code>expression</code>, a list of <code>call</code>s or a list of <code>expression</code>s, returns a list of <code>calls</code>.
Symbols and atomic vectors (which may get mixed up in a list) are returned wrapped in list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use non-exported function from teal.code
lang2calls &lt;- getFromNamespace("lang2calls", "teal.code")
expr &lt;- expression(
  i &lt;- iris,
  m &lt;- mtcars
)
lang2calls(expr)
</code></pre>

<hr>
<h2 id='qenv'>Code tracking with <code>qenv</code> object</h2><span id='topic+qenv'></span><span id='topic+new_qenv'></span><span id='topic+new_qenv+2Cenvironment+2Cexpression-method'></span><span id='topic+new_qenv+2Cenvironment+2Ccharacter-method'></span><span id='topic+new_qenv+2Cenvironment+2Clanguage-method'></span><span id='topic+new_qenv+2Cenvironment+2Cmissing-method'></span><span id='topic+new_qenv+2Cmissing+2Cmissing-method'></span><span id='topic+eval_code'></span><span id='topic+eval_code+2Cqenv+2Ccharacter-method'></span><span id='topic+eval_code+2Cqenv+2Clanguage-method'></span><span id='topic+eval_code+2Cqenv+2Cexpression-method'></span><span id='topic+eval_code+2Cqenv.error+2CANY-method'></span><span id='topic+get_code'></span><span id='topic+get_code+2Cqenv-method'></span><span id='topic+get_code+2Cqenv.error-method'></span><span id='topic+within.qenv'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
</p>
<p>Create a <code>qenv</code> object and evaluate code in it to track code history.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qenv()

new_qenv(env = new.env(parent = parent.env(.GlobalEnv)), code = character())

eval_code(object, code)

get_code(object, deparse = TRUE, ...)

## S3 method for class 'qenv'
within(data, expr, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qenv_+3A_env">env</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> (<code>environment</code>)
Environment being a result of the <code>code</code> evaluation.</p>
</td></tr>
<tr><td><code id="qenv_+3A_code">code</code></td>
<td>
<p>(<code>character</code> or <code>language</code>) code to evaluate. If <code>character</code>, comments are retained.</p>
</td></tr>
<tr><td><code id="qenv_+3A_object">object</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id="qenv_+3A_deparse">deparse</code></td>
<td>
<p>(<code>logical(1)</code>) flag specifying whether to return code as <code>character</code> or <code>expression</code>.</p>
</td></tr>
<tr><td><code id="qenv_+3A_...">...</code></td>
<td>
<p>see <code>Details</code></p>
</td></tr>
<tr><td><code id="qenv_+3A_data">data</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
<tr><td><code id="qenv_+3A_expr">expr</code></td>
<td>
<p>(<code>expression</code>) to evaluate. Must be inline code, see <code style="white-space: pre;">&#8288;Using language objects...&#8288;</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>qenv()</code> instantiates a <code>qenv</code> with an empty environment.
Any changes must be made by evaluating code in it with <code>eval_code</code> or <code>within</code>, thereby ensuring reproducibility.
</p>
<p><code>new_qenv()</code> (<a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> and not recommended)
can instantiate a <code>qenv</code> object with data in the environment and code registered.
</p>
<p><code>eval_code</code> evaluates given code in the <code>qenv</code> environment and appends it to the <code>code</code> slot.
Thus, if the <code>qenv</code> had been instantiated empty, contents of the environment are always a result of the stored code.
</p>
<p><code>get_code</code> retrieves the code stored in the <code>qenv</code>. <code>...</code> passes arguments to methods.
</p>
<p><code>within</code> is a convenience function for evaluating inline code inside the environment of a <code>qenv</code>.
It is a method for the <code>base</code> generic that wraps <code>eval_code</code> to provide a simplified way of passing code.
<code>within</code> accepts only inline expressions (both simple and compound) and allows for injecting values into <code>expr</code>
through the <code>...</code> argument:
as <code>name:value</code> pairs are passed to <code>...</code>, <code>name</code> in <code>expr</code> will be replaced with <code>value</code>.
</p>


<h3>Value</h3>

<p><code>qenv</code> and <code>new_qenv</code> return a <code>qenv</code> object.
</p>
<p><code>eval_code</code> returns a <code>qenv</code> object with <code>expr</code> evaluated or <code>qenv.error</code> if evaluation fails.
</p>
<p><code>get_code</code> returns the traced code (from <code style="white-space: pre;">&#8288;@code&#8288;</code> slot) in the form specified by <code>deparse</code>.
</p>
<p><code>within</code> returns a <code>qenv</code> object with <code>expr</code> evaluated or <code>qenv.error</code> if evaluation fails.
</p>


<h3>Using language objects with <code>within</code></h3>

<p>Passing language objects to <code>expr</code> is generally not intended but can be achieved with <code>do.call</code>.
Only single <code>expression</code>s will work and substitution is not available. See examples.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+with">base::within()</a></code>, <code><a href="#topic+get_var">get_var()</a></code>, <code><a href="#topic+get_env">get_env()</a></code>, <code><a href="#topic+get_warnings">get_warnings()</a></code>, <code><a href="#topic+join">join()</a></code>, <code><a href="#topic+concat">concat()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create empty qenv
qenv()

# create qenv with data and code (deprecated)
new_qenv(env = list2env(list(a = 1)), code = quote(a &lt;- 1))
new_qenv(env = list2env(list(a = 1)), code = parse(text = "a &lt;- 1", keep.source = TRUE))
new_qenv(env = list2env(list(a = 1)), code = "a &lt;- 1")

# evaluate code in qenv
q &lt;- qenv()
q &lt;- eval_code(q, "a &lt;- 1")
q &lt;- eval_code(q, quote(library(checkmate)))
q &lt;- eval_code(q, expression(assert_number(a)))

# retrieve code
get_code(q)
get_code(q, deparse = FALSE)

# evaluate code using within
q &lt;- qenv()
q &lt;- within(q, {
  i &lt;- iris
})
q &lt;- within(q, {
  m &lt;- mtcars
  f &lt;- faithful
})
q
get_code(q)

# inject values into code
q &lt;- qenv()
q &lt;- within(q, i &lt;- iris)
within(q, print(dim(subset(i, Species == "virginica"))))
within(q, print(dim(subset(i, Species == species)))) # fails
within(q, print(dim(subset(i, Species == species))), species = "versicolor")
species_external &lt;- "versicolor"
within(q, print(dim(subset(i, Species == species))), species = species_external)

# pass language objects
expr &lt;- expression(i &lt;- iris, m &lt;- mtcars)
within(q, expr) # fails
do.call(within, list(q, expr))

exprlist &lt;- list(expression(i &lt;- iris), expression(m &lt;- mtcars))
within(q, exprlist) # fails
do.call(within, list(q, do.call(c, exprlist)))

</code></pre>

<hr>
<h2 id='qenv-class'>Reproducible class with environment and code</h2><span id='topic+qenv-class'></span>

<h3>Description</h3>

<p>Reproducible class with environment and code.
</p>


<h3>Slots</h3>


<dl>
<dt><code>code</code></dt><dd><p>(<code>character</code>) representing code necessary to reproduce the environment</p>
</dd>
<dt><code>env</code></dt><dd><p>(<code>environment</code>) environment which content was generated by the evaluation
of the <code>code</code> slot.</p>
</dd>
<dt><code>id</code></dt><dd><p>(<code>integer</code>) random identifier of the code element to make sure uniqueness
when joining.</p>
</dd>
<dt><code>warnings</code></dt><dd><p>(<code>character</code>) the warnings output when evaluating the code</p>
</dd>
<dt><code>messages</code></dt><dd><p>(<code>character</code>) the messages output when evaluating the code</p>
</dd>
</dl>

<hr>
<h2 id='show+2Cqenv-method'>Display <code>qenv</code> object</h2><span id='topic+show+2Cqenv-method'></span><span id='topic+show-qenv'></span>

<h3>Description</h3>

<p>Prints the <code>qenv</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'qenv'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2Cqenv-method_+3A_object">object</code></td>
<td>
<p>(<code>qenv</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>object</code>, invisibly.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>q &lt;- qenv()
q1 &lt;- eval_code(q, expression(a &lt;- 5, b &lt;- data.frame(x = 1:10)))
q1

</code></pre>

<hr>
<h2 id='teal.code-package'><code>teal.code</code>: Code storage and execution class for teal applications</h2><span id='topic+teal.code'></span><span id='topic+teal.code-package'></span>

<h3>Description</h3>

<p>The <code>teal.code</code> package contains functionalities that can be used
to store and execute R calls. <code>qenv</code> class allows to create a <code>teal</code>
module which returns code to reproduce application outputs.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dawid Kaledkowski <a href="mailto:dawid.kaledkowski@roche.com">dawid.kaledkowski@roche.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Aleksander Chlebowski <a href="mailto:aleksander.chlebowski@contractors.roche.com">aleksander.chlebowski@contractors.roche.com</a>
</p>
</li>
<li><p> Marcin Kosinski <a href="mailto:marcin.kosinski.mk1@roche.com">marcin.kosinski.mk1@roche.com</a>
</p>
</li>
<li><p> Pawel Rucki <a href="mailto:pawel.rucki@roche.com">pawel.rucki@roche.com</a>
</p>
</li>
<li><p> Nikolas Burkoff <a href="mailto:nikolas.burkoff@roche.com">nikolas.burkoff@roche.com</a>
</p>
</li>
<li><p> Mahmoud Hallal <a href="mailto:mahmoud.hallal@roche.com">mahmoud.hallal@roche.com</a>
</p>
</li>
<li><p> Maciej Nasinski <a href="mailto:maciej.nasinski@contractors.roche.com">maciej.nasinski@contractors.roche.com</a>
</p>
</li>
<li><p> Konrad Pagacz <a href="mailto:konrad.pagacz@contractors.roche.com">konrad.pagacz@contractors.roche.com</a>
</p>
</li>
<li><p> Junlue Zhao <a href="mailto:zhaoj88@gene.com">zhaoj88@gene.com</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Chendi Liao <a href="mailto:chendi.liao@roche.com">chendi.liao@roche.com</a> [reviewer]
</p>
</li>
<li><p> Dony Unardi <a href="mailto:unardid@gene.com">unardid@gene.com</a> [reviewer]
</p>
</li>
<li><p> F. Hoffmann-La Roche AG [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://insightsengineering.github.io/teal.code/">https://insightsengineering.github.io/teal.code/</a>
</p>
</li>
<li> <p><a href="https://github.com/insightsengineering/teal.code">https://github.com/insightsengineering/teal.code</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/insightsengineering/teal.code/issues">https://github.com/insightsengineering/teal.code/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
