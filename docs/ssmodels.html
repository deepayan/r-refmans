<!DOCTYPE html><html><head><title>Help for package ssmodels</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ssmodels}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HCinitial'><p>Two-Step Method for Parameter Estimation of the Heckman Model</p></a></li>
<li><a href='#HeckmanBS'><p>Heckman BS Model fit Function</p></a></li>
<li><a href='#HeckmanCL'><p>Classic Heckman Model fit Function</p></a></li>
<li><a href='#HeckmanGe'><p>Function for fit of the Generalized</p>
Heckman Model</a></li>
<li><a href='#HeckmanSK'><p>Normal Skew Model fit Function</p></a></li>
<li><a href='#HeckmantS'><p>Heckman-t Model fit Function</p></a></li>
<li><a href='#IMR'><p>Inverse Mills Ratio</p></a></li>
<li><a href='#MEPS2001'><p>Medical Expenditure Panel Survey</p></a></li>
<li><a href='#Mroz87'><p>U.S. Women's Labor Force Participation</p></a></li>
<li><a href='#nhanes'><p>US National Health and Nutrition Examination Study</p></a></li>
<li><a href='#PSID2'><p>Panel Study of Income Dynamics</p></a></li>
<li><a href='#RandHIE'><p>RAND Health Insurance Experiment</p></a></li>
<li><a href='#ssmodels'><p>ssmodels: A package for fit the sample selection models.</p></a></li>
<li><a href='#step2'><p>Heckman's two-step method</p></a></li>
<li><a href='#summary.HeckmanBS'><p>Summary of Birnbaum-Saunders Heckman Model</p></a></li>
<li><a href='#summary.HeckmanCL'><p>Summary of Classic Heckman Model</p></a></li>
<li><a href='#summary.HeckmanGe'><p>Summary of Generalized Heckman Model</p></a></li>
<li><a href='#summary.HeckmanSK'><p>Summary of Skew-Normal Heckman Model</p></a></li>
<li><a href='#summary.HeckmantS'><p>Summary of Heckman-ts Model</p></a></li>
<li><a href='#twostep'><p>Heckman's two-step method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Sample Selection Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Fernando de Souza Bastos [aut, cre],
  Wagner Barreto de Souza [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fernando de Souza Bastos &lt;fernando.bastos@ufv.br&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sn (&ge; 2.1.0), numDeriv (&ge; 2016.8-1.1), pracma (&ge; 2.3.8),
miscTools (&ge; 0.6-26), Rdpack (&ge; 2.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.24), testthat (&ge; 3.0.0), maxLik (&ge; 1.3-6),
mvtnorm (&ge; 1.0-11), sampleSelection (&ge; 1.2-6), kableExtra (&ge;
1.1.0), kfigr (&ge; 1.2), ggplot2 (&ge; 3.2.1), gridExtra (&ge; 2.3)</td>
</tr>
<tr>
<td>Description:</td>
<td>In order to facilitate the adjustment of the sample selection models existing in the literature, we created the 'ssmodels' package. Our package allows the adjustment of the classic Heckman model (Heckman (1976), Heckman (1979) &lt;<a href="https://doi.org/10.2307%2F1912352">doi:10.2307/1912352</a>&gt;), and the estimation of the parameters of this model via the maximum likelihood method and two-step method, in addition to the adjustment of the Heckman-t models, introduced in the literature by Marchenko and Genton (2012) &lt;<a href="https://doi.org/10.1080%2F01621459.2012.656011">doi:10.1080/01621459.2012.656011</a>&gt; and the Heckman-Skew model introduced in the literature by Ogundimu and Hutton (2016) &lt;<a href="https://doi.org/10.1111%2Fsjos.12171">doi:10.1111/sjos.12171</a>&gt;. We also implemented functions to adjust the generalized version of the Heckman model, introduced by Bastos, Barreto-Souza, and Genton (2021) &lt;<a href="https://doi.org/10.5705%2Fss.202021.0068">doi:10.5705/ss.202021.0068</a>&gt;, that allows the inclusion of covariables to the dispersion and correlation parameters and a function to adjust the Heckman-BS model introduced by Bastos and Barreto-Souza (2020) &lt;<a href="https://doi.org/10.1080%2F02664763.2020.1780570">doi:10.1080/02664763.2020.1780570</a>&gt; that uses the Birnbaum-Saunders distribution as a joint distribution of the selection and primary regression variables. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fsbmat-ufv/ssmodels/issues">https://github.com/fsbmat-ufv/ssmodels/issues</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-03 17:42:59 UTC; Dell</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-04 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='HCinitial'>Two-Step Method for Parameter Estimation of the Heckman Model</h2><span id='topic+HCinitial'></span>

<h3>Description</h3>

<p>Estimates the parameters of the classic
Heckman model via the two-step method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HCinitial(selection, outcome, data = sys.frame(sys.parent()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HCinitial_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HCinitial_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HCinitial_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generally, the two-step method is very
useful for finding initial values for
the Likelihood Estimation method. In
first step performs a probit analysis
on a selection equation. The second
step analyzes an outcome equation based
on the first-step binary probit model.
</p>


<h3>Value</h3>

<p>Returns a numerical vector with estimates
of the parameters of the classical Heckman
model using the two-step method
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
HCinitial(selectEq,outcomeEq, data = MEPS2001)

</code></pre>

<hr>
<h2 id='HeckmanBS'>Heckman BS Model fit Function</h2><span id='topic+HeckmanBS'></span>

<h3>Description</h3>

<p>Estimates the parameters of the Heckman-BS model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HeckmanBS(selection, outcome, data = sys.frame(sys.parent()), start = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HeckmanBS_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HeckmanBS_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HeckmanBS_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
<tr><td><code id="HeckmanBS_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The HeckmanBS() function fits the Sample Selection Model
based on the Birnbaum–Saunders bivariate distribution,
it has the same number of parameters as the classical
Heckman model. For more information see
Bastos and Barreto-Souza (2020)
</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<p>Coefficients: Returns a numerical vector with the best estimated values
of the model parameters;
</p>
<p>Value: The value of function to be minimized (or maximized) corresponding
to par.
</p>
<p>loglik: Negative of value. Minimum (or maximum) of the likelihood function
calculated from the estimated coefficients.
</p>
<p>counts: Component of the Optim function. A two-element integer vector
giving the number of calls to fn and gr respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls
to fn to compute a finite-difference approximation to the gradient.
</p>
<p>hessian: Component of the Optim function, with pre-defined option
hessian=TRUE. A symmetric matrix giving an estimate of the Hessian
at the solution found. Note that this is the Hessian of the unconstrained
problem even if the box constraints are active.
</p>
<p>fisher_infoBS: Fisher information matrix
</p>
<p>prop_sigmaBS: Square root of the Fisher information matrix diagonal
</p>
<p>level: Selection variable levels
</p>
<p>nObs: Numeric value representing the size of the database
</p>
<p>nParam: Numerical value representing the number of model parameters
</p>
<p>N0: Numerical value representing the number of unobserved entries
</p>
<p>N1: Numerical value representing the number of complete entries
</p>
<p>NXS: Numerical value representing the number of parameters of the
selection model
</p>
<p>NXO: Numerical value representing the number of parameters of the
regression model
</p>
<p>df: Numerical value that represents the difference between the size
of the response vector of the selection equation and the number of
model parameters
</p>
<p>aic: Numerical value representing Akaike's information criterion.
</p>
<p>bic: Numerical value representing Schwarz's Bayesian Criterion
</p>
<p>initial.value: Numerical vector that represents the input values
(Initial Values) used in the parameter estimation.
</p>


<h3>References</h3>


<p>Fernando
de
Souza Bastos, Wagner Barreto-Souza (2020).
&ldquo;Birnbaum–Saunders sample selection model.&rdquo;
<em>Journal of Applied Statistics</em>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeBS &lt;- ambexp ~ age + female + educ + blhisp + totchr + ins
HeckmanBS(selectEq, outcomeBS, data = MEPS2001)
</code></pre>

<hr>
<h2 id='HeckmanCL'>Classic Heckman Model fit Function</h2><span id='topic+HeckmanCL'></span>

<h3>Description</h3>

<p>Estimates the parameters of the classic Heckman model
via Maximum Likelihood method. The initial start is obtained
via the two-step method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HeckmanCL(selection, outcome, data = sys.frame(sys.parent()), start = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HeckmanCL_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HeckmanCL_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HeckmanCL_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
<tr><td><code id="HeckmanCL_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<p>Coefficients: Returns a numerical vector with the best estimated values
of the model parameters;
</p>
<p>Value: The value of function to be minimized (or maximized) corresponding
to par.
</p>
<p>loglik: Negative of value. Minimum (or maximum) of the likelihood function
calculated from the estimated coefficients.
</p>
<p>counts: Component of the Optim function. A two-element integer vector
giving the number of calls to fn and gr respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls
to fn to compute a finite-difference approximation to the gradient.
</p>
<p>hessian: Component of the Optim function, with pre-defined option
hessian=TRUE. A symmetric matrix giving an estimate of the Hessian
at the solution found. Note that this is the Hessian of the unconstrained
problem even if the box constraints are active.
</p>
<p>fisher_infoHC: Fisher information matrix
</p>
<p>prop_sigmaHC: Square root of the Fisher information matrix diagonal
</p>
<p>level: Selection variable levels
</p>
<p>nObs: Numeric value representing the size of the database
</p>
<p>nParam: Numerical value representing the number of model parameters
</p>
<p>N0: Numerical value representing the number of unobserved entries
</p>
<p>N1: Numerical value representing the number of complete entries
</p>
<p>NXS: Numerical value representing the number of parameters of the
selection model
</p>
<p>NXO: Numerical value representing the number of parameters of the
regression model
</p>
<p>df: Numerical value that represents the difference between the size
of the response vector of the selection equation and the number of
model parameters
</p>
<p>aic: Numerical value representing Akaike's information criterion.
</p>
<p>bic: Numerical value representing Schwarz's Bayesian Criterion
</p>
<p>initial.value: Numerical vector that represents the input values
(Initial Values) used in the parameter estimation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
HeckmanCL(selectEq, outcomeEq, data = MEPS2001)
</code></pre>

<hr>
<h2 id='HeckmanGe'>Function for fit of the Generalized
Heckman Model</h2><span id='topic+HeckmanGe'></span>

<h3>Description</h3>

<p>Estimates the parameters of the Generalized
Heckman model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HeckmanGe(
  selection,
  outcome,
  outcomeS,
  outcomeC,
  data = sys.frame(sys.parent()),
  start = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HeckmanGe_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HeckmanGe_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HeckmanGe_+3A_outcomes">outcomeS</code></td>
<td>
<p>Matrix with Covariates for fit of the Dispersion Parameter.</p>
</td></tr>
<tr><td><code id="HeckmanGe_+3A_outcomec">outcomeC</code></td>
<td>
<p>Matrix with Covariates for fit of the Correlation Parameter.</p>
</td></tr>
<tr><td><code id="HeckmanGe_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
<tr><td><code id="HeckmanGe_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The HeckmanGe() function fits a generalization of the Heckman sample
selection model, allowing sample selection bias and dispersion parameters
to depend on covariates. For more information, see
Bastos et al. (2022)
</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<p>Coefficients: Returns a numerical vector with the best estimated values
of the model parameters;
</p>
<p>Value: The value of function to be minimized (or maximized) corresponding
to par.
</p>
<p>loglik: Negative of value. Minimum (or maximum) of the likelihood function
calculated from the estimated coefficients.
</p>
<p>counts: Component of the Optim function. A two-element integer vector
giving the number of calls to fn and gr respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls
to fn to compute a finite-difference approximation to the gradient.
</p>
<p>hessian: Component of the Optim function, with pre-defined option
hessian=TRUE. A symmetric matrix giving an estimate of the Hessian
at the solution found. Note that this is the Hessian of the unconstrained
problem even if the box constraints are active.
</p>
<p>fisher_infoHG: Fisher information matrix
</p>
<p>prop_sigmaHG: Square root of the Fisher information matrix diagonal
</p>
<p>level: Selection variable levels
</p>
<p>nObs: Numeric value representing the size of the database
</p>
<p>nParam: Numerical value representing the number of model parameters
</p>
<p>N0: Numerical value representing the number of unobserved entries
</p>
<p>N1: Numerical value representing the number of complete entries
</p>
<p>NXS: Numerical value representing the number of parameters of the
selection model
</p>
<p>NXO: Numerical value representing the number of parameters of the
regression model
</p>
<p>df: Numerical value that represents the difference between the size
of the response vector of the selection equation and the number of
model parameters
</p>
<p>aic: Numerical value representing Akaike's information criterion.
</p>
<p>bic: Numerical value representing Schwarz's Bayesian Criterion
</p>
<p>initial.value: Numerical vector that represents the input values
(Initial Values) used in the parameter estimation.
</p>
<p>NE: Numerical value that represents the number
of parameters related to the covariates fitted
to the dispersion parameter considering the
constant parameter.
</p>
<p>NV: Numerical value that represents the number
of parameters related to the covariates fitted
to the correlation parameter considering the
constant parameter.
</p>


<h3>References</h3>


<p>Fernando
de
Souza Bastos, Wagner Barreto-Souza, Marc
G Genton (2022).
&ldquo;A Generalized Heckman Model With Varying Sample Selection Bias and Dispersion Parameters.&rdquo;
<em>Statistica Sinica</em>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
outcomeS &lt;- cbind(age,female,totchr,ins)
outcomeC &lt;- 1
HeckmanGe(selectEq, outcomeEq,outcomeS, outcomeC, data = MEPS2001)
</code></pre>

<hr>
<h2 id='HeckmanSK'>Normal Skew Model fit Function</h2><span id='topic+HeckmanSK'></span>

<h3>Description</h3>

<p>Estimates the parameters of the Sample Selection Model with Skew-Normal
Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HeckmanSK(
  selection,
  outcome,
  data = sys.frame(sys.parent()),
  lambda,
  start = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HeckmanSK_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HeckmanSK_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HeckmanSK_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
<tr><td><code id="HeckmanSK_+3A_lambda">lambda</code></td>
<td>
<p>Initial start for asymmetry parameter.</p>
</td></tr>
<tr><td><code id="HeckmanSK_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The HeckmanSK() function fits the Sample Selection Model
based on the Skew-normal distribution. For more information see
Ogundimu and Hutton (2016)
</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<p>Coefficients: Returns a numerical vector with the best estimated values
of the model parameters;
</p>
<p>Value: The value of function to be minimized (or maximized) corresponding
to par.
</p>
<p>loglik: Negative of value. Minimum (or maximum) of the likelihood function
calculated from the estimated coefficients.
</p>
<p>counts: Component of the Optim function. A two-element integer vector
giving the number of calls to fn and gr respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls
to fn to compute a finite-difference approximation to the gradient.
</p>
<p>hessian: Component of the Optim function, with pre-defined option
hessian=TRUE. A symmetric matrix giving an estimate of the Hessian
at the solution found. Note that this is the Hessian of the unconstrained
problem even if the box constraints are active.
</p>
<p>fisher_infoSK: Fisher information matrix
</p>
<p>prop_sigmaSK: Square root of the Fisher information matrix diagonal
</p>
<p>level: Selection variable levels
</p>
<p>nObs: Numeric value representing the size of the database
</p>
<p>nParam: Numerical value representing the number of model parameters
</p>
<p>N0: Numerical value representing the number of unobserved entries
</p>
<p>N1: Numerical value representing the number of complete entries
</p>
<p>NXS: Numerical value representing the number of parameters of the
selection model
</p>
<p>NXO: Numerical value representing the number of parameters of the
regression model
</p>
<p>df: Numerical value that represents the difference between the size
of the response vector of the selection equation and the number of
model parameters
</p>
<p>aic: Numerical value representing Akaike's information criterion.
</p>
<p>bic: Numerical value representing Schwarz's Bayesian Criterion
</p>
<p>initial.value: Numerical vector that represents the input values
(Initial Values) used in the parameter estimation.
</p>


<h3>References</h3>


<p>Emmanuel
O Ogundimu, Jane
L Hutton (2016).
&ldquo;A Sample Selection Model with Skew-normal Distribution.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>43</b>(1), 172&ndash;190.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Mroz87")
attach(Mroz87)
selectEq &lt;- lfp ~ huswage + kids5 + mtr + fatheduc + educ + city
outcomeEq &lt;- log(wage) ~ educ+city
HeckmanSK(selectEq, outcomeEq, data = Mroz87, lambda = -1.5)
</code></pre>

<hr>
<h2 id='HeckmantS'>Heckman-t Model fit Function</h2><span id='topic+HeckmantS'></span>

<h3>Description</h3>

<p>Estimates the parameters of the Heckman-t model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HeckmantS(selection, outcome, data = sys.frame(sys.parent()), df, start = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HeckmantS_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="HeckmantS_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="HeckmantS_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
<tr><td><code id="HeckmantS_+3A_df">df</code></td>
<td>
<p>Initial start to the degree of freedom.</p>
</td></tr>
<tr><td><code id="HeckmantS_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The HeckmantS() function fits the Sample Selection Model
based on the Student's t distribution. For more information see
Marchenko and Genton (2012)
</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<p>Coefficients: Returns a numerical vector with the best estimated values
of the model parameters;
</p>
<p>Value: The value of function to be minimized (or maximized) corresponding
to par.
</p>
<p>loglik: Negative of value. Minimum (or maximum) of the likelihood function
calculated from the estimated coefficients.
</p>
<p>counts: Component of the Optim function. A two-element integer vector
giving the number of calls to fn and gr respectively. This excludes
those calls needed to compute the Hessian, if requested, and any calls
to fn to compute a finite-difference approximation to the gradient.
</p>
<p>hessian: Component of the Optim function, with pre-defined option
hessian=TRUE. A symmetric matrix giving an estimate of the Hessian
at the solution found. Note that this is the Hessian of the unconstrained
problem even if the box constraints are active.
</p>
<p>fisher_infotS: Fisher information matrix
</p>
<p>prop_sigmatS: Square root of the Fisher information matrix diagonal
</p>
<p>level: Selection variable levels
</p>
<p>nObs: Numeric value representing the size of the database
</p>
<p>nParam: Numerical value representing the number of model parameters
</p>
<p>N0: Numerical value representing the number of unobserved entries
</p>
<p>N1: Numerical value representing the number of complete entries
</p>
<p>NXS: Numerical value representing the number of parameters of the
selection model
</p>
<p>NXO: Numerical value representing the number of parameters of the
regression model
</p>
<p>df: Numerical value that represents the difference between the size
of the response vector of the selection equation and the number of
model parameters
</p>
<p>aic: Numerical value representing Akaike's information criterion.
</p>
<p>bic: Numerical value representing Schwarz's Bayesian Criterion
</p>
<p>initial.value: Numerical vector that represents the input values
(Initial Values) used in the parameter estimation.
</p>


<h3>References</h3>


<p>Yulia
V Marchenko, Marc
G Genton (2012).
&ldquo;A Heckman selection-t model.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>107</b>(497), 304&ndash;317.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
HeckmantS(selectEq, outcomeEq, data = MEPS2001, df=12)
</code></pre>

<hr>
<h2 id='IMR'>Inverse Mills Ratio</h2><span id='topic+IMR'></span>

<h3>Description</h3>

<p>Column vector of the inverse ratio of Mills
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IMR(selection, data = sys.frame(sys.parent()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IMR_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="IMR_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return column vector of the inverse ratio of Mills
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
IMR(selectEq)
</code></pre>

<hr>
<h2 id='MEPS2001'>Medical Expenditure Panel Survey</h2><span id='topic+MEPS2001'></span>

<h3>Description</h3>

<p>The MEPS is a set of large-scale surveys of families, individuals
and their medical providers (doctors, hospitals, pharmacies, etc.)
in the United States. It has data on the health services Americans use,
how often they use them, the cost of these services and how they are paid,
as well as data on the cost and reach of health insurance available
to American workers. The sample is restricted to persons aged between 21
and 64 years and contains a variable response with 3328 observations of
outpatient costs, of which 526 (15.8%) correspond to unobserved expenditure
values and identified as zero expenditure for adjustment of the models.
It also includes the following explanatory variables:
</p>

<ul>
<li><p>educ: education status
</p>
</li>
<li><p>age: Age
</p>
</li>
<li><p>income: income
</p>
</li>
<li><p>female: gender
</p>
</li>
<li><p>vgood: a numeric vector
</p>
</li>
<li><p>good: a numeric vector
</p>
</li>
<li><p>hospexp: a numeric vector
</p>
</li>
<li><p>totchr: number of chronic diseases
</p>
</li>
<li><p>ffs: a numeric vector
</p>
</li>
<li><p>dhospexp: a numeric vector
</p>
</li>
<li><p>age2: a numeric vector
</p>
</li>
<li><p>agefem: a numeric vector
</p>
</li>
<li><p>fairpoor: a numeric vector
</p>
</li>
<li><p>year01: a numeric vector
</p>
</li>
<li><p>instype: a numeric vector
</p>
</li>
<li><p>ambexp: a numeric vector
</p>
</li>
<li><p>lambexp: log ambulatory expenditures
</p>
</li>
<li><p>blhisp: ethnicity
</p>
</li>
<li><p>instype_s1: a numeric vector
</p>
</li>
<li><p>dambexp: dummy variable, ambulatory expenditures
</p>
</li>
<li><p>lnambx: a numeric vector
</p>
</li>
<li><p>ins: insurance status
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>MEPS2001
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 3328 rows and 22 columns.
</p>


<h3>Source</h3>

<p>2001 Medical Expenditure Panel Survey by the Agency
for Healthcare Research and Quality.
</p>


<h3>References</h3>


<p>Cameron
A Colin, Pravin
K Trivedi (2009).
&ldquo;Microeconometrics using STATA.&rdquo;
<em>Lakeway Drive, TX: Stata Press Books</em>.
</p>
<p>Mikhail Zhelonkin, Marc
G. Genton, Elvezio Ronchetti (2019).
<em>ssmrob: Robust Estimation and Inference in Sample Selection Models</em>.
R package version 0.7, <a href="https://CRAN.R-project.org/package=ssmrob">https://CRAN.R-project.org/package=ssmrob</a>.
</p>
<p>Ott Toomet, Arne Henningsen (2008).
&ldquo;Sample Selection Models in R: Package sampleSelection.&rdquo;
<em>Journal of Statistical Software</em>, <b>27</b>(7).
<a href="https://www.jstatsoft.org/article/view/v027i07">https://www.jstatsoft.org/article/view/v027i07</a>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
hist(lnambx)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
HeckmanCL(selectEq, outcomeEq, data = MEPS2001)
</code></pre>

<hr>
<h2 id='Mroz87'>U.S. Women's Labor Force Participation</h2><span id='topic+Mroz87'></span>

<h3>Description</h3>

<p>The Mroz87 data frame contains data about 753
married women. These data are collected within the
&quot;Panel Study of Income Dynamics&quot; (PSID). Of the 753
observations, the first 428 are for women with positive
hours worked in 1975, while the remaining 325
observations are for women who did not work for
pay in 1975. A more complete discussion of the data
is found in Mroz (1987). It also
includes the following explanatory variables:
</p>

<ul>
<li><p>lfp: Dummy variable for labor-force participation.
</p>
</li>
<li><p>hours: Wife's hours of work in 1975. 
</p>
</li>
<li><p>kids5: Number of children 5 years old or younger.
</p>
</li>
<li><p>kids618: Number of children 6 to 18 years old.
</p>
</li>
<li><p>Age: Wife's age.
</p>
</li>
<li><p>Educ: Wife's educational attainment, in years.
</p>
</li>
<li><p>wage: Wife's average hourly earnings, in 1975 dollars.
</p>
</li>
<li><p>repwage: Wife's wage reported at the time of the 1976 interview.
</p>
</li>
<li><p>hushrs: Husband's hours worked in 1975.
</p>
</li>
<li><p>husage: Husband's age.
</p>
</li>
<li><p>huseduc: Husband's educational attainment, in years.
</p>
</li>
<li><p>huswage: Husband's wage, in 1975 dollars.
</p>
</li>
<li><p>faminc: Family income, in 1975 dollars.
</p>
</li>
<li><p>mtr: Marginal tax rate facing the wife.
</p>
</li>
<li><p>motheduc: Wife's mother's educational attainment, in years.
</p>
</li>
<li><p>fatheduc: Wife's father's educational attainment, in years.
</p>
</li>
<li><p>unem: Unemployment rate in county of residence, in percentage points.
</p>
</li>
<li><p>city: Dummy variable = 1 if live in large city, else 0. 
</p>
</li>
<li><p>exper: Actual years of wife's previous labor market experience.
</p>
</li>
<li><p>nwifeinc: Non-wife income.
</p>
</li>
<li><p>wifecoll: Dummy variable for wife's college attendance.
</p>
</li>
<li><p>huscoll: Dummy variable for husband's college attendance.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>Mroz87
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 753 rows and 22 columns.
</p>


<h3>Source</h3>

<p>PSID Staff, The Panel Study of Income Dynamics,
Institute for Social ResearchPanel Study of Income
Dynamics, University of Michigan, <a href="https://psidonline.isr.umich.edu/">https://psidonline.isr.umich.edu/</a>
</p>


<h3>References</h3>


<p>Thomas
A Mroz (1987).
&ldquo;The sensitivity of an empirical model of married women's hours of work to economic and statistical assumptions.&rdquo;
<em>Econometrica: Journal of the Econometric Society</em>, 765&ndash;799.
</p>
<p>Mikhail Zhelonkin, Marc
G. Genton, Elvezio Ronchetti (2019).
<em>ssmrob: Robust Estimation and Inference in Sample Selection Models</em>.
R package version 0.7, <a href="https://CRAN.R-project.org/package=ssmrob">https://CRAN.R-project.org/package=ssmrob</a>.
</p>
<p>Ott Toomet, Arne Henningsen (2008).
&ldquo;Sample Selection Models in R: Package sampleSelection.&rdquo;
<em>Journal of Statistical Software</em>, <b>27</b>(7).
<a href="https://www.jstatsoft.org/article/view/v027i07">https://www.jstatsoft.org/article/view/v027i07</a>.
</p>
<p>Jeffrey
M Wooldridge (2016).
<em>Introductory econometrics: A modern approach</em>.
Nelson Education.

</p>


<h3>Examples</h3>

<pre><code class='language-R'># Wooldridge(2016): page 247
data(Mroz87)
attach(Mroz87)
selectEq  &lt;- lfp ~ nwifeinc + educ + exper + I(exper^2) + age + kids5 + kids618
outcomeEq &lt;- log(wage) ~ educ + exper + I(exper^2)
outcomeS  &lt;- cbind(educ, exper)
outcomeC  &lt;- cbind(educ, exper)
outcomeBS &lt;- wage ~ educ + exper + I(exper^2)
outcomeBS &lt;- wage ~ educ + exper + I(exper^2)
HeckmanCL(selectEq, outcomeEq, data = Mroz87)
HeckmanBS(selectEq, outcomeBS, data = Mroz87)
HeckmanSK(selectEq, outcomeEq, data = Mroz87, lambda = 1)
HeckmantS(selectEq, outcomeEq, data = Mroz87, df=5)
HeckmanGe(selectEq, outcomeEq, outcomeS, outcomeC, data = Mroz87)

</code></pre>

<hr>
<h2 id='nhanes'>US National Health and Nutrition Examination Study</h2><span id='topic+nhanes'></span>

<h3>Description</h3>

<p>The US National Health and Nutrition Examination Study (NHANES) is a
survey data collected by the US National Center for Health Statistics.
The survey data dates back to 1999, where individuals of all ages are
interviewed in their home annually and complete the health examination
component of the survey. The study variables include demographic
variables (e.g. age and annual household income), physical measurements
(e.g. BMI – body mass index), health variables (e.g. diabetes status),
and lifestyle variables (e.g. smoking status). This data frame contains
the following columns:
</p>

<ul>
<li><p>id: Individual identifier
</p>
</li>
<li><p>age: Age
</p>
</li>
<li><p>gender: Sex 1=male, 0=female
</p>
</li>
<li><p>educ: Education is dichotomized into high school
and above versus less than high school
</p>
</li>
<li><p>race: categorical variable with five levels
</p>
</li>
<li><p>income: Household income ($1000 per year) was reported
as a range of values in dollar (e.g. 0–4999, 5000–9999, etc.)
and had 10 interval categories. 
</p>
</li>
<li><p>Income: Household income ($1000 per year) was reported
as a range of values in dollar (e.g. 0–4999, 5000–9999, etc.)
and had 10 interval categories. 
</p>
</li>
<li><p>bmi: body mass index
</p>
</li>
<li><p>sbp: systolic blood pressure
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>nhanes
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 9643 rows and 9 columns.
</p>


<h3>Source</h3>

<p><a href="https://wwwn.cdc.gov/nchs/nhanes/ContinuousNhanes/Default.aspx?BeginYear=2003">https://wwwn.cdc.gov/nchs/nhanes/ContinuousNhanes/Default.aspx?BeginYear=2003</a>
</p>


<h3>References</h3>


<p>Emmanuel
O Ogundimu, Gary
S Collins (2019).
&ldquo;A robust imputation method for missing responses and covariates in sample selection models.&rdquo;
<em>Statistical methods in medical research</em>, <b>28</b>(1), 102&ndash;116.
</p>
<p>Roderick
J Little, Nanhua Zhang (2011).
&ldquo;Subsample ignorable likelihood for regression analysis with missing data.&rdquo;
<em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, <b>60</b>(4), 591&ndash;605.
</p>
<p>Mikhail Zhelonkin, Marc
G. Genton, Elvezio Ronchetti (2019).
<em>ssmrob: Robust Estimation and Inference in Sample Selection Models</em>.
R package version 0.7, <a href="https://CRAN.R-project.org/package=ssmrob">https://CRAN.R-project.org/package=ssmrob</a>.
</p>
<p>Ott Toomet, Arne Henningsen (2008).
&ldquo;Sample Selection Models in R: Package sampleSelection.&rdquo;
<em>Journal of Statistical Software</em>, <b>27</b>(7).
<a href="https://www.jstatsoft.org/article/view/v027i07">https://www.jstatsoft.org/article/view/v027i07</a>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("nhanes")
attach(nhanes)
hist(Income, prob= TRUE, breaks = seq(1, 99, 0.5), xlim = c(1,10),
ylim = c(0,0.35), main = "Histogram of Income", xlab = "Category")
data2 &lt;- subset(nhanes, !is.na(sbp))
data3 &lt;- subset(data2, !is.na(bmi))
attach(data3)
data &lt;- data3
data$YS &lt;- ifelse(is.na(data$Income),0,1)
data$educ &lt;- ifelse(data$educ&lt;=2,0,1)
attach(data)
selectionEq &lt;- YS~age+gender+educ+race
outcomeEq   &lt;- sbp~age+gender+educ+bmi

</code></pre>

<hr>
<h2 id='PSID2'>Panel Study of Income Dynamics</h2><span id='topic+PSID2'></span>

<h3>Description</h3>

<p>The data come from the Panel Study of Income
Dynamics, years 1981 to 1992 (also contains earnings
data from 1980). The sample consists of 579 white
females, who were followed over the considered period.
In total, there are 6,948 observations over the 12-year
period (1981-1992). This data frame contains the following
columns:
</p>

<ul>
<li><p>id: Individual identifier
</p>
</li>
<li><p>year: Survey year
</p>
</li>
<li><p>age: Calculated age in years (based on year and month of birth)
</p>
</li>
<li><p>educ: Years of schooling
</p>
</li>
<li><p>children: Total number of children in family unit, ages 0-17
</p>
</li>
<li><p>s: Participation dummy, =1 if worked (hours&gt;0)
</p>
</li>
<li><p>lnw: Log of real average hourly earnings
</p>
</li>
<li><p>lnw80: Log earnings in 1980
</p>
</li>
<li><p>agesq: Age squared
</p>
</li>
<li><p>children_lag1: Number of children in t-1
</p>
</li>
<li><p>children_lag2: Number of children in t-2
</p>
</li>
<li><p>lnw2: Log of real average hourly earnings
</p>
</li>
<li><p>Lnw: Log of real average hourly earnings
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>PSID2
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 6948 rows and 13 columns.
</p>


<h3>Source</h3>

<p><a href="http://simba.isr.umich.edu/">http://simba.isr.umich.edu/</a>
</p>


<h3>References</h3>


<p>Anastasia Semykina, Jeffrey
M Wooldridge (2013).
&ldquo;Estimation of dynamic panel data models with sample selection.&rdquo;
<em>Journal of Applied Econometrics</em>, <b>28</b>(1), 47&ndash;61.
</p>
<p>Mikhail Zhelonkin, Marc
G. Genton, Elvezio Ronchetti (2019).
<em>ssmrob: Robust Estimation and Inference in Sample Selection Models</em>.
R package version 0.7, <a href="https://CRAN.R-project.org/package=ssmrob">https://CRAN.R-project.org/package=ssmrob</a>.
</p>
<p>Ott Toomet, Arne Henningsen (2008).
&ldquo;Sample Selection Models in R: Package sampleSelection.&rdquo;
<em>Journal of Statistical Software</em>, <b>27</b>(7).
<a href="https://www.jstatsoft.org/article/view/v027i07">https://www.jstatsoft.org/article/view/v027i07</a>.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PSID2)
attach(PSID2)
hist(Lnw)
selectEq &lt;- s ~ educ+ age+ children+ year
outcomeEq &lt;- Lnw ~ educ+ age+ children
HCinitial(selectEq,outcomeEq, data = PSID2)
#Note that the estimated value of rho by the two-step
#method is greater than 1
summary(HeckmanGe(selectEq,outcomeEq, 1, 1, data = PSID2))

</code></pre>

<hr>
<h2 id='RandHIE'>RAND Health Insurance Experiment</h2><span id='topic+RandHIE'></span>

<h3>Description</h3>

<p>'The RAND Health Insurance Experiment (RAND HIE) was a comprehensive
study of health care cost, utilization and outcome in the United States.
It is the only randomized study of health insurance, and the only study
which can give definitive evidence as to the causal effects of different
health insurance plans. For more information about the database visit:
<a href="https://en.wikipedia.org/w/index.php?title=RAND_Health_Insurance_Experiment&amp;oldid=110166949">https://en.wikipedia.org/w/index.php?title=RAND_Health_Insurance_Experiment&amp;oldid=110166949</a>
accessed september 09, 2019). This data frame contains the following columns:
</p>

<ul>
<li><p>plan: HIE plan number.
</p>
</li>
<li><p>site: Participant's  place of residence
when the participant was initially enrolled.
</p>
</li>
<li><p>coins: Coinsurance rate.
</p>
</li>
<li><p>tookphys: Took baseline physical.
</p>
</li>
<li><p>year: Study year.
</p>
</li>
<li><p>zper: Person identifier.
</p>
</li>
<li><p>black: 1 if race of household head is black.
</p>
</li>
<li><p>income: Family income.
</p>
</li>
<li><p>xage: Age in years.
</p>
</li>
<li><p>female: 1 if person is female.
</p>
</li>
<li><p>educdec: Education of household head in years.
</p>
</li>
<li><p>time: Time eligible during the year.
</p>
</li>
<li><p>outpdol: Outpatient expenses:
all covered outpatient medical services
excluding dental care, outpatient psychotherapy,
outpatient drugs or supplies.
</p>
</li>
<li><p>drugdol: Drug expenses:
all covered outpatient and dental drugs.
</p>
</li>
<li><p>suppdol: Supply expenses:
all covered outpatient supplies including dental.
</p>
</li>
<li><p>mentdol: Psychotherapy expenses:
all covered outpatient psychotherapy services including injections
excluding charges for visits in excess of 52 per year,
prescription drugs, and inpatient care.
</p>
</li>
<li><p>inpdol: Inpatient expenses:
all covered inpatient expenses in a hospital, mental hospital,
or nursing home,
excluding outpatient care and renal dialysis.
</p>
</li>
<li><p>meddol: Medical expenses:
all covered inpatient and outpatient services,
including drugs, supplies, and inpatient costs of newborns
excluding dental care and outpatient psychotherapy.
</p>
</li>
<li><p>totadm: Hospital admissions:
annual number of covered hospitalizations.
</p>
</li>
<li><p>inpmis: Incomplete Hospital Records:
missing inpatient records.
</p>
</li>
<li><p>mentvis: Psychotherapy visits:
indicates the annual number of outpatient visits for psychotherapy.
It includes billed visits only.
The limit was 52 covered visits per person per year.
The count includes an initial visit to a psychiatrist or psychologist.
</p>
</li>
<li><p>mdvis: Face-to-Face visits to physicians:
annual covered outpatient visits with physician providers
(excludes dental, psychotherapy, and
radiology/anesthesiology/pathology-only visits).
</p>
</li>
<li><p>notmdvis: Face-to-Face visits to nonphysicians:
annual covered outpatient visits with nonphysician providers
such as speech and physical therapists, chiropractors,
podiatrists, acupuncturists, Christian Science etc.
(excludes dental, healers, psychotherapy,
and radiology/anesthesiology/pathology-only visits).
</p>
</li>
<li><p>num: Family size.
</p>
</li>
<li><p>mhi: Mental health index.
</p>
</li>
<li><p>disea: Number of chronic diseases.
</p>
</li>
<li><p>physlm: Physical limitations.
</p>
</li>
<li><p>ghindx: General health index.
</p>
</li>
<li><p>mdeoff: Maximum expenditure offer.
</p>
</li>
<li><p>pioff: Participation incentive payment.
</p>
</li>
<li><p>child: 1 if age is less than 18 years.
</p>
</li>
<li><p>fchild: <code>female * child</code>.
</p>
</li>
<li><p>lfam: log of <code>num</code> (family size).
</p>
</li>
<li><p>lpi: log of <code>pioff</code> (participation incentive payment).
</p>
</li>
<li><p>idp: 1 if individual deductible plan.
</p>
</li>
<li><p>logc: <code>log(coins+1)</code>.
</p>
</li>
<li><p>fmde: 0 if <code>idp=1</code>,
<code>ln(max(1,mdeoff/(0.01*coins)))</code> otherwise.
</p>
</li>
<li><p>hlthg: 1 if self-rated health is good
&ndash; baseline is excellent self-rated health.
</p>
</li>
<li><p>hlthf: 1 if self-rated health is fair
&ndash; baseline is excellent self-rated health.
</p>
</li>
<li><p>hlthp: 1 if self-rated health is poor
&ndash; baseline is excellent self-rated health.
</p>
</li>
<li><p>xghindx: <code>ghindx</code> (general healt index)
with imputations of missing values.
</p>
</li>
<li><p>linc: log of <code>income</code> (family income).
</p>
</li>
<li><p>lnum: log of <code>num</code> (family size).
</p>
</li>
<li><p>lnmeddol: log of <code>meddol</code> (medical expenses).
</p>
</li>
<li><p>binexp: 1 if <code>meddol</code> &gt; 0.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>RandHIE
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 20190 rows and 45 columns.
</p>


<h3>Source</h3>

<p><a href="http://cameron.econ.ucdavis.edu/mmabook/mmadata.html">http://cameron.econ.ucdavis.edu/mmabook/mmadata.html</a>
</p>


<h3>References</h3>


<p>A
Colin Cameron, Pravin
K Trivedi (2005).
<em>Microeconometrics: methods and applications</em>.
Cambridge university press.
</p>
<p>Mikhail Zhelonkin, Marc
G. Genton, Elvezio Ronchetti (2019).
<em>ssmrob: Robust Estimation and Inference in Sample Selection Models</em>.
R package version 0.7, <a href="https://CRAN.R-project.org/package=ssmrob">https://CRAN.R-project.org/package=ssmrob</a>.
</p>
<p>Ott Toomet, Arne Henningsen (2008).
&ldquo;Sample Selection Models in R: Package sampleSelection.&rdquo;
<em>Journal of Statistical Software</em>, <b>27</b>(7).
<a href="https://www.jstatsoft.org/article/view/v027i07">https://www.jstatsoft.org/article/view/v027i07</a>.
</p>
<p> Wikipedia contributors (2019).
&ldquo;RAND Health Insurance Experiment &mdash; Wikipedia, The Free Encyclopedia.&rdquo;
<a href="https://en.wikipedia.org/w/index.php?title=RAND_Health_Insurance_Experiment&amp;oldid=909771077">https://en.wikipedia.org/w/index.php?title=RAND_Health_Insurance_Experiment&amp;oldid=909771077</a>.
[Online; accessed 9-September-2019].

</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Cameron and Trivedi (2005): Section 16.6
data(RandHIE)
subsample &lt;- RandHIE$year == 2 &amp; !is.na( RandHIE$educdec )
selectEq &lt;- binexp ~ logc + idp + lpi + fmde + physlm + disea +
  hlthg + hlthf + hlthp + linc + lfam + educdec + xage + female +
  child + fchild + black
  outcomeEq &lt;- lnmeddol ~ logc + idp + lpi + fmde + physlm + disea +
  hlthg + hlthf + hlthp + linc + lfam + educdec + xage + female +
  child + fchild + black
  cameron &lt;- HeckmanCL(selectEq, outcomeEq, data = RandHIE[subsample, ])
  summary(cameron)

</code></pre>

<hr>
<h2 id='ssmodels'>ssmodels: A package for fit the sample selection models.</h2><span id='topic+ssmodels'></span>

<h3>Description</h3>

<p>Package that provides models to fit data with sample selection bias problems. Includes:
</p>

<dl>
<dt>HeckmanCL(selectEq, outcomeEq, data = data, start)</dt><dd><p>Heckman's classic model fit function. Sample selection
usually arises in practice as a result of partial observability of the
result of interest in a study. In the presence of sample selection, the
observed data do not represent a random sample of the population, even
after controlling for explanatory variables. That is, data is missing
randomly. Thus, standard analysis using only complete cases will lead to
biased results. Heckman introduced a sample selection model to analyze
this data and proposed a complete likelihood estimation method under the
assumption of normality. Such model was called Heckman model or Tobit 2
model.</p>
</dd>
<dt>HeckmantS(selectEq, outcomeEq, data = data, df, start)</dt><dd><p>Heckman-t model adjustment function. The Heckman-t model
maintains the original parametric structure of the Classic Heckman model,
but considers a bivariate Student's t distribution as the underlying joint
distribution of the selection and primary regression variable and estimates
the parameters by maximum likelihood.</p>
</dd>
<dt>HeckmanSK(selectEq, outcomeEq, data = data, lambda, start)</dt><dd><p>Heckman-SK model adjustment function. The Heckman-sk
model maintains the original parametric structure of the Classic Heckman
model, but considers a bivariate Skew-Normal distribution as the underlying
joint distribution of the selection and primary regression variable and
estimates the parameters by maximum likelihood.</p>
</dd>
<dt>HeckmanBS(selectEq, outcomeBS, data = data, start)</dt><dd><p>Heckman-BS model adjustment function. The Heckman-BS model
maintains the original parametric structure of the Classic Heckman model,
but considers a bivariate Birnbaum-Saunders distribution as the underlying
joint distribution of the selection and primary regression variable and
estimates the parameters by maximum likelihood.</p>
</dd>
<dt>HeckmanGe(selectEq, outcomeEq,outcomeS, outcomeC, data = data)</dt><dd><p>Function for adjustment of Generalized Heckman model. The
Generalized Heckman Model generalize the Classic Heckman model by adding
covariables to the dispersion and correlation parameters, which allows to
identify the covariates responsible for the presence of selection bias and
the presence of heteroscedasticity.</p>
</dd>
</dl>



<h3>Arguments</h3>

<table>
<tr><td><code id="ssmodels_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_outcomes">outcomeS</code></td>
<td>
<p>Matrix with Covariables for fit of the Dispersion Parameter.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_outcomec">outcomeC</code></td>
<td>
<p>Matrix with Covariates for Adjusting the Correlation Parameter.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_df">df</code></td>
<td>
<p>Initial value to the degree of freedom of Heckman-t model.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_lambda">lambda</code></td>
<td>
<p>Initial value for asymmetry parameter.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_start">start</code></td>
<td>
<p>initial values.</p>
</td></tr>
<tr><td><code id="ssmodels_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Applying any package function returns a list of results
that include estimates of the fit model parameters, hessian matrix,
number of observations, and more. If the initial value is not included
in the function argument, an initial value is estimated from the
Heckman two-step method setting.
</p>


<h3>Author(s)</h3>

<p>Fernando de Souza Bastos, Wagner Barreto de Souza
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HeckmanCL">HeckmanCL</a></code>
</p>
<p><code><a href="#topic+HeckmantS">HeckmantS</a></code>
</p>
<p><code><a href="#topic+HeckmanSK">HeckmanSK</a></code>
</p>
<p><code><a href="#topic+HeckmanBS">HeckmanBS</a></code>
</p>
<p><code><a href="#topic+HeckmanGe">HeckmanGe</a></code>
</p>

<hr>
<h2 id='step2'>Heckman's two-step method</h2><span id='topic+step2'></span>

<h3>Description</h3>

<p>Estimate model parameters via two-step method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step2(YS, XS, YO, XO)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step2_+3A_ys">YS</code></td>
<td>
<p>Selection vector.</p>
</td></tr>
<tr><td><code id="step2_+3A_xs">XS</code></td>
<td>
<p>Selection Matrix.</p>
</td></tr>
<tr><td><code id="step2_+3A_yo">YO</code></td>
<td>
<p>Interest vector.</p>
</td></tr>
<tr><td><code id="step2_+3A_xo">XO</code></td>
<td>
<p>Matrix of the equation of interest.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numerical vector with the parameter estimates of the Classical
Heckman model via a two-step method. For more information see
Heckman (1979)
</p>


<h3>References</h3>


<p>James
J Heckman (1979).
&ldquo;Sample selection bias as a specification error.&rdquo;
<em>Econometrica: Journal of the econometric society</em>, 153&ndash;161.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
YS &lt;- dambexp
XS &lt;- cbind(age, female, educ, blhisp, totchr, ins)
YO &lt;- lnambx
XO &lt;- cbind(age, female, educ, blhisp, totchr, ins, income)
step2(YS, XS, YO, XO)
</code></pre>

<hr>
<h2 id='summary.HeckmanBS'>Summary of Birnbaum-Saunders Heckman Model</h2><span id='topic+summary.HeckmanBS'></span>

<h3>Description</h3>

<p>Summary of Birnbaum-Saunders Heckman Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HeckmanBS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.HeckmanBS_+3A_object">object</code></td>
<td>
<p>HeckmanBS class object.</p>
</td></tr>
<tr><td><code id="summary.HeckmanBS_+3A_...">...</code></td>
<td>
<p>others functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print estimates of the parameters of the Heckman-BS model
</p>

<hr>
<h2 id='summary.HeckmanCL'>Summary of Classic Heckman Model</h2><span id='topic+summary.HeckmanCL'></span>

<h3>Description</h3>

<p>Summary of Classic Heckman Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HeckmanCL'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.HeckmanCL_+3A_object">object</code></td>
<td>
<p>HeckmanCL class object.</p>
</td></tr>
<tr><td><code id="summary.HeckmanCL_+3A_...">...</code></td>
<td>
<p>others functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print estimates of the parameters of the Classic Heckman model
</p>

<hr>
<h2 id='summary.HeckmanGe'>Summary of Generalized Heckman Model</h2><span id='topic+summary.HeckmanGe'></span>

<h3>Description</h3>

<p>Summary of Generalized Heckman Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HeckmanGe'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.HeckmanGe_+3A_object">object</code></td>
<td>
<p>HeckmanGe class object.</p>
</td></tr>
<tr><td><code id="summary.HeckmanGe_+3A_...">...</code></td>
<td>
<p>others functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print estimates of the parameters of the Generalized Heckman model
</p>

<hr>
<h2 id='summary.HeckmanSK'>Summary of Skew-Normal Heckman Model</h2><span id='topic+summary.HeckmanSK'></span>

<h3>Description</h3>

<p>Summary of Skew-Normal Heckman Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HeckmanSK'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.HeckmanSK_+3A_object">object</code></td>
<td>
<p>HeckmanSK class object.</p>
</td></tr>
<tr><td><code id="summary.HeckmanSK_+3A_...">...</code></td>
<td>
<p>others functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print estimates of the parameters of the Heckman-SK model
</p>

<hr>
<h2 id='summary.HeckmantS'>Summary of Heckman-ts Model</h2><span id='topic+summary.HeckmantS'></span>

<h3>Description</h3>

<p>Summary of Heckman-ts Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HeckmantS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.HeckmantS_+3A_object">object</code></td>
<td>
<p>HeckmantS class object.</p>
</td></tr>
<tr><td><code id="summary.HeckmantS_+3A_...">...</code></td>
<td>
<p>others functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print estimates of the parameters of the Heckman-ts model
</p>

<hr>
<h2 id='twostep'>Heckman's two-step method</h2><span id='topic+twostep'></span>

<h3>Description</h3>

<p>Estimate model parameters via two-step method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twostep(selection, outcome, data = sys.frame(sys.parent()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twostep_+3A_selection">selection</code></td>
<td>
<p>Selection equation.</p>
</td></tr>
<tr><td><code id="twostep_+3A_outcome">outcome</code></td>
<td>
<p>Primary Regression Equation.</p>
</td></tr>
<tr><td><code id="twostep_+3A_data">data</code></td>
<td>
<p>Database.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numerical vector with the parameter estimates of the Classical
Heckman model via a two-step method. For more information see
Heckman (1979)
</p>


<h3>References</h3>


<p>James
J Heckman (1979).
&ldquo;Sample selection bias as a specification error.&rdquo;
<em>Econometrica: Journal of the econometric society</em>, 153&ndash;161.

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MEPS2001)
attach(MEPS2001)
selectEq &lt;- dambexp ~ age + female + educ + blhisp + totchr + ins + income
outcomeEq &lt;- lnambx ~ age + female + educ + blhisp + totchr + ins
twostep(selectEq, outcomeEq)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
