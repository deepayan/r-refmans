<!DOCTYPE html><html lang="en"><head><title>Help for package eba</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eba}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#balanced.pcdesign'><p>Balanced Paired-Comparison Design</p></a></li>
<li><a href='#boot'><p>Bootstrap for Elimination-by-Aspects (EBA) Models</p></a></li>
<li><a href='#celebrities'><p>Choice among Celebrities</p></a></li>
<li><a href='#circular'><p>Circular Triads (Intransitive Cycles)</p></a></li>
<li><a href='#cov.u'><p>Covariance Matrix of the EBA Utility Scale</p></a></li>
<li><a href='#drugrisk'><p>Perceived Health Risk of Drugs</p></a></li>
<li><a href='#eba'><p>Elimination-by-Aspects (EBA) Models</p></a></li>
<li><a href='#eba.order'><p>Elimination-by-Aspects (EBA) Models with Order-Effect</p></a></li>
<li><a href='#envirosound'><p>Auditory Unpleasantness of Environmental Sound</p></a></li>
<li><a href='#group.test'><p>Group Effects in Elimination-by-Aspects (EBA) Models</p></a></li>
<li><a href='#heaviness'><p>Weights Judging Data</p></a></li>
<li><a href='#inclusion.rule'><p>Inclusion Rule</p></a></li>
<li><a href='#kendall.u'><p>Kendall's Coefficient of Agreement</p></a></li>
<li><a href='#linear2btl'><p>Linear Coefficients to Bradley-Terry-Luce (BTL) Estimates</p></a></li>
<li><a href='#logLik.eba'><p>Log-Likelihood of an eba Object</p></a></li>
<li><a href='#mbt'><p>Mallows-Bradley-Terry Model</p></a></li>
<li><a href='#pcX'><p>Paired-Comparison Design Matrix</p></a></li>
<li><a href='#plot.eba'><p>Diagnostic Plot for EBA Models</p></a></li>
<li><a href='#pork'><p>Pork Tasting Data</p></a></li>
<li><a href='#residuals.eba'><p>Residuals for EBA Models</p></a></li>
<li><a href='#schoolsubjects'><p>Preference for School Subjects</p></a></li>
<li><a href='#simulate.eba'><p>Simulate Responses from EBA Models</p></a></li>
<li><a href='#soundquality'><p>Quality of Multichannel Reproduced Sound</p></a></li>
<li><a href='#strans'><p>Stochastic Transitivity</p></a></li>
<li><a href='#tartness'><p>Tartness Rankings of Salad Dressings</p></a></li>
<li><a href='#thurstone'><p>Thurstone-Mosteller Model (Case V)</p></a></li>
<li><a href='#trineq'><p>Trinary Inequality</p></a></li>
<li><a href='#uscale'><p>Utility Scale of an EBA Choice Model</p></a></li>
<li><a href='#wald.test'><p>Testing Linear Hypotheses in Elimination-by-Aspects (EBA) Models</p></a></li>
<li><a href='#winetaste'><p>Wine Tasting Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.10-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-11-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Elimination-by-Aspects Models</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), stats, graphics</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, psychotools</td>
</tr>
<tr>
<td>Description:</td>
<td>Fitting and testing multi-attribute probabilistic choice
  models, especially the Bradley-Terry-Luce (BTL) model (Bradley &amp;
  Terry, 1952 &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F39.3-4.324">doi:10.1093/biomet/39.3-4.324</a>&gt;; Luce, 1959),
  elimination-by-aspects (EBA) models (Tversky, 1972 &lt;<a href="https://doi.org/10.1037%2Fh0032955">doi:10.1037/h0032955</a>&gt;),
  and preference tree (Pretree) models (Tversky &amp; Sattath, 1979
  &lt;<a href="https://doi.org/10.1037%2F0033-295X.86.6.542">doi:10.1037/0033-295X.86.6.542</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.mathpsy.uni-tuebingen.de/wickelmaier">http://www.mathpsy.uni-tuebingen.de/wickelmaier</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-20 12:38:03 UTC; siifw01</td>
</tr>
<tr>
<td>Author:</td>
<td>Florian Wickelmaier [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Florian Wickelmaier &lt;wickelmaier@web.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-20 23:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='balanced.pcdesign'>Balanced Paired-Comparison Design</h2><span id='topic+balanced.pcdesign'></span>

<h3>Description</h3>

<p>Creates a (completely) balanced paired-comparison design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>balanced.pcdesign(nstimuli)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="balanced.pcdesign_+3A_nstimuli">nstimuli</code></td>
<td>
<p>number of stimuli in the paired-comparison design</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>nstimuli</code> is odd, the presentation order is completely balanced,
that is any given stimulus appears an equal number of times as the first
and second member of a pair. When <code>nstimuli</code> is even, the presentation
order is balanced as much as possible.  Subjects should be equally assigned
to <code>listA</code> and <code>listB</code> for the purpose of balancing the
within-pair presentation order across a sample of subjects.  Pairs should be
re-randomized for each subject.  See David (1988) for details.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>pairs</code></td>
<td>
<p>a character array holding the balanced pairs</p>
</td></tr>
<tr><td><code>listA</code></td>
<td>
<p>the vector pairs in the original within-pair order</p>
</td></tr>
<tr><td><code>listB</code></td>
<td>
<p>the vector of pairs in the inverted within-pair order</p>
</td></tr>
</table>


<h3>References</h3>

<p>David, H. (1988). <em>The method of paired comparisons</em>. 
London: Griffin.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcX">pcX</a></code>, <code><a href="#topic+eba">eba</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Create balanced design for 6 stimuli
bp &lt;- balanced.pcdesign(6)

## Replicate each within-pair order 10 times and re-randomize
cbind(replicate(10, sample(bp$listA)), replicate(10, sample(bp$listB)))
</code></pre>

<hr>
<h2 id='boot'>Bootstrap for Elimination-by-Aspects (EBA) Models</h2><span id='topic+boot'></span><span id='topic+eba.boot'></span><span id='topic+eba.boot.constrained'></span>

<h3>Description</h3>

<p>Performs a bootstrap by resampling the individual data matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot(D, R = 100, A = 1:I, s = rep(1/J, J), constrained = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot_+3A_d">D</code></td>
<td>
<p>either a 3d array consisting of the individual paired
comparison matrices or an object of class <code>paircomp</code></p>
</td></tr>
<tr><td><code id="boot_+3A_r">R</code></td>
<td>
<p>the number of bootstrap samples</p>
</td></tr>
<tr><td><code id="boot_+3A_a">A</code></td>
<td>
<p>a list of vectors consisting of the stimulus aspects;
the default is <code>1:I</code>, where <code>I</code> is the number of stimuli</p>
</td></tr>
<tr><td><code id="boot_+3A_s">s</code></td>
<td>
<p>the starting vector with default <code>1/J</code> for all parameters,
where <code>J</code> is the number of parameters</p>
</td></tr>
<tr><td><code id="boot_+3A_constrained">constrained</code></td>
<td>
<p>logical, if TRUE (default), parameters are constrained
to be positive</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap functions <code>eba.boot.constrained</code> and <code>eba.boot</code>
are automatically called by <code>boot</code>.
</p>
<p>The code is experimental and may change in the future.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>p</code></td>
<td>
<p>the matrix of bootstrap vectors</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>the matrix of bootstrap statistics, including parameter
means, standard errors, and confidence limits</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+simulate.eba">simulate.eba</a></code>, <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pork)  # pork tasting data, 10 individual paired comparison matrices
btl1 &lt;- eba(apply(pork, 1:2, sum))  # fit Bradley-Terry-Luce model
b &lt;- boot(pork, R = 200)            # resample 200 times

plot(coef(btl1), b$stat[, "mean"], log = "xy")
abline(0, 1, lty = 2)
</code></pre>

<hr>
<h2 id='celebrities'>Choice among Celebrities</h2><span id='topic+celebrities'></span>

<h3>Description</h3>

<p>Rumelhart and Greeno (1971) presented 234 participants with pairs of names
of nine celebrities: the politicians L. B. Johnson (LBJ), Harold Wilson
(HW), and Charles De Gaulle (CDG); the athletes Johnny Unitas (JU), Carl
Yastrzemski (CY), and A. J. Foyt (AJF); the actresses Brigitte Bardot (BB),
Elizabeth Taylor (ET), and Sophia Loren (SL).  Participants were instructed
to choose the person with whom they would rather spend an hour of
discussion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(celebrities)</code></pre>


<h3>Format</h3>

<p>A square data frame containing the absolute choice frequencies and a
diagonal of zeros; row stimuli are chosen over column stimuli.</p>


<h3>Source</h3>

<p>Rumelhart, D.L., &amp; Greeno, J.G. (1971).
Similarity between stimuli: An experimental test of the
Luce and Restle choice models.
<em>Journal of Mathematical Psychology</em>, <b>8</b>, 370&ndash;381.
doi: <a href="https://doi.org/10.1016/0022-2496(71)90038-1">10.1016/0022-2496(71)90038-1</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)
celebrities["LBJ", "HW"]  # 159 participants chose Johnson over Wilson
</code></pre>

<hr>
<h2 id='circular'>Circular Triads (Intransitive Cycles)</h2><span id='topic+circular'></span><span id='topic+print.circular'></span>

<h3>Description</h3>

<p>Number of circular triads and coefficient of consistency.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circular(mat, alternative = c("two.sided", "less", "greater"),
         exact = NULL, correct = TRUE, simulate.p.value = FALSE,
         nsim = 2000)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="circular_+3A_mat">mat</code></td>
<td>
<p>a square matrix or a data frame consisting of (individual)
binary choice data; row stimuli are chosen over column stimuli</p>
</td></tr>
<tr><td><code id="circular_+3A_alternative">alternative</code></td>
<td>
<p>a character string specifying the alternative hypothesis,
must be one of <code>"two.sided"</code> (default), <code>"less"</code> or
<code>"greater"</code></p>
</td></tr>
<tr><td><code id="circular_+3A_exact">exact</code></td>
<td>
<p>a logical indicating whether an exact p-value should be
computed</p>
</td></tr>
<tr><td><code id="circular_+3A_correct">correct</code></td>
<td>
<p>a logical indicating whether to apply continuity correction
in the chi-square approximation for the p-value</p>
</td></tr>
<tr><td><code id="circular_+3A_simulate.p.value">simulate.p.value</code></td>
<td>
<p>a logical indicating whether to compute p-values by
Monte Carlo simulation</p>
</td></tr>
<tr><td><code id="circular_+3A_nsim">nsim</code></td>
<td>
<p>an integer specifying the number of replicates used in the Monte
Carlo test</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kendall's coefficient of consistency,
</p>
<p style="text-align: center;"><code class="reqn">zeta = 1 - T/T_{max},</code>
</p>

<p>lies between one (perfect consistency) and zero,
where <code>T</code> is the observed number of circular triads,
and the maximum possible number of circular triads is
<code class="reqn">T_{max} = n(n^2 - 4)/24</code>, if <code class="reqn">n</code> is even, and
<code class="reqn">T_{max} = n(n^2 - 1)/24</code> else, and <code class="reqn">n</code> is the
number of stimuli or objects being judged. For details see Kendall and
Babington Smith (1940) and David (1988).
</p>
<p>Kendall (1962) discusses a test of the hypothesis that the number of
circular triads <code>T</code> is different (smaller or greater) than expected
when choosing randomly. For small <code class="reqn">n</code>, an exact p-value is computed,
based on the exact distributions listed in Alway (1962) and in Kendall
(1962).  Otherwise, an approximate chi-square test is computed.  In this
test, the sampling distribution is measured from lower to higher values of
<code>T</code>, so that the probability that <code>T</code> will be exceeded is the
complement of the probability for <code>chi2</code>.  The chi-square approximation
may be incorrect if <code class="reqn">n &lt; 8</code> and is only available for <code class="reqn">n &gt; 4</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>T</code></td>
<td>
<p>number of circular triads</p>
</td></tr>
<tr><td><code>T.max</code></td>
<td>
<p>maximum possible number of circular triads</p>
</td></tr>
<tr><td><code>T.exp</code></td>
<td>
<p>expected number of circular triads <code class="reqn">E(T)</code> when choices are
totally random</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>
<p>Kendall's coefficient of consistency</p>
</td></tr>
<tr><td><code>chi2</code>, <code>df</code>, <code>correct</code></td>
<td>
<p>the chi-square statistic and degrees of freedom for
the approximate test, and whether continuity correction has been applied</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test (see Details)</p>
</td></tr>
<tr><td><code>simulate.p.value</code>, <code>nsim</code></td>
<td>
<p>whether the p-value is based on simulations,
number of simulation runs</p>
</td></tr>
</table>


<h3>References</h3>

<p>Alway, G.G. (1962).
The distribution of the number of circular triads in paired comparisons.
<em>Biometrika</em>, <b>49</b>, 265&ndash;269.
doi: <a href="https://doi.org/10.1093/biomet/49.1-2.265">10.1093/biomet/49.1-2.265</a>
</p>
<p>David, H. (1988).
<em>The method of paired comparisons</em>. 
London: Griffin.
</p>
<p>Kendall, M.G. (1962).
<em>Rank correlation methods</em>.
London: Griffin.
</p>
<p>Kendall, M.G., &amp; Babington Smith, B. (1940).
On the method of paired comparisons. 
<em>Biometrika</em>, <b>31</b>, 324&ndash;345.
doi: <a href="https://doi.org/10.1093/biomet/31.3-4.324">10.1093/biomet/31.3-4.324</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+strans">strans</a></code>, <code><a href="#topic+kendall.u">kendall.u</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A dog's preferences for six samples of food
# (Kendall and Babington Smith, 1940, p. 326)
dog &lt;- matrix(c(0, 1, 1, 0, 1, 1,
                0, 0, 0, 1, 1, 0,
                0, 1, 0, 1, 1, 1,
                1, 0, 0, 0, 0, 0,
                0, 0, 0, 1, 0, 1,
                0, 1, 0, 1, 0, 0), 6, 6, byrow=TRUE)
dimnames(dog) &lt;- setNames(rep(list(c("meat", "biscuit", "chocolate",
                                     "apple", "pear", "cheese")), 2),
                          c("&gt;", "&lt;"))
circular(dog, alternative="less")  # moderate consistency
subset(strans(dog)$violdf, !wst)   # list circular triads
</code></pre>

<hr>
<h2 id='cov.u'>Covariance Matrix of the EBA Utility Scale</h2><span id='topic+cov.u'></span>

<h3>Description</h3>

<p>Computes the (normalized) covariance matrix of the utility scale from the
covariance matrix of elimination-by-aspects (EBA) model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov.u(object, norm = "sum")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cov.u_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="cov.u_+3A_norm">norm</code></td>
<td>
<p>either <code>sum</code> (default), a number from 1 to number of
stimuli, or <code>NULL</code>; see <code><a href="#topic+uscale">uscale</a></code> for details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The additivity rule for covariances
<code class="reqn">cov(x + y, z) = cov(x, z) + cov(y, z)</code> is used for the computations.
</p>
<p>If <code>norm</code> is not <code>NULL</code>, the unnormalized covariance matrix is
transformed using <code class="reqn">a^2 cov(u)</code>, where the constant <code class="reqn">a</code> results from
the type of normalization applied.
</p>


<h3>Value</h3>

<p>The (normalized) covariance matrix of the utility scale.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+uscale">uscale</a></code>, <code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+wald.test">wald.test</a></code>.
</p>

<hr>
<h2 id='drugrisk'>Perceived Health Risk of Drugs</h2><span id='topic+drugrisk'></span>

<h3>Description</h3>

<p>In summer 2007, a survey was conducted at the Department of Psychology,
University of Tuebingen.  Hundred and ninety-two participants were presented
with all 15 unordered pairs of the names of six drugs or substances and
asked to choose the drug they judged as more dangerous for their health.
The six drugs were alcohol (alc), tobacco (tob), cannabis (can), ecstasy
(ecs), heroine (her), and cocaine (coc).  Choice frequencies were aggregated
in four groups defined by gender and age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(drugrisk)</code></pre>


<h3>Format</h3>

<p>A 3d array consisting of four square matrices of choice
frequencies (row drugs are judged over column drugs):
</p>

<dl>
<dt><code>drugrisk[, , group = "female30"]</code></dt><dd><p>holds the choices
of the 48 female participants up to 30 years of age.</p>
</dd>
<dt><code>drugrisk[, , group = "female31"]</code></dt><dd><p>holds the choices
of the 48 female participants from 31 years of age.</p>
</dd>
<dt><code>drugrisk[, , group = "male30"]</code></dt><dd><p>holds the choices
of the 48 male participants up to 30 years of age.</p>
</dd>
<dt><code>drugrisk[, , group = "male31"]</code></dt><dd><p>holds the choices
of the 48 male participants from 31 years of age.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wickelmaier, F. (2008).
Analyzing paired-comparison data in R using probabilistic choice
models. Presented at the <em>R User Conference 2008</em>,
August 12-14, Dortmund, Germany. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugrisk)

## Bradley-Terry-Luce (BTL) model
btl &lt;- eba(drugrisk[, , group = "male30"])

## Elimination-by-aspects (EBA) model, 1 additional aspect
A1 &lt;- list(c(1), c(2,7), c(3,7), c(4,7), c(5,7), c (6,7))
eba1 &lt;- eba(drugrisk[, , group = "male30"], A1)

## EBA model, 2 additional aspects
A2 &lt;- list(c(1), c(2,7), c(3,7), c(4,7,8), c(5,7,8), c(6,7,8))
eba2 &lt;- eba(drugrisk[, , group = "male30"], A2)

## Model selection
anova(btl, eba1, eba2)

## Utility scale values (BTL for females, EBA for males)
dotchart(cbind(
  apply(drugrisk[, , 1:2], 3, function(x) uscale(eba(x),     norm = 1)),
  apply(drugrisk[, , 3:4], 3, function(x) uscale(eba(x, A2), norm = 1))
  ), xlab="Utility scale value (BTL and EBA models)",
     main="Perceived health risk of drugs",
  panel.first = abline(v = 1, col = "gray"), log = "x")
mtext("(Wickelmaier, 2008)", line = 0.5)
</code></pre>

<hr>
<h2 id='eba'>Elimination-by-Aspects (EBA) Models</h2><span id='topic+OptiPt'></span><span id='topic+eba'></span><span id='topic+summary.eba'></span><span id='topic+anova.eba'></span><span id='topic+vcov.eba'></span><span id='topic+print.summary.eba'></span><span id='topic+print.eba'></span><span id='topic+L'></span><span id='topic+L.constrained'></span><span id='topic+deviance.eba'></span>

<h3>Description</h3>

<p>Fits a (multi-attribute) probabilistic choice model by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eba(M, A = 1:I, s = rep(1/J, J), constrained = TRUE)

OptiPt(M, A = 1:I, s = rep(1/J, J), constrained = TRUE)

## S3 method for class 'eba'
summary(object, ...)

## S3 method for class 'eba'
anova(object, ..., test = c("Chisq", "none"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eba_+3A_m">M</code></td>
<td>
<p>a square matrix or a data frame consisting of absolute choice
frequencies; row stimuli are chosen over column stimuli</p>
</td></tr>
<tr><td><code id="eba_+3A_a">A</code></td>
<td>
<p>a list of vectors consisting of the stimulus aspects;
the default is <code>1:I</code>, where <code>I</code> is the number of stimuli</p>
</td></tr>
<tr><td><code id="eba_+3A_s">s</code></td>
<td>
<p>the starting vector with default <code>1/J</code> for all parameters,
where <code>J</code> is the number of parameters</p>
</td></tr>
<tr><td><code id="eba_+3A_constrained">constrained</code></td>
<td>
<p>logical, if TRUE (default), parameters are constrained
to be positive</p>
</td></tr>
<tr><td><code id="eba_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="eba_+3A_test">test</code></td>
<td>
<p>should the p-values of the chi-square distributions be
reported?</p>
</td></tr>
<tr><td><code id="eba_+3A_...">...</code></td>
<td>
<p>additional arguments; none are used in the summary method;
in the anova method they refer to additional objects of class <code>eba</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>eba</code> is a wrapper function for <code>OptiPt</code>.  Both functions can be
used interchangeably.  See Wickelmaier and Schmid (2004) for further
details.
</p>
<p>The probabilistic choice models that can be fitted to paired-comparison
data are the Bradley-Terry-Luce (BTL) model (Bradley, 1984; Luce, 1959),
preference tree (Pretree) models (Tversky and Sattath, 1979), and
elimination-by-aspects (EBA) models (Tversky, 1972), the former being
special cases of the latter.
</p>
<p><code>A</code> represents the family of aspect sets.  It is usually a list of
vectors, the first element of each being a number from 1 to <code>I</code>;
additional elements specify the aspects shared by several stimuli.  <code>A</code>
must have as many elements as there are stimuli.  When fitting a BTL model,
<code>A</code> reduces to <code>1:I</code> (the default), i.e. there is only one aspect
per stimulus.
</p>
<p>The maximum likelihood estimation of the parameters is carried out by
<code>nlm</code>.  The Hessian matrix, however, is approximated by
<code>nlme::fdHess</code>.  The likelihood functions <code>L.constrained</code> and
<code>L</code> are called automatically.
</p>
<p>See <code><a href="#topic+group.test">group.test</a></code> for details on the likelihood ratio
tests reported by <code>summary.eba</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a vector of parameter estimates</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>same as <code>coefficients</code></p>
</td></tr>
<tr><td><code>logL.eba</code></td>
<td>
<p>the log-likelihood of the fitted model</p>
</td></tr>
<tr><td><code>logL.sat</code></td>
<td>
<p>the log-likelihood of the saturated (binomial) model</p>
</td></tr>
<tr><td><code>goodness.of.fit</code></td>
<td>
<p>the goodness of fit statistic including the
likelihood ratio fitted vs. saturated model (-2logL), the degrees of
freedom, and the p-value of the corresponding chi-square distribution</p>
</td></tr>
<tr><td><code>u.scale</code></td>
<td>
<p>the unnormalized utility scale of the stimuli; each utility
scale value is defined as the sum of aspect values (parameters) that
characterize a given stimulus</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the Hessian matrix of the likelihood function</p>
</td></tr>
<tr><td><code>cov.p</code></td>
<td>
<p>the covariance matrix of the model parameters</p>
</td></tr>
<tr><td><code>chi.alt</code></td>
<td>
<p>the Pearson chi-square goodness of fit statistic</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>the fitted paired-comparison matrix</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>the data vector of the upper triangle matrix</p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p>the data vector of the lower triangle matrix</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations per pair (<code>y1 + y0</code>)</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the predicted choice probabilities for the upper triangle</p>
</td></tr>
<tr><td><code>nobs</code></td>
<td>
<p>the number of pairs</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florian Wickelmaier</p>


<h3>References</h3>

<p>Bradley, R.A. (1984).
Paired comparisons: Some basic procedures and examples.
In P.R. Krishnaiah &amp; P.K. Sen (eds.),
<em>Handbook of Statistics, Volume 4</em>.
Amsterdam: Elsevier.
doi: <a href="https://doi.org/10.1016/S0169-7161(84)04016-5">10.1016/S0169-7161(84)04016-5</a>
</p>
<p>Luce, R.D. (1959).
<em>Individual choice behavior: A theoretical analysis</em>.
New York: Wiley.
</p>
<p>Tversky, A. (1972).
Elimination by aspects: A theory of choice.
<em>Psychological Review</em>, <b>79</b>, 281&ndash;299.
doi: <a href="https://doi.org/10.1037/h0032955">10.1037/h0032955</a>
</p>
<p>Tversky, A., &amp; Sattath, S. (1979).
Preference trees.
<em>Psychological Review</em>, <b>86</b>, 542&ndash;573.
doi: <a href="https://doi.org/10.1037/0033-295X.86.6.542">10.1037/0033-295X.86.6.542</a>
</p>
<p>Wickelmaier, F., &amp; Schmid, C. (2004).
A Matlab function to estimate choice model parameters from paired-comparison
data.
<em>Behavior Research Methods, Instruments, and Computers</em>,
<b>36</b>, 29&ndash;40.
doi: <a href="https://doi.org/10.3758/BF03195547">10.3758/BF03195547</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+strans">strans</a></code>, <code><a href="#topic+uscale">uscale</a></code>, <code><a href="#topic+cov.u">cov.u</a></code>,
<code><a href="#topic+group.test">group.test</a></code>, <code><a href="#topic+wald.test">wald.test</a></code>, <code><a href="#topic+plot.eba">plot.eba</a></code>,
<code><a href="#topic+residuals.eba">residuals.eba</a></code>, <code><a href="#topic+logLik.eba">logLik.eba</a></code>,
<code><a href="#topic+simulate.eba">simulate.eba</a></code>,
<code><a href="#topic+kendall.u">kendall.u</a></code>, <code><a href="#topic+circular">circular</a></code>, <code><a href="#topic+trineq">trineq</a></code>,
<code><a href="#topic+thurstone">thurstone</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)                     # absolute choice frequencies
btl1 &lt;- eba(celebrities)              # fit Bradley-Terry-Luce model
A &lt;- list(c(1,10), c(2,10), c(3,10),
          c(4,11), c(5,11), c(6,11),
          c(7,12), c(8,12), c(9,12))  # the structure of aspects
eba1 &lt;- eba(celebrities, A)           # fit elimination-by-aspects model

summary(eba1)                         # goodness of fit
plot(eba1)                            # residuals versus predicted values
anova(btl1, eba1)                     # model comparison based on likelihoods
confint(eba1)                         # confidence intervals for parameters
uscale(eba1)                          # utility scale

ci &lt;- 1.96 * sqrt(diag(cov.u(eba1)))      # 95% CI for utility scale values
dotchart(uscale(eba1), xlim=c(0, .3), main="Choice among celebrities",
         xlab="Utility scale value (EBA model)", pch=16)    # plot the scale
arrows(uscale(eba1)-ci, 1:9, uscale(eba1)+ci, 1:9, .05, 90, 3)  # error bars
abline(v=1/9, lty=2)                      # indifference line
mtext("(Rumelhart and Greeno, 1971)", line=.5)

## See data(package = "eba") for application examples.
</code></pre>

<hr>
<h2 id='eba.order'>Elimination-by-Aspects (EBA) Models with Order-Effect</h2><span id='topic+eba.order'></span><span id='topic+summary.eba.order'></span><span id='topic+anova.eba.order'></span><span id='topic+vcov.eba.order'></span><span id='topic+print.eba.order'></span><span id='topic+print.summary.eba.order'></span><span id='topic+L.order'></span><span id='topic+L.constrained.order'></span><span id='topic+logLik.eba.order'></span><span id='topic+plot.eba.order'></span><span id='topic+residuals.eba.order'></span><span id='topic+deviance.eba.order'></span>

<h3>Description</h3>

<p>Fits a (multi-attribute) probabilistic choice model that
accounts for the effect of the presentation order within a pair.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eba.order(M1, M2 = NULL, A = 1:I, s = c(rep(1/J, J), 1),
          constrained = TRUE)

## S3 method for class 'eba.order'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eba.order_+3A_m1">M1</code>, <code id="eba.order_+3A_m2">M2</code></td>
<td>
<p>two square matrices or data frames consisting of absolute
choice frequencies in both within-pair orders; row stimuli are chosen
over column stimuli. If M2 is empty (default), M1 is assumed to be a
3d array containing both orders</p>
</td></tr>
<tr><td><code id="eba.order_+3A_a">A</code></td>
<td>
<p>see <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="eba.order_+3A_s">s</code></td>
<td>
<p>the starting vector with default <code>1/J</code> for all <code>J</code>
aspect parameters, and <code>1</code> for the order effect</p>
</td></tr>
<tr><td><code id="eba.order_+3A_constrained">constrained</code></td>
<td>
<p>see <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="eba.order_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba.order</code>, typically the result
of a call to <code><a href="#topic+eba.order">eba.order</a></code></p>
</td></tr>
<tr><td><code id="eba.order_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice models include a single multiplicative order effect,
<code>order</code>, that is constant for all pairs (see Davidson and Beaver,
1977). An order effect &lt; 1 (&gt; 1) indicates a bias in favor of the first
(second) interval.  See <code><a href="#topic+eba">eba</a></code> for choice models without order
effect.
</p>
<p>Several likelihood ratio tests are performed (see also
<code><a href="#topic+summary.eba">summary.eba</a></code>).
</p>
<p><code>EBA.order</code> tests an order-effect EBA model against a saturated
binomial model; this corresponds to a goodness of fit test of the former
model.
</p>
<p><code>Order</code> tests an EBA model with an order effect constrained to 1
against an unconstrained order-effect EBA model; this corresponds to a test
of the order effect.
</p>
<p><code>Effect</code> tests an order-effect indifference model (where all scale
values are equal, but the order effect is free) against the order-effect EBA
model; this corresponds to testing for a stimulus effect; <code>order0</code> is
the estimate of the former model.
</p>
<p>Wickelmaier and Choisel (2006) describe a model that generalizes the
Davidson-Beaver model and allows for an order effect in Pretree and EBA
models.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a vector of parameter estimates, the last component
holds the order-effect estimate</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>same as <code>coefficients</code></p>
</td></tr>
<tr><td><code>logL.eba</code></td>
<td>
<p>the log-likelihood of the fitted model</p>
</td></tr>
<tr><td><code>logL.sat</code></td>
<td>
<p>the log-likelihood of the saturated (binomial) model</p>
</td></tr>
<tr><td><code>goodness.of.fit</code></td>
<td>
<p>the goodness of fit statistic including the
likelihood ratio fitted vs. saturated model (-2logL), the degrees of
freedom, and the p-value of the corresponding chi-square distribution</p>
</td></tr>
<tr><td><code>u.scale</code></td>
<td>
<p>the unnormalized utility scale of the stimuli; each utility
scale value is defined as the sum of aspect values (parameters) that
characterize a given stimulus</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>the Hessian matrix of the likelihood function</p>
</td></tr>
<tr><td><code>cov.p</code></td>
<td>
<p>the covariance matrix of the model parameters</p>
</td></tr>
<tr><td><code>chi.alt</code></td>
<td>
<p>the Pearson chi-square goodness of fit statistic</p>
</td></tr>
<tr><td><code>fitted</code></td>
<td>
<p>3d array of the fitted paired-comparison matrices</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>the data vector of the upper triangle matrices</p>
</td></tr>
<tr><td><code>y0</code></td>
<td>
<p>the data vector of the lower triangle matrices</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations per pair (<code>y1 + y0</code>)</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the predicted choice probabilities for the upper triangles</p>
</td></tr>
<tr><td><code>M1</code>, <code>M2</code></td>
<td>
<p>the data matrices</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florian Wickelmaier</p>


<h3>References</h3>

<p>Davidson, R.R., &amp; Beaver, R.J. (1977).
On extending the Bradley-Terry model to incorporate within-pair order
effects.
<em>Biometrics</em>, <b>33</b>, 693&ndash;702.
</p>
<p>Wickelmaier, F., &amp; Choisel, S. (2006).
Modeling within-pair order effects in paired-comparison judgments.
In D.E. Kornbrot, R.M. Msetfi, &amp; A.W. MacRae (eds.),
<em>Fechner Day 2006. Proceedings of the 22nd Annual Meeting of
the International Society for Psychophysics</em> (p. 89&ndash;94).
St. Albans, UK: The ISP.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+group.test">group.test</a></code>, <code><a href="#topic+plot.eba">plot.eba</a></code>,
<code><a href="#topic+residuals.eba">residuals.eba</a></code>, <code><a href="#topic+logLik.eba">logLik.eba</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heaviness)                # weights judging data
ebao1 &lt;- eba.order(heaviness)  # Davidson-Beaver model
summary(ebao1)                 # goodness of fit
plot(ebao1)                    # residuals versus predicted values
confint(ebao1)                 # confidence intervals for parameters
</code></pre>

<hr>
<h2 id='envirosound'>Auditory Unpleasantness of Environmental Sound</h2><span id='topic+envirosound'></span>

<h3>Description</h3>

<p>Zimmer et al. (2004) investigated the auditory unpleasantness of
twelve short binaural recordings (Johannsen and Prante, 2001); recordings
were presented via headphones to 74 participants.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(envirosound)</code></pre>


<h3>Format</h3>

<p>A data frame containing 74 observations on 2 variables:
</p>

<dl>
<dt>unpleasantness</dt><dd><p>paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>;
judgments for all 66 paired comparisons from 12 recordings:
circular saw, stadium, dentist's drill, waterfall, ship's horn, stone in
well, typewriter, hooves, fan, howling wind, tyre on gravel, wasp.</p>
</dd>
<dt>rt</dt><dd><p>median response time.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Details of the recordings, including psychoacoustic metrics, are available
as an attribute of the <code>unpleasantness</code> variable (see Examples).
</p>


<h3>Source</h3>

<p>Zimmer, K., Ellermeier, W., &amp; Schmid, C. (2004).
Using probabilistic choice models to investigate auditory unpleasantness.
<em>Acta Acustica united with Acustica</em>, <b>90</b>(6), 1019&ndash;1028.
</p>


<h3>References</h3>

<p>Johannsen, K., &amp; Prante, H.U. (2001).
Environmental sounds for psychoacoustic testing.
<em>Acta Acustica united with Acustica</em>, <b>87</b>(2), 290&ndash;293.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+strans">strans</a></code>, <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>requireNamespace("psychotools")
data(envirosound)
set.seed(1019)

## Choice-model representation of unpleasantness
mat &lt;- summary(envirosound$unpleasantness, pcmatrix = TRUE)
strans(mat)
btl1 &lt;- eba(mat)
eba1 &lt;- eba(mat, A = list(c(1, 13), c(2, 13), c(3, 13), c(4, 13),
                          c(5, 13), c(6, 13), c(7, 13), c(8, 13),
                          c(9, 13), c(10, 13), c(11, 13), 12))
eba2 &lt;- eba(mat, A = list(c(1, 13), c(2, 13), c(3, 13), c(4, 13),
                          c(5, 13), c(6, 13), c(7, 13, 14), c(8, 13, 14),
                          c(9, 13, 14), c(10, 13, 14), c(11, 13, 14), 12),
            s = runif(14))
anova(btl1, eba1, eba2)

sounds &lt;- psychotools::covariates(envirosound$unpleasantness)
sounds$u &lt;- 10 * uscale(eba2, norm = 9)  # u(fan) := 10

plot(magnitude ~ u, sounds, log = "x", type = "n",
     xlab = "Indirect scaling (EBA model)",
     ylab = "Direct magnitude estimation",
     main = "Auditory unpleasantness of environmental sound")
mtext("(Zimmer et al., 2004)", line = 0.5)
abline(lm(magnitude ~ log10(u), sounds))
text(magnitude ~ u, sounds, labels = abbreviate(rownames(sounds), 4))

## Predicting unpleasantness from psychoacoustic metrics
summary(
  lm(log(u) ~ scale(sharpness, scale = FALSE) +
              scale(roughness, scale = FALSE):I(loudness.5 &gt; 27),
     sounds[-12, ])  # w/o wasp
)
</code></pre>

<hr>
<h2 id='group.test'>Group Effects in Elimination-by-Aspects (EBA) Models</h2><span id='topic+group.test'></span><span id='topic+print.group.test'></span>

<h3>Description</h3>

<p>Tests for group effects in elimination-by-aspects (EBA) models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group.test(groups, A = 1:I, s = rep(1/J, J), constrained = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="group.test_+3A_groups">groups</code></td>
<td>
<p>a 3d array containing one aggregate choice matrix
per group</p>
</td></tr>
<tr><td><code id="group.test_+3A_a">A</code></td>
<td>
<p>a list of vectors consisting of the stimulus aspects;
the default is <code>1:I</code>, where <code>I</code> is the number of stimuli</p>
</td></tr>
<tr><td><code id="group.test_+3A_s">s</code></td>
<td>
<p>the starting vector with default <code>1/J</code> for all parameters,
where <code>J</code> is the number of parameters</p>
</td></tr>
<tr><td><code id="group.test_+3A_constrained">constrained</code></td>
<td>
<p>logical, if TRUE (default), EBA parameters are
constrained to be positive</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The five tests are all based on likelihood ratios. 
</p>
<p><code>Overall</code> compares a 1-parameter Poisson model to a saturated Poisson
model, thereby testing the equality of the frequencies in each cell of the
array.  This test corresponds to simultaneously testing for a null effect of
(1) the context induced by a given pair, (2) the grouping factor, (3) the
stimuli, and (4) the imbalance between pairs.  The deviances of the
remaining tests sum to the total deviance associated with the overall test.
</p>
<p><code>EBA.g</code> tests an EBA group model against a saturated binomial group
model, which corresponds to a goodness of fit test of the EBA group model.
</p>
<p><code>Group</code> tests an EBA model having its parameters restricted to be equal
across groups (single set of parameters) against the EBA group model
allowing its parameters to vary freely across groups (one set of parameters
per group); this corresponds to testing for group differences.
</p>
<p><code>Effect</code> tests an indifference model (where all choice probabilities
are equal to 0.5) against the restricted EBA model (single set of
parameters), which corresponds to testing for a stimulus effect.
</p>
<p><code>Imbalance</code> tests for differences in the number of observations per
pair by comparing the average sample size (1-parameter Poisson model) to the
actual sample sizes (saturated Poisson model).
</p>
<p>See Duineveld, Arents, and King (2000) for further details, and Choisel and
Wickelmaier (2007) for an application.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>tests</code></td>
<td>
<p>a table displaying the likelihood ratio test statistics</p>
</td></tr>
</table>


<h3>References</h3>

<p>Choisel, S., &amp; Wickelmaier, F. (2007).
Evaluation of multichannel reproduced sound: Scaling auditory attributes
underlying listener preference.
<em>Journal of the Acoustical Society of America</em>,
<b>121</b>, 388&ndash;400.
doi: <a href="https://doi.org/10.1121/1.2385043">10.1121/1.2385043</a>
</p>
<p>Duineveld, C.A.A., Arents, P., &amp; King, B.M. (2000).
Log-linear modelling of paired comparison data from consumer tests.
<em>Food Quality and Preference</em>, <b>11</b>, 63&ndash;70.
doi: <a href="https://doi.org/10.1016/s0950-3293(99)00040-3">10.1016/s0950-3293(99)00040-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+wald.test">wald.test</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Bradley-Terry-Luce model
data(pork)          # Is there a difference between Judge 1 and Judge 2?
groups &lt;- simplify2array(list(apply(pork[, , 1:5],  1:2, sum),
                              apply(pork[, , 6:10], 1:2, sum)))
group.test(groups)  # Yes, there is.

## Elimination-by-aspects model
data(drugrisk)   # Do younger and older males judge risk of drugs differently?
A2 &lt;- list(c(1), c(2,7), c(3,7), c(4,7,8), c(5,7,8), c(6,7,8))
group.test(drugrisk[, , 3:4], A2)  # Yes.
</code></pre>

<hr>
<h2 id='heaviness'>Weights Judging Data</h2><span id='topic+heaviness'></span>

<h3>Description</h3>

<p>Beaver and Gokhale (1975) presented fifty subjects with all 20 ordered pairs
of bottles filled with lead shot and asked them to choose the bottle that
felt heavier.  The mass of the bottles was 90, 95, 100, 105, and 110 grams,
respectively.  Choice frequencies were aggregated across subjects for the
two within-pair presentation orders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(heaviness)</code></pre>


<h3>Format</h3>

<p>A 3d array consisting of two square matrices:
</p>

<dl>
<dt><code>heaviness[, , order = 1]</code></dt><dd><p>holds the choices where the row
stimulus was presented first for each pair (in the upper triangle, and
vice versa in the lower triangle).</p>
</dd>
<dt><code>heaviness[, , order = 2]</code></dt><dd><p>holds the choices where the column
stimulus was presented first for each pair (in the upper triangle, and
vice versa in the lower triangle).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Beaver, R.J., &amp; Gokhale, D.V. (1975).
A model to incorporate within-pair order effects in paired comparisons.
<em>Communications in Statistics</em>, <b>4</b>, 923&ndash;939.
doi: <a href="https://doi.org/10.1080/03610927308827302">10.1080/03610927308827302</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba.order">eba.order</a></code> for a model that includes a within-pair
order effect.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heaviness)
## 6 subjects chose 90g over 100g, when 90g was presented first.
heaviness["90g", "100g", order=1]

## 44 subjects chose 100g over 90g, when 90g was presented first.
heaviness["100g", "90g", order=1]

## 14 subjects chose 90g over 100g, when 90g was presented second.
heaviness["90g", "100g", order=2]

## 36 subjects chose 100g over 90g, when 90g was presented second.
heaviness["100g", "90g", order=2]

## Bradley-Terry-Luce (BTL) model for each within-pair order
btl1 &lt;- eba(heaviness[, , 1])
btl2 &lt;- eba(heaviness[, , 2])

xval &lt;- seq(90, 110, 5)
plot(uscale(btl1) ~ xval, type="n", log="y",
     xlab="Mass of lead shot filled bottle (in g)",
     ylab="Perceived heaviness (BTL model)",
     main="Weights judging experiment")
mtext("(Beaver and Gokhale, 1975)", line=.5)

arrows(xval, uscale(btl1) - 1.96*sqrt(diag(cov.u(btl1))),
       xval, uscale(btl1) + 1.96*sqrt(diag(cov.u(btl1))), .05, 90, 3, "gray")
arrows(xval, uscale(btl2) - 1.96*sqrt(diag(cov.u(btl2))),
       xval, uscale(btl2) + 1.96*sqrt(diag(cov.u(btl2))), .05, 90, 3, "gray")

points(uscale(btl1) ~ xval, type="b", pch=16)
points(uscale(btl2) ~ xval, type="b", lty=2, pch=21, bg="white")

text(90.3, .01,  "Lower weight judged first", adj=0)
text(90.3, .08, "Higher weight judged first", adj=0)
</code></pre>

<hr>
<h2 id='inclusion.rule'>Inclusion Rule</h2><span id='topic+inclusion.rule'></span>

<h3>Description</h3>

<p>Checks if a family of sets fulfills the inclusion rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inclusion.rule(A)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inclusion.rule_+3A_a">A</code></td>
<td>
<p>a list of vectors consisting of the stimulus aspects of an
elimination-by-aspects model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inclusion rule is necessary and sufficient for a tree structure on the
aspect sets:
</p>
<p>Structure theorem. A family <code class="reqn">\{x' | x \in T\}</code> of aspect sets is
representable by a tree iff either <code class="reqn">x' \cap y' \supset x' \cap z'</code> or
<code class="reqn">x' \cap z' \supset x' \cap y'</code> for all <code class="reqn">x, y, z</code> in <code class="reqn">T</code>.
(Tversky and Sattath, 1979, p. 546)
</p>


<h3>Value</h3>

<p>Either <code>TRUE</code> if the inclusion rule holds for <code>A</code>, or <code>FALSE</code>
otherwise.
</p>


<h3>References</h3>

<p>Tversky, A., &amp; Sattath, S. (1979).
Preference trees.
<em>Psychological Review</em>, <b>86</b>, 542&ndash;573.
doi: <a href="https://doi.org/10.1037/0033-295X.86.6.542">10.1037/0033-295X.86.6.542</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+trineq">trineq</a></code>, <code><a href="#topic+strans">strans</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- list(c(1, 5), c(2, 5), c(3, 6), c(4, 6))  # tree
inclusion.rule(A)

B &lt;- list(c(1, 5), c(2, 5, 6), c(3, 6), c(4, 6))  # lattice
inclusion.rule(B)
</code></pre>

<hr>
<h2 id='kendall.u'>Kendall's Coefficient of Agreement</h2><span id='topic+kendall.u'></span><span id='topic+print.kendall.u'></span>

<h3>Description</h3>

<p>Kendall's u coefficient of agreement between judges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kendall.u(M, correct = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kendall.u_+3A_m">M</code></td>
<td>
<p>a square matrix or a data frame consisting of absolute choice
frequencies; row stimuli are chosen over column stimuli</p>
</td></tr>
<tr><td><code id="kendall.u_+3A_correct">correct</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) a continuity correction is
applied when computing the test statistic (by subtracting one from the sum
of agreeing pairs)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Kendall's u (Kendall and Babington Smith, 1940) takes on values between
<code>min.u</code> (minimum agreement) and 1 (maximum agreement).
The minimum <code>min.u</code> equals <code class="reqn">-1/(m - 1)</code>, if <code class="reqn">m</code> is even,
and <code class="reqn">-1/m</code>, if <code class="reqn">m</code> is odd, where <code class="reqn">m</code> is the number of subjects
(judges).
</p>
<p>The null hypothesis in the chi-square test is that the agreement between
judges is by chance.
</p>
<p>It is assumed that there is an equal number of observations per pair
and that each subject judges each pair only once.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>u</code></td>
<td>
<p>Kendall's u coefficient of agreement</p>
</td></tr>
<tr><td><code>min.u</code></td>
<td>
<p>the minimum value for u</p>
</td></tr>
<tr><td><code>chi2</code></td>
<td>
<p>the chi-square statistic for a test that the agreement is
by chance</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value of the test</p>
</td></tr>
</table>


<h3>References</h3>

<p>Kendall, M.G., &amp; Babington Smith, B. (1940).
On the method of paired comparisons.
<em>Biometrika</em>, <b>31</b>, 324&ndash;345.
doi: <a href="https://doi.org/10.1093/biomet/31.3-4.324">10.1093/biomet/31.3-4.324</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+schoolsubjects">schoolsubjects</a></code>, <code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+strans">strans</a></code>,
<code><a href="#topic+circular">circular</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schoolsubjects)
lapply(schoolsubjects, kendall.u)  # better-than-chance agreement
</code></pre>

<hr>
<h2 id='linear2btl'>Linear Coefficients to Bradley-Terry-Luce (BTL) Estimates</h2><span id='topic+linear2btl'></span>

<h3>Description</h3>

<p>Transforms linear model coefficients to Bradley-Terry-Luce (BTL) model
parameter estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linear2btl(object, order = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="linear2btl_+3A_object">object</code></td>
<td>
<p>an object of class <code>glm</code> or <code>lm</code> specifying a BTL
model</p>
</td></tr>
<tr><td><code id="linear2btl_+3A_order">order</code></td>
<td>
<p>logical, does the model include an order effect? Defaults to
FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design matrix used by <code>glm</code> or <code>lm</code> usually results from
a call to <code><a href="#topic+pcX">pcX</a></code>.  It is assumed that the reference category is
the first level.  The covariance matrix is estimated by employing the delta
method.  See Imrey, Johnson, and Koch (1976) for more details.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>btl.parameters</code></td>
<td>
<p>a matrix; the first column holds the BTL parameter
estimates, the second column the approximate standard errors</p>
</td></tr>
<tr><td><code>cova</code></td>
<td>
<p>the approximate covariance matrix of the BTL parameter
estimates</p>
</td></tr>
<tr><td><code>linear.coefs</code></td>
<td>
<p>a vector of the original linear coefficients as returned
by <code>glm</code> or <code>lm</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Imrey, P.B., Johnson, W.D., &amp; Koch, G.G. (1976).
An incomplete contingency table approach to paired-comparison experiments.
<em>Journal of the American Statistical Association</em>, <b>71</b>, 614&ndash;623.
doi: <a href="https://doi.org/10.2307/2285591">10.2307/2285591</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+eba.order">eba.order</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>,
<code><a href="#topic+pcX">pcX</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugrisk)
y1 &lt;- t(drugrisk[, , 1])[lower.tri(drugrisk[, , 1])]
y0 &lt;-   drugrisk[, , 1][ lower.tri(drugrisk[, , 1])]

## Fit BTL model using glm (maximum likelihood)
btl.glm &lt;- glm(cbind(y1, y0) ~ 0 + pcX(6), binomial)
linear2btl(btl.glm)

## Fit BTL model using lm (weighted least squares)
btl.lm &lt;- lm(log(y1/y0) ~ 0 + pcX(6), weights=y1*y0/(y1 + y0))
linear2btl(btl.lm)
</code></pre>

<hr>
<h2 id='logLik.eba'>Log-Likelihood of an eba Object</h2><span id='topic+logLik.eba'></span><span id='topic+nobs.eba'></span>

<h3>Description</h3>

<p>Returns the log-likelihood value of the (multi-attribute) probabilistic
choice model represented by <code>object</code> evaluated at the estimated
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eba'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logLik.eba_+3A_object">object</code></td>
<td>
<p>an object inheriting from class <code>eba</code>, representing
a fitted elimination-by-aspects model</p>
</td></tr>
<tr><td><code id="logLik.eba_+3A_...">...</code></td>
<td>
<p>some methods for this generic require additional
arguments; none are used in this method.</p>
</td></tr> 
</table>


<h3>Value</h3>

<p>The log-likelihood of the model represented by
<code>object</code> evaluated at the estimated parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="stats.html#topic+logLik.lm">logLik.lm</a></code>, <code><a href="stats.html#topic+AIC">AIC</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(heaviness)
btl1 &lt;- eba(heaviness[, , order=1])
logLik(btl1)
AIC(btl1)
BIC(btl1)
</code></pre>

<hr>
<h2 id='mbt'>Mallows-Bradley-Terry Model</h2><span id='topic+mbt'></span><span id='topic+print.mbt'></span>

<h3>Description</h3>

<p>Fits a Mallows-Bradley-Terry (MBT) model by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbt(data, bootstrap = FALSE, nsim = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mbt_+3A_data">data</code></td>
<td>
<p>a data frame, the first t columns containing the ranks, the
(t + 1)th column containing the frequencies</p>
</td></tr>
<tr><td><code id="mbt_+3A_bootstrap">bootstrap</code></td>
<td>
<p>logical. Return a parametric bootstrap p-value?</p>
</td></tr>
<tr><td><code id="mbt_+3A_nsim">nsim</code></td>
<td>
<p>number of bootstrap replicates</p>
</td></tr>
<tr><td><code id="mbt_+3A_...">...</code></td>
<td>
<p>further aguments passed to <code>simulate</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mbt</code> provides a front end for <code>glm</code>.  See Critchlow and Fligner
(1991) and Mallows (1957) for details.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>a vector of parameter estimates (scale values)
constrained to sum to unity</p>
</td></tr>
<tr><td><code>goodness.of.fit</code></td>
<td>
<p>the goodness of fit statistic including the
likelihood ratio fitted vs. saturated model (-2logL), the degrees of
freedom, the p-value of the corresponding chi-square distribution, and
if <code>bootstrap</code> is <code>TRUE</code> the bootstrap p-value</p>
</td></tr>
<tr><td><code>perm.idx</code></td>
<td>
<p>the names of the non-zero frequency ranks</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the vector of rank frequencies including zeros</p>
</td></tr>
<tr><td><code>mbt.glm</code></td>
<td>
<p>the output from a call to <code>glm</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Florian Wickelmaier</p>


<h3>References</h3>

<p>Critchlow, D.E., &amp; Fligner, M.A. (1991).
Paired comparison, triple comparison, and ranking experiments as generalized
linear models, and their implementation in GLIM.
<em>Psychometrika</em>, <b>56</b>, 517&ndash;533.
doi: <a href="https://doi.org/10.1007/bf02294488">10.1007/bf02294488</a>
</p>
<p>Mallows, C.L. (1957).
Non-null ranking models. I.
<em>Biometrika</em>, <b>44</b>, 114&ndash;130.
doi: <a href="https://doi.org/10.1093/biomet/44.1-2.114">10.1093/biomet/44.1-2.114</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tartness">tartness</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tartness)        # tartness rankings of salad dressings (Vargo, 1989)
mbt(tartness, bootstrap=TRUE, nsim=500)  # fit Mallows-Bradley-Terry model
</code></pre>

<hr>
<h2 id='pcX'>Paired-Comparison Design Matrix</h2><span id='topic+pcX'></span>

<h3>Description</h3>

<p>Computes a paired-comparison design matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcX(nstimuli, omitRef = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcX_+3A_nstimuli">nstimuli</code></td>
<td>
<p>number of stimuli in the paired-comparison design</p>
</td></tr>
<tr><td><code id="pcX_+3A_omitref">omitRef</code></td>
<td>
<p>logical, if <code>TRUE</code> (default), the first column
corresponding to the reference category is omitted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design matrix can be used when fitting a Bradley-Terry-Luce (BTL)
model or a Thurstone-Mosteller (TM) model by means of <code><a href="stats.html#topic+glm">glm</a></code>
or <code><a href="stats.html#topic+lm">lm</a></code>.  See Critchlow and Fligner (1991) for more details.
</p>


<h3>Value</h3>

<p>A matrix having <code>(nstimuli - 1)*nstimuli/2</code> rows and
<code>nstimuli - 1</code> columns (if the reference category is omitted).
</p>


<h3>References</h3>

<p>Critchlow, D.E., &amp; Fligner, M.A. (1991).
Paired comparison, triple comparison, and ranking experiments as generalized
linear models, and their implementation in GLIM.
<em>Psychometrika</em>, <b>56</b>, 517&ndash;533.
doi: <a href="https://doi.org/10.1007/bf02294488">10.1007/bf02294488</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+thurstone">thurstone</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>,
<code><a href="#topic+balanced.pcdesign">balanced.pcdesign</a></code>, <code><a href="#topic+linear2btl">linear2btl</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugrisk)               # absolute choice frequencies
btl &lt;- eba(drugrisk[, , 1])  # fit Bradley-Terry-Luce model using eba
summary(btl)

y1 &lt;- t(drugrisk[, , 1])[lower.tri(drugrisk[, , 1])]
y0 &lt;-   drugrisk[, , 1][ lower.tri(drugrisk[, , 1])]

## Fit Bradley-Terry-Luce model using glm
btl.glm &lt;- glm(cbind(y1, y0) ~ 0 + pcX(6), binomial)
summary(btl.glm)

## Fit Thurstone Case V model using glm
tm.glm &lt;- glm(cbind(y1, y0) ~ 0 + pcX(6), binomial(probit))
summary(tm.glm)
</code></pre>

<hr>
<h2 id='plot.eba'>Diagnostic Plot for EBA Models</h2><span id='topic+plot.eba'></span>

<h3>Description</h3>

<p>Plots elimination-by-aspects (EBA) model residuals against fitted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eba'
plot(x, xlab = "Predicted choice probabilities",
     ylab = "Deviance residuals", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.eba_+3A_x">x</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="plot.eba_+3A_xlab">xlab</code>, <code id="plot.eba_+3A_ylab">ylab</code>, <code id="plot.eba_+3A_...">...</code></td>
<td>
<p>graphical parameters passed to plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deviance residuals are plotted against the predicted choice
probabilities for the upper triangle of the paired-comparison
matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+residuals.eba">residuals.eba</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Compare two choice models

data(celebrities)                     # absolute choice frequencies
btl1 &lt;- eba(celebrities)              # fit Bradley-Terry-Luce model
A &lt;- list(c(1,10), c(2,10), c(3,10),
          c(4,11), c(5,11), c(6,11),
          c(7,12), c(8,12), c(9,12))  # the structure of aspects
eba1 &lt;- eba(celebrities, A)           # fit elimination-by-aspects model
anova(btl1, eba1)                     # model comparison based on likelihoods

par(mfrow = 1:2)                      # residuals versus fitted values
plot(btl1, main = "BTL", ylim = c(-4, 4.5))  # BTL doesn't fit well
plot(eba1, main = "EBA", ylim = c(-4, 4.5))  # EBA fits better
</code></pre>

<hr>
<h2 id='pork'>Pork Tasting Data</h2><span id='topic+pork'></span>

<h3>Description</h3>

<p>Bradley and Terry (1952) provide the individual choice matrices of two
judges choosing between pairs of three samples of pork meet.  The pigs had
been fed on either corn (C), corn plus peanut supplement (Cp), or corn plus
a large peanut supplement (CP).  Each judge does five repetitions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pork)</code></pre>


<h3>Format</h3>

<p>A 3d array consisting of ten square matrices.  The first five matrices
correspond to the five repetitions of the first judge, the last five to the
repetitions of the second judge.  Row stimuli are chosen (preferred) over
column stimuli.
</p>


<h3>Source</h3>

<p>Bradley, R.A., &amp; Terry, M.E. (1952).
Rank analysis of incomplete block designs. I. The method of paired
comparisons.
<em>Biometrika</em>, <b>39</b>, 324&ndash;345.
doi: <a href="https://doi.org/10.1093/biomet/39.3-4.324">10.1093/biomet/39.3-4.324</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pork)
apply(pork, 1:2, sum)  # aggregate choice frequencies
</code></pre>

<hr>
<h2 id='residuals.eba'>Residuals for EBA Models</h2><span id='topic+residuals.eba'></span>

<h3>Description</h3>

<p>Computes deviance and Pearson residuals for <code>eba</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eba'
residuals(object, type = c("deviance", "pearson"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.eba_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="residuals.eba_+3A_type">type</code></td>
<td>
<p>the type of residuals which should be returned; the
alternatives are: <code>"deviance"</code> (default) and <code>"pearson"</code></p>
</td></tr>
<tr><td><code id="residuals.eba_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods; none are
used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Residuals are computed from the upper triangle of the paired-comparison
matrix.  See <code><a href="stats.html#topic+residuals.glm">residuals.glm</a></code> for details.
</p>


<h3>Value</h3>

<p>A vector of residuals having as many elements as pairs of stimuli.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="stats.html#topic+residuals.glm">residuals.glm</a></code>,
<code><a href="#topic+plot.eba">plot.eba</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)                # absolute choice frequencies
btl1 &lt;- eba(celebrities)         # fit Bradley-Terry-Luce model
sum( resid(btl1)^2 )             # deviance G2
deviance(btl1)
sum( resid(btl1, "pearson")^2 )  # Pearson X2
</code></pre>

<hr>
<h2 id='schoolsubjects'>Preference for School Subjects</h2><span id='topic+schoolsubjects'></span>

<h3>Description</h3>

<p>Two classes of children (ages 11 to 13) were asked to state their
preferences with respect to certain school subjects. Each child was given a
sheet on which were written the possible pairs of subjects and asked to
underline the one preferred in each case (Kendall and Babington Smith,
1940).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schoolsubjects)</code></pre>


<h3>Format</h3>

<p>A list containing two square matrices of aggregate choice frequencies
(row entries are preferred over column entries):
</p>

<dl>
<dt><code>schoolsubjects[["boys"]]</code></dt><dd><p>holds the frequencies
of 21 boys choosing among 13 school subjects:
woodwork, gymnastics, art, science, history, geography, arithmetic,
religion, English literature, commercial subjects, algebra,
English grammar, geometry.</p>
</dd>
<dt><code>schoolsubjects[["girls"]]</code></dt><dd><p>holds the frequencies
of 25 girls choosing among 11 school subjects:
gymnastics, science, art, domestic science, history, arithmetic,
geography, English literature, religion, algebra, English grammar.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kendall, M.G., &amp; Babington Smith, B. (1940).
On the method of paired comparisons.
<em>Biometrika</em>, <b>31</b>, 324&ndash;345.
doi: <a href="https://doi.org/10.1093/biomet/31.3-4.324">10.1093/biomet/31.3-4.324</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(schoolsubjects)

m &lt;- lapply(schoolsubjects, eba)  # Bradley-Terry-Luce (BTL) model

par(mfrow = 1:2)
dotchart(uscale(m$boys), main = "Boys' preferences", log = "x")
dotchart(uscale(m$girls), main = "Girls' preferences", log = "x")
mtext("Utility scale value (BTL model)", outer = TRUE, side = 1,
      line = -2)
mtext("(Kendall and Babington Smith, 1940)", outer = TRUE, line = -4)
</code></pre>

<hr>
<h2 id='simulate.eba'>Simulate Responses from EBA Models</h2><span id='topic+simulate.eba'></span>

<h3>Description</h3>

<p>Simulates responses from the distribution corresponding to a fitted
<code>eba</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'eba'
simulate(object, nsim, seed, pool = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate.eba_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="simulate.eba_+3A_nsim">nsim</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="simulate.eba_+3A_seed">seed</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="simulate.eba_+3A_pool">pool</code></td>
<td>
<p>logical, if TRUE (default), pooled responses (summed across
respondents) are returned</p>
</td></tr>
<tr><td><code id="simulate.eba_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods; none are
used in this method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Responses are simulated by <code><a href="stats.html#topic+rbinom">rbinom</a></code> with sizes taken from the
original sample and probabilities computed from the model object.
</p>


<h3>Value</h3>

<p>A paired-comparison matrix of (pooled) responses.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+boot">boot</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)                     # absolute choice frequencies
A &lt;- list(c(1,10), c(2,10), c(3,10),
          c(4,11), c(5,11), c(6,11),
          c(7,12), c(8,12), c(9,12))  # the structure of aspects
eba1 &lt;- eba(celebrities, A)           # fit elimination-by-aspects model

## Parametric bootstrap of goodness-of-fit test
LR.stat &lt;- replicate(200, deviance(eba(simulate(eba1), A)))

hist(LR.stat, col="lightgray", border="white", freq=FALSE, breaks=20,
     xlim=c(0, 60), main="Parametric bootstrap")
curve(dchisq(x, df=eba1$goodness.of.fit["df"]), add=TRUE)
abline(v=deviance(eba1), lty=2)
</code></pre>

<hr>
<h2 id='soundquality'>Quality of Multichannel Reproduced Sound</h2><span id='topic+soundquality'></span><span id='topic+SQattributes'></span><span id='topic+SQpreference'></span><span id='topic+SQsubjects'></span>

<h3>Description</h3>

<p>Paired comparison judgments of 40 selected listeners with respect to
eight audio reproduction modes and four types of music:
<code>SQpreference</code> includes judgments on overall preference;
<code>SQattributes</code> includes judgments on specific spatial and timbral
auditory attributes;
<code>SQsubjects</code>: includes information about the listeners involved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("soundquality")</code></pre>


<h3>Format</h3>

<p><code>SQpreference</code> A data frame containing 783 observations on 6 variables:
</p>

<dl>
<dt>id</dt><dd><p>factor, listener ID.</p>
</dd>
<dt>time</dt><dd><p>factor, listening experiment before or after elicitation and
scaling of more specific auditory attributes.</p>
</dd>
<dt>progmat</dt><dd><p>factor, the program material: Beethoven, Rachmaninov, Steely
Dan, Sting.</p>
</dd>
<dt>repet</dt><dd><p>the repetition number.</p>
</dd>
<dt>session</dt><dd><p>the experimental session coding the presentation order of
the program material.</p>
</dd>
<dt>preference</dt><dd><p>paired comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>;
preferences for all 28 paired comparisons from 8 audio reproduction modes:
Mono, Phantom Mono, Stereo, Wide-Angle Stereo, 4-channel Matrix,
5-channel Upmix 1, 5-channel Upmix 2, and 5-channel Original.</p>
</dd>
</dl>

<p><code>SQattributes</code> A data frame containing 156 observations on 10 variables:
</p>

<dl>
<dt>id</dt><dd><p>factor, listener ID.</p>
</dd>
<dt>progmat</dt><dd><p>factor, the program material.</p>
</dd>
<dt>width, spaciousness, envelopment, distance, clarity, brightness,
elevation, naturalness</dt><dd><p>Paired comparison of class
<code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.</p>
</dd>
</dl>

<p><code>SQsubjects</code> A data frame containing 78 observations on 18 variables:
</p>

<dl>
<dt>id</dt><dd><p>factor, listener ID</p>
</dd>
<dt>status</dt><dd><p>factor, selection status; 40 listeners were selected.</p>
</dd>
<dt>HLmax</dt><dd><p>maximum hearing level between 250 and 8000 Hz</p>
</dd>
<dt>stereowidth</dt><dd><p>stereo-width discrimination threshold</p>
</dd>
<dt>fluency</dt><dd><p>word fluency score</p>
</dd>
<dt>age</dt><dd><p>subject age</p>
</dd>
<dt>gender</dt><dd><p>factor, subject gender</p>
</dd>
<dt>education</dt><dd><p>factor, education class</p>
</dd>
<dt>background, experience, listenmusic, concerts, instrument, critical,
cinema, hifi, surround, earliertests</dt><dd><p>indicators of prior experience</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were collected within a series of experiments conducted at the
Sound Quality Research Unit (SQRU), Department of Acoustics, Aalborg
University, Denmark, between September 2004 and March 2005.
</p>
<p>The results of scaling listener preference and spatial and timbral auditory
attributes are reported in Choisel and Wickelmaier (2007). See examples for
replication code.  Details about the loudspeaker setup and calibration are
given in Choisel and Wickelmaier (2006).  The attribute elicitation
procedure is described in Wickelmaier and Ellermeier (2007) and in Choisel
and Wickelmaier (2006).  The selection of listeners for the experiments is
described in Wickelmaier and Choisel (2005).
</p>
<p>Portions of these data are also available via <code>data("SoundQuality",
  package = "psychotools")</code>.
</p>


<h3>Note</h3>

<p>One listener (ID 62) dropped out after contributing the first set of
preference judgments.</p>


<h3>References</h3>

<p>Choisel, S., &amp; Wickelmaier, F. (2006).
Extraction of auditory features and elicitation of attributes for the
assessment of multichannel reproduced sound.
<em>Journal of the Audio Engineering Society</em>, <b>54</b>(9), 815&ndash;826.
</p>
<p>Choisel, S., &amp; Wickelmaier, F. (2007).
Evaluation of multichannel reproduced sound: Scaling auditory attributes
underlying listener preference.
<em>Journal of the Acoustical Society of America</em>,
<b>121</b>(1), 388&ndash;400. 
doi: <a href="https://doi.org/10.1121/1.2385043">10.1121/1.2385043</a>
</p>
<p>Wickelmaier, F., &amp; Choisel, S. (2005).
Selecting participants for listening tests of multichannel reproduced sound.
Presented at the AES 118th Convention, May 28&ndash;31, Barcelona, Spain,
convention paper 6483.
</p>
<p>Wickelmaier, F., &amp; Ellermeier, W. (2007).
Deriving auditory features from triadic comparisons.
<em>Perception &amp; Psychophysics</em>, <b>69</b>(2), 287&ndash;297.
doi: <a href="https://doi.org/10.3758/BF03193750">10.3758/BF03193750</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+strans">strans</a></code>, <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>requireNamespace("psychotools")
data(soundquality)

######### Replication code for Choisel and Wickelmaier (2007) ######

### A. Scaling overall preference

## Participants
summary(subset(SQsubjects, status == "selected"))

## Transitivity violations
aggregate(preference ~ progmat + time,
  data = SQpreference,
  function(x) unlist(strans(summary(x, pcmatrix = TRUE))[
                       c("weak", "moderate", "strong")]))

## BTL modeling
prefdf &lt;- aggregate(preference ~ progmat + time,
            data = SQpreference,
            function(x) uscale(eba(summary(x, pcmatrix = TRUE))))

## Preference scale
p &lt;- t(prefdf[prefdf$time == "before", 3])
colnames(p) &lt;- levels(prefdf$progmat)
dotchart(p, main = "Quality of multichannel reproduced sound",
         xlab = "Estimated preference (BTL model)", log = "x",
         panel.first = abline(v = 1/8, col = "gray"))
points(x = t(prefdf[prefdf$time == "after", 3]),
       y = c(31:38, 21:28, 11:18, 1:8), pch = 3)
legend("topleft", c("before", "after"), pch = c(1, 3))
mtext("(Choisel and Wickelmaier, 2007)", line = 0.5)

### B. Scaling specific auditory attributes

## Transitivity violations
aggregate(
  x = SQattributes[-(1:2)],
  by = list(progmat = SQattributes$progmat),
  FUN = function(x) strans(summary(x, pcmatrix = TRUE))[
          c("weak", "moderate", "strong")],
  simplify = FALSE
)

## BTL modeling
uscal &lt;- aggregate(
  x = SQattributes[-(1:2)],
  by = list(progmat = SQattributes$progmat),
  FUN = function(x) uscale(eba(summary(x, pcmatrix = TRUE)))
)
uscal &lt;- data.frame(
  progmat = rep(levels(SQattributes$progmat), each = 8),
  repmod = factor(1:8, labels = labels(SQattributes$width)),
  as.data.frame(sapply(uscal[-1], t))
)

## EBA modeling: envelopment, width
uscal$envelopment[uscal$progmat == "SteelyDan"] &lt;-
  uscale(eba(summary(SQattributes[SQattributes$progmat == "SteelyDan",
                                  "envelopment"], pcmatrix = TRUE),
             A = list(c(1,9), c(2,9), c(3,9), c(4,9), 5, 6, c(7,9), 8)))
uscal$width[uscal$progmat == "SteelyDan"] &lt;-
  uscale(eba(summary(SQattributes[SQattributes$progmat == "SteelyDan",
                                  "width"], pcmatrix = TRUE),
             A = list(1, 2, c(3,9), c(4,9), c(5,9), 6, 7, c(8,9))))

### C. Relating overall preference to specific attributes

## Principal components: classical music
pca1 &lt;- princomp(
  ~ width + spaciousness + envelopment + distance +
    clarity + brightness + elevation,
  data = uscal,
  subset = progmat %in% c("Beethoven", "Rachmaninov"),
  cor = TRUE
)

## Loadings on first two components
L &lt;- varimax(loadings(pca1) %*% diag(pca1$sdev)[, 1:2])

## Factor scores
f &lt;- scale(predict(pca1)[, 1:2]) %*% L$rotmat
dimnames(f) &lt;- list(
  abbreviate(rep(labels(SQattributes$width), 2), 2),
  names(pca1$sdev)[1:2]
)
biplot(f, 2*L$loadings, cex = 0.8, expand = 1.5,
       main = "Preference and auditory attributes: classical music",
       xlim = c(-1.5, 2), ylim = c(-2, 2))

## Predicting preference
classdf &lt;- cbind(
  pref = as.vector(t(prefdf[prefdf$time == "after" &amp;
           prefdf$progmat %in% c("Beethoven", "Rachmaninov"), 3])),
  as.data.frame(f)
)
m1 &lt;- lm(pref ~ Comp.1 + Comp.2 + I(Comp.1^2), classdf)
c1 &lt;- seq(-1.5, 2.0, length.out = 101)
c2 &lt;- seq(-2.0, 2.0, length.out = 101)
z &lt;- matrix(predict(m1, expand.grid(Comp.1 = c1, Comp.2 = c2)), 101, 101)
contour(c1, c2, z, add = TRUE, col = "darkblue")

## Principal components: pop music
pca2 &lt;- princomp(
  ~ width + spaciousness + envelopment + distance +
    clarity + brightness + elevation,
  data = uscal,
  subset = progmat %in% c("SteelyDan", "Sting"),
  cor = TRUE
)
L &lt;- varimax(loadings(pca2) %*% diag(pca2$sdev)[, 1:2])
f[] &lt;- scale(predict(pca2)[, 1:2]) %*% L$rotmat
biplot(f, 2*L$loadings, cex = 0.8,
       main = "Preference and auditory attributes: pop music",
       xlim = c(-1.5, 2), ylim = c(-2.5, 1.5))

popdf &lt;- cbind(
  pref = as.vector(t(prefdf[prefdf$time == "after" &amp;
           prefdf$progmat %in% c("SteelyDan", "Sting"), 3])),
  as.data.frame(f)
)
m2 &lt;- lm(pref ~ Comp.1 + Comp.2 + I(Comp.2^2), popdf)
c1 &lt;- seq(-1.5, 2.0, length.out = 101)
c2 &lt;- seq(-2.5, 1.5, length.out = 101)
z &lt;- matrix(predict(m2, expand.grid(Comp.1 = c1, Comp.2 = c2)), 101, 101)
contour(c1, c2, z, add = TRUE, col = "darkblue")
</code></pre>

<hr>
<h2 id='strans'>Stochastic Transitivity</h2><span id='topic+strans'></span><span id='topic+print.strans'></span>

<h3>Description</h3>

<p>Checks the weak, moderate, and strong stochastic transitivity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strans(M)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strans_+3A_m">M</code></td>
<td>
<p>a square matrix or a data frame consisting of absolute choice
frequencies; row stimuli are chosen over column stimuli</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Weak (WST), moderate (MST), and strong (SST) stochastic transitivity hold
for a set of choice probabilities <code class="reqn">P</code>, whenever if <code class="reqn">P_{ij} \ge 0.5</code>
and <code class="reqn">P_{jk} \ge 0.5</code>, then
</p>
<p><code class="reqn">P_{ik} \ge 0.5</code> (WST),
</p>
<p><code class="reqn">P_{ik} \ge \min(P_{ij}, P_{jk})</code> (MST),
</p>
<p><code class="reqn">P_{ik} \ge \max(P_{ij}, P_{jk})</code> (SST).
</p>
<p>See Suppes, Krantz, Luce, and Tversky (1989/2007, chap. 17) for an
introduction to the representation of choice probabilities.
</p>
<p>If WST holds, a permutation of the indices of the matrix exists such that
the proportions in the upper triangular matrix are <code class="reqn">\ge 0.5</code>.  This
rearranged matrix is stored in <code>pcm</code>.  If WST does not hold, cells in
the upper triangular matrix that are smaller than 0.5 are replaced by 0.5.
The deviance resulting from this restriction is reported in <code>wst.fit</code>.
</p>
<p>The approximate likelihood ratio test for significance of the WST violations
is according to Tversky (1969); for a more exact test of WST see Iverson and
Falmagne (1985).
</p>


<h3>Value</h3>

<p>A table displaying the number of violations of the weak, moderate, and
strong stochastic transitivity, the number of tests, the error ratio
(violations/tests), and the mean and maximum deviation from the minimum
probability for which the corresponding transitivity would hold.
</p>
<table role = "presentation">
<tr><td><code>weak</code></td>
<td>
<p>number of violations of WST</p>
</td></tr>
<tr><td><code>moderate</code></td>
<td>
<p>number of violations of MST</p>
</td></tr>
<tr><td><code>strong</code></td>
<td>
<p>number of violations of SST</p>
</td></tr>
<tr><td><code>n.tests</code></td>
<td>
<p>number of transitivity tests performed</p>
</td></tr>
<tr><td><code>wst.violations</code></td>
<td>
<p>a vector containing
<code class="reqn">0.5 - P_{ik}</code> for all triples that violate WST</p>
</td></tr>
<tr><td><code>mst.violations</code></td>
<td>
<p>a vector containing
<code class="reqn">\min(P_{ij}, P_{jk}) - P_{ik}</code> for all triples that violate MST</p>
</td></tr>
<tr><td><code>sst.violations</code></td>
<td>
<p>a vector containing
<code class="reqn">\max(P_{ij}, P_{jk}) - P_{ik}</code> for all triples that violate SST</p>
</td></tr>
<tr><td><code>pcm</code></td>
<td>
<p>the permuted square matrix of relative choice frequencies</p>
</td></tr>
<tr><td><code>ranking</code></td>
<td>
<p>the ranking of the objects, which corresponds to the colnames
of pcm</p>
</td></tr>
<tr><td><code>chkdf</code></td>
<td>
<p>data frame reporting the choice proportions for each triple in
each permutation</p>
</td></tr>
<tr><td><code>violdf</code></td>
<td>
<p>data frame reporting for each triple which type of
transitivity holds or does not hold</p>
</td></tr>
<tr><td><code>wst.fit</code></td>
<td>
<p>likelihood ratio test of WST (see Details)</p>
</td></tr>
<tr><td><code>wst.mat</code></td>
<td>
<p>restricted matrix that satisfies WST</p>
</td></tr>
</table>


<h3>References</h3>

<p>Iverson, G., &amp; Falmagne, J.-C. (1985).
Statistical issues in measurement.
<em>Mathematical Social Sciences</em>, <b>10</b>, 131&ndash;153.
doi: <a href="https://doi.org/10.1016/0165-4896(85)90031-9">10.1016/0165-4896(85)90031-9</a>
</p>
<p>Suppes, P., Krantz, D.H., Luce, R.D., &amp; Tversky, A. (1989/2007).
<em>Foundations of measurement. Volume II</em>.
Mineola, N.Y.: Dover Publications.
</p>
<p>Tversky, A. (1969).
Intransitivity of preferences.
<em>Psychological Review</em>, <b>76</b>, 31&ndash;48.
doi: <a href="https://doi.org/10.1037/h0026750">10.1037/h0026750</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+circular">circular</a></code>, <code><a href="#topic+kendall.u">kendall.u</a></code>,
<code><a href="#topic+trineq">trineq</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)           # absolute choice frequencies
strans(celebrities)         # WST and MST hold, but not SST
strans(celebrities)$pcm     # reordered relative frequencies
strans(celebrities)$violdf  # transitivity violations
</code></pre>

<hr>
<h2 id='tartness'>Tartness Rankings of Salad Dressings</h2><span id='topic+tartness'></span>

<h3>Description</h3>

<p>The data were collected by Vargo (1989; cited in Critchlow and Fligner,
1991). Each of 32 judges is asked to rank four salad dressing preparations
according to tartness, with a rank of 1 being assigned to the formulation
judged to be the most tart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tartness)</code></pre>


<h3>Format</h3>

<p>A data frame consisting the rankings and their frequencies.</p>


<h3>Source</h3>

<p>Critchlow, D.E., &amp; Fligner, M.A. (1991).
Paired comparison, triple comparison, and ranking experiments as generalized
linear models, and their implementation in GLIM.
<em>Psychometrika</em>, <b>56</b>, 517&ndash;533.
doi: <a href="https://doi.org/10.1007/bf02294488">10.1007/bf02294488</a>
</p>


<h3>References</h3>

<p>Vargo, M.D. (1989).
Microbiological spoilage of a moderate acid food system using a dairy-based
salad dressing model.
Unpublished masters thesis, Ohio State University,
Department of Food Science and Nutrition, Columbus, OH.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(tartness)
</code></pre>

<hr>
<h2 id='thurstone'>Thurstone-Mosteller Model (Case V)</h2><span id='topic+thurstone'></span><span id='topic+print.thurstone'></span>

<h3>Description</h3>

<p>Fits a Thurstone-Mosteller model (Case V) by maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thurstone(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="thurstone_+3A_m">M</code></td>
<td>
<p>a square matrix or a data frame consisting of absolute choice
frequencies; row stimuli are chosen over column stimuli</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>thurstone</code> provides a front end for <code>glm</code>.  See Critchlow and
Fligner (1991) for more details.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>a vector of parameter estimates (scale values), first
element is set to zero</p>
</td></tr>
<tr><td><code>goodness.of.fit</code></td>
<td>
<p>the goodness of fit statistic including the
likelihood ratio fitted vs. saturated model (-2logL), the degrees of
freedom, and the p-value of the corresponding chi-square distribution</p>
</td></tr>
<tr><td><code>tm.glm</code></td>
<td>
<p>the output from a call to <code>glm</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Critchlow, D.E., &amp; Fligner, M.A. (1991).
Paired comparison, triple comparison, and ranking experiments as generalized
linear models, and their implementation in GLIM.
<em>Psychometrika</em>, <b>56</b>, 517&ndash;533.
doi: <a href="https://doi.org/10.1007/bf02294488">10.1007/bf02294488</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+strans">strans</a></code>, <code><a href="#topic+pcX">pcX</a></code>,
<code><a href="#topic+kendall.u">kendall.u</a></code>, <code><a href="#topic+circular">circular</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Taste data (David, 1988, p. 116)
taste &lt;- matrix(c( 0,  3,  2,  2,
                  12,  0, 11,  3,
                  13,  4,  0,  5,
                  13, 12, 10,  0), 4, 4, byrow=TRUE)
dimnames(taste) &lt;- setNames(rep(list(c("A1", "A2", "A3", "A4")), 2),
                            c("&gt;", "&lt;"))
thurstone(taste)  # Thurstone-Mosteller model fits OK
</code></pre>

<hr>
<h2 id='trineq'>Trinary Inequality</h2><span id='topic+trineq'></span><span id='topic+print.trineq'></span>

<h3>Description</h3>

<p>Checks if binary choice probabilities fulfill the trinary inequality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trineq(M, A = 1:I)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trineq_+3A_m">M</code></td>
<td>
<p>a square matrix or a data frame consisting of absolute choice
frequencies; row stimuli are chosen over column stimuli</p>
</td></tr>
<tr><td><code id="trineq_+3A_a">A</code></td>
<td>
<p>a list of vectors consisting of the stimulus aspects;
the default is <code>1:I</code>, where <code>I</code> is the number of stimuli</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For any triple of stimuli <code class="reqn">x, y, z</code>, the trinary inequality states
that, if <code class="reqn">P(x, y) &gt; 1/2</code> and <code class="reqn">(xy)z</code>, then
</p>
<p style="text-align: center;"><code class="reqn">R(x, y, z) &gt; 1,</code>
</p>

<p>where <code class="reqn">R(x, y, z) = R(x, y) R(y, z) R(z, x)</code>,
<code class="reqn">R(x, y) = P(x, y)/P(y, x)</code>, and <code class="reqn">(xy)z</code> denotes that <code class="reqn">x</code> and
<code class="reqn">y</code> share at least one aspect that <code class="reqn">z</code> does not have
(Tversky and Sattath, 1979, p. 554).
</p>
<p><code><a href="#topic+inclusion.rule">inclusion.rule</a></code> checks if a family of aspect sets is
representable by a tree.
</p>


<h3>Value</h3>

<p>Results checking the trinary inequality.
</p>
<table role = "presentation">
<tr><td><code>n</code></td>
<td>
<p>number of tests of the trinary inequality</p>
</td></tr>
<tr><td><code>prop</code></td>
<td>
<p>proportion of triples confirming the trinary inequality</p>
</td></tr>
<tr><td><code>quant</code></td>
<td>
<p>quantiles of <code class="reqn">R(x, y, z)</code></p>
</td></tr>
<tr><td><code>n.tests</code></td>
<td>
<p>number of transitivity tests performed</p>
</td></tr>
<tr><td><code>chkdf</code></td>
<td>
<p>data frame reporting <code class="reqn">R(x, y, z)</code> for each triple where
<code class="reqn">P(x, y) &gt; 1/2</code> and <code class="reqn">(xy)z</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Tversky, A., &amp; Sattath, S. (1979).
Preference trees.
<em>Psychological Review</em>, <b>86</b>, 542&ndash;573.
doi: <a href="https://doi.org/10.1037/0033-295X.86.6.542">10.1037/0033-295X.86.6.542</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+inclusion.rule">inclusion.rule</a></code>,
<code><a href="#topic+strans">strans</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)             # absolute choice frequencies
A &lt;- list(c(1,10), c(2,10), c(3,10),
          c(4,11), c(5,11), c(6,11),
          c(7,12), c(8,12), c(9,12))  # the structure of aspects
trineq(celebrities, A)        # check trinary inequality for tree A
trineq(celebrities, A)$chkdf  # trinary inequality for each triple
</code></pre>

<hr>
<h2 id='uscale'>Utility Scale of an EBA Choice Model</h2><span id='topic+uscale'></span>

<h3>Description</h3>

<p>Extract the (normalized) utility scale for an elimination-by-aspects (EBA)
model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uscale(object, norm = "sum", log = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uscale_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="uscale_+3A_norm">norm</code></td>
<td>
<p>either <code>sum</code>, so the scale values sum to unity (default);
or a number from 1 to number of stimuli, so this scale value becomes one;
or <code>NULL</code> (no normalization)</p>
</td></tr>
<tr><td><code id="uscale_+3A_log">log</code></td>
<td>
<p>should the log of the utility scale values be returned? Defaults
to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each utility scale value is defined as the sum of aspect values (EBA model
parameters) that characterize a given stimulus.  First these sums are
computed for all stimuli, then normalization (if any) is applied.  As
each type of normalization corresponds to a multiplication by a positive
real number, the ratio between scale values remains constant.
</p>


<h3>Value</h3>

<p>The (normalized) utility scale of the stimuli.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+cov.u">cov.u</a></code>, <code><a href="#topic+wald.test">wald.test</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugrisk)
A &lt;- list(c(1), c(2,7), c(3,7), c(4,7,8), c(5,7,8), c(6,7,8))
eba1 &lt;- eba(drugrisk[, , group = "male30"], A)  # EBA model

uscale(eba1)                    # sum-to-unity normalization
uscale(eba1, norm=1)            # u(alcohol) := 1
uscale(eba1, norm=5)            # u(heroine) := 1
uscale(eba1, norm=NULL)         # no normalization
uscale(eba1, norm=1, log=TRUE)  # log utility scale, log u(alcohol) := 0
</code></pre>

<hr>
<h2 id='wald.test'>Testing Linear Hypotheses in Elimination-by-Aspects (EBA) Models</h2><span id='topic+wald.test'></span><span id='topic+print.wald.test'></span>

<h3>Description</h3>

<p>Tests linear hypotheses of the form <code class="reqn">Cp = 0</code> in elimination-by-aspects
(EBA) models using the Wald test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wald.test(object, C, u.scale = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wald.test_+3A_object">object</code></td>
<td>
<p>an object of class <code>eba</code>, typically the result of a
call to <code><a href="#topic+eba">eba</a></code></p>
</td></tr>
<tr><td><code id="wald.test_+3A_c">C</code></td>
<td>
<p>a matrix of contrasts, specifying the linear hypotheses</p>
</td></tr>
<tr><td><code id="wald.test_+3A_u.scale">u.scale</code></td>
<td>
<p>logical, if TRUE the test is performed on the utility scale,
if FALSE the test is performed on the EBA parameters directly</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Wald test statistic,
</p>
<p style="text-align: center;"><code class="reqn">W = (Cp)' [C cov(p) C']^{-1} (Cp),</code>
</p>

<p>is approximately chi-square distributed with <code class="reqn">rk(C)</code> degrees of
freedom.
</p>
<p><code>C</code> is usually of full rank and must have as many columns as there
are parameters in <code>p</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>C</code></td>
<td>
<p>the matrix of contrasts, specifying the linear hypotheses</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>the Wald test statistic</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom (<code class="reqn">rk(C)</code>)</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>the p-value of the test</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+group.test">group.test</a></code>, <code><a href="#topic+uscale">uscale</a></code>,
<code><a href="#topic+cov.u">cov.u</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(celebrities)                     # absolute choice frequencies
A &lt;- list(c(1,10), c(2,10), c(3,10),
          c(4,11), c(5,11), c(6,11),
          c(7,12), c(8,12), c(9,12))  # the structure of aspects
eba1 &lt;- eba(celebrities, A)           # fit elimination-by-aspects model

## Test whether JU, CY, and AJF have equal utility scale values
C1 &lt;- rbind(c(0,0,0,1,-1, 0,0,0,0),
            c(0,0,0,1, 0,-1,0,0,0))
wald.test(eba1, C1)

## Test whether the three branch parameters are different
C2 &lt;- rbind(c(0,0,0,0,0,0,0,0,0,1,-1, 0),
            c(0,0,0,0,0,0,0,0,0,1, 0,-1))
wald.test(eba1, C2, u.scale = FALSE)
</code></pre>

<hr>
<h2 id='winetaste'>Wine Tasting Data</h2><span id='topic+winetaste'></span><span id='topic+ambilight'></span><span id='topic+redwines'></span>

<h3>Description</h3>

<p>Paired comparison judgments for two wine tasting studies:
<code>ambilight</code> includes the results of a study on the effect of ambient
lighting on the flavor of wine; <code>redwines</code> includes judgments on the
sensory quality of red wines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("winetaste")</code></pre>


<h3>Format</h3>

<p><code>ambilight</code> A data frame containing 230 observations on 10 variables:
</p>

<dl>
<dt>preference, fruitiness, spiciness, sweetness</dt><dd><p>Paired comparison of
class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>; judgments for one of the 6 ordered pairs
of the blue, red, and white lighting conditions.</p>
</dd>
<dt>age</dt><dd><p>subject age</p>
</dd>
<dt>gender</dt><dd><p>factor, subject gender</p>
</dd>
<dt>sensesmell</dt><dd><p>self-rating of sense of smell and taste.</p>
</dd>
<dt>likewine</dt><dd><p>self-rating of general liking of wine.</p>
</dd>
<dt>drinkwine</dt><dd><p>factor, frequency of wine consumption.</p>
</dd>
<dt>redwhite</dt><dd><p>factor, preference for red or white wine.</p>
</dd>
</dl>

<p><code>redwines</code> A data frame containing 11 observations on 7 variables:
</p>

<dl>
<dt>bitterness, fruitiness, sourness, roundness, preference</dt><dd><p>Paired
comparison of class <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>; judgments for all 10 pairs
from 5 red wines:  Primitivo di Manduria, Cotes du Rhone, Bourgogne,
Shiraz cuvee, Cabernet Sauvignon.</p>
</dd>
<dt>best</dt><dd><p>factor, Which of the five wines did you like best?</p>
</dd>
<dt>worst</dt><dd><p>factor, Which of the five wines did you like worst?</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>ambilight</code> data are from Experiment 3 in Oberfeld et al. (2009).
The <code>redwines</code> data were collected among the members of the Sound
Quality Research Unit (SQRU), Department of Acoustics, Aalborg University,
Denmark, in 2004. Details of the red wines are available as an attribute of
the <code>preference</code> variable (see Examples).
</p>


<h3>References</h3>

<p>Oberfeld, D., Hecht, H., Allendorf, U., &amp; Wickelmaier, F. (2009).
Ambient lighting modifies the flavor of wine.
<em>Journal of Sensory Studies</em>,
<b>24</b>(6), 797&ndash;832.
doi: <a href="https://doi.org/10.1111/j.1745-459X.2009.00239.x">10.1111/j.1745-459X.2009.00239.x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eba">eba</a></code>, <code><a href="#topic+eba.order">eba.order</a></code>, <code><a href="psychotools.html#topic+paircomp">paircomp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>requireNamespace("psychotools")
data(winetaste)

## No effect of ambient lighting on flavor (Oberfeld et al., 2009)

m &lt;- lapply(ambilight[, c("preference", "fruitiness",
                          "spiciness", "sweetness")],
            function(x) eba.order(summary(x, pcmatrix = TRUE)))
lapply(m, summary)

u &lt;- sapply(m, uscale, norm = 3)
dotchart(
  u, xlim = c(0.5, 2), pch = 16, panel.first = abline(v = 1, col = "gray"),
  main = "Ambient lighting and the flavor of wine",
  xlab = "Utility scale value (Davidson-Beaver model)"
)
ci &lt;- sapply(m, function(x) 1.96 * sqrt(diag(cov.u(x))))
arrows(
  u - ci, c(16:18, 11:13, 6:8, 1:3), u + ci, c(16:18, 11:13, 6:8, 1:3),
.05, 90, 3)
mtext("Oberfeld et al. (2009)", line = 0.5)

## Sensory quality of red wines

psychotools::covariates(redwines$preference)  # details of the wines

m &lt;- lapply(redwines[, c("bitterness", "fruitiness", "sourness",
                         "roundness", "preference")],
            function(x) eba(summary(x, pcmatrix = TRUE)))
lapply(m, summary)

u &lt;- sapply(m, uscale)
dotchart(
  u[order(u[, "preference"]), ], log = "x",
  panel.first = abline(v = 1/5, col = "gray"),
  main = "SQRU red wine tasting",
  xlab = "Utility scale value (BTL model), choice proportion (+)"
)
points(as.vector(
  prop.table(table(redwines$best))[order(u[, "preference"])]
), 1:5, pch = 3)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
