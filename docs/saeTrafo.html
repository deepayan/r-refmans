<!DOCTYPE html><html><head><title>Help for package saeTrafo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {saeTrafo}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#saeTrafo'><p>The R Package saeTrafo for Estimating unit-level Small Area Models under</p>
Transformations</a></li>
<li><a href='#compare_plot'><p>Shows plots for the comparison of estimates</p></a></li>
<li><a href='#compare_pred'><p>Compare predictions of model objects</p></a></li>
<li><a href='#estimators'><p>Presents point, MSE and CV estimates</p></a></li>
<li><a href='#eusilcA_pop'><p>Simulated eusilc data - population data</p></a></li>
<li><a href='#eusilcA_smp'><p>Simulated eusilc data - sample data</p></a></li>
<li><a href='#fixef'><p>Extract fixed effects from an saeTrafo object</p></a></li>
<li><a href='#getData'><p>Extract saeTrafo object data</p></a></li>
<li><a href='#getGroups'><p>Extract grouping factors from an saeTrafo object</p></a></li>
<li><a href='#getGroupsFormula'><p>Extract grouping formula from a saeTrafo object</p></a></li>
<li><a href='#getResponse'><p>Extract response variable from an saeTrafo object</p></a></li>
<li><a href='#getVarCov'><p>Extract variance-covariance matrix from an saeTrafo object</p></a></li>
<li><a href='#intervals'><p>Confidence intervals on coefficients of an saeTrafo object</p></a></li>
<li><a href='#load_shapeaustria'><p>Loading the shape file for Austrian districts</p></a></li>
<li><a href='#map_plot'><p>Visualizes regional disaggregated estimates on a map</p></a></li>
<li><a href='#NER_Trafo'><p>Nested error regression Model under transformations</p></a></li>
<li><a href='#plot.saeTrafo'><p>Plots for an saeTrafo object</p></a></li>
<li><a href='#pop_area_size'><p>Aggregates from simulated eusilc population data: domain sizes</p></a></li>
<li><a href='#pop_cov'><p>Aggregates from simulated eusilc population data: domain-specific covariances</p></a></li>
<li><a href='#pop_mean'><p>Aggregates from simulated eusilc population data: domain-specific means</p></a></li>
<li><a href='#predict.NER'><p>Predictions from saeTrafo objects</p></a></li>
<li><a href='#qqnorm.saeTrafo'><p>Quantile-quantile plots for an saeTrafo object</p></a></li>
<li><a href='#ranef'><p>Extract random effects of saeTrafo object</p></a></li>
<li><a href='#saeTrafoObject'><p>Fitted saeTrafoObject</p></a></li>
<li><a href='#summaries.saeTrafo'><p>Summarizes an saeTrafo object</p></a></li>
<li><a href='#write.excel'><p>Exports an saeTrafo Object to an Excel file or OpenDocument Spreadsheet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Transformations for Unit-Level Small Area Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Nora Würz [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nora Würz &lt;nora.wuerz@uni-bamberg.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The aim of this package is to offer new methodology for unit-level 
    small area models under transformations and limited population auxiliary 
    information. In addition to this new methodology, the widely used nested 
    error regression model without transformations (see "An Error-Components 
    Model for Prediction of County Crop Areas Using Survey and Satellite Data" 
    by Battese, Harter and Fuller (1988) &lt;<a href="https://doi.org/10.1080%2F01621459.1988.10478561">doi:10.1080/01621459.1988.10478561</a>&gt;) 
    and its well-known uncertainty estimate (see "The estimation of the mean 
    squared error of small-area estimators" by Prasad and Rao (1990) 
    &lt;<a href="https://doi.org/10.1080%2F01621459.1995.10476570">doi:10.1080/01621459.1995.10476570</a>&gt;) are provided. In this package, the 
    log transformation and the data-driven log-shift transformation are 
    provided. If a transformation is selected, an appropriate method is chosen 
    depending on the respective input of the population data: Individual 
    population data (see "Empirical best prediction under a nested error model 
    with log transformation" by Molina and Martín (2018) 
    &lt;<a href="https://doi.org/10.1214%2F17-aos1608">doi:10.1214/17-aos1608</a>&gt;) but also aggregated population data (see 
    "Estimating regional income indicators under transformations and access to 
    limited population auxiliary information" by Würz, Schmid and Tzavidis 
    &lt;unpublished&gt;) can be entered. Especially under limited data access, new 
    methodologies are provided in saeTrafo. Several options are available to 
    assess the used model and to judge, present and export its results. For a 
    detailed description of the package and the methods used see the 
    corresponding vignette.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/NoraWuerz/saeTrafo">https://github.com/NoraWuerz/saeTrafo</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>nlme, emdi, stats, sfsmisc, parallelMap, MuMIn, ggplot2,
moments, openxlsx, reshape2, HLMdiag, gridExtra, stringr,
readODS, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>simFrame, sf, graphics, R.rsp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Copyright:</td>
<td>inst/COPYRIGHTS</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-11 12:32:34 UTC; ba8em6</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-11 13:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='saeTrafo'>The R Package saeTrafo for Estimating unit-level Small Area Models under
Transformations</h2><span id='topic+saeTrafo'></span><span id='topic+saeTrafo-package'></span>

<h3>Description</h3>

<p>The package <span class="pkg">saeTrafo</span> supports estimating regional means based on the
nested error regression model (<cite>Battese et al., 1988</cite>).
Therefore, point estimation and mean squared error estimation
(<cite>Prasad and Rao, 1990</cite>) for the classical model is offered.
In addition to the classical model, the logarithmic and the data-driven
log-shift transformation are provided.
The core function <code><a href="#topic+NER_Trafo">NER_Trafo</a></code> allows several options to enter
population data: Either individual population data or only aggregates can be
entered. If full population data is given, the method of
<cite>Molina and Martín (2018)</cite> is applied.
Compared to other small area packages, these transformations are
accessible in the absence of population micro-data. Only population
aggregates (mean values, population sizes and preferably also covariances)
need to be supplied. The methodology for point and mean squared error
estimates is described in <cite>Wuerz et al. (2022)</cite> and is made available
in a user-friendly way within <span class="pkg">saeTrafo</span>.
</p>


<h3>Details</h3>

<p>The estimation function is called <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>. For this
function, several methods are available such as
<code><a href="#topic+estimators.saeTrafo">estimators.saeTrafo</a></code> and
<code><a href="#topic+summaries.saeTrafo">summaries.saeTrafo</a></code>. For a full list, please see
<code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>.
Furthermore, functions <code><a href="#topic+map_plot">map_plot</a></code> and <code><a href="#topic+write.excel">write.excel</a></code>
help to visualize and export results. An overview of all currently provided
functions can be requested by <code>library(help=saeTrafo)</code>.
</p>


<h3>References</h3>

<p>Battese, G.E., Harter, R.M. and Fuller, W.A. (1988). An Error-Components
Model for Predictions of County Crop Areas Using Survey and Satellite Data.
Journal of the American Statistical Association, Vol.83, No. 401,
28-36. <br /> <br />
Molina, I. and Martín, N. (2018). Empirical best prediction under a nested
error model with log transformation. The Annals of Statistics, Vol.46, No. 5,
1961–1993. <br /> <br />
Prasad, N.N., Rao, J.N.K. (1990). The estimation of the mean squared error of
small-area estimators. Journal of the American statistical association,
Vol.85, No. 409, 163-171. <br /> <br />
Wuerz, N., Schmid, T., Tzavidis, N. (2022). Estimating regional income
indicators under transformations and access to limited population auxiliary
information. Unpublished.
</p>

<hr>
<h2 id='compare_plot'>Shows plots for the comparison of estimates</h2><span id='topic+compare_plot'></span><span id='topic+compare_plots_saeTrafo'></span><span id='topic+compare_plot.NER'></span>

<h3>Description</h3>

<p>Function <code>compare_plot</code> is a generic function used to produce plots
comparing point and existing MSE/CV estimates of direct and model-based
estimation for the Mean.
</p>
<p>Methods <code>compare_plot.NER</code> produce plots comparing point and existing
MSE/CV estimates of direct and model-based estimation from <code>NER_Trafo</code>.
The direct and model-based point estimates are compared by a scatter plot and
a line plot. If the input arguments MSE and CV are set to TRUE, two extra
plots are created, respectively: the MSE/CV estimates of the direct and
model-based estimates are compared by boxplots and scatter plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_plot(
  model,
  direct,
  MSE = FALSE,
  CV = FALSE,
  label = "orig",
  color = c("blue", "lightblue3"),
  shape = c(16, 16),
  line_type = c("solid", "solid"),
  gg_theme = NULL,
  ...
)

## S3 method for class 'NER'
compare_plot(
  model = NULL,
  direct = NULL,
  MSE = FALSE,
  CV = FALSE,
  label = "orig",
  color = c("blue", "lightblue3"),
  shape = c(16, 16),
  line_type = c("solid", "solid"),
  gg_theme = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_plot_+3A_model">model</code></td>
<td>
<p>a model object of type &quot;NER&quot;, representing point and optional
MSE estimates.</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_direct">direct</code></td>
<td>
<p>an object of type &quot;direct&quot; from &quot;emdi&quot;, representing point
and MSE estimates. For more information on how to generate direct estimates,
please see <code><a href="emdi.html#topic+direct">direct</a></code>.</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_mse">MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the MSE estimates of the direct
and model-based estimates are compared via boxplots and scatter plots.</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_cv">CV</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the coefficient of variation
estimates of the direct and model-based estimates are compared via boxplots
and scatter plots.</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_label">label</code></td>
<td>
<p>argument that enables to customize title and axis labels. There
are three options to label the evaluation plots: (i) original labels
(&quot;orig&quot;), (ii) axis labels but no title (&quot;no_title&quot;), (iii) neither axis
labels nor title (&quot;blank&quot;).</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_color">color</code></td>
<td>
<p>a vector with two elements. The first color determines
the color for the regression line in the scatter plot and the color for
the direct estimates in the remaining plots. The second color specifies the
color of the intersection line in the scatter plot and the color for the
model-based estimates in the remaining plots. Defaults to
c(&quot;blue&quot;, &quot;lightblue3&quot;).</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_shape">shape</code></td>
<td>
<p>a numeric vector with two elements. The first shape determines
the shape of the points in the scatterplot and the shape of the points for
the direct estimates in the remaining plots. The second shape determines
the shape for the points for the model-based estimates. The options
are numbered from 0 to 25. Defaults to c(16, 16).</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_line_type">line_type</code></td>
<td>
<p>a character vector with two elements. The first line type
determines the line type for the regression line in the scatter plot and the
line type for the direct estimates in the remaining plots. The second line
type specifies the line type of the intersection line in the scatter plot and
the line type for the model-based estimates in the remaining plots. The
options are: &quot;twodash&quot;, &quot;solid&quot;, &quot;longdash&quot;, &quot;dotted&quot;, &quot;dotdash&quot;, &quot;dashed&quot;
and &quot;blank&quot;. Defaults to  c(&quot;solid&quot;, &quot;solid&quot;).</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_gg_theme">gg_theme</code></td>
<td>
<p><code><a href="ggplot2.html#topic+theme">theme</a></code> list from package <span class="pkg">ggplot2</span>.
For using this argument, package <span class="pkg">ggplot2</span> must be loaded via
<code>library(ggplot2)</code>. See also Example 2.</p>
</td></tr>
<tr><td><code id="compare_plot_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Since all of the comparisons need a direct estimator, the plots are
only created for in-sample domains.
</p>


<h3>Value</h3>

<p>Plots comparing direct and model-based estimators for the Mean
obtained by <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>
<p>A scatter plot and a line plot comparing direct and model-based
estimators for each selected indicator obtained by
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. If the input arguments MSE and CV are set to
<code>TRUE</code> two extra plots are created, respectively: the MSE/CV estimates
of the direct and model-based estimates are compared by boxplots and scatter
plots.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="emdi.html#topic+direct">direct</a></code>,
<code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Examples for creating plots to compare the saeTrafo object with direct
# estimates (produced by the package emdi)

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

# Get direct estimates from the R-package emdi
require(emdi)
library(emdi)
emdi_direct &lt;- direct(y = "eqIncome", smp_data = eusilcA_smp,
                      smp_domains = "district", weights = "weight",
                      var = TRUE, na.rm = TRUE)

# Please detach emdi or use saeTrafo::compare_plot

# Example 1: Comparison plots with uncertainty assessment plots
# (for MSE and CV)
saeTrafo::compare_plot(model = NER_model, direct = emdi_direct, MSE = TRUE,
                       CV = TRUE)

# Example 2: Personalize comparison plots using the options provided with
# this function and ggplot themes
require(ggplot2)
library(ggplot2)
saeTrafo::compare_plot(model = NER_model, direct = emdi_direct, MSE = TRUE,
                       CV = TRUE, label = "no_title",
                       color = c("orange", "green"), shape = c(1,2),
                       line_type = c("dotted", "dashed"),
                       gg_theme = theme(
                          text = element_text(size = 20, color = "blue"),
                          panel.border = element_rect(linetype = "dashed",
                                                      fill = "NA")))


</code></pre>

<hr>
<h2 id='compare_pred'>Compare predictions of model objects</h2><span id='topic+compare_pred'></span><span id='topic+compare_pred.saeTrafo'></span>

<h3>Description</h3>

<p>Function <code>compare_pred</code> is a generic function used to compare
predictions of two model objects.
</p>
<p>Method <code>compare_pred.saeTrafo</code> compares predictions of two saeTrafo
objects or a saeTrafo object and a emdi object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_pred(object1, object2, MSE = FALSE, ...)

## S3 method for class 'saeTrafo'
compare_pred(object1, object2, MSE = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_pred_+3A_object1">object1</code></td>
<td>
<p>an object of type &quot;saeTrafo&quot;.</p>
</td></tr>
<tr><td><code id="compare_pred_+3A_object2">object2</code></td>
<td>
<p>an object of type &quot;saeTrafo&quot; or &quot;emdi&quot;
(<code><a href="emdi.html#topic+emdiObject">emdiObject</a></code>).</p>
</td></tr>
<tr><td><code id="compare_pred_+3A_mse">MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, MSE estimates are returned.
Defaults to <code>FALSE</code> and than point estimates are returned.</p>
</td></tr>
<tr><td><code id="compare_pred_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the point estimates or the MSE estimates
(if <code>MSE</code> is set to <code>TRUE</code>) of both objects. If column names are
duplicated, the suffixes &quot;_1&quot; and &quot;_2&quot; are added to their names. &quot;_1&quot; and
&quot;_2&quot; standing for object1 and object2, respectively.
</p>


<h3>See Also</h3>

<p><code><a href="emdi.html#topic+emdi">emdi</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>,
<code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example comparing two saeTrafo objects


# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model 1
NER_model_1 &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                         self_empl + unempl_ben + age_ben + surv_ben +
                         sick_ben + dis_ben + rent + fam_allow +
                         house_allow + cap_inv + tax_adj,
                         smp_domains = "district",
                         pop_area_size = pop_area_size,
                         pop_mean = pop_mean, pop_cov = pop_cov,
                         smp_data = eusilcA_smp, MSE = TRUE)

# Nested error regression model 2
NER_model_2 &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                         self_empl + unempl_ben + age_ben + surv_ben,
                         smp_domains = "district",
                         pop_area_size = pop_area_size,
                         pop_mean = pop_mean, pop_cov = pop_cov,
                         smp_data = eusilcA_smp, MSE = TRUE)

# Generate a data frame for the comparison of point estimates
compare_pred(NER_model_1, NER_model_2)

# Generate a data frame for the comparison of MSE estimates
compare_pred(NER_model_1, NER_model_2, MSE = TRUE)


</code></pre>

<hr>
<h2 id='estimators'>Presents point, MSE and CV estimates</h2><span id='topic+estimators'></span><span id='topic+estimators.saeTrafo'></span>

<h3>Description</h3>

<p>Function <code>estimators</code> is a generic function used to present point and
mean squared error (MSE) estimates. Furthermore, it calculates from both the
coefficients of variation (CV).
</p>
<p>Method <code>estimators.saeTrafo</code> presents point and MSE estimates.
Coefficients of variation are calculated using these estimators. The returned
object is suitable for printing with the method
<code>print.estimators.saeTrafo</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimators(object, MSE, CV, ...)

## S3 method for class 'saeTrafo'
estimators(object, MSE = FALSE, CV = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimators_+3A_object">object</code></td>
<td>
<p>an object of type &quot;saeTrafo&quot;, representing point and,
if chosen, MSE estimates.</p>
</td></tr>
<tr><td><code id="estimators_+3A_mse">MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, MSE estimates are added to the
data frame of point estimates. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="estimators_+3A_cv">CV</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, coefficients of variation are
added to the data frame of point estimates. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="estimators_+3A_...">...</code></td>
<td>
<p>other parameters that can be passed to function <code>estimators</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Objects of class &quot;estimators.saeTrafo&quot; have methods for following
generic functions: <code>head</code> and <code>tail</code> (for default documentation,
see <code><a href="utils.html#topic+head">head</a></code>, <code><a href="utils.html#topic+tail">tail</a></code>),
<code>as.matrix</code> (for default documentation, see <code><a href="base.html#topic+matrix">matrix</a></code>),
<code>as.data.frame</code> (for default documentation, see
<code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>), <code>subset</code> (for default documentation,
see <code><a href="base.html#topic+subset">subset</a></code>).
</p>


<h3>Value</h3>

<p>The return of <code>estimators.saeTrafo</code> is an object of type
&quot;estimators.saeTrafo&quot; with point and/or MSE estimates and/or calculated CV's
from <code>saeTrafoObject$ind</code> and, if chosen, <code>saeTrafoObject$MSE</code>.
These objects contain two elements, one data frame
<code>ind</code> and a character naming the indicator or indicator group
<code>ind_name</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>,  <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example for presenting point, MSE, and CV estimates for a saeTrafo object

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

sae_mean &lt;- estimators(NER_model, MSE = TRUE, CV = TRUE)
class(sae_mean)

# use generic functions for estimators.saeTrafo object
print(sae_mean)
head(sae_mean)
tail(sae_mean)
as.matrix(sae_mean)
as.data.frame(sae_mean)
subset(sae_mean)


</code></pre>

<hr>
<h2 id='eusilcA_pop'>Simulated eusilc data - population data</h2><span id='topic+eusilcA_pop'></span>

<h3>Description</h3>

<p>The data set is synthetic EU-SILC data based on the data set
<code><a href="simFrame.html#topic+eusilcP">eusilcP</a></code> from package <span class="pkg">simFrame</span>. The data set is
reduced to 17 variables containing three regional variables for the states
and districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eusilcA_pop
</code></pre>


<h3>Format</h3>

<p>A data frame with 25000 observations and 17 variables:
</p>

<dl>
<dt>eqIncome</dt><dd><p>numeric; a simplified version of the equivalized household
income.</p>
</dd>
<dt>eqsize</dt><dd><p>numeric; the equivalized household size according to the
modified OECD scale.</p>
</dd>
<dt>gender</dt><dd><p>factor; the person's gender (levels: male and female).</p>
</dd>
<dt>cash</dt><dd><p>numeric; employee cash or near cash income (net).</p>
</dd>
<dt>self_empl</dt><dd><p>numeric; cash benefits or losses from self-employment
(net).</p>
</dd>
<dt>unempl_ben</dt><dd><p>numeric; unemployment benefits (net).</p>
</dd>
<dt>age_ben</dt><dd><p>numeric; old-age benefits (net).</p>
</dd>
<dt>surv_ben</dt><dd><p>numeric; survivor's benefits (net).</p>
</dd>
<dt>sick_ben</dt><dd><p>numeric; sickness benefits (net).</p>
</dd>
<dt>dis_ben</dt><dd><p>numeric; disability benefits (net).</p>
</dd>
<dt>rent</dt><dd><p>numeric; income from rental of a property or land (net).</p>
</dd>
<dt>fam_allow</dt><dd><p>numeric; family/children related allowances (net).</p>
</dd>
<dt>house_allow</dt><dd><p>numeric; housing allowances (net).</p>
</dd>
<dt>cap_inv</dt><dd><p>numeric; interest, dividends, profit from capital investments
in unincorporated business (net).</p>
</dd>
<dt>tax_adj</dt><dd><p>numeric; repayments/receipts for tax adjustment (net).</p>
</dd>
<dt>state</dt><dd><p>factor; state (nine levels).</p>
</dd>
<dt>district</dt><dd><p>factor; districts (94 levels).</p>
</dd>
</dl>


<hr>
<h2 id='eusilcA_smp'>Simulated eusilc data - sample data</h2><span id='topic+eusilcA_smp'></span>

<h3>Description</h3>

<p>The data set is a simple random sample of data set <code><a href="#topic+eusilcA_pop">eusilcA_pop</a></code>
which is based on <code><a href="simFrame.html#topic+eusilcP">eusilcP</a></code> from package
<span class="pkg">simFrame</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eusilcA_smp
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 observations and 18 variables:
</p>

<dl>
<dt>eqIncome</dt><dd><p>numeric; a simplified version of the equivalized household
income.</p>
</dd>
<dt>eqsize</dt><dd><p>numeric; the equivalized household size according to the
modified OECD scale.</p>
</dd>
<dt>gender</dt><dd><p>factor; the person's gender (levels: male and female).</p>
</dd>
<dt>cash</dt><dd><p>numeric; employee cash or near cash income (net).</p>
</dd>
<dt>self_empl</dt><dd><p>numeric; cash benefits or losses from self-employment
(net).</p>
</dd>
<dt>unempl_ben</dt><dd><p>numeric; unemployment benefits (net).</p>
</dd>
<dt>age_ben</dt><dd><p>numeric; old-age benefits (net).</p>
</dd>
<dt>surv_ben</dt><dd><p>numeric; survivor's benefits (net).</p>
</dd>
<dt>sick_ben</dt><dd><p>numeric; sickness benefits (net).</p>
</dd>
<dt>dis_ben</dt><dd><p>numeric; disability benefits (net).</p>
</dd>
<dt>rent</dt><dd><p>numeric; income from rental of a property or land (net).</p>
</dd>
<dt>fam_allow</dt><dd><p>numeric; family/children related allowances (net).</p>
</dd>
<dt>house_allow</dt><dd><p>numeric; housing allowances (net).</p>
</dd>
<dt>cap_inv</dt><dd><p>numeric; interest, dividends, profit from capital investments
in unincorporated business (net).</p>
</dd>
<dt>tax_adj</dt><dd><p>numeric; repayments/receipts for tax adjustment (net).</p>
</dd>
<dt>state</dt><dd><p>factor; state (nine levels).</p>
</dd>
<dt>district</dt><dd><p>factor; districts (94 levels).</p>
</dd>
<dt>weight</dt><dd><p>numeric; constant weight.</p>
</dd>
</dl>


<hr>
<h2 id='fixef'>Extract fixed effects from an saeTrafo object</h2><span id='topic+fixef'></span><span id='topic+fixed.effects'></span><span id='topic+fixef.NER'></span><span id='topic+fixed.effects.NER'></span>

<h3>Description</h3>

<p>Method <code>fixef.NER</code> extracts the fixed effects from an saeTrafo object of
class &quot;NER&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
fixef(object, ...)

## S3 method for class 'NER'
fixed.effects(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fixef_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="fixef_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The alias <code>fixed.effects</code> can also be used instead of
<code>fixef</code>. The generic function <code>fixef</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though the
<span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation,
see <code><a href="nlme.html#topic+fixed.effects">fixed.effects</a></code>.
</p>


<h3>Value</h3>

<p>A vector containing the fixed effects is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+fixed.effects">fixed.effects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example to extract fixed effects

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

fixef(NER_model)

</code></pre>

<hr>
<h2 id='getData'>Extract saeTrafo object data</h2><span id='topic+getData'></span><span id='topic+getData.NER'></span>

<h3>Description</h3>

<p>Method <code>getData.NER</code> extracts the data frame used to fit the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
getData(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getData_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="getData_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>getData</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though the
<span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+getData">getData</a></code>.
</p>


<h3>Value</h3>

<p>Data frame used to fit the model. For &quot;NER&quot; the (untransformed)
sample data is returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+getData">getData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example to extract object data

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

getData(NER_model)
</code></pre>

<hr>
<h2 id='getGroups'>Extract grouping factors from an saeTrafo object</h2><span id='topic+getGroups'></span><span id='topic+getGroups.NER'></span>

<h3>Description</h3>

<p>Method <code>getGroups.NER</code> extracts grouping factors from a saeTrafo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
getGroups(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getGroups_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="getGroups_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>getGroups</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though
the <span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+getGroups">getGroups</a></code>.
</p>


<h3>Value</h3>

<p>A vector containing the grouping factors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+getGroups">getGroups</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract grouping factors

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

getGroups(NER_model)
</code></pre>

<hr>
<h2 id='getGroupsFormula'>Extract grouping formula from a saeTrafo object</h2><span id='topic+getGroupsFormula'></span><span id='topic+getGroupsFormula.NER'></span>

<h3>Description</h3>

<p>Method <code>getGroupsFormula.NER</code> extracts the grouping formula from an
saeTrafo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
getGroupsFormula(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getGroupsFormula_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="getGroupsFormula_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>getGroupsFormula</code> is imported from
package <span class="pkg">nlme</span> and re-exported to make the S3-methods available, even
though the <span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+getGroupsFormula">getGroupsFormula</a></code>.
</p>


<h3>Value</h3>

<p>A one-sided formula.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code> <code><a href="nlme.html#topic+getGroupsFormula">getGroupsFormula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract grouping formula

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

getGroupsFormula(NER_model)
</code></pre>

<hr>
<h2 id='getResponse'>Extract response variable from an saeTrafo object</h2><span id='topic+getResponse'></span><span id='topic+getResponse.NER'></span>

<h3>Description</h3>

<p>Method <code>getResponse.NER</code> extracts the response variable from a saeTrafo
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
getResponse(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getResponse_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="getResponse_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>getResponse</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though
the <span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+getResponse">getResponse</a></code>.
</p>


<h3>Value</h3>

<p>Vector containing the response variable.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+getResponse">getResponse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract the response variable

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

getResponse(NER_model)
</code></pre>

<hr>
<h2 id='getVarCov'>Extract variance-covariance matrix from an saeTrafo object</h2><span id='topic+getVarCov'></span><span id='topic+getVarCov.NER'></span>

<h3>Description</h3>

<p>Method <code>getVarCov.NER</code> extracts the variance-covariance matrix from a
fitted model of class &quot;NER&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
getVarCov(obj, individuals = 1, type = "random.effects", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getVarCov_+3A_obj">obj</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="getVarCov_+3A_individuals">individuals</code></td>
<td>
<p>vector of levels of the in-sample domains can be specified
for the types &quot;<code>conditional</code>&quot; or &quot;<code>marginal</code>&quot;.</p>
</td></tr>
<tr><td><code id="getVarCov_+3A_type">type</code></td>
<td>
<p>a character that determines the type of variance-covariance
matrix. Types that can be chosen
(i) random-effects variance-covariance matrix (&quot;<code>random.effects</code>&quot;),
(ii) conditional variance-covariance matrix (&quot;<code>conditional</code>&quot;),
(iii) marginal variance-covariance matrix (&quot;<code>marginal</code>&quot;). Defaults to
&quot;<code>random.effects</code>&quot;.</p>
</td></tr>
<tr><td><code id="getVarCov_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>getVarCov</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though the
<span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+getVarCov">getVarCov</a></code>.
</p>


<h3>Value</h3>

<p>A variance-covariance matrix or a list of variance-covariance
matrices, if more than one individual is selected. For method
<code>getVarCov.NER</code>, the dimensions of the matrices are 1 x 1 for type
&quot;<code>random.effects</code>&quot; and number of in-sample domains x number of
in-sample domains for types &quot;<code>conditional</code>&quot; and &quot;<code>marginal</code>&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+getVarCov">getVarCov</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract variance-covariance matrix

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

getVarCov(NER_model)
</code></pre>

<hr>
<h2 id='intervals'>Confidence intervals on coefficients of an saeTrafo object</h2><span id='topic+intervals'></span><span id='topic+intervals.NER'></span>

<h3>Description</h3>

<p>Method <code>intervals.NER</code> provides the approximate confidence intervals on
the coefficients (fixed effects) of an saeTrafo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
intervals(object, level = 0.95, parm = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intervals_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="intervals_+3A_level">level</code></td>
<td>
<p>an optional numeric value with the confidence level for the
intervals. Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="intervals_+3A_parm">parm</code></td>
<td>
<p>vector of names to specify which parameters are to be given
confidence intervals. If <code>NULL</code>, all parameters are taken into account.
Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="intervals_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generic function <code>intervals</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though the
<span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+intervals">intervals</a></code>.
</p>


<h3>Value</h3>

<p>A matrix with rows corresponding to the parameters and columns
containing the lower confidence limits (lower), the
estimated values (est.), and upper confidence limits (upper).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+intervals">intervals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract confidence intervals on coefficients

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

intervals(NER_model)
</code></pre>

<hr>
<h2 id='load_shapeaustria'>Loading the shape file for Austrian districts</h2><span id='topic+load_shapeaustria'></span>

<h3>Description</h3>

<p>The function simplifies to load the shape file for Austrian districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_shapeaustria()
</code></pre>


<h3>Details</h3>

<p>The shape file contains the borders of Austrian districts. Thus, it
can be used for the visualization of estimation results for Austrian
districts.
</p>


<h3>Value</h3>

<p>A shape file of class <code>sf</code>.
</p>

<hr>
<h2 id='map_plot'>Visualizes regional disaggregated estimates on a map</h2><span id='topic+map_plot'></span>

<h3>Description</h3>

<p>Function <code>map_plot</code> creates spatial visualizations of the estimates
obtained by small area estimation methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_plot(
  object,
  MSE = FALSE,
  CV = FALSE,
  map_obj = NULL,
  map_dom_id = NULL,
  map_tab = NULL,
  color = c("white", "red4"),
  scale_points = NULL,
  guide = "colourbar",
  return_data = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_plot_+3A_object">object</code></td>
<td>
<p>an object of type <code>saeTrafo</code>, containing the estimates to
be visualized.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_mse">MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the MSE is also visualized.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_cv">CV</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, the CV is also visualized.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_map_obj">map_obj</code></td>
<td>
<p>an <code>sf</code> object (map object) as defined by the
<span class="pkg">sf</span> package on which the data should be visualized.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_map_dom_id">map_dom_id</code></td>
<td>
<p>a character string containing the name of a variable in
<code>map_obj</code> that indicates the domains.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_map_tab">map_tab</code></td>
<td>
<p>a <code>data.frame</code> object with two columns that match the
domain variable from the census data set (first column) with the domain
variable in the map_obj (second column). This should only be used if the IDs
in both objects differ.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_color">color</code></td>
<td>
<p>a <code>vector</code> of length 2 defining the lowest and highest
color in the plots.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_scale_points">scale_points</code></td>
<td>
<p>a numeric vector of length two. This
scale will be used for every plot.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_guide">guide</code></td>
<td>
<p>character passed to <code>scale_fill_gradient</code> from
<span class="pkg">ggplot2</span>. Possible values are &quot;none&quot;, &quot;colourbar&quot;, and &quot;legend&quot;.
Defaults to &quot;colourbar&quot;.</p>
</td></tr>
<tr><td><code id="map_plot_+3A_return_data">return_data</code></td>
<td>
<p>if set to <code>TRUE</code>, a fortified data frame including
the map data as well as the chosen indicators is returned. Customized maps
can easily be obtained from this data frame via the package <span class="pkg">ggplot2</span>.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates the plots demanded and, if selected, a fortified data.frame
containing the mapdata and chosen indicators.
</p>


<h3>See Also</h3>

<p><code><a href="sf.html#topic+sf">sf</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>,
<code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Examples for creating maps to visualize the saeTrafo estimates

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

# Load shape file
load_shapeaustria()

# Example 1: Map plots with uncertainty plots (for MSE and CV)
map_plot(NER_model, MSE = TRUE, CV = TRUE, map_obj = shape_austria_dis,
         map_dom_id = "PB")

# Example 2: Personalize map plot for point estimates
map_plot(NER_model, map_obj = shape_austria_dis, map_dom_id = "PB",
         color = c("white", "darkblue"),
         scale_points = c(0, max(NER_model$ind$Mean)))

# Example 3: More options to personalize map plot by using return_data = TRUE
# and ggplot2
require(ggplot2)
library(ggplot2)
data_plot &lt;- map_plot(NER_model, map_obj = shape_austria_dis, map_dom_id = "PB",
                      return_data = TRUE)
ggplot(data_plot, aes(long = NULL, lat = NULL,
                      group = "PB", fill = Mean))+
       geom_sf(color = "black") +
       theme_void() +
       ggtitle("Personalized map") +
       scale_fill_gradient2(low = "red", mid = "white", high = "darkgreen",
                            midpoint = 20000)

# Example 4: Create a suitable mapping table to use numerical identifiers of
# the shape file

# First find the right order
dom_ord &lt;- match(shape_austria_dis$PB, NER_model$ind$Domain)

#Create the mapping table based on the order obtained above
map_tab &lt;- data.frame(pop_data_id = NER_model$ind$Domain[dom_ord],
                      shape_id = shape_austria_dis$BKZ)

# Create map plot for mean indicator - point and CV estimates but no MSE
# using the numerical domain identifiers of the shape file
map_plot(object = NER_model, MSE = FALSE, CV = TRUE,
         map_obj = shape_austria_dis,
         map_dom_id = "BKZ", map_tab = map_tab)


</code></pre>

<hr>
<h2 id='NER_Trafo'>Nested error regression Model under transformations</h2><span id='topic+NER_Trafo'></span>

<h3>Description</h3>

<p>Function <code>NER_Trafo</code> estimates small area means based on the
(transformed) nested error regression (NER) model
(<cite>Battese et al., 1988</cite>).
In contrast to the empirical best predictor of <cite>Molina and Rao (2010)</cite>,
which is implemented in the package <span class="pkg">emdi</span> (<code><a href="emdi.html#topic+ebp">ebp</a></code>), no
unit-level population data are required.<br /> <br />
<code>NER_Trafo</code> supports the log as well as the data-driven log-shift
transformation. Especially for skewed variables, (data-driven)
transformations are useful to meet the model assumptions for the error terms.
If a transformation is chosen and aggregates (means and covariance) are
simultaneously provided for the population, point estimates are produced by
the method of <cite>Wuerz et al. (2022)</cite>, which uses kernel density
estimation to resolve the issue of not having access to population
micro-data.
In the case that population data are available at unit-level and the log or
log-shift transformation is selected, the bias-correction of
<cite>Berg and Chandra (2014)</cite> and <cite>Molina and Martín (2018)</cite> is
applied. For this data situation, more methods and options are provided in
the package <span class="pkg">emdi</span>.
If only population means are available and the log or log-shift
transformation is selected, a bias-correction due to
the transformation is added but for the lack of access to population data no
correction is available. Therefore, a part of the bias is
disregarded.<br /> <br />
Additionally, analytically mean squared errors (MSE) are calculated in the
case of no transformation following <cite>Prasad and Rao (1990)</cite>.
For the log and log-shift transformation, a parametric bootstrap procedure
proposed by <cite>Wuerz et al. (2022)</cite> following
<cite>Gonzalez-Manteiga et al. (2008)</cite> is applied. Please note that this can
only be determined if covariance data are also provided.
If population data is available on unit-level a bootstrap procedure as
described in <cite>Molina and Martín (2018)</cite> is applied.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NER_Trafo(
  fixed,
  pop_area_size = NULL,
  pop_mean = NULL,
  pop_cov = NULL,
  pop_data = NULL,
  pop_domains = NULL,
  smp_data,
  smp_domains,
  threshold = 30,
  B = 50,
  transformation = "log.shift",
  interval = "default",
  MSE = FALSE,
  parallel_mode = ifelse(grepl("windows", .Platform$OS.type), "socket", "multicore"),
  cpus = 1,
  seed = 123
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NER_Trafo_+3A_fixed">fixed</code></td>
<td>
<p>a two-sided linear formula object describing the
fixed-effects part of the nested error linear regression model with the
dependent variable on the left of a ~ operator and the explanatory
variables on the right, separated by + operators. The argument corresponds
to the argument <code>fixed</code> in function <code><a href="nlme.html#topic+lme">lme</a></code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_pop_area_size">pop_area_size</code></td>
<td>
<p>a named numeric vector containing the number of
individuals within each domain. This numeric vector is named with the
domain names.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_pop_mean">pop_mean</code></td>
<td>
<p>a named list. Each element of the list contains the
population means for the p covariates for a specicfic domain. The list is
named with the respective domain name. The numeric vector within the list is
named with the covariate names. The covariates right of the ~ operator in
<code>fixed</code> need to comprise.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_pop_cov">pop_cov</code></td>
<td>
<p>a named list. Each element of the list contains the
domain-specific covariance matrice for p covariates for a specicfic domain.
The list is named with the respective domain name. The matrix within the list
has row and column names with the respective covariate names. The covariates
right of the ~ operator in <code>fixed</code> need to comprise. If <code>pop_cov</code>
is not available only a bias-correction due to the transformation is
added but for the lack of access to population data a correction is not
possible. Additionally, no MSE could be determined.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_pop_data">pop_data</code></td>
<td>
<p>a data frame that needs to comprise the variables
named on the right of the ~ operator in <code>fixed</code>, i.e. the explanatory
variables, and <code>pop_domains</code>.
Please note, if population data is available other methods using unit-level
population data, like <code><a href="emdi.html#topic+ebp">ebp</a></code>, could be applied.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_pop_domains">pop_domains</code></td>
<td>
<p>a character string containing the name of a variable that
indicates domains in the population data. The variable can be numeric or
a factor but needs to be of the same class as the variable named in
<code>smp_domains</code>. Only needed if population data are given.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_smp_data">smp_data</code></td>
<td>
<p>a data frame that needs to comprise all variables named in
<code>fixed</code> and <code>smp_domains</code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_smp_domains">smp_domains</code></td>
<td>
<p>a character string containing the name of a variable
that indicates domains in the sample data. The variable can be numeric or a
factor but needs to be of the same class as the variable named in
<code>pop_domains</code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_threshold">threshold</code></td>
<td>
<p>a numeric value indicating the threshold for using pooled
domain data (for domains with sample sizes below the threshold) or non pooled
domain data (for domains with sample sizes above the threshold) for the
density estimation within the approach of <cite>Wuerz et al. (2022)</cite>.
Defaults to 30.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_b">B</code></td>
<td>
<p>a number determining the number of bootstrap replications in the
parametric bootstrap approach. The number must be greater than 1. Defaults to
50. For practical applications, values larger than 200 are recommended.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_transformation">transformation</code></td>
<td>
<p>a character string. Three different transformation
types for the dependent variable can be chosen (i) no transformation (&quot;no&quot;);
(ii) log transformation (&quot;log&quot;); (iii) Log-Shift transformation
(&quot;log.shift&quot;). Defaults to <code>"log.shift"</code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_interval">interval</code></td>
<td>
<p>a string equal to 'default' or a numeric vector containing a
lower and upper limit determining an interval for the estimation of the
optimal parameter for the log-shift transformation. The interval is passed to
function  <code><a href="stats.html#topic+optimize">optimize</a></code> for the optimization. Defaults to
an interval based on the range of y. If the convergence fails, it is often
advisable to choose a smaller more suitable interval. For right skewed
distributions, the negative values may be excluded.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_mse">MSE</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, MSE estimates are provided.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_parallel_mode">parallel_mode</code></td>
<td>
<p>modus of parallelization, defaults to an automatic
selection of a suitable mode, depending on the operating system, if the
number of <code>cpus</code> is chosen higher than 1. For details, see
<code><a href="parallelMap.html#topic+parallelStart">parallelStart</a></code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_cpus">cpus</code></td>
<td>
<p>number determining the kernels that are used for the
parallelization. Defaults to 1. For details, see
<code><a href="parallelMap.html#topic+parallelStart">parallelStart</a></code>.</p>
</td></tr>
<tr><td><code id="NER_Trafo_+3A_seed">seed</code></td>
<td>
<p>an integer to set the seed for the random number generator. For
the usage of random number generation, see Details. If seed is set to
<code>NULL</code>, seed is chosen randomly. Defaults to <code>123</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the parametric bootstrap and the density estimation
approach random number generation is used. Thus, a seed is set by the
argument <code>seed</code>. <br /> <br />
</p>


<h3>Value</h3>

<p>An object of class &quot;NER&quot;, &quot;saeTrafo&quot; that provides estimators for
regional means optionally corresponding MSE estimates. Several generic
functions have methods for the returned object. For a full list and
descriptions of the components of objects of class &quot;saeTrafo&quot;, see
<code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>.
</p>


<h3>References</h3>

<p>Battese, G.E., Harter, R.M. and Fuller, W.A. (1988). An Error-Components
Model for Predictions of County Crop Areas Using Survey and Satellite Data.
Journal of the American Statistical Association, Vol.83, No. 401,
28-36. <br /> <br />
Berg, E. and Chandra, H. (2014). Small area prediction for a unit-level
lognormal model. Computational Statistics &amp; Data Analysis, Vol.78,
159–175.<br /> <br />
González-Manteiga, W., Lombardía, M. J., Molina, I., Morales, D. and
Santamaría, L. (2008). Analytic and bootstrap approximations of prediction
errors under a multivariate Fay–Herriot model. Computational Statistics &amp;
Data Analysis, Vol. 52, No. 12, 5242-5252. <br /> <br />
Molina, I. and Martín, N. (2018). Empirical best prediction under a nested
error model with log transformation. The Annals of Statistics, Vol.46, No. 5,
1961–1993. <br /> <br />
Molina, I. and Rao, J.N.K. (2010). Small area estimation of poverty
indicators. The Canadian Journal of Statistics, Vol. 38, No.3,
369-385. <br /> <br />
Prasad, N.N., Rao, J.N.K. (1990). The estimation of the mean squared error of
small-area estimators. Journal of the American statistical association,
Vol. 85, No. 409, 163-171. <br /> <br />
Wuerz, N., Schmid, T., and Tzavidis, N. (2022) Estimating regional income
indicators under transformations and access to limited population auxiliary
information. Journal of the Royal Statistical Society: Series A
(Statistics in Society), Vol. 185, No. 4, 1679-1706.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="nlme.html#topic+lme">lme</a></code>,
<code><a href="#topic+estimators.saeTrafo">estimators.saeTrafo</a></code>,  <code><a href="#topic+plot.saeTrafo">plot.saeTrafo</a></code>,
<code><a href="#topic+summaries.saeTrafo">summaries.saeTrafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Examples for (transformed) nested error regression model

# Load Data
data("eusilcA_pop")
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# formula object for all examples
formula &lt;- eqIncome ~ gender + eqsize + cash + self_empl + unempl_ben +
                      age_ben + surv_ben + sick_ben + dis_ben + rent +
                      fam_allow + house_allow + cap_inv + tax_adj

# For all four examples, no MSEs/variances are determined in order to avoid
# long run times. These can be obtained with MSE = TRUE.

# Example 1: No transformation - classical NER
NER_model_1 &lt;- NER_Trafo(fixed = formula, transformation = "no",
                         smp_domains = "district", smp_data = eusilcA_smp,
                         pop_area_size = pop_area_size, pop_mean = pop_mean)

# Example 2: Log-shift transformation and population aggregates
# (means and covariances) with changed threshold
NER_model_2 &lt;- NER_Trafo(fixed = formula,
                         smp_domains = "district", smp_data = eusilcA_smp,
                         pop_area_size = pop_area_size, pop_mean = pop_mean,
                         pop_cov = pop_cov, threshold = 50)

# Example 3: Log-shift transformation and population data
# A bias-corrections which need unit-level population data are applied
NER_model_3 &lt;- NER_Trafo(fixed = formula,
                         smp_domains = "district", smp_data = eusilcA_smp,
                         pop_data = eusilcA_pop, pop_domains = "district")


# Example 4: Log-shift transformation and population aggregates
# (only means (!) - Therefore, no MSE estimation is available, bias is
# disregarded)
NER_model_4 &lt;- NER_Trafo(fixed = formula,
                         smp_domains = "district", smp_data = eusilcA_smp,
                         pop_area_size = pop_area_size, pop_mean = pop_mean)

</code></pre>

<hr>
<h2 id='plot.saeTrafo'>Plots for an saeTrafo object</h2><span id='topic+plot.saeTrafo'></span>

<h3>Description</h3>

<p>Diagnostic plots of the nested error regression model
(see also <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>) are obtained. These include Q-Q plots and
density plots of residuals and random effects, a Cook's distance plot for
detecting outliers and the log-likelihood of the estimation of the
optimal parameter in log-shift transformations. The return depends on the
transformation, such that a plot for the optimal parameter is only returned
in case if a transformation with transformation parameter is chosen.
The range of the x-axis is optional but necessary to change if there are
convergence problems. All plots are obtained by
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'saeTrafo'
plot(
  x,
  label = "orig",
  color = c("blue", "lightblue3"),
  gg_theme = NULL,
  cooks = TRUE,
  range = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.saeTrafo_+3A_x">x</code></td>
<td>
<p>an object of type &quot;NER&quot;, representing point
and, if chosen, MSE estimates obtained by the (transformed) nested error
regression model (see also <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>).</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_label">label</code></td>
<td>
<p>argument that enables to customize title and axis labels. There
are three instant options to label the diagnostic plot: (i) original labels
(&quot;orig&quot;), (ii) axis lables but no title (&quot;no_title&quot;), (iii) neither axis
labels nor title (&quot;blank&quot;), (iv) individual labels by a list that needs to
have below structure.
Six elements can be defined called <code>qq_res, qq_ran, d_res, d_ran, cooks</code>
and <code>opt_lambda</code> for the six different plots and these list elements
need to have three elements each called <code>title, y_lab and x_lab</code>.
Only the labels for the plots that should be different to the original
need to be specified. Please see the details section for an example
with the default labels.</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_color">color</code></td>
<td>
<p>a character vector with two elements. The first element defines
the color for the line in the QQ-plots, for the Cook's Distance plot and for
the optimal parameter plot. The second element defines the color for the
densities.</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_gg_theme">gg_theme</code></td>
<td>
<p><code><a href="ggplot2.html#topic+theme">theme</a></code> list from package <span class="pkg">ggplot2</span>.
For using this argument, package <span class="pkg">ggplot2</span> must be loaded via
<code>library(ggplot2)</code>.</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_cooks">cooks</code></td>
<td>
<p>optional logical. If <code>TRUE</code>, a Cook's distance plot is
returned. The used method <code>mdffits.default</code> from the package
<span class="pkg">HLMdiag</span> struggles when data sets get large. In these cases,
<code>cooks</code> should be set to <code>FALSE</code>. It defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_range">range</code></td>
<td>
<p>optional sequence determining the range of the x-axis for plots
of the optimal transformation parameter that defaults to <code>NULL</code>. In that
case a range of the default interval is used for the plots of the
optimal parameter. This leads in some cases to convergence problems such that
it should be changed to e.g. the selected <code>interval</code>. The default value
depends on the chosen data driven transformation and equals the default
interval for the estimation of the optimal parameter.</p>
</td></tr>
<tr><td><code id="plot.saeTrafo_+3A_...">...</code></td>
<td>
<p>optional arguments passed to generic function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default settings of the <code>label</code> argument are as follows:<br />
</p>

<dl>
<dt>list(</dt><dd></dd>
<dt>qq_res =</dt><dd><p>c(title=&quot;Error term&quot;,
y_lab=&quot;Quantiles of pearson residuals&quot;,
x_lab=&quot;Theoretical quantiles&quot;),</p>
</dd>
<dt>qq_ran =</dt><dd><p>c(title=&quot;Random effect&quot;,
y_lab=&quot;Quantiles of random effects&quot;,
x_lab=&quot;Theoretical quantiles&quot;),</p>
</dd>
<dt>d_res =</dt><dd><p>c(title=&quot;Density - Pearson residuals&quot;,
y_lab=&quot;Density&quot;,
x_lab=&quot;Pearson residuals&quot;),</p>
</dd>
<dt>d_ran =</dt><dd><p>c(title=&quot;Density - Standardized random effects&quot;,
y_lab=&quot;Density&quot;,
x_lab=&quot;Standardized random effects&quot;),</p>
</dd>
<dt>cooks =</dt><dd><p>c(title=&quot;Cook's Distance Plot&quot;,
y_lab=&quot;Cook's Distance&quot;,
x_lab=&quot;Index&quot;),</p>
</dd>
<dt>opt_lambda =</dt><dd><p>c(title=&quot;Log-Shift - REML&quot;,
y_lab=&quot;Log-Likelihood&quot;,
x_lab=&quot;expression(lambda)&quot;))</p>
</dd>
</dl>



<h3>Value</h3>

<p>Two Q-Q plots in one grid, two density plots, a Cook's distance plot
and a likelihood plot for the optimal parameter of transformations with
transformation parameter obtained by <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Examples for diagnostic plots

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

# Example 1: Default diagnostic plot
plot(NER_model)

# Example 2: Creation of diagnostic plots without labels and titles,
# different colors and without Cook's distance plot.

plot(NER_model, label = "no_title", color = c("red", "yellow"),
     cooks = FALSE)



</code></pre>

<hr>
<h2 id='pop_area_size'>Aggregates from simulated eusilc population data: domain sizes</h2><span id='topic+pop_area_size'></span>

<h3>Description</h3>

<p>This data contains aggregates from <code><a href="#topic+eusilcA_pop">eusilcA_pop</a></code>
which is based on <code><a href="simFrame.html#topic+eusilcP">eusilcP</a></code> from package
<span class="pkg">simFrame</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop_area_size
</code></pre>


<h3>Format</h3>

<p>A named numeric vector containing the number of individuals within
each domain. This numeric vector is named with the domain names.
</p>

<hr>
<h2 id='pop_cov'>Aggregates from simulated eusilc population data: domain-specific covariances</h2><span id='topic+pop_cov'></span>

<h3>Description</h3>

<p>This data contains aggregates from <code><a href="#topic+eusilcA_pop">eusilcA_pop</a></code>
which is based on <code><a href="simFrame.html#topic+eusilcP">eusilcP</a></code> from package
<span class="pkg">simFrame</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop_cov
</code></pre>


<h3>Format</h3>

<p>A named list. Each element of the list contains the
domain-specific covariance matrice for p covariates for a specicfic domain.
The list is named with the respective domain name. The matrix within the list
has row and column names with the respective covariate names. The covariates
right of the ~ operator in <code>fixed</code> need to comprise.
</p>

<hr>
<h2 id='pop_mean'>Aggregates from simulated eusilc population data: domain-specific means</h2><span id='topic+pop_mean'></span>

<h3>Description</h3>

<p>This data contains aggregates from <code><a href="#topic+eusilcA_pop">eusilcA_pop</a></code>
which is based on <code><a href="simFrame.html#topic+eusilcP">eusilcP</a></code> from package
<span class="pkg">simFrame</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop_mean
</code></pre>


<h3>Format</h3>

<p>A named list. Each element of the list contains the
population means for the p covariates for a specicfic domain. The list is
named with the respective domain name. The numeric vector within the list is
named with the covariate names. The covariates right of the ~ operator in
<code>fixed</code> need to comprise.
</p>

<hr>
<h2 id='predict.NER'>Predictions from saeTrafo objects</h2><span id='topic+predict.NER'></span>

<h3>Description</h3>

<p>Method <code>predict.NER</code> extracts the direct estimates, the empirical
best linear unbiased or empirical best predictors for all domains from an
saeTrafo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.NER_+3A_object">object</code></td>
<td>
<p>an object of type &quot;saeTrafo&quot;.</p>
</td></tr>
<tr><td><code id="predict.NER_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with domain predictors.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples for Predictions from saeTrafo objects

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

predict(NER_model)

</code></pre>

<hr>
<h2 id='qqnorm.saeTrafo'>Quantile-quantile plots for an saeTrafo object</h2><span id='topic+qqnorm.saeTrafo'></span>

<h3>Description</h3>

<p>Normal quantile-quantile plots of the underlying model (see
<code><a href="#topic+NER_Trafo">NER_Trafo</a></code>) are obtained. The plots are obtained by
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'saeTrafo'
qqnorm(y, color = c("blue", "lightblue3"), gg_theme = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqnorm.saeTrafo_+3A_y">y</code></td>
<td>
<p>a model object of type &quot;saeTrafo&quot; (see <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>).</p>
</td></tr>
<tr><td><code id="qqnorm.saeTrafo_+3A_color">color</code></td>
<td>
<p>a character vector with two elements. The first element defines
the color for the line in the Q-Q plots, for the Cook's Distance plot and for
the Box-Cox plot. The second element defines the color for the densities.</p>
</td></tr>
<tr><td><code id="qqnorm.saeTrafo_+3A_gg_theme">gg_theme</code></td>
<td>
<p><code><a href="ggplot2.html#topic+theme">theme</a></code> list from package <span class="pkg">ggplot2</span>.
For using this argument, package <span class="pkg">ggplot2</span> must be loaded via
<code>library(ggplot2)</code>. See also Example 2.</p>
</td></tr>
<tr><td><code id="qqnorm.saeTrafo_+3A_...">...</code></td>
<td>
<p>optional arguments passed to generic function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two Q-Q plots in one grid obtained by <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Examples for Quantile-quantile plots

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

# Example 1: Default Quantile-quantile plots
qqnorm(NER_model)

# Example 2: Personalized plot using theme
require("ggplot2")
library(ggplot2)
qqnorm(NER_model,
       color = c("red", "darkgreen"),
       gg_theme = theme(panel.background = element_rect(fill = NA),
                        panel.grid.major = element_line(colour = "grey50"),
                        panel.ontop = TRUE)
)

</code></pre>

<hr>
<h2 id='ranef'>Extract random effects of saeTrafo object</h2><span id='topic+ranef'></span><span id='topic+random.effects'></span><span id='topic+ranef.NER'></span><span id='topic+random.effects.NER'></span>

<h3>Description</h3>

<p>Method <code>ranef.NER</code> extracts the random effects from an saeTrafo object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
ranef(object, ...)

## S3 method for class 'NER'
random.effects(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ranef_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;.</p>
</td></tr>
<tr><td><code id="ranef_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The alias <code>random.effects</code> can also be used instead of
<code>ranef</code>. The generic function <code>ranef</code> is imported from package
<span class="pkg">nlme</span> and re-exported to make the S3-methods available, even though the
<span class="pkg">nlme</span> package itself is not loaded or attached. For default
documentation, see <code><a href="nlme.html#topic+random.effects">random.effects</a></code>.
</p>


<h3>Value</h3>

<p>A vector containing the estimated random effects at domain level is
returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+random.effects">random.effects</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example to extract random effects

# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp)

ranef(NER_model)
</code></pre>

<hr>
<h2 id='saeTrafoObject'>Fitted saeTrafoObject</h2><span id='topic+saeTrafoObject'></span>

<h3>Description</h3>

<p>An object of class saeTrafo that represents point predictions of
domain-specific means. Optionally, it also contains corresponding MSE
estimates. Objects of these classes have methods for various generic
functions. See Details for more information.
</p>


<h3>Details</h3>

<p>Objects of class &quot;saeTrafo&quot; and subclass &quot;NER_Trafo&quot; have the following
methods:
<code><a href="#topic+compare_pred">compare_pred</a></code>, <code><a href="#topic+estimators">estimators</a></code>,
<code><a href="#topic+plot.saeTrafo">plot.saeTrafo</a></code>,
<code><a href="#topic+predict.NER">predict.NER</a></code>,
<code><a href="#topic+qqnorm.saeTrafo">qqnorm.saeTrafo</a></code>,
<code><a href="#topic+compare_plot">compare_plot</a></code>,
<code><a href="#topic+getData">getData</a></code>,
<code><a href="#topic+getGroups">getGroups</a></code>, <code><a href="#topic+getGroupsFormula">getGroupsFormula</a></code>,
<code><a href="#topic+getResponse">getResponse</a></code>,
<code>plot</code> (for documentation, see <code><a href="#topic+plot.saeTrafo">plot.saeTrafo</a></code>),
<code>print</code>, <code>qqnorm</code> (for documentation, see
<code><a href="#topic+qqnorm.saeTrafo">qqnorm.saeTrafo</a></code>) and
<code>summary</code> (for documentation, see
<code><a href="#topic+summaries.saeTrafo">summaries.saeTrafo</a></code>),
<code>coef</code> (for default documentation, see <code><a href="stats.html#topic+coef">coef</a></code>),
<code>confint</code> (for default documentation, see <code><a href="stats.html#topic+confint">confint</a></code>),
<code>family</code> (for default documentation, see <code><a href="stats.html#topic+family">family</a></code>),
<code>fitted</code> (for default documentation, see
<code><a href="stats.html#topic+fitted.values">fitted.values</a></code>),
<code><a href="#topic+fixef">fixef</a></code>,
<code>formula</code> (for default documentation, see <code><a href="stats.html#topic+formula">formula</a></code>),
<code><a href="#topic+getVarCov">getVarCov</a></code>,
<code><a href="#topic+intervals">intervals</a></code>,
<code>logLik</code> (for default documentation, see <code><a href="stats.html#topic+logLik">logLik</a></code>),
<code>nobs</code> (for default documentation, see <code><a href="stats.html#topic+nobs">nobs</a></code>),
<code><a href="#topic+ranef">ranef</a></code>,
<code>residuals</code> (for default documentation, see
<code><a href="stats.html#topic+residuals">residuals</a></code>),
<code>terms</code> (for default documentation, see <code><a href="stats.html#topic+terms">terms</a></code>),
<code>vcov</code> (for default documentation, see <code><a href="stats.html#topic+vcov">vcov</a></code>)
<code>sigma</code> (for default documentation, see <code><a href="stats.html#topic+sigma">sigma</a></code>)
</p>


<h3>Value</h3>

<p>The following components are always included in an saeTrafo object but not
always filled:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the function call that produced the object.</p>
</td></tr>
<tr><td><code>fixed</code></td>
<td>
<p>for details, see <code>fixed</code> in
<code><a href="#topic+NER_Trafo">NER_Trafo</a></code>.</p>
</td></tr>
<tr><td><code>framework</code></td>
<td>
<p>a list with components that describe the data setup,
e.g., number of domains in the sample.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>data frame containing estimates for the mean per domain.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>character returning the method for the estimation
approach used to fit the linear mixed model and for the the optimal
lambda, in our case &quot;reml&quot;.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>list containing a  selection of model components.</p>
</td></tr>
<tr><td><code>MSE</code></td>
<td>
<p>data frame containing MSE estimates corresponding to the
mean predictions in <code>ind</code> per domain if MSE is selected in
function call. If <code>MSE</code>, <code>MSE</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code>transformation</code></td>
<td>
<p>character or list containing information about
applied transformation.</p>
</td></tr>
<tr><td><code>transform_param</code></td>
<td>
<p>a list with two elements, <code>optimal_lambda</code>
and <code>shift_par</code>, where the first contains the optimal parameter
for a transformation with transformation parameter or <code>NULL</code> for
no and log transformation and the second the potential shift parameter
for the log transformation and <code>NULL</code> for no transformation.</p>
</td></tr>
<tr><td><code>successful_bootstraps</code></td>
<td>
<p>a numeric returning the number of
successful bootstraps. If <code>MSE = FALSE</code> in the function call or
<code>transformation = "no"</code>, <code>successful_bootstraps</code> is
<code>NULL</code>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+NER_Trafo">NER_Trafo</a></code>, <code><a href="nlme.html#topic+lme">lme</a></code>,
<code> <a href="nlme.html#topic+lmeObject">lmeObject</a></code>
</p>

<hr>
<h2 id='summaries.saeTrafo'>Summarizes an saeTrafo object</h2><span id='topic+summaries.saeTrafo'></span><span id='topic+summary.NER'></span>

<h3>Description</h3>

<p>Additional information about the data and model in small area estimation
methods and components of an saeTrafo object are extracted. The returned
object is suitable for printing  with the <code>print</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NER'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summaries.saeTrafo_+3A_object">object</code></td>
<td>
<p>an object of type &quot;NER&quot;, representing point and MSE estimates.</p>
</td></tr>
<tr><td><code id="summaries.saeTrafo_+3A_...">...</code></td>
<td>
<p>additional arguments that are not used in this method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of type &quot;summary.NER&quot; with information about the sample and
population data, the usage of transformation, normality tests and information
of the model fit.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>,
<code><a href="MuMIn.html#topic+r.squaredGLMM">r.squaredGLMM</a></code>, <code><a href="moments.html#topic+skewness">skewness</a></code>,
<code><a href="moments.html#topic+kurtosis">kurtosis</a></code>, <code><a href="stats.html#topic+shapiro.test">shapiro.test</a></code>
</p>

<hr>
<h2 id='write.excel'>Exports an saeTrafo Object to an Excel file or OpenDocument Spreadsheet</h2><span id='topic+write.excel'></span><span id='topic+write.ods'></span>

<h3>Description</h3>

<p>Function <code>write.excel</code> enables the user to export point and MSE
estimates as well as diagnostics from the <code>summary</code> to an Excel file.
The user can choose if the results should be reported in one or several Excel
sheets. Furthermore, a selection of indicators can be specified.
Respectively the function <code>write.ods</code> enables the export to OpenDocument
Spreadsheets. Note that while <code>write.exel</code> will create a single document
<code>write.ods</code> will create a group of files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.excel(
  object,
  file = "excel_output.xlsx",
  MSE = FALSE,
  CV = FALSE,
  split = FALSE
)

write.ods(
  object,
  file = "ods_output.ods",
  MSE = FALSE,
  CV = FALSE,
  split = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.excel_+3A_object">object</code></td>
<td>
<p>an object of type &quot;saeTrafo&quot;, representing point and MSE
estimates.</p>
</td></tr>
<tr><td><code id="write.excel_+3A_file">file</code></td>
<td>
<p>path and filename of the spreadsheet to create. It should end on
.xlsx or .ods respectively.</p>
</td></tr>
<tr><td><code id="write.excel_+3A_mse">MSE</code></td>
<td>
<p>logical. If <code>TRUE</code>, the MSE of the saeTrafoObject is
exported.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="write.excel_+3A_cv">CV</code></td>
<td>
<p>logical. If <code>TRUE</code>, the CV of the saeTrafoObject is exported.
Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="write.excel_+3A_split">split</code></td>
<td>
<p>logical. If <code>TRUE</code>, point estimates, MSE and CV are written
to different sheets in the Excel file. In <code>write.ods</code> <code>TRUE</code> will
result in different files for point estimates and their precision.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions create an Excel file via the package
<span class="pkg"><a href="openxlsx.html#topic+openxlsx">openxlsx</a></span> and ODS files via the package <span class="pkg">readODS</span>.
Both packages require a zip application to be available to <span class="rlang"><b>R</b></span>. If this is not
the case the authors of <span class="pkg"><a href="openxlsx.html#topic+openxlsx">openxlsx</a></span> suggest the first of the
following two ways.
</p>

<ul>
<li><p> Install Rtools from: http://cran.r-project.org/bin/windows/Rtools/ and
modify the system PATH during installation.
</p>
</li>
<li><p> If Rtools is installed, but no system path variable is set. One can
set such a variable temporarily to <span class="rlang"><b>R</b></span> by a command like:
<code>Sys.setenv("R_ZIPCMD" = "PathToTheRToolsFolder/bin/zip.exe")</code>.
</p>
</li></ul>

<p>To check if a zip application is available they recommend the command
<code>shell("zip")</code>.
</p>


<h3>Value</h3>

<p>An Excel file is created in your working directory, or at the given
path. Alternatively multiple ODS files are created at the given path.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+saeTrafoObject">saeTrafoObject</a></code>, <code><a href="#topic+NER_Trafo">NER_Trafo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples for exporting saeTrafoObject to an Excel file or OpenDocument
# Spreadsheet

## Not run: 
# Load Data
data("eusilcA_smp")
data("pop_area_size")
data("pop_mean")
data("pop_cov")

# Nested error regression model
NER_model &lt;- NER_Trafo(fixed = eqIncome ~ gender + eqsize + cash +
                       self_empl + unempl_ben + age_ben + surv_ben +
                       sick_ben + dis_ben + rent + fam_allow + house_allow +
                       cap_inv + tax_adj,
                       smp_domains = "district",
                       pop_area_size = pop_area_size,
                       pop_mean = pop_mean, pop_cov = pop_cov,
                       smp_data = eusilcA_smp, MSE = TRUE)

# Example 1: Export estimates for all indicators and uncertainty measures and
# diagnostics to Excel
write.excel(NER_model, file = "excel_output.xlsx", MSE = TRUE, CV = TRUE)

# Example 2: Single Excel sheets for point, MSE and CV estimates
write.excel(NER_model, file = "excel_output_split.xlsx", MSE = TRUE,
            CV = TRUE, split = TRUE)

# Example 3: Same as example 1 but for an ODS output
write.ods(NER_model, file = "ods_output_all.ods", MSE = TRUE, CV = TRUE)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
