<!DOCTYPE html><html><head><title>Help for package outbreaker2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {outbreaker2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bind_to_function'><p>Encloses argument in a function's environment</p></a></li>
<li><a href='#chains_pal'><p>Color palettes used in outbreaker</p></a></li>
<li><a href='#create_config'><p>Set and check parameter settings of outbreaker</p></a></li>
<li><a href='#create_param'><p>Initializes outputs for outbreaker</p></a></li>
<li><a href='#custom_likelihoods'><p>Customise likelihood functions for outbreaker</p></a></li>
<li><a href='#custom_moves'><p>Customise samplers for outbreaker</p></a></li>
<li><a href='#custom_priors'><p>Customise priors for outbreaker</p></a></li>
<li><a href='#fake_outbreak'><p>Small simulated outbreak</p></a></li>
<li><a href='#get_cpp_api'><p>Access internal C++ rountines used in outbreaker2</p></a></li>
<li><a href='#outbreaker'><p>outbreaker2: main function for reconstructing disease outbreaks</p></a></li>
<li><a href='#outbreaker_data'><p>Process input data for outbreaker</p></a></li>
<li><a href='#outbreaker_package'><p>outbreaker2: a platform for disease outbreak reconstruction</p></a></li>
<li><a href='#print.outbreaker_chains'><p>Basic methods for processing outbreaker results</p></a></li>
<li><a href='#sim_ctd'><p>Simulate contact data from a transmission tree</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-23</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Reconstruction of Disease Outbreaks by Combining
Epidemiologic and Genomic Data</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Finlay Campbell &lt;finlaycampbell93@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian reconstruction of disease outbreaks using epidemiological
    and genetic information. Jombart T, Cori A, Didelot X, Cauchemez S, Fraser
    C and Ferguson N. 2014. &lt;<a href="https://doi.org/10.1371%2Fjournal.pcbi.1003457">doi:10.1371/journal.pcbi.1003457</a>&gt;. Campbell, F,
    Cori A, Ferguson N, Jombart T. 2019. &lt;<a href="https://doi.org/10.1371%2Fjournal.pcbi.1006930">doi:10.1371/journal.pcbi.1006930</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda, microbenchmark, testthat, knitr, rmarkdown, igraph,
epicontacts, adegenet</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, methods, stats, grDevices, Rcpp, ape, ggplot2,
magrittr, visNetwork</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-23 07:50:24 UTC; campbellf</td>
</tr>
<tr>
<td>Author:</td>
<td>Thibaut Jombart [aut],
  Finlay Campbell [aut, cre],
  Rich Fitzjohn [aut],
  Gerry Tonkin-Hill [ctb],
  Kristjan Eldjarn [ctb],
  Alexis Robert [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-23 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bind_to_function'>Encloses argument in a function's environment</h2><span id='topic+bind_to_function'></span>

<h3>Description</h3>

<p>This function takes a function <code>f</code> and a series of named arguments, and
returns a closure of <code>f</code> which will only rely on one single argument
'param'. This is used to reduce the number of arguments passed around to
likelihood or movement functions. This functionality is used internally when
creating closures of custom moves in <code>bind_moves</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bind_to_function(f, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bind_to_function_+3A_f">f</code></td>
<td>
<p>The function to which arguments are bound.</p>
</td></tr>
<tr><td><code id="bind_to_function_+3A_...">...</code></td>
<td>
<p>Named arguments to bind to the function's environment.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Initial code by Rich FitzJohn (see 'references') with some
adaptations by Thibaut Jombart
</p>


<h3>References</h3>

<p>Initial code comes from the <code>partially_apply</code> function in
the 'rodeint' package <code>richfitz/rodeint</code>.
</p>

<hr>
<h2 id='chains_pal'>Color palettes used in outbreaker</h2><span id='topic+chains_pal'></span><span id='topic+outbreaker_palettes'></span><span id='topic+cases_pal'></span>

<h3>Description</h3>

<p>These functions are different color palettes (color-generating functions)
used in outbreaker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chains_pal(n)

cases_pal(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chains_pal_+3A_n">n</code></td>
<td>
<p>a number of colors to be created</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:8, col = chains_pal(8), cex = 10, pch = 20)

</code></pre>

<hr>
<h2 id='create_config'>Set and check parameter settings of outbreaker</h2><span id='topic+create_config'></span><span id='topic+print.outbreaker_config'></span>

<h3>Description</h3>

<p>This function defines settings for outbreaker.  It takes a list of named
items as input, performs various checks, set defaults where arguments are
missing, and return a correct list of settings. If no input is given, it
returns the default settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_config(..., data = NULL)

## S3 method for class 'outbreaker_config'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_config_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="create_config_+3A_data">data</code></td>
<td>
<p>an optional list of data items as returned by
<code>outbreaker_data</code>; if provided, this allows for further checks of
the outbreaker setings.</p>
</td></tr>
<tr><td><code id="create_config_+3A_x">x</code></td>
<td>
<p>an <code>outbreaker_config</code> object as returned by <code>create_config</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Acceptables arguments for ... are:
</p>

<dl>
<dt>init_tree</dt><dd><p>the tree used to initialize the MCMC. Can be either a
character string indicating how this tree should be computed, or a vector of
integers corresponding to the tree itself, where the i-th value corresponds
to the index of the ancestor of 'i' (i.e., <code>init.tree[i]</code> is the
ancestor of case <code>i</code>). Accepted character strings are &quot;seqTrack&quot; (uses
seqTrack algorithm to generate the initial tree - see function
<code>seqTrack</code> in the package <code>adegenet</code>), &quot;random&quot; (ancestor randomly
selected from preceding cases), and &quot;star&quot; (all cases coalesce to the first
case).  Note that for SeqTrack, all cases should have been sequenced.</p>
</dd>
<dt>init_alpha</dt><dd><p>a vector of integers indicating the initial values of
alpha, where the i-th value indicates the ancestor of case 'i'; defaults to
<code>NULL</code>, in which ancestries are defined from <code>init_tree</code>.</p>
</dd>
<dt>init_kappa</dt><dd><p>a (recycled) vector of integers indicating the initial
values of kappa; defaults to 1.</p>
</dd>
<dt>init_t_inf</dt><dd><p>a vector of integers indicating the initial values of
<code>t_inf</code>, i.e. dates of infection; defaults to <code>NULL</code>, in which case
the most likely <code>t_inf</code> will be determined from the delay to
reporting/symptoms distribution, and the dates of reporting/symptoms,
provided in <code>data</code>.</p>
</dd>
<dt>init_mu</dt><dd><p>initial value for the mutation rates</p>
</dd>
<dt>init_pi</dt><dd><p>initial value for the reporting probability</p>
</dd>
<dt>init_eps</dt><dd><p>initial value for the contact reporting coverage</p>
</dd>
<dt>init_lambda</dt><dd><p>initial value for the non-infectious contact rate</p>
</dd>
<dt>n_iter</dt><dd><p>an integer indicating the number of iterations in the MCMC,
including the burnin period</p>
</dd>
<dt>move_alpha</dt><dd><p>a vector of logicals indicating, for each case, if the
ancestry should be estimated ('moved' in the MCMC), or not, defaulting to
TRUE; the vector is recycled if needed.</p>
</dd>
<dt>move_t_inf</dt><dd><p>a vector of logicals indicating, for each case, if the
dates of infection should be estimated ('moved' in the MCMC), or not,
defaulting to TRUE; the vector is recycled if needed.</p>
</dd>
<dt>move_mu</dt><dd><p>a logical indicating whether the mutation rates
should be estimated ('moved' in the MCMC), or not, all defaulting to TRUE.</p>
</dd>
<dt>move_pi</dt><dd><p>a logical indicating whether the reporting probability
should be estimated ('moved' in the MCMC), or not, all defaulting to TRUE.</p>
</dd>
<dt>move_eps</dt><dd><p>a logical indicating whether the contact reporting coverage
should be estimated ('moved' in the MCMC), or not at all, defaulting to
TRUE.</p>
</dd>
<dt>move_lambda</dt><dd><p>a logical indicating whether the non-infectious contact
rate should be estimated ('moved' in the MCMC), or not at all, defaulting to
TRUE.</p>
</dd>
<dt>move_kappa</dt><dd><p>a logical indicating whether the number of generations
between two successive cases should be estimated ('moved' in the MCMC), or
not, all defaulting to TRUE.</p>
</dd>
<dt>move_pi</dt><dd><p>a logical indicating whether the reporting probability
should be estimated ('moved' in the MCMC), or not, all defaulting to TRUE.</p>
</dd>
<dt>n_iter</dt><dd><p>the number of iterations of the MCMC</p>
</dd>
<dt>sample_every</dt><dd><p>the frequency at which MCMC samples are retained for the
output</p>
</dd>
<dt>sd_mu</dt><dd><p>the standard deviation for the Normal proposal for the mutation
rates</p>
</dd>
<dt>sd_pi</dt><dd><p>the standard deviation for the Normal proposal for the reporting
probability</p>
</dd>
<dt>sd_eps</dt><dd><p>the standard deviation for the Normal proposal for the
contact reporting coverage</p>
</dd>
<dt>sd_lambda</dt><dd><p>the standard deviation for the Normal proposal for the
non-infectious contact rate</p>
</dd>
<dt>prop_alpha_move</dt><dd><p>the proportion of ancestries to move at each iteration
of the MCMC</p>
</dd>
<dt>prop_t_inf_move</dt><dd><p>the proportion of infection dates to move at each
iteration of the MCMC</p>
</dd>
<dt>batch_size</dt><dd><p>the size of the batch of random number pre-generated</p>
</dd>
<dt>paranoid</dt><dd><p>a logical indicating if the paranoid mode should be used;
this mode is used for performing additional tests during outbreaker; it makes
computations substantially slower and is mostly used for debugging purposes.</p>
</dd>
<dt>min_date</dt><dd><p>earliest infection date possible, expressed as days since the
first sampling</p>
</dd>
<dt>max_kappa</dt><dd><p>an integer indicating the largest number of generations
between any two linked cases; defaults to 5</p>
</dd>
<dt>prior_mu</dt><dd><p>a numeric value indicating the rate of the exponential prior
for the mutation rate 'mu'</p>
</dd>
<dt>prior_pi</dt><dd><p>a numeric vector of length 2 indicating the first and second
parameter of the beta prior for the reporting probability 'pi'</p>
</dd>
<dt>prior_eps</dt><dd><p>a numeric vector of length 2 indicating the first and second
parameter of the beta prior for the contact reporting coverage 'eps'</p>
</dd>
<dt>prior_lambda</dt><dd><p>a numeric vector of length 2 indicating the first and
second parameter of the beta prior for the non-infectious contact rate
'lambda'</p>
</dd>
<dt>ctd_directed</dt><dd><p>a logical indicating if the contact tracing data is
directed or not. If yes, the first column represents the infector and the
second column the infectee. If ctd is provided as an epicontacts objects,
directionality will be taken from there.</p>
</dd>
<dt>pb</dt><dd><p>a logical indicating if a progress bar should be displayed</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+outbreaker_data">outbreaker_data</a></code> to check and process data for outbreaker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## see default settings
create_config()

## change defaults
create_config(move_alpha = FALSE, n_iter = 2e5, sample_every = 1000)



</code></pre>

<hr>
<h2 id='create_param'>Initializes outputs for outbreaker</h2><span id='topic+create_param'></span><span id='topic+outbreaker_store'></span><span id='topic+outbreaker_param'></span>

<h3>Description</h3>

<p>This function creates initial outputs and parameter states for outbreaker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_param(data = outbreaker_data(), config = create_config())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_param_+3A_data">data</code></td>
<td>
<p>A list of data items as returned by <code>outbreaker_data</code>, or
arguments passed to this function.</p>
</td></tr>
<tr><td><code id="create_param_+3A_config">config</code></td>
<td>
<p>A list of settings as returned by <code>create_config</code>, or
arguments passed to this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two components <code>$store</code> and
<code>$current</code>. <code>store</code> is a list with the class
<code>outbreaker_store</code>, used for storing 'saved' states of the
MCMC. <code>current</code> is a list with the class <code>outbreaker_param</code>, used
for storing 'current' states of the MCMC. <br /> <br />
</p>
<p><code>outbreaker_store</code> class content:
</p>

<ul>
<li> <p><code>size</code>: The length of the list, corresponding to the number of
samples saved from the MCMC.
</p>
</li>
<li> <p><code>step</code>: A vector of integers of length <code>size</code>, storing the
steps of the MCMC corresponding to the saved samples.
</p>
</li>
<li> <p><code>post</code>: A numeric vector of length <code>size</code>, storing
log-posterior values.
</p>
</li>
<li> <p><code>like</code>: A numeric vector of length <code>size</code>, storing
log-likelihood values.
</p>
</li>
<li> <p><code>prior</code>: A numeric vector of length <code>size</code>,
storing log-prior values.
</p>
</li>
<li> <p><code>alpha</code>: A list of length <code>size</code>. Each item of the list is
an integer vector of length <code>data$N</code>, storing indices (from 1 to N) of
infectors for each case.
</p>
</li>
<li> <p><code>t_inf</code>: A list of length <code>size</code>. Each item of the list is
an integer vector of length <code>data$N</code>, storing dates of infections for
each case.
</p>
</li>
<li> <p><code>mu</code>: A numeric vector of length <code>size</code>, storing values of
the mutation rate.
</p>
</li>
<li> <p><code>kappa</code>: A list of length <code>size</code>. Each item of the list is
an integer vector of length <code>data$N</code>, storing the number of generations
before the last sampled ancestor for each case.
</p>
</li>
<li> <p><code>pi</code>: A numeric vector of length <code>size</code>, storing values of
the reporting probability.
</p>
</li>
<li> <p><code>eps</code>: A numeric vector of length <code>size</code>, storing values of
the contact reporting coverage.
</p>
</li>
<li> <p><code>lambda</code>: A numeric vector of length <code>size</code>, storing values of
the non-infectious contact rate.
</p>
</li>
<li> <p><code>counter</code>: A counter used to keep track of the current iteration
of the MCMC (used internally).
</p>
</li></ul>

<p><code>outbreaker_param</code> class content:
</p>

<ul>
<li> <p><code>alpha</code>: An integer vector of length <code>data$N</code>, storing
indices (from 1 to N) of infectors for each case.
</p>
</li>
<li> <p><code>t_inf</code>: An integer vector of length <code>data$N</code>, storing dates
of infections for each case.
</p>
</li>
<li> <p><code>mu</code>: The value of the mutation rate.
</p>
</li>
<li> <p><code>kappa</code>: An integer vector of length <code>data$N</code>, storing the
number of generations before the last sampled ancestor for each case.
</p>
</li>
<li> <p><code>pi</code>: The value of the reporting probability.
</p>
</li>
<li> <p><code>eps</code>: The value of the contact reporting coverage.
</p>
</li>
<li> <p><code>lambda</code>: The value of the non-infectious contact rate.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load data
x &lt;- fake_outbreak
data &lt;- outbreaker_data(dates = x$sample, dna = x$dna, w_dens = x$w)

## modify config settings
config &lt;- create_config(move_alpha = FALSE, n_iter = 2e5, sample_every = 1000)

## create param object
param &lt;- create_param(data = data, config = config)

</code></pre>

<hr>
<h2 id='custom_likelihoods'>Customise likelihood functions for outbreaker</h2><span id='topic+custom_likelihoods'></span><span id='topic+print.custom_likelihoods'></span>

<h3>Description</h3>

<p>This function is used to specify customised likelihood functions for
outbreaker. Custom functions are specified as a named list or series of
comma-separated, named arguments, indicating which log-likelihood component
they compute. Values currently available are:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_likelihoods(...)

## S3 method for class 'custom_likelihoods'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custom_likelihoods_+3A_...">...</code></td>
<td>
<p>a named list of functions, each computing a log-likelihood component.</p>
</td></tr>
<tr><td><code id="custom_likelihoods_+3A_x">x</code></td>
<td>
<p>an <code>outbreaker_config</code> object as returned by <code>create_config</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>genetic</code>: the genetic likelihood; by default, the function
<code>cpp_ll_genetic</code> is used.
</p>
</li>
<li> <p><code>timing_sampling</code>: the likelihood of sampling times; by default, the function
<code>cpp_ll_timing_sampling</code> is used.
</p>
</li>
<li> <p><code>timing_infections</code>: the likelihood of infection times; by default, the function
<code>cpp_ll_timing_infections</code> is used.
</p>
</li>
<li> <p><code>reporting</code>: the likelihood of the reporting process; by default,
the function <code>cpp_ll_reporting</code> is used.
</p>
</li>
<li> <p><code>contact</code>: the likelihood of the contact tracing data; by default,
the function <code>cpp_ll_contact</code> is used.
</p>
</li></ul>

<p>All log-likelihood functions should have the following arguments, in this
order:
</p>

<ul>
<li> <p><code>data</code>: a list of named items containing input data as returned by
<code><a href="#topic+outbreaker_data">outbreaker_data</a></code>
</p>
</li>
<li> <p><code>param</code>: a list of parameters with the class
<code><a href="#topic+create_param">create_param</a></code>
</p>
</li></ul>



<h3>Value</h3>

<p>A named list of list(function, arity) pairs with the class
<code>custom_likelihood</code>, each function implementing a customised
log-likelihood component of outbreaker. Functions which are not
customised will result in a list(NULL, 0) component. Any function with
arity 3 must have the third parameter default to NULL.
</p>
<p>a list of named functions
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>See Also</h3>

<p>See <a href="http://www.repidemicsconsortium.org/outbreaker2/articles/customisation.html#customizing-likelihood">customization vignette</a> for detailed examples on how to customize likelihoods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## specify a null model by disabling all likelihood components
f_null &lt;- function(data, param) {
  return(0.0)
}

null_model &lt;- custom_likelihoods(genetic = f_null,
                                timing_sampling = f_null,
                                timing_infections = f_null,
                                reporting = f_null,
                                contact = f_null)

null_config &lt;- list(find_import = FALSE,
                    n_iter = 100,
                    sample_every = 1)

## load data
x &lt;- fake_outbreak
data &lt;- outbreaker_data(dates = x$sample, dna = x$dna, w_dens = x$w)

res_null &lt;- outbreaker(data = data,
                       config = null_config,
                       likelihoods = null_model)

## visualise ancestries to see if all transmission trees have been explored
plot(res_null, type = "alpha")
</code></pre>

<hr>
<h2 id='custom_moves'>Customise samplers for outbreaker</h2><span id='topic+custom_moves'></span><span id='topic+print.outbreaker_moves'></span>

<h3>Description</h3>

<p>This function is used to specify customised movement functions
(a.k.a. samplers) for outbreaker. Custom functions are specified as a named
list or series of comma-separated, named arguments, indicating which type of
movement they implement. Values currently available are:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_moves(...)

## S3 method for class 'outbreaker_moves'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custom_moves_+3A_...">...</code></td>
<td>
<p>A list or a series of named, comma-separated functions
implementing movements of parameters or augmented data.</p>
</td></tr>
<tr><td><code id="custom_moves_+3A_x">x</code></td>
<td>
<p>an <code>outbreaker_moves</code> object as returned by <code>create_moves</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>mu</code>: movement of the mutation rate; by default, the function
<code>cpp_move_mu</code> is used.
</p>
</li>
<li> <p><code>pi</code>: movement of the reporting probability; by default, the function
<code>cpp_move_pi</code> is used.
</p>
</li>
<li> <p><code>eps</code>: movement of the contact reporting coverage; by default, the
function <code>cpp_move_eps</code> is used.
</p>
</li>
<li> <p><code>lambda</code>: the movement of the non-infectious contact rate; the
function <code>cpp_move_lambda</code> is used.
</p>
</li>
<li> <p><code>alpha</code>: movement of the transmission tree, by randomly proposing
infectors in the pool of cases infected before; by default, the function
<code>cpp_move_alpha</code> is used.
</p>
</li>
<li> <p><code>swap_cases</code>: movement of the transmission tree, by swapping
infectors and infected cases; by default, the function
<code>cpp_move_swap_cases</code> is used.
</p>
</li>
<li> <p><code>t_inf</code>: movement of the date of infection; by default, the
function <code>cpp_move_t_inf</code> is used.
</p>
</li>
<li> <p><code>kappa</code>: movement of the number generations between cases; by
default, the function <code>cpp_move_kappa</code> is used.
</p>
</li></ul>

<p>Movement functions must have an argument <code>param</code>, which is a list of
parameters and augmented data of the class <code><a href="#topic+create_param">create_param</a></code>.
Each movement function will be enclosed with its other arguments, so that the
resulting function will have a single argument 'param'. For non-standard
movements (i.e. none of the names specified above), the closure will contain:
</p>

<ul>
<li> <p><code>data</code>: a list of named items containing input data as returned by
<code><a href="#topic+outbreaker_data">outbreaker_data</a></code>
</p>
</li>
<li> <p><code>config</code>:  a list of named items containing input data as returned by
<code><a href="#topic+create_config">create_config</a></code>
</p>
</li>
<li> <p><code>likelihoods</code>: a list of named custom likelihood functions as returned by
<code><a href="#topic+custom_likelihoods">custom_likelihoods</a></code>
</p>
</li>
<li> <p><code>priors</code>: a list of named custom prior functions as returned by
<code><a href="#topic+custom_priors">custom_priors</a></code>
</p>
</li></ul>



<h3>Value</h3>

<p>A list of movement functions with a single argument 'param', with
class <code>outbreaker_moves</code>.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>).
</p>


<h3>See Also</h3>

<p>See <a href="http://www.repidemicsconsortium.org/outbreaker2/articles/customisation.html#customising-movements">customization vignette</a> for detailed examples on how to customise movement functions.
</p>

<hr>
<h2 id='custom_priors'>Customise priors for outbreaker</h2><span id='topic+custom_priors'></span><span id='topic+print.custom_priors'></span>

<h3>Description</h3>

<p>Priors can be specified in several ways in outbreaker2 (see details and
examples). The most flexible way to specify a prior is to provide a prior
function directly. This function must take an argument 'param', which is a
list which contains all the states of the parameters and augmented data. See
the documentation of <a href="#topic+create_param">create_param</a> for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_priors(...)

## S3 method for class 'custom_priors'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="custom_priors_+3A_...">...</code></td>
<td>
<p>A list or a series of named, comma-separated functions
implementing priors. Each function must have a single argument, which
corresponds to a 'outbreaker_param' list.</p>
</td></tr>
<tr><td><code id="custom_priors_+3A_x">x</code></td>
<td>
<p>an <code>outbreaker_config</code> object as returned by <code>create_config</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are three ways a user can specify priors:<br />
</p>
<p>1) Default: this is what happens when the 'config' has default values of
prior parameters.<br />
2) Customized parameters: in this case, the prior functions are the default
ones from the package, but will use custom parameters, specified by the user
through <code><a href="#topic+create_config">create_config</a></code>.<br />
</p>
<p>3) Customized functions: in this case, prior functions themselves are
specified by the user, through the '...' argument of 'custom_priors'. The
requirements is that such functions must have either hard-coded parameters or
enclosed values. They will take a single argument which is a list containing
all model parameters with the class 'outbreaker_param'. ALL PRIORS functions
are expected to return values on a LOG SCALE.<br />
</p>
<p>Priors currently used for the model are:
</p>

<ul>
<li> <p><code>mu</code> (mutation rate): default function is an exponential
distribution implemented in <code>outbreaker:::cpp_prior_mu</code>. New prior
functions should use <code>x$mu</code> to refer to the current value of <code>mu</code>,
assuming their argument is called <code>x</code>.
</p>
</li>
<li> <p><code>pi</code> (reporting probability): default function is a beta
distribution implemented in <code>outbreaker:::cpp_prior_pi</code>. New prior
functions should use <code>x$pi</code> to refer to the current value of <code>pi</code>,
assuming their argument is called <code>x</code>.
</p>
</li>
<li> <p><code>eps</code> (contact reporting coverage): default function is a beta
distribution implemented in <code>outbreaker:::cpp_prior_eps</code>. New prior
functions should use <code>x$eps</code> to refer to the current value of <code>eps</code>,
assuming their argument is called <code>x</code>.
</p>
</li>
<li> <p><code>lambda</code> (non-infectious contact rate): default function is a
beta distribution implemented in <code>outbreaker:::cpp_prior_lambda</code>. New
prior functions should use <code>x$lambda</code> to refer to the current value of
<code>lambda</code>, assuming their argument is called <code>x</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A list of custom functions with class <code>custom_priors</code>. Values
set to <code>NULL</code> will be ignored and default functions will be used
instead.
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>).
</p>


<h3>See Also</h3>

<p>See <a href="http://www.repidemicsconsortium.org/outbreaker2/articles/customisation.html#customising-priors">customization vignette</a> for detailed examples on how to customize priors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## BASIC CONFIGURATION
custom_priors()


## SPECIFYING PRIOR PARAMETERS
## - this will need to be passed to outbreaker
default_config &lt;- create_config()
new_config &lt;- create_config(prior_mu = 1e-5,
                        prior_pi = c(2, 1))

## - to check the prior manually, default settings:
param &lt;- list(mu = 0.001, pi = 0.9)
outbreaker2:::cpp_prior_mu(param, default_config)
outbreaker2:::cpp_prior_pi(param, default_config)

outbreaker2:::cpp_prior_mu(param, new_config)
outbreaker2:::cpp_prior_pi(param, new_config)

## these correspond to:
dexp(0.001, 0.01, log = TRUE)
dbeta(0.9, 2, 1, log = TRUE)


## SPECIFYING A PRIOR FUNCTION

## flat prior for pi between 0.5 and 1
f &lt;- function(x) {ifelse(x$pi &gt; 0.5, log(2), log(0))}
priors &lt;- custom_priors(pi = f)
priors # this should be passed to outbreaker

## test the prior manually
priors$pi(list(pi=1))
priors$pi(list(pi=.6))
priors$pi(list(pi=.2))
priors$pi(list(pi=.49))

</code></pre>

<hr>
<h2 id='fake_outbreak'>Small simulated outbreak</h2><span id='topic+fake_outbreak'></span>

<h3>Description</h3>

<p>This dataset is a small (30 cases) simulated outbreak originally used to
illustrate <code>outbreaker</code>, and used for the same purposes in
<code>outbreaker2</code>.  This list contains the following:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fake_outbreak
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 6.
</p>


<h3>Details</h3>


<ul>
<li> <p><code>$onset</code>: A vector of integers representing dates of onset.
</p>
</li>
<li> <p><code>$sample</code>: A vector of integers representing the dates of isolation.
</p>
</li>
<li> <p><code>$dna</code>: A DNAbin matrix of pathogen genome sequences.
</p>
</li>
<li> <p><code>$w</code>: A numeric vector giving the empirical distribution of the
generation time.
</p>
</li>
<li> <p><code>$ances</code>: A vector of integers indicating, for each case, the true
infectors. <code>NA</code> represents imported cases.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>names(fake_outbreak)
fake_outbreak

</code></pre>

<hr>
<h2 id='get_cpp_api'>Access internal C++ rountines used in outbreaker2</h2><span id='topic+get_cpp_api'></span>

<h3>Description</h3>

<p>This function returns an environment containing all C++ functions (bound to R
using Rcpp) used for priors, likelihoods, and movements of parameters in
outbreaker2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cpp_api()
</code></pre>


<h3>Value</h3>

<p>An environment containing Rcpp bindings to C++ functions used internally in
outbreaker2. All functions are named as cpp_[type]_[component], where 'type'
can be:
</p>

<ul>
<li><p> 'prior': prior computation
</p>
</li>
<li><p> 'll':  likelihood computation
</p>
</li>
<li><p> 'move': movement of parameters or augmented data
</p>
</li></ul>

<p>And where 'component' can be:
</p>

<ul>
<li><p> 'mu': (parameter) mutation rate
</p>
</li>
<li><p> 'pi': (parameter) reporting probability
</p>
</li>
<li><p> 'lambda': (parameter) non-infectious contact rate
</p>
</li>
<li><p> 'eps': (parameter) contact reporting coverage
</p>
</li>
<li><p> 'alpha': (augmented data) ancestries of the cases
</p>
</li>
<li><p> 'kappa': (augmented data) generation between cases on transmission
chains
</p>
</li>
<li><p> 't_inf': (augmented data) dates of infections
</p>
</li>
<li><p> 'timing_infections': (likelihood component) timing between infectors and
infectees
</p>
</li>
<li><p> 'timing_sampling': (likelihood component) timing between infection and
reporting / isolation
</p>
</li>
<li><p> 'timing': (likelihood component) sum of the two timing components
</p>
</li>
<li><p> 'genetic': (likelihood component) genetic diversity accumulated along
transmission chains
</p>
</li>
<li><p> 'reporting': (likelihood component) reporting of cases
</p>
</li>
<li><p> 'all': (likelihood component) sum of all likelihood components
</p>
</li>
<li><p> 'swap_cases': (type of movement) swap infectors and infectees on a
transmission tree 
</p>
</li></ul>

<p>For a description of the arguments of these functions, see the Rcpp_API
vignette (<code>vignette("Rcpp_API", package = "outbreaker2")</code>).
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get functions in an environment
api &lt;- get_cpp_api()
api

## check content of the environment
ls(api)

## test the prior for mu
args(api$cpp_prior_mu)

config &lt;- create_config()

api$cpp_prior_mu(list(mu = 0.00123), config)

dexp(0.00123, rate = config$prior_mu, log = TRUE)

</code></pre>

<hr>
<h2 id='outbreaker'>outbreaker2: main function for reconstructing disease outbreaks</h2><span id='topic+outbreaker'></span>

<h3>Description</h3>

<p>The function <code>outbreaker</code> is the main function of the package. It runs
processes various inputs (data, configuration settings, custom priors,
likelihoods and movement functions) and explores the space of plausible
transmission trees of a densely sampled outbreaks.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outbreaker(
  data = outbreaker_data(),
  config = create_config(),
  priors = custom_priors(),
  likelihoods = custom_likelihoods(),
  moves = custom_moves()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outbreaker_+3A_data">data</code></td>
<td>
<p>a list of named items containing input data as returned by
<code><a href="#topic+outbreaker_data">outbreaker_data</a></code></p>
</td></tr>
<tr><td><code id="outbreaker_+3A_config">config</code></td>
<td>
<p>a set of settings as returned by <code><a href="#topic+create_config">create_config</a></code></p>
</td></tr>
<tr><td><code id="outbreaker_+3A_priors">priors</code></td>
<td>
<p>a set of log-prior functions as returned by
<code><a href="#topic+custom_priors">custom_priors</a></code></p>
</td></tr>
<tr><td><code id="outbreaker_+3A_likelihoods">likelihoods</code></td>
<td>
<p>a set of log-likelihood functions as returned by
<code><a href="#topic+custom_likelihoods">custom_likelihoods</a></code></p>
</td></tr>
<tr><td><code id="outbreaker_+3A_moves">moves</code></td>
<td>
<p>a set of movement functions as returned by
<code><a href="#topic+custom_moves">custom_moves</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The emphasis of 'outbreaker2' is on modularity, which enables customisation
of priors, likelihoods and even movements of parameters and augmented data by
the user. This the dedicated vignette on this topic
<code>vignette("outbreaker2_custom")</code>.<br />
</p>


<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>References</h3>

<p>Jombart T, Cori A, Didelot X, Cauchemez S, Fraser C and Ferguson
N (2014).  Bayesian reconstruction of disease outbreaks by combining
epidemiologic and genomic data. PLoS Computational Biology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+outbreaker_data">outbreaker_data</a></code> to process input data, and
<code><a href="#topic+create_config">create_config</a></code> to process/set up parameters
</p>

<ul>
<li> <p><code><a href="#topic+outbreaker_data">outbreaker_data</a></code>: function to process input data
</p>
</li>
<li> <p><code><a href="#topic+create_config">create_config</a></code>: function to create default and customise
configuration settings
</p>
</li>
<li> <p><code><a href="#topic+custom_priors">custom_priors</a></code>: function to specify customised prior
functions
</p>
</li>
<li> <p><code><a href="#topic+custom_likelihoods">custom_likelihoods</a></code>: function to specify customised likelihoods
functions
</p>
</li>
<li> <p><code><a href="#topic+custom_moves">custom_moves</a></code>: function to create default and customise movement
functions
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
## get data
data(fake_outbreak)
dat &lt;- fake_outbreak

## Not run: 
## run outbreaker
out &lt;- outbreaker(data = list(dna = dat$dna, dates = dat$onset, w_dens = dat$w),
config = list(n_iter = 2e4, sample_every = 200))
plot(out)
as.data.frame(out)

## run outbreaker, no DNA sequences
out2 &lt;- outbreaker(data = list(dates = dat$onset, w_dens = w),
config = list(n_iter = 2e4, sample_every = 200))
plot(out2)
as.data.frame(out2)


## End(Not run)
</code></pre>

<hr>
<h2 id='outbreaker_data'>Process input data for outbreaker</h2><span id='topic+outbreaker_data'></span>

<h3>Description</h3>

<p>This function performs various checks on input data given to outbreaker.  It
takes a list of named items as input, performs various checks, set defaults
where arguments are missing, and return a correct list of data input. If no
input is given, it returns the default settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outbreaker_data(..., data = list(...))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outbreaker_data_+3A_...">...</code></td>
<td>
<p>a list of data items to be processed (see description)</p>
</td></tr>
<tr><td><code id="outbreaker_data_+3A_data">data</code></td>
<td>
<p>optionally, an existing list of data item as returned by <code>outbreaker_data</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Acceptables arguments for ... are:
</p>

<dl>
<dt>dates</dt><dd><p>dates a vector indicating the collection dates, provided either as
integer numbers or in a usual date format such as <code>Date</code> or
<code>POSIXct</code> format. By convention, zero will indicate the oldest date. If
the vector is named, the vector names will be used for matching cases to
contact tracing data and labelled DNA sequences.</p>
</dd>
<dt>dna</dt><dd><p>the DNA sequences in <code>DNAbin</code> format (see
<code><a href="ape.html#topic+read.dna">read.dna</a></code> in the ape package); this can be imported from a
fasta file (extension .fa, .fas, or .fasta) using <code>adegenet</code>'s function
<a href="adegenet.html#topic+fasta2DNAbin">fasta2DNAbin</a>.</p>
</dd>
<dt>ctd</dt><dd><p>the contact tracing data provided as a matrix/dataframe of two
columns, indicating a reported contact between the two individuals whose ids
are provided in a given row of the data, or an epicontacts object. In the case
of the latter, linelist IDs will be used for matching dates and DNA
sequences</p>
</dd>
<dt>w_dens</dt><dd><p>a vector of numeric values indicating the generation time
distribution, reflecting the infectious potential of a case t = 1, 2, ...
time steps after infection. By convention, it is assumed that
newly infected patients cannot see new infections on the same time step. If not
standardized, this distribution is rescaled to sum to 1.</p>
</dd>
<dt>f_dens</dt><dd><p>similar to <code>w_dens</code>, except that this is the distribution
of the colonization time, i_e. time interval during which the pathogen can
be sampled from the patient.</p>
</dd></dl>



<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- fake_outbreak
outbreaker_data(dates = x$sample, dna = x$dna, w_dens = x$w)

</code></pre>

<hr>
<h2 id='outbreaker_package'>outbreaker2: a platform for disease outbreak reconstruction</h2><span id='topic+outbreaker_package'></span>

<h3>Description</h3>

<p>This package provides a statistical platform for reconstructing transmission
trees ('who infects whom') in densely sampled disease outbreaks. It
reimplements, as a particular case, the model of 'outbreaker' (see
references). 'outbreaker2' extends and replaces 'outbreaker'. <br />
</p>


<h3>Details</h3>

<p>The emphasis of 'outbreaker2' is on modularity, which enables customisation
of priors, likelihoods and even movements of parameters and augmented data by
the user. This the dedicated vignette on this topic
<code>vignette("outbreaker2_custom")</code>.<br />
</p>
<p>The main functions of the package are:
</p>

<ul>
<li> <p><code><a href="#topic+outbreaker">outbreaker</a></code>: main function to run analyses
</p>
</li>
<li> <p><code><a href="#topic+outbreaker_data">outbreaker_data</a></code>: function to process input data
</p>
</li>
<li> <p><code><a href="#topic+create_config">create_config</a></code>: function to create default and customise
configuration settings
</p>
</li>
<li> <p><code><a href="#topic+custom_priors">custom_priors</a></code>: function to specify customised prior
functions
</p>
</li>
<li> <p><code><a href="#topic+custom_likelihoods">custom_likelihoods</a></code>: function to specify customised likelihoods
functions
</p>
</li>
<li> <p><code><a href="#topic+custom_moves">custom_moves</a></code>: function to create default and customise movement
functions
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Thibaut Jombart <a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>
</p>

<hr>
<h2 id='print.outbreaker_chains'>Basic methods for processing outbreaker results</h2><span id='topic+print.outbreaker_chains'></span><span id='topic+outbreaker_chains'></span><span id='topic+plot.outbreaker_chains'></span><span id='topic+summary.outbreaker_chains'></span>

<h3>Description</h3>

<p>Several methods are defined for instances of the class
<code>outbreaker_chains</code>, returned by <code><a href="#topic+outbreaker">outbreaker</a></code>, including:
<code>print</code>, <code>plot</code>, <code>summary</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'outbreaker_chains'
print(x, n_row = 3, n_col = 8, ...)

## S3 method for class 'outbreaker_chains'
plot(
  x,
  y = "post",
  type = c("trace", "hist", "density", "alpha", "t_inf", "kappa", "network"),
  group = NULL,
  burnin = 0,
  min_support = 0.1,
  labels = NULL,
  ...
)

## S3 method for class 'outbreaker_chains'
summary(object, burnin = 0, method = c("mpa", "decycle"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.outbreaker_chains_+3A_x">x</code></td>
<td>
<p>an <code>outbreaker_chains</code> object as returned by <code>outbreaker</code>.</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_n_row">n_row</code></td>
<td>
<p>the number of rows to display in head and tail; defaults to 3.</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_n_col">n_col</code></td>
<td>
<p>the number of columns to display; defaults to 8.</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to other methods</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_y">y</code></td>
<td>
<p>a character string indicating which element of an
<code>outbreaker_chains</code> object to plot</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_type">type</code></td>
<td>
<p>a character string indicating the kind of plot to be used (see details)</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_group">group</code></td>
<td>
<p>a vector of character strings indicating the parameters to display, 
or &quot;all&quot; to display all global parameters (non node-specific parameters).</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_burnin">burnin</code></td>
<td>
<p>the number of iterations to be discarded as burnin</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_min_support">min_support</code></td>
<td>
<p>a number between 0 and 1 indicating the minimum support of
ancestries to be plotted; only used if 'type' is 'network'</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_labels">labels</code></td>
<td>
<p>a vector of length N indicating the case labels (must be
provided in the same order used for dates of symptom onset)</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_object">object</code></td>
<td>
<p>an <code>outbreaker_chains</code> object as returned by <code>outbreaker</code>.</p>
</td></tr>
<tr><td><code id="print.outbreaker_chains_+3A_method">method</code></td>
<td>
<p>the method used to determine consensus ancestries. 'mpa'
(maximum posterior ancestry) simply returns the posterior ancestry with the
highest posterior support for each case, even if this includes
cycles. 'decycle' will return the maximum posterior ancestry, except when
cycles are detected, in which case the link in the cycle with the lowest
support is pruned and the tree recalculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>type</code> indicates the type of graphic to plot:
</p>

<ul>
<li> <p><code>trace</code> to visualise MCMC traces for parameters or augmented data (plots the
log-likelihood by default)
</p>
</li>
<li> <p><code>hist</code> to plot histograms of quantitative values
</p>
</li>
<li> <p><code>density</code> to plot kernel density estimations of quantitative values
</p>
</li>
<li> <p><code>alpha</code> to visualise the posterior frequency of ancestries
</p>
</li>
<li> <p><code>network</code> to visualise the transmission tree; note that
this opens up an interactive plot and requires a web browser with
Javascript enabled; the argument 'min_support' is useful to select only the
most supported ancestries and avoid displaying too many links
</p>
</li>
<li> <p><code>kappa</code> to visualise the distributions generations between cases and their
ancestor/infector
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Thibaut Jombart (<a href="mailto:thibautjombart@gmail.com">thibautjombart@gmail.com</a>)
</p>


<h3>See Also</h3>

<p>See <a href="http://www.repidemicsconsortium.org/outbreaker2/articles/introduction.html#graphics">introduction vignette</a> for detailed examples on how to visualise <code>outbreaker_chains</code> objects.
</p>

<hr>
<h2 id='sim_ctd'>Simulate contact data from a transmission tree</h2><span id='topic+sim_ctd'></span>

<h3>Description</h3>

<p>This function simulates contact data from a transmission tree. The
model assumes that all transmission pairs have experienced contact, and that
there is no false-positive reporting of contacts. The probability of contact
occuring between a non-transmision pair is given by the parameter lambda. The
probability of reporting a contact (transmission pair or not) is given by the
parameters eps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_ctd(tTree, eps, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_ctd_+3A_ttree">tTree</code></td>
<td>
<p>a dataframe or matrix of two columns, with each row providing
the ids (numerical or as characters) of a transmission pair</p>
</td></tr>
<tr><td><code id="sim_ctd_+3A_eps">eps</code></td>
<td>
<p>the contact reporting coverage, defined as the probability of
reporting a contact (transmission pair or not)</p>
</td></tr>
<tr><td><code id="sim_ctd_+3A_lambda">lambda</code></td>
<td>
<p>the non-infectious contact rate, defined as the probability
of contact between a non-transmission pair.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Finlay Campbell (<a href="mailto:finlaycampbell93@gmail.com">finlaycampbell93@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## load data
x &lt;- fake_outbreak
tTree &lt;- data.frame(from = x$ances, to = seq_along(x$ances))

## simulate contact data with coverage of 80% and 10% probability of
## contact between non-transmission pairs
ctd &lt;- outbreaker2:::sim_ctd(tTree, eps = 0.8, lambda = 0.1)

## inspect contact data
head(ctd)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
