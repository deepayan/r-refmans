<!DOCTYPE html><html lang="en"><head><title>Help for package bcdata</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bcdata}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bcdata-package'><p>bcdata: Search and Retrieve Data from the BC Data Catalogue</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#as_tibble'><p>as_tibble</p></a></li>
<li><a href='#bcdc_browse'><p>Load the B.C. Data Catalogue URL into an HTML browser</p></a></li>
<li><a href='#bcdc_check_geom_size'><p>Check spatial objects for WFS spatial operations</p></a></li>
<li><a href='#bcdc_describe_feature'><p>Describe the attributes of a Web Feature Service</p></a></li>
<li><a href='#bcdc_get_citation'><p>Generate a bibentry from a Data Catalogue Record</p></a></li>
<li><a href='#bcdc_get_data'><p>Download and read a resource from a B.C. Data Catalogue record</p></a></li>
<li><a href='#bcdc_get_record'><p>Show a single B.C. Data Catalogue record</p></a></li>
<li><a href='#bcdc_list'><p>Return a full list of the names of B.C. Data Catalogue records</p></a></li>
<li><a href='#bcdc_list_groups'><p>Retrieve group information for B.C. Data Catalogue</p></a></li>
<li><a href='#bcdc_list_organizations'><p>Retrieve organization information for B.C. Data Catalogue</p></a></li>
<li><a href='#bcdc_options'><p>Retrieve options used in bcdata, their value if set and the default value.</p></a></li>
<li><a href='#bcdc_preview'><p>Get preview map from the B.C. Web Map Service</p></a></li>
<li><a href='#bcdc_query_geodata'><p>Query data from the B.C. Web Feature Service</p></a></li>
<li><a href='#bcdc_read_functions'><p>Formats supported and loading functions</p></a></li>
<li><a href='#bcdc_search'><p>Search the B.C. Data Catalogue</p></a></li>
<li><a href='#bcdc_search_facets'><p>Get the valid values for a facet (that you can use in <code>bcdc_search()</code>)</p></a></li>
<li><a href='#bcdc_tidy_resources'><p>Provide a data frame containing the metadata for all resources from a single B.C. Data Catalogue record</p></a></li>
<li><a href='#CQL'><p>CQL escaping</p></a></li>
<li><a href='#cql_geom_predicates'><p>CQL Geometry Predicates</p></a></li>
<li><a href='#filter.bcdc_promise'><p>Filter a query from bcdc_query_geodata()</p></a></li>
<li><a href='#mutate.bcdc_promise'><p>Throw an informative error when attempting mutate on a <code>bcdc_promise</code> object</p></a></li>
<li><a href='#select.bcdc_promise'><p>Select columns from bcdc_query_geodata() call</p></a></li>
<li><a href='#show_query.bcdc_promise'><p>Show SQL and URL used for Web Feature Service request from B.C. Data Catalogue</p></a></li>
<li><a href='#wfsConnection-class'><p>wfsConnection class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Search and Retrieve Data from the BC Data Catalogue</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Search, query, and download tabular and
    'geospatial' data from the British Columbia Data Catalogue
    (<a href="https://catalogue.data.gov.bc.ca/">https://catalogue.data.gov.bc.ca/</a>).  Search catalogue data records
    based on keywords, data licence, sector, data format, and B.C.
    government organization. View metadata directly in R, download many
    data formats, and query 'geospatial' data available via the B.C.
    government Web Feature Service ('WFS') using 'dplyr' syntax.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (== 2.0)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://bcgov.github.io/bcdata/">https://bcgov.github.io/bcdata/</a>,
<a href="https://catalogue.data.gov.bc.ca/">https://catalogue.data.gov.bc.ca/</a>,
<a href="https://github.com/bcgov/bcdata/">https://github.com/bcgov/bcdata/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/bcgov/bcdata/issues">https://github.com/bcgov/bcdata/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, utils, stats, cli (&ge; 3.3.0), DBI (&ge; 1.1.0), crul
(&ge; 1.1.0), dbplyr (&ge; 2.3.4), dplyr (&ge; 1.1.2), tibble (&ge;
3.1.0), glue (&ge; 1.6.0), jsonlite (&ge; 1.6.0), leaflet (&ge;
2.1.0), leaflet.extras (&ge; 1.0.0), purrr (&ge; 0.3), readr (&ge;
2.1), readxl (&ge; 1.4.0), rlang (&ge; 1.0), sf (&ge; 1.0),
tidyselect (&ge; 1.1.0), xml2 (&ge; 1.3.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, ggplot2, knitr, rmarkdown, testthat (&ge; 3.0.0), withr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>'bcdata-package.R' 'bcdc-get-citation.R' 'bcdc-web-services.R'
'bcdc_browse.R' 'bcdc_options.R' 'bcdc_search.R' 'cli.R'
'cql-geom-predicates.R' 'cql-translator.R' 'describe-feature.R'
'get_data.R' 'utils-as_tibble.R' 'utils-classes.R'
'utils-collect.R' 'utils-filter.R' 'utils-is.R'
'utils-mutate.R' 'utils-pipe.R' 'utils-select.R'
'utils-show-query.R' 'utils.R' 'zzz.R'</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-12 01:39:20 UTC; andy</td>
</tr>
<tr>
<td>Author:</td>
<td>Andy Teucher <a href="https://orcid.org/0000-0002-7840-692X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Sam Albers <a href="https://orcid.org/0000-0002-9270-7884"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    ctb],
  Stephanie Hazlitt <a href="https://orcid.org/0000-0002-3161-2304"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ctb],
  Province of British Columbia [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andy Teucher &lt;andy.teucher@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-12 04:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bcdata-package'>bcdata: Search and Retrieve Data from the BC Data Catalogue</h2><span id='topic+bcdata'></span><span id='topic+bcdata-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Search, query, and download tabular and 'geospatial' data from the British Columbia Data Catalogue (<a href="https://catalogue.data.gov.bc.ca/">https://catalogue.data.gov.bc.ca/</a>). Search catalogue data records based on keywords, data licence, sector, data format, and B.C. government organization. View metadata directly in R, download many data formats, and query 'geospatial' data available via the B.C. government Web Feature Service ('WFS') using 'dplyr' syntax.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andy Teucher <a href="mailto:andy.teucher@gmail.com">andy.teucher@gmail.com</a> (<a href="https://orcid.org/0000-0002-7840-692X">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Sam Albers <a href="mailto:sam.albers@gmail.com">sam.albers@gmail.com</a> (<a href="https://orcid.org/0000-0002-9270-7884">ORCID</a>) [contributor]
</p>
</li>
<li><p> Stephanie Hazlitt <a href="mailto:stephhazlitt@gmail.com">stephhazlitt@gmail.com</a> (<a href="https://orcid.org/0000-0002-3161-2304">ORCID</a>) [contributor]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Province of British Columbia [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://bcgov.github.io/bcdata/">https://bcgov.github.io/bcdata/</a>
</p>
</li>
<li> <p><a href="https://catalogue.data.gov.bc.ca/">https://catalogue.data.gov.bc.ca/</a>
</p>
</li>
<li> <p><a href="https://github.com/bcgov/bcdata/">https://github.com/bcgov/bcdata/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/bcgov/bcdata/issues">https://github.com/bcgov/bcdata/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Pipe operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='as_tibble'>as_tibble</h2><span id='topic+as_tibble'></span><span id='topic+collect.bcdc_promise'></span><span id='topic+as_tibble.bcdc_promise'></span><span id='topic+collect'></span>

<h3>Description</h3>

<p>See <code>tibble::<a href="tibble.html#topic+as_tibble">as_tibble</a></code> for details.
</p>
<p>After tuning a query, <code>collect()</code> is used to actually bring the data into memory.
This will retrieve an sf object into R. The <code>as_tibble()</code> function can be used
interchangeably with <code>collect</code> which matches <code>dbplyr</code> behaviour.
</p>
<p>See <code>dplyr::<a href="dplyr.html#topic+compute">collect</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdc_promise'
collect(x, ...)

## S3 method for class 'bcdc_promise'
as_tibble(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_tibble_+3A_x">x</code></td>
<td>
<p>object of class <code>bcdc_promise</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_query_geodata("bc-airports") %&gt;%
    collect()
)

try(
  bcdc_query_geodata("bc-airports") %&gt;%
    as_tibble()
)


</code></pre>

<hr>
<h2 id='bcdc_browse'>Load the B.C. Data Catalogue URL into an HTML browser</h2><span id='topic+bcdc_browse'></span>

<h3>Description</h3>

<p>This is a wrapper around utils::browseURL with the URL for the B.C. Data Catalogue as
the default
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_browse(
  query = NULL,
  browser = getOption("browser"),
  encodeIfNeeded = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_browse_+3A_query">query</code></td>
<td>
<p>Default (NULL) opens a browser to <code>https://catalogue.data.gov.bc.ca</code>.
This argument will also accept a B.C. Data Catalogue record ID or name to take you
directly to that page. If the provided ID or name doesn't lead to a valid webpage,
bcdc_browse will search the data catalogue for that string.</p>
</td></tr>
<tr><td><code id="bcdc_browse_+3A_browser">browser</code></td>
<td>
<p>a non-empty character string giving the name of the
program to be used as the HTML browser.  It should be in the PATH,
or a full path specified.  Alternatively, an <span class="rlang"><b>R</b></span> function to be
called to invoke the browser.
</p>
<p>Under Windows <code>NULL</code> is also allowed (and is the default), and
implies that the file association mechanism will be used.
</p>
</td></tr>
<tr><td><code id="bcdc_browse_+3A_encodeifneeded">encodeIfNeeded</code></td>
<td>
<p>Should the URL be encoded by
<code><a href="utils.html#topic+URLencode">URLencode</a></code> before passing to the browser?  This is not
needed (and might be harmful) if the <code>browser</code> program/function
itself does encoding, and can be harmful for &lsquo;<span class="samp">&#8288;file://&#8288;</span>&rsquo; URLs on some
systems and for &lsquo;<span class="samp">&#8288;http://&#8288;</span>&rsquo; URLs passed to some CGI applications.
Fortunately, most URLs do not need encoding.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A browser is opened with the B.C. Data Catalogue URL loaded if the
session is interactive. The URL used is returned as a character string.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+browseURL">browseURL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Take me to the B.C. Data Catalogue home page
try(
  bcdc_browse()
)

## Take me to the B.C. airports catalogue record
try(
 bcdc_browse("bc-airports")
)

## Take me to the B.C. airports catalogue record
try(
  bcdc_browse("76b1b7a3-2112-4444-857a-afccf7b20da8")
)

</code></pre>

<hr>
<h2 id='bcdc_check_geom_size'>Check spatial objects for WFS spatial operations</h2><span id='topic+bcdc_check_geom_size'></span>

<h3>Description</h3>

<p>Check a spatial object to see if it exceeds the current set value of
'bcdata.max_geom_pred_size' option, which controls how the object is treated when used inside a spatial predicate function in <code><a href="#topic+filter.bcdc_promise">filter.bcdc_promise()</a></code>. If the object does exceed the size
threshold a bounding box is drawn around it and all features
within the box will be returned. Further options include:
</p>

<ul>
<li><p> Try adjusting the value of the 'bcdata.max_geom_pred_size' option
</p>
</li>
<li><p> Simplify the spatial object to reduce its size
</p>
</li>
<li><p> Further processing on the returned object
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>bcdc_check_geom_size(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_check_geom_size_+3A_x">x</code></td>
<td>
<p>object of class sf, sfc or sfg</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the <a href="https://bcgov.github.io/bcdata/articles/efficiently-query-spatial-data-in-the-bc-data-catalogue.html">Querying Spatial Data with bcdata</a>
for more details.
</p>


<h3>Value</h3>

<p>invisibly return logical indicating whether the check pass. If the return
value is TRUE, the object will not need a bounding box drawn. If the return value is
FALSE, the check will fails and a bounding box will be drawn.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try({
  airports &lt;- bcdc_query_geodata("bc-airports") %&gt;% collect()
  bcdc_check_geom_size(airports)
})

</code></pre>

<hr>
<h2 id='bcdc_describe_feature'>Describe the attributes of a Web Feature Service</h2><span id='topic+bcdc_describe_feature'></span>

<h3>Description</h3>

<p>Describe the attributes of column of a record accessed through the Web Feature Service.
This can be a useful tool to examine a layer before issuing a query with <code>bcdc_query_geodata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_describe_feature(record)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_describe_feature_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>bcdc_describe_feature</code> returns a tibble describing the attributes of a B.C. Data Catalogue record.
The tibble returns the following columns:
</p>

<ul>
<li><p> col_name: attributes of the feature
</p>
</li>
<li><p> sticky: whether a column can be separated from the record in a Web Feature Service call via the <code>dplyr::select</code> method
</p>
</li>
<li><p> remote_col_type: class of what is return by the web feature service
</p>
</li>
<li><p> local_col_type: the column class in R
</p>
</li>
<li><p> column_comments: additional metadata specific to that column
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_describe_feature("bc-airports")
)

try(
  bcdc_describe_feature("WHSE_IMAGERY_AND_BASE_MAPS.GSR_AIRPORTS_SVW")
)


</code></pre>

<hr>
<h2 id='bcdc_get_citation'>Generate a bibentry from a Data Catalogue Record</h2><span id='topic+bcdc_get_citation'></span>

<h3>Description</h3>

<p>Generate a &quot;TechReport&quot; bibentry object directly from a catalogue record.
The primary use of this function is as a helper to create a <code>.bib</code> file for use
in reference management software to cite data from the B.C. Data Catalogue.
This function is likely to be starting place for this process and manual
adjustment will often be needed. The bibentries are not designed to be
authoritative and may not reflect all fields required for individual
citation requirements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_get_citation(record)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_get_citation_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL)
</p>
<p>It is advised to use the permanent ID for a record rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+bibentry">utils::bibentry()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
 bcdc_get_citation("76b1b7a3-2112-4444-857a-afccf7b20da8")
)

## Or directly on a record object
try(
 bcdc_get_citation(bcdc_get_record("76b1b7a3-2112-4444-857a-afccf7b20da8"))
)
</code></pre>

<hr>
<h2 id='bcdc_get_data'>Download and read a resource from a B.C. Data Catalogue record</h2><span id='topic+bcdc_get_data'></span>

<h3>Description</h3>

<p>Download and read a resource from a B.C. Data Catalogue record
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_get_data(record, resource = NULL, verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_get_data_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
<tr><td><code id="bcdc_get_data_+3A_resource">resource</code></td>
<td>
<p>optional argument used when there are multiple data files
within the same record. See examples.</p>
</td></tr>
<tr><td><code id="bcdc_get_data_+3A_verbose">verbose</code></td>
<td>
<p>When more than one resource is available for a record,
should extra information about those resources be printed to the console?
Default <code>TRUE</code></p>
</td></tr>
<tr><td><code id="bcdc_get_data_+3A_...">...</code></td>
<td>
<p>arguments passed to other functions. Tabular data is passed to a function to handle
the import based on the file extension. <code><a href="#topic+bcdc_read_functions">bcdc_read_functions()</a></code> provides details on which functions
handle the data import. You can then use this information to look at the help pages of those functions.
See the examples for a workflow that illustrates this process.
For spatial Web Feature Service data the <code>...</code> arguments are passed to <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of a type relevant to the resource (usually a tibble or an sf object, a list if the resource is a json file)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Using the record and resource ID:
try(
  bcdc_get_data(record = '76b1b7a3-2112-4444-857a-afccf7b20da8',
                resource = '4d0377d9-e8a1-429b-824f-0ce8f363512c')
)

try(
  bcdc_get_data('1d21922b-ec4f-42e5-8f6b-bf320a286157')
)

# Using a `bcdc_record` object obtained from `bcdc_get_record`:
try(
  record &lt;- bcdc_get_record('1d21922b-ec4f-42e5-8f6b-bf320a286157')
)

try(
  bcdc_get_data(record)
)

# Using a BCGW name
try(
  bcdc_get_data("WHSE_IMAGERY_AND_BASE_MAPS.GSR_AIRPORTS_SVW")
)

# Using sf's sql querying ability
try(
  bcdc_get_data(
    record = '30aeb5c1-4285-46c8-b60b-15b1a6f4258b',
    resource = '3d72cf36-ab53-4a2a-9988-a883d7488384',
    layer = 'BC_Boundary_Terrestrial_Line',
    query = "SELECT SHAPE_Length, geom FROM BC_Boundary_Terrestrial_Line WHERE SHAPE_Length &lt; 100"
  )
)

## Example of correcting import problems

## Some initial problems reading in the data
try(
  bcdc_get_data('d7e6c8c7-052f-4f06-b178-74c02c243ea4')
)

## From bcdc_get_record we realize that the data is in xlsx format
try(
 bcdc_get_record('8620ce82-4943-43c4-9932-40730a0255d6')
)

## bcdc_read_functions let's us know that bcdata
## uses readxl::read_excel to import xlsx files
try(
 bcdc_read_functions()
)

## bcdata let's you know that this resource has
## multiple worksheets
try(
 bcdc_get_data('8620ce82-4943-43c4-9932-40730a0255d6')
)

## we can control what is read in from an excel file
## using arguments from readxl::read_excel
try(
  bcdc_get_data('8620ce82-4943-43c4-9932-40730a0255d6', sheet = 'Regional Districts')
)


## Pass an argument through to a read_* function

try(
  bcdc_get_data(record = "a2a2130b-e853-49e8-9b30-1d0c735aa3d9",
                resource = "0b9e7d31-91ff-4146-a473-106a3b301964")
)

## we can control some properties of the list object returned by
## jsonlite::read_json by setting simplifyVector = TRUE or
## simplifyDataframe = TRUE
try(
 bcdc_get_data(record = "a2a2130b-e853-49e8-9b30-1d0c735aa3d9",
                resource = "0b9e7d31-91ff-4146-a473-106a3b301964",
                simplifyVector = TRUE)
)
</code></pre>

<hr>
<h2 id='bcdc_get_record'>Show a single B.C. Data Catalogue record</h2><span id='topic+bcdc_get_record'></span>

<h3>Description</h3>

<p>Show a single B.C. Data Catalogue record
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_get_record(id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_get_record_+3A_id">id</code></td>
<td>
<p>the human-readable name, permalink ID, or
URL of the record.
</p>
<p>It is advised to use the permanent ID for a record rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_record_warning" = TRUE)</code> - which you can put
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the metadata for the record
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_get_record("https://catalogue.data.gov.bc.ca/dataset/bc-airports")
)

try(
  bcdc_get_record("bc-airports")
)

try(
  bcdc_get_record("https://catalogue.data.gov.bc.ca/dataset/76b1b7a3-2112-4444-857a-afccf7b20da8")
)

try(
  bcdc_get_record("76b1b7a3-2112-4444-857a-afccf7b20da8")
)

</code></pre>

<hr>
<h2 id='bcdc_list'>Return a full list of the names of B.C. Data Catalogue records</h2><span id='topic+bcdc_list'></span>

<h3>Description</h3>

<p>Return a full list of the names of B.C. Data Catalogue records
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_list()
</code></pre>


<h3>Value</h3>

<p>A character vector of the names of B.C. Data Catalogue records
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_list()
)

</code></pre>

<hr>
<h2 id='bcdc_list_groups'>Retrieve group information for B.C. Data Catalogue</h2><span id='topic+bcdc_list_groups'></span><span id='topic+bcdc_list_group_records'></span>

<h3>Description</h3>

<p>Returns a tibble of groups or records. Groups can be viewed here:
https://catalogue.data.gov.bc.ca/group or accessed directly from R using <code>bcdc_list_groups</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_list_groups()

bcdc_list_group_records(group)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_list_groups_+3A_group">group</code></td>
<td>
<p>Name of the group</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>bcdc_list_groups()</code>: 
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_list_group_records('environmental-reporting-bc')
)

</code></pre>

<hr>
<h2 id='bcdc_list_organizations'>Retrieve organization information for B.C. Data Catalogue</h2><span id='topic+bcdc_list_organizations'></span><span id='topic+bcdc_list_organization_records'></span>

<h3>Description</h3>

<p>Returns a tibble of organizations or records. Organizations can be viewed here:
https://catalogue.data.gov.bc.ca/organizations or accessed directly from R using <code>bcdc_list_organizations</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_list_organizations()

bcdc_list_organization_records(organization)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_list_organizations_+3A_organization">organization</code></td>
<td>
<p>Name of the organization</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>bcdc_list_organizations()</code>: 
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_list_organization_records('bc-stats')
)

</code></pre>

<hr>
<h2 id='bcdc_options'>Retrieve options used in bcdata, their value if set and the default value.</h2><span id='topic+bcdc_options'></span>

<h3>Description</h3>

<p>This function retrieves bcdata specific options that can be set. These
options can be set using <code style="white-space: pre;">&#8288;option({name of the option} = {value of the option})&#8288;</code>. The default options are purposefully set conservatively to
hopefully ensure successful requests. Resetting these options may result in
failed calls to the data catalogue. Options in R are reset every time R is
re-started. See examples for additional ways to restore your initial state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_options()
</code></pre>


<h3>Details</h3>

<p><code>bcdata.max_geom_pred_size</code> is the maximum size in bytes of an object used
for a geometric operation. Objects that are bigger than this value will have
a bounding box drawn and apply the geometric operation on that simpler
polygon. The <a href="#topic+bcdc_check_geom_size">bcdc_check_geom_size</a> function can be used to assess whether a
given spatial object exceeds the value of this option. Users can iteratively
try to increase the maximum geometric predicate size and see if the bcdata
catalogue accepts the request.
</p>
<p><code>bcdata.chunk_limit</code> is an option useful when dealing with very large data
sets. When requesting large objects from the catalogue, the request is broken
up into smaller chunks which are then recombined after they've been
downloaded. This is called &quot;pagination&quot;. bcdata does this all for you, however by
using this option you can set the size of the chunk requested. On slower
connections, or when having problems, it may help to lower the chunk limit.
</p>
<p><code>bcdata.single_download_limit</code> <em>Deprecated</em>. This is the maximum number of
records an object can be before forcing a paginated download; it is set by
querying the server capabilities. This option is deprecated and will be
removed in a future release. Use <code>bcdata.chunk_limit</code> to set a lower value
pagination value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Save initial conditions
try(
  original_options &lt;- options()
)

## See initial options
try(
  bcdc_options()
)

try(
  options(bcdata.max_geom_pred_size = 1E6)
)

## See updated options
try(
  bcdc_options()
)

## Reset initial conditions
try(
  options(original_options)
)

</code></pre>

<hr>
<h2 id='bcdc_preview'>Get preview map from the B.C. Web Map Service</h2><span id='topic+bcdc_preview'></span>

<h3>Description</h3>

<p>Note this does not return the actual map features, rather
opens an image preview of the layer in a
<a href="https://rstudio.github.io/leaflet/">Leaflet</a> map window
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_preview(record)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_preview_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_preview("regional-districts-legally-defined-administrative-areas-of-bc")
)

try(
  bcdc_preview("water-reservations-points")
)

# Using BCGW name
try(
  bcdc_preview("WHSE_LEGAL_ADMIN_BOUNDARIES.ABMS_REGIONAL_DISTRICTS_SP")
)

</code></pre>

<hr>
<h2 id='bcdc_query_geodata'>Query data from the B.C. Web Feature Service</h2><span id='topic+bcdc_query_geodata'></span>

<h3>Description</h3>

<p>Queries features from the B.C. Web Feature Service. See
<code><a href="#topic+bcdc_tidy_resources">bcdc_tidy_resources()</a></code> - if a resource has a value of
<code>"wms"</code> in the <code>format</code> column it is available as a Web
Feature Service, and you can query and download it
using <code>bcdc_query_geodata()</code>. The response will be
paginated if the number of features is greater than that allowed by the server.
Please see <code><a href="#topic+bcdc_options">bcdc_options()</a></code> for defaults and more
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_query_geodata(record, crs = 3005)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_query_geodata_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
<tr><td><code id="bcdc_query_geodata_+3A_crs">crs</code></td>
<td>
<p>the epsg code for the coordinate reference system. Defaults to
<code>3005</code> (B.C. Albers). See https://epsg.io.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that this function doesn't actually return the data, but rather an
object of class <code>bcdc_promise</code>, which includes all of the information
required to retrieve the requested data. In order to get the actual data as
an <code>sf</code> object, you need to run <code><a href="#topic+collect">collect()</a></code> on the <code>bcdc_promise</code>. This
allows further refining the call to <code>bcdc_query_geodata()</code> with <code><a href="#topic+filter">filter()</a></code>
and/or <code><a href="#topic+select">select()</a></code> statements before pulling down the actual data as an <code>sf</code>
object with <code><a href="#topic+collect">collect()</a></code>. See examples.
</p>


<h3>Value</h3>

<p>A <code>bcdc_promise</code> object. This object includes all of the information
required to retrieve the requested data. In order to get the actual data as
an <code>sf</code> object, you need to run <code><a href="#topic+collect">collect()</a></code> on the <code>bcdc_promise</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Returns a bcdc_promise, which can be further refined using filter/select:
try(
  res &lt;- bcdc_query_geodata("bc-airports", crs = 3857)
)

# To obtain the actual data as an sf object, collect() must be called:
try(
  res &lt;- bcdc_query_geodata("bc-airports", crs = 3857) %&gt;%
    filter(PHYSICAL_ADDRESS == 'Victoria, BC') %&gt;%
    collect()
)

try(
  res &lt;- bcdc_query_geodata("groundwater-wells") %&gt;%
    filter(OBSERVATION_WELL_NUMBER == "108") %&gt;%
    select(WELL_TAG_NUMBER, INTENDED_WATER_USE) %&gt;%
    collect()
)

## A moderately large layer
try(
  res &lt;- bcdc_query_geodata("bc-environmental-monitoring-locations")
)

try(
  res &lt;- bcdc_query_geodata("bc-environmental-monitoring-locations") %&gt;%
    filter(PERMIT_RELATIONSHIP == "DISCHARGE")
)


## A very large layer
try(
  res &lt;- bcdc_query_geodata("terrestrial-protected-areas-representation-by-biogeoclimatic-unit")
)

## Using a BCGW name
try(
  res &lt;- bcdc_query_geodata("WHSE_IMAGERY_AND_BASE_MAPS.GSR_AIRPORTS_SVW")
)

</code></pre>

<hr>
<h2 id='bcdc_read_functions'>Formats supported and loading functions</h2><span id='topic+bcdc_read_functions'></span>

<h3>Description</h3>

<p>Provides a tibble of formats supported by bcdata and the associated function that
reads that data into R. This function is meant as a resource to determine which parameters
can be passed through the <code>bcdc_get_data</code> function to the reading function. This is
particularly important to know if the data requires using arguments from the read in function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_read_functions()
</code></pre>

<hr>
<h2 id='bcdc_search'>Search the B.C. Data Catalogue</h2><span id='topic+bcdc_search'></span>

<h3>Description</h3>

<p>Search the B.C. Data Catalogue
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_search(
  ...,
  license_id = NULL,
  download_audience = NULL,
  res_format = NULL,
  sector = NULL,
  organization = NULL,
  groups = NULL,
  n = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_search_+3A_...">...</code></td>
<td>
<p>search terms</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_license_id">license_id</code></td>
<td>
<p>the type of license (see <code>bcdc_search_facets("license_id")</code>).</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_download_audience">download_audience</code></td>
<td>
<p>download audience
(see <code>bcdc_search_facets("download_audience")</code>). Default <code>NULL</code> (all audiences).</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_res_format">res_format</code></td>
<td>
<p>format of resource (see <code>bcdc_search_facets("res_format")</code>)</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_sector">sector</code></td>
<td>
<p>sector of government from which the data comes
(see <code>bcdc_search_facets("sector")</code>)</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_organization">organization</code></td>
<td>
<p>government organization that manages the data
(see <code>bcdc_search_facets("organization")</code>)</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_groups">groups</code></td>
<td>
<p>collections of datasets for a particular project or on a particular theme
(see <code>bcdc_search_facets("groups")</code>)</p>
</td></tr>
<tr><td><code id="bcdc_search_+3A_n">n</code></td>
<td>
<p>number of results to return. Default <code>100</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the records that match the search
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_search("forest")
)

try(
  bcdc_search("regional district", res_format = "fgdb")
)

try(
  bcdc_search("angling", groups = "bc-tourism")
)

</code></pre>

<hr>
<h2 id='bcdc_search_facets'>Get the valid values for a facet (that you can use in <code><a href="#topic+bcdc_search">bcdc_search()</a></code>)</h2><span id='topic+bcdc_search_facets'></span>

<h3>Description</h3>

<p>Get the valid values for a facet (that you can use in <code><a href="#topic+bcdc_search">bcdc_search()</a></code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_search_facets(
  facet = c("license_id", "download_audience", "res_format", "publish_state",
    "organization", "groups")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_search_facets_+3A_facet">facet</code></td>
<td>
<p>the facet(s) for which to retrieve valid values. Can be one or
more of:
<code style="white-space: pre;">&#8288;"license_id", "download_audience", "res_format", "publish_state", "organization", "groups"&#8288;</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of values for the selected facet
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_search_facets("download_audience")
)

try(
  bcdc_search_facets("res_format")
)

</code></pre>

<hr>
<h2 id='bcdc_tidy_resources'>Provide a data frame containing the metadata for all resources from a single B.C. Data Catalogue record</h2><span id='topic+bcdc_tidy_resources'></span>

<h3>Description</h3>

<p>Returns a rectangular data frame of all resources contained within a record. This is particularly useful
if you are trying to construct a vector of multiple resources in a record. The data frame also provides
useful information on the formats, availability and types of data available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdc_tidy_resources(record)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdc_tidy_resources_+3A_record">record</code></td>
<td>
<p>either a <code>bcdc_record</code> object (from the result of <code>bcdc_get_record()</code>),
a character string denoting the name or ID of a resource (or the URL) or a BC Geographic
Warehouse (BCGW) name.
</p>
<p>It is advised to use the permanent ID for a record or the BCGW name rather than the
human-readable name to guard against future name changes of the record.
If you use the human-readable name a warning will be issued once per
session. You can silence these warnings altogether by setting an option:
<code>options("silence_named_get_data_warning" = TRUE)</code> - which you can set
in your .Rprofile file so the option persists across sessions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing the metadata for all the resources for a record
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  airports &lt;- bcdc_get_record("bc-airports")
)

try(
  bcdc_tidy_resources(airports)
)


</code></pre>

<hr>
<h2 id='CQL'>CQL escaping</h2><span id='topic+CQL'></span><span id='topic+CQL-class'></span>

<h3>Description</h3>

<p>Write a CQL expression to escape its inputs, and return a CQL/SQL object.
Used when writing filter expressions in <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CQL(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CQL_+3A_...">...</code></td>
<td>
<p>Character vectors that will be combined into a single CQL statement.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <a href="https://docs.geoserver.org/stable/en/user/tutorials/cql/cql_tutorial.html">the CQL/ECQL for Geoserver website</a>.
</p>


<h3>Value</h3>

<p>An object of class <code>c("CQL", "SQL")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CQL("FOO &gt; 12 &amp; NAME LIKE 'A&amp;'")
</code></pre>

<hr>
<h2 id='cql_geom_predicates'>CQL Geometry Predicates</h2><span id='topic+cql_geom_predicates'></span><span id='topic+EQUALS'></span><span id='topic+DISJOINT'></span><span id='topic+INTERSECTS'></span><span id='topic+TOUCHES'></span><span id='topic+CROSSES'></span><span id='topic+WITHIN'></span><span id='topic+CONTAINS'></span><span id='topic+OVERLAPS'></span><span id='topic+BBOX'></span><span id='topic+DWITHIN'></span>

<h3>Description</h3>

<p>Functions to construct a CQL expression to be used
to filter results from <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>.
See <a href="https://docs.geoserver.org/stable/en/user/filter/ecql_reference.html#spatial-predicate">the geoserver CQL documentation for details</a>.
The sf object is automatically converted in a
bounding box to reduce the complexity of the Web Feature Service call. Subsequent in-memory
filtering may be needed to achieve exact results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EQUALS(geom)

DISJOINT(geom)

INTERSECTS(geom)

TOUCHES(geom)

CROSSES(geom)

WITHIN(geom)

CONTAINS(geom)

OVERLAPS(geom)

BBOX(coords, crs = NULL)

DWITHIN(
  geom,
  distance,
  units = c("meters", "feet", "statute miles", "nautical miles", "kilometers")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cql_geom_predicates_+3A_geom">geom</code></td>
<td>
<p>an <code>sf</code>/<code>sfc</code>/<code>sfg</code> or <code>bbox</code> object (from the <code>sf</code> package)</p>
</td></tr>
<tr><td><code id="cql_geom_predicates_+3A_coords">coords</code></td>
<td>
<p>the coordinates of the bounding box as four-element numeric
vector <code>c(xmin, ymin, xmax, ymax)</code>, a <code>bbox</code> object from the <code>sf</code>
package (the result of running <code>sf::st_bbox()</code> on an <code>sf</code> object), or
an <code>sf</code> object which then gets converted to a bounding box on the fly.</p>
</td></tr>
<tr><td><code id="cql_geom_predicates_+3A_crs">crs</code></td>
<td>
<p>(Optional) A numeric value or string containing an SRS code. If
<code>coords</code> is a <code>bbox</code> object with non-empty crs, it is taken from that.
(For example, <code>'EPSG:3005'</code> or just <code>3005</code>. The default is to use the CRS of
the queried layer)</p>
</td></tr>
<tr><td><code id="cql_geom_predicates_+3A_distance">distance</code></td>
<td>
<p>numeric value for distance tolerance</p>
</td></tr>
<tr><td><code id="cql_geom_predicates_+3A_units">units</code></td>
<td>
<p>units that distance is specified in. One of
<code>"feet"</code>, <code>"meters"</code>, <code>"statute miles"</code>, <code>"nautical miles"</code>, <code>"kilometers"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a CQL expression to be passed on to the WFS call
</p>

<hr>
<h2 id='filter.bcdc_promise'>Filter a query from bcdc_query_geodata()</h2><span id='topic+filter.bcdc_promise'></span><span id='topic+filter'></span>

<h3>Description</h3>

<p>Filter a query from Web Feature Service using dplyr
methods. This filtering is accomplished lazily so that
the full sf object is not read into memory until
<code>collect()</code> has been called.
</p>
<p>See <code>dplyr::<a href="dplyr.html#topic+filter">filter</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdc_promise'
filter(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter.bcdc_promise_+3A_.data">.data</code></td>
<td>
<p>object of class <code>bcdc_promise</code> (likely passed from <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>)</p>
</td></tr>
<tr><td><code id="filter.bcdc_promise_+3A_...">...</code></td>
<td>
<p>Logical predicates with which to filter the results. Multiple
conditions are combined with <code>&amp;</code>. Only rows where the condition evaluates to
<code>TRUE</code> are kept. Accepts normal R expressions as well as any of the special
<a href="#topic+cql_geom_predicates">CQL geometry functions</a> such as <code>WITHIN()</code> or <code>INTERSECTS()</code>.
If you know <code>CQL</code> and want to write a <code>CQL</code> query directly, write it enclosed
in quotes, wrapped in the <code><a href="#topic+CQL">CQL()</a></code> function. e.g., <code>CQL("ID = '42'")</code>.
</p>
<p>If your filter expression contains calls that need to be executed locally, wrap them
in <code>local()</code> to force evaluation in R before the request is sent to the server.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>filter(bcdc_promise)</code>: filter.bcdc_promise
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  crd &lt;- bcdc_query_geodata("regional-districts-legally-defined-administrative-areas-of-bc") %&gt;%
    filter(ADMIN_AREA_NAME == "Cariboo Regional District") %&gt;%
    collect()
)

try(
  ret1 &lt;- bcdc_query_geodata("bc-wildfire-fire-perimeters-historical") %&gt;%
    filter(FIRE_YEAR == 2000, FIRE_CAUSE == "Person", INTERSECTS(crd)) %&gt;%
    collect()
)

# Use local() to force parts of your call to be evaluated in R:
try({
  # Create a bounding box around two points and use that to filter
  # the remote data set
  library(sf)
  two_points &lt;- st_sfc(st_point(c(1164434, 368738)),
                     st_point(c(1203023, 412959)),
                     crs = 3005)

  # Wrapping the call to `st_bbox()` in `local()` ensures that it
  # is executed in R to make a bounding box that is then sent to
  # the server for the filtering operation:
  res &lt;- bcdc_query_geodata("local-and-regional-greenspaces") %&gt;%
    filter(BBOX(local(st_bbox(two_points, crs = st_crs(two_points))))) %&gt;%
    collect()
})

</code></pre>

<hr>
<h2 id='mutate.bcdc_promise'>Throw an informative error when attempting mutate on a <code>bcdc_promise</code> object</h2><span id='topic+mutate.bcdc_promise'></span><span id='topic+mutate'></span>

<h3>Description</h3>

<p>The CQL syntax to generate WFS calls does not current allow arithmetic operations. Therefore
this function exists solely to generate an informative error that suggests an alternative
approach to use mutate with bcdata
</p>
<p>See <code>dplyr::<a href="dplyr.html#topic+mutate">mutate</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdc_promise'
mutate(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutate.bcdc_promise_+3A_.data">.data</code></td>
<td>
<p>object of class <code>bcdc_promise</code> (likely passed from <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>)</p>
</td></tr>
<tr><td><code id="mutate.bcdc_promise_+3A_...">...</code></td>
<td>
<p>One or more unquoted expressions separated by commas. See details.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>mutate(bcdc_promise)</code>: mutate.bcdc_promise
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>

## Mutate columns
try(
  res &lt;- bcdc_query_geodata("bc-airports") %&gt;%
    mutate(LATITUDE * 100)
)


</code></pre>

<hr>
<h2 id='select.bcdc_promise'>Select columns from bcdc_query_geodata() call</h2><span id='topic+select.bcdc_promise'></span><span id='topic+select'></span>

<h3>Description</h3>

<p>Similar to a <code>dplyr::select</code> call, this allows you to select which columns you want the Web Feature Service to return.
A key difference between <code>dplyr::select</code> and <code>bcdata::select</code> is the presence of &quot;sticky&quot; columns that are
returned regardless of what columns are selected. If any of these &quot;sticky&quot; columns are selected
only &quot;sticky&quot; columns are return. <code>bcdc_describe_feature</code> is one way to tell if columns are sticky in advance
of issuing the Web Feature Service call.
</p>
<p>See <code>dplyr::<a href="dplyr.html#topic+select">select</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdc_promise'
select(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select.bcdc_promise_+3A_.data">.data</code></td>
<td>
<p>object of class <code>bcdc_promise</code> (likely passed from <code><a href="#topic+bcdc_query_geodata">bcdc_query_geodata()</a></code>)</p>
</td></tr>
<tr><td><code id="select.bcdc_promise_+3A_...">...</code></td>
<td>
<p>One or more unquoted expressions separated by commas. See details.</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>select(bcdc_promise)</code>: select.bcdc_promise
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  feature_spec &lt;- bcdc_describe_feature("bc-airports")
)

try(
  ## Columns that can selected:
  feature_spec[feature_spec$sticky == TRUE,]
)

## Select columns
try(
  res &lt;- bcdc_query_geodata("bc-airports") %&gt;%
    select(DESCRIPTION, PHYSICAL_ADDRESS)
)

## Select "sticky" columns
try(
  res &lt;- bcdc_query_geodata("bc-airports") %&gt;%
    select(LOCALITY)
)



</code></pre>

<hr>
<h2 id='show_query.bcdc_promise'>Show SQL and URL used for Web Feature Service request from B.C. Data Catalogue</h2><span id='topic+show_query.bcdc_promise'></span><span id='topic+show_query.bcdc_sf'></span><span id='topic+show_query'></span>

<h3>Description</h3>

<p>Display Web Feature Service query CQL
</p>
<p>See <code>dplyr::<a href="dplyr.html#topic+explain">show_query</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdc_promise'
show_query(x, ...)

## S3 method for class 'bcdc_sf'
show_query(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_query.bcdc_promise_+3A_x">x</code></td>
<td>
<p>object of class bcdc_promise or bcdc_sf</p>
</td></tr>
</table>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>show_query(bcdc_promise)</code>: show_query.bcdc_promise
</p>
</li>
<li> <p><code>show_query(bcdc_sf)</code>: show_query.bcdc_promise
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'>
try(
  bcdc_query_geodata("bc-environmental-monitoring-locations") %&gt;%
    filter(PERMIT_RELATIONSHIP == "DISCHARGE") %&gt;%
    show_query()
)
  


try(
  air &lt;- bcdc_query_geodata("bc-airports") %&gt;%
    collect()
)

try(
  show_query(air)
)

</code></pre>

<hr>
<h2 id='wfsConnection-class'>wfsConnection class</h2><span id='topic+wfsConnection-class'></span><span id='topic+dbQuoteIdentifier+2CwfsConnection+2CCQL-method'></span><span id='topic+dbQuoteString+2CwfsConnection+2CCQL-method'></span>

<h3>Description</h3>

<p>wfsConnection class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'wfsConnection,CQL'
dbQuoteIdentifier(conn, x)

## S4 method for signature 'wfsConnection,CQL'
dbQuoteString(conn, x)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
