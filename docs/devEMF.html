<!DOCTYPE html><html><head><title>Help for package devEMF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {devEMF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#emf'><p>Enhanced Metafile Graphics Device</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>EMF Graphics Output Device</td>
</tr>
<tr>
<td>Version:</td>
<td>4.4-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Philip Johnson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philip Johnson &lt;plfj@umd.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10.1)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>fontconfig or zlib (only needed for platforms other
than modern OSX and Windows)</td>
</tr>
<tr>
<td>Description:</td>
<td>Output graphics to EMF+/EMF.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/plfjohnson/devEMF">https://github.com/plfjohnson/devEMF</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/plfjohnson/devEMF/issues">https://github.com/plfjohnson/devEMF/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-02 19:37:51 UTC; pjohnson</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-02 20:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='emf'>Enhanced Metafile Graphics Device</h2><span id='topic+emf'></span><span id='topic+devEMF'></span>

<h3>Description</h3>

<p>'emf' starts the graphics device driver for producing enhanced
metafile (emf+/emf) graphics, which can imported natively as vector
graphics in both LibreOffice and Microsoft Office.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
emf(file = "Rplot.emf", width = 7, height = 7, units = c("in", "cm", "mm"),
    bg = "transparent", fg = "black", pointsize = 12,
    family = "Helvetica", coordDPI = 300, custom.lty=emfPlus,
    emfPlus=TRUE, emfPlusFont = FALSE, emfPlusRaster = FALSE,
    emfPlusFontToPath = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emf_+3A_file">file</code></td>
<td>
<p>character string giving the name of file.</p>
</td></tr>
<tr><td><code id="emf_+3A_width">width</code></td>
<td>
<p>width of plot.</p>
</td></tr>
<tr><td><code id="emf_+3A_height">height</code></td>
<td>
<p>height of plot.</p>
</td></tr>
<tr><td><code id="emf_+3A_units">units</code></td>
<td>
<p>units in which <code>width</code> and <code>height</code> are
given.  Must be one of <code>in</code> (inches, default), <code>cm</code>, or <code>mm</code>.</p>
</td></tr>
<tr><td><code id="emf_+3A_bg">bg</code></td>
<td>
<p>plot background color.  If <code>transparent</code>, no background
color is painted.</p>
</td></tr>
<tr><td><code id="emf_+3A_fg">fg</code></td>
<td>
<p>initial foreground color to be used.</p>
</td></tr>
<tr><td><code id="emf_+3A_pointsize">pointsize</code></td>
<td>
<p>default font point size to be used.</p>
</td></tr>
<tr><td><code id="emf_+3A_family">family</code></td>
<td>
<p>default font family to be used (if you use non-standard
fonts, consider setting emfPlusFontToPath=TRUE to ensure text looks
correct on the viewing system).</p>
</td></tr>
<tr><td><code id="emf_+3A_coorddpi">coordDPI</code></td>
<td>
<p>DPI used for coordinate system (while EMF is a vector
format, it (and R) use discrete coordinate systems).</p>
</td></tr>
<tr><td><code id="emf_+3A_custom.lty">custom.lty</code></td>
<td>
<p>logical: if false, approximate R line types with EMF
standard line types (any program that imports EMF should support
this).  If true, use exact (custom) R line type, which is only
supported by LibreOffice if using EMF+.</p>
</td></tr>
<tr><td><code id="emf_+3A_emfplus">emfPlus</code></td>
<td>
<p>logical: whether to use EMF+ records or not</p>
</td></tr>
<tr><td><code id="emf_+3A_emfplusfont">emfPlusFont</code></td>
<td>
<p>logical: if using EMF+, should text use EMF+ or EMF
records?</p>
</td></tr>
<tr><td><code id="emf_+3A_emfplusraster">emfPlusRaster</code></td>
<td>
<p>logical: if using EMF+, should raster images use
EMF+ or EMF records?</p>
</td></tr>
<tr><td><code id="emf_+3A_emfplusfonttopath">emfPlusFontToPath</code></td>
<td>
<p>logical: if using EMF+, should text be
converted to graphics paths and saved in file?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The standard office suites support very few vector graphics formats
for import.  Enhanced Metafiles (EMFs) do tend to be supported, which
is the purpose of this device.  EMF+ is a newer format that is
encapsulated within an EMF file and allows options such as partial
transparency.
</p>
<p>The EMF/EMF+ specifications do not allow for multiple pages; attempting to
create multiple pages will result in a warning message and the output
file will contain the different pages superimposed.
</p>
<p>Also, note EMF/EMF+ does not support font embedding, so with the
default options, any fonts used must be present both on the system
that you use when you create the graphics file (i.e., when you run R)
and on the system that you use to import/view the file.  HOWEVER, the
<code>emfPlusFontToPath = TRUE</code> option converts text characters into
graphics paths and makes the resulting EMF+ files truly portable
(although text strings will no longer be editable by downstream
programs).  This option is currently only implemented for Linux (with
Fontconfig installed) and Windows.  Contact the author if you'd
like to request implementation on Apple.
</p>
<p>EMF/EMF+ supports Unicode characters, and this package tries to
maintain that support as well.  However, font metric information is
system dependent and on linux depends on Fontconfig being
installed.  Regardless, basic font metrics for the standard Adobe
PostScript font families are built into this package.
</p>
<p>Only EMF+ allows partial transparency (i.e., the only useful type &ndash;
0.0 &lt; alpha &lt; 1.0); attempting to use a transparent color when
<code>emfPlus = FALSE</code> will result in a warning message and the output
will be completely transparent (invisible).
</p>
<p>LibreOffice support for EMF+ was incomplete as of version 5, and,
cannot handle EMF+ records with rotated text or raster images (hence
the options to turn off EMF+ and use EMF instead for these types of
records).  devEMF defaults to EMF for these records to maintain
compatibility, but quality is higher if EMF+ records are used.
</p>


<h3>Known limitations</h3>


<ul>
<li><p> EMF (as opposed to EMF+) raster rendering does not support
interpolation control.
</p>
</li>
<li><p> EMF (as opposed to EMF+) does not support an alpha channel.
</p>
</li>
<li><p> Path rendering is not implemented for EMF (as opposed to
EMF+).
</p>
</li>
<li><p> The EMF/EMF+ specification needs logical bounds in integer
units of mm, but needs the graphic frame bounds in integer units of
0.01mm.  This discrepancy can create a small gap at the right and
bottom edges of the graphic.  If you need to make a graphic precisely
full-bleed with no gap (and no cropping), set the logical DPI high
(perhaps 1000) and specify figure width and height in integer units of
mm.  If using Microsoft Office to view the graphic, you'll need to
shrink the bounds by a few 0.01mm (subtracting 0.04mm appears
sufficient) to completely eliminate the gap.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philip Johnson
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+Devices">Devices</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(devEMF)
## Not run: 
# open file "bar.emf" for graphics output
emf("bar.emf")
# produce the desired graph(s)
plot(1,1)
dev.off() #turn off device and finalize file

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
