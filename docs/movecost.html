<!DOCTYPE html><html><head><title>Help for package movecost</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {movecost}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_barrier_cs'><p>Create barrier cost surface</p></a></li>
<li><a href='#destin.loc'><p>Dataset: locations on the volcano Maunga Whau (Auckland, New Zealand)</p></a></li>
<li><a href='#Etna_boundary'><p>Dataset: bounding polygon representing a study area on Mount Etna (Sicily, Italy)</p></a></li>
<li><a href='#Etna_end_location'><p>Dataset: locations on Mount Etna (Sicily, Italy)</p></a></li>
<li><a href='#Etna_start_location'><p>Dataset: location on Mount Etna (Sicily, Italy)</p></a></li>
<li><a href='#malta_dtm_40'><p>Dataset: Malta DTM (40m cell size)</p></a></li>
<li><a href='#movealloc'><p>R function for calculating slope-dependant walking-cost allocation to origins</p></a></li>
<li><a href='#movebound'><p>R function for calculating slope-dependant walking cost boundary(ies) around point location(s)</p></a></li>
<li><a href='#movecomp'><p>R function for comparing least-cost paths generated using different cost functions</p></a></li>
<li><a href='#movecorr'><p>R function for calculating least-cost corridor between point locations</p></a></li>
<li><a href='#movecost'><p>R function for calculating accumulated anisotropic slope-dependant cost of movement across the terrain and least-cost paths from a point origin</p></a></li>
<li><a href='#movenetw'><p>R function for calculating least-cost path network</p></a></li>
<li><a href='#moverank'><p>R function for calculating sub-optimal least-cost paths bewteen an origin and a destination location</p></a></li>
<li><a href='#springs'><p>Dataset: location of springs in Malta</p></a></li>
<li><a href='#volc'><p>Dataset: raster dataset representing the elevation of the volcano Maunga Whau (Auckland, New Zealand)</p></a></li>
<li><a href='#volc.loc'><p>Dataset: location on the volcano Maunga Whau (Auckland, New Zealand)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Calculation of Slope-Dependant Accumulated Cost Surface,
Least-Cost Paths, Least-Cost Corridors, Least-Cost Networks
Related to Human Movement Across the Landscape</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides the facility to calculate non-isotropic accumulated cost surface, least-cost paths, least-cost corridors, least-cost networks using a number of human-movement-related cost functions that can be selected by the user. It just requires a Digital Terrain Model, a start location and (optionally) destination locations. See Alberti (2019) &lt;<a href="https://doi.org/10.1016%2Fj.softx.2019.100331">doi:10.1016/j.softx.2019.100331</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>chron (&ge; 2.3-56), gdistance (&ge; 1.2-2), elevatr (&ge; 0.3.4),
Matrix (&ge; 1.5.0), methods (&ge; 4.0.3), raster (&ge; 2.8-4), sf
(&ge; 1.0-9), sp (&ge; 1.4.0), terra (&ge; 1.3.0), utils (&ge; 4.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-12 17:03:47 UTC; gianmarcoalberti</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianmarco Alberti [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianmarco Alberti &lt;gianmarcoalberti@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-12 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_barrier_cs'>Create barrier cost surface</h2><span id='topic+create_barrier_cs'></span>

<h3>Description</h3>

<p>Creates a cost surface that incorporates barriers that inhibit movement in the landscape.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_barrier_cs(raster, barrier, neighbours = 16, field = 0, background = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_barrier_cs_+3A_raster">raster</code></td>
<td>
<p>RasterLayer (raster package). The Resolution, Extent, and Spatial Reference System of the provided RasterLayer is used when creating the resultant Barrier Cost Surface.</p>
</td></tr>
<tr><td><code id="create_barrier_cs_+3A_barrier">barrier</code></td>
<td>
<p>Spatial* (sp package) or RasterLayer (raster package). Area within the landscape that movement is inhibited.</p>
</td></tr>
<tr><td><code id="create_barrier_cs_+3A_neighbours">neighbours</code></td>
<td>
<p>Number of directions used in the Least Cost Path calculation.</p>
</td></tr>
<tr><td><code id="create_barrier_cs_+3A_field">field</code></td>
<td>
<p>Value assigned to cells that coincide with the barrier Spatial* or RasterLayer object. Default is numeric value 0.</p>
</td></tr>
<tr><td><code id="create_barrier_cs_+3A_background">background</code></td>
<td>
<p>Value assigned to cells that do not coincide with the Spatial* or RasterLayer object. Default is numeric value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The resultant Barrier Cost Surface is produced by assessing which areas of the raster
coincide with the Spatial* or RasterLayer object as specified in the barrier argument.
The areas of the raster that coincide with the barrier are given a conductance value of 0
(default value, with all other areas given a Conductance value of 1 (default value).
The conductance value of 0 ensures that movement is inhibited within these areas.
Examples of use include rivers, altitudes, and taboo areas.
If a RasterLayer object is supplied in the barrier argument then all cells with a value NOT NA will be
used as the barrier. <br />
</p>


<h3>Value</h3>

<p>TransitionLayer (gdistance package) numerically expressing the barriers to movement in the landscape.
The resultant TransitionLayer can be incorporated with other TransitionLayer through Raster calculations.
</p>

<hr>
<h2 id='destin.loc'>Dataset: locations on the volcano Maunga Whau (Auckland, New Zealand)</h2><span id='topic+destin.loc'></span>

<h3>Description</h3>

<p>A SpatialPointsDataFrame representing spots on the volcano Maunga Whau (Auckland, New Zealand), to be used as destination locations for least-cost paths calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(destin.loc)
</code></pre>


<h3>Format</h3>

<p>SpatialPointsDataFrame
</p>

<hr>
<h2 id='Etna_boundary'>Dataset: bounding polygon representing a study area on Mount Etna (Sicily, Italy)</h2><span id='topic+Etna_boundary'></span>

<h3>Description</h3>

<p>A SpatialPolygonDataFrame representing an area on Mount Etna (Sicily, Italy), to be used to download elevation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Etna_boundary)
</code></pre>


<h3>Format</h3>

<p>SpatialPolygonDataFrame
</p>

<hr>
<h2 id='Etna_end_location'>Dataset: locations on Mount Etna (Sicily, Italy)</h2><span id='topic+Etna_end_location'></span>

<h3>Description</h3>

<p>A SpatialPointsDataFrame representing spots on Mount Etna (Sicily, Italy), to be used as destination locations for least-cost paths calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Etna_end_location)
</code></pre>


<h3>Format</h3>

<p>SpatialPointsDataFrame
</p>

<hr>
<h2 id='Etna_start_location'>Dataset: location on Mount Etna (Sicily, Italy)</h2><span id='topic+Etna_start_location'></span>

<h3>Description</h3>

<p>A SpatialPointsDataFrame representing a spot on Mount Etna, to be used as start location for least-cost paths calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Etna_start_location)
</code></pre>


<h3>Format</h3>

<p>SpatialPointsDataFrame
</p>

<hr>
<h2 id='malta_dtm_40'>Dataset: Malta DTM (40m cell size)</h2><span id='topic+malta_dtm_40'></span>

<h3>Description</h3>

<p>A RasterLayer representing a Digital Terrain Model of Malta (40m resolution).<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(malta_dtm_40)
</code></pre>


<h3>Format</h3>

<p>RasterLayer
</p>

<hr>
<h2 id='movealloc'>R function for calculating slope-dependant walking-cost allocation to origins</h2><span id='topic+movealloc'></span>

<h3>Description</h3>

<p>The function provides the facility to carry out a cost allocation analysis. Given a number of origin locations,
a cost allocation raster is produced; each cell of the cost allocation raster is given an integer indicating to which origin
a cell is closer in terms of cost. Needless to say, the cost can be conceptualized in terms of either walking time or
energy expenditure, and is function of the terrain slope.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movealloc(
  dtm = NULL,
  origin,
  studyplot = NULL,
  funct = "t",
  time = "h",
  move = 16,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  isolines = FALSE,
  breaks = NULL,
  cont.lab = TRUE,
  cex.breaks = 0.6,
  leg.alloc = FALSE,
  leg.pos = "topright",
  cex.leg = 0.75,
  transp = 0.5,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movealloc_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_origin">origin</code></td>
<td>
<p>locations (two at least) in relation to which the cost allocation is carried out (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_funct">funct</code></td>
<td>
<p>cost function to be used (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="movealloc_+3A_time">time</code></td>
<td>
<p>time-unit expressed by the isoline(s) if Tobler's and other time-related cost functions are used; h' for hour, 'm' for minutes.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_isolines">isolines</code></td>
<td>
<p>TRUE or FALSE (default) is the user wants or does not want cost isolines/contours around the origins to be calculated and plotted.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_breaks">breaks</code></td>
<td>
<p>contours' (i.e., isolines') interval; if no value is supplied, the interval is set by default to 1/10 of the range of values of the cost surface accumulated around the origins.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_cont.lab">cont.lab</code></td>
<td>
<p>if set to TRUE (default) display the labels of the cost contours.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_cex.breaks">cex.breaks</code></td>
<td>
<p>set the size of the labels attached to the cost contours (0.6 by default).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_leg.alloc">leg.alloc</code></td>
<td>
<p>if set to TRUE, display the legend in the plotted cost allocation raster; FALSE by default.</p>
</td></tr>
<tr><td><code id="movealloc_+3A_leg.pos">leg.pos</code></td>
<td>
<p>set the position of the legend in the plotted cost allocation raster; 'topright' by default (other options: &quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot;, &quot;center&quot;).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_cex.leg">cex.leg</code></td>
<td>
<p>set the size of the labels used in the legend displayed in the plotted allocation raster (0.75 by default).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the cost allocation raster (0.5 by default).</p>
</td></tr>
<tr><td><code id="movealloc_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the output to be exported; if TRUE, the isolines (i.e. the contours) and the allocation boundaries will be exported as a shapefile;
the cost allocation raster will be exported as 'GeoTiff'; the DTM is exported only if it was not provided by the user and downloaded by the function from online sources; all the exported files (excluding the DTM)
will bear a suffix corresponding to the cost function selected by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function requires an input DTM ('RasterLayer' class) and a dataset ('SpatialPointsDataFrame' class) containing the
origin locations. If a DTM is not provided, <code>movealloc()</code> will download elevation data from online sources (see <code><a href="#topic+movecost">movecost</a></code> for more details).
Under the hood, <code>movealloc()</code> relies on the <code>movecost()</code> function and implements the same cost functions:
see the help documentation of <code>movecost()</code> for further information.<br />
</p>
<p>Internally, what <code>movealloc()</code> does is producing an accumulated cost surface around each individual origin location; those
accumulated cost surfaces are then stacked together, and then the function looks at each pixel in the stack of surfaces and
returns 1 if the first stacked surface has the smallest pixel value, or 2 if the second stacked surface has the smallest pixel value, and so on for bigger stacks.<br />
</p>
<p><code>movealloc()</code> produces a plot featuring a slopeshade image that is overlaid by the cost allocation raster and by a polygon layer
where each polygon represents the limits of each allocation zone. A legend can be optionally added to the plot via the <code>leg.alloc</code> parameter (FALSE by default).
Isolines (i.e., contour lines) around each origin location can be optionally plotted via the 'isolines' parameter (FALSE by default).<br />
</p>
<p>The DTM, the cost allocation raster, the cost allocation polygons, and the isolines (if requested by the user by setting the  <code>isolines</code> parameter to TRUE), can
be exported by setting the 'export' parameter to TRUE. All the exported files (excluding the DTM) will bear a suffix corresponding to the cost function selected by the user.
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class)
</p>
</li>
<li><p> cost.allocation.raster: raster of the cost allocation ('RasterLayer' class)
</p>
</li>
<li><p> isolines: contour lines representing the accumulated cost around the origins ('SpatialLinesDataFrame' class); returned if the 'isolines' parameter is set to TRUE
</p>
</li>
<li><p> alloc.boundaries: polygons representing the allocation zones ('SpatialPolygonsDataFrame' class)
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample locations on the above DTM
data(destin.loc)


#carry out a cost allocation analysis using the Tobler's off-path hiking function,
#setting the time to minutes and the isolines (i.e., contours) interval to 1 minute;
#only 3 locations are used

#result &lt;- movealloc(dtm=volc, origin=destin.loc[c(3,7,9),], funct="tofp", time="m",
#breaks=1, isolines=TRUE)


#same as above, using all the locations and the Kondo-Seino's cost function

#result &lt;- movealloc(dtm=volc, origin=destin.loc, funct="ks", time="m",
#breaks=1, isolines=TRUE)


</code></pre>

<hr>
<h2 id='movebound'>R function for calculating slope-dependant walking cost boundary(ies) around point location(s)</h2><span id='topic+movebound'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate walking cost boundary(ies) around one or more point locations. Rationale: while <code><a href="#topic+movecost">movecost</a></code>
can calculate and render an accumulated cost surface and corresponding isolines around a point location, the user(s) might want to
calculate and plot a boundary (or boundaries) corresponding to a specific walking cost limit around one or more locations,
either in terms of walking time or energy expenditure.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movebound(
  dtm = NULL,
  origin,
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  funct = "t",
  time = "h",
  move = 16,
  field = 0,
  cont.value = NULL,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  cont.lab = TRUE,
  transp = 0.5,
  add.geom = FALSE,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movebound_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_origin">origin</code></td>
<td>
<p>location(s) around which the boundary(ies) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movebound_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="movebound_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class) (see <code><a href="#topic+movecost">movecost</a></code>.</p>
</td></tr>
<tr><td><code id="movebound_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_funct">funct</code></td>
<td>
<p>cost function to be used (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function (for all the mentioned cost functions;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="movebound_+3A_time">time</code></td>
<td>
<p>time-unit expressed by the isoline(s) if Tobler's and other time-related cost functions are used; h' for hour, 'm' for minutes.</p>
</td></tr>
<tr><td><code id="movebound_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movebound_+3A_field">field</code></td>
<td>
<p>value assigned to the cells coincidinng with the barrier (0 by default) (see <code><a href="#topic+movecost">movecost</a></code>.</p>
</td></tr>
<tr><td><code id="movebound_+3A_cont.value">cont.value</code></td>
<td>
<p>cost value represented by the calculated isoline(s) (NULL by default); if no value is supplied, it is set to 1/10 of the range of values of the accumulated cost surface.</p>
</td></tr>
<tr><td><code id="movebound_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movebound_+3A_cont.lab">cont.lab</code></td>
<td>
<p>TRUE (default) or FALSE if the usuer wants or does not want labels to be attached to the isolines.</p>
</td></tr>
<tr><td><code id="movebound_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the DTM (0.5 by default).</p>
</td></tr>
<tr><td><code id="movebound_+3A_add.geom">add.geom</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the area enclosed by each isolines to be calculated (see Details).</p>
</td></tr>
<tr><td><code id="movebound_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the isoline(s) and the copy of the input 'origin' dataset (storing boundaries' geometry information)
to be exported; if TRUE, they will be exported as a shapefile; the exported file will bear a suffix corresponding to the cost function selected by the user.
The DTM is exported only if it was not provided by the user and downloaded by the function from online sources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function just requires an input DTM and a dataset ('SpatialPointsDataFrame' class) containing at least one point location.
If a DTM is not provided, <code>movebound()</code> will download elevation data from online sources (see <code><a href="#topic+movecost">movecost</a></code> for more details).
Under the hood, <code>movebound()</code> relies on the <code>movecost()</code> function and implements the same
cost functions: see the help documentation of <code>movecost()</code> for further information.<br />
</p>
<p>The following example uses in-built datasets and calculates 45-minute boundaries around three locations close to Mt Etna (Sicily, Italy), using the
Tobler's off-path hiking function (note: elevation data are acquired online for the area enclosed by the polygon fed via the
'studyplot' parameter):<br />
</p>
<p>result &lt;- movebound(origin=Etna_end_location, cont.value=45, time=&quot;m&quot;, cont.lab = TRUE, funct=&quot;tofp&quot;, studyplot = Etna_boundary, add.geom=TRUE)<br />
</p>
<p>Note that by setting the parameter <code>add.geom</code> to <code>TRUE</code>, the function calculates the area enclosed by the boundary represented by each
calculated isoline. Needless to say, the unit of measure is the one used by the input layers' coordinate system. The value(s) of the area
will be appended as a new variables to a copy of the input 'origin' dataset. The area can only be calculated if the
isolines are &quot;complete&quot; and not truncated (i.e., if they do not meet the end of the study area for instance). Therefore, before using this option,
the user may want to be sure that all the isolines are actual loops.<br />
</p>
<p>With reference to the above example, the area of the three 45-minutes boundaries can be retrieved typing what follows:<br />
</p>
<p>result$origin_w_isolines_geom$area <br />
</p>
<p>It will return:<br />
17857994 20428575 9172688<br />
</p>
<p>that are the values of the area of each 45-minute boundary in square meter.<br />
Needless to say, if we want to convert to square km we can just:<br />
result$origin_w_isolines_geom$area/1000000 <br />
</p>
<p>which gives<br />
17.857994 20.428575  9.172688 <br />
</p>
<p><code>movebound()</code> produces a plot representing the input DTM overlaid by a slopeshade raster, whose transparency can be adjusted using
the 'transp' parameter. On the rendered plot, the calculated isoline(s) is displayed and the label(s) representing the cost limit can be
activated or deactivated using the 'cont.lab' parameter. The function also returns the isoline(s) ('SpatialLinesDataFrame' class) corresponding
to the selected accumulated cost limit and the copy of the 'origin' dataset (storing information about the boundaries' geometry) (see 'Value' below).
The isoline(s) and the copy of the 'origin' dataset can be exported as shapefile by setting the <code>export</code> parameter to <code>TRUE</code>. <br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class)
</p>
</li>
<li><p> isolines: contour line(s) representing the selected cost limit ('SpatialLinesDataFrame' class)
</p>
</li>
<li><p> origin_w_isolines_geom: copy of the input origin location(s) dataset with a new variable ('area') storing the
area values of the boundary calculated around each location
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample destination locations on the above DTM
data(destin.loc)


# calculate the 5minute walking time boundary around a location
# using the Tobler's off-path hiking function

result &lt;- movebound(dtm=volc, origin=volc.loc, funct="tofp", move=8, time="m", cont.val=5)


# same as above, but around multiple locations; contours' labels are turned off

result &lt;- movebound(dtm=volc, origin=destin.loc, funct="tofp", move=8, time="m",
cont.val=2, cont.lab=FALSE)


</code></pre>

<hr>
<h2 id='movecomp'>R function for comparing least-cost paths generated using different cost functions</h2><span id='topic+movecomp'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate LCPs using different cost functions and to plot them in the same visual output to allow
comparability. See, for instance, fig. 14.2 in Parcero-Oubina C. et al, Footprints and Cartwheels on a Pixel Road: On the Applicability of GIS for
the Modelling of Ancient (Roman) Routes (2019). In Verhagen P., Joyce J., Groenhuijzen M.R. (eds), Finding the
Limits of the Limes. Modelling Demography, Economy and Transport on the Edge of the Roman Empire, Springer,  291-311.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movecomp(
  dtm = NULL,
  origin,
  destin,
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  irregular.dtm = FALSE,
  choice,
  time = "h",
  move = 16,
  field = 0,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  return.base = FALSE,
  leg.pos = "topright",
  leg.cex = 0.75,
  transp = 0.5,
  add.chart = FALSE,
  oneplot = TRUE,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movecomp_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_origin">origin</code></td>
<td>
<p>location from which least-cost path(s) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_destin">destin</code></td>
<td>
<p>location(s) to which least-cost path(s) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="movecomp_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_irregular.dtm">irregular.dtm</code></td>
<td>
<p>TRUE or FALSE (default) if the input DTM features irregular margins (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_choice">choice</code></td>
<td>
<p>character vector indicating the cost functions to be compared (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="movecomp_+3A_time">time</code></td>
<td>
<p>time-unit to be used if Tobler's and other time-related cost functions are used; h' for hour, 'm' for minutes;</p>
</td></tr>
<tr><td><code id="movecomp_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_field">field</code></td>
<td>
<p>value assigned to the cells coinciding with the barrier (0 by default) (see <code><a href="#topic+movecost">movecost</a></code>.</p>
</td></tr>
<tr><td><code id="movecomp_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_return.base">return.base</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the least-cost paths back to the origin to be calculated and plotted (as dashed lines).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_leg.pos">leg.pos</code></td>
<td>
<p>set the position of the legend in the plotted cost allocation raster; 'topright' by default (other options: &quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot;, &quot;center&quot;).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_leg.cex">leg.cex</code></td>
<td>
<p>set the size of the labels used in the legend displayed in the rendered plot (0.75 by default).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the DTM (0.5 by default).</p>
</td></tr>
<tr><td><code id="movecomp_+3A_add.chart">add.chart</code></td>
<td>
<p>TRUE or FALSE (default) is the user wants or does not want boxplots visualising LCPs length/cost vs cost function to be rendered.</p>
</td></tr>
<tr><td><code id="movecomp_+3A_oneplot">oneplot</code></td>
<td>
<p>TRUE (default) or FALSE if the user wants or does not want the plots displayed in a single window.</p>
</td></tr>
<tr><td><code id="movecomp_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the LCPs to be exported as a shapefile; the DTM is exported only if it was not provided by the user
and downloaded by the function from online sources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Like <code>movecost()</code>, the function just requires an input DTM ('RasterLayer' class), and an origin and destination dataset  ('SpatialPointsDataFrame' class).
The cost functions to be used have to be entered into 'movecomp()' via a character vector fed via the <code>choice</code> parameter (see the examples below).
If a DTM is not provided, <code>movecomp()</code> downloads elevation data from online sources for the area enclosed by the polygon fed via
the <code>studyplot</code> parameter (see <code><a href="#topic+movecost">movecost</a></code> for more details). Under the hood, <code>movecomp()</code> relies on <code>movecost()</code> and implements the same cost functions:
see the help documentation of <code>movecost()</code> for further information.<br />
</p>
<p><code>movecomp()</code> produces a plot representing the input DTM overlaid by a slopeshade raster, whose transparency can be adjusted using
the 'transp' parameter. On the rendered plot, the LPCs ('SpatialLinesDataFrame' class) generated by the different input cost functions are given a different line type; a legend
indicates which line type corresponds to which cost function. LCPs back to the origin can be calculated (and plotted) setting the
parameter <code>return.base</code> to <code>TRUE</code>.<br />
</p>
<p>The function returns the LCPs and (if requested by the user) the LCPs back to the origin. If the DTM has been acquired online, it will be returned as well.
The LCPs (and the LCPs back to the origin) will store three variables: the length of each path, the cost of each path, and an abbreviation corresponding to the cost function used to
generate the LCPs. The mentioned data can be exported by setting the <code>export</code> parameter to <code>TRUE</code>.<br />
</p>
<p>If the users want to compare the distribution of the length of the LCPs generate by different cost functions,
it suffices to set the <code>add.chart</code> parameter to <code>TRUE</code>. Two charts featuring boxplots will be rendered:
one plotting the distribution of the LCPs length by cost function; one portaying the distribution of the cost by cost function.<br />
</p>
<p>The following example uses in-built datasets to compare the LCPs generated using two cost functions: the Tobler hiking function , the
wheeled vehicle cost function, and the Pantolf. et al's cost function with correction factor.
LCPs back to the origin location will be calculated as well. The origin and destination locations are close to Mt Etna (Sicily, Italy).
Note that elevation data are acquired online for the area enclosed by the polygon fed via the <code>studyplot</code> parameter:<br />
</p>
<p>result &lt;- movecomp(origin=Etna_start_location, destin=Etna_end_location, choice=c(&quot;t&quot;, &quot;wcs&quot;, &quot;pcf&quot;), studyplot = Etna_boundary, return.base=TRUE)<br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class); returned only if acquired online
</p>
</li>
<li><p> LCPs: estimated least-cost paths ('SpatialLinesDataFrame' class); three variables are stored: 'length', 'cost', and
'funct'.
</p>
</li>
<li><p> LCPs.back: estimated least-cost paths back to the origin ('SpatialLinesDataFrame' class); three variables are stored; see above.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample destination locations on the above DTM
data(destin.loc)


# compare the LCPs generated using different walking-time cost functions (time in minutes)

result &lt;- movecomp(volc, volc.loc, destin.loc, choice=c("t", "ug", "gkrs"), time="m", move=8)

# the distribution of the length and cost of the LCPs by cost function can be easily compared
# using the 'add.chart' parameter:
#result &lt;- movecomp(volc, volc.loc, destin.loc, choice=c("t", "ug", "gkrs"), time="m",
#move=8, add.chart=T)


</code></pre>

<hr>
<h2 id='movecorr'>R function for calculating least-cost corridor between point locations</h2><span id='topic+movecorr'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate the least-cost corridor between point locations.
It just requires an input DTM and at least two point locations ('SpatialPointsDataFrame' class) representing the locations between which the corridor is calculated.
Under the hood, <code>movecorr()</code> relies on the <code><a href="#topic+movecost">movecost</a></code> function and, needless to say, implements the same
cost functions. See the help documentation of 'movecost()' for further details.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movecorr(
  dtm = NULL,
  a,
  b,
  lab.a = "A",
  lab.b = "B",
  cex.labs = 0.8,
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  irregular.dtm = FALSE,
  funct = "t",
  time = "h",
  move = 16,
  field = 0,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  rescale = FALSE,
  transp = 0.5,
  graph.out = TRUE,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movecorr_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_a">a</code></td>
<td>
<p>first location from which the least-cost corridor is calculated (SpatialPointsDataFrame class); if it contains more than two locations, see the 'Description' section above.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_b">b</code></td>
<td>
<p>second location from which the least-cost corridor is calculated (SpatialPointsDataFrame class); if parameter 'a' stores more than two locations, this parameter is disregarded; see the 'Description' section above.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_lab.a">lab.a</code></td>
<td>
<p>string to be used to label point a on the outplut plot (A is the default)</p>
</td></tr>
<tr><td><code id="movecorr_+3A_lab.b">lab.b</code></td>
<td>
<p>string to be used to label point a on the outplut plot (B is the default).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_cex.labs">cex.labs</code></td>
<td>
<p>scaling factor for the size of the points' labels (0.8 by default)</p>
</td></tr>
<tr><td><code id="movecorr_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_irregular.dtm">irregular.dtm</code></td>
<td>
<p>TRUE or FALSE (default) if the input DTM features irregular margins (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_funct">funct</code></td>
<td>
<p>cost function to be used (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="movecorr_+3A_time">time</code></td>
<td>
<p>time-unit expressed by the accumulated raster if Tobler's and other time-related cost functions are used; h' for hour, 'm' for minutes.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_field">field</code></td>
<td>
<p>value assigned to the cells coinciding with the barrier (0 by default) (see <code><a href="#topic+movecost">movecost</a></code>.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_rescale">rescale</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the output least-coast corridor raster to be rescaled between 0 and 1.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the least-cost corridor raster (0.5 by default).</p>
</td></tr>
<tr><td><code id="movecorr_+3A_graph.out">graph.out</code></td>
<td>
<p>TRUE (default) or FALSE if the user wants or does not want a graphical output to be generated.</p>
</td></tr>
<tr><td><code id="movecorr_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the output to be exported; if TRUE, the least-cost corridor, the dtm (if not provided by the user but acquired online),
and the accumulated cost surface around a and b are exported as a GeoTiff file, while the two LCPs (from a to b, and from b to a) as individual shapefiles. If multiple locations are analysed, only the
least-cost corridor (and the DTM if originally not provided) will be exported. All the exported files (excluding the DTM) will bear a suffix corresponding to the cost function selected by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If only two locations are provided (one via parameter <code>a</code>, one via parameter <code>b</code>),
the function renders a raster representing the least cost corridor (which can be optionally exported as GeoTiff) with least-cost paths superimposed.
If more than 2 locations are fed into the function via the 'a' parameter, the function calculates the least-cost corridor between pairs of locations.
All the pair-wise corridor rasters are returned (but not individually plotted) in a list.
All those rasters will be summed, and the resulting raster will be plotted (and can be, optionally, exported as GeoTiff).<br />
</p>
<p>The function returns a list containing a number of components (see 'Value' below). For more details about exporting the function's outputs,  see 'Arguments' below. <br />
</p>
<p>If the user wants to calculate the least-cost corridor between two locations only, (s)he may want to use parameter <code>a</code> and <code>b</code> to indicate
the two locations of interest respectively. For example, using the datasets provided by this package: <br />
</p>
<p>result &lt;- movecorr(a=Etna_start_location, b=Etna_end_location[1,], studyplot=Etna_boundary, funct=&quot;tofp&quot;) <br />
</p>
<p>The above will produce the least-cost corridor between two locations close to Mt Etna (Sicily, Italy), using the
Tobler's cost function (for off-path hiking). Side note: the elevation data will be acquired online. <br />
</p>
<p>If the interest lies in using more than 2 locations, the user may want to feed the dataset storing all the locations
into parameter <code>a</code> (disregarding <code>b</code>). As explained above, in this case the function calculates the least-cost corridor between pairs of locations.
All the pair-wise corridor rasters are returned in a list. Those rasters will be summed, and the resulting raster will be plotted (and can be, optionally, exported as GeoTiff).
For example, to calculate the least-cost corridors between every individual unique pair of the 9 locations stored in the <code>destin.loc</code> dataset:<br />
</p>
<p>volc &lt;- raster::raster(system.file(&quot;external/maungawhau.grd&quot;, package=&quot;gdistance&quot;)) <br />
</p>
<p>result &lt;- movecorr(dtm=volc, a=destin.loc, funct=&quot;ree&quot;, rescale=TRUE) <br />
</p>
<p>Note that only parameter <code>a</code> has been used. The function returns and plots the sum of the 36 individual corridors; the latter are not plotted,
but are stored in a list. If the user wants to plot the least-cost corridor, say, n 4, and then add the two locations
between which the corridor has been calculated, (s)he can first plot the corridor raster n 4: <br />
</p>
<p>raster::plot(result$corridors[[4]]) <br />
</p>
<p>Then, identifying which locations are related to corridor n 4 can be easily accomplished by looking up the values stored in
the 4th column of the returned matrix: <br />
</p>
<p>result$locations.matrix <br />
</p>
<p>The locations are the n 1 and n 5, so the user can add them to the plot previosly produced using: <br />
</p>
<p>raster::plot(destin.loc[1,], pch=20, add=T)<br />
raster::plot(destin.loc[5,], pch=20, add=T)<br />
</p>
<p>Note that the resulting plot can be produced (with a nicer outlook) directly by 'movecorr()' by feeding those two locations in the
parameter 'a' and 'b' respectively: <br />
</p>
<p>result &lt;- movecorr(dtm=volc, a=destin.loc[1,], b=destin.loc[5,], funct=&quot;ree&quot;) <br />
</p>
<p>Overall, what <code>movecorr()</code> does is to calculate (via the <code><a href="#topic+movecost">movecost</a></code> function) the accumulated cost surface around each location.
Those are eventually summed to produce the least-cost corridor between locations. On the produced corridor raster, the cost of a cell is the total cost to reach it
from all the analysed locations. About least-cost corridors between pairs of locations, see for instance: <br />
Mitchell A. (2012), &quot;The ESRI Guide to GIS Analysis. Vol 3. Modelling Suitability, Movement, and Interaction&quot;, New York: Esri Press (257-259). <br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class)
</p>
</li>
<li><p> lc.corridor: raster of the least-cost corridor ('RasterLayer' class); if more than two locations are analysed, this raster is the sum of all the corridors between all the pairs of locations
</p>
</li>
<li><p> lcp_a_to_b: least-cost past from a to b ('SpatialLinesDataFrame' class); returned only when the corridor is calculated between two locations
</p>
</li>
<li><p> lcp_b_to_a: least-cost past from b to a ('SpatialLinesDataFrame' class); returned only when the corridor is calculated between two locations
</p>
</li>
<li><p> accum_cost_surf_a: accumulated cost-surface around a ('RasterLayer' class); returned only when the corridor is calculated between two locations
</p>
</li>
<li><p> accum_cost_surf_b: accumulated cost-surface around b ('RasterLayer' class); returned only when the corridor is calculated between two locations
</p>
</li>
<li><p> corridors: list of rasters ('RasterLayer' class) representing the least-cost corridor between all the unique pairs of locations; returned only when more than two locations are analysed
</p>
</li>
<li><p> locations.matrix: matrix whose columns indicate the identifiers for all the unique pairs of locations for which each corridor is calculated; returned only when more than two locations are analysed
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample destination locations on the above DTM
data(destin.loc)


# calculate the least-cost corridor between two locations, using the
# relative energetic expenditure cost function, and store the results
# in the 'result' object

result &lt;- movecorr(dtm=volc, a=destin.loc[1,], b=destin.loc[3,], funct="ree", move=8)


#same as above, but using the 'cognitive slope'

# result &lt;- movecorr(dtm=volc, a=destin.loc[1,], b=destin.loc[3,],
# funct="ree", move=8, cogn.slp=TRUE)


</code></pre>

<hr>
<h2 id='movecost'>R function for calculating accumulated anisotropic slope-dependant cost of movement across the terrain and least-cost paths from a point origin</h2><span id='topic+movecost'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate the anisotropic accumulated cost of movement around a starting location and to optionally calculate least-cost path(s) toward
one or multiple destinations. It implements different cost estimations related to human movement across the landscape.
The function takes as input a Digital Terrain Model ('RasterLayer' class) and a point feature ('SpatialPointsDataFrame' class), the latter representing
the starting location, i.e. the location from which the accumulated cost is calculated. Besides citing this package,
you may want to refer to the following journal article, where an earlier version of the
package is described: <strong>Alberti (2019) &lt;doi:10.1016/j.softx.2019.100331&gt;</strong>.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movecost(
  dtm = NULL,
  origin,
  destin = NULL,
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  irregular.dtm = FALSE,
  funct = "t",
  time = "h",
  outp = "r",
  move = 16,
  field = 0,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  return.base = FALSE,
  rb.lty = 2,
  breaks = NULL,
  cont.lab = TRUE,
  destin.lab = TRUE,
  cex.breaks = 0.6,
  cex.lcp.lab = 0.6,
  graph.out = TRUE,
  transp = 0.5,
  oneplot = TRUE,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movecost_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_origin">origin</code></td>
<td>
<p>location from which the cost surface is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movecost_+3A_destin">destin</code></td>
<td>
<p>location(s) to which least-cost path(s) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movecost_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see Details); NULL is default.</p>
</td></tr>
<tr><td><code id="movecost_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class).</p>
</td></tr>
<tr><td><code id="movecost_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (in blue).</p>
</td></tr>
<tr><td><code id="movecost_+3A_irregular.dtm">irregular.dtm</code></td>
<td>
<p>TRUE or FALSE (default) if the input DTM features irregular margins (Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_funct">funct</code></td>
<td>
<p>cost function to be used:<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see Details).<br /></p>
</td></tr>
<tr><td><code id="movecost_+3A_time">time</code></td>
<td>
<p>time-unit expressed by the accumulated raster and by the isolines if Tobler's and other time-related cost functions are used; 'h' for hour, 'm' for minutes.</p>
</td></tr>
<tr><td><code id="movecost_+3A_outp">outp</code></td>
<td>
<p>type of output: 'raster' or 'contours' (see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movecost_+3A_field">field</code></td>
<td>
<p>value assigned to the cells coinciding with the barrier (0 by default).</p>
</td></tr>
<tr><td><code id="movecost_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function; see Details).</p>
</td></tr>
<tr><td><code id="movecost_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (0 to 15; 9 by default) (see Details and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movecost_+3A_return.base">return.base</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the least-cost paths back to the origin to be calculated and plotted (as dashed lines).</p>
</td></tr>
<tr><td><code id="movecost_+3A_rb.lty">rb.lty</code></td>
<td>
<p>line type used to represent the least-cost paths back to the origin in the returned plot (2 by default; dashed line; see 'lty' parameter in <code><a href="graphics.html#topic+par">par</a></code>).</p>
</td></tr>
<tr><td><code id="movecost_+3A_breaks">breaks</code></td>
<td>
<p>contour interval; if no value is supplied, the interval is set by default to 1/10 of the range of values of the accumulated cost surface.</p>
</td></tr>
<tr><td><code id="movecost_+3A_cont.lab">cont.lab</code></td>
<td>
<p>if set to TRUE (default) display the labels of the contours over the accumulated cost surface.</p>
</td></tr>
<tr><td><code id="movecost_+3A_destin.lab">destin.lab</code></td>
<td>
<p>if set to TRUE (default) display the label(s) indicating the cost at the destination location(s).</p>
</td></tr>
<tr><td><code id="movecost_+3A_cex.breaks">cex.breaks</code></td>
<td>
<p>set the size of the cost labels used in the contour plot (0.6 by default).</p>
</td></tr>
<tr><td><code id="movecost_+3A_cex.lcp.lab">cex.lcp.lab</code></td>
<td>
<p>set the size of the labels used in least-cost path(s) plot (0.6 by default).</p>
</td></tr>
<tr><td><code id="movecost_+3A_graph.out">graph.out</code></td>
<td>
<p>TRUE (default) or FALSE if the user wants or does not want a graphical output to be generated.</p>
</td></tr>
<tr><td><code id="movecost_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the rendered plots (0.5 by default).</p>
</td></tr>
<tr><td><code id="movecost_+3A_oneplot">oneplot</code></td>
<td>
<p>TRUE (default) or FALSE if the user wants or does not want the plots displayed in a single window.</p>
</td></tr>
<tr><td><code id="movecost_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the outputs to be exported; if TRUE, the DTM, the cost-surface, and the accumulated cost surface are
exported as a GeoTiff file, while the isolines, the least-cost path(s), and a copy of the input destination locations (storing the cost measured at each location)
are exported as shapefile; all the exported files (excluding the DTM) will bear a suffix corresponding to the cost function selected by the user.
Note that the DTM is exported only if it was not provided by the user and downloaded by the function from online sources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the parameter <code>destin</code> is fed with a dataset representing destination location(s) ('SpatialPointsDataFrame' class), the function also calculates
least-cost path(s) plotted on the input DTM; the length of each path is saved under the variable 'length' stored in the 'LCPs' dataset ('SpatialLines' class) returned by the function.
In the produced plot, the red dot(s) representing the destination location(s) are labelled with numeric values representing
the cost value at the location(s). <br />
</p>
<p>The cost value is also appended to the updated destination locations dataset returned by the function, which
stores a new variable labelled <code>cost</code>. If the cost is expressed in terms of walking time, the labels accompaining each destinaton location will
express time in sexagesimal numbers (hours, minutes, seconds). In this case, the variable 'cost' appended to the returned destination location datset
will store the time figures in decimal numbers, while another variable named <code>cost_hms</code> will store the corresponding value in sexagesimal numbers.
When interpreting the time values stored in the <code>cost</code> variable, the user may want to bear in mind the selected time unit (see right below).<br />
</p>
<p>When using cost functions expressing cost in terms of time, the time unit can be selected by the user setting the <code>time</code> parameter to <code>h</code> (hours) or to <code>m</code> (minutes).<br />
</p>
<p>In general, the user can also select which type of visualization the function has to produce; this is achieved setting the <code>outp</code> parameter to either <code>r</code> (=raster)
or to <code>c</code> (=contours). The former will produce a raster with a colour scale and contour lines representing the accumulated cost surface; the latter parameter will only
produce contour lines.<br />
</p>
<p>The contour lines' interval is set using the <code>breaks</code> parameter; if no value is passed to the parameter, the interval will be set by default to
1/10 of the range of values of the accumulated cost surface.<br />
</p>
<p>It is worth reminding the user(s) that all the input layers (i.e., DTM, start location, and destination locations) must use the same projected coordinate system.<br />
</p>
<p><strong>Cost surface calculation</strong>:<br />
for the cost-surface and LCPs calculation, <code>movecost()</code> builds on functions from Jacob van Etten's
<a href="https://cran.r-project.org/package=gdistance">gdistance</a> package.
Under the hood, <code>movecost()</code> calculates the slope as rise over run, following the procedure described
by van Etten, &quot;R Package gdistance: Distances and Routes on Geographical Grids&quot; in Journal of Statistical Software 76(13), 2017, pp. 14-15.
The number of directions in which cells are connected in the cost calculation can be set to 4 (rook's case), 8 (queen's case), or
16 (knight and one-cell queen moves) using the <code>move</code> parameter (see 'Arguments').<br />
</p>
<p><strong>Inhibition of movement (barrier)</strong>:<br />
areas where the movement is inhibited can be fed into the analysis via the <code>barrier</code> parameter; SpatialLineDataFrame or SpatialPolygonDataFrame can be used.
The barrier is assigned a conductance value of 0 (i.e., movement is inhibited) by default, but the user can assign any other value via the
<code>field</code> parameter. Internally, the barrier creation rests on the internal <code>create_barrier_cs</code> function, which relies on the same function
out of an earlier version of the <em>leastcostpath</em> package.<br />
</p>
<p>To test this facility, consider the following example:<br />
</p>
<p>First, we use in-built data to come up with a linear feature (i.e., a LCP) that we will later use as barrier:<br />
</p>
<p>result1 &lt;- movecost(volc, destin.loc[1,], destin.loc[4,])<br />
</p>
<p>After, we calculate the LCP between two other locations, first not using any barrier (result2), then using the mentioned LCP (from result1)
as a barrier (result3):<br />
</p>
<p>result2 &lt;- movecost(volc, destin.loc[3,], destin.loc[6,], move=8)<br />
result3 &lt;- movecost(volc, destin.loc[3,], destin.loc[6,], barrier=result1$LCPs, plot.barrier=TRUE, move=8)<br />
</p>
<p>As apparent by comparing result2 to result3, when the barrier is used (result3), the LCP does not cross the barrier but is &quot;forced&quot;
to make a long detour. In result3, the barrier is plotted as a blue line. <strong>Note</strong> that the <code>move</code> parameter has been set to 8; if set to 16, the LCP will be &quot;able&quot; to jump the barrier.<br />
</p>
<p><strong>DTM featuring irregular margins</strong>:<br />
if the input DTM features irregular margins, e.g a coastline with gulfs and/or inlets where cells corresponding to the sea are given NoData,
the user is to set the <code>irregular.dtm</code> parameter to TRUE; this will prevent the LCPs to cross the sea. Internally, what <code>movecost()</code> does is
to generate a polygon vector layer from the DTM and to use the polygon as a mask to create a Transitional Layer via the
internal <code>create_barrier_cs</code> function, which relies on the same function out of an earlier version from the <em>leastcostpath</em> package.
In the mask Transitional Layer those parts corresponding to the terrain are given a conductance value equal to 1, while everything else (i.e., the parts corresponding to the sea)
are given 0 conductance. The mask Transitional Layer is then internally multiplied by the conductance transitional layer representing the cost of movement
(according to the user-selected function). This will set to 0 the conductance values of those parts of the study area that do not correspond to the terrain,
while keeping unaltered the conductance of those parts that do coincide with the terrain.<br />
</p>
<p>As a case in point, let's consider the two following examples (using some in-build datasets):<br />
</p>
<p>resultA &lt;- movecost(malta_dtm_40, origin=springs[5,], destin=springs[15,], irregular.dtm=FALSE, oneplot=FALSE)<br />
</p>
<p>resultB &lt;- movecost(malta_dtm_40, origin=springs[5,], destin=springs[15,], irregular.dtm=TRUE, oneplot=FALSE)<br />
</p>
<p>As you can see, in the first case, the LCP between the two locations cross the sea, while in the second case the LCP follows
the coastline. One can also appreciate the difference between the two returned conductance transitional layers:<br />
</p>
<p>raster::plot(raster::raster(resultA$conductance))<br />
</p>
<p>raster::plot(raster::raster(resultB$conductance))<br />
</p>
<p>It is apparent that in the second layer the sea area has been given 0 conductance, while keeping the rest unchanged. If the input DTM does not feature
irregular margins (like, for instance, the built-in <code>volc</code> DTM), the user may safely leave the <code>irregular.dtm</code> parameter set to FALSE
(which is the default value).<br />
</p>
<p><strong>Acquiring online elevation data</strong>:<br />
if a DTM is not provided,<code>movecost()</code>' will download elevation data from online sources.
Elevation data will be acquired for the area enclosed  by the  polygon supplied by the <code>studyplot</code> parameter (SpatialPolygonDataFrame class).
To tap online elevation data, <code>movecost()</code>' internally builds on the
<code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code> function from the <em>elevatr</em> package.<br />
</p>
<p>The zoom level of the downloaded DTM (i.e., its resolution) is controlled by the parameter <code>z</code>, which is
set to 9 by default (a trade off between resolution and download time).<br />
</p>
<p>To test this facility, the user may want to try the following code, that will generate a least-cost surface and least-cost paths
in an area close the Mount Etna (Sicily, Italy), whose elevation data are acquired online; the start and end locations, and the
polygon defining the study area, are provided in this same package:<br />
</p>
<p>result &lt;- movecost(origin=Etna_start_location, destin=Etna_end_location, studyplot=Etna_boundary) <br />
</p>
<p>The LCPs back to the origin can be calculated and plotted setting the parameter 'return.base' to TRUE:<br />
</p>
<p>result &lt;- movecost(origin=Etna_start_location, destin=Etna_end_location, studyplot=Etna_boundary, return.base=TRUE) <br />
</p>
<p>To know more about what elevation data are tapped from online
sources, visit: https://cran.r-project.org/web/packages/elevatr/vignettes/introduction_to_elevatr.html. <br />
</p>
<p>For more information about the elevation data resolution per zoom level, visit
https://github.com/tilezen/joerd/blob/master/docs/data-sources.md#what-is-the-ground-resolution.<br />
</p>
<p>To know what is sourced at what zoom level, visit
https://github.com/tilezen/joerd/blob/master/docs/data-sources.md#what-is-sourced-at-what-zooms. <br />
</p>
<p><strong>Terrain slope and cognitive slope</strong>:<br />
when it comes to the terrain slope, the function provides the facility to use the so-called 'cognitive slope',
following Pingel TJ (2013), Modeling Slope as a Contributor to Route Selection in Mountainous Areas, in Cartography and Geographic Information Science, 37(2), 137-148.
According to Pingel, &quot;Humans tend to overestimate geographic slopes by a surprisingly high margin...This analysis indicates downhill slopes are overestimated
at approximately 2.3 times the vertical, while uphill slopes are overestimated at 2 times the vertical.&quot;. As a result,
if the parameter <code>cogn.slp</code> is set to <code>TRUE</code>, positive slope values are preliminarily multiplied by 1.99, while negative slope values are multiplied by 2.31.
</p>
<p><strong>Terrain factor (N)</strong>:<br />
virtually all the implemented cost functions (with few exceptions) can take into account a 'terrain factor' (<code>N</code> parameter; 1 by default), which
represents the easiness/difficulty of moving on different terrain types. According to the type of terrain, the energy spent when walking
increases. The same holds true for time, which increases because on a loose terrain (for instance) the walking speed decreases.
While a terrain factor is 'natively' part of the Van Leusen's, Pandolf et al.'s, and Bellavia's cost function,
it has been integrated into the other cost functions as well (when/if relevant).<br />
</p>
<p>Note that the terrain factor has NOT been implemented in the Alberti's, Tobler's off-path, and Irmischer-Clarke's off-path cost function.
As for the latter two, they already natively feature a terrain factor. Therefore, it has been implemented only in their on-path version.
Needless to say, if we use a terrain factor of 1.67 with the Tobler's (on-path) hiking function, the results
will be equal to those obtained using the Tobler's off-path function (the reciprocal of 1.67, i.e. 0.60, is in fact
natively used by the Tobler's function for off-path hiking). In fact, compare the results of the following two runs
of  <code>movecost()</code> (using in-built datasets):<br />
</p>
<p>result1 &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc, breaks=0.05, funct=&quot;t&quot;, N=1.67)<br />
result2 &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc, breaks=0.05, funct=&quot;tofp&quot;)<br />
</p>
<p>The user may want to refer to the following <strong>list of terrain factors</strong>, which is based on the data collected in Herzog, I. (2020).
Spatial Analysis Based on Cost Functions. In Gillings M, Haciguzeller P, Lock G (eds), &quot;Archaeological Spatial Analysis. A Methodological Guide.&quot;,
Routledge: New York, 340 (with previous references). The list is divided into two sections (a and b), the first reporting the terrain
factors to be used for cost functions measuring time, the second for functions measuring cost other than time:<br />
</p>
<p>(a)<br />
</p>

<ul>
<li><p> Blacktop roads, improved dirt paths, cement = 1.00
</p>
</li>
<li><p> Lawn grass = 1.03
</p>
</li>
<li><p> Loose beach sand = 1.19
</p>
</li>
<li><p> Disturbed ground (former stone quarry) = 1.24
</p>
</li>
<li><p> Horse riding path, flat trails and meadows = 1.25
</p>
</li>
<li><p> Tall grassland (with thistle and nettles) = 1.35
</p>
</li>
<li><p> Open space above the treeline (i.e., 2000 m asl) = 1.50
</p>
</li>
<li><p> Bad trails, stony outcrops and river beds = 1.67
</p>
</li>
<li><p> Off-paths = 1.67
</p>
</li>
<li><p> Bog = 1.79
</p>
</li>
<li><p> Off-path areas below the treeline (pastures, forests, heathland) = 2.00
</p>
</li>
<li><p> Rock = 2.50
</p>
</li>
<li><p> Swamp, water course = 5.00
</p>
</li></ul>

<p>(b)<br />
</p>

<ul>
<li><p> Asphalt/blacktop = 1.00
</p>
</li>
<li><p> Dirt road or grass = 1.10
</p>
</li>
<li><p> Hard-surface road = 1.20
</p>
</li>
<li><p> Light brush = 1.20
</p>
</li>
<li><p> Ploughed field = 1.30 or 1.50
</p>
</li>
<li><p> Heavy brush = 1.50
</p>
</li>
<li><p> Hard-packed snow = 1.60
</p>
</li>
<li><p> Swampy bog = 1.80
</p>
</li>
<li><p> Sand dunes = 1.80
</p>
</li>
<li><p> Loose sand = 2.10
</p>
</li></ul>

<p><strong>Implemented cost functions</strong>:<br />
note that in what follows <strong>x[adj]</strong> stands for slope as rise/run calculated for adjacent cells:<br />
</p>
<p><strong>Tobler's hiking function (on-path) (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> (6 * exp(-3.5 * abs(x[adj] + 0.05))) * (1/N) </code><br />
</p>
<p><strong>Tobler's hiking function (off-path) (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn">(6 * exp(-3.5 * abs(x[adj] + 0.05))) * 0.6</code><br />
</p>
<p>as per Tobler's indication, the off-path walking speed is reduced by 0.6.<br />
</p>
<p><strong>Marquez-Perez et al.'s modified Tobler hiking function (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> (4.8 * exp(-5.3 * abs((x[adj] * 0.7) + 0.03))) * (1/N) </code><br />
</p>
<p>modified version of the Tobler's hiking function as proposed by Joaquin Marquez-Parez, Ismael Vallejo-Villalta &amp; Jose I. Alvarez-Francoso (2017), &quot;Estimated travel time for walking trails in natural areas&quot;,
Geografisk Tidsskrift-Danish Journal of Geography, 117:1, 53-62, DOI: 10.1080/00167223.2017.1316212.<br />
</p>
<p><strong>Irmischer-Clarke's modified Tobler hiking function (male, on-path; speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> ((0.11 + exp(-(abs(x[adj])*100 + 5)^2 / (2 * 30^2))) * 3.6) * (1/N) </code><br />
</p>
<p>modified version of the Tobler's function as proposed for (male) on-path hiking by Irmischer, I. J., &amp; Clarke, K. C. (2018). Measuring and modeling the speed of human navigation.
Cartography and Geographic Information Science, 45(2), 177-186. https://doi.org/10.1080/15230406.2017.1292150.
It is interesting to note that the hiking speed predicted by this and by the other functions proposed by the authors is slower than the one
modelled by Tobler's hiking function. This is attributed to the cognition involved in wayfinding
, such as map reading, analyzing the terrain, decision making, determining routes, etc.
<strong>Note</strong>: all the all the Irmischer-Clarke's functions originally express speed in m/s; they have been reshaped (multiplied by 3.6) to turn m/s into km/h for consistency
with the other Tobler-related cost functions; slope is in percent.<br />
</p>
<p><strong>Irmischer-Clarke's modified Tobler hiking function (male, off-path; speed in kmh)</strong>:<br />
</p>
<p><code class="reqn">(0.11 + 0.67 * exp(-(abs(x[adj])*100 + 2)^2 / (2 * 30)^2)) * 3.6</code><br />
</p>
<p><strong>Irmischer-Clarke's modified Tobler hiking function (female, on-path; speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> ((0.95 * (0.11 + exp(-(abs(x[adj]) * 100 + 5)^2/(2 * 30^2)))) * 3.6) * (1/N) </code><br />
</p>
<p><strong>Irmischer-Clarke's modified Tobler hiking function (female, off-path; speed in kmh)</strong>:<br />
</p>
<p><code class="reqn">(0.95 * (0.11 + 0.67 * exp(-(abs(x[adj]) * 100 + 2)^2/(2 * 30^2)))) * 3.6</code><br />
</p>
<p><strong>Uriarte Gonzalez's walking-time cost function</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((0.0277 * (abs(x[adj])*100) + 0.6115) * N) </code><br />
</p>
<p>proposed by Uriarte Gonzalez;
<strong>see</strong>: Chapa Brunet, T., Garcia, J., Mayoral Herrera, V., &amp; Uriarte Gonzalez, A. (2008). GIS landscape models for the study of preindustrial settlement patterns in Mediterranean areas.
In Geoinformation Technologies for Geo-Cultural Landscapes (pp. 255-273). CRC Press. https://doi.org/10.1201/9780203881613.ch12.<br />
The cost function originally expresses walking time in seconds; for the purpose of its implementation in this function, it is the reciprocal of time (1/T) that is used in order to eventually get
T/1. Unlike in the original cost function, here the pixel resolution is not taken into account since 'gdistance' takes care of the cells' dimension
when calculating accumulated costs.<br />
</p>
<p><strong>Marin Arroyo's walking-time cost function</strong>:<br />
</p>
<p><code class="reqn"> ifelse((abs(x[adj])*100) &lt; 0, 1 / ((0.6 * ((abs(x[adj])*100)/23+1))*N), 1 / ((0.6 * ((abs(x[adj])*100)/11+1))*N)) </code><br />
</p>
<p>used by Marin Arroyo A.B. (2009), The use of optimal foraging theory to estimate Late Glacial site catchments areas from a central place:
the case of eastern Cantabria, Span, in Journal of Anthropological Archaeology 28, 27-36.
The cost function originally expresses walking time in seconds; here it is the reciprocal of time (1/T) that is used in order to eventually get
T/1. Slope is in percent. Note: unlike in the original equation, here d (distance travelled in meter) is not taken into account since 'gdistance'
takes care of the cells' dimension when calculating accumulated costs.<br />
</p>
<p><strong>Alberti's Tobler hiking function modified for pastoral foraging excursions (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn">(6 * exp(-3.5 * abs(x[adj] + 0.05))) * 0.25</code><br />
</p>
<p>proposed by Gianmarco Alberti;
<strong>see</strong>: <a href="https://www.um.edu.mt/library/oar/bitstream/123456789/64172/1/Chapter_9_Locating_potential_pastoral_foraging_routes.pdf">Locating potential pastoral foraging routes in Malta through the use of a Geographic Information System</a>.
The Tobler's function has been rescaled to fit animal walking speed during foraging excursions. The distribution of the latter, as empirical data show, turns out to be right-skewed
and to vary along a continuum. It ranges from very low speed values (corresponding to slow grazing activities grazing while walking) to comparatively higher values
(up to about 4.0 km/h) corresponding to travels without grazing (directional travel toward feeding stations).
The function consider 1.5 km/h as the average flock speed, which roughly corresponds to the average speed recorded in some studies, and
can be considered the typical speed of flocks during excursions in which grazing takes place while walking  (typical form of grazing in most situations).
Tobler's hiking function has been rescaled by a factor of 0.25 to represent the walking pace of a flock instead of humans.
The factor corresponds to the ratio between the flock average speed (1.5 km/h) and the maximum human walking speed (about 6.0 km/h) on a favourable slope.<br />
</p>
<p><strong>Garmy, Kaddouri, Rozenblat, and Schneider's hiking function (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> (4 * exp(-0.008 * ((atan(abs(x[adj]))*180/pi)^2))) * (1/N) </code><br />
</p>
<p>slope in degrees;
<strong>see</strong>: Herzog, I. (2020). Spatial Analysis Based on Cost Functions. In Gillings M, Haciguzeller P, Lock G (eds), &quot;Archaeological Spatial Analysis. A Methodological Guide.&quot;,
Routledge: New York, 333-358 (with previous references).<br />
</p>
<p><strong>Rees' hiking function (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> ((1 / (0.75 + 0.09 * abs(x[adj]) + 14.6 * (abs(x[adj]))^2)) * 3.6) * (1/N) </code><br />
</p>
<p>Rees' slope-dependant cost function; it is originally expressed in terms of time (1/v in Rees' publication);
here it is the reciprocal of time (i.e. speed) that is used in order to eventually get the reciprocal of speed (i.e. time).
Slope is dealt with here as originally expressed in Rees' publication (i.e. rise over run). The speed, which is originally expressed in m/s,
has been here transposed to kmh (i.e., multiplied by 3.6) for consistency with other hiking functions.<br />
For this cost function <strong>see</strong>: Rees, WG (2004). Least-cost paths in mountainous terrain.
Computers &amp; Geosciences, 30(3), 203-209. See also: Campbell MJ, Dennison PE, Butler BW, Page WG (2019). Using crowdsourced
fitness tracker data to model the relationship between slope and travel rates. Applied Geography 106, 93-107 (with previous references).<br />
</p>
<p><strong>Kondo-Seino's modified Tobler hiking function (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> ifelse(abs(x[adj]) &gt;= -0.07, (5.1 * exp(-2.25 * abs(x[adj] + 0.07))) * (1/N), (5.1 * exp(-1.5 * abs(x[adj] + 0.07)))) * (1/N) </code><br />
</p>
<p>Kondo-Seino's modified Tobler hiking function; it expresses walking speed in Kmh; slope as rise/run;
<strong>see</strong> Kondo Y., Seino Y. (2010). GPS-aided Walking Experiments and Data-driven Travel Cost Modelingon the Historical Road of Nakasendo-Kisoji
(Central Highland Japan), in: Frischer B., Webb Crawford J., Koller D. (eds.), Making History Interactive.
Computer Applications and Quantitative Methods in Archaeology (CAA). Proceedings of the 37th International Conference, Williamsburg, Virginia, United States of America,
March 22-26 (BAR International Series S2079). Archaeopress, Oxford, 158-165.<br />
</p>
<p><strong>Tripcevich hiking function (speed in kmh)</strong>:<br />
</p>
<p><code class="reqn"> ((4.028*46^2)/(((atan(abs(x[adj]))*180/pi)+4.127)^2+46^2))*(1/N) </code><br />
</p>
<p>Tripcevich's hiking function; it expresses walking speed in Kmh; slope is originally expressed in degrees;
<strong>see</strong> Tripcevich N (2008). Estimating Llama caravan travel speeds: ethno-archaeological fieldwork with a Peruvian salt caravan.
Trabajo presentado el la inauguracionn del Centre for Spatial Studies, University of California, Santa Barbara.
See also: Lucero G, Marsh EJ, Castro S (2014), Rutas prehistoricas en lo NO de San Juan: una propuesta macroregional desde los sistemas
de information geografica, in Cortegoso V, Duran V, Gasco Alejandra (eds), Arqueologia de ambientes de altura de Mendoza y San
Juan (Argentina), EDIUNC, pp. 275-305.<br />
</p>
<p><strong>Wheeled-vehicle critical slope cost function</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((1 + ((abs(x[adj])*100) / sl.crit)^2) * N) </code><br />
</p>
<p>where <code class="reqn">sl.crit</code> (=critical slope, in percent) is &quot;the transition where switchbacks become more effective than direct uphill or downhill paths&quot; and typically is in the range 8-16;
<strong>see</strong> Herzog, I. (2016). Potential and Limits of Optimal Path Analysis. In A. Bevan &amp; M. Lake (Eds.), Computational Approaches to Archaeological Spaces (pp. 179-211). New York: Routledge. <br />
</p>
<p><strong>Relative energetic expenditure cost function</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((tan((atan(abs(x[adj]))*180/pi)*pi/180) / tan (1*pi/180)) * N) </code><br />
</p>
<p>slope-based cost function expressing change in potential energy expenditure;
<strong>see</strong> Conolly, J., &amp; Lake, M. (2006). Geographic Information Systems in Archaeology. Cambridge: Cambridge University Press, p. 220;
<strong>see also</strong> Newhard, J. M. L., Levine, N. S., &amp; Phebus, A. D. (2014). The development of integrated terrestrial and marine pathways in the Argo-Saronic region, Greece. Cartography and Geographic Information Science, 41(4), 379-390, with references to studies that use this
function; <strong>see also</strong> ten Bruggencate, R. E., Stup, J. P., Milne, S. B., Stenton, D. R., Park, R. W., &amp; Fayek, M. (2016). A human-centered GIS approach to modeling mobility on southern Baffin Island, Nunavut,
Canada. Journal of Field Archaeology, 41(6), 684-698. https://doi.org/10.1080/00934690.2016.1234897.<br />
</p>
<p><strong>Bellavia's cost function</strong>:<br />
</p>
<p><code class="reqn">1 / (N * ((atan(abs(x[adj]))*180/pi)+1))</code><br />
</p>
<p>proposed by G. Bellavia, it measures abstract cost. Slope in degrees; N is a terrain factor (see above).
<strong>See</strong>: Herzog I. (2020). Spatial Analysis Based on Cost Functions. In Gillings M, Haciguzeller P, Lock G (eds), &quot;Archaeological Spatial Analysis. A Methodological Guide.&quot;,
Routledge: New York, 333-358 (with previous references).<br />
</p>
<p><strong>Eastman's cost function</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((0.031*(atan(abs(x[adj]))*180/pi)^2-0.025*(atan(abs(x[adj]))*180/pi)+1)*N) </code><br />
</p>
<p>proposed by J.R. Eastman, it measures abstract cost; slope in degrees.
<strong>See</strong>: Vaissie E., Mobility of Paleolithic Populations: Biomechanical Considerations and Spatiotemporal Modelling,
in PaleoAnthropology 2021 (1): 120-144 (with previous reference to Eastman 1999).<br />
</p>
<p><strong>Pandolf et al.'s metabolic energy expenditure cost function (in Watts)</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((1.5 * W + 2.0 * (W + L) * (L / W)^2 + N * (W + L) * (1.5 * (V^2) + 0.35 * V * (abs(x[adj])*100)))*N) </code><br />
</p>
<p>where <code class="reqn">W</code> is the walker's body weight (Kg), <code class="reqn">L</code> is the carried load (in Kg), <code class="reqn">V</code> is the velocity in m/s, <code class="reqn">N</code> is a coefficient representing ease of movement on the terrain (see above).
<strong>Note</strong> that if <code class="reqn">V</code> is set to 0 by the user, it is internally worked out on the basis of the Tobler function for on-path hiking; therefore, <code class="reqn">V</code> will not be
considered constant throughout the analysed area, but will vary as function of the slope.
</p>
<p>For this cost function, <strong>see</strong> Pandolf, K. B., Givoni, B., &amp; Goldman, R. F. (1977). Predicting energy expenditure with loads while standing or walking very slowly. Journal of Applied Physiology,
43(4), 577-581. https://doi.org/10.1152/jappl.1977.43.4.577.<br />
</p>
<p>For the use of this cost function in a case study, <strong>see</strong> Rademaker, K., Reid, D. A., &amp; Bromley, G. R. M. (2012). Connecting the Dots: Least Cost Analysis, Paleogeography, and
the Search for Paleoindian Sites in Southern Highland Peru. In White D.A. &amp; Surface-Evans S.L. (Eds.), Least Cost Analysis of Social Landscapes. Archaeological Case Studies (pp. 32-45).
University of Utah Press; <strong>see also</strong> Herzog, I. (2013). Least-cost Paths - Some Methodological Issues, Internet Archaeology 36 (http://intarch.ac.uk/journal/issue36/index.html) with references.
For the idea of using an hiking function inside an energetic cost function, <strong>see</strong> for instance White D.A., Prehistoric Trail Networks of the Western Papaguarie.
A Multifaceted Least Cost Graph Theory Analysis. In White D.A. &amp; Surface-Evans S.L. (Eds.), Least Cost Analysis of Social Landscapes. Archaeological Case Studies (pp. 188-206).
University of Utah Press.<br />
</p>
<p><strong>Note</strong>: in the returned charts, the cost is transposed from Watts to Megawatts (see, e.g., Rademaker et al 2012 cited above).<br />
</p>
<p><strong>Pandolf et al.'s metabolic energy expenditure cost function with correction factor for downhill movements (in Watts)</strong>:<br />
</p>
<p><code class="reqn"> ifelse(abs(x[adj])*100 &gt; 0 , 1 / (1.5 * W + 2.0 * (W+L) * (L/W)^2 + N * (W+L) * (1.5 * V^2 + 0.35 * V * (abs(x[adj])*100))),
1 / ((1.5 * W + 2.0 * (W+L) * (L/W)^2 + N * (W+L) * (1.5 * V^2 + 0.35 * V * (abs(x[adj])*100))) - (N * ((abs(x[adj])*100) * (W+L) * V/3.5) - ((W+L) * ((abs(x[adj])*100)+6)^2/W) + (25-V^2)))) </code><br />
</p>
<p>for the parameters <code class="reqn">W</code>, <code class="reqn">L</code>, <code class="reqn">V</code>, and <code class="reqn">N</code>, see above. If <code class="reqn">V</code> is set to 0 by the user, it is internally worked out on the basis of the Tobler function for on-path hiking; therefore, <code class="reqn">V</code> will not be
considered constant throughout the analysed area, but will vary as function of the slope.
For the correction factor applied to the Pandolf et al.'s cost function, <strong>see</strong> Yokota M., Berglund L.G., Santee W.R., Buller M.J., Hoyt R.W. (2004),
Predicting Individual Physiological Responsed During Marksmanship Field Training Using an Updates Scenario-J Model. U.S. Army Research Institute of Environmental Medicine
Technical Report T04-09. For an archaeological application of the Pandol et al's cost function with correction factor, <strong>see</strong> White D.A., Prehistoric Trail Networks of the Western Papaguarie.
A Multifaceted Least Cost Graph Theory Analysis. In White D.A. &amp; Surface-Evans S.L. (Eds.), Least Cost Analysis of Social Landscapes. Archaeological Case Studies (pp. 188-206).
University of Utah Press.<br />
</p>
<p><strong>Note</strong>: in the returned charts, the cost is transposed from Watts to Megawatts (see, e.g., Rademaker et al 2012 cited above).<br />
</p>
<p><strong>Minetti et al.'s metabolic energy cost function (in J/(kg*m))</strong>:<br />
</p>
<p><code class="reqn"> 1 / (((280.5 * abs(x[adj])^5) - (58.7 * abs(x[adj])^4) - (76.8 * abs(x[adj])^3) + (51.9 * abs(x[adj])^2) + (19.6 * abs(x[adj])) + 2.5) * N) </code><br />
</p>
<p><strong>see</strong> Minetti A.E., Moia C., Roi G.S., Susta D., Ferretti G. (2002), Enery cost of walking and running at extreme uphilland downhill slopes,
in Journal of Applied Physiology 93, 1039-1046. <strong>Note</strong> that this equation is valid for slopes in the range -0.5/0.5; outside this range,
the function's output becomes counterintuitive, as noted in Paez et al. in Journal of Transport Geography 82 (2020) and Herzog I. (2013), Theory and practice
of cost functions, in Contreras F., Farjas M., Melero F.J. (eds), &quot;Fusion of cultures. Proceedings of the 38th annual conference on computer
applications and quantitative methods in archaeology&quot;. BAR IS, 2494, 375-382. Oxford: Archaeopress. In the latter work, Herzog proposes to
replace Minetti et al.'s equation with its 6th degrees polynomial approximation (see the Herzog's metabolic cost function below).<br />
</p>
<p><strong>Herzog's metabolic cost function in J/(kg*m)</strong>:<br />
</p>
<p><code class="reqn">1 / (((1337.8 * abs(x[adj])^6) + (278.19 * abs(x[adj])^5) - (517.39 * abs(x[adj])^4) - (78.199 * abs(x[adj])^3) + (93.419 * abs(x[adj])^2) + (19.825 * abs(x[adj])) + 1.64) * N)  </code><br />
</p>
<p><strong>see</strong> Herzog, I. (2016). Potential and Limits of Optimal Path Analysis. In A. Bevan &amp; M. Lake (Eds.), Computational Approaches to Archaeological Spaces (pp. 179-211). New York: Routledge.
Herzog suggests to use this as a 6th degree polynomial approximation of the Minetti et al's cost function (see above).<br />
</p>
<p><strong>Van Leusen's metabolic energy expenditure cost function (in Watts)</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((1.5 * W + 2.0 * (W + L) * (L / W)^2 + N * (W + L) * (1.5 * (V^2) + 0.35 * V * ((abs(x[adj])*100) + 10)))*N) </code><br />
</p>
<p>which modifies the Pandolf et al.'s equation; <strong>see</strong> Van Leusen, P. M. (2002). Pattern to process: methodological investigations into the formation and interpretation of spatial patterns in archaeological landscapes. University of Groningen.
<strong>Note</strong> that, as per Herzog, I. (2013). Least-cost Paths - Some Methodological Issues, Internet Archaeology 36 (http://intarch.ac.uk/journal/issue36/index.html) and
unlike Van Leusen (2002), in the above equation slope is expressed in percent and speed in m/s; also, in the last bit of the equantion, 10 replaces
the value of 6 used by Van Leusen (as per Herzog 2013).<br />
As explained above, if <code class="reqn">V</code> is set to 0 by the user, it is internally worked out on the basis of the Tobler function for on-path hiking; therefore, <code class="reqn">V</code> will not be considered constant
throughout the analysed area, but will vary as function of the slope.<br />
</p>
<p><strong>Note</strong>: in the returned charts, the cost is transposed from Watts to Megawatts.<br />
</p>
<p><strong>Llobera-Sluckin's metabolic energy expenditure cost function (in KJ/m)</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((2.635 + (17.37 * abs(x[adj])) + (42.37 * abs(x[adj])^2) - (21.43 * abs(x[adj])^3) + (14.93 * abs(x[adj])^4)) * N)  </code><br />
</p>
<p>for which <strong>see</strong> Llobera M.-Sluckin T.J. (2007). Zigzagging: Theoretical insights on climbing strategies, Journal of Theoretical Biology 249, 206-217.<br />
</p>
<p><strong>Ardigo et al.'s metabolic energy expenditure cost function (in J/(kg*m))</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((1.866 * exp(4.911*abs(x[adj])) * V^2 - 3.773 * exp(3.416*abs(x[adj])) * V + (45.71*abs(x[adj]^2) + 18.90*abs(x[adj])) + 4.456) * N) </code><br />
</p>
<p><strong>see</strong> Ardigo L.P., Saibene F., Minetti A.E. (2003), The optimal locomotion on gradients: walking, running or cycling?, in
Eur J Appl Physiol 90, 365-371. If <code class="reqn">V</code> is set to 0 by the user, it is internally worked out on the basis of the Tobler function for on-path hiking; therefore,
<code class="reqn">V</code> will not be considered constant throughout the analysed area, but will vary as function of the slope.<br />
</p>
<p><strong>Hare's metabolic energy expenditure cost function (in cal/km)</strong>:<br />
</p>
<p><code class="reqn"> 1 / ((48+30/(1/(6 * exp(-3.5 * abs(x[adj] + 0.05)))))*N) </code><br />
</p>
<p><strong>see</strong> Hare T.S., Using Measures of Cost Distance in the Estimation of Polity Bounrdaries in the Post Classic
Yautepec valley, Mexico, in Journal of Archaeological Science 31 (2004). Energetic expenditure is expressed in calories per km; walking speed
is internally worked out from the DTM using the on-path Tobler's hiking function, which is expressed as its reciprocal; walking speed in km/h as per original Tobler's equation
and as requested by Hare's function.<br />
</p>
<p><strong>Note</strong> that the walking-speed-related cost functions listed above are used as they are, while the other functions are reciprocated.
This is done since &quot;gdistance works with conductivity rather than the more usual approach using costs&quot;; therefore
&quot;we need inverse cost functions&quot; (Nakoinz-Knitter (2016). &quot;Modelling Human Behaviour in Landscapes&quot;. New York: Springer, p. 183).
As a consequence, if we want to estimate time, we have to use the walking-speed functions as they are since the final accumulated values will correspond to the
reciprocal of speed, i.e. pace. In the other cases, we have to use 1/cost-function to eventually get cost-function/1.<br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class)
</p>
</li>
<li><p> cost.surface: raster representing the cost-surface ('RasterLayer' class)
</p>
</li>
<li><p> accumulated.cost.raster: raster representing the accumualted cost ('RasterLayer' class)
</p>
</li>
<li><p> isolines: contour lines derived from the accumulated cost surface ('SpatialLinesDataFrame' class)
</p>
</li>
<li><p> LCPs: estimated least-cost paths ('SpatialLinesDataFrame' class)
</p>
</li>
<li><p> LCPs.back: estimated least-cost paths back to the origin ('SpatialLinesDataFrame' class)
</p>
</li>
<li><p> LCPs$length: length of each least-cost path (units depend on the unit used in the input DTM)
</p>
</li>
<li><p> LCPs.back$length: length of each least-cost path back to the origin (units depend on the unit used in the input DTM)
</p>
</li>
<li><p> dest.loc.w.cost: copy of the input destination location(s) dataset with a new variable ('cost') added; if
the cost is expressed in terms of time, the 'cost' variable will store the time values in decimal numbers, while another variable named
'cost_hms' will store the time values in sexagesimmal numbers (hours, minutes, seconds)
</p>
</li>
<li><p> conductance: conductance 'Transitional Layer', returned because internally used by the <code>movenetw()</code> function
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>, <code><a href="#topic+movecorr">movecorr</a></code>, <code><a href="#topic+movebound">movebound</a></code>, <code><a href="#topic+movealloc">movealloc</a></code>,  <code><a href="#topic+movecomp">movecomp</a></code>, <code><a href="#topic+movenetw">movenetw</a></code>, <code><a href="#topic+moverank">moverank</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)

# load a sample start location on the above DTM
data(volc.loc)

# load the sample destination locations on the above DTM
data(destin.loc)

# calculate walking-time isochrones based on the on-path Tobler's hiking function (default),
# setting the time unit to hours and the isochrones interval to 0.05 hour;
# also, since destination locations are provided,
# least-cost paths from the origin to the destination locations will be calculated
# and plotted; 8-directions move is used

result &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc, move=8, breaks=0.05)


# same as above, but using the Irmischer-Clarke's hiking function (male, on-path)

result &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc, funct="icmonp",
move=8, breaks=0.05)


# same as above, but using the 'cognitive slope'

result &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc, funct="icmonp",
move=8, breaks=0.05, cogn.slp=TRUE)


# calculate accumulated cost surface and the least-cost path between the
# origin and one destination, and also calculate the LCP back to the origin

results &lt;- movecost(dtm=volc, origin=volc.loc, destin=destin.loc[2,], move=8, return.base = TRUE)


</code></pre>

<hr>
<h2 id='movenetw'>R function for calculating least-cost path network</h2><span id='topic+movenetw'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate LCPs between multiple origins.
Two types of networks are produced: one where each origin location is connected to all the others locations; one where
only pairs of neighboring locations are connected. In other words, in the latter case, each location is connected to the location that is the
nearest in terms of walking cost, either in terms of time or energy (or abstract cost), according to the selected cost function.
Optionally, a raster representing the density of the first type of network can be produced.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movenetw(
  dtm = NULL,
  origin,
  netw.type = "allpairs",
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  irregular.dtm = FALSE,
  funct = "t",
  move = 16,
  field = 0,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  lcp.dens = FALSE,
  transp = 0.5,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movenetw_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_origin">origin</code></td>
<td>
<p>locations from which the network of least-cost paths is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_netw.type">netw.type</code></td>
<td>
<p>type of network to be calculated: 'allpairs' (default) or 'neigh' (see 'Details').</p>
</td></tr>
<tr><td><code id="movenetw_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="movenetw_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_irregular.dtm">irregular.dtm</code></td>
<td>
<p>TRUE or FALSE (default) if the input DTM features irregular margins (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_funct">funct</code></td>
<td>
<p>cost function to be used (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
<strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="movenetw_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_field">field</code></td>
<td>
<p>value assigned to the cells coinciding with the barrier (0 by default) (see <code><a href="#topic+movecost">movecost</a></code>.</p>
</td></tr>
<tr><td><code id="movenetw_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_lcp.dens">lcp.dens</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the least-cost paths density raster to be produced.</p>
</td></tr>
<tr><td><code id="movenetw_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the DTM (0.5 by default).</p>
</td></tr>
<tr><td><code id="movenetw_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the LCPs network to be exported as a shapefile, and the LCPs network density as a GeoTiff; the DTM is exported only if it was not provided by the user
and downloaded by the function from online sources.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Like <code>movecost()</code>, the function just requires an input DTM ('RasterLayer' class) and an origin dataset  ('SpatialPointsDataFrame' class).
If a DTM is not provided, <code>movenetw()</code> downloads elevation data from online sources for the area enclosed by the polygon fed via
the <code>studyplot</code> parameter (see <code><a href="#topic+movecost">movecost</a></code> for more details). Under the hood, <code>movenetw()</code> relies on <code>movecost()</code> and implements the same cost functions:
see the help documentation of <code>movecost()</code> for further information.<br />
</p>
<p><code>movenetw()</code> produces a plot representing the input DTM overlaid by a slopeshade raster, whose transparency can be adjusted using
the <code>transp</code> parameter. On the rendered plot, the LPCs network ('SpatialLinesDataFrame' class) is represented by black lines.
To calculate the network connecting all the locations, the user may want to set the <code>netw.type</code> parameter to <code>allpairs</code> (which is the default value).
If the user wants to calculate the network connecting neighbouring locations, the <code>netw.type</code> parameter is to be set to <code>neigh</code>.
Optionally, by setting the <code>lcp.dens</code> parameter to <code>TRUE</code>, the function produces a raster representing the density of the LCPs connecting each location to all the
other locations. The raster, which is rendered overlaid to a slopeshade visualization, expresses the density of LCPs as percentages.
The percentages are calculated in relation to the maximum number of LCPs passing through the same cell stored in the raster.
A density raster expressing counts is NOT rendered BUT is returned by the function. The density raster retains the cell size and coordinate system of the input DTM.<br />
</p>
<p>The function returns a list storing the DTM (only in case this has not been fed into the function but acquired online), a list of LCPs
split by origin, a SpatialLineDataFrame representing the merged LCPs, two rasters representing the LCPs network density
expressed as counts and percentages respectively, and cost matrices. As for the latter, if the selected cost function defines cost as
walking time, two matrices are returned, one expressing time in minutes, one in hours (<strong>note</strong> that the values are in decimal format).
If the selected cost function expresses cost differently (i.e., energy or abstract cost), the two above mentioned cost matrices will be set to NULL,
and a third cost matrix will store all the pair-wise costs.<br />
</p>
<p>The above mentioned data (DTM, LCPs, network density) can be exported by setting the <code>export</code> parameter to <code>TRUE</code>. The LCPs network (exported as a shapefile)
and the density raster (as a GeoTiff) will bear a suffix indicating the used cost function.<br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class); returned only if acquired online
</p>
</li>
<li><p> LCPs.netw: list containing the LCPs ('SpatialLinesDataFrame' class) split by origin
</p>
</li>
<li><p> LCPs.netw.merged: 'SpatialLinesDataFrame' corresponding to the merged LCPs
</p>
</li>
<li><p> LCPs.netw.neigh: list containing the LCPs between neighboring locations ('SpatialLinesDataFrame' class) split by origin
</p>
</li>
<li><p> LCPs.netw.merged: 'SpatialLinesDataFrame' corresponding to the merged LCPs between neighboring locations
</p>
</li>
<li><p> LCPs.density.count: raster ('RasterLayer' class) representing the counts of LCPs on each raster's cell
</p>
</li>
<li><p> LCPs.density.perc: same as the preceding, but re-expressing the counts as percentages
</p>
</li>
<li><p> cost.matrix.min: matrix of cost between locations, expressing cost in minutes
</p>
</li>
<li><p> cost.matrix.hr: matrix of cost between locations, expressing cost in hours
</p>
</li>
<li><p> cost.matrix: matrix of cost between locations, expressing cost either in energy or abstract cost, depending on the
used cost function
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample destination locations on the above DTM
data(destin.loc)


# calculate the least-cost path network between neighboring locations
# using the Tobler's hiking function (for on-path walking)

result &lt;- movenetw(dtm=volc, origin=destin.loc, move=8, funct="t", netw.type="neigh")


</code></pre>

<hr>
<h2 id='moverank'>R function for calculating sub-optimal least-cost paths bewteen an origin and a destination location</h2><span id='topic+moverank'></span>

<h3>Description</h3>

<p>The function provides the facility to calculate the LCP between an origin and a destination location and (more importantly) to
work out the first five sub-optimal LCPs between those locations. The underlying idea is the following: given two locations, we can
calculate the least-costly path between them; but, if we disregard that LCP, what path would be the second least costly?
And if we in turn disregard those first two, what the third least costly path would be? The same reasoning holds for all the subsequent n-th LCPs. Under the hood,
<code>moverank()</code> rests on <code><a href="#topic+movecost">movecost</a></code> and implements the same cost functions. See the help documentation of <code>movecost()</code> for further details.<br />
Visit this <a href="https://drive.google.com/file/d/1gLDrkZFh1b_glzCEqKdkPrer72JJ9Ffa/view?usp=sharing">LINK</a> to access the package's vignette.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moverank(
  dtm = NULL,
  origin,
  destin,
  studyplot = NULL,
  barrier = NULL,
  plot.barrier = FALSE,
  irregular.dtm = FALSE,
  funct = "t",
  time = "h",
  lcp.n = 3,
  move = 16,
  cogn.slp = FALSE,
  sl.crit = 10,
  W = 70,
  L = 0,
  N = 1,
  V = 1.2,
  z = 9,
  use.corr = FALSE,
  leg.pos = "topright",
  leg.cex = 0.55,
  add.chart = FALSE,
  bubble.cex = 0.5,
  transp = 0.5,
  export = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moverank_+3A_dtm">dtm</code></td>
<td>
<p>Digital Terrain Model (RasterLayer class); if not provided, elevation data will be acquired online for the area enclosed by the 'studyplot' parameter (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_origin">origin</code></td>
<td>
<p>location from which least-cost path(s) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="moverank_+3A_destin">destin</code></td>
<td>
<p>location(s) to which least-cost path(s) is calculated (SpatialPointsDataFrame class).</p>
</td></tr>
<tr><td><code id="moverank_+3A_studyplot">studyplot</code></td>
<td>
<p>polygon (SpatialPolygonDataFrame class) representing the study area for which online elevation data are acquired (see <code><a href="#topic+movecost">movecost</a></code>); NULL is default.</p>
</td></tr>
<tr><td><code id="moverank_+3A_barrier">barrier</code></td>
<td>
<p>area where the movement is inhibited (SpatialLineDataFrame or SpatialPolygonDataFrame class) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_plot.barrier">plot.barrier</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the barrier to be plotted (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_irregular.dtm">irregular.dtm</code></td>
<td>
<p>TRUE or FALSE (default) if the input DTM features irregular margins (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_funct">funct</code></td>
<td>
<p>cost function to be used (for details on each of the following, see <code><a href="#topic+movecost">movecost</a></code>):<br />
</p>
<p><strong>-functions expressing cost as walking time-</strong><br />
<strong>t</strong> (default) uses the on-path Tobler's hiking function;<br />
<strong>tofp</strong> uses the off-path Tobler's hiking function;<br />
<strong>mp</strong> uses the Marquez-Perez et al.'s modified Tobler's function;<br />
<strong>icmonp</strong> uses the Irmischer-Clarke's hiking function (male, on-path);<br />
<strong>icmoffp</strong> uses the Irmischer-Clarke's hiking function (male, off-path);<br />
<strong>icfonp</strong> uses the Irmischer-Clarke's hiking function (female, on-path);<br />
<strong>icfoffp</strong> uses the Irmischer-Clarke's hiking function (female, off-path);<br />
<strong>ug</strong> uses the Uriarte Gonzalez's walking-time cost function;<br />
<strong>ma</strong> uses the Marin Arroyo's walking-time cost function;<br />
<strong>alb</strong> uses the Alberti's Tobler hiking function modified for pastoral foraging excursions;<br />
<strong>gkrs</strong> uses the Garmy, Kaddouri, Rozenblat, and Schneider's hiking function;<br />
<strong>r</strong> uses the Rees' hiking function;<br />
<strong>ks</strong> uses the Kondo-Seino's hiking function;<br />
<strong>trp</strong> uses the Tripcevich's hiking function;<br />
</p>
<p><strong>-functions for wheeled-vehicles-</strong><br />
<strong>wcs</strong> uses the wheeled-vehicle critical slope cost function;<br />
</p>
<p><strong>-functions expressing abstract cost-</strong><br />
<strong>ree</strong> uses the relative energetic expenditure cost function;<br />
<strong>b</strong> uses the Bellavia's cost function;<br />
<strong>e</strong> uses the Eastman's cost function;<br />
</p>
<p><strong>-functions expressing cost as metabolic energy expenditure-</strong><br />
<strong>p</strong> uses the Pandolf et al.'s metabolic energy expenditure cost function;<br />
<strong>pcf</strong> uses the Pandolf et al.'s cost function with correction factor for downhill movements;<br />
<strong>m</strong> uses the Minetti et al.'s metabolic energy expenditure cost function;<br />
<strong>hrz</strong> uses the Herzog's metabolic energy expenditure cost function;<br />
<strong>vl</strong> uses the Van Leusen's metabolic energy expenditure cost function;<br />
<strong>ls</strong> uses the Llobera-Sluckin's metabolic energy expenditure cost function;<br />
<strong>a</strong> uses the Ardigo et al.'s metabolic energy expenditure cost function;<br />
<strong>h</strong> uses the Hare's metabolic energy expenditure cost function (for all the mentioned cost functions, see <code><a href="#topic+movecost">movecost</a></code>).<br /></p>
</td></tr>
<tr><td><code id="moverank_+3A_time">time</code></td>
<td>
<p>time-unit expressed by the accumulated raster if Tobler's and other time-related cost functions are used; h' for hour, 'm' for minutes.</p>
</td></tr>
<tr><td><code id="moverank_+3A_lcp.n">lcp.n</code></td>
<td>
<p>number of LCPs rendered in the output plot (min=1, max=6; 3 by default; the 1st LCP is the optimal one, while the LCPs from the 2nd to the 6th are the sub-optimal ones).</p>
</td></tr>
<tr><td><code id="moverank_+3A_move">move</code></td>
<td>
<p>number of directions in which cells are connected: 4 (rook's case), 8 (queen's case), 16 (knight and one-cell queen moves; default).</p>
</td></tr>
<tr><td><code id="moverank_+3A_cogn.slp">cogn.slp</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the 'cognitive slope' to be used in place of the real slope (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_sl.crit">sl.crit</code></td>
<td>
<p>critical slope (in percent), typically in the range 8-16 (10 by default) (used by the wheeled-vehicle cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_w">W</code></td>
<td>
<p>walker's body weight (in Kg; 70 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_l">L</code></td>
<td>
<p>carried load weight (in Kg; 0 by default; used by the Pandolf's and Van Leusen's cost function; see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_n">N</code></td>
<td>
<p>coefficient representing ease of movement (1 by default) (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_v">V</code></td>
<td>
<p>speed in m/s (1.2 by default) (used by the Pandolf et al.'s, Pandolf et al.s with correction factor, Van Leusen's, and Ardigo et al.'s cost function; if set to 0, it is internally worked out on the basis of Tobler on-path hiking function (see <code><a href="#topic+movecost">movecost</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_z">z</code></td>
<td>
<p>zoom level for the elevation data downloaded from online sources (from 0 to 15; 9 by default) (see <code><a href="#topic+movecost">movecost</a></code> and <code><a href="elevatr.html#topic+get_elev_raster">get_elev_raster</a></code>).</p>
</td></tr>
<tr><td><code id="moverank_+3A_use.corr">use.corr</code></td>
<td>
<p>TRUE or FALSE (default) is the user wants or does not want the least-cost corridor raster to be rendered in place of the input DTM.</p>
</td></tr>
<tr><td><code id="moverank_+3A_leg.pos">leg.pos</code></td>
<td>
<p>set the position of the legend in rendered plot; 'topright' by default (other options: &quot;bottomright&quot;, &quot;bottom&quot;, &quot;bottomleft&quot;, &quot;left&quot;, &quot;topleft&quot;, &quot;top&quot;, &quot;topright&quot;, &quot;right&quot;, &quot;center&quot;).</p>
</td></tr>
<tr><td><code id="moverank_+3A_leg.cex">leg.cex</code></td>
<td>
<p>set the size of the labels used in the legend displayed in the rendered plot (0.55 by default).</p>
</td></tr>
<tr><td><code id="moverank_+3A_add.chart">add.chart</code></td>
<td>
<p>TRUE or FALSE (default) is the user wants or does not want a bubble chart visualising LCPs length vs rank vs cost to be rendered.</p>
</td></tr>
<tr><td><code id="moverank_+3A_bubble.cex">bubble.cex</code></td>
<td>
<p>set the size of the labels reporting the LCPs cost in the bubble chart (0.5 by default).</p>
</td></tr>
<tr><td><code id="moverank_+3A_transp">transp</code></td>
<td>
<p>set the transparency of the slopeshade raster that is plotted over the least-cost corridor raster (0.5 by default).</p>
</td></tr>
<tr><td><code id="moverank_+3A_export">export</code></td>
<td>
<p>TRUE or FALSE (default) if the user wants or does not want the output to be exported; if TRUE, the least-cost corridor and the DTM (if not provided by the user but acquired online)
are expoerted as a GeoTiff file, while the LCPs as a shapefile layer. All the exported files (excluding the DTM) will bear a suffix corresponding to the cost function selected by the user.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, <code>moverank()</code> uses <code>movecost()</code> to generate the first (optimal) LCP. In a second iteration,
the optimal LCP is internally used as barrier (see <code><a href="#topic+movecost">movecost</a></code>) when calculating the 2nd LCPs. Then, in a third iteration,
the two previously generated LCPs are used as barriers when working out the 3rd LCPs. The process repeats along the same lines until the
6th LCP is calculated. The 1st LCP is deemed to represent the optimal path (cost-wise) between the two locations, while the
2nd-to-5th LCPs are deemed to represent progressively sub-optimal paths.<br />
</p>
<p>It is worth noting that it may happen that some LCP will cross another one; this cannot be anticipated and is context dependent.
In those cases, the user may want to set the <code>move</code> parameter to 8 (see the section about
inhibition of movement in the help documentation of <code><a href="#topic+movecost">movecost</a></code>). <br />
</p>
<p>The function provides the facility to render the LCPs either on the input DTM or on the least-cost corridor
between the two locations. The second option can be obtained by setting the <code>use.corr</code> parameter to <code>TRUE</code>.
Also, by setting the <code>add.chart</code> parameter to <code>TRUE</code>, the function renders a bubble chart that plots the LCPs length
against their rank, while the size of the bubbles is proportional to the cost. All the LCPs will be plotted.<br />
</p>
<p>By setting the <code>export</code> parameter to <code>TRUE</code>, the LCPs, the DTM (if acquired online), and the least-cost corridor
(if obtained by setting the <code>use.corr</code> parameter to <code>TRUE</code>), will be exported: the DTM and least-cost corridor as a raster layer,
the LCPs as shapefile layer. The LCPs and the least-cost corridor files will be given a suffix indicating which cost function has been used.<br />
</p>


<h3>Value</h3>

<p>The function returns a list storing the following components
</p>

<ul>
<li><p> dtm: Digital Terrain Model ('RasterLayer' class); returned only if not provided by the user and acquired online instead
</p>
</li>
<li><p> LCPs: least-cost paths ('SpatialLinesDataFrame' class) ranked from 1 (optimal) to 6 (sub-optimal LCPs)
</p>
</li>
<li><p> lc.corr: least-cost corridor between the origin and destination location ('RasterLayer' class); returned if the <code>use.corr</code> parameter is set to <code>TRUE</code>
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+movecost">movecost</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load a sample Digital Terrain Model
data(volc)


# load the sample destination locations on the above DTM
data(destin.loc)

# calculate the optimal and sub-optimals LCPs between two locations
#result &lt;- moverank(volc, destin.loc[1,], destin.loc[4,], move=8, funct="t")

</code></pre>

<hr>
<h2 id='springs'>Dataset: location of springs in Malta</h2><span id='topic+springs'></span>

<h3>Description</h3>

<p>A SpatialPointsDataFrame representing the location of spring-related toponyms in Malta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(springs)
</code></pre>


<h3>Format</h3>

<p>SpatialPointsDataFrame
</p>

<hr>
<h2 id='volc'>Dataset: raster dataset representing the elevation of the volcano Maunga Whau (Auckland, New Zealand)</h2><span id='topic+volc'></span>

<h3>Description</h3>

<p>A RasterLayer representing a DTM of the volcano Maunga Whau (Auckland, New Zealand).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(volc)
</code></pre>


<h3>Format</h3>

<p>RasterLayer
</p>

<hr>
<h2 id='volc.loc'>Dataset: location on the volcano Maunga Whau (Auckland, New Zealand)</h2><span id='topic+volc.loc'></span>

<h3>Description</h3>

<p>A SpatialPointsDataFrame representing a spot on the volcano Maunga Whau (Auckland, New Zealand).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(volc.loc)
</code></pre>


<h3>Format</h3>

<p>SpatialPointsDataFrame
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
