<!DOCTYPE html><html><head><title>Help for package saros</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {saros}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#attach_qualtrics_labels'><p>Re-attach label information from Qualtrics not obtained from regular data downloads</p></a></li>
<li><a href='#center_string'><p>Center String Vector</p></a></li>
<li><a href='#col_to_binaries'><p>Mutate a (factor, character, integer, etc) column into multiple columns,</p></a></li>
<li><a href='#combn_upto'><p>Create All Possible Combinations of Vector Elements with Minimum A and</p>
Maximum B.</a></li>
<li><a href='#create_caption'><p>Adds caption attribute</p></a></li>
<li><a href='#create_email_credentials'><p>Create Data Frame Containing Email Drafts with User Credentials</p></a></li>
<li><a href='#crosstable3'><p>Internal function for fast cross-table</p></a></li>
<li><a href='#draft_report'><p>Automatically Draft a Quarto Report</p></a></li>
<li><a href='#embed_cat_freq_plot'><p>Embed Interactive Categorical Plot</p></a></li>
<li><a href='#embed_cat_freq_plot_docx'><p>Create Word Report with Univariates for Categorical Columns Sharing Same Categories</p></a></li>
<li><a href='#embed_cat_prop_plot'><p>Embed Interactive Categorical Plot</p></a></li>
<li><a href='#embed_cat_prop_plot_docx'><p>Create Word Report with Univariates for Categorical Columns Sharing Same Categories</p></a></li>
<li><a href='#embed_cat_table'><p>Embed Reactable Table</p></a></li>
<li><a href='#embed_cat_text_html'><p>Creates a structured list with text interpretations for a set of variables.</p></a></li>
<li><a href='#embed_chr_table_html'><p>Interactive table of text data</p></a></li>
<li><a href='#embed_sigtest'><p>Test Significance Based on Randomization Theory</p></a></li>
<li><a href='#ex_survey'><p>ex_survey: Mockup dataset of a survey.</p></a></li>
<li><a href='#ex_survey_ch_overview'><p>ex_survey_ch_overview: Mock overview of chapter structure</p></a></li>
<li><a href='#filename_sanitizer'><p>File/folder name sanitizer replacing space and punctuation with underscore</p></a></li>
<li><a href='#gen_element_and_qmd_snippet2'><p>Mass Create Elements of A Certain Type</p></a></li>
<li><a href='#gen_qmd_chapters'><p>Generate A Quarto Survey Report</p></a></li>
<li><a href='#gen_qmd_index'><p>Generate Quarto Index File That Merges All Chapters</p></a></li>
<li><a href='#get_colour_palette'><p>Provide A Colour Set for A Number of Requested Colours</p></a></li>
<li><a href='#get_colour_set'><p>Provide A Colour Set for A Number of Requested Colours</p></a></li>
<li><a href='#get_data_label_opts'><p>Get Valid Data Labels for Figures and Tables</p></a></li>
<li><a href='#handpick'><p>Return character vector of manually picked data columns.</p></a></li>
<li><a href='#hex_bw'><p>Identify Suitable Font Given Background Hex Colour</p></a></li>
<li><a href='#is_colour'><p>Are All Colours in Vector Valid Colours</p></a></li>
<li><a href='#list_available_element_types'><p>List All Valid Names of The Elements Argument</p></a></li>
<li><a href='#omitted_recoder_df'><p>Recode Missing By Type of Missingness</p></a></li>
<li><a href='#post_render_docx_img_replacer'><p>Post-Render All docx-files Found in The Output Folder To Replace Images with Mscharts</p></a></li>
<li><a href='#prep_cat_freq_plot_docx'><p>Create Categorical Data Chart from Summarized Data</p></a></li>
<li><a href='#prep_cat_freq_plot_html'><p>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories</p></a></li>
<li><a href='#prep_cat_prop_plot_docx'><p>Create Categorical Data Chart from Summarized Data</p></a></li>
<li><a href='#prep_cat_prop_plot_html'><p>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories</p></a></li>
<li><a href='#prepare_chunk'><p>Internal function to prepare a chunk for a Quarto report.</p></a></li>
<li><a href='#prepare_safe_render'><p>Convenience function to prepare, copy and render website</p></a></li>
<li><a href='#quarto_render_saros'><p>Simple wrapper for quarto::quarto_render() that temporarily sets LC_ALL=&quot;C&quot; and takes the processing time</p></a></li>
<li><a href='#read_default_draft_report_args'><p>Read Default Arguments for <code>draft_report()</code> from YAML-file</p></a></li>
<li><a href='#refine_chapter_overview'><p>Processes A 'chapter_overview' Data Frame</p></a></li>
<li><a href='#remove_label_parts'><p>Remove regex pattern from variable labels</p></a></li>
<li><a href='#remove_special_chars_in_labels'><p>Remove Special Characters (&lt;,&gt;) in Variable Labels</p></a></li>
<li><a href='#rename_by_labels'><p>Rename Dataset Columns by Labels.</p></a></li>
<li><a href='#render_full_reports'><p>Post-render rendering of complete reports</p></a></li>
<li><a href='#replace_docx_imgs_with_mscharts'><p>Replace Images in A Quarto-Generated docx-file with Mschart docx-files</p></a></li>
<li><a href='#replace_stata_labels'><p>Replace Stata Labels</p></a></li>
<li><a href='#sanitize_labels'><p>Sanitize labels originating from e.g. Qualtrics for use in Saros</p></a></li>
<li><a href='#setup_access_restrictions'><p>Setup files needed for basic password-based access restriction for website</p></a></li>
<li><a href='#subset_vector'><p>Given Ordered Integer Vector, Return Requested Set.</p></a></li>
<li><a href='#summarize_data'><p>Summarize a survey dataset for use in tables and graphs</p></a></li>
<li><a href='#swap_label_colnames'><p>Swap Dataset Columns and Labels</p></a></li>
<li><a href='#write_default_draft_report_args'><p>Write Default Arguments for <code>draft_report()</code> to YAML-file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Semi-Automatic Reporting of Ordinary Surveys</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephan Daus &lt;stephus.daus@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Produces highly customized reports, primarily intended for survey
    research. Building on 'Quarto' (<a href="https://quarto.org">https://quarto.org</a>), it generates draft
    chapters of all specified dependent/independent variables, which can be
    further edited by hand, containing figures, tables and analyses (currently
    only uni-/bivariate tests of equivalent means/proportions). The feature
    'mesos'-reports offer tailor-made batch report production where e.g. an
    institution can compare itself to all other participants. Publication tools
    are also included, such as password generation for 'mesos'-report sections
    on a 'Quarto' Website.</td>
</tr>
<tr>
<td>Note:</td>
<td>Free to use for non-Norwegian institutions, otherwise see
LICENSE.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nifu-no.github.io/saros/">https://nifu-no.github.io/saros/</a>, <a href="https://github.com/NIFU-NO/saros">https://github.com/NIFU-NO/saros</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/NIFU-NO/saros/issues">https://github.com/NIFU-NO/saros/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, bcrypt, utils, vctrs, dplyr, tidyr, tidyselect, glue,
rlang, stringi, yaml, forcats, ggplot2, ggiraph, mschart,
officer, fs, clipr, rstudioapi, rvest</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, srvyr, writexl, haven, readr, ggfittext, labelled,
testthat (&ge; 3.0.0), readxl, htmltools, reactable, stringr,
tibble, qs, openai, withr, quarto, spelling</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Quarto command line tools
(https://github.com/quarto-dev/quarto-cli) for the rendering
wrapper functionality.</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>refine_chapter_overview</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-28 21:52:43 UTC; py128</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephan Daus <a href="https://orcid.org/0000-0003-0230-6997"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Nordic Institute for The Studies of Innovation, Research and Education
    (NIFU) [fnd],
  Kristiania University College [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-29 01:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='attach_qualtrics_labels'>Re-attach label information from Qualtrics not obtained from regular data downloads</h2><span id='topic+attach_qualtrics_labels'></span>

<h3>Description</h3>

<p>Re-attach label information from Qualtrics not obtained from regular data downloads
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attach_qualtrics_labels(
  data,
  questions,
  reverse_stata_replacement = FALSE,
  questions_var = "qname",
  questions_question = "question"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attach_qualtrics_labels_+3A_data">data</code></td>
<td>
<p>Data.frame with original variable names.</p>
</td></tr>
<tr><td><code id="attach_qualtrics_labels_+3A_questions">questions</code></td>
<td>
<p>Data frame with questions obtained from <code>qualtRics::survey_questions()</code></p>
</td></tr>
<tr><td><code id="attach_qualtrics_labels_+3A_reverse_stata_replacement">reverse_stata_replacement</code></td>
<td>
<p>If variable names have already been modified</p>
</td></tr>
<tr><td><code id="attach_qualtrics_labels_+3A_questions_var">questions_var</code></td>
<td>
<p>String, indicating column name in <code>questions</code> that indicates column names.</p>
</td></tr>
<tr><td><code id="attach_qualtrics_labels_+3A_questions_question">questions_question</code></td>
<td>
<p>String, indicating column name in <code>questions</code> for the full question.
with full stops changed to underscores, this will reverse them for connection. Rarely needed. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data returned with only variable labels modified.
</p>

<hr>
<h2 id='center_string'>Center String Vector</h2><span id='topic+center_string'></span>

<h3>Description</h3>

<p>Center String Vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>center_string(string, maxwidth = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="center_string_+3A_string">string</code></td>
<td>
<p>String vector</p>
</td></tr>
<tr><td><code id="center_string_+3A_maxwidth">maxwidth</code></td>
<td>
<p>Maximum width</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>center_string(string=c("This is a very long label for a graph.",
"But this one is even longer due to superfluous and verbose way of writing"),
 maxwidth=20)
</code></pre>

<hr>
<h2 id='col_to_binaries'>Mutate a (factor, character, integer, etc) column into multiple columns,</h2><span id='topic+col_to_binaries'></span>

<h3>Description</h3>

<p>Easily mutate a single column into multiple columns (~dummies+1),
while retaining variable labels and order of the original factor variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>col_to_binaries(data, col, var_separator = "___", label_separator = " - ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="col_to_binaries_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="col_to_binaries_+3A_col">col</code></td>
<td>
<p>Single column. Tidy-select.</p>
</td></tr>
<tr><td><code id="col_to_binaries_+3A_var_separator">var_separator</code></td>
<td>
<p><em>Variable separator</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Separator between old variable name and categories.</p>
</td></tr>
<tr><td><code id="col_to_binaries_+3A_label_separator">label_separator</code></td>
<td>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Separator between old label name and new label part.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Original data frame with the binary columns attached, containing new labels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>col_to_binaries(ex_survey, col = b_3, label_separator = "  -  ")
</code></pre>

<hr>
<h2 id='combn_upto'>Create All Possible Combinations of Vector Elements with Minimum A and
Maximum B.</h2><span id='topic+combn_upto'></span>

<h3>Description</h3>

<p>Create All Possible Combinations of Vector Elements with Minimum A and
Maximum B.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combn_upto(
  vec = c("a", "b", "c", "d", "e", "f", "g"),
  n_min = 6L,
  n_max = length(vec)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combn_upto_+3A_vec">vec</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="combn_upto_+3A_n_min">n_min</code></td>
<td>
<p>Minimum number of elements</p>
</td></tr>
<tr><td><code id="combn_upto_+3A_n_max">n_max</code></td>
<td>
<p>Maximum number of elements. Defaults to length of vec.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>combn_upto()
</code></pre>

<hr>
<h2 id='create_caption'>Adds caption attribute</h2><span id='topic+create_caption'></span>

<h3>Description</h3>

<p>Adds caption attribute
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_caption(
  main_question,
  data_out,
  indep_pos = NULL,
  mesos_group = NULL,
  filepath = NULL,
  translations = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_caption_+3A_main_question">main_question</code></td>
<td>
<p>String from get_main_question2</p>
</td></tr>
<tr><td><code id="create_caption_+3A_data_out">data_out</code></td>
<td>
<p>Output from summarize_data</p>
</td></tr>
<tr><td><code id="create_caption_+3A_indep_pos">indep_pos</code></td>
<td>
<p>Named integer for the by-variable.</p>
</td></tr>
<tr><td><code id="create_caption_+3A_mesos_group">mesos_group</code></td>
<td>
<p>String, indicating the name of the mesos group</p>
</td></tr>
<tr><td><code id="create_caption_+3A_filepath">filepath</code></td>
<td>
<p>String, path to pretty tabular file</p>
</td></tr>
<tr><td><code id="create_caption_+3A_translations">translations</code></td>
<td>
<p>List of named strings for by and (N=, etc. see getOption(&quot;saros&quot;)$translations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String
</p>

<hr>
<h2 id='create_email_credentials'>Create Data Frame Containing Email Drafts with User Credentials</h2><span id='topic+create_email_credentials'></span>

<h3>Description</h3>

<p>Create Data Frame Containing Email Drafts with User Credentials
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_email_credentials(
  local_basepath = getwd(),
  rel_path_base_to_parent_of_user_restricted_folder,
  email_data_frame,
  email_col = "email",
  username_col = "username",
  local_main_password_path = ".htpasswd_private",
  ignore_missing_emails = FALSE,
  email_body = "Login credentials are \nUsername: {username},\nPassword: {password}",
  email_subject = "User credentials for website example.net.",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_email_credentials_+3A_local_basepath">local_basepath</code></td>
<td>
<p>String. Path to where your QMD-files are located (the site to be rendered).</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_rel_path_base_to_parent_of_user_restricted_folder">rel_path_base_to_parent_of_user_restricted_folder</code></td>
<td>
<p>String. Path going from basepath to the folder containing folders to password-protect.</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_email_data_frame">email_data_frame</code></td>
<td>
<p>Data.frame/tibble with (at least) emails and usernames</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_email_col">email_col</code></td>
<td>
<p>String, name of email column</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_username_col">username_col</code></td>
<td>
<p>String, name of username column in email_data_frame</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_local_main_password_path">local_main_password_path</code></td>
<td>
<p>Path to a local .htpasswd file containing username:password header and : as separator.</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_ignore_missing_emails">ignore_missing_emails</code></td>
<td>
<p>Flag, defaults to FALSE. Whether usernames existing in password file but not email file will result in warnings.</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_email_body">email_body</code>, <code id="create_email_credentials_+3A_email_subject">email_subject</code></td>
<td>
<p>String, subject line and email body respectively. Supports glue syntax referring to columns found in the email data frame or password file.</p>
</td></tr>
<tr><td><code id="create_email_credentials_+3A_...">...</code></td>
<td>
<p>Dynamic dots forwarded to quarto::quarto_render</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame
</p>

<hr>
<h2 id='crosstable3'>Internal function for fast cross-table</h2><span id='topic+crosstable3'></span>

<h3>Description</h3>

<p>Internal function for fast cross-table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crosstable3(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crosstable3_+3A_data">data</code></td>
<td>
<p>data.frame, survey object (requires <code>srvyr</code>-package)</p>
</td></tr>
<tr><td><code id="crosstable3_+3A_...">...</code></td>
<td>
<p>Dynamic dots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame
</p>

<hr>
<h2 id='draft_report'>Automatically Draft a Quarto Report</h2><span id='topic+draft_report'></span>

<h3>Description</h3>

<p>The <code>draft_report()</code> function is the main function, and the only necessary
user interface, to create semi-automated (draft) reports. It does not need to
be the first step, however, as one might want to store and read in arguments
for the function with the <code>read_yaml_params()</code>-function first. After the
report files has been drafted with <code>draft_report()</code>, you can edit, render, and
ultimately publish these as usual with Quarto features in RStudio.
The index.qmd will be the main output file containing &quot;includes&quot; to other
chapters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>draft_report(
  data,
  chapter_overview = NULL,
  ...,
  path,
  title = "Report",
  authors = NULL,
  mesos_report = FALSE,
  mesos_var = NULL,
  label_separator = " - ",
  name_separator = NULL,
  index_yaml_file = NULL,
  report_yaml_file = NULL,
  chapter_yaml_file = NULL,
  qmd_start_section_filepath = NULL,
  qmd_end_section_filepath = NULL,
  index_filename = "index.qmd",
  element_names = c("uni_cat_prop_plot", "uni_cat_freq_plot", "uni_cat_table",
    "uni_chr_table", "hline", "bi_catcat_prop_plot", "bi_catcat_freq_plot",
    "bi_catcat_prop_plot2", "bi_catcat_freq_plot2", "bi_catcat_table", "bi_sigtest"),
  sort_by = ".upper",
  data_label = saros::get_data_label_opts(),
  always_show_bi_for_indep = NULL,
  categories_treated_as_na = NULL,
  variables_always_at_top = NULL,
  variables_always_at_bottom = NULL,
  return_raw = TRUE,
  showNA = c("never", "always", "ifany"),
  totals = FALSE,
  hide_bi_entry_if_sig_above = 1,
  hide_test_if_n_below = 10,
  hide_result_if_n_below = 10,
  hide_chr_for_others = TRUE,
  hide_variable_if_all_na = TRUE,
  single_y_bivariates_if_indep_cats_above = 3,
  single_y_bivariates_if_deps_above = 20,
  digits = 1,
  data_label_decimal_symbol = ".",
  hide_label_if_prop_below = 0.01,
  hide_axis_text_if_single_variable = FALSE,
  main_font_size = 10,
  label_font_size = 3,
  strip_font_size = 7,
  legend_font_size = 7,
  strip_width = 15,
  strip_angle = 0,
  x_axis_label_width = 20,
  plot_height_multiplier_per_horizontal_line = NA,
  plot_height_multiplier_per_vertical_letter = 0.2,
  plot_height_multiplier_per_facet = 0.95,
  plot_height_multiplier_per_legend_line = 1.1,
  plot_height_fixed_constant = 0,
  plot_height_max = 8,
  plot_height_min = 1.5,
  vertical_height = 12,
  vertical = FALSE,
  png_scale = 1.2,
  png_width = 14,
  png_height = 16,
  font_family = "sans",
  colour_palette_nominal = NULL,
  colour_palette_ordinal = NULL,
  colour_na = "gray90",
  colour_2nd_binary_cat = NULL,
  table_main_question_as_header = FALSE,
  max_width_obj = 128,
  max_width_file = 64,
  max_clean_folder_name = 12,
  open_after_drafting = FALSE,
  organize_by = c("chapter", ".variable_label_prefix_dep", ".variable_name_indep",
    ".element_name"),
  arrange_output_by = c("chapter", ".variable_name_dep", ".variable_name_indep"),
  ignore_heading_for_group = c(".element_name", ".variable_type_dep", "chapter"),
  replace_heading_for_group = c(.variable_label_suffix_dep = ".variable_name_dep"),
  mesos_first = TRUE,
  descend = TRUE,
  require_common_categories = TRUE,
  panel_tabset_mesos = TRUE,
  pdf = TRUE,
  attach_chapter_dataset = TRUE,
  auxiliary_variables = NULL,
  flexi = FALSE,
  micro = FALSE,
  reps = 1000,
  information = c(".variable_label_dep", ".category", ".count", ".count_se",
    ".proportion", ".proportion_se", ".mean", ".mean_se", ".data_label",
    ".comb_categories", ".sum_value"),
  contents = c("intro", "not_used_category", "mode_max", "value_max", "value_min",
    "value_diff", "mean_max", "mean_min", "mean_diff", "median_max", "median_min",
    "median_diff", "variance_max", "variance_min"),
  include_numbers = TRUE,
  n_top_bottom = 1,
  log_file = NULL,
  serialized_format = c("rds", "qs"),
  tabular_format = c("delim", "xlsx", "csv", "csv2", "tsv", "sav", "dta"),
  translations = list(last_sep = " and ", download_report = "Download report (PDF)",
    intro_prefix = "We will now look at the questions asked regarding ", intro_suffix =
    "", mode_max_onfix = " on ", mode_max_prefix = "The most common responses were ",
    mode_max_suffix = "", not_used_prefix =
    "The following response categories were not used: ", not_used_suffix = "",
    value_max_prefix = "", value_max_infix =
    " {?is/are} the {dots$n_top_bottom} item{?s} where the most responded ",
    value_max_suffix = "", value_min_prefix = "", 
     value_min_infix =
    " {?is/are} the {dots$n_top_bottom} item{?s} where the fewest responded ",
    value_min_suffix = "", mean_onfix = "M = ", mean_max_prefix =
    "They have highest mean on ", mean_max_suffix = "", mean_min_prefix =
    "They have lowest mean on ", mean_min_suffix = "", median_onfix = "Median = ",
    median_max_prefix = "They have highest median on ", median_max_suffix = "",
    median_min_prefix = "They have lowest median on ", median_min_suffix = "",
    intro_by_prefix = "We will now look at the questions asked regarding ", 
    
    intro_by_infix = " broken down by ", intro_by_suffix = "", by_breakdown = " by ",
    n_equal_prefix = " (N &amp;equals; ", n_equal_suffix = ")", table_heading_N =
    "Total (N)", by_total = "Everyone", sigtest_prefix = "Significance testing of ",
    sigtest_suffix = "", mesos_group_prefix = " Group: ", mesos_group_suffix = "",
    mesos_label_all_others = "Others", empty_chunk_text = "\nText\n",
    flexi_input_chapter = "Chapter(s):", flexi_input_dep = "Dependent variable(s):",
    flexi_input_indep = "Independent variable:", 
     flexi_input_mesos_group =
    "Filter:", flexi_figure_type = "Figure type:", flexi_data_label =
    "Summary to display", flexi_showNA = "Show NA (Missing)", flexi_sort_by = "Sort by",
    flexi_totals = "Totals", flexi_digits = "Digits after decimal", flexi_table =
    "Table", flexi_figure = "Figure", flexi_cols_variable_name = "Variable name",
    flexi_cols_variable_label = "Variable label", flexi_cols_category =
    "Response category", flexi_cols_count = "N", flexi_cols_count_se = "SE(N)",
    flexi_cols_proportion = "Proportion", 
     flexi_cols_proportion_se =
    "SE(Proportion)", flexi_cols_mean = "Mean", flexi_cols_mean_se = "SE(Mean)",
    flexi_cols_data_label = "Data label", flexi_cols_comb_categories =
    "Combined categories", flexi_cols_sum_value =
    "Sum of data label across combined categories", flexi_validate =
    "Error: Columns must have some categories in common.", flexi_settings = "Settings",
    flexi_basic_settings = "Basic", flexi_advanced_settings = "Advanced",
    flexi_input_indep_none = "&lt;none&gt;", flexi_figure_type_proportion = "Proportion", 
    
    flexi_figure_type_frequency = "Frequency", flexi_hide_label_if_prop_below =
    "Hide label if proportion below:")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="draft_report_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_chapter_overview">chapter_overview</code></td>
<td>
<p><em>What goes in each chapter</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>Data frame (or tibble, possibly grouped). One row per chapter. Should
contain the columns 'chapter' and 'dep', Optionally 'indep' (independent
variables) and other informative columns as needed.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_path">path</code></td>
<td>
<p><em>Output path</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Path to save all output.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_title">title</code></td>
<td>
<p><em>Title of report</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Added automatically to YAML-header of index.qmd-file.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_authors">authors</code></td>
<td>
<p><em>Authors of entire report</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>If NULL, infers from chapter_overview$authors, and collates for entire report.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_mesos_report">mesos_report</code></td>
<td>
<p><em>Whether to produce reports per mesos group</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code>
If false, returns a regular single report.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_mesos_var">mesos_var</code></td>
<td>
<p><em>Variable in ´data´ indicating groups to tailor reports for</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Column name in data indicating the groups for which mesos reports will be produced.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_label_separator">label_separator</code></td>
<td>
<p><em>Variable label separator</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>String to split labels on main question and sub-items.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_name_separator">name_separator</code></td>
<td>
<p><em>Variable name separator</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>String to split column names in data between main question and sub-items</p>
</td></tr>
<tr><td><code id="draft_report_+3A_index_yaml_file">index_yaml_file</code>, <code id="draft_report_+3A_report_yaml_file">report_yaml_file</code></td>
<td>
<p><em>Path to YAML-file to insert into index.qmd and report.qmd respectively</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Path to file used to insert header YAML, in index and report files.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_chapter_yaml_file">chapter_yaml_file</code></td>
<td>
<p><em>Path to YAML-file to insert into each chapter qmd-file</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Path to file used to insert header YAML, in each chapter.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_qmd_start_section_filepath">qmd_start_section_filepath</code>, <code id="draft_report_+3A_qmd_end_section_filepath">qmd_end_section_filepath</code></td>
<td>
<p><em>Path to qmd-bit for start/end of each qmd</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Path to qmd-snippet placed before/after body of all chapter qmds.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_index_filename">index_filename</code></td>
<td>
<p><em>Index filename</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"index.qmd"</code> (<code>optional</code>)
</p>
<p>The name of the main index Quarto file (and its subfolder) used as landing
page for each report. Will link to a PDF (report.qmd) which collects all chapters.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_element_names">element_names</code></td>
<td>
<p><em>Elements to be reported</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Elements to be reported for all sets (batteries) of y-variables.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_sort_by">sort_by</code></td>
<td>
<p><em>What to sort output by</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Sort output (and collapse if requested).
</p>

<dl>
<dt>&quot;.top&quot;</dt><dd><p>The proportion for the highest category available in the variable.</p>
</dd>
<dt>&quot;.upper&quot;</dt><dd><p>The sum of the proportions for the categories above the middle category.</p>
</dd>
<dt>&quot;.mid_upper&quot;</dt><dd><p>The sum of the proportions for the categories including and above the middle category.</p>
</dd>
<dt>&quot;.mid_lower&quot;</dt><dd><p>The sum of the proportions for the categories including and below the middle category.</p>
</dd>
<dt>&quot;.lower&quot;</dt><dd><p>The sum of the proportions for the categories below the middle category.</p>
</dd>
<dt>&quot;.bottom&quot;</dt><dd><p>The proportions for the lowest category available in the variable.</p>
</dd>
<dt>&quot;.variable_label&quot;</dt><dd><p>Sort by the variable labels.</p>
</dd>
<dt>&quot;.id&quot;</dt><dd><p>Sort by the variable names.</p>
</dd>
<dt>&quot;.by_group&quot;</dt><dd><p>The groups of the by argument.</p>
</dd>
<dt>character()</dt><dd><p>Character vector of category labels to sum together.</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="draft_report_+3A_data_label">data_label</code></td>
<td>
<p><em>Data label</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"proportion"</code> (<code>optional</code>)
</p>
<p>One of &quot;proportion&quot;, &quot;percentage&quot;, &quot;percentage_bare&quot;, &quot;count&quot;, &quot;mean&quot;, or &quot;median&quot;.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_always_show_bi_for_indep">always_show_bi_for_indep</code></td>
<td>
<p><em>Always show bivariate for indep-variable</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Specific combinations with a by-variable where bivariates should always be shown.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_categories_treated_as_na">categories_treated_as_na</code></td>
<td>
<p><em>NA categories</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Categories that should be treated as NA.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_variables_always_at_top">variables_always_at_top</code>, <code id="draft_report_+3A_variables_always_at_bottom">variables_always_at_bottom</code></td>
<td>
<p><em>Top/bottom variables</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Column names in <code>data</code> that should always be placed at the top or bottom of figures/tables.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_return_raw">return_raw</code></td>
<td>
<p><em>NOT IN USE</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code>
</p>
<p>Whether to return the raw static element.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_showna">showNA</code></td>
<td>
<p><em>Show/hide NA in categorical variables</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Whether to show NA in categorical variables (one of c(&quot;ifany&quot;, &quot;always&quot;, &quot;never&quot;)).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_totals">totals</code></td>
<td>
<p><em>Include totals</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to include totals in the output.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_bi_entry_if_sig_above">hide_bi_entry_if_sig_above</code></td>
<td>
<p><em>p-value threshold for hiding bivariate entry</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>1</code> (<code>optional</code>)
</p>
<p>Whether to hide bivariate entry if significance is above this value.
Defaults to showing all.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_test_if_n_below">hide_test_if_n_below</code></td>
<td>
<p><em>Threshold n for hiding significance test</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>0</code> (<code>optional</code>)
</p>
<p>If N is below this value, p-value will not be shown.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_result_if_n_below">hide_result_if_n_below</code></td>
<td>
<p><em>Hide result if N below</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>10</code> (<code>optional</code>)
</p>
<p>Whether to hide result if N for a given datasets (or mesos group) is below
this value. NOTE: Exceptions will be made to chr_table and chr_plot as these are
typically exempted in the first place. This might change in the future with
a separate argument.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_chr_for_others">hide_chr_for_others</code></td>
<td>
<p><em>Hide open response displays for others</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code> (<code>optional</code>)
</p>
<p>For mesos reports using the element &quot;chr_table&quot;, open responses are
displayed for also the entire sample (<code>FALSE</code>) or only for the mesos
group to ensure data privacy (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_variable_if_all_na">hide_variable_if_all_na</code></td>
<td>
<p><em>Hide variable from outputs if containing all NA</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;boolean&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code> (<code>optional</code>)
</p>
<p>Whether to remove all variables (in particular useful for mesos) if all values are NA</p>
</td></tr>
<tr><td><code id="draft_report_+3A_single_y_bivariates_if_indep_cats_above">single_y_bivariates_if_indep_cats_above</code></td>
<td>
<p><em>Single y bivariates if indep-cats above ...</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>3</code> (<code>optional</code>)
</p>
<p>Figures and tables for bivariates can become very long if the independent
variable has many categories. This argument specifies the number of indep categories
above which only single y bivariates should be shown.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_single_y_bivariates_if_deps_above">single_y_bivariates_if_deps_above</code></td>
<td>
<p><em>Single y bivariates if dep-vars above ...</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>20</code> (<code>optional</code>)
</p>
<p>Figures and tables for bivariates can become very long if there are many dependent
variables in a battery/question matrix. This argument specifies the number of dep variables
above which only single y bivariates should be shown. Set to 0 to always show single y bivariates.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_digits">digits</code></td>
<td>
<p><em>Decimal places</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>0L</code> (<code>optional</code>)
</p>
<p>Number of decimal places.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_data_label_decimal_symbol">data_label_decimal_symbol</code></td>
<td>
<p><em>Decimal symbol</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"."</code> (<code>optional</code>)
</p>
<p>Decimal marker, some might prefer a comma ',' or something else entirely.
NOTE: Future version will likely postpone formatting this until <code>gt()</code>, <code>kable()</code>, etc.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_label_if_prop_below">hide_label_if_prop_below</code></td>
<td>
<p><em>Hide label threshold</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;numeric&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Whether to hide label if below this value.
NOTE: Future versions will likely distinguish between element_types.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_hide_axis_text_if_single_variable">hide_axis_text_if_single_variable</code></td>
<td>
<p><em>Hide y-axis text if just a single variable</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;boolean&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to hide text on the y-axis label if just a single variable</p>
</td></tr>
<tr><td><code id="draft_report_+3A_main_font_size">main_font_size</code>, <code id="draft_report_+3A_label_font_size">label_font_size</code>, <code id="draft_report_+3A_strip_font_size">strip_font_size</code>, <code id="draft_report_+3A_legend_font_size">legend_font_size</code></td>
<td>
<p><em>Font sizes</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>12</code> (<code>optional</code>)
</p>
<p>Font sizes for general text (10), data label text (3), strip text (7) and legend text (7).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_strip_angle">strip_angle</code></td>
<td>
<p><em>Angle on the facet strip in plots</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>0</code></p>
</td></tr>
<tr><td><code id="draft_report_+3A_x_axis_label_width">x_axis_label_width</code>, <code id="draft_report_+3A_strip_width">strip_width</code></td>
<td>
<p><em>Label width of x-axis and strip texts in plots</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>20</code> (<code>optional</code>)
</p>
<p>Width of the labels used for the categorical column names in x-axis texts and strip texts.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_multiplier_per_vertical_letter">plot_height_multiplier_per_vertical_letter</code>, <code id="draft_report_+3A_plot_height_multiplier_per_horizontal_line">plot_height_multiplier_per_horizontal_line</code></td>
<td>
<p><em>Height multiplier</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>.1</code>
</p>
<p>Height in cm per chart entry, for all static plots.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_multiplier_per_facet">plot_height_multiplier_per_facet</code></td>
<td>
<p><em>Plot height multiplier per facet</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>0.95</code> (<code>optional</code>)
</p>
<p>Multiplier for plot height per facet. Defaults to optimal at .95, i.e. slightly less than no change (1).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_multiplier_per_legend_line">plot_height_multiplier_per_legend_line</code></td>
<td>
<p><em>Plot height multiplier per legend line</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>1.1</code> (<code>optional</code>)
</p>
<p>Multiplier for plot height per horizontal line of legend.
Defaults to optimal at 1.1, i.e. slightly more than no change (1).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_fixed_constant">plot_height_fixed_constant</code></td>
<td>
<p><em>Height constant addition</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>0</code>
</p>
<p>Fixed height in cm to add to all static plots.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_max">plot_height_max</code></td>
<td>
<p><em>Maximum plot height</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>10</code> (<code>optional</code>)
</p>
<p>Maximum height for the plot.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_plot_height_min">plot_height_min</code></td>
<td>
<p><em>Minimum plot height</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>2</code> (<code>optional</code>)
</p>
<p>Minimum height for the plot.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_vertical_height">vertical_height</code></td>
<td>
<p><em>Vertical height</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Height for vertical layout of plot? NEEDS CHECKING</p>
</td></tr>
<tr><td><code id="draft_report_+3A_vertical">vertical</code></td>
<td>
<p><em>Orientation of plots</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>If FALSE (default), then horizontal plots.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_png_scale">png_scale</code></td>
<td>
<p><em>PNG scale</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>1</code> (<code>optional</code>)
</p>
<p>Scale factor for PNG output.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_png_width">png_width</code>, <code id="draft_report_+3A_png_height">png_height</code></td>
<td>
<p><em>PNG width and height</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;double&gt;&#8288;</code> // <em>default:</em> <code>12</code> (<code>optional</code>)
</p>
<p>Width for PNG output.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_font_family">font_family</code></td>
<td>
<p><em>Font family</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"sans"</code> (<code>optional</code>)
</p>
<p>Word font family. See officer::fp_text.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_colour_palette_nominal">colour_palette_nominal</code>, <code id="draft_report_+3A_colour_palette_ordinal">colour_palette_ordinal</code></td>
<td>
<p><em>Colour palettes (nominal and ordinal)</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Must contain at least the number of unique values (including missing) in the data set.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_colour_na">colour_na</code></td>
<td>
<p><em>Colour for NA category</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Colour as a single string for NA values.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_colour_2nd_binary_cat">colour_2nd_binary_cat</code></td>
<td>
<p><em>Colour for second binary category</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"#ffffff"</code> (<code>optional</code>)
</p>
<p>Colour for second category in binary variables. Often useful to hide this.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_table_main_question_as_header">table_main_question_as_header</code></td>
<td>
<p><em>Table main question as header</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to include the main question as a header in the table.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_max_width_obj">max_width_obj</code></td>
<td>
<p><em>Maximum object width</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Maximum width for object names in the Quarto script. In particular useful
when having label as part of the structure.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_max_width_file">max_width_file</code></td>
<td>
<p><em>Maximum filename width</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Maximum width for any filename. Due to OneDrive having a max path of about
400 characters, this can quickly be exceeded with a long path base path,
long file names if using labels as part of structure, and hashing with
Quarto's <code>cache: true</code> feature. This argument truncates the filenames.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_max_clean_folder_name">max_clean_folder_name</code></td>
<td>
<p><em>Maximum clean folder name length</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Whereas <code>max_width_file</code> truncates the file name, this argument truncates
the folder name. It will not impact the report or chapter names in website,
only the folders.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_open_after_drafting">open_after_drafting</code></td>
<td>
<p><em>Whether to open index.qmd</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to open the main output file (index.qmd) after completion.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_organize_by">organize_by</code></td>
<td>
<p><em>Grouping columns</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Column names used for identifying chapters and sections.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_arrange_output_by">arrange_output_by</code></td>
<td>
<p><em>Grouping columns</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Column names used for sorting output within each organize_by group</p>
</td></tr>
<tr><td><code id="draft_report_+3A_ignore_heading_for_group">ignore_heading_for_group</code></td>
<td>
<p><em>Ignore heading for group</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Type of refined chapter_overview data for which to suppress the heading
in the report output. Typically variable_name_dep, variable_name_indep, etc.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_replace_heading_for_group">replace_heading_for_group</code></td>
<td>
<p><em>Replacing heading for group</em>
</p>
<p><code style="white-space: pre;">&#8288;named vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>c(".variable_label_suffix_dep" = ".variable_name_dep")</code>
</p>
<p>Occasionally, one needs to replace the heading with another piece of information
in the refined chapter_overview. For instance, one may want to organize output
by variable_name_indep, but to display the variable_label_indep instead. Use
the name for the replacement and the value for the original.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_mesos_first">mesos_first</code></td>
<td>
<p><em>mesos first</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to place the mesos group element before or after the entire sample.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_descend">descend</code></td>
<td>
<p><em>Sorting order</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Reverse sorting of <code>sort_by</code>.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_require_common_categories">require_common_categories</code></td>
<td>
<p><em>Check common categories</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Whether to check if all items share common categories.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_panel_tabset_mesos">panel_tabset_mesos</code></td>
<td>
<p><em>mesos panel tabset</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code> (<code>optional</code>)
</p>
<p>Whether in mesos reports the comparison group should be displayed as
a Quarto panel tabset (<code>TRUE</code>), or above each other (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_pdf">pdf</code></td>
<td>
<p><em>Create PDF of full report?</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to create a PDF of the entire report (all chapters included in a single file).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_attach_chapter_dataset">attach_chapter_dataset</code></td>
<td>
<p><em>Toggle inclusion of chapter-specific datasets in qmd-files</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code>
</p>
<p>Whether to save in each chapter folder an 'Rds'-file with the
chapter-specific dataset, and load it at the top of each QMD-file.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_auxiliary_variables">auxiliary_variables</code></td>
<td>
<p><em>Auxiliary variables to be included in datasets</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Column names in <code>data</code> that should always be included in datasets for
chapter qmd-files, if <code>attach_chapter_dataset=TRUE</code>. Not publicly available.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_flexi">flexi</code></td>
<td>
<p><em>Create page with user-editable categorical plots and tables</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to create a folder with a Shiny flexi app containing all the
variables in the chapter_overview and auxiliary_variables.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_micro">micro</code></td>
<td>
<p><em>Create page with raw data (micro data) and codebook</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Whether to a page with local links to a raw dataset (in various formats) and codebook (in various formats).</p>
</td></tr>
<tr><td><code id="draft_report_+3A_reps">reps</code></td>
<td>
<p><em>Number of permutations</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>100</code> (<code>optional</code>)
</p>
<p>Number of permutations to be performed in bootstrap significance tests.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_information">information</code></td>
<td>
<p><em>Pre-computed information</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Which pre-computed information for each variable-category to display.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_contents">contents</code></td>
<td>
<p><em>Text interpretations</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> all available (<code>optional</code>)
</p>
<p>The type of text interpretations to return.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_include_numbers">include_numbers</code></td>
<td>
<p><em>Include numbers</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Whether or not to include the actual numbers in parentheses.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_n_top_bottom">n_top_bottom</code></td>
<td>
<p><em>Top and bottom entries to report</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;integer&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>The number of top and bottom entries to report.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_log_file">log_file</code></td>
<td>
<p><em>Path to log file</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;string&gt;&#8288;</code> // <em>default:</em> <code>"_log.txt"</code> (<code>optional</code>)
</p>
<p>Path to log file. Set to NULL to disable logging.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_serialized_format">serialized_format</code></td>
<td>
<p><em>Serialized format</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;string&gt;&#8288;</code> // <em>default:</em> <code>"rds"</code>
</p>
<p>Format for serialized data. One of <code>"rds"</code> (default), <code>"qs"</code> or <code>"fst"</code>.
The latter two requires the respective packages to be installed.
qs is usually the fastest and most space efficient, but sets package
dependencies on the report.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_tabular_format">tabular_format</code></td>
<td>
<p><em>Serialized format</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;string&gt;&#8288;</code> // <em>default:</em> <code>"delim"</code>
</p>
<p>Format for pretty tabular data, meant for end-user to peruse and will be
linked to in reports (the graph data, etc). One of <code>"delim"</code> (tab-separated delim-files)
<code>"xlsx"</code> requires <code>writexl</code>-package), <code>"csv"</code> or <code>"csv2"</code> (requires <code>readr</code>-package.
<code>"dta"</code> or <code>"sav"</code> requires <code>haven</code>-package. Currently must be specified,
in the future this will become an optional argument.</p>
</td></tr>
<tr><td><code id="draft_report_+3A_translations">translations</code></td>
<td>
<p><em>Translations</em>
</p>
<p><code>list</code> // <em>default:</em> <code>saros:::.saros.env$defaults$translations</code> (<code>optional</code>)
</p>
<p>Named list of strings for translations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function requires at a minimum a dataset (data frame and tibbles are
supported so far). Note that saros treats data as they are stored: numeric,
integer, factor, ordinal, character, and datetime. Currently, only
factor/ordinal and character are implemented. Second, the chapter_overview
must be specified, also as a (small) data frame, with at least the character
columns 'chapter' and 'dep', where the first names the output chapters, and
the 'dep'-column contain comma-separated (alternatively using tidyselect-syntax)
columns in the <code>data</code> which are to be treated as dependent variables.
See <code>chapter_overview</code> for more options.
</p>


<h3>Value</h3>

<p>Path to index qmd-file. If not specified in the yaml_path file, will default to index.qmd.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
index_filepath &lt;-
 draft_report(
    chapter_overview = ex_survey_ch_overview,
    data = ex_survey,
    path = tempdir())
index_filepaths &lt;-
  draft_report(
   chapter_overview = ex_survey_ch_overview,
   data = ex_survey,
   mesos_report = TRUE,
   mesos_var = "f_uni",
   path = tempdir())

</code></pre>

<hr>
<h2 id='embed_cat_freq_plot'>Embed Interactive Categorical Plot</h2><span id='topic+embed_cat_freq_plot'></span>

<h3>Description</h3>

<p>Embed Interactive Categorical Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_freq_plot(
  data,
  ...,
  dep = tidyselect::everything(),
  indep = NULL,
  colour_palette = NULL,
  mesos_group = NULL,
  html_interactive = TRUE,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_freq_plot_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_dep">dep</code>, <code id="embed_cat_freq_plot_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_colour_palette">colour_palette</code></td>
<td>
<p>Character vector of colour codes.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_html_interactive">html_interactive</code></td>
<td>
<p><em>Toggle interactive plot</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code> (<code>optional</code>)
</p>
<p>Whether plot is to be interactive (ggiraph) or static (ggplot2).</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
embed_cat_freq_plot(data = ex_survey, dep = b_1:b_3)

</code></pre>

<hr>
<h2 id='embed_cat_freq_plot_docx'>Create Word Report with Univariates for Categorical Columns Sharing Same Categories</h2><span id='topic+embed_cat_freq_plot_docx'></span>

<h3>Description</h3>

<p>Create Word Report with Univariates for Categorical Columns Sharing Same Categories
</p>
<p>Create Word Report with Univariates for Categorical Columns Sharing Same Categories
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_freq_plot_docx(
  data,
  ...,
  inverse = FALSE,
  dep = tidyselect::everything(),
  indep = NULL,
  colour_palette = NULL,
  mesos_group = NULL,
  call = rlang::caller_env()
)

embed_cat_freq_plot_docx(
  data,
  ...,
  inverse = FALSE,
  dep = tidyselect::everything(),
  indep = NULL,
  colour_palette = NULL,
  mesos_group = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_dep">dep</code>, <code id="embed_cat_freq_plot_docx_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_colour_palette">colour_palette</code></td>
<td>
<p>Character vector of colour codes.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_freq_plot_docx_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rdocx object, which can be saved with print() after loading the officer-package
</p>
<p>rdocx object, which can be saved with print() after loading the officer-package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer) # To save the rdocx object to disk

test_docx_b13 &lt;-
   ex_survey |&gt;
   embed_cat_freq_plot_docx(dep = b_1:b_3,
              showNA = "never",
              descend = TRUE,
              return_raw = FALSE,
              hide_label_if_prop_below=0,
              data_label = "count",
              data_label_decimal_symbol = ",",
              digits = 1,
              label_font_size = 12,
              main_font_size = 12,
             plot_height_multiplier = .3,
             plot_height_fixed_constant = 1,
              vertical = FALSE,
              font_family = "sans")
print(test_docx_b13, target = tempfile(fileext = ".docx"))
library(officer) # To save the rdocx object to disk

test_docx_b13 &lt;-
   ex_survey |&gt;
   embed_cat_freq_plot_docx(dep = b_1:b_3,
              showNA = "never",
              descend = TRUE,
              return_raw = FALSE,
              hide_label_if_prop_below=0,
              data_label = "count",
              data_label_decimal_symbol = ",",
              digits = 1,
              label_font_size = 12,
              main_font_size = 12,
             plot_height_multiplier = .3,
             plot_height_fixed_constant = 1,
              vertical = FALSE,
              font_family = "sans")
print(test_docx_b13, target = tempfile(fileext = ".docx"))
</code></pre>

<hr>
<h2 id='embed_cat_prop_plot'>Embed Interactive Categorical Plot</h2><span id='topic+embed_cat_prop_plot'></span>

<h3>Description</h3>

<p>Embed Interactive Categorical Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_prop_plot(
  data,
  ...,
  dep = tidyselect::everything(),
  indep = NULL,
  colour_palette = NULL,
  mesos_group = NULL,
  html_interactive = TRUE,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_prop_plot_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_dep">dep</code>, <code id="embed_cat_prop_plot_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_colour_palette">colour_palette</code></td>
<td>
<p>Character vector of colour codes.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_html_interactive">html_interactive</code></td>
<td>
<p><em>Toggle interactive plot</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code> (<code>optional</code>)
</p>
<p>Whether plot is to be interactive (ggiraph) or static (ggplot2).</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
embed_cat_prop_plot(data = ex_survey, dep = b_1:b_3)

</code></pre>

<hr>
<h2 id='embed_cat_prop_plot_docx'>Create Word Report with Univariates for Categorical Columns Sharing Same Categories</h2><span id='topic+embed_cat_prop_plot_docx'></span>

<h3>Description</h3>

<p>Create Word Report with Univariates for Categorical Columns Sharing Same Categories
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_prop_plot_docx(
  data,
  ...,
  dep = tidyselect::everything(),
  indep = NULL,
  colour_palette = NULL,
  mesos_group = NULL,
  plot_height = 15,
  inverse = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_dep">dep</code>, <code id="embed_cat_prop_plot_docx_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_colour_palette">colour_palette</code></td>
<td>
<p>Character vector of colour codes.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_plot_height">plot_height</code></td>
<td>
<p>Fixed height of the plot in cm. Defaults to 15.</p>
</td></tr>
<tr><td><code id="embed_cat_prop_plot_docx_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>rdocx object, which can be saved with print() after loading the officer-package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(officer) # To save the rdocx object to disk

test_docx_b13 &lt;-
   ex_survey |&gt;
   embed_cat_prop_plot_docx(dep = b_1:b_3,
              showNA = "never",
              descend = TRUE,
              return_raw = FALSE,
              hide_label_if_prop_below=0,
              data_label = "percentage_bare",
              data_label_decimal_symbol = ",",
              digits = 1,
              label_font_size = 12,
              main_font_size = 12,
             plot_height_multiplier = .3,
             plot_height_fixed_constant = 1,
              vertical = FALSE,
              font_family = "sans")
print(test_docx_b13, target = tempfile(fileext = ".docx"))
</code></pre>

<hr>
<h2 id='embed_cat_table'>Embed Reactable Table</h2><span id='topic+embed_cat_table'></span>

<h3>Description</h3>

<p>Embed Reactable Table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_table(
  data,
  ...,
  dep = tidyselect::everything(),
  indep = NULL,
  mesos_group = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_table_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_table_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_table_+3A_dep">dep</code>, <code id="embed_cat_table_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_table_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_table_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A reactable object. If return_raw=FALSE, then just the table.
</p>

<hr>
<h2 id='embed_cat_text_html'>Creates a structured list with text interpretations for a set of variables.</h2><span id='topic+embed_cat_text_html'></span>

<h3>Description</h3>

<p>Creates a structured list with text interpretations for a set of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_cat_text_html(
  data,
  dep = NULL,
  indep = NULL,
  ...,
  mesos_group = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_cat_text_html_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_cat_text_html_+3A_dep">dep</code>, <code id="embed_cat_text_html_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_cat_text_html_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_cat_text_html_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_cat_text_html_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List
</p>


<h3>Examples</h3>

<pre><code class='language-R'>embed_cat_text_html(ex_survey,
dep = tidyselect::matches("e_"),
contents = c("intro", "mode_max", "value_max",
"value_min", "not_used_category", "mean_max", "mean_min"),
label_separator = " - ",
require_common_categories = FALSE,
n_top_bottom = 1,
showNA = "never",
descend = TRUE,
return_raw = TRUE,
hide_label_if_prop_below=0,
data_label = "count",
data_label_decimal_symbol = ",",
digits = 1)

</code></pre>

<hr>
<h2 id='embed_chr_table_html'>Interactive table of text data</h2><span id='topic+embed_chr_table_html'></span>

<h3>Description</h3>

<p>Interactive table of text data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_chr_table_html(
  data,
  dep = colnames(data),
  ...,
  mesos_group = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_chr_table_html_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_chr_table_html_+3A_dep">dep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for by.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="embed_chr_table_html_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_chr_table_html_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="embed_chr_table_html_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>

<hr>
<h2 id='embed_sigtest'>Test Significance Based on Randomization Theory</h2><span id='topic+embed_sigtest'></span>

<h3>Description</h3>

<p>Test Significance Based on Randomization Theory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>embed_sigtest(data, chapter_overview, ..., call = rlang::caller_env())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="embed_sigtest_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="embed_sigtest_+3A_chapter_overview">chapter_overview</code></td>
<td>
<p><em>What goes in each chapter</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>Data frame (or tibble, possibly grouped). One row per chapter. Should
contain the columns 'chapter' and 'dep', Optionally 'indep' (independent
variables) and other informative columns as needed.</p>
</td></tr>
<tr><td><code id="embed_sigtest_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="embed_sigtest_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame
</p>

<hr>
<h2 id='ex_survey'>ex_survey: Mockup dataset of a survey.</h2><span id='topic+ex_survey'></span>

<h3>Description</h3>

<p>A dataset containing fake respondents' answers to survey questions.
The first two, x_sex and x_human, are intended to be independent variables,
whereas the remaining are dependent. The underscore _ in variable names
separates item groups (prefix) from items (suffix) (i.e. a_1-a_9 =&gt; a + 1-9),
whereas ' - ' separates the same for labels.
The latter corresponds with the default in SurveyXact.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_survey
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 rows and 29 variables:
</p>

<dl>
<dt>x1_sex</dt><dd><p>Gender</p>
</dd>
<dt>x2_human</dt><dd><p>Is respondent human?</p>
</dd>
<dt>x3_nationality</dt><dd><p>Where is the respondent born?</p>
</dd>
<dt>a_1</dt><dd><p>Do you consent to the following? - Agreement #1</p>
</dd>
<dt>a_2</dt><dd><p>Do you consent to the following? - Agreement #2</p>
</dd>
<dt>a_3</dt><dd><p>Do you consent to the following? - Agreement #3</p>
</dd>
<dt>a_4</dt><dd><p>Do you consent to the following? - Agreement #4</p>
</dd>
<dt>a_5</dt><dd><p>Do you consent to the following? - Agreement #5</p>
</dd>
<dt>a_6</dt><dd><p>Do you consent to the following? - Agreement #6</p>
</dd>
<dt>a_7</dt><dd><p>Do you consent to the following? - Agreement #7</p>
</dd>
<dt>a_8</dt><dd><p>Do you consent to the following? - Agreement #8</p>
</dd>
<dt>a_9</dt><dd><p>Do you consent to the following? - Agreement #9</p>
</dd>
<dt>b_1</dt><dd><p>How much do you like living in - Beijing</p>
</dd>
<dt>b_2</dt><dd><p>How much do you like living in - Brussels</p>
</dd>
<dt>b_3</dt><dd><p>How much do you like living in - Budapest</p>
</dd>
<dt>c_1</dt><dd><p>How many years of experience do you have in - Company A</p>
</dd>
<dt>c_2</dt><dd><p>How many years of experience do you have in - Company B</p>
</dd>
<dt>d_1</dt><dd><p>Rate your degree of confidence doing the following - Driving</p>
</dd>
<dt>d_2</dt><dd><p>Rate your degree of confidence doing the following - Drinking</p>
</dd>
<dt>d_3</dt><dd><p>Rate your degree of confidence doing the following - Driving</p>
</dd>
<dt>d_4</dt><dd><p>Rate your degree of confidence doing the following - Dancing</p>
</dd>
<dt>e_1</dt><dd><p>How often do you do the following? - Eat</p>
</dd>
<dt>e_2</dt><dd><p>How often do you do the following? - Eavesdrop</p>
</dd>
<dt>e_3</dt><dd><p>How often do you do the following? - Exercise</p>
</dd>
<dt>e_4</dt><dd><p>How often do you do the following? - Encourage someone whom you have only recently met and who struggles with simple tasks that they cannot achieve by themselves</p>
</dd>
<dt>p_1</dt><dd><p>To what extent do you agree or disagree to the
following policies - Red Party</p>
</dd>
<dt>p_2</dt><dd><p>To what extent do you agree or disagree to the
following policies - Green Party</p>
</dd>
<dt>p_3</dt><dd><p>To what extent do you agree or disagree to the
following policies - Yellow Party</p>
</dd>
<dt>p_4</dt><dd><p>To what extent do you agree or disagree to the
following policies - Blue Party</p>
</dd>
<dt>f_uni</dt><dd><p>Which of the following universities would you
prefer to study at?</p>
</dd>
<dt>open_comments</dt><dd><p>Do you have any comments to the survey?</p>
</dd>
<dt>resp_status</dt><dd><p>Response status</p>
</dd>
</dl>


<hr>
<h2 id='ex_survey_ch_overview'>ex_survey_ch_overview: Mock overview of chapter structure</h2><span id='topic+ex_survey_ch_overview'></span>

<h3>Description</h3>

<p>Note that only chapter and dep are compulsory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ex_survey_ch_overview
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 rows (chapters) and 5 variables:
</p>

<dl>
<dt>chapter</dt><dd><p>Manual entry chapter title</p>
</dd>
<dt>author</dt><dd><p>Single or multiple authors, separated by comma</p>
</dd>
<dt>dep</dt><dd><p>Columns in ex_survey having the role of dependent variable</p>
</dd>
<dt>indep</dt><dd><p>Columns in ex_survey having the role of independent variable</p>
</dd>
<dt>irrelevant_col</dt><dd><p>Just a column about something else to verify that the system works also with superfluous information.</p>
</dd>
</dl>


<hr>
<h2 id='filename_sanitizer'>File/folder name sanitizer replacing space and punctuation with underscore</h2><span id='topic+filename_sanitizer'></span>

<h3>Description</h3>

<p>File/folder name sanitizer replacing space and punctuation with underscore
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filename_sanitizer(x, max_chars = NA_integer_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filename_sanitizer_+3A_x">x</code></td>
<td>
<p>Character vector of file/folder names</p>
</td></tr>
<tr><td><code id="filename_sanitizer_+3A_max_chars">max_chars</code></td>
<td>
<p>Maximum character length</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of same length as x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filename_sanitizer(c("Too long a name", "with invalid *^/&amp;#"))
</code></pre>

<hr>
<h2 id='gen_element_and_qmd_snippet2'>Mass Create Elements of A Certain Type</h2><span id='topic+gen_element_and_qmd_snippet2'></span>

<h3>Description</h3>

<p>Mass Create Elements of A Certain Type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_element_and_qmd_snippet2(
  chapter_overview_section,
  data,
  mesos_group = NULL,
  chapter_folderpath_absolute,
  chapter_foldername,
  element_folderpath_absolute,
  element_folderpath_relative,
  grouping_structure = NULL,
  ...,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_chapter_overview_section">chapter_overview_section</code></td>
<td>
<p><em>Overview of chapter section</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>Data frame (or tibble, possibly grouped). Must contain column 'dep'
with similar items. See <code>draft_report()</code>.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_element_folderpath_absolute">element_folderpath_absolute</code>, <code id="gen_element_and_qmd_snippet2_+3A_element_folderpath_relative">element_folderpath_relative</code></td>
<td>
<p><em>Absolute and relative folder paths</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // Required
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_grouping_structure">grouping_structure</code></td>
<td>
<p><em>Vector of groups</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>Optional</code>)
</p>
<p>Internal usage.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="gen_element_and_qmd_snippet2_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list of elements, where each element can UNFINISHED.
</p>

<hr>
<h2 id='gen_qmd_chapters'>Generate A Quarto Survey Report</h2><span id='topic+gen_qmd_chapters'></span>

<h3>Description</h3>

<p>This function generates a Quarto survey report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_qmd_chapters(
  chapter_overview,
  data,
  mesos_group = NULL,
  ...,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_qmd_chapters_+3A_chapter_overview">chapter_overview</code></td>
<td>
<p><em>What goes in each chapter</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>Data frame (or tibble, possibly grouped). One row per chapter. Should
contain the columns 'chapter' and 'dep', Optionally 'indep' (independent
variables) and other informative columns as needed.</p>
</td></tr>
<tr><td><code id="gen_qmd_chapters_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="gen_qmd_chapters_+3A_mesos_group">mesos_group</code></td>
<td>
<p><em>Specific group to compare with</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>Default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
<tr><td><code id="gen_qmd_chapters_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="gen_qmd_chapters_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A report consists of multiple chapters and an index file that merges them together.
A chapter can contain any user-defined set of dependent, independent or bivariate variable sets.
A chapter consists of multiple sections.
A section is defined as a group in the chapter_overview (ignoring the chapter grouping level) containing variables of the same type, meaning at a minimum that the variables in the section sharing the same response options, the same main question, and being of the same data type.
</p>


<h3>Value</h3>

<p>A Quarto survey report generated in the specified working directory.
</p>

<hr>
<h2 id='gen_qmd_index'>Generate Quarto Index File That Merges All Chapters</h2><span id='topic+gen_qmd_index'></span>

<h3>Description</h3>

<p>This function creates an index Quarto file (QMD) that merges all chapters in the specified order. It can also include optional title and author(s) information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_qmd_index(
  index_filepath = "index.qmd",
  ...,
  chapter_filepaths = NULL,
  report_filepath = NULL,
  yaml_file = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gen_qmd_index_+3A_index_filepath">index_filepath</code></td>
<td>
<p>Path to the output index.qmd file. Defaults to &quot;complete_report.qmd&quot;</p>
</td></tr>
<tr><td><code id="gen_qmd_index_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="gen_qmd_index_+3A_chapter_filepaths">chapter_filepaths</code></td>
<td>
<p>A character vector containing the filepaths of the chapter files to be included in the index, in the desired order.</p>
</td></tr>
<tr><td><code id="gen_qmd_index_+3A_report_filepath">report_filepath</code></td>
<td>
<p>A string containing the filepath to the report.qmd.</p>
</td></tr>
<tr><td><code id="gen_qmd_index_+3A_yaml_file">yaml_file</code></td>
<td>
<p>A string containing the filepath to a yaml-file to be inserted at top of qmd-file.</p>
</td></tr>
<tr><td><code id="gen_qmd_index_+3A_call">call</code></td>
<td>
<p>Internal call argument. Not to be fiddled with by the user.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string containing the filepath to the generated Quarto index file.
</p>

<hr>
<h2 id='get_colour_palette'>Provide A Colour Set for A Number of Requested Colours</h2><span id='topic+get_colour_palette'></span>

<h3>Description</h3>

<p>Possibly using colour_palette_nominal if available. If not sufficient, uses a set
palette from RColorBrewer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_colour_palette(
  data,
  col_pos,
  colour_palette_nominal = NULL,
  colour_palette_ordinal = NULL,
  colour_na = NULL,
  categories_treated_as_na = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_colour_palette_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="get_colour_palette_+3A_col_pos">col_pos</code></td>
<td>
<p>Character vector of column names for which colours will be found.</p>
</td></tr>
<tr><td><code id="get_colour_palette_+3A_colour_palette_nominal">colour_palette_nominal</code>, <code id="get_colour_palette_+3A_colour_palette_ordinal">colour_palette_ordinal</code></td>
<td>
<p><em>User specified colour set</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>User-supplied default palette, excluding <code>colour_na</code>.</p>
</td></tr>
<tr><td><code id="get_colour_palette_+3A_colour_na">colour_na</code></td>
<td>
<p><em>Colour for NA category</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Colour as a single string for NA values.</p>
</td></tr>
<tr><td><code id="get_colour_palette_+3A_categories_treated_as_na">categories_treated_as_na</code></td>
<td>
<p><em>NA categories</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Categories that should be treated as NA.</p>
</td></tr>
<tr><td><code id="get_colour_palette_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour set as character vector, where <code>NA</code> has the <code>colour_na</code>, and the rest are taken from colour_palette_nominal if available.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_colour_palette(ex_survey, col_pos=c("b_1", "b_2"))
get_colour_palette(ex_survey, col_pos=c("b_1", "b_2"),
                  colour_palette_nominal = c("red", "blue", "orange"))
</code></pre>

<hr>
<h2 id='get_colour_set'>Provide A Colour Set for A Number of Requested Colours</h2><span id='topic+get_colour_set'></span>

<h3>Description</h3>

<p>Possibly using colour_palette_nominal if available. If not sufficient, uses a set
palette from RColorBrewer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_colour_set(
  x,
  common_data_type = "factor",
  colour_palette_nominal = NULL,
  colour_palette_ordinal = NULL,
  colour_na = NULL,
  colour_2nd_binary_cat = NULL,
  ordinal = FALSE,
  categories_treated_as_na = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_colour_set_+3A_x">x</code></td>
<td>
<p>Vector for which colours will be found.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_common_data_type">common_data_type</code></td>
<td>
<p><em>factor or ordered data type</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>factor</code> (<code>optional</code>)
</p>
<p>Currently only supports factor and ordered.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_colour_palette_nominal">colour_palette_nominal</code>, <code id="get_colour_set_+3A_colour_palette_ordinal">colour_palette_ordinal</code></td>
<td>
<p><em>User specified colour set</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>User-supplied default palette, excluding <code>colour_na</code>.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_colour_na">colour_na</code></td>
<td>
<p><em>Colour for NA category</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Colour as a single string for NA values.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_colour_2nd_binary_cat">colour_2nd_binary_cat</code></td>
<td>
<p><em>Colour for second binary category</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // <em>default:</em> <code>"#ffffff"</code> (<code>optional</code>)
</p>
<p>Colour for second category in binary variables. Often useful to hide this.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_ordinal">ordinal</code></td>
<td>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>FALSE</code> (<code>optional</code>)
</p>
<p>Is palette ordinal?</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_categories_treated_as_na">categories_treated_as_na</code></td>
<td>
<p><em>NA categories</em>
</p>
<p><code style="white-space: pre;">&#8288;vector&lt;character&gt;&#8288;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)
</p>
<p>Categories that should be treated as NA.</p>
</td></tr>
<tr><td><code id="get_colour_set_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A colour set as character vector, where <code>NA</code> has the <code>colour_na</code>, and the rest are taken from colour_palette_nominal if available.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_colour_set(x=1:4)
</code></pre>

<hr>
<h2 id='get_data_label_opts'>Get Valid Data Labels for Figures and Tables</h2><span id='topic+get_data_label_opts'></span>

<h3>Description</h3>

<p>Get Valid Data Labels for Figures and Tables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_label_opts()
</code></pre>


<h3>Value</h3>

<p>Character vector
</p>

<hr>
<h2 id='handpick'>Return character vector of manually picked data columns.</h2><span id='topic+handpick'></span>

<h3>Description</h3>

<p>Only works in an interactive session. Copies to the clipboard if to_clipboard = TRUE, and if clipboard is available on system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>handpick(data, to_clipboard = FALSE, bare = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="handpick_+3A_data">data</code></td>
<td>
<p>A dataset; data frame.</p>
</td></tr>
<tr><td><code id="handpick_+3A_to_clipboard">to_clipboard</code></td>
<td>
<p>Boolean. Defaults to FALSE. If TRUE, overwrites what you already have copied. Use with caution.</p>
</td></tr>
<tr><td><code id="handpick_+3A_bare">bare</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, returns a tidyselect-style bare list of columns, without quotation marks.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector. Prints to console.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()) handpick(mtcars)
</code></pre>

<hr>
<h2 id='hex_bw'>Identify Suitable Font Given Background Hex Colour</h2><span id='topic+hex_bw'></span>

<h3>Description</h3>

<p>Code is taken from XXX.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hex_bw(hex_code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hex_bw_+3A_hex_code">hex_code</code></td>
<td>
<p>Colour in hex-format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Colours in hex-format, either black or white.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hex_bw("#0dadfd")
</code></pre>

<hr>
<h2 id='is_colour'>Are All Colours in Vector Valid Colours</h2><span id='topic+is_colour'></span>

<h3>Description</h3>

<p>As title says. From: (https://stackoverflow.com/a/13290832/3315962)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_colour(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_colour_+3A_x">x</code></td>
<td>
<p>Character vector of colours in hex-format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical, or error.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is_colour(c("#ff00ff", "#010101"))
</code></pre>

<hr>
<h2 id='list_available_element_types'>List All Valid Names of The Elements Argument</h2><span id='topic+list_available_element_types'></span>

<h3>Description</h3>

<p>List All Valid Names of The Elements Argument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_available_element_types(valid_only = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_available_element_types_+3A_valid_only">valid_only</code></td>
<td>
<p>Only return implemented elements, or all (planned) elements.
Note that *_docx-elements have limited storage support and
are hence not included in examples in this package as minor (unimportant) warnings will occur.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of valid names.
</p>

<hr>
<h2 id='omitted_recoder_df'>Recode Missing By Type of Missingness</h2><span id='topic+omitted_recoder_df'></span>

<h3>Description</h3>

<p>Useful for item difficulty estimation according to Mislevy's recommendation.
Also allowing for escaping rows with all missingess (typically
not administered).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omitted_recoder_df(
  df,
  accept_vector = FALSE,
  skipped = 0L,
  not_administered = NA_integer_,
  all_missing = NA_integer_
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omitted_recoder_df_+3A_df">df</code></td>
<td>
<p>Data frame, or vector. Must be a dataframe, not a matrix, in this
function. Only include item variables.</p>
</td></tr>
<tr><td><code id="omitted_recoder_df_+3A_accept_vector">accept_vector</code></td>
<td>
<p>Handles vectors if accept_vector=TRUE. Set to false to
avoid accidents when using function per block and there is just one item in
the block.</p>
</td></tr>
<tr><td><code id="omitted_recoder_df_+3A_skipped">skipped</code></td>
<td>
<p>What to replace skipped values with</p>
</td></tr>
<tr><td><code id="omitted_recoder_df_+3A_not_administered">not_administered</code></td>
<td>
<p>What to replace not administered values with.</p>
</td></tr>
<tr><td><code id="omitted_recoder_df_+3A_all_missing">all_missing</code></td>
<td>
<p>What to replace values in rows with all missing with.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame (or vector, if input is vector and accept_vector=TRUE)
with recoded cells.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Original data
input &lt;- stats::setNames(as.data.frame(matrix(c(
	1,0,1,0,1, # All present
	NA,0,1,0,1, # First missing
	NA,NA,1,0,1, # First two missing
	1,0,NA,0,1, # One in middle missing
	1,NA,NA,NA,1, # All in the middle missing
	1,0,1,0,NA, # Last one missing
	1,0,1,NA,NA, # Last two missing
	1,0,NA,NA,NA, # Last three missing
	NA,NA,NA,NA,NA # All missing
), nrow = 9, byrow = TRUE)), nm=stringi::stri_c(ignore_null=TRUE, "X", 1:5))
# What should be the output for item estimation according to Mislevy
# Skipped=&gt; 0, not_administered=&gt;NA, all_missing=&gt;NA
y_i &lt;-  stats::setNames(as.data.frame(matrix(c(
	1,0,1,0,1, # All present
	0,0,1,0,1, # First missing
	0,0,1,0,1, # First two missing
	1,0,0,0,1, # One in middle missing
	1,0,0,0,1, # All in the middle missing
	1,0,1,0,0, # Last one missing
	1,0,1,0,NA, # Last two missing
	1,0,0,NA,NA, # Last three missing
	NA,NA,NA,NA,NA # All missing
), nrow = 9, byrow = TRUE)), nm=stringi::stri_c(ignore_null=TRUE, "X", 1:5))

# What should be the output for person estimation according to Mislevy
# Skipped=&gt; 0, not_administered=&gt;NA, all_missing=&gt;NA
y_p &lt;- stats::setNames(as.data.frame(matrix(c(
	1,0,1,0,1, # All present
	0,0,1,0,1, # First missing
	0,0,1,0,1, # First two missing
	1,0,0,0,1, # One in middle missing
	1,0,0,0,1, # All in the middle missing
	1,0,1,0,0, # Last one missing
	1,0,1,0,0, # Last two missing
	1,0,0,0,0, # Last three missing
	0,0,0,0,0 # All missing
), nrow = 9, byrow = TRUE)), nm=stringi::stri_c(ignore_null=TRUE, "X", 1:5))
# Recoding for counting skipped, not_administered, all_missing, etc
# Skipped=&gt; 99, not_administered=&gt;999, all_missing=&gt;9999
y_info &lt;- stats::setNames(as.data.frame(matrix(c(
	1,0,1,0,1, # All present
	99,0,1,0,1, # First missing
	99,99,1,0,1, # First two missing
	1,0,99,0,1, # One in middle missing
	1,99,99,99,1, # All in the middle missing
	1,0,1,0,99, # Last one missing
	1,0,1,99,999, # Last two missing
	1,0,99,999,999, # Last three missing
	9999,9999,9999,9999,9999 # All missing
), nrow = 9, byrow = TRUE)), nm=stringi::stri_c(ignore_null=TRUE, "X", 1:5))

y_i2 &lt;- omitted_recoder_df(input) #Mislevy item estimation
y_p2 &lt;- omitted_recoder_df(input, skipped = 0L, #Mislevy person estimation
                           not_administered = 0L, all_missing = 0L)
y_info2 &lt;- omitted_recoder_df(input, skipped = 99,
                              not_administered = 999, all_missing = 9999)
identical(y_i, y_i2)
identical(y_p, y_p2)
identical(y_info, y_info2)
## Not run: 
omitted_recoder_df(input[,4]) # Should fail

## End(Not run)
identical(omitted_recoder_df(input[,4], accept_vector=TRUE),
         c(0,0,0,0,0,0,0,NA,NA))
identical(omitted_recoder_df(input[,4, drop=FALSE]),
          input[,4, drop=FALSE]) # Output should equal input
</code></pre>

<hr>
<h2 id='post_render_docx_img_replacer'>Post-Render All docx-files Found in The Output Folder To Replace Images with Mscharts</h2><span id='topic+post_render_docx_img_replacer'></span>

<h3>Description</h3>

<p>Post-Render All docx-files Found in The Output Folder To Replace Images with Mscharts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_render_docx_img_replacer(
  site_dir = fs::path(Sys.getenv("QUARTO_PROJECT_OUTPUT_DIR"), "reports", "report"),
  site_mesos_dir = fs::path(site_dir, "mesos"),
  chart_dir = fs::path(Sys.getenv("QUARTO_PROJECT_OUTPUT_DIR"), "..", "reports",
    "report"),
  chart_mesos_dir = fs::path(chart_dir, "mesos"),
  delete_mschart_files = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_render_docx_img_replacer_+3A_site_dir">site_dir</code>, <code id="post_render_docx_img_replacer_+3A_site_mesos_dir">site_mesos_dir</code>, <code id="post_render_docx_img_replacer_+3A_chart_dir">chart_dir</code>, <code id="post_render_docx_img_replacer_+3A_chart_mesos_dir">chart_mesos_dir</code></td>
<td>
<p>String. Paths to the site (and mesos subfolder) with the docx files where the images are to be replaced, and paths to where to find the docx files with mscharts to be replaced with can be found.</p>
</td></tr>
<tr><td><code id="post_render_docx_img_replacer_+3A_delete_mschart_files">delete_mschart_files</code></td>
<td>
<p>Flag. Whether to delete the mschart docx files after successful copying into the docx files. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, side-effects only.
</p>

<hr>
<h2 id='prep_cat_freq_plot_docx'>Create Categorical Data Chart from Summarized Data</h2><span id='topic+prep_cat_freq_plot_docx'></span>

<h3>Description</h3>

<p>Create Categorical Data Chart from Summarized Data
</p>
<p>Create Categorical Data Chart from Summarized Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_cat_freq_plot_docx(
  data,
  ...,
  colour_palette = NULL,
  inverse = FALSE,
  call = rlang::caller_env()
)

prep_cat_freq_plot_docx(
  data,
  ...,
  colour_palette = NULL,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_cat_freq_plot_docx_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_docx_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_docx_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_docx_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mschart-object. Can be added to an rdocx, rpptx or rxlsx object.
</p>
<p>mschart-object. Can be added to an rdocx, rpptx or rxlsx object.
</p>

<hr>
<h2 id='prep_cat_freq_plot_html'>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories</h2><span id='topic+prep_cat_freq_plot_html'></span>

<h3>Description</h3>

<p>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_cat_freq_plot_html(
  data,
  ...,
  colour_palette = NULL,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_cat_freq_plot_html_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_html_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_html_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="prep_cat_freq_plot_html_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggiraph object, plottable with plot()
</p>

<hr>
<h2 id='prep_cat_prop_plot_docx'>Create Categorical Data Chart from Summarized Data</h2><span id='topic+prep_cat_prop_plot_docx'></span>

<h3>Description</h3>

<p>Create Categorical Data Chart from Summarized Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_cat_prop_plot_docx(
  data,
  ...,
  colour_palette = NULL,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_cat_prop_plot_docx_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_docx_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_docx_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_docx_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mschart-object. Can be added to an rdocx, rpptx or rxlsx object.
</p>

<hr>
<h2 id='prep_cat_prop_plot_html'>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories</h2><span id='topic+prep_cat_prop_plot_html'></span>

<h3>Description</h3>

<p>Create Single Interactive Categorical Plot with Univariates for Categorical Columns Sharing Same Categories
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_cat_prop_plot_html(
  data,
  ...,
  colour_palette = NULL,
  inverse = FALSE,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prep_cat_prop_plot_html_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_html_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_html_+3A_inverse">inverse</code></td>
<td>
<p>Flag, defaults to FALSE. If TRUE, swaps x-axis and faceting.</p>
</td></tr>
<tr><td><code id="prep_cat_prop_plot_html_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggiraph object, plottable with plot()
</p>

<hr>
<h2 id='prepare_chunk'>Internal function to prepare a chunk for a Quarto report.</h2><span id='topic+prepare_chunk'></span>

<h3>Description</h3>

<p>Internal function to prepare a chunk for a Quarto report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_chunk(element_name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_chunk_+3A_element_name">element_name</code></td>
<td>
<p>The name of the element to be prepared.</p>
</td></tr>
<tr><td><code id="prepare_chunk_+3A_...">...</code></td>
<td>
<p>Dynamic dots passed onto the methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a text string for the chunk, but
also has side-effects for generating files.
</p>

<hr>
<h2 id='prepare_safe_render'>Convenience function to prepare, copy and render website</h2><span id='topic+prepare_safe_render'></span>

<h3>Description</h3>

<p>Rendering a website on a Sharepoint/OneDrive location can be a pain
due to long filepaths above 260 characters, which causes read errors. This
function simplifies things by copying a site from local_basepath to a site_basepath,
sets up basic access authentication files (either Netlify's _headers file or
regular Apache .htaccess/.htpasswd files), as well as optionally copying
in an existing Netlify _publish.yaml-file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_safe_render(
  remote_basepath = "/home/",
  from_folders = NULL,
  from_files = NULL,
  local_basepath,
  site,
  rel_path_base_to_parent_of_user_restricted_folder = "Reports",
  overwrite = FALSE,
  prompt = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_safe_render_+3A_remote_basepath">remote_basepath</code></td>
<td>
<p>String. FTP servers often have a subdomain path location different from &quot;/home/&quot;. Adjust this here.</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_from_folders">from_folders</code>, <code id="prepare_safe_render_+3A_from_files">from_files</code></td>
<td>
<p>Character vector of folders and files to copy into the site path.</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_local_basepath">local_basepath</code></td>
<td>
<p>String. Path to where your QMD-files are located (the site to be rendered).</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_site">site</code></td>
<td>
<p>String. Path to where to copy folders and files to setup what Quarto needs to build a project.</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_rel_path_base_to_parent_of_user_restricted_folder">rel_path_base_to_parent_of_user_restricted_folder</code></td>
<td>
<p>String. Path going from basepath to the folder containing folders to password-protect.</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_overwrite">overwrite</code></td>
<td>
<p>Flag. Defaults to FALSE to ensure you know what you are doing. If TRUE, will delete all files and folders in site!</p>
</td></tr>
<tr><td><code id="prepare_safe_render_+3A_prompt">prompt</code></td>
<td>
<p>Flag. Whether to ask the user if they are certain. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>local_basepath
</p>

<hr>
<h2 id='quarto_render_saros'>Simple wrapper for quarto::quarto_render() that temporarily sets LC_ALL=&quot;C&quot; and takes the processing time</h2><span id='topic+quarto_render_saros'></span>

<h3>Description</h3>

<p>Simple wrapper for quarto::quarto_render() that temporarily sets LC_ALL=&quot;C&quot; and takes the processing time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quarto_render_saros(site_path, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quarto_render_saros_+3A_site_path">site_path</code></td>
<td>
<p>String, path to render.</p>
</td></tr>
<tr><td><code id="quarto_render_saros_+3A_...">...</code></td>
<td>
<p>Dynamic dots forwarded to quarto::quarto_render</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing
</p>

<hr>
<h2 id='read_default_draft_report_args'>Read Default Arguments for <code>draft_report()</code> from YAML-file</h2><span id='topic+read_default_draft_report_args'></span>

<h3>Description</h3>

<p>Read Default Arguments for <code>draft_report()</code> from YAML-file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_default_draft_report_args(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_default_draft_report_args_+3A_path">path</code></td>
<td>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // Required. <em>default:</em> <code>settings.yaml</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The defaults as a <code>yaml</code>-object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- write_default_draft_report_args(path=tempfile(fileext=".yaml"))
read_default_draft_report_args(path=path)
</code></pre>

<hr>
<h2 id='refine_chapter_overview'>Processes A 'chapter_overview' Data Frame</h2><span id='topic+refine_chapter_overview'></span>

<h3>Description</h3>

<p>Processes A 'chapter_overview' Data Frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refine_chapter_overview(
  chapter_overview = NULL,
  data = NULL,
  ...,
  progress = TRUE,
  variable_group_dep = ".variable_group_dep",
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refine_chapter_overview_+3A_chapter_overview">chapter_overview</code></td>
<td>
<p><em>What goes in each chapter</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>Data frame (or tibble, possibly grouped). One row per chapter. Should
contain the columns 'chapter' and 'dep', Optionally 'indep' (independent
variables) and other informative columns as needed.</p>
</td></tr>
<tr><td><code id="refine_chapter_overview_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="refine_chapter_overview_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="refine_chapter_overview_+3A_progress">progress</code></td>
<td>
<p><em>Whether to display progress message</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;logical&gt;&#8288;</code> // <em>default:</em> <code>TRUE</code></p>
</td></tr>
<tr><td><code id="refine_chapter_overview_+3A_variable_group_dep">variable_group_dep</code></td>
<td>
<p><em>Name for the variable_group_dep column</em>
</p>
<p><code style="white-space: pre;">&#8288;scalar&lt;string&gt;&#8288;</code> // <em>default:</em> <code>".variable_group_dep"</code>
</p>
<p>This column is used to group variables that are part of the same bivariate analysis.</p>
</td></tr>
<tr><td><code id="refine_chapter_overview_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Grouped tibble.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ref_df &lt;- refine_chapter_overview(chapter_overview = ex_survey_ch_overview)

ref_df2 &lt;- refine_chapter_overview(chapter_overview = ex_survey_ch_overview,
                     data = ex_survey, hide_bi_entry_if_sig_above=.05)

</code></pre>

<hr>
<h2 id='remove_label_parts'>Remove regex pattern from variable labels</h2><span id='topic+remove_label_parts'></span>

<h3>Description</h3>

<p>Remove regex pattern from variable labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_label_parts(
  data,
  pattern = NULL,
  replacement = "",
  data_type_criterion = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_label_parts_+3A_data">data</code></td>
<td>
<p>Data.frame</p>
</td></tr>
<tr><td><code id="remove_label_parts_+3A_pattern">pattern</code></td>
<td>
<p>String, regex pattern.</p>
</td></tr>
<tr><td><code id="remove_label_parts_+3A_replacement">replacement</code></td>
<td>
<p>String, replacement for pattern.</p>
</td></tr>
<tr><td><code id="remove_label_parts_+3A_data_type_criterion">data_type_criterion</code></td>
<td>
<p>Can be a function that specifies what kind of variables to select, e.g. is.factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>remove_label_parts(ex_survey, pattern = " living in")
</code></pre>

<hr>
<h2 id='remove_special_chars_in_labels'>Remove Special Characters (&lt;,&gt;) in Variable Labels</h2><span id='topic+remove_special_chars_in_labels'></span>

<h3>Description</h3>

<p>Remove Special Characters (&lt;,&gt;) in Variable Labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_special_chars_in_labels(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_special_chars_in_labels_+3A_df">df</code></td>
<td>
<p>Data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='rename_by_labels'>Rename Dataset Columns by Labels.</h2><span id='topic+rename_by_labels'></span>

<h3>Description</h3>

<p>Occasionally dataframe columns have not been named logically and consistent in the
software where the data originates. This function renames variable names
based on patterns in the variable labels, after ignoring some stop words.
</p>
<p>Occasionally dataframe columns have not been named logically and consistent in the
software where the data originates. This function renames variable names
based on patterns in the variable labels, after ignoring some stop words.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rename_by_labels(
  data,
  label_sep = " - ",
  sort_var = c("pos", "variable", "label"),
  new_var_sep = "_",
  stop_words = NULL
)

rename_by_labels(
  data,
  label_sep = " - ",
  sort_var = c("pos", "variable", "label"),
  new_var_sep = "_",
  stop_words = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rename_by_labels_+3A_data">data</code></td>
<td>
<p>Dataset.</p>
</td></tr>
<tr><td><code id="rename_by_labels_+3A_label_sep">label_sep</code></td>
<td>
<p>The separator between group part and unique part of label.</p>
</td></tr>
<tr><td><code id="rename_by_labels_+3A_sort_var">sort_var</code></td>
<td>
<p>When numbering variables within a group, what to sort by? pos is original position in dataset,</p>
</td></tr>
<tr><td><code id="rename_by_labels_+3A_new_var_sep">new_var_sep</code></td>
<td>
<p>When creating new variables, how to glue together variable group name prefix and numbering?</p>
</td></tr>
<tr><td><code id="rename_by_labels_+3A_stop_words">stop_words</code></td>
<td>
<p>Words to ignore in label when abbreviating label to name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data with renamed variable names.
</p>
<p>Data with renamed variable names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rename_by_labels(ex_survey)
rename_by_labels(ex_survey)
</code></pre>

<hr>
<h2 id='render_full_reports'>Post-render rendering of complete reports</h2><span id='topic+render_full_reports'></span>

<h3>Description</h3>

<p>If one wishes to render complete reports that are linked to
in a website, but not listed among the chapters on the sidebar menu,
one can make these with filenames starting with underscores (_) which
will make them not listed in said menu. However, this will also mean they
are not rendered in a Quarto (Website) project. This function, which can
be called within a post-script (see example below), will render only these
after the ordinary rendering of the project, and copied to the _site folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>render_full_reports(
  files = NULL,
  path,
  processable_path = file.path(path, "Reports"),
  site_path = file.path(path, "_site"),
  resource_paths = file.path(path, c("_extensions", "_images")),
  warn_on_file_error = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="render_full_reports_+3A_files">files</code></td>
<td>
<p>Optional character vector of report files (qmd). Can be obtained within a project by <code>Sys.getenv("QUARTO_PROJECT_OUTPUT_FILES")</code></p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_path">path</code></td>
<td>
<p>If no files are given, a path to the root folder of the local &quot;site&quot;.</p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_processable_path">processable_path</code></td>
<td>
<p>Path to where report files can be (recursively) found.</p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_site_path">site_path</code></td>
<td>
<p>Path to _site</p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_resource_paths">resource_paths</code></td>
<td>
<p>Paths to where _extensions and _images folders can be found and copied to wherever needed</p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_warn_on_file_error">warn_on_file_error</code></td>
<td>
<p>If TRUE, will collect warnings if a file fails to render or be copied. If FALSE (default), will stop the rendering process.</p>
</td></tr>
<tr><td><code id="render_full_reports_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>quarto::render()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns invisibly a character vector of processed files.
</p>

<hr>
<h2 id='replace_docx_imgs_with_mscharts'>Replace Images in A Quarto-Generated docx-file with Mschart docx-files</h2><span id='topic+replace_docx_imgs_with_mscharts'></span>

<h3>Description</h3>

<p>Replace Images in A Quarto-Generated docx-file with Mschart docx-files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_docx_imgs_with_mscharts(
  main_file,
  chart_dir = fs::path_ext_remove(main_file),
  delete_mschart_files = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_docx_imgs_with_mscharts_+3A_main_file">main_file</code></td>
<td>
<p>docx file where images are to be replaced with mscharts</p>
</td></tr>
<tr><td><code id="replace_docx_imgs_with_mscharts_+3A_chart_dir">chart_dir</code></td>
<td>
<p>Directory path to where the mscharts as docx files can be found.</p>
</td></tr>
<tr><td><code id="replace_docx_imgs_with_mscharts_+3A_delete_mschart_files">delete_mschart_files</code></td>
<td>
<p>Flag. Whether to delete the mschart docx files after insertion. Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String, path to input file.
</p>

<hr>
<h2 id='replace_stata_labels'>Replace Stata Labels</h2><span id='topic+replace_stata_labels'></span>

<h3>Description</h3>

<p>If no replacement exists, keeps the original.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_stata_labels(
  data,
  df_new_labels,
  var_name_col = "name",
  var_label_col = "vallab_full",
  trim = c("both", "all"),
  overwrite = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_stata_labels_+3A_data">data</code></td>
<td>
<p>data frame for which labels will be replaced</p>
</td></tr>
<tr><td><code id="replace_stata_labels_+3A_df_new_labels">df_new_labels</code></td>
<td>
<p>a data frame with a var_name_col and a var_label_col</p>
</td></tr>
<tr><td><code id="replace_stata_labels_+3A_var_name_col">var_name_col</code>, <code id="replace_stata_labels_+3A_var_label_col">var_label_col</code></td>
<td>
<p>variable names (as strings) for the lookup of variable names in data, and the corresponding variable label.</p>
</td></tr>
<tr><td><code id="replace_stata_labels_+3A_trim">trim</code></td>
<td>
<p>string, trim &quot;both&quot; sides (default), &quot;left&quot; or &quot;right&quot;.</p>
</td></tr>
<tr><td><code id="replace_stata_labels_+3A_overwrite">overwrite</code></td>
<td>
<p>Flag. Whether to remove label if it already exists.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data, with variable labels replaced
</p>

<hr>
<h2 id='sanitize_labels'>Sanitize labels originating from e.g. Qualtrics for use in Saros</h2><span id='topic+sanitize_labels'></span>

<h3>Description</h3>

<p>This function is quite specific to a few problems, users might find it lacking in functionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sanitize_labels(
  data,
  sep = " - ",
  multi_sep_replacement = ": ",
  replace_ascii_with_utf = FALSE,
  questions = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sanitize_labels_+3A_data">data</code></td>
<td>
<p>data.frame or tibble</p>
</td></tr>
<tr><td><code id="sanitize_labels_+3A_sep">sep</code></td>
<td>
<p>String, separates main question from subquestion</p>
</td></tr>
<tr><td><code id="sanitize_labels_+3A_multi_sep_replacement">multi_sep_replacement</code></td>
<td>
<p>String. If multiple sep are found, replace the first ones with this.</p>
</td></tr>
<tr><td><code id="sanitize_labels_+3A_replace_ascii_with_utf">replace_ascii_with_utf</code></td>
<td>
<p>Flag. If TRUE, downloads a list from W3 used to convert html characters as ASCII to UTF8.</p>
</td></tr>
<tr><td><code id="sanitize_labels_+3A_questions">questions</code></td>
<td>
<p>Data frame with questions obtained from <code>qualtRics::survey_questions()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Identical data.frame as input, with only variable labels changed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sanitize_labels(ex_survey)
</code></pre>

<hr>
<h2 id='setup_access_restrictions'>Setup files needed for basic password-based access restriction for website</h2><span id='topic+setup_access_restrictions'></span>

<h3>Description</h3>

<p>Create a _headers file for 'Netlify' publishing or a set of .htaccess and .htpasswd files (FTP)
placed in the specific subfolders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_access_restrictions(
  remote_basepath = "/home/",
  local_basepath,
  rel_path_base_to_parent_of_user_restricted_folder = file.path("Reports", "2022",
    "Mesos"),
  warn = TRUE,
  local_main_password_path = ".main_htpasswd_public",
  username_folder_matching_df = NULL,
  universal_usernames = c("admin"),
  log_rounds = 12,
  append_users = TRUE,
  password_input = "prompt",
  type = c("netlify", "apache")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_access_restrictions_+3A_remote_basepath">remote_basepath</code></td>
<td>
<p>String. Folder where site will be located if using FTP-server. Needed for .htaccess-files.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_local_basepath">local_basepath</code></td>
<td>
<p>String. Local folder for website, typically &quot;_site&quot;.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_rel_path_base_to_parent_of_user_restricted_folder">rel_path_base_to_parent_of_user_restricted_folder</code></td>
<td>
<p>String, relative path from basepath to the folder where the restricted folders are located. (E.g. the &quot;mesos&quot;-folder)</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_warn">warn</code></td>
<td>
<p>Flag. Whether to provide warning or error if paths do not exist.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_local_main_password_path">local_main_password_path</code></td>
<td>
<p>String. Path to main file containing all usernames and passwords formatted with a colon between username and password.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_username_folder_matching_df">username_folder_matching_df</code></td>
<td>
<p>Data frame. If NULL (default), will use folder names as usernames. Otherwise, a data frame with two columns: &quot;folder&quot; and &quot;username&quot; where &quot;folder&quot; is the name of the folder and &quot;username&quot; is the username for that folder.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_universal_usernames">universal_usernames</code></td>
<td>
<p>Character vector. Usernames in local_main_htpasswd_path which always have access to folder</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_log_rounds">log_rounds</code></td>
<td>
<p>Integer, number of rounds in the bcrypt algorithm. The higher the more time consuming and harder to brute-force.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_append_users">append_users</code></td>
<td>
<p>Boolean, if TRUE (default) will create new users and add them to local_main_password_path. See also password_input.</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_password_input">password_input</code></td>
<td>
<p>String, either &quot;prompt&quot; which asks the user for input. Alternatively, a number stored as string for a generated random password of said length: &quot;8&quot;, &quot;10&quot;, &quot;12&quot;, &quot;16&quot;</p>
</td></tr>
<tr><td><code id="setup_access_restrictions_+3A_type">type</code></td>
<td>
<p>Character vector. &quot;netlify&quot; will create _headers file used for Netlify. &quot;apache&quot; will create .htaccess and .htpasswd files used for general FTP-servers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String, the path to the newly created _headers-file or .htaccess files.
</p>

<hr>
<h2 id='subset_vector'>Given Ordered Integer Vector, Return Requested Set.</h2><span id='topic+subset_vector'></span>

<h3>Description</h3>

<p>Useful for identifying which categories are to be collected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subset_vector(
  vec,
  set = c(".top", ".upper", ".mid_upper", ".lower", ".mid_lower", ".bottom", ".spread"),
  spread_n = NULL,
  sort = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset_vector_+3A_vec">vec</code></td>
<td>
<p>A vector of any type.</p>
</td></tr>
<tr><td><code id="subset_vector_+3A_set">set</code></td>
<td>
<p>A character string, one of c(&quot;.top&quot;, &quot;.upper&quot;, &quot;.mid_upper&quot;, &quot;.lower&quot;,
&quot;.mid_lower&quot;, &quot;.bottom&quot;)</p>
</td></tr>
<tr><td><code id="subset_vector_+3A_spread_n">spread_n</code></td>
<td>
<p>The number of values to extract when set is &quot;spread&quot;.</p>
</td></tr>
<tr><td><code id="subset_vector_+3A_sort">sort</code></td>
<td>
<p>Whether to sort the output, defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Selected set of vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subset_vector(vec=1:7, set=".mid_lower")
</code></pre>

<hr>
<h2 id='summarize_data'>Summarize a survey dataset for use in tables and graphs</h2><span id='topic+summarize_data'></span>

<h3>Description</h3>

<p>Summarize a survey dataset for use in tables and graphs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize_data(
  data,
  ...,
  dep = colnames(data),
  indep = NULL,
  call = rlang::caller_env()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_data_+3A_data">data</code></td>
<td>
<p><em>Survey data</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;data.frame&gt;|obj:&lt;tbl_df&gt;&#8288;</code> // Required
</p>
<p>A data frame (or a srvyr-object) with the columns specified in the
chapter_overview 'dep_cat', etc columns.</p>
</td></tr>
<tr><td><code id="summarize_data_+3A_...">...</code></td>
<td>
<p><em>Dynamic dots</em>
</p>
<p>&lt;<a href="https://rlang.r-lib.org/reference/dyn-dots.html"><code>dynamic-dots</code></a>&gt;
</p>
<p>Arguments forwarded to the corresponding functions that create the elements.</p>
</td></tr>
<tr><td><code id="summarize_data_+3A_dep">dep</code>, <code id="summarize_data_+3A_indep">indep</code></td>
<td>
<p><em>Variable selections</em>
</p>
<p>&lt;<code>tidyselect</code>&gt; // <em>Default:</em> <code>NULL</code>, meaning everything for dep, nothing for indep.
</p>
<p>Columns in <code>data</code>. Currently allows tidyselect-syntax, which will be removed.</p>
</td></tr>
<tr><td><code id="summarize_data_+3A_call">call</code></td>
<td>
<p><em>Internal call</em>
</p>
<p><code style="white-space: pre;">&#8288;obj:&lt;call&gt;&#8288;</code> // <em>Default:</em> <code>rlang::caller_env()</code> (<code>optional</code>)
</p>
<p>Both the absolute and relative folderpaths are required, as strings.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataset
</p>

<hr>
<h2 id='swap_label_colnames'>Swap Dataset Columns and Labels</h2><span id='topic+swap_label_colnames'></span>

<h3>Description</h3>

<p>Columns not containing labels will remain unaffected, and warning given.
</p>
<p>Columns not containing labels will remain unaffected, and warning given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swap_label_colnames(data)

swap_label_colnames(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swap_label_colnames_+3A_data">data</code></td>
<td>
<p>Data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data.frame
</p>
<p>Data.frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>swap_label_colnames(mtcars)
swap_label_colnames(mtcars)
</code></pre>

<hr>
<h2 id='write_default_draft_report_args'>Write Default Arguments for <code>draft_report()</code> to YAML-file</h2><span id='topic+write_default_draft_report_args'></span>

<h3>Description</h3>

<p>Write Default Arguments for <code>draft_report()</code> to YAML-file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_default_draft_report_args(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_default_draft_report_args_+3A_path">path</code></td>
<td>
<p><code style="white-space: pre;">&#8288;scalar&lt;character&gt;&#8288;</code> // Required. <em>default:</em> <code>settings.yaml</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The defaults as a <code>yaml</code>-object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>write_default_draft_report_args(path=tempfile(fileext=".yaml"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
