<!DOCTYPE html><html lang="en"><head><title>Help for package scdtb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {scdtb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#basic_scd'><p>Basic Single Case Design</p></a></li>
<li><a href='#cross_lagged'><p>Cross-Lagged Correlation</p></a></li>
<li><a href='#deal_phase'><p>Deal a Phase of Cards</p></a></li>
<li><a href='#efficacy_of_CBT'><p>Fictional Single Case Design Efficacy of CBT Example</p></a></li>
<li><a href='#mixed_model_analysis'><p>Mixed Model Analysis</p></a></li>
<li><a href='#nap'><p>Non-overlap of All Pairs (NAP) Analysis</p></a></li>
<li><a href='#napjack'><p>Nap Jack: A Single Case Design Card Game</p></a></li>
<li><a href='#plot.cross_lagged'><p>Plot Cross-Lagged Correlation Results</p></a></li>
<li><a href='#plot.replext_gls'><p>Plot Results from Replications and Extension of GLS Simulation</p></a></li>
<li><a href='#print.cross_lagged'><p>Print Method for Cross-Lagged Objects</p></a></li>
<li><a href='#process_cond'><p>Process Condition Variable</p></a></li>
<li><a href='#process_phase'><p>Process Phase Variable</p></a></li>
<li><a href='#randomization_test'><p>Randomization Test for Single-Case Experiments</p></a></li>
<li><a href='#raw_plot'><p>Plot Raw Data with Optional Phase and Condition Annotations</p></a></li>
<li><a href='#render_card_grid'><p>Render a Grid of Card Images</p></a></li>
<li><a href='#replext_gls'><p>Replications and Extension of Generalized Least Squares Simulation</p></a></li>
<li><a href='#replext_gls_UIParams'><p>Generate UI Elements for GLS Simulation Parameters</p></a></li>
<li><a href='#replext_pgsql'><p>Replication and Extension of Generalized Least Squares Simulation Shiny App</p></a></li>
<li><a href='#reversal_withdrawal'><p>Reversal/withdrawal Design Example</p></a></li>
<li><a href='#scdtb'><p>Single Case Design Toolbox Shiny Application</p></a></li>
<li><a href='#simulate_gls_once'><p>Simulate and Analyze Generalized Least Squares</p></a></li>
<li><a href='#sleeping_pills'><p>Sleeping Pills and Dizziness Example</p></a></li>
<li><a href='#swapper'><p>Swap Cards Within a Row of a Card Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Single Case Design Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>In some situations where researchers would like to demonstrate
    causal effects, it is hard to obtain a sample size that would allow for a
    well-powered randomized controlled trial. Single case designs are experimental
    designs that can be used to demonstrate causal effects with only one participant
    or with only a few participants. The 'scdtb' package provides a suite of tools
    for analyzing data from studies that use single case designs. The nap() function
    can be used to compute the nonoverlap of all pairs as outlined by the What
    Works Clearinghouse (2022) <a href="https://ies.ed.gov/ncee/wwc/Handbooks">https://ies.ed.gov/ncee/wwc/Handbooks</a>. The
    package also offers the mixed_model_analysis() and cross_lagged() functions
    which implement mixed effects models and cross lagged analyses as described
    in Maric &amp; van der Werff (2020) &lt;<a href="https://doi.org/10.4324%2F9780429273872-9">doi:10.4324/9780429273872-9</a>&gt;. The
    randomization_test() function implements randomization tests based on methods
    presented in Onghena (2020) &lt;<a href="https://doi.org/10.4324%2F9780429273872-8">doi:10.4324/9780429273872-8</a>&gt;. The scdtb() 'shiny'
    application can be used to upload single case design data and access various
    'scdtb' tools for plotting and analysis.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mightymetrika/scdtb">https://github.com/mightymetrika/scdtb</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mightymetrika/scdtb/issues">https://github.com/mightymetrika/scdtb/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>broom.mixed, DT, ggplot2, MASS, mmcards, mmints, nlme, shiny,
shinythemes, sn</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-20 15:19:12 UTC; Administrator</td>
</tr>
<tr>
<td>Author:</td>
<td>Mackson Ncube [aut, cre],
  mightymetrika, LLC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mackson Ncube &lt;macksonncube.stats@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-20 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='basic_scd'>Basic Single Case Design</h2><span id='topic+basic_scd'></span>

<h3>Description</h3>

<p>This is the data for the Basic Single Case Design Example presented in
Figure 14 of the What Works Clearinghouse Procedures and Standards Handbook,
Version 5.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basic_scd
</code></pre>


<h3>Format</h3>



<h4><code>basic_scd</code></h4>

<p>A data frame with 21 rows and 3 columns:
</p>

<dl>
<dt>phase</dt><dd><p>Study phase</p>
</dd>
<dt>time</dt><dd><p>Time of data collection</p>
</dd>
<dt>socbehavs</dt><dd><p>Social behaviors score</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://ies.ed.gov/ncee/WWC/Docs/referenceresources/Final_WWC-HandbookVer5_0-0-508.pdf">https://ies.ed.gov/ncee/WWC/Docs/referenceresources/Final_WWC-HandbookVer5_0-0-508.pdf</a>
</p>

<hr>
<h2 id='cross_lagged'>Cross-Lagged Correlation</h2><span id='topic+cross_lagged'></span>

<h3>Description</h3>

<p>Computes cross-lagged correlations between two variables in a dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cross_lagged(
  .df,
  .x,
  .y,
  lag.max = 5,
  na.action = stats::na.fail,
  conf.level = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cross_lagged_+3A_.df">.df</code></td>
<td>
<p>A dataframe containing the variables for analysis.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_.x">.x</code></td>
<td>
<p>The name of the first variable (as a string) to be analyzed.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_.y">.y</code></td>
<td>
<p>The name of the second variable (as a string) to be analyzed.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_lag.max">lag.max</code></td>
<td>
<p>The maximum lag at which to calculate the cross-correlation or covariance.
Defaults to 5.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_na.action">na.action</code></td>
<td>
<p>A function to specify the action to be taken if NAs are found.
Defaults to <code>stats::na.fail</code>.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level for the confidence intervals.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="cross_lagged_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to stats::ccf().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the cross-lagged correlation between two variables
in a given dataframe up to a specified maximum lag. It returns an object
containing the cross-correlation function, confidence intervals, and other
related information. The function calls stats::ccf() internally.
</p>


<h3>Value</h3>

<p>An object of class &quot;cross_lagged&quot; containing the cross-correlation function,
upper and lower confidence intervals, the number of observations used, and
the names of the variables analyzed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creating a sample dataset
reversal_withdrawal &lt;- data.frame(
  phase = c(rep("baseline1", 6), rep("treatment1", 5), rep("baseline2", 5), rep("treatment2", 5)),
  time = 1:21,
  extbehavs = c(15, 10, 14, 17, 13, 12, 2, 1, 1, 0, 0, 9, 9, 11, 15, 20, 1, 0, 4, 0, 1)
)

reversal_withdrawal$synth &lt;- sapply(reversal_withdrawal$time, function(x) {
  stats::rpois(1, x)
})

reversal_withdrawal &lt;- as.data.frame(reversal_withdrawal)

# Using the cross_lagged function
cl_result &lt;- cross_lagged(reversal_withdrawal, .x = "time", .y = "synth")

</code></pre>

<hr>
<h2 id='deal_phase'>Deal a Phase of Cards</h2><span id='topic+deal_phase'></span>

<h3>Description</h3>

<p>This function deals a phase of cards from a given deck, consisting of 6 cards.
It returns a list containing the dealt cards as a matrix, the updated deck,
and the individual dealt cards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deal_phase(.deck)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="deal_phase_+3A_.deck">.deck</code></td>
<td>
<p>A deck of cards created using the <code>mmcards</code> package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<dl>
<dt>cards_matrix</dt><dd><p>A matrix of the dealt cards, with 1 row and 6 columns.</p>
</dd>
<dt>updeck</dt><dd><p>The updated deck after dealing the cards.</p>
</dd>
<dt>dealt_cards</dt><dd><p>A list of the individual dealt cards.</p>
</dd>
</dl>


<hr>
<h2 id='efficacy_of_CBT'>Fictional Single Case Design Efficacy of CBT Example</h2><span id='topic+efficacy_of_CBT'></span>

<h3>Description</h3>

<p>This is the data set used for the clinical case example in Maric &amp; van der Werf
(2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>efficacy_of_CBT
</code></pre>


<h3>Format</h3>



<h4><code>efficacy_of_CBT</code></h4>

<p>A data frame with 10 rows and 4 columns:
</p>

<dl>
<dt>phase</dt><dd><p>Study phase</p>
</dd>
<dt>time</dt><dd><p>Time of data collection</p>
</dd>
<dt>Anxious</dt><dd><p>Outcome measure</p>
</dd>
<dt>CATS_N</dt><dd><p>Outcome measure</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="doi:10.4324/9780429273872-9">doi:10.4324/9780429273872-9</a>
</p>


<h3>References</h3>

<p>Maric, M., &amp; van der Werff, V. (2020). Single-Case Experimental
Designs in Clinical Intervention Research. In R. van de Schoot &amp; M. Miocevic
(Eds.), Small Sample Size Solutions: A Guide for Applied Researchers and
Practitioners (1st ed., pp. 10). Routledge.
<a href="doi:10.4324/9780429273872-9">doi:10.4324/9780429273872-9</a>
</p>

<hr>
<h2 id='mixed_model_analysis'>Mixed Model Analysis</h2><span id='topic+mixed_model_analysis'></span>

<h3>Description</h3>

<p>Performs a mixed model analysis on a dataset, allowing for the specification
of a dependent variable, time variable, phase variable, participant
identification, and covariates. It supports reverse timing within phases,
custom phase levels and labels, and adds covariates to the fixed effects model.
The function fits a model using generalized least squares and returns
a list containing the modified dataset, the fitted model, and a plot of
predicted values with phase annotations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixed_model_analysis(
  .df,
  .dv,
  .time,
  .phase,
  .participant = NULL,
  rev_time_in_phase = FALSE,
  phase_levels = NULL,
  phase_labels = NULL,
  covs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixed_model_analysis_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the dataset to be analyzed.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_.dv">.dv</code></td>
<td>
<p>The name of the dependent variable in the dataset.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_.time">.time</code></td>
<td>
<p>The name of the time variable in the dataset.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_.phase">.phase</code></td>
<td>
<p>The name of the phase variable in the dataset.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_.participant">.participant</code></td>
<td>
<p>(optional) The name of the participant identifier variable
in the dataset. If not provided, a default factor will be used.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_rev_time_in_phase">rev_time_in_phase</code></td>
<td>
<p>(optional) A boolean indicating whether to reverse
the timing within each phase. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_phase_levels">phase_levels</code></td>
<td>
<p>(optional) A vector of phase levels to be used for the phase
variable. If NULL, the unique values in the phase variable will be used.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_phase_labels">phase_labels</code></td>
<td>
<p>(optional) A vector of labels corresponding to the phase_levels.
If NULL, phase_levels will be used as labels.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_covs">covs</code></td>
<td>
<p>(optional) A vector of names of covariates to be added to the
fixed effect model.</p>
</td></tr>
<tr><td><code id="mixed_model_analysis_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the <code>gls</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing three elements:
- <code>data</code>: The modified dataset with added time variables and predicted
values.
- <code>fitted_mod</code>: The fitted model object from <code>nlme::gls</code>.
- <code>plot</code>: A ggplot object showing the predicted values and phase
annotations.
</p>


<h3>References</h3>

<p>Maric, M., &amp; van der Werff, V. (2020). Single-Case Experimental
Designs in Clinical Intervention Research. In R. van de Schoot &amp; M. Miocevic
(Eds.), Small Sample Size Solutions: A Guide for Applied Researchers and
Practitioners (1st ed., pp. 10). Routledge.
<a href="doi:10.4324/9780429273872-9">doi:10.4324/9780429273872-9</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- mixed_model_analysis(efficacy_of_CBT, .dv = "Anxious", .time = "time",
                            .phase = "phase",rev_time_in_phase = TRUE,
                            phase_levels = c(0, 1),
                            phase_labels = c("Exposure", "Exposure + CT"))

summary(res$fitted_mod)

</code></pre>

<hr>
<h2 id='nap'>Non-overlap of All Pairs (NAP) Analysis</h2><span id='topic+nap'></span>

<h3>Description</h3>

<p>This function performs a Non-overlap of All Pairs (NAP) analysis on a given
data frame, considering specified phases, improvement direction, and analysis
type (reversability or trend). It is designed to assess the distinctiveness of
data across phases or trends within the data, based on the concept outlined in
the What Works Clearinghouse Procedures and Standards Handbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nap(
  .df,
  .y,
  .phase,
  .time,
  type = c("reversability", "trend"),
  last_m = NULL,
  phases,
  improvement = c("positive", "negative")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nap_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the data to be analyzed.</p>
</td></tr>
<tr><td><code id="nap_+3A_.y">.y</code></td>
<td>
<p>Character string specifying the variable in <code>.df</code> to be analyzed.</p>
</td></tr>
<tr><td><code id="nap_+3A_.phase">.phase</code></td>
<td>
<p>Character string specifying the variable in <code>.df</code> that defines
the phases.</p>
</td></tr>
<tr><td><code id="nap_+3A_.time">.time</code></td>
<td>
<p>Character string specifying the time variable in <code>.df</code>.</p>
</td></tr>
<tr><td><code id="nap_+3A_type">type</code></td>
<td>
<p>Character string indicating the type of analysis to be conducted:
either &quot;reversability&quot; or &quot;trend&quot;.</p>
</td></tr>
<tr><td><code id="nap_+3A_last_m">last_m</code></td>
<td>
<p>An integer specifying the number of measurements from the end
to be considered in a trend analysis. Leave as NULL if <code>type</code> is set
to &quot;reversability&quot;.</p>
</td></tr>
<tr><td><code id="nap_+3A_phases">phases</code></td>
<td>
<p>Vector specifying the phases to be included in the analysis.
If <code>type</code> is &quot;reversability&quot;, two phases must be specified. If <code>type</code>
is &quot;trend&quot;, one phase must be specified.</p>
</td></tr>
<tr><td><code id="nap_+3A_improvement">improvement</code></td>
<td>
<p>Character vector indicating the direction of improvement to
consider: either &quot;positive&quot; or &quot;negative&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NAP analysis is a method used to evaluate the effectiveness of interventions
by analyzing the non-overlap between data points across different phases or
trends within a dataset. It is a useful statistical tool for educational research
and is detailed in the What Works Clearinghouse Procedures and Standards Handbook,
Version 5.0.
</p>


<h3>Value</h3>

<p>A numeric value representing the NAP score, reflecting the proportion
of non-overlapping data points between the specified phases or trends.
</p>


<h3>References</h3>

<p>What Works Clearinghouse. (2022). What Works Clearinghouse procedures and
standards handbook, version 5.0. U.S. Department of Education, Institute of
Education Sciences, National Center for Education Evaluation and Regional
Assistance (NCEE). This report is available on the What Works Clearinghouse
website at <a href="https://ies.ed.gov/ncee/wwc/Handbooks">https://ies.ed.gov/ncee/wwc/Handbooks</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>nap(.df = reversal_withdrawal, .y = "extbehavs", .phase = "phase",
    .time = "time", type = "reversability",
    phases = list("baseline1", "baseline2"), improvement = "negative")

</code></pre>

<hr>
<h2 id='napjack'>Nap Jack: A Single Case Design Card Game</h2><span id='topic+napjack'></span>

<h3>Description</h3>

<p>This function creates a Shiny application that implements the Nap Jack card game.
Nap Jack is a single case design card game where the player deals cards in phases
and tries to achieve a winning score based on the analysis of the dealt cards.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>napjack()
</code></pre>


<h3>Details</h3>

<p>The game consists of four phases: baseline 1, treatment 1, baseline 2, and
treatment 2. In each phase, the player deals six cards and has the option to swap
cards within a row once per phase. After all four phases are completed, the game
is scored based on the analysis of the dealt cards using non-overlap of all pairs
(NAP) and mixed effects modeling.
</p>
<p>The game utilizes the following internal helper functions:
</p>

<ul>
<li> <p><code>deal_phase()</code>: Deals a phase of cards from the game deck.
</p>
</li>
<li> <p><code>render_card_grid()</code>: Renders a grid of card images based on the dealt cards.
</p>
</li>
<li> <p><code>swapper()</code>: Allows swapping of cards within a row of the card matrix.
</p>
</li></ul>

<p>The game also uses the following external functions for analysis:
</p>

<ul>
<li> <p><code>raw_plot()</code>: Plots the raw data of the dealt cards.
</p>
</li>
<li> <p><code>nap()</code>: Performs non-overlap of all pairs analysis.
</p>
</li>
<li> <p><code>mixed_model_analysis()</code>: Performs mixed effects modeling analysis.
</p>
</li></ul>

<p>The player's objective is to achieve a winning score by strategically dealing and
swapping cards to optimize the analysis results.
</p>


<h3>Value</h3>

<p>A Shiny application object that represents the Nap Jack game.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the Shiny app
if(interactive()){
  napjack()
}

</code></pre>

<hr>
<h2 id='plot.cross_lagged'>Plot Cross-Lagged Correlation Results</h2><span id='topic+plot.cross_lagged'></span>

<h3>Description</h3>

<p>Plots the cross-lagged correlation results calculated by cross_lagged().
This method generates a bar plot showing the autocorrelation function (ACF) values
for different lags, along with dashed lines indicating the upper and lower confidence
intervals. The plot is created using <code>ggplot2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cross_lagged'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cross_lagged_+3A_x">x</code></td>
<td>
<p>An object of class &quot;cross_lagged&quot; containing the results of a cross-lagged
correlation analysis performed by cross_lagged().</p>
</td></tr>
<tr><td><code id="plot.cross_lagged_+3A_...">...</code></td>
<td>
<p>Additional parameters (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object representing the cross-lagged correlation analysis
results. This plot includes bars for ACF values at different lags
and dashed lines for the upper and lower confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a sample dataset
reversal_withdrawal &lt;- data.frame(
  phase = c(rep("baseline1", 6), rep("teratment1", 5), rep("baseline2", 5), rep("teratment2", 5)),
  time = 1:21,
  extbehavs = c(15, 10, 14, 17, 13, 12, 2, 1, 1, 0, 0, 9, 9, 11, 15, 20, 1, 0, 4, 0, 1)
)

reversal_withdrawal$synth &lt;- sapply(reversal_withdrawal$time, function(x) {
  stats::rpois(1, x)
})

reversal_withdrawal &lt;- as.data.frame(reversal_withdrawal)

# Using the cross_lagged function
cl_result &lt;- cross_lagged(reversal_withdrawal, .x = "time", .y = "synth")

# Plot the cross-lagged correlation results
plot(cl_result)

</code></pre>

<hr>
<h2 id='plot.replext_gls'>Plot Results from Replications and Extension of GLS Simulation</h2><span id='topic+plot.replext_gls'></span>

<h3>Description</h3>

<p>This method creates a ggplot2 visualization of results from a replext_gls object.
It allows for flexible plotting of different metrics across various conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'replext_gls'
plot(
  x,
  term,
  metric = "rejection_rates",
  x_axis = "tppp",
  color = "rho",
  title = NULL,
  x_label = NULL,
  y_label = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.replext_gls_+3A_x">x</code></td>
<td>
<p>An object of class &quot;replext_gls&quot;, typically the output from replext_gls().</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_term">term</code></td>
<td>
<p>Character. The name of the model term to plot.</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_metric">metric</code></td>
<td>
<p>Character. The metric to plot on the y-axis. Default is &quot;rejection_rates&quot;.
Other options include &quot;mean_estimates&quot;, &quot;mean_bias&quot;, etc.</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_x_axis">x_axis</code></td>
<td>
<p>Character. The variable to plot on the x-axis. Default is &quot;tppp&quot;
(time points per phase).</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_color">color</code></td>
<td>
<p>Character. The variable to use for color grouping. Default is &quot;rho&quot;
(autocorrelation parameter).</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_title">title</code></td>
<td>
<p>Character. The plot title. If NULL, a default title is generated.</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_x_label">x_label</code></td>
<td>
<p>Character. The x-axis label. If NULL, a default label is generated.</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_y_label">y_label</code></td>
<td>
<p>Character. The y-axis label. If NULL, a default label is generated.</p>
</td></tr>
<tr><td><code id="plot.replext_gls_+3A_...">...</code></td>
<td>
<p>Pass extra arguments to ggplot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method creates a line plot with points, where each line represents a different
level of the color variable (default is rho). If the metric is &quot;rejection_rates&quot;,
error bars are added to represent the standard error of the rejection rates.
</p>


<h3>Value</h3>

<p>A ggplot2 object representing the plot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- replext_gls(
  n_timepoints_list = c(10),
  rho_list = c(0.2),
  iterations = 10,
  betas = c("(Intercept)" = 0, "phase1" = 1),
  formula = y ~ phase
)
plot(results, term = "phase1", metric = "rejection_rates")

</code></pre>

<hr>
<h2 id='print.cross_lagged'>Print Method for Cross-Lagged Objects</h2><span id='topic+print.cross_lagged'></span>

<h3>Description</h3>

<p>Prints a summary of cross-lagged correlation analysis results. This method
formats the results into a data frame showing lags, autocorrelation function (ACF) values,
and indicates significance based on the confidence intervals. Significant ACF values,
which fall outside the upper or lower confidence intervals, are marked with an asterisk (*).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cross_lagged'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cross_lagged_+3A_x">x</code></td>
<td>
<p>An object of class &quot;cross_lagged&quot; containing the results from running
<code>cross_lagged</code>. This object includes information on lags, ACF values, and
confidence intervals.</p>
</td></tr>
<tr><td><code id="print.cross_lagged_+3A_...">...</code></td>
<td>
<p>Additional parameters (currently ignored).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a data frame with columns for lag, ACF values, and a
significance indicator. This data frame is printed to the console for the user.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Creating a sample dataset
reversal_withdrawal &lt;- data.frame(
  phase = c(rep("baseline1", 6), rep("teratment1", 5), rep("baseline2", 5), rep("teratment2", 5)),
  time = 1:21,
  extbehavs = c(15, 10, 14, 17, 13, 12, 2, 1, 1, 0, 0, 9, 9, 11, 15, 20, 1, 0, 4, 0, 1)
)

reversal_withdrawal$synth &lt;- sapply(reversal_withdrawal$time, function(x) {
  stats::rpois(1, x)
})

reversal_withdrawal &lt;- as.data.frame(reversal_withdrawal)

# Using the cross_lagged function
cl_result &lt;- cross_lagged(reversal_withdrawal, .x = "time", .y = "synth")

# Print the summary of cross-lagged analysis
print(cl_result)

</code></pre>

<hr>
<h2 id='process_cond'>Process Condition Variable</h2><span id='topic+process_cond'></span>

<h3>Description</h3>

<p>This is an internal helper function used by <code>raw_plot</code> and <code>randomization_test</code>
to process the condition variable in the input data frame. It sets the factor
levels and labels of the condition variable based on the provided <code>cond_levels</code>
and <code>cond_labels</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_cond(.df, .cond, cond_levels, cond_labels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_cond_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the data to be processed. Must contain a column
specified by <code>.cond</code>.</p>
</td></tr>
<tr><td><code id="process_cond_+3A_.cond">.cond</code></td>
<td>
<p>The name of the column in <code>.df</code> that contains the condition variable.</p>
</td></tr>
<tr><td><code id="process_cond_+3A_cond_levels">cond_levels</code></td>
<td>
<p>(Optional) A vector of values indicating the order of condition
levels. This is used to set the factor levels of the condition
variable.</p>
</td></tr>
<tr><td><code id="process_cond_+3A_cond_labels">cond_labels</code></td>
<td>
<p>(Optional) A vector of labels corresponding to the condition
levels. These are used for the legend. If not provided, the
<code>cond_levels</code> are used as labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data frame <code>.df</code> with the condition variable processed as a factor
with the specified levels and labels.
</p>

<hr>
<h2 id='process_phase'>Process Phase Variable</h2><span id='topic+process_phase'></span>

<h3>Description</h3>

<p>This is an internal helper function used by <code>raw_plot</code> and <code>mixed_model_analysis</code>
to process the phase variable in the input data frame. It sets the factor levels
and labels of the phase variable based on the provided <code>phase_levels</code> and
<code>phase_labels</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_phase(.df, .phase, phase_levels, phase_labels)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="process_phase_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the data to be processed. Must contain a column
specified by <code>.phase</code>.</p>
</td></tr>
<tr><td><code id="process_phase_+3A_.phase">.phase</code></td>
<td>
<p>The name of the column in <code>.df</code> that contains the phase variable.</p>
</td></tr>
<tr><td><code id="process_phase_+3A_phase_levels">phase_levels</code></td>
<td>
<p>(Optional) A vector of values indicating the order of phase
levels. This is used to set the factor levels of the phase
variable.</p>
</td></tr>
<tr><td><code id="process_phase_+3A_phase_labels">phase_labels</code></td>
<td>
<p>(Optional) A vector of labels corresponding to the phase
levels. These labels are used in annotations. If not provided,
the <code>phase_levels</code> are used as labels.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data frame <code>.df</code> with the phase variable processed as a factor
with the specified levels and labels.
</p>

<hr>
<h2 id='randomization_test'>Randomization Test for Single-Case Experiments</h2><span id='topic+randomization_test'></span>

<h3>Description</h3>

<p>Performs a randomization test on data from single-case experiments. This
function allows for the assessment of treatment effects by comparing the observed
outcome difference to a distribution of differences obtained through permutation.
It supports various constraints on permutation sequences, such as fixed or
observed maximum and minimum consecutive sequences of a particular condition.
The function also provides graphical summaries of the raw data and the
distribution of mean differences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomization_test(
  .df,
  .out,
  .cond,
  .time,
  num_permutations = NULL,
  consec = c("observed", "fixed"),
  max_consec = NULL,
  min_consec = NULL,
  cond_levels = NULL,
  cond_labels = NULL,
  conf.level = 0.95,
  .bins = 30
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomization_test_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the variables of interest.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_.out">.out</code></td>
<td>
<p>The name of the outcome variable in <code>.df</code>.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_.cond">.cond</code></td>
<td>
<p>The name of the condition variable in <code>.df</code>. This variable should
have two levels.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_.time">.time</code></td>
<td>
<p>The name of the time variable in <code>.df</code>.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_num_permutations">num_permutations</code></td>
<td>
<p>The number of permutations to perform. If <code>NULL</code>, all
possible permutations are considered.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_consec">consec</code></td>
<td>
<p>Specifies the constraint on consecutive sequences for permutation.
Can be <code>"observed"</code> for the observed sequence length or <code>"fixed"</code> for
a specified sequence length. Defaults to <code>"observed"</code>.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_max_consec">max_consec</code></td>
<td>
<p>The maximum number of consecutive observations of the same
condition to allow in permutations. If <code>NULL</code>, no maximum is enforced.
To implement <code>max_consec</code>, <code>consec</code> must be set to <code>"fixed"</code>.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_min_consec">min_consec</code></td>
<td>
<p>The minimum number of consecutive observations of the same
condition to allow in permutations. If <code>NULL</code>, no minimum is enforced.
To implement <code>min_consec</code>, <code>consec</code> must be set to <code>"fixed"</code>.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_cond_levels">cond_levels</code></td>
<td>
<p>Explicitly sets the levels of the condition variable. If
<code>NULL</code>, the levels are derived from the data.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_cond_labels">cond_labels</code></td>
<td>
<p>Labels for the condition levels. If <code>NULL</code>, levels are used
as labels.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_conf.level">conf.level</code></td>
<td>
<p>The confidence level for the confidence interval calculation.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="randomization_test_+3A_.bins">.bins</code></td>
<td>
<p>The number of bins to use for the histogram of the test statistic
distribution. Defaults to 30.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the original difference in means, the p-value of the
test, the distribution of test statistics under the null hypothesis,
confidence intervals, and plots of the distribution of mean differences
and the raw data.
</p>


<h3>References</h3>

<p>Onghena, P. (2020). One by One: The design and analysis of replicated randomized
single-case experiments.In R. van de Schoot &amp; M. Mioecvic (Eds.), Small Sample
Size Solutions: A Guide for Applied Researchers and Practitioners (1st ed., pp.
15). Routledge. <a href="doi:10.4324/9780429273872-8">doi:10.4324/9780429273872-8</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>result &lt;- randomization_test(sleeping_pills, .out = "sever_compl",
                             .cond = "treatment", .time = "day",
                             num_permutations = 100,
                             cond_levels = c("C", "E"))

result$conf_int

</code></pre>

<hr>
<h2 id='raw_plot'>Plot Raw Data with Optional Phase and Condition Annotations</h2><span id='topic+raw_plot'></span>

<h3>Description</h3>

<p>This function generates a plot of raw data from a specified data frame. It
supports optional annotations based on phase and condition variables, and can
facet the plot by participant. The plot is customizable with parameters for
setting factor levels and labels for both phase and condition variables. It
utilizes ggplot2 for plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw_plot(
  .df,
  .out,
  .time,
  .phase = NULL,
  .cond = NULL,
  .participant = NULL,
  phase_levels = NULL,
  phase_labels = NULL,
  cond_levels = NULL,
  cond_labels = NULL,
  label_raise = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="raw_plot_+3A_.df">.df</code></td>
<td>
<p>A data frame containing the data to be plotted. Must contain columns
specified by .time, .out, and optionally .phase, .cond, and .participant
if used.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_.out">.out</code></td>
<td>
<p>The name of the column in .df that contains the outcome variable
to be plotted on the y-axis.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_.time">.time</code></td>
<td>
<p>The name of the column in .df that contains the time variable to
be plotted on the x-axis.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_.phase">.phase</code></td>
<td>
<p>(Optional) The name of the column in .df that contains the phase
variable used for annotating the plot with phase changes. If NULL,
phase annotations are not added.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_.cond">.cond</code></td>
<td>
<p>(Optional) The name of the column in .df that contains the condition
variable. If not NULL, data points are colored based on condition.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_.participant">.participant</code></td>
<td>
<p>(Optional) The name of the column in .df that contains
participant identifiers. If not NULL, the plot is faceted
by participant.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_phase_levels">phase_levels</code></td>
<td>
<p>(Optional) A vector of values indicating the order of phase
levels. This is used to set the factor levels of the phase
variable.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_phase_labels">phase_labels</code></td>
<td>
<p>(Optional) A vector of labels corresponding to the phase
levels. These labels are used in annotations.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_cond_levels">cond_levels</code></td>
<td>
<p>(Optional) A vector of values indicating the order of condition
levels. This is used to set the factor levels of the condition
variable.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_cond_labels">cond_labels</code></td>
<td>
<p>(Optional) A vector of labels corresponding to the condition
levels. These are used for the legend.</p>
</td></tr>
<tr><td><code id="raw_plot_+3A_label_raise">label_raise</code></td>
<td>
<p>A numeric value indicating how much to raise the phase labels
on the y-axis. Defaults to 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object representing the raw data plot with optional annotations
for phase and condition, and faceting by participant if specified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rp &lt;- raw_plot(.df = efficacy_of_CBT, .out = "Anxious", .time = "time",
               .phase = "phase", phase_levels = c(0, 1),
               phase_labels = c("Exposure", "Exposure + CT"))

</code></pre>

<hr>
<h2 id='render_card_grid'>Render a Grid of Card Images</h2><span id='topic+render_card_grid'></span>

<h3>Description</h3>

<p>This function takes a matrix of card objects and renders them as a grid of
card images using Shiny's <code>renderImage</code> function. The resulting grid is
returned as a Shiny UI component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>render_card_grid(new_card_grid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="render_card_grid_+3A_new_card_grid">new_card_grid</code></td>
<td>
<p>A matrix of card objects, where each cell contains a
card object with an <code>icard</code> property specifying the path to the card image.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function applies <code>renderImage</code> to each card object in the matrix,
creating a grid of card images. The images are displayed in a fluid row
layout, with each image occupying an equal portion of the available width.
</p>


<h3>Value</h3>

<p>A Shiny UI component representing the grid of rendered card images.
</p>

<hr>
<h2 id='replext_gls'>Replications and Extension of Generalized Least Squares Simulation</h2><span id='topic+replext_gls'></span>

<h3>Description</h3>

<p>This function performs multiple simulations of Generalized Least Squares (GLS)
models across various conditions, extending the work of Maric et al. (2014).
It allows for the exploration of different numbers of timepoints per phase and
autocorrelation parameters, providing a comprehensive analysis of model
performance across these conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replext_gls(
  n_timepoints_list,
  rho_list,
  iterations,
  n_phases = 2,
  n_IDs = 1,
  betas,
  formula,
  covariate_specs = NULL,
  alpha_level = 0.05,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replext_gls_+3A_n_timepoints_list">n_timepoints_list</code></td>
<td>
<p>Numeric vector. The numbers of timepoints per phase
to simulate.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_rho_list">rho_list</code></td>
<td>
<p>Numeric vector. The autocorrelation parameters to simulate.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_iterations">iterations</code></td>
<td>
<p>Integer. The number of simulations to run for each combination
of conditions.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_n_phases">n_phases</code></td>
<td>
<p>Integer. The number of phases in the design. Default is 2.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_n_ids">n_IDs</code></td>
<td>
<p>Integer. The number of subjects (IDs) to simulate. Default is 1.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_betas">betas</code></td>
<td>
<p>Named numeric vector. The true coefficient values for the model.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_formula">formula</code></td>
<td>
<p>Formula object. The model formula to be fitted.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_covariate_specs">covariate_specs</code></td>
<td>
<p>List of lists. Specifications for generating covariates.
Each inner list should contain elements 'vars' (variable names), 'dist'
(distribution function name), 'args' (list of distribution parameters), and
optionally 'expr' (a function to generate data).</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_alpha_level">alpha_level</code></td>
<td>
<p>Numeric. The significance level for hypothesis tests. Default
is 0.05.</p>
</td></tr>
<tr><td><code id="replext_gls_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If TRUE, print progress messages. Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of class 'replext_gls' containing simulation results, including:
</p>
<table role = "presentation">
<tr><td><code>term</code></td>
<td>
<p>Character. The name of the model term.</p>
</td></tr>
<tr><td><code>tppp</code></td>
<td>
<p>Integer. The number of timepoints per phase.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>Numeric. The autocorrelation parameter.</p>
</td></tr>
<tr><td><code>success_rate</code></td>
<td>
<p>Numeric. The proportion of successful model fits.</p>
</td></tr>
<tr><td><code>mean_estimates</code></td>
<td>
<p>Numeric. The mean of the estimated coefficients.</p>
</td></tr>
<tr><td><code>mean_bias</code></td>
<td>
<p>Numeric. The mean bias of the estimated coefficients.</p>
</td></tr>
<tr><td><code>se_estimates</code></td>
<td>
<p>Numeric. The standard error of the estimated coefficients.</p>
</td></tr>
<tr><td><code>rejection_rates</code></td>
<td>
<p>Numeric. The proportion of significant hypothesis tests.</p>
</td></tr>
<tr><td><code>se_rejection_rates</code></td>
<td>
<p>Numeric. The standard error of the rejection rates.</p>
</td></tr>
<tr><td><code>mean_rmse</code></td>
<td>
<p>Numeric. The mean root mean square error of the estimates.</p>
</td></tr>
<tr><td><code>alpha_level</code></td>
<td>
<p>Numeric. The significance level used for hypothesis tests.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>Integer. The number of iterations performed.</p>
</td></tr>
<tr><td><code>n_phases</code></td>
<td>
<p>Integer. The number of phases in the design.</p>
</td></tr>
<tr><td><code>n_IDs</code></td>
<td>
<p>Integer. The number of subjects simulated.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>Character. The model formula used.</p>
</td></tr>
<tr><td><code>covariate_specs</code></td>
<td>
<p>Character. The covariate specifications used.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Maric, M., de Haan, E., Hogendoorn, S.M., Wolters, L.H. &amp; Huizenga, H.M. (2014).
Evaluating statistical and clinical significance of intervention effects in
single-case experimental designs: An SPSS method to analyze univariate data.
Behavior Therapy. doi: 10.1016/j.beth.2014.09.009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>results &lt;- replext_gls(
  n_timepoints_list = c(10),
  rho_list = c(0.2),
  iterations = 10,
  betas = c("(Intercept)" = 0, "phase1" = 1),
  formula = y ~ phase
)

</code></pre>

<hr>
<h2 id='replext_gls_UIParams'>Generate UI Elements for GLS Simulation Parameters</h2><span id='topic+replext_gls_UIParams'></span>

<h3>Description</h3>

<p>This internal function creates a list of Shiny UI input elements for setting
parameters in the Generalized Least Squares (GLS) simulation Shiny app.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replext_gls_UIParams()
</code></pre>


<h3>Details</h3>

<p>This function is used internally by the <code>replext_pgsql</code> Shiny app to
generate the UI elements for parameter input. It creates a standardized set
of inputs with default values that users can modify to customize their
simulation settings.
</p>


<h3>Value</h3>

<p>A list of Shiny input elements, including:
</p>

<ul>
<li><p> textInput for number of timepoints in each phase
</p>
</li>
<li><p> textInput for AR(1) parameter values
</p>
</li>
<li><p> numericInput for number of simulation iterations
</p>
</li>
<li><p> numericInput for number of phases
</p>
</li>
<li><p> numericInput for number of participants
</p>
</li>
<li><p> textAreaInput for regression coefficients
</p>
</li>
<li><p> textAreaInput for model formula
</p>
</li>
<li><p> textAreaInput for covariate specification
</p>
</li>
<li><p> numericInput for alpha level
</p>
</li></ul>



<h3>Note</h3>

<p>The function uses text inputs for lists (e.g., timepoints, AR(1) parameters)
which should be entered as comma-separated values. The betas, formula, and
covariate specifications are entered as text areas to allow for more complex
inputs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+replext_pgsql">replext_pgsql</a></code> for the main Shiny app function.
</p>

<hr>
<h2 id='replext_pgsql'>Replication and Extension of Generalized Least Squares Simulation Shiny App</h2><span id='topic+replext_pgsql'></span>

<h3>Description</h3>

<p>This function creates a Shiny app for running and visualizing simulations of
Generalized Least Squares (GLS) models, extending the work of Maric et al. (2014).
It allows users to interactively set simulation parameters, run simulations,
view results, and generate plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replext_pgsql(dbname, datatable, host, port, user, password)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="replext_pgsql_+3A_dbname">dbname</code></td>
<td>
<p>Character string. The name of the PostgreSQL database to connect to.</p>
</td></tr>
<tr><td><code id="replext_pgsql_+3A_datatable">datatable</code></td>
<td>
<p>Character string. The name of the table in the database where
results will be stored.</p>
</td></tr>
<tr><td><code id="replext_pgsql_+3A_host">host</code></td>
<td>
<p>Character string. The host name or IP address of the PostgreSQL server.</p>
</td></tr>
<tr><td><code id="replext_pgsql_+3A_port">port</code></td>
<td>
<p>Integer. The port number on which the PostgreSQL server is listening.</p>
</td></tr>
<tr><td><code id="replext_pgsql_+3A_user">user</code></td>
<td>
<p>Character string. The username for the PostgreSQL database connection.</p>
</td></tr>
<tr><td><code id="replext_pgsql_+3A_password">password</code></td>
<td>
<p>Character string. The password for the PostgreSQL database
connection.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The app provides a user interface for:
</p>

<ul>
<li><p> Setting simulation parameters
</p>
</li>
<li><p> Running simulations based on the specified parameters
</p>
</li>
<li><p> Viewing simulation results in a table format
</p>
</li>
<li><p> Generating plots of various metrics across different conditions
</p>
</li>
<li><p> Storing and retrieving results from a PostgreSQL database
</p>
</li>
<li><p> Displaying relevant citations
</p>
</li></ul>

<p>The app uses the <code>replext_gls()</code> function to perform the actual simulations.
</p>


<h3>Value</h3>

<p>A Shiny app object which can be run to start the application.
</p>


<h3>References</h3>

<p>Maric, M., de Haan, E., Hogendoorn, S.M., Wolters, L.H. &amp; Huizenga, H.M. (2014).
Evaluating statistical and clinical significance of intervention effects in
single-case experimental designs: An SPSS method to analyze univariate data.
Behavior Therapy. doi: 10.1016/j.beth.2014.09.009
</p>


<h3>See Also</h3>

<p><code><a href="#topic+replext_gls">replext_gls</a></code> for the underlying simulation function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
replext_pgsql(
  dbname = "my_database",
  datatable = "simulation_results",
  host = "localhost",
  port = 5432,
  user = "myuser",
  password = "mypassword"
)
}

</code></pre>

<hr>
<h2 id='reversal_withdrawal'>Reversal/withdrawal Design Example</h2><span id='topic+reversal_withdrawal'></span>

<h3>Description</h3>

<p>This is the data for the Reversal/Withdrawal Design Example presented in
Figure 17 of the What Works Clearinghouse Procedures and Standards Handbook,
Version 5.0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reversal_withdrawal
</code></pre>


<h3>Format</h3>



<h4><code>reversal_withdrawal</code></h4>

<p>A data frame with 21 rows and 3 columns:
</p>

<dl>
<dt>phase</dt><dd><p>Study phase</p>
</dd>
<dt>time</dt><dd><p>Time of data collection</p>
</dd>
<dt>extbehavs</dt><dd><p>Externalizing behaviors score</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://ies.ed.gov/ncee/WWC/Docs/referenceresources/Final_WWC-HandbookVer5_0-0-508.pdf">https://ies.ed.gov/ncee/WWC/Docs/referenceresources/Final_WWC-HandbookVer5_0-0-508.pdf</a>
</p>

<hr>
<h2 id='scdtb'>Single Case Design Toolbox Shiny Application</h2><span id='topic+scdtb'></span>

<h3>Description</h3>

<p>This Shiny application provides a toolbox for analyzing single case design data.
It includes features for data upload, data type handling, raw data visualization,
mixed effects analysis, cross-lagged correlation analysis, non-overlap of all pairs
analysis, and randomization tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scdtb()
</code></pre>


<h3>Value</h3>

<p>A Shiny app object which can be run to start the application.
</p>


<h3>References</h3>

<p>Maric, M., &amp; van der Werff, V. (2020). Single-Case Experimental Designs in
Clinical Intervention Research. In R. van de Schoot &amp; M. Miocevic (Eds.),
Small Sample Size Solutions: A Guide for Applied Researchers and Practitioners
(1st ed., pp. 10). Routledge. <a href="doi:10.4324/9780429273872-9">doi:10.4324/9780429273872-9</a>
</p>
<p>What Works Clearinghouse. (2022). What Works Clearinghouse procedures and
standards handbook, version 5.0. U.S. Department of Education, Institute of
Education Sciences, National Center for Education Evaluation and Regional
Assistance (NCEE). This report is available on the What Works Clearinghouse
website at https://ies.ed.gov/ncee/wwc/Handbooks
</p>
<p>Onghena, P. (2020). One by One: The design and analysis of replicated randomized
single-case experiments.In R. van de Schoot &amp; M. Mioecvic (Eds.), Small Sample
Size Solutions: A Guide for Applied Researchers and Practitioners (1st ed., pp.
15). Routledge. <a href="doi:10.4324/9780429273872-8">doi:10.4324/9780429273872-8</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># To run the Shiny app
if(interactive()){
  scdtb()
}

</code></pre>

<hr>
<h2 id='simulate_gls_once'>Simulate and Analyze Generalized Least Squares</h2><span id='topic+simulate_gls_once'></span>

<h3>Description</h3>

<p>This function simulates data and fits a Generalized Least Squares (GLS) model
to the simulated data. It can handle multiple phases, multiple subjects (IDs),
and various covariate specifications.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_gls_once(
  n_timepoints_per_phase,
  rho,
  n_phases = 2,
  n_IDs = 1,
  betas,
  formula,
  covariate_specs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_gls_once_+3A_n_timepoints_per_phase">n_timepoints_per_phase</code></td>
<td>
<p>Integer. The number of timepoints in each phase.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_rho">rho</code></td>
<td>
<p>Numeric. The autocorrelation parameter for the AR(1) error structure.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_n_phases">n_phases</code></td>
<td>
<p>Integer. The number of phases in the design. Default is 2.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_n_ids">n_IDs</code></td>
<td>
<p>Integer. The number of subjects (IDs) to simulate. Default is 1.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_betas">betas</code></td>
<td>
<p>Named numeric vector. The true coefficient values for the model.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_formula">formula</code></td>
<td>
<p>Formula object. The model formula to be fitted.</p>
</td></tr>
<tr><td><code id="simulate_gls_once_+3A_covariate_specs">covariate_specs</code></td>
<td>
<p>List of lists. Specifications for generating covariates.
Each inner list should contain elements 'vars' (variable names), 'dist'
(distribution function name), args' (list of distribution parameters), and
optionally 'expr' (a function to generate data).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>success</code></td>
<td>
<p>Logical. TRUE if the model converged, FALSE otherwise.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>Named numeric vector. Estimated coefficients from the fitted model.</p>
</td></tr>
<tr><td><code>std_errors</code></td>
<td>
<p>Named numeric vector. Standard errors of the estimated coefficients.</p>
</td></tr>
<tr><td><code>p_values</code></td>
<td>
<p>Named numeric vector. P-values for the estimated coefficients.</p>
</td></tr>
<tr><td><code>bias</code></td>
<td>
<p>Named numeric vector. Bias of the estimated coefficients (estimate - true value).</p>
</td></tr>
<tr><td><code>rmse</code></td>
<td>
<p>Numeric. Root Mean Square Error of the estimated coefficients.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Simple example with 2 phases, 10 timepoints per phase, and no covariates
result &lt;- simulate_gls_once(
  n_timepoints_per_phase = 10,
  rho = 0.2,
  betas = c("(Intercept)" = 0, "phase1" = 1),
  formula = y ~ phase
)

</code></pre>

<hr>
<h2 id='sleeping_pills'>Sleeping Pills and Dizziness Example</h2><span id='topic+sleeping_pills'></span>

<h3>Description</h3>

<p>This is the data set used for the example in Onghena (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sleeping_pills
</code></pre>


<h3>Format</h3>



<h4><code>sleeping_pills</code></h4>

<p>A data frame with 14 rows and 3 columns:
</p>

<dl>
<dt>day</dt><dd><p>day of study</p>
</dd>
<dt>treatment</dt><dd><p>E, Experimental; C, Control</p>
</dd>
<dt>sever_compl</dt><dd><p>Severity of complaints</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="doi:10.4324/9780429273872-8">doi:10.4324/9780429273872-8</a>
</p>


<h3>References</h3>

<p>Onghena, P. (2020). One by one: The design and analysis of
replicated randomized single-case experiments. In R. van de Schoot &amp; M. Miocevic
(Eds.), Small sample size solutions: A guide for applied researchers and
practitioners (1st ed., pp. 15). Routledge. <a href="doi:10.4324/9780429273872-8">doi:10.4324/9780429273872-8</a>
</p>

<hr>
<h2 id='swapper'>Swap Cards Within a Row of a Card Matrix</h2><span id='topic+swapper'></span>

<h3>Description</h3>

<p>This function allows swapping of cards within a row of a card matrix. It takes a
card matrix and the indices of the columns to swap. The function modifies the
card matrix in-place and returns the updated matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swapper(cards_matrix, swap_in_row = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="swapper_+3A_cards_matrix">cards_matrix</code></td>
<td>
<p>A matrix of cards representing the current state of the game.</p>
</td></tr>
<tr><td><code id="swapper_+3A_swap_in_row">swap_in_row</code></td>
<td>
<p>A vector of length 2 specifying the indices of the columns to
swap within a row. If <code>NULL</code> (default), no swapping is performed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function performs the following steps:
</p>

<ol>
<li><p> Initializes a move history attribute if it doesn't exist.
</p>
</li>
<li><p> Checks if <code>swap_in_row</code> is provided and has a length of 2.
</p>
</li>
<li><p> Verifies that swapping within a phase has not been performed more than once.
</p>
</li>
<li><p> Swaps the cards at the specified column indices within the first row of the matrix.
</p>
</li>
<li><p> Updates the move history attribute.
</p>
</li>
<li><p> Adds the &quot;swapper&quot; class to the card matrix.
</p>
</li></ol>



<h3>Value</h3>

<p>The updated card matrix with the specified cards swapped within a row.
</p>


<h3>Note</h3>

<p>The function modifies the card matrix in-place and returns the updated matrix.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
