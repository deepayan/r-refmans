<!DOCTYPE html><html><head><title>Help for package ConSpline</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ConSpline}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ConSpline-package'><p>Partial Linear Least-squares Regression with Constrained Splines</p></a></li>
<li><a href='#conspline'><p>Partial Linear Least-Squares with Constrained Regression Splines</p></a></li>
<li><a href='#GAVoting'><p>Voting Data for Counties in Georgia, for the 2000 U.S. Presidential Election</p></a></li>
<li><a href='#WhiteSpruce'><p>Height and Diameter of 36 White Spruce trees.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Partial Linear Least-Squares Regression using Constrained
Splines</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-10-02</td>
</tr>
<tr>
<td>Author:</td>
<td>Mary C Meyer</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mary C Meyer &lt;meyer@stat.colostate.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Given response y, continuous predictor x, and covariate matrix, the relationship between E(y) and x is estimated with a shape constrained regression spline.  Function outputs fits and various types of inference.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>graphics, grDevices, stats, utils, coneproj (&ge; 1.12)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-10-02 14:49:59 UTC; xiyueliao</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-02 18:49:42 UTC</td>
</tr>
</table>
<hr>
<h2 id='ConSpline-package'>Partial Linear Least-squares Regression with Constrained Splines</h2><span id='topic+ConSpline-package'></span><span id='topic+ConSpline'></span>

<h3>Description</h3>

<p>Given a continuous response y and a continuous predictor x, and a design matrix Z of parametrically-modeled covariates, the model y=f(x)+Zb+e is fit using least-squares cone projection.   The function f is smooth and has one of eight user-defined shapes: increasing, decreasing, convex, concave, or combinations of monotonicity and convexity.   Quadratic splines are used for increasing and decreasing, while cubic splines are used for the other six shapes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> ConSpline</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-08-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The function <code>conspline</code> fits the partial linear model.   Given a response variable y, a continuous predictor x, and a design matrix Z of parametrically modeled covariates, this function solves a least-squares regression assuming that y=f(x)+Zb+e, where f is a smooth function with a user-defined shape.   The shape is assigned with the argument type, where 1=increasing, 2=decreasing, 3=convex, 4=concave, 5=increasing and convex, 6=decreasing and convex, 7=increasing and concave, 8= decreasing and concave.
</p>


<h3>Author(s)</h3>

<p>Mary C. Meyer
</p>
<p>Maintainer: Mary C. Meyer &lt;meyer@stat.colostate.edu&gt;
</p>


<h3>References</h3>

<p>Meyer, M.C. (2008) Shape-Restricted Regression Splines, <em>Annals of Applied Statistics</em>, <b>2(3)</b>,1013-1033.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(WhiteSpruce)
plot(WhiteSpruce$Diameter,WhiteSpruce$Height)
ans=conspline(WhiteSpruce$Height,WhiteSpruce$Diameter,7)
lines(sort(WhiteSpruce$Diameter),ans$muhat[order(WhiteSpruce$Diameter)])
</code></pre>

<hr>
<h2 id='conspline'>Partial Linear Least-Squares with Constrained Regression Splines
</h2><span id='topic+conspline'></span>

<h3>Description</h3>

<p>Given a response variable y, a continuous predictor x, and a design matrix Z of parametrically modeled covariates, this function solves a least-squares regression assuming that y=f(x)+Zb+e, where f is a smooth function with a user-defined shape.   The shape is assigned with the argument type, where 1=increasing, 2=decreasing, 3=convex, 4=concave, 5=increasing and convex, 6=decreasing and convex, 7=increasing and concave, 8=decreasing and concave.</p>


<h3>Usage</h3>

<pre><code class='language-R'>conspline(y,x,type,zmat=0,wt=0,knots=0,
   test=FALSE,c=1.2,nsim=10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conspline_+3A_y">y</code></td>
<td>

<p>A continuous response variable</p>
</td></tr>
<tr><td><code id="conspline_+3A_x">x</code></td>
<td>
<p>A continuous predictor variable.  The length of x must equal the length of y.</p>
</td></tr>
<tr><td><code id="conspline_+3A_type">type</code></td>
<td>
<p>An integer 1-8 describing the shape of the regression function in x.  1=increasing, 2=decreasing, 3=convex, 4=concave, 5=increasing and convex, 6=decreasing and convex, 7=increasing and concave, 8= decreasing and concave.
</p>
</td></tr>
<tr><td><code id="conspline_+3A_zmat">zmat</code></td>
<td>
<p>An optional design matrix of covariates to be modeled parametrically.  The number of rows of zmat must be the length of y.</p>
</td></tr>
<tr><td><code id="conspline_+3A_wt">wt</code></td>
<td>
<p>Optional weight vector, must be positive and of the same length as y.</p>
</td></tr>
<tr><td><code id="conspline_+3A_knots">knots</code></td>
<td>
<p>Optional user-defined knots for the spline function.  The range of the knots must contain the range of x.</p>
</td></tr>
<tr><td><code id="conspline_+3A_test">test</code></td>
<td>
<p>If test=TRUE, a test for the &quot;significance&quot; of x is performed.   For convex and concave shapes, the null hypothesis is that the relationship between y and x is linear, for any of the other shapes, the null hypothesis is that the expected value of y is constant in x.  </p>
</td></tr>
<tr><td><code id="conspline_+3A_c">c</code></td>
<td>
<p>An optional parameter for the variance estimation.  Must be between 1 and 2 inclusive.</p>
</td></tr>
<tr><td><code id="conspline_+3A_nsim">nsim</code></td>
<td>
<p>An optional specification of the number of simulated data sets to make the mixing distribution for the test statistic if test=TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A cone projection is used to fit the least-squares regression model.   The test for the significance of x is exact, while the inference for the covariates represented by the Z columns uses statistics that have approximate t-distributions.</p>


<h3>Value</h3>

<table>
<tr><td><code>muhat</code></td>
<td>
<p>The fitted values at the design points, i.e. an estimate of E(y).</p>
</td></tr>
<tr><td><code>fhat</code></td>
<td>
<p>The estimated regression function, evaluated at the x-values, describing the relationship between E(y) and x, see above description of the model.</p>
</td></tr>
<tr><td><code>fslope</code></td>
<td>
<p>The slope of fhat, evaluated at the x-values.</p>
</td></tr>
<tr><td><code>knots</code></td>
<td>
<p>The knots used in the spline function estimation.</p>
</td></tr>
<tr><td><code>pvalx</code></td>
<td>
<p>If test=TRUE, this is the p-value for the test involving the predictor x.  For convex and concave shapes, the null hypothesis is that the relationship between y and x is linear, versus the alternative that it has the assigned shape.  For any of the other shapes, the null hypothesis is that the expected value of y is constant in x, versus the assigned shape.    </p>
</td></tr>
<tr><td><code>zcoef</code></td>
<td>
<p>The estimated coefficients for the components of the regression function  given by the columns of Z.   An &quot;intercept&quot; is given if the column space of Z did not contain the constant vectors. </p>
</td></tr>
<tr><td><code>sighat</code></td>
<td>
<p>The estimate of the model variance.  Calculated as SSR/(n-cD), where SSR is the sum of squared residuals of the fit, n is the length of y, D is the observed degrees of freedom of the fit, and c is a parameter between 1 and 2.</p>
</td></tr>
<tr><td><code>zhmat</code></td>
<td>
<p>The hat matrix corresponding the columns of Z, to compute p-values for contrasts, for example.</p>
</td></tr>
<tr><td><code>sez</code></td>
<td>
<p>The standard errors for the Z coefficient estimates.   These are square roots of the diagonal values of zhmat, times the square root of sighat.</p>
</td></tr>
<tr><td><code>pvalz</code></td>
<td>
<p>Approximate p-values for the null hypotheses that the coefficients for the covariates represented by the Z columns are zero.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Mary C Meyer, Professor, Statistics Department, Colorado State University
</p>


<h3>References</h3>

<p>Meyer, M.C. (2008) Shape-Restricted Regression Splines, <em>Annals of Applied Statistics</em>, <b>2(3)</b>,1013-1033.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=60
x=1:n/n
z=sample(0:1,n,replace=TRUE)
mu=1:n*0+4
mu[x&gt;1/2]=4+5*(x[x&gt;1/2]-1/2)^2
mu=mu+z/4
y=mu+rnorm(n)/4
plot(x,y,col=z+1)
ans=conspline(y,x,5,z,test=TRUE)
points(x,ans$muhat,pch=20,col=z+1)
lines(x,ans$fhat)
lines(x,ans$fhat+ans$zcoef, col=2)
ans$pvalz  ## p-val for test of significance of z parameter
ans$pvalx  ## p-val for test for linear vs convex regression function
</code></pre>

<hr>
<h2 id='GAVoting'>Voting Data for Counties in Georgia, for the 2000 U.S. Presidential Election
</h2><span id='topic+GAVoting'></span>

<h3>Description</h3>

<p>Voting data by county, for the 150 counties in the state of Georgia, in the Bush vs Gore 2000 presidential election. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("GAVoting")</code></pre>


<h3>Format</h3>

<p>A data frame with 159 observations on the following 9 variables.
</p>

<dl>
<dt><code>county</code></dt><dd><p>the county name</p>
</dd>
<dt><code>method</code></dt><dd><p>the voting method: <code>OS-CC</code> (optical scan, central count); <code>OS-PC</code> (optical scan, precinct count); <code>LEVER</code> (lever); <code>PUNCH</code> (punch card); <code>PAPER</code> (paper ballot)</p>
</dd>
<dt><code>econ</code></dt><dd><p>the economic level of the county according to OneGeorgia: <code>poor</code>; <code>middle</code>; <code>rich</code></p>
</dd>
<dt><code>percent.black</code></dt><dd><p>proportion of registered voters who are black</p>
</dd>
<dt><code>gore</code></dt><dd><p>number of votes recorded for Mr Gore</p>
</dd>
<dt><code>bush</code></dt><dd><p>number of votes recorded for Mr Bush</p>
</dd>
<dt><code>other</code></dt><dd><p>number of votes recorded for a third candidate</p>
</dd>
<dt><code>votes</code></dt><dd><p>number of votes recorded</p>
</dd>
<dt><code>ballots</code></dt><dd><p>number of ballots received</p>
</dd>
</dl>



<h3>Details</h3>

<p>The uncounted votes in the 2000 presidential election were a concern in the state of Florida, where 2.9 percent of the ballots did not have vote for president recorded.   Because the election was close in that state, the voting methods and other issues were scrutinized.   In the state of Georgia, 3.5 percent of the votes were uncounted.   This data set gives votes by county, along with other data including voting method.  A properly weighted ANOVA will show that proportions of uncounted votes are significantly higher with counties using the punch card method.
</p>


<h3>References</h3>

<p>Meyer, M.C. (2002).  Uncounted Votes: Does Voting Equipment Matter?  Chance Magazine, 15(4), pp33-38.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GAVoting)
obs1=1:5
obs2=1:3
meth=1:159
econ=1:159
types=unique(GAVoting$method)
econs=unique(GAVoting$econ)
for(i in 1:159){
	meth[i]=obs1[GAVoting$method[i]==types]
	econ[i]=obs2[GAVoting$econ[i]==econs]
}
punc=100*(1-GAVoting$votes/GAVoting$ballots)
par(mar=c(4,4,1,1))
plot(GAVoting$percent.black,punc,xlab="Proportion of black voters",
  ylab="percent uncounted votes",col=meth,pch=econ)
legend(0,18.5,pch=1:3,legend=c("poor","middle","rich"))
legend(.63,18.5,pch=c(1,1,1,1,1),col=1:5,
  legend=c("lever","OS-CC","OS-PC","punch","paper"))

zmat=matrix(0,ncol=4,nrow=159)
for(i in 1:4){zmat[meth==i+1,i]=1}

ans1=conspline(punc,GAVoting$percent.black,1,zmat,wt=GAVoting$ballots)
lines(sort(GAVoting$percent.black),
   ans1$fhat[order(GAVoting$percent.black)],col=1)
for(i in 1:4){
	lines(sort(GAVoting$percent.black),
	ans1$fhat[order(GAVoting$percent.black)]+ans1$zcoef[i],col=i+1)
}
</code></pre>

<hr>
<h2 id='WhiteSpruce'>Height and Diameter of 36 White Spruce trees.</h2><span id='topic+WhiteSpruce'></span>

<h3>Description</h3>

<p>A standard scatterplot example from various statistics text books, representing height versus diameter of White Spruce trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("WhiteSpruce")</code></pre>


<h3>Format</h3>

<p>A data frame with 36 observations on the following 2 variables.
</p>

<dl>
<dt><code>Diameter</code></dt><dd><p>Diameter at &quot;breast height&quot; of tree</p>
</dd>
<dt><code>Height</code></dt><dd><p>Height of tree</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(WhiteSpruce)
plot(WhiteSpruce$Diameter,WhiteSpruce$Height)
ans=conspline(WhiteSpruce$Height,WhiteSpruce$Diameter,7)
lines(sort(WhiteSpruce$Diameter),ans$muhat[order(WhiteSpruce$Diameter)])
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
