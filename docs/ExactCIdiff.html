<!DOCTYPE html><html><head><title>Help for package ExactCIdiff</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ExactCIdiff}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Exact one-sided and two-sided 1-alpha confidence interval for two dependent proportions'><p>Inductive confidence intervals for the Difference Between Two Proportions</p></a></li>
<li><a href='#Exact one-sided and two-sided 1-alpha confidence interval two independent proportions'><p>Inductive confidence intervals for the Difference Between Two Proportions</p></a></li>
<li><a href='#Exact one-sided and two-sided 1-alpha confidence interval, main functions'><p>Inductive confidence intervals for the difference between two proportions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Inductive Confidence Intervals for the Difference Between Two
Proportions</td>
</tr>
<tr>
<td>Author:</td>
<td>Guogen Shan &lt;gshan@ufl.edu&gt;, Weizhen Wang &lt;weizhen.wang@wright.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guogen Shan &lt;gshan@ufl.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.8.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a package for exact Confidence Intervals for the difference between two independent or dependent proportions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org&amp;d=DwICaQ&amp;c=sJ6xIWYx-zLMB3EPkvcnVg&amp;r=u5749-0kOlGR1AfizUVmaw&amp;m=qjJHLdipM5gUyXllZWH5kL0wENGFef6KuJ57hW5lHx14eZasfdmgFN_1geUbxk5J&amp;s=VFf9h_9FOlJBpRMIjim8tGuVnJ7GlWc5qZkrA9kmoMM&amp;e=">https://urldefense.proofpoint.com/v2/url?u=http-3A__www.R-2Dproject.org&amp;d=DwICaQ&amp;c=sJ6xIWYx-zLMB3EPkvcnVg&amp;r=u5749-0kOlGR1AfizUVmaw&amp;m=qjJHLdipM5gUyXllZWH5kL0wENGFef6KuJ57hW5lHx14eZasfdmgFN_1geUbxk5J&amp;s=VFf9h_9FOlJBpRMIjim8tGuVnJ7GlWc5qZkrA9kmoMM&amp;e=</a>,
<a href="https://biostat.ufl.edu/profile/shan-guogen/">https://biostat.ufl.edu/profile/shan-guogen/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-08 15:17:17 UTC; gshan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-08 21:50:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='Exact+20one-sided+20and+20two-sided+201-alpha+20confidence+20interval+20for+20two+20dependent+20proportions'>Inductive confidence intervals for the Difference Between Two Proportions</h2><span id='topic+PairedCI'></span>

<h3>Description</h3>

<p>Three exact confidence intervals (two-sided, smallest lower one-sided and  smallest upper one-sided)  of level 1-alpha are constructed for p1-p2,
the difference of two dependent proportions. 
</p>
<p>A random vector (n11,n12,n21,n22) follows 
multinomial(N, p11,p12,p21,p22) where N=n11+n12+n21+n22, 
and p1-p2=(p11+p12)-(p11+p21)=p12-p21. Let t=n11+n22. 
Intervals [L(n12,t,n21),1], [-1,U(n12,t,n21)] and [L(n12,t,n21),U(n12,t,n21)] are of interest. 
</p>
<p>This package can be used to calculate these intervals using an inductive method
developed by Wang (2012).           
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PairedCI(n12,t,n21,conf.level,CItype,precision,grid.one,grid.two)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_n12">n12</code></td>
<td>
<p>the number of subjects in the paired study who have success from the treatment and failure from the control</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_t">t</code></td>
<td>
<p>the number of subjects in the paired study who have the same results from the treatment and control, t=n11+n22</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_n21">n21</code></td>
<td>
<p>the number of subjects in the paired study who have success from the contol and failure from the treatment</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_conf.level">conf.level</code></td>
<td>
<p>Confience level, 95% is the default value.</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_citype">CItype</code></td>
<td>
<p>c(&quot;Lower&quot;,&quot;Upper&quot;,&quot;Two.sided&quot;), lower one-sided confidence interval [L,1], upper one-sided confidence interval [-1,U], two-sided confidence interval [L,U], &quot;Two.sided&quot; is the default value</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_precision">precision</code></td>
<td>
<p>Precision of the confidence interval, default is 0.00001 rounded to 5 decimals</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_grid.one">grid.one</code></td>
<td>
<p>two-step grid search algorithm is used. grid.one is the number of points for searching the global maximum of the tail probability in the first step. 30 is the default value</p>
</td></tr>   
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20for+2B20two+2B20dependent+2B20proportions_+3A_grid.two">grid.two</code></td>
<td>
<p>grid.two is the number of points for searching the global maximum of the tail probability in the second step. 20 is the default value</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>An inductive construction is carried out to obtain one-sided interval. At each step we rank sample 
point by its potential confidence interval and then select the one with the
shortest interval. The difference of the two proportions is the parameter of interest.
There is a nuisance parameter in the tail probability 
(Eq (8) in Wang 2012). The nuisance parameter is 
eliminated by the maximization originally proposed by Buehler (1957).
A two-step grid search algorithm is applied to find the maximum. 
The first step is to roughly identify a neighbor area of the global 
maximization of the tail probability,  more points used more accurate results achieved. 
We recommend to use grid.one at least 30 to have accurate confidence intervals. 
The second step is to search for maximum within that smaller neighbor area, and  grid.two should be
at least 20. We find that this two-step grid search algorithm works much more accurate and efficient 
than the traditional one-step grid search algorithm. 1-alpha two-sided interval is equal to the 
intersection of two 1-alpha/2 one-sided intervals.
</p>
<p>Details and more examples see: http://www.wright.edu/~weizhen.wang/software/ExactTwoProp/examples.pdf
</p>


<h3>Value</h3>

<p>PairedCI gives the estimate of (p1-p2), which is (n12/-n21)/(n12+t+n21), and the exact confidence interval.
</p>


<h3>References</h3>

<p>Wang, W. (2012). An inductive order construction for the difference of two dependent proportions. Statistical and Probability Letters, 82, 1623&ndash;1628.
</p>
<p>Buehler, R. (1957). Confidence intervals for the porduct of two binomial parameters. JASA, 52, 482&ndash;493.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#lower one-sided confidence intervals in Table 1 of Wang 2012 
PairedCI(3,1,0,conf.level=0.95,CItype="Lower")
PairedCI(2,0,2,conf.level=0.95,CItype="Lower")

#Upper one-sided confidence intervals for the difference of two dependent proportions
PairedCI(3,1,0,CItype="Upper",conf.level=0.95)
PairedCI(1,1,2,CItype="Upper",conf.level=0.9,grid.one=40,grid.two=25)

#Two-sided 90% confidence intervals
PairedCI(3,1,0,CItype='Two.sided',conf.level=0.9)

</code></pre>

<hr>
<h2 id='Exact+20one-sided+20and+20two-sided+201-alpha+20confidence+20interval+20two+20independent+20proportions'>Inductive confidence intervals for the Difference Between Two Proportions</h2><span id='topic+BinomCI'></span>

<h3>Description</h3>

<p>Three exact confidence intervals (two-sided, smallest lower one-sided and  smallest upper one-sided)  of level 1-alpha are constructed for p1-p2,
the difference of two independent proportions. 
</p>
<p>X follows Binomial(n1,p1), Y follows Binomial(n2,p2) and X and Y are independent. Intervals [L(X,Y),1], [-1,U(X,Y)] and [L(X,Y),U(X,Y)] are of interest. 
</p>
<p>This package can be used to calculate these intervals using an inductive method
developed by Wang (2010).           
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BinomCI(n1,n2,x,y,conf.level,CItype,precision,grid.one,grid.two)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_n1">n1</code></td>
<td>
<p>the number of trials in the first group in the parallel two-arm study</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_n2">n2</code></td>
<td>
<p>the number of trials in the second group in the parallel two-arm study</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_x">x</code></td>
<td>
<p>the number of successes from the first group in the parallel two-arm study</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_y">y</code></td>
<td>
<p>the number of successes from the second group in the parallel two-arm study</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_conf.level">conf.level</code></td>
<td>
<p>Confience level, 95% is the default value.</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_citype">CItype</code></td>
<td>
<p>c(&quot;Lower&quot;,&quot;Upper&quot;,&quot;Two.sided&quot;), lower one-sided confidence interval [L,1], upper one-sided confidence interval [-1,U], two-sided confidence interval [L,U], &quot;Two.sided&quot; is the default value</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_precision">precision</code></td>
<td>
<p>Precision of the confidence interval, default is 0.00001 rounded to 5 decimals</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_grid.one">grid.one</code></td>
<td>
<p>two-step grid search algorithm is used. grid.one is the number of points for searching the global maximum of the tail probability in the first step. 30 is the default value</p>
</td></tr>   
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B20two+2B20independent+2B20proportions_+3A_grid.two">grid.two</code></td>
<td>
<p>grid.two is the number of points for searching the global maximum of the tail probability in the second step. 20 is the default value</p>
</td></tr>   
</table>


<h3>Details</h3>

<p>An inductive construction is carried out to obtain one-sided interval. At each step we rank sample 
point by its potential confidence interval and then select the one with the
shortest interval. The difference of the two proportions is the parameter of interest.
There is a nuisance parameter in the tail probability 
(Eq (6) in Wang 2010). The nuisance parameter is 
eliminated by the maximization originally proposed by Buehler (1957).
A two-step grid search algorithm is applied to find the maximum. 
The first step is to roughly identify a neighbor area of the global 
maximization of the tail probability,  more points used more accurate results achieved. 
We recommend to use grid.one at least 30 to have accurate confidence intervals. 
The second step is to search for maximum within that smaller neighbor area, and  grid.two should be
at least 20. We find that this two-step grid search algorithm works much more accurate and efficient 
than the traditional one-step grid search algorithm. 1-alpha two-sided interval is equal to the 
intersection of two 1-alpha/2 one-sided intervals.
</p>
<p>Details and more examples see: http://www.wright.edu/~weizhen.wang/software/ExactTwoProp/examples.pdf
</p>


<h3>Value</h3>

<p>BinomCI gives the estimate of (p1-p2), which is x/n1-y/n2, and the exact confidence interval.
</p>


<h3>References</h3>

<p>Wang, W. (2010). On construction of the smallest one-sided confidence interval for the difference of two proportions. The Annals of Statistics, 38, 1227&ndash;1243.
</p>
<p>Buehler, R. (1957). Confidence intervals for the porduct of two binomial parameters. JASA, 52, 482&ndash;493.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#lower one-sided confidence interval with n1=4,n2=1,x=2,and y=0 in Wang 2010 
BinomCI(4,1,2,0,CItype="Lower")

#Upper one-sided confidence interval with n1=4,n2=1,x=2,and y=0.
BinomCI(4,1,2,0,CItype="Upper")


#Two-sided 90% confidence intervals
BinomCI(5,5,4,2,conf.level=0.9,CItype='Two.sided')

</code></pre>

<hr>
<h2 id='Exact+20one-sided+20and+20two-sided+201-alpha+20confidence+20interval+2C+20main+20functions'>Inductive confidence intervals for the difference between two proportions</h2><span id='topic+BinomialCIone'></span><span id='topic+PairedCIone'></span>

<h3>Description</h3>

<p>The function BinomialCIone and PairedCIone are the called functions for the main function BinomCI and PairedCI, respectively.         
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_n12">n12</code></td>
<td>
<p>the number of subjects in the paired study who have success from the treatment and failure from the control</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_t">t</code></td>
<td>
<p>the number of subjects in the paired study who have the same results from the treatment and control, t=n11+n22</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_n21">n21</code></td>
<td>
<p>the number of subjects in the paired study who have success from the contol and failure from the treatment</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_conf.level">conf.level</code></td>
<td>
<p>Confience level, 95% is the default value.</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_citype">CItype</code></td>
<td>
<p>c(&quot;Lower&quot;,&quot;Upper&quot;,&quot;Two.sided&quot;), lower one-sided confidence interval [L,1], upper one-sided confidence interval [-1,U], two-sided confidence interval [L,U], &quot;Two.sided&quot; is the default value</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_precision">precision</code></td>
<td>
<p>Precision of the confidence interval, default is 0.00001 rounded to 5 decimals</p>
</td></tr>
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_grid.one">grid.one</code></td>
<td>
<p>two-step grid search algorithm is used. grid.one is the number of points for searching the global maximum of the tail probability in the first step. 30 is the default value</p>
</td></tr>   
<tr><td><code id="Exact+2B20one-sided+2B20and+2B20two-sided+2B201-alpha+2B20confidence+2B20interval+2B2C+2B20main+2B20functions_+3A_grid.two">grid.two</code></td>
<td>
<p>grid.two is the number of points for searching the global maximum of the tail probability in the second step. 20 is the default value</p>
</td></tr>   
</table>


<h3>Value</h3>

<p>PairedCI gives the estimate of (p1-p2), which is (n12/-n21)/(n12+t+n21), and the exact confidence interval.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
