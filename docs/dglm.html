<!DOCTYPE html><html><head><title>Help for package dglm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dglm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.dglm'><p>Analysis of Deviance for Double Generalized Linear Model Fits</p></a></li>
<li><a href='#dglm'><p>Double Generalized Linear Models</p></a></li>
<li><a href='#dglm-class'><p>Double Generalized Linear Model - class</p></a></li>
<li><a href='#dglm.control'><p>Auxiliary for controlling double glm fitting</p></a></li>
<li><a href='#residuals.dglm'><p>Extract Residuals from Double Generalized Linear Model Fit</p></a></li>
<li><a href='#summary.dglm'><p>Summarize Double Generalized Linear Model Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.8.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-25</td>
</tr>
<tr>
<td>Title:</td>
<td>Double Generalized Linear Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Gordon Smyth, Peter K Dunn &lt;pdunn2@usc.edu.au&gt;, Robert W. Corty</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gordon Smyth &lt;smyth@wehi.edu.au&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.8.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>statmod, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Model fitting and evaluation tools for double generalized linear
    models (DGLMs). This class of models uses one generalized linear model (GLM)
    to fit the specified response and a second GLM to fit the deviance of the first
    model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-25 05:38:07 UTC; smyth</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-25 06:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.dglm'>Analysis of Deviance for Double Generalized Linear Model Fits</h2><span id='topic+anova.dglm'></span>

<h3>Description</h3>

<p>Compute an analysis of deviance table for one or more double generalized
linear model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dglm'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.dglm_+3A_object">object</code></td>
<td>
<p>objects of class <code>dglm</code>, typically
the result of a call to <code><a href="#topic+dglm">dglm</a></code>.</p>
</td></tr>
<tr><td><code id="anova.dglm_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifying a single object gives sequential and adjusted likelihood ratio
tests for the mean and dispersion model components of the fit.
The aim is to test overall significance for the mean and dispersion components
of the double generalized linear model fit.
The sequential tests (i) set both mean and dispersion models constant,
add the mean model and (ii) sequentially add the dispersion model.
The adjusted tests determine whether the mean and dispersion models can be set
constant separately.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
</p>


<h3>Note</h3>

<p>The anova method is questionable when applied to an <code>"dglm"</code> object with 
<code>method="reml"</code> (stick to <code>method="ml"</code>).
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth,
ported to R by Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Hastie, T. J. and Pregibon, D. (1992)
<em>Generalized linear models.</em>
Chapter 6 of <em>Statistical Models in S</em>,
edited by J. M. Chambers and T. J. Hastie,
Wadsworth and Brooks/Cole.
</p>
<p>Smyth, G. K. (1989). Generalized linear models with varying dispersion.  
<em>J. R. Statist. Soc. B</em>, <b>51</b>, 47&ndash;60.
<a href="https://doi.org/10.1111/j.2517-6161.1989.tb01747.x">doi:10.1111/j.2517-6161.1989.tb01747.x</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999). 
Adjusted likelihood methods for modelling dispersion in generalized linear models.
<em>Environmetrics</em>, <b>10</b>, 696-709.
<a href="https://doi.org/10.1002/%28SICI%291099-095X%28199911/12%2910%3A6%3C695%3A%3AAID-ENV385%3E3.0.CO%3B2-M">doi:10.1002/(SICI)1099-095X(199911/12)10:6&lt;695::AID-ENV385&gt;3.0.CO;2-M</a>
<a href="https://gksmyth.github.io/pubs/Ties98-Preprint.pdf">https://gksmyth.github.io/pubs/Ties98-Preprint.pdf</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999).
Double generalized linear models: approximate REML and diagnostics.
In <em>Statistical Modelling: Proceedings of the 14th International Workshop on Statistical Modelling</em>, Graz, Austria, July 19-23, 1999, H. Friedl, A. Berghold, G. Kauermann (eds.), Technical University, Graz, Austria, pages 66-80.
<a href="https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf">https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dglm">dglm</a></code>, <code><a href="stats.html#topic+anova">anova</a></code>.
</p>

<hr>
<h2 id='dglm'>Double Generalized Linear Models</h2><span id='topic+dglm'></span><span id='topic+dglm.constant'></span>

<h3>Description</h3>

<p>Fits a generalized linear model with a link-linear model for the dispersion as well as for the mean.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dglm(formula=formula(data), dformula = ~ 1, family = gaussian, dlink = "log", 
data = parent.frame(), subset = NULL, weights = NULL, contrasts = NULL, 
method = "ml", mustart = NULL, betastart = NULL, etastart = NULL, phistart = NULL, 
control = dglm.control(...), ykeep = TRUE, xkeep = FALSE, zkeep = FALSE, ...)

dglm.constant(y, family, weights = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dglm_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit. 
The details of model specification are found in <code><a href="#topic+dglm">dglm</a></code>.</p>
</td></tr>
<tr><td><code id="dglm_+3A_dformula">dformula</code></td>
<td>
<p>a formula expression of the form  
<code>~ predictor</code>, the response being ignored. 
This specifies the linear predictor for modelling the dispersion. 
A term of the form <code>offset(expression)</code> is allowed.</p>
</td></tr>
<tr><td><code id="dglm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to
be used in the model. 
See <code><a href="stats.html#topic+glm">glm</a></code> for more information.</p>
</td></tr>
<tr><td><code id="dglm_+3A_dlink">dlink</code></td>
<td>
<p>link function for modelling the dispersion. 
Any link function accepted by the <code>quasi</code>
family is allowed, including <code>power(x)</code>. See details below.</p>
</td></tr>
<tr><td><code id="dglm_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables in the model.
See <code><a href="stats.html#topic+glm">glm</a></code> for more information.</p>
</td></tr>
<tr><td><code id="dglm_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be
used in the fitting process.</p>
</td></tr>
<tr><td><code id="dglm_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used in the fitting
process.</p>
</td></tr>
<tr><td><code id="dglm_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code> of
<code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code>.</p>
</td></tr>
<tr><td><code id="dglm_+3A_method">method</code></td>
<td>
<p>the method used to estimate the dispersion parameters; 
the default is <code>"reml"</code> for restricted maximum likelihood 
and the alternative is <code>"ml"</code> for maximum likelihood. 
Upper case and partial matches are allowed.</p>
</td></tr>
<tr><td><code id="dglm_+3A_mustart">mustart</code></td>
<td>
<p>numeric vector giving starting values for the fitted values 
or expected responses. 
Must be of the same length as the response, 
or of length 1 if a constant starting vector is desired. 
Ignored if <code>betastart</code> is supplied.</p>
</td></tr>
<tr><td><code id="dglm_+3A_betastart">betastart</code></td>
<td>
<p>numeric vector giving starting values for the 
regression coefficients in the link-linear model for the mean.</p>
</td></tr>
<tr><td><code id="dglm_+3A_etastart">etastart</code></td>
<td>
<p>numeric vector giving starting values for the 
linear predictor for the mean model.</p>
</td></tr>
<tr><td><code id="dglm_+3A_phistart">phistart</code></td>
<td>
<p>numeric vector giving starting values for the dispersion
parameters.</p>
</td></tr>
<tr><td><code id="dglm_+3A_control">control</code></td>
<td>
<p>a list of iteration and algorithmic constants. 
See <code><a href="#topic+dglm.control">dglm.control</a></code> for their names and default values. 
These can also be set as arguments to <code>dglm</code> itself.</p>
</td></tr>
<tr><td><code id="dglm_+3A_ykeep">ykeep</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the vector of responses is returned.</p>
</td></tr>
<tr><td><code id="dglm_+3A_xkeep">xkeep</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the <code>model.matrix</code> for the mean
model is returned.</p>
</td></tr>
<tr><td><code id="dglm_+3A_zkeep">zkeep</code></td>
<td>
<p>logical flag: if <code>TRUE</code>, the <code>model.matrix</code> for the
dispersion model is returned.</p>
</td></tr>
<tr><td><code id="dglm_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="dglm_+3A_y">y</code></td>
<td>
<p>numeric response vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Write <code class="reqn">\mu_i = \mbox{E}[y_i]</code> for the expectation of the 
<code class="reqn">i</code>th response. 
Then <code class="reqn">\mbox{Var}[Y_i] = \phi_i V(\mu_i)</code> where <code class="reqn">V</code>
is the variance function and <code class="reqn">\phi_i</code> is the dispersion of the 
<code class="reqn">i</code>th response 
(often denoted as the Greek character &lsquo;phi&rsquo;). 
We assume the link linear models
<code class="reqn">g(\mu_i) = \mathbf{x}_i^T \mathbf{b}</code> and
<code class="reqn">h(\phi_i) = \mathbf{z}_i^T \mathbf{z}</code>,
where <code class="reqn">\mathbf{x}_i</code> and <code class="reqn">\mathbf{z}_i</code> are vectors of covariates,
and <code class="reqn">\mathbf{b}</code> and <code class="reqn">\mathbf{a}</code> are vectors of regression
cofficients affecting the mean and dispersion respectively. 
The argument <code>dlink</code> specifies <code class="reqn">h</code>. 
See <code><a href="stats.html#topic+family">family</a></code> for how to specify <code class="reqn">g</code>. 
The optional arguments <code>mustart</code>, <code>betastart</code> and <code>phistart</code>
specify starting values for <code class="reqn">\mu_i</code>, <code class="reqn">\mathbf{b}</code>
and <code class="reqn">\phi_i</code> respectively.
</p>
<p>The parameters <code class="reqn">\mathbf{b}</code> are estimated as for an ordinary <abbr><span class="acronym">glm</span></abbr>.
The parameters <code class="reqn">\mathbf{a}</code> are estimated by way of a dual <abbr><span class="acronym">glm</span></abbr>
in which the deviance components of the ordinary <abbr><span class="acronym">glm</span></abbr> appear as responses.
The estimation procedure alternates between one iteration for the mean submodel 
and one iteration for the dispersion submodel until overall convergence.
</p>
<p>The output from <code>dglm</code>, <code>out</code> say, consists of two <code>glm</code> objects
(that for the dispersion submodel is <code>out$dispersion.fit</code>) with a few more
components for the outer iteration and overall likelihood. 
The <code>summary</code> and <code>anova</code> functions have special methods for <code>dglm</code>
objects. 
Any generic function that has methods for <code>glm</code>s or <code>lm</code>s will work on
<code>out</code>, giving information about the mean submodel. 
Information about the dispersion submodel can be obtained by using
<code>out$dispersion.fit</code> as argument rather than out itself. 
In particular <code>drop1(out,scale=1)</code> gives correct score statistics for 
removing terms from the mean submodel, 
while <code>drop1(out$dispersion.fit,scale=2)</code> gives correct score 
statistics for removing terms from the dispersion submodel.
</p>
<p>The dispersion submodel is treated as a gamma family unless the original 
reponses are gamma, in which case the dispersion submodel is digamma. 
This is exact if the original glm family is <code>gaussian</code>,
<code>Gamma</code> or <code>inverse.gaussian</code>. In other cases it can be 
justified by the saddle-point approximation to the density of the responses. 
The results will therefore be close to exact ML or REML when the dispersions 
are small compared to the means. In all cases the dispersion submodel has prior
weights 1, and has its own dispersion parameter which is 2.
</p>


<h3>Value</h3>

<p>an object of class <code>dglm</code> is returned, 
which inherits from <code>glm</code> and <code>lm</code>. 
See <code><a href="#topic+dglm-class">dglm-class</a></code> for details.
</p>


<h3>Note</h3>

<p>The anova method is questionable when applied to an <code>dglm</code> object with
<code>method="reml"</code> (stick to <code>method="ml"</code>). 
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth, ported to R by Peter Dunn</p>


<h3>References</h3>

<p>Smyth, G. K. (1989). Generalized linear models with varying dispersion. 
<em>J. R. Statist. Soc. B</em>, <b>51</b>, 47&ndash;60.
<a href="https://doi.org/10.1111/j.2517-6161.1989.tb01747.x">doi:10.1111/j.2517-6161.1989.tb01747.x</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999). 
Adjusted likelihood methods for modelling dispersion in generalized linear models.
<em>Environmetrics</em>, <b>10</b>, 696-709.
<a href="https://doi.org/10.1002/%28SICI%291099-095X%28199911/12%2910%3A6%3C695%3A%3AAID-ENV385%3E3.0.CO%3B2-M">doi:10.1002/(SICI)1099-095X(199911/12)10:6&lt;695::AID-ENV385&gt;3.0.CO;2-M</a>
<a href="https://gksmyth.github.io/pubs/Ties98-Preprint.pdf">https://gksmyth.github.io/pubs/Ties98-Preprint.pdf</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999).
Double generalized linear models: approximate REML and diagnostics.
In <em>Statistical Modelling: Proceedings of the 14th International Workshop on Statistical Modelling</em>, Graz, Austria, July 19-23, 1999, H. Friedl, A. Berghold, G. Kauermann (eds.), Technical University, Graz, Austria, pages 66-80.
<a href="https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf">https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dglm-class">dglm-class</a></code>, <code><a href="#topic+dglm.control">dglm.control</a></code>, 
<code>Digamma family</code>, <code>Polygamma</code>.
</p>
<p>See <a href="https://gksmyth.github.io/s/dglm.html">https://gksmyth.github.io/s/dglm.html</a> for the original S-Plus code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Continuing the example from glm, but this time try
# fitting a Gamma double generalized linear model also.
clotting &lt;- data.frame(
      u = c(5,10,15,20,30,40,60,80,100),
      lot1 = c(118,58,42,35,27,25,21,19,18),
      lot2 = c(69,35,26,21,18,16,13,12,12))
         
# The same example as in  glm: the dispersion is modelled as constant
# However, dglm uses  ml  not  reml,  so the results are slightly different:
out &lt;- dglm(lot1 ~ log(u), ~1, data=clotting, family=Gamma)
summary(out)

# Try a double glm 
out2 &lt;- dglm(lot1 ~ log(u), ~u, data=clotting, family=Gamma)

summary(out2)
anova(out2)

# Summarize the mean model as for a glm
summary.glm(out2)
    
# Summarize the dispersion model as for a glm
summary(out2$dispersion.fit)

# Examine goodness of fit of dispersion model by plotting residuals
plot(fitted(out2$dispersion.fit),residuals(out2$dispersion.fit)) 
</code></pre>

<hr>
<h2 id='dglm-class'>Double Generalized Linear Model - class</h2><span id='topic+dglm-class'></span>

<h3>Description</h3>

<p>Class of objects returned by fitting double generalized linear models.</p>


<h3>Details</h3>

<p>Write <code class="reqn">\mu_i = \mbox{E}[y_i]</code> for the expectation of the 
<code class="reqn">i</code>th response. 
Then <code class="reqn">\mbox{Var}[Y_i] = \phi_i V(\mu_i)</code> where <code class="reqn">V</code>
is the variance function and <code class="reqn">\phi_i</code> is the dispersion of the 
<code class="reqn">i</code>th response 
(often denoted as the Greek character &lsquo;phi&rsquo;). 
We assume the link linear models
<code class="reqn">g(\mu_i) = \mathbf{x}_i^T \mathbf{b}</code> and
<code class="reqn">h(\phi_i) = \mathbf{z}_i^T \mathbf{z}</code>,
where <code class="reqn">\mathbf{x}_i</code> and <code class="reqn">\mathbf{z}_i</code> are vectors of covariates,
and <code class="reqn">\mathbf{b}</code> and <code class="reqn">\mathbf{a}</code> are vectors of regression
cofficients affecting the mean and dispersion respectively. 
The argument <code>dlink</code> specifies <code class="reqn">h</code>. 
See <code><a href="stats.html#topic+family">family</a></code> for how to specify <code class="reqn">g</code>. 
The optional arguments <code>mustart</code>, <code>betastart</code> and <code>phistart</code>
specify starting values for <code class="reqn">\mu_i</code>, <code class="reqn">\mathbf{b}</code>
and <code class="reqn">\phi_i</code> respectively.
</p>
<p>The parameters <code class="reqn">\mathbf{b}</code> are estimated as for an ordinary <abbr><span class="acronym">glm</span></abbr>.
The parameters <code class="reqn">\mathbf{a}</code> are estimated by way of a dual <abbr><span class="acronym">glm</span></abbr>
in which the deviance components of the ordinary <abbr><span class="acronym">glm</span></abbr> appear as responses.
The estimation procedure alternates between one iteration for the mean submodel 
and one iteration for the dispersion submodel until overall convergence.
</p>
<p>The output from <code>dglm</code>, <code>out</code> say, consists of two <code>glm</code> objects
(that for the dispersion submodel is <code>out$dispersion.fit</code>) with a few more
components for the outer iteration and overall likelihood. 
The <code>summary</code> and <code>anova</code> functions have special methods for <code>dglm</code>
objects. 
Any generic function that has methods for <code>glm</code>s or <code>lm</code>s will work on
<code>out</code>, giving information about the mean submodel. 
Information about the dispersion submodel can be obtained by using
<code>out$dispersion.fit</code> as argument rather than out itself. 
In particular <code>drop1(out,scale=1)</code> gives correct score statistics for 
removing terms from the mean submodel, 
while <code>drop1(out$dispersion.fit,scale=2)</code> gives correct score 
statistics for removing terms from the dispersion submodel.
</p>
<p>The dispersion submodel is treated as a gamma family unless the original 
reponses are gamma, in which case the dispersion submodel is digamma. 
This is exact if the original glm family is <code>gaussian</code>,
<code>Gamma</code> or <code>inverse.gaussian</code>. In other cases it can be 
justified by the saddle-point approximation to the density of the responses. 
The results will therefore be close to exact ML or REML when the dispersions 
are small compared to the means. In all cases the dispersion submodel has prior
weights 1, and has its own dispersion parameter which is 2.
</p>


<h3>Generation</h3>

<p>This class of objects is returned by the <code><a href="#topic+dglm">dglm</a></code> function 
to represent a fitted double generalized linear model. 
Class <code>"dglm"</code> inherits from class <code>"glm"</code>, 
since it consists of two coupled generalized linear models, 
one for the mean and one for the dispersion. 
Like <code>glm</code>, 
it also inherits from <code>lm</code>. 
The object returned has all the components of a <code>glm</code> object. 
The returned component <code>object$dispersion.fit</code> is also a 
<code>glm</code> object in its own right, 
representing the result of modelling the dispersion.
</p>


<h3>Methods</h3>

<p>Objects of this class have methods for the functions 
<code>print</code>, <code>plot</code>, <code>summary</code>, <code>anova</code>, <code>predict</code>, 
<code>fitted</code>, <code>drop1</code>, <code>add1</code>, and <code>step</code>, amongst others.
Specific methods (not shared with <code>glm</code>) exist for 
<code>summary</code> and <code>anova</code>. 
</p>


<h3>Structure</h3>

<p>A <code>dglm</code> object consists of a <code>glm</code> object with the following additional components:
</p>

<table>
<tr>
 <td style="text-align: left;">
		<code>dispersion.fit</code> </td><td style="text-align: left;"> the dispersion submodel: a <code>glm</code> object 
representing the fitted model for the dispersions. 
The responses for this model are the deviance components from the original
generalized linear model. 
The prior weights are 1 and the dispersion or scale of this model is 2.</td>
</tr>
<tr>
 <td style="text-align: left;">
		
		<code>iter</code> </td><td style="text-align: left;"> this component now represents the number of outer iterations 
used to fit the coupled mean-dispersion models. 
At each outer iteration, one IRLS is done for each of the mean and dispersion
submodels.</td>
</tr>
<tr>
 <td style="text-align: left;">
		
		<code>method</code> </td><td style="text-align: left;"> fitting method used: <code>"ml"</code> if maximum likelihood 
was used or <code>"reml"</code> if adjusted profile likelihood was used.</td>
</tr>
<tr>
 <td style="text-align: left;">
		
		<code>m2loglik</code> </td><td style="text-align: left;"> minus twice the log-likelihood or 
adjusted profile likelihood of the fitted model.</td>
</tr>
<tr>
 <td style="text-align: left;">
	</td>
</tr>

</table>



<h3>Note</h3>

<p>The anova method is questionable when applied to an <code>dglm</code> object with
<code>method="reml"</code> (stick to <code>method="ml"</code>). 
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth,
ported to R by Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Smyth, G. K. (1989). Generalized linear models with varying dispersion. 
<em>J. R. Statist. Soc. B</em>, <b>51</b>, 47&ndash;60.
<a href="https://doi.org/10.1111/j.2517-6161.1989.tb01747.x">doi:10.1111/j.2517-6161.1989.tb01747.x</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999). 
Adjusted likelihood methods for modelling dispersion in generalized linear models.
<em>Environmetrics</em>, <b>10</b>, 696-709.
<a href="https://doi.org/10.1002/%28SICI%291099-095X%28199911/12%2910%3A6%3C695%3A%3AAID-ENV385%3E3.0.CO%3B2-M">doi:10.1002/(SICI)1099-095X(199911/12)10:6&lt;695::AID-ENV385&gt;3.0.CO;2-M</a>
<a href="https://gksmyth.github.io/pubs/Ties98-Preprint.pdf">https://gksmyth.github.io/pubs/Ties98-Preprint.pdf</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999).
Double generalized linear models: approximate REML and diagnostics.
In <em>Statistical Modelling: Proceedings of the 14th International Workshop on Statistical Modelling</em>, Graz, Austria, July 19-23, 1999, H. Friedl, A. Berghold, G. Kauermann (eds.), Technical University, Graz, Austria, pages 66-80.
<a href="https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf">https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dglm">dglm</a></code>, <code>Digamma family</code>, <code>Polygamma</code></p>

<hr>
<h2 id='dglm.control'>Auxiliary for controlling double glm fitting</h2><span id='topic+dglm.control'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for fitting double
generalized linear models. 
Typically only used when calling <code>dglm</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dglm.control(epsilon = 1e-007, maxit = 50, trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dglm.control_+3A_epsilon">epsilon</code></td>
<td>
<p>positive convergence tolerance epsilon; the iterations
converge when 
<code class="reqn">(|L_o - L|)/(|L_o| + 1) &gt; \epsilon</code>,
where <code class="reqn">L_o</code> is minus twice the values of log-likelihood
on the previous iteration, and
<code class="reqn">L</code> is minus twice the values of log-likelihood
on the current.
</p>
</td></tr>
<tr><td><code id="dglm.control_+3A_maxit">maxit</code></td>
<td>
<p>integer giving the maximal number of outer iterations
of the alternating iterations.</p>
</td></tr>
<tr><td><code id="dglm.control_+3A_trace">trace</code></td>
<td>
<p>logical indicating if (a small amount of) output should 
be produced for each iteration.</p>
</td></tr>
<tr><td><code id="dglm.control_+3A_...">...</code></td>
<td>
<p>not currently implemented</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When 'trace' is true, calls to 'cat' produce the output for each
outer iteration. Hence, 'options(digits = *)' can be used to
increase the precision; see the example for <code><a href="stats.html#topic+glm.control">glm.control</a></code>.</p>


<h3>Author(s)</h3>

<p>Gordon Smyth,
ported to R by Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)
</p>


<h3>References</h3>

<p>Smyth, G. K. (1989). Generalized linear models with varying dispersion. 
<em>J. R. Statist. Soc. B</em>, <b>51</b>, 47&ndash;60.
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999). 
Adjusted likelihood methods for modelling dispersion in generalized linear models.
<em>Environmetrics</em>, <b>10</b>, 696-709.
</p>
<p>Verbyla, A. P., and Smyth, G. K. (1998). Double generalized linear models:
approximate residual maximum likelihood and diagnostics. 
Research Report, Department of Statistics, University of Adelaide. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dglm-class">dglm-class</a></code>, <code><a href="#topic+dglm">dglm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### A variation on  example(dglm) :
# Continuing the example from  glm, but this time try
# fitting a Gamma double generalized linear model also.
clotting &lt;- data.frame(
      u = c(5,10,15,20,30,40,60,80,100),
      lot1 = c(118,58,42,35,27,25,21,19,18),
      lot2 = c(69,35,26,21,18,16,13,12,12))
         
# The same example as in  glm: the dispersion is modelled as constant
out &lt;- dglm(lot1 ~ log(u), ~1, data=clotting, family=Gamma)
summary(out)

# Try a double glm 
oo &lt;- options()
options(digits=12) # See more details in tracing
out2 &lt;- dglm(lot1 ~ log(u), ~u, data=clotting, family=Gamma,
   control=dglm.control(epsilon=0.01, trace=TRUE))
   # With this value of epsilon, convergence should be quicker
   # and the results less reliable (compare to example(dglm) )

summary(out2)
options(oo)
</code></pre>

<hr>
<h2 id='residuals.dglm'>Extract Residuals from Double Generalized Linear Model Fit</h2><span id='topic+residuals.dglm'></span>

<h3>Description</h3>

<p>This implements the 'residuals' generic for the dglm object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dglm'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.dglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"dglm"</code>.</p>
</td></tr>
<tr><td><code id="residuals.dglm_+3A_...">...</code></td>
<td>
<p>any other parameters are passed to <code>residuals.glm</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of residuals from the mean submodel.
</p>


<h3>Author(s)</h3>

<p>Robert W. Corty and Gordon Smyth
</p>

<hr>
<h2 id='summary.dglm'>Summarize Double Generalized Linear Model Fit</h2><span id='topic+summary.dglm'></span><span id='topic+print.summary.dglm'></span>

<h3>Description</h3>

<p>Summarize objects of class <code>"dglm"</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dglm'
summary(object, dispersion=NULL, correlation = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.dglm_+3A_object">object</code></td>
<td>
<p>an object of class <code>"dglm"</code>.</p>
</td></tr>
<tr><td><code id="summary.dglm_+3A_dispersion">dispersion</code></td>
<td>
<p>the dispersion parameter for the fitting family. 
By default it is obtained from <code>object</code>.</p>
</td></tr>
<tr><td><code id="summary.dglm_+3A_correlation">correlation</code></td>
<td>
<p>logical; if <code>TRUE</code>, the correlation matrix of 
the estimated parameters is returned and printed.</p>
</td></tr>
<tr><td><code id="summary.dglm_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>summary.glm</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details, see <code><a href="stats.html#topic+summary.glm">summary.glm</a></code>.
</p>
<p>If more than one of <code>etastart</code>, <code>start</code> and <code>mustart</code>
is specified, the first in the list will be used.
</p>


<h3>Value</h3>

<p>An object of class <code>"summary.dglm"</code>, which is a list with the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>deviance</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>aic</code></td>
<td>
<p><code>NULL</code> here</p>
</td></tr>
<tr><td><code>constrasts</code></td>
<td>
<p>(where relevant) the contrasts used. NOT WORKING??</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>null.deviance</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>df.null</code></td>
<td>
<p>the residual degrees of freedom for the null model.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the component from <code>object</code></p>
</td></tr>
<tr><td><code>deviance.resid</code></td>
<td>
<p>the deviance residuals: see <code>residuals.glm</code></p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>the matrix of coefficients, standard errors, 
<code class="reqn">z</code>-values and <code class="reqn">p</code>-values.  Aliased coefficients are omitted.</p>
</td></tr>
<tr><td><code>aliased</code></td>
<td>
<p>named logical vector showing if the original coefficients are
aliased.</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p>either the supplied argument or the estimated dispersion 
if the latter in <code>NULL</code></p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>a 3-vector of the rank of the model and the number of
residual degrees of freedom, plus number of non-aliased coefficients.</p>
</td></tr>
<tr><td><code>cov.unscaled</code></td>
<td>
<p>the unscaled (<code>dispersion = 1</code>) estimated covariance
matrix of the estimated coefficients.</p>
</td></tr>
<tr><td><code>cov.scaled</code></td>
<td>
<p>ditto, scaled by <code>dispersion</code></p>
</td></tr>
<tr><td><code>correlation</code></td>
<td>
<p>(only if <code>correlation</code> is true.)  
The estimated correlations of the estimated coefficients.</p>
</td></tr>
<tr><td><code>dispersion.summary</code></td>
<td>
<p>the summary of the fitted dispersion model</p>
</td></tr>
<tr><td><code>outer.iter</code></td>
<td>
<p>the number of outer iteration of the alternating iterations</p>
</td></tr>
<tr><td><code>m2loglik</code></td>
<td>
<p>minus twice the log-likelihood of the fitted model</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The anova method is questionable when applied to an <code>dglm</code> object created with
<code>method="reml"</code> (stick to <code>method="ml"</code>). 
</p>


<h3>Author(s)</h3>

<p>Gordon Smyth,
ported to R by Peter Dunn (<a href="mailto:pdunn2@usc.edu.au">pdunn2@usc.edu.au</a>)</p>


<h3>References</h3>

<p>Smyth, G. K. (1989). Generalized linear models with varying dispersion. 
<em>J. R. Statist. Soc. B</em>, <b>51</b>, 47&ndash;60.
<a href="https://doi.org/10.1111/j.2517-6161.1989.tb01747.x">doi:10.1111/j.2517-6161.1989.tb01747.x</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999). 
Adjusted likelihood methods for modelling dispersion in generalized linear models.
<em>Environmetrics</em>, <b>10</b>, 696-709.
<a href="https://doi.org/10.1002/%28SICI%291099-095X%28199911/12%2910%3A6%3C695%3A%3AAID-ENV385%3E3.0.CO%3B2-M">doi:10.1002/(SICI)1099-095X(199911/12)10:6&lt;695::AID-ENV385&gt;3.0.CO;2-M</a>
<a href="https://gksmyth.github.io/pubs/Ties98-Preprint.pdf">https://gksmyth.github.io/pubs/Ties98-Preprint.pdf</a>
</p>
<p>Smyth, G. K., and Verbyla, A. P. (1999).
Double generalized linear models: approximate REML and diagnostics.
In <em>Statistical Modelling: Proceedings of the 14th International Workshop on Statistical Modelling</em>, Graz, Austria, July 19-23, 1999, H. Friedl, A. Berghold, G. Kauermann (eds.), Technical University, Graz, Austria, pages 66-80.
<a href="https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf">https://gksmyth.github.io/pubs/iwsm99-Preprint.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dglm">dglm</a></code>,
<code><a href="#topic+dglm-class">dglm-class</a></code>,
<code><a href="stats.html#topic+summary.glm">summary.glm</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
