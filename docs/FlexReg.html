<!DOCTYPE html><html lang="en"><head><title>Help for package FlexReg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlexReg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FlexReg-package'><p>The &lsquo;FlexReg&rsquo; package.</p></a></li>
<li><a href='#Atomic'><p>Atomic bombs data</p></a></li>
<li><a href='#Bacteria'><p>Bacteria data</p></a></li>
<li><a href='#Consumption'><p>Italian Households Consumption data</p></a></li>
<li><a href='#convergence.diag'><p>Convergence diagnostics</p></a></li>
<li><a href='#convergence.plot'><p>Convergence plots</p></a></li>
<li><a href='#curve.density'><p>Draw density plots</p></a></li>
<li><a href='#dBeta'><p>Probability density function of the beta distribution</p></a></li>
<li><a href='#dBetaBin'><p>Probability mass function of the beta-binomial distribution</p></a></li>
<li><a href='#dFB'><p>Probability density function of the flexible beta distribution</p></a></li>
<li><a href='#dFBB'><p>Probability mass function of the flexible beta-binomial distribution</p></a></li>
<li><a href='#dVIB'><p>Probability density function of the variance-inflated beta distribution</p></a></li>
<li><a href='#Election'><p>Italian Election Results</p></a></li>
<li><a href='#extract.pars'><p>extract.pars</p></a></li>
<li><a href='#flexreg'><p>Flexible Regression Models for Bounded Continuous Responses</p></a></li>
<li><a href='#flexreg_binom'><p>Flexible Regression Models for Bounded Discrete Responses</p></a></li>
<li><a href='#mu.chain.nd'><p>mu.chain.nd</p></a></li>
<li><a href='#newdata.adjust'><p>newdata.adjust</p></a></li>
<li><a href='#phi.chain.nd'><p>phi.chain.nd</p></a></li>
<li><a href='#plot.flexreg'><p>Plot Method for <code>flexreg</code> Objects</p></a></li>
<li><a href='#plot.flexreg_postpred'><p>Plot Method for <code>`flexreg_postpred`</code> objects</p></a></li>
<li><a href='#posterior_predict'><p>posterior_predict</p></a></li>
<li><a href='#posterior_predict.flexreg'><p>Posterior Predictive Method for <code>`flexreg`</code> objects</p></a></li>
<li><a href='#predict_lambda.chain'><p>predict_lambda.chain</p></a></li>
<li><a href='#predict_link'><p>predict_link</p></a></li>
<li><a href='#predict_mu.chain'><p>predict_mu.chain</p></a></li>
<li><a href='#predict_over'><p>predict_over</p></a></li>
<li><a href='#predict_precision'><p>predict_precision</p></a></li>
<li><a href='#predict_q.chain'><p>predict_q.chain</p></a></li>
<li><a href='#predict_response'><p>predict_response</p></a></li>
<li><a href='#predict_variance'><p>predict_variance</p></a></li>
<li><a href='#predict.flexreg'><p>Predict Method for <code>`flexreg`</code> Objects</p></a></li>
<li><a href='#print.flexreg'><p>Print Methods for flexreg Objects</p></a></li>
<li><a href='#q0.chain.nd'><p>q0.chain.nd</p></a></li>
<li><a href='#q01.chain.nd'><p>q01.chain.nd</p></a></li>
<li><a href='#q1.chain.nd'><p>q1.chain.nd</p></a></li>
<li><a href='#R2_bayes'><p>Bayesian R-squared for <code>flexreg</code> Objects</p></a></li>
<li><a href='#rate_plot'><p>rate_plot</p></a></li>
<li><a href='#rBeta'><p>Random generator from the beta distribution</p></a></li>
<li><a href='#rBetaBin'><p>Random generator from the beta-binomial distribution</p></a></li>
<li><a href='#Reading'><p>Reading Skills data</p></a></li>
<li><a href='#residuals.flexreg'><p>Residuals Method for flexreg Objects</p></a></li>
<li><a href='#rFB'><p>Random generator from the flexible beta distribution</p></a></li>
<li><a href='#rFBB'><p>Random generator from the flexible beta-binomial distribution</p></a></li>
<li><a href='#rVIB'><p>Random generation from the variance-inflated beta distribution</p></a></li>
<li><a href='#Stress'><p>Stress and anxiety data</p></a></li>
<li><a href='#summary.flexreg'><p>Methods for <code>`flexreg`</code> Objects</p></a></li>
<li><a href='#summary.flexreg_postpred'><p>Summary Method for <code>`flexreg_postpred`</code> objects</p></a></li>
<li><a href='#theta.chain.nd'><p>theta.chain.nd</p></a></li>
<li><a href='#var.fun'><p>var.fun</p></a></li>
<li><a href='#WAIC'><p>WAIC and LOO</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Regression Models for Bounded Continuous and Discrete Responses</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Roberto Ascari [aut, cre], Agnese M. Di Brisco [aut, cre], Sonia Migliorati [aut], Andrea Ongaro [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Roberto Ascari &lt;roberto.ascari@unimib.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to fit regression models for bounded continuous and discrete responses. In case of bounded continuous  responses (e.g., proportions and rates), available models are the flexible beta (Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018) &lt;<a href="https://doi.org/10.1214%2F17-BA1079">doi:10.1214/17-BA1079</a>&gt;), the variance-inflated beta (Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020) &lt;<a href="https://doi.org/10.1177%2F1471082X18821213">doi:10.1177/1471082X18821213</a>&gt;), the beta (Ferrari, S.L.P., Cribari-Neto, F. (2004) &lt;<a href="https://doi.org/10.1080%2F0266476042000214501">doi:10.1080/0266476042000214501</a>&gt;), and their augmented versions to handle the presence of zero/one values (Di Brisco, A. M., Migliorati, S. (2020) &lt;<a href="https://doi.org/10.1002%2Fsim.8406">doi:10.1002/sim.8406</a>&gt;) are implemented. In case of bounded discrete responses (e.g., bounded counts, such as the number of successes in n trials),  available models are the flexible beta-binomial (Ascari, R., Migliorati, S. (2021) &lt;<a href="https://doi.org/10.1002%2Fsim.9005">doi:10.1002/sim.9005</a>&gt;), the beta-binomial, and the binomial are implemented. Inference is dealt with a Bayesian approach based on the Hamiltonian Monte Carlo (HMC) algorithm (Gelman, A., Carlin, J. B., Stern, H. S., Rubin, D. B. (2014) &lt;<a href="https://doi.org/10.1201%2Fb16018">doi:10.1201/b16018</a>&gt;). Besides, functions to compute residuals, posterior predictives, goodness of fit measures, convergence diagnostics, and graphical representations are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), rstan (&ge; 2.26.0), rstantools (&ge;
2.0.0), loo, bayesplot, ggplot2, Formula, utils, grDevices,
RcppParallel</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
rstan (&ge; 2.26.0), StanHeaders (&ge; 2.26.0), RcppParallel</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-28 14:29:00 UTC; ascari</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-29 08:40:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='FlexReg-package'>The &lsquo;FlexReg&rsquo; package.</h2><span id='topic+FlexReg-package'></span><span id='topic+FlexReg'></span>

<h3>Description</h3>

<p>The <span class="pkg"><a href="#topic+FlexReg">FlexReg</a></span> package provides functions and methods to implement several types of regression models for bounded continuous responses (e.g., proportions and rates) and
bounded discrete responses (e.g., number of successes in n trials).
Inferential statistical analysis is dealt with by a Bayesian estimation procedure based on the Hamiltonian Monte Carlo (HMC) algorithm through the <span class="pkg">rstan</span> package.
</p>


<h3>References</h3>

<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309. doi:10.1177/1471082X18821213 <br />
<br />
Ferrari, S.L.P., Cribari-Neto, F. (2004). Beta Regression for Modeling Rates and Proportions. Journal of Applied Statistics, <b>31</b>(7), 799&ndash;815. doi:10.1080/0266476042000214501<br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />
<br />
Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.19.3. https://mc-stan.org
</p>

<hr>
<h2 id='Atomic'>Atomic bombs data</h2><span id='topic+Atomic'></span>

<h3>Description</h3>

<p>Count/Percentage of chromosome aberrations in atomic bombs survivors.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 1039 observations on the following 5 variables:
</p>

<dl>
<dt><code>y.perc</code></dt><dd><p>the percentage of cells with chromosomal abnormalities.</p>
</dd>
<dt><code>y</code></dt><dd><p>the number of cells with chromosomal abnormalities.</p>
</dd>
<dt><code>n</code></dt><dd><p>the number of analyzed cells.  It is fixed to 100 for all the survivors.</p>
</dd>
<dt><code>dose</code></dt><dd><p>a quantitative measure of the radiation exposure level, expressed in rads.</p>
</dd>
<dt><code>bomb</code></dt><dd><p>a factor, indicating which bomb the subject survived (H = Hiroshima, N = Nagasaki).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data have been originally analyzed by Otake and Prentice (1984) and successively by Ascari and Migliorati (2021).
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Otake, M., Prentice, R.L. (1984). The analysis of chromosomally aberrant cells based on beta-binomial distribution. Radiat Res. <b>98</b>, 456&ndash;470. <br />

</p>

<hr>
<h2 id='Bacteria'>Bacteria data</h2><span id='topic+Bacteria'></span>

<h3>Description</h3>

<p>Count/Percentage of eggs parasitized by female parasitoids.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 70 observations on the following 5 variables:
</p>

<dl>
<dt><code>y.perc</code></dt><dd><p>the percentage of parasitized eggs.</p>
</dd>
<dt><code>y</code></dt><dd><p>the number of parasitized eggs.</p>
</dd>
<dt><code>n</code></dt><dd><p>the maximum number of eggs that female parasitoids could parasitized. It is fixed to 128 for all the observations.</p>
</dd>
<dt><code>females</code></dt><dd><p>the number of female parasitoids.</p>
</dd>
<dt><code>females_std</code></dt><dd><p>the standardized version of <code>females</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data have been originally analyzed by Demétrio et al (2014) and successively by Ascari and Migliorati (2021).
Data come from a completely randomized experiment with 10 replicates for each specification of number of females.
</p>


<h3>Source</h3>

<p>Demétrio et al., (2014). Models for overdispersed data in entomology.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Demétrio, C.G.B., Hinde, J., Moral, R.A. (2014). Models for overdispersed data in entomology. Ecological Modelling Applied to Entomology. Entomology in Focus Switzerland: Springer International Publishing, 219&ndash;259. <br />

</p>

<hr>
<h2 id='Consumption'>Italian Households Consumption data</h2><span id='topic+Consumption'></span>

<h3>Description</h3>

<p>This dataset is a subset from the 2016 Survey on Household Income and Wealth data, a statistical survey conducted by the Bank of Italy. The statistical units are the households and the head of the household is conventionally selected as the major income earner.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 568 observations on the following 8 variables:
</p>

<dl>
<dt><code>NComp</code></dt><dd><p>the number of household members.</p>
</dd>
<dt><code>Sex</code></dt><dd><p>the sex of the head of the household.</p>
</dd>
<dt><code>Age</code></dt><dd><p>the age of the head of the household.</p>
</dd>
<dt><code>NEarners</code></dt><dd><p>the number of household income earners.</p>
</dd>
<dt><code>Area</code></dt><dd><p>a factor indicating the geographical area where the household is located.</p>
</dd>
<dt><code>Citizenship</code></dt><dd><p>a factor indicating the citizenship of the head of household.</p>
</dd>
<dt><code>Income</code></dt><dd><p>the net disposable income.</p>
</dd>
<dt><code>Consumption</code></dt><dd><p>the propensity to consume, defined as the percentage of <code>Income</code> that is spent rather than saved.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Full data are available on the website of the Bank of Italy. <code>Consumption</code> is computed as the ratio between the amount of &lsquo;consumption&rsquo; over the &lsquo;net disposable income&rsquo;.
</p>


<h3>Source</h3>

  <p><a href="https://www.bancaditalia.it/statistiche/tematiche/indagini-famiglie-imprese/bilanci-famiglie/distribuzione-microdati/index.html?com.dotmarketing.htmlpage.language=1">Bank of Italy, Survey on Household Income and Wealth, 2016</a>. <br />
<br />
<a href="https://www.bancaditalia.it/statistiche/tematiche/indagini-famiglie-imprese/bilanci-famiglie/documentazione/documenti/2016/eng_Legen16.pdf?language_id=1">Survey description.</a>

</p>

<hr>
<h2 id='convergence.diag'>Convergence diagnostics</h2><span id='topic+convergence.diag'></span>

<h3>Description</h3>

<p>The function returns some diagnostic measures to check for convergence to the equilibrium distribution of the Markov Chain(s).
Moreover, it prints the number (and percentage) of iterations that ended with a divergence and that saturated the max treedepth, and the E-BFMI values for each chain for which E-BFMI is less than 0.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convergence.diag(
  model,
  diagnostics = "all",
  pars = NULL,
  additional.args = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convergence.diag_+3A_model">model</code></td>
<td>
<p>an object of class <code>`flexreg`</code>.</p>
</td></tr>
<tr><td><code id="convergence.diag_+3A_diagnostics">diagnostics</code></td>
<td>
<p>an optional character vector of diagnostics names. The default is to compute <code>"all"</code> diagnostics, otherwise one can specify a selection of diagnostics among <code>"Rhat"</code>, <code>"geweke"</code>, <code>"raftery"</code>, <code>"heidel"</code>, and <code>"gelman"</code>.</p>
</td></tr>
<tr><td><code id="convergence.diag_+3A_pars">pars</code></td>
<td>
<p>an optional character vector of parameter names. If <code>pars</code> is not specified, all parameters in the regression models are evaluated.</p>
</td></tr>
<tr><td><code id="convergence.diag_+3A_additional.args">additional.args</code></td>
<td>
<p>a list containing additional arguments (see details)</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>"Rhat"</code> returns the potential scale reduction factor on split chains. An R-hat greater than 1 is indicative of a bad mix of the chains. At convergence R-hat has to be less than 1.05. See <code>rstan::Rhat</code> for further details.
</p>
</li>
<li> <p><code>"geweke"</code> returns the z-scores, one for each parameter, for a test of equality between the means of the first 10% and last 50% of the chain. The fraction to use from the first and last part of the chain can be edited through the additional arguments <code>frac1</code> and <code>frac2</code>. The sum of <code>frac1</code> and <code>frac2</code> has to be strictly less than 1. See <code>coda::geweke.diag</code> for further details.
</p>
</li>
<li> <p><code>"raftery"</code> returns the estimate of the &quot;dependence factor&quot; <code class="reqn">I</code>. Values of <code class="reqn">I</code> greater than 5 may indicate a strong autocorrelation.
Additional parameters such as the quantile to be estimated (<code>q</code>), the desired margin of error of the estimate (<code>r</code>), and the probability (<code>s</code>) of obtaining an estimate between <code class="reqn">q-r</code> and <code class="reqn">q+r</code>  can be passed as a list in the <code>additional.args</code> argument. See <code>coda::raftery.diag</code> for further details.
</p>
</li>
<li> <p><code>"heidel"</code> returns the p-values, one for each parameter, referred to a convergence test where the null hypothesis is that the sampled values come from a stationary distribution. It is possible to set the target value for ratio of halfwidth to sample mean (<code>eps</code>) and the significance level of the test (<code>pvalue</code>)  into the <code>additional.args</code> argument. See <code>coda::heidel.diag</code> for further details.
</p>
</li>
<li> <p><code>"gelman"</code> returns the estimate of the potential scale reduction factor and the upper confidence limit. At least two chains are needed to compute the Gelman and Rubin's convergence diagnostic. Additional parameters such as the confidence level (<code>confidence</code>), a logical flag indicating whether variables should be transformed (<code>transform</code>),
a logical flag indicating whether only the second half of the series should be used in the computation (<code>autoburnin</code>), and a logical flag indicating whether the multivariate potential scale reduction factor should be calculated for multivariate chains (<code>multivariate</code>) can be passed as a list in the <code>additional.args</code> argument. See <code>coda::gelman.diag</code> for further details.
</p>
</li></ul>



<h3>Value</h3>

<p>A print from <code>check_hmc_diagnostics</code> function and a list of convergence diagnostics.
</p>


<h3>References</h3>


<p>Brooks, SP., Gelman, A. (1998). General methods for monitoring convergence of iterative simulations. Journal of Computational and Graphical Statistics, <b>7</b>, 434-455. <br />
<br />
Geweke, J. (1992). Evaluating the accuracy of sampling-based approaches to calculating posterior moments. In Bayesian Statistics 4 (ed JM Bernado, JO Berger, AP Dawid and AFM Smith). Clarendon Press, Oxford, UK. <br />
<br />
Heidelberger P., Welch P.D. (1981). A spectral method for confidence interval generation and run length control in simulations. Comm. ACM. <b>24</b>, 233-245.<br />
<br />
Raftery, A.E. and Lewis, S.M. (1992). One long run with diagnostics: Implementation strategies for Markov chain Monte Carlo. Statistical Science, <b>7</b>, 493-497.<br />
<br />
Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.19.3. https://mc-stan.org

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, type = "FB")
convergence.diag(FB,  diagnostics = c("Rhat", "geweke"), pars = "beta")


## End(Not run)

</code></pre>

<hr>
<h2 id='convergence.plot'>Convergence plots</h2><span id='topic+convergence.plot'></span>

<h3>Description</h3>

<p>The function produces some convergence plots from the Monte Carlo draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convergence.plot(
  model,
  file = "convergence-output.pdf",
  plotfun = "all",
  pars = NULL,
  point_est = "median",
  prob = 0.5,
  prob_outer = 0.9,
  lags = 10,
  warmup = F,
  width = 7,
  height = 7
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convergence.plot_+3A_model">model</code></td>
<td>
<p>an object of class <code>`flexreg`</code>.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_file">file</code></td>
<td>
<p>a character string giving the name of the file (including the extension .pdf) containing the convergence plots. If <code>NULL</code>, the convergence plots are printed in the graphics window.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_plotfun">plotfun</code></td>
<td>
<p>an optional character vector of diagnostics plots. The default is to compute <code>"all"</code> plots, otherwise one can specify a subset of plots among <code>"density"</code>, <code>"trace"</code>, <code>"intervals"</code>, <code>"rate"</code>, <code>"rhat"</code>, and <code>"acf"</code>.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_pars">pars</code></td>
<td>
<p>an optional character vector of parameter names. If <code>pars</code> is not specified, all parameters in the regression models are evaluated.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_point_est">point_est</code></td>
<td>
<p>an optional character to specify the point estimate to be shown between <code>"median"</code> (the default), <code>"mean"</code>, or <code>"none"</code>.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_prob">prob</code></td>
<td>
<p>the probability mass to be included in the inner interval (for <code>"intervals"</code> plot) or in the shaded region (for <code>"density"</code> plot). The default is 0.5.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_prob_outer">prob_outer</code></td>
<td>
<p>the probability mass to be included in the outer interval  of the <code>"intervals"</code> plot. The default is 0.9.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_lags">lags</code></td>
<td>
<p>the number of lags to be shown in the <code>"acf"</code> plot. The default is 10.</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_warmup">warmup</code></td>
<td>
<p>a logical scalar indicating whether to include the warmup draws or not (default).</p>
</td></tr>
<tr><td><code id="convergence.plot_+3A_width">width</code>, <code id="convergence.plot_+3A_height">height</code></td>
<td>
<p>the width and height of the graphics region of each plot in inches. The default values are 7.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code>"density"</code> returns a density plot for each parameter in <code>pars</code> computed from the posterior draws. See <code>bayesplot::mcmc_areas</code> for further details.
</p>
</li>
<li> <p><code>"trace"</code> returns a trace plot for each parameter in <code>pars</code> computed from the posterior draws. See <code>bayesplot::mcmc_trace</code> for further details.
</p>
</li>
<li> <p><code>"intervals"</code> returns a plot of uncertainty interval for each parameter in <code>pars</code> computed from the posterior draws. See <code>bayesplot::mcmc_intervals</code> for further details.
</p>
</li>
<li> <p><code>"rate"</code> returns a plot for each parameter in <code>pars</code>  with the number of iterations on the x-axis and the Monte Carlo mean until iteration i-th on the y-axis.
</p>
</li>
<li> <p><code>"rhat"</code> returns a plot with the Rhat values for each parameter in <code>pars</code>. See <code>bayesplot::mcmc_rhat</code> for further details.
</p>
</li>
<li> <p><code>"acf"</code> returns the autocorrelation plots (one for each parameter in <code>pars</code>). See <code>bayesplot::mcmc_acf</code> for further details.
</p>
</li></ul>

<p>Moreover, the convergence plots can be further customized using the <span class="pkg">ggplot2</span> package.
</p>


<h3>Value</h3>

<p>A .pdf file with one plot per page.
</p>


<h3>References</h3>


<p>Brooks, SP., Gelman, A. (1998). General methods for monitoring convergence of iterative simulations. Journal of Computational and Graphical Statistics, <b>7</b>, 434-455. <br />
<br />
Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.19.3. https://mc-stan.org

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, type = "FB")
convergence.plot(FB, file = "Convergence_plot_Output.pdf", pars = "beta")

## End(Not run)

</code></pre>

<hr>
<h2 id='curve.density'>Draw density plots</h2><span id='topic+curve.density'></span>

<h3>Description</h3>

<p>The function draws a curve corresponding to the probability density/mass function of the specified distribution (beta, flexible beta, variance-inflated beta, binomial, beta-binomial, or flexible beta-binomial).
For beta, flexible beta, and variance-inflated beta, it also allows to include the representation of the probability of augmentation in zero and/or one values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curve.density(
  type = NULL,
  size = NULL,
  mu = NULL,
  theta = NULL,
  phi = NULL,
  p = NULL,
  w = NULL,
  k = NULL,
  q0 = NULL,
  q1 = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curve.density_+3A_type">type</code></td>
<td>
<p>a character specifying the distribution type to be plotted (<code>"Beta"</code>, <code>"FB"</code>, <code>"VIB"</code>, <code>"Bin"</code>, <code>"BetaBin"</code>, or <code>"FBB"</code>).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_size">size</code></td>
<td>
<p>the total number of trials (to be specified only if <code>type</code> is <code>"Bin"</code>, <code>"BetaBin"</code>, or <code>"FBB"</code>).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_mu">mu</code></td>
<td>
<p>the mean parameter of the distribution. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_theta">theta</code></td>
<td>
<p>the overdispersion parameter (to be specified only if <code>type</code> is <code>"BetaBin"</code> or <code>"FBB"</code>). It must  lie in (0, 1).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_phi">phi</code></td>
<td>
<p>the precision parameter (if <code>type</code> is <code>"BetaBin"</code> or <code>"FBB"</code>, it represents an alternative way to specify the <code>theta</code> parameter). It must be a real positive value.</p>
</td></tr>
<tr><td><code id="curve.density_+3A_p">p</code></td>
<td>
<p>the mixing weight (to be specified only if <code>type</code> is <code>"FB"</code>, <code>"VIB"</code>, or <code>"FBB"</code>). It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_w">w</code></td>
<td>
<p>the normalized distance among component means of the FB and FBB distributions (to be specified only if <code>type = "FB"</code>, or <code>type = "FBB"</code>). It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_k">k</code></td>
<td>
<p>the extent of the variance inflation (to be specified only if <code>type = "VIB"</code>). It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero (to be specified only if <code>type</code> is <code>"Beta"</code>, <code>"FB"</code>, or <code>"VIB"</code>). It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one (to be specified only if <code>type</code> is <code>"Beta"</code>, <code>"FB"</code>, or <code>"VIB"</code>). It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="curve.density_+3A_...">...</code></td>
<td>
<p>additional arguments of <code>stat_function</code>.</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309. doi:10.1177/1471082X18821213 <br />
<br />
Ferrari, S.L.P., and Cribari-Neto, F. (2004). Beta Regression for Modeling Rates and Proportions. Journal of Applied Statistics, <b>31</b>(7), 799&ndash;815. doi:10.1080/0266476042000214501<br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />

</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve.density("Beta", mu=.5, phi=20)
curve.density("Beta", mu=.5, phi=20, q1 = .3)
curve.density("FB", mu=.5, phi=20, p=.4, w=.8)
curve.density("FB", mu=.5, phi=20, p=.4, w=.8, q0= .1)
curve.density("VIB", mu=.5, phi=20, p=.9, k=.8, col=3)
curve.density("VIB", mu=.5, phi=20, p=.9, k=.8, col=3, q0=.1, q1=.3)

curve.density("Bin", size=10, mu=.7)
curve.density("BetaBin", size=10, mu=.7, phi=10)
curve.density("FBB", size=10, mu=.7, phi=10, p=.2,w=.7)


</code></pre>

<hr>
<h2 id='dBeta'>Probability density function of the beta distribution</h2><span id='topic+dBeta'></span>

<h3>Description</h3>

<p>The function computes the probability density function of the beta distribution with a mean-precision parameterization.
It can also  compute the probability density function of the augmented beta distribution by assigning positive probabilities to zero and/or one values and a (continuous) beta density to the interval (0,1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBeta(x, mu, phi, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dBeta_+3A_x">x</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="dBeta_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dBeta_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="dBeta_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="dBeta_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta distribution has density
</p>
<p style="text-align: center;"><code class="reqn">f_B(x;\mu,\phi)=\frac{\Gamma{(\phi)}}{\Gamma{(\mu\phi)}\Gamma{((1-\mu)\phi)}}x^{\mu\phi-1}(1-x)^{(1-\mu)\phi-1}</code>
</p>

<p>for <code class="reqn">0&lt;x&lt;1</code>, where <code class="reqn">0&lt;\mu&lt;1</code> identifies the mean and <code class="reqn">\phi&gt;0</code> is the precision parameter.
</p>
<p>The augmented beta distribution has density
</p>

<ul>
<li> <p><code class="reqn">q_0</code>,  if  <code class="reqn">x=0</code>
</p>
</li>
<li> <p><code class="reqn">q_1</code>, if  <code class="reqn">x=1</code>
</p>
</li>
<li> <p><code class="reqn">(1-q_0-q_1)f_B(x;\mu,\phi)</code>, if <code class="reqn">0&lt;x&lt;1</code>
</p>
</li></ul>

<p>where <code class="reqn">0&lt;q_0&lt;1</code> identifies the augmentation in zero, <code class="reqn">0&lt;q_1&lt;1</code> identifies the augmentation in one,
and <code class="reqn">q_0+q_1&lt;1</code>.
</p>


<h3>Value</h3>

<p>A vector with the same length as <code>x</code>.
</p>


<h3>References</h3>


<p>Ferrari, S.L.P., Cribari-Neto, F. (2004). Beta Regression for Modeling Rates and Proportions. Journal of Applied Statistics, <b>31</b>(7), 799&ndash;815. doi:10.1080/0266476042000214501

</p>


<h3>Examples</h3>

<pre><code class='language-R'>dBeta(x = c(.5,.7,.8), mu = .3, phi = 20)
dBeta(x = c(.5,.7,.8), mu = .3, phi = 20, q0 = .2)
dBeta(x = c(.5,.7,.8), mu = .3, phi = 20, q0 = .2, q1= .1)

</code></pre>

<hr>
<h2 id='dBetaBin'>Probability mass function of the beta-binomial distribution</h2><span id='topic+dBetaBin'></span>

<h3>Description</h3>

<p>The function computes the probability mass function of the beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dBetaBin(x, size, mu, theta = NULL, phi = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dBetaBin_+3A_x">x</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="dBetaBin_+3A_size">size</code></td>
<td>
<p>the total number of trials.</p>
</td></tr>
<tr><td><code id="dBetaBin_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dBetaBin_+3A_theta">theta</code></td>
<td>
<p>the overdispersion parameter. It must  lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dBetaBin_+3A_phi">phi</code></td>
<td>
<p>the precision parameter, an alternative way to specify the overdispersion parameter <code>theta</code>. It must be a real positive value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The beta-binomial distribution has probability mass function
</p>
<p style="text-align: center;"><code class="reqn">f_{BB}(x;\mu,\phi)={n\choose x} \frac{\Gamma{(\phi)}}{\Gamma{(\mu\phi)}\Gamma{((1-\mu)\phi)}} \frac{\Gamma{(\mu\phi+x)}\Gamma{((1-\mu)\phi + n - x)}}{\Gamma{(\phi + n)}},</code>
</p>

<p>for <code class="reqn">x \in \lbrace 0, 1, \dots, n \rbrace</code>, where <code class="reqn">0&lt;\mu&lt;1</code> identifies the mean and <code class="reqn">\phi=(1-\theta)/\theta &gt;0</code> is the precision parameter.
</p>


<h3>Value</h3>

<p>A vector with the same length as <code>x</code>.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005

</p>


<h3>Examples</h3>

<pre><code class='language-R'>dBetaBin(x = 5, size = 10, mu = .3, phi = 10)

</code></pre>

<hr>
<h2 id='dFB'>Probability density function of the flexible beta distribution</h2><span id='topic+dFB'></span>

<h3>Description</h3>

<p>The function computes the probability density function of the flexible beta distribution.
It can also  compute the probability density function of the augmented flexible beta distribution by assigning positive probabilities to zero and/or one values and a (continuous) flexible beta density to the interval (0,1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dFB(x, mu, phi, p, w, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dFB_+3A_x">x</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="dFB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="dFB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFB_+3A_w">w</code></td>
<td>
<p>the normalized distance among component means. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFB_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="dFB_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FB distribution is a special mixture of two beta distributions with probability density function
</p>
<p style="text-align: center;"><code class="reqn">f_{FB}(x;\mu,\phi,p,w)=p f_B(x;\lambda_1,\phi)+(1-p)f_B(x;\lambda_2,\phi),</code>
</p>

<p>for <code class="reqn">0&lt;x&lt;1</code>, where <code class="reqn">f_B(x;\cdot,\cdot)</code> is the beta density with a mean-precision parameterization.
Moreover, <code class="reqn">0&lt;\mu=p\lambda_1+(1-p)\lambda_2&lt;1</code> is the overall mean, <code class="reqn">\phi&gt;0</code> is a precision parameter,
<code class="reqn">0&lt;p&lt;1</code> is the mixing weight,  <code class="reqn">0&lt;w&lt;1</code> is the  normalized distance between component means, and
<code class="reqn">\lambda_1=\mu+(1-p)w</code> and <code class="reqn">\lambda_2=\mu-pw</code> are the means of the first and second component of the mixture, respectively.
</p>
<p>The augmented FB distribution has density
</p>

<ul>
<li> <p><code class="reqn">q_0</code>, if <code class="reqn">x=0</code>
</p>
</li>
<li> <p><code class="reqn">q_1</code>, if <code class="reqn">x=1</code>
</p>
</li>
<li> <p><code class="reqn">(1-q_0-q_1)f_{FB}(x;\mu,\phi,p,w)</code>, if <code class="reqn">0&lt;x&lt;1 </code>
</p>
</li></ul>

<p>where <code class="reqn">0&lt;q_0&lt;1</code> identifies the augmentation in zero, <code class="reqn">0&lt;q_1&lt;1</code> identifies the augmentation in one,
and <code class="reqn">q_0+q_1&lt;1</code>.
</p>


<h3>Value</h3>

<p>A vector with the same length as <code>x</code>.
</p>


<h3>References</h3>


<p>Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079

</p>


<h3>Examples</h3>

<pre><code class='language-R'>dFB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, w = .5)
dFB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, w = .5, q0 = .2)
dFB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, w = .5, q0 = .2, q1 = .1)
</code></pre>

<hr>
<h2 id='dFBB'>Probability mass function of the flexible beta-binomial distribution</h2><span id='topic+dFBB'></span>

<h3>Description</h3>

<p>The function computes the probability mass function of the flexible beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dFBB(x, size, mu, theta = NULL, phi = NULL, p, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dFBB_+3A_x">x</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="dFBB_+3A_size">size</code></td>
<td>
<p>the total number of trials.</p>
</td></tr>
<tr><td><code id="dFBB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFBB_+3A_theta">theta</code></td>
<td>
<p>the overdispersion parameter. It must  lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFBB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter, an alternative way to specify the overdispersion parameter <code>theta</code>. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="dFBB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dFBB_+3A_w">w</code></td>
<td>
<p>the normalized distance among component means. It must lie in (0, 1).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FBB distribution is a special mixture of two beta-binomial distributions with probability mass function
</p>
<p style="text-align: center;"><code class="reqn">f_{FBB}(x;\mu,\phi,p,w) = p BB(x;\lambda_1,\phi)+(1-p)BB(x;\lambda_2,\phi),</code>
</p>

<p>for <code class="reqn">x \in \lbrace 0, 1, \dots, n \rbrace</code>, where <code class="reqn">BB(x;\cdot,\cdot)</code> is the beta-binomial distribution with a mean-precision parameterization.
Moreover, <code class="reqn">\phi=(1-\theta)/\theta&gt;0</code> is a precision parameter, <code class="reqn">0&lt;p&lt;1</code> is the mixing weight, <code class="reqn">0&lt;\mu=p\lambda_1+(1-p)\lambda_2&lt;1</code> is the overall mean,
<code class="reqn">0&lt;w&lt;1</code> is the  normalized distance between component means, and
<code class="reqn">\lambda_1=\mu+(1-p)w</code> and <code class="reqn">\lambda_2=\mu-pw</code> are the scaled means of the first and second component of the mixture, respectively.
</p>


<h3>Value</h3>

<p>A vector with the same length as <code>x</code>.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005

</p>


<h3>Examples</h3>

<pre><code class='language-R'>dFBB(x = c(5,7,8), size=10, mu = .3, phi = 20, p = .5, w = .5)

</code></pre>

<hr>
<h2 id='dVIB'>Probability density function of the variance-inflated beta distribution</h2><span id='topic+dVIB'></span>

<h3>Description</h3>

<p>The function computes the probability density function of the variance-inflated beta distribution.
It can also  compute the probability density function of the augmented variance-inflated beta distribution by assigning positive probabilities to zero and/or one values and a (continuous) variance-inflated beta density to the interval (0,1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dVIB(x, mu, phi, p, k, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dVIB_+3A_x">x</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="dVIB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dVIB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="dVIB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dVIB_+3A_k">k</code></td>
<td>
<p>the extent of the variance inflation. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="dVIB_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="dVIB_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The VIB distribution is a special mixture of two beta distributions with probability density function
</p>
<p style="text-align: center;"><code class="reqn">f_{VIB}(x;\mu,\phi,p,k)=p f_B(x;\mu,\phi k)+(1-p)f_B(x;\mu,\phi),</code>
</p>

<p>for <code class="reqn">0&lt;x&lt;1</code>, where <code class="reqn">f_B(x;\cdot,\cdot)</code> is the beta density with a mean-precision parameterization.
Moreover, <code class="reqn">0&lt;p&lt;1</code> is the mixing weight, <code class="reqn">0&lt;\mu&lt;1</code> represents the overall (as well as mixture component)
mean, <code class="reqn">\phi&gt;0</code> is a precision parameter, and <code class="reqn">0&lt;k&lt;1</code> determines the extent of the variance inflation.
The augmented VIB distribution has density
</p>

<ul>
<li> <p><code class="reqn">q_0</code>, if <code class="reqn">x=0</code>
</p>
</li>
<li> <p><code class="reqn">q_1</code>,  if <code class="reqn">x=1</code>
</p>
</li>
<li> <p><code class="reqn">(1-q_0-q_1)f_{VIB}(x;\mu,\phi,p,k)</code>, if <code class="reqn">0&lt;x&lt;1</code>
</p>
</li></ul>

<p>where <code class="reqn">0&lt;q_0&lt;1</code> identifies the augmentation in zero, <code class="reqn">0&lt;q_1&lt;1</code> identifies the augmentation in one,
and <code class="reqn">q_0+q_1&lt;1</code>.
</p>


<h3>Value</h3>

<p>A vector with the same length as <code>x</code>.
</p>


<h3>References</h3>


<p>Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309.
doi:10.1177/1471082X18821213

</p>


<h3>Examples</h3>

<pre><code class='language-R'>dVIB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, k= .5)
dVIB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, k= .5, q1 = .1)
dVIB(x = c(.5,.7,.8), mu = .3, phi = 20, p = .5, k= .5, q0 = .2, q1 = .1)

</code></pre>

<hr>
<h2 id='Election'>Italian Election Results</h2><span id='topic+Election'></span>

<h3>Description</h3>

<p>Data from the Italian general election held on 4 March 2018.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 232 observations on the following 13 variables:
</p>

<dl>
<dt><code>NVotes</code></dt><dd><p>the number of valid votes.</p>
</dd>
<dt><code>FI</code></dt><dd><p>the percentage of votes got by &lsquo;Forza Italia&rsquo; party.</p>
</dd>
<dt><code>FDI</code></dt><dd><p>the percentage of votes got by &lsquo;Fratelli d&rsquo;Italia' party.</p>
</dd>
<dt><code>LEGA</code></dt><dd><p>the percentage of votes got by &lsquo;Lega&rsquo; party.</p>
</dd>
<dt><code>LEU</code></dt><dd><p>the percentage of votes got by &lsquo;Liberi e Uguali&rsquo; party.</p>
</dd>
<dt><code>M5S</code></dt><dd><p>the percentage of votes got by &lsquo;Movimento 5 Stelle&rsquo; party.</p>
</dd>
<dt><code>PD</code></dt><dd><p>the percentage of votes got by &lsquo;Partito Democratico&rsquo; party.</p>
</dd>
<dt><code>Other</code></dt><dd><p>the percentage of votes got by other parties, including blank ballots.</p>
</dd>
<dt><code>AgeInd</code></dt><dd><p>the age index, defined as the ratio of the number of elderly persons (aged 65 and over) to the number of young persons (from 0 to 14), divided by 10.</p>
</dd>
<dt><code>PopDens</code></dt><dd><p>the number of inhabitants per square km.</p>
</dd>
<dt><code>ER</code></dt><dd><p>the employment rate, defined as the ratio of the number of employed persons (aged 15-64) to the number of persons (aged 15-64).</p>
</dd>
<dt><code>Illiteracy</code></dt><dd><p>the illiteracy rate, defined as the ratio of the number of persons without a qualification (aged 15 and over) to the total number of persons aged 15 and over.</p>
</dd>
<dt><code>Foreign</code></dt><dd><p>the number of foreigners per 1000 inhabitants.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Data are collected on the 232 electoral districts into which the Italian territory is organized. Distribution of votes for Aosta constituency is not available. Distributions of votes are available on the Italian Ministry of Interior’s webpage, whereas constituencies information have been obtained from 2011 Italian Census.
The count of votes got by each party can be derived by multiplying the percentage of votes and the number of valid votes.
</p>


<h3>Source</h3>

<p>Italian Ministry of Interior’s webpage: https://www.interno.gov.it/it/speciali/2018-elections.
</p>

<hr>
<h2 id='extract.pars'>extract.pars</h2><span id='topic+extract.pars'></span>

<h3>Description</h3>

<p>extract.pars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract.pars(posterior)
</code></pre>

<hr>
<h2 id='flexreg'>Flexible Regression Models for Bounded Continuous Responses</h2><span id='topic+flexreg'></span>

<h3>Description</h3>

<p>The function fits some flexible regression models for bounded continuous responses (e.g., proportions and rates) via a Bayesian approach to inference based on Hamiltonian Monte Carlo algorithm.
Available regression models are the flexible beta regression model (<code>type = "FB"</code>, default), the variance inflated beta (<code>type = "VIB"</code>),  the beta  (<code>type = "Beta"</code>), as well as their augmented versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flexreg(
  formula,
  zero.formula = NULL,
  one.formula = NULL,
  data,
  type = "FB",
  link.mu = "logit",
  prior.beta = "normal",
  hyperparam.beta = NULL,
  prior.omega0 = "normal",
  hyperparam.omega0 = NULL,
  prior.omega1 = "normal",
  hyperparam.omega1 = NULL,
  link.phi = NULL,
  prior.phi = NULL,
  hyperparam.phi = NULL,
  prior.psi = NULL,
  hyperparam.psi = NULL,
  n.chain = 1,
  n.iter = 5000,
  warmup.perc = 0.5,
  thin = 1,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flexreg_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;: a symbolic description of the mean model (<code>y ~ x</code>) or the mean and precision models (<code>y ~ x | z</code>) to be fitted (see Details).</p>
</td></tr>
<tr><td><code id="flexreg_+3A_zero.formula">zero.formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;: a symbolic description of the zero augmented model to be fitted (see Details).</p>
</td></tr>
<tr><td><code id="flexreg_+3A_one.formula">one.formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;: a symbolic description of the one augmented model to be fitted (see Details).</p>
</td></tr>
<tr><td><code id="flexreg_+3A_data">data</code></td>
<td>
<p>an optional  <code>data.frame</code>, list, or object that is coercible to a  <code>data.frame</code> through <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> containing the variables in the model. If not found in <code>data</code>, the variables in <code>formula</code>, <code>zero.formula</code>, and <code>one.formula</code> are taken from the environment from which the function <code><a href="#topic+flexreg">flexreg</a></code> is called.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_type">type</code></td>
<td>
<p>a character specifying the type of regression model. Current options are <code>"FB"</code> (flexible beta, default), <code>"VIB"</code> (variance inflated beta), and <code>"Beta"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_link.mu">link.mu</code></td>
<td>
<p>a character specifying the link function for the mean model (mu). Currently, <code>"logit"</code> (default), <code>"probit"</code>, <code>"cloglog"</code>, and <code>"loglog"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_prior.beta">prior.beta</code></td>
<td>
<p>a character specifying the prior distribution for the  regression coefficients of the mean model, <code>beta</code>. Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_hyperparam.beta">hyperparam.beta</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>beta</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_prior.omega0">prior.omega0</code></td>
<td>
<p>a character specifying the prior distribution for the  regression coefficients of the augmented model in zero, <code>omega0</code>. Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_hyperparam.omega0">hyperparam.omega0</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>omega0</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_prior.omega1">prior.omega1</code></td>
<td>
<p>a character specifying the prior distribution for the  regression coefficients of the augmented model in one, <code>omega1</code>. Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_hyperparam.omega1">hyperparam.omega1</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>omega1</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_link.phi">link.phi</code></td>
<td>
<p>a character specifying the link function for the precision model (phi). Currently, <code>"identity"</code> (default), <code>"log"</code>, and <code>"sqrt"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_prior.phi">prior.phi</code></td>
<td>
<p>a character specifying the prior distribution for precision parameter <code>phi</code> if <br /> <code>link.phi = "identity"</code>. Currently, <code>"gamma"</code> (default) and <code>"unif"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_hyperparam.phi">hyperparam.phi</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior parameter for the prior distribution of <code>phi</code>. If the prior is <code>"gamma"</code>, the value identifies the gamma's shape and rate parameters (the default is 0.001). If the prior is <code>"uniform"</code> the hyperparameter must be specified to define the upper limit of the support of <code>phi</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_prior.psi">prior.psi</code></td>
<td>
<p>a character specifying the prior distribution for the regression coefficients of the precision model <code>psi</code> (not supported if <code>link.phi = "identity"</code>). Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_hyperparam.psi">hyperparam.psi</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>psi</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_n.chain">n.chain</code></td>
<td>
<p>a positive integer specifying the number of Markov chains. The default is 1.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_n.iter">n.iter</code></td>
<td>
<p>a positive integer specifying the number of iterations for each chain (including warm-up). The default is 5000.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_warmup.perc">warmup.perc</code></td>
<td>
<p>the percentage of iterations per chain to discard.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_thin">thin</code></td>
<td>
<p>a positive integer specifying the period for saving samples. The default is 1.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_verbose">verbose</code></td>
<td>
<p>a logical (with default <code>TRUE</code>) indicating whether to print intermediate output.</p>
</td></tr>
<tr><td><code id="flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments from <code>sampling</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let Y be a continuous bounded random variable whose distribution can be specified in the <code>type</code> argument and <code class="reqn">\mu</code> be the mean of Y.
The <code><a href="#topic+flexreg">flexreg</a></code> function links the parameter <code class="reqn">\mu</code> to a linear predictor through a function  <code class="reqn">g_1(\cdot)</code> specified in <code>link.mu</code>:
</p>
<p style="text-align: center;"><code class="reqn">g_1(\mu) = \bold{x}^t \bold{\beta},</code>
</p>
<p> where <code class="reqn">\bold{\beta}</code> is the vector of regression coefficients for the mean model.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\beta}</code> can be specified in <code>prior.beta</code> and <code>hyperparam.beta</code>, respectively.
By default, the precision parameter <code class="reqn">\phi</code> is assumed to be constant.
The prior distribution and the related hyperparameter of <code class="reqn">\phi</code> can be specified in <code>prior.phi</code> and <code>hyperparam.phi</code>.
It is possible to extend the model by linking <code class="reqn">\phi</code> to an additional (possibly overlapping) set of covariates through a proper link
function <code class="reqn">g_2(\cdot)</code>  specified in the <code>link.phi</code> argument:
</p>
<p style="text-align: center;"><code class="reqn">g_2(\phi) = \bold{z}^t \bold{\psi},</code>
</p>
<p> where <code class="reqn">\bold{\psi}</code> is the vector of regression coefficients for the precision model.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\psi}</code> can be specified in <code>prior.psi</code> and <code>hyperparam.psi</code>.
In the function <code><a href="#topic+flexreg">flexreg</a></code>, the regression model for the mean and, where appropriate, for the precision parameter can be specified in the
<code>formula</code> argument with a formula of type <code>y ~ x1 + x2 | z1 + z2</code> where covariates on the left of &quot;|&quot; are included in the regression model
for the mean, whereas covariates on the right of &quot;|&quot; are included in the regression model for the precision.
</p>
<p>If the second part is omitted, i.e., <code>y ~ x1 + x2</code>, the precision is assumed constant for each observation.
</p>
<p>In presence of zero values in the response, one has to link the parameter <code class="reqn">q_0</code>, i.e., the probability of augmentation in zero,  to an additional (possibly overlapping) set of covariates through a logit link function:
</p>
<p style="text-align: center;"><code class="reqn">g_3(q_{0}) = \bold{x}_{0}^t \bold{\omega_0},</code>
</p>
<p> where <code class="reqn">\bold{\omega_0}</code> is the vector of regression coefficients for the augmented model in zero.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\omega_0}</code> can be specified in <code>prior.omega0</code> and <code>hyperparam.omega0</code>.
In presence of one values in the response, one has to link the parameter <code class="reqn">q_1</code>, i.e., the probability of augmentation in one,  to an additional (possibly overlapping) set of covariates through a logit link function:
</p>
<p style="text-align: center;"><code class="reqn">g_4(q_{1}) = \bold{x}_{1}^t \bold{\omega_1},</code>
</p>
<p> where <code class="reqn">\bold{\omega_1}</code> is the vector of regression coefficients for the augmented model in one.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\omega_1}</code> can be specified in <code>prior.omega1</code> and <code>hyperparam.omega1</code>.
If both the augmented models in zero and one are specified, the link function is a bivariate logit.
In <code><a href="#topic+flexreg">flexreg</a></code> function, the augmented models in zero and/or one can be specified in the
<code>zero.formula</code> and/or <code>one.formula</code> arguments with a formula of type <code> ~ x</code>.
Left hand side in <code>zero.formula</code> and <code>one.formula</code> can be omitted; if specified, they have to be the same as left hand side in <code>formula</code>.
</p>


<h3>Value</h3>

<p>The <code><a href="#topic+flexreg">flexreg</a></code> function returns an object of class <code>`flexreg`</code>, i.e. a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the function call.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the type of regression model.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the overall formula.</p>
</td></tr>
<tr><td><code>aug</code></td>
<td>
<p>a character specifing the absence of the augmentation (<code>"No"</code>) or the presence of augmentation in zero (<code>"0"</code>), one (<code>"1"</code>), or both (<code>"01"</code>).</p>
</td></tr>
<tr><td><code>link.mu</code></td>
<td>
<p>a character specifing the link function in the mean model.</p>
</td></tr>
<tr><td><code>link.phi</code></td>
<td>
<p>a character specifing the link function in the precision model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>an object of class <code>`stanfit`</code> containing the fitted model.</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>the response variable, assuming values in (0, 1).</p>
</td></tr>
<tr><td><code>design.X</code></td>
<td>
<p>the design matrix for the mean model.</p>
</td></tr>
<tr><td><code>design.Z</code></td>
<td>
<p>the design matrix for the precision model (if defined).</p>
</td></tr>
<tr><td><code>design.X0</code></td>
<td>
<p>the design matrix for the augmented model in zero (if defined).</p>
</td></tr>
<tr><td><code>design.X1</code></td>
<td>
<p>the design matrix for the augmented model in one (if defined).</p>
</td></tr>
</table>


<h3>References</h3>


<p>Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309. doi:10.1177/1471082X18821213 <br />
<br />
Ferrari, S.L.P., Cribari-Neto, F. (2004). Beta Regression for Modeling Rates and Proportions. Journal of Applied Statistics, <b>31</b>(7), 799&ndash;815. doi:10.1080/0266476042000214501 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018) A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, type="FB")

# Regression model with one augmentation:
AFB1 &lt;- flexreg(accuracy ~ dyslexia | iq + dyslexia + iq:dyslexia,
one.formula = ~ iq + dyslexia, data = Reading, type="FB")

## End(Not run)
</code></pre>

<hr>
<h2 id='flexreg_binom'>Flexible Regression Models for Bounded Discrete Responses</h2><span id='topic+flexreg_binom'></span>

<h3>Description</h3>

<p>The function fits some flexible regression models for bounded discrete responses via a Bayesian approach to inference based on Hamiltonian Monte Carlo algorithm.
Available regression models are the flexible beta-binomial (<code>type = "FBB"</code>, default), the beta-binomial (<code>type = "BetaBin"</code>), and the binomial one (<code>type = "Bin"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flexreg_binom(
  formula,
  data,
  type = "FBB",
  n,
  link.mu = "logit",
  prior.beta = "normal",
  hyperparam.beta = 100,
  hyper.theta.a = NULL,
  hyper.theta.b = NULL,
  link.theta = NULL,
  prior.psi = NULL,
  hyperparam.psi = NULL,
  n.chain = 1,
  n.iter = 5000,
  warmup.perc = 0.5,
  thin = 1,
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flexreg_binom_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;<code><a href="stats.html#topic+formula">formula</a></code>&quot;: a symbolic description of the model to be fitted (<code>y ~ x</code> or <code>y ~ x | z</code>, see Details).</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_data">data</code></td>
<td>
<p>an optional  <code>data.frame</code>, list, or object that is coercible to a  <code>data.frame</code> through <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code> containing the variables in the model. If not found in <code>data</code>, the variables in <code>formula</code> are taken from the environment from which the function <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> is called.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_type">type</code></td>
<td>
<p>a character specifying the type of regression model. Current options are  <code>"FBB"</code> (flexible beta-binomial, default), <code>"BetaBin"</code> (beta-binomial), and  <code>"Bin"</code> (binomial).</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_n">n</code></td>
<td>
<p>a character specifying the name of the variable containing the total number of trials.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_link.mu">link.mu</code></td>
<td>
<p>a character specifying the link function for the mean model. Currently, <code>"logit"</code> (default), <code>"probit"</code>, <code>"cloglog"</code>, and <code>"loglog"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_prior.beta">prior.beta</code></td>
<td>
<p>a character specifying the prior distribution for the  regression coefficients of the mean model, <code>beta</code>. Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_hyperparam.beta">hyperparam.beta</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>beta</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_hyper.theta.a">hyper.theta.a</code></td>
<td>
<p>a numeric (vector of length 1) specifying the first shape parameter for the beta prior distribution of <code>theta</code>.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_hyper.theta.b">hyper.theta.b</code></td>
<td>
<p>a numeric (vector of length 1) specifying the second shape parameter for the beta prior distribution of <code>theta</code>.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_link.theta">link.theta</code></td>
<td>
<p>a character specifying the link function for the overdispersion model. Currently, <code>"identity"</code> (default), <code>"logit"</code>, <code>"probit"</code>, <code>"cloglog"</code>, and <code>"loglog"</code> are supported. If <code>link.theta = "identity"</code>, the prior distribution for <code>theta</code> is a beta.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_prior.psi">prior.psi</code></td>
<td>
<p>a character specifying the prior distribution for the regression coefficients of the overdispersion model,<code>psi</code>. Not supported if <code>link.theta="identity"</code>. Currently, <code>"normal"</code> (default) and <code>"cauchy"</code> are supported.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_hyperparam.psi">hyperparam.psi</code></td>
<td>
<p>a positive numeric (vector of length 1) specifying the hyperprior scale parameter for the prior distribution of <code>psi</code> regression coefficients. The default is 100 if the prior is <code>"normal"</code>, 2.5 if it is <code>"cauchy"</code>.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_n.chain">n.chain</code></td>
<td>
<p>a positive integer specifying the number of Markov chains. The default is 1.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_n.iter">n.iter</code></td>
<td>
<p>a positive integer specifying the number of iterations for each chain (including warm-up). The default is 5000.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_warmup.perc">warmup.perc</code></td>
<td>
<p>the percentage of iterations per chain to discard.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_thin">thin</code></td>
<td>
<p>a positive integer specifying the period for saving samples. The default is 1.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_verbose">verbose</code></td>
<td>
<p>a logical (with default <code>TRUE</code>) indicating whether to print intermediate output.</p>
</td></tr>
<tr><td><code id="flexreg_binom_+3A_...">...</code></td>
<td>
<p>additional arguments from <code>sampling</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let Y be a random variable whose distribution can be specified in the <code>type</code> argument and <code class="reqn">\mu</code> be the mean of Y/n.
The <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> function links the parameter <code class="reqn">\mu</code> to a linear predictor through a function  <code class="reqn">g_1(\cdot)</code> specified in <code>link.mu</code>:
</p>
<p style="text-align: center;"><code class="reqn">g_1(\mu) = x^t \bold{\beta},</code>
</p>
<p> where <code class="reqn">\bold{\beta}</code> is the vector of regression coefficients for the mean model.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\beta}</code> can be specified in <code>prior.beta</code> and <code>hyperparam.beta</code>.
By default, <code>link.theta="identity"</code>, meaning that the overdispersion parameter <code class="reqn">\theta</code> is assumed to be constant.
In that case, the prior distribution for <code class="reqn">\theta</code> is a beta with shape hyperparameters <code class="reqn">a</code> and <code class="reqn">b</code> that can be specified in <code>hyper.theta.a</code> and <code>hyper.theta.b</code>.
If not specified, <code class="reqn">a=b=1</code>, otherwise if only one hyperparameter is specified, the other  is set equal.
It is possible to extend the model by linking <code class="reqn">\theta</code> to an additional (possibly overlapping) set of covariates through a proper link
function <code class="reqn">g_2(\cdot)</code>  specified in the <code>link.theta</code> argument: </p>
<p style="text-align: center;"><code class="reqn">g_2(\theta) = z^t \bold{\psi},</code>
</p>
<p> where <code class="reqn">\bold{\psi}</code> is the vector of regression coefficients for the overdispersion model.
The prior distribution and the related hyperparameter of <code class="reqn">\bold{\psi}</code> can be specified in <code>prior.psi</code> and <code>hyperparam.psi</code>.
In <code><a href="#topic+flexreg_binom">flexreg_binom</a></code>, the regression model for the mean and, where appropriate, for the overdispersion parameter can be specified in the
<code>formula</code> argument with a formula of type <code>y ~ x1 + x2 | z1 + z2</code> where covariates on the left of &quot;|&quot; are included in the regression model
for the mean, whereas covariates on the right of &quot;|&quot; are included in the regression model for the overdispersion.
</p>
<p>If the second part is omitted, i.e., <code>y ~ x1 + x2</code>, the overdispersion is assumed constant for each observation.
</p>


<h3>Value</h3>

<p>The <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> function returns an object of class <code>`flexreg`</code>, i.e. a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the function call.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>the type of regression model.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the original formula.</p>
</td></tr>
<tr><td><code>link.mu</code></td>
<td>
<p>a character specifing the link function in the mean model.</p>
</td></tr>
<tr><td><code>link.theta</code></td>
<td>
<p>a character specifing the link function in the overdispersion model.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>an object of class <code>`stanfit`</code> containing the fitted model.</p>
</td></tr>
<tr><td><code>response</code></td>
<td>
<p>the response variable, assuming values in (0, 1).</p>
</td></tr>
<tr><td><code>design.X</code></td>
<td>
<p>the design matrix for the mean model.</p>
</td></tr>
<tr><td><code>design.Z</code></td>
<td>
<p>the design matrix for the overdispersion model (if defined).</p>
</td></tr>
</table>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Bacteria)
fbb &lt;- flexreg_binom(y ~ females,  n = "n", data = Bacteria, type = "FBB")

## End(Not run)
</code></pre>

<hr>
<h2 id='mu.chain.nd'>mu.chain.nd</h2><span id='topic+mu.chain.nd'></span>

<h3>Description</h3>

<p>mu.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mu.chain.nd(posterior, newdata.X, link.mu)
</code></pre>

<hr>
<h2 id='newdata.adjust'>newdata.adjust</h2><span id='topic+newdata.adjust'></span>

<h3>Description</h3>

<p>newdata.adjust
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newdata.adjust(newdata, formula)
</code></pre>

<hr>
<h2 id='phi.chain.nd'>phi.chain.nd</h2><span id='topic+phi.chain.nd'></span>

<h3>Description</h3>

<p>phi.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phi.chain.nd(posterior, newdata.Z, link.phi)
</code></pre>

<hr>
<h2 id='plot.flexreg'>Plot Method for <code>flexreg</code> Objects</h2><span id='topic+plot.flexreg'></span>

<h3>Description</h3>

<p>Method for plotting regression curves for the mean from fitted regression model objects of class <code>`flexreg`</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
plot(
  x,
  name.x,
  additional.cov.default = NA,
  smooth = TRUE,
  cluster = FALSE,
  type = "response",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.flexreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_name.x">name.x</code></td>
<td>
<p>a character containing the name of the covariate from the mean model to be plotted on the x-axis of the scatterplot.</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_additional.cov.default">additional.cov.default</code></td>
<td>
<p>a list of additional covariates from the mean model and their value to be set as default.</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_smooth">smooth</code></td>
<td>
<p>a logical value indicating wheater the curves should be smooth (<code>TRUE</code>) or piecewise linear (<code>FALSE</code>, default).</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_cluster">cluster</code></td>
<td>
<p>logical. If the model is <code>"FB"</code> or <code>"FBB"</code>, <code>cluster = TRUE</code> plots the cluster means. By default, <code>cluster = FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_type">type</code></td>
<td>
<p>a vector of characters indicating the regression curves to be plotted. Available options are <code>"response"</code> and <code>"response.aug"</code> for augmented models.</p>
</td></tr>
<tr><td><code id="plot.flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces a scatterplot of the covariate from the mean model specified in <code>name.x</code> and <code>y</code> or <code>y/n</code> if the response is bounded continuous or discrete, respectively. Any other variable specified in the mean model must be set to a default through the <code>additional.cov.default</code> argument.
The argument <code>type = "response"</code> plots the conditional mean curve (i.e., <code class="reqn">\mu</code>), whereas the argument <code>type = "response.aug"</code>, available only for augmented models,
plots the augmented mean curve.
If the regression model is of <code>"FB"</code> or <code>"FBB"</code> type and <code>cluster = TRUE</code>, then the function returns two additional curves corresponding to the component means, i.e., <code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq + dyslexia, data = Reading)
plot(FB, name.x="iq", additional.cov.default = list("dyslexia"=1))

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.flexreg_postpred'>Plot Method for <code>`flexreg_postpred`</code> objects</h2><span id='topic+plot.flexreg_postpred'></span>

<h3>Description</h3>

<p>Method for an object of class <code>`flexreg_postpred`</code> containing the simulated posterior predictive distribution, usually the result of <code><a href="#topic+posterior_predict">posterior_predict</a></code> function. The plot shows the posterior predictive interval for each statistical unit.
Additionally, the mean of the posterior predictives and the values of the observed response (either <code class="reqn">y</code> or <code class="reqn">y/n</code> for bounded continuous  or discrete responses, respectively) can be added.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg_postpred'
plot(x, prob = 0.9, p_mean = F, response = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.flexreg_postpred_+3A_x">x</code></td>
<td>
<p>an object of class <code>`flexreg_postpred`</code> containing the simulated posterior predictives, usually the result of <code><a href="#topic+posterior_predict">posterior_predict</a></code>.</p>
</td></tr>
<tr><td><code id="plot.flexreg_postpred_+3A_prob">prob</code></td>
<td>
<p>the interval probability for the posterior predictives (default is 0.9).</p>
</td></tr>
<tr><td><code id="plot.flexreg_postpred_+3A_p_mean">p_mean</code></td>
<td>
<p>a logical value indicating whether the posterior predictives' mean should be plotted.</p>
</td></tr>
<tr><td><code id="plot.flexreg_postpred_+3A_response">response</code></td>
<td>
<p>a numerical vector containing the response (either <code class="reqn">y</code> or <code class="reqn">y/n</code> for bounded continuous or discrete responses, respectively) to be added to the plot. If <code>NULL</code>, observed values are not plotted.</p>
</td></tr>
<tr><td><code id="plot.flexreg_postpred_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy ~ iq, data = Reading)
pp &lt;- posterior_predict(FB)
plot(pp)

## End(Not run)

</code></pre>

<hr>
<h2 id='posterior_predict'>posterior_predict</h2><span id='topic+posterior_predict'></span>

<h3>Description</h3>

<p>posterior_predict
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_predict(model, newdata = NULL, n.new = NULL)
</code></pre>

<hr>
<h2 id='posterior_predict.flexreg'>Posterior Predictive Method for <code>`flexreg`</code> objects</h2><span id='topic+posterior_predict.flexreg'></span>

<h3>Description</h3>

<p>The function takes an object of class <code>`flexreg`</code> and generates values from the posterior predictive distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
posterior_predict(model, newdata = NULL, n.new = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_predict.flexreg_+3A_model">model</code></td>
<td>
<p>an object of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="posterior_predict.flexreg_+3A_newdata">newdata</code></td>
<td>
<p>an optional  <code>data.frame</code> containing variables with which to predict. If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="posterior_predict.flexreg_+3A_n.new">n.new</code></td>
<td>
<p>an optional vector containing the total number of trials with which to predict. It must be specified if <code>newdata</code> is not <code>NULL</code> and the
<code><a href="#topic+flexreg">flexreg</a></code> object is the result of the <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> function (i.e., the fitted model is binomial, beta-binomial, or flexible beta-binomial). The vector must have the same length as <code>nrow(newdata)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function generates values from the posterior predictive distribution, which is the distribution of a  future outcome given the observed data.
The posterior predictive distribution is computed for <code class="reqn">y</code> in case of bounded continuous  responses and
for <code class="reqn">y/n</code> in case of bounded discrete responses.
</p>


<h3>Value</h3>

<p>An object of class <code>`flexreg_postpred`</code> containing a matrix with the simulated posterior predictions. Each column refers to a statistical unit to predict.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309. doi:10.1177/1471082X18821213 <br />
<br />
Gelman, A., Carlin, J. B., Stern, H. S., Rubin, D. B. (2014). Bayesian Data Analysis, 3th edition. Chapman and Hall/CRC. doi:10.1201/b16018 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, n.iter=1000)
pp &lt;- posterior_predict(FB)
plot(pp)

## End(Not run)

</code></pre>

<hr>
<h2 id='predict_lambda.chain'>predict_lambda.chain</h2><span id='topic+predict_lambda.chain'></span>

<h3>Description</h3>

<p>predict_lambda.chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_lambda.chain(posterior, mu.chain, newdata)
</code></pre>

<hr>
<h2 id='predict_link'>predict_link</h2><span id='topic+predict_link'></span>

<h3>Description</h3>

<p>predict_link
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_link(model, posterior, newdata)
</code></pre>

<hr>
<h2 id='predict_mu.chain'>predict_mu.chain</h2><span id='topic+predict_mu.chain'></span>

<h3>Description</h3>

<p>predict_mu.chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_mu.chain(model, posterior, newdata)
</code></pre>

<hr>
<h2 id='predict_over'>predict_over</h2><span id='topic+predict_over'></span>

<h3>Description</h3>

<p>predict_over
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_over(model, posterior, newdata)
</code></pre>

<hr>
<h2 id='predict_precision'>predict_precision</h2><span id='topic+predict_precision'></span>

<h3>Description</h3>

<p>predict_precision
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_precision(model, posterior, newdata)
</code></pre>

<hr>
<h2 id='predict_q.chain'>predict_q.chain</h2><span id='topic+predict_q.chain'></span>

<h3>Description</h3>

<p>predict_q.chain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_q.chain(model, posterior, newdata = NULL)
</code></pre>

<hr>
<h2 id='predict_response'>predict_response</h2><span id='topic+predict_response'></span>

<h3>Description</h3>

<p>predict_response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_response(model, posterior, newdata, cluster, n)
</code></pre>

<hr>
<h2 id='predict_variance'>predict_variance</h2><span id='topic+predict_variance'></span>

<h3>Description</h3>

<p>predict_variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_variance(
  model,
  posterior,
  newdata,
  cluster,
  cluster.var = T,
  model.type,
  model.class,
  n
)
</code></pre>

<hr>
<h2 id='predict.flexreg'>Predict Method for <code>`flexreg`</code> Objects</h2><span id='topic+predict.flexreg'></span>

<h3>Description</h3>

<p>Method that computes various types of predictions from objects of class <code>`flexreg`</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
predict(
  object,
  newdata = NULL,
  n.new = NULL,
  cluster = FALSE,
  type = "response",
  estimate = "mean",
  q = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.flexreg_+3A_object">object</code></td>
<td>
<p>an object of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_newdata">newdata</code></td>
<td>
<p>an optional  <code>data.frame</code> containing variables with which to predict. If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_n.new">n.new</code></td>
<td>
<p>an optional vector containing the total number of trials with which to predict. It must be specified if <code>newdata</code> is not <code>NULL</code> and the
<code><a href="#topic+flexreg">flexreg</a></code> object is the result of the <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> function (i.e., the fitted model is binomial, beta-binomial, or flexible beta-binomial). The vector must have the same length as <code>nrow(newdata)</code>.</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_cluster">cluster</code></td>
<td>
<p>a logical (with default <code>FALSE</code>).  The option <code>cluster = TRUE</code> is available only for <code>"FB"</code> and <code>"FBB"</code> models and allows to compute some component-specific predictions (see Details).</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_type">type</code></td>
<td>
<p>a character indicating the type of prediction. Available options are: <code>"response"</code>, returning the marginal fitted mean of the response/relative response;
<code>"link"</code>, returning the linear predictor of the mean model;
<code>"precision"</code>, returning the fitted precision parameter;
<code>"overdispersion"</code>, returning the fitted overdispersion parameter;
<code>"variance"</code>, returning the fitted variance of the response.</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_estimate">estimate</code></td>
<td>
<p>a character indicating the type of estimate. Available options are <code>"mean"</code> (default), <code>"median"</code>, and <code>"quantile"</code>.</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_q">q</code></td>
<td>
<p>if <code>estimate = "quantile"</code>, a numeric value of probability in (0, 1).</p>
</td></tr>
<tr><td><code id="predict.flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="stats.html#topic+predict">predict</a></code> method computes various types of predictions from objects of class <code>`flexreg`</code>.
If <code>type = "response"</code>, the function returns the marginal mean, i.e., <code class="reqn">\mu</code>.
In case of models for continuous bounded responses with augmentation, the function returns also the overall mean
<code class="reqn">q_1+(1-q_0-q_1)\mu</code> and the probabilities of augmentation <code class="reqn">q_0</code> and/or <code class="reqn">q_1</code>.
If <code>type = "variance"</code>, the function returns <code class="reqn">Var(Y|0&lt;Y&lt;1)</code> in case of no augmentation and
<code class="reqn">(1-q_0-q_1)Var(Y|0&lt;Y&lt;1)+q_1^2+(1-q_0-q_1)\mu^2-(q_1+(1-q_0-q_1)\mu)^2</code> in case of augmentation.
If <code>cluster = TRUE</code>, for FB and FBB models, the function returns the cluster means (<code class="reqn">\lambda_1</code> and <code class="reqn">\lambda_2</code>) when <code>type = "response"</code> and the cluster variances when <code>type = "variance"</code>.
</p>
<p>The option <code>type = "overdispersion"</code>  is available only for beta-binomial and flexible beta-binomial models and returns the fitted overdispersion.
</p>


<h3>Value</h3>

<p>The function returns a <code>data.frame</code> of different dimensions depending on the type of prediction.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data=Reading, type="FB")
predict(FB, type="response", cluster=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='print.flexreg'>Print Methods for flexreg Objects</h2><span id='topic+print.flexreg'></span>

<h3>Description</h3>

<p>Print Methods for flexreg Objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.flexreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>`flexreg`</code>.</p>
</td></tr>
<tr><td><code id="print.flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
</table>

<hr>
<h2 id='q0.chain.nd'>q0.chain.nd</h2><span id='topic+q0.chain.nd'></span>

<h3>Description</h3>

<p>q0.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q0.chain.nd(posterior, newdata.X0)
</code></pre>

<hr>
<h2 id='q01.chain.nd'>q01.chain.nd</h2><span id='topic+q01.chain.nd'></span>

<h3>Description</h3>

<p>q01.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q01.chain.nd(posterior, newdata.X0, newdata.X1)
</code></pre>

<hr>
<h2 id='q1.chain.nd'>q1.chain.nd</h2><span id='topic+q1.chain.nd'></span>

<h3>Description</h3>

<p>q1.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>q1.chain.nd(posterior, newdata.X1)
</code></pre>

<hr>
<h2 id='R2_bayes'>Bayesian R-squared for <code>flexreg</code> Objects</h2><span id='topic+R2_bayes'></span>

<h3>Description</h3>

<p>Bayesian version of R-squared for flexible regression models for bounded continuous and discrete responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R2_bayes(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R2_bayes_+3A_model">model</code></td>
<td>
<p>an object (or a list of objects) of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function provides a Bayesian version of the R-squared measure, defined as the variance of the predicted values divided by itself plus the expected variance of the errors.
</p>


<h3>Value</h3>

<p>A list with the same length as the number of objects of class <code>`flexreg`</code> passed in the <code>model</code> argument.
Each element of the list contains a vector of  Bayesian R-squared values with the same length as the Markov Chain(s) after warmup.
</p>


<h3>References</h3>


<p>Gelman, A., Goodrich, B., Gabry, J., Vehtari, A. (2019). R-squared for Bayesian Regression Models, The American Statistician, 73:3, 307&ndash;309. doi: 10.1080/00031305.2018.1549100

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, type = "FB", n.iter=1000)
hist(R2_bayes(FB)[[1]])

</code></pre>

<hr>
<h2 id='rate_plot'>rate_plot</h2><span id='topic+rate_plot'></span>

<h3>Description</h3>

<p>rate_plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate_plot(chains, pars, n.warmup = n.warmup)
</code></pre>

<hr>
<h2 id='rBeta'>Random generator from the beta distribution</h2><span id='topic+rBeta'></span>

<h3>Description</h3>

<p>The function  generates random values from the beta distribution with a mean-precision parameterization, or from the augmented beta distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBeta(n, mu, phi, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rBeta_+3A_n">n</code></td>
<td>
<p>the number of values to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rBeta_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rBeta_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="rBeta_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="rBeta_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>n</code>.
</p>


<h3>References</h3>


<p>Ferrari, S.L.P.,  Cribari-Neto, F. (2004). Beta Regression for Modeling Rates and Proportions. Journal of Applied Statistics, <b>31</b>(7), 799&ndash;815. doi:10.1080/0266476042000214501

</p>


<h3>Examples</h3>

<pre><code class='language-R'>rBeta(n = 100, mu = .5, phi = 30)
rBeta(n = 100, mu = .5, phi = 30, q0 = .2, q1 = .1)

</code></pre>

<hr>
<h2 id='rBetaBin'>Random generator from the beta-binomial distribution</h2><span id='topic+rBetaBin'></span>

<h3>Description</h3>

<p>The function  generates random values from the beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBetaBin(n, size = NULL, mu = NULL, theta = NULL, phi = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rBetaBin_+3A_n">n</code></td>
<td>
<p>the number of values to generate. If <code>length(n)</code> &gt; 1, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rBetaBin_+3A_size">size</code></td>
<td>
<p>the total number of trials.</p>
</td></tr>
<tr><td><code id="rBetaBin_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rBetaBin_+3A_theta">theta</code></td>
<td>
<p>the overdispersion parameter. It must  lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rBetaBin_+3A_phi">phi</code></td>
<td>
<p>the precision parameter, an alternative way to specify the overdispersion parameter <code>theta</code>.  It must be a real positive value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code>n</code>.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005

</p>


<h3>Examples</h3>

<pre><code class='language-R'>rBetaBin(n = 100, size = 40, mu = .5, theta = .4)
rBetaBin(n = 100, size = 40, mu = .5, phi = 1.5)

</code></pre>

<hr>
<h2 id='Reading'>Reading Skills data</h2><span id='topic+Reading'></span>

<h3>Description</h3>

<p>Data for assessing the contribution of non-verbal IQ to children's reading skills in dyslexic and non-dyslexic children.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 44 observations on 4 variables.
</p>

<dl>
<dt><code>accuracy</code></dt><dd><p>a reading score.</p>
</dd>
<dt><code>accuracy.adj</code></dt><dd><p>the adjusted reading score: the observed 1's (perfect reading scores) are substituted with 0.99.</p>
</dd>
<dt><code>dyslexia</code></dt><dd><p>a factor indicating wheter the child is dyslexic.</p>
</dd>
<dt><code>iq</code></dt><dd><p>a standardized quantitative measure of the children's non verbal abilities.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data were originally analyzed by Pammer and Kevan (2004) and successively used by Smithson and Verkuilen (2006) and by Migliorati et al. (2018).
</p>


<h3>Source</h3>

<p><a href="https://CRAN.R-project.org/package=betareg">betareg</a>.
</p>


<h3>References</h3>


<p>Cribari-Neto, F.,  Zeileis, A. (2010). Beta Regression in R. Journal of Statistical Software, 34(2), 1&ndash;24. <br />
<br />
Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />
<br />
Smithson, M., Verkuilen, J. (2006). A Better Lemon Squeezer? Maximum-Likelihood Regression with Beta-Distributed Dependent Variables. Psychological Methods, <b>11</b>(7), 54&ndash;71. <br />

</p>

<hr>
<h2 id='residuals.flexreg'>Residuals Method for flexreg Objects</h2><span id='topic+residuals.flexreg'></span>

<h3>Description</h3>

<p>Method that computes various types of residuals from objects of class <code>`flexreg`</code>. If the model type is  <code>FB</code> or <code>FBB</code> and <code>cluster = TRUE</code>, the method returns also residuals with respect to cluster means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
residuals(
  object,
  type = "raw",
  cluster = FALSE,
  estimate = "mean",
  q = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.flexreg_+3A_object">object</code></td>
<td>
<p>an object of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="residuals.flexreg_+3A_type">type</code></td>
<td>
<p>a character indicating type of residuals (<code>"raw"</code> or <code>"standardized"</code>).</p>
</td></tr>
<tr><td><code id="residuals.flexreg_+3A_cluster">cluster</code></td>
<td>
<p>logical. If the model is <code>"FB"</code> without augmentation or <code>"FBB"</code>, <code>cluster = TRUE</code> returns the cluster means. By default <code>cluster = FALSE</code>.</p>
</td></tr>
<tr><td><code id="residuals.flexreg_+3A_estimate">estimate</code></td>
<td>
<p>a character indicating the type of estimate: <code>"mean"</code> (default), <code>"median"</code>, or <code>"quantile"</code>.</p>
</td></tr>
<tr><td><code id="residuals.flexreg_+3A_q">q</code></td>
<td>
<p>if <code>estimate = "quantile"</code>, a numeric value of probability in (0, 1).</p>
</td></tr>
<tr><td><code id="residuals.flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>residuals</code> method  computes raw and standardized residuals from objects of class <code>`flexreg`</code>.
Raw residuals are defined as <code class="reqn">r=y-\hat{\mu}</code> for bounded continuous  responses or as <code class="reqn">r= y/n-\hat{\mu}</code> for bounded discrete responses.
Values <code class="reqn">y</code> and <code class="reqn">y/n</code> are  the observed
responses which are specified on the left-hand side of <code>formula</code> in the
<code><a href="#topic+flexreg">flexreg</a></code> and <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions, respectively.
Moreover,  <code class="reqn">\hat{\mu}</code>  is the predicted value, the result of
the <code><a href="stats.html#topic+predict">predict</a></code> function with <code>type = "response"</code>.
Standardized residuals are defined as <code class="reqn">\frac{r}{\sqrt{\widehat{Var}(y)}}</code> where
<code class="reqn">\widehat{Var}(y)</code>
is the variance of the response evaluated at the posterior means
&ndash;by default, otherwise evaluated at the posterior quantiles of order <code>q</code>&ndash; of the parameters.
If the model is <code>"FB"</code> or <code>"FBB"</code>, <code>type = "raw"</code>, and <code>cluster = TRUE</code>, the cluster raw residuals are computed as
the difference between the observed response/relative response  and the cluster means, i.e.,
<code class="reqn">\hat{\lambda}_{1}</code> and <code class="reqn">\hat{\lambda}_{2}</code>.
If the model is <code>"FB"</code> or <code>"FBB"</code>, <code>type = "standardized"</code> and <code>cluster = TRUE</code>, the cluster standardized residuals are computed as the
cluster raw residuals divided by the square root of the cluster variances.
Cluster residuals, either raw or standardized, can be used for classification purpose. Indeed, with <code>cluster = TRUE</code> the <code>residuals</code> method returns also a column named
<code>"label"</code> assigning values 1 or 2 to observations depending on whether they are classified in cluster 1 (if the corresponding cluster residual is smaller) or in cluster 2.
</p>


<h3>Value</h3>

<p>The method returns an array with as many rows as the number of observations in the sample. If <code>cluster = FALSE</code>, the array has only one column containing either the raw or standardized residuals.
If <code>cluster = TRUE</code>, the array has four columns: the first column contains the raw or standardized residuals, the second and third columns contain the cluster residuals,
and the fourth column contains the classification labels (see Details).
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005 <br />
<br />
Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079 <br />

</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data=Reading, type="FB")
residuals(FB, type="raw", cluster=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='rFB'>Random generator from the flexible beta distribution</h2><span id='topic+rFB'></span>

<h3>Description</h3>

<p>The function generates random values from the flexible beta distribution, or from the augmented flexible beta distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rFB(n, mu, phi, p, w, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rFB_+3A_n">n</code></td>
<td>
<p>the number of values to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rFB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="rFB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFB_+3A_w">w</code></td>
<td>
<p>the normalized distance among clusters. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFB_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="rFB_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length  <code>n</code>.
</p>


<h3>References</h3>


<p>Di Brisco, A. M., Migliorati, S. (2020). A new mixed-effects mixture model for constrained longitudinal data. Statistics in Medicine, <b>39</b>(2), 129&ndash;145. doi:10.1002/sim.8406 <br />
<br />
Migliorati, S., Di Brisco, A. M., Ongaro, A. (2018). A New Regression Model for Bounded Responses. Bayesian Analysis, <b>13</b>(3), 845&ndash;872. doi:10.1214/17-BA1079

</p>


<h3>Examples</h3>

<pre><code class='language-R'>rFB(n = 100, mu = .5, phi = 30,p = .3, w = .6)
rFB(n = 100, mu = .5, phi = 30,p = .3, w = .6, q0 = .2, q1 = .1)
</code></pre>

<hr>
<h2 id='rFBB'>Random generator from the flexible beta-binomial distribution</h2><span id='topic+rFBB'></span>

<h3>Description</h3>

<p>The function generates random values from the flexible beta-binomial distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rFBB(n, size = NULL, mu, theta = NULL, phi = NULL, p, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rFBB_+3A_n">n</code></td>
<td>
<p>the number of values to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rFBB_+3A_size">size</code></td>
<td>
<p>the total number of trials.</p>
</td></tr>
<tr><td><code id="rFBB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFBB_+3A_theta">theta</code></td>
<td>
<p>the overdispersion parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFBB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter, an alternative way to specify the overdispersion parameter <code>theta</code>. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="rFBB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rFBB_+3A_w">w</code></td>
<td>
<p>the normalized distance among clusters. It must lie in (0, 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length  <code>n</code>.
</p>


<h3>References</h3>


<p>Ascari, R., Migliorati, S. (2021). A new regression model for overdispersed binomial data accounting for outliers and an excess of zeros. Statistics in Medicine, <b>40</b>(17), 3895&ndash;3914. doi:10.1002/sim.9005

</p>


<h3>Examples</h3>

<pre><code class='language-R'>rFBB(n = 100, size = 40, mu = .5, theta = .4, p = .3, w = .6)
rFBB(n = 100, size = 40, mu = .5, phi = 1.5, p = .3, w = .6)

</code></pre>

<hr>
<h2 id='rVIB'>Random generation from the variance-inflated beta distribution</h2><span id='topic+rVIB'></span>

<h3>Description</h3>

<p>The function generates random values from the variance-inflated beta distribution, or from the augmented variance-inflated beta distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rVIB(n, mu, phi, p, k, q0 = NULL, q1 = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rVIB_+3A_n">n</code></td>
<td>
<p>the number of values to generate. If <code>length(n) &gt; 1</code>, the length is taken to be the number required.</p>
</td></tr>
<tr><td><code id="rVIB_+3A_mu">mu</code></td>
<td>
<p>the mean parameter. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rVIB_+3A_phi">phi</code></td>
<td>
<p>the precision parameter. It must be a real positive value.</p>
</td></tr>
<tr><td><code id="rVIB_+3A_p">p</code></td>
<td>
<p>the mixing weight. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rVIB_+3A_k">k</code></td>
<td>
<p>the extent of the variance inflation. It must lie in (0, 1).</p>
</td></tr>
<tr><td><code id="rVIB_+3A_q0">q0</code></td>
<td>
<p>the probability of augmentation in zero. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="rVIB_+3A_q1">q1</code></td>
<td>
<p>the probability of augmentation in one. It must lie in (0, 1). In case of no augmentation, it is <code>NULL</code> (default).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length  <code>n</code>.
</p>


<h3>References</h3>


<p>Di Brisco, A. M., Migliorati, S., Ongaro, A. (2020). Robustness against outliers: A new variance inflated regression model for proportions. Statistical Modelling, <b>20</b>(3), 274&ndash;309. doi:10.1177/1471082X18821213

</p>


<h3>Examples</h3>

<pre><code class='language-R'>rVIB(n = 100, mu = .5, phi = 30, p = .3, k = .6)
rVIB(n = 100, mu = .5, phi = 30, p = .3, k = .6, q0 = .2, q1 = .1)

</code></pre>

<hr>
<h2 id='Stress'>Stress and anxiety data</h2><span id='topic+Stress'></span>

<h3>Description</h3>

<p>Data for assessing the dependency between stress and anxiety in  nonclinical women in Townsville, Queensland, Australia.
</p>


<h3>Format</h3>

<p>A  <code>data.frame</code> containing 166 observations on the following 2 variables:
</p>

<dl>
<dt><code>stress</code></dt><dd><p> defined as rate. </p>
</dd>
<dt><code>anxiety</code></dt><dd><p>defined as rate.</p>
</dd>
</dl>



<h3>Details</h3>

<p>Both variables are rates obtained as linear transformations from the Depression Anxiety Stress Scales which range from 0 to 42 (Lovibond &amp; Lovibond, 1995). Additional details can be found in Example 2 from Smithson and Verkuilen (2006).
</p>


<h3>Source</h3>

<p>Example 2 from Smithson and Verkuilen (2006).
</p>


<h3>References</h3>


<p>Lovibond, P. F.,  Lovibond, S. H. (1995). The structure of negative emotional states: Comparison of the Depression Anxiety Stress Scales (DASS) with the Beck Depression and Anxiety Inventories. Behaviour research and therapy, 33(3), 335&ndash;343. <br />
<br />
Smithson, M.,  Verkuilen, J. (2006). A Better Lemon Squeezer? Maximum-Likelihood Regression with Beta-Distributed Dependent Variables. Psychological Methods, 11(7), 54&ndash;71. <br />

</p>

<hr>
<h2 id='summary.flexreg'>Methods for <code>`flexreg`</code> Objects</h2><span id='topic+summary.flexreg'></span><span id='topic+print.summary.flexreg'></span><span id='topic+coef.flexreg'></span>

<h3>Description</h3>

<p>Methods for extracting information from fitted  regression model objects of class <code>`flexreg`</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg'
summary(object, ..., digits = 4)

## S3 method for class 'summary.flexreg'
print(x, ...)

## S3 method for class 'flexreg'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.flexreg_+3A_object">object</code></td>
<td>
<p>an object of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="summary.flexreg_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently not used.</p>
</td></tr>
<tr><td><code id="summary.flexreg_+3A_digits">digits</code></td>
<td>
<p>an integer indicating the number of decimal places. Default equal to 4.</p>
</td></tr>
<tr><td><code id="summary.flexreg_+3A_x">x</code></td>
<td>
<p>an object of class <code>`summary.flexreg`</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+summary.flexreg">summary.flexreg</a></code> method summarizes the results of <code><a href="#topic+flexreg">flexreg</a></code> and <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions, adding also information from the functions
<code><a href="#topic+residuals.flexreg">residuals.flexreg</a></code> and <code><a href="#topic+WAIC">WAIC</a></code>. The <code><a href="#topic+summary.flexreg">summary.flexreg</a></code> method returns an object of class <code>`summary.flexreg`</code> containing the relevant summary statistics which can subsequently be
printed using the associated <code><a href="#topic+print.summary.flexreg">print.summary.flexreg</a></code> method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, n.iter = 1000)
summary(FB)


</code></pre>

<hr>
<h2 id='summary.flexreg_postpred'>Summary Method for <code>`flexreg_postpred`</code> objects</h2><span id='topic+summary.flexreg_postpred'></span>

<h3>Description</h3>

<p>Summary method for an object of class <code>`flexreg_postpred`</code>, containing the simulated posterior predictive distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexreg_postpred'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.flexreg_postpred_+3A_object">object</code></td>
<td>
<p>an object of class <code>`flexreg_postpred`</code> containing the simulated posterior predictives, usually the result of <code><a href="#topic+posterior_predict">posterior_predict</a></code>.</p>
</td></tr>
<tr><td><code id="summary.flexreg_postpred_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function <code><a href="#topic+summary.flexreg_postpred">summary.flexreg_postpred</a></code> returns an array with the statistical units by row. The number of rows of the array is equal to the number of columns of the object of class <code>`flexreg_postpred`</code> that is given to the function.
By column there are some synthesis values that are the minimum, the first quartile, the media, the mean, the third quartile, and the maximum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy ~ iq, data = Reading)
pp &lt;- posterior_predict(FB)
summary(pp)

## End(Not run)

</code></pre>

<hr>
<h2 id='theta.chain.nd'>theta.chain.nd</h2><span id='topic+theta.chain.nd'></span>

<h3>Description</h3>

<p>theta.chain.nd
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theta.chain.nd(posterior, newdata.theta, link.theta)
</code></pre>

<hr>
<h2 id='var.fun'>var.fun</h2><span id='topic+var.fun'></span>

<h3>Description</h3>

<p>var.fun
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var.fun(
  model.class,
  model.type,
  posterior,
  mu.chain,
  phi.chain,
  theta.chain,
  q0.chain,
  q1.chain,
  l1.chain,
  l2.chain,
  n
)
</code></pre>

<hr>
<h2 id='WAIC'>WAIC and LOO</h2><span id='topic+WAIC'></span><span id='topic+print.WAIC.flexreg'></span>

<h3>Description</h3>

<p>The function computes widely applicable information criterion (WAIC) and efficient approximate leave-one-out cross-validation (LOO) from fitted  regression model objects of class <code>`flexreg`</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WAIC(model, ...)

## S3 method for class 'WAIC.flexreg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="WAIC_+3A_model">model</code></td>
<td>
<p>an object (or a list of objects) of class <code>`flexreg`</code>, usually the result of <code><a href="#topic+flexreg">flexreg</a></code> or <code><a href="#topic+flexreg_binom">flexreg_binom</a></code> functions.</p>
</td></tr>
<tr><td><code id="WAIC_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
<tr><td><code id="WAIC_+3A_x">x</code></td>
<td>
<p>an object of class <code>`WAIC.flexreg`</code>, usually the result of <code><a href="#topic+WAIC">WAIC</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes advantage of the <span class="pkg">loo</span> package to compute the widely applicable information criterion (WAIC) and leave-one-out cross-validation (LOO) for objects of class <code>`flexreg`</code>.
If a list of two or more objects of class <code>`flexreg`</code> is provided, the function returns the difference in their expected predictive accuracy (see <code>loo_compare</code> for further details).
</p>


<h3>Value</h3>

<p>A named list with components from <code>loo</code> and <code>waic</code>.
</p>


<h3>References</h3>


<p>Vehtari, A., Gelman, A., Gabry, J. (2017). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing. <b>27</b>(5), 1413&ndash;1432. doi:10.1007/s11222-016-9696-4 <br />
<br />
</p>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("Reading")
FB &lt;- flexreg(accuracy.adj ~ iq, data = Reading, type="FB", n.iter=1000)
WAIC(FB)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
