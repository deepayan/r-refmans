<!DOCTYPE html><html><head><title>Help for package phenmod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phenmod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bbObs'><p>Phenological observation: budburst</p></a></li>
<li><a href='#data.addTemperatures'><p>Add temperature data to a dataset.</p></a></li>
<li><a href='#data.combine'><p>Main function to combine timeseries</p></a></li>
<li><a href='#data.combine.clusters'><p>Station cluster creation.</p></a></li>
<li><a href='#data.combine.clusters.search'><p>Cluster search</p></a></li>
<li><a href='#data.combine.stationNet'><p>Station net creator</p></a></li>
<li><a href='#data.combine.timeseries'><p>Create combined timeseries</p></a></li>
<li><a href='#data.coordinates2gridcellnumber'><p>Search number of gridcell for given coordinates.</p></a></li>
<li><a href='#data.extract'><p>Essential data extraction.</p></a></li>
<li><a href='#data.loadTemperature'><p>Loads a temperature vector</p></a></li>
<li><a href='#data.main'><p>Main function for data conversion.</p></a></li>
<li><a href='#data.read.phase'><p>Read data from TSV-table</p></a></li>
<li><a href='#dataFinal'><p>Preprocessed data</p></a></li>
<li><a href='#extractedObs'><p>Phenological observation: leafcolouring and budburst</p></a></li>
<li><a href='#lcObs'><p>Phenological observation of leafcolouring</p></a></li>
<li><a href='#pim.solve'><p>Promoter-Inhibitor-Model</p></a></li>
<li><a href='#relatedGrid'><p>Grid containing spatial information related to temperature data</p></a></li>
<li><a href='#result.extract.interpolate'><p>Result interpotion</p></a></li>
<li><a href='#result.extract.main'><p>Essential result extraction</p></a></li>
<li><a href='#result.extract.mask'><p>Result masking</p></a></li>
<li><a href='#result.extract.sub'><p>Extract values</p></a></li>
<li><a href='#result.main'><p>Result evaluation</p></a></li>
<li><a href='#result.pic.histogramm'><p>Histogramm Creation</p></a></li>
<li><a href='#result.pic.maps'><p>Map creation</p></a></li>
<li><a href='#result.pic.scatterplot'><p>Scatterplot creation</p></a></li>
<li><a href='#result.rsquare'><p>R-square calculation.</p></a></li>
<li><a href='#temperatures'><p>Temperature data</p></a></li>
<li><a href='#tsm.solve'><p>Temperature-Sum-Model</p></a></li>
<li><a href='#util.geoco2gk'><p>Geographic coordinates to Gauss-Krueger-Coordinates</p></a></li>
<li><a href='#util.isLeapYear'><p>Leap year check</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Auxiliary Functions for Phenological Data Processing, Modelling
and Result Handling</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-14</td>
</tr>
<tr>
<td>Author:</td>
<td>Maximilian Lange</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Maximilian Lange &lt;maximilian.lange@ufz.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for phenological data preprocessing, modelling and result handling. For more information, please refer to Lange et al. (2016) &lt;<a href="https://doi.org/10.1007%2Fs00484-016-1161-8">doi:10.1007/s00484-016-1161-8</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), gstat, RColorBrewer, lattice, pheno</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-14 10:31:13 UTC; langema</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-14 11:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bbObs'>Phenological observation: budburst</h2><span id='topic+bbObs'></span>

<h3>Description</h3>

<p>This dataset gives an example of budburst observations from the German Weather Service (DWD) 
obtainable by the plant phenological online database PPODB. 
The dataset was extracted out of the downloadable tsv-File by use of <code><a href="#topic+data.read.phase">data.read.phase</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bbObs)</code></pre>


<h3>Format</h3>

<p>A dataframe containing three observations.</p>


<h3>Source</h3>

<p>Plant Phenological Online Database (PPODB), <a href="http://www.phenology.de">http://www.phenology.de</a></p>


<h3>References</h3>

<p>Dierenbach, J., Badeck, F.W., Schaber, J., 2013. The plant phenological online database (PPODB): an online database for long-term phenological data. International Journal of Biometeorology , 1-8.</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.read.phase">data.read.phase</a></code>,<code><a href="#topic+lcObs">lcObs</a></code></p>

<hr>
<h2 id='data.addTemperatures'>Add temperature data to a dataset.</h2><span id='topic+data.addTemperatures'></span>

<h3>Description</h3>

<p>Adds a temperature vector to a dataset containing spatial and seasonal phenological information.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.addTemperatures(dataset, grid.related.to.Temperatures,
		temperature.filenames, 
		temperature.matrix, temperature.scale.factor, 
		out2File=FALSE, silent=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.addTemperatures_+3A_dataset">dataset</code></td>
<td>
<p>A dataset containing spatial and seasonal phenological information. Can be created by using function <code><a href="#topic+data.extract">data.extract</a></code>.</p>
</td></tr>
<tr><td><code id="data.addTemperatures_+3A_grid.related.to.temperatures">grid.related.to.Temperatures</code></td>
<td>
<p>A grid containing spatial informations for the temperature data.</p>
</td></tr>
<tr><td><code id="data.addTemperatures_+3A_temperature.filenames">temperature.filenames</code></td>
<td>
<p>The full name of temperature files. The filenames have to contain the year (YYYY) of the temperature observation. 
The files should be stored as RData-Files and have to contain a matrix called &lsquo;edk.one.year&rsquo; with 366 columns (one per day) 
and the number of rows equal to the number of rows in &lsquo;grid.related.to.Temperatures&rsquo;. 
Should have the value NULL if a temperature matrix should be used instead.</p>
</td></tr>
<tr><td><code id="data.addTemperatures_+3A_temperature.matrix">temperature.matrix</code></td>
<td>
<p>An array containing temperature data. The year of the observation should given as rowname, the columns should equal the julian day 
of the observation and the third dimension of the array should equal the location given in &lsquo;grid.related.to.Temperatures&rsquo;</p>
</td></tr></table>
<p>.
The matrix will be used instead of temperature files if &lsquo;temperature.filenames&rsquo; is NULL.
</p>
<table>
<tr><td><code id="data.addTemperatures_+3A_temperature.scale.factor">temperature.scale.factor</code></td>
<td>
<p>The down-scaling factor for the temperature data (needed if the data is scaled).</p>
</td></tr>
<tr><td><code id="data.addTemperatures_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
<tr><td><code id="data.addTemperatures_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adds a temperature vector to a dataset containing spatial (The coordinates of the station as Gauss-Krueger coordinates) and seasonal (The year for which the budburst day should be modelled and the leafcolouring day of the previous year) phenological information.</p>


<h3>Value</h3>

<p>A dataset containing spatial and seasonal phenological data and the added temperatures.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.loadTemperature">data.loadTemperature</a></code>,<code><a href="#topic+data.extract">data.extract</a></code>,<code><a href="#topic+relatedGrid">relatedGrid</a></code>,<code><a href="#topic+temperatures">temperatures</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)
  ## load temperature data
  data(temperatures)
  ## load grid with spatial informations for temperature files
  data(relatedGrid)	

  ## add temperatures from files in working directory
  dataset &lt;- data.addTemperatures(dataset=extractedObs, 
				out2File=FALSE,
				grid.related.to.Temperatures=relatedGrid,
				temperature.filenames=NULL, 
				temperature.matrix=temperatures,
				temperature.scale.factor=0.1)
 
  ## resulting dataset should equal 'dataFinal'
  data(dataFinal)
  dataFinal
  dataset
</code></pre>

<hr>
<h2 id='data.combine'>Main function to combine timeseries</h2><span id='topic+data.combine'></span>

<h3>Description</h3>

<p>This function creates a station net and builds clusters of stations out of it. These clusters are used to create combined timeseries.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.combine(dataset, range=5000, alt.range=50, shuffle=TRUE, 
				tries=100, silent=FALSE, out2File=FALSE,
				clusters.tmp.file="tmpcluster.RData")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.combine_+3A_dataset">dataset</code></td>
<td>
<p>A dataset created by <code><a href="#topic+data.extract">data.extract</a></code> containing the information that 
should be used to generate the combined timeseries.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_range">range</code></td>
<td>
<p>The maximum distance between two stations that should be connected in the station net.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_alt.range">alt.range</code></td>
<td>
<p>The maximum altitude difference between two stations that should be connected in the station net.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_shuffle">shuffle</code></td>
<td>
<p>A boolean value determining wether the stations should be processed in their order (value: FALSE) 
or if they should be shuffled befor processing (value: TRUE). 
Shuffled stations produce different results each run.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_tries">tries</code></td>
<td>
<p>If value of &lsquo;shuffle&rsquo; is true, the integer value &lsquo;tries&rsquo; determines how 
much cluster-lists should be created. The cluster-list with the lowest 
number of entries will be returned (this will increase the size of the clusters).</p>
</td></tr>
<tr><td><code id="data.combine_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
<tr><td><code id="data.combine_+3A_clusters.tmp.file">clusters.tmp.file</code></td>
<td>
<p>A file where the clusters are saved for evaluation. If the value is NULL, no file will be created.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function joins the functions <code><a href="#topic+data.combine.stationNet">data.combine.stationNet</a></code>, <code><a href="#topic+data.combine.clusters">data.combine.clusters</a></code> and <code><a href="#topic+data.combine.timeseries">data.combine.timeseries</a></code>.</p>


<h3>Value</h3>

<p>A dataset containing the combined timeseries as a data.frame with same columns like a data.frame created by <code><a href="#topic+data.extract">data.extract</a></code>.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Schaber J., Badeck F. (2002). Evaluation of methods for the combination of phenological time series and outlier detection. Tree Physiology, 22:973-982</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.combine.clusters">data.combine.clusters</a></code>,<code><a href="#topic+data.combine.stationNet">data.combine.stationNet</a></code>,<code><a href="#topic+data.combine.timeseries">data.combine.timeseries</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)
  
  ## combine timeseries
  data.combined &lt;- data.combine(dataset=extractedObs, range=5000, 
				alt.range=50, shuffle=TRUE, tries=3, 
				silent=FALSE, out2File=FALSE, 
				clusters.tmp.file=NULL)
</code></pre>

<hr>
<h2 id='data.combine.clusters'>Station cluster creation.</h2><span id='topic+data.combine.clusters'></span>

<h3>Description</h3>

<p>Creates a list of station clusters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.combine.clusters(dataset, stations.net, 
			shuffle=TRUE, tries=100, 
			silent=FALSE, out2File=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.combine.clusters_+3A_dataset">dataset</code></td>
<td>
<p>The dataset with the stations to cluster and their coordinates.</p>
</td></tr>
<tr><td><code id="data.combine.clusters_+3A_stations.net">stations.net</code></td>
<td>
<p>A list containing the information which stations are neighbours. 
Created by function <code><a href="#topic+data.combine.stationNet">data.combine.stationNet</a></code>.</p>
</td></tr>
<tr><td><code id="data.combine.clusters_+3A_shuffle">shuffle</code></td>
<td>
<p>A boolean value determining wether the stations should be processed in their order (value: FALSE) 
or if they should be shuffled befor processing (value: TRUE). 
Shuffled stations produce different results each run.</p>
</td></tr>
<tr><td><code id="data.combine.clusters_+3A_tries">tries</code></td>
<td>
<p>If value of &lsquo;shuffle&rsquo; is true, the integer value &lsquo;tries&rsquo; determines how 
much cluster-lists should be created. The cluster-list with the lowest 
number of entries will be returned (this will increase the size of the clusters).</p>
</td></tr>
<tr><td><code id="data.combine.clusters_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="data.combine.clusters_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a list of station clusters by randomly creating clusters (if value of &lsquo;shuffle&rsquo; is TRUE) and 
chosing the list with the lowest number of clusters.</p>


<h3>Value</h3>

<p>Returns a list of station clusters (a station cluster is a vector containing related stations).</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.combine.clusters.search">data.combine.clusters.search</a></code>,<code><a href="#topic+data.combine.stationNet">data.combine.stationNet</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)

  ## create station net
  stations.net &lt;- data.combine.stationNet(extractedObs, 
				range=5000, alt.range=50, silent=FALSE, 
				out2File=FALSE)

  ## search clusters in station net
  clusters &lt;- data.combine.clusters(extractedObs, stations.net, 
				shuffle=TRUE, tries=3, silent=FALSE, 
				out2File=FALSE)
</code></pre>

<hr>
<h2 id='data.combine.clusters.search'>Cluster search</h2><span id='topic+data.combine.clusters.search'></span>

<h3>Description</h3>

<p>Searches clusters in a station net.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.combine.clusters.search(stations, stations.net, 
			shuffle=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.combine.clusters.search_+3A_stations">stations</code></td>
<td>
<p>A list of all stations.</p>
</td></tr>
<tr><td><code id="data.combine.clusters.search_+3A_stations.net">stations.net</code></td>
<td>
<p>A list of neighbourstations (neighbours of the station at same list position in list &lsquo;stations&rsquo;).</p>
</td></tr>
<tr><td><code id="data.combine.clusters.search_+3A_shuffle">shuffle</code></td>
<td>
<p>A boolean value determining wether the stations should be processed in their order (value: FALSE) 
or if they should be shuffled befor processing (value: TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Searches related stations in a station net. If value of &lsquo;shuffle&rsquo; is TRUE, 
each run of this method produces different results.</p>


<h3>Value</h3>

<p>Returns a list containing related stations.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)

  ## create station net
  stations.net &lt;- data.combine.stationNet(extractedObs, range=5000, 
				alt.range=50, silent=FALSE, out2File=FALSE)

  ## search clusters in station net
  stations &lt;- as.list(unique(extractedObs$STAT_ID))
  clusters &lt;- data.combine.clusters.search(stations, 
			stations.net, shuffle=TRUE)

  
</code></pre>

<hr>
<h2 id='data.combine.stationNet'>Station net creator</h2><span id='topic+data.combine.stationNet'></span>

<h3>Description</h3>

<p>Creates a net of the stations of dataset by checking the distances between the stations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.combine.stationNet(dataset, range, 
					alt.range, silent=FALSE, 
					out2File=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.combine.stationNet_+3A_dataset">dataset</code></td>
<td>
<p>A dataset created by <code><a href="#topic+data.extract">data.extract</a></code> containing the information that 
should be used to generate the station net.</p>
</td></tr>
<tr><td><code id="data.combine.stationNet_+3A_range">range</code></td>
<td>
<p>The maximum distance between two stations that should be connected in the net.</p>
</td></tr>
<tr><td><code id="data.combine.stationNet_+3A_alt.range">alt.range</code></td>
<td>
<p>The maximum altitude difference between two stations that should be connected in the net.</p>
</td></tr>
<tr><td><code id="data.combine.stationNet_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="data.combine.stationNet_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only stations with a maximal distance of 'range' and maximal altitude difference of &lsquo;alt.range&rsquo; are connected.</p>


<h3>Value</h3>

<p>Returns a list with entries for all stations of dataset. Each list entry stands for a station and contains all neighbours of that station.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)

  ## create station net
  stations.net &lt;- data.combine.stationNet(extractedObs, 
				range=5000, alt.range=50, silent=FALSE, 
				out2File=FALSE)
</code></pre>

<hr>
<h2 id='data.combine.timeseries'>Create combined timeseries</h2><span id='topic+data.combine.timeseries'></span>

<h3>Description</h3>

<p>Creates combined timeseries out of the dataset by using clusters of stations.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.combine.timeseries(dataset, clusters, 
			silent=FALSE, out2File=FALSE, 
			minimalClusterSize=5)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.combine.timeseries_+3A_dataset">dataset</code></td>
<td>
<p>A dataset created by <code><a href="#topic+data.extract">data.extract</a></code> containing the information that 
should be used to generate the combined timeseries.</p>
</td></tr>
<tr><td><code id="data.combine.timeseries_+3A_clusters">clusters</code></td>
<td>
<p>A list of station clusters generated by <code><a href="#topic+data.combine.clusters">data.combine.clusters</a></code>.</p>
</td></tr>
<tr><td><code id="data.combine.timeseries_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="data.combine.timeseries_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
<tr><td><code id="data.combine.timeseries_+3A_minimalclustersize">minimalClusterSize</code></td>
<td>
<p>An integer value determining the minimal number of stations in a 
cluster to be included in combining process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The combined timeseries are created by using the function <code><a href="pheno.html#topic+pheno.lad.fit">pheno.lad.fit</a></code> of package &lsquo;pheno&rsquo;. This process eliminates outliers and smooths the data.</p>


<h3>Value</h3>

<p>A dataset containing the combined timeseries as a data.frame with same columns like a data.frame created by <code><a href="#topic+data.extract">data.extract</a></code>.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Schaber J., Badeck F. (2002). Evaluation of methods for the combination of phenological time series and outlier detection. Tree Physiology, 22:973-982</p>


<h3>See Also</h3>

<p><code><a href="pheno.html#topic+pheno.lad.fit">pheno.lad.fit</a></code>, <code><a href="#topic+data.extract">data.extract</a></code>, 
<code><a href="#topic+data.combine.stationNet">data.combine.stationNet</a></code>, <code><a href="#topic+data.combine.clusters">data.combine.clusters</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load extracted observations as created by 'data.extract'
  data(extractedObs)

  ## create station net
  stations.net &lt;- data.combine.stationNet(extractedObs, 
				range=5000, alt.range=50, silent=FALSE, 
				out2File=FALSE)

  ## search clusters in station net
  clusters &lt;- data.combine.clusters(extractedObs, 
			stations.net, shuffle=TRUE, tries=3, 
			silent=FALSE, out2File=FALSE)

  ## combine timeseries
  data.combined &lt;- data.combine.timeseries(extractedObs, 
				clusters, out2File=FALSE)
</code></pre>

<hr>
<h2 id='data.coordinates2gridcellnumber'>Search number of gridcell for given coordinates.</h2><span id='topic+data.coordinates2gridcellnumber'></span>

<h3>Description</h3>

<p>Searches the number of the cell of a given spatial grid by given coordinates (Gauss-Krueger-Coordinates).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.coordinates2gridcellnumber(grid, x,y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.coordinates2gridcellnumber_+3A_grid">grid</code></td>
<td>
<p>The grid in which the cell should be searched.</p>
</td></tr>
<tr><td><code id="data.coordinates2gridcellnumber_+3A_x">x</code></td>
<td>
<p>The &lsquo;Rechtswert&rsquo; of the Gauss-Krueger-Coordinates.</p>
</td></tr>
<tr><td><code id="data.coordinates2gridcellnumber_+3A_y">y</code></td>
<td>
<p>The &lsquo;Hochwert&rsquo; of the Gauss-Krueger-Coordinates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Searches the number of the cell of a given spatial grid by given coordinates (Gauss-Krueger-Coordinates).</p>


<h3>Value</h3>

<p>Returns the cell-number of the grid-cell which is next to the given coordinates.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load grid containing spatial information
  data(relatedGrid)

  ## search position in grid
  xy &lt;- util.geoco2gk(54.12,10.17,4)
  gridposition &lt;- data.coordinates2gridcellnumber(grid=relatedGrid, 
	x=xy[,1],y=xy[,2])

  gridposition
</code></pre>

<hr>
<h2 id='data.extract'>Essential data extraction.</h2><span id='topic+data.extract'></span>

<h3>Description</h3>

<p>Extracts the essential data out of budburst and leafcolouring data and combines them.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.extract(data.budburst, data.leafcolouring, 
			valid.years=1952:2009, out2File=FALSE, 
			silent=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.extract_+3A_data.budburst">data.budburst</code></td>
<td>
<p>A dataset extracted by function <code><a href="#topic+data.read.phase">data.read.phase</a></code> containing budburst 
information of currently processed plant.</p>
</td></tr>
<tr><td><code id="data.extract_+3A_data.leafcolouring">data.leafcolouring</code></td>
<td>
<p>A dataset extracted by function <code><a href="#topic+data.read.phase">data.read.phase</a></code> containing leafcolouring 
information of currently processed plant.</p>
</td></tr>
<tr><td><code id="data.extract_+3A_valid.years">valid.years</code></td>
<td>
<p>The years that should be included in extraction process 
(may be needed if some data in datasets are insufficient).</p>
</td></tr>
<tr><td><code id="data.extract_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
<tr><td><code id="data.extract_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts the essential data out of budburst and leafcolouring data and combines them. 
Therefor it extracts the stations contained in both datasets and searches the leafcolouring dates and 
the related budburst date (at the following year).</p>


<h3>Value</h3>

<p>A dataset containing the station ID, the station geographic and the Gauss-Krueger-coordinates of the station,
the altitude of the station, the year and the julian day of the budburst and the leafcolouring and 
outlier information for budburst and leafcolouring.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.read.phase">data.read.phase</a></code>,<code><a href="#topic+lcObs">lcObs</a></code>,<code><a href="#topic+bbObs">bbObs</a></code>,<code><a href="#topic+extractedObs">extractedObs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load budburst observations (extracted via 'data.read.phase')
  data(bbObs)
  ## load leafcolouring observations (extracted via 'data.read.phase')
  data(lcObs)

  ## extract essential data
  data.extracted &lt;- data.extract(data.budburst=bbObs, 
				data.leafcolouring=lcObs, 
				out2File=FALSE)
</code></pre>

<hr>
<h2 id='data.loadTemperature'>Loads a temperature vector</h2><span id='topic+data.loadTemperature'></span>

<h3>Description</h3>

<p>Loads a temperature vector of given length from a given day of a given year.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.loadTemperature(year, temperature.year, temperature.previous.year, 
				from.previous.year.doy, length, position, 
				scale.factor=0.1)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.loadTemperature_+3A_year">year</code></td>
<td>
<p>The year of the budburst doy which should be calculated.</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_temperature.year">temperature.year</code></td>
<td>
<p>A vector of temperature data (with length 365 or 366) of year given by &lsquo;year&rsquo;.</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_temperature.previous.year">temperature.previous.year</code></td>
<td>
<p>A vector of temperature data (with length 365 or 366) of previous year.</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_from.previous.year.doy">from.previous.year.doy</code></td>
<td>
<p>The day the modelling starts (leafcolouring day of previous year).</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_length">length</code></td>
<td>
<p>The length of the resulting temperature vector.</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_position">position</code></td>
<td>
<p>The number of the grid-cell for which the temperatures should be loaded.</p>
</td></tr>
<tr><td><code id="data.loadTemperature_+3A_scale.factor">scale.factor</code></td>
<td>
<p>The down-scaling factor for the temperature data (needed if the data is scaled).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loads a temperature vector of given length from temperature data. The day of leafcolouring of the 
previous year should be given as starting day. The vector contains one temperature datapoint per day and 
should have a length of 300 or more to ensure a stable modelling process. Internal function used by method <code><a href="#topic+data.addTemperatures">data.addTemperatures</a></code>.</p>


<h3>Value</h3>

<p>A vector with temperature data for a given location and a given period.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.addTemperatures">data.addTemperatures</a></code>,<code><a href="#topic+data.coordinates2gridcellnumber">data.coordinates2gridcellnumber</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  t.year &lt;- as.matrix(rnorm(365, mean=10, sd=5))
  t.p.year &lt;- as.matrix(rnorm(365, mean=9, sd=6))
  temperatures &lt;- data.loadTemperature(year=2006,temperature.year=t.year, 
			temperature.previous.year=t.p.year, 
			from.previous.year.doy=210, length=365, 
			position=1, scale.factor=0.1)
</code></pre>

<hr>
<h2 id='data.main'>Main function for data conversion.</h2><span id='topic+data.main'></span>

<h3>Description</h3>

<p>This function extracts data from tsv-Files, creates combined timeseries out of them if needed and adds temperature data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.main(extraction.done=TRUE, out2File=FALSE, 
			grid.related.to.temperaturefiles, 
			valid.years=1952:2009,
			combine.time.series=TRUE, range=10000, 
			alt.range=50, temperature.scale.factor=1,
			dataPath=getwd(),temperature.filenames,
			temperature.matrix, pathForTmpFiles=getwd(),
			pathToSave=getwd(), plant="beech")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.main_+3A_extraction.done">extraction.done</code></td>
<td>
<p>If data extraction was already done, turn this value to TRUE and the 
extracted values will be loaded from &lsquo;pathForTmpFiles&rsquo;.</p>
</td></tr>
<tr><td><code id="data.main_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
<tr><td><code id="data.main_+3A_grid.related.to.temperaturefiles">grid.related.to.temperaturefiles</code></td>
<td>
<p>A grid containing spatial informations for the temperature files.</p>
</td></tr>
<tr><td><code id="data.main_+3A_valid.years">valid.years</code></td>
<td>
<p>The years that should be included in extraction process 
(may be needed if some data in datasets are insufficient).</p>
</td></tr>
<tr><td><code id="data.main_+3A_combine.time.series">combine.time.series</code></td>
<td>
<p>A boolean value determining wether the extracted timeseries should be combined or not.</p>
</td></tr>
<tr><td><code id="data.main_+3A_range">range</code></td>
<td>
<p>The maximum distance between two stations that should be connected in the station station-net 
needed for the timeserie-combination.</p>
</td></tr>
<tr><td><code id="data.main_+3A_alt.range">alt.range</code></td>
<td>
<p>The maximum altitude difference between two stations that should be connected in the 
station-net needed for the timeserie-combination.</p>
</td></tr>
<tr><td><code id="data.main_+3A_temperature.scale.factor">temperature.scale.factor</code></td>
<td>
<p>The down-scaling factor for the temperature data (needed if the data is scaled).</p>
</td></tr>
<tr><td><code id="data.main_+3A_datapath">dataPath</code></td>
<td>
<p>The path where the tsv-tables are stored. These tsv-tables should have the following name: 
&lsquo;&lt;PLANT&gt;_budburst.tsv&rsquo; for budburst-data or &lsquo;&lt;PLANT&gt;_leafcolouring.tsv&rsquo; for leafcolouring-data, 
where &lt;PLANT&gt; stands for the name of the plant, for example &lsquo;beech&rsquo;.</p>
</td></tr>
<tr><td><code id="data.main_+3A_temperature.filenames">temperature.filenames</code></td>
<td>
<p>The full name of temperature files. The filenames have to contain the year (YYYY) of the temperature observation. 
The files should be stored as RData-Files and have to contain a matrix called &lsquo;edk.one.year&rsquo; with 366 columns (one per day) 
and the number of rows equal to the number of rows in &lsquo;grid.related.to.Temperatures&rsquo;.
Should have the value NULL if a temperature matrix should be used instead.</p>
</td></tr>
<tr><td><code id="data.main_+3A_temperature.matrix">temperature.matrix</code></td>
<td>
<p>An array containing temperature data. The year of the observation should given as rowname, the columns should equal the julian day 
of the observation and the third dimension of the array should equal the location given in &lsquo;grid.related.to.Temperatures&rsquo;</p>
</td></tr></table>
<p>.
The matrix will be used instead of temperature files if &lsquo;temperature.filenames&rsquo; is NULL.
</p>
<table>
<tr><td><code id="data.main_+3A_pathfortmpfiles">pathForTmpFiles</code></td>
<td>
<p>The path where the extracted data should be temporarily stored as RData-files.</p>
</td></tr>
<tr><td><code id="data.main_+3A_pathtosave">pathToSave</code></td>
<td>
<p>The path where the resulting dataframe should be stored as RData-file with the name 
&lsquo;&lt;PLANT&gt;-dataset.RData&rsquo; for non-combined data or &lsquo;&lt;PLANT&gt;-dataset-cts.RData&rsquo; for combined data.</p>
</td></tr>
<tr><td><code id="data.main_+3A_plant">plant</code></td>
<td>
<p>The name of the plant which should be processed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the main method for data extraction. It exctracts budburst and leafcolouring data from tsv-Files, 
creates combined timeseries out of them if needed and adds temperature data from RData files containing daily mean temperatures.</p>


<h3>Value</h3>

<p>Returns nothing, but saves the resulting dataset in &lsquo;pathToSave&rsquo;.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.extract">data.extract</a></code>,<code><a href="#topic+data.combine">data.combine</a></code>,<code><a href="#topic+data.addTemperatures">data.addTemperatures</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load temperature data
  data(temperatures)
  ## load grid with spatial informations for temperature files
  data(relatedGrid)
  
  ## extract dataset from datafiles in working directory
  ## Not run: dataset &lt;- data.main(extraction.done=FALSE, out2File=FALSE, 
			grid.related.to.temperaturefiles=relatedGrid,
			combine.timeseries=TRUE, range=5000, alt.range=50, 
			temperature.scale.factor=0.1, dataPath=getwd(), 
			temperature.filenames=NULL,
			temperature.matrix=temperatures,
			pathForTmpFiles=getwd(), pathToSave=getwd(),
			plant="beech")
## End(Not run)
</code></pre>

<hr>
<h2 id='data.read.phase'>Read data from TSV-table</h2><span id='topic+data.read.phase'></span>

<h3>Description</h3>

<p>This function reads phenological data out of a tsv-table.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.read.phase(path, filename)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="data.read.phase_+3A_path">path</code></td>
<td>
<p>The path of the tsv-file to read.</p>
</td></tr>
<tr><td><code id="data.read.phase_+3A_filename">filename</code></td>
<td>
<p>The filename of the tsv-table.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Reads phenological data out of a tsv-table containing the columns 
&lsquo;DWD_STAT_ID&rsquo; (the ID of the phenological station), 
&lsquo;STAT_NAME&rsquo; (the name of the phenological station),
&lsquo;STAT_LON&rsquo; (the longitude of the station),
&lsquo;STAT_LAT&rsquo; (the latitude of the station),
&lsquo;STAT_ALT&rsquo; (the altitude of the station),
&lsquo;BEGIN_OBS&rsquo; (the year the station started the observation),
&lsquo;END_OBS&rsquo; (the year the station stopped the observation),
&lsquo;NATURRAUM_ID&rsquo; (the id of the region),
&lsquo;PHASE_ID&rsquo; (the ID of the observed phase),
&lsquo;OBS_DAY&rsquo; (the julian day the observed phase starts),
&lsquo;OBS_YEAR&rsquo; (the year at which &lsquo;OBS_DAY&rsquo; was observed),
&lsquo;CHECKED&rsquo; (a value determining wether the result was checked or not),
&lsquo;outlier&rsquo; (if result was checked, this value determines wether it was an outlier or not).
Such a dataset can be obtained at <a href="http://www.phenology.de">http://www.phenology.de</a>.</p>


<h3>Value</h3>

<p>Returns the table as R-Dataframe.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Dierenbach, J., Badeck, F.W., Schaber, J., 2013. The plant phenological online database (PPODB): an online database for long-term phenological data. International Journal of Biometeorology , 1-8.</p>


<h3>See Also</h3>

<p><code><a href="#topic+lcObs">lcObs</a></code>,<code><a href="#topic+bbObs">bbObs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ##read file 'beech_budburst.tsv' out of working directory
  ## Not run: data.budburst &lt;- data.read.phase(path=getwd(), 
				filename="beech_budburst.tsv")
## End(Not run)

  ## resulting data looks like the following:
  data(lcObs)
  data(bbObs)

  lcObs
  bbObs
</code></pre>

<hr>
<h2 id='dataFinal'>Preprocessed data</h2><span id='topic+dataFinal'></span>

<h3>Description</h3>

<p>This dataset contains phenological data (connected leafcolouring and budburst observations) as well as 
spatially related temperature data. The dataset was created out of <code><a href="#topic+extractedObs">extractedObs</a></code>, <code><a href="#topic+relatedGrid">relatedGrid</a></code> and 
<code><a href="#topic+temperatures">temperatures</a></code> by use of <code><a href="#topic+data.addTemperatures">data.addTemperatures</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dataFinal)</code></pre>


<h3>Format</h3>

<p>A dataframe containing three rows of connected phenological information combined with temperature data.</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.addTemperatures">data.addTemperatures</a></code>,<code><a href="#topic+bbObs">bbObs</a></code>,<code><a href="#topic+lcObs">lcObs</a></code>,<code><a href="#topic+extractedObs">extractedObs</a></code>,<code><a href="#topic+relatedGrid">relatedGrid</a></code>,<code><a href="#topic+temperatures">temperatures</a></code></p>

<hr>
<h2 id='extractedObs'>Phenological observation: leafcolouring and budburst</h2><span id='topic+extractedObs'></span>

<h3>Description</h3>

<p>This dataset gives an example of leafcolouring observations connected with subsequent budburst observations. 
The observations are extracted out of phenological data from the German Weather Service (DWD) obtainable by 
the plant phenological online database PPODB.
The dataset was created out of the datasets <code><a href="#topic+bbObs">bbObs</a></code> and <code><a href="#topic+lcObs">lcObs</a></code> by use of method <code><a href="#topic+data.extract">data.extract</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(extractedObs)</code></pre>


<h3>Format</h3>

<p>A dataframe containing three rows of connected observations.</p>


<h3>Source</h3>

<p>Plant Phenological Online Database (PPODB), <a href="http://www.phenology.de">http://www.phenology.de</a></p>


<h3>References</h3>

<p>Dierenbach, J., Badeck, F.W., Schaber, J., 2013. The plant phenological online database (PPODB): an online database for long-term phenological data. International Journal of Biometeorology , 1-8.</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.extract">data.extract</a></code>,<code><a href="#topic+bbObs">bbObs</a></code>,<code><a href="#topic+lcObs">lcObs</a></code></p>

<hr>
<h2 id='lcObs'>Phenological observation of leafcolouring</h2><span id='topic+lcObs'></span>

<h3>Description</h3>

<p>This dataset gives an example of leafcolouring observations from the German Weather Service (DWD) obtainable 
by the plant phenological online database PPODB.
The dataset was extracted out of the downloadable tsv-File by use of <code><a href="#topic+data.read.phase">data.read.phase</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lcObs)</code></pre>


<h3>Format</h3>

<p>A dataframe containing three observations.</p>


<h3>Source</h3>

<p>Plant Phenological Online Database (PPODB), <a href="http://www.phenology.de">http://www.phenology.de</a></p>


<h3>References</h3>

<p>Dierenbach, J., Badeck, F.W., Schaber, J., 2013. The plant phenological online database (PPODB): an online database for long-term phenological data. International Journal of Biometeorology , 1-8.</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.read.phase">data.read.phase</a></code>,<code><a href="#topic+bbObs">bbObs</a></code></p>

<hr>
<h2 id='pim.solve'>Promoter-Inhibitor-Model</h2><span id='topic+pim.solve'></span>

<h3>Description</h3>

<p>Applies a promoter-inhibitor-model to a given dataset.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim.solve(params, data, model.no=1, 
	silent=FALSE, out2File=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pim.solve_+3A_params">params</code></td>
<td>
<p>The parameters for the promoter-inhibitor-model as list or vector with following order: a1, a2, a3, a4, T.min.i, T.opt.i, T.max.i, T.min.p, T.opt.p, T.max.p</p>
</td></tr>
<tr><td><code id="pim.solve_+3A_data">data</code></td>
<td>
<p>A dataset containing the station ID, the station geographic and the Gauss-Krueger-coordinates of the station,
the altitude of the station, the year and the julian day of the budburst and the leafcolouring,
outlier information for budburst and leafcolouring and temperature data for modelling. Can be created by using the function <code><a href="#topic+data.main">data.main</a></code>.</p>
</td></tr>
<tr><td><code id="pim.solve_+3A_model.no">model.no</code></td>
<td>
<p>The promoter-inhibitor-model to use. See references for more details.</p>
</td></tr>
<tr><td><code id="pim.solve_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="pim.solve_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Applies a promoter-inhibitor-model with given parameters to a given dataset.</p>


<h3>Value</h3>

<p>A dataset containing the values of the origin dataset and additionally the modelled budburst days.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Schaber, J. and Badeck, F.-W. (2003). Physiology-based phenology models for forest tree species in Germany
. International Journal of Biometeorology 47:193-201</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.main">data.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)

</code></pre>

<hr>
<h2 id='relatedGrid'>Grid containing spatial information related to temperature data</h2><span id='topic+relatedGrid'></span>

<h3>Description</h3>

<p>This dataset, based on a digital elevation model contains spatial information related to the temperature data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(relatedGrid)</code></pre>


<h3>Format</h3>

<p>A dataframe containing spatial information.</p>


<h3>Source</h3>

<p>digital elevation model</p>


<h3>See Also</h3>

<p><code><a href="#topic+temperatures">temperatures</a></code></p>

<hr>
<h2 id='result.extract.interpolate'>Result interpotion</h2><span id='topic+result.extract.interpolate'></span>

<h3>Description</h3>

<p>Interpolates result values with given spatial information.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.extract.interpolate(mask.grid, values, alt, x, y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.extract.interpolate_+3A_mask.grid">mask.grid</code></td>
<td>
<p>The grid with spatial information the values are ordered by.</p>
</td></tr>
<tr><td><code id="result.extract.interpolate_+3A_values">values</code></td>
<td>
<p>The values which should be interpolated.</p>
</td></tr>
<tr><td><code id="result.extract.interpolate_+3A_alt">alt</code></td>
<td>
<p>The related altitude for the gridcells of &lsquo;mask.grid&rsquo;.</p>
</td></tr>
<tr><td><code id="result.extract.interpolate_+3A_x">x</code></td>
<td>
<p>The related Rechtswert (Gauss-Krueger-coordinates) for the gridcells of &lsquo;mask.grid&rsquo;.</p>
</td></tr>
<tr><td><code id="result.extract.interpolate_+3A_y">y</code></td>
<td>
<p>The related Hochwert (Gauss-Krueger-coordinates) for the gridcells of &lsquo;mask.grid&rsquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Interpolates result values with given spatial information by external drift kriging.</p>


<h3>Value</h3>

<p>A vector with the interpolated values.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Krige, D.G., 1951. A statistical approach to some basic mine valuation problems on the witwatersrand. Journal of the Chemical, Metallurgical and Mining Society of South Africa 52, 119-139.
Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package. Computers &amp; Geosciences 30, 683-691.</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code>,<code><a href="#topic+data.main">data.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## resolve outlier information
  outliers &lt;- result$outlier.bb + result$outlier.lc
  outliers.na &lt;- which(is.na(outliers)==TRUE)
  outliers[outliers.na] &lt;- rep(0, length(outliers.na))

  mask.grid &lt;- relatedGrid

  ## extract valid modelled values
  values.model &lt;- result.extract.sub(mask.grid=mask.grid, 
				result$doy.bb.pim, result$gk4.x, 
				result$gk4.y, outliers=outliers, 
				silent=FALSE, withOutliers=FALSE)$values

  ## interpolate result values with spatial informations of mask.grid
  values.model &lt;- result.extract.interpolate(mask.grid=mask.grid, 
				values=values.model, alt=mask.grid$alt, 
				x=mask.grid$x, y=mask.grid$y)
</code></pre>

<hr>
<h2 id='result.extract.main'>Essential result extraction</h2><span id='topic+result.extract.main'></span>

<h3>Description</h3>

<p>Extracts essential results from model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.extract.main(mask.grid, result.grid, model="pim", 
	interpolate=TRUE, silent=FALSE, withOutliers=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.extract.main_+3A_mask.grid">mask.grid</code></td>
<td>
<p>A grid containing spatial information related to values (which should be extracted) and their Gauss-Krueger-Coordinates. The values in the resulting data.frame will be ordered related to values in mask.grid.</p>
</td></tr>
<tr><td><code id="result.extract.main_+3A_result.grid">result.grid</code></td>
<td>
<p>The grid created by <code><a href="#topic+pim.solve">pim.solve</a></code> containing observated and modelled values.</p>
</td></tr>
<tr><td><code id="result.extract.main_+3A_model">model</code></td>
<td>
<p>A character value determining which model was used to create the results (either &lsquo;pim&rsquo; or &lsquo;tsm&rsquo;).</p>
</td></tr>	
<tr><td><code id="result.extract.main_+3A_interpolate">interpolate</code></td>
<td>
<p>A boolean value determining wether the results should be interpolated (with spatial information of mask.grid) or not.</p>
</td></tr>
<tr><td><code id="result.extract.main_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="result.extract.main_+3A_withoutliers">withOutliers</code></td>
<td>
<p>A boolean value determining wether outliers should be included in extraction and transformation or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts essential results (observed and modelled results and their difference and coordinates) from used model.</p>


<h3>Value</h3>

<p>A data.frame containing the modelled values (&lsquo;doy.model&rsquo;), the observed values (&lsquo;doy.observed&rsquo;), their difference (&lsquo;doy.dif&rsquo;) and related coordinates (&lsquo;x&rsquo;,&lsquo;y&rsquo;)</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.sub">result.extract.sub</a></code>,<code><a href="#topic+result.extract.mask">result.extract.mask</a></code>,<code><a href="#topic+result.extract.interpolate">result.extract.interpolate</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## extract essential results
  result.values &lt;- result.extract.main(
				mask.grid=relatedGrid, 
				result.grid=result, model="pim", 
				interpolate=FALSE, silent=FALSE)
</code></pre>

<hr>
<h2 id='result.extract.mask'>Result masking</h2><span id='topic+result.extract.mask'></span>

<h3>Description</h3>

<p>Masks values with the spatial informations of a given grid.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.extract.mask(mask.grid, values)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.extract.mask_+3A_mask.grid">mask.grid</code></td>
<td>
<p>The grid with the spatial informations which should be used for masking.</p>
</td></tr>
<tr><td><code id="result.extract.mask_+3A_values">values</code></td>
<td>
<p>The values to mask (in same order as &lsquo;mask.grid&rsquo;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Masks values with the spatial informations of a given grid. Gridcells with NA value are masked in the resulting data.frame by setting them to &lsquo;-9999&rsquo;.</p>


<h3>Value</h3>

<p>A vector of masked values.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  
  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## resolve outlier information
  outliers &lt;- result$outlier.bb + result$outlier.lc
  outliers.na &lt;- which(is.na(outliers)==TRUE)
  outliers[outliers.na] &lt;- rep(0, length(outliers.na))

  mask.grid &lt;- relatedGrid

  ## extract valid modelled values
  values.model &lt;- result.extract.sub(mask.grid=mask.grid, 
				result$doy.bb.pim, result$gk4.x, 
				result$gk4.y, outliers=outliers, 
				silent=FALSE, withOutliers=FALSE)$values

  ## mask result values with spatial informations of mask.grid
  values.model &lt;- result.extract.mask(relatedGrid, 
				values.model)
</code></pre>

<hr>
<h2 id='result.extract.sub'>Extract values</h2><span id='topic+result.extract.sub'></span>

<h3>Description</h3>

<p>Extracts and transformates given values to a data.frame with same order as a given masking grid.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.extract.sub(mask.grid, values, gk4.x, gk4.y, 
	outliers, silent=FALSE, withOutliers=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.extract.sub_+3A_mask.grid">mask.grid</code></td>
<td>
<p>A grid containing spatial information related to the values and their Gauss-Krueger-Coordinates. The values in the resulting data.frame will be ordered related to values in &lsquo;mask.grid&rsquo;.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_values">values</code></td>
<td>
<p>The values that should be extracted and transformed.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_gk4.x">gk4.x</code></td>
<td>
<p>Gauss-Krueger-Rechtswert related to values.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_gk4.y">gk4.y</code></td>
<td>
<p>Gauss-Krueger-Hochwert related to values.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_outliers">outliers</code></td>
<td>
<p>Outlier information related to values.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="result.extract.sub_+3A_withoutliers">withOutliers</code></td>
<td>
<p>A boolean value determining wether outliers should be included in extraction and transformation or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts and transformates given values (with related Gauss-Krueger-Coordinates) to a data.frame with same order as a given masking grid.</p>


<h3>Value</h3>

<p>A grid containing the values and their coordinates (as given in &lsquo;mask.grid&rsquo;).</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## resolve outlier information
  outliers &lt;- result$outlier.bb + result$outlier.lc
  outliers.na &lt;- which(is.na(outliers)==TRUE)
  outliers[outliers.na] &lt;- rep(0, length(outliers.na))

  mask.grid &lt;- relatedGrid

  ## extract valid modelled values
  values.model &lt;- result.extract.sub(mask.grid=mask.grid, 
				result$doy.bb.pim, result$gk4.x, 
				result$gk4.y, outliers=outliers, 
				silent=FALSE, withOutliers=FALSE)$values
</code></pre>

<hr>
<h2 id='result.main'>Result evaluation</h2><span id='topic+result.main'></span>

<h3>Description</h3>

<p>Main function for result evaluation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.main(mask.grid, result.grid, plant="beech", model="pim", 
			year=1954, picPath=getwd(), picName="beech-budburst", 
			createFiles=TRUE, rsquarePath=getwd(), 
			rsquareFile="rsquare.RData", rsquare.type="cod", 
			silent=FALSE, withOutliers=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.main_+3A_mask.grid">mask.grid</code></td>
<td>
<p>A grid with spatial information related to the resulting grid of modelling.</p>
</td></tr>
<tr><td><code id="result.main_+3A_result.grid">result.grid</code></td>
<td>
<p>The resulting grid of modelling. Can be obtained by using <code><a href="#topic+pim.solve">pim.solve</a></code> or <code><a href="#topic+tsm.solve">tsm.solve</a></code>.</p>
</td></tr>
<tr><td><code id="result.main_+3A_plant">plant</code></td>
<td>
<p>The plant name for which the values of 'result.grid' are modelled.</p>
</td></tr>
<tr><td><code id="result.main_+3A_model">model</code></td>
<td>
<p>A character value determining which model was used to create the results (either &lsquo;pim&rsquo; or &lsquo;tsm&rsquo;).</p>
</td></tr>
<tr><td><code id="result.main_+3A_year">year</code></td>
<td>
<p>The processed year.</p>
</td></tr>
<tr><td><code id="result.main_+3A_picpath">picPath</code></td>
<td>
<p>The path where the created png-files should be stored.</p>
</td></tr>
<tr><td><code id="result.main_+3A_picname">picName</code></td>
<td>
<p>The filename of the created png-files.</p>
</td></tr>
<tr><td><code id="result.main_+3A_createfiles">createFiles</code></td>
<td>
<p>A boolean flag determining wether the results should be stored in files or not.</p>
</td></tr>
<tr><td><code id="result.main_+3A_rsquarepath">rsquarePath</code></td>
<td>
<p>The path where the RData-file with the rsquare-dataset should be stored.</p>
</td></tr>
<tr><td><code id="result.main_+3A_rsquarefile">rsquareFile</code></td>
<td>
<p>The filename of the RData-file with the rsquare-dataset.</p>
</td></tr>
<tr><td><code id="result.main_+3A_rsquare.type">rsquare.type</code></td>
<td>
<p>The value of type (either &lsquo;cod&rsquo; or &lsquo;pearson&rsquo;) determines whether the coefficient of 
determination or the squared pearson correlation coefficient is used as rsquare.</p>
</td></tr>
<tr><td><code id="result.main_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="result.main_+3A_withoutliers">withOutliers</code></td>
<td>
<p>A boolean value determining wether outliers should be included in extraction and transformation or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Main function for result evaluation. Extracts essential values from resulting grid, interpolates and masks values, creates histogramms, scatterplot and maps and calculates r-square.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code>,<code><a href="#topic+result.extract.interpolate">result.extract.interpolate</a></code>,<code><a href="#topic+result.pic.histogramm">result.pic.histogramm</a></code>,<code><a href="#topic+result.pic.maps">result.pic.maps</a></code>,<code><a href="#topic+result.pic.scatterplot">result.pic.scatterplot</a></code>,<code><a href="#topic+result.rsquare">result.rsquare</a></code>,<code><a href="#topic+pim.solve">pim.solve</a></code>,<code><a href="#topic+tsm.solve">tsm.solve</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
  ## evaluate resuts
  result.main(mask.grid=relatedGrid, 
		result.grid=result, plant="beech", model="pim", 
		year="1952-2009", picPath=getwd(), picName="beech-budburst",
		createFiles=FALSE, rsquarePath=getwd(), 
		rsquareFile="rsquare.RData", rsquare.type="cod", 
		silent=FALSE, withOutliers=FALSE)
</code></pre>

<hr>
<h2 id='result.pic.histogramm'>Histogramm Creation</h2><span id='topic+result.pic.histogramm'></span>

<h3>Description</h3>

<p>Creates histogramms of results.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.pic.histogramm(values, picPath=getwd(), 
		picName="budburst-beech", silent=FALSE,
		createFile=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.pic.histogramm_+3A_values">values</code></td>
<td>
<p>The data.frame with result values (can be created with <code><a href="#topic+result.extract.main">result.extract.main</a></code>).</p>
</td></tr>
<tr><td><code id="result.pic.histogramm_+3A_picpath">picPath</code></td>
<td>
<p>The path where the png-files should be stored.</p>
</td></tr>
<tr><td><code id="result.pic.histogramm_+3A_picname">picName</code></td>
<td>
<p>The name of the created files with the histogramms.</p>
</td></tr>
<tr><td><code id="result.pic.histogramm_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="result.pic.histogramm_+3A_createfile">createFile</code></td>
<td>
<p>A boolean value determining wether a png-File will be created or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates histogramms of results (observed value, modelled value and difference of them).</p>


<h3>Value</h3>

<p>Returns nothing but creates histogramms as png-files with given path and filename.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code>,<code><a href="#topic+result.main">result.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## extract essential results
  result.values &lt;- result.extract.main(
			mask.grid=relatedGrid, 
			result.grid=result, model="pim", 
			interpolate=FALSE, silent=FALSE)

  ## create histogramm
  result.pic.histogramm(values=result.values, 
		picPath=getwd(), picName="beech_budburst", 
		silent=FALSE, createFile=FALSE)
</code></pre>

<hr>
<h2 id='result.pic.maps'>Map creation</h2><span id='topic+result.pic.maps'></span>

<h3>Description</h3>

<p>Creates maps out of results.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.pic.maps(values, picPath=getwd(), 
	picName="beech-budburst", silent=FALSE,
	createFile=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.pic.maps_+3A_values">values</code></td>
<td>
<p>The data.frame with result values (can be created with <code><a href="#topic+result.extract.main">result.extract.main</a></code>).</p>
</td></tr>
<tr><td><code id="result.pic.maps_+3A_picpath">picPath</code></td>
<td>
<p>The path where the png-files should be stored.</p>
</td></tr>
<tr><td><code id="result.pic.maps_+3A_picname">picName</code></td>
<td>
<p>The name of the created files with the maps.</p>
</td></tr>
<tr><td><code id="result.pic.maps_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="result.pic.maps_+3A_createfile">createFile</code></td>
<td>
<p>A boolean value determining wether a png-File will be created or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates maps out of results.</p>


<h3>Value</h3>

<p>Returns nothing but stores maps as png-files with given path and filename.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.extract.main">result.extract.main</a></code>,<code><a href="#topic+result.main">result.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## extract essential results
  result.values &lt;- result.extract.main(
			mask.grid=relatedGrid, 
			result.grid=result, model="pim", 
			interpolate=TRUE, silent=FALSE)

  ## not enough successfully calculated budbursts
  ## replace with examples
  result.values$doy.model &lt;- round(rnorm(n=9,mean=100,sd=20))
  result.values$doy.observed &lt;- round(rnorm(n=9,mean=100,sd=20))

  ## create maps
  result.pic.maps(values=result.values, 
		picPath=getwd(), picName="beech_budburst", 
		silent=FALSE, createFile=FALSE)
</code></pre>

<hr>
<h2 id='result.pic.scatterplot'>Scatterplot creation</h2><span id='topic+result.pic.scatterplot'></span>

<h3>Description</h3>

<p>Creates a scatterplot out of result values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.pic.scatterplot(values, picPath=getwd(), 
			picName="beech-budburst", createFile=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.pic.scatterplot_+3A_values">values</code></td>
<td>
<p>The values for which the scatterplot should be created.</p>
</td></tr>
<tr><td><code id="result.pic.scatterplot_+3A_picpath">picPath</code></td>
<td>
<p>The path where the png-files should be stored.</p>
</td></tr>
<tr><td><code id="result.pic.scatterplot_+3A_picname">picName</code></td>
<td>
<p>The name of the created file with the scatterplot.</p>
</td></tr>
<tr><td><code id="result.pic.scatterplot_+3A_createfile">createFile</code></td>
<td>
<p>A boolean value determining wether a png-File will be created or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a scatterplot out of result values. The observed values are shown at the abscissa and the modelled values at the ordinate.</p>


<h3>Value</h3>

<p>Returns nothing but stores the scatterplot as png-file with given path and filename.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.main">result.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)
  ## load spatial information
  data(relatedGrid)

  ## set or load params
  params &lt;- c(0, 0.058326, 0.109494, 0.039178, 
			-10.34, -0.89, 18.11,-10.03, 
			28.61, 44.49)

  ## apply model
  result &lt;- pim.solve(params, dataFinal, model.no=11, 
			silent=FALSE, out2File=FALSE)
 
  ## extract essential results
  result.values &lt;- result.extract.main(
			mask.grid=relatedGrid, 
			result.grid=result, model="pim", 
			interpolate=FALSE, silent=FALSE)

  ## create scatterplot
  result.pic.scatterplot(values=result.values, 
		picPath=getwd(), picName="beech_budburst",
		createFile=FALSE)
</code></pre>

<hr>
<h2 id='result.rsquare'>R-square calculation.</h2><span id='topic+result.rsquare'></span>

<h3>Description</h3>

<p>Calculates the r-square value of a model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>result.rsquare(values, type="cod")</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="result.rsquare_+3A_values">values</code></td>
<td>
<p>A list containing the modelled (doy.model) and the observed (doy.observed) values.</p>
</td></tr>
<tr><td><code id="result.rsquare_+3A_type">type</code></td>
<td>
<p>The value of type (either &lsquo;cod&rsquo; or &lsquo;pearson&rsquo;) determines whether the coefficient of 
determination or the squared pearson correlation coefficient is calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the r-square value of modelled values with given observed values.</p>


<h3>Value</h3>

<p>The r-square as numeric value.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>See Also</h3>

<p><code><a href="#topic+result.main">result.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'> 	modelled &lt;- c(100,102,98,97,96)
	observed &lt;- rep(100,5)
	values &lt;- list(doy.model=modelled, doy.observed=observed)
	result.rsquare(values, type="cod")
</code></pre>

<hr>
<h2 id='temperatures'>Temperature data</h2><span id='topic+temperatures'></span>

<h3>Description</h3>

<p>This dataset contains interpolated temperature data based on data obtained from WebWerdis, 
the Web-based weather request and distribution system of the German Weather Service (DWD).
The interpolation was done via external drift kriging provided by the &lsquo;gstat&rsquo; package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(temperatures)</code></pre>


<h3>Format</h3>

<p>A matrix containing 4 years (366 days) of temperature data at 9 different locations given by <code><a href="#topic+relatedGrid">relatedGrid</a></code>.</p>


<h3>Source</h3>

<p>WebWerdis (DWD)</p>


<h3>References</h3>

<p>Krige, D.G., 1951. A statistical approach to some basic mine valuation problems on the witwatersrand. Journal of the Chemical, Metallurgical and Mining Society of South Africa 52, 119-139.
Pebesma, E.J., 2004. Multivariable geostatistics in S: the gstat package. Computers &amp; Geosciences 30, 683-691.</p>


<h3>See Also</h3>

<p><code><a href="#topic+relatedGrid">relatedGrid</a></code></p>

<hr>
<h2 id='tsm.solve'>Temperature-Sum-Model</h2><span id='topic+tsm.solve'></span>

<h3>Description</h3>

<p>Applies a temperature-sum-model to a given dataset.</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsm.solve(params, data, silent=FALSE, out2File=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsm.solve_+3A_params">params</code></td>
<td>
<p>The parameters for the temperature-sum-model as list or vector with following order: <code class="reqn">T_b</code>, <code class="reqn">F^*</code>. <code class="reqn">T_b</code> is the threshold temperature. Above this value, temperatures are summed for calculating the development rate. <code class="reqn">F^*</code> is the threshold development rate. If the development rate reached this threshold, the phase occurs.</p>
</td></tr>
<tr><td><code id="tsm.solve_+3A_data">data</code></td>
<td>
<p>A dataset containing the station ID, the station geographic and the Gauss-Krueger-coordinates of the station,
the altitude of the station, the year and the julian day of the budburst and the leafcolouring,
outlier information for budburst and leafcolouring and temperature data for modelling. Can be created by using the function <code><a href="#topic+data.main">data.main</a></code>.</p>
</td></tr>
<tr><td><code id="tsm.solve_+3A_silent">silent</code></td>
<td>
<p>A boolean value determining wether the function should generate output messages or not.</p>
</td></tr>
<tr><td><code id="tsm.solve_+3A_out2file">out2File</code></td>
<td>
<p>A boolean value determining wether the output will be stored in log-files.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Applies a temperature-sum-model with given parameters to a given dataset.</p>


<h3>Value</h3>

<p>A dataset containing the values of the origin dataset and additionally the modelled budburst days.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>References</h3>

<p>Menzel, A. (1997). Phaenologie von Waldbaeumen unter sich aendernden Klimabedingungen - Auswertung der Beobachtungen in den Internationalen Phaenologischen Gaerten und Moeglichkeiten der Modellierung von Phaenodaten. Thesis. Forstwissenschaftliche Fakultaet der Uni Muenchen. Muenchen, Universitaet Muenchen.</p>


<h3>See Also</h3>

<p><code><a href="#topic+data.main">data.main</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## load preprocessed data
  data(dataFinal)

  ## set or load params
  params &lt;- c(0, 100)

  ## apply model
  result &lt;- tsm.solve(params, dataFinal, 
		silent=FALSE, out2File=FALSE)

</code></pre>

<hr>
<h2 id='util.geoco2gk'>Geographic coordinates to Gauss-Krueger-Coordinates</h2><span id='topic+util.geoco2gk'></span>

<h3>Description</h3>

<p>Converts geographic coordinates to Gauss-Krueger-Coordinates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>util.geoco2gk(x,y, meridian=4)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="util.geoco2gk_+3A_x">x</code></td>
<td>
<p>A vector of longitudes to transform.</p>
</td></tr>
<tr><td><code id="util.geoco2gk_+3A_y">y</code></td>
<td>
<p>A vector of latitudes to transform.</p>
</td></tr>
<tr><td><code id="util.geoco2gk_+3A_meridian">meridian</code></td>
<td>
<p>The referenced meridian for Gauss-Krueger-Coordinates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converts geographic coordinates (longitude, latitude) to Gauss-Krueger-Coordinates (&lsquo;Rechtswert&rsquo;, &lsquo;Hochwert&rsquo;) referenced by a given meridian.</p>


<h3>Value</h3>

<p>A matrix containing the the &lsquo;Rechtswert&rsquo; of the Gauss-Krueger-Coordinates in its first column and the &lsquo;Hochwert&rsquo; in its second column.</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>Examples</h3>

<pre><code class='language-R'> x &lt;- c(51.3, 54.7)
 y &lt;- c(12.3, 13.5)
 gk.xy &lt;- util.geoco2gk(x,y,4)
</code></pre>

<hr>
<h2 id='util.isLeapYear'>Leap year check</h2><span id='topic+util.isLeapYear'></span>

<h3>Description</h3>

<p>Checks wether a given year is a leap year or not.</p>


<h3>Usage</h3>

<pre><code class='language-R'>util.isLeapYear(year)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="util.isLeapYear_+3A_year">year</code></td>
<td>
<p>A year or vector of years to check.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function checks wether a year (yyyy) is a leap year or not.</p>


<h3>Value</h3>

<p>Returns a boolean vector determining wether the given years are leap years (TRUE) or not (FALSE).</p>


<h3>Author(s)</h3>

<p>Daniel Doktor, Maximilian Lange</p>


<h3>Examples</h3>

<pre><code class='language-R'>  util.isLeapYear(2000:2012)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
