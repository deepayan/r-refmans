<!DOCTYPE html><html lang="en"><head><title>Help for package SBMTrees</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SBMTrees}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#SBMTrees-package'>
<p>Sequential Imputation with Bayesian Trees Mixed-Effects Models</p></a></li>
<li><a href='#apply_locf_nocb'><p>Impute Missing Values Using LOCF and NOCB</p></a></li>
<li><a href='#BMTrees_prediction'><p>Bayesian Trees Mixed-Effects Models for Predicting Longitudinal Outcomes</p></a></li>
<li><a href='#sequential_imputation'><p>Sequential Imputation for Missing Data</p></a></li>
<li><a href='#simulation_imputation'><p>Simulate Longitudinal Data with Missingness</p></a></li>
<li><a href='#simulation_prediction'><p>Simulate Longitudinal Data for Prediction</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sequential Imputation with Bayesian Trees Mixed-Effects Models
for Longitudinal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Jungang Zou [aut, cre],
  Liangyuan Hu [aut],
  Robert McCulloch [ctb],
  Rodney Sparapani [ctb],
  Charles Spanbauer [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jungang Zou &lt;jungang.zou@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a sequential imputation framework using Bayesian Mixed-Effects Trees ('SBMTrees') for handling missing data in longitudinal studies. The package supports a variety of models, including non-linear relationships and non-normal random effects and residuals, leveraging Dirichlet Process priors for increased flexibility. Key features include handling Missing at Random (MAR) longitudinal data, imputation of both covariates and outcomes, and generating posterior predictive samples for further analysis. The methodology is designed for applications in epidemiology, biostatistics, and other fields requiring robust handling of missing data in longitudinal settings.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, lme4, Matrix, arm, dplyr, mvtnorm, sn, tidyr, mice, nnet</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist, RcppProgress</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mitml</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-10 23:44:22 UTC; jz3138</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-11 07:50:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='SBMTrees-package'>
Sequential Imputation with Bayesian Trees Mixed-Effects Models
</h2><span id='topic+SBMTrees-package'></span><span id='topic+SBMTrees'></span>

<h3>Description</h3>

<p>The SBMTrees package implements a Bayesian non-parametric framework for imputing missing covariates and outcomes in longitudinal data under the Missing at Random (MAR) assumption. Its core model, the Bayesian Trees Mixed-Effects Model (BMTrees), extends Mixed-Effects BART by employing centralized Dirichlet Process (CDP) Normal Mixture priors. This allows handling non-normal random effects and errors, addressing model misspecification, and capturing complex relationships.
</p>


<h3>Details</h3>

<p>SBMTrees offers tools for predicting and imputing missing values in longitudinal data using Bayesian Trees Mixed-Effects Models. The package supports various semiparametric variants, including BMTrees_R and BMTrees_RE, and integrates mixedBART as a baseline model. Key functionalities include:
</p>
<p>- <code>BMTrees_prediction</code>: Predicts longitudinal outcomes based on mixed-effects models.
</p>
<p>- <code>sequential_imputation</code>: Imputes missing covariates and outcomes sequentially in longitudinal datasets.
</p>
<p>The package supports flexibility in specifying priors for random effects and errors, making it suitable for diverse longitudinal data settings. Core computations leverage efficient Gibbs samplers implemented in C++.
</p>
<p>This package modifies and extends C++ code originally derived from the 
BART3 package, developed by Rodney Sparapani, 
which is licensed under the GNU General Public License version 2 (GPL-2).
</p>
<p>The modified code is redistributed in accordance with the GPL-2 license. 
For more details on the modifications, see the package's documentation.
</p>


<h3>Note</h3>

<p>This package and all associated documentation are licensed under the GNU General Public License version 2 (GPL-2). See the <code>LICENSE</code> file for the full text of the license.
</p>


<h3>Author(s)</h3>

<p>Jungang Zou &lt;jungang.zou@gmail.com&gt;
</p>


<h3>References</h3>

<p>BART3 package: https://github.com/rsparapa/bnptools/tree/master, originally developed by Rodney Sparapani. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BMTrees_prediction">BMTrees_prediction</a></code>, <code><a href="#topic+sequential_imputation">sequential_imputation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>     ## Example of predicting longitudinal outcomes
     ## To make it faster to compile and check, we only run 30 iterations for 
     ## burn-in and 40 for posterior sampling phases.
     ## Please increase to 3000 and 4000 iterations, respectively, when running the models.
     
     data &lt;- simulation_prediction(n_subject = 100, seed = 1234, nonlinear = TRUE,
             nonrandeff = TRUE, nonresidual = TRUE)
     X_train &lt;- data$X_train
     Y_train &lt;- data$Y_train
     Z_train &lt;- data$Z_train
     subject_id_train &lt;- data$subject_id_train

     X_test &lt;- data$X_test
     Z_test &lt;- data$Z_test
     subject_id_test &lt;- data$subject_id_test

     model &lt;- BMTrees_prediction(X_train, Y_train, Z_train, subject_id_train, 
              X_test, Z_test, subject_id_test, model = "BMTrees", seed = 1234)
     model$post_predictive_y_test
     
     
     
     data2 = simulation_imputation(n_subject = 100, seed = 1234, nonrandeff = TRUE, 
             nonresidual = TRUE, alligned = FALSE) 
     X_mis = data2$X_mis # get missing covariates
     Y_mis = data2$Y_mis # get missing outcomes
     Z = data2$Z # get random predictors
     subject_id = data2$subject_id  # get subject id

     model2 = sequential_imputation(X_mis, Y_mis, Z, subject_id, rep(0, 9), FALSE, 
             model = "BMTrees", nburn = 30L, npost = 40L, skip = 2L, 
             verbose = TRUE, seed = 1234)
     model2$imputed_data
     model2$imputed_data[,,10]
     
</code></pre>

<hr>
<h2 id='apply_locf_nocb'>Impute Missing Values Using LOCF and NOCB</h2><span id='topic+apply_locf_nocb'></span>

<h3>Description</h3>

<p>Imputes missing values in a matrix by applying Last Observation Carried Forward (LOCF) followed by
Next Observation Carried Backward (NOCB) for each subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_locf_nocb(X, subject_id)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_locf_nocb_+3A_x">X</code></td>
<td>
<p>A matrix where rows represent observations and columns represent variables.</p>
</td></tr>
<tr><td><code id="apply_locf_nocb_+3A_subject_id">subject_id</code></td>
<td>
<p>A vector of subject IDs corresponding to the rows of <code>X</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with missing values imputed using LOCF and NOCB.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(c(NA, 2, NA, 4, 5, NA, 7, 8, NA, NA), nrow = 5, byrow = TRUE)
subject_id &lt;- c(1, 1, 1, 2, 2)
apply_locf_nocb(X, subject_id)

</code></pre>

<hr>
<h2 id='BMTrees_prediction'>Bayesian Trees Mixed-Effects Models for Predicting Longitudinal Outcomes</h2><span id='topic+BMTrees_prediction'></span>

<h3>Description</h3>

<p>Provides predictions for outcomes in longitudinal data using Bayesian Trees
Mixed-Effects Models (BMTrees) and its semiparametric variants. The function predicts values for test
data while accounting for random effects, complex relationships, and potential model misspecification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BMTrees_prediction(
  X_train,
  Y_train,
  Z_train,
  subject_id_train,
  X_test,
  Z_test,
  subject_id_test,
  model = c("BMTrees", "BMTrees_R", "BMTrees_RE", "mixedBART"),
  binary = FALSE,
  nburn = 3000L,
  npost = 4000L,
  skip = 1L,
  verbose = TRUE,
  seed = NULL,
  tol = 1e-20,
  resample = 5,
  ntrees = 200,
  pi_CDP = 0.99
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BMTrees_prediction_+3A_x_train">X_train</code></td>
<td>
<p>A matrix of covariates in the training set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_y_train">Y_train</code></td>
<td>
<p>A numeric or logical vector of outcomes in the training set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_z_train">Z_train</code></td>
<td>
<p>A matrix of random predictors in the training set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_subject_id_train">subject_id_train</code></td>
<td>
<p>A character vector of subject IDs in the training set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_x_test">X_test</code></td>
<td>
<p>A matrix of covariates in the testing set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_z_test">Z_test</code></td>
<td>
<p>A matrix of random predictors in the testing set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_subject_id_test">subject_id_test</code></td>
<td>
<p>A character vector of subject IDs in the testing set.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_model">model</code></td>
<td>
<p>A character string specifying the predictive model. Options are <code>"BMTrees"</code>,
<code>"BMTrees_R"</code>, <code>"BMTrees_RE"</code>, and <code>"mixedBART"</code>. Default: <code>"BMTrees"</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_binary">binary</code></td>
<td>
<p>Logical. Indicates whether the outcome is binary (<code>TRUE</code>) or continuous (<code>FALSE</code>).
Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_nburn">nburn</code></td>
<td>
<p>An integer specifying the number of burn-in iterations for Gibbs sampler.
Default: <code>3000L</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_npost">npost</code></td>
<td>
<p>An integer specifying the number of posterior samples to collect. Default: <code>4000L</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_skip">skip</code></td>
<td>
<p>An integer indicating the thinning interval for MCMC samples. Default: <code>1L</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_verbose">verbose</code></td>
<td>
<p>Logical. If <code>TRUE</code>, displays MCMC progress. If <code>FALSE</code>, shows a progress bar.
Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_seed">seed</code></td>
<td>
<p>An optional integer for setting the random seed to ensure reproducibility. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_tol">tol</code></td>
<td>
<p>A numeric tolerance value to prevent numerical overflow and underflow in the model. Default: <code>1e-20</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_resample">resample</code></td>
<td>
<p>An integer specifying the number of resampling steps for the CDP prior. Default: <code>5</code>. This parameter is only valid for <code>"BMTrees"</code> and <code>"BMTrees_R"</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_ntrees">ntrees</code></td>
<td>
<p>An integer specifying the number of trees in BART. Default: <code>200</code>.</p>
</td></tr>
<tr><td><code id="BMTrees_prediction_+3A_pi_cdp">pi_CDP</code></td>
<td>
<p>A value between 0 and 1 for calculating the empirical prior in the CDP prior. Default: <code>0.99</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing posterior samples and predictions:
</p>

<dl>
<dt>post_tree_train</dt><dd><p>Posterior samples of the fixed-effects from BART on training data.</p>
</dd>
<dt>post_Sigma</dt><dd><p>Posterior samples of covariance matrices in random effects.</p>
</dd>
<dt>post_lambda_F</dt><dd><p>Posterior samples of lambda parameter in CDP normal mixture on random errors.</p>
</dd>
<dt>post_lambda_G</dt><dd><p>Posterior samples of lambda parameter in CDP normal mixture on random-effects.</p>
</dd>
<dt>post_B</dt><dd><p>Posterior samples of the coefficients in random effects.</p>
</dd>
<dt>post_random_effect_train</dt><dd><p>Posterior samples of random effects for training data.</p>
</dd>
<dt>post_sigma</dt><dd><p>Posterior samples of error deviation.</p>
</dd>
<dt>post_expectation_y_train</dt><dd><p>Posterior expectations of training data outcomes, equal to fixed-effects + random effects.</p>
</dd>
<dt>post_expectation_y_test</dt><dd><p>Posterior expectations of testing data outcomes, equal to fixed-effects + random effects.</p>
</dd>
<dt>post_predictive_y_train</dt><dd><p>Posterior predictive distributions for training outcomes, equal to fixed-effects + random effects + predictive residual.</p>
</dd>
<dt>post_predictive_y_test</dt><dd><p>Posterior predictive distributions for testing outcomes, equal to fixed-effects + random effects + predictive residual.</p>
</dd>
<dt>post_eta</dt><dd><p>Posterior samples of location parameters in CDP normal mixture on random errors.</p>
</dd>
<dt>post_mu</dt><dd><p>Posterior samples of location parameters in CDP normal mixture on random effects.</p>
</dd>
</dl>



<h3>Note</h3>

<p>This function utilizes modified C++ code originally derived from the
BART3 package (Bayesian Additive Regression Trees). The original package
was developed by Rodney Sparapani and is licensed
under GPL-2. Modifications were made by Jungang Zou, 2024.
</p>


<h3>References</h3>

<p>For more information about the original BART3 package, see:
https://github.com/rsparapa/bnptools/tree/master/BART3
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data = simulation_prediction(n_subject = 100, seed = 1234, nonlinear = TRUE, 
nonrandeff = TRUE, nonresidual = TRUE) 

# To make it faster to compile and check, we only run 30 iterations for burn-in 
# and 40 for posterior sampling phases.
# Please increase to 3000 and 4000 iterations, respectively, when running the model.
model = BMTrees_prediction(data$X_train, data$Y_train, data$Z_train, 
data$subject_id_train, data$X_test, data$Z_test, data$subject_id_test, model = "BMTrees", 
binary = FALSE, nburn = 30L, npost = 40L, skip = 1L, verbose = TRUE, seed = 1234)
model$post_predictive_y_test
model$post_sigma

</code></pre>

<hr>
<h2 id='sequential_imputation'>Sequential Imputation for Missing Data</h2><span id='topic+sequential_imputation'></span>

<h3>Description</h3>

<p>Implements sequential imputation for missing covariates and outcomes in longitudinal data.
The function uses a Bayesian non-parametric framework with mixed-effects models to handle both
normal and non-normal random effects and errors. It sequentially imputes missing values by constructing
univariate models in a fixed order, ensuring simplicity and consistency with a valid joint distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequential_imputation(
  X,
  Y,
  Z = NULL,
  subject_id,
  type,
  binary_outcome = FALSE,
  model = c("BMTrees", "BMTrees_R", "BMTrees_RE", "mixedBART"),
  nburn = 0L,
  npost = 3L,
  skip = 1L,
  verbose = TRUE,
  seed = NULL,
  tol = 1e-20,
  resample = 5,
  ntrees = 200,
  reordering = TRUE,
  pi_CDP = 0.99
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sequential_imputation_+3A_x">X</code></td>
<td>
<p>A matrix of missing covariates.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_y">Y</code></td>
<td>
<p>A vector of missing outcomes (numeric or logical).</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_z">Z</code></td>
<td>
<p>A matrix of complete random predictors.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_subject_id">subject_id</code></td>
<td>
<p>A vector of subject IDs corresponding to the rows of <code>X</code> and <code>Y</code>. Can be both integer or character</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_type">type</code></td>
<td>
<p>A logical vector indicating whether each covariate in <code>X</code> is binary (1) or continuous (0).</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_binary_outcome">binary_outcome</code></td>
<td>
<p>A logical value indicating whether the outcome <code>Y</code> is binary (1) or continuous (0). Default: <code>0</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_model">model</code></td>
<td>
<p>A character vector specifying the imputation model. Options are <code>"BMTrees"</code>,
<code>"BMTrees_R"</code>, <code>"BMTrees_RE"</code>, and <code>"mixedBART"</code>. Default: <code>"BMTrees"</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_nburn">nburn</code></td>
<td>
<p>An integer specifying the number of burn-in iterations. Default: <code>0</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_npost">npost</code></td>
<td>
<p>An integer specifying the number of sampling iterations. Default: <code>3</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_skip">skip</code></td>
<td>
<p>An integer specifying the interval for keeping samples in the sampling phase. Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether to display progress and MCMC information. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_seed">seed</code></td>
<td>
<p>A random seed for reproducibility. Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_tol">tol</code></td>
<td>
<p>A small numerical tolerance to prevent numerical overflow or underflow in the model. Default: <code>1e-20</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_resample">resample</code></td>
<td>
<p>An integer specifying the number of resampling steps for the CDP prior. Default: <code>5</code>. This parameter is only valid for <code>"BMTrees"</code> and <code>"BMTrees_R"</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_ntrees">ntrees</code></td>
<td>
<p>An integer specifying the number of trees in BART. Default: <code>200</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_reordering">reordering</code></td>
<td>
<p>A logical value indicating whether to apply a reordering strategy for sorting covariates. Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sequential_imputation_+3A_pi_cdp">pi_CDP</code></td>
<td>
<p>A value between 0 and 1 for calculating the empirical prior in the CDP prior. Default: <code>0.99</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function builds on the Bayesian Trees Mixed-Effects Model (BMTrees), which extends Mixed-Effects
BART by using centralized Dirichlet Process (CDP) Normal Mixture priors. This framework handles non-normal
random effects and errors, addresses model misspecification, and captures complex relationships. The function
employs a Metropolis-Hastings MCMC method to sequentially impute missing values.
</p>


<h3>Value</h3>

<p>A three-dimensional array of imputed data with dimensions <code>(npost / skip, N, p + 1)</code>, where:
</p>

<ul>
<li> <p><code>N</code> is the number of observations.
</p>
</li>
<li> <p><code>p</code> is the number of covariates in <code>X</code>.
The array includes imputed covariates and outcomes.
</p>
</li></ul>



<h3>Note</h3>

<p>This function utilizes modified C++ code originally derived from the
BART3 package (Bayesian Additive Regression Trees). The original package
was developed by Rodney Sparapani and is licensed
under GPL-2. Modifications were made by Jungang Zou, 2024.
</p>


<h3>References</h3>

<p>For more information about the original BART3 package, see:
https://github.com/rsparapa/bnptools/tree/master/BART3
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- simulation_imputation(n_subject = 100, seed = 1234, nonrandeff = TRUE, 
        nonresidual = TRUE, alligned = FALSE) 

# To make it faster to compile and check, we only run 30 iterations for burn-in 
# and 40 for posterior sampling phases.
# Please increase to 3000 and 4000 iterations, respectively, when running the model.
model &lt;- sequential_imputation(data$X_mis, data$Y_mis, data$Z, data$subject_id, 
        rep(0, 9), binary_outcome = FALSE, model = "BMTrees", nburn = 30L, 
        npost = 40L, skip = 2L, verbose = TRUE, seed = 1234)
model$imputed_data

</code></pre>

<hr>
<h2 id='simulation_imputation'>Simulate Longitudinal Data with Missingness</h2><span id='topic+simulation_imputation'></span>

<h3>Description</h3>

<p>Generates a dataset with longitudinal data containing missing covariates and outcomes.
The function allows customization of random effects, residuals, and the alignment of covariates to simulate
data under different conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_imputation(
  n_subject = 800,
  seed = NULL,
  nonrandeff = FALSE,
  nonresidual = FALSE,
  alligned = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation_imputation_+3A_n_subject">n_subject</code></td>
<td>
<p>Number of subjects in the dataset. Each subject has multiple observations. Default: <code>800</code>.</p>
</td></tr>
<tr><td><code id="simulation_imputation_+3A_seed">seed</code></td>
<td>
<p>Random seed for reproducibility. Default: <code>123</code>.</p>
</td></tr>
<tr><td><code id="simulation_imputation_+3A_nonrandeff">nonrandeff</code></td>
<td>
<p>Logical value indicating whether the random effects are non-normal. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_imputation_+3A_nonresidual">nonresidual</code></td>
<td>
<p>Logical value indicating whether the residuals are non-normal. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_imputation_+3A_alligned">alligned</code></td>
<td>
<p>Logical value indicating whether the covariates should be aligned (<code>TRUE</code>)
or shuffled (<code>FALSE</code>). Default: <code>FALSE</code>. If it is shuffled, we will return covariate order as X1, X2, X3, X4, X5, X6, X9, X8, X7. If it is alligned, we will return covariate order as X1, X2, X3, X4, X5, X6, X7, X8, X9.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates longitudinal data for multiple subjects, each observed across 6
time points. Non-normal or normal random effects and residual conditions can be specified. Missing values are introduced based MAR assumption.
The alignment of covariates can be customized to test different imputation scenarios.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt><code>X_mis</code></dt><dd><p>Matrix of missing covariates.</p>
</dd>
<dt><code>Y_mis</code></dt><dd><p>Vector of missing outcomes.</p>
</dd>
<dt><code>Z</code></dt><dd><p>Matrix of complete random predictors.</p>
</dd>
<dt><code>subject_id</code></dt><dd><p>Vector of subject IDs.</p>
</dd>
<dt><code>time</code></dt><dd><p>Time points for each observation.</p>
</dd>
<dt><code>X_O</code></dt><dd><p>Matrix of original complete covariates (for evaluation).</p>
</dd>
<dt><code>Y_O</code></dt><dd><p>Vector of original complete outcomes (for evaluation).</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="stats.html#topic+Normal">Normal</a></code>, <code><a href="stats.html#topic+Uniform">Uniform</a></code>, <code><a href="stats.html#topic+Binomial">Binomial</a></code>, <code><a href="stats.html#topic+Chisquare">Chisquare</a></code>, <code><a href="stats.html#topic+GammaDist">GammaDist</a></code>
<code><a href="mvtnorm.html#topic+Mvnorm">Mvnorm</a></code>
<code><a href="sn.html#topic+dmst">dmst</a></code>
<code><a href="dplyr.html#topic+reexports">reexports</a></code>, <code><a href="dplyr.html#topic+mutate">mutate</a></code>, <code><a href="dplyr.html#topic+select">select</a></code>
<code><a href="tidyr.html#topic+pivot_wider">pivot_wider</a></code>, <code><a href="tidyr.html#topic+pivot_longer">pivot_longer</a></code>, <code><a href="tidyr.html#topic+reexports">reexports</a></code>, <code><a href="tidyr.html#topic+separate">separate</a></code>
<code><a href="arm.html#topic+invlogit">invlogit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>simulated_data &lt;- simulation_imputation(
  n_subject = 800,
  seed = 123,
  nonrandeff = TRUE,
  nonresidual = TRUE,
  alligned = FALSE
)
</code></pre>

<hr>
<h2 id='simulation_prediction'>Simulate Longitudinal Data for Prediction</h2><span id='topic+simulation_prediction'></span>

<h3>Description</h3>

<p>Generates a fixed population longitudinal dataset, with random seeds to generate different
training and testing sets. The function supports customization of linear/nonlinear associations,
normal/non-normal random effects, and random errors. It splits the data into training and testing sets,
with the testing set comprising approximately 40% of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulation_prediction(
  n_subject = 800,
  seed = NULL,
  nonlinear = FALSE,
  nonrandeff = FALSE,
  nonresidual = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation_prediction_+3A_n_subject">n_subject</code></td>
<td>
<p>Number of subjects in the dataset. Each subject has multiple observations across 6 follow-up time points. Default: <code>800</code>.</p>
</td></tr>
<tr><td><code id="simulation_prediction_+3A_seed">seed</code></td>
<td>
<p>Random seed for reproducibility. Ensures different training-testing splits. Default: <code>123</code>.</p>
</td></tr>
<tr><td><code id="simulation_prediction_+3A_nonlinear">nonlinear</code></td>
<td>
<p>Logical value indicating whether the outcome model includes nonlinear associations. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_prediction_+3A_nonrandeff">nonrandeff</code></td>
<td>
<p>Logical value indicating whether the random effects are non-normal. Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="simulation_prediction_+3A_nonresidual">nonresidual</code></td>
<td>
<p>Logical value indicating whether the residuals are non-normal. Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a dataset with individuals observed at 6 follow-up time points. It allows
users to specify whether the associations are linear or nonlinear and whether random effects and residuals
follow normal or non-normal distributions. Approximately 40% of the data is randomly chosen to form the
testing set, while the remaining 60% constitutes the training set.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<dl>
<dt><code>Y_test_true</code></dt><dd><p>True values of the vector of outcomes in the testing set.</p>
</dd>
<dt><code>X_train</code></dt><dd><p>Matrix of covariates in the training set.</p>
</dd>
<dt><code>Y_train</code></dt><dd><p>Vector of outcomes in the training set.</p>
</dd>
<dt><code>Z_train</code></dt><dd><p>Matrix of random predictors in the training set.</p>
</dd>
<dt><code>subject_id_train</code></dt><dd><p>Vector of subject IDs in the training set.</p>
</dd>
<dt><code>time_train</code></dt><dd><p>Vector of time point in the training set.</p>
</dd>
<dt><code>X_test</code></dt><dd><p>Matrix of covariates in the testing set.</p>
</dd>
<dt><code>Y_test</code></dt><dd><p>Vector of outcomes in the testing set.</p>
</dd>
<dt><code>Z_test</code></dt><dd><p>Matrix of random predictors in the testing set.</p>
</dd>
<dt><code>subject_id_test</code></dt><dd><p>Vector of subject IDs in the testing set.</p>
</dd>
<dt><code>time_test</code></dt><dd><p>Vector of time point in the testing set.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="mvtnorm.html#topic+Mvnorm">Mvnorm</a></code>
<code><a href="stats.html#topic+Chisquare">Chisquare</a></code>
<code><a href="mice.html#topic+ampute">ampute</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Generate data with nonlinear associations and non-normal random effects and residuals
  data &lt;- simulation_prediction(
    n_subject = 800,
    seed = 123,
    nonlinear = TRUE,
    nonrandeff = TRUE,
    nonresidual = TRUE
  )
  # Access training and testing data
  X_train &lt;- data$X_train
  Y_train &lt;- data$Y_train
  Z_train &lt;- data$Z_train
  subject_id_train &lt;- data$subject_id_train

  X_test &lt;- data$X_test
  Y_test &lt;- data$Y_test
  Z_test &lt;- data$Z_test
  subject_id_test &lt;- data$subject_id_test
  
  Y_test_true = data$Y_test_true

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
