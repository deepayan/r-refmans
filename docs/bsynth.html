<!DOCTYPE html><html><head><title>Help for package bsynth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bsynth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bsynth-package'><p>The 'bsynth' package.</p></a></li>
<li><a href='#.get_par_long'><p>Get Parameter Estimates in Long Format</p></a></li>
<li><a href='#.get_plot_df'><p>Returns Data Frame Ready for Plotting with Confidence Intervals</p></a></li>
<li><a href='#.get_plot_df2'><p>Prepare Data Frame for Plotting with Multiple Treated Units</p></a></li>
<li><a href='#.get_synth_draws'><p>Get Synthetic Draws in Tidy Format for Single Treated Unit</p></a></li>
<li><a href='#.get_synth_draws_predictor_match'><p>Get Synthetic Draws in Tidy Format for Single Treated Unit (Predictor Match Model)</p></a></li>
<li><a href='#.get_synth_draws3d'><p>Get Synthetic Draws in Tidy Format for Multiple Treated Units (3D Array)</p></a></li>
<li><a href='#.makeWide'><p>Convert Data to Wide Format</p></a></li>
<li><a href='#.plot_tau'><p>Plot Treatment Effect Estimate</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#bayesianFactor'><p>Create a Bayesian Synthetic Control Object Using Panel Data</p></a></li>
<li><a href='#bayesianSynth'><p>Create a Bayesian Synthetic Control Object Using Panel Data</p></a></li>
<li><a href='#time_tiles'><p>Time Tiles Plot of Intervention Impact</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Bayesian Synthetic Control</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the Bayesian Synthetic Control method for causal inference
    in comparative case studies. This package provides tools for estimating
    treatment effects in settings with a single treated unit and multiple control
    units, allowing for uncertainty quantification and flexible modeling of
    time-varying effects. The methodology is based on the paper by Vives and
    Martinez (2022) &lt;<a href="https://doi.org/10.48550%2FarXiv.2206.01779">doi:10.48550/arXiv.2206.01779</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/google/bsynth">https://github.com/google/bsynth</a>, <a href="https://arxiv.org/abs/2206.01779">https://arxiv.org/abs/2206.01779</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/google/bsynth/issues">https://github.com/google/bsynth/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1), cubelyr, dplyr,
ggplot2, glue, magrittr, methods, purrr, rstan (&ge; 2.18.1),
rstantools (&ge; 2.1.1), scales, tibble, tidyr, vizdraws (&ge;
1.1), stats, rlang</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, roxygen2, gsynth, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-23 16:15:49 UTC; rstudio</td>
</tr>
<tr>
<td>Author:</td>
<td>Ignacio Martinez <a href="https://orcid.org/0000-0002-3721-8172"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jaume [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ignacio Martinez &lt;ignacio@martinez.fyi&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-25 10:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bsynth-package'>The 'bsynth' package.</h2><span id='topic+bsynth-package'></span><span id='topic+bsynth'></span>

<h3>Description</h3>

<p>Provides causal inference with a Bayesian synthetic
control method.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Ignacio Martinez <a href="mailto:ignacio@martinez.fyi">ignacio@martinez.fyi</a> (<a href="https://orcid.org/0000-0002-3721-8172">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Jaume <a href="mailto:vives@mit.edu">vives@mit.edu</a>
</p>
</li></ul>



<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.2. https://mc-stan.org
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/google/bsynth">https://github.com/google/bsynth</a>
</p>
</li>
<li> <p><a href="https://arxiv.org/abs/2206.01779">https://arxiv.org/abs/2206.01779</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/google/bsynth/issues">https://github.com/google/bsynth/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.get_par_long'>Get Parameter Estimates in Long Format</h2><span id='topic+.get_par_long'></span>

<h3>Description</h3>

<p>Helper function to get the long dataset of draws given a stan fit object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_par_long(fit, par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_par_long_+3A_fit">fit</code></td>
<td>
<p>Stan object with the fitted model.</p>
</td></tr>
<tr><td><code id=".get_par_long_+3A_par">par</code></td>
<td>
<p>Variable to do the long table for.expand_more</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble containing the parameter estimates in long format.
</p>

<hr>
<h2 id='.get_plot_df'>Returns Data Frame Ready for Plotting with Confidence Intervals</h2><span id='topic+.get_plot_df'></span>

<h3>Description</h3>

<p>This function processes data frames containing synthetic and observed outcomes,
calculates confidence intervals for the synthetic outcomes, and returns a
combined data frame suitable for plotting the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_plot_df(y_synth_draws, pre_data, post_data, time, outcome, ci = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_plot_df_+3A_y_synth_draws">y_synth_draws</code></td>
<td>
<p>A data frame containing draws from the Stan fit object.</p>
</td></tr>
<tr><td><code id=".get_plot_df_+3A_pre_data">pre_data</code></td>
<td>
<p>A data frame with data before the intervention.</p>
</td></tr>
<tr><td><code id=".get_plot_df_+3A_post_data">post_data</code></td>
<td>
<p>A data frame with data after the intervention.</p>
</td></tr>
<tr><td><code id=".get_plot_df_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_plot_df_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_plot_df_+3A_ci">ci</code></td>
<td>
<p>The width of the credible confidence interval (default: 0.75).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>time</code>: The time period.
</p>
</li>
<li> <p><code>outcome</code>: The observed outcome.
</p>
</li>
<li> <p><code>y_synth</code>: The mean synthetic outcome.
</p>
</li>
<li> <p><code>LB</code>: The lower bound of the confidence interval for the synthetic outcome.
</p>
</li>
<li> <p><code>UB</code>: The upper bound of the confidence interval for the synthetic outcome.
</p>
</li>
<li> <p><code>tau</code>: The difference between the observed and synthetic outcomes.
</p>
</li>
<li> <p><code>tau_LB</code>: The lower bound of the confidence interval for <code>tau</code>.
</p>
</li>
<li> <p><code>tau_UB</code>: The upper bound of the confidence interval for <code>tau</code>.
</p>
</li></ul>


<hr>
<h2 id='.get_plot_df2'>Prepare Data Frame for Plotting with Multiple Treated Units</h2><span id='topic+.get_plot_df2'></span>

<h3>Description</h3>

<p>This function processes data for multiple treated units, calculating synthetic outcomes,
confidence intervals, and treatment effects. It combines this information into a data
frame suitable for plotting the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_plot_df2(y_synth_draws, data, treated_ids, id, time, outcome, ci = 0.75)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_plot_df2_+3A_y_synth_draws">y_synth_draws</code></td>
<td>
<p>A data frame containing synthetic outcome draws for each treated unit and time period.</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_data">data</code></td>
<td>
<p>A data frame with the original data, including outcomes for treated units.</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_treated_ids">treated_ids</code></td>
<td>
<p>A vector of identifiers for the treated units.</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_id">id</code></td>
<td>
<p>The name of the variable in <code>data</code> that identifies units (as a string).</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_plot_df2_+3A_ci">ci</code></td>
<td>
<p>The width of the credible confidence interval (default: 0.75).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>time</code>: The time period.
</p>
</li>
<li> <p><code>id</code>: The unit identifier (including &quot;Average&quot; for the average treatment effect).
</p>
</li>
<li> <p><code>outcome</code>: The observed outcome (for treated units).
</p>
</li>
<li> <p><code>y_synth</code>: The mean synthetic outcome (for treated units and the average).
</p>
</li>
<li> <p><code>LB</code>: The lower bound of the confidence interval for the synthetic outcome.
</p>
</li>
<li> <p><code>UB</code>: The upper bound of the confidence interval for the synthetic outcome.
</p>
</li>
<li> <p><code>tau</code>: The treatment effect (difference between observed and synthetic outcomes).
</p>
</li>
<li> <p><code>tau_LB</code>: The lower bound of the confidence interval for the treatment effect.
</p>
</li>
<li> <p><code>tau_UB</code>: The upper bound of the confidence interval for the treatment effect.
</p>
</li></ul>


<hr>
<h2 id='.get_synth_draws'>Get Synthetic Draws in Tidy Format for Single Treated Unit</h2><span id='topic+.get_synth_draws'></span>

<h3>Description</h3>

<p>This internal helper function extracts synthetic draws from a Stan fit object,
combines them with observed outcome data, and returns a tidy data frame suitable
for further analysis or plotting. This function is specifically designed for
scenarios with a single treated unit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_synth_draws(fit, pre_data, post_data, time, outcome)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_synth_draws_+3A_fit">fit</code></td>
<td>
<p>A Stan fit object containing the model results.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_+3A_pre_data">pre_data</code></td>
<td>
<p>A data frame with outcome data before the intervention.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_+3A_post_data">post_data</code></td>
<td>
<p>A data frame with outcome data after the intervention.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_synth_draws_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>draw</code>: The index of the synthetic draw.
</p>
</li>
<li> <p><code>time</code>: The time period.
</p>
</li>
<li> <p><code>y_synth</code>: The synthetic outcome for the given draw and time period.
</p>
</li>
<li> <p><code>outcome</code>: The observed outcome for the given time period.
</p>
</li></ul>


<hr>
<h2 id='.get_synth_draws_predictor_match'>Get Synthetic Draws in Tidy Format for Single Treated Unit (Predictor Match Model)</h2><span id='topic+.get_synth_draws_predictor_match'></span>

<h3>Description</h3>

<p>This internal helper function extracts synthetic draws from a Stan fit object
generated by a predictor match model. It combines these draws with observed
outcome data and returns a tidy data frame suitable for analysis or plotting.
It specifically works with variable definitions from the predictor match model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_synth_draws_predictor_match(fit, pre_data, post_data, time, outcome)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_synth_draws_predictor_match_+3A_fit">fit</code></td>
<td>
<p>A Stan fit object containing the model results.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_predictor_match_+3A_pre_data">pre_data</code></td>
<td>
<p>A data frame with outcome data before the intervention.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_predictor_match_+3A_post_data">post_data</code></td>
<td>
<p>A data frame with outcome data after the intervention.</p>
</td></tr>
<tr><td><code id=".get_synth_draws_predictor_match_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_synth_draws_predictor_match_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>draw</code>: The index of the synthetic draw.
</p>
</li>
<li> <p><code>time</code>: The time period.
</p>
</li>
<li> <p><code>y_synth</code>: The synthetic outcome for the given draw and time period.
</p>
</li>
<li> <p><code>outcome</code>: The observed outcome for the given time period.
</p>
</li></ul>


<hr>
<h2 id='.get_synth_draws3d'>Get Synthetic Draws in Tidy Format for Multiple Treated Units (3D Array)</h2><span id='topic+.get_synth_draws3d'></span>

<h3>Description</h3>

<p>This internal helper function extracts synthetic draws from a Stan fit object
where the draws are stored in a 3D array. It handles multiple treated units and
combines the draws with observed outcome data, returning a tidy data frame
suitable for analysis or plotting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.get_synth_draws3d(fit, data, id, treated_ids, time, outcome, intervention)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".get_synth_draws3d_+3A_fit">fit</code></td>
<td>
<p>A Stan fit object containing the model results.</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_data">data</code></td>
<td>
<p>A data frame with the input data, including outcome, time, and unit identifier.</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_id">id</code></td>
<td>
<p>The name of the variable in <code>data</code> that identifies units (as a string).</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_treated_ids">treated_ids</code></td>
<td>
<p>A vector of identifiers for the treated units.</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
<tr><td><code id=".get_synth_draws3d_+3A_intervention">intervention</code></td>
<td>
<p>The name of the variable in <code>data</code> that indicates the intervention time (as a string).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame containing:
</p>

<ul>
<li> <p><code>draw</code>: The index of the synthetic draw.
</p>
</li>
<li> <p><code>id</code>: The identifier of the treated unit.
</p>
</li>
<li> <p><code>time</code>: The time period.
</p>
</li>
<li> <p><code>y_hat</code>: The synthetic outcome for the given draw, unit, and time period.
</p>
</li></ul>


<hr>
<h2 id='.makeWide'>Convert Data to Wide Format</h2><span id='topic+.makeWide'></span>

<h3>Description</h3>

<p>This internal helper function transforms data from a long format, where each
row represents an observation for a specific unit and time, to a wide format,
where each row represents a time period and each column represents a unit's outcome.
It specifically focuses on separating treated and untreated units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.makeWide(data, id, time, outcome, treatment)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".makeWide_+3A_data">data</code></td>
<td>
<p>A data frame containing the input data.</p>
</td></tr>
<tr><td><code id=".makeWide_+3A_id">id</code></td>
<td>
<p>The name of the variable in <code>data</code> that identifies units (as a string).</p>
</td></tr>
<tr><td><code id=".makeWide_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id=".makeWide_+3A_outcome">outcome</code></td>
<td>
<p>The name of the outcome variable (as a string).</p>
</td></tr>
<tr><td><code id=".makeWide_+3A_treatment">treatment</code></td>
<td>
<p>The name of the variable in <code>data</code> that indicates treatment status (as a string).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame in wide format, where each row corresponds to a time period,
and columns include the time variable, the treatment indicator, and the outcome
values for each treated unit and all untreated units.
</p>

<hr>
<h2 id='.plot_tau'>Plot Treatment Effect Estimate</h2><span id='topic+.plot_tau'></span>

<h3>Description</h3>

<p>This internal helper function creates a plot to visualize the estimated
treatment effect over time. It allows for faceting by a specified variable
and optional subsetting of units to include in the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.plot_tau(data, x, y, ymin, ymax, xintercept, facet, id, subset = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id=".plot_tau_+3A_data">data</code></td>
<td>
<p>A data frame containing the data to be plotted.</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_x">x</code></td>
<td>
<p>The name of the x-axis variable (typically the time period) (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_y">y</code></td>
<td>
<p>The name of the y-axis variable (typically the treatment effect) (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_ymin">ymin</code></td>
<td>
<p>The name of the variable containing the lower bound of the confidence interval (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_ymax">ymax</code></td>
<td>
<p>The name of the variable containing the upper bound of the confidence interval (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_xintercept">xintercept</code></td>
<td>
<p>The time point of the intervention to be marked with a vertical dashed line.</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_facet">facet</code></td>
<td>
<p>(Optional) The name of the variable to facet the plot by (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_id">id</code></td>
<td>
<p>The name of the variable identifying the units (as a string).</p>
</td></tr>
<tr><td><code id=".plot_tau_+3A_subset">subset</code></td>
<td>
<p>(Optional) A vector specifying a subset of units to include in the plot. If NULL, all units are included.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object displaying the treatment effect plot.
</p>

<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='bayesianFactor'>Create a Bayesian Synthetic Control Object Using Panel Data</h2><span id='topic+bayesianFactor'></span>

<h3>Description</h3>

<p>A Bayesian Factor Model has raw data and draws from the posterior
distribution. This is represented by an R6 Class.
</p>
<p>Code and theory based on
<a href="https://arxiv.org/abs/2103.16244">Pinkney 2021</a>.
</p>
<p>public methods:
</p>

<ul>
<li> <p><code>initialize()</code> initializes the variables and model parameters
</p>
</li>
<li> <p><code>fit()</code>  fits the stan model and returns a fit object
</p>
</li>
<li> <p><code>updateWidth</code> updates the width of the credible interval
</p>
</li>
<li> <p><code>placeboPlot</code> generates a counterfactual placebo plot
</p>
</li>
<li> <p><code>effectPlot</code> returns a plot of the treatment effect over time
</p>
</li>
<li> <p><code>summarizeLift</code>returns descriptive statistics of the lift estimate
</p>
</li>
<li> <p><code>biasDraws</code> returns a plot of the relative bias in a LFM
</p>
</li>
<li> <p><code>liftDraws</code> returns a plot of the posterior lift distribution
</p>
</li>
<li> <p><code>liftBias</code> returns a plot of the relative bias given a lift offset
</p>
</li></ul>



<h3>Value</h3>

<p>vizdraws object with the relative bias with offset.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>timeTiles</code></dt><dd><p>ggplot2 object that shows when
the intervention happened.</p>
</dd>
<dt><code>plotData</code></dt><dd><p>tibble with the observed outcome and the
counterfactual data.</p>
</dd>
<dt><code>interventionTime</code></dt><dd><p>returns the intervention time period.</p>
</dd>
<dt><code>synthetic</code></dt><dd><p>ggplot2 object that shows the
observed and counterfactual outcomes over time.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-bayesianFactor-new"><code>bayesianFactor$new()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-fit"><code>bayesianFactor$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-updateWidth"><code>bayesianFactor$updateWidth()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-summarizeLift"><code>bayesianFactor$summarizeLift()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-effectPlot"><code>bayesianFactor$effectPlot()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-liftDraws"><code>bayesianFactor$liftDraws()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-liftBias"><code>bayesianFactor$liftBias()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-biasDraws"><code>bayesianFactor$biasDraws()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianFactor-clone"><code>bayesianFactor$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-bayesianFactor-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new bayesianFactor object.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$new(
  data,
  time,
  id,
  treated,
  outcome,
  ci_width = 0.75,
  covariates
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt><dd><p>Long data.frame object with fields outcome, time, id,
and treatment indicator.</p>
</dd>
<dt><code>time</code></dt><dd><p>Name of the variable in the data frame that</p>
</dd>
<dt><code>id</code></dt><dd><p>Name of the variable in the data frame that
identifies the units (e.g. country, region etc).</p>
</dd>
<dt><code>treated</code></dt><dd><p>Name of the variable in the data frame that contains the
treatment assignment of the intervention.</p>
</dd>
<dt><code>outcome</code></dt><dd><p>Name of the outcome variable.</p>
</dd>
<dt><code>ci_width</code></dt><dd><p>Credible interval's width.  This number is in the
(0,1) interval.</p>
</dd>
<dt><code>covariates</code></dt><dd><p>Dataframe with a column for id and the other columns
Defaults to NULL if no covariates should be included in the model.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>params described in the data structure section of the
documentation of the R6 class at the top of the file.
</p>



<h5>Returns</h5>

<p>A new <code>bayesianFactor</code> object.
</p>


<hr>
<a id="method-bayesianFactor-fit"></a>



<h4>Method <code>fit()</code></h4>

<p>Fit Stan model.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$fit(L = 8, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>L</code></dt><dd><p>Number of factors.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianFactor-updateWidth"></a>



<h4>Method <code>updateWidth()</code></h4>

<p>Update the width of the credible interval.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$updateWidth(ci_width = 0.75)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ci_width</code></dt><dd><p>New width for the credible interval. This number
should be in the (0,1) interval.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianFactor-summarizeLift"></a>



<h4>Method <code>summarizeLift()</code></h4>

<p>summarizeLift returns descriptive statistics of
the lift estimate.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$summarizeLift()</pre></div>


<hr>
<a id="method-bayesianFactor-effectPlot"></a>



<h4>Method <code>effectPlot()</code></h4>

<p>effectPlot returns ggplot2 object that shows the
effect of the intervention over time.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$effectPlot()</pre></div>


<hr>
<a id="method-bayesianFactor-liftDraws"></a>



<h4>Method <code>liftDraws()</code></h4>

<p>Plots lift.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$liftDraws(from, to, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>from</code></dt><dd><p>First period to consider when calculating lift. If infinite,
set to the time of the intervention.</p>
</dd>
<dt><code>to</code></dt><dd><p>Last period to consider when calculating lift. If infinite, set
to the last period.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to vizdraws::vizdraws().</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>vizdraws object with the posterior distribution of the lift.
</p>


<hr>
<a id="method-bayesianFactor-liftBias"></a>



<h4>Method <code>liftBias()</code></h4>

<p>Plot bias magnitude in terms of lift for period (firstT, lastT)
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$liftBias(firstT, lastT, offset, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>firstT</code></dt><dd><p>Start of the time period to compute relative bias over.
Must be after the intervention.</p>
</dd>
<dt><code>lastT</code></dt><dd><p>End of the time period to compute relative bias over.
Must be after the intervention.
over. They must be after the intervention.</p>
</dd>
<dt><code>offset</code></dt><dd><p>Target lift %.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to vizdraws::vizdraws().</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianFactor-biasDraws"></a>



<h4>Method <code>biasDraws()</code></h4>

<p>Plots relative upper bias / tau for a time period (firstT, lastT).
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$biasDraws(small_bias = 0.3, firstT, lastT)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>small_bias</code></dt><dd><p>Threshold value for considering the bias &quot;small&quot;.</p>
</dd>
<dt><code>firstT, lastT</code></dt><dd><p>Time periods to compute relative bias over, they must
after the intervention.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>vizdraw object with the posterior distribution of relative bias.
Bias is scaled by the time periods.
</p>


<hr>
<a id="method-bayesianFactor-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianFactor$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='bayesianSynth'>Create a Bayesian Synthetic Control Object Using Panel Data</h2><span id='topic+bayesianSynth'></span>

<h3>Description</h3>

<p>A Bayesian Synthetic Control has raw data and draws from the posterior
distribution. This is represented by an R6 Class.
</p>
<p>public methods:
</p>

<ul>
<li> <p><code>initialize()</code> initializes the variables and model parameters
</p>
</li>
<li> <p><code>fit()</code>  fits the stan model and returns a fit object
</p>
</li>
<li> <p><code>updateWidth</code> updates the width of the credible interval
</p>
</li>
<li> <p><code>placeboPlot</code> generates a counterfactual placebo plot
</p>
</li>
<li> <p><code>effectPlot</code> returns a plot of the treatment effect over time
</p>
</li>
<li> <p><code>summarizeLift</code>returns descriptive statistics of the lift estimate
</p>
</li>
<li> <p><code>biasDraws</code> returns a plot of the relative bias in a LFM
</p>
</li>
<li> <p><code>liftDraws</code> returns a plot of the posterior lift distribution
</p>
</li>
<li> <p><code>liftBias</code> returns a plot of the relative bias given a lift offset
Data structure:
</p>
</li></ul>



<h3>Value</h3>

<p>vizdraws object with the relative bias with offset.
</p>


<h3>Active bindings</h3>

<div class="r6-active-bindings">

<dl>
<dt><code>timeTiles</code></dt><dd><p>ggplot2 object that shows when
the intervention happened.</p>
</dd>
<dt><code>plotData</code></dt><dd><p>returns tibble with the observed outcome and the
counterfactual data.</p>
</dd>
<dt><code>interventionTime</code></dt><dd><p>returns intervention time period (e.g., year)
in which the treatment occurred.</p>
</dd>
<dt><code>synthetic</code></dt><dd><p>returns ggplot2 object that shows the
observed and counterfactual outcomes over time.</p>
</dd>
<dt><code>checks</code></dt><dd><p>returns MCMC checks.</p>
</dd>
<dt><code>lift</code></dt><dd><p>draws from the posterior distribution of the lift.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-bayesianSynth-new"><code>bayesianSynth$new()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-fit"><code>bayesianSynth$fit()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-updateWidth"><code>bayesianSynth$updateWidth()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-summarizeLift"><code>bayesianSynth$summarizeLift()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-effectPlot"><code>bayesianSynth$effectPlot()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-placeboPlot"><code>bayesianSynth$placeboPlot()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-biasDraws"><code>bayesianSynth$biasDraws()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-liftDraws"><code>bayesianSynth$liftDraws()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-liftBias"><code>bayesianSynth$liftBias()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-weightDraws"><code>bayesianSynth$weightDraws()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-weightCorr"><code>bayesianSynth$weightCorr()</code></a>
</p>
</li>
<li> <p><a href="#method-bayesianSynth-clone"><code>bayesianSynth$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-bayesianSynth-new"></a>



<h4>Method <code>new()</code></h4>

<p>Create a new bayesianSynth object.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$new(
  data,
  time,
  id,
  treated,
  outcome,
  ci_width = 0.75,
  gp = FALSE,
  covariates = NULL,
  predictor_match = FALSE,
  predictor_match_covariates0 = NULL,
  predictor_match_covariates1 = NULL,
  vs = NULL
)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>data</code></dt><dd><p>Long data.frame object with fields outcome, time, id,
and treatment indicator.</p>
</dd>
<dt><code>time</code></dt><dd><p>Name of the variable in the data frame that
identifies the time period (e.g. year, month, week etc).</p>
</dd>
<dt><code>id</code></dt><dd><p>Name of the variable in the data frame that
identifies the units (e.g. country, region etc).</p>
</dd>
<dt><code>treated</code></dt><dd><p>Name of the variable in the data frame that contains
the treatment assignment of the intervention.</p>
</dd>
<dt><code>outcome</code></dt><dd><p>Name of the outcome variable.</p>
</dd>
<dt><code>ci_width</code></dt><dd><p>Credible interval's width.  This number is in the
(0,1) interval.</p>
</dd>
<dt><code>gp</code></dt><dd><p>Logical that indicates whether or not to include a
Gaussian Process as part of the model.</p>
</dd>
<dt><code>covariates</code></dt><dd><p>Data.frame with time dependent covariates for
for each unit and time field.
Defaults to NULL if no covariates should be included in the model.</p>
</dd>
<dt><code>predictor_match</code></dt><dd><p>Logical that indicates whether or not to run
the matching version of the Bayesian Synthetic Control. This option can
not be used with gp, covariates or multiple treated units.</p>
</dd>
<dt><code>predictor_match_covariates0</code></dt><dd><p>data.frame with time independent
covariates on each row and column indicating the control unit names
(dim k x J+1).</p>
</dd>
<dt><code>predictor_match_covariates1</code></dt><dd><p>Vector with time independent
covariates for the treated unit (dim k x 1).</p>
</dd>
<dt><code>vs</code></dt><dd><p>Vector of weights for the importance of the predictors used
in creating the synthetic control.
Defaults to equal weight for all predictors.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A new <code>bayesianSynth</code> object.
</p>


<hr>
<a id="method-bayesianSynth-fit"></a>



<h4>Method <code>fit()</code></h4>

<p>Fit Stan model.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$fit(...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>...</code></dt><dd><p>other arguments passed to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianSynth-updateWidth"></a>



<h4>Method <code>updateWidth()</code></h4>

<p>Update the width of the credible interval.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$updateWidth(ci_width = 0.75)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>ci_width</code></dt><dd><p>New width for the credible interval. This number should
be in the (0,1) interval.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianSynth-summarizeLift"></a>



<h4>Method <code>summarizeLift()</code></h4>

<p>returns descriptive statistics of the lift estimate.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$summarizeLift()</pre></div>


<hr>
<a id="method-bayesianSynth-effectPlot"></a>



<h4>Method <code>effectPlot()</code></h4>

<p>effect ggplot2 object that shows the
effect of the intervention over time.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$effectPlot(facet = TRUE, subset = NULL)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>facet</code></dt><dd><p>Boolean that is TRUE if we want to divide the plot for each
unit.</p>
</dd>
<dt><code>subset</code></dt><dd><p>Set of units to use in the effect plot.</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianSynth-placeboPlot"></a>



<h4>Method <code>placeboPlot()</code></h4>

<p>Plot placebo intervention.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$placeboPlot(periods, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>periods</code></dt><dd><p>Positive number of periods for the placebo intervention.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to <code><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling()</a></code>.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>ggplot2 object for placebo treatment effect.
</p>


<hr>
<a id="method-bayesianSynth-biasDraws"></a>



<h4>Method <code>biasDraws()</code></h4>

<p>Plots relative upper bias / tau for a time period (firstT, lastT).
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$biasDraws(small_bias = 0.3, firstT, lastT)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>small_bias</code></dt><dd><p>Threshold value for considering the bias &quot;small&quot;.</p>
</dd>
<dt><code>firstT</code></dt><dd><p>Start of the time period to compute relative bias over.
Must be after the intervention.</p>
</dd>
<dt><code>lastT</code></dt><dd><p>End of the time period to compute relative bias over.
Must be after the intervention.</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>vizdraw object with the posterior distribution of relative bias.
Bias is scaled by the time periods.
</p>


<hr>
<a id="method-bayesianSynth-liftDraws"></a>



<h4>Method <code>liftDraws()</code></h4>

<p>Plots lift.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$liftDraws(from, to, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>from</code></dt><dd><p>First period to consider when calculating lift. If infinite,
set to the time of the intervention.</p>
</dd>
<dt><code>to</code></dt><dd><p>Last period to consider when calculating lift. If infinite, set
to the last period.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to vizdraws::vizdraws().</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>vizdraws object with the posterior distribution of the lift.
</p>


<hr>
<a id="method-bayesianSynth-liftBias"></a>



<h4>Method <code>liftBias()</code></h4>

<p>Plot Bias magnitude in terms of lift for period (firstT, lastT)
pre_MADs / y0 relative to lift thresholds.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$liftBias(firstT, lastT, offset, ...)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>firstT</code></dt><dd><p>start of the time period to compute relative bias
over. They must be after the intervention.</p>
</dd>
<dt><code>lastT</code></dt><dd><p>end of the Time period to compute relative bias
over. They must be after the intervention.</p>
</dd>
<dt><code>offset</code></dt><dd><p>Target lift %.</p>
</dd>
<dt><code>...</code></dt><dd><p>other arguments passed to vizdraws::vizdraws().</p>
</dd>
</dl>

</div>


<hr>
<a id="method-bayesianSynth-weightDraws"></a>



<h4>Method <code>weightDraws()</code></h4>

<p>Plot implicit weight distribution across draws.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$weightDraws()</pre></div>



<h5>Returns</h5>

<p>ggplot object with weight distribution per unit.
</p>


<hr>
<a id="method-bayesianSynth-weightCorr"></a>



<h4>Method <code>weightCorr()</code></h4>

<p>Plots correlations between weights across draws.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$weightCorr()</pre></div>



<h5>Returns</h5>

<p>ggplot heatmap object with correlations.
</p>


<hr>
<a id="method-bayesianSynth-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>bayesianSynth$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>



<hr>
<h2 id='time_tiles'>Time Tiles Plot of Intervention Impact</h2><span id='topic+time_tiles'></span>

<h3>Description</h3>

<p>This function creates a time tiles plot visualizing when and which units are
affected by an intervention. Each tile represents a unit at a specific time point,
with the color indicating the treatment status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_tiles(data, time, id, status)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_tiles_+3A_data">data</code></td>
<td>
<p>A data frame containing the input data.</p>
</td></tr>
<tr><td><code id="time_tiles_+3A_time">time</code></td>
<td>
<p>The name of the time period variable (as a string).</p>
</td></tr>
<tr><td><code id="time_tiles_+3A_id">id</code></td>
<td>
<p>The name of the unit identifier variable (as a string).</p>
</td></tr>
<tr><td><code id="time_tiles_+3A_status">status</code></td>
<td>
<p>The name of the variable that identifies the treatment status (as a string).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object displaying the time tiles plot.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
