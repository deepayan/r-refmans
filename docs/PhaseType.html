<!DOCTYPE html><html><head><title>Help for package PhaseType</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PhaseType}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PhaseType-package'><p>Phase-type Distributions Toolbox</p></a></li>
<li><a href='#phtMCMC'><p>MCMC for dense Phase-type models</p></a></li>
<li><a href='#phtMCMC2'><p>MCMC for structured Phase-type models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Inference for Phase-Type Distributions</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to perform Bayesian inference on absorption time data for
             Phase-type distributions. The methods of Bladt et al (2003)
             &lt;<a href="https://doi.org/10.1080%2F03461230110106435">doi:10.1080/03461230110106435</a>&gt; and Aslett (2012)
             <a href="https://www.louisaslett.com/PhD_Thesis.pdf">https://www.louisaslett.com/PhD_Thesis.pdf</a> are provided.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.louisaslett.com/PhaseType/">https://www.louisaslett.com/PhaseType/</a>,
<a href="https://github.com/louisaslett/PhaseType">https://github.com/louisaslett/PhaseType</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/louisaslett/PhaseType/issues">https://github.com/louisaslett/PhaseType/issues</a></td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Louis Aslett &lt;louis.aslett@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Copyright:</td>
<td>The code in src/arms.c is slightly modified based on the
research paper implementation written by Wally Gilks. All other
code in all other files were written by the maintainer.</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, ggplot2, reshape</td>
</tr>
<tr>
<td>Suggests:</td>
<td>actuar</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-05 23:19:20 UTC; louis</td>
</tr>
<tr>
<td>Author:</td>
<td>Louis Aslett [aut, cre],
  Wally Gilks [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-07 15:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='PhaseType-package'>Phase-type Distributions Toolbox</h2><span id='topic+PhaseType-package'></span><span id='topic+PhaseType'></span>

<h3>Description</h3>

<p>A collection of tools for working with Phase-type Distributions, including sampling methods and both frequentist and Bayesian inference.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PhaseType</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.2.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2011-10-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>





<h3>Author(s)</h3>

<p>Louis J. M. Aslett, <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> (<a href="https://www.louisaslett.com">https://www.louisaslett.com</a>)
</p>


<h3>References</h3>

<p>Aslett, L. J. M. (2012), MCMC for Inference on Phase-type and Masked System Lifetime Models. Ph.D. thesis, Trinity College Dublin..
</p>
<p>Bladt, M., Gonzalez, A. &amp; Lauritzen, S. L. (2003), &lsquo;The estimation of phase-type related functionals using Markov chain Monte Carlo methods&rsquo;, <em>Scandinavian Journal of Statistics</em> <b>2003</b>(4), 280-300.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(actuar)
# Define the S matrix (columnwise)
S &lt;- matrix(c(-3.6, 9.5, 9.5, 1.8, -11.3, 0, 1.8, 0, -11.3), 3)

# Define starting state distribution
pi &lt;- c(1, 0, 0)

# Generate 50 random absorption times from the Phase-type with subgenerator S
# and starting distribution pi, which we will try to infer next
x &lt;- rphtype(50, pi, S)


library(PhaseType)
# FIRST: descriptive model fit (Bladt et al. 2003)
# Prior on starting state
dirpi &lt;- c(1, 0, 0)

# Gamma prior: shape hyperparameters (one per matrix element, columnwise)
nu &lt;- c(24, 24, 1, 180, 1, 24, 180, 1, 24)

# Gamma prior: reciprocal scale hyperparameters (one per matrix row)
zeta &lt;- c(16, 16, 16)

# Define dimension of model to fit
n &lt;- 3

# Perform 20 MCMC iterations (fix inner Metropolis-Hastings to one iteration
# since starts in stationarity here).  Do more in practise!!
res1 &lt;- phtMCMC(x, n, dirpi, nu, zeta, 20, mhit=1)
print(res1)

plot(res1)



# SECOND: mechanistic model fit (Aslett and Wilson 2011)
# Prior on starting state
dirpi &lt;- c(1, 0, 0)

# Define the structure of the Phase-type generator
TT &lt;- matrix(c(0,"R","R",0,"F",0,0,0,"F",0,0,0,0,"F","F",0), 4)

# Gamma prior: shape hyperparameters (one per model parameter)
nu &lt;- list("R"=180, "F"=24)

# Gamma prior: reciprocal scale hyperparameters (one per model parameter)
zeta &lt;- c("R"=16,"F"=16)

# Perform 20 MCMC iterations.  Do more in practise!!
res2 &lt;- phtMCMC2(x, TT, dirpi, nu, zeta, 20)
print(res2)

plot(res2)

</code></pre>

<hr>
<h2 id='phtMCMC'>MCMC for dense Phase-type models</h2><span id='topic+phtMCMC'></span>

<h3>Description</h3>

<p>Markov-chain Monte Carlo (MCMC) sampler for Bayesian inference on Phase-type models where data consist solely of time to entering the absorbing state (Bladt et al., 2003).
</p>
<p>Consider an m+1 state continuous-time Markov chain (CTMC) where the final (m+1 st) state is absorbing.  Then, given data consisting of first passage times to the last state, this function performs Bayesian inference on the rate parameters of the latent continuous-time Markov chain where the generator is assumed to be dense and all rates independent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phtMCMC(x, states, beta, nu, zeta, n, mhit=1, resume=NULL, silent=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phtMCMC_+3A_x">x</code></td>
<td>

<p>a vector of absorption times (or times at which censoring occurs).
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_states">states</code></td>
<td>

<p>an integer describing how many states (ie what dimension) the fitted Phase-type's generator should be.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_beta">beta</code></td>
<td>

<p>a vector of length m representing the Dirichlet prior on the starting state of the latent continuous-time Markov chain.  Entries should sum to 1.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_nu">nu</code></td>
<td>

<p>a list of the Gamma shape hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  These should match the dense generator matrix filled <b>column-wise</b>.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_zeta">zeta</code></td>
<td>

<p>a list of the Gamma reciprocal scale hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  These should match the dense generator matrix, with one zeta value <b>per row</b>.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_n">n</code></td>
<td>

<p>the total number of MCMC iterations to compute.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_mhit">mhit</code></td>
<td>

<p>the number of Metropolis-Hastings iterations to perform when sampling the latent process.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_resume">resume</code></td>
<td>

<p><code>NULL</code> indicates a new chain is to be sampled.  Otherwise, passing in an object of class <code>phtMCMC</code> (as returned by a call to this function) picks up a previously run MCMC chain at its end an continues for another <code>n</code> iterations.
</p>
</td></tr>
<tr><td><code id="phtMCMC_+3A_silent">silent</code></td>
<td>

<p>setting to <code>TRUE</code> suppresses the feedback about current iteration.  Highly recommended for batch files or else output fills with unnecessary iteration updates.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Usage of this function effectively involves specification of the number of states for the CTMC generator matrix, the parameter priors in Gamma form and providing absorption time data.
</p>
<p>If you want to specify structure on your generator (for example, to model a stochastic process about which some underlying mechanism is known), then consider using <code><a href="#topic+phtMCMC2">phtMCMC2</a></code> instead.  This function is best illustrated by the example below which is <a href="https://www.louisaslett.com/PhaseType/">more fully discussed on this webpage</a>.
</p>


<h3>Value</h3>

<p><code>phtMCMC</code> returns an object of class <code>"phtMCMC"</code>.
</p>
<p>An object of class <code>"phtMCMC"</code> is a list containing at least the following components:
</p>
<table>
<tr><td><code>samples</code></td>
<td>
<p>an object of class <code>"mcmc"</code> containing the MCMC samples for each parameter in the model.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a vector containing the original data used in the inference.</p>
</td></tr>
<tr><td><code>vars</code></td>
<td>
<p>a list of the distinct variable names in the CTMC generator.</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>the naming scheme for the generator which was fitted.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>the Dirichlet prior probability mass function on the starting states.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>a list of the prior nu hyper-parameters used when phtMCMC2 was called.</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>
<p>a list of the prior zeta hyper-parameters used when phtMCMC2 was called.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations contained in the object.</p>
</td></tr>
<tr><td><code>MHit</code></td>
<td>
<p>the number of iterations used if <code>method="MHRS"</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please feel free to email <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> with any queries or if you encounter errors when running this function.
</p>


<h3>Author(s)</h3>

<p>Louis J.M. Aslett <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> (<a href="https://www.louisaslett.com/">https://www.louisaslett.com/</a>)
</p>


<h3>References</h3>

<p>Bladt, M., Gonzalez, A. and Lauritzen, S. L. (2003), &lsquo;The estimation of Phase-type related functionals using Markov chain Monte Carlo methods&rsquo;, <em>Scandinavian Actuarial Journal</em> 2003(4), 280-300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phtMCMC2">phtMCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some pre-simulated absorption times
x &lt;- c(1.45353415045187, 1.85349532001349, 2.01084961814576, 0.505725921290172,
1.56252630012213, 3.41158665930278, 1.52674487509487, 4.3428662377235,
8.03208018151311, 2.41746547476986, 0.38828086509283, 2.61513815012196,
3.39148865480856, 1.82705817807965, 1.42090953713845, 0.851438991331866,
0.0178808867191894, 0.632198596390046, 0.959910259815998, 1.83344199966323)

# Prior on starting state
dirpi &lt;- c(1, 0, 0)
# Gamma prior: shape hyperparameters (one per matrix element, columnwise)
nu &lt;- c(24, 24, 1, 180, 1, 24, 180, 1, 24)
# Gamma prior: reciprocal scale hyperparameters (one per matrix row)
zeta &lt;- c(16, 16, 16)
# Define dimension of model to fit
n &lt;- 3
# Perform 20 MCMC iterations (fix inner Metropolis-Hastings to one iteration
# since starts in stationarity here).  Do more in practice!
res &lt;- phtMCMC(x, n, dirpi, nu, zeta, 6, mhit=1)
print(res)

plot(res)

</code></pre>

<hr>
<h2 id='phtMCMC2'>MCMC for structured Phase-type models</h2><span id='topic+phtMCMC2'></span>

<h3>Description</h3>

<p>Markov-chain Monte Carlo (MCMC) sampler for Bayesian inference on Phase-type models where data consist solely of time to entering the absorbing state (Aslett and Wilson, 2011, and Aslett, 2012).
</p>
<p>Consider an m+1 state continuous-time Markov chain (CTMC) where the final (m+1 st) state is absorbing.  Then, given data consisting of first passage times to the last state, this function performs Bayesian inference on the rate parameters of the latent continuous-time Markov chain where the generator has some fixed structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phtMCMC2(x, TT, beta, nu, zeta, n, censored=rep(FALSE, length(x)),
         C=matrix(1.0, nrow=dim(TT)[1], ncol=dim(TT)[2]), method="ECS", mhit=1,
         resume=NULL, silent=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phtMCMC2_+3A_x">x</code></td>
<td>

<p>a vector of absorption times (or times at which censoring occurs).
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_tt">TT</code></td>
<td>

<p>a matrix describing the structure of the Phase-type distribution to be used in the inference.  Each element of the matrix should either be a string for the variable name, or zero to indicate the transition there is prohibited.  See Details and Examples sections below.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_beta">beta</code></td>
<td>

<p>a vector of length m representing the Dirichlet prior on the starting state of the latent continuous-time Markov chain.  Entries should sum to 1.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_nu">nu</code></td>
<td>

<p>a list of the Gamma shape hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  The <code>tag = value</code> arguments to the list creation should be such that <code>tag</code> matches the parameter name given in <code>TT</code> and <code>value</code> is the numeric value of the hyper-parameter.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_zeta">zeta</code></td>
<td>

<p>a list of the Gamma reciprocal scale hyper-parameters for the prior of each parameter in the continuous-time Markov chain.  The <code>tag = value</code> arguments to the list creation should be such that <code>tag</code> matches the parameter name given in <code>TT</code> and <code>value</code> is the numeric value of the hyper-parameter.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_n">n</code></td>
<td>

<p>the total number of MCMC iterations to compute.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_censored">censored</code></td>
<td>

<p>a vector of <code>TRUE/FALSE</code>s of the same length as <code>x</code> indicating whether the corresponding observation is censored.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_c">C</code></td>
<td>

<p>a numeric matrix of the same dimensions as <code>TT</code> which specifies any constant scalar multiples of the parameters in <code>TT</code>.  Entries must be non-negative.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_method">method</code></td>
<td>

<p>the sampling method to use for the latent stochastic process:
</p>
<p><code>method="ECS"</code> is Exact Conditional Sampling as described in Aslett and Wilson (2011);
</p>
<p><code>method="MHRS"</code> is Metropolis-Hastings + Rejection Sampling as in the original work of Bladt et al. (2003).

</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_mhit">mhit</code></td>
<td>

<p>the number of Metropolis-Hastings iterations to perform when sampling the latent process.  Ignored unless <code>method="MHRS"</code>.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_resume">resume</code></td>
<td>

<p><code>NULL</code> indicates a new chain is to be sampled.  Otherwise, passing in an object of class <code>phtMCMC</code> (as returned by a call to this function) picks up a previously run MCMC chain at its end an continues for another <code>n</code> iterations.
</p>
</td></tr>
<tr><td><code id="phtMCMC2_+3A_silent">silent</code></td>
<td>

<p>setting to <code>TRUE</code> suppresses the feedback about current iteration.  Highly recommended for batch files or else output fills with unnecessary iteration updates.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Usage of this function effectively involves specification of the structure of an absorbing CTMC generator matrix, the parameter priors in Gamma form and providing absorption time data.
</p>
<p>The generator matrix <code>TT</code> is specified as a matrix containing strings (ie text) naming the parameters in each element of the matrix.  This allows constraints to be imposed (see Aslett &amp; Wilson, 2011) and is best illustrated by the example below which is <a href="https://www.louisaslett.com/PhaseType/">more fully discussed on this webpage</a>.
</p>


<h3>Value</h3>

<p><code>phtMCMC2</code> returns an object of class <code>"phtMCMC"</code>.
</p>
<p>An object of class <code>"phtMCMC"</code> is a list containing at least the following components:
</p>
<table>
<tr><td><code>samples</code></td>
<td>
<p>an object of class <code>"mcmc"</code> containing the MCMC samples for each parameter in the model.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>a vector containing the original data used in the inference.</p>
</td></tr>
<tr><td><code>vars</code></td>
<td>
<p>a list of the distinct variable names detected in the CTMC generator.</p>
</td></tr>
<tr><td><code>TT</code></td>
<td>
<p>the original CTMC generator passed in when phtMCMC2 was called.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>the Dirichlet prior probability mass function on the starting states.</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>a list of the prior nu hyper-parameters used when phtMCMC2 was called.</p>
</td></tr>
<tr><td><code>zeta</code></td>
<td>
<p>a list of the prior zeta hyper-parameters used when phtMCMC2 was called.</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p>the number of MCMC iterations contained in the object.</p>
</td></tr>
<tr><td><code>censored</code></td>
<td>
<p>the original vector of <code>TRUE/FALSE</code>s of the same length as <code>x</code> indicating whether the corresponding observations are censored.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>a string indicating the method used for sampling of the latent process</p>
</td></tr>
<tr><td><code>MHit</code></td>
<td>
<p>the number of iterations used if <code>method="MHRS"</code></p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please feel free to email <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> with any queries or if you encounter errors when running this function.
</p>


<h3>Author(s)</h3>

<p>Louis J.M. Aslett <a href="mailto:louis.aslett@durham.ac.uk">louis.aslett@durham.ac.uk</a> (<a href="https://www.louisaslett.com/">https://www.louisaslett.com/</a>)
</p>


<h3>References</h3>

<p>Aslett, L. J. M. and Wilson, S. P. (2011), &lsquo;Markov chain Monte Carlo for inference on Phase-type models&rsquo;, ISI 2011 Proceedings, (<a href="https://www.louisaslett.com/Proceedings/ISI_2011.html">https://www.louisaslett.com/Proceedings/ISI_2011.html</a>).
</p>
<p>Aslett, L. J. M. (2012), &lsquo;MCMC for Inference on Phase-type and Masked System Lifetime Models&rsquo;, PhD Thesis, Trinity College Dublin (<a href="https://www.louisaslett.com/PhD_Thesis.html">https://www.louisaslett.com/PhD_Thesis.html</a>).
</p>
<p>Bladt, M., Gonzalez, A. and Lauritzen, S. L. (2003), &lsquo;The estimation of Phase-type related functionals using Markov chain Monte Carlo methods&rsquo;, <em>Scandinavian Actuarial Journal</em> 2003(4), 280-300.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phtMCMC">phtMCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some pre-simulated absorption times
x &lt;- c(1.45353415045187, 1.85349532001349, 2.01084961814576, 0.505725921290172,
1.56252630012213, 3.41158665930278, 1.52674487509487, 4.3428662377235,
8.03208018151311, 2.41746547476986, 0.38828086509283, 2.61513815012196,
3.39148865480856, 1.82705817807965, 1.42090953713845, 0.851438991331866,
0.0178808867191894, 0.632198596390046, 0.959910259815998, 1.83344199966323)

# Prior on starting state
dirpi &lt;- c(1, 0, 0)
# Define the structure of the Phase-type generator
TT &lt;- matrix(c(0,"R","R",0,"F",0,0,0,"F",0,0,0,0,"F","F",0), 4)
# Gamma prior: shape hyperparameters (one per model parameter)
nu &lt;- list("R"=180, "F"=24)
# Gamma prior: reciprocal scale hyperparameters (one per model parameter)
zeta &lt;- c("R"=16,"F"=16)
# Perform 20 MCMC iterations.  Do more in practice!!
res &lt;- phtMCMC2(x, TT, dirpi, nu, zeta, 20)
print(res)

plot(res)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
