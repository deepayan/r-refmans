<!DOCTYPE html><html lang="en"><head><title>Help for package jarbes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {jarbes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#b3lmeta'><p>Bayesian Meta-Analysis for Combining Studies</p></a></li>
<li><a href='#bcdpmeta'><p>Bias Corrected Meta-Analysis with Dirichlet Process Priors</p></a></li>
<li><a href='#bcmeta'><p>Bias-Corrected Meta-Analysis for Combining Studies of Different Types and Quality</p></a></li>
<li><a href='#bcmixmeta'><p>Bias Corrected Meta-Analysis with Dirichlet Mixture Process Priors for the biased component</p></a></li>
<li><a href='#bmeta'><p>Bayesian Meta-Analysis for Combining Studies</p></a></li>
<li><a href='#covid19'><p>Meta-analysis: Observational studies assessing the impact of</p>
risk factors on the severity and mortality of COVID-19 cases</a></li>
<li><a href='#diagnostic'><p>Generic diagnostic function.</p></a></li>
<li><a href='#diagnostic.b3lmeta'><p>Diagnostic function for b3lmeta object in jarbes</p></a></li>
<li><a href='#diagnostic.bcdpmeta'><p>Diagnostic function for bcdpmeta object in jarbes</p></a></li>
<li><a href='#diagnostic.bcmeta'><p>Diagnostic function for bcmeta object in jarbes</p></a></li>
<li><a href='#diagnostic.bcmixmeta'><p>Diagnostic function for bcmixmeta object in jarbes</p></a></li>
<li><a href='#diagnostic.bmeta'><p>Diagnostic function for bmeta object in jarbes</p></a></li>
<li><a href='#diagnostic.hmr'><p>Diagnostic function for hmr object in jarbes</p></a></li>
<li><a href='#diagnostic.metarisk'><p>Diagnostic function for metarisk object in jarbes</p></a></li>
<li><a href='#dpmeta'><p>Bayesian Meta-Analysis with Dirichlet Process Priors</p></a></li>
<li><a href='#dpmetareg'><p>Bayesian Meta-Analysis with Dirichlet Process Priors</p></a></li>
<li><a href='#dpmmeta'><p>Bayesian Meta-Analysis with Dirichlet Process Mixtures Priors</p></a></li>
<li><a href='#effect'><p>Generic effect function.</p></a></li>
<li><a href='#effect.hmr'><p>Posterior distribution of Effectiveness for a subgroup of patients</p></a></li>
<li><a href='#healing'><p>Efficacy of diabetic foot healing using adjuvant treatments</p></a></li>
<li><a href='#healingipd'><p>Individual participant data for diabetic patients</p></a></li>
<li><a href='#hips'><p>Meta-analysis:</p></a></li>
<li><a href='#hmr'><p>Bayesian meta-analysis to combine aggregated and individual participant data for cross design synthesis.</p></a></li>
<li><a href='#metarisk'><p>Bayesian meta-analysis for using baseline risk adjustment</p></a></li>
<li><a href='#plot.b3lmeta'><p>Generic plot function for b3lmeta object in jarbes.</p></a></li>
<li><a href='#plot.bcdpmeta'><p>Generic plot function for bcdpmeta object in jarbes.</p></a></li>
<li><a href='#plot.bcmeta'><p>Generic plot function for bcmeta object in jarbes.</p></a></li>
<li><a href='#plot.bmeta'><p>Generic plot function for bmeta object in jarbes.</p></a></li>
<li><a href='#plot.dpmeta'><p>Generic plot function for bmeta object in jarbes.</p></a></li>
<li><a href='#plot.dpmmeta'><p>Generic plot function for dpmeta object in jarbes.</p></a></li>
<li><a href='#plot.hmr'><p>Generic plot function for hmr object in jarbes.</p></a></li>
<li><a href='#plot.metarisk'><p>Generic plot function for metarisk object in jarbes.</p></a></li>
<li><a href='#ppvcap'><p>Efficacy of Pneumococcal Polysaccharide Vaccine in Preventing Community Acquired Pneumonia</p></a></li>
<li><a href='#ppvipd'><p>Efficacy of Pneumococcal Polysaccharide Vaccine in Preventing Invasive Pneumococcal Disease</p></a></li>
<li><a href='#print.b3lmeta'><p>Generic print function for b3lmeta object in jarbes.</p></a></li>
<li><a href='#print.bcdpmeta'><p>Generic print function for bcdpmeta object in jarbes.</p></a></li>
<li><a href='#print.bcmeta'><p>Generic print function for bcmeta object in jarbes.</p></a></li>
<li><a href='#print.bcmixmeta'><p>Generic print function for bcmixmeta object in jarbes.</p></a></li>
<li><a href='#print.bmeta'><p>Generic print function for bcmeta object in jarbes.</p></a></li>
<li><a href='#print.dpmeta'><p>Generic print function for dpmeta object in jarbes.</p></a></li>
<li><a href='#print.dpmetareg'><p>Generic print function for dpmeta object in jarbes.</p></a></li>
<li><a href='#print.dpmmeta'><p>Generic print function for dpmmeta object in jarbes.</p></a></li>
<li><a href='#print.hmr'><p>Generic print function for hmr object in jarbes.</p></a></li>
<li><a href='#print.metarisk'><p>Generic print function for metarisk object in jarbes.</p></a></li>
<li><a href='#stemcells'><p>Meta-analysis of 31 randomized controled trials (RCTs) with reported discrepancies</p></a></li>
<li><a href='#summary.b3lmeta'><p>Generic summary function for bmeta object in jarbes</p></a></li>
<li><a href='#summary.bcdpmeta'><p>Generic summary function for bcdpmeta object in jarbes</p></a></li>
<li><a href='#summary.bcmeta'><p>Generic summary function for bcmeta object in jarbes</p></a></li>
<li><a href='#summary.bmeta'><p>Generic summary function for bmeta object in jarbes</p></a></li>
<li><a href='#summary.dpmeta'><p>Generic summary function for dpmmeta object in jarbes</p></a></li>
<li><a href='#summary.dpmmeta'><p>Generic summary function for dpmmeta object in jarbes</p></a></li>
<li><a href='#summary.hmr'><p>Generic summary function for hmr object in jarbes</p></a></li>
<li><a href='#summary.metarisk'><p>Generic summary function for metarisk object in jarbes</p></a></li>
<li><a href='#trisomy21'><p>Meta-analysis: Observational studies assessing the relationship of</p>
a positive ICPC (Isolated Choroid Plexus Cyst) on Trisomy 21</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Just a Rather Bayesian Evidence Synthesis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-05</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>rjags, R2jags, stats, graphics, ggplot2, ggExtra, MASS, grid,
gridExtra, mcmcplots, bookdown, tidyr, kableExtra, GGally, qpdf</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS (&gt;= 4.3.0) (see
http://mcmc-jags.sourceforge.net)</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a new class of Bayesian meta-analysis models that incorporates a model for internal and external validity bias. In this way, it is possible to combine studies of diverse quality and different types. For example, we can combine the results of randomized control trials (RCTs) with the results of observational studies (OS). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-05 15:44:33 UTC; User</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Author:</td>
<td>Pablo Emilio Verde [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pablo Emilio Verde &lt;pabloemilio.verde@hhu.de&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-05 16:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='b3lmeta'>Bayesian Meta-Analysis for Combining Studies</h2><span id='topic+b3lmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b3lmeta(
  data,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  scale.sigma.within = 0.5,
  df.scale.within = 1,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="b3lmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least three columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.
3) design = indicates study type or clustering subgroup.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the overall mean parameter mu.0 (mean across designs), default value is 0.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of mu.0 (mean across designs), the default value is 10.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between study types. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between study types.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_scale.sigma.within">scale.sigma.within</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision within study types. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_df.scale.within">df.scale.within</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision within study types.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="b3lmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)



## End(Not run)

</code></pre>

<hr>
<h2 id='bcdpmeta'>Bias Corrected Meta-Analysis with Dirichlet Process Priors</h2><span id='topic+bcdpmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis with DP as random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcdpmeta(
  data,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  B.lower = 0,
  B.upper = 10,
  a.0 = 1,
  a.1 = 1,
  alpha.0 = 0.03,
  alpha.1 = 10,
  K = 30,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcdpmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the mean of the base distribution default value is mean.mu.0 = 0.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of the base distribution, the default value is 10.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_b.lower">B.lower</code></td>
<td>
<p>Lower bound of the bias parameter B, the default value is 0.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_b.upper">B.upper</code></td>
<td>
<p>Upper bound of the bias parameter B, the default value is 10.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_a.0">a.0</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a0 = 1.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_a.1">a.1</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a1 = 1.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_alpha.0">alpha.0</code></td>
<td>
<p>Lower bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.0 = 0.03.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_alpha.1">alpha.1</code></td>
<td>
<p>Upper bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.1 = 10.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters in the DPM, default value is K = 30.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="bcdpmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcdpmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bcdpmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)


# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

bm1 = bcdpmeta(stemcells)
summary(bm1)


## End(Not run)

</code></pre>

<hr>
<h2 id='bcmeta'>Bias-Corrected Meta-Analysis for Combining Studies of Different Types and Quality</h2><span id='topic+bcmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis to jointly
combine different types of studies. The random-effects follows a finite
mixture of normal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcmeta(
  data,
  mean.mu = 0,
  sd.mu = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  B.lower = 0,
  B.upper = 10,
  a.0 = 1,
  a.1 = 1,
  nu = 0.5,
  nu.estimate = FALSE,
  b.0 = 1,
  b.1 = 2,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_mean.mu">mean.mu</code></td>
<td>
<p>Prior mean of the overall mean parameter mu, default value is 0.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_sd.mu">sd.mu</code></td>
<td>
<p>Prior standard deviation of mu, the default value is 10.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_b.lower">B.lower</code></td>
<td>
<p>Lower bound of the bias parameter B, the default value is 0.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_b.upper">B.upper</code></td>
<td>
<p>Upper bound of the bias parameter B, the default value is 10.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_a.0">a.0</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a0 = 1.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_a.1">a.1</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a1 = 1.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nu">nu</code></td>
<td>
<p>Parameter for the Beta distribution for the quality weights. The default value is nu = 0.5.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nu.estimate">nu.estimate</code></td>
<td>
<p>If TRUE, then we estimate nu from the data.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_b.0">b.0</code></td>
<td>
<p>If nu.estimate = TRUE, this parameter is the shape parameter of the prior Gamma distribution for nu.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_b.1">b.1</code></td>
<td>
<p>If nu.estimate = TRUE, this parameter is the rate parameter of the prior Gamma distribution for nu.
Note that E(nu) = b.0/b.1 and we need to choose b.0 &lt;&lt; b.1.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, defualt is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discared for burnin period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="bcmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bcmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P. E. (2017) Two Examples of Bayesian Evidence Synthesis with the Hierarchical Meta-Regression Approach. Chap.9, pag 189-206. Bayesian Inference, ed. Tejedor, Javier Prieto. InTech.
</p>
<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)

# Example ppvipd data

data(ppvipd)



## End(Not run)

</code></pre>

<hr>
<h2 id='bcmixmeta'>Bias Corrected Meta-Analysis with Dirichlet Mixture Process Priors for the biased component</h2><span id='topic+bcmixmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis with DPM as random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcmixmeta(
  data,
  x = NULL,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  scale.sigma.beta = 0.5,
  df.scale.beta = 1,
  B.lower = -15,
  B.upper = 15,
  a.0 = 0.5,
  a.1 = 1,
  alpha.0 = 0.03,
  alpha.1 = 2,
  K = 10,
  bilateral.bias = FALSE,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcmixmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_x">x</code></td>
<td>
<p>a covariate to perform meta-regression.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the mean of the base distribution default value is mean.mu.0 = 0.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of the base distribution, the default value is 10^-6.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_scale.sigma.beta">scale.sigma.beta</code></td>
<td>
<p>Prior scale parameter for the scale.gamma distribution for the
precision between study biases.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_df.scale.beta">df.scale.beta</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between
study biases. The default value is 1, which results in a Half Cauchy distribution
for the standard deviation between biases.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_b.lower">B.lower</code></td>
<td>
<p>Lower bound of the bias parameter B, the default value is -15.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_b.upper">B.upper</code></td>
<td>
<p>Upper bound of the bias parameter B, the default value is 15.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_a.0">a.0</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a0 = 0.5.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_a.1">a.1</code></td>
<td>
<p>Parameter for the prior Beta distribution for the probability of bias. Default value is a1 = 1.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_alpha.0">alpha.0</code></td>
<td>
<p>Lower bound of the uniform prior for the concentration parameter for the DP,
the default value is 0.5.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_alpha.1">alpha.1</code></td>
<td>
<p>Upper bound of the uniform prior for the concentration parameter for the DP,
the default value depends on the sample size, see the example below. We give as
working value alpha.1 = 2</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters in the DP, the default value depends on alpha.1, see the
example below. We give as working value K = 10.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_bilateral.bias">bilateral.bias</code></td>
<td>
<p>Experimental option, which indicates if bias could be to the left and
to the right of the model of interest. If bilateral.bias==TRUE,
then the function generates three mean and sorts the means in two
groups: mean_bias_left, mean_theta, mean_bias_right.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="bcmixmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmixmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bcmixmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. and Rosner, G. L. (2024) A Bias-Corrected Bayesian Nonparamteric Model for Combining
Studies with Varying Quality in Meta-Analysis. Biometrical Journal; (under revision).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)


# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

# Beta(0.5, 1)
a.0 = 0.5
a.1 = 1

# alpha.max
 N = dim(stemcells)[1]
 alpha.max = 1/5 *((N-1)*a.0 - a.1)/(a.0 + a.1)

alpha.max

# K.max
K.max = 1 + 5*alpha.max
K.max = round(K.max)

K.max

set.seed(20233)

bcmix.2.stemcell = bcmixmeta(stemcells,
                            mean.mu.0=0, sd.mu.0=100,
                            B.lower = -15,
                            B.upper = 15,
                            alpha.0 = 0.5,
                            alpha.1 = alpha.max,
                            a.0 = a.0,
                            a.1 = a.1,
                            K = K.max,
                            sort.priors = FALSE,
                            df.scale.between = 1,
                            scale.sigma.between = 0.5,
                            nr.chains = 4,
                            nr.iterations = 50000,
                            nr.adapt = 1000,
                            nr.burnin = 10000,
                            nr.thin = 4)


 diagnostic(bcmix.2.stemcell, y.lim = c(-1, 15), title.plot = "Default priors")


 bcmix.2.stemcell.mcmc &lt;- as.mcmc(bcmix.1.stemcell$BUGSoutput$sims.matrix)


theta.names &lt;- paste(paste("theta[",1:31, sep=""),"]", sep="")
theta.b.names &lt;- paste(paste("theta.bias[",1:31, sep=""),"]", sep="")

theta.b.greek.names &lt;- paste(paste("theta[",1:31, sep=""),"]^B", sep="")
theta.greek.names &lt;- paste(paste("theta[",1:31, sep=""),"]", sep="")


caterplot(bcmix.2.stemcell.mcmc,
         parms = theta.names,               # theta
         labels = theta.greek.names,
         greek = T,
         labels.loc="axis", cex =0.7,
         col = "black",
         style = "plain",
         reorder = F,
         val.lim =c(-6, 16),
         quantiles = list(outer=c(0.05,0.95),inner=c(0.16,0.84)),
         x.lab = "Effect: mean difference"
)
title( "95% posterior intervals of studies' effects")
caterplot(bcmix.2.stemcell.mcmc,
         parms = theta.b.names,             # theta.bias
         labels = theta.greek.names,
         greek = T,
         labels.loc="no",
         cex = 0.7,
         col = "grey",
         style = "plain", reorder = F,
         val.lim =c(-6, 16),
         quantiles = list(outer=c(0.025,0.975),inner=c(0.16,0.84)),
         add = TRUE,
         collapse=TRUE, cat.shift= -0.5,
)

attach.jags(bcmix.2.stemcell, overwrite = TRUE)
abline(v=mean(mu.0), lwd =2, lty =2)

legend(9, 20, legend = c("bias corrected", "biased"),
     lty = c(1,1), lwd = c(2,2), col = c("black", "grey"))



## End(Not run)

</code></pre>

<hr>
<h2 id='bmeta'>Bayesian Meta-Analysis for Combining Studies</h2><span id='topic+bmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bmeta(
  data,
  mean.mu = 0,
  sd.mu = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1,
  be.quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_mean.mu">mean.mu</code></td>
<td>
<p>Prior mean of the overall mean parameter mu, default value is 0.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_sd.mu">sd.mu</code></td>
<td>
<p>Prior standard deviation of mu, the default value is 10.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
<tr><td><code id="bmeta_+3A_be.quiet">be.quiet</code></td>
<td>
<p>Do not print warning message if the model does not adapt. The default value is FALSE. If you are not sure about the adaptation period choose be.quiet=TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)

#Example: ppvipd

data(ppvipd)
bm1 = bmeta(ppvipd)

summary(bm1)
plot(bm1, x.lim = c(-3, 1), y.lim = c(0, 3))

diagnostic(bm1, study.names = ppvipd$name, post.p.value.cut = 0.1,
           lwd.forest = 1, shape.forest = 4)

# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

bm2 = bmeta(stemcells)
summary(bm2)
plot(bm2, x.lim = c(-1, 7), y.lim = c(0, 1))

diagnostic(bm2, study.names = stemcells$trial,
           post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

diagnostic(bm2, post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

## End(Not run)

</code></pre>

<hr>
<h2 id='covid19'>Meta-analysis: Observational studies assessing the impact of
risk factors on the severity and mortality of COVID-19 cases</h2><span id='topic+covid19'></span>

<h3>Description</h3>

<p>Meta-analysis of 40 Observational Studies from PubMed, Cocharane Library and SciELO databases
that assessed the impact of diabetes, hypertension, cardiovascular disease,
and the use of ACEI/ARB on severity and mortality of COVID-19 cases.
</p>


<h3>Format</h3>

<p>A dataframe with 89 rows and 12 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>author</dt><dd><p>Principal author and year of publication.</p>
</dd>
<dt>endpoint</dt><dd><p>Endoint: severity or mortality.</p>
</dd>
<dt>risk.factor</dt><dd><p>Possible risk factors: diabetes, hypertension, cardiovascular, ACE_ARB.</p>
</dd>
<dt>event.e</dt><dd><p>Number of events in the group with risk factor.</p>
</dd>
<dt>n.e</dt><dd><p>Number of patients in the group with risk factor.</p>
</dd>
<dt>event.c</dt><dd><p>Number of events in the group without risk factor.</p>
</dd>
<dt>n.c</dt><dd><p>Number of patients in the group with risk factor.</p>
</dd>
<dt>design</dt><dd><p>Study design: Case Series, Cross Sectional and Retrospective Cohort.</p>
</dd>
<dt>TE</dt><dd><p>Log Odds Ratio</p>
</dd>
<dt>seTE</dt><dd><p>Standard Error of the Log Odds Ratio</p>
</dd>
<dt>logitPc</dt><dd><p>Logit transformation of the proportion of events in the control group.</p>
</dd>
<dt>N</dt><dd><p>Total number of patients.</p>
</dd>
</dl>



<h3>Source</h3>

<p>de Almeida-Pititto, B., Dualib, P.M., Zajdenverg, L. et al. Severity and mortality of COVID 19 in patients with diabetes, hypertension and cardiovascular disease: a meta-analysis. Diabetol Metab Syndr 12, 75 (2020). https://doi.org/10.1186/s13098-020-00586-4
</p>

<hr>
<h2 id='diagnostic'>Generic diagnostic function.</h2><span id='topic+diagnostic'></span>

<h3>Description</h3>

<p>Generic diagnostic function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diagnostic(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic_+3A_object">object</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="diagnostic_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.b3lmeta'>Diagnostic function for b3lmeta object in jarbes</h2><span id='topic+diagnostic.b3lmeta'></span>

<h3>Description</h3>

<p>This function performers an approximated Bayesian cross-validation for a b3lmeta object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'b3lmeta'
diagnostic(
  object,
  post.p.value.cut = 0.05,
  study.names = NULL,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.b3lmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the function b3lmeta.</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_post.p.value.cut">post.p.value.cut</code></td>
<td>
<p>Posterior p-value cut point to assess outliers.</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.b3lmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.bcdpmeta'>Diagnostic function for bcdpmeta object in jarbes</h2><span id='topic+diagnostic.bcdpmeta'></span>

<h3>Description</h3>

<p>This function performers an approximated Bayesian cross-validation for a bcmeta object and specially designed diagnostics to detect the existence of a biased component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdpmeta'
diagnostic(
  object,
  post.p.value.cut = 0.05,
  study.names = NULL,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  bias.plot = TRUE,
  cross.val.plot = FALSE,
  level = c(0.5, 0.75, 0.95),
  x.lim = c(0, 1),
  y.lim = c(0, 10),
  x.lab = "P(Bias)",
  y.lab = "Mean Bias",
  title.plot = paste("Bias Diagnostics Contours (50%, 75% and 95%)"),
  kde2d.n = 25,
  marginals = TRUE,
  bin.hist = 30,
  color.line = "black",
  color.hist = "white",
  color.data.points = "black",
  alpha.data.points = 0.1,
  S = 5000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.bcdpmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the function b3lmeta.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_post.p.value.cut">post.p.value.cut</code></td>
<td>
<p>Posterior p-value cut point to assess outliers.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_bias.plot">bias.plot</code></td>
<td>
<p>Display the bias plot. The default is TRUE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_cross.val.plot">cross.val.plot</code></td>
<td>
<p>Display the cross validation plot. The default is FALSE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_level">level</code></td>
<td>
<p>Vector with the probability levels of the contour plot. The default values are: 0.5, 0.75, and 0.95.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the bias plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_kde2d.n">kde2d.n</code></td>
<td>
<p>The number of grid points in each direction for the non-parametric density estimation. The default is 25.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_marginals">marginals</code></td>
<td>
<p>If TRUE the marginal histograms of the posteriors are added to the plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_bin.hist">bin.hist</code></td>
<td>
<p>The number of bins in for the histograms. The default value is 30.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_color.line">color.line</code></td>
<td>
<p>The color of the contour lines. The default is &quot;black.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_color.hist">color.hist</code></td>
<td>
<p>The color of the histogram bars. The default is &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_color.data.points">color.data.points</code></td>
<td>
<p>The color of the data points. The default is &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_alpha.data.points">alpha.data.points</code></td>
<td>
<p>Transparency of the data points.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_s">S</code></td>
<td>
<p>The number of sample values from the joint posterior distribution used to approximate the contours. The default is S=5000.</p>
</td></tr>
<tr><td><code id="diagnostic.bcdpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.bcmeta'>Diagnostic function for bcmeta object in jarbes</h2><span id='topic+diagnostic.bcmeta'></span>

<h3>Description</h3>

<p>This function performers an approximated Bayesian cross-validation for a bcmeta object and specially designed diagnostics to detect the existence of a biased component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmeta'
diagnostic(
  object,
  post.p.value.cut = 0.05,
  study.names = NULL,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  bias.plot = TRUE,
  cross.val.plot = TRUE,
  level = c(0.5, 0.75, 0.95),
  x.lim = c(0, 1),
  y.lim = c(0, 10),
  x.lab = "P(Bias)",
  y.lab = "Mean Bias",
  title.plot = paste("Bias Diagnostics Contours (50%, 75% and 95%)"),
  kde2d.n = 25,
  marginals = TRUE,
  bin.hist = 30,
  color.line = "black",
  color.hist = "white",
  color.data.points = "black",
  alpha.data.points = 0.1,
  S = 5000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.bcmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the function b3lmeta.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_post.p.value.cut">post.p.value.cut</code></td>
<td>
<p>Posterior p-value cut point to assess outliers.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_bias.plot">bias.plot</code></td>
<td>
<p>Display the bias plot. The default is TRUE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_cross.val.plot">cross.val.plot</code></td>
<td>
<p>Display the cross validation plot. The default is TRUE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_level">level</code></td>
<td>
<p>Vector with the probability levels of the contour plot. The default values are: 0.5, 0.75, and 0.95.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the bias plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_kde2d.n">kde2d.n</code></td>
<td>
<p>The number of grid points in each direction for the non-parametric density estimation. The default is 25.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_marginals">marginals</code></td>
<td>
<p>If TRUE the marginal histograms of the posteriors are added to the plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_bin.hist">bin.hist</code></td>
<td>
<p>The number of bins in for the histograms. The default value is 30.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_color.line">color.line</code></td>
<td>
<p>The color of the contour lines. The default is &quot;black.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_color.hist">color.hist</code></td>
<td>
<p>The color of the histogram bars. The default is &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_color.data.points">color.data.points</code></td>
<td>
<p>The color of the data points. The default is &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_alpha.data.points">alpha.data.points</code></td>
<td>
<p>Transparency of the data points.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_s">S</code></td>
<td>
<p>The number of sample values from the joint posterior distribution used to approximate the contours. The default is S=5000.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.bcmixmeta'>Diagnostic function for bcmixmeta object in jarbes</h2><span id='topic+diagnostic.bcmixmeta'></span>

<h3>Description</h3>

<p>This function performers an approximated Bayesian cross-validation for a bcmeta object and specially designed diagnostics to detect the existence of a biased component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmixmeta'
diagnostic(
  object,
  post.p.value.cut = 0.05,
  study.names = NULL,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  bias.plot = TRUE,
  cross.val.plot = FALSE,
  level = c(0.5, 0.75, 0.95),
  x.lim = c(0, 1),
  y.lim = c(0, 10),
  x.lab = "P(Bias)",
  y.lab = "Mean Bias",
  title.plot = paste("Bias Diagnostics Contours (50%, 75% and 95%)"),
  kde2d.n = 25,
  marginals = TRUE,
  bin.hist = 30,
  color.line = "black",
  color.hist = "white",
  color.data.points = "black",
  alpha.data.points = 0.1,
  S = 5000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.bcmixmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the function b3lmeta.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_post.p.value.cut">post.p.value.cut</code></td>
<td>
<p>Posterior p-value cut point to assess outliers.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_bias.plot">bias.plot</code></td>
<td>
<p>Display the bias plot. The default is TRUE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_cross.val.plot">cross.val.plot</code></td>
<td>
<p>Display the cross validation plot. The default is FALSE.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_level">level</code></td>
<td>
<p>Vector with the probability levels of the contour plot. The default values are: 0.5, 0.75, and 0.95.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the bias plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_kde2d.n">kde2d.n</code></td>
<td>
<p>The number of grid points in each direction for the non-parametric density estimation. The default is 25.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_marginals">marginals</code></td>
<td>
<p>If TRUE the marginal histograms of the posteriors are added to the plot.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_bin.hist">bin.hist</code></td>
<td>
<p>The number of bins in for the histograms. The default value is 30.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_color.line">color.line</code></td>
<td>
<p>The color of the contour lines. The default is &quot;black.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_color.hist">color.hist</code></td>
<td>
<p>The color of the histogram bars. The default is &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_color.data.points">color.data.points</code></td>
<td>
<p>The color of the data points. The default is &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_alpha.data.points">alpha.data.points</code></td>
<td>
<p>Transparency of the data points.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_s">S</code></td>
<td>
<p>The number of sample values from the joint posterior distribution used to approximate the contours. The default is S=5000.</p>
</td></tr>
<tr><td><code id="diagnostic.bcmixmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.bmeta'>Diagnostic function for bmeta object in jarbes</h2><span id='topic+diagnostic.bmeta'></span>

<h3>Description</h3>

<p>This function performers an approximated Bayesian cross-validation for a b3lmeta object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmeta'
diagnostic(
  object,
  post.p.value.cut = 0.05,
  median.w = 1.5,
  study.names = NULL,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.bmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the function bmeta.</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_post.p.value.cut">post.p.value.cut</code></td>
<td>
<p>Posterior p-value cut point to assess outliers.</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_median.w">median.w</code></td>
<td>
<p>Change color if median of a weight &gt; median.w. The default value is 1.5.</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.bmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.hmr'>Diagnostic function for hmr object in jarbes</h2><span id='topic+diagnostic.hmr'></span>

<h3>Description</h3>

<p>This function performers a specially designed diagnostic for a hmr object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hmr'
diagnostic(
  object,
  median.w = 1.5,
  study.names,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  mu.phi = TRUE,
  mu.phi.x.lim.low = -10,
  mu.phi.x.lim.up = 10,
  colour.hist.mu.phi = "royalblue",
  colour.prior.mu.phi = "black",
  colour.posterior.mu.phi = "blue",
  title.plot.mu.phi = "Prior-to-Posterior Sensitivity",
  title.plot.weights = "Outlier Detection",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.hmr_+3A_object">object</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_median.w">median.w</code></td>
<td>
<p>Change colour if median of a weight &gt; median.w. The default value is 1.5.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_mu.phi">mu.phi</code></td>
<td>
<p>Prior-to-posterior sensitivity analysis of mu.phi. Default value is TRUE.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_mu.phi.x.lim.low">mu.phi.x.lim.low</code></td>
<td>
<p>Lower limit of the prior to posterior plot for mu.phi</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_mu.phi.x.lim.up">mu.phi.x.lim.up</code></td>
<td>
<p>Upper limit of the prior to posterior plot for mu.phi</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_colour.hist.mu.phi">colour.hist.mu.phi</code></td>
<td>
<p>colour of the posterior mu.phi histogram</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_colour.prior.mu.phi">colour.prior.mu.phi</code></td>
<td>
<p>colour of the prior of mu.phi</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_colour.posterior.mu.phi">colour.posterior.mu.phi</code></td>
<td>
<p>colour of the posterior of mu.phi</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_title.plot.mu.phi">title.plot.mu.phi</code></td>
<td>
<p>Text for the title in the mu phi plot.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_title.plot.weights">title.plot.weights</code></td>
<td>
<p>Text for the title of the posterior weights.</p>
</td></tr>
<tr><td><code id="diagnostic.hmr_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='diagnostic.metarisk'>Diagnostic function for metarisk object in jarbes</h2><span id='topic+diagnostic.metarisk'></span>

<h3>Description</h3>

<p>This function performers a specially designed diagnostic for a metarisk object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metarisk'
diagnostic(
  object,
  median.w = 1.5,
  study.names,
  size.forest = 0.4,
  lwd.forest = 0.2,
  shape.forest = 23,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diagnostic.metarisk_+3A_object">object</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_median.w">median.w</code></td>
<td>
<p>Change color if median of a weight &gt; median.w. The default value is 1.5.</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_study.names">study.names</code></td>
<td>
<p>Character vector containing names of the studies used.</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_size.forest">size.forest</code></td>
<td>
<p>Size of the center symbol mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_lwd.forest">lwd.forest</code></td>
<td>
<p>Thickness of the lines in the forest-plot</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_shape.forest">shape.forest</code></td>
<td>
<p>Type of symbol for the center mark in the forest-plot lines</p>
</td></tr>
<tr><td><code id="diagnostic.metarisk_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='dpmeta'>Bayesian Meta-Analysis with Dirichlet Process Priors</h2><span id='topic+dpmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis with DP as random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpmeta(
  data,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  alpha.0 = 0.03,
  alpha.1 = 10,
  K = 30,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the mean of the base distribution default value is mean.mu.0 = 0.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of the base distribution, the default value is 10.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_alpha.0">alpha.0</code></td>
<td>
<p>Lower bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.0 = 0.03.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_alpha.1">alpha.1</code></td>
<td>
<p>Upper bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.1 = 10.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters in the DPM, default value is K = 30.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="dpmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;dpmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)


# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

bm1 = dpmmeta(stemcells)
summary(bm1)
plot(bm1, x.lim = c(-1, 7), y.lim = c(0, 1))

diagnostic(bm1, study.names = stemcells$trial,
           post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

diagnostic(bm1, post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

## End(Not run)

</code></pre>

<hr>
<h2 id='dpmetareg'>Bayesian Meta-Analysis with Dirichlet Process Priors</h2><span id='topic+dpmetareg'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis with DP as random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpmetareg(
  data,
  x,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  alpha.0 = 0.03,
  alpha.1 = 10,
  K = 30,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpmetareg_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_x">x</code></td>
<td>
<p>a covariate to perform meta-regression.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the mean of the base distribution default value is mean.mu.0 = 0.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of the base distribution, the default value is 10.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_alpha.0">alpha.0</code></td>
<td>
<p>Lower bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.0 = 0.03.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_alpha.1">alpha.1</code></td>
<td>
<p>Upper bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.1 = 10.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters in the DPM, default value is K = 30.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="dpmetareg_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;dpmetareg&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)


# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

bm1 = dpmmeta(stemcells)
summary(bm1)
plot(bm1, x.lim = c(-1, 7), y.lim = c(0, 1))

diagnostic(bm1, study.names = stemcells$trial,
           post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

diagnostic(bm1, post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

## End(Not run)

</code></pre>

<hr>
<h2 id='dpmmeta'>Bayesian Meta-Analysis with Dirichlet Process Mixtures Priors</h2><span id='topic+dpmmeta'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis with DPM as random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dpmmeta(
  data,
  mean.mu.0 = 0,
  sd.mu.0 = 10,
  scale.sigma.between = 0.5,
  df.scale.between = 1,
  alpha.0 = 0.03,
  alpha.1 = 10,
  K = 5,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dpmmeta_+3A_data">data</code></td>
<td>
<p>A data frame with at least two columns with the following names:
1) TE = treatment effect,
2) seTE = the standard error of the treatment effect.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_mean.mu.0">mean.mu.0</code></td>
<td>
<p>Prior mean of the mean of the base distribution default value is mean.mu.0 = 0.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_sd.mu.0">sd.mu.0</code></td>
<td>
<p>Prior standard deviation of the base distribution, the default value is 10.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_scale.sigma.between">scale.sigma.between</code></td>
<td>
<p>Prior scale parameter for scale gamma distribution for the
precision between studies. The default value is 0.5.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_df.scale.between">df.scale.between</code></td>
<td>
<p>Degrees of freedom of the scale gamma distribution for the precision between studies.
The default value is 1, which results in a Half Cauchy distribution for the standard
deviation between studies. Larger values e.g. 30 corresponds to a Half Normal distribution.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_alpha.0">alpha.0</code></td>
<td>
<p>Lower bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.0 = 0.03.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_alpha.1">alpha.1</code></td>
<td>
<p>Upper bound of the uniform prior for the concentration parameter for the DPM,
default value is alpha.1 = 10.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_k">K</code></td>
<td>
<p>Maximum number of clusters in the DPM, default value is K = 5.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 2.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discard for burn-in period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="dpmmeta_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The results of the object of the class bcmeta can be extracted with R2jags or with rjags. In addition a summary, a print and a plot functions are
implemented for this type of object.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;bmeta&quot;. This object contains the MCMC
output of each parameter and hyper-parameter in the model and
the data frame used for fitting the model.
</p>


<h3>References</h3>

<p>Verde, P.E. (2021) A Bias-Corrected Meta-Analysis Model for Combining Studies of Different Types and Quality. Biometrical Journal; 1–17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(jarbes)


# Example: Stemcells

data("stemcells")
stemcells$TE = stemcells$effect.size
stemcells$seTE = stemcells$se.effect

bm1 = dpmmeta(stemcells)
summary(bm1)
plot(bm1, x.lim = c(-1, 7), y.lim = c(0, 1))

diagnostic(bm1, study.names = stemcells$trial,
           post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

diagnostic(bm1, post.p.value.cut = 0.05,
           lwd.forest = 0.5, shape.forest = 4)

## End(Not run)

</code></pre>

<hr>
<h2 id='effect'>Generic effect function.</h2><span id='topic+effect'></span>

<h3>Description</h3>

<p>Generic effect function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>effect(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect_+3A_object">object</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="effect_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='effect.hmr'>Posterior distribution of Effectiveness for a subgroup of patients</h2><span id='topic+effect.hmr'></span>

<h3>Description</h3>

<p>This function estimates the posterior distribution for a subgroup of patients identified with the function hmr (Hierarchical Meta-Regression).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hmr'
effect(
  object,
  B.lower = 0,
  B.upper = 3,
  k = 1,
  level = c(0.5, 0.75, 0.95),
  x.lim = c(-9, 5),
  y.lim = c(-1, 5),
  x.lab = "Baseline risk",
  y.lab = "Effectiveness",
  title.plot = paste("Posterior Effectiveness for a subgroup (50%, 75% and 95%)"),
  kde2d.n = 25,
  marginals = TRUE,
  bin.hist = 30,
  color.line = "black",
  color.hist = "white",
  color.data.points = "black",
  alpha.data.points = 0.1,
  S = 5000,
  display.probability = FALSE,
  line.no.effect = 0,
  font.size.title = 20,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effect.hmr_+3A_object">object</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_b.lower">B.lower</code></td>
<td>
<p>Lower limit of bias correction. The default is 0 meaning no bias correction.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_b.upper">B.upper</code></td>
<td>
<p>Upper limit of bias correction. The default is 3 meaning three times bias correction.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_k">k</code></td>
<td>
<p>Covariable number indicating the subgroup.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_level">level</code></td>
<td>
<p>Vector with the probability levels of the contour plot. The default values are: 0.5, 0.75, and 0.95.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the bias plot.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_kde2d.n">kde2d.n</code></td>
<td>
<p>The number of grid points in each direction for the non-parametric density estimation. The default is 25.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_marginals">marginals</code></td>
<td>
<p>If TRUE the marginal histograms of the posteriors are added to the plot.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_bin.hist">bin.hist</code></td>
<td>
<p>The number of bins in for the histograms. The default value is 30.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_color.line">color.line</code></td>
<td>
<p>The color of the contour lines. The default is &quot;black.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_color.hist">color.hist</code></td>
<td>
<p>The color of the histogram bars. The default is &quot;white&quot;.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_color.data.points">color.data.points</code></td>
<td>
<p>The color of the data points. The default is &quot;black&quot;.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_alpha.data.points">alpha.data.points</code></td>
<td>
<p>Transparency of the data points.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_s">S</code></td>
<td>
<p>The number of sample values from the joint posterior distribution used to approximate the contours. The default is S=5000.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_display.probability">display.probability</code></td>
<td>
<p>Logical, if TRUE the figure display probabilities.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_line.no.effect">line.no.effect</code></td>
<td>
<p>Horizontal line used as reference for no effect.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_font.size.title">font.size.title</code></td>
<td>
<p>Font size of the title.</p>
</td></tr>
<tr><td><code id="effect.hmr_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='healing'>Efficacy of diabetic foot healing using adjuvant treatments</h2><span id='topic+healing'></span>

<h3>Description</h3>

<p>Meta-analysis of 35 randomized controlled trials investigating the effectiveness
in the application of adjuvant therapies for diabetic patients compared to medical
routine care, where the endpoint was healing without amputations within a period
less than or equal to one year.
</p>


<h3>Format</h3>

<p>A matrix with 35 rows and 9 columns. Each row represents study results,
the columns are:
</p>

<dl>
<dt>Study</dt><dd><p>Name of the first author and year.</p>
</dd>
<dt>n_t</dt><dd><p>Number of patients in the treatment group.</p>
</dd>
<dt>n_c</dt><dd><p>Number of patients in the control group.</p>
</dd>
<dt>y_t</dt><dd><p>Number of heal patients in the treatment group.</p>
</dd>
<dt>y_c</dt><dd><p>Number of heal patients in the control group.</p>
</dd>
<dt>ndrop</dt><dd><p>Total number of drop out patients.</p>
</dd>
<dt>fup_weeks</dt><dd><p>Length of followup in weeks.</p>
</dd>
<dt>PAD</dt><dd><p>Inclusion of patients with peripheral arterial disease.</p>
</dd>
<dt>wagner_4</dt><dd><p>Inclusion of patients with Wagner score 3 and 4.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtainded from: Centre for Clinical Practice at NICE (UK and others)
(2011), Clinical guideline 119. Diabetic foot problems: Inpatient Management of Diabetic Foot Problems.
Tech. rep., National Institute for Health and Clinical Excellence.
</p>


<h3>References</h3>

<p>Verde, P.E. (2018) The Hierarchical Meta-Regression Approach and Learning
from Clinical Evidence. Technical Report.
</p>

<hr>
<h2 id='healingipd'>Individual participant data for diabetic patients</h2><span id='topic+healingipd'></span>

<h3>Description</h3>

<p>Prospective cohort study.
</p>


<h3>Format</h3>

<p>A dataframe with 260 rows and 18 columns. Each row represents a patient,
the columns are:
</p>

<dl>
<dt>healing.without.amp</dt><dd><p>Outcome variable: Healing without amputation with in one year.</p>
</dd>
<dt>duration_lesion_days</dt><dd><p>Duration of leasions in days at baseline.</p>
</dd>
<dt>PAD</dt><dd><p>Peripheral arterial disease yes/no.</p>
</dd>
<dt>neuropathy</dt><dd><p>Neuropathy yes/no.</p>
</dd>
<dt>first.ever.lesion</dt><dd><p>First ever lesion yes/no.</p>
</dd>
<dt>no.continuous.care</dt><dd><p>No continuous care yes/no.</p>
</dd>
<dt>male</dt><dd><p>yes/no.</p>
</dd>
<dt>diab.typ2</dt><dd><p>Diabetes type 2 yes/no.</p>
</dd>
<dt>insulin</dt><dd><p>Insulin dependent yes/no.</p>
</dd>
<dt>HOCHD</dt><dd><p>HOCHD yes/no.</p>
</dd>
<dt>HOS</dt><dd><p>HOCHD yes/no.</p>
</dd>
<dt>CRF</dt><dd><p>CRF yes/no.</p>
</dd>
<dt>dialysis</dt><dd><p>Dialysis yes/no.</p>
</dd>
<dt>DNOAP</dt><dd><p>DNOAP yes/no.</p>
</dd>
<dt>smoking.ever</dt><dd><p>Ever smoke yes/no.</p>
</dd>
<dt>age</dt><dd><p>Age at baseline in years.</p>
</dd>
<dt>diabdur</dt><dd><p>Diabetes duration at baseline.</p>
</dd>
<dt>wagner.class</dt><dd><p>Wagner score 1-2 vs. 3-4-5.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morbach, S, et al. (2012). Long-Term Prognosis of Diabetic Foot Patients and Their Limbs: Amputation and death over the course of a decade,Diabetes Care, 35, 10, 2012-2017.
</p>


<h3>References</h3>

<p>Verde, P.E. (2018) The Hierarchical Meta-Regression Approach and Learning from Clinical Evidence. Technical Report.
</p>

<hr>
<h2 id='hips'>Meta-analysis:</h2><span id='topic+hips'></span>

<h3>Description</h3>

<p>Meta-analysis of 15 studies investigating total hip replacement to compare the risk of revision of
cemented and uncemented implantfixation modalities, by pooling
treatment effectestimates from OS and RCTs.
</p>


<h3>Format</h3>

<p>A dataframe with 15 rows and 12 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>Study</dt><dd><p>Author and year.</p>
</dd>
<dt>Study_type</dt><dd><p>Study desing.</p>
</dd>
<dt>N_of_revisions</dt><dd><p>Number of revisions.</p>
</dd>
<dt>Total_cemented</dt><dd><p>Total number of cemmented cases.</p>
</dd>
<dt>N_of_revisions_uncemented</dt><dd><p>Number of uncemented revisions.</p>
</dd>
<dt>Total_uncemented</dt><dd><p>Total number of uncemmented cases.</p>
</dd>
<dt>Relative_risks_computed</dt><dd><p>RR calculated from the two by two table.</p>
</dd>
<dt>L95CI</dt><dd><p>Lower 95prc CI</p>
</dd>
<dt>U95CI</dt><dd><p>Upper 95prc CI</p>
</dd>
<dt>mean_age</dt><dd><p>Mean age of the study</p>
</dd>
<dt>proportion_of_women</dt><dd><p>Proportion of women in the study.</p>
</dd>
<dt>Follow_up</dt><dd><p>Time to follow-up in years.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Schnell-Inderst P, Iglesias CP, Arvandi M, Ciani O, Matteucci Gothe R, Peters J, Blom AW, Taylor RS and Siebert U (2017). A bias-adjusted evidence synthesis of RCT and observational data: the case of total hip replacement. Health Econ. 26(Suppl. 1): 46–69.
</p>

<hr>
<h2 id='hmr'>Bayesian meta-analysis to combine aggregated and individual participant data for cross design synthesis.</h2><span id='topic+hmr'></span>

<h3>Description</h3>

<p>This function performers a Bayesian cross design synthesis. The function fits a
hierarchical meta-regression model based on a bivariate random effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hmr(
  data,
  two.by.two = TRUE,
  dataIPD,
  re = "normal",
  link = "logit",
  mean.mu.1 = 0,
  mean.mu.2 = 0,
  mean.mu.phi = 0,
  sd.mu.1 = 1,
  sd.mu.2 = 1,
  sd.mu.phi = 1,
  sigma.1.upper = 5,
  sigma.2.upper = 5,
  sigma.beta.upper = 5,
  mean.Fisher.rho = 0,
  sd.Fisher.rho = 1/sqrt(2),
  df = 4,
  df.estimate = FALSE,
  df.lower = 3,
  df.upper = 20,
  split.w = FALSE,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hmr_+3A_data">data</code></td>
<td>
<p>Aggregated data results: a data frame where the first four columns containing the number of events in
the control group (yc), the number of patients in the control group (nc),
the number of events in the treatment group (yt) and the number of patients in the
treatment group (nt). If two.by.two = TRUE a data frame where each line
contains the trial results with column names: yc, nc, yt, nt.</p>
</td></tr>
<tr><td><code id="hmr_+3A_two.by.two">two.by.two</code></td>
<td>
<p>If TRUE indicates that the trial results are with names: yc, nc, yt, nt.</p>
</td></tr>
<tr><td><code id="hmr_+3A_dataipd">dataIPD</code></td>
<td>
<p>Individual participant data: a data frame where
the first column is the outcome variable and the
other columns represent individual participant
charachteristics.</p>
</td></tr>
<tr><td><code id="hmr_+3A_re">re</code></td>
<td>
<p>Random effects distribution for the resulting model. Possible
values are <em>normal</em> for bivariate random effects and <em>sm</em>
for scale mixtures.</p>
</td></tr>
<tr><td><code id="hmr_+3A_link">link</code></td>
<td>
<p>The link function used in the model. Possible values are
<em>logit</em>, <em>cloglog</em> <em>probit</em>.</p>
</td></tr>
<tr><td><code id="hmr_+3A_mean.mu.1">mean.mu.1</code></td>
<td>
<p>Prior mean of baseline risk, default value is 0.</p>
</td></tr>
<tr><td><code id="hmr_+3A_mean.mu.2">mean.mu.2</code></td>
<td>
<p>Prior mean of treatment effect, default value is 0.</p>
</td></tr>
<tr><td><code id="hmr_+3A_mean.mu.phi">mean.mu.phi</code></td>
<td>
<p>Prior mean of the bias parameter which measures the difference
between the baseline mean mu.1 and the intercept parameter of
the logistic regression of the individual participant data.
The defalut vaule is 0.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sd.mu.1">sd.mu.1</code></td>
<td>
<p>Prior standard deviation of mu.1, default value is 1. The default prior of mu.1 is a
logistic distribution with mean 0 and dispersion 1. The implicit prior for mu.1 in
the probability scale is a uniform between 0 and 1.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sd.mu.2">sd.mu.2</code></td>
<td>
<p>Prior standard deviation of mu.2, default value is 1. The default prior of mu.2 is a
logistic distribution with mean 0 and dispersion 1. The implicit prior for mu.2 in
the probability scale is a uniform between 0 and 1.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sd.mu.phi">sd.mu.phi</code></td>
<td>
<p>Prior standard deviation of mu.phi, default value is 1.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sigma.1.upper">sigma.1.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.1, default value is 5.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sigma.2.upper">sigma.2.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.2, default value is 5.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sigma.beta.upper">sigma.beta.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.beta, default value is 5.</p>
</td></tr>
<tr><td><code id="hmr_+3A_mean.fisher.rho">mean.Fisher.rho</code></td>
<td>
<p>Mean of rho in the Fisher scale, default value is 0.</p>
</td></tr>
<tr><td><code id="hmr_+3A_sd.fisher.rho">sd.Fisher.rho</code></td>
<td>
<p>Standard deviation of rho in the Fisher scale, default value is 1/sqrt(2).</p>
</td></tr>
<tr><td><code id="hmr_+3A_df">df</code></td>
<td>
<p>If de.estimate = FALSE, then df is the degrees of freedom for the scale mixture distribution, default value is 4.</p>
</td></tr>
<tr><td><code id="hmr_+3A_df.estimate">df.estimate</code></td>
<td>
<p>Estimate the posterior of df. The default value is FALSE.</p>
</td></tr>
<tr><td><code id="hmr_+3A_df.lower">df.lower</code></td>
<td>
<p>Lower bound of the prior of df. The default value is 3.</p>
</td></tr>
<tr><td><code id="hmr_+3A_df.upper">df.upper</code></td>
<td>
<p>Upper bound of the prior of df. The default value is 30.</p>
</td></tr>
<tr><td><code id="hmr_+3A_split.w">split.w</code></td>
<td>
<p>Split the w parameter in two independent weights one for each random effect.
The default value is FALSE.</p>
</td></tr>
<tr><td><code id="hmr_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 5.</p>
</td></tr>
<tr><td><code id="hmr_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="hmr_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, default is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="hmr_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discarded for burnin period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="hmr_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of events in the control and treated group are modeled with two
conditional Binomial distributions and the random-effects are based on a
bivariate scale mixture of Normals.
</p>
<p>The individual participant data is modeled as a Bayesian logistic regression for
participants in the control group. Coefficients in the regression are modeled as
exchangeables.
</p>
<p>The function calculates the implicit hierarchical meta-regression, where the
treatment effect is regressed to the baseline risk (rate of events in the control
group). The scale mixture weights are used to adjust for internal validity and
structural outliers identification.
</p>
<p>The implicit hierarchical meta-regression is used to predict the treatment effect
for subgroups of individual participant data.
</p>
<p>Computations are done by calling JAGS (Just Another Gibbs Sampler) to perform
MCMC (Markov Chain Monte Carlo) sampling and returning an object of the
class <em>mcmc.list</em>.
</p>
<p>Installation of JAGS: It is important to note that R 3.3.0 introduced a major change in the
use of toolchain for Windows. This new toolchain is incompatible with older packages written in C++.
As a consequence, if the installed version of JAGS does not match the R installation, then the rjags
package will spontaneously crash. Therefore, if a user works with R version &gt;= 3.3.0, then JAGS must
be installed with the installation program JAGS-4.2.0-Rtools33.exe. For users who continue using R 3.2.4 or
an earlier version, the installation program for JAGS is the default installer JAGS-4.2.0.exe.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;hmr&quot;. This object contains the MCMC output of
each parameter and hyper-parameter in the model, the data frame used for fitting the model, the link function,
type of random effects distribution and the splitting information for conflict of evidence analysis.
</p>
<p>The results of the object of the class hmr can be extracted with R2jags. In addition
a summary, a print and a plot function are implemented for this type of object.
</p>


<h3>References</h3>

<p>Verde, P.E, Ohmann, C., Icks, A. and Morbach, S. (2016) Bayesian evidence synthesis and combining randomized and nonrandomized results: a case study in diabetes. Statistics in Medicine. Volume 35, Issue 10, 10 May 2016, Pages: 1654 to 1675.
</p>
<p>Verde, P.E. (2017) The hierarchical meta-regression approach and learning from clinical evidence. Submited to the Biometrical Journal.
</p>
<p>Verde, P.E. (2018) The Hierarchical Meta-Regression Approach and Learning from Clinical Evidence. Technical report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(jarbes)

data("healing")
AD &lt;- healing[, c("y_c", "n_c", "y_t", "n_t")]

data("healingipd")

IPD &lt;- healingipd[, c("healing.without.amp", "PAD", "neuropathy",
"first.ever.lesion", "no.continuous.care", "male", "diab.typ2",
"insulin", "HOCHD", "HOS", "CRF", "dialysis", "DNOAP", "smoking.ever",
"diabdur", "wagner.class")]

mx2 &lt;- hmr(AD, two.by.two = FALSE,
           dataIPD = IPD,
           re = "sm",
           link = "logit",
           sd.mu.1 = 2,
           sd.mu.2 = 2,
           sd.mu.phi = 2,
           sigma.1.upper = 5,
           sigma.2.upper = 5,
           sigma.beta.upper = 5,
           sd.Fisher.rho = 1.25,
           df.estimate = FALSE,
           df.lower = 3,
           df.upper = 10,
           nr.chains = 1,
           nr.iterations = 1500,
           nr.adapt = 100,
           nr.thin = 1)

print(mx2)




# This experiment corresponds to Section 4 in Verde (2018).
#
# Experiment: Combining aggretated data from RCTs and a single
# observational study with individual participant data.
#
# In this experiment we assess conflict of evidence between the RCTs
# and the observational study with a partially identified parameter
# mu.phi.
#
# We run two simulated data: 1) mu.phi = 0.5 which is diffucult to
# identify. 2) mu.phi = 2 which can be identify. The simulations are
# used to see if the hmr() function can recover mu.phi.
#


library(MASS)
library(ggplot2)
library(jarbes)
library(gridExtra)
library(mcmcplots)


# Simulation of the IPD data

invlogit &lt;- function (x)
{
 1/(1 + exp(-x))
}

# Data set for mu.phi = 0.5 .........................................

# Parameters values
mu.phi.true &lt;- 0.5
beta0 &lt;- mu.1.true + mu.phi.true
beta1 &lt;- 2.5
beta2 &lt;- 2

# Regression variables

x1 &lt;- rnorm(200)
x2 &lt;- rbinom(200, 1, 0.5)

# Binary outcome as a function of "b0 + b1 * x1 + b2 * x2"

y &lt;- rbinom(200, 1,
         invlogit(beta0 + beta1 * x1 + beta2 * x2))


# Preparing the plot to visualize the data
jitter.binary &lt;- function(a, jitt = 0.05)

 ifelse(a==0, runif(length(a), 0, jitt),
        runif(length(a), 1-jitt, 1))



plot(x1, jitter.binary(y), xlab = "x1",
    ylab = "Success probability")

curve(invlogit(beta0 + beta1*x),
     from = -2.5, to = 2.5, add = TRUE, col ="blue", lwd = 2)
curve(invlogit(beta0 + beta1*x + beta2),
     from = -2.5, to = 2.5, add = TRUE, col ="red", lwd =2)
legend("bottomright", c("b2 = 0", "b2 = 2"),
      col = c("blue", "red"), lwd = 2, lty = 1)

noise &lt;- rnorm(100*20)
dim(noise) &lt;- c(100, 20)
n.names &lt;- paste(rep("x", 20), seq(3, 22), sep="")
colnames(noise) &lt;- n.names

data.IPD &lt;- data.frame(y, x1, x2, noise)


# Application of HMR ...........................................

res.s2 &lt;- hmr(AD.s1, two.by.two = FALSE,
             dataIPD = data.IPD,
             sd.mu.1 = 2,
             sd.mu.2 = 2,
             sd.mu.phi = 2,
             sigma.1.upper = 5,
             sigma.2.upper = 5,
             sd.Fisher.rho = 1.5)


print(res.s2)

# Data set for mu.phi = 2 ......................................
# Parameters values

mu.phi.true &lt;- 2
beta0 &lt;- mu.1.true + mu.phi.true
beta1 &lt;- 2.5
beta2 &lt;- 2

# Regression variables
x1 &lt;- rnorm(200)
x2 &lt;- rbinom(200, 1, 0.5)
# Binary outcome as a function of "b0 + b1 * x1 + b2 * x2"
y &lt;- rbinom(200, 1,
           invlogit(beta0 + beta1 * x1 + beta2 * x2))

# Preparing the plot to visualize the data
jitter.binary &lt;- function(a, jitt = 0.05)

 ifelse(a==0, runif(length(a), 0, jitt),
        runif(length(a), 1-jitt, 1))

plot(x1, jitter.binary(y), xlab = "x1",
    ylab = "Success probability")

curve(invlogit(beta0 + beta1*x),
     from = -2.5, to = 2.5, add = TRUE, col ="blue", lwd = 2)
curve(invlogit(beta0 + beta1*x + beta2),
     from = -2.5, to = 2.5, add = TRUE, col ="red", lwd =2)
legend("bottomright", c("b2 = 0", "b2 = 2"),
      col = c("blue", "red"), lwd = 2, lty = 1)

noise &lt;- rnorm(100*20)
dim(noise) &lt;- c(100, 20)
n.names &lt;- paste(rep("x", 20), seq(3, 22), sep="")
colnames(noise) &lt;- n.names

data.IPD &lt;- data.frame(y, x1, x2, noise)

# Application of HMR ................................................


res.s3 &lt;- hmr(AD.s1, two.by.two = FALSE,
             dataIPD = data.IPD,
             sd.mu.1 = 2,
             sd.mu.2 = 2,
             sd.mu.phi = 2,
             sigma.1.upper = 5,
             sigma.2.upper = 5,
             sd.Fisher.rho = 1.5
)

print(res.s3)

# Posteriors for mu.phi ............................
attach.jags(res.s2)
mu.phi.0.5 &lt;- mu.phi
df.phi.05 &lt;- data.frame(x = mu.phi.0.5)

attach.jags(res.s3)
mu.phi.1 &lt;- mu.phi
df.phi.1 &lt;- data.frame(x = mu.phi.1)


p1 &lt;- ggplot(df.phi.05, aes(x=x))+
 xlab(expression(mu[phi])) +
 ylab("Posterior distribution")+
 xlim(c(-7,7))+
 geom_histogram(aes(y=..density..),fill = "royalblue",
              colour = "black", alpha= 0.4, bins=60) +
 geom_vline(xintercept = 0.64, colour = "black", size = 1.7, lty = 2)+
 geom_vline(xintercept = 0.5, colour = "black", size = 1.7, lty = 1)+
 stat_function(fun = dlogis,
               n = 101,
               args = list(location = 0, scale = 1), size = 1.5) + theme_bw()

p2 &lt;- ggplot(df.phi.1, aes(x=x))+
 xlab(expression(mu[phi])) +
 ylab("Posterior distribution")+
 xlim(c(-7,7))+
 geom_histogram(aes(y=..density..),fill = "royalblue",
                colour = "black", alpha= 0.4, bins=60) +
 geom_vline(xintercept = 2.2, colour = "black", size = 1.7, lty = 2)+
 geom_vline(xintercept = 2, colour = "black", size = 1.7, lty = 1)+
 stat_function(fun = dlogis,
               n = 101,
               args = list(location = 0, scale = 1), size = 1.5) + theme_bw()

grid.arrange(p1, p2, ncol = 2, nrow = 1)


# Cater plots for regression coefficients ...........................

var.names &lt;- names(data.IPD[-1])
v &lt;- paste("beta", names(data.IPD[-1]), sep = ".")
mcmc.x &lt;- as.rjags.mcmc(res.s2$BUGSoutput$sims.matrix)
mcmc.x.2 &lt;- as.mcmc.rjags(res.s2)
mcmc.x.3 &lt;- as.mcmc.rjags(res.s3)

greek.names &lt;- paste(paste("beta[",1:22, sep=""),"]", sep="")
par.names &lt;- paste(paste("beta.IPD[",1:22, sep=""),"]", sep="")

caterplot(mcmc.x.2,
         parms = par.names,
         col = "black", lty = 1,
         labels = greek.names,
         greek = T,
         labels.loc="axis", cex =0.7,
         style = "plain",reorder = F, denstrip = F)

caterplot(mcmc.x.3,
         parms = par.names,
         col = "grey", lty = 2,
         labels = greek.names,
         greek = T,
         labels.loc="axis", cex =0.7,
         style = "plain",reorder = F, denstrip = F,
         add = TRUE,
         collapse=TRUE, cat.shift=-0.5)



abline(v=0, lty = 2, lwd = 2)
abline(v =2, lty = 2, lwd = 2)
abline(v =2.5, lty = 2, lwd = 2)

# End of the examples.


## End(Not run)


</code></pre>

<hr>
<h2 id='metarisk'>Bayesian meta-analysis for using baseline risk adjustment</h2><span id='topic+metarisk'></span>

<h3>Description</h3>

<p>This function performers a Bayesian meta-analysis to analyse heterogeneity of
the treatment effect as a function of the baseline risk. The function fits a
hierarchical meta-regression model based on a bivariate random effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metarisk(
  data,
  two.by.two = TRUE,
  re = "normal",
  link = "logit",
  mean.mu.1 = 0,
  mean.mu.2 = 0,
  sd.mu.1 = 1,
  sd.mu.2 = 1,
  sigma.1.upper = 5,
  sigma.2.upper = 5,
  mean.Fisher.rho = 0,
  sd.Fisher.rho = 1/sqrt(2),
  df = 4,
  df.estimate = FALSE,
  df.lower = 3,
  df.upper = 20,
  split.w = FALSE,
  nr.chains = 2,
  nr.iterations = 10000,
  nr.adapt = 1000,
  nr.burnin = 1000,
  nr.thin = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="metarisk_+3A_data">data</code></td>
<td>
<p>A data frame where the first four columns containing the number of events in
the control group (yc), the number of patients in the control group (nc),
the number of events in the treatment group (yt) and the number of patients in the
treatment group (nt). If two.by.two = TRUE a data frame where each line
contains the trial results with column names: yc, nc, yt, nt.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_two.by.two">two.by.two</code></td>
<td>
<p>If TRUE indicates that the trial results are with names: yc, nc, yt, nt.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_re">re</code></td>
<td>
<p>Random effects distribution for the resulting model. Possible
values are <em>normal</em> for bivariate random effects and <em>sm</em>
for scale mixtures.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_link">link</code></td>
<td>
<p>The link function used in the model. Possible values are
<em>logit</em>, <em>cloglog</em> <em>probit</em>.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_mean.mu.1">mean.mu.1</code></td>
<td>
<p>Prior mean of baseline risk, default value is 0.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_mean.mu.2">mean.mu.2</code></td>
<td>
<p>Prior mean of the relative treatment effect, default value is 0.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_sd.mu.1">sd.mu.1</code></td>
<td>
<p>Prior standard deviation of mu.1, default value is 1. The default prior of mu.1 is a
logistic distribution with mean 0 and dispersion 1. The implicit prior for mu.1 in
the probability scale is a uniform between 0 and 1.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_sd.mu.2">sd.mu.2</code></td>
<td>
<p>Prior standard deviation of mu.2, default value is 1. The default prior of mu.2 is a
logistic distribution with mean 0 and dispersion 1. The implicit prior for mu.2 in
the probability scale is a uniform between 0 and 1.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_sigma.1.upper">sigma.1.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.1, default value is 5.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_sigma.2.upper">sigma.2.upper</code></td>
<td>
<p>Upper bound of the uniform prior of sigma.2, default value is 5.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_mean.fisher.rho">mean.Fisher.rho</code></td>
<td>
<p>Mean of rho in the Fisher scale default value is 0.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_sd.fisher.rho">sd.Fisher.rho</code></td>
<td>
<p>Standard deviation of rho in the Fisher scale, default value is 1/sqrt(2).</p>
</td></tr>
<tr><td><code id="metarisk_+3A_df">df</code></td>
<td>
<p>If de.estimate = FALSE, then df is the degrees of freedom for the scale mixture distribution, default value is 4.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_df.estimate">df.estimate</code></td>
<td>
<p>Estimate the posterior of df. The default value is FALSE.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_df.lower">df.lower</code></td>
<td>
<p>Lower bound of the prior of df. The default value is 3.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_df.upper">df.upper</code></td>
<td>
<p>Upper bound of the prior of df. The default value is 30.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_split.w">split.w</code></td>
<td>
<p>Split the w parameter in two independent weights one for each random effect.
The default value is FALSE.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_nr.chains">nr.chains</code></td>
<td>
<p>Number of chains for the MCMC computations, default 5.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_nr.iterations">nr.iterations</code></td>
<td>
<p>Number of iterations after adapting the MCMC, default is 10000. Some models may need more iterations.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_nr.adapt">nr.adapt</code></td>
<td>
<p>Number of iterations in the adaptation process, defualt is 1000. Some models may need more iterations during adptation.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_nr.burnin">nr.burnin</code></td>
<td>
<p>Number of iteration discared for burnin period, default is 1000. Some models may need a longer burnin period.</p>
</td></tr>
<tr><td><code id="metarisk_+3A_nr.thin">nr.thin</code></td>
<td>
<p>Thinning rate, it must be a positive integer, the default value is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The number of events in the control and treated group are modeled with two
conditional Binomial distributions and the random-effects are based on a
bivariate scale mixture of Normals.
</p>
<p>The function calculates the implicit hierarchical meta-regression, where the
treatment effect is regressed to the baseline risk (rate of events in the control
group). The scale mixture weights are used to adjust for internal validity and
structural outliers identification.
</p>
<p>Computations are done by calling JAGS (Just Another Gibbs Sampler) to perform
MCMC (Markov Chain Monte Carlo) sampling and returning an object of the
class <em>mcmc.list</em>.
</p>


<h3>Value</h3>

<p>This function returns an object of the class &quot;metarisk&quot;. This object contains the MCMC output of
each parameter and hyper-parameter in the model, the data frame used for fitting the model, the link function,
type of random effects distribution and the splitting information for conflict of evidence analysis.
</p>
<p>The results of the object of the class metadiag can be extracted with R2jags or with rjags. In addition
a summary, a print and a plot functions are implemented for this type of object.
</p>


<h3>References</h3>

<p>Verde, P.E. and Curcio, D. (2019) Hierarchical Meta-Regression Modelling: The Case
of The Pneumococcal Polysaccharide Vaccine. Technical Report.
</p>
<p>Verde, P.E. (2019) The hierarchical meta-regression
approach and learning from clinical evidence.
Biometrical Journal. 1 - 23.
</p>
<p>Verde, P. E. (2017) Two Examples of Bayesian Evidence Synthesis with
the Hierarchical Meta-Regression Approach. Chap.9, pag 189-206.
Bayesian Inference, ed. Tejedor, Javier Prieto. InTech.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(jarbes)

# This example is used to test the function and it runs in about 5 seconds.
# In a real application you must increase the number of MCMC interations.
# For example use: nr.burnin = 5000 and nr.iterations = 20000





# The following examples corresponds to Section 4 in Verde (2019).
# These are simulated examples to investigate internal and
# external validity bias in meta-analysis.


library(MASS)
library(ggplot2)
library(jarbes)
library(gridExtra)
library(mcmcplots)

#Experiment 1: External validity bias

set.seed(2018)
# mean control
pc &lt;- 0.7
# mean treatment
pt &lt;- 0.4
# reduction of "amputations" odds ratio
OR &lt;- (pt/(1-pt)) /(pc/(1-pc))
OR

# mu_2
log(OR)
mu.2.true &lt;- log(OR)
#sigma_2
sigma.2.true &lt;- 0.5
# mu_1
mu.1.true &lt;- log(pc/(1-pc))
mu.1.true
#sigma_1
sigma.1.true &lt;- 1
# rho
rho.true &lt;- -0.5
Sigma &lt;- matrix(c(sigma.1.true^2, sigma.1.true*sigma.2.true*rho.true,
                 sigma.1.true*sigma.2.true*rho.true, sigma.2.true^2),
                 byrow = TRUE, ncol = 2)
Sigma

theta &lt;- mvrnorm(35, mu = c(mu.1.true, mu.2.true),
                Sigma = Sigma )


plot(theta, xlim = c(-2,3))
abline(v=mu.1.true, lty = 2)
abline(h=mu.2.true, lty = 2)
abline(a = mu.2.true, b=sigma.2.true/sigma.1.true * rho.true, col = "red")
abline(lm(theta[,2]~theta[,1]), col = "blue")

# Target group
mu.T &lt;- mu.1.true + 2 * sigma.1.true
abline(v=mu.T, lwd = 3, col = "blue")
eta.true &lt;- mu.2.true + sigma.2.true/sigma.1.true*rho.true* mu.T
eta.true
exp(eta.true)
abline(h = eta.true, lty =3, col = "blue")
# Simulation of each primary study:
n.c &lt;- round(runif(35, min = 30, max = 60),0)
n.t &lt;- round(runif(35, min = 30, max = 60),0)
y.c &lt;- y.t &lt;- rep(0, 35)
p.c &lt;- exp(theta[,1])/(1+exp(theta[,1]))
p.t &lt;- exp(theta[,2]+theta[,1])/(1+exp(theta[,2]+theta[,1]))
for(i in 1:35)
{
 y.c[i] &lt;- rbinom(1, n.c[i], prob = p.c[i])
 y.t[i] &lt;- rbinom(1, n.t[i], prob = p.t[i])
}

AD.s1 &lt;- data.frame(yc=y.c, nc=n.c, yt=y.t, nt=n.t)

##########################################################
incr.e &lt;- 0.05
incr.c &lt;- 0.05
n11 &lt;- AD.s1$yt
n12 &lt;- AD.s1$yc
n21 &lt;- AD.s1$nt - AD.s1$yt
n22 &lt;- AD.s1$nc - AD.s1$yc
AD.s1$TE &lt;- log(((n11 + incr.e)*(n22 + incr.c))/((n12 + incr.e) * (n21 + incr.c)))
AD.s1$seTE &lt;- sqrt((1/(n11 + incr.e) + 1/(n12 + incr.e) +
                     1/(n21 + incr.c) + 1/(n22 + incr.c)))

Pc &lt;- ((n12 + incr.c)/(AD.s1$nc + 2*incr.c))

AD.s1$logitPc &lt;- log(Pc/(1-Pc))

AD.s1$Ntotal &lt;- AD.s1$nc + AD.s1$nt
rm(list=c("Pc", "n11","n12","n21","n22","incr.c", "incr.e"))


dat.points &lt;- data.frame(TE = AD.s1$TE, logitPc = AD.s1$logitPc, N.total = AD.s1$Ntotal)
###################################################################

res.s1 &lt;- metarisk(AD.s1, two.by.two = FALSE, sigma.1.upper = 5,
                  sigma.2.upper = 5,
                  sd.Fisher.rho = 1.5)

print(res.s1, digits = 4)


library(R2jags)
attach.jags(res.s1)
eta.hat &lt;- mu.2 + rho*sigma.2/sigma.1*(mu.T - mu.1)
mean(eta.hat)
sd(eta.hat)

OR.eta.hat &lt;- exp(eta.hat)
mean(OR.eta.hat)
sd(OR.eta.hat)
quantile(OR.eta.hat, probs = c(0.025, 0.5, 0.975))

ind.random &lt;- sample(1:18000, size = 80, replace = FALSE)

##############################################################
p1 &lt;- ggplot(dat.points, aes(x = logitPc, y = TE, size = N.total)) +
      xlab("logit Baseline Risk")+
      ylab("log(Odds Ratio)")+
      geom_point(shape = 21, colour = "blue") + scale_size_area(max_size=10)+
      scale_x_continuous(name= "Rate of The Control Group (logit scale)",
                       limits=c(-2, 5)) +
     geom_vline(xintercept = mu.T, colour = "blue", size = 1, lty = 1) +
       geom_hline(yintercept = eta.true, colour = "blue", size = 1, lty = 1)+
         geom_abline(intercept=beta.0[ind.random],
                   slope=beta.1[ind.random],alpha=0.3,
                   colour = "grey", size = 1.3, lty = 2)+
         geom_abline(intercept = mean(beta.0[ind.random]),
         slope = mean(beta.1[ind.random]),
         colour = "black", size = 1.3, lty = 2)+
     geom_abline(intercept = mu.2.true, slope = sigma.2.true/sigma.1.true * rho.true,
     colour = "blue", size = 1.2)+ theme_bw()


# Posterior of eta.hat

eta.df &lt;- data.frame(x = OR.eta.hat)


p2 &lt;- ggplot(eta.df, aes(x = x)) +
 xlab("Odds Ratio") +
 ylab("Posterior distribution")+
 geom_histogram(fill = "royalblue", colour = "black", alpha= 0.4, bins=80) +
 geom_vline(xintercept = exp(eta.true), colour = "black", size = 1.7, lty = 1)+
 geom_vline(xintercept = c(0.28, 0.22, 0.35), colour = "black", size = 1, lty = 2)+
 theme_bw()


grid.arrange(p1, p2, ncol = 2, nrow = 1)

#Experiment 2: Internal validity bias and assesing conflict of evidence between the RCTs.


set.seed(2018)
ind &lt;- sample(1:35, size=5, replace = FALSE)
ind
AD.s4.contaminated &lt;- AD.s1[ind,1:4]
AD.s4.contaminated$yc &lt;- AD.s1$yt[ind]
AD.s4.contaminated$yt &lt;- AD.s1$yc[ind]
AD.s4.contaminated$nc &lt;- AD.s1$nt[ind]
AD.s4.contaminated$nt &lt;- AD.s1$nc[ind]
AD.s4.contaminated &lt;- rbind(AD.s4.contaminated,
                         AD.s1[-ind,1:4])

res.s4 &lt;- metarisk(AD.s4.contaminated,
                   two.by.two = FALSE,
                   re = "sm",
                   sigma.1.upper = 3,
                   sigma.2.upper = 3,
                   sd.Fisher.rho = 1.5,
                   df.estimate = TRUE)

print(res.s4, digits = 4)

attach.jags(res.s4)

w.s &lt;- apply(w, 2, median)
w.u &lt;- apply(w, 2, quantile, prob = 0.75)
w.l &lt;- apply(w, 2, quantile, prob = 0.25)

studies &lt;- c(ind,c(1,3,4,5,6,8,9,10,11,13,14,17,18,19,20:35))


dat.weights &lt;- data.frame(x = studies,
                         y = w.s,
                        ylo  = w.l,
                        yhi  = w.u)

# Outliers:
w.col &lt;- studies %in% ind
w.col.plot &lt;- ifelse(w.col, "black", "grey")
w.col.plot[c(9,17, 19,27,34,35)] &lt;- "black"

w.plot &lt;- function(d){
  # d is a data frame with 4 columns
  # d$x gives variable names
  # d$y gives center point
  # d$ylo gives lower limits
  # d$yhi gives upper limits

  p &lt;- ggplot(d, aes(x=x, y=y, ymin=ylo, ymax=yhi) )+
       geom_pointrange( colour=w.col.plot, lwd =0.8)+
       coord_flip() + geom_hline(yintercept = 1, lty=2)+
       xlab("Study ID") +
       ylab("Scale mixture weights") + theme_bw()
       return(p)}

w.plot(dat.weights)

#List of other possible statistical models:
#    1) Different link functions: logit, cloglog and probit

#    2) Different random effects distributions:
#       "normal" or "sm = scale mixtures".

#    3) For the scale mixture random effects:
#       split.w = TRUE =&gt; "split the weights".

#    4) For the scale mixture random effects:
#       df.estimate = TRUE =&gt; "estimate the degrees of freedom".

#    5) For the scale mixture random effects:
#       df.estimate = TRUE =&gt; "estimate the degrees of freedom".

#    6) For the scale mixture random effects:
#       df = 4 =&gt; "fix the degrees of freedom to a particual value".
#       Note that df = 1 fits a Cauchy bivariate distribution to
#       the random effects.
#End of the examples


## End(Not run)


</code></pre>

<hr>
<h2 id='plot.b3lmeta'>Generic plot function for b3lmeta object in jarbes.</h2><span id='topic+plot.b3lmeta'></span>

<h3>Description</h3>

<p>Generic plot function for b3lmeta object in jarbes.
</p>
<p>Generic plot function for b3lmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'b3lmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2.7),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot.1 = "Mean Design Components",
  title.plot.2 = "Three Levels Bayesian Meta-Analysis",
  ...
)

## S3 method for class 'b3lmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2.7),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot.1 = "Mean Design Components",
  title.plot.2 = "Three Levels Bayesian Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.b3lmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the b3lmeta function.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_title.plot.1">title.plot.1</code></td>
<td>
<p>Text for the posterior means by design.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_title.plot.2">title.plot.2</code></td>
<td>
<p>Text for the posterior pooled mean.</p>
</td></tr>
<tr><td><code id="plot.b3lmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.bcdpmeta'>Generic plot function for bcdpmeta object in jarbes.</h2><span id='topic+plot.bcdpmeta'></span>

<h3>Description</h3>

<p>Generic plot function for bcdpmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdpmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot.1 = "Model Components",
  title.plot.2 = "Bias Corrected Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bcdpmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the bcmeta function.</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_title.plot.1">title.plot.1</code></td>
<td>
<p>Text for the posterior means by component (biased and bias corrected).</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_title.plot.2">title.plot.2</code></td>
<td>
<p>Text for the posterior mean (pooled and predictive).</p>
</td></tr>
<tr><td><code id="plot.bcdpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.bcmeta'>Generic plot function for bcmeta object in jarbes.</h2><span id='topic+plot.bcmeta'></span>

<h3>Description</h3>

<p>Generic plot function for bcmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot.1 = "Model Components",
  title.plot.2 = "Bias Corrected Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bcmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the bcmeta function.</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_title.plot.1">title.plot.1</code></td>
<td>
<p>Text for the posterior means by component (biased and bias corrected).</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_title.plot.2">title.plot.2</code></td>
<td>
<p>Text for the posterior mean (pooled and predictive).</p>
</td></tr>
<tr><td><code id="plot.bcmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.bmeta'>Generic plot function for bmeta object in jarbes.</h2><span id='topic+plot.bmeta'></span>

<h3>Description</h3>

<p>Generic plot function for bmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot = "Simple Bayesian Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the bmeta function.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.bmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.dpmeta'>Generic plot function for bmeta object in jarbes.</h2><span id='topic+plot.dpmeta'></span>

<h3>Description</h3>

<p>Generic plot function for bmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot = "Simple Bayesian Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dpmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the bmeta function.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.dpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.dpmmeta'>Generic plot function for dpmeta object in jarbes.</h2><span id='topic+plot.dpmmeta'></span>

<h3>Description</h3>

<p>Generic plot function for dpmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmmeta'
plot(
  x,
  x.lim = c(-3, 3),
  y.lim = c(0, 2),
  x.lab = "Treatment Effect: log(OR)",
  y.lab = "Posterior",
  title.plot = "Simple Bayesian Meta-Analysis",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.dpmmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the bmeta function.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.dpmmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.hmr'>Generic plot function for hmr object in jarbes.</h2><span id='topic+plot.hmr'></span>

<h3>Description</h3>

<p>Generic plot function for hmr object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hmr'
plot(
  x,
  x.lim = c(-5, 2.8),
  y.lim = c(-2, 1),
  x.lab = "Event rate of The Control Group (logit scale)",
  y.lab = "No improvement &lt;- Effectiveness -&gt; Improvement",
  title.plot = "HMR: Effectiveness Against Baseline Risk",
  AD.colour = "red",
  IPD.colour = "blue",
  Study.Types = c("AD-RCTs", "IPD-RWD"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.hmr_+3A_x">x</code></td>
<td>
<p>The object generated by the hmr function.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_ad.colour">AD.colour</code></td>
<td>
<p>Colour of the location of the baseline risk of the aggregated data AD</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_ipd.colour">IPD.colour</code></td>
<td>
<p>Colour of the location of the baseline risk of the individual participant data (IPD) data</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_study.types">Study.Types</code></td>
<td>
<p>Vector of text for the label of the study types</p>
</td></tr>
<tr><td><code id="plot.hmr_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='plot.metarisk'>Generic plot function for metarisk object in jarbes.</h2><span id='topic+plot.metarisk'></span>

<h3>Description</h3>

<p>Generic plot function for metarisk object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metarisk'
plot(
  x,
  x.lim = c(-5, 2.8),
  y.lim = c(-2, 1),
  x.lab = "Rate of The Control Group (logit scale)",
  y.lab = "No improvement &lt;- Treatment effect -&gt; Improvement",
  title.plot = "Treatment Effect Against Baseline Risk",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.metarisk_+3A_x">x</code></td>
<td>
<p>The object generated by the metarisk function.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_x.lim">x.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the x-axis limits.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_y.lim">y.lim</code></td>
<td>
<p>Numeric vector of length 2 specifying the y-axis limits.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_x.lab">x.lab</code></td>
<td>
<p>Text with the label of the x-axis.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_y.lab">y.lab</code></td>
<td>
<p>Text with the label of the y-axis.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_title.plot">title.plot</code></td>
<td>
<p>Text for setting a title in the plot.</p>
</td></tr>
<tr><td><code id="plot.metarisk_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='ppvcap'>Efficacy of Pneumococcal Polysaccharide Vaccine in Preventing Community Acquired Pneumonia</h2><span id='topic+ppvcap'></span>

<h3>Description</h3>

<p>PPV23 (23-valent pneumococcal polysaccharide vaccine) with 16 Randomized Clinical Trials
(RCTs); outcome variable CAP (community-acquired pneumonia).
</p>
<p>This data frame corresponds to 16 randomized control trials (RCTs) reporting efficacy of
the PPV (Pneumococcal Polysaccharide) vaccine in preventing CAP (community acquired pneumonia).
The data frame contains the evaluation of Risk of Bias (RoB) of the trials and some study population
characteristics.
</p>


<h3>Format</h3>

<p>A matrix with 16 rows and 18 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>Name_Year</dt><dd><p>Name of the first author and year.</p>
</dd>
<dt>Year</dt><dd><p>Year of publication.</p>
</dd>
<dt>yt</dt><dd><p>Number of infections in the intervention group.</p>
</dd>
<dt>nt</dt><dd><p>Number of patients in the intervention group.</p>
</dd>
<dt>yc</dt><dd><p>Number of infections in the control group.</p>
</dd>
<dt>nc</dt><dd><p>Number of patients in the control group.</p>
</dd>
<dt>TE</dt><dd><p>Treatment Effect as Log Odds Ratio.</p>
</dd>
<dt>seTE</dt><dd><p>Standard Error of the TE.</p>
</dd>
<dt>logitPc</dt><dd><p>Observed baseline rate in logit scale.</p>
</dd>
<dt>N</dt><dd><p>Total sample size.</p>
</dd>
<dt>Study_Design</dt><dd><p>Description of the study design.</p>
</dd>
<dt>Intervention</dt><dd><p>Type of vaccine used for itervention.</p>
</dd>
<dt>Valency</dt><dd><p>0 = PPV23; 1 = PPV-Other.</p>
</dd>
<dt>low_income</dt><dd><p>Indicates low income patients population with 0 = no; 1 = yes.</p>
</dd>
<dt>R1</dt><dd><p>Random sequence generation (selection bias: low;high;unclear.</p>
</dd>
<dt>R2</dt><dd><p>Allocation concealment (selection bias): low;high;unclear.</p>
</dd>
<dt>R3</dt><dd><p>Confounding: low;high;unclear.</p>
</dd>
<dt>R4</dt><dd><p>Blinding of participants and personnel (performace bias): low;high;unclear.</p>
</dd>
<dt>R5</dt><dd><p>Blinding of outcome assessment (detection bias): low;high;unclear.</p>
</dd>
<dt>R6</dt><dd><p>Incomplete outcome data (attrition bias): low;high;unclear.</p>
</dd>
<dt>R7</dt><dd><p>Selective reporting (reporting bias): low;high;unclear.</p>
</dd>
<dt>Participants</dt><dd><p>Comments on patients characteristics.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtainded from: Moberley et al. (2013).
</p>


<h3>References</h3>

<p>Moberley, S., Holden, J., Tatham, D., and Andrews, R. (2013), Vaccines for preventing pneumococcal infection in adults., Cochrane Database of Systematic Reviews, Issue 1. Art. No.: CD000422. DOI:10.1002/14651858.CD000422.pub3.
</p>
<p>Verde, P.E. and Curcio, D. (2017) Hierarchical Meta-Regression Modelling: The Case of The Pneumococcal Polysaccharide Vaccine. Technical Report.
</p>

<hr>
<h2 id='ppvipd'>Efficacy of Pneumococcal Polysaccharide Vaccine in Preventing Invasive Pneumococcal Disease</h2><span id='topic+ppvipd'></span>

<h3>Description</h3>

<p>PPV23 (23-valent pneumococcal polysaccharide vaccine) with 3 Randomized Clinical Trials;
5 Cohort Studies and 3 Case-Control Studies.
</p>
<p>The outcome variable IPD (Invasive Pneumococcal Disease).
</p>


<h3>Format</h3>

<p>A matrix with 11 rows and 6 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>name</dt><dd><p>Name of the first author and year.</p>
</dd>
<dt>TE</dt><dd><p>Treatment Effect as Log Odds Ratio.</p>
</dd>
<dt>seTE</dt><dd><p>Standard Error of the TE.</p>
</dd>
<dt>n.v</dt><dd><p>Number of patients in the vaccination group.</p>
</dd>
<dt>n.c</dt><dd><p>Number of patients in the control group.</p>
</dd>
<dt>design</dt><dd><p>Description of the study design.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data were obtainded from: Falkenhorst et al. (2017).
</p>


<h3>References</h3>

<p>Falkenhorst, G., Remschmidt, C., Harder, T., Hummers-Pradier, E., Wichmann, O., and Bogdan, C. (2017) Effectiveness of the 23-Valent Pneumococcal Polysaccharide Vaccine(PPV23) against Pneumococcal Disease in the Elderly: Systematic Review and Meta-Analysis. PLoS ONE 12(1): e0169368. doi:10.1371/journal.pone.0169368.
</p>
<p>Verde, P.E. and Curcio, D. (2017) Hierarchical Meta-Regression Modelling: The Case of The Pneumococcal Polysaccharide Vaccine. Technical Report.
</p>

<hr>
<h2 id='print.b3lmeta'>Generic print function for b3lmeta object in jarbes.</h2><span id='topic+print.b3lmeta'></span>

<h3>Description</h3>

<p>Generic print function for b3lmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'b3lmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.b3lmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function b3lmeta.</p>
</td></tr>
<tr><td><code id="print.b3lmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.b3lmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.bcdpmeta'>Generic print function for bcdpmeta object in jarbes.</h2><span id='topic+print.bcdpmeta'></span>

<h3>Description</h3>

<p>Generic print function for bcdpmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdpmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcdpmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function bcdpmeta.</p>
</td></tr>
<tr><td><code id="print.bcdpmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.bcdpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.bcmeta'>Generic print function for bcmeta object in jarbes.</h2><span id='topic+print.bcmeta'></span>

<h3>Description</h3>

<p>Generic print function for bcmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function bcmeta.</p>
</td></tr>
<tr><td><code id="print.bcmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.bcmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.bcmixmeta'>Generic print function for bcmixmeta object in jarbes.</h2><span id='topic+print.bcmixmeta'></span>

<h3>Description</h3>

<p>Generic print function for bcmixmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmixmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcmixmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function bcmixmeta.</p>
</td></tr>
<tr><td><code id="print.bcmixmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.bcmixmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.bmeta'>Generic print function for bcmeta object in jarbes.</h2><span id='topic+print.bmeta'></span>

<h3>Description</h3>

<p>Generic print function for bcmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function bcmeta.</p>
</td></tr>
<tr><td><code id="print.bmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.bmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.dpmeta'>Generic print function for dpmeta object in jarbes.</h2><span id='topic+print.dpmeta'></span>

<h3>Description</h3>

<p>Generic print function for dpmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dpmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function dpmeta.</p>
</td></tr>
<tr><td><code id="print.dpmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.dpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.dpmetareg'>Generic print function for dpmeta object in jarbes.</h2><span id='topic+print.dpmetareg'></span>

<h3>Description</h3>

<p>Generic print function for dpmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmetareg'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dpmetareg_+3A_x">x</code></td>
<td>
<p>The object generated by the function dpmmeta.</p>
</td></tr>
<tr><td><code id="print.dpmetareg_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.dpmetareg_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.dpmmeta'>Generic print function for dpmmeta object in jarbes.</h2><span id='topic+print.dpmmeta'></span>

<h3>Description</h3>

<p>Generic print function for dpmmeta object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmmeta'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.dpmmeta_+3A_x">x</code></td>
<td>
<p>The object generated by the function dpmmeta.</p>
</td></tr>
<tr><td><code id="print.dpmmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.dpmmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.hmr'>Generic print function for hmr object in jarbes.</h2><span id='topic+print.hmr'></span>

<h3>Description</h3>

<p>Generic print function for hmr object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hmr'
print(x, digits = 3, intervals = c(0.025, 0.25, 0.5, 0.75, 0.975), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.hmr_+3A_x">x</code></td>
<td>
<p>The object generated by the function hmr.</p>
</td></tr>
<tr><td><code id="print.hmr_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.hmr_+3A_intervals">intervals</code></td>
<td>
<p>A numeric vector of probabilities with values in [0,1]. The default value is
intervals = c(0.025, 0.5, 0.975).</p>
</td></tr>
<tr><td><code id="print.hmr_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='print.metarisk'>Generic print function for metarisk object in jarbes.</h2><span id='topic+print.metarisk'></span>

<h3>Description</h3>

<p>Generic print function for metarisk object in jarbes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metarisk'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.metarisk_+3A_x">x</code></td>
<td>
<p>The object generated by the function metarisk.</p>
</td></tr>
<tr><td><code id="print.metarisk_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="print.metarisk_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='stemcells'>Meta-analysis of 31 randomized controled trials (RCTs) with reported discrepancies</h2><span id='topic+stemcells'></span>

<h3>Description</h3>

<p>Meta-analysis of 31 randomized controled trials (RCTs) of two treatment groups
of heart disease patients, where the treatment group received bone marrow stem
cells and the control group a placebo treatment.
</p>


<h3>Format</h3>

<p>A matrix with 31 rows and 11 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>trial</dt><dd><p>ID name of the trial.</p>
</dd>
<dt>effect.size</dt><dd><p>treatment effect is measured as the difference of the
ejection fraction between groups, which measures the improvement of
left ventricular function in the heart.</p>
</dd>
<dt>se.effect</dt><dd><p>Standard Error of the effect.size.</p>
</dd>
<dt>sample.size</dt><dd><p>Total number of patients in the trial.</p>
</dd>
<dt>n.discrep</dt><dd><p>Number of detected discrepancies in the published trial.
Discrepancies are defined as two or more reported facts that cannot both be
true because they are logically or mathematically incompatible.</p>
</dd>
<dt>Sequence</dt><dd><p>Bias arising from the randomization process.</p>
</dd>
<dt>Allocation</dt><dd><p>Bias due to deviations from intended interventions.</p>
</dd>
<dt>Blinding</dt><dd><p>Bias introduced by lack of blinding.</p>
</dd>
<dt>Outcome</dt><dd><p>Bias in measurement of the outcome.</p>
</dd>
<dt>Reporting</dt><dd><p>Bias in selection of the reported result.</p>
</dd>
<dt>Other</dt><dd><p>Selection bias, performance bias, detection bias, attrition bias, etc.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Nowbar, A N, et al. (2014) Discrepancies in autologous bone marrow stem cell trials and enhancemen of ejection fraction (DAMASCENE): weighted regression and meta-analysis. BMJ, 348,1-9.
</p>


<h3>References</h3>

<p>Verde, P. E. (2017) Two Examples of Bayesian Evidence Synthesis with the Hierarchical Meta-Regression Approach. Chap.9, pag 189-206. Bayesian Inference, ed. Tejedor, Javier Prieto. InTech.
</p>

<hr>
<h2 id='summary.b3lmeta'>Generic summary function for bmeta object in jarbes</h2><span id='topic+summary.b3lmeta'></span>

<h3>Description</h3>

<p>Generic summary function for bmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'b3lmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.b3lmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the bmeta function.</p>
</td></tr>
<tr><td><code id="summary.b3lmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.b3lmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.bcdpmeta'>Generic summary function for bcdpmeta object in jarbes</h2><span id='topic+summary.bcdpmeta'></span>

<h3>Description</h3>

<p>Generic summary function for bcdpmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcdpmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bcdpmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the bcmeta function.</p>
</td></tr>
<tr><td><code id="summary.bcdpmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.bcdpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.bcmeta'>Generic summary function for bcmeta object in jarbes</h2><span id='topic+summary.bcmeta'></span>

<h3>Description</h3>

<p>Generic summary function for bcmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bcmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the bcmeta function.</p>
</td></tr>
<tr><td><code id="summary.bcmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.bcmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.bmeta'>Generic summary function for bmeta object in jarbes</h2><span id='topic+summary.bmeta'></span>

<h3>Description</h3>

<p>Generic summary function for bmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the bmeta function.</p>
</td></tr>
<tr><td><code id="summary.bmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.bmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.dpmeta'>Generic summary function for dpmmeta object in jarbes</h2><span id='topic+summary.dpmeta'></span>

<h3>Description</h3>

<p>Generic summary function for dpmmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.dpmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the dmpmeta function.</p>
</td></tr>
<tr><td><code id="summary.dpmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.dpmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.dpmmeta'>Generic summary function for dpmmeta object in jarbes</h2><span id='topic+summary.dpmmeta'></span>

<h3>Description</h3>

<p>Generic summary function for dpmmeta object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'dpmmeta'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.dpmmeta_+3A_object">object</code></td>
<td>
<p>The object generated by the dmpmeta function.</p>
</td></tr>
<tr><td><code id="summary.dpmmeta_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.dpmmeta_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.hmr'>Generic summary function for hmr object in jarbes</h2><span id='topic+summary.hmr'></span>

<h3>Description</h3>

<p>Generic summary function for hmr object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hmr'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.hmr_+3A_object">object</code></td>
<td>
<p>The object generated by the hmr function.</p>
</td></tr>
<tr><td><code id="summary.hmr_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.hmr_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='summary.metarisk'>Generic summary function for metarisk object in jarbes</h2><span id='topic+summary.metarisk'></span>

<h3>Description</h3>

<p>Generic summary function for metarisk object in jarbes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'metarisk'
summary(object, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.metarisk_+3A_object">object</code></td>
<td>
<p>The object generated by the metarisk function.</p>
</td></tr>
<tr><td><code id="summary.metarisk_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits printed. The default value is 3.</p>
</td></tr>
<tr><td><code id="summary.metarisk_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>

<hr>
<h2 id='trisomy21'>Meta-analysis: Observational studies assessing the relationship of
a positive ICPC (Isolated Choroid Plexus Cyst) on Trisomy 21</h2><span id='topic+trisomy21'></span>

<h3>Description</h3>

<p>Meta-analysis of 22 Observational Studies from PubMed, Cochrane Library and SciELO databases
that assessed the relationship of a positive ICPC (Isolated Choroid Plexus Cyst) on Trisomy 21
</p>


<h3>Format</h3>

<p>A dataframe with 22 rows and 6 columns. Each row represents study results, the columns are:
</p>

<dl>
<dt>year</dt><dd><p>Year of publication.</p>
</dd>
<dt>author</dt><dd><p>Principal author of the publication.</p>
</dd>
<dt>y</dt><dd><p>Number of cases of ICPC with Trisomy 21.</p>
</dd>
<dt>n</dt><dd><p>Total number o cases with ICPC.</p>
</dd>
<dt>mean.GA</dt><dd><p>Mean gestational time in weeks.</p>
</dd>
<dt>study.design</dt><dd><p>Study design: prospective or retrospective cohort.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kürten C, Knippel A, Verde P, Kozlowski P. A Bayesian risk analysis for Trisomy 21 in isolated choroid plexus cyst: combining a prenatal database with a meta-analysis. J Matern Fetal Neonatal Med. 2019 Jun 11:1-9. doi: 10.1080/14767058.2019.1622666. Epub ahead of print. PMID: 31113245.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
