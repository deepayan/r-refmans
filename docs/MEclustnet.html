<!DOCTYPE html><html lang="en"><head><title>Help for package MEclustnet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MEclustnet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MEclustnet'><p>MEclustnet: A package for model-based clustering of nodes in a network,</p>
accounting for covariates.</a></li>
<li><a href='#calclambda'><p>Title Compute mixing proportions</p></a></li>
<li><a href='#calcloglikelihood'><p>Calculate the log likelihood function of the data.</p></a></li>
<li><a href='#calcm'><p>Totals the number of observations in each cluster.</p></a></li>
<li><a href='#calcpis'><p>Calculate link probabilities.</p></a></li>
<li><a href='#formatting.covars'><p>Reformat matrix of covariates.</p></a></li>
<li><a href='#invariant'><p>Account for invariance of configurations.</p></a></li>
<li><a href='#labelswitch'><p>Label switching correction.</p></a></li>
<li><a href='#lawyers.adjacency.advice'><p>Adjacency matrix detailing the presence or absence of advice links</p>
between the &lsquo;Lazega Lawyers&rsquo;.</a></li>
<li><a href='#lawyers.adjacency.coworkers'><p>Adjacency matrix detailing the presence or absence of coworker</p>
links between the &lsquo;Lazega Lawyers&rsquo;.</a></li>
<li><a href='#lawyers.adjacency.friends'><p>Adjacency matrix detailing the presence or absence of friendship</p>
links between the &lsquo;Lazega Lawyers&rsquo;.</a></li>
<li><a href='#lawyers.covariates'><p>A matrix of covariates of the &lsquo;Lazega Lawyers&rsquo;.</p></a></li>
<li><a href='#plotMEclustnet'><p>Plot latent position network.</p></a></li>
<li><a href='#summaryMEclustnet'><p>Summary of MEclustnet object.</p></a></li>
<li><a href='#updatebeta'><p>Update the logistic regression parameters in the link probabilities model.</p></a></li>
<li><a href='#updateK'><p>Update the cluster membership vector.</p></a></li>
<li><a href='#updatemu'><p>Update the mean of each cluster.</p></a></li>
<li><a href='#updatesigma2'><p>Update variances in each cluster.</p></a></li>
<li><a href='#updatetau'><p>Update the logistic regression parameters in the mixing proportions model.</p></a></li>
<li><a href='#updatez'><p>Update step for the latent locations.</p></a></li>
<li><a href='#us.twitter.adjacency'><p>Directed adjacency matrix detailing the presence or absence</p>
of Twitter friend/follower links between US politicians.</a></li>
<li><a href='#us.twitter.covariates'><p>A matrix of covariates of the US politicians.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fit the Mixture of Experts Latent Position Cluster Model to
Network Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to facilitate model-based clustering of nodes in a network in a mixture of experts setting, which incorporates covariate information on the nodes in the modelling process. Isobel Claire Gormley and Thomas Brendan Murphy (2010) &lt;<a href="https://doi.org/10.1016%2Fj.stamet.2010.01.002">doi:10.1016/j.stamet.2010.01.002</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mvtnorm, nnet, ellipse, latentnet, vegan, e1071</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-10 08:50:57 UTC; clairegormley</td>
</tr>
<tr>
<td>Author:</td>
<td>Isobel Claire Gormley [aut, cre],
  Thomas Brendan Murphy [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Isobel Claire Gormley &lt;claire.gormley@ucd.ie&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-10 11:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='MEclustnet'>MEclustnet: A package for model-based clustering of nodes in a network,
accounting for covariates.</h2><span id='topic+MEclustnet'></span><span id='topic+MEclustnet-package'></span>

<h3>Description</h3>

<p>The main function of interest is MEclustnet which will fit a mixture
of experts latent position cluster model to a binary network.
</p>
<p>MEclustnet will fit a mixture of experts latent position cluster model to a binary network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MEclustnet(Y, covars, link.vars = c(1:ncol(covars)),
  mix.vars = c(1:ncol(covars)), G = 2, d = 2, itermax = 10000,
  uphill = 100, burnin = 1000, thin = 10, rho.input = 1,
  verbose = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MEclustnet_+3A_y">Y</code></td>
<td>
<p>An n x n binary matrix of links between n nodes, with 0 on the diagonal and 1 indicating a link.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_covars">covars</code></td>
<td>
<p>An n x p data frame of node specific covariates. Categorical variables should be factors. First column should be a column of 1s, and should always be passed in.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_link.vars">link.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in link probability model. If none are to be included, this argument should be 1.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_mix.vars">mix.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in mixing proportions model. If none are to be included, argument should be 1.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_g">G</code></td>
<td>
<p>The number of clusters in the model to be fitted.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_d">d</code></td>
<td>
<p>The dimension of the latent space.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_itermax">itermax</code></td>
<td>
<p>Maximum number of iterations in the MCMC chain.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_uphill">uphill</code></td>
<td>
<p>Number of iterations for which uphill only steps in the MCMC chain should be run to find <em>maximum a posteriori</em> estimates.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_burnin">burnin</code></td>
<td>
<p>Number of burnin iterations in the MCMC chain.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_thin">thin</code></td>
<td>
<p>The degree of thinning to be applied to the MCMC chain.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_rho.input">rho.input</code></td>
<td>
<p>Scaling factor to achieve desirable acceptance rates in Metropolis-Hastings steps.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_verbose">verbose</code></td>
<td>
<p>Print progress updates to screen? Recommended as the models are slow to run.</p>
</td></tr>
<tr><td><code id="MEclustnet_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function fits the mixture of experts latent position cluster model to a binary network via a Metropolis-within-Gibbs sampler. Covariates can influence either the link probabilities between nodes and/or the cluster memberships of nodes.
</p>


<h3>Value</h3>

<p>An object of class <code>MEclustnet</code>, which is a list containing:
</p>

<dl>
<dt>zstore</dt><dd><p>An n x d x store.dim array of sampled latent location matrices, where store.dim is the number of post burnin thinned iterations.</p>
</dd>
<dt>betastore</dt><dd><p>A store.dim x p matrix of sampled beta vectors, the logistic regression parameters of the link probabilities model.</p>
</dd>
<dt>Kstore</dt><dd><p>A store.dim x n matrix of sampled cluster membership vectors.</p>
</dd>
<dt>mustore</dt><dd><p>A G x d x store.dim array of sampled cluster mean latent location matrices.</p>
</dd>
<dt>sigma2store</dt><dd><p>A store.dim x G matrix of sampled cluster variances.</p>
</dd>
<dt>lambdastore</dt><dd><p>An n x G x store.dim array of sampled mixing proportion matrices.</p>
</dd>
<dt>taustore</dt><dd><p>A G x s x store.dim array of sampled tau vectors, the logistic regression parameters of the mixing proportions model, where s is the length of tau.</p>
</dd>
<dt>LLstore</dt><dd><p>A vector of length store.dim storing the loglikelihood from each stored iteration.</p>
</dd>
<dt>G</dt><dd><p>The number of clusters fitted</p>
</dd>
<dt>d</dt><dd><p>The dimension of the latent space</p>
</dd>
<dt>countbeta</dt><dd><p>Count of accepted beta values</p>
</dd>
<dt>counttau</dt><dd><p>Count of accepted tau values</p>
</dd>
</dl>



<h3>MEclustnet functions</h3>

<p>MEclustnet
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################################################################
# An example from the Gormley and Murphy (2010) paper, using the Lazega lawyers friendship network.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(lawyers.adjacency.friends)
data(lawyers.covariates)

link.vars = c(1)
mix.vars = c(1,4,5)

fit = MEclustnet(lawyers.adjacency.friends, lawyers.covariates,
link.vars, mix.vars, G=2, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, lawyers.adjacency.friends)
plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, lawyers.adjacency.friends, link.vars, mix.vars)

#################################################################
# An example analysing a 2016 Twitter network of US politicians.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(us.twitter.adjacency)
data(us.twitter.covariates)

link.vars = c(1)
mix.vars = c(1,5,7,8)

fit = MEclustnet(us.twitter.adjacency, us.twitter.covariates,
link.vars, mix.vars, G=4, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, us.twitter.adjacency)

plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, us.twitter.adjacency, link.vars, mix.vars)

# Examine which politicians are in which clusters...
clusters = list()
for(g in 1:fit$G)
{
  clusters[[g]] = us.twitter.covariates[summ$Kmode==g,c("name", "party")]
}
clusters

</code></pre>

<hr>
<h2 id='calclambda'>Title Compute mixing proportions</h2><span id='topic+calclambda'></span>

<h3>Description</h3>

<p>Function to compute the each observation's mixing proportions which are modeled as a logistic function of their covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calclambda(tau, x.mix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calclambda_+3A_tau">tau</code></td>
<td>
<p>A matrix of logistic regression coefficients, with G rows and number of columns equal to the number of covariates in the mixing proportions model plus 1, for the intercept.</p>
</td></tr>
<tr><td><code id="calclambda_+3A_x.mix">x.mix</code></td>
<td>
<p>A matrix of covariates in the mixing proportions model (including dummy variables for any factor covariates), with a column of 1's appended at the front.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n x G matrix of mixing proportions.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='calcloglikelihood'>Calculate the log likelihood function of the data.</h2><span id='topic+calcloglikelihood'></span>

<h3>Description</h3>

<p>This function calculates the log likelihood function of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcloglikelihood(pis, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcloglikelihood_+3A_pis">pis</code></td>
<td>
<p>Vector of link probabilities.</p>
</td></tr>
<tr><td><code id="calcloglikelihood_+3A_y">y</code></td>
<td>
<p>Vector version of the adjacency matrix, with the diagonal removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the log likelihood function.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='calcm'>Totals the number of observations in each cluster.</h2><span id='topic+calcm'></span>

<h3>Description</h3>

<p>Update the count of the number of observations in each cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcm(m, G, K)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcm_+3A_m">m</code></td>
<td>
<p>Vector of length G containing the number of nodes in each cluster.</p>
</td></tr>
<tr><td><code id="calcm_+3A_g">G</code></td>
<td>
<p>The number of clusters in the model being fitted.</p>
</td></tr>
<tr><td><code id="calcm_+3A_k">K</code></td>
<td>
<p>Vector of length n detailing the number of the cluster to which each node belongs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of length G containing the number of nodes in each cluster.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='calcpis'>Calculate link probabilities.</h2><span id='topic+calcpis'></span>

<h3>Description</h3>

<p>Function calculates link probabilities between nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calcpis(beta, x.link, delta, n.tilde)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calcpis_+3A_beta">beta</code></td>
<td>
<p>Vector of regression coefficients in the link probabilities.</p>
</td></tr>
<tr><td><code id="calcpis_+3A_x.link">x.link</code></td>
<td>
<p>Matrix, with <code class="reqn">n^2 - n</code> rows and the same number of columns as covariates (including the intercept), giving the differences in covariates for all pairs of nodes.</p>
</td></tr>
<tr><td><code id="calcpis_+3A_delta">delta</code></td>
<td>
<p>Vector of Euclidean distances between locations in the latent space of all pairs of nodes.</p>
</td></tr>
<tr><td><code id="calcpis_+3A_n.tilde">n.tilde</code></td>
<td>
<p>Length of the vector version of the adjacency matrix, with the diagonal removed i.e. <code class="reqn">n^2 - n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of length <code class="reqn">n^2 - n</code> providing the link probabilities between all pairs of nodes.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='formatting.covars'>Reformat matrix of covariates.</h2><span id='topic+formatting.covars'></span>

<h3>Description</h3>

<p>This function reformats the matrix of input covariates into the required format for the link probabilities and for the mixing proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatting.covars(covars, link.vars, mix.vars, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="formatting.covars_+3A_covars">covars</code></td>
<td>
<p>The n x p data frame of node specific covariates passed in to the overall <code><a href="#topic+MEclustnet">MEclustnet</a></code> function. The first column should be a column of 1's and categorical variables should be factors.</p>
</td></tr>
<tr><td><code id="formatting.covars_+3A_link.vars">link.vars</code></td>
<td>
<p>A vector detailing the column numbers of the matrix covars that should be included in the link probabilities model.</p>
</td></tr>
<tr><td><code id="formatting.covars_+3A_mix.vars">mix.vars</code></td>
<td>
<p>A vector detailing the column numbers of the matrix covars that should be included in the mixing proportions probabilities model.</p>
</td></tr>
<tr><td><code id="formatting.covars_+3A_n">n</code></td>
<td>
<p>The number of nodes in the network.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the link regression model, the difference in the link.vars covariates, for all pairs of nodes is calculated.
For the mixing proportions model, the required representation of the mix.vars required is formed, where for categorical/factor variables a dummy value representation is used.
</p>


<h3>Value</h3>

<p>A list with
</p>

<dl>
<dt>x.link </dt><dd><p>A matrix with <code class="reqn">n^2</code> rows and length(link.vars) columns, detailing the differences in covariates for all pairs of nodes.</p>
</dd>
<dt>x.mix </dt><dd><p>A matrix with n rows and number of columns equal to the number of variables detailed in mix.vars, where dummy variable representations will be used for categorical.factor covariates.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(us.twitter.covariates)
link.vars = c(1)
mix.vars = c(1,5,7,8)
res = formatting.covars(us.twitter.covariates, link.vars, mix.vars, nrow(us.twitter.covariates))
dim(res$x.link)
dim(res$x.mix)
</code></pre>

<hr>
<h2 id='invariant'>Account for invariance of configurations.</h2><span id='topic+invariant'></span>

<h3>Description</h3>

<p>This function accounts for the fact that configurations in the latent space are invariant to rotations, reflections and translations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invariant(z, zMAP)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="invariant_+3A_z">z</code></td>
<td>
<p>An n x d matrix of latent locations in the d dimensional space for each of n nodes.</p>
</td></tr>
<tr><td><code id="invariant_+3A_zmap">zMAP</code></td>
<td>
<p>The <em>maximum a posteriori</em> configuration of latent locations used as the template to which all sampled configurations are mapped.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Procrustean rotations, reflections and translations (note: NOT dilations) are employed to best match z to zMAP.
</p>


<h3>Value</h3>

<p>The transformed version of the input configuration z that best matches zMAP.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='labelswitch'>Label switching correction.</h2><span id='topic+labelswitch'></span>

<h3>Description</h3>

<p>This function corrects for the issue of label switching when fitting mixture models in a Bayesian setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>labelswitch(mu, sigma2, lambda, tau, K, G, d, perms, muMAP, iter, uphill,
  burnin, thin, s, x.mix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="labelswitch_+3A_mu">mu</code></td>
<td>
<p>A G x d matrix of mean latent locations.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_sigma2">sigma2</code></td>
<td>
<p>A vector of length G containing the covariance of the latent locations within each cluster.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_lambda">lambda</code></td>
<td>
<p>An n x G matrix of mixing proportions.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_tau">tau</code></td>
<td>
<p>A matrix of logistic regression coefficients, with G rows and number of columns equal to the number of covariates in the mixing proportions model plus 1, for the intercept.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_k">K</code></td>
<td>
<p>Vector of length n detailing the number of the cluster to which each node belongs.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_g">G</code></td>
<td>
<p>The number of clusters in the model being fitted.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_d">d</code></td>
<td>
<p>The dimension of the latent space.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_perms">perms</code></td>
<td>
<p>A G! x G matrix of all possible permutations of 1:G (output by permutations(G), say).</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_mumap">muMAP</code></td>
<td>
<p>A G x d matrix of <em>maximum a posteriori</em> latent location means, obtained at the end of the uphill only section of the MCMC chain. Used as the template to correct for label switching.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_iter">iter</code></td>
<td>
<p>Iteration number.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_uphill">uphill</code></td>
<td>
<p>Number of iterations for which uphill only steps in the MCMC chain should be run.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_burnin">burnin</code></td>
<td>
<p>Number of iterations of the MCMC chain which should not be included in <em>a posteriori</em> summaries.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_thin">thin</code></td>
<td>
<p>Thinning frequency of the MCMC chain to ensure independent samples.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_s">s</code></td>
<td>
<p>Number of columns in the reformatted covariates matrix for the mixing proportions model, output by <code><a href="#topic+formatting.covars">formatting.covars</a></code>.</p>
</td></tr>
<tr><td><code id="labelswitch_+3A_x.mix">x.mix</code></td>
<td>
<p>The reformatted covariates matrix for the mixing proportions model, output by <code><a href="#topic+formatting.covars">formatting.covars</a>.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The muMAP matrix is used as the reference to which each new estimate the cluster means is matched to correct for any label switching which may have occurred during sampling. A sum of squares function is employed as the loss function.
</p>


<h3>Value</h3>

<p>A list containing:list(mu, sigma2, lambda, tau, K)
</p>

<dl>
<dt>mu</dt><dd><p>The label-corrected matrix of cluster means.</p>
</dd>
<dt>sigma2</dt><dd><p>The label-corrected vector of cluster covariances.</p>
</dd>
<dt>lambda</dt><dd><p>The label-corrected matrix of mixing proportions.</p>
</dd>
<dt>tau</dt><dd><p>The label-corrected matrix of logistic regression coefficients for the mixing proportions model.</p>
</dd>
<dt>K</dt><dd><p>The label-corrected vector of length n detailing the number of the cluster to which each node belongs.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='lawyers.adjacency.advice'>Adjacency matrix detailing the presence or absence of advice links
between the &lsquo;Lazega Lawyers&rsquo;.</h2><span id='topic+lawyers.adjacency.advice'></span>

<h3>Description</h3>

<p>Data on whether or not 71 lawyers in a northeastern American law firm
asked each other for advice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lawyers.adjacency.advice
</code></pre>


<h3>Format</h3>

<p>A 71 x 71 binary matrix, with 0 down the diagonal.</p>


<h3>Source</h3>

<p>E. Lazega, The Collegial Phenomenon: The Social Mechanisms of Cooperation
Among Peers in a Corporate Law Partnership, Oxford University Press, Oxford, England, 2001.
</p>

<hr>
<h2 id='lawyers.adjacency.coworkers'>Adjacency matrix detailing the presence or absence of coworker
links between the &lsquo;Lazega Lawyers&rsquo;.</h2><span id='topic+lawyers.adjacency.coworkers'></span>

<h3>Description</h3>

<p>Data on whether or not 71 lawyers in a northeastern American law
firm work with each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lawyers.adjacency.coworkers
</code></pre>


<h3>Format</h3>

<p>A 71 x 71 binary matrix, with 0 down the diagonal.</p>


<h3>Source</h3>

<p>E. Lazega, The Collegial Phenomenon: The Social Mechanisms of Cooperation
Among Peers in a Corporate Law Partnership, Oxford University Press, Oxford, England, 2001.
</p>

<hr>
<h2 id='lawyers.adjacency.friends'>Adjacency matrix detailing the presence or absence of friendship
links between the &lsquo;Lazega Lawyers&rsquo;.</h2><span id='topic+lawyers.adjacency.friends'></span>

<h3>Description</h3>

<p>Data on whether or not 71 lawyers in a northeastern American law
firm are friends outside of work.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lawyers.adjacency.friends
</code></pre>


<h3>Format</h3>

<p>A 71 x 71 binary matrix, with 0 down the diagonal.</p>


<h3>Source</h3>

<p>E. Lazega, The Collegial Phenomenon: The Social Mechanisms of Cooperation
Among Peers in a Corporate Law Partnership, Oxford University Press, Oxford, England, 2001.
</p>

<hr>
<h2 id='lawyers.covariates'>A matrix of covariates of the &lsquo;Lazega Lawyers&rsquo;.</h2><span id='topic+lawyers.covariates'></span>

<h3>Description</h3>

<p>Covariates on each of 71 lawyers in a northeastern American law firm.
Note the first column is a column of 1's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lawyers.covariates
</code></pre>


<h3>Format</h3>

<p>A data frame with 71 observations on the following 8 variables.
</p>

<dl>
<dt><code>Intercept</code></dt><dd><p>a column of 1s should always be the first column.</p>
</dd>
<dt><code>Seniority</code></dt><dd><p>a factor with levels <code>1</code> = partner, <code>2</code> = associate.</p>
</dd>
<dt><code>Gender</code></dt><dd><p>a factor with <code>1</code> = male, <code>2</code> = female.</p>
</dd>
<dt><code>Office</code></dt><dd><p>a factor with levels <code>1</code> = Boston, <code>2</code> = Hartford and <code>3</code> = Providence</p>
</dd>
<dt><code>Years</code></dt><dd><p>a numeric vector detailing years with the firm.</p>
</dd>
<dt><code>Age</code></dt><dd><p>a numeric vector detailing the age of each lawyer.</p>
</dd>
<dt><code>Practice</code></dt><dd><p>a factor with levels <code>1</code> = litigation and <code>2</code> = corporate.</p>
</dd>
<dt><code>School</code></dt><dd><p>a factor with levels <code>1</code> = Harvard or Yale, <code>2</code> = University of Connecticut and <code>3</code> = Other.</p>
</dd>
</dl>


<h3>Source</h3>

<p>E. Lazega, The Collegial Phenomenon: The Social Mechanisms of Cooperation
Among Peers in a Corporate Law Partnership, Oxford University Press, Oxford, England, 2001.
</p>

<hr>
<h2 id='plotMEclustnet'>Plot latent position network.</h2><span id='topic+plotMEclustnet'></span>

<h3>Description</h3>

<p>Function to plot the resulting fitted network, using first two dimensions only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMEclustnet(fit, Y, link.vars, mix.vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotMEclustnet_+3A_fit">fit</code></td>
<td>
<p>An object storing the output of the function <code><a href="#topic+MEclustnet">MEclustnet</a></code>.</p>
</td></tr>
<tr><td><code id="plotMEclustnet_+3A_y">Y</code></td>
<td>
<p>The n x n binary adjacency matrix, with 0 down the diagonal, that was passed to <code><a href="#topic+MEclustnet">MEclustnet</a></code>.</p>
</td></tr>
<tr><td><code id="plotMEclustnet_+3A_link.vars">link.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in link probability model. If none are to be included, this argument should be 1.</p>
</td></tr>
<tr><td><code id="plotMEclustnet_+3A_mix.vars">mix.vars</code></td>
<td>
<p>A vector of the column numbers of the data frame <code>covars</code> to be included in mixing proportions model. If none are to be included, argument should be 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function will plot the posterior mean latent location for each node in the network. The colour of each node reflects the posterior modal cluster membership, and the ellipses are 50% posterior sets illustrating the uncertainty in the latent locations. The grey lines illustrate the observed links between the nodes.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################################################################
# An example analysing a 2016 Twitter network of US politicians.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(us.twitter.adjacency)
data(us.twitter.covariates)

link.vars = c(1)
mix.vars = c(1,5,7,8)

fit = MEclustnet(us.twitter.adjacency, us.twitter.covariates,
           link.vars, mix.vars, G=4, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, us.twitter.adjacency)

plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, us.twitter.adjacency, link.vars, mix.vars)

# Examine which politicians are in which clusters...
clusters = list()
for(g in 1:fit$G)
{
  clusters[[g]] = us.twitter.covariates[summ$Kmode==g,c("name", "party")]
}
clusters


</code></pre>

<hr>
<h2 id='summaryMEclustnet'>Summary of MEclustnet object.</h2><span id='topic+summaryMEclustnet'></span>

<h3>Description</h3>

<p>Summary of the output of the function MEclustnet which fits a mixture of experts latent position cluster model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryMEclustnet(fit, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryMEclustnet_+3A_fit">fit</code></td>
<td>
<p>An object storing the output of the function <code><a href="#topic+MEclustnet">MEclustnet</a></code>.</p>
</td></tr>
<tr><td><code id="summaryMEclustnet_+3A_y">Y</code></td>
<td>
<p>The n x n binary adjacency matrix, with 0 down the diagonal, that was passed to <code><a href="#topic+MEclustnet">MEclustnet</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>

<dl>
<dt>AICM</dt><dd><p>The value of the AICM criterion for the fitted model.</p>
</dd>
<dt>BICM</dt><dd><p>The value of the BICM criterion for the fitted model.</p>
</dd>
<dt>BICMCMC</dt><dd><p>The value of the BICMCMC criterion for the fitted model.</p>
</dd>
<dt>betamean</dt><dd><p>The posterior mean vector of the regression coefficients for the link probabilities model.</p>
</dd>
<dt>betasd</dt><dd><p>The standard deviation of the posterior distribution of beta.</p>
</dd>
<dt>taumean</dt><dd><p>A matrix with G rows, detailing the posterior mean of the regression coefficients for the mixing proportions  model.</p>
</dd>
<dt>tausd</dt><dd><p>The standard deviation of the posterior distribution of tau.</p>
</dd>
<dt>mumean</dt><dd><p>A G x d matrix containing the posterior mean of the latent locations' mean.</p>
</dd>
<dt>meansd</dt><dd><p>The standard deviation of the posterior distribution of mu.</p>
</dd>
<dt>sigma2mean</dt><dd><p>A vector of length G containing the posterior mean of the latent locations' covariance.</p>
</dd>
<dt>sigma2sd</dt><dd><p>The standard deviation of the posterior distribution of the latent locations' covariance.</p>
</dd>
<dt>Kmode</dt><dd><p>A vector of length n detailing the posterior modal cluster membership for each node.</p>
</dd>
<dt>zmean</dt><dd><p>An n x d matrix containing the posterior mean latent location for each node.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#################################################################
# An example analysing a 2016 Twitter network of US politicians.
#################################################################
# Number of iterations etc. are set to low values for illustrative purposes.
# Longer run times are likely to be required to achieve sufficient mixing.

library(latentnet)
data(us.twitter.adjacency)
data(us.twitter.covariates)

link.vars = c(1)
mix.vars = c(1,5,7,8)

fit = MEclustnet(us.twitter.adjacency, us.twitter.covariates,
 link.vars, mix.vars, G=4, d=2, itermax = 500, burnin = 50, uphill = 1, thin=10)

# Plot the trace plot of the mean of dimension 1 for each cluster.
matplot(t(fit$mustore[,1,]), type="l", xlab="Iteration", ylab="Parameter")

# Compute posterior summaries
summ = summaryMEclustnet(fit, us.twitter.adjacency)

plot(summ$zmean, col=summ$Kmode, xlab="Dimension 1", ylab="Dimension 2", pch=summ$Kmode,
     main = "Posterior mean latent location for each node.")

# Plot the resulting latent space, with uncertainties
plotMEclustnet(fit, us.twitter.adjacency, link.vars, mix.vars)

# Examine which politicians are in which clusters...
clusters = list()
for(g in 1:fit$G)
{
  clusters[[g]] = us.twitter.covariates[summ$Kmode==g,c("name", "party")]
}
clusters

</code></pre>

<hr>
<h2 id='updatebeta'>Update the logistic regression parameters in the link probabilities model.</h2><span id='topic+updatebeta'></span>

<h3>Description</h3>

<p>The Metropolis-Hastings update step for the logistic regression parameters in the link probabilities model, using a surrogate proposal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatebeta(beta, p, x.link, delta, y, epsilon, psi, psi.inv, pis,
  countbeta, rho, n.tilde)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatebeta_+3A_beta">beta</code></td>
<td>
<p>Vector of regression coefficients in the link probabilities.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_p">p</code></td>
<td>
<p>Length of beta.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_x.link">x.link</code></td>
<td>
<p>Matrix, with <code class="reqn">n^2 - n</code> rows and the same number of columns as covariates (including the intercept), giving the differences in covariates for all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_delta">delta</code></td>
<td>
<p>Vector of Euclidean distances between locations in the latent space of all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_y">y</code></td>
<td>
<p>Vector version of the adjacency matrix, with the diagonal removed.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_epsilon">epsilon</code></td>
<td>
<p>Mean of the multivariate normal prior on beta.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_psi">psi</code></td>
<td>
<p>Covariance of the multivariate normal prior on beta.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_psi.inv">psi.inv</code></td>
<td>
<p>Inverse covariance of the multivariate normal prior on beta.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_pis">pis</code></td>
<td>
<p>Vector of length <code class="reqn">n^2 - n</code> providing the link probabilities between all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_countbeta">countbeta</code></td>
<td>
<p>Counter for number of steps for which the proposed beta value was accepted.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_rho">rho</code></td>
<td>
<p>Scaling factor to be used to adjust the acceptance rate.</p>
</td></tr>
<tr><td><code id="updatebeta_+3A_n.tilde">n.tilde</code></td>
<td>
<p>Length of the vector version of the adjacency matrix, with the diagonal removed i.e. <code class="reqn">n^2 - n</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See appendix of the paper detailed below for details.
</p>


<h3>Value</h3>

<p>A list:
</p>

<dl>
<dt>beta</dt><dd><p>The returned version of the beta parameter vector.</p>
</dd>
<dt>countbeta</dt><dd><p>The count of the number of acceptances of beta to that point in the MCMC chain.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='updateK'>Update the cluster membership vector.</h2><span id='topic+updateK'></span>

<h3>Description</h3>

<p>A Gibbs update step for K, the cluster membership vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateK(G, K, z, mu, sigma2, Id, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateK_+3A_g">G</code></td>
<td>
<p>The number of clusters being fitted.</p>
</td></tr>
<tr><td><code id="updateK_+3A_k">K</code></td>
<td>
<p>The cluster membership vector.</p>
</td></tr>
<tr><td><code id="updateK_+3A_z">z</code></td>
<td>
<p>The n x d matrix of latent locations.</p>
</td></tr>
<tr><td><code id="updateK_+3A_mu">mu</code></td>
<td>
<p>The G x d matrix of cluster means.</p>
</td></tr>
<tr><td><code id="updateK_+3A_sigma2">sigma2</code></td>
<td>
<p>The G vector of cluster covariances.</p>
</td></tr>
<tr><td><code id="updateK_+3A_id">Id</code></td>
<td>
<p>An identity matrix of dimension d.</p>
</td></tr>
<tr><td><code id="updateK_+3A_lambda">lambda</code></td>
<td>
<p>The n x G matrix of mixing proportions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The cluster membership vector.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='updatemu'>Update the mean of each cluster.</h2><span id='topic+updatemu'></span>

<h3>Description</h3>

<p>A Gibbs step to update the mean of each cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatemu(G, z, K, m, sigma2, omega2, Id, mu, d)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatemu_+3A_g">G</code></td>
<td>
<p>The number of clusters being fitted.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_z">z</code></td>
<td>
<p>The n x d matrix of latent locations.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_k">K</code></td>
<td>
<p>The cluster membership vector.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_m">m</code></td>
<td>
<p>Vector of length G containing the number of nodes in each cluster.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_sigma2">sigma2</code></td>
<td>
<p>The covariance of each cluster.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_omega2">omega2</code></td>
<td>
<p>Covariance of the multivariate normal prior distribution on the means. Note this is a scalar value, as the prior covariance is diagonal.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_id">Id</code></td>
<td>
<p>A d x d identity matrix.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_mu">mu</code></td>
<td>
<p>The G x d matrix of cluster means.</p>
</td></tr>
<tr><td><code id="updatemu_+3A_d">d</code></td>
<td>
<p>The dimension of the latent space.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The G x d matrix of cluster means.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='updatesigma2'>Update variances in each cluster.</h2><span id='topic+updatesigma2'></span>

<h3>Description</h3>

<p>A Gibbs step to update variances in each cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatesigma2(G, alpha, m, d, sigma02, z, K, mu, sigma2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatesigma2_+3A_g">G</code></td>
<td>
<p>The number of clusters being fitted.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_alpha">alpha</code></td>
<td>
<p>Degrees of freedom of the scaled inverse Chi squared prior distribution on the cluster variances.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_m">m</code></td>
<td>
<p>Vector of length G containing the number of nodes in each cluster.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_d">d</code></td>
<td>
<p>Dimension of the latent space.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_sigma02">sigma02</code></td>
<td>
<p>Scaled factor of the scaled inverse Chi squared prior distribution on the cluster variances.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_z">z</code></td>
<td>
<p>The n x d matrix of latent locations.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_k">K</code></td>
<td>
<p>The cluster membership vector.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_mu">mu</code></td>
<td>
<p>The G x d matrix of cluster means.</p>
</td></tr>
<tr><td><code id="updatesigma2_+3A_sigma2">sigma2</code></td>
<td>
<p>The G vector of cluster variances.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The G vector of cluster variances.
</p>


<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='updatetau'>Update the logistic regression parameters in the mixing proportions model.</h2><span id='topic+updatetau'></span>

<h3>Description</h3>

<p>The Metropolis-Hastings update step for the logistic regression parameters in the mixing proportions model, using a surrogate proposal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatetau(G, x.mix, lambda, Sigmag, Sigmag.inv, K, gammag, tau, counttau,
  rho)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatetau_+3A_g">G</code></td>
<td>
<p>The number of clusters being fitted.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_x.mix">x.mix</code></td>
<td>
<p>A matrix of covariates in the mixing proportions model (including dummy variables for any factor covariates), with a column of 1's appended at the front.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_lambda">lambda</code></td>
<td>
<p>An n x G matrix of mixing proportions.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_sigmag">Sigmag</code></td>
<td>
<p>Covariance matrix of the multivariate normal prior for tau.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_sigmag.inv">Sigmag.inv</code></td>
<td>
<p>The inverse of Sigmag.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_k">K</code></td>
<td>
<p>The cluster membership vector.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_gammag">gammag</code></td>
<td>
<p>Mean vector of the multivariate normal prior for tau.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_tau">tau</code></td>
<td>
<p>A matrix of logistic regression coefficients, with G rows and number of columns equal to the number of covariates in the mixing proportions model plus 1, for the intercept.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_counttau">counttau</code></td>
<td>
<p>Counter for number of steps for which the proposed tau value was accepted.</p>
</td></tr>
<tr><td><code id="updatetau_+3A_rho">rho</code></td>
<td>
<p>Scaling factor to be used to adjust the acceptance rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>

<dl>
<dt>tau</dt><dd><p>The returned version of the tau parameter vector.</p>
</dd>
<dt>lambda</dt><dd><p>The returned version of the lambda matrix.</p>
</dd>
<dt>counttau</dt><dd><p>The count of the number of acceptances of tau to that point in the MCMC chain.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='updatez'>Update step for the latent locations.</h2><span id='topic+updatez'></span>

<h3>Description</h3>

<p>A Metropolis-Hastings update step for the latent locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatez(n, z, x.link, delta, beta, y, mu, K, sigma2, Id, pis, iter, uphill,
  countz, delete, d, n.tilde)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatez_+3A_n">n</code></td>
<td>
<p>The number of nodes.</p>
</td></tr>
<tr><td><code id="updatez_+3A_z">z</code></td>
<td>
<p>The n x d matrix of latent locations.</p>
</td></tr>
<tr><td><code id="updatez_+3A_x.link">x.link</code></td>
<td>
<p>Matrix, with <code class="reqn">n^2 - n</code> rows and the same number of columns as covariates (including the intercept), giving the differences in covariates for all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatez_+3A_delta">delta</code></td>
<td>
<p>Vector of Euclidean distances between locations in the latent space of all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatez_+3A_beta">beta</code></td>
<td>
<p>Vector of regression coefficients in the link probabilities.</p>
</td></tr>
<tr><td><code id="updatez_+3A_y">y</code></td>
<td>
<p>Vector version of the adjacency matrix, with the diagonal removed.</p>
</td></tr>
<tr><td><code id="updatez_+3A_mu">mu</code></td>
<td>
<p>The G x d matrix of cluster means.</p>
</td></tr>
<tr><td><code id="updatez_+3A_k">K</code></td>
<td>
<p>The cluster membership vector</p>
</td></tr>
<tr><td><code id="updatez_+3A_sigma2">sigma2</code></td>
<td>
<p>The covariance of each cluster.</p>
</td></tr>
<tr><td><code id="updatez_+3A_id">Id</code></td>
<td>
<p>A d dimensional identity matrix.</p>
</td></tr>
<tr><td><code id="updatez_+3A_pis">pis</code></td>
<td>
<p>A vector of length <code class="reqn">n^2 - n</code> providing the link probabilities between all pairs of nodes.</p>
</td></tr>
<tr><td><code id="updatez_+3A_iter">iter</code></td>
<td>
<p>Iteration number.</p>
</td></tr>
<tr><td><code id="updatez_+3A_uphill">uphill</code></td>
<td>
<p>Number of iterations for which uphill only steps in the MCMC chain should be run.</p>
</td></tr>
<tr><td><code id="updatez_+3A_countz">countz</code></td>
<td>
<p>Counter for number of steps for which the proposed z value was accepted.</p>
</td></tr>
<tr><td><code id="updatez_+3A_delete">delete</code></td>
<td>
<p>Index of the terms to be deleted in order to delete the diagonal terms from the vector version of the adjacency matrix.</p>
</td></tr>
<tr><td><code id="updatez_+3A_d">d</code></td>
<td>
<p>The dimension of the latent space.</p>
</td></tr>
<tr><td><code id="updatez_+3A_n.tilde">n.tilde</code></td>
<td>
<p>Length of the vector version of the adjacency matrix, with the diagonal removed i.e. <code class="reqn">n^2 - n</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list:
</p>

<dl>
<dt>z</dt><dd><p>The returned matrix of latent locations.</p>
</dd>
<dt>delta</dt><dd><p>Vector of Euclidean distances between locations in the latent space of all pairs of nodes.</p>
</dd>
<dt>pis</dt><dd><p>A vector of length <code class="reqn">n^2 - n</code> providing the link probabilities between all pairs of nodes.</p>
</dd>
<dt>countz</dt><dd><p>Counter for z acceptance rate.</p>
</dd>
</dl>



<h3>References</h3>

<p>Isobel Claire Gormley and Thomas Brendan Murphy. (2010) A Mixture of Experts Latent Position Cluster Model for Social Network Data. Statistical Methodology, 7 (3), pp.385-405.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MEclustnet">MEclustnet</a></code>
</p>

<hr>
<h2 id='us.twitter.adjacency'>Directed adjacency matrix detailing the presence or absence
of Twitter friend/follower links between US politicians.</h2><span id='topic+us.twitter.adjacency'></span>

<h3>Description</h3>

<p>Network data on whether or not 69 US politicians are
friends/followers on Twitter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>us.twitter.adjacency
</code></pre>


<h3>Format</h3>

<p>A 69 x 69 binary matrix, with 0 down the diagonal.</p>


<h3>Source</h3>

<p>With thanks to Dr. Derek Greene. School of Computer Science,
University College Dublin.
</p>

<hr>
<h2 id='us.twitter.covariates'>A matrix of covariates of the US politicians.</h2><span id='topic+us.twitter.covariates'></span>

<h3>Description</h3>

<p>Covariates on each of 69 US politicians. Note the
first column is a column of 1's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>us.twitter.covariates
</code></pre>


<h3>Format</h3>

<p>A data frame with 69 observations on the following 8 variables.
</p>

<dl>
<dt>&lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo;</dt><dd><p>a column of 1s should always be the first column.</p>
</dd>
<dt><code>twitter_id</code></dt><dd><p>Twitter number.</p>
</dd>
<dt><code>twitter_name</code></dt><dd><p>Twitter name.</p>
</dd>
<dt><code>name</code></dt><dd><p>Actual name.</p>
</dd>
<dt><code>party</code></dt><dd><p>a factor with levels <code>Democrat</code> <code>Republican</code></p>
</dd>
<dt><code>location</code></dt><dd><p>a factor with levels detailing location.</p>
</dd>
<dt><code>role</code></dt><dd><p>a factor with levels <code>Candidate</code>, <code>Representative</code> and <code>Senator</code></p>
</dd>
<dt><code>gender</code></dt><dd><p>a factor with levels <code>Female</code> and <code>Male</code></p>
</dd>
</dl>


<h3>Source</h3>

<p>E. Lazega, The Collegial Phenomenon: The Social Mechanisms of Cooperation
Among Peers in a Corporate Law Partnership, Oxford University Press, Oxford, England, 2001.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
