<!DOCTYPE html><html lang="en"><head><title>Help for package BAREB</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BAREB}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BAREB'>
<p>The BAREB package: summary information</p></a></li>
<li><a href='#const'><p>const</p></a></li>
<li><a href='#Init'><p>The initial value of patient- and site-level covariates for simulation</p></a></li>
<li><a href='#kernelC'><p>The function to get the kernel function value</p></a></li>
<li><a href='#likeli_theta'><p>likeli_theta</p></a></li>
<li><a href='#obs'><p>The simulation observation</p></a></li>
<li><a href='#RJi'><p>Function to update the number of site level clusters for one patient level cluster via RJMCMC</p></a></li>
<li><a href='#RJi_empty'><p>Function to update the number of site level clusters for one patient level cluster via RJMCMC, when there is no patient in this cluster</p></a></li>
<li><a href='#truth'><p>The simulation truth</p></a></li>
<li><a href='#update_RJ'><p>update_RJ</p></a></li>
<li><a href='#update_sigma_squre'><p>update_sigma_squre</p></a></li>
<li><a href='#update_theta_beta'><p>update_theta_beta</p></a></li>
<li><a href='#update_theta_gamma'><p>update_theta_gamma</p></a></li>
<li><a href='#update_w'><p>update_w</p></a></li>
<li><a href='#update_w_beta'><p>update_w_beta</p></a></li>
<li><a href='#updateBeta'><p>Function to update patient level linear coefficients in the BAREB model</p></a></li>
<li><a href='#updatec'><p>Function to update c in missingess model</p></a></li>
<li><a href='#updateC'><p>Function to obtain the kernel matrix of the determinantal point process</p></a></li>
<li><a href='#updateE'><p>Function to update patient level clustering in the BAREB model</p></a></li>
<li><a href='#updateGamma'><p>Function to update site level linear coefficients in the BAREB model</p></a></li>
<li><a href='#updatemu'><p>Function to update estimated mean CAL values based on current parameters</p></a></li>
<li><a href='#updatemustar'><p>Function to update mean latent values for missingness model</p></a></li>
<li><a href='#updateR'><p>Function to update site level clustering in the BAREB model</p></a></li>
<li><a href='#updateZstar'><p>Function to generate new latent values for missingness model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Bayesian Repulsive Biclustering Model for Periodontal Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Simultaneously clusters the Periodontal diseases (PD) patients 
    and their tooth sites after taking the patient- and site-level covariates into consideration. 
    'BAREB' uses the determinantal point process (DPP) prior to induce diversity 
    among different biclusters to facilitate parsimony and interpretability. 
    Essentially, 'BAREB' is a cluster-wise linear model based on Yuliang (2020) &lt;<a href="https://doi.org/10.1002%2Fsim.8536">doi:10.1002/sim.8536</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-18 01:27:43 UTC; kevin_liu</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuliang Li [aut],
  Yanxun Xu [aut],
  Dipankar Bandyopadhyay [aut],
  John Burkardt [ctb],
  Qingyang Liu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qingyang Liu &lt;rh8liuqy@gmail.com&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-18 16:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='BAREB'>
The BAREB package: summary information
</h2><span id='topic+BAREB'></span>

<h3>Description</h3>

<p>This package implements BAREB (A Bayesian Repulsive Biclustering Model for Periodontal Data)
</p>


<h3>Value</h3>

<p>This is the summary page. No return value.</p>


<h3>Main Features</h3>

<p>The functions in the pacakge implement BAREB. BAREB can simultaneously cluster periodontal disease patients and their tooth site after taking the patient- and site-level covariates into consideration. BAREB uses the determinantal point process prior to induce diversity among different biclusters to facilitate parsimony and interpretability. In addition, since periodontal diseases are the leading cause for tooth loss, the missing data mechanism is non-ignorable. Such nonrandom missingness is incorporated into BAREB.
</p>


<h3>Functions</h3>

<p>The main functions are <code>updateBeta</code>, <code>update.theta.beta</code>, <code>update.theta.gamma</code>, <code>updatec</code>, <code>updateE</code>, <code>updateGamma</code>, <code>updatemu</code>, <code>updatemustar</code>, <code>updateR</code>, <code>updateZstar</code>, <code>update_RJ</code>, <code>update_sigma_square</code>, <code>update_w</code>, and <code>update_w_beta</code>; other
functions intended for direct access by the user are:
<code>kernelC</code> and <code>updateC</code>.  
There are undocumented functions which are called by these.
</p>


<h3>Requirements</h3>

<p>R version &gt;= 3.4.3. Packages <code>Rcpp</code> and <code>RcppArmadillo</code> are used so that complicated functions are implemented in C++ to speed up.
</p>


<h3>Version</h3>

<p>This is version 0.1.2.
</p>


<h3>Licence</h3>

<p>This package and its documentation are usable under the terms of the &quot;GNU
General Public License&quot;, a copy of which is distributed with the package.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li (Dept Applied Mathematics and Statistics, Johns Hopkins University, USA) and
Yanxun Xu (Dept Applied Mathematics and Statistics, Johns Hopkins University, USA) and 
Dipankar Bandyopadhyay (Dept Biostatistics, Virginia Commonwealth University, USA)
.
Please send comments, error reports, etc. to the maintainer (Yuliang) via email.
</p>

<hr>
<h2 id='const'>const</h2><span id='topic+const'></span>

<h3>Description</h3>

<p>The function to compute the normalizing constant for Determinantal Point Process (DPP)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>const(theta, tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="const_+3A_theta">theta</code></td>
<td>
<p>The parameter that controls how repulsive the DPP is</p>
</td></tr>
<tr><td><code id="const_+3A_tau">tau</code></td>
<td>
<p>The parameter we fixed at a large number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The computed normalizing constant
</p>

<hr>
<h2 id='Init'>The initial value of patient- and site-level covariates for simulation</h2><span id='topic+Init'></span>

<h3>Description</h3>

<p>These data record the initial value of patient- and site-level covariates in simulation in the paper &quot;BAREB: A Bayesian Repulsive Biclustering Model for Periodontal Data&quot;. It is obtained by simple linear regression.
</p>
<p>The variables are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>Init</code>          </td><td style="text-align: left;">  It has two parts: the initial value of patient-level covariates, <code>Beta</code>;  the initial value of site-level covariates, <code>Gamma</code>
</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>data("Init")
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'># output patient level covariates
data("Init")
Init$Beta
Init$Gamma
</code></pre>

<hr>
<h2 id='kernelC'>The function to get the kernel function value</h2><span id='topic+kernelC'></span>

<h3>Description</h3>

<p>This function take two configurations x and y, two parameters of the kernel function and returns its kernel function value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kernelC(x,y,theta,tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kernelC_+3A_x">x</code></td>
<td>
<p>a numeric vector, representing one configuration</p>
</td></tr>
<tr><td><code id="kernelC_+3A_y">y</code></td>
<td>
<p>a numeric vector, representing one configuration</p>
</td></tr>
<tr><td><code id="kernelC_+3A_theta">theta</code></td>
<td>
<p>a parameter of the DPP's kernel function</p>
</td></tr>
<tr><td><code id="kernelC_+3A_tau">tau</code></td>
<td>
<p>a parameter of the DPP's kernel function</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>kernelC(x,y,theta,tau)</code> returns the value of the kernel function
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  x &lt;- rnorm(5)
  y &lt;- rnorm(5) + 1
  kernelC(x,y,1,1)
</code></pre>

<hr>
<h2 id='likeli_theta'>likeli_theta</h2><span id='topic+likeli_theta'></span>

<h3>Description</h3>

<p>The function computes the likelihood of the hyperparameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likeli_theta(theta, tau, Beta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="likeli_theta_+3A_theta">theta</code></td>
<td>
<p>The parameter that controls how repulsive the DPP is</p>
</td></tr>
<tr><td><code id="likeli_theta_+3A_tau">tau</code></td>
<td>
<p>The parameter we fixed at a large number</p>
</td></tr>
<tr><td><code id="likeli_theta_+3A_beta">Beta</code></td>
<td>
<p>The matrix that records the samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The likelihood
</p>

<hr>
<h2 id='obs'>The simulation observation</h2><span id='topic+obs'></span>

<h3>Description</h3>

<p>These data record the simulation observation (observed value and missing indicator) and covariates in the paper &quot;BAREB: A Bayesian Repulsive Biclustering Model for Periodontal Data&quot;.
</p>
<p>The variables are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>delta</code>          </td><td style="text-align: left;">  the missing indicator matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>X</code>              </td><td style="text-align: left;">  the patient level covariates</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Y</code>              </td><td style="text-align: left;">  the observed (CAL) value matrix</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Z</code>              </td><td style="text-align: left;">  the site level covariates

</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>data("obs")
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'># output patient level covariates
data("obs")
obs$X
</code></pre>

<hr>
<h2 id='RJi'>Function to update the number of site level clusters for one patient level cluster via RJMCMC</h2><span id='topic+RJi'></span>

<h3>Description</h3>

<p>This function updates the number of site level clusters for one patient level cluster via RJMCMC. Only used for <code>updateRJ</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RJi(w, K, Gamma, Beta, X, Y, Z, R, delta, mu, mu_star, c, sigma_square, C,
             theta, tau, m, n,q,T0, hyper_delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RJi_+3A_w">w</code></td>
<td>
<p>The weights for site level clusters. Should be a vector.</p>
</td></tr>
<tr><td><code id="RJi_+3A_k">K</code></td>
<td>
<p>The number of site level cluster for the patient level cluster. </p>
</td></tr>
<tr><td><code id="RJi_+3A_gamma">Gamma</code></td>
<td>
<p>The linear coefficients for site level covariates. Should be a matrix.</p>
</td></tr>
<tr><td><code id="RJi_+3A_beta">Beta</code></td>
<td>
<p>The linear coefficients for patient level covariates. Should be a vector.</p>
</td></tr>
<tr><td><code id="RJi_+3A_x">X</code></td>
<td>
<p>The design matrix for patient level clusters.</p>
</td></tr>
<tr><td><code id="RJi_+3A_y">Y</code></td>
<td>
<p>The observed CAL value matrix</p>
</td></tr>
<tr><td><code id="RJi_+3A_z">Z</code></td>
<td>
<p>The design matrix for site level clusters.</p>
</td></tr>
<tr><td><code id="RJi_+3A_r">R</code></td>
<td>
<p>The current site level clustering membership</p>
</td></tr>
<tr><td><code id="RJi_+3A_delta">delta</code></td>
<td>
<p>The missing indicator matrix</p>
</td></tr>
<tr><td><code id="RJi_+3A_mu">mu</code></td>
<td>
<p>The current CAL mean vector</p>
</td></tr>
<tr><td><code id="RJi_+3A_mu_star">mu_star</code></td>
<td>
<p>The latent value vector for missingness model</p>
</td></tr>
<tr><td><code id="RJi_+3A_c">c</code></td>
<td>
<p>The linear coefficients for missingness model</p>
</td></tr>
<tr><td><code id="RJi_+3A_sigma_square">sigma_square</code></td>
<td>
<p>The current noise variance</p>
</td></tr>
<tr><td><code id="RJi_+3A_c">C</code></td>
<td>
<p>The DPP related kernel matrices. Should be an array of 3 dimensions</p>
</td></tr>
<tr><td><code id="RJi_+3A_theta">theta</code></td>
<td>
<p>The DPP hyper-parameter for site level</p>
</td></tr>
<tr><td><code id="RJi_+3A_tau">tau</code></td>
<td>
<p>A fixed DPP hyper-parameter, which we suggest high value, say 10^5</p>
</td></tr>
<tr><td><code id="RJi_+3A_m">m</code></td>
<td>
<p>The number of sites</p>
</td></tr>
<tr><td><code id="RJi_+3A_n">n</code></td>
<td>
<p>The number of patients</p>
</td></tr>
<tr><td><code id="RJi_+3A_q">q</code></td>
<td>
<p>The number of site level covariates</p>
</td></tr>
<tr><td><code id="RJi_+3A_t0">T0</code></td>
<td>
<p>The number of teeth</p>
</td></tr>
<tr><td><code id="RJi_+3A_hyper_delta">hyper_delta</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>RJi(w, K, Gamma, Beta, X, Y, Z, R, delta, mu, mu_star, c, sigma_square, C, theta, tau, m, n,q,T0, hyper_delta)</code> returns a list with following variables:
</p>
<table role = "presentation">
<tr><td><code>K</code></td>
<td>
<p>The numbers of site level clusters</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>The weights for site level clusters</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Linear coefficients for site level covariates</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The site level clusteirng membership</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The DPP related kernel matrice</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuliang Li</p>

<hr>
<h2 id='RJi_empty'>Function to update the number of site level clusters for one patient level cluster via RJMCMC, when there is no patient in this cluster</h2><span id='topic+RJi_empty'></span>

<h3>Description</h3>

<p>This function updates the number of site level clusters for one patient level cluster via RJMCMC, when there is no patient in this cluster. Only used for <code>updateRJ</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RJi_empty(w, K, Gamma,  R,  C,theta, tau, m,  q, hyper_delta)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RJi_empty_+3A_w">w</code></td>
<td>
<p>The weights for site level clusters. Should be a vector.</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_k">K</code></td>
<td>
<p>The number of site level cluster for the patient level cluster. </p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_gamma">Gamma</code></td>
<td>
<p>The linear coefficients for site level covariates. Should be a matrix.</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_r">R</code></td>
<td>
<p>The current site level clustering membership</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_c">C</code></td>
<td>
<p>The DPP related kernel matrices. Should be an array of 3 dimensions</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_theta">theta</code></td>
<td>
<p>The DPP hyper-parameter for site level</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_tau">tau</code></td>
<td>
<p>A fixed DPP hyper-parameter, which we suggest high value, say 10^5</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_m">m</code></td>
<td>
<p>The number of sites</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_q">q</code></td>
<td>
<p>The number of site level covariates</p>
</td></tr>
<tr><td><code id="RJi_empty_+3A_hyper_delta">hyper_delta</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>RJi_empty(w, K, Gamma,  R,  C,theta, tau, m,  q, hyper_delta)</code> returns a list with following variables:
</p>
<table role = "presentation">
<tr><td><code>K</code></td>
<td>
<p>The numbers of site level clusters</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>The weights for site level clusters</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Linear coefficients for site level covariates</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The site level clusteirng membership</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The DPP related kernel matrice</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuliang Li</p>

<hr>
<h2 id='truth'>The simulation truth</h2><span id='topic+truth'></span>

<h3>Description</h3>

<p>These data record the simulation truth in the paper &quot;BAREB: A Bayesian Repulsive Biclustering Model for Periodontal Data&quot;.
It includes the true simulated parameters.
</p>
<p>The variables are:
</p>

<table>
<tr>
 <td style="text-align: left;">
	<code>S</code>              </td><td style="text-align: left;">  the number of patient level clusters </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>E</code>              </td><td style="text-align: left;">  the clustering membership of patient level</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>K</code>              </td><td style="text-align: left;">  the numbers of site level clusters</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>R</code>              </td><td style="text-align: left;">  the site level clustering membership</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Beta</code>           </td><td style="text-align: left;">  the patient level linear coefficients</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>Gamma</code>          </td><td style="text-align: left;">  the site level linear coefficients</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>mu</code>             </td><td style="text-align: left;">  the underlying mean for CAL values </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>sigma_square</code>   </td><td style="text-align: left;">  the variance of noise for CAL values </td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>noise</code>          </td><td style="text-align: left;">  the noise for CAL values</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>c</code>              </td><td style="text-align: left;">  the parameter for missingness model</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>mu.star</code>        </td><td style="text-align: left;">  the mean of latent values for missingness model</td>
</tr>
<tr>
 <td style="text-align: left;">
	<code>z.star</code>         </td><td style="text-align: left;">  the latent values for missingness model

</td>
</tr>

</table>



<h3>Usage</h3>

<pre><code class='language-R'>data("truth")
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'># output true patient level clustering membership
data("truth")
truth$E

#get the details of the list
str(truth)
</code></pre>

<hr>
<h2 id='update_RJ'>update_RJ</h2><span id='topic+update_RJ'></span>

<h3>Description</h3>

<p>Update the number of site level clusters for each patient level cluster via RJMCMC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_RJ(
  w,
  K,
  Gamma,
  Beta,
  E,
  Z,
  X,
  R,
  mu,
  mu_star,
  Y,
  delta,
  c,
  sigma_square,
  C,
  S,
  theta,
  tau,
  q,
  m,
  T0,
  hyper_delta = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_RJ_+3A_w">w</code></td>
<td>
<p>The weights for site level clusters. Should be a matrix with S rows.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_k">K</code></td>
<td>
<p>The number of site level cluster for each patient level cluster. Should be a vector of length S</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_gamma">Gamma</code></td>
<td>
<p>The linear coefficients for site level covariates. Should be a 3-dimensional array.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_beta">Beta</code></td>
<td>
<p>The linear coefficients for patient level covariates. Should be a matrix with S rows</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_e">E</code></td>
<td>
<p>A vector that records the current clustering membership.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_z">Z</code></td>
<td>
<p>The design matrix for site level clusters.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_x">X</code></td>
<td>
<p>The design matrix for patient level clusters.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_r">R</code></td>
<td>
<p>The current site level clustering membership</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_mu">mu</code></td>
<td>
<p>The current CAL mean matrix</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_mu_star">mu_star</code></td>
<td>
<p>The latent value matrix for missingness model</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_y">Y</code></td>
<td>
<p>The observed CAL value matrix</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_delta">delta</code></td>
<td>
<p>The missing indicator matrix</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_c">c</code></td>
<td>
<p>The linear coefficients for missingness model</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_sigma_square">sigma_square</code></td>
<td>
<p>The current noise variance</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_c">C</code></td>
<td>
<p>The DPP related kernel matrices. Should be an array of 3 dimensions</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_s">S</code></td>
<td>
<p>The number of patient level clusters.</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_theta">theta</code></td>
<td>
<p>The DPP hyper-parameter for site level</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_tau">tau</code></td>
<td>
<p>A fixed DPP hyper-parameter, which we suggest high value, say 10^5</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_q">q</code></td>
<td>
<p>The number of site level covariates</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_m">m</code></td>
<td>
<p>The number of sites</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_t0">T0</code></td>
<td>
<p>The number of teeth</p>
</td></tr>
<tr><td><code id="update_RJ_+3A_hyper_delta">hyper_delta</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following updated parameters:
</p>
<table role = "presentation">
<tr><td><code>K</code></td>
<td>
<p>The numbers of site level clusters</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>The weights for site level clusters</p>
</td></tr>
<tr><td><code>Gamma</code></td>
<td>
<p>Linear coefficients for site level covariates</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>The site level clusteirng membership</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>The DPP related kernel matrice</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(BAREB)
data("obs")
X &lt;- obs$X
Y &lt;- obs$Y
Z &lt;- obs$Z
delta &lt;- obs$delta
data("truth")

set.seed(1)

n&lt;-80
m&lt;-168
T0&lt;-28
q&lt;-3
p&lt;-3
S&lt;-3
theta1 &lt;- theta2 &lt;- 5
tau &lt;- 100000
D&lt;-matrix(0, nrow = T0, ncol = m)
for(i in 1:T0){
  indi&lt;-1:6
  indi&lt;-indi+6*(i-1)
  D[i,indi]&lt;-rep(1/6,6)
}
nu_gamma&lt;-0.05
nu_beta &lt;- 0.05
data("Init")
Beta0 &lt;- Init$Beta
Gamma0 &lt;- Init$Gamma

Niter&lt;-10
record &lt;- NULL
record$E&lt;-matrix(NA,nrow = Niter, ncol = n)
record$R&lt;-array(NA, dim = c(Niter, S, m))
record$Gamma &lt;-array(NA,dim = c(Niter, 10, q, S))
record$Beta &lt;- array(NA,dim = c(Niter, S, p))
record$K &lt;- matrix(NA,nrow = Niter, ncol = S)
record$sigma_square &lt;-rep(NA,Niter)
record$theta1&lt;-rep(0,Niter)
record$theta2&lt;-rep(0,Niter)
record$c&lt;-matrix(0,nrow =  Niter,ncol = T0)
record$mu&lt;-array(NA,dim = c(Niter,n,m))
record$w_beta &lt;- array(NA, dim = c(Niter, S))
record$w &lt;- array(NA, dim = c(Niter, S, 10))
set.seed(1)
E&lt;-sample.int(S,n,TRUE)
Beta &lt;- matrix(NA,nrow = S, ncol = p)
Beta[1,] &lt;- Beta[2,] &lt;- Beta[3,]  &lt;- Beta0
Beta&lt;- Beta + matrix(rnorm(S*p, 0, 1) , nrow = S, ncol = p)
Gamma &lt;- array(NA,dim = c(10,q,S))
Gamma[1,,1] &lt;- Gamma[2,,1] &lt;- Gamma[3,,1] &lt;- Gamma0
Gamma[,,2] &lt;- Gamma[,,3]   &lt;- Gamma[,,1]
Gamma &lt;- Gamma + array(rnorm(10*q*S, 0, 5), dim = c(10, q, S))
K &lt;- rep(3,S)
R &lt;- matrix(NA,nrow = S, ncol = m)
R[1,]&lt;- R[2,]&lt;- R[3,]  &lt;- sample.int(3,m,TRUE)
mu&lt;-updatemu(R,Z,X,Gamma,K,Beta,E,m,n,p,q)
mu_star&lt;-updatemustar(mu,rep(0.01,2),n,T0,D)
z_star&lt;-updateZstar(mu_star,delta,n,T0)
sigma_square &lt;- 10
C&lt;-array(NA,dim = c(10,10,S))
w&lt;-matrix(NA,nrow = S, ncol = 10)
w_beta&lt;-rep(1/S,S)
for(i in 1:S){
 C[1:K[i],1:K[i],i]&lt;-updateC(Gamma[1:K[i],,i],theta2,tau)
  w[i, 1:K[i]]&lt;-rep(1/K[i],K[i])
}
c&lt;-c(0,0.01)
start &lt;- Sys.time()
for(iter in 1:Niter){
  c&lt;-updatec(z_star, mu,D, 100,sigma_square, n, T0)
  mu_star&lt;-updatemustar(mu,c,n,T0,D)
  z_star&lt;-updateZstar(mu_star,delta,n, T0)
  w &lt;- update_w(K, R, S)
  R &lt;- updateR(w, Gamma, Beta,
               Y, Z, delta, mu, mu_star, c[2], S,
               sigma_square, K, E, X,
               m, n, q, p, T0)
  for(i in unique(E)){
    ind&lt;-sort(unique(R[i,]))
    KK&lt;-length(ind)
    Gamma_temp&lt;-Gamma[ind,,i]
    Gamma[,,i]&lt;-NA
    Gamma[1:KK,,i]&lt;-Gamma_temp
    w_temp&lt;-w[i,ind]
    w_temp&lt;-w_temp/sum(w_temp)
    w[i,]&lt;-NA
    w[i,1:KK]&lt;-w_temp
    for(k in 1:KK){
      R[i,which(R[i,]==ind[k])]&lt;-k
    }
    K[i]&lt;-KK
  }
  mu&lt;-updatemu(R,Z,X,Gamma,K,Beta,E,m,n,p,q)
  mu_star&lt;-updatemustar(mu,c,n,T0,D)
  step &lt;- array(rnorm(max(K) * S *q, 0, nu_gamma),dim=c( max(K), q,S))
  run&lt;- array(runif(max(K) * S *q, 0, 1),dim=c( max(K), q,S))
  A&lt;-updateGamma(X,Y, Z, delta, Beta, Gamma, E, R, S, K , mu, mu_star, sigma_square, rep(c,T0),
                 step,  run,  n,  m, T0,  p,  q,  D,theta2,  tau)
  Gamma&lt;-A$Gamma
  mu&lt;-A$mu
  mu_star&lt;-A$mustar
  for(i in 1:S){
    if(K[i]==1){
      Gammai = t(as.matrix(Gamma[1:K[i],,i]))
      C[1:K[i],1:K[i],i]&lt;-updateC(Gammai,theta2,tau)
    }
    else{
      C[1:K[i],1:K[i],i]&lt;-updateC(Gamma[1:K[i],,i],theta2,tau)
    }
  }
  A&lt;-update_RJ(w, K, Gamma,Beta, E,
               Z, X, R, mu, mu_star, Y, delta, c,sigma_square, C,
               S, theta2, tau, q, m, T0)
  K&lt;-A$K
  w&lt;-A$w
  Gamma&lt;-A$Gamma
  R&lt;-A$R
  C&lt;-A$C
  mu&lt;-updatemu(R,Z,X,Gamma,K,Beta,E,m,n,p,q)
  mu_star&lt;-updatemustar(mu,rep(c,T0),n,T0,D)
  C_beta&lt;-updateC(Beta,theta1,tau)
  step&lt;-matrix(rnorm(S*p,0,nu_beta),nrow = S)
  runif&lt;-matrix(runif(S*p,0,1),nrow = S)
  A&lt;- updateBeta( X,Y, Z, delta,
                  Beta, Gamma, E,R,S,K,mu_star, mu,sigma_square,rep(c,T0), C_beta, step,runif,
                  n, m, T0,  p,  q,  D,
                  theta1, tau)
  Beta&lt;-A$Beta
  mu&lt;-A$mu
  mu_star&lt;-A$mustar
  record$Beta[iter,,]&lt;-Beta
  A&lt;-updateE( Beta,Gamma, w_beta, X,Y,Z,delta,E, R, S,K, mu, mu_star,sigma_square,rep(c,T0),
              n,  m,  T0,  p,  q,  D)
  E&lt;-A$E
  mu&lt;-A$mu
  mu_star&lt;-A$mustar
  K&lt;-A$Ds
  w_beta&lt;- update_w_beta(S, w_beta, E)
  theta1&lt;-update_theta_beta(theta1,tau,Beta)
  theta2&lt;-update_theta_gamma(theta2,tau,Gamma,S,K)
  sigma_square &lt;- update_sigma_squre(Y,mu)
}

</code></pre>

<hr>
<h2 id='update_sigma_squre'>update_sigma_squre</h2><span id='topic+update_sigma_squre'></span>

<h3>Description</h3>

<p>Update the noise variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_sigma_squre(Y, mu, a = 1, b = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_sigma_squre_+3A_y">Y</code></td>
<td>
<p>The CAL observation matrix, with missing values</p>
</td></tr>
<tr><td><code id="update_sigma_squre_+3A_mu">mu</code></td>
<td>
<p>Current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="update_sigma_squre_+3A_a">a</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
<tr><td><code id="update_sigma_squre_+3A_b">b</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated noise variance
</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='update_theta_beta'>update_theta_beta</h2><span id='topic+update_theta_beta'></span>

<h3>Description</h3>

<p>Update the DPP hyper-parameter for patient level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_theta_beta(theta, tau, Beta, sig = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_theta_beta_+3A_theta">theta</code></td>
<td>
<p>The DPP hyper-parameter for patient level</p>
</td></tr>
<tr><td><code id="update_theta_beta_+3A_tau">tau</code></td>
<td>
<p>A fixed DPP hyper-parameter, which we suggest high value, say 10^5</p>
</td></tr>
<tr><td><code id="update_theta_beta_+3A_beta">Beta</code></td>
<td>
<p>The linear coefficients for patient level covariates. Should be a matrix with S rows</p>
</td></tr>
<tr><td><code id="update_theta_beta_+3A_sig">sig</code></td>
<td>
<p>The hyper-parameter with default value being 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated DPP hyper-parameter for patient level
</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='update_theta_gamma'>update_theta_gamma</h2><span id='topic+update_theta_gamma'></span>

<h3>Description</h3>

<p>Update the DPP hyper-parameter for site level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_theta_gamma(theta, tau, Gamma, S, Ds, sig = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_theta_gamma_+3A_theta">theta</code></td>
<td>
<p>The DPP hyper-parameter for patient level</p>
</td></tr>
<tr><td><code id="update_theta_gamma_+3A_tau">tau</code></td>
<td>
<p>A fixed DPP hyper-parameter, which we suggest high value, say 10^5</p>
</td></tr>
<tr><td><code id="update_theta_gamma_+3A_gamma">Gamma</code></td>
<td>
<p>The linear coefficients for site level covariates. Should be a 3-dimensional array.</p>
</td></tr>
<tr><td><code id="update_theta_gamma_+3A_s">S</code></td>
<td>
<p>The number of patient level clusters</p>
</td></tr>
<tr><td><code id="update_theta_gamma_+3A_ds">Ds</code></td>
<td>
<p>The number for site level clusters for each patient level cluster</p>
</td></tr>
<tr><td><code id="update_theta_gamma_+3A_sig">sig</code></td>
<td>
<p>The hyper-parameter with default value being 10</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated DPP hyper-parameter for site level
</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='update_w'>update_w</h2><span id='topic+update_w'></span>

<h3>Description</h3>

<p>This function updates the weights for site level clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_w(K, R, S, hyper_delta = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_w_+3A_k">K</code></td>
<td>
<p>The number of site level cluster for each patient level cluster. Should be a vector of length <code>S</code></p>
</td></tr>
<tr><td><code id="update_w_+3A_r">R</code></td>
<td>
<p>The current site level clustering membership. Should be a matrix with <code>S</code> rows.</p>
</td></tr>
<tr><td><code id="update_w_+3A_s">S</code></td>
<td>
<p>The number of patient level clusters.</p>
</td></tr>
<tr><td><code id="update_w_+3A_hyper_delta">hyper_delta</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It returns a matrix with 10 columns.
For example, first patient cluster has 2 site level clusters. The first row's first 2 elements give the weights for site level clusters in patient cluster 1. Last 8 elements are NA's
</p>


<h3>Value</h3>

<p>The updated weights for site level clusters. Should be a matrix with <code>S</code> rows.
</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Suppose we know the number of patient level cluster is 2,
#one has 2 site level clusters and one has 3.
#Use the default value, 1, for hyper-parameter
update_w(K=c(2,3),R=matrix(c(1,2,2,1,1,2,3,2),nrow=2,byrow=TRUE), S=2)

#To change the hyper-parameter to, for example 2
update_w(K=c(2,3),R=matrix(c(1,2,2,1,1,2,3,2),nrow=2,byrow=TRUE), S=2, hyper_delta = 2)
</code></pre>

<hr>
<h2 id='update_w_beta'>update_w_beta</h2><span id='topic+update_w_beta'></span>

<h3>Description</h3>

<p>This function updates the weights for each patient level cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_w_beta(S, E, hyper_delta = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_w_beta_+3A_s">S</code></td>
<td>
<p>The number of patient level clusters</p>
</td></tr>
<tr><td><code id="update_w_beta_+3A_e">E</code></td>
<td>
<p>A vector that records the current clustering membership.</p>
</td></tr>
<tr><td><code id="update_w_beta_+3A_hyper_delta">hyper_delta</code></td>
<td>
<p>The hyper-parameter with default value being 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The updated weights for each patient level cluster
</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Suppose we know the number of patient level cluster is 4
#Suppose the current clustering membership indicates 3 patients in cluster 1,
#2 patients in cluster 2, 3 patinets in cluster 3, 1 patient in cluster 4
#Use the default value, 1, for hyper-parameter
update_w_beta(S=4,E=c(1,1,1,2,2,3,3,3,4))


#To change the hyper-parameter to, for example 2
update_w_beta(S=4,E=c(1,1,1,2,2,3,3,3,4),hyper_delta = 2)
</code></pre>

<hr>
<h2 id='updateBeta'>Function to update patient level linear coefficients in the BAREB model</h2><span id='topic+updateBeta'></span>

<h3>Description</h3>

<p>This function takes current parameters and observed data, gives an updated patient level linear coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateBeta(X, Y, Z,
    delta, Beta, Gamma, E, R,
    S, Ds, mustar, mu,
    sigma, c, C,
    step, runif,
    n, m, T0, p, q, D,
    theta,tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateBeta_+3A_x">X</code></td>
<td>
<p>the patient level covariate matrix</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_y">Y</code></td>
<td>
<p>the CAL observation matrix, with missing values</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_z">Z</code></td>
<td>
<p>the site level covariate matrix</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_delta">delta</code></td>
<td>
<p>the missing indicator matrix, with 1 means missing</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_beta">Beta</code></td>
<td>
<p>current patient level linear coefficients matrix</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_gamma">Gamma</code></td>
<td>
<p>current site level linear coefficients array</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_e">E</code></td>
<td>
<p>current patient level clustering vector</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_r">R</code></td>
<td>
<p>current site level clustering matrix</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_s">S</code></td>
<td>
<p>number of patient level clusters</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_ds">Ds</code></td>
<td>
<p>a vector recording numbers of site level clusters</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_mustar">mustar</code></td>
<td>
<p>current matrix of latent value for missingness model</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_sigma">sigma</code></td>
<td>
<p>current estimated noise variance</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_c">c</code></td>
<td>
<p>current c for missingness model. It is a vector</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_c">C</code></td>
<td>
<p>current kernel matrix for DPP</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_step">step</code></td>
<td>
<p>a matrix of steps for M-H</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_runif">runif</code></td>
<td>
<p>a matrix of uniform random variables for deciding whether to accept new proposed point in M-H</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_m">m</code></td>
<td>
<p>number of sites</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_p">p</code></td>
<td>
<p>dimension of patient level covariates</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_q">q</code></td>
<td>
<p>dimension of site level covariates</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_d">D</code></td>
<td>
<p>the D matrix in the paper</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_theta">theta</code></td>
<td>
<p>parameter for DPP</p>
</td></tr>
<tr><td><code id="updateBeta_+3A_tau">tau</code></td>
<td>
<p>parameter for DPP</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateBeta(X, Y, Z, delta, Beta, Gamma, E, R, S, Ds, mustar, mu, sigma, c, C, step, runif, n, m, T0, p, q, D, theta,tau)</code> returns a list with following variables:
</p>
<table role = "presentation">
<tr><td><code>C</code></td>
<td>
<p>the updated kernel matrix computed by updated Beta</p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>the updated patient level linear coefficients</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the updated mu computed by updated Beta</p>
</td></tr>
<tr><td><code>mustar</code></td>
<td>
<p>the updated mustar computed by updated Beta</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updatec'>Function to update c in missingess model</h2><span id='topic+updatec'></span>

<h3>Description</h3>

<p>This function takes current parameters, gives updated c in missingess model. Note a double type of value is returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatec(Zstar, mu,  D, sigmac,sigma_square, n, T0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatec_+3A_zstar">Zstar</code></td>
<td>
<p>generated latent value for missingness model</p>
</td></tr>
<tr><td><code id="updatec_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updatec_+3A_d">D</code></td>
<td>
<p>the D matrix in the paper</p>
</td></tr>
<tr><td><code id="updatec_+3A_sigmac">sigmac</code></td>
<td>
<p>hyperparamter for c (variance)</p>
</td></tr>
<tr><td><code id="updatec_+3A_sigma_square">sigma_square</code></td>
<td>
<p>current estimated noise variance</p>
</td></tr>
<tr><td><code id="updatec_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updatec_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updatec(Zstar, mu,  D, sigmac, n, T0)</code> returns the updated c in missingess model.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updateC'>Function to obtain the kernel matrix of the determinantal point process</h2><span id='topic+updateC'></span>

<h3>Description</h3>

<p>This function takes a matrix and two parameters of kernel function for the determinantal point process (DPP) and gives the kernel matrix for that DPP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateC(Z,theta,tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateC_+3A_z">Z</code></td>
<td>
<p>a matrix, whose rows stand for configurations of the DPP.</p>
</td></tr>
<tr><td><code id="updateC_+3A_theta">theta</code></td>
<td>
<p>a parameter of the DPP's kernel function</p>
</td></tr>
<tr><td><code id="updateC_+3A_tau">tau</code></td>
<td>
<p>a parameter of the DPP's kernel function</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateC(Z,theta,tau)</code> returns the kernel matrix
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Z &lt;- matrix(rnorm(15), nrow = 5)
  updateC(Z,1,1)
</code></pre>

<hr>
<h2 id='updateE'>Function to update patient level clustering in the BAREB model</h2><span id='topic+updateE'></span>

<h3>Description</h3>

<p>This function takes current parameters and observed data, gives an updated patient level clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateE( Beta, Gamma,w,
    X, Y, Z, delta,
    E, R, S, Ds,
    mu, mustar,
    sigma, c,
    n, m, T0, p, q, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateE_+3A_beta">Beta</code></td>
<td>
<p>current patient level linear coefficients matrix</p>
</td></tr>
<tr><td><code id="updateE_+3A_gamma">Gamma</code></td>
<td>
<p>current site level linear coefficients array</p>
</td></tr>
<tr><td><code id="updateE_+3A_w">w</code></td>
<td>
<p>current patient level clustering prior prob, a vector</p>
</td></tr>
<tr><td><code id="updateE_+3A_x">X</code></td>
<td>
<p>the patient level covariate matrix</p>
</td></tr>
<tr><td><code id="updateE_+3A_y">Y</code></td>
<td>
<p>the CAL observation matrix, with missing values</p>
</td></tr>
<tr><td><code id="updateE_+3A_z">Z</code></td>
<td>
<p>the site level covariate matrix</p>
</td></tr>
<tr><td><code id="updateE_+3A_delta">delta</code></td>
<td>
<p>the missing indicator matrix, with 1 means missing</p>
</td></tr>
<tr><td><code id="updateE_+3A_e">E</code></td>
<td>
<p>current patient level clustering vector</p>
</td></tr>
<tr><td><code id="updateE_+3A_r">R</code></td>
<td>
<p>current site level clustering matrix</p>
</td></tr>
<tr><td><code id="updateE_+3A_s">S</code></td>
<td>
<p>number of patient level clusters</p>
</td></tr>
<tr><td><code id="updateE_+3A_ds">Ds</code></td>
<td>
<p>a vector recording numbers of site level clusters</p>
</td></tr>
<tr><td><code id="updateE_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updateE_+3A_mustar">mustar</code></td>
<td>
<p>current matrix of latent value for missingness model</p>
</td></tr>
<tr><td><code id="updateE_+3A_sigma">sigma</code></td>
<td>
<p>current estimated noise variance</p>
</td></tr>
<tr><td><code id="updateE_+3A_c">c</code></td>
<td>
<p>current c for missingness model. It is a vector</p>
</td></tr>
<tr><td><code id="updateE_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updateE_+3A_m">m</code></td>
<td>
<p>number of sites</p>
</td></tr>
<tr><td><code id="updateE_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
<tr><td><code id="updateE_+3A_p">p</code></td>
<td>
<p>dimension of patient level covariates</p>
</td></tr>
<tr><td><code id="updateE_+3A_q">q</code></td>
<td>
<p>dimension of site level covariates</p>
</td></tr>
<tr><td><code id="updateE_+3A_d">D</code></td>
<td>
<p>the D matrix in the paper</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateE( Beta, Gamma,w, X, Y, Z, delta,E, R, S, Ds, mu, mustar, sigma, c, n, m, T0, p, q, D)</code> returns a list with following variables:
</p>
<table role = "presentation">
<tr><td><code>E</code></td>
<td>
<p>the updated patient level clustering</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>new vector recording the numbers of site level clusters</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the updated mu computed by updated E</p>
</td></tr>
<tr><td><code>mustar</code></td>
<td>
<p>the updated mustar computed by updated E</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updateGamma'>Function to update site level linear coefficients in the BAREB model</h2><span id='topic+updateGamma'></span>

<h3>Description</h3>

<p>This function takes current parameters and observed data, gives an updated site level linear coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateGamma(X, Y, Z, delta,
    Beta, Gamma, E, R,
    S, Ds, mu, mustar,
    sigma, c, step, runif,
    n, m, T0, p, q, D, theta,tau)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateGamma_+3A_x">X</code></td>
<td>
<p>the patient level covariate matrix</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_y">Y</code></td>
<td>
<p>the CAL observation matrix, with missing values</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_z">Z</code></td>
<td>
<p>the site level covariate matrix</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_delta">delta</code></td>
<td>
<p>the missing indicator matrix, with 1 means missing</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_beta">Beta</code></td>
<td>
<p>current patient level linear coefficients matrix</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_gamma">Gamma</code></td>
<td>
<p>current site level linear coefficients array</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_e">E</code></td>
<td>
<p>current patient level clustering vector</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_r">R</code></td>
<td>
<p>current site level clustering matrix</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_s">S</code></td>
<td>
<p>number of patient level clusters</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_ds">Ds</code></td>
<td>
<p>a vector recording numbers of site level clusters</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_mustar">mustar</code></td>
<td>
<p>current matrix of latent value for missingness model</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_sigma">sigma</code></td>
<td>
<p>current estimated noise variance</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_c">c</code></td>
<td>
<p>current c for missingness model. It is a vector</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_step">step</code></td>
<td>
<p>an array of steps for M-H</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_runif">runif</code></td>
<td>
<p>an array of uniform random variables for deciding whether to accept new proposed point in M-H</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_m">m</code></td>
<td>
<p>number of sites</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_p">p</code></td>
<td>
<p>dimension of patient level covariates</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_q">q</code></td>
<td>
<p>dimension of site level covariates</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_d">D</code></td>
<td>
<p>the D matrix in the paper</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_theta">theta</code></td>
<td>
<p>parameter for DPP</p>
</td></tr>
<tr><td><code id="updateGamma_+3A_tau">tau</code></td>
<td>
<p>parameter for DPP</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateGamma(X, Y, Z, delta, Beta, Gamma, E, R, S, Ds, mu, mustar, sigma, c, step, runif, n, m, T0, p, q, D, theta,tau)</code> returns a list with following variables:
</p>
<table role = "presentation">
<tr><td><code>Gamma</code></td>
<td>
<p>the updated site level linear coefficients</p>
</td></tr>
<tr><td><code>mu</code></td>
<td>
<p>the updated mu computed by updated Gamma</p>
</td></tr>
<tr><td><code>mustar</code></td>
<td>
<p>the updated mustar computed by updated Gamma</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updatemu'>Function to update estimated mean CAL values based on current parameters</h2><span id='topic+updatemu'></span>

<h3>Description</h3>

<p>This function takes current parameters, gives an estimated mean CAL values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatemu(R, Z, X, Gamma, K, Beta, E,  m,n,p, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatemu_+3A_r">R</code></td>
<td>
<p>current site level clustering matrix</p>
</td></tr>
<tr><td><code id="updatemu_+3A_z">Z</code></td>
<td>
<p>the site level covariate matrix</p>
</td></tr>
<tr><td><code id="updatemu_+3A_x">X</code></td>
<td>
<p>the patient level covariate matrix</p>
</td></tr>
<tr><td><code id="updatemu_+3A_gamma">Gamma</code></td>
<td>
<p>current site level linear coefficients array</p>
</td></tr>
<tr><td><code id="updatemu_+3A_k">K</code></td>
<td>
<p>a vector recording numbers of site level clusters</p>
</td></tr>
<tr><td><code id="updatemu_+3A_beta">Beta</code></td>
<td>
<p>current patient level linear coefficients matrix</p>
</td></tr>
<tr><td><code id="updatemu_+3A_e">E</code></td>
<td>
<p>current patient level clustering vector</p>
</td></tr>
<tr><td><code id="updatemu_+3A_m">m</code></td>
<td>
<p>number of sites</p>
</td></tr>
<tr><td><code id="updatemu_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updatemu_+3A_p">p</code></td>
<td>
<p>dimension of patient level covariates</p>
</td></tr>
<tr><td><code id="updatemu_+3A_q">q</code></td>
<td>
<p>dimension of site level covariates</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updatemu(R, Z, X, Gamma, K, Beta, E,  m,n,p, q)</code> returns the updated estimated mean CAL matrix.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updatemustar'>Function to update mean latent values for missingness model</h2><span id='topic+updatemustar'></span>

<h3>Description</h3>

<p>This function takes current parameters, gives updated mean latent values for missingness model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updatemustar(mu, c, n, T0, D)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updatemustar_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updatemustar_+3A_c">c</code></td>
<td>
<p>current c for missingness model</p>
</td></tr>
<tr><td><code id="updatemustar_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updatemustar_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
<tr><td><code id="updatemustar_+3A_d">D</code></td>
<td>
<p>the D matrix in the paper</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updatemustar(mu, c, n, T0, D)</code> returns the updated mean latent values for missingness model.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updateR'>Function to update site level clustering in the BAREB model</h2><span id='topic+updateR'></span>

<h3>Description</h3>

<p>This function takes current parameters and observed data, gives an updated site level clustering.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateR( w ,Gamma,Beta,
    Y, Z, delta,
    mu, mu_star,
    c, S, sigma_square,
    K, E, X,
    m,n, q, p, T0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateR_+3A_w">w</code></td>
<td>
<p>current site level clustering prior prob, a matrix</p>
</td></tr>
<tr><td><code id="updateR_+3A_gamma">Gamma</code></td>
<td>
<p>current site level linear coefficients array</p>
</td></tr>
<tr><td><code id="updateR_+3A_beta">Beta</code></td>
<td>
<p>current patient level linear coefficients matrix</p>
</td></tr>
<tr><td><code id="updateR_+3A_y">Y</code></td>
<td>
<p>the CAL observation matrix, with missing values</p>
</td></tr>
<tr><td><code id="updateR_+3A_z">Z</code></td>
<td>
<p>the site level covariate matrix</p>
</td></tr>
<tr><td><code id="updateR_+3A_delta">delta</code></td>
<td>
<p>the missing indicator matrix, with 1 means missing</p>
</td></tr>
<tr><td><code id="updateR_+3A_mu">mu</code></td>
<td>
<p>current estimated mean matrix for CAL</p>
</td></tr>
<tr><td><code id="updateR_+3A_mu_star">mu_star</code></td>
<td>
<p>current matrix of latent value for missingness model</p>
</td></tr>
<tr><td><code id="updateR_+3A_c">c</code></td>
<td>
<p>current c for missingness model</p>
</td></tr>
<tr><td><code id="updateR_+3A_s">S</code></td>
<td>
<p>number of patient level clusters</p>
</td></tr>
<tr><td><code id="updateR_+3A_sigma_square">sigma_square</code></td>
<td>
<p>current estimated noise variance</p>
</td></tr>
<tr><td><code id="updateR_+3A_k">K</code></td>
<td>
<p>a vector recording numbers of site level clusters</p>
</td></tr>
<tr><td><code id="updateR_+3A_e">E</code></td>
<td>
<p>current patient level clustering vector</p>
</td></tr>
<tr><td><code id="updateR_+3A_x">X</code></td>
<td>
<p>the patient level covariate matrix</p>
</td></tr>
<tr><td><code id="updateR_+3A_m">m</code></td>
<td>
<p>number of sites</p>
</td></tr>
<tr><td><code id="updateR_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updateR_+3A_p">p</code></td>
<td>
<p>dimension of patient level covariates</p>
</td></tr>
<tr><td><code id="updateR_+3A_q">q</code></td>
<td>
<p>dimension of site level covariates</p>
</td></tr>
<tr><td><code id="updateR_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateR( w ,Gamma,Beta,  Y, Z, delta, mu, mu_star, c, S, sigma_square, K, E, X, m,n,  p, q, T0)</code> returns the updated site level clustering.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

<hr>
<h2 id='updateZstar'>Function to generate new latent values for missingness model</h2><span id='topic+updateZstar'></span>

<h3>Description</h3>

<p>This function takes current parameters, gives updated c in missingess model. Note a double type of value is returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateZstar(mu_star, delta, n, T0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="updateZstar_+3A_mu_star">mu_star</code></td>
<td>
<p>current matrix of latent value for missingness model</p>
</td></tr>
<tr><td><code id="updateZstar_+3A_delta">delta</code></td>
<td>
<p>the missing indicator matrix, with 1 means missing</p>
</td></tr>
<tr><td><code id="updateZstar_+3A_n">n</code></td>
<td>
<p>number of patients</p>
</td></tr>
<tr><td><code id="updateZstar_+3A_t0">T0</code></td>
<td>
<p>number of teeth</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>updateZstar(mu_star, delta, n, T0)</code> returns a matrix of new generated latent values.
</p>


<h3>Author(s)</h3>

<p>Yuliang Li</p>


<h3>See Also</h3>

<p><a href="#topic+update_RJ">update_RJ</a> for a complete example for all functions in this package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
