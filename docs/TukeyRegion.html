<!DOCTYPE html><html><head><title>Help for package TukeyRegion</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TukeyRegion}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#depth.wm'><p>Computation of the Tukey depth weighted and/or trimmed mean</p></a></li>
<li><a href='#plot.TukeyRegion'><p>Plot the Tukey Region</p></a></li>
<li><a href='#summary.TukeyRegion'><p>Prints Summary of the Tukey Region</p></a></li>
<li><a href='#TukeyKMedian'><p>Computation of the Tukey median set and Tukey median</p></a></li>
<li><a href='#TukeyKRegions'><p>Computation of the Tukey Region</p></a></li>
<li><a href='#TukeyMedian'><p>Computation of the Tukey median set and Tukey median</p></a></li>
<li><a href='#TukeyRegion'><p>Computation of the Tukey Region</p></a></li>
<li><a href='#TukeyRegion-package'>
<p>Computation of the Tukey Region and the Tukey Median</p></a></li>
<li><a href='#TukeyRegions'><p>Computation of the Tukey Region</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tukey Region and Median</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.6.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-17</td>
</tr>
<tr>
<td>Description:</td>
<td>Tukey regions are polytopes in the Euclidean space, viz. 
    upper-level sets of the Tukey depth function on given data. The bordering 
    hyperplanes of a Tukey region are computed as well as its vertices, facets, 
    centroid, and volume. In addition, the Tukey median set, which is the 
    non-empty Tukey region having highest depth level, and its barycenter 
    (= Tukey median) are calculated. Tukey regions are visualized in dimension 
    two and three. For details see Liu, Mosler, and Mozharovskyi 
    (2019, &lt;<a href="https://doi.org/10.1080%2F10618600.2018.1546595">doi:10.1080/10618600.2018.1546595</a>&gt;). See file LICENSE.note for 
    additional license information.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>rgl,ddalpha,MASS,bfp,Rglpk</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp,BH</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-17 16:29:41 UTC; pavlomozharovskyi</td>
</tr>
<tr>
<td>Author:</td>
<td>C.B. Barber [aut, cph] (Qhull library),
  The Geometry Center University of Minnesota [cph] (Qhull library),
  Pavlo Mozharovskyi [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@telecom-paris.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-17 18:30:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='depth.wm'>Computation of the Tukey depth weighted and/or trimmed mean</h2><span id='topic+depth.wm'></span>

<h3>Description</h3>

<p>Computes the Tukey depth weighted and/or trimmed for a given depth level or for a given number of deepest points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depth.wm(data, depth.level = 1/nrow(data), weighted = TRUE, 
  break.ties = "atRandom", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="depth.wm_+3A_data">data</code></td>
<td>

<p>data set for which the weighted mean should be computed, a matrix having &gt; 2 columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="depth.wm_+3A_depth.level">depth.level</code></td>
<td>

<p>either Tukey depth level for trimming (a numeric between 1/(number of rows in <code>data</code>) and 1) or the number of deepest points to take into account (an integer between one and the number of rows in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="depth.wm_+3A_weighted">weighted</code></td>
<td>

<p>whether the trimmed mean should be weighted by depth, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="depth.wm_+3A_break.ties">break.ties</code></td>
<td>

<p>the way to break ties if the number of deepest points is given, character. If <code>"atRandom"</code> (by default) ties are broken at random, for any other value input points' order is used.
</p>
</td></tr>
<tr><td><code id="depth.wm_+3A_...">...</code></td>
<td>

<p>further agruments passed to function <code><a href="ddalpha.html#topic+depth.halfspace">depth.halfspace</a></code> of package <code><a href="ddalpha.html#topic+ddalpha">ddalpha</a></code>. See &lsquo;Details&rsquo; for additional information.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After having computed the Tukey depth of each point in <code>data</code> the function operates in two possible modes. If <code>depth.level</code> lies between 0 and 1 then the function computes trimmed (weighted if specified by flag <code>weighted</code>) mean of all points having at least given depth level. If <code>depth.level</code> specifies the number of points (an integer between 1 and number of rows in <code>data</code>) then the trimmed (weighted) mean of <code>depth.level</code> deepest points are calculated breaking ties due to argument <code>break.ties</code> (ties can occur due to discrete nature of the Tukey depth). This follows the idea of Donoho and Gasko (1992), also see this article for the breakdown point.
</p>
<p>Depth of points is calculated by means of external function <code><a href="ddalpha.html#topic+depth.halfspace">depth.halfspace</a></code> from package <code><a href="ddalpha.html#topic+ddalpha">ddalpha</a></code>, whose arguments can be specified as well. In particular, argument <code>exact</code> specifies whether Tukey depth is computed exactly (<code>TRUE</code>) or approximated (<code>FALSE</code>) by random projections; for the latter case argument <code>num.directions</code> specifies the number of random directions to use. For further details about the algorithm see Dyckerhoff and Mozharovskyi (2016).
</p>


<h3>Value</h3>

<p>The function returns the weighted and/or trimmed mean, a point in the <code>d</code>-variate Euclidean space (<code>d</code> is the number of columns in <code>data</code>), a numeric vector.
</p>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Donoho, D.L. and Gasko, M (1992). Breakdown properties of location estimates based on halfspace depth and projected outlyingness. <em>The Annals of Statistics</em>, 20(4), 1803-1827.
</p>
<p>Dyckerhoff, R. and Mozharovskyi, P. (2016). Exact computation of the halfspace depth. <em>Computational Statistics and Data Analysis</em>, 98, 19-30.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(bfp)
# Generate data
set.seed(1)
X &lt;- bfp:::rmvt(150, diag(3), rep(0, 3), 1)
# Compute arithmetic mean
T.mean &lt;- colMeans(X)
(T.mean)
# Compute Tukey depth trimmed weighted mean (approximate depth)
T.approx1 &lt;- depth.wm(X, 0.25)
(T.approx1)
T.approx2 &lt;- depth.wm(X, 25)
(T.approx2)
# Compute Tukey depth trimmed weighted mean (exact depth)
T.exact1 &lt;- depth.wm(X, 0.25, exact = TRUE)
(T.exact1)
T.exact2 &lt;- depth.wm(X, 25, exact = TRUE)
(T.exact2)
# Compute Tukey median
Tm &lt;- TukeyMedian(X)
(Tm$barycenter)
</code></pre>

<hr>
<h2 id='plot.TukeyRegion'>Plot the Tukey Region</h2><span id='topic+plot.TukeyRegion'></span>

<h3>Description</h3>

<p>Plots the two-dimensional and the three-dimensional Tukey region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TukeyRegion'
plot(x, newPlot = TRUE, drawPoints = TRUE, 
  drawRidges = TRUE, colorBackground = "white", 
  colorPoints = "red", colorFacets = "blue", 
  colorRidges = "green", lwd = 1, lty = 1, alpha = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TukeyRegion_+3A_x">x</code></td>
<td>

<p>object of class <code>TukeyRegion</code> to be plotted.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_newplot">newPlot</code></td>
<td>

<p>whether to create a new plot(2D)/scene(3D).
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_drawpoints">drawPoints</code></td>
<td>

<p>whether to show the data points.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_drawridges">drawRidges</code></td>
<td>

<p>whether to show the ridges; works for non-triangulated facets only.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_colorbackground">colorBackground</code></td>
<td>

<p>background color of the plot(2D)/scene(3D).
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_colorpoints">colorPoints</code></td>
<td>

<p>color of the points in case they are shown.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_colorfacets">colorFacets</code></td>
<td>

<p>color of the facets.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_colorridges">colorRidges</code></td>
<td>

<p>color of the facets' ridges in case they are shown.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_lwd">lwd</code></td>
<td>

<p>line width of the facets in 2D.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_lty">lty</code></td>
<td>

<p>line type of the facets in 2D.
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_alpha">alpha</code></td>
<td>

<p>transperency of the facets (and ridges if shown).
</p>
</td></tr>
<tr><td><code id="plot.TukeyRegion_+3A_...">...</code></td>
<td>

<p>included for compatibility and should not be used.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If dimension is equal to two, the traditional <code><a href="graphics.html#topic+plot">plot</a></code> is produced. If dimension is equal to three, the 3D-scene is produced using the package <code><a href="rgl.html#topic+rgl">rgl</a></code>.
</p>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in TukeyRegion or TukeyMedian
</code></pre>

<hr>
<h2 id='summary.TukeyRegion'>Prints Summary of the Tukey Region</h2><span id='topic+summary.TukeyRegion'></span>

<h3>Description</h3>

<p>Prints basic information about the Tukey region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TukeyRegion'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.TukeyRegion_+3A_object">object</code></td>
<td>

<p>object of class <code>TukeyRegion</code> for which the summary should be printed.
</p>
</td></tr>
<tr><td><code id="summary.TukeyRegion_+3A_...">...</code></td>
<td>

<p>included for compatibility and should not be used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints in the console basic information about the computed Tukey region.
</p>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See examples in TukeyRegion or TukeyMedian
</code></pre>

<hr>
<h2 id='TukeyKMedian'>Computation of the Tukey median set and Tukey median</h2><span id='topic+TukeyKMedian'></span>

<h3>Description</h3>

<p>Computes the Tukey median set and its barycenter, the Tukey median, starting from the region with dpeth <code>1</code> iteratively increasing it, according to the algorithm by Fojtik et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TukeyKMedian(data, algMedian = "upwards", method = "bfs",
  trgFacets = TRUE, retHalfspaces = FALSE, retHalfspacesNR = FALSE,
  retInnerPoint = FALSE, retVertices = TRUE, retFacets = TRUE,
  retVolume = FALSE, retBarycenter = TRUE, verbosity = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TukeyKMedian_+3A_data">data</code></td>
<td>

<p>data set for which the Tukey median shall be computed, a matrix having &gt; 2 columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_algmedian">algMedian</code></td>
<td>

<p>the algorithm used to compute the Tukey median, a string containing <code>bsbarydepth</code>, or <code>"cutintwo"</code>, or <code>"downwards"</code>, or <code>"upwards"</code>, see &lsquo;Details&rsquo;, <code>"bsbarydepth"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_method">method</code></td>
<td>

<p>the method to use to compute the Tukey region, a string containing <code>"bfs"</code>, or <code>"cmb"</code>, or <code>"bf"</code>, see <code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code>"bfs"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_trgfacets">trgFacets</code></td>
<td>

<p>whether to triangulate facets, logical, <code>FALSE</code> by default. In this case no facet ridges are plotted, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_rethalfspaces">retHalfspaces</code></td>
<td>

<p>whether to return all found halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_rethalfspacesnr">retHalfspacesNR</code></td>
<td>

<p>whether to return non-redundant halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_retinnerpoint">retInnerPoint</code></td>
<td>

<p>whether to return inner point, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_retvertices">retVertices</code></td>
<td>

<p>whether to return vertices, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_retfacets">retFacets</code></td>
<td>

<p>whether to return facets, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_retvolume">retVolume</code></td>
<td>

<p>whether to return volume, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_retbarycenter">retBarycenter</code></td>
<td>

<p>whether to return the region's barycenter, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKMedian_+3A_verbosity">verbosity</code></td>
<td>

<p>level of details to print during execution, integer, from <code>0</code> (= print nothing) to <code>2</code> (= print all details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the Tukey median set, <em>i.e.</em> the region with the highest depth value, for <code>n</code> points in the Euclidean <code>d</code>-variate space contained in <code>data</code>.
</p>
<p>It also computes this set's barycenter, which is the Tukey median. Four search algorithms are implemented: Algorithm <code>bsbarydepth</code> is the most efficient, it is the bisection algorithm starting with the lower bound as the maximum of the theoretical minimum and the depth of the componentwise median, and updating lower bound with the depth of the barycenter of the last found region. Algorithm <code>"cutintwo"</code> sequntially cuts the range of remaining depths into two parts starting with the range from <code>1</code> to the upper bound obtained by Liu, Luo, and Zuo (2016). Algorithm <code>"downwards"</code> is checking each depth value decrementally with step <code>1</code> starting with the upper bound obtained by Liu, Luo, and Zuo (2016) until the first existing region is found. Algorithm <code>"upwards"</code> is checking each depth value incrementally until the first non-existing region is found.
</p>
<p>The main goal of the function is to provide the polytope (Tukey median set) and its barycenter (Tukey median); the settings can be adjusted though. After the median depth is found, the <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> function is called.
</p>
<p>See function <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> for details regarding the output.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>TukeyRegion</code> with fields specified by <code>ret...</code>-flags in the arguments:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>the input data set.
</p>
</td></tr>
<tr><td><code>depth</code></td>
<td>

<p>chosen depth level.
</p>
</td></tr>
<tr><td><code>numRegions</code></td>
<td>

<p>number of time the depth region has been computed.
</p>
</td></tr>
<tr><td><code>halfspacesFound</code></td>
<td>

<p>whether at least one of the determining Tukey region halfspaces has been found.
</p>
</td></tr>
<tr><td><code>halfspaces</code></td>
<td>

<p>if requested, halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code>innerPointFound</code></td>
<td>

<p>a logical indicating whether an inner point of the region has been found. If <code>FALSE</code> then the region of the given depth does not exist. If the field is absent then the inner point has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>innerPoint</code></td>
<td>

<p>coordinates of a point inside of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>halfspacesNR</code></td>
<td>

<p>non-redundant halfspaces (<em>i.e.</em> those containing Tukey region's facets), a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>vertices</code></td>
<td>

<p>vertices of the Tukey region, a matrix with number of columns equal to space dimension and where each row represents vertex coordinates. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments. If field <code>facets</code> is returned, this field is returned as well.
</p>
</td></tr>
<tr><td><code>triangulated</code></td>
<td>

<p>a logical repeating the <code>trgFacets</code> input argument. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>facets</code></td>
<td>

<p>facets of the Tukey region. If input argument <code>trgFacets</code> is set, then this is a list where each element is an array enumerating numbers of the rows in field <code>vertices</code>, their number for each facet can vary. If input argument <code>trgFacets</code> is unset, then this is a matrix with each row corresponding to a triangulated facet, and no facets' ridges reconstruction is performed, so it cannot be visualized. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>

<p>volume of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>barycenter</code></td>
<td>

<p>the barycenter of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>numRidges</code></td>
<td>

<p>number of used ridges (for computing the last region).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Liu, X., Luo, S., and Zuo, Y. (2020). Some results on the computing of Tukey's halfspace median. <em>Statistical Papers</em>, 61, 303-316.
</p>
<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
</p>
<p>Vit Fojtik, Petra Laketa, Pavlo Mozharovskyi, and Stanislav Nagy (2022). On exact computation of Tukey depth central regions. <em>arXiv:2208.04587</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code><a href="#topic+depth.wm">depth.wm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(100, rep(0, 3),
  matrix(c(1, 1, 1, 1, 2, 2, 1, 2, 4), nrow = 3))
# Compute the Tukey median
Tm &lt;- TukeyKMedian(X)
summary(Tm)
# Visualize the Tukey median
plot(Tm)
</code></pre>

<hr>
<h2 id='TukeyKRegions'>Computation of the Tukey Region</h2><span id='topic+TukeyKRegions'></span>

<h3>Description</h3>

<p>Computes the Tukey depth trimmed regions for all depth levels from <code>1</code> to <code>K</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TukeyKRegions(data, maxDepth, method = "bfs",
  trgFacets = FALSE, checkInnerPoint = TRUE,
  retHalfspaces = TRUE, retHalfspacesNR = FALSE,
  retInnerPoint = FALSE, retVertices = FALSE,
  retFacets = FALSE, retVolume = FALSE, retBarycenter = FALSE,
  verbosity = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TukeyKRegions_+3A_data">data</code></td>
<td>

<p>data set for which the Tukey region shall be computed, a matrix having &gt; 2 columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_maxdepth">maxDepth</code></td>
<td>

<p>depth level until which Tukey regions to compute, an integer between <code>1</code> and the half of the number of rows in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_method">method</code></td>
<td>

<p>the method to use to compute the Tukey region, a string containing <code>"bfs"</code>, or <code>"cmb"</code>, or <code>"bf"</code>, see &lsquo;Details&rsquo;, <code>"bfs"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_trgfacets">trgFacets</code></td>
<td>

<p>whether to triangulate facets, logical, <code>FALSE</code> by default. In this case no facet ridges are plotted, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_checkinnerpoint">checkInnerPoint</code></td>
<td>

<p>whether to check correctness of the inner point in case it is provided, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_rethalfspaces">retHalfspaces</code></td>
<td>

<p>whether to return all found halfspaces, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_rethalfspacesnr">retHalfspacesNR</code></td>
<td>

<p>whether to return non-redundant halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_retinnerpoint">retInnerPoint</code></td>
<td>

<p>whether to return inner point, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_retvertices">retVertices</code></td>
<td>

<p>whether to return vertices, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_retfacets">retFacets</code></td>
<td>

<p>whether to return facets, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_retvolume">retVolume</code></td>
<td>

<p>whether to return volume, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_retbarycenter">retBarycenter</code></td>
<td>

<p>whether to return the region's barycenter, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyKRegions_+3A_verbosity">verbosity</code></td>
<td>

<p>level of details to print during execution, integer, from <code>0</code> (= print nothing) to <code>2</code> (= print all details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the Tukey regions (upper-level set of the Tukey depth function) for <code>n</code> points in the Euclidean <code>d</code>-variate space contained in <code>data</code> at the depth values specified in the argument <code>maxDepth</code>. This function calls iteratively function <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> for depth levels from <code>1</code> to <code>maxDepth</code>, where each time the initial set of ridges conincides with all the ridges found at the previous step (see Fojtik et al., 2022).
</p>
<p>Due to the nature of the function, arguments <code>halfspaces</code> and/or <code>innerPoint</code> cannot be provided here anymore.
</p>


<h3>Value</h3>

<p>The function returns a list of objects of class <code>TukeyRegion</code> with fields specified by <code>ret...</code>-flags in the arguments:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>the input data set.
</p>
</td></tr>
<tr><td><code>depth</code></td>
<td>

<p>chosen depth level.
</p>
</td></tr>
<tr><td><code>halfspacesFound</code></td>
<td>

<p>whether at least one of the determining Tukey region halfspaces has been found.
</p>
</td></tr>
<tr><td><code>halfspaces</code></td>
<td>

<p>if requested, halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code>innerPointFound</code></td>
<td>

<p>a logical indicating whether an inner point of the region has been found. If <code>FALSE</code> then the region of the given depth does not exist. If the field is absent then the inner point has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>innerPoint</code></td>
<td>

<p>coordinates of a point inside of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>halfspacesNR</code></td>
<td>

<p>non-redundant halfspaces (<em>i.e.</em> those containing Tukey region's facets), a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>vertices</code></td>
<td>

<p>vertices of the Tukey region, a matrix with number of columns equal to space dimension and where each row represents vertex coordinates. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments. If field <code>facets</code> is returned, this field is returned as well.
</p>
</td></tr>
<tr><td><code>triangulated</code></td>
<td>

<p>a logical repeating the <code>trgFacets</code> input argument. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>facets</code></td>
<td>

<p>facets of the Tukey region. If input argument <code>trgFacets</code> is set, then this is a list where each element is an array enumerating numbers of the rows in field <code>vertices</code>; their number for each facet can vary. If input argument <code>trgFacets</code> is unset, then this is a matrix with each row corresponding to a triangulated facet, and no facets' ridges reconstruction is performed. So it cannot be visualized. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>

<p>volume of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>barycenter</code></td>
<td>

<p>the barycenter of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>numRidges</code></td>
<td>

<p>number of used ridges.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
Vit Fojtik, Petra Laketa, Pavlo Mozharovskyi, and Stanislav Nagy (2022). On exact computation of Tukey depth central regions. <em>arXiv:2208.04587</em>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>
<code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(500, rep(0, 3),
  matrix(c(1, 0.25, 0.25, 0.25, 1, 0.25, 0.25, 0.25, 1), nrow = 3))
# Compute the Tukey region
Trs &lt;- TukeyKRegions(X, 5, "bfs",
  retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)
for (i in 1:5){
  summary(Trs[[i]])
  cat("\n")
}
</code></pre>

<hr>
<h2 id='TukeyMedian'>Computation of the Tukey median set and Tukey median</h2><span id='topic+TukeyMedian'></span>

<h3>Description</h3>

<p>Computes the Tukey median set and its barycenter, the Tukey median.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TukeyMedian(data, algMedian = "bsbarydepth", method = "bfs",
  trgFacets = TRUE, retHalfspaces = FALSE, retHalfspacesNR = FALSE,
  retInnerPoint = FALSE, retVertices = TRUE, retFacets = TRUE,
  retVolume = FALSE, retBarycenter = TRUE, verbosity = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TukeyMedian_+3A_data">data</code></td>
<td>

<p>data set for which the Tukey median shall be computed, a matrix having &gt; 2 columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_algmedian">algMedian</code></td>
<td>

<p>the algorithm used to compute the Tukey median, a string containing <code>bsbarydepth</code>, or <code>"cutintwo"</code>, or <code>"downwards"</code>, or <code>"upwards"</code>, see &lsquo;Details&rsquo;, <code>"bsbarydepth"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_method">method</code></td>
<td>

<p>the method to use to compute the Tukey region, a string containing <code>"bfs"</code>, or <code>"cmb"</code>, or <code>"bf"</code>, see <code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code>"bfs"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_trgfacets">trgFacets</code></td>
<td>

<p>whether to triangulate facets, logical, <code>FALSE</code> by default. In this case no facet ridges are plotted, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_rethalfspaces">retHalfspaces</code></td>
<td>

<p>whether to return all found halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_rethalfspacesnr">retHalfspacesNR</code></td>
<td>

<p>whether to return non-redundant halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_retinnerpoint">retInnerPoint</code></td>
<td>

<p>whether to return inner point, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_retvertices">retVertices</code></td>
<td>

<p>whether to return vertices, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_retfacets">retFacets</code></td>
<td>

<p>whether to return facets, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_retvolume">retVolume</code></td>
<td>

<p>whether to return volume, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_retbarycenter">retBarycenter</code></td>
<td>

<p>whether to return the region's barycenter, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyMedian_+3A_verbosity">verbosity</code></td>
<td>

<p>level of details to print during execution, integer, from <code>0</code> (= print nothing) to <code>2</code> (= print all details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the Tukey median set, <em>i.e.</em> the region with the highest depth value, for <code>n</code> points in the Euclidean <code>d</code>-variate space contained in <code>data</code>.
</p>
<p>It also computes this set's barycenter, which is the Tukey median. Four search algorithms are implemented: Algorithm <code>bsbarydepth</code> is the most efficient, it is the bisection algorithm starting with the lower bound as the maximum of the theoretical minimum and the depth of the componentwise median, and updating lower bound with the depth of the barycenter of the last found region. Algorithm <code>"cutintwo"</code> sequntially cuts the range of remaining depths into two parts starting with the range from <code>1</code> to the upper bound obtained by Liu, Luo, and Zuo (2016). Algorithm <code>"downwards"</code> is checking each depth value decrementally with step <code>1</code> starting with the upper bound obtained by Liu, Luo, and Zuo (2016) until the first existing region is found. Algorithm <code>"upwards"</code> is checking each depth value incrementally until the first non-existing region is found.
</p>
<p>The main goal of the function is to provide the polytope (Tukey median set) and its barycenter (Tukey median); the settings can be adjusted though. After the median depth is found, the <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> function is called.
</p>
<p>See function <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> for details regarding the output.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>TukeyRegion</code> with fields specified by <code>ret...</code>-flags in the arguments:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>the input data set.
</p>
</td></tr>
<tr><td><code>depth</code></td>
<td>

<p>chosen depth level.
</p>
</td></tr>
<tr><td><code>numRegions</code></td>
<td>

<p>number of time the depth region has been computed.
</p>
</td></tr>
<tr><td><code>halfspacesFound</code></td>
<td>

<p>whether at least one of the determining Tukey region halfspaces has been found.
</p>
</td></tr>
<tr><td><code>halfspaces</code></td>
<td>

<p>if requested, halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code>innerPointFound</code></td>
<td>

<p>a logical indicating whether an inner point of the region has been found. If <code>FALSE</code> then the region of the given depth does not exist. If the field is absent then the inner point has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>innerPoint</code></td>
<td>

<p>coordinates of a point inside of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>halfspacesNR</code></td>
<td>

<p>non-redundant halfspaces (<em>i.e.</em> those containing Tukey region's facets), a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>vertices</code></td>
<td>

<p>vertices of the Tukey region, a matrix with number of columns equal to space dimension and where each row represents vertex coordinates. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments. If field <code>facets</code> is returned, this field is returned as well.
</p>
</td></tr>
<tr><td><code>triangulated</code></td>
<td>

<p>a logical repeating the <code>trgFacets</code> input argument. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>facets</code></td>
<td>

<p>facets of the Tukey region. If input argument <code>trgFacets</code> is set, then this is a list where each element is an array enumerating numbers of the rows in field <code>vertices</code>, their number for each facet can vary. If input argument <code>trgFacets</code> is unset, then this is a matrix with each row corresponding to a triangulated facet, and no facets' ridges reconstruction is performed, so it cannot be visualized. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>

<p>volume of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>barycenter</code></td>
<td>

<p>the barycenter of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>numRidges</code></td>
<td>

<p>number of used ridges (for computing the last region).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Liu, X., Luo, S., and Zuo, Y. (2020). Some results on the computing of Tukey's halfspace median. <em>Statistical Papers</em>, 61, 303-316.
</p>
<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code><a href="#topic+depth.wm">depth.wm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(100, rep(0, 3),
  matrix(c(1, 1, 1, 1, 2, 2, 1, 2, 4), nrow = 3))
# Compute the Tukey median
Tm &lt;- TukeyMedian(X)
summary(Tm)
# Visualize the Tukey median
plot(Tm)
</code></pre>

<hr>
<h2 id='TukeyRegion'>Computation of the Tukey Region</h2><span id='topic+TukeyRegion'></span>

<h3>Description</h3>

<p>Computes the Tukey depth trimmed region for a given depth level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TukeyRegion(data, depth, method = "bfs",
  trgFacets = FALSE, checkInnerPoint = TRUE,
  retHalfspaces = TRUE, retHalfspacesNR = FALSE,
  retInnerPoint = FALSE, retVertices = FALSE,
  retFacets = FALSE, retVolume = FALSE, retBarycenter = FALSE,
  halfspaces = matrix(0), innerPoint = numeric(1),
  verbosity = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TukeyRegion_+3A_data">data</code></td>
<td>

<p>data set for which the Tukey region shall be computed, a matrix having <code>&gt; 2</code> columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_depth">depth</code></td>
<td>

<p>depth of the Tukey region, an integer between <code>1</code> and the half of the number of rows in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_method">method</code></td>
<td>

<p>the method to use to compute the Tukey region, a string containing <code>"bfs"</code>, or <code>"cmb"</code>, or <code>"bf"</code>, see &lsquo;Details&rsquo;, <code>"bfs"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_trgfacets">trgFacets</code></td>
<td>

<p>whether to triangulate facets, logical, <code>FALSE</code> by default. In this case no facet ridges are plotted, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_checkinnerpoint">checkInnerPoint</code></td>
<td>

<p>whether to check correctness of the inner point in case it is provided, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_rethalfspaces">retHalfspaces</code></td>
<td>

<p>whether to return all found halfspaces, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_rethalfspacesnr">retHalfspacesNR</code></td>
<td>

<p>whether to return non-redundant halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_retinnerpoint">retInnerPoint</code></td>
<td>

<p>whether to return inner point, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_retvertices">retVertices</code></td>
<td>

<p>whether to return vertices, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_retfacets">retFacets</code></td>
<td>

<p>whether to return facets, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_retvolume">retVolume</code></td>
<td>

<p>whether to return volume, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_retbarycenter">retBarycenter</code></td>
<td>

<p>whether to return the region's barycenter, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_halfspaces">halfspaces</code></td>
<td>

<p>halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_innerpoint">innerPoint</code></td>
<td>

<p>inner point, a vector of length equal to dimension.
</p>
</td></tr>
<tr><td><code id="TukeyRegion_+3A_verbosity">verbosity</code></td>
<td>

<p>level of details to print during execution, integer, from <code>0</code> (= print nothing) to <code>2</code> (= print all details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the Tukey region (upper-level set of the Tukey depth function) for <code>n</code> points in the Euclidean <code>d</code>-variate space contained in <code>data</code> at the depth value <code>depth</code>.
</p>
<p>Three methods are implemented: Method <code>"bfs"</code> is the most efficient, it starts with an initial set of ridges and traverses all facets using the <b>breadth-first search</b> algorithm. Method <code>"cmb"</code> considers all subspaces spanned by <b>combinations</b> of <code>d - 1</code> points, projects <code>data</code> onto their orthogonal complements (planes), and searches for bivariate quantiles these planes. Method <code>"bf"</code> employs the <b>brute-force</b> strategy by checking all halfspaces defined by hyperplanes containing <code>d</code> points from <code>data</code>. If <code>d = 2</code>, method <code>"bf"</code> is used. See Liu, Mosler, and Mozharovskyi (2019) for details on algorithms.
</p>
<p>The function proceeds in three main steps. Step 1: Calculate all the halfspaces defining Tukey region in their intersection. Many of them are usually redundant. Step 2: Find the inner point of the Tukey region, <em>i.e.</em> a point which lies simultaneously in all the before calculated halfspaces. If such a point does not exist neither does the Tukey region exist for this depth level. The algorithm stops and returns <code>FALSE</code> in the field <code>innerPointFound</code>. If the inner point has been found, the algorithm proceeds to Step 3: Filter the halfspaces leaving only those containing the facets of the Tukey region. Step 3 provides infirmation to compute vertices, facets, volume, and barycenter of the Tukey region.
</p>
<p><code>halfspaces</code> and/or <code>innerPoint</code> can be provided as function arguments.
</p>
<p>The function tries to fulfill all the requirements indicated by the input flags. Step 1 is performed anyway (even if <code>retHalfspaces</code> is unset, which means the halfspaces just should not be output, except they are provided by the argument <code>halfspaces</code>). If any further <code>ret...</code>-flag is set Step 2 is performed, except <code>retHalfspacesNR</code> is unset and the argument <code>innerPoint</code> provided. If any of <code>retVertices</code>, <code>retFacets</code>, <code>retVolume</code>, <code>retBarycenter</code> is set, Step 3 is performed.
</p>
<p>The region can be visualized in 2- and 3-dimensional space by <code>plot(...)</code>, general information can be printed by <code>print(...)</code>, statistics can be summarized by <code>summary(...)</code>.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>TukeyRegion</code> with fields specified by <code>ret...</code>-flags in the arguments:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>the input data set.
</p>
</td></tr>
<tr><td><code>depth</code></td>
<td>

<p>chosen depth level.
</p>
</td></tr>
<tr><td><code>halfspacesFound</code></td>
<td>

<p>whether at least one of the determining Tukey region halfspaces has been found.
</p>
</td></tr>
<tr><td><code>halfspaces</code></td>
<td>

<p>if requested, halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code>innerPointFound</code></td>
<td>

<p>a logical indicating whether an inner point of the region has been found. If <code>FALSE</code> then the region of the given depth does not exist. If the field is absent then the inner point has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>innerPoint</code></td>
<td>

<p>coordinates of a point inside of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>halfspacesNR</code></td>
<td>

<p>non-redundant halfspaces (<em>i.e.</em> those containing Tukey region's facets), a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>vertices</code></td>
<td>

<p>vertices of the Tukey region, a matrix with number of columns equal to space dimension and where each row represents vertex coordinates. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments. If field <code>facets</code> is returned, this field is returned as well.
</p>
</td></tr>
<tr><td><code>triangulated</code></td>
<td>

<p>a logical repeating the <code>trgFacets</code> input argument. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>facets</code></td>
<td>

<p>facets of the Tukey region. If input argument <code>trgFacets</code> is set, then this is a list where each element is an array enumerating numbers of the rows in field <code>vertices</code>; their number for each facet can vary. If input argument <code>trgFacets</code> is unset, then this is a matrix with each row corresponding to a triangulated facet, and no facets' ridges reconstruction is performed. So it cannot be visualized. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>

<p>volume of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>barycenter</code></td>
<td>

<p>the barycenter of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>numRidges</code></td>
<td>

<p>number of used ridges.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(500, rep(0, 3),
  matrix(c(1, 1, 1, 1, 2, 2, 1, 2, 4), nrow = 3))
# Compute the Tukey region
Tr &lt;- TukeyRegion(X, 10, "bfs",
  retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)
summary(Tr)
# Visualize the Tukey region
plot(Tr)
</code></pre>

<hr>
<h2 id='TukeyRegion-package'>
Computation of the Tukey Region and the Tukey Median
</h2><span id='topic+TukeyRegion-package'></span><span id='topic+TukeyRegion-package'></span>

<h3>Description</h3>

<p>Tukey regions are polytopes in the Euclidean space, <em>viz.</em> upper-level sets of the Tukey depth function on given data. The bordering hyperplanes of a Tukey region are computed as well as its vertices, facets, centroid, and volume. In addition, the Tukey median set, which is the non-empty Tukey region having highest depth level, and its barycenter (= Tukey median) are calculated. Tukey regions are visualized in dimension two and three. For details see Liu, Mosler, and Mozharovskyi (2019).
</p>


<h3>Details</h3>

<p>Proposed initially by John W. Tukey in 1975 (see also Donoho and Gasko, 1992) Tukey depth measures centrality of an arbitrary point in the Euclidean space w.r.t. a data cloud. For a point, Tukey (also halfspace or location) depth is defined as the smallest portion of observations that can be cut off by a closed halfspace containing this. For a given depth level Tukey (trimmed) region is defined as the upper level set of the Tukey depth function; it constitutes a closed polytope. The Tukey region of the highest level is referred to as the Tukey median set, while its barycenter is mentioned as the Tukey median. Due to properties of affine invariance, quasiconcavity, vanishing at infinity, high breakdown point of the median set, the Tukey depth attracted attention of statisticians and experienced substantial theoretical development. It is used in numerous applications including multivariate data analysis, outlier detection, tests for location (also scale and symmetry), classification, statistical quality control, imputation of missing data, etc.
</p>
<p>Package <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> provides routines for computation (<code><a href="#topic+TukeyRegion">TukeyRegion</a></code>) and visualization (<code><a href="graphics.html#topic+plot">plot</a></code>) of the Tukey depth trimmed region, the Tukey median set and Tukey median (<code><a href="#topic+TukeyMedian">TukeyMedian</a></code>), and Tukey depth weighted and/or trimmed mean (<code><a href="#topic+depth.wm">depth.wm</a></code>).
</p>
<p>For cumputation of Tukey depth see function <code><a href="ddalpha.html#topic+depth.halfspace">depth.halfspace</a></code> of package <code><a href="ddalpha.html#topic+ddalpha">ddalpha</a></code>.
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> TukeyRegion</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1.6.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-04-17</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Authors:
C.B. Barber [aut, cph] (Qhull library), The Geometry Center of University of Minnesota [cph]  (Qhull library), Pavlo Mozharovskyi [aut, cre]
</p>
<p>Maintainer: Pavlo Mozharovskyi, &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Donoho, D.L. and Gasko, M (1992). Breakdown properties of location estimates based on halfspace depth and projected outlyingness. <em>The Annals of Statistics</em>, 20(4), 1803-1827.
</p>
<p>Dyckerhoff, R. and Mozharovskyi, P. (2016). Exact computation of the halfspace depth. <em>Computational Statistics and Data Analysis</em>, 98, 19-30.
</p>
<p>Hallin, M., Paindaveine, D., and Siman, M. (2010). Multivariate quantiles and multiple-output regression quantiles: from L1-optimization to halfspace depth. <em>The Annals of Statistics</em>, 38, 635-669.
</p>
<p>Kong, L. and Mizera, I. (2012). Quantile tomography: using quantiles with multivariate data. <em>Statistica Sinica</em>, 22, 1589-1610. Published online as <code>arXiv:0805.0056 [stat.ME]</code> (2008).
</p>
<p>Liu, X., Luo, S., and Zuo, Y. (2020). Some results on the computing of Tukey's halfspace median. <em>Statistical Papers</em>, 61, 303-316.
</p>
<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
</p>
<p>Tukey, J.W. (1975). Mathematics and the picturing of data. In: James, R.D. (Ed.), <em>Proceeding of the International Congress of Mathematicians (Volume 2)</em>, Canadian Mathematical Congress, Vancouver, 523-531.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>, <code><a href="#topic+TukeyMedian">TukeyMedian</a></code>, <code><a href="#topic+depth.wm">depth.wm</a></code>,
</p>
<p><code><a href="ddalpha.html#topic+depth.halfspace">depth.halfspace</a></code>, <code><a href="ddalpha.html#topic+ddalpha">ddalpha</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(100, rep(0, 3), diag(3))
# Compute and visualize two Tukey regions
Tr1 &lt;- TukeyRegion(X, 5, "bfs",
  retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)
Tr2 &lt;- TukeyRegion(X, 25, "bfs",
  retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)
plot(Tr1, colorFacets = "red", colorRidges = "red",
  colorPoints = "blue", alpha = 0.35)
plot(Tr2, newPlot = FALSE, drawPoints = FALSE, colorFacets = "green",
  colorRidges = "green", alpha = 0.65)
(Tr1$barycenter)
(Tr2$barycenter)
# Compute arithmetic mean
T.mean &lt;- colMeans(X)
(T.mean)
# Compute Tukey depth trimmed weighted mean (approximate depth)
T.approx1 &lt;- depth.wm(X, 0.25)
(T.approx1)
T.approx2 &lt;- depth.wm(X, 75)
(T.approx2)
# Compute Tukey depth trimmed weighted mean (exact depth)
T.exact1 &lt;- depth.wm(X, 0.25, exact = TRUE)
(T.exact1)
T.exact2 &lt;- depth.wm(X, 75, exact = TRUE)
(T.exact2)
# Compute and visualize Tukey median
Tm &lt;- TukeyMedian(X)
(Tm$barycenter)
plot(Tm, newPlot = FALSE, drawPoints = FALSE)
</code></pre>

<hr>
<h2 id='TukeyRegions'>Computation of the Tukey Region</h2><span id='topic+TukeyRegions'></span>

<h3>Description</h3>

<p>Computes the Tukey depth trimmed regions for given depth levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TukeyRegions(data, depths, method = "bfs",
  trgFacets = FALSE, checkInnerPoint = TRUE,
  retHalfspaces = TRUE, retHalfspacesNR = FALSE,
  retInnerPoint = FALSE, retVertices = FALSE,
  retFacets = FALSE, retVolume = FALSE, retBarycenter = FALSE,
  verbosity = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TukeyRegions_+3A_data">data</code></td>
<td>

<p>data set for which the Tukey region shall be computed, a matrix having <code>&gt; 2</code> columns and more rows than columns.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_depths">depths</code></td>
<td>

<p>depths of the Tukey regions to compute, a vector of integers between <code>1</code> and the half of the number of rows in <code>data</code>.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_method">method</code></td>
<td>

<p>the method to use to compute the Tukey region, a string containing <code>"bfs"</code>, or <code>"cmb"</code>, or <code>"bf"</code>, see &lsquo;Details&rsquo;, <code>"bfs"</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_trgfacets">trgFacets</code></td>
<td>

<p>whether to triangulate facets, logical, <code>FALSE</code> by default. In this case no facet ridges are plotted, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_checkinnerpoint">checkInnerPoint</code></td>
<td>

<p>whether to check correctness of the inner point in case it is provided, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_rethalfspaces">retHalfspaces</code></td>
<td>

<p>whether to return all found halfspaces, logical, <code>TRUE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_rethalfspacesnr">retHalfspacesNR</code></td>
<td>

<p>whether to return non-redundant halfspaces, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_retinnerpoint">retInnerPoint</code></td>
<td>

<p>whether to return inner point, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_retvertices">retVertices</code></td>
<td>

<p>whether to return vertices, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_retfacets">retFacets</code></td>
<td>

<p>whether to return facets, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_retvolume">retVolume</code></td>
<td>

<p>whether to return volume, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_retbarycenter">retBarycenter</code></td>
<td>

<p>whether to return the region's barycenter, logical, <code>FALSE</code> by default.
</p>
</td></tr>
<tr><td><code id="TukeyRegions_+3A_verbosity">verbosity</code></td>
<td>

<p>level of details to print during execution, integer, from <code>0</code> (= print nothing) to <code>2</code> (= print all details).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the Tukey regions (upper-level set of the Tukey depth function) for <code>n</code> points in the Euclidean <code>d</code>-variate space contained in <code>data</code> at the depth values specified in the argument <code>depths</code>. This function calls multiple times function <code><a href="#topic+TukeyRegion">TukeyRegion</a></code> and provides computational convenience by shifting the loop on the <code>C++</code> level.
</p>
<p>The main difference with <code><a href="#topic+TukeyMedian">TukeyMedian</a></code> is that arguments <code>halfspaces</code> and/or <code>innerPoint</code> cannot be provided here anymore.
</p>


<h3>Value</h3>

<p>The function returns a list of objects of class <code>TukeyRegion</code> with fields specified by <code>ret...</code>-flags in the arguments:
</p>
<table>
<tr><td><code>data</code></td>
<td>

<p>the input data set.
</p>
</td></tr>
<tr><td><code>depth</code></td>
<td>

<p>chosen depth level.
</p>
</td></tr>
<tr><td><code>halfspacesFound</code></td>
<td>

<p>whether at least one of the determining Tukey region halfspaces has been found.
</p>
</td></tr>
<tr><td><code>halfspaces</code></td>
<td>

<p>if requested, halfspaces defining the Tukey region by their intersection, a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>.
</p>
</td></tr>
<tr><td><code>innerPointFound</code></td>
<td>

<p>a logical indicating whether an inner point of the region has been found. If <code>FALSE</code> then the region of the given depth does not exist. If the field is absent then the inner point has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>innerPoint</code></td>
<td>

<p>coordinates of a point inside of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>halfspacesNR</code></td>
<td>

<p>non-redundant halfspaces (<em>i.e.</em> those containing Tukey region's facets), a matrix with number of columns equal to space dimension and where each row corresponds to a halfspace defined by three point numbers in <code>data</code>. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>vertices</code></td>
<td>

<p>vertices of the Tukey region, a matrix with number of columns equal to space dimension and where each row represents vertex coordinates. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments. If field <code>facets</code> is returned, this field is returned as well.
</p>
</td></tr>
<tr><td><code>triangulated</code></td>
<td>

<p>a logical repeating the <code>trgFacets</code> input argument. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>facets</code></td>
<td>

<p>facets of the Tukey region. If input argument <code>trgFacets</code> is set, then this is a list where each element is an array enumerating numbers of the rows in field <code>vertices</code>; their number for each facet can vary. If input argument <code>trgFacets</code> is unset, then this is a matrix with each row corresponding to a triangulated facet, and no facets' ridges reconstruction is performed. So it cannot be visualized. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>volume</code></td>
<td>

<p>volume of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>barycenter</code></td>
<td>

<p>the barycenter of the Tukey region. If the field is absent then either no halfspaces or no inner point have been found or facet computation has not been requested by the input arguments.
</p>
</td></tr>
<tr><td><code>numRidges</code></td>
<td>

<p>number of used ridges.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pavlo Mozharovskyi &lt;pavlo.mozharovskyi@ensai.fr&gt;
</p>


<h3>References</h3>

<p>Liu, X., Mosler, K., and Mozharovskyi, P. (2019). Fast computation of Tukey trimmed regions and median in dimension p &gt; 2. <em>Journal of Computational and Graphical Statistics</em>, 28, 682-697.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TukeyRegion">TukeyRegion</a></code>
<code><a href="#topic+TukeyMedian">TukeyMedian</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load required packages
require(TukeyRegion)
require(MASS)
# Generate data
set.seed(1)
X &lt;- mvrnorm(500, rep(0, 3),
  matrix(c(1, 0.25, 0.25, 0.25, 1, 0.25, 0.25, 0.25, 1), nrow = 3))
# Compute the Tukey region
Trs &lt;- TukeyRegions(X, c(5, 25), "bfs",
  retFacets = TRUE, retVolume = TRUE, retBarycenter = TRUE)
summary(Trs[[1]])
summary(Trs[[2]])
# Visualize the Tukey region
plot(Trs[[2]], drawRidges = FALSE, colorFacets = "green", alpha = 1)
plot(Trs[[1]], drawRidges = FALSE, newPlot = FALSE, colorFacets = "blue",
  alpha = 0.5)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
