<!DOCTYPE html><html><head><title>Help for package dynmix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dynmix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cauimp'><p>Computes Causal Inference through Counterfactual Predictions from a Mixture Estimation with State-Space Components.</p></a></li>
<li><a href='#convts'><p>Renames Selected Outcomes of <code>mixest</code> and <code>tvpreg</code> Objects.</p></a></li>
<li><a href='#ldlt'><p>Computes LDL' Matrix Decomposition.</p></a></li>
<li><a href='#ltdl'><p>Computes L'DL Matrix Decomposition.</p></a></li>
<li><a href='#mixest1'><p>Computes Mixture Estimation with State-Space Components.</p></a></li>
<li><a href='#mixest2'><p>Computes Mixture Estimation with Normal Regression Components.</p></a></li>
<li><a href='#oil'><p>Crude Oil Data.</p></a></li>
<li><a href='#plot.mixest'><p>Plots Selected Outcomes from <code>mixest</code> Object.</p></a></li>
<li><a href='#plot.qbnmix'><p>Plots Selected Outcomes from <code>qbnmix</code> Object.</p></a></li>
<li><a href='#plot.tvpreg'><p>Plots Selected Outcomes from <code>tvpreg</code> Object.</p></a></li>
<li><a href='#print.mixest'><p>Prints <code>mixest</code> Object.</p></a></li>
<li><a href='#print.qbnmix'><p>Prints <code>qbnmix</code> Object.</p></a></li>
<li><a href='#print.tvpreg'><p>Prints <code>tvpreg</code> Object.</p></a></li>
<li><a href='#qbnmix'><p>Estimates Normal Mixtures.</p></a></li>
<li><a href='#sqrtmat'><p>Computes the Square Root of a Matrix.</p></a></li>
<li><a href='#tvp.reg'><p>Computes Time-Varying Parameters Regression.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Dynamic Finite Mixtures</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, MASS, Rcpp, stats, utils, zoo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-12</td>
</tr>
<tr>
<td>Author:</td>
<td>Krzysztof Drachal [aut, cre] (Faculty of Economic Sciences, University
    of Warsaw, Poland)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Krzysztof Drachal &lt;kdrachal@wne.uw.edu.pl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Allows to perform the dynamic mixture estimation with state-space components and normal regression components, and clustering with normal mixture. Quasi-Bayesian estimation, as well as, that based on the Kerridge inaccuracy approximation are implemented. Main references: Nagy and Suzdaleva (2013) &lt;<a href="https://doi.org/10.1016%2Fj.apm.2013.05.038">doi:10.1016/j.apm.2013.05.038</a>&gt;; Nagy et al. (2011) &lt;<a href="https://doi.org/10.1002%2Facs.1239">doi:10.1002/acs.1239</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.R-project.org/package=dynmix">https://CRAN.R-project.org/package=dynmix</a></td>
</tr>
<tr>
<td>Note:</td>
<td>Ver. 1.0: The author obtained financial resources as part of
financing the doctoral scholarship from the Polish National
Science Centre (DEC-2018/28/T/HS4/00095). Ver. 2.0: The
research was supported by the program ''Excellence Initiative -
Research University (IDUB)'' through the project
BOB-IDUB-622-89/2021 - Nowe Idee POB III IDUB, 01/IDUB/2019/94
at the University of Warsaw, Poland.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-13 11:43:17 UTC; Krzysiek</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-13 14:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='cauimp'>Computes Causal Inference through Counterfactual Predictions from a Mixture Estimation with State-Space Components.</h2><span id='topic+cauimp'></span>

<h3>Description</h3>

<p>This function estimates causal inference through counterfactual predictions from a mixture estimation with state-space components. Multi-step ahead predictions are generated by the Monte Carlo method. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cauimp(object,x.post,y.post,alpha=0.05,n.sim=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cauimp_+3A_object">object</code></td>
<td>
<p>object of class <code>mixest</code> obtained from <code><a href="#topic+mixest1">mixest1</a></code> for the pre-intervention period</p>
</td></tr>
<tr><td><code id="cauimp_+3A_x.post">x.post</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of independent time-series (predictors) for the post-intervention period, observations inserted rowwise</p>
</td></tr>
<tr><td><code id="cauimp_+3A_y.post">y.post</code></td>
<td>
<p>one column <code><a href="base.html#topic+matrix">matrix</a></code> of the post-intervention period observed dependent time-series, observations inserted rowwise</p>
</td></tr>
<tr><td><code id="cauimp_+3A_alpha">alpha</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1, the desired tail area probability for posterior intervals, by default <code>alpha=0.05</code> is taken</p>
</td></tr>
<tr><td><code id="cauimp_+3A_n.sim">n.sim</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code>, number of the post-intervention period simulations, by default <code>n.sim=100</code> is taken</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$statistics</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of summary statistics for the post-intervention period</p>
</td></tr>
<tr><td><code>$significance</code></td>
<td>
<p><code><a href="base.html#topic+logical">logical</a></code> indicating whether the posterior interval excludes zero</p>
</td></tr>
<tr><td><code>$p</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> of Bayesian one-sided tail area probability that the observed effect was obtained by chance</p>
</td></tr>
<tr><td><code>$y.hat</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of the dependent variable predicted for the post-intervention period</p>
</td></tr>
<tr><td><code>$alpha</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> of the desired tail area probability for posterior intervals, as above</p>
</td></tr>
<tr><td><code>$n.sim</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> of the number of the post-intervention period simulations, as above</p>
</td></tr>
<tr><td><code>$y.sim</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of the simulated dependent variable predictions for the post-intervention period</p>
</td></tr>
</table>


<h3>References</h3>

<p>Brodersen, K. H., Gallusser, F., Koehler, J., Remy, N., Scott, S. L., 2015, Inferring causal impact using Bayesian structural time-series models. <em>Annals of Applied Statistics</em> <b>9</b>, 247&ndash;274.
</p>
<p>Morgan, S. L., Winship, C., 2007, <em>Counterfactuals and Causal Inference</em>, Cambridge University Press. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixest1">mixest1</a></code>, <code><a href="CausalImpact.html#topic+CausalImpact">CausalImpact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil)
m1 &lt;- mixest1(y=oil[1:300,1,drop=FALSE],x=oil[1:300,-1,drop=FALSE],ftype=0,V=1,W=1,kappa=0.97)
x.1 &lt;- oil[301:323,-1,drop=FALSE]
y.1 &lt;- oil[301:323,1,drop=FALSE]
ci &lt;- cauimp(object=m1,x.post=x.1,y.post=y.1,alpha=0.05,n.sim=100)

</code></pre>

<hr>
<h2 id='convts'>Renames Selected Outcomes of <code>mixest</code> and <code>tvpreg</code> Objects.</h2><span id='topic+convts'></span>

<h3>Description</h3>

<p>This function renames rows of selected outcomes stored in <code>mixest</code> and <code>tvpreg</code> objects. It can be useful in generating better looking plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convts(x,ind=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convts_+3A_x">x</code></td>
<td>
<p>object of class <code>mixest</code> or <code>tvpreg</code></p>
</td></tr>
<tr><td><code id="convts_+3A_ind">ind</code></td>
<td>
<p>optional, <code><a href="base.html#topic+character">character</a></code> consisting of names of time points, should have the same length as the forecasted time-series</p>
</td></tr>
<tr><td><code id="convts_+3A_...">...</code></td>
<td>
<p>optional, alternatively, instead of providing <code>ind</code>, arguments of <code><a href="base.html#topic+seq.Date">seq.Date</a></code> can be specified</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of the same class as <code>x</code> but with renamed rownames of selected outcomes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil)
t1 &lt;- tvp.reg(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],lambda=0.99,V=100,W=100)
plot(t1)

t1a &lt;- convts(x=t1,from=as.Date("1990-02-15"),by="month",length.out=nrow(oil[,1,drop=FALSE]))
plot(t1a)

m1 &lt;- mixest1(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],ftype=1,V=100,W=100)
plot(m1)

ind &lt;- as.character(seq(from=as.Date("1990-02-15"),by="month",length.out=nrow(oil[,1,drop=FALSE])))
m1a &lt;- convts(x=m1,ind=ind)
plot(m1a)

</code></pre>

<hr>
<h2 id='ldlt'>Computes LDL' Matrix Decomposition.</h2><span id='topic+ldlt'></span>

<h3>Description</h3>

<p>This function decomposes matrix <code class="reqn">V</code> into <code class="reqn">V=LDL'</code>, where <code class="reqn">L</code> is a lower triangular matrix with unit diagonal and <code class="reqn">D</code> is a diagonal matrix with non-negative terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ldlt(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ldlt_+3A_a">A</code></td>
<td>
<p>symmetric positive-definite <code><a href="base.html#topic+matrix">matrix</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$L</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> <code class="reqn">L</code></p>
</td></tr>
<tr><td><code>$D</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> <code class="reqn">D</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhuang, X., 2020, <em>Lecture Notes in Numerical Analysis (MATH 381)</em>, University of Alberta. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- matrix(c(5,1,1,3),2,2)
V &lt;- ldlt(A)
V$L
V$D
V$L %*% V$D %*% t(V$L)
A
</code></pre>

<hr>
<h2 id='ltdl'>Computes L'DL Matrix Decomposition.</h2><span id='topic+ltdl'></span>

<h3>Description</h3>

<p>This function decomposes matrix <code class="reqn">V</code> into <code class="reqn">V=L'DL</code>, where <code class="reqn">L</code> is a lower triangular matrix with unit diagonal and <code class="reqn">D</code> is a diagonal matrix with non-negative terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ltdl(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ltdl_+3A_a">A</code></td>
<td>
<p>symmetric positive-definite <code><a href="base.html#topic+matrix">matrix</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$L</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> <code class="reqn">L</code></p>
</td></tr>
<tr><td><code>$D</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> <code class="reqn">D</code></p>
</td></tr>
</table>


<h3>References</h3>

<p>de Jonge, P., Tiberius, C., 1996, <em>The LAMBDA Method for Integer Ambiguity Estimation: Implementation Aspects</em>, Universiteitsdrukkerij TU Delft. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- matrix(c(5,1,1,3),2,2)
V &lt;- ltdl(A)
V$L
V$D
t(V$L) %*% V$D %*% V$L
A
</code></pre>

<hr>
<h2 id='mixest1'>Computes Mixture Estimation with State-Space Components.</h2><span id='topic+mixest1'></span>

<h3>Description</h3>

<p>This function estimates recursively mixtures with state-space components with a dynamic model of switching. The components are normal linear models. Suppose there are available <code class="reqn">k</code> potentially important predictors of <code>y</code>, i.e., <code class="reqn">x_1, \dots, x_k</code>. Then up to <code class="reqn">2^{k}</code> linear models including constant term can be created by inclding or not including each of these predictors in the individual model, i.e., component of the mixture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixest1(y,x,mods=NULL,ftype=NULL,lambda=NULL,kappa=NULL,V=NULL,W=NULL,atype=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixest1_+3A_y">y</code></td>
<td>
<p>one column <code><a href="base.html#topic+matrix">matrix</a></code> of forecasted time-series, observations inserted rowwise</p>
</td></tr>
<tr><td><code id="mixest1_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of independent time-series (predictors), observations inserted rowwise</p>
</td></tr>
<tr><td><code id="mixest1_+3A_mods">mods</code></td>
<td>
<p>optional, <code><a href="base.html#topic+matrix">matrix</a></code> indicating which models should be used as components, the first column indicates inclusion of a constant in a component model, by default all possible models with a constant are used, inclusion of a variable is indicated by 1, omitting by 0, component models are indexed by rows, variables (time-series) are indexed by columns</p>
</td></tr>
<tr><td><code id="mixest1_+3A_ftype">ftype</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> indicating type of forecasting, 0 represents forecasting based on coefficients derived from the estimated mixture, 1 represents averaging forecasts from all components by the estimated weights, 2 represents selecting the forecast given by the model with the highest weight, 3 represents selecting the forecast from the so-called median probability model (Barbieri and Berger, 2004), by default <code>ftype=0</code> is taken</p>
</td></tr>
<tr><td><code id="mixest1_+3A_lambda">lambda</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1, a forgetting factor in covariance estimation method described by Raftery et al. (2010), by default the method of Nagy and Suzdaleva (2013) is used</p>
</td></tr>
<tr><td><code id="mixest1_+3A_kappa">kappa</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> between 0 and 1, a parameter for the exponentially weighted moving average estimation of components variances, described for example by Koop and Korobilis (2012), if <code>lambda</code> is specified but <code>kappa</code> is not, then the method of recursive moments described by Raftery et al. (2010) is used, by default the method of Nagy and Suzdaleva (2013) is used</p>
</td></tr>
<tr><td><code id="mixest1_+3A_v">V</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial variance for all components (output equation), by default <code>V=1</code> is taken</p>
</td></tr>
<tr><td><code id="mixest1_+3A_w">W</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial value to be put in the diagonal matrix representing the covariance matrices (state equation), by default <code>W=1</code> is taken</p>
</td></tr>
<tr><td><code id="mixest1_+3A_atype">atype</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> indicating approximation of pdf, 0 represents quasi-Bayesian approach, 1 represents minimization of the Kerridge inaccuracy (where suitiable optimization is done with the Gauss-Newton method, still this increases the computation time greatly), by default <code>atype=0</code> is taken</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>mixest</code>, i.e., <code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$y.hat</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of predictions</p>
</td></tr>
<tr><td><code>$rvi</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of relative variable importances</p>
</td></tr>
<tr><td><code>$coef</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of regression coefficients corresponding to <code>ftype</code> method chosen</p>
</td></tr>
<tr><td><code>$weights</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of estimated weights of component models</p>
</td></tr>
<tr><td><code>$V</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of updated variances from the selected models, consistent with <code>ftype</code> chosen</p>
</td></tr>
<tr><td><code>$R</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of updated diagonal of covariances corresponding to independent variables in regressions, consistent with <code>ftype</code> chosen</p>
</td></tr>
<tr><td><code>$components</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of <code>mods</code></p>
</td></tr>
<tr><td><code>$parameters</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> of parameters used in the model</p>
</td></tr>
<tr><td><code>$data.last</code></td>
<td>
<p><code><a href="base.html#topic+list">list</a></code> of selected parameters obtained in the last iteration, necessary for the internal use by <code><a href="#topic+cauimp">cauimp</a></code></p>
</td></tr>
</table>


<h3>Source</h3>

<p>Nagy, I., Suzdaleva, E., 2013, Mixture estimation with state-space components and Markov model of switching. <em>Applied Mathematical Modelling</em> <b>37</b>, 9970&ndash;9984.
</p>


<h3>References</h3>

<p>Barbieri, M. M., Berger, J. O., 2004, Optimal predictive model selection. <em>The Annals of Statistics</em> <b>32</b>, 870&ndash;897.
</p>
<p>Burnham, K. P., Anderson, D. R., 2002, <em>Model Selection and Multimodel Inference</em>, Springer. 
</p>
<p>Karny, M. (ed.), 2006, <em>Optimized Bayesian Dynamic Advising</em>, Springer. 
</p>
<p>Koop, G., Korobilis, D., 2012, Forecasting inflation using Dynamic Model Averaging. <em>International Economic Review</em> <b>53</b>, 867&ndash;886.
</p>
<p>Nagy, I., Suzdaleva, E., 2017, <em>Algorithms and Programs of Dynamic Mixture Estimation</em>, Springer. 
</p>
<p>Quarteroni, A., Sacco, R., Saleri, F., 2007, <em>Numerical Mathematics</em>, Springer.
</p>
<p>Raftery, A. E., Karny, M., Ettler, P., 2010, Online prediction under model uncertainty via Dynamic Model Averaging: Application to a cold rolling mill. <em>Technometrics</em> <b>52</b>, 52&ndash;66.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixest2">mixest2</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil)
m1 &lt;- mixest1(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],ftype=1,V=100,W=100)

# Models with only one variable
mods &lt;- diag(1,nrow=ncol(oil[,-1,drop=FALSE]),ncol=ncol(oil[,-1,drop=FALSE]))
mods &lt;- cbind(1,mods)
m2 &lt;- mixest1(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],mods=mods,ftype=1,V=100,W=100)

</code></pre>

<hr>
<h2 id='mixest2'>Computes Mixture Estimation with Normal Regression Components.</h2><span id='topic+mixest2'></span>

<h3>Description</h3>

<p>This function estimates recursively mixtures with normal regression components with a dynamic model of switching.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixest2(y,x,mods=NULL,ftype=NULL,V=NULL,W=NULL,atype=NULL,Tvar=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mixest2_+3A_y">y</code></td>
<td>
<p>one column <code><a href="base.html#topic+matrix">matrix</a></code> of forecasted time-series, observations inserted rowwise</p>
</td></tr>
<tr><td><code id="mixest2_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of independent time-series (predictors), observations inserted rowwise</p>
</td></tr>
<tr><td><code id="mixest2_+3A_mods">mods</code></td>
<td>
<p>see <code><a href="#topic+mixest1">mixest1</a></code></p>
</td></tr>
<tr><td><code id="mixest2_+3A_ftype">ftype</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> indicating type of forecasting, 1 represents averaging forecasts from all components by the estimated weights (i.e., forecasting based on coefficients derived from the estimated mixture), 2 represents selecting the forecast given by the model with the highest weight, 3 represents selecting the forecast from the so-called median probability model (Barbieri and Berger, 2004), by default <code>ftype=1</code> is taken</p>
</td></tr>
<tr><td><code id="mixest2_+3A_v">V</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial variance, the same for all components, by default <code>V=1</code> is taken</p>
</td></tr>
<tr><td><code id="mixest2_+3A_w">W</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial value to be put in the diagonal  matrix representing the covariance matrices for regression coefficients, the same for all components, by default <code>W=1</code> is taken</p>
</td></tr>
<tr><td><code id="mixest2_+3A_atype">atype</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> indicating approximation of pdfs, 0 represents quasi-Bayesian approach, 1 represents minimization of the Kerridge inaccuracy, by default <code>atype=0</code> is taken</p>
</td></tr>
<tr><td><code id="mixest2_+3A_tvar">Tvar</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> indicating the number of first observations, when variance and covariance updating will not be performed, i.e., the initial values will be kept fixed, by default <code>Tvar=30</code> is taken</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>mixest</code>, i.e., <code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$y.hat</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of predictions</p>
</td></tr>
<tr><td><code>$rvi</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of relative variable importances</p>
</td></tr>
<tr><td><code>$coef</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of regression coefficients corresponding to <code>ftype</code> method chosen</p>
</td></tr>
<tr><td><code>$weights</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of estimated weights of component models</p>
</td></tr>
<tr><td><code>$V</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of updated variances from the selected models, consistent with <code>ftype</code> chosen</p>
</td></tr>
<tr><td><code>$R</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of updated diagonal of covariances corresponding to independent variables in regressions, consistent with <code>ftype</code> chosen</p>
</td></tr>
<tr><td><code>$components</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of <code>mods</code></p>
</td></tr>
<tr><td><code>$parameters</code></td>
<td>
<p><code><a href="base.html#topic+character">character</a></code> of parameters used in the model</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Nagy, I., Suzdaleva, E., Karny, M., Mlynarova, T., 2011, Bayesian estimation of dynamic finite mixtures. <em>International Journal of Adaptive Control and Signal Processing</em> <b>25</b>, 765&ndash;787.
</p>


<h3>References</h3>

<p>Barbieri, M. M., Berger, J. O., 2004, Optimal predictive model selection. <em>The Annals of Statistics</em> <b>32</b>, 870&ndash;897.
</p>
<p>Burnham, K. P., Anderson, D. R., 2002, <em>Model Selection and Multimodel Inference</em>, Springer. 
</p>
<p>Dedecius, K., 2010, <em>Partial Forgetting in Bayesian Estimation</em>, Czech Technical University in Prague. 
</p>
<p>Karny, M. (ed.), 2006, <em>Optimized Bayesian Dynamic Advising</em>, Springer. 
</p>
<p>Nagy, I., 2015, <em>Mixture Models and Their Applications</em>, Czech Technical University in Prague. 
</p>
<p>Nagy, I., Suzdaleva, E., 2017, <em>Algorithms and Programs of Dynamic Mixture Estimation</em>, Springer. 
</p>
<p>Quarteroni, A., Sacco, R., Saleri, F., 2007, <em>Numerical Mathematics</em>, Springer.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mixest1">mixest1</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil)
m1 &lt;- mixest2(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],ftype=1,V=100,W=100)

</code></pre>

<hr>
<h2 id='oil'>Crude Oil Data.</h2><span id='topic+oil'></span>

<h3>Description</h3>

<p>Selected data from oil market.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(oil)</code></pre>


<h3>Format</h3>

<p><code>oil</code> is <code><a href="base.html#topic+matrix">matrix</a></code> object such that columnwise are
</p>

<ul>
<li><p> WTI &ndash; WTI spot price in USD per barrel 
</p>
</li>
<li><p> MSCI &ndash; MSCI World Index 
</p>
</li>
<li><p> TB3MS &ndash; U.S. 3-month treasury bill secondary market rate 
</p>
</li>
<li><p> TWEXM &ndash; Trade weighted U.S. dollar index (Mar, 1973 = 100) 
</p>
</li>
<li><p> PROD &ndash; U.S. product supplied for crude oil and petroleum products in thousands of barrels 
</p>
</li></ul>



<h3>Details</h3>

<p>The data are in monthly frequency. They cover the period between Feb, 1990 and Dec, 2016. MSCI, TB3MS, TWEXM and PROD are lagged one period back.
</p>


<h3>Source</h3>

<p>The data are provided by Federal Reserve Bank of St. Louis, MSCI and U.S. Energy Information Administration. 
</p>
<p><a href="https://www.eia.gov">https://www.eia.gov</a>
</p>
<p><a href="https://fred.stlouisfed.org">https://fred.stlouisfed.org</a>
</p>
<p><a href="https://www.msci.com/end-of-day-data-search">https://www.msci.com/end-of-day-data-search</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil)
</code></pre>

<hr>
<h2 id='plot.mixest'>Plots Selected Outcomes from <code>mixest</code> Object.</h2><span id='topic+plot.mixest'></span><span id='topic+plot'></span>

<h3>Description</h3>

<p>The function plots selected outcomes from <code>mixest</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixest'
plot(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.mixest_+3A_x">x</code></td>
<td>
<p>an object of <code>mixest</code> class</p>
</td></tr>
<tr><td><code id="plot.mixest_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots a few outcomes from <code>mixest</code> object. First, the estimated regression coefficients are plotted separately for each variable. Credible intervals of 90% are added. Next, if averaging was chosen for forecasting, then relative variable importances are plotted, i.e., sum of weights of models containing the given variable. If selection procedure was chosen for forecasting, it is plotted whether the given variable is included in the selected model at the given time. Finally weights from all component models are presented in one plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convts">convts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil) 
m1 &lt;- mixest1(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],ftype=2,V=100,W=100)
plot(m1)

</code></pre>

<hr>
<h2 id='plot.qbnmix'>Plots Selected Outcomes from <code>qbnmix</code> Object.</h2><span id='topic+plot.qbnmix'></span>

<h3>Description</h3>

<p>The function plots selected outcomes from <code>qbnmix</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qbnmix'
plot(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.qbnmix_+3A_x">x</code></td>
<td>
<p>an object of <code>qbnmix</code> class</p>
</td></tr>
<tr><td><code id="plot.qbnmix_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots a few outcomes from <code>qbnmix</code> object. First, it plots means for each cluster. Then, it plots posterior probabilities for each cluster. Finally, estimates of mixing weights for each cluster.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R &lt;- list(matrix(c(1,0.3,0,
                   0.3,0.3,0,
                   0,0,0.15),3,3),
          matrix(c(1,0,0,
                   0,0.5,0,
                   0,0,0.2),3,3))
data &lt;- rbind(MASS::mvrnorm(n=180,c(5,2,3),R[[1]]),
              MASS::mvrnorm(n=20,c(1,2,3),R[[2]]))
data &lt;- data[sample(nrow(data)),]
                  
mu0 &lt;- list(matrix(c(4.8689,1.9417,3.0175),nrow=1,ncol=3),
            matrix(c(1.0182,1.9903,2.8847),nrow=1,ncol=3))     
est &lt;- qbnmix(y=data,mu0=mu0)
plot(est)
</code></pre>

<hr>
<h2 id='plot.tvpreg'>Plots Selected Outcomes from <code>tvpreg</code> Object.</h2><span id='topic+plot.tvpreg'></span>

<h3>Description</h3>

<p>The function plots selected outcomes from <code>tvpreg</code> object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tvpreg'
plot(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tvpreg_+3A_x">x</code></td>
<td>
<p>an object of <code>tvpreg</code> class</p>
</td></tr>
<tr><td><code id="plot.tvpreg_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the estimated regression coefficients, separately for each variable. 90% credible intervals are added. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convts">convts</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil)
t1&lt;- tvp.reg(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],lambda=0.99,V=100,W=100)
plot(t1)
</code></pre>

<hr>
<h2 id='print.mixest'>Prints <code>mixest</code> Object.</h2><span id='topic+print.mixest'></span><span id='topic+print'></span>

<h3>Description</h3>

<p>The function prints selected outcomes obtained from object <code>mixest</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixest'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mixest_+3A_x">x</code></td>
<td>
<p>an object of <code>mixest</code> class</p>
</td></tr>
<tr><td><code id="print.mixest_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints the general structure of the model, i.e., names of predictors. It also prints the number of observations (length of time-series) and the number of component models used in estimations (mixing). Additionally it prints the model's parameters (i.e., forecasting method, values of the initial parameters, etc.).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(oil) 
m1 &lt;- mixest1(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],ftype=2,V=100,W=100)
print(m1)

</code></pre>

<hr>
<h2 id='print.qbnmix'>Prints <code>qbnmix</code> Object.</h2><span id='topic+print.qbnmix'></span>

<h3>Description</h3>

<p>The function prints selected outcomes obtained from <code><a href="#topic+qbnmix">qbnmix</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qbnmix'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.qbnmix_+3A_x">x</code></td>
<td>
<p>an object of <code>qbnmix</code> class</p>
</td></tr>
<tr><td><code id="print.qbnmix_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints estimated means and covariance matrices from the last step.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R &lt;- list(matrix(c(1,0.3,0,
                   0.3,0.3,0,
                   0,0,0.15),3,3),
          matrix(c(1,0,0,
                   0,0.5,0,
                   0,0,0.2),3,3))
data &lt;- rbind(MASS::mvrnorm(n=180,c(5,2,3),R[[1]]),
              MASS::mvrnorm(n=20,c(1,2,3),R[[2]]))
data &lt;- data[sample(nrow(data)),]
                  
mu0 &lt;- list(matrix(c(4.8689,1.9417,3.0175),nrow=1,ncol=3),
            matrix(c(1.0182,1.9903,2.8847),nrow=1,ncol=3))     
est &lt;- qbnmix(y=data,mu0=mu0)
print(est)
</code></pre>

<hr>
<h2 id='print.tvpreg'>Prints <code>tvpreg</code> Object.</h2><span id='topic+print.tvpreg'></span>

<h3>Description</h3>

<p>The function prints selected outcomes obtained from object <code>tvpreg</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tvpreg'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.tvpreg_+3A_x">x</code></td>
<td>
<p>an object of <code>tvpreg</code> class</p>
</td></tr>
<tr><td><code id="print.tvpreg_+3A_...">...</code></td>
<td>
<p>not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints the general structure of the model, i.e., names of predictors. It also prints the number of observations (length of time-series) and the regression coefficients as estimated in the last period.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil)
t1&lt;- tvp.reg(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],lambda=0.99,V=100,W=100)
print(t1)
</code></pre>

<hr>
<h2 id='qbnmix'>Estimates Normal Mixtures.</h2><span id='topic+qbnmix'></span>

<h3>Description</h3>

<p>This function performs a recursive clustering for normal mixtures. Quasi-Bayesian approximation is performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qbnmix(y,m=2,mu0=NULL,R0=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qbnmix_+3A_y">y</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of observations, rows correspond to observations, columns correspond to tuples</p>
</td></tr>
<tr><td><code id="qbnmix_+3A_m">m</code></td>
<td>
<p><code><a href="base.html#topic+numeric">numeric</a></code> specifying the number of components (clusters), by default <code>m=2</code> is taken</p>
</td></tr>
<tr><td><code id="qbnmix_+3A_mu0">mu0</code></td>
<td>
<p>optional, initial means, should be a <code><a href="base.html#topic+list">list</a></code> of <code>m</code> matrices, each of them having one row and <code>ncol(y)</code> columns, if not specified random values are taken</p>
</td></tr>
<tr><td><code id="qbnmix_+3A_r0">R0</code></td>
<td>
<p>optional, initial covariance matrices, should be a <code><a href="base.html#topic+list">list</a></code> of <code>m</code> matrices, each of them having <code>ncol(y)</code> rows and <code>ncol(y)</code> columns, if not specified identity matrices are taken</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>qbnmix</code>, i.e., <code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$mu</code></td>
<td>
<p><code><a href="base.html#topic+list">list</a></code> of estimated means</p>
</td></tr>
<tr><td><code>$R</code></td>
<td>
<p><code><a href="base.html#topic+list">list</a></code> of estimated covariance matrices (from last step only)</p>
</td></tr>
<tr><td><code>$alpha</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of estimates of mixing weights (components columnwise)</p>
</td></tr>
<tr><td><code>$w</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of posterior probabilities (components columnwise)</p>
</td></tr>
<tr><td><code>$mu0</code></td>
<td>
<p><code><a href="base.html#topic+list">list</a></code> of initial means matrices</p>
</td></tr>
<tr><td><code>$R0</code></td>
<td>
<p><code><a href="base.html#topic+list">list</a></code> of initial covaraince matrices</p>
</td></tr>
</table>


<h3>Source</h3>

<p>Karny, M., Kadlec, J., Sutanto, E.L., 1998, Quasi-Bayes estimation applied to normal mixture,
<em>Preprints of The 3rd European IEEE Workshop on Computer-Intensive Methods in Control and Data Processing</em>, Rojicek, J., Valeckova, M., Karny, M., Warwick K. (eds.), UTIA AV CR, 77&ndash;82.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>R &lt;- list(matrix(c(1,0.3,0,
                   0.3,0.3,0,
                   0,0,0.15),3,3),
          matrix(c(1,0,0,
                   0,0.5,0,
                   0,0,0.2),3,3))
data &lt;- rbind(MASS::mvrnorm(n=180,c(5,2,3),R[[1]]),
              MASS::mvrnorm(n=20,c(1,2,3),R[[2]]))
data &lt;- data[sample(nrow(data)),]
                  
mu0 &lt;- list(matrix(c(4.8689,1.9417,3.0175),nrow=1,ncol=3),
            matrix(c(1.0182,1.9903,2.8847),nrow=1,ncol=3))     
est &lt;- qbnmix(y=data,mu0=mu0)
</code></pre>

<hr>
<h2 id='sqrtmat'>Computes the Square Root of a Matrix.</h2><span id='topic+sqrtmat'></span>

<h3>Description</h3>

<p>This function computes the square root of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sqrtmat(A)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sqrtmat_+3A_a">A</code></td>
<td>
<p>symmetric positive-definite <code><a href="base.html#topic+matrix">matrix</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+matrix">matrix</a></code> <code class="reqn">B</code> such that <code class="reqn">BB'=A</code>
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/Square_root_of_a_matrix">https://en.wikipedia.org/wiki/Square_root_of_a_matrix</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A &lt;- matrix(c(5,1,1,3),2,2)
B &lt;- sqrtmat(A)
B %*% t(B)
A
</code></pre>

<hr>
<h2 id='tvp.reg'>Computes Time-Varying Parameters Regression.</h2><span id='topic+tvp.reg'></span>

<h3>Description</h3>

<p>This function estimates Time-Varying Parameters regression. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvp.reg(y,x,lambda=NULL,kappa=NULL,V=NULL,W=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvp.reg_+3A_y">y</code></td>
<td>
<p>one column <code><a href="base.html#topic+matrix">matrix</a></code> of forecasted time-series, observations inserted rowwise</p>
</td></tr>
<tr><td><code id="tvp.reg_+3A_x">x</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of independent time-series (predictors), observations inserted rowwise</p>
</td></tr>
<tr><td><code id="tvp.reg_+3A_lambda">lambda</code></td>
<td>
<p>optional, see <code><a href="#topic+mixest1">mixest1</a></code></p>
</td></tr>
<tr><td><code id="tvp.reg_+3A_kappa">kappa</code></td>
<td>
<p>optional, see <code><a href="#topic+mixest1">mixest1</a></code></p>
</td></tr>
<tr><td><code id="tvp.reg_+3A_v">V</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial variance, by default <code>V=1</code> is taken</p>
</td></tr>
<tr><td><code id="tvp.reg_+3A_w">W</code></td>
<td>
<p>optional, <code><a href="base.html#topic+numeric">numeric</a></code> initial value to be put on diagonal of covariance matrix, by default <code>W=1</code> is taken</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>lambda</code> is specified, then the method described by Raftery et al. (2010) is used, with possible extentsion to the one described by Koop and Korobilis (2012). Otherwise, the Kalman filter described as by Nagy and Suzdaleva (2013) is used.  
</p>


<h3>Value</h3>

<p>object of class <code>tvpreg</code>, i.e., <code><a href="base.html#topic+list">list</a></code> of 
</p>
<table>
<tr><td><code>$y.hat</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of predictions</p>
</td></tr>
<tr><td><code>$coef</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of regression coefficients</p>
</td></tr>
<tr><td><code>$R</code></td>
<td>
<p><code><a href="base.html#topic+matrix">matrix</a></code> of diagonals of covariances corresponding to independent variables in regressions</p>
</td></tr>
<tr><td><code>$V</code></td>
<td>
<p><code><a href="base.html#topic+vector">vector</a></code> of outcome variances</p>
</td></tr>
</table>


<h3>References</h3>

<p>Koop, G., Korobilis, D., 2012, Forecasting inflation using Dynamic Model Averaging. <em>International Economic Review</em> <b>53</b>, 867&ndash;886.
</p>
<p>Nagy, I., Suzdaleva, E., 2017, <em>Algorithms and Programs of Dynamic Mixture Estimation</em>, Springer. 
</p>
<p>Raftery, A. E., Karny, M., Ettler, P., 2010, Online prediction under model uncertainty via Dynamic Model Averaging: Application to a cold rolling mill. <em>Technometrics</em> <b>52</b>, 52&ndash;66.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oil)
t1 &lt;- tvp.reg(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],lambda=0.99,V=100,W=100)
t2 &lt;- tvp.reg(y=oil[,1,drop=FALSE],x=oil[,-1,drop=FALSE],V=100,W=100)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
