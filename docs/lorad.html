<!DOCTYPE html><html lang="en"><head><title>Help for package lorad</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lorad}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gtrigsamples'><p>Sequence data used in gtrig vignette</p></a></li>
<li><a href='#k80samples'><p>Sequence data used in k80 vignette</p></a></li>
<li><a href='#lorad_calc_log_sum'><p>Calculate a sum on log scale</p></a></li>
<li><a href='#lorad_estimate'><p>Calculates the LoRaD estimate of the marginal likelihood</p></a></li>
<li><a href='#lorad_standardize'><p>Transforms unconstrained parameters to have the same location and scale</p></a></li>
<li><a href='#lorad_standardize_estimation_sample'><p>Transforms training sample using training sample means and standard deviations</p></a></li>
<li><a href='#lorad_summary'><p>Summarize output from <code>lorad_estimate()</code></p></a></li>
<li><a href='#lorad_transform'><p>Log (or log-ratio) transform parameters having constrained support</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Lowest Radial Distance Method of Marginal Likelihood Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates marginal likelihood from a posterior sample using the method described in Wang et al. (2023) &lt;<a href="https://doi.org/10.1093%2Fsysbio%2Fsyad007">doi:10.1093/sysbio/syad007</a>&gt;, which does not require evaluation of any additional points and requires only the log of the unnormalized posterior density for each sampled parameter vector.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0), rstan (&ge; 2.32),
bridgesampling (&ge; 1.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Analisa Milkey &lt;analisa.milkey@uconn.edu&gt;</td>
</tr>
<tr>
<td>Author:</td>
<td>Analisa Milkey <a href="https://orcid.org/0000-0002-1157-4363"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Elena Korte [aut],
  Paul O. Lewis <a href="https://orcid.org/0000-0001-9852-8759"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-15 20:27:47 UTC; analisamilkey</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-17 08:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='gtrigsamples'>Sequence data used in gtrig vignette</h2><span id='topic+gtrigsamples'></span>

<h3>Description</h3>

<p>Sequence data used in gtrig vignette
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtrigsamples
</code></pre>


<h3>Format</h3>



<h4><code>gtrigsamples</code></h4>

<p>A data frame with 10,001 rows and 35 columns:
</p>

<dl>
<dt>Iteration</dt><dd><p>MCMC iteration</p>
</dd>
<dt>Posterior</dt><dd><p>Log of the unnormalized posterior density</p>
</dd>
<dt>Likelihood</dt><dd><p>Log likelihood</p>
</dd>
<dt>Prior</dt><dd><p>Log of the prior density</p>
</dd>
<dt>alpha</dt><dd><p>Shape parameter of the (mean=1) Gamma distribution of among-site rate heterogeneity</p>
</dd>
<dt>edge_length_proportions.1.</dt><dd><p>Proportion of total tree length used by edge 1</p>
</dd>
<dt>edge_length_proportions.2.</dt><dd><p>Proportion of total tree length used by edge 2</p>
</dd>
<dt>edge_length_proportions.3.</dt><dd><p>Proportion of total tree length used by edge 3</p>
</dd>
<dt>edge_length_proportions.4.</dt><dd><p>Proportion of total tree length used by edge 4</p>
</dd>
<dt>edge_length_proportions.5.</dt><dd><p>Proportion of total tree length used by edge 5</p>
</dd>
<dt>edge_length_proportions.6.</dt><dd><p>Proportion of total tree length used by edge 6</p>
</dd>
<dt>edge_length_proportions.7.</dt><dd><p>Proportion of total tree length used by edge 7</p>
</dd>
<dt>edgelens.1.</dt><dd><p>Edge length 1</p>
</dd>
<dt>edgelens.2.</dt><dd><p>Edge length 2</p>
</dd>
<dt>edgelens.3.</dt><dd><p>Edge length 3</p>
</dd>
<dt>edgelens.4.</dt><dd><p>Edge length 4</p>
</dd>
<dt>edgelens.5.</dt><dd><p>Edge length 5</p>
</dd>
<dt>edgelens.6.</dt><dd><p>Edge length 6</p>
</dd>
<dt>edgelens.7.</dt><dd><p>Edge length 7</p>
</dd>
<dt>er.1.</dt><dd><p>Exchangeability parameter for A to C</p>
</dd>
<dt>er.2.</dt><dd><p>Exchangeability parameter for A to G</p>
</dd>
<dt>er.3.</dt><dd><p>Exchangeability parameter for A to T</p>
</dd>
<dt>er.4.</dt><dd><p>Exchangeability parameter for C to G</p>
</dd>
<dt>er.5.</dt><dd><p>Exchangeability parameter for C to T</p>
</dd>
<dt>er.6.</dt><dd><p>Exchangeability parameter for G to T</p>
</dd>
<dt>pi.1.</dt><dd><p>Nucleotide relative frequency for A</p>
</dd>
<dt>pi.2.</dt><dd><p>Nucleotide relative frequency for C</p>
</dd>
<dt>pi.3.</dt><dd><p>Nucleotide relative frequency for G</p>
</dd>
<dt>pi.4.</dt><dd><p>Nucleotide relative frequency for t</p>
</dd>
<dt>pinvar</dt><dd><p>Proportion of invariable sites</p>
</dd>
<dt>site_rates.1.</dt><dd><p>Rate for site category 1</p>
</dd>
<dt>site_rates.2.</dt><dd><p>Rate for site category 1</p>
</dd>
<dt>site_rates.3.</dt><dd><p>Rate for site category 1</p>
</dd>
<dt>site_rates.4.</dt><dd><p>Rate for site category 1</p>
</dd>
<dt>tree_length</dt><dd><p>Tree length (sum of all edge lengths) in substitutions per site</p>
</dd>
</dl>




<h3>Source</h3>

<p>The program RevBayes (version 1.2.1) was used to obtain a sample from the Bayesian posterior distribution for 5 green plant rbcL sequences under a GTR+I+G model.
</p>

<hr>
<h2 id='k80samples'>Sequence data used in k80 vignette</h2><span id='topic+k80samples'></span>

<h3>Description</h3>

<p>Sequence data used in k80 vignette
</p>


<h3>Usage</h3>

<pre><code class='language-R'>k80samples
</code></pre>


<h3>Format</h3>



<h4><code>k80samples</code></h4>

<p>A data frame with 10,000 rows and 4 columns:
</p>

<dl>
<dt>iter</dt><dd><p>Iteration</p>
</dd>
<dt>log.kernel</dt><dd><p>Log unnormalized posterior</p>
</dd>
<dt>edgelen</dt><dd><p>Edge length in substitutions per site</p>
</dd>
<dt>kappa</dt><dd><p>Transition transversion rate ratio</p>
</dd>
</dl>




<h3>Source</h3>

<p>doi: <a href="https://doi.org/10.1093/sysbio/syad007">10.1093/sysbio/syad007</a>
</p>

<hr>
<h2 id='lorad_calc_log_sum'>Calculate a sum on log scale</h2><span id='topic+lorad_calc_log_sum'></span>

<h3>Description</h3>

<p>Calculates the (natural) log of a sum without leaving the log scale by factoring
out the largest element.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lorad_calc_log_sum(logx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_calc_log_sum_+3A_logx">logx</code></td>
<td>
<p>Numeric vector in which elements are on log scale</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log of the sum of the (exponentiated) elements supplied in logx
</p>

<hr>
<h2 id='lorad_estimate'>Calculates the LoRaD estimate of the marginal likelihood</h2><span id='topic+lorad_estimate'></span>

<h3>Description</h3>

<p>Provided with a data frame containing sampled paraneter vectors and a dictionary
relating column names to parameter types, returns a named character vector containing
the following quantities:
</p>

<ul>
<li><p> logML (the estimated log marginal likelihood)
</p>
</li>
<li><p> nsamples (number of samples)
</p>
</li>
<li><p> nparams (length of each parameter vector)
</p>
</li>
<li><p> training_frac (fraction of samples used for training)
</p>
</li>
<li><p> tsamples (number of samples used for training)
</p>
</li>
<li><p> esamples (number of sampled used for etimation)
</p>
</li>
<li><p> coverage (nominal fraction of the estimation sampled used)
</p>
</li>
<li><p> esamplesused (number of estimation samples actually used for estimation)
</p>
</li>
<li><p> realized_coverage (actual fraction of estimation sample used)
</p>
</li>
<li><p> rmax (lowest radial distance: defines boundary of working parameter space)
</p>
</li>
<li><p> log_delta (volume under the unnormalized posterior inside working parameter space)
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>lorad_estimate(params, colspec, training_frac, training_mode, coverage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_estimate_+3A_params">params</code></td>
<td>
<p>Data frame in which rows are sample points and columns are parameters,
except that last column holds the log posterior kernel</p>
</td></tr>
<tr><td><code id="lorad_estimate_+3A_colspec">colspec</code></td>
<td>
<p>Named character vector associating column names in params with
column specifications</p>
</td></tr>
<tr><td><code id="lorad_estimate_+3A_training_frac">training_frac</code></td>
<td>
<p>Number between 0 and 1 specifying the training fraction</p>
</td></tr>
<tr><td><code id="lorad_estimate_+3A_training_mode">training_mode</code></td>
<td>
<p>One of random, left, or right, specifying how training
fraction is chosen</p>
</td></tr>
<tr><td><code id="lorad_estimate_+3A_coverage">coverage</code></td>
<td>
<p>Number between 0 and 1 specifying fraction of training sample
used to compute working parameter space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named character vector of length 11.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>normals &lt;- rnorm(1000000,0,10)
prob_normals &lt;- dnorm(normals,0,10,log=TRUE) 
proportions &lt;- rbeta(1000000,1,2)
prob_proportions &lt;- dbeta(proportions,1,2,log=TRUE)
lengths &lt;- rgamma(1000000, 10, 1)
prob_lengths &lt;- dgamma(lengths,10,1,log=TRUE)
paramsdf &lt;- data.frame(
    normals,prob_normals,
    proportions, prob_proportions,
    lengths, prob_lengths)
columnkey &lt;- c(
    "normals"="unconstrained", 
    "prob_normals"="posterior", 
    "proportions"="proportion", 
    "prob_proportions"="posterior", 
    "lengths"="positive", 
    "prob_lengths"="posterior")
results &lt;- lorad_estimate(paramsdf, columnkey, 0.5, 'random', 0.1)
lorad_summary(results)

</code></pre>

<hr>
<h2 id='lorad_standardize'>Transforms unconstrained parameters to have the same location and scale</h2><span id='topic+lorad_standardize'></span>

<h3>Description</h3>

<p>Standardizes parameters that have already been transformed (if necessary) to have
unconstrained support. Standardization involves subtracting the sample mean
and dividing by the sample standard deviation. Assumes that the log posterior kernel
(i.e. the log of the unnormalized posterior) is the last column in the supplied
data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lorad_standardize(df, coverage)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_standardize_+3A_df">df</code></td>
<td>
<p>Data frame containing a column for each model parameter sampled
and a final column of log posterior kernel values</p>
</td></tr>
<tr><td><code id="lorad_standardize_+3A_coverage">coverage</code></td>
<td>
<p>Fraction of the training sample used to compute working parameter space</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the log-Jacobian of the standardization transformation,
the inverse square root matrix, a vector of column means, and rmax (radial
distance to furthest point in working parameter space)
</p>

<hr>
<h2 id='lorad_standardize_estimation_sample'>Transforms training sample using training sample means and standard deviations</h2><span id='topic+lorad_standardize_estimation_sample'></span>

<h3>Description</h3>

<p>Transforms training sample using training sample means and standard deviations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lorad_standardize_estimation_sample(standardinfo, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_standardize_estimation_sample_+3A_standardinfo">standardinfo</code></td>
<td>
<p>List containing the log Jacobian of the standardization
transformation, the inverse square root matrix, the column means, and
rmax (the radial distance representing the edge of the working parameter space)</p>
</td></tr>
<tr><td><code id="lorad_standardize_estimation_sample_+3A_y">y</code></td>
<td>
<p>Data frame containing a column for each transformed model parameter
in the estimation sample, with last column being the log kernel values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new data frame consisting of the standardized estimation sample with
log kernel in last column
</p>

<hr>
<h2 id='lorad_summary'>Summarize output from <code><a href="#topic+lorad_estimate">lorad_estimate()</a></code></h2><span id='topic+lorad_summary'></span>

<h3>Description</h3>

<p>Summarize output from <code><a href="#topic+lorad_estimate">lorad_estimate()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lorad_summary(results)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_summary_+3A_results">results</code></td>
<td>
<p>Named character vector returned from <code><a href="#topic+lorad_estimate">lorad_estimate()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>String containing a summary of the supplied <code>results</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>normals &lt;- rnorm(1000000,0,10)
prob_normals &lt;- dnorm(normals,0,10,log=TRUE) 
paramsdf &lt;- data.frame(normals,prob_normals)
columnkey &lt;- c("normals"="unconstrained", "prob_normals"="posterior")
results &lt;- lorad_estimate(paramsdf, columnkey, 0.5, 'left', 0.1)
lorad_summary(results)
</code></pre>

<hr>
<h2 id='lorad_transform'>Log (or log-ratio) transform parameters having constrained support</h2><span id='topic+lorad_transform'></span>

<h3>Description</h3>

<p>Log-transforms parameters with support (0,infinity), log-ratio transforms
K-dimensional parameters with support a (K-1)-simplex, logit transforms
parameters with support [0,1], and leaves unchanged parameters with
unconstrained support (-infinity, infinity).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lorad_transform(params, colspec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lorad_transform_+3A_params">params</code></td>
<td>
<p>Data frame containing a column for each model parameter
sampled as well as one or more columns that, when summed, constitute
the log joint posterior kernel</p>
</td></tr>
<tr><td><code id="lorad_transform_+3A_colspec">colspec</code></td>
<td>
<p>Named character vector matching each column name in
params with a column specification</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new data frame comprising transformed parameter values
with a final column holding the log joint posterior kernel
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
