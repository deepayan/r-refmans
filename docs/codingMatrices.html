<!DOCTYPE html><html lang="en"><head><title>Help for package codingMatrices</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {codingMatrices}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Codings'><p>Coding matrix functions for factors in linear model formulae</p></a></li>
<li><a href='#mean_contrasts'><p>Display contrasts</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Alternative Factor Coding Matrices for Linear Model Formulae</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Bill Venables</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bill Venables &lt;Bill.Venables@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of coding functions as alternatives to the standard
    functions in the stats package, which have names starting with 'contr.'.  Their
    main advantage is that they provide a consistent method for defining marginal
    effects in factorial models.  In a simple one-way ANOVA model the
    intercept term is always the simple average of the class means.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, methods, fractional, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, MASS, dplyr, car, ggplot2, xtable</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-01 07:23:22 UTC; bill</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-01 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Codings'>Coding matrix functions for factors in linear model formulae</h2><span id='topic+Codings'></span><span id='topic+code_control'></span><span id='topic+code_control_last'></span><span id='topic+code_diff'></span><span id='topic+code_diff_forward'></span><span id='topic+code_helmert'></span><span id='topic+code_helmert_forward'></span><span id='topic+code_deviation'></span><span id='topic+code_deviation_first'></span><span id='topic+code_poly'></span><span id='topic+contr.diff'></span>

<h3>Description</h3>

<p>These functions provide an alternative to the coding functions supplied
in the <code>stats</code> package, namely <code>contr.treatment</code>, <code>contr.sum</code>,
<code>contr.helmert</code> and <code>contr.poly</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>code_control(
  n,
  contrasts = TRUE,
  sparse = FALSE,
  abbreviate = substring(tolower(Sys.getenv("R_CODING_ABBREVIATE", "yes")[[1]]), 0, 1) ==
    "y"
)

code_control_last(
  n,
  contrasts = TRUE,
  sparse = FALSE,
  abbreviate = substring(tolower(Sys.getenv("R_CODING_ABBREVIATE", "yes")[[1]]), 0, 1) ==
    "y"
)

code_diff(
  n,
  contrasts = TRUE,
  sparse = FALSE,
  abbreviate = substring(tolower(Sys.getenv("R_CODING_ABBREVIATE", "yes")[[1]]), 0, 1) ==
    "y"
)

code_diff_forward(
  n,
  contrasts = TRUE,
  sparse = FALSE,
  abbreviate = substring(tolower(Sys.getenv("R_CODING_ABBREVIATE", "yes")[[1]]), 0, 1) ==
    "y"
)

code_helmert(n, contrasts = TRUE, sparse = FALSE)

code_helmert_forward(n, contrasts = TRUE, sparse = FALSE)

code_deviation(n, contrasts = TRUE, sparse = FALSE)

code_deviation_first(n, contrasts = TRUE, sparse = FALSE)

code_poly(n, contrasts = TRUE, sparse = FALSE)

contr.diff(
  n,
  contrasts = TRUE,
  sparse = FALSE,
  abbreviate = substring(tolower(Sys.getenv("R_CODING_ABBREVIATE", "yes")[[1]]), 0, 1) ==
    "y"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Codings_+3A_n">n</code></td>
<td>
<p>Either a positive integer giving the number of levels or the levels
attribute of a factor, supplying both the number of levels via its length and
labels potentially to be used in the <code>dimnames</code> of the result.</p>
</td></tr>
<tr><td><code id="Codings_+3A_contrasts">contrasts</code></td>
<td>
<p>Logical: Do you want the <code class="reqn">n \times (n-1)</code> coding
matrix (<code>TRUE</code>) or an <code class="reqn">n \times n</code> full-rank matrix, (as is
sometimes needed by the fitting functions) (<code>FALSE</code>)?</p>
</td></tr>
<tr><td><code id="Codings_+3A_sparse">sparse</code></td>
<td>
<p>Logical: Do you want the result to be a sparse matrix
object, as generated the the <code>Matrix</code> package?</p>
</td></tr>
<tr><td><code id="Codings_+3A_abbreviate">abbreviate</code></td>
<td>
<p>Logical: should level names be abbreviated in the
generated contrast labels?  Default: TRUE.  May be set globally by
setting the environment variable <code>R_CODING_ABBREVIATE</code> to either
&quot;yes&quot; or &quot;no&quot;, with obvious meaning.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All functions with names of the form <code>code_xxxx</code> return
coding matrices which, in a simple model, make the intercept term
the simple (&quot;unweighted&quot;) average of the class means.  This can be
important in some non-standard ANOVA tables.  The function
<code>contr.diff</code> is an exception, and is offered as a natural companion
to <code>stats::contr.treatment</code>, with which it is closely aligned.
</p>

<dl>
<dt>code_control</dt><dd><p>Similar to <code><a href="stats.html#topic+contr.treatment">contr.treatment</a></code>, with
contrasts comparing the class means (the &quot;treatments&quot;) with
the first class mean (the &quot;control&quot;).</p>
</dd>
<dt>code_control_last</dt><dd><p>Similar to <code>code_control</code>, but using the final
class mean as the &quot;control&quot;.  Cf. <code><a href="stats.html#topic+contr.SAS">contr.SAS</a></code></p>
</dd>
<dt>code_diff</dt><dd><p>The contrasts are the successive differences of the treatment means,
<code class="reqn">\mu_{i+i} - \mu_i</code>.  This coding function has no counterpart in the <code>stats</code>
package.  It is suggested as an alternative to the default coding,
<code><a href="stats.html#topic+contr.poly">contr.poly</a></code>, for
ordered factors.  It offers a visual check of monotonicity of the class means
with the ordered levels of the factor.  Unlike <code>stats::contr.poly</code>
there is no assumption that the factor levels
are in some sense &quot;equally spaced&quot;.</p>
</dd>
<dt>code_diff_forward</dt><dd><p>Very similar to <code>code_diff</code>, but using forward
differences: <code class="reqn">\mu_i - \mu_{i+1}</code></p>
</dd>
<dt>code_helmert</dt><dd><p>Similar to <code><a href="stats.html#topic+contr.helmert">contr.helmert</a></code>, but with a
small scaling change to make the regression coefficients (i.e. the contrasts)
more easily interpretable.  The contrasts now compare each class mean, starting
from the second, with the average of all class means coming prior to it in the
factor levels order.</p>
</dd>
<dt>code_helmert_forward</dt><dd><p>Similar to <code>code_helmert</code>, but comparing each class
mean, up to the second last, with the average of all class means coming after it in
the factor levels order.</p>
</dd>
<dt>code_deviation</dt><dd><p>Similar to <code><a href="stats.html#topic+contr.sum">contr.sum</a></code>, which is described
as having the &quot;effects&quot; summing to zero.  A more precise description might be to
say that the contrasts are the deviations of each class mean from the average
of them, i.e. <code class="reqn">\mu_i - \bar\mu</code>.  To avoid redundancy, the
last deviation is omitted.</p>
</dd>
<dt>code_deviation_first</dt><dd><p>Very similar to <code>code_deviation</code>, but omitting
the first deviation to avoid redundancy rather than the last.</p>
</dd>
<dt>code_poly</dt><dd><p>Similar in effect to <code><a href="stats.html#topic+contr.poly">contr.poly</a></code> but
for levels fewer than 15 using an unnormalized basis for the orthogonal polynomials
with integer entries.  (Orthogonal polynomials were originally given in this form
as tables.)  The only advantage over <code>stats::contr.poly</code> is one of display.
Use <code>stats::contr.poly</code> in preference other than for teaching purposes.</p>
</dd>
<dt>contr.diff</dt><dd><p>Very similar in effect to <code>code_diff</code>, yielding the same
differences as the contrasts, but like <code>stats::contr.treatment</code> using the
first class mean as the intercept coefficient rather than the simple average of
the class means, as with <code>code_diff</code>.  Some would regard this as making it
unsuitable for use in some non-standard ANOVA tables.</p>
</dd>
</dl>



<h3>Value</h3>

<p>A coding matrix, as requested by fitting functions using linear
model formulae with factor predictors.
</p>


<h3>See Also</h3>

<p>The <code>MASS</code> function <code><a href="MASS.html#topic+contr.sdif">contr.sdif</a></code> which is an early
version of <code>code_deviation</code> (by the same author).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(M &lt;- code_control(5))
mean_contrasts(M)
(M &lt;- stats::contr.treatment(5))
mean_contrasts(M)  ## same contrasts; different averaging vector.
mean_contrasts(stats::contr.helmert(6))  ## Interpretation obscure
mean_contrasts(code_helmert(6))          ## each mean with the average preceding
mean_contrasts(code_helmert_forward(6))  ## each mean with the averave succeeding
</code></pre>

<hr>
<h2 id='mean_contrasts'>Display contrasts</h2><span id='topic+mean_contrasts'></span>

<h3>Description</h3>

<p>A function to display the averaging vector and class mean contrasts
implied by a given coding matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_contrasts(M)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mean_contrasts_+3A_m">M</code></td>
<td>
<p>Any <code class="reqn">n \times (n-1)</code> coding matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The full contrast matrix, <code>solve(cbind(1, M))</code>, suitably
annotated and presented in vulgar fractional form, for clarity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mean_contrasts(code_helmert_forward(5))
mean_contrasts(code_diff_forward(letters[1:7]))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
