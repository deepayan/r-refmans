<!DOCTYPE html><html><head><title>Help for package vein</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vein}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_lkm'><p>Construction function to add unit km</p></a></li>
<li><a href='#add_miles'><p>Construction function to add unit miles</p></a></li>
<li><a href='#add_polid'><p>Add polygon id to lines road network</p></a></li>
<li><a href='#addscale'><p>function to add a scale to a image plot</p></a></li>
<li><a href='#adt'><p>Average daily traffic (ADT) from hourly traffic data.</p></a></li>
<li><a href='#age'><p>Applies a survival rate to numeric new vehicles</p></a></li>
<li><a href='#age_hdv'><p>Returns amount of vehicles at each age</p></a></li>
<li><a href='#age_ldv'><p>Returns amount of vehicles at each age</p></a></li>
<li><a href='#age_moto'><p>Returns amount of vehicles at each age</p></a></li>
<li><a href='#aw'><p>Average Weight for hourly traffic data.</p></a></li>
<li><a href='#celsius'><p>Construction function for Celsius temperature</p></a></li>
<li><a href='#check_nt'><p>Check the max number of threads</p></a></li>
<li><a href='#cold_mileage'><p>Fraction of mileage driven with a cold engine or catalizer below normal temperature</p></a></li>
<li><a href='#colplot'><p>Function to plot columns of data.frames</p></a></li>
<li><a href='#decoder'><p>Description data.frame for MOVES</p></a></li>
<li><a href='#dmonth'><p>Number of days of the month</p></a></li>
<li><a href='#ef_cetesb'><p>Emissions factors for Environment Company of Sao Paulo, Brazil (CETESB)</p></a></li>
<li><a href='#ef_china'><p>Emissions factors from Chinese emissions guidelines</p></a></li>
<li><a href='#ef_china_det'><p>Correction of Chinese emission factors by deterioration</p></a></li>
<li><a href='#ef_china_h'><p>Correction of Chinese factors by altitude</p></a></li>
<li><a href='#ef_china_hu'><p>Correction of Chinese emission factors by humidity</p></a></li>
<li><a href='#ef_china_long'><p>Chinese emission factors by emissions standard</p></a></li>
<li><a href='#ef_china_s'><p>Correction of Chinese emission factors by sulfur</p></a></li>
<li><a href='#ef_china_speed'><p>Correction of Chinese emission factors by speed</p></a></li>
<li><a href='#ef_china_te'><p>Correction of Chinese emission factors by temperature</p></a></li>
<li><a href='#ef_china_th'><p>Correction of Chinese factors by humidity when temperature &gt; 24</p></a></li>
<li><a href='#ef_eea'><p>Emissions factors from European European Environment Agency</p></a></li>
<li><a href='#ef_emfac'><p>Emission Factors from EMFAC emission factors</p></a></li>
<li><a href='#ef_evap'><p>Evaporative emission factor</p></a></li>
<li><a href='#ef_fun'><p>Experimental: Returns a function of Emission Factor by age of use</p></a></li>
<li><a href='#ef_hdv_scaled'><p>Scaling constant with speed emission factors of Heavy Duty Vehicles</p></a></li>
<li><a href='#ef_hdv_speed'><p>Emissions factors for Heavy Duty Vehicles based on average speed</p></a></li>
<li><a href='#ef_im'><p>Emission factors deoending on accumulated mileage</p></a></li>
<li><a href='#ef_ldv_cold'><p>Cold-Start Emissions factors for Light Duty Vehicles</p></a></li>
<li><a href='#ef_ldv_cold_list'><p>List of cold start emission factors of Light Duty Vehicles</p></a></li>
<li><a href='#ef_ldv_scaled'><p>Scaling constant with speed emission factors of Light Duty Vehicles</p></a></li>
<li><a href='#ef_ldv_speed'><p>Emissions factors for Light Duty Vehicles and Motorcycles</p></a></li>
<li><a href='#ef_local'><p>Local Emissions factors</p></a></li>
<li><a href='#ef_nitro'><p>Emissions factors of N2O and NH3</p></a></li>
<li><a href='#ef_wear'><p>Emissions factors from tyre, break and road surface wear</p></a></li>
<li><a href='#ef_whe'><p>Emission factor that incorporates the effect of high emitters</p></a></li>
<li><a href='#emis'><p>Estimation of emissions</p></a></li>
<li><a href='#emis_chem'><p>(in development, needs checks) Aggregate emissions by lumped groups in chemical mechanism</p></a></li>
<li><a href='#emis_chem2'><p>Aggregate emissions by lumped groups in chemical mechanism</p></a></li>
<li><a href='#emis_china'><p>Estimation with Chinese factors</p></a></li>
<li><a href='#emis_cold'><p>Estimation of cold start emissions hourly for the of the week</p></a></li>
<li><a href='#emis_cold_td'><p>Estimation of cold start emissions with top-down approach</p></a></li>
<li><a href='#emis_det'><p>Determine deterioration factors for urban conditions</p></a></li>
<li><a href='#emis_dist'><p>Allocate emissions into spatial objects (street emis to grid)</p></a></li>
<li><a href='#emis_emfac'><p>Emission calculation based on EMFAC emission factors</p></a></li>
<li><a href='#emis_evap'><p>Estimation of evaporative emissions</p></a></li>
<li><a href='#emis_evap2'><p>Estimation of evaporative emissions 2</p></a></li>
<li><a href='#emis_grid'><p>Allocate emissions into a grid returning point emissions or flux</p></a></li>
<li><a href='#emis_hot_td'><p>Estimation of hot exhaust emissions with a top-down approach</p></a></li>
<li><a href='#emis_long'><p>Estimation with long format</p></a></li>
<li><a href='#emis_merge'><p>Merge several emissions files returning data-frames or 'sf' of lines</p></a></li>
<li><a href='#emis_order'><p>Re-order the emission to match specific hours and days</p></a></li>
<li><a href='#emis_paved'><p>Estimation of resuspension emissions from paved roads</p></a></li>
<li><a href='#emis_post'><p>Post emissions</p></a></li>
<li><a href='#emis_to_streets'><p>Emis to streets distribute top-down emissions into streets</p></a></li>
<li><a href='#emis_wear'><p>Emission estimation from tyre, brake and road surface wear</p></a></li>
<li><a href='#EmissionFactors'><p>Construction function for class &quot;EmissionFactors&quot;</p></a></li>
<li><a href='#EmissionFactorsList'><p>Construction function for class &quot;EmissionFactorsList&quot;</p></a></li>
<li><a href='#Emissions'><p>Construction function for class &quot;Emissions&quot;</p></a></li>
<li><a href='#EmissionsArray'><p>Construction function for class &quot;EmissionsArray&quot;</p></a></li>
<li><a href='#fe2015'><p>Emission factors from Environmental Agency of Sao Paulo CETESB</p></a></li>
<li><a href='#fkm'><p>List of functions of mileage in km fro Brazilian fleet</p></a></li>
<li><a href='#fuel_corr'><p>Correction due Fuel effects</p></a></li>
<li><a href='#get_project'><p>Download vein project</p></a></li>
<li><a href='#grid_emis'><p>Allocate emissions gridded emissions into streets (grid to emis street)</p></a></li>
<li><a href='#GriddedEmissionsArray'><p>Construction function for class &quot;GriddedEmissionsArray&quot;</p></a></li>
<li><a href='#invcop'><p>Helper function to copy and zip projects</p></a></li>
<li><a href='#inventory'><p>Inventory function.</p></a></li>
<li><a href='#long_to_wide'><p>Transform data.frame from long to wide format</p></a></li>
<li><a href='#make_grid'><p>Creates rectangular grid for emission allocation</p></a></li>
<li><a href='#moves_ef'><p>MOVES emission factors</p></a></li>
<li><a href='#moves_rpd'><p>MOVES estimation of using rates per distance</p></a></li>
<li><a href='#moves_rpdy'><p>MOVES estimation of using rates per distance by model year</p></a></li>
<li><a href='#moves_rpdy_meta'><p>MOVES estimation of using rates per distance by model year</p></a></li>
<li><a href='#moves_rpdy_sf'><p>MOVES estimation of using rates per distance by model year</p></a></li>
<li><a href='#moves_rpsy_meta'><p>MOVES estimation of using rates per start by model year</p></a></li>
<li><a href='#moves_rpsy_sf'><p>MOVES estimation of using rates per start by model year</p></a></li>
<li><a href='#moves_speed'><p>Return speed bins according to US/EPA MOVES model</p></a></li>
<li><a href='#my_age'><p>Returns amount of vehicles at each age</p></a></li>
<li><a href='#net'><p>Road network of the west part of Sao Paulo city</p></a></li>
<li><a href='#netspeed'><p>Calculate speeds of traffic network</p></a></li>
<li><a href='#pc_cold'><p>Profile of Vehicle start patterns</p></a></li>
<li><a href='#pc_profile'><p>Profile of traffic data 24 hours 7 n days of the week</p></a></li>
<li><a href='#pollutants'><p>Data.frame with pollutants names and molar mass used in VEIN</p></a></li>
<li><a href='#profiles'><p>Profile of traffic data 24 hours 7 n days of the week</p></a></li>
<li><a href='#remove_units'><p>Remove units</p></a></li>
<li><a href='#running_losses-deprecated'><p>Estimation of average daily  hot-soak evaporative emissions</p></a></li>
<li><a href='#speciate'><p>Speciation of emissions</p></a></li>
<li><a href='#Speed'><p>Construction function for class &quot;Speed&quot;</p></a></li>
<li><a href='#split_emis'><p>Split street emissions based on a grid</p></a></li>
<li><a href='#temp_fact'><p>Expansion of hourly traffic data</p></a></li>
<li><a href='#temp_veh'><p>Expanded Vehicles data.frame by hour</p></a></li>
<li><a href='#to_latex'><p>creates a .tex a table from a data.frame</p></a></li>
<li><a href='#Vehicles'><p>Construction function for class &quot;Vehicles&quot;</p></a></li>
<li><a href='#vein_notes'><p>Notes with sysinfo</p></a></li>
<li><a href='#vein-deprecated'><p>DEPRECATED Construction function for class &quot;EmissionsList&quot;</p></a></li>
<li><a href='#vein-package'><p>vein: Vehicular Emissions Inventories</p></a></li>
<li><a href='#vkm'><p>Estimation of VKM</p></a></li>
<li><a href='#wide_to_long'><p>Transform data.frame from wide to long format</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Vehicular Emissions Inventories</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-04-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Elaboration of vehicular emissions inventories,
    consisting in four stages, pre-processing activity data, preparing 
    emissions factors, estimating the emissions and post-processing of emissions 
    in maps and databases. More details in Ibarra-Espinosa et al (2018) &lt;<a href="https://doi.org/10.5194%2Fgmd-11-2209-2018">doi:10.5194/gmd-11-2209-2018</a>&gt;.
    Before using VEIN you need to know the vehicular composition of your study area, in other words,
    the combination of of type of vehicles, size and fuel of the fleet. Then, it is recommended to
    start with the project to download a template to create a structure of directories and scripts.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/atmoschem/vein">https://github.com/atmoschem/vein</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/atmoschem/vein/issues">https://github.com/atmoschem/vein/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sf (&ge; 1.0.1), data.table, units, graphics, stats, dotCall64,
cptcity, grDevices</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-29 18:57:51 UTC; sergio</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergio Ibarra-Espinosa
    <a href="https://orcid.org/0000-0002-3162-1905"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Daniel Schuch <a href="https://orcid.org/0000-0001-5977-4519"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Joao Bazzo <a href="https://orcid.org/0000-0002-7371-1116"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Mario Gavidia-Calderón
    <a href="https://orcid.org/0000-0003-4536-5006"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergio Ibarra-Espinosa &lt;zergioibarra@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-29 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_lkm'>Construction function to add unit km</h2><span id='topic+add_lkm'></span>

<h3>Description</h3>

<p><code>add_lkm</code> just  add unit 'km' to different R objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_lkm(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_lkm_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot;,  &quot;numeric&quot; or &quot;integer&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;data.frame&quot; or &quot;units&quot;
</p>


<h3>See Also</h3>

<p>Other Add distance unitts: 
<code><a href="#topic+add_miles">add_miles</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
a &lt;- add_lkm(rnorm(100)*10)
plot(a)
b &lt;- add_lkm(matrix(rnorm(100)*10, ncol = 10))
print(head(b))

## End(Not run)
</code></pre>

<hr>
<h2 id='add_miles'>Construction function to add unit miles</h2><span id='topic+add_miles'></span>

<h3>Description</h3>

<p><code>add_miles</code> just  add unit 'miles' to different R objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_miles(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_miles_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot;,  &quot;numeric&quot; or &quot;integer&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;data.frame&quot; or &quot;units&quot;
</p>


<h3>See Also</h3>

<p>Other Add distance unitts: 
<code><a href="#topic+add_lkm">add_lkm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
a &lt;- add_miles(rnorm(100)*10)
plot(a)
b &lt;- add_miles(matrix(rnorm(100)*10, ncol = 10))
print(head(b))

## End(Not run)
</code></pre>

<hr>
<h2 id='add_polid'>Add polygon id to lines road network</h2><span id='topic+add_polid'></span>

<h3>Description</h3>

<p>Sometimes you need to add polygon id into your streets road network.
<code><a href="#topic+add_polid">add_polid</a></code> add add_polid id into your road network cropping your
network by.
</p>
<p>For instance, you have open street maps road network the you have the
polygon of your regions. This function adds the id of your polygon
as a new column in the streets network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_polid(polyg, street, by)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_polid_+3A_polyg">polyg</code></td>
<td>
<p>sf object POLYGON or sp</p>
</td></tr>
<tr><td><code id="add_polid_+3A_street">street</code></td>
<td>
<p>streets road network class sf or sp</p>
</td></tr>
<tr><td><code id="add_polid_+3A_by">by</code></td>
<td>
<p>Character indicating the column with the id in polyg</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+emis_to_streets">emis_to_streets</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
nets &lt;- sf::st_as_sf(net)
bb &lt;- sf::st_as_sf(sf::st_as_sfc(sf::st_bbox(nets)))
bb$id &lt;- "a"
a &lt;- add_polid(polyg = bb, street = nets, by = "id")

## End(Not run)
</code></pre>

<hr>
<h2 id='addscale'>function to add a scale to a image plot</h2><span id='topic+addscale'></span>

<h3>Description</h3>

<p>method to plot a scale in image plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addscale(
  z,
  zlim = range(z, na.rm = TRUE),
  col = grDevices::heat.colors(12),
  breaks = pretty(zlim),
  horiz = TRUE,
  ylim = NULL,
  xlim = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addscale_+3A_z">z</code></td>
<td>
<p>matrix or vector</p>
</td></tr>
<tr><td><code id="addscale_+3A_zlim">zlim</code></td>
<td>
<p>z limit</p>
</td></tr>
<tr><td><code id="addscale_+3A_col">col</code></td>
<td>
<p>color</p>
</td></tr>
<tr><td><code id="addscale_+3A_breaks">breaks</code></td>
<td>
<p>interval for the tickmarks</p>
</td></tr>
<tr><td><code id="addscale_+3A_horiz">horiz</code></td>
<td>
<p>TRUE (default) to a horizontal scale</p>
</td></tr>
<tr><td><code id="addscale_+3A_ylim">ylim</code></td>
<td>
<p>y limitS</p>
</td></tr>
<tr><td><code id="addscale_+3A_xlim">xlim</code></td>
<td>
<p>x limit</p>
</td></tr>
<tr><td><code id="addscale_+3A_...">...</code></td>
<td>
<p>other arguments to plot</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
mat &lt;- matrix(100:1,ncol = 10, byrow = F)
cor &lt;- grDevices::heat.colors(100)
image(mat,axe = FALSE, main = "numbers from 1 to 100", col = cor)
axis(2)
addscale(mat, col = cor)

## End(Not run)
</code></pre>

<hr>
<h2 id='adt'>Average daily traffic (ADT) from hourly traffic data.</h2><span id='topic+adt'></span>

<h3>Description</h3>

<p><code><a href="#topic+adt">adt</a></code> calculates ADT based on hourly traffic data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adt(
  pc,
  lcv,
  hgv,
  bus,
  mc,
  p_pc,
  p_lcv,
  p_hgv,
  p_bus,
  p_mc,
  feq_pc = 1,
  feq_lcv = 1.5,
  feq_hgv = 2,
  feq_bus = 2,
  feq_mc = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adt_+3A_pc">pc</code></td>
<td>
<p>numeric vector for passenger cars</p>
</td></tr>
<tr><td><code id="adt_+3A_lcv">lcv</code></td>
<td>
<p>numeric vector for light commercial vehicles</p>
</td></tr>
<tr><td><code id="adt_+3A_hgv">hgv</code></td>
<td>
<p>numeric vector for heavy good vehicles or trucks</p>
</td></tr>
<tr><td><code id="adt_+3A_bus">bus</code></td>
<td>
<p>numeric vector for bus</p>
</td></tr>
<tr><td><code id="adt_+3A_mc">mc</code></td>
<td>
<p>numeric vector for motorcycles</p>
</td></tr>
<tr><td><code id="adt_+3A_p_pc">p_pc</code></td>
<td>
<p>data-frame profile for passenger cars, 24 hours only.</p>
</td></tr>
<tr><td><code id="adt_+3A_p_lcv">p_lcv</code></td>
<td>
<p>data-frame profile for light commercial vehicles, 24 hours only.</p>
</td></tr>
<tr><td><code id="adt_+3A_p_hgv">p_hgv</code></td>
<td>
<p>data-frame profile for heavy good vehicles or trucks, 24 hours only.</p>
</td></tr>
<tr><td><code id="adt_+3A_p_bus">p_bus</code></td>
<td>
<p>data-frame profile for bus, 24 hours only.</p>
</td></tr>
<tr><td><code id="adt_+3A_p_mc">p_mc</code></td>
<td>
<p>data-frame profile for motorcycles, 24 hours only.</p>
</td></tr>
<tr><td><code id="adt_+3A_feq_pc">feq_pc</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="adt_+3A_feq_lcv">feq_lcv</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="adt_+3A_feq_hgv">feq_hgv</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="adt_+3A_feq_bus">feq_bus</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="adt_+3A_feq_mc">feq_mc</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of total volume of traffic per link as ADT
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
p1 &lt;- pc_profile[, 1]
adt1 &lt;- adt(pc = net$ldv*0.75,
            lcv = net$ldv*0.1,
            hgv = net$hdv,
            bus = net$hdv*0.1,
            mc = net$ldv*0.15,
            p_pc = p1,
            p_lcv = p1,
            p_hgv = p1,
            p_bus = p1,
            p_mc = p1)
head(adt1)

## End(Not run)
</code></pre>

<hr>
<h2 id='age'>Applies a survival rate to numeric new vehicles</h2><span id='topic+age'></span>

<h3>Description</h3>

<p><code><a href="#topic+age">age</a></code> returns survived vehicles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age(x, type = "weibull", a = 14.46, b = 4.79, agemax, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_+3A_x">x</code></td>
<td>
<p>Numeric; numerical vector of sales or registrations for each year</p>
</td></tr>
<tr><td><code id="age_+3A_type">type</code></td>
<td>
<p>Character; any of &quot;gompertz&quot;, &quot;double_logistic&quot;, &quot;weibull&quot; and &quot;weibull2&quot;</p>
</td></tr>
<tr><td><code id="age_+3A_a">a</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_+3A_b">b</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_+3A_verbose">verbose</code></td>
<td>
<p>Logical;  message with average age and total numer of vehicles
regions or streets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distrubution of vehicles
</p>


<h3>Note</h3>

<p>The functions age* produce distribution of the circulating fleet by age of use.
The order of using these functions is:
</p>
<p>1. If you know the distribution of the vehicles by age of use , use:  <code><a href="#topic+my_age">my_age</a></code>
2. If you know the sales of vehicles, or the registry of new vehicles,
use <code><a href="#topic+age">age</a></code> to apply a survival function.
3. If you know the theoretical shape of the circulating fleet and you can use
<code><a href="#topic+age_ldv">age_ldv</a></code>, <code><a href="#topic+age_hdv">age_hdv</a></code> or <code><a href="#topic+age_moto">age_moto</a></code>. For instance,
you dont know the sales or registry of vehicles, but somehow you know
the shape of this curve.
4. You can use/merge/transform/dapt any of these functions.
</p>
<p><strong>gompertz: 1 - exp(-exp(a + b*time))</strong>,
defaults PC: b = -0.137, a = 1.798, LCV: b = -0.141, a = 1.618
MCT (2006). de Gases de Efeito Estufa-Emissoes de Gases de
Efeito Estufa por Fontes Moveis, no Setor Energético. Ministerio da Ciencia e Tecnologia.
This curve is also used by Guo and Wang (2012, 2015) in the form:
V*exp(alpha*exp(beta*E)) where
V is the saturation  car ownership level and E GDP per capita
Huo, H., &amp; Wang, M. (2012). Modeling future vehicle sales and stock in China.
Energy Policy, 43, 17–29. doi:10.1016/j.enpol.2011.09.063
Huo, Hong, et al. &quot;Vehicular air pollutant emissions in China: evaluation of past control
policies and future perspectives.&quot; Mitigation and Adaptation Strategies for Global Change 20.5 (2015): 719-733.
</p>
<p><strong>double_logistic: 1/(1 + exp(a*(time + b))) + 1/(1 + exp(a*(time - b)))</strong>,
defaults PC: b = 21, a = 0.19, LCV: b = 15.3, a = 0.17, HGV: b = 17, a = 0.1, BUS: b = 19.1, a = 0.16
MCT (2006). de Gases de Efeito Estufa-Emissoes de Gases de
Efeito Estufa por Fontes Moveis, no Setor Energético. Ministerio da Ciencia e Tecnologia.
</p>
<p><strong>weibull: exp(-(time/a)^b)</strong>,
defaults PC: b = 4.79, a = 14.46, Taxi: b = +inf, a = 5,
Government and business: b = 5.33, a = 13.11
Non-operating vehicles: b = 5.08, a = 11.53
Bus: b = +inf, a = 9, non-transit bus: b = +inf, a = 5.5
Heavy HGV: b = 5.58, a = 12.8, Medium HGV: b = 5.58, a = 10.09, Light HGV: b = 5.58, a = 8.02
Hao, H., Wang, H., Ouyang, M., &amp; Cheng, F. (2011). Vehicle survival patterns in China.
Science China Technological Sciences, 54(3), 625-629.
</p>
<p><strong>weibull2: exp(-((time + b)/a)^b )</strong>,
defaults b = 11, a = 26
Zachariadis, T., Samaras, Z., Zierock, K. H. (1995). Dynamic modeling of vehicle
populations: an engineering approach for emissions calculations. Technological
Forecasting and Social Change, 50(2), 135-149. Cited by Huo and Wang (2012)
</p>


<h3>See Also</h3>

<p>Other age: 
<code><a href="#topic+age_hdv">age_hdv</a>()</code>,
<code><a href="#topic+age_ldv">age_ldv</a>()</code>,
<code><a href="#topic+age_moto">age_moto</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
vehLIA &lt;- rep(1, 25)
PV_Minia &lt;- age(x = vehLIA)
PV_Minib &lt;- age(x = vehLIA, type = "weibull2", b = 11, a = 26)
PV_Minic &lt;- age(x = vehLIA, type = "double_logistic", b = 21, a = 0.19)
PV_Minid &lt;- age(x = vehLIA, type = "gompertz", b = -0.137, a = 1.798)
dff &lt;- data.frame(PV_Minia, PV_Minib, PV_Minic, PV_Minid)
colplot(dff)

## End(Not run)
</code></pre>

<hr>
<h2 id='age_hdv'>Returns amount of vehicles at each age</h2><span id='topic+age_hdv'></span>

<h3>Description</h3>

<p><code><a href="#topic+age_hdv">age_hdv</a></code> returns amount of vehicles at each age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_hdv(
  x,
  name = "age",
  a = 0.2,
  b = 17,
  agemin = 1,
  agemax = 50,
  k = 1,
  bystreet = F,
  net,
  verbose = FALSE,
  namerows,
  time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_hdv_+3A_x">x</code></td>
<td>
<p>Numeric; numerical vector of vehicles with length equal to lines features of road network</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_name">name</code></td>
<td>
<p>Character; of vehicle assigned to columns of dataframe</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_a">a</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_b">b</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_agemin">agemin</code></td>
<td>
<p>Integer; age of newest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_k">k</code></td>
<td>
<p>Numeric; multiplication factor. If its length is &gt; 1, it must match the length of x</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_bystreet">bystreet</code></td>
<td>
<p>Logical; when TRUE it is expecting that 'a' and 'b' are numeric vectors with length equal to x</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_verbose">verbose</code></td>
<td>
<p>Logical;  message with average age and total numer of vehicles</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_namerows">namerows</code></td>
<td>
<p>Any vector to be change row.names. For instance, name of
regions or streets.</p>
</td></tr>
<tr><td><code id="age_hdv_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;1/h&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distrubution of vehicles at each street
</p>


<h3>Note</h3>

<p>The functions age* produce distribution of the circulating fleet by age of use.
The order of using these functions is:
</p>
<p>1. If you know the distribution of the vehicles by age of use , use:  <code><a href="#topic+my_age">my_age</a></code>
2. If you know the sales of vehicles, or the registry of new vehicles,
use <code><a href="#topic+age">age</a></code> to apply a survival function.
3. If you know the theoretical shape of the circulating fleet and you can use
<code><a href="#topic+age_ldv">age_ldv</a></code>, <code><a href="#topic+age_hdv">age_hdv</a></code> or <code><a href="#topic+age_moto">age_moto</a></code>. For instance,
you dont know the sales or registry of vehicles, but somehow you know
the shape of this curve.
4. You can use/merge/transform/adapt any of these functions.
</p>


<h3>See Also</h3>

<p>Other age: 
<code><a href="#topic+age_ldv">age_ldv</a>()</code>,
<code><a href="#topic+age_moto">age_moto</a>()</code>,
<code><a href="#topic+age">age</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
LT_B5 &lt;- age_hdv(x = net$hdv,name = "LT_B5")
plot(LT_B5)
LT_B5 &lt;- age_hdv(x = net$hdv, name = "LT_B5", net = net)
plot(LT_B5)

## End(Not run)
</code></pre>

<hr>
<h2 id='age_ldv'>Returns amount of vehicles at each age</h2><span id='topic+age_ldv'></span>

<h3>Description</h3>

<p><code><a href="#topic+age_ldv">age_ldv</a></code> returns amount of vehicles at each age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_ldv(
  x,
  name = "age",
  a = 1.698,
  b = -0.2,
  agemin = 1,
  agemax = 50,
  k = 1,
  bystreet = F,
  net,
  verbose = FALSE,
  namerows,
  time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_ldv_+3A_x">x</code></td>
<td>
<p>Numeric; numerical vector of vehicles with length equal to lines features of road network</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_name">name</code></td>
<td>
<p>Character; of vehicle assigned to columns of dataframe</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_a">a</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_b">b</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_agemin">agemin</code></td>
<td>
<p>Integer; age of newest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_k">k</code></td>
<td>
<p>Numeric; multiplication factor. If its length is &gt; 1, it must match the length of x</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_bystreet">bystreet</code></td>
<td>
<p>Logical; when TRUE it is expecting that 'a' and 'b' are numeric vectors with length equal to x</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_verbose">verbose</code></td>
<td>
<p>Logical;  message with average age and total numer of vehicles</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_namerows">namerows</code></td>
<td>
<p>Any vector to be change row.names. For instance, name of
regions or streets.</p>
</td></tr>
<tr><td><code id="age_ldv_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;1/h&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distrubution of vehicles
</p>


<h3>Note</h3>

<p>The functions age* produce distribution of the circulating fleet by age of use.
The order of using these functions is:
</p>
<p>1. If you know the distribution of the vehicles by age of use , use:  <code><a href="#topic+my_age">my_age</a></code>
2. If you know the sales of vehicles, or the registry of new vehicles,
use <code><a href="#topic+age">age</a></code> to apply a survival function.
3. If you know the theoretical shape of the circulating fleet and you can use
<code><a href="#topic+age_ldv">age_ldv</a></code>, <code><a href="#topic+age_hdv">age_hdv</a></code> or <code><a href="#topic+age_moto">age_moto</a></code>. For instance,
you dont know the sales or registry of vehicles, but somehow you know
the shape of this curve.
4. You can use/merge/transform/adapt any of these functions.
</p>
<p>It consists in a Gompertz equation with default parameters from
1 national emissions inventory for green housegases in Brazil, MCT 2006
</p>


<h3>See Also</h3>

<p>Other age: 
<code><a href="#topic+age_hdv">age_hdv</a>()</code>,
<code><a href="#topic+age_moto">age_moto</a>()</code>,
<code><a href="#topic+age">age</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
PC_E25_1400 &lt;- age_ldv(x = net$ldv, name = "PC_E25_1400")
plot(PC_E25_1400)
PC_E25_1400 &lt;- age_ldv(x = net$ldv, name = "PC_E25_1400", net = net)
plot(PC_E25_1400)

## End(Not run)
</code></pre>

<hr>
<h2 id='age_moto'>Returns amount of vehicles at each age</h2><span id='topic+age_moto'></span>

<h3>Description</h3>

<p><code><a href="#topic+age_moto">age_moto</a></code> returns amount of vehicles at each age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_moto(
  x,
  name = "age",
  a = 0.2,
  b = 17,
  agemin = 1,
  agemax = 50,
  k = 1,
  bystreet = FALSE,
  net,
  verbose = FALSE,
  namerows,
  time
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_moto_+3A_x">x</code></td>
<td>
<p>Numeric; numerical vector of vehicles with length equal to lines features of road network</p>
</td></tr>
<tr><td><code id="age_moto_+3A_name">name</code></td>
<td>
<p>Character; of vehicle assigned to columns of dataframe</p>
</td></tr>
<tr><td><code id="age_moto_+3A_a">a</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_moto_+3A_b">b</code></td>
<td>
<p>Numeric; parameter of survival equation</p>
</td></tr>
<tr><td><code id="age_moto_+3A_agemin">agemin</code></td>
<td>
<p>Integer; age of newest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_moto_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="age_moto_+3A_k">k</code></td>
<td>
<p>Numeric; multiplication factor. If its length is &gt; 1, it must match the length of x</p>
</td></tr>
<tr><td><code id="age_moto_+3A_bystreet">bystreet</code></td>
<td>
<p>Logical; when TRUE it is expecting that 'a' and 'b' are numeric vectors with length equal to x</p>
</td></tr>
<tr><td><code id="age_moto_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="age_moto_+3A_verbose">verbose</code></td>
<td>
<p>Logical;  message with average age and total numer of vehicles</p>
</td></tr>
<tr><td><code id="age_moto_+3A_namerows">namerows</code></td>
<td>
<p>Any vector to be change row.names. For instance, name of
regions or streets.</p>
</td></tr>
<tr><td><code id="age_moto_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;1/h&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distrubution of vehicles
</p>


<h3>Note</h3>

<p>The functions age* produce distribution of the circulating fleet by age of use.
The order of using these functions is:
</p>
<p>1. If you know the distribution of the vehicles by age of use , use:  <code><a href="#topic+my_age">my_age</a></code>
2. If you know the sales of vehicles, or the registry of new vehicles,
use <code><a href="#topic+age">age</a></code> to apply a survival function.
3. If you know the theoretical shape of the circulating fleet and you can use
<code><a href="#topic+age_ldv">age_ldv</a></code>, <code><a href="#topic+age_hdv">age_hdv</a></code> or <code><a href="#topic+age_moto">age_moto</a></code>. For instance,
you dont know the sales or registry of vehicles, but somehow you know
the shape of this curve.
4. You can use/merge/transform/adapt any of these functions.
</p>


<h3>See Also</h3>

<p>Other age: 
<code><a href="#topic+age_hdv">age_hdv</a>()</code>,
<code><a href="#topic+age_ldv">age_ldv</a>()</code>,
<code><a href="#topic+age">age</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
MOTO_E25_500 &lt;- age_moto(x = net$ldv, name = "M_E25_500", k = 0.4)
plot(MOTO_E25_500)
MOTO_E25_500 &lt;- age_moto(x = net$ldv, name = "M_E25_500", k = 0.4, net = net)
plot(MOTO_E25_500)

## End(Not run)
</code></pre>

<hr>
<h2 id='aw'>Average Weight for hourly traffic data.</h2><span id='topic+aw'></span>

<h3>Description</h3>

<p><code><a href="#topic+aw">aw</a></code> average weight form traffic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aw(
  pc,
  lcv,
  hgv,
  bus,
  mc,
  p_pc,
  p_lcv,
  p_hgv,
  p_bus,
  p_mc,
  w_pc = 1,
  w_lcv = 3.5,
  w_hgv = 20,
  w_bus = 20,
  w_mc = 0.5,
  net
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aw_+3A_pc">pc</code></td>
<td>
<p>numeric vector for passenger cars</p>
</td></tr>
<tr><td><code id="aw_+3A_lcv">lcv</code></td>
<td>
<p>numeric vector for light commercial vehicles</p>
</td></tr>
<tr><td><code id="aw_+3A_hgv">hgv</code></td>
<td>
<p>numeric vector for heavy good vehicles or trucks</p>
</td></tr>
<tr><td><code id="aw_+3A_bus">bus</code></td>
<td>
<p>numeric vector for bus</p>
</td></tr>
<tr><td><code id="aw_+3A_mc">mc</code></td>
<td>
<p>numeric vector for motorcycles</p>
</td></tr>
<tr><td><code id="aw_+3A_p_pc">p_pc</code></td>
<td>
<p>data-frame profile for passenger cars, 24 hours only.</p>
</td></tr>
<tr><td><code id="aw_+3A_p_lcv">p_lcv</code></td>
<td>
<p>data-frame profile for light commercial vehicles, 24 hours only.</p>
</td></tr>
<tr><td><code id="aw_+3A_p_hgv">p_hgv</code></td>
<td>
<p>data-frame profile for heavy good vehicles or trucks, 24 hours only.</p>
</td></tr>
<tr><td><code id="aw_+3A_p_bus">p_bus</code></td>
<td>
<p>data-frame profile for bus, 24 hours only.</p>
</td></tr>
<tr><td><code id="aw_+3A_p_mc">p_mc</code></td>
<td>
<p>data-frame profile for motorcycles, 24 hours only.</p>
</td></tr>
<tr><td><code id="aw_+3A_w_pc">w_pc</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="aw_+3A_w_lcv">w_lcv</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="aw_+3A_w_hgv">w_hgv</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="aw_+3A_w_bus">w_bus</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="aw_+3A_w_mc">w_mc</code></td>
<td>
<p>Numeric, factor equivalence</p>
</td></tr>
<tr><td><code id="aw_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with with average weight
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
p1 &lt;- pc_profile[, 1]
aw1 &lt;- aw(pc = net$ldv*0.75,
            lcv = net$ldv*0.1,
            hgv = net$hdv,
            bus = net$hdv*0.1,
            mc = net$ldv*0.15,
            p_pc = p1,
            p_lcv = p1,
            p_hgv = p1,
            p_bus = p1,
            p_mc = p1)
head(aw1)

## End(Not run)
</code></pre>

<hr>
<h2 id='celsius'>Construction function for Celsius temperature</h2><span id='topic+celsius'></span>

<h3>Description</h3>

<p><code>celsius</code> just  add unit celsius to different R objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>celsius(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="celsius_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot;,  &quot;numeric&quot; or &quot;integer&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;data.frame&quot; or &quot;units&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
a &lt;- celsius(rnorm(100)*10)
plot(a)
b &lt;- celsius(matrix(rnorm(100)*10, ncol = 10))
print(head(b))
}
</code></pre>

<hr>
<h2 id='check_nt'>Check the max number of threads</h2><span id='topic+check_nt'></span>

<h3>Description</h3>

<p><code>get_threads</code> check the number of threads in this machine
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_nt()
</code></pre>


<h3>Value</h3>

<p>Integer with the max number of threads
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
  check_nt()
}
</code></pre>

<hr>
<h2 id='cold_mileage'>Fraction of mileage driven with a cold engine or catalizer below normal temperature</h2><span id='topic+cold_mileage'></span>

<h3>Description</h3>

<p>This function depends length of trip and on ambient temperature.
From the guidelines  EMEP/EEA air pollutant emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cold_mileage(ltrip, ta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cold_mileage_+3A_ltrip">ltrip</code></td>
<td>
<p>Numeric; Length of trip. It must be in 'units' km.</p>
</td></tr>
<tr><td><code id="cold_mileage_+3A_ta">ta</code></td>
<td>
<p>Numeric or data.frame; average monthly temperature Celsius. It if is a
data.frame, it is convenient that each column is each month.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is set so that values varies between 0 and 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lkm &lt;- units::set_units(1:10, km)
ta &lt;- celsius(matrix(0:9, ncol = 12, nrow = 10))
a &lt;- cold_mileage(lkm, ta)
colplot(a)

## End(Not run)
</code></pre>

<hr>
<h2 id='colplot'>Function to plot columns of data.frames</h2><span id='topic+colplot'></span>

<h3>Description</h3>

<p><code><a href="#topic+colplot">colplot</a></code> plots columns of data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colplot(
  df,
  cols = names(df),
  xlab = "",
  ylab = "",
  xlim = c(1, nrow(df)),
  ylim = range(unlist(df[[cols]]), na.rm = TRUE),
  main = NULL,
  theme = "black",
  col = cptcity::cpt(pal = cptcity::find_cpt("pastel")[4], n = length(names(df))),
  type = "b",
  lwd = 2,
  pch = 1:ncol(df),
  familyfont = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colplot_+3A_df">df</code></td>
<td>
<p>data.frame.</p>
</td></tr>
<tr><td><code id="colplot_+3A_cols">cols</code></td>
<td>
<p>Character, columns of data.frame.</p>
</td></tr>
<tr><td><code id="colplot_+3A_xlab">xlab</code></td>
<td>
<p>a label for the x axis, defaults to a description of x.</p>
</td></tr>
<tr><td><code id="colplot_+3A_ylab">ylab</code></td>
<td>
<p>a label for the x axis, defaults to a description of x.</p>
</td></tr>
<tr><td><code id="colplot_+3A_xlim">xlim</code></td>
<td>
<p>x limits</p>
</td></tr>
<tr><td><code id="colplot_+3A_ylim">ylim</code></td>
<td>
<p>y limits</p>
</td></tr>
<tr><td><code id="colplot_+3A_main">main</code></td>
<td>
<p>Character, a main title for the plot, see also <code><a href="graphics.html#topic+title">title</a></code>.</p>
</td></tr>
<tr><td><code id="colplot_+3A_theme">theme</code></td>
<td>
<p>Character; &quot;black&quot;, &quot;dark&quot;, &quot;clean&quot;, &quot;ink&quot;</p>
</td></tr>
<tr><td><code id="colplot_+3A_col">col</code></td>
<td>
<p>The colors for lines and points. Multiple colors can
be specified so that each point can be given its own color. If
there are fewer colors than points they are recycled in the
standard fashion. Default are cptcity colour palette &quot;kst_18_pastels&quot;</p>
</td></tr>
<tr><td><code id="colplot_+3A_type">type</code></td>
<td>
<p>1-character string giving the type of plot desired.
The following values are possible, for details, see plot: &quot;p&quot; for
points, &quot;l&quot; for lines, &quot;b&quot; for both points and lines, &quot;c&quot;
for empty points joined by lines, &quot;o&quot; for overplotted points and
lines, &quot;s&quot; and &quot;S&quot; for stair steps and &quot;h&quot; for histogram-like vertical
lines. Finally, &quot;n&quot; does not produce any points or lines.</p>
</td></tr>
<tr><td><code id="colplot_+3A_lwd">lwd</code></td>
<td>
<p>a vector of line widths, see <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="colplot_+3A_pch">pch</code></td>
<td>
<p>plotting ‘character’, i.e., symbol to use. This can either be a
single character or an integer code for one of a set of graphics symbols.
The full set of S symbols is available with pch = 0:18, see the
examples below. (NB: R uses circles instead of the octagons used in S.).
Value pch = &quot;.&quot; (equivalently pch = 46) is handled specially.
It is a rectangle of side 0.01 inch (scaled by cex). In addition,
if cex = 1 (the default), each side is at least one pixel
(1/72 inch on the pdf, postscript and xfig devices).
For other text symbols, cex = 1 corresponds to the default fontsize
of the device, often specified by an argument pointsize.
For pch in 0:25 the default size is about 75
the character height (see par(&quot;cin&quot;)).</p>
</td></tr>
<tr><td><code id="colplot_+3A_familyfont">familyfont</code></td>
<td>
<p>&quot;Character&quot; to specify font, default is&quot;&quot;, options &quot;serif&quot;,
&quot;sans&quot;, &quot;mono&quot; or more according device</p>
</td></tr>
<tr><td><code id="colplot_+3A_...">...</code></td>
<td>
<p>plot arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a nice plot
</p>


<h3>Note</h3>

<p>This plot shows values &gt; 0 by default. To plot all values, use all_values = TRUE
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">par</a></code>
</p>
<p>Other helpers: 
<code><a href="#topic+dmonth">dmonth</a>()</code>,
<code><a href="#topic+to_latex">to_latex</a>()</code>,
<code><a href="#topic+wide_to_long">wide_to_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
a &lt;- ef_cetesb("CO", c("PC_G", "PC_FE", "PC_FG", "PC_E"), agemax = 20)
colplot(df = a, ylab = "CO [g/km]", theme = "dark", type = "b")
colplot(df = a, ylab = "CO [g/km]", theme = "dark", pch = NULL, type = "b")
colplot(df = a, ylab = "CO [g/km]", theme = "clean", type = "b")
colplot(df = a, ylab = "CO [g/km]", theme = "clean", pch = NULL, type = "b")
#colplot(df = a, cols = "PC_FG", main = "EF", ylab = "CO [g/km]")
#colplot(df = a, ylab = "CO [g/km]", theme = "clean")

## End(Not run)
</code></pre>

<hr>
<h2 id='decoder'>Description data.frame for MOVES</h2><span id='topic+decoder'></span>

<h3>Description</h3>

<p>A data.frame descriptors to use MOVES functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(decoder)
</code></pre>


<h3>Format</h3>

<p>A data frame with 69 rows and 4 columns:
</p>

<dl>
<dt>CategoryField</dt><dd><p>dayID, sourceTypID, roadTypeID, pollutantID and procesID</p>
</dd>
<dt>pollutantID</dt><dd><p>Associated number</p>
</dd>
<dt>Description</dt><dd><p>Associatd description</p>
</dd>
<dt>V4</dt><dd><p>pollutants</p>
</dd>
</dl>



<h3>Source</h3>

<p>US/EPA MOVES
</p>

<hr>
<h2 id='dmonth'>Number of days of the month</h2><span id='topic+dmonth'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> return the number of day sof the month
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmonth(year, month)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmonth_+3A_year">year</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="dmonth_+3A_month">month</code></td>
<td>
<p>Numeric</p>
</td></tr>
</table>


<h3>Value</h3>

<p>days of the month
</p>


<h3>See Also</h3>

<p>Other helpers: 
<code><a href="#topic+colplot">colplot</a>()</code>,
<code><a href="#topic+to_latex">to_latex</a>()</code>,
<code><a href="#topic+wide_to_long">wide_to_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dmonth(2022, 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_cetesb'>Emissions factors for Environment Company of Sao Paulo, Brazil (CETESB)</h2><span id='topic+ef_cetesb'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_cetesb">ef_cetesb</a></code> returns a vector or data.frame of Brazilian emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_cetesb(
  p,
  veh,
  year = 2017,
  agemax = 40,
  scale = "default",
  sppm,
  full = FALSE,
  efinput,
  verbose = FALSE,
  csv
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_cetesb_+3A_p">p</code></td>
<td>
<p>Character;
</p>
<p>Pollutants: &quot;CO&quot;, &quot;HC&quot;, &quot;NMHC&quot;, &quot;CH4&quot;, &quot;NOx&quot;, &quot;CO2&quot;,
&quot;RCHO&quot; (aldehydes + formaldehyde), &quot;ETOH&quot;,
&quot;PM&quot;, &quot;N2O&quot;, &quot;KML&quot;, &quot;FC&quot;, &quot;NO2&quot;, &quot;NO&quot;, &quot;NH3&quot;,
&quot;gD/KWH&quot;, &quot;gCO2/KWH&quot;, &quot;RCHO_0km&quot; (aldehydes + formaldehyde), &quot;PM25RES&quot;, &quot;PM10RES&quot;,
&quot;CO_0km&quot;, &quot;HC_0km&quot;, &quot;NMHC_0km&quot;, &quot;NOx_0km&quot;, &quot;NO2_0km&quot; ,&quot;NO_0km&quot;,
&quot;RCHO_0km&quot; and &quot;ETOH_0km&quot;, &quot;FS&quot; (fuel sales) (g/km). If scale = &quot;tunnel&quot; is
used, there is also &quot;ALD&quot; for aldehydes and &quot;HCHO&quot; for  formaldehydes
Evaporative emissions at average temperature ranges:
&quot;D_20_35&quot;, &quot;S_20_35&quot;, &quot;R_20_35&quot;, &quot;D_10_25&quot;, &quot;S_10_25&quot;, &quot;R_10_25&quot;, &quot;D_0_15&quot;,
&quot;S_0_15&quot; and &quot;R_0_15&quot; where D means diurnal (g/day), S hot/warm soak (g/trip)
and R hot/warm running losses (g/trip). THe deteriorated emission factors are calculated inside this function.</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_veh">veh</code></td>
<td>
<p>Character; Vehicle categories:
&quot;PC_G&quot;, &quot;PC_FG&quot;, &quot;PC_FE&quot;, &quot;PC_E&quot;,
&quot;LCV_G&quot;, &quot;LCV_FG&quot;, &quot;LCV_FE&quot;, &quot;LCV_E&quot;, &quot;LCV_D&quot;,
&quot;TRUCKS_SL&quot;, &quot;TRUCKS_L&quot;, &quot;TRUCKS_M&quot;, &quot;TRUCKS_SH&quot;, &quot;TRUCKS_H&quot;,
&quot;BUS_URBAN&quot;, &quot;BUS_MICRO&quot;, &quot;BUS_COACH&quot;, &quot;BUS_ARTIC&quot;,
&quot;MC_150_G&quot;, &quot;MC_150_500_G&quot;, &quot;MC_500_G&quot;,
&quot;MC_150_FG&quot;, &quot;MC_150_500_FG&quot;, &quot;MC_500_FG&quot;,
&quot;MC_150_FE&quot;, &quot;MC_150_500_FE&quot;, &quot;MC_500_FE&quot;,
&quot;CICLOMOTOR&quot;, &quot;GNV&quot;</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_year">year</code></td>
<td>
<p>Numeric; Filter the emission factor to start from a specific base year.
If project is 'constant' values above 2017 and below 1980 will be repeated</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_scale">scale</code></td>
<td>
<p>Character; values &quot;default&quot;,&quot;tunnel&quot; o  &quot;tunnel2018&quot;. If &quot;tunnel&quot;, emission
factors are scaled to represent EF measurements in tunnels in Sao Paulo</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_sppm">sppm</code></td>
<td>
<p>Numeric, sulfur (sulphur) in ppm in fuel.</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_full">full</code></td>
<td>
<p>Logical; To return a data.frame instead or a vector adding
Age, Year, Brazilian emissions standards and its euro equivalents.</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_efinput">efinput</code></td>
<td>
<p>data.frame with efinput structure of sysdata cetesb. Allow
apply deterioration for future emission factors</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
<tr><td><code id="ef_cetesb_+3A_csv">csv</code></td>
<td>
<p>String with the path to download the ef in a .csv file. For instance,
ef.csv</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of Emission Factor or a data.frame
</p>


<h3>Note</h3>

<p>The new convention for vehicles names are translated from CETESB report:
</p>

<table>
<tr>
 <td style="text-align: left;">
  veh    </td><td style="text-align: left;"> description </td>
</tr>
<tr>
 <td style="text-align: left;">
  PC_G   </td><td style="text-align: left;"> Passenger Car Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  PC_E   </td><td style="text-align: left;"> Passenger Car Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  PC_FG   </td><td style="text-align: left;"> Passenger Car Flex Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  PC_FE  </td><td style="text-align: left;"> Passenger Car Flex Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_G   </td><td style="text-align: left;"> Light Commercial Vehicle Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_E   </td><td style="text-align: left;"> Light Commercial Vehicle Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_FG   </td><td style="text-align: left;"> Light Commercial Vehicle Flex Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_FE  </td><td style="text-align: left;"> Light Commercial Vehicle Flex Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_D  </td><td style="text-align: left;"> Light Commercial Vehicle Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  TRUCKS_SL_D  </td><td style="text-align: left;"> Trucks Semi Light Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  TRUCKS_L_D  </td><td style="text-align: left;"> Trucks Light Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  TRUCKS_M_D  </td><td style="text-align: left;"> Trucks Medium Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  TRUCKS_SH_D  </td><td style="text-align: left;"> Trucks Semi Heavy Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  TRUCKS_H_D  </td><td style="text-align: left;"> Trucks Heavy Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  BUS_URBAN_D  </td><td style="text-align: left;"> Urban Bus Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  BUS_MICRO_D  </td><td style="text-align: left;"> Micro Urban Bus Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  BUS_COACH_D  </td><td style="text-align: left;"> Coach (inter-state) Bus Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  BUS_ARTIC_D  </td><td style="text-align: left;"> Articulated Urban Bus Diesel (5perc bio-diesel) </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_G   </td><td style="text-align: left;"> Motorcycle engine less than 150cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_500_G   </td><td style="text-align: left;"> Motorcycle engine 150-500cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_500_G   </td><td style="text-align: left;"> Motorcycle greater than 500cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_FG   </td><td style="text-align: left;"> Flex Motorcycle engine less than 150cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_500_FG   </td><td style="text-align: left;"> Flex Motorcycle engine 150-500cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_500_FG   </td><td style="text-align: left;"> Flex Motorcycle greater than 500cc Gasohol (Gasoline + 27perc of anhydrous ethanol)  </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_FE   </td><td style="text-align: left;"> Flex Motorcycle engine less than 150cc Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_150_500_FE   </td><td style="text-align: left;"> Flex Motorcycle engine 150-500cc Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  MC_500_FE   </td><td style="text-align: left;"> Flex Motorcycle greater than 500cc Ethanol (hydrous ethanol) </td>
</tr>
<tr>
 <td style="text-align: left;">
  PC_ELEC   </td><td style="text-align: left;"> Passenger Car Electric  </td>
</tr>
<tr>
 <td style="text-align: left;">
  LCV_ELEC   </td><td style="text-align: left;"> Light Commercial Vehicle Electric </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The percentage varies of biofuels varies by law.
</p>
<p>This emission factors are not exactly the same as the report of CETESB.
</p>
<p>1) In this emission factors, there is also NO and NO2 based on split by
published in the EMEP/EEA air pollutant emission inventory guidebook.
</p>
<p>2) Also, the emission factors were extended till 50 years of use, repeating
the oldest value.
</p>
<p>3) CNG emission factors were expanded to other pollutants by comparison
of US.EPA-AP42 emission factor: Section 1.4 Natural Gas Combustion.
</p>
<p>In the previous versions I used the letter 'd' for deteriorated. I removed the
letter 'd' internally to not break older code.
</p>
<p>If by mistake, the user inputs one of veh names from the old convention,
they are internally changed to the new convention:
&quot;SLT&quot;, &quot;LT&quot;, &quot;MT&quot;, &quot;SHT&quot;,&quot;HT&quot;, &quot;UB&quot;, &quot;SUB&quot;, &quot;COACH&quot;, &quot;ARTIC&quot;, &quot;M_G_150&quot;,
&quot;M_G_150_500&quot;, &quot;M_G_500&quot;, &quot;M_FG_150&quot;, &quot;M_FG_150_500&quot;, &quot;M_FG_500&quot;,
&quot;M_FE_150&quot;, &quot;M_FE_150_500&quot;,&quot;M_FE_500&quot;,
PC_ELEC, LCV_ELEC, TRUCKS_ELEC, BUS_ELEC,
MC_150_ELEC, MC_150_500_ELEC, MC_500_ELEC
</p>
<p>If pollutant is &quot;SO2&quot;, it needs sppm. It is designed when veh has length 1, if it has length 2 or more,
it will show a warning
</p>
<p><strong>Emission factor for vehicles older than the reported by CETESB were filled with las highest EF</strong>
</p>

<ul>
<li><p> Range EF from PC and LCV otto: 2018 - 1982. EF for 1981 and older as moving average.
</p>
</li>
<li><p> Range LCV diesel : 2018 - 2006. EF for 2005 and older as moving average.
</p>
</li>
<li><p> Range Trucks and Buse: 2018 - 1998. EF for 1997 and older as moving average.
</p>
</li>
<li><p> Range MC Gasoline: 2018 - 2003.  EF for 2002 and older as moving average.
</p>
</li>
<li><p> Range MC Flex 150-500cc and &gt;500cc: 2018 - 2012.  EF for 2011 and older as moving average.
</p>
</li></ul>

<p>Currently, 2020, there are not any system for recovery of fuel vapors in Brazil. Hence,
the FS takes into account the vapour that comes from the fuel tank inside the car and
released into the atmosphere when injecting new fuel. There are discussions about
increasing implementing stage I and II and/or ORVR these days. The ef FS is calculated
by transforming g FC/km into  (L/KM)*g/L with g/L 1.14 fgor gasoline and 0.37
for ethanol (CETESB, 2016). The density considered is 0.75425 for gasoline and
0.809 for ethanol (t/m^3)
</p>
<p>CETESB emission factors did not cover evaporative emissions from motorcycles,
which occur. Therefore, in the absence of better data, it was assumed the
same ratio from passenger cars.
</p>
<p>Li, Lan, et al. &quot;Exhaust and evaporative emissions from motorcycles fueled
with ethanol gasoline blends.&quot; Science of the Total Environment 502 (2015): 627-631.
</p>
<p>If scale is used with tunnel, the references are:
</p>

<ul>
<li><p> Pérez-Martinez, P. J., Miranda, R. M., Nogueira, T., Guardani, M. L.,
Fornaro, A., Ynoue, R., and Andrade, M. F. (2014). Emission
factors of air pollutants from vehicles measured inside road tunnels in
Sao Paulo: case study comparison. International Journal of
Environmental Science and Technology, 11(8), 2155-2168.
</p>
</li>
<li><p> Nogueira, T., de Souza, K. F., Fornaro, A., de Fatima Andrade, M., and
de Carvalho, L. R. F. (2015). On-road emissions of carbonyls
from vehicles powered by biofuel blends in traffic tunnels in the
Metropolitan Area of Sao Paulo, Brazil. Atmospheric Environment, 108, 88-97.
</p>
</li>
<li><p> Nogueira, T., et al (2021). In preparation (for tunnel 2018)
</p>
</li></ul>

<p>Emission factors for resuspension applies <strong>only</strong> with top-down approach
as a experimental feature. Units are g/(streets*veh)/day. These values were
derived form a bottom-up resuspension emissions from metropolitan area
of Sao Paulo 2018, assuming 50000 streets
</p>
<p>NH3 from EEA Tier 2
</p>


<h3>References</h3>

<p>Emissoes Veiculares no Estado de Sao Paulo 2016. Technical Report.
url: https://cetesb.sp.gov.br/veicular/relatorios-e-publicacoes/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
a &lt;- ef_cetesb(p = "CO", veh = "PC_G")
a &lt;- ef_cetesb(p = "NOx", veh = "TRUCKS_M_D")
a &lt;- ef_cetesb("R_10_25", "PC_G")
a &lt;- ef_cetesb("CO", c("PC_G", "PC_FE"))
ef_cetesb(p = "CO", veh = "PC_G", year = 1970, agemax = 40)
ef_cetesb(p = "CO", veh = "TRUCKS_L_D", year = 2018)
ef_cetesb(p = "CO", veh = "SLT", year = 2018) #  olds names
a &lt;- ef_cetesb(p = "NMHC", veh = c("PC_G", "PC_FG", "PC_FE", "PC_E"), year = 2018, agemax = 20)
colplot(a, main = "NMHC EF", ylab = "[g/km]", xlab = "Years of use")
ef_cetesb(p = "PM25RES", veh = "PC_ELEC", year = 1970, agemax = 40)
ef_cetesb(p = "PM25RES", veh = "BUS_ELEC", year = 1970, agemax = 40)
}
</code></pre>

<hr>
<h2 id='ef_china'>Emissions factors from Chinese emissions guidelines</h2><span id='topic+ef_china'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_china">ef_china</a></code> returns emission factors as vector or data.frames.
The emission factors  comes from the chinese emission guidelines (v3) from the
Chinese Ministry of Ecology and Environment
http://www.mee.gov.cn/gkml/hbb/bgth/201407/W020140708387895271474.pdf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china(
  v = "PV",
  t = "Small",
  f = "G",
  standard,
  p,
  k = 1,
  ta = celsius(15),
  humidity = 0.5,
  altitude = 1000,
  speed = Speed(30),
  baseyear_det = 2016,
  sulphur = 50,
  load_factor = 0.5,
  details = FALSE,
  correction_only = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;, &quot;ALL&quot;</p>
</td></tr>
<tr><td><code id="ef_china_+3A_standard">standard</code></td>
<td>
<p>Character or data.frame; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;. When
it is a data.frame, it each row is a different region and ta, humidity,
altitud, speed, sulphur and load_factor lengths have the same as the number of
rows.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
<tr><td><code id="ef_china_+3A_k">k</code></td>
<td>
<p>Numeric; multiplication factor</p>
</td></tr>
<tr><td><code id="ef_china_+3A_ta">ta</code></td>
<td>
<p>Numeric; temperature of ambient in celcius degrees. When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_humidity">humidity</code></td>
<td>
<p>Numeric; relative humidity. When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_altitude">altitude</code></td>
<td>
<p>Numeric; altitude in meters. When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_speed">speed</code></td>
<td>
<p>Numeric; altitude in km/h When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_baseyear_det">baseyear_det</code></td>
<td>
<p>Integer; any of 2014, 2015, 2016, 2017, 2018</p>
</td></tr>
<tr><td><code id="ef_china_+3A_sulphur">sulphur</code></td>
<td>
<p>Numeric; sulphur in ppm. When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_load_factor">load_factor</code></td>
<td>
<p>Numeric; When standard is a
data.frame, the length must be equal to the number of rows of standard.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_details">details</code></td>
<td>
<p>Logical; When TRUE, it shows a description of the vehicle in chinese
and english. Only when length standard is 1.</p>
</td></tr>
<tr><td><code id="ef_china_+3A_correction_only">correction_only</code></td>
<td>
<p>Logical; When TRUE, return only correction factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An emission factor
</p>


<h3>Note</h3>

<p>Combination of vehicles:
</p>

<table>
<tr>
 <td style="text-align: center;">
  v    </td><td style="text-align: center;"> t      </td><td style="text-align: center;">    f  </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mini   </td><td style="text-align: center;">   G HY   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   D HY D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mini   </td><td style="text-align: center;">   CNG   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   CNG   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mini   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Small   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Medium   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Large   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Taxi   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Motorcycles   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Moped   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mini   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Small   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mediumbus   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Medium   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Largebus   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> 3-Wheel   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Small   </td><td style="text-align: center;">   ALL   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Mediumbus   </td><td style="text-align: center;">   ALL   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Largebus   </td><td style="text-align: center;">   ALL   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Taxi   </td><td style="text-align: center;">   ALL   </td>
</tr>
<tr>
 <td style="text-align: center;">
  PV   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   ALL   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Bus   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Light   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Medium   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Heavy   </td><td style="text-align: center;">   G   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Light   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Medium   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Heavy   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Low Speed   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
  Trucks   </td><td style="text-align: center;"> Mini   </td><td style="text-align: center;">   D   </td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>

<p>standard VI is assumed as V
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> <code><a href="#topic+emis_hot_td">emis_hot_td</a></code>
</p>
<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# when standard is 'character'
# Checking
df_st &lt;- rev(c(as.character(as.roman(5:1)), "PRE"))
ef_china(t = "Mini", f = "G", standard = df_st, p = "CO")
ef_china(t = "Mini", f = "G", standard = df_st, p = "HC")
ef_china(t = "Mini", f = "G", standard = df_st, p = "NOx")
ef_china(t = "Mini", f = "G", standard = df_st, p = "PM2.5")
ef_china(t = "Mini", f = "G", standard = df_st, p = "PM10")

ef_china(t = "Small", f = "G", standard = df_st, p = "CO")
ef_china(t = "Small", f = "G", standard = df_st, p = "HC")
ef_china(t = "Small", f = "G", standard = df_st, p = "NOx")
ef_china(t = "Small", f = "G", standard = df_st, p = "PM2.5")
ef_china(t = "Small", f = "G", standard = df_st, p = "PM10")


ef_china(t = "Mini",
        standard = c("PRE"),
        p = "CO",
        k = 1,
        ta = celsius(15),
        humidity = 0.5,
        altitude = 1000,
        speed = Speed(30),
        baseyear_det = 2014,
        sulphur = 50,
        load_factor = 0.5,
        details = FALSE)
ef_china(standard = c("PRE", "I"), p = "CO", correction_only = TRUE)

# when standard is 'data.frame'
df_st &lt;- matrix(c("V", "IV", "III", "III", "II", "I", "PRE"), nrow = 2, ncol = 7, byrow = TRUE)
df_st &lt;- as.data.frame(df_st)
a &lt;- ef_china(standard = df_st,
              p = "PM10",
              ta = rep(celsius(15), 2),
              altitude = rep(1000, 2),
              speed = rep(Speed(30), 2),
              sulphur = rep(50, 2))
dim(a)
dim(df_st)
ef_china(standard = df_st, p = "PM2.5", ta = rep(celsius(20), 2),
altitude = rep(1501, 2), speed = rep(Speed(29), 2), sulphur = rep(50, 2))
a

# when standard, temperature and humidity are data.frames
# assuming 10 regions
df_st &lt;- matrix(c("V", "IV", "III", "III", "II", "I", "PRE"), nrow = 10, ncol = 7, byrow = TRUE)
df_st &lt;- as.data.frame(df_st)
df_t &lt;- matrix(21:30, nrow = 10, ncol = 12, byrow = TRUE)
df_t &lt;- as.data.frame(df_t)
for(i in 1:12) df_t[, i] &lt;- celsius(df_t[, i])

# assuming 10 regions
df_h &lt;- matrix(seq(0.4, 0.5, 0.05), nrow = 10, ncol = 12, byrow = TRUE)
df_h &lt;- as.data.frame(df_h)
a &lt;- ef_china(standard = df_st, p = "CO", ta = df_t, humidity = df_h,
altitude = rep(1501, 10), speed = rep(Speed(29), 10), sulphur = rep(50, 10))
a
a &lt;- ef_china(standard = df_st, p = "PM2.5", ta = df_t, humidity = df_h,
altitude = rep(1501, 10), speed = rep(Speed(29), 10), sulphur = rep(50, 10))
a
a &lt;- ef_china(standard = df_st, p = "PM10", ta = df_t, humidity = df_h,
altitude = rep(1501, 10), speed = rep(Speed(29), 10), sulphur = rep(50, 10))
a
dim(a)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_china_det'>Correction of Chinese emission factors by deterioration</h2><span id='topic+ef_china_det'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_det(v = "PV", t = "Small", f = "G", standard, yeardet = 2015, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_det_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_det_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_det_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;, &quot;ALL&quot;</p>
</td></tr>
<tr><td><code id="ef_china_det_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="ef_china_det_+3A_yeardet">yeardet</code></td>
<td>
<p>Integer; any of 2014, 2015, 2016, 2017, 2018</p>
</td></tr>
<tr><td><code id="ef_china_det_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_det(standard = "I", p = "CO")
ef_china_det(standard = c("I", "III"),
             p = "CO",
             f = "D")
}
</code></pre>

<hr>
<h2 id='ef_china_h'>Correction of Chinese factors by altitude</h2><span id='topic+ef_china_h'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_h(h, v = "PV", t = "Small", f = "G", p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_h_+3A_h">h</code></td>
<td>
<p>numeric altitude</p>
</td></tr>
<tr><td><code id="ef_china_h_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_h_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_h_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;</p>
</td></tr>
<tr><td><code id="ef_china_h_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_h(h = 1600, p = "CO")
}
</code></pre>

<hr>
<h2 id='ef_china_hu'>Correction of Chinese emission factors by humidity</h2><span id='topic+ef_china_hu'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_hu(hu, v = "PV", t = "Small", f = "G", standard, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_hu_+3A_hu">hu</code></td>
<td>
<p>numeric humidity</p>
</td></tr>
<tr><td><code id="ef_china_hu_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_hu_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_hu_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;</p>
</td></tr>
<tr><td><code id="ef_china_hu_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="ef_china_hu_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_hu(hu = 60, standard = "I", p = "CO")
}
</code></pre>

<hr>
<h2 id='ef_china_long'>Chinese emission factors by emissions standard</h2><span id='topic+ef_china_long'></span>

<h3>Description</h3>

<p>Chinese emission factors in long format
</p>
<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_long(v = "PV", t = "Small", f = "G", standard, p)

ef_china_long(v = "PV", t = "Small", f = "G", standard, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_long_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_long_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_long_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;, &quot;ALL&quot;</p>
</td></tr>
<tr><td><code id="ef_china_long_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="ef_china_long_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>
<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>
<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
## Not run: 
# Do not run

## End(Not run)
}
{
ef_china_long(standard = "I", p = "CO")
}
</code></pre>

<hr>
<h2 id='ef_china_s'>Correction of Chinese emission factors by sulfur</h2><span id='topic+ef_china_s'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_s(s, f = "G", standard, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_s_+3A_s">s</code></td>
<td>
<p>Numeric sulfur content in ppm</p>
</td></tr>
<tr><td><code id="ef_china_s_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;, &quot;ALL&quot;</p>
</td></tr>
<tr><td><code id="ef_china_s_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="ef_china_s_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_s(s = 1000, standard = "I", p = "CO")
}
</code></pre>

<hr>
<h2 id='ef_china_speed'>Correction of Chinese emission factors by speed</h2><span id='topic+ef_china_speed'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_speed(speed, f = "G", standard, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_speed_+3A_speed">speed</code></td>
<td>
<p>numeric speed km/h</p>
</td></tr>
<tr><td><code id="ef_china_speed_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;</p>
</td></tr>
<tr><td><code id="ef_china_speed_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="ef_china_speed_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
head(ef_china_speed(speed = net$ps, standard = "I", p = "CO"))
head(ef_china_speed(speed = net$ps,
                    standard = c("II", "I"),
                    p = "NOx"))
}
</code></pre>

<hr>
<h2 id='ef_china_te'>Correction of Chinese emission factors by temperature</h2><span id='topic+ef_china_te'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_te(te, v = "PV", t = "Small", f = "G", p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_te_+3A_te">te</code></td>
<td>
<p>numeric temperature in celsius</p>
</td></tr>
<tr><td><code id="ef_china_te_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_te_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_te_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;</p>
</td></tr>
<tr><td><code id="ef_china_te_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
head(ef_china_te(te = net$ps,  p = "CO"))
head(ef_china_te(te = net$ps,
                 p = "NOx"))
}
</code></pre>

<hr>
<h2 id='ef_china_th'>Correction of Chinese factors by humidity when temperature &gt; 24</h2><span id='topic+ef_china_th'></span>

<h3>Description</h3>

<p>Correction of Chinese emission
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_china_th(hu, te, v = "PV", t = "Small", f = "G", p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_china_th_+3A_hu">hu</code></td>
<td>
<p>numeric humidity</p>
</td></tr>
<tr><td><code id="ef_china_th_+3A_te">te</code></td>
<td>
<p>numeric temperature in celsius</p>
</td></tr>
<tr><td><code id="ef_china_th_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="ef_china_th_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="ef_china_th_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;</p>
</td></tr>
<tr><td><code id="ef_china_th_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_th(hu = 60, te = 25,  p = "CO")
}
</code></pre>

<hr>
<h2 id='ef_eea'>Emissions factors from European European Environment Agency</h2><span id='topic+ef_eea'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_cetesb">ef_cetesb</a></code> returns a vector or data.frame of Brazilian emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_eea(
  category,
  fuel,
  segment,
  euro,
  tech,
  pol,
  mode,
  slope,
  load,
  speed,
  fcorr = rep(1, 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_eea_+3A_category">category</code></td>
<td>
<p>String: &quot;PC&quot; (Passenger Cars), &quot;LCV&quot; (Light Commercial Vehicles),
&quot;TRUCKS&quot; (Heavy Duty Trucks),
&quot;BUS&quot; (Buses) or &quot;MC&quot; (Motorcycles or L-Category as in EEA 2019).</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_fuel">fuel</code></td>
<td>
<p>String;  &quot;G&quot;, &quot;G HY&quot;, &quot;G PHEV G&quot;,
&quot;G PHEV ELEC&quot;,  &quot;D&quot;, &quot;D PHEV D&quot;,
&quot;D PHEV ELEC&quot;, &quot;LPG BIFUEL LPG&quot;, &quot;LPG BIFUEL G&quot;,
&quot;CNG BIFUEL CNG&quot;, &quot;CNG BIFUEL G&quot;, &quot;D HY D&quot;,
&quot;D HY ELEC&quot;, &quot;CNG&quot;, &quot;BIO D&quot;</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_segment">segment</code></td>
<td>
<p>String for type of vehicle (try different, the function will show values).</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_euro">euro</code></td>
<td>
<p>String; euro standard:
&quot;PRE&quot;, &quot;IMPROVED CONVENTIONAL&quot;, &quot;OPEN LOOP&quot;,
&quot;ECE 15/00-01&quot;, &quot;ECE 15/02&quot;, &quot;ECE 15/03&quot;, &quot;ECE 15/04&quot;.
&quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;,
&quot;VI A/B/C&quot;, &quot;VI D&quot;, &quot;VI D-TEMP&quot;, &quot;VI D/E&quot;,
&quot;EEV&quot;.</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_tech">tech</code></td>
<td>
<p>String; technology:
&quot;DPF&quot;, &quot;DPF With S/W Update&quot;, &quot;DPF+SCR&quot;
&quot;EGR&quot;, &quot;GDI&quot;, &quot;GDI+GPF&quot;, &quot;LNT+DPF&quot;, &quot;PFI&quot;, &quot;SCR&quot;.</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_pol">pol</code></td>
<td>
<p>String; &quot;CO&quot;, &quot;NOx&quot;, &quot;NMHC&quot; (VOC), &quot;PM&quot; (PM Exhaust), &quot;EC&quot;, &quot;CH4&quot;, &quot;NH3&quot;, &quot;N2O&quot;</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_mode">mode</code></td>
<td>
<p>String; &quot;Urban Peak&quot;, &quot;Urban Off Peak&quot;, &quot;Rural&quot;, &quot;Highway&quot;, NA.</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_slope">slope</code></td>
<td>
<p>Numeric; 0.00, -0.06, -0.04, -0.02,  0.02,  0.04,  0.06, or NA</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_load">load</code></td>
<td>
<p>Numeric; 0.0,0.5, 1.0 or NA</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_speed">speed</code></td>
<td>
<p>Numeric; optional numeric in km/h.</p>
</td></tr>
<tr><td><code id="ef_eea_+3A_fcorr">fcorr</code></td>
<td>
<p>Numeric; Correction by fuel properties by euro technology.
See <code><a href="#topic+fuel_corr">fuel_corr</a></code>. The order from first to last is
&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot;, &quot;or other VI. Default is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a function depending of speed or numeric (g/km)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# ef_eea(category = "I DONT KNOW")
ef_eea(category = "PC",
fuel = "G",
segment = "Small",
euro = "I",
tech = NA,
pol = "CO",
mode = NA,
slope = 0,
load = 0)(10)
}
</code></pre>

<hr>
<h2 id='ef_emfac'>Emission Factors from EMFAC emission factors</h2><span id='topic+ef_emfac'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_emfac">ef_emfac</a></code> reads path to ef EMFAC.
You must download the
emission factors from EMFAC website.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_emfac(efpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_emfac_+3A_efpath">efpath</code></td>
<td>
<p>Character path to EMFAC ef (g/miles)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table with emission estimation in long format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# do not run

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_evap'>Evaporative emission factor</h2><span id='topic+ef_evap'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_evap">ef_evap</a></code> is a lookup table with tier 2 evaporative emission factors
from EMEP/EEA emisison guidelines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_evap(
  ef,
  v,
  cc,
  dt,
  ca,
  pollutant = "NMHC",
  k = 1,
  ltrip,
  kmday,
  show = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_evap_+3A_ef">ef</code></td>
<td>
<p>Name of  evaporative emission factor as *eshotc*: mean hot-soak with
carburator, *eswarmc*: mean cold and warm-soak with carburator, eshotfi: mean
hot-soak with fuel injection, *erhotc*: mean hot running losses with
carburator, *erwarmc* mean cold and warm running losses, *erhotfi* mean hot
running losses with fuel injection. Length of ef 1.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_v">v</code></td>
<td>
<p>Type of vehicles, &quot;PC&quot;, &quot;Motorcycle&quot;, &quot;Motorcycle_2S&quot; and &quot;Moped&quot;</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_cc">cc</code></td>
<td>
<p>Size of engine in cc. PC &quot;&lt;=1400&quot;,  &quot;1400_2000&quot; and &quot;&gt;2000&quot;
Motorcycle_2S:  &quot;&lt;=50&quot;. Motorcyces: &quot;&gt;50&quot;, &quot;&lt;=250&quot;, &quot;250_750&quot; and &quot;&gt;750&quot;.
Only engines of &gt;750 has canister.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_dt">dt</code></td>
<td>
<p>Character or Numeric: Average monthly temperature variation: &quot;-5_10&quot;, &quot;0_15&quot;, &quot;10_25&quot;
and &quot;20_35&quot;. This argument can vector with several elements. dt can also be data.frame,
but it is recommended that the number of columns are each month. So that dt
varies in each row and each column.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_ca">ca</code></td>
<td>
<p>Size of canister: &quot;no&quot; meaning no canister, &quot;small&quot;, &quot;medium&quot; and
&quot;large&quot;.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_pollutant">pollutant</code></td>
<td>
<p>Character indicating any of the covered pollutants: &quot;NMHC&quot;,
&quot;ethane&quot;, &quot;propane&quot;, &quot;i-butane&quot;, &quot;n-butane&quot;, &quot;i-pentane&quot;, &quot;n-pentane&quot;,
&quot;2-methylpentane&quot;, &quot;3-methylpentane&quot;, &quot;n-hexane&quot;, &quot;n-heptane&quot;, &quot;propene&quot;,
&quot;trans-2-butene&quot;, &quot;isobutene&quot;, &quot;cis-2-butene&quot;, &quot;1,3-butadiene&quot;,
&quot;trans-2-pentene&quot;, &quot;cis-2-pentene&quot;, &quot;isoprene&quot;, &quot;propyne&quot;, &quot;acetylene&quot;,
&quot;benzene&quot;, &quot;toluene&quot;, &quot;ethylbenzene&quot;, &quot;m-xylene&quot;, &quot;o-xylene&quot;,
&quot;1,2,4-trimethylbenzene&quot; and &quot;1,3,5-trimethylbenzene&quot;. Default is &quot;NMHC&quot;</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_k">k</code></td>
<td>
<p>multiplication factor</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_ltrip">ltrip</code></td>
<td>
<p>Numeric; Length of trip. Experimental feature to conter g/trip
and g/proced (assuming proced similar to trip) in g/km.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_kmday">kmday</code></td>
<td>
<p>Numeric; average daily mileage. Experimental option
to convert g/day in g/km.
it is an information more solid than to know the average number of trips per day.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_show">show</code></td>
<td>
<p>when TRUE shows row of table with respective emission factor.</p>
</td></tr>
<tr><td><code id="ef_evap_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission factors in g/trip or g/proced. The object has class (g)
but it order to know it is g/trip or g/proceed the argument show must by T
</p>


<h3>Note</h3>

<p>Diurnal loses occur with daily temperature variations. Running loses
occur during vehicles use. Hot soak emission occur following vehicles use.
</p>


<h3>References</h3>

<p>Mellios G and Ntziachristos 2016. Gasoline evaporation. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
a &lt;- ef_evap(ef = "eshotc", v = "PC", cc = "&lt;=1400", dt = "0_15", ca = "no",
pollutant = "cis-2-pentene")
a &lt;- ef_evap(ef = "ed", v = "PC", cc = "&lt;=1400", dt = "0_15", ca = "no",
show = TRUE)
a &lt;- ef_evap(ef = c("erhotc", "erhotc"), v = "PC", cc = "&lt;=1400",
dt = "0_15", ca = "no",
show = TRUE)
a &lt;- ef_evap(ef = c("erhotc", "erhotc"), v = "PC", cc = "&lt;=1400",
 dt = "0_15", ca = "no",
show = FALSE)
a &lt;- ef_evap(ef = "eshotc", v = "PC", cc = "&lt;=1400", dt = "0_15", ca = "no",
show = TRUE)
ef_evap(ef = "erhotc", v = "PC", cc = "&lt;=1400", dt = "0_15", ca = "no",
show = TRUE)
temps &lt;- 10:20
a &lt;- ef_evap(ef = "erhotc", v = "PC", cc = "&lt;=1400", dt = temps, ca = "no",
show = TRUE)
dt &lt;- matrix(rep(1:24,5), ncol = 12) # 12 months
dt &lt;- celsius(dt)
a &lt;- ef_evap(ef ="erhotc", v = "PC", cc = "&lt;=1400",
dt = dt, ca = "no")
lkm &lt;- units::set_units(10, km)
a &lt;- ef_evap(ef ="erhotc", v = "PC", cc = "&lt;=1400", ltrip = lkm,
dt = dt, ca = "no")

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_fun'>Experimental: Returns a function of Emission Factor by age of use</h2><span id='topic+ef_fun'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_fun">ef_fun</a></code> returns amount of vehicles at each age
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_fun(
  ef,
  type = "logistic",
  x = 1:length(ef),
  x0 = mean(ef),
  k = 1/4,
  L = max(ef)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_fun_+3A_ef">ef</code></td>
<td>
<p>Numeric; numeric vector of emission factors.</p>
</td></tr>
<tr><td><code id="ef_fun_+3A_type">type</code></td>
<td>
<p>Character; &quot;logistic&quot;  by default so far.</p>
</td></tr>
<tr><td><code id="ef_fun_+3A_x">x</code></td>
<td>
<p>Numeric; vector for ages of use.</p>
</td></tr>
<tr><td><code id="ef_fun_+3A_x0">x0</code></td>
<td>
<p>Numeric;  the x-value of the sigmoid's midpoint,</p>
</td></tr>
<tr><td><code id="ef_fun_+3A_k">k</code></td>
<td>
<p>Numeric; the steepness of the curve.</p>
</td></tr>
<tr><td><code id="ef_fun_+3A_l">L</code></td>
<td>
<p>Integer; the curve's maximum value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distrubution of vehicles at each street.
</p>


<h3>References</h3>

<p>https://en.wikipedia.org/wiki/Logistic_function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(fe2015)
CO &lt;- ef_cetesb(p = "CO", veh = "PC_G")
ef_logit &lt;- ef_fun(ef = CO, x0 = 27, k = 0.4, L = 33)
df &lt;- data.frame(CO, ef_logit)
colplot(df)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_hdv_scaled'>Scaling constant with speed emission factors of Heavy Duty Vehicles</h2><span id='topic+ef_hdv_scaled'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_hdv_scaled">ef_hdv_scaled</a></code> creates a list of scaled functions of emission factors. A scaled
emission factor which at a speed of the dricing cycle (SDC) gives a desired value.
This function needs a dataframe with local emission factors with a columns with
the name &quot;Euro_HDV&quot; indicating the Euro equivalence standard, assuming that there are
available local emission factors for several consecutive years.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_hdv_scaled(df, dfcol, SDC = 34.12, v, t, g, eu, gr = 0, l = 0.5, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_hdv_scaled_+3A_df">df</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_dfcol">dfcol</code></td>
<td>
<p>Column of the dataframe with the local emission factors eg df$dfcol</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_sdc">SDC</code></td>
<td>
<p>Speed of the driving cycle</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_v">v</code></td>
<td>
<p>Category vehicle: &quot;Coach&quot;, &quot;Trucks&quot; or &quot;Ubus&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_t">t</code></td>
<td>
<p>Sub-category of of vehicle: &quot;3Axes&quot;, &quot;Artic&quot;, &quot;Midi&quot;, &quot;RT, &quot;Std&quot; and &quot;TT&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_g">g</code></td>
<td>
<p>Gross weight of each category: &quot;&lt;=18&quot;, &quot;&gt;18&quot;, &quot;&lt;=15&quot;, &quot;&gt;15 &amp; &lt;=18&quot;, &quot;&lt;=7.5&quot;,
&quot;&gt;7.5 &amp; &lt;=12&quot;, &quot;&gt;12 &amp; &lt;=14&quot;, &quot;&gt;14 &amp; &lt;=20&quot;, &quot;&gt;20 &amp; &lt;=26&quot;, &quot;&gt;26 &amp; &lt;=28&quot;, &quot;&gt;28 &amp; &lt;=32&quot;,
&quot;&gt;32&quot;, &quot;&gt;20 &amp; &lt;=28&quot;, &quot;&gt;28 &amp; &lt;=34&quot;, &quot;&gt;34 &amp; &lt;=40&quot;, &quot;&gt;40 &amp; &lt;=50&quot; or &quot;&gt;50 &amp; &lt;=60&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_eu">eu</code></td>
<td>
<p>Euro emission standard: &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot; and &quot;V&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_gr">gr</code></td>
<td>
<p>Gradient or slope of road: -0.06, -0.04, -0.02, 0.00, 0.02. 0.04 or 0.06</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_l">l</code></td>
<td>
<p>Load of the vehicle: 0.0, 0.5 or 1.0</p>
</td></tr>
<tr><td><code id="ef_hdv_scaled_+3A_p">p</code></td>
<td>
<p>Pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot; or &quot;HC&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of scaled emission factors g/km
</p>


<h3>Note</h3>

<p>The length of the list should be equal to the name of the age categories of
a specific type of vehicle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# Do not run
CO &lt;- ef_cetesb(p = "CO", veh = "TRUCKS_SL_D", full = TRUE)
lef &lt;- ef_hdv_scaled(dfcol = CO$CO,
                     v = "Trucks",
                     t = "RT",
                     g = "&lt;=7.5",
                     eu = CO$Euro_EqHDV,
                     gr = 0,
                     l = 0.5,
                     p = "CO")
length(lef)
ages &lt;- c(1, 10, 20, 30, 40)
EmissionFactors(do.call("cbind",
   lapply(ages, function(i) {
       data.frame(i = lef[[i]](1:100))
}))) -&gt; df
names(df) &lt;- ages
colplot(df)
}
</code></pre>

<hr>
<h2 id='ef_hdv_speed'>Emissions factors for Heavy Duty Vehicles based on average speed</h2><span id='topic+ef_hdv_speed'></span>

<h3>Description</h3>

<p>This function returns speed dependent emission factors. The emission factors
comes from the guidelines  EMEP/EEA air pollutant emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_hdv_speed(
  v,
  t,
  g,
  eu,
  x,
  gr = 0,
  l = 0.5,
  p,
  k = 1,
  show.equation = FALSE,
  speed,
  fcorr = rep(1, 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_hdv_speed_+3A_v">v</code></td>
<td>
<p>Category vehicle: &quot;Coach&quot;, &quot;Trucks&quot; or &quot;Ubus&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_t">t</code></td>
<td>
<p>Sub-category of of vehicle: &quot;3Axes&quot;, &quot;Artic&quot;, &quot;Midi&quot;, &quot;RT, &quot;Std&quot; and &quot;TT&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_g">g</code></td>
<td>
<p>Gross weight of each category: &quot;&lt;=18&quot;, &quot;&gt;18&quot;, &quot;&lt;=15&quot;, &quot;&gt;15 &amp; &lt;=18&quot;, &quot;&lt;=7.5&quot;,
&quot;&gt;7.5 &amp; &lt;=12&quot;, &quot;&gt;12 &amp; &lt;=14&quot;, &quot;&gt;14 &amp; &lt;=20&quot;, &quot;&gt;20 &amp; &lt;=26&quot;, &quot;&gt;26 &amp; &lt;=28&quot;, &quot;&gt;28 &amp; &lt;=32&quot;,
&quot;&gt;32&quot;, &quot;&gt;20 &amp; &lt;=28&quot;, &quot;&gt;28 &amp; &lt;=34&quot;, &quot;&gt;34 &amp; &lt;=40&quot;, &quot;&gt;40 &amp; &lt;=50&quot; or &quot;&gt;50 &amp; &lt;=60&quot;</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_eu">eu</code></td>
<td>
<p>Euro emission standard: &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;. Also &quot;II+CRDPF&quot;,
&quot;III+CRDPF&quot;, &quot;IV+CRDPF&quot;, &quot;II+SCR&quot;, &quot;III+SCR&quot; and &quot;V+SCR&quot; for pollutants
Number of particles and Active Surface.</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_x">x</code></td>
<td>
<p>Numeric; if pollutant is &quot;SO2&quot;, it is sulfur in fuel in ppm, if is
&quot;Pb&quot;, Lead in fuel in ppm.</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_gr">gr</code></td>
<td>
<p>Gradient or slope of road: -0.06, -0.04, -0.02, 0.00, 0.02. 0.04 or 0.06</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_l">l</code></td>
<td>
<p>Load of the vehicle: 0.0, 0.5 or 1.0</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot;, &quot;NO&quot;, &quot;NO2&quot;, &quot;HC&quot;, &quot;PM&quot;, &quot;NMHC&quot;, &quot;CH4&quot;,
&quot;CO2&quot;,  &quot;SO2&quot; or &quot;Pb&quot;. Only when p is &quot;SO2&quot; pr &quot;Pb&quot; x is needed. See notes.</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_k">k</code></td>
<td>
<p>Multiplication factor</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_show.equation">show.equation</code></td>
<td>
<p>Option to see or not the equation parameters</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_speed">speed</code></td>
<td>
<p>Numeric; Speed to return Number of emission factor and not a function.
It needs units in km/h</p>
</td></tr>
<tr><td><code id="ef_hdv_speed_+3A_fcorr">fcorr</code></td>
<td>
<p>Numeric; Correction by fuel properties by euro technology.
See <code><a href="#topic+fuel_corr">fuel_corr</a></code>. The order from first to last is
&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, VI, &quot;VIc&quot;. Default is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an emission factor function which depends of the average speed V  g/km
</p>


<h3>Note</h3>

<p><strong>Pollutants (g/km)</strong>: &quot;CO&quot;, &quot;NOx&quot;, &quot;HC&quot;, &quot;PM&quot;, &quot;CH4&quot;, &quot;NMHC&quot;, &quot;CO2&quot;, &quot;SO2&quot;,
&quot;Pb&quot;.
</p>
<p><strong>Black Carbon and Organic Matter (g/km)</strong>: &quot;BC&quot;, &quot;OM&quot;
</p>
<p><strong>PAH and POP (g/km)</strong>:  See  <code><a href="#topic+speciate">speciate</a></code>
<strong>Dioxins and furans (g equivalent toxicity / km)</strong>: See  <code><a href="#topic+speciate">speciate</a></code>
</p>
<p><strong>Metals (g/km)</strong>: See  <code><a href="#topic+speciate">speciate</a></code>
</p>
<p><em>Active Surface (cm2/km)</em> See  <code><a href="#topic+speciate">speciate</a></code>
</p>
<p><em>Total Number of particles (N/km)</em>: See  <code><a href="#topic+speciate">speciate</a></code>
</p>
<p>The available standards for Active Surface or number of particles are:
Euro II and III
Euro II and III + CRDPF
Euro II and III + SCR
Euro IV + CRDPF
Euro V + SCR
</p>
<p>The categories Pre Euro and Euro I were assigned with the factors of Euro II and Euro III
The categories euro IV and euro V were assigned with euro III + SCR
</p>
<p>Fuel consumption for heavy VI comes from V
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fuel_corr">fuel_corr</a></code> <code><a href="#topic+emis">emis</a></code> <code><a href="#topic+ef_ldv_cold">ef_ldv_cold</a></code>  <code><a href="#topic+speciate">speciate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Quick view
pol &lt;- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2")
f &lt;- sapply(1:length(pol), function(i){
print(pol[i])
ef_hdv_speed(v = "Trucks",t = "RT", g = "&lt;=7.5", e = "II", gr = 0,
l = 0.5, p = pol[i], x = 10)(30)
})
f

V &lt;- 0:130
ef1 &lt;- ef_hdv_speed(v = "Trucks",t = "RT", g = "&lt;=7.5", e = "II", gr = 0,
l = 0.5, p = "HC")
plot(1:130, ef1(1:130), pch = 16, type = "b")
euro &lt;- c(rep("V", 5), rep("IV", 5), rep("III", 5), rep("II", 5),
          rep("I", 5), rep("PRE", 15))
lef &lt;- lapply(1:30, function(i) {
ef_hdv_speed(v = "Trucks", t = "RT", g = "&gt;32", gr = 0,
eu = euro[i], l = 0.5, p = "NOx",
show.equation = FALSE)(25) })
efs &lt;- EmissionFactors(unlist(lef)) #returns 'units'
plot(efs, xlab = "age")
lines(efs, type = "l")
a &lt;- ef_hdv_speed(v = "Trucks", t = "RT", g = "&gt;32", gr = 0,
eu = euro, l = 0.5, p = "NOx", speed = Speed(0:125))
a$speed &lt;- NULL
filled.contour(as.matrix(a), col = cptcity::lucky(n = 24),
xlab = "Speed", ylab = "Age")
persp(x = as.matrix(a), theta = 35, xlab = "Speed", ylab = "Age",
zlab = "NOx [g/km]", col = cptcity::lucky(), phi = 25)
aa &lt;- ef_hdv_speed(v = "Trucks", t = "RT", g = "&gt;32", gr = 0,
eu = rbind(euro, euro), l = 0.5, p = "NOx", speed = Speed(0:125))

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_im'>Emission factors deoending on accumulated mileage</h2><span id='topic+ef_im'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_im">ef_im</a></code> calculate the theoretical emission factors of vehicles.
The approache is different from including deterioration factors
(<code><a href="#topic+emis_det">emis_det</a></code>)  but similar, because they represent how much emits
a vehicle with a normal deterioration, but that it will pass the
Inspection and Manteinance program.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_im(ef, tc, amileage, max_amileage, max_ef, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_im_+3A_ef">ef</code></td>
<td>
<p>Numeric; emission factors of vehicles with <strong>0 mileage</strong>
(new vehicles).</p>
</td></tr>
<tr><td><code id="ef_im_+3A_tc">tc</code></td>
<td>
<p>Numeric; rate of growth of emissions by year of use.</p>
</td></tr>
<tr><td><code id="ef_im_+3A_amileage">amileage</code></td>
<td>
<p>Numeric; Accumulated mileage by age of use.</p>
</td></tr>
<tr><td><code id="ef_im_+3A_max_amileage">max_amileage</code></td>
<td>
<p>Numeric; Max accumulated mileage. This means that after
this value, mileage is constant.</p>
</td></tr>
<tr><td><code id="ef_im_+3A_max_ef">max_ef</code></td>
<td>
<p>Numeric; Max ef. This means that after this value, ef is constant.</p>
</td></tr>
<tr><td><code id="ef_im_+3A_verbose">verbose</code></td>
<td>
<p>Logical; if you want detailed description.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An emission factor of a deteriorated vehicle under normal conditions
which would be approved in a inspection and mantainence program.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
# Passenger Cars PC
data(fkm)
# cumulative mileage from 1 to 50 years of use, 40:50
mil &lt;- cumsum(fkm$KM_PC_E25(1:10))
ef_im(ef = seq(0.1, 2, 0.2), seq(0.1, 1, 0.1), mil)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_ldv_cold'>Cold-Start Emissions factors for Light Duty Vehicles</h2><span id='topic+ef_ldv_cold'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_ldv_cold">ef_ldv_cold</a></code> returns speed functions or data.frames which depends on ambient temperature
average speed. The emission factors comes from the guidelines  EMEP/EEA air pollutant
emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_ldv_cold(
  v = "LDV",
  ta,
  cc,
  f,
  eu,
  p,
  k = 1,
  show.equation = FALSE,
  speed,
  fcorr = rep(1, 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_ldv_cold_+3A_v">v</code></td>
<td>
<p>Character; Category vehicle:  &quot;LDV&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_ta">ta</code></td>
<td>
<p>Numeric vector or data.frame; Ambient temperature. Monthly mean can be used. When
ta is a data.frame, one option is that the number of rows should be the number of
rows of your  Vehicles data.frame. This is convenient for top-down approach
when each simple feature can be a polygon, with a monthly average temperature for
each simple feature. In this case, the number of columns can be the 12 months.</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_cc">cc</code></td>
<td>
<p>Character; Size of engine in cc: &quot;&lt;=1400&quot;,  &quot;1400_2000&quot; or &quot;&gt;2000&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_f">f</code></td>
<td>
<p>Character; Type of fuel: &quot;G&quot;, &quot;D&quot; or &quot;LPG&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_eu">eu</code></td>
<td>
<p>Character or data.frame of Characters; Euro standard: &quot;PRE&quot;, &quot;I&quot;,
&quot;II&quot;, &quot;III&quot;,  &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot; or &quot;VIc&quot;. When 'eu' is a data.frame and
'ta' is also a data.frame both has to have the same number of rows. For instance,
When you want that each simple feature or region has a different emission standard.</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_p">p</code></td>
<td>
<p>Character; Pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot;, &quot;HC&quot; or &quot;PM&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_k">k</code></td>
<td>
<p>Numeric; Multiplication factor</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_show.equation">show.equation</code></td>
<td>
<p>Option to see or not the equation parameters</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_speed">speed</code></td>
<td>
<p>Numeric; Speed to return Number of emission factor and not a function.</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_+3A_fcorr">fcorr</code></td>
<td>
<p>Numeric; Correction by fuel properties by euro technology.
See <code><a href="#topic+fuel_corr">fuel_corr</a></code>. The order from first to last is
&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, VI, &quot;VIc&quot;. Default is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an emission factor function which depends of the average speed V
and ambient temperature. g/km
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fuel_corr">fuel_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ef1 &lt;- ef_ldv_cold(ta = 15, cc = "&lt;=1400", f ="G", eu = "PRE", p = "CO",
show.equation = TRUE)
ef1(10)
speed &lt;- Speed(10)
ef_ldv_cold(ta = 15, cc = "&lt;=1400", f ="G", eu = "PRE", p = "CO", speed = speed)
# lets create a matrix of ef cold at different speeds and temperatures
te &lt;- -50:50
lf &lt;- sapply(1:length(te), function(i){
ef_ldv_cold(ta = te[i], cc = "&lt;=1400", f ="G", eu = "I", p = "CO", speed = Speed(0:120))
})
filled.contour(lf, col= cptcity::lucky())
euros &lt;- c("V", "V", "IV", "III", "II", "I", "PRE", "PRE")
ef_ldv_cold(ta = 10, cc = "&lt;=1400", f ="G", eu = euros, p = "CO", speed = Speed(0))
lf &lt;-  ef_ldv_cold(ta = 10, cc = "&lt;=1400", f ="G", eu = euros, p = "CO", speed = Speed(0:120))
dt &lt;- matrix(rep(2:25,5), ncol = 12) # 12 months
ef_ldv_cold(ta = dt, cc = "&lt;=1400", f ="G", eu = "I", p = "CO", speed = Speed(0))
ef_ldv_cold(ta = dt, cc = "&lt;=1400", f ="G", eu = euros, p = "CO", speed = Speed(34))
euros2 &lt;- c("V", "V", "V", "IV", "IV", "IV", "III", "III")
dfe &lt;- rbind(euros, euros2)
ef_ldv_cold(ta = 10, cc = "&lt;=1400", f ="G", eu = dfe, p = "CO", speed = Speed(0))

ef_ldv_cold(ta = dt[1:2,], cc = "&lt;=1400", f ="G", eu = dfe, p = "CO", speed = Speed(0))
# Fuel corrections
fcorr &lt;- c(0.5,1,1,1,0.9,0.9,0.9,0.9)
ef1 &lt;- ef_ldv_cold(ta = 15, cc = "&lt;=1400", f ="G", eu = "PRE", p = "CO",
show.equation = TRUE, fcorr = fcorr)
ef_ldv_cold(ta = 10, cc = "&lt;=1400", f ="G", eu = dfe, p = "CO", speed = Speed(0),
fcorr = fcorr)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_ldv_cold_list'>List of cold start emission factors of Light Duty Vehicles</h2><span id='topic+ef_ldv_cold_list'></span>

<h3>Description</h3>

<p>This function creates a list of functions of cold start emission factors
considering different euro emission standard to the elements of the list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_ldv_cold_list(df, v = "LDV", ta, cc, f, eu, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_ldv_cold_list_+3A_df">df</code></td>
<td>
<p>Dataframe with local emission factor</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_v">v</code></td>
<td>
<p>Category vehicle: &quot;LDV&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_ta">ta</code></td>
<td>
<p>ambient temperature. Montly average van be used</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_cc">cc</code></td>
<td>
<p>Size of engine in cc: &lt;=1400&quot;, &quot;1400_2000&quot; and &quot;&gt;2000&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_f">f</code></td>
<td>
<p>Type of fuel: &quot;G&quot; or &quot;D&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_eu">eu</code></td>
<td>
<p>character vector of euro standards: &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;,
&quot;V&quot;, &quot;VI&quot; or &quot;VIc&quot;.</p>
</td></tr>
<tr><td><code id="ef_ldv_cold_list_+3A_p">p</code></td>
<td>
<p>Pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot;, &quot;HC&quot; or &quot;PM&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of cold start emission factors  g/km
</p>


<h3>Note</h3>

<p>The length of the list should be equal to the name of the age categories of
a specific type of vehicle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
df &lt;- data.frame(age1 = c(1,1),
                 age2 = c(2,2))
eu = c("I", "PRE")
l &lt;- ef_ldv_cold(t = 17, cc = "&lt;=1400", f = "G",
eu = "I", p = "CO")
l_cold &lt;- ef_ldv_cold_list(df, t = 17, cc = "&lt;=1400", f = "G",
eu = eu, p = "CO")
length(l_cold)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_ldv_scaled'>Scaling constant with speed emission factors of Light Duty Vehicles</h2><span id='topic+ef_ldv_scaled'></span>

<h3>Description</h3>

<p>This function creates a list of scaled functions of emission factors. A scaled
emission factor which at a speed of the driving cycle (SDC) gives a desired value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_ldv_scaled(df, dfcol, SDC = 34.12, v, t = "4S", cc, f, eu, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_ldv_scaled_+3A_df">df</code></td>
<td>
<p>deprecated</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_dfcol">dfcol</code></td>
<td>
<p>Column of the dataframe with the local emission factors eg df$dfcol</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_sdc">SDC</code></td>
<td>
<p>Speed of the driving cycle</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_v">v</code></td>
<td>
<p>Category vehicle: &quot;PC&quot;, &quot;LCV&quot;, &quot;Motorcycle&quot; or &quot;Moped</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_t">t</code></td>
<td>
<p>Sub-category of of vehicle: PC:  &quot;ECE_1501&quot;, &quot;ECE_1502&quot;,
&quot;ECE_1503&quot;, &quot;ECE_1504&quot; , &quot;IMPROVED_CONVENTIONAL&quot;, &quot;OPEN_LOOP&quot;, &quot;ALL&quot;,
&quot;2S&quot;  or &quot;4S&quot;. LCV: &quot;4S&quot;, Motorcycle: &quot;2S&quot; or &quot;4S&quot;. Moped: &quot;2S&quot; or &quot;4S&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_cc">cc</code></td>
<td>
<p>Size of engine in cc:  PC: &quot;&lt;=1400&quot;, &quot;&gt;1400&quot;, &quot;1400_2000&quot;, &quot;&gt;2000&quot;,
&quot;&lt;=800&quot;, &quot;&lt;=2000&quot;. Motorcycle:  &quot;&gt;=50&quot; (for &quot;2S&quot;), &quot;&lt;=250&quot;, &quot;250_750&quot;, &quot;&gt;=750&quot;.
Moped: &quot;&lt;=50&quot;. LCV :  &quot;&lt;3.5&quot; for gross weight.</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_f">f</code></td>
<td>
<p>Type of fuel: &quot;G&quot;, &quot;D&quot;, &quot;LPG&quot; or &quot;FH&quot; (Full Hybrid: starts by electric motor)</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_eu">eu</code></td>
<td>
<p>Euro standard: &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;III+DPF&quot;, &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot;, &quot;VIc&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_scaled_+3A_p">p</code></td>
<td>
<p>Pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot;, &quot;HC&quot; or &quot;PM&quot;. If your pollutant dfcol
is based on fuel, use &quot;FC&quot;, if it is based on &quot;HC&quot;, use &quot;HC&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calls &quot;ef_ldv_speed&quot; and calculate the specific k value, dividing the
local emission factor by the respective speed emissions factor at the speed representative
of the local emission factor, e.g. If the local emission factors were tested with the
FTP-75 test procedure, SDC = 34.12 km/h.
</p>


<h3>Value</h3>

<p>A list of scaled emission factors  g/km
</p>


<h3>Note</h3>

<p>The length of the list should be equal to the name of the age categories of
a specific type of vehicle. Thanks to Glauber Camponogara for the help.
</p>


<h3>See Also</h3>

<p>ef_ldv_seed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
CO &lt;- ef_cetesb(p = "CO", veh = "PC_FG", full = TRUE)
lef &lt;- ef_ldv_scaled(dfcol = CO$CO,
                     v = "PC",
                     t = "4S",
                     cc = "&lt;=1400",
                     f = "G",
                     eu = CO$EqEuro_PC,
                     p = "CO")
length(lef)
ages &lt;- c(1, 10, 20, 30, 40)
EmissionFactors(do.call("cbind",
   lapply(ages, function(i) {
       data.frame(i = lef[[i]](1:100))
}))) -&gt; df
names(df) &lt;- ages
colplot(df)
}
</code></pre>

<hr>
<h2 id='ef_ldv_speed'>Emissions factors for Light Duty Vehicles and Motorcycles</h2><span id='topic+ef_ldv_speed'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> returns speed dependent emission factors, data.frames or
list of emission factors. The emission factors
comes from the guidelines  EMEP/EEA air pollutant emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_ldv_speed(
  v,
  t = "4S",
  cc,
  f,
  eu,
  p,
  x,
  k = 1,
  speed,
  show.equation = FALSE,
  fcorr = rep(1, 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_ldv_speed_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PC&quot;, &quot;LCV&quot;, &quot;Motorcycle&quot; or &quot;Moped</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PC:  &quot;ECE_1501&quot;, &quot;ECE_1502&quot;,
&quot;ECE_1503&quot;, &quot;ECE_1504&quot; , &quot;IMPROVED_CONVENTIONAL&quot;, &quot;OPEN_LOOP&quot;, &quot;ALL&quot;,
&quot;2S&quot;  or &quot;4S&quot;. LCV: &quot;4S&quot;, Motorcycle: &quot;2S&quot; or &quot;4S&quot;. Moped: &quot;2S&quot; or &quot;4S&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_cc">cc</code></td>
<td>
<p>Character; size of engine in cc:  PC: &quot;&lt;=1400&quot;, &quot;&gt;1400&quot;, &quot;1400_2000&quot;, &quot;&gt;2000&quot;,
&quot;&lt;=800&quot;, &quot;&lt;=2000&quot;. Motorcycle:  &quot;&gt;=50&quot; (for &quot;2S&quot;), &quot;&lt;=250&quot;, &quot;250_750&quot;, &quot;&gt;=750&quot;.
Moped: &quot;&lt;=50&quot;. LCV :  &quot;&lt;3.5&quot; for gross weight.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_f">f</code></td>
<td>
<p>Character; type of fuel: &quot;G&quot;, &quot;D&quot;, &quot;LPG&quot; or &quot;FH&quot; (Gasoline Full Hybrid).
Full hybrid vehicles cannot be charged from the grid and recharge; only its own engine
may recharge tis batteries.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_eu">eu</code></td>
<td>
<p>Character or data.frame of characters; euro standard:
&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;III+DPF&quot;, &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot; or &quot;VIc&quot;.
When the pollutan is active surface or number of particles, eu can also be &quot;III+DISI&quot;</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;FC&quot;, &quot;NOx&quot;, &quot;NO&quot;, &quot;NO2&quot;, &quot;HC&quot;, &quot;PM&quot;, &quot;NMHC&quot;, &quot;CH4&quot;,
&quot;CO2&quot;,  &quot;SO2&quot; or &quot;Pb&quot;. Only when p is &quot;SO2&quot; pr &quot;Pb&quot; x is needed. Also
polycyclic aromatic hydrocarbons (PAHs), persistent organi pollutants (POPs),
and Number of particles and Active Surface.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_x">x</code></td>
<td>
<p>Numeric; if pollutant is &quot;SO2&quot;, it is sulphur in fuel in ppm, if is
&quot;Pb&quot;, Lead in fuel in ppm.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_k">k</code></td>
<td>
<p>Numeric; multiplication factor</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_speed">speed</code></td>
<td>
<p>Numeric; Speed to return Number of emission factor and not a function.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_show.equation">show.equation</code></td>
<td>
<p>Logical; option to see or not the equation parameters.</p>
</td></tr>
<tr><td><code id="ef_ldv_speed_+3A_fcorr">fcorr</code></td>
<td>
<p>Numeric; Correction by fuel properties by euro technology.
See <code><a href="#topic+fuel_corr">fuel_corr</a></code>. The order from first to last is
&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, VI, &quot;VIc&quot;. Default is 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument of this functions have several options which results in
different combinations that returns emission factors. If a combination of
any option is wrong it will return an empty value. Therefore, it is
important ti know the combinations.
</p>


<h3>Value</h3>

<p>An emission factor function which depends of the average speed V  g/km
</p>


<h3>Note</h3>

<p>t = &quot;ALL&quot; and cc == &quot;ALL&quot; works for several pollutants because emission
fators are the same. Some exceptions are with NOx and FC because size of engine.
</p>
<p><strong>Hybrid cars</strong>: the only cover &quot;PC&quot; and according to EMEP/EEA air pollutant emission inventory
guidebook 2016 (Ntziachristos and Samaras, 2016) only for euro IV. When new literature
is available, I will update these factors.
</p>
<p><strong>Pollutants (g/km)</strong>: &quot;CO&quot;, &quot;NOx&quot;, &quot;HC&quot;, &quot;PM&quot;, &quot;CH4&quot;, &quot;NMHC&quot;, &quot;CO2&quot;, &quot;SO2&quot;,
&quot;Pb&quot;, &quot;FC&quot;.
</p>
<p><strong>Black Carbon and Organic Matter (g/km)</strong>: &quot;BC&quot;, &quot;OM&quot;
</p>
<p><strong>PAH and POP (g/km)</strong>:  <code><a href="#topic+speciate">speciate</a></code>
<strong>Dioxins and furans(g equivalent toxicity / km)</strong>:  <code><a href="#topic+speciate">speciate</a></code>
<strong>Metals (g/km)</strong>:  <code><a href="#topic+speciate">speciate</a></code>
</p>
<p><strong>NMHC (g/km)</strong>: <code><a href="#topic+speciate">speciate</a></code>
</p>
<p><em>Active Surface (cm2/km)</em>:  <code><a href="#topic+speciate">speciate</a></code>&quot;AS_urban&quot;, &quot;AS_rural&quot;, &quot;AS_highway&quot;
</p>
<p><em>Total Number of particles (N/km)</em>: <code><a href="#topic+speciate">speciate</a></code> &quot;N_urban&quot;, &quot;N_rural&quot;, &quot;N_highway&quot;,
&quot;N_50nm_urban&quot;, &quot;N_50_100nm_rural&quot;, &quot;N_100_1000nm_highway&quot;.
</p>
<p>The available standards for Active Surface or number of particles are Euro I,
II, III, III+DPF dor diesle and III+DISI for gasoline. Pre euro vehicles
has the value of Euro I and  euro IV, V, VI and VIc the value of euro III.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fuel_corr">fuel_corr</a></code> <code><a href="#topic+emis">emis</a></code> <code><a href="#topic+ef_ldv_cold">ef_ldv_cold</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Passenger Cars PC
# Emission factor function
V &lt;- 0:150
ef1 &lt;- ef_ldv_speed(v = "PC",t = "4S", cc = "&lt;=1400", f = "G", eu = "PRE",
p = "CO")
efs &lt;- EmissionFactors(ef1(1:150))
plot(Speed(1:150), efs, xlab = "speed[km/h]", type = "b", pch = 16, col = "blue")

# Quick view
pol &lt;- c("CO", "NOx", "HC", "NMHC", "CH4", "FC", "PM", "CO2", "SO2",
"1-butyne", "propyne")
f &lt;- sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "&lt;=1400", "G", "PRE", pol[i], x = 10)(30)
})
f
# PM Characteristics
pol &lt;- c("AS_urban", "AS_rural", "AS_highway",
"N_urban", "N_rural", "N_highway",
"N_50nm_urban", "N_50_100nm_rural", "N_100_1000nm_highway")
f &lt;- sapply(1:length(pol), function(i){
ef_ldv_speed("PC", "4S", "&lt;=1400", "D", "PRE", pol[i], x = 10)(30)
})
f
# PAH POP
ef_ldv_speed(v = "PC",t = "4S", cc = "&lt;=1400", f = "G", eu = "PRE",
p = "indeno(1,2,3-cd)pyrene")(10)
ef_ldv_speed(v = "PC",t = "4S", cc = "&lt;=1400", f = "G", eu = "PRE",
p = "napthalene")(10)

# Dioxins and Furans
ef_ldv_speed(v = "PC",t = "4S", cc = "&lt;=1400", f = "G", eu = "PRE",
p = "PCB")(10)

# NMHC
ef_ldv_speed(v = "PC",t = "4S", cc = "&lt;=1400", f = "G", eu = "PRE",
p = "hexane")(10)

# List of Copert emission factors for 40 years fleet of Passenger Cars.
# Assuming a euro distribution of euro V, IV, III, II, and I of
# 5 years each and the rest 15 as PRE euro:
euro &lt;- c(rep("V", 5), rep("IV", 5), rep("III", 5), rep("II", 5),
          rep("I", 5), rep("PRE", 15))
speed &lt;- 25
lef &lt;- lapply(1:40, function(i) {
ef_ldv_speed(v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
          eu = euro[i], p = "CO")
ef_ldv_speed(v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
          eu = euro[i], p = "CO", show.equation = FALSE)(25) })
# to check the emission factor with a plot
efs &lt;- EmissionFactors(unlist(lef)) #returns 'units'
plot(efs, xlab = "age")
lines(efs, type = "l")
euros &lt;- c("VI", "V", "IV", "III", "II")
ef_ldv_speed(v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
          eu = euros, p = "CO")
a &lt;- ef_ldv_speed(v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
          eu = euros, p = "CO", speed = Speed(0:120))
head(a)
filled.contour(as.matrix(a)[1:10, 1:length(euros)], col = cptcity::cpt(n = 18))
filled.contour(as.matrix(a)[110:120, 1:length(euros)], col = cptcity::cpt(n = 16))
filled.contour(as.matrix(a)[, 1:length(euros)], col = cptcity::cpt(n = 21))
filled.contour(as.matrix(a)[, 1:length(euros)],
col = cptcity::cpt("mpl_viridis", n = 21))
filled.contour(as.matrix(a)[, 1:length(euros)],
col = cptcity::cpt("mpl_magma", n = 21))
persp(as.matrix(a)[, 1:length(euros)], phi = 0, theta = 0)
persp(as.matrix(a)[, 1:length(euros)], phi = 25, theta = 45)
persp(as.matrix(a)[, 1:length(euros)], phi = 0, theta = 90)
persp(as.matrix(a)[, 1:length(euros)], phi = 25, theta = 90+45)
persp(as.matrix(a)[, 1:length(euros)], phi = 0, theta = 180)
new_euro &lt;- c("VI", "VI", "V", "V", "V")
euro &lt;- c("V", "V", "IV", "III", "II")
old_euro &lt;- c("III", "II", "I", "PRE", "PRE")
meuros &lt;- rbind(new_euro, euro, old_euro)
aa &lt;- ef_ldv_speed(v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
          eu = meuros, p = "CO", speed = Speed(10:11))
# Light Commercial Vehicles
V &lt;- 0:150
ef1 &lt;- ef_ldv_speed(v = "LCV",t = "4S", cc = "&lt;3.5", f = "G", eu = "PRE",
p = "CO")
efs &lt;- EmissionFactors(ef1(1:150))
plot(Speed(1:150), efs, xlab = "speed[km/h]")
lef &lt;- lapply(1:5, function(i) {
ef_ldv_speed(v = "LCV", t = "4S", cc = "&lt;3.5", f = "G",
          eu = euro[i], p = "CO", show.equation = FALSE)(25) })
# to check the emission factor with a plot
efs &lt;- EmissionFactors(unlist(lef)) #returns 'units'
plot(efs, xlab = "age")
lines(efs, type = "l")

# Motorcycles
V &lt;- 0:150
ef1 &lt;- ef_ldv_speed(v = "Motorcycle",t = "4S", cc = "&lt;=250", f = "G",
eu = "PRE", p = "CO",show.equation = TRUE)
efs &lt;- EmissionFactors(ef1(1:150))
plot(Speed(1:150), efs, xlab = "speed[km/h]")
# euro for motorcycles
eurom &lt;- c(rep("III", 5), rep("II", 5), rep("I", 5), rep("PRE", 25))
lef &lt;- lapply(1:30, function(i) {
ef_ldv_speed(v = "Motorcycle", t = "4S", cc = "&lt;=250", f = "G",
eu = eurom[i], p = "CO",
show.equation = FALSE)(25) })
efs &lt;- EmissionFactors(unlist(lef)) #returns 'units'
plot(efs, xlab = "age")
lines(efs, type = "l")
a &lt;- ef_ldv_speed(v = "Motorcycle", t = "4S", cc = "&lt;=250", f = "G",
eu = eurom, p = "CO", speed = Speed(0:125))
a$speed &lt;- NULL
filled.contour(as.matrix(a), col = cptcity::lucky(),
xlab = "Speed", ylab = "Age")
persp(x = as.matrix(a), theta = 35, xlab = "Speed", ylab = "Euros",
zlab = "CO [g/km]", col = cptcity::lucky(), phi = 25)

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_local'>Local Emissions factors</h2><span id='topic+ef_local'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_local">ef_local</a></code> process an data.frame delivered by the user, but adding
similar funcionality and arguments as <code><a href="#topic+ef_cetesb">ef_cetesb</a></code>, which are classification, filtering
and projections
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_local(
  p,
  veh,
  year = 2017,
  agemax = 40,
  ef,
  full = FALSE,
  project = "constant",
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_local_+3A_p">p</code></td>
<td>
<p>Character; pollutant delivered by the user. the name of the column of the data.frame must be
<strong>Pollutant</strong>.</p>
</td></tr>
<tr><td><code id="ef_local_+3A_veh">veh</code></td>
<td>
<p>Character; Vehicle categories available in the data.frame provided by the user</p>
</td></tr>
<tr><td><code id="ef_local_+3A_year">year</code></td>
<td>
<p>Numeric; Filter the emission factor to start from a specific base year.
If project is 'constant' values above 2017 and below 1980 will be repeated</p>
</td></tr>
<tr><td><code id="ef_local_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="ef_local_+3A_ef">ef</code></td>
<td>
<p>data.frame, for local the emission factors. The names of the ef must
be 'Age'    'Year'    'Pollutant' and all the vehicle categories...</p>
</td></tr>
<tr><td><code id="ef_local_+3A_full">full</code></td>
<td>
<p>Logical; To return a data.frame instead or a vector adding
Age, Year, Brazilian emissions standards and its euro equivalents.</p>
</td></tr>
<tr><td><code id="ef_local_+3A_project">project</code></td>
<td>
<p>Character showing the method for projecting emission factors in
future. Currently the only value is &quot;constant&quot;</p>
</td></tr>
<tr><td><code id="ef_local_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>returns a vector or data.frame of Brazilian emission factors.
</p>


<h3>Value</h3>

<p>A vector of Emission Factor or a data.frame
</p>


<h3>Note</h3>

<p>The names of the ef must be 'Age'	'Year'	'Pollutant' and all the vehicle categories...
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_cetesb">ef_cetesb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#do not run

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_nitro'>Emissions factors of N2O and NH3</h2><span id='topic+ef_nitro'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_nitro">ef_nitro</a></code> returns emission factors as a functions of acondumulated mileage.
The emission factors comes from the guidelines  EMEP/EEA air pollutant
emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_nitro(
  v,
  t = "Hot",
  cond = "Urban",
  cc,
  f,
  eu,
  p = "NH3",
  S = 10,
  cumileage,
  k = 1,
  show.equation = FALSE,
  fcorr = rep(1, 8)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_nitro_+3A_v">v</code></td>
<td>
<p>Category vehicle: &quot;PC&quot;, &quot;LCV&quot;, &quot;Motorcycles_2S&quot;, &quot;Motorcycles&quot;,
&quot;Trucks&quot;, &quot;Trucks-A&quot;, &quot;Coach&quot; and &quot;BUS&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_t">t</code></td>
<td>
<p>Type: &quot;Cold&quot; or &quot;Hot&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_cond">cond</code></td>
<td>
<p>&quot;Urban&quot;, &quot;Rural&quot;, &quot;Highway&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_cc">cc</code></td>
<td>
<p>PC: &quot;&lt;=1400&quot;, &quot;1400_2000&quot;, &quot;&gt;2000&quot;. LCV: &quot;&lt;3.5&quot;. Motorcycles: &quot;&gt;=50&quot;,
Motorcycles_2S, &quot;&lt;50&quot;, &quot;&gt;=50&quot;. Trucks: &quot;&gt;3.5&quot;, &quot;7.5_12&quot;, &quot;12_28&quot;, &quot;28_34&quot;.
Trucks_A: &quot;&gt;34&quot;. BUS: &quot;&lt;=15&quot;, &quot;&gt;15 &amp; &lt;= 18&quot;. Coach:  &quot;&lt;=18&quot;, &quot;&gt;18&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_f">f</code></td>
<td>
<p>Type of fuel: &quot;G&quot;, &quot;D&quot; or &quot;LPG&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_eu">eu</code></td>
<td>
<p>Euro standard: &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot;,
&quot;VIc&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_p">p</code></td>
<td>
<p>Pollutant: &quot;N2O&quot;, &quot;NH3&quot;</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_s">S</code></td>
<td>
<p>Sulphur (ppm). Number.</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_cumileage">cumileage</code></td>
<td>
<p>Numeric; Acondumulated mileage to return number of emission factor and not a function.</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_k">k</code></td>
<td>
<p>Multiplication factor</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_show.equation">show.equation</code></td>
<td>
<p>Option to see or not the equation parameters</p>
</td></tr>
<tr><td><code id="ef_nitro_+3A_fcorr">fcorr</code></td>
<td>
<p>Numeric; Correction by by euro technology.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an emission factor function which depends on the acondumulated mileage,
or an EmissionFactor
</p>


<h3>Note</h3>

<p>if length of eu is bigger than 1, cumileage can have values  of length 1
or length equal to length of eu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
efe10 &lt;- ef_nitro(v = "PC", t = "Hot", cond = "Urban", f = "G", cc = "&lt;=1400",
eu = "III", p = "NH3", S = 10,
show.equation = FALSE)
efe50 &lt;- ef_nitro(v = "PC", t = "Hot", cond = "Urban", f = "G", cc = "&lt;=1400",
eu = "III", p = "NH3", S = 50,
show.equation = TRUE)
efe10(10)
efe50(10)
efe10 &lt;- ef_nitro(v = "PC", t = "Hot", cond = "Urban", f = "G", cc = "&lt;=1400",
eu = "III", p = "NH3", S = 10, cumileage = units::set_units(25000, "km"))

## End(Not run)
</code></pre>

<hr>
<h2 id='ef_wear'>Emissions factors from tyre, break and road surface wear</h2><span id='topic+ef_wear'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_wear">ef_wear</a></code> estimates wear emissions.
The sources are tyres, breaks and road surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_wear(
  wear,
  type,
  pol = "TSP",
  speed,
  load = 0.5,
  axle = 2,
  road = "urban",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_wear_+3A_wear">wear</code></td>
<td>
<p>Character; type of wear: &quot;tyre&quot; (or &quot;tire&quot;),
&quot;break&quot; (or &quot;brake&quot;) and &quot;road&quot;</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_type">type</code></td>
<td>
<p>Character; type of vehicle: &quot;2W&quot;, &quot;MC&quot;, &quot;Motorcycle&quot;, &quot;PC&quot;,
&quot;LCV&quot;, 'HDV&quot;, &quot;BUS&quot;, &quot;TRUCKS&quot;</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_pol">pol</code></td>
<td>
<p>Character; pollutant: &quot;TSP&quot;, &quot;PM10&quot;, &quot;PM2.5&quot;, &quot;PM1&quot; and &quot;PM0.1&quot;</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_speed">speed</code></td>
<td>
<p>Data.frame of speeds</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_load">load</code></td>
<td>
<p>Load of the HDV</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_axle">axle</code></td>
<td>
<p>Number of axle of the HDV</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_road">road</code></td>
<td>
<p>Type of road &quot;urban&quot;, &quot;rural&quot;, &quot;motorway&quot;.
Only applies when type is &quot;E6DV&quot; or &quot;BEV&quot;</p>
</td></tr>
<tr><td><code id="ef_wear_+3A_verbose">verbose</code></td>
<td>
<p>Logical to show more information.
Only applies when type is &quot;E6DV&quot; or &quot;BEV&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission factors grams/km
</p>


<h3>References</h3>

<p>Ntziachristos and Boulter 2016. Automobile tyre and break wear
and road abrasion. In: EEA, EMEP. EEA air pollutant emission inventory
guidebook-2009. European Environment Agency, Copenhagen, 2016
</p>
<p>When type is &quot;E6DV&quot; or &quot;BEV&quot;:
Tivey J., Davies H., Levine J., Zietsman J., Bartington S.,
Ibarra-Espinosa S., Ropkins K. 2022. Meta Analysis as Early
Evidence on the Particulate Emissions Impact of EURO VI to
Battery Electric Bus Fleet Transitions. Paper under development.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
data(pc_profile)
pc_week &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
df &lt;- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
ef &lt;- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)

ef_wear(wear = "tyre",
        type = c("E6DV"),
        pol = "PM10",
        verbose = TRUE)

ef_wear(wear = "tyre",
        type = c("E6DV"),
        pol = "PM10",
        verbose = FALSE)

}
</code></pre>

<hr>
<h2 id='ef_whe'>Emission factor that incorporates the effect of high emitters</h2><span id='topic+ef_whe'></span>

<h3>Description</h3>

<p><code><a href="#topic+ef_whe">ef_whe</a></code> return weighted emission factors of vehicles considering
that one part of the fleet has a normal deterioration and another has a
deteriorated fleet that would be rejected in a inspection and mantainence
program but it is still in circulation. This emission factor might be
applicable in cities without a inspection and mantainence program and with
Weighted emission factors considering that part of the fleet are high emitters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ef_whe(efhe, phe, ef)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ef_whe_+3A_efhe">efhe</code></td>
<td>
<p>Numeric; Emission factors of high emitters vehicles. This vehicles
would be rejected in a inspection and mantainnence program.</p>
</td></tr>
<tr><td><code id="ef_whe_+3A_phe">phe</code></td>
<td>
<p>Numeric; Percentage of high emitters.</p>
</td></tr>
<tr><td><code id="ef_whe_+3A_ef">ef</code></td>
<td>
<p>Numeric; Emission factors deteriorated vehicles under normal
conditions. These vehicles would be approved in a inspection and mantainence
program.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An emission factor by annual mileage.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
# Do not run
# Let's say high emitter is 5 times the normal ef.
co_efhe &lt;- ef_cetesb(p = "COd", "PC_G") * 5
# Let's say that the perfil of high emitters increases linearly
# till 30 years and after that percentage is constant
perc &lt;- c(seq(0.01, 0.3, 0.01), rep(0.3, 10))
# Now, lets use our ef with normal deterioration
co_ef_normal &lt;- ef_cetesb(p = "COd", "PC_G")
efd &lt;- ef_whe(efhe = co_efhe,
              phe = perc,
              ef = co_ef_normal)
# now, we can plot the three ef
colplot(data.frame(co_efhe, co_ef_normal, efd))
}
</code></pre>

<hr>
<h2 id='emis'>Estimation of emissions</h2><span id='topic+emis'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis">emis</a></code> estimates vehicular emissions as the product of the
vehicles on a road, length of the road, emission factor avaliated at the
respective speed. <code class="reqn">E = VEH*LENGTH*EF(speed)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis(
  veh,
  lkm,
  ef,
  speed,
  agemax = ifelse(is.data.frame(veh), ncol(veh), ncol(veh[[1]])),
  profile,
  simplify = FALSE,
  fortran = FALSE,
  hour = nrow(profile),
  day = ncol(profile),
  verbose = FALSE,
  nt = ifelse(check_nt() == 1, 1, check_nt()/2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that ype of vehicle.
The number of rows is equal to the number of streets link. If this is a list,
the length of the list is the vehicles for each hour.</p>
</td></tr>
<tr><td><code id="emis_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in km</p>
</td></tr>
<tr><td><code id="emis_+3A_ef">ef</code></td>
<td>
<p>List of functions of emission factors</p>
</td></tr>
<tr><td><code id="emis_+3A_speed">speed</code></td>
<td>
<p>Speed data-frame with number of columns as hours. The default value is 34km/h</p>
</td></tr>
<tr><td><code id="emis_+3A_agemax">agemax</code></td>
<td>
<p>Age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="emis_+3A_profile">profile</code></td>
<td>
<p>Dataframe or Matrix with nrows equal to 24 and ncol 7 day of
the week</p>
</td></tr>
<tr><td><code id="emis_+3A_simplify">simplify</code></td>
<td>
<p>Logical; to determine if EmissionsArray should les dimensions,
being streets, vehicle categories and hours or default (streets, vehicle
categories, hours and days). Default is FALSE to avoid break old code, but
the recommendation is that new estimations use this parameter as TRUE</p>
</td></tr>
<tr><td><code id="emis_+3A_fortran">fortran</code></td>
<td>
<p>Logical; to try the fortran calculation when speed is not used.
I will add fortran for EmissionFactorsList soon.</p>
</td></tr>
<tr><td><code id="emis_+3A_hour">hour</code></td>
<td>
<p>Number of considered hours in estimation. Default value is number
of rows of argument profile</p>
</td></tr>
<tr><td><code id="emis_+3A_day">day</code></td>
<td>
<p>Number of considered days in estimation</p>
</td></tr>
<tr><td><code id="emis_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
<tr><td><code id="emis_+3A_nt">nt</code></td>
<td>
<p>Integer; Number of threads wich must be lower than max available.
See <code><a href="#topic+check_nt">check_nt</a></code>. Only when fortran = TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the user applies a top-down approach, the resulting units will be
according its own data. For instance, if the vehicles are veh/day, the units
of the emissions implicitly will be g/day.
</p>


<h3>Note</h3>

<p>Hour and day will be deprecated because they can be infered from the profile
matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
data(net)
data(pc_profile)
data(profiles)
data(fe2015)
data(fkm)
PC_G &lt;- c(
  33491, 22340, 24818, 31808, 46458, 28574, 24856, 28972, 37818, 49050, 87923,
  133833, 138441, 142682, 171029, 151048, 115228, 98664, 126444, 101027,
  84771, 55864, 36306, 21079, 20138, 17439, 7854, 2215, 656, 1262, 476, 512,
  1181, 4991, 3711, 5653, 7039, 5839, 4257, 3824, 3068
)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")

# Estimation for morning rush hour and local emission factors and speed
speed &lt;- data.frame(S8 = net$ps)
lef &lt;- EmissionFactorsList(ef_cetesb("CO", "PC_G", agemax = ncol(pc1)))
system.time(E_CO &lt;- emis(veh = pc1, lkm = net$lkm, ef = lef, speed = speed))
system.time(E_CO_2 &lt;- emis(veh = pc1, lkm = net$lkm, ef = lef, speed = speed, simplify = TRUE))
identical(E_CO, E_CO_2)

# Estimation for morning rush hour and local emission factors without speed
lef &lt;- ef_cetesb("CO", "PC_G", agemax = ncol(pc1))
system.time(E_CO &lt;- emis(veh = pc1, lkm = net$lkm, ef = lef))
system.time(E_CO_2 &lt;- emis(veh = pc1, lkm = net$lkm, ef = lef, fortran = TRUE))
identical(E_CO, E_CO_2)

# Estimation for 168 hour and local factors and speed
pcw &lt;- temp_fact(net$ldv + net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
lef &lt;- EmissionFactorsList(ef_cetesb("CO", "PC_G", agemax = ncol(pc1)))
system.time(
  E_CO &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    speed = speed,
    profile = profiles$PC_JUNE_2014
  )
)
system.time(
  E_CO_2 &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    speed = speed,
    profile = profiles$PC_JUNE_2014,
    simplify = TRUE
  )
)

# Estimation for 168 hour and local factors and without speed
lef &lt;- ef_cetesb("CO", "PC_G", agemax = ncol(pc1))
system.time(
  E_CO &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    profile = profiles$PC_JUNE_2014
  )
)
sum(E_CO)
system.time(
  E_CO_2 &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    profile = profiles$PC_JUNE_2014,
    fortran = TRUE
  )
)
sum(E_CO)
system.time(
  E_CO_3 &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    profile = profiles$PC_JUNE_2014,
    simplify = TRUE
  )
)
sum(E_CO)
system.time(
  E_CO_4 &lt;- emis(
    veh = pc1,
    lkm = net$lkm,
    ef = lef,
    profile = profiles$PC_JUNE_2014,
    simplify = TRUE,
    fortran = TRUE
  )
)
sum(E_CO)
identical(round(E_CO, 2), round(E_CO_2, 2))
identical(round(E_CO_3, 2), round(E_CO_4, 2))
identical(round(E_CO_3[, , 1], 2), round(E_CO_4[, , 1], 2))
dim(E_CO_3)
dim(E_CO_4)
# but
a &lt;- unlist(lapply(1:41, function(i) {
  unlist(lapply(1:168, function(j) {
    identical(E_CO_3[, i, j], E_CO_4[, i, j])
  }))
}))
unique(a)

# Estimation with list of vehicles
lpc &lt;- list(pc1, pc1)
lef &lt;- EmissionFactorsList(ef_cetesb("CO", "PC_G", agemax = ncol(pc1)))
E_COv2 &lt;- emis(veh = lpc, lkm = net$lkm, ef = lef, speed = speed)

# top down
veh &lt;- age_ldv(x = net$ldv[1:4], name = "PC_E25_1400", agemax = 4)
mil &lt;- fkm$KM_PC_E25(1:4)
ef &lt;- ef_cetesb("COd", "PC_G")[1:4]
emis(veh, units::set_units(mil, "km"), ef)

# group online
bus1 &lt;- age_hdv(30, agemax = 4)
veh &lt;- bus1
lkm &lt;- units::set_units(400, "km")
speed &lt;- 40
efco &lt;- ef_cetesb("COd", "UB", agemax = 4)
lef &lt;- ef_hdv_scaled(
  dfcol = as.numeric(efco),
  v = "Ubus",
  t = "Std",
  g = "&gt;15 &amp; &lt;=18",
  eu = rep("IV", 4),
  gr = 0,
  l = 0.5,
  p = "CO"
)
for (i in 1:length(lef)) print(lef[[i]](10))
(a &lt;- emis(veh = bus1, lkm = lkm, ef = efco, verbose = TRUE))
(b &lt;- emis(veh = bus1, lkm = lkm, ef = efco, verbose = TRUE, fortran = TRUE))

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_chem'>(in development, needs checks) Aggregate emissions by lumped groups in chemical mechanism</h2><span id='topic+emis_chem'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_chem">emis_chem</a></code> aggregates emissions by chemical mechanism
and convert grams to mol. This function reads all hydrocarbos and respective
criteria polluants specified in <code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> and <code><a href="#topic+ef_hdv_speed">ef_hdv_speed</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_chem(dfe, mechanism, colby, long = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_chem_+3A_dfe">dfe</code></td>
<td>
<p>data.frame with column 'emissions' in grams and 'pollutant' in long format. It is supposed
that each line is the pollution of some region. Then the 'coldby' argument is for include the
name of the region.</p>
</td></tr>
<tr><td><code id="emis_chem_+3A_mechanism">mechanism</code></td>
<td>
<p>Character,
&quot;SAPRC&quot;, &quot;RACM&quot;, &quot;RADM2&quot;, &quot;CBMZ&quot;, &quot;MOZART&quot;, &quot;SAPRC99&quot;, &quot;CB05&quot;,
&quot;CB06CMAQ&quot;, &quot;CB05CMAQ&quot;, &quot;RACM2CMAQ&quot;, &quot;SAPRC99CMAQ&quot;, &quot;SAPRC07CMAQ&quot;,
&quot;SAPRC07A&quot;, &quot;RADM2_SORG&quot;, &quot;CBMZ_MOSAIC&quot;, &quot;CPTEC&quot;,
&quot;GOCART_CPTEC&quot;, &quot;MOZEM&quot;, &quot;MOZCEM&quot;, &quot;CAMMAM&quot;, &quot;MOZMEM&quot;,
&quot;MOZC_T1_EM&quot;, &quot;CB05_OPT1&quot;, &quot;CB05_OPT2&quot;, &quot;CRIMECH&quot;</p>
</td></tr>
<tr><td><code id="emis_chem_+3A_colby">colby</code></td>
<td>
<p>Character indicating column name for aggregating extra column.
For instance, region or province.</p>
</td></tr>
<tr><td><code id="emis_chem_+3A_long">long</code></td>
<td>
<p>Logical. Do you want data in long format?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with lumped groups by chemical mechanism. It transform
emissions in grams to mol.
</p>


<h3>Note</h3>

<p>This feature is experimental and the mapping of pollutants and lumped
species may change in future.
This function is converting the intial data.frame input into data.table.
To have a comprehensive speciation is necessary enter with a data.frame
with colum 'emission' in long format including another column named 'pollutant' with
species of NMHC, CO, NO, NO2, NH3, SO2, PM2.5 and coarse PM10.
</p>
<p>Groups derived from gases has units 'mol' and from aersols 'g'. The aersol
units for WRF-Chem are ug/m^2/s while for CMAQ and CAMx are g/s. So,
leaving the units just in g, allow to make further change while
providing flexibility for several models.
TODO: Enter with wide data.frame, with each line as a each street, each column for pollutant
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> <code><a href="#topic+ef_hdv_speed">ef_hdv_speed</a></code> <code><a href="#topic+speciate">speciate</a></code> <code><a href="#topic+ef_evap">ef_evap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# CO
df &lt;- data.frame(emission = Emissions(1:10))
df$pollutant = "CO"
emis_chem(dfe = df, "CBMZ_MOSAIC")
# hexanal
df$pollutant = "hexanal"
emis_chem(df, "CBMZ_MOSAIC")
# propadiene and NO2
df2 &lt;- df1 &lt;- df
df1$pollutant = "propadiene"
df2$pollutant = "NO2"
(dfe &lt;- rbind(df1, df2))
emis_chem(dfe, "CBMZ_MOSAIC")
dfe$region &lt;- rep(letters[1:2], 10)
emis_chem(dfe, "CBMZ_MOSAIC", "region")
emis_chem(dfe, "CBMZ_MOSAIC", "region", TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_chem2'>Aggregate emissions by lumped groups in chemical mechanism</h2><span id='topic+emis_chem2'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_chem2">emis_chem2</a></code> aggregates VOC emissions by chemical mechanism
and convert grams to mol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_chem2(df, mech, nx, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_chem2_+3A_df">df</code></td>
<td>
<p>data.frame with emissions including columns &quot;id&quot; and &quot;pol&quot;.</p>
</td></tr>
<tr><td><code id="emis_chem2_+3A_mech">mech</code></td>
<td>
<p>Character, &quot;CB4&quot;, &quot;CB05&quot;, &quot;S99&quot;, &quot;S7&quot;,&quot;CS7&quot;, &quot;S7T&quot;, &quot;S11&quot;,
&quot;S11D&quot;,&quot;S16C&quot;,&quot;S18B&quot;,&quot;RADM2&quot;, &quot;RACM2&quot;,&quot;MOZT1&quot;, &quot;CBMZ&quot;, &quot;CB05opt2&quot;</p>
</td></tr>
<tr><td><code id="emis_chem2_+3A_nx">nx</code></td>
<td>
<p>Character, colnames for emissions data, for instance &quot;V1&quot;, &quot;V2&quot;...</p>
</td></tr>
<tr><td><code id="emis_chem2_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical, to remove lines with NA from group</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with lumped groups by chemical mechanism.
</p>


<h3>Note</h3>


<ul>
<li> <p><strong>CB05</strong>: &quot;ALD&quot;  &quot;ALDX&quot; &quot;ETH&quot;  &quot;HC3&quot;  &quot;HC5&quot;  &quot;HC8&quot;  &quot;HCHO&quot; &quot;KET&quot;
&quot;OL2&quot;  &quot;OLI&quot;  &quot;OLT&quot;  &quot;TOL&quot;  &quot;XYL&quot;
</p>
</li>
<li> <p><strong>CB05opt2</strong>:  &quot;ALD2&quot; &quot;ALDX&quot; &quot;BENZENE&quot; &quot;ETH&quot; &quot;ETHA&quot; &quot;FORM&quot;
&quot;IOLE&quot; &quot;OLE&quot; &quot;PAR&quot; &quot;TOL&quot; &quot;XYL&quot;
</p>
</li>
<li> <p><strong>RADM2</strong>:  &quot;ALD&quot;  &quot;ETH&quot;  &quot;HC3&quot;  &quot;HC5&quot;  &quot;HC8&quot;  &quot;HCHO&quot; &quot;KET&quot;
&quot;MACR&quot; &quot;OL2&quot;  &quot;OLI&quot;  &quot;OLT&quot;  &quot;TOL&quot; &quot;XYL&quot;
</p>
</li>
<li> <p><strong>RACM2</strong>:  ACD&quot;  &quot;ACE&quot;  &quot;ACT&quot;  &quot;ALD&quot;  &quot;BALD&quot; &quot;BEN&quot;  &quot;DIEN&quot;
&quot;ETE&quot;  &quot;ETH&quot;  &quot;HC3&quot;  &quot;HC5&quot;  &quot;HC8&quot;  &quot;HCHO&quot; &quot;MACR&quot; &quot;MEK&quot;  &quot;OLI&quot;  &quot;OLT&quot;
&quot;TOL&quot;  &quot;UALD&quot; &quot;XYM&quot;  &quot;XYO&quot;  &quot;XYP&quot;
</p>
</li>
<li> <p><strong>CB4</strong>:  &quot;ALD2&quot; &quot;ETH&quot;  &quot;FORM&quot; &quot;OLE&quot;  &quot;PAR&quot;  &quot;TOL&quot;  &quot;XYL&quot;
</p>
</li>
<li> <p><strong>S99</strong>:  &quot;ACET&quot; &quot;ALK1&quot; &quot;ALK2&quot; &quot;ALK3&quot; &quot;ALK4&quot; &quot;ALK5&quot; &quot;ARO1NBZ&quot;
&quot;ARO2&quot; &quot;BALD&quot; &quot;BENZENE&quot; &quot;CCHO&quot; &quot;ETHENE&quot; &quot;HCHO&quot; &quot;IPROD&quot; &quot;MACR&quot; &quot;MEK&quot;
&quot;OLE1&quot; &quot;OLE2&quot; &quot;RCHO&quot;
</p>
</li>
<li> <p><strong>CB4</strong>: &quot;ACET&quot; &quot;ACYE&quot; &quot;ALK1&quot; &quot;ALK2&quot; &quot;ALK3&quot; &quot;ALK4&quot; &quot;ALK5&quot;
&quot;ARO1&quot; &quot;ARO2&quot; &quot;BALD&quot; &quot;BENZ&quot; &quot;CCHO&quot; &quot;ETHE&quot; &quot;HCHO&quot; &quot;IPRD&quot; &quot;MACR&quot; &quot;MEK&quot;
&quot;OLE1&quot; &quot;OLE2&quot; &quot;RCHO&quot;
</p>
</li>
<li> <p><strong>CS7</strong>: &quot;ALK3&quot; &quot;ALK4&quot; &quot;ARO1&quot; &quot;ARO2&quot; &quot;CCHO&quot; &quot;ETHE&quot; &quot;HCHO&quot;
&quot;IPRD&quot; &quot;NROG&quot; &quot;OLE1&quot; &quot;OLE2&quot; &quot;PRD2&quot; &quot;RCHO&quot;
</p>
</li>
<li> <p><strong>S7</strong>: &quot;ACET&quot; &quot;ACYE&quot; &quot;ALK1&quot; &quot;ALK2&quot; &quot;ALK3&quot; &quot;ALK4&quot; &quot;ALK5&quot;
&quot;ARO1&quot; &quot;ARO2&quot; &quot;BALD&quot; &quot;BENZ&quot; &quot;CCHO&quot; &quot;ETHE&quot; &quot;HCHO&quot; &quot;IPRD&quot; &quot;MACR&quot;
&quot;MEK&quot;  &quot;OLE1&quot; &quot;OLE2&quot; &quot;RCHO&quot;
</p>
</li>
<li> <p><strong>S7T</strong>: &quot;13BDE&quot; &quot;ACET&quot;  &quot;ACRO&quot;  &quot;ACYE&quot;  &quot;ALK1&quot;  &quot;ALK2&quot;
&quot;ALK3&quot;  &quot;ALK4&quot;  &quot;ALK5&quot;  &quot;ARO1&quot;  &quot;ARO2&quot;  &quot;B124&quot; &quot;BALD&quot;  &quot;BENZ&quot;  &quot;CCHO&quot;
&quot;ETHE&quot;  &quot;HCHO&quot;  &quot;IPRD&quot;  &quot;MACR&quot;  &quot;MEK&quot;   &quot;MXYL&quot;  &quot;OLE1&quot;  &quot;OLE2&quot;  &quot;OXYL&quot;
&quot;PRPE&quot;  &quot;PXYL&quot;  &quot;RCHO&quot;  &quot;TOLU&quot;
</p>
</li>
<li> <p><strong>S11</strong>: &quot;ACET&quot; &quot;ACYL&quot; &quot;ALK1&quot; &quot;ALK2&quot; &quot;ALK3&quot; &quot;ALK4&quot; &quot;ALK5&quot;
&quot;ARO1&quot; &quot;ARO2&quot; &quot;BALD&quot; &quot;BENZ&quot; &quot;CCHO&quot; &quot;ETHE&quot; &quot;HCHO&quot; &quot;IPRD&quot; &quot;MACR&quot;
&quot;MEK&quot;  &quot;OLE1&quot; &quot;OLE2&quot; &quot;RCHO&quot;
</p>
</li>
<li> <p><strong>S11D</strong>: &quot;ACET&quot; &quot;ACRO&quot; &quot;ACYL&quot; &quot;ALLENE&quot; &quot;BALD&quot; &quot;BENZ&quot;
&quot;BUTDE13&quot; &quot;BUTENE1&quot;  &quot;C2BENZ&quot; &quot;C2BUTE&quot; &quot;C2PENT&quot; &quot;C4RCHO1&quot; &quot;CCHO&quot;
&quot;CROTALD&quot; &quot;ETACTYL&quot;  &quot;ETHANE&quot; &quot;ETHE&quot;  &quot;HCHO&quot; &quot;HEXENE1&quot; &quot;ISOBUTEN&quot; &quot;M2C3&quot;
&quot;M2C4&quot; &quot;M2C6&quot; &quot;M2C7&quot; &quot;M3C6&quot; &quot;M3C7&quot; &quot;MACR&quot; &quot;MEACTYL&quot; &quot;MEK&quot; &quot;MXYLENE&quot;
&quot;NC1&quot; &quot;NC4&quot; NC5&quot; &quot;NC6&quot; &quot;NC7&quot; &quot;NC8&quot; &quot;NC9&quot; &quot;OLE2&quot; &quot;OTH2&quot; &quot;OTH4&quot;
&quot;OTH5&quot; &quot;OXYLENE&quot; &quot;PENTEN1&quot; &quot;PROPALD&quot; &quot;PROPANE&quot; &quot;PROPENE&quot; &quot;PXYLENE&quot; &quot;RCHO&quot;
&quot;STYRENE&quot;  &quot;TMB123&quot;   &quot;TMB124&quot;   &quot;TMB135&quot;   &quot;TOLUENE&quot;
</p>
</li>
<li> <p><strong>S16C</strong>:&quot;ACET&quot;  &quot;ACETL&quot; &quot;ACRO&quot;  &quot;ACYLS&quot; &quot;ALK3&quot;
&quot;ALK4&quot;  &quot;ALK5&quot;  &quot;BALD&quot;  &quot;BENZ&quot;  &quot;BUT13&quot; &quot;BZ123&quot; &quot;BZ124&quot;
&quot;BZ135&quot; &quot;C2BEN&quot; &quot;ETCHO&quot; &quot;ETHAN&quot; &quot;ETHEN&quot; &quot;HCHO&quot;  &quot;MACR&quot;
&quot;MECHO&quot; &quot;MEK&quot;   &quot;MXYL&quot;  &quot;NC4&quot;   &quot;OLE1&quot;
&quot;OLE2&quot;  &quot;OLE3&quot;  &quot;OLE4&quot;  &quot;OLEA1&quot; &quot;OTH1&quot;  &quot;OTH3&quot;  &quot;OTH4&quot;
&quot;OXYL&quot;  &quot;PROP&quot;  &quot;PROPE&quot; &quot;PXYL&quot;  &quot;RCHO&quot; &quot;STYRS&quot; &quot;TOLU&quot;
</p>
</li>
<li> <p><strong>S18B</strong>:&quot;ACET&quot;  &quot;ACETL&quot; &quot;ACRO&quot;  &quot;ACYLS&quot; &quot;ALK3&quot;
&quot;ALK4&quot;  &quot;ALK5&quot;  &quot;BALD&quot;  &quot;BENZ&quot;  &quot;BUT13&quot; &quot;BZ123&quot; &quot;BZ124&quot;
&quot;BZ135&quot; &quot;C2BEN&quot; &quot;ETCHO&quot; &quot;ETHAN&quot; &quot;ETHEN&quot; &quot;HCHO&quot;
&quot;MACR&quot;  &quot;MECHO&quot; &quot;MEK&quot;   &quot;MXYL&quot;  &quot;NC4&quot;   &quot;OLE1&quot;
&quot;OLE2&quot;  &quot;OLE3&quot;  &quot;OLE4&quot;  &quot;OLEA1&quot; &quot;OTH1&quot;  &quot;OTH3&quot;  &quot;OTH4&quot;  &quot;OXYL&quot;
&quot;PROP&quot;  &quot;PROPE&quot; &quot;PXYL&quot;  &quot;RCHO&quot; &quot;STYRS&quot; &quot;TOLU&quot;
</p>
</li></ul>



<h3>References</h3>

<p>Carter, W. P. (2015). Development of a database for
chemical mechanism assignments for volatile organic emissions.
Journal of the Air &amp; Waste Management Association, 65(10), 1171-1184.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speciate">speciate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
id &lt;-1:2
df &lt;- data.frame(V1 = 1:2, V2 = 1:2)
dx &lt;- speciate(x = df,
               spec = "nmhc",
               fuel = "E25",
               veh = "LDV",
               eu = "Exhaust")
dx$id &lt;- rep(id, length(unique(dx$pol)))
names(dx)
vocE25EX &lt;- emis_chem2(df = dx,
                       mech = "CB05",
                       nx = c("V1", "V2"))
}
</code></pre>

<hr>
<h2 id='emis_china'>Estimation with Chinese factors</h2><span id='topic+emis_china'></span>

<h3>Description</h3>

<p>Emissions estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_china(
  x,
  lkm,
  tfs,
  v = "PV",
  t = "Small",
  f = "G",
  standard,
  s,
  speed,
  te,
  hu,
  h,
  yeardet = 2016,
  p,
  verbose = TRUE,
  array = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_china_+3A_x">x</code></td>
<td>
<p>Vehicles data.frame</p>
</td></tr>
<tr><td><code id="emis_china_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in km</p>
</td></tr>
<tr><td><code id="emis_china_+3A_tfs">tfs</code></td>
<td>
<p>temporal factor</p>
</td></tr>
<tr><td><code id="emis_china_+3A_v">v</code></td>
<td>
<p>Character; category vehicle: &quot;PV&quot; for Passenger Vehicles or 'Trucks&quot;</p>
</td></tr>
<tr><td><code id="emis_china_+3A_t">t</code></td>
<td>
<p>Character; sub-category of of vehicle: PV Gasoline:  &quot;Mini&quot;, &quot;Small&quot;,&quot;Medium&quot;,
&quot;Large&quot;, &quot;Taxi&quot;, &quot;Motorcycles&quot;, &quot;Moped&quot;, PV Diesel: &quot;Mediumbus&quot;, &quot;Largebus&quot;,
&quot;3-Wheel&quot;. Trucks: &quot;Mini&quot;, &quot;Light&quot; , &quot;Medium&quot;, &quot;Heavy&quot;</p>
</td></tr>
<tr><td><code id="emis_china_+3A_f">f</code></td>
<td>
<p>Character;fuel: &quot;G&quot;, &quot;D&quot;, &quot;CNG&quot;, &quot;ALL&quot;</p>
</td></tr>
<tr><td><code id="emis_china_+3A_standard">standard</code></td>
<td>
<p>Character vector; &quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;.</p>
</td></tr>
<tr><td><code id="emis_china_+3A_s">s</code></td>
<td>
<p>Sulhur in ppm</p>
</td></tr>
<tr><td><code id="emis_china_+3A_speed">speed</code></td>
<td>
<p>Speed  (length nrow x)</p>
</td></tr>
<tr><td><code id="emis_china_+3A_te">te</code></td>
<td>
<p>Temperature (length tfs)</p>
</td></tr>
<tr><td><code id="emis_china_+3A_hu">hu</code></td>
<td>
<p>Humidity (length tfs)</p>
</td></tr>
<tr><td><code id="emis_china_+3A_h">h</code></td>
<td>
<p>Altitude (length nrow x)</p>
</td></tr>
<tr><td><code id="emis_china_+3A_yeardet">yeardet</code></td>
<td>
<p>Year, default 2016</p>
</td></tr>
<tr><td><code id="emis_china_+3A_p">p</code></td>
<td>
<p>Character; pollutant: &quot;CO&quot;, &quot;NOx&quot;,&quot;HC&quot;, &quot;PM&quot;, &quot;Evaporative_driving&quot;
or &quot;Evaporative_parking&quot;</p>
</td></tr>
<tr><td><code id="emis_china_+3A_verbose">verbose</code></td>
<td>
<p>Logical to show more info</p>
</td></tr>
<tr><td><code id="emis_china_+3A_array">array</code></td>
<td>
<p>Logical to return EmissionsArray or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_long">emis_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
ef_china_h(h = 1600, p = "CO")
}
</code></pre>

<hr>
<h2 id='emis_cold'>Estimation of cold start emissions hourly for the of the week</h2><span id='topic+emis_cold'></span>

<h3>Description</h3>

<p><code>emis_cold</code> emissions are estimated as the product of the
vehicles on a road, length of the road, emission factor evaluated at the
respective speed. The estimation considers the beta parameter, the fraction of
mileage driven
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_cold(
  veh,
  lkm,
  ef,
  efcold,
  beta,
  speed = 34,
  agemax = if (!inherits(x = veh, what = "list")) {
     ncol(veh)
 } else {
    
    ncol(veh[[1]])
 },
  profile,
  simplify = FALSE,
  hour = nrow(profile),
  day = ncol(profile),
  array = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_cold_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that type of vehicle.
The number of rows is equal to the number of streets link</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_ef">ef</code></td>
<td>
<p>List of functions of emission factors of vehicular categories</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_efcold">efcold</code></td>
<td>
<p>List of functions of cold start emission factors of vehicular categories</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_beta">beta</code></td>
<td>
<p>Dataframe with the hourly cold-start distribution to each day
of the period. Number of rows are hours and columns are days</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_speed">speed</code></td>
<td>
<p>Speed data-frame with number of columns as hours</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_agemax">agemax</code></td>
<td>
<p>Age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_profile">profile</code></td>
<td>
<p>Numerical or dataframe with nrows equal to 24 and ncol 7 day
of the week</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_simplify">simplify</code></td>
<td>
<p>Logical; to determine if EmissionsArray should les dimensions,
being streets, vehicle categories and hours or default (streets, vehicle
categories, hours and days). Default is FALSE to avoid break old code, but
the recommendation is that new estimations use this parameter as TRUE</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_hour">hour</code></td>
<td>
<p>Number of considered hours in estimation</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_day">day</code></td>
<td>
<p>Number of considered days in estimation</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_array">array</code></td>
<td>
<p>Deprecated! <code><a href="#topic+emis_cold">emis_cold</a></code> returns only arrays.
When TRUE and veh is not a list, expects a profile as a dataframe producing
an array with dimensions (streets x columns x hours x days)</p>
</td></tr>
<tr><td><code id="emis_cold_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EmissionsArray  g/h
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
data(pc_cold)
pcf &lt;- as.data.frame(cbind(pc_cold,pc_cold,pc_cold,pc_cold,pc_cold,pc_cold,
pc_cold))
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::set_units(fkm[[1]](1:24), "km"); pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(co1, cod, v = "PC", cc = "&lt;=1400",
                     f = "G",p = "CO", eu=co1$Euro_LDV)
# Mohtly average temperature 18 Celcius degrees
lefec &lt;- ef_ldv_cold_list(df = co1, ta = 18, cc = "&lt;=1400", f = "G",
                          eu = co1$Euro_LDV, p = "CO" )
lefec &lt;- c(lefec,lefec[length(lefec)], lefec[length(lefec)],
           lefec[length(lefec)], lefec[length(lefec)],
           lefec[length(lefec)])
length(lefec) == ncol(pc1)
#emis change length of 'ef' to match ncol of 'veh'
class(lefec)
PC_CO_COLD &lt;- emis_cold(veh = pc1,
                        lkm = net$lkm,
                        ef = lef,
                        efcold = lefec,
                        beta = pcf,
                        speed = speed,
                        profile = pc_profile)
class(PC_CO_COLD)
plot(PC_CO_COLD)
lpc &lt;- list(pc1, pc1)
PC_CO_COLDv2 &lt;- emis_cold(veh = pc1,
                          lkm = net$lkm,
                          ef = lef,
                          efcold = lefec,
                          beta = pcf,
                          speed = speed,
                          profile = pc_profile,
                          hour = 2,
                          day = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_cold_td'>Estimation of cold start emissions with top-down approach</h2><span id='topic+emis_cold_td'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_cold_td">emis_cold_td</a></code> estimates cld start emissions with
a top-down appraoch. This is, annual or monthly emissions or region.
Especifically, the emissions are esitmated for row of the simple feature (row
of the spatial feature).
</p>
<p>In general was designed so that each simple feature is a region with
different average monthly temperature.
This funcion, as other in this package, adapts to the class of the input data.
providing flexibility to the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_cold_td(
  veh,
  lkm,
  ef,
  efcold,
  beta,
  pro_month,
  params,
  verbose = FALSE,
  fortran = FALSE,
  nt = ifelse(check_nt() == 1, 1, check_nt()/2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_cold_td_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or spatial feature, wwhere columns are the
age distribution of that vehicle. and rows each simple feature or region.
The number of rows is equal to the number of streets link</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_lkm">lkm</code></td>
<td>
<p>Numeric; mileage by the age of use of each vehicle.</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_ef">ef</code></td>
<td>
<p>Numeric; emission factor with</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_efcold">efcold</code></td>
<td>
<p>Data.frame. When it is a data.frame, each column is for each
type of vehicle by age of use, rows are are each simple feature. When you have
emission factors for each month, the order should a data.frame ina long format,
as rurned by <code><a href="#topic+ef_ldv_cold">ef_ldv_cold</a></code>.</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_beta">beta</code></td>
<td>
<p>Data.frame with the fraction of cold starts. The rows are the fraction
for each spatial feature or subregion, the columns are the age of use of vehicle.</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_pro_month">pro_month</code></td>
<td>
<p>Numeric; montly profile to distribuite annual mileage in each month.</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_params">params</code></td>
<td>
<p>List of parameters; Add columns with information to returning data.frame</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_fortran">fortran</code></td>
<td>
<p>Logical; to try the fortran calculation.</p>
</td></tr>
<tr><td><code id="emis_cold_td_+3A_nt">nt</code></td>
<td>
<p>Integer; Number of threads wich must be lower than max available.
See <code><a href="#topic+check_nt">check_nt</a></code>. Only when fortran = TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Emissions data.frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_ldv_cold">ef_ldv_cold</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
veh &lt;- age_ldv(1:10, agemax = 8)
euros &lt;- c("V", "V", "IV", "III", "II", "I", "PRE", "PRE")
dt &lt;- matrix(rep(2:25, 5), ncol = 12, nrow = 10) # 12 months, 10 rows
row.names(dt) &lt;- paste0("Simple_Feature_", 1:10)
efc &lt;- ef_ldv_cold(ta = dt, cc = "&lt;=1400", f = "G", eu = euros, p = "CO", speed = Speed(34))
efh &lt;- ef_ldv_speed(
  v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
  eu = euros, p = "CO", speed = Speed(runif(nrow(veh), 15, 40))
)
lkm &lt;- units::as_units(18:11, "km") * 1000
cold_lkm &lt;- cold_mileage(ltrip = units::as_units(20, "km"), ta = celsius(dt))
names(cold_lkm) &lt;- paste0("Month_", 1:12)
veh_month &lt;- c(rep(8, 1), rep(10, 5), 9, rep(10, 5))
system.time(
  a &lt;- emis_cold_td(
    veh = veh,
    lkm = lkm,
    ef = efh[1, ],
    efcold = efc[1:10, ],
    beta = cold_lkm[, 1],
    verbose = TRUE
  )
)
system.time(
  a2 &lt;- emis_cold_td(
    veh = veh,
    lkm = lkm,
    ef = efh[1, ],
    efcold = efc[1:10, ],
    beta = cold_lkm[, 1],
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd2coldf.f95
a$emissions &lt;- round(a$emissions, 8)
a2$emissions &lt;- round(a2$emissions, 8)
identical(a, a2)

# Adding parameters
emis_cold_td(
  veh = veh,
  lkm = lkm,
  ef = efh[1, ],
  efcold = efc[1:10, ],
  beta = cold_lkm[, 1],
  verbose = TRUE,
  params = list(
    paste0("data_", 1:10),
    "moredata"
  )
)
system.time(
  aa &lt;- emis_cold_td(
    veh = veh,
    lkm = lkm,
    ef = efh,
    efcold = efc,
    beta = cold_lkm,
    pro_month = veh_month,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_cold_td(
    veh = veh,
    lkm = lkm,
    ef = efh,
    efcold = efc,
    beta = cold_lkm,
    pro_month = veh_month,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd5coldf.f95
aa$emissions &lt;- round(aa$emissions, 8)
aa2$emissions &lt;- round(aa2$emissions, 8)
identical(aa, aa2)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_det'>Determine deterioration factors for urban conditions</h2><span id='topic+emis_det'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_det">emis_det</a></code> returns deterioration factors. The emission
factors comes from the guidelines for developing emission factors of the
EMEP/EEA air pollutant emission inventory guidebook
http://www.eea.europa.eu/themes/air/emep-eea-air-pollutant-emission-inventory-guidebook
This function subset an internal database of emission factors with each argument
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_det(
  po,
  cc,
  eu,
  speed = Speed(18.9),
  km,
  verbose = FALSE,
  show.equation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_det_+3A_po">po</code></td>
<td>
<p>Character; Pollutant &quot;CO&quot;, &quot;NOx&quot; or &quot;HC&quot;</p>
</td></tr>
<tr><td><code id="emis_det_+3A_cc">cc</code></td>
<td>
<p>Character; Size of engine in cc covering &quot;&lt;=1400&quot;, &quot;1400_2000&quot; or &quot;&gt;2000&quot;</p>
</td></tr>
<tr><td><code id="emis_det_+3A_eu">eu</code></td>
<td>
<p>Character; Euro standard:  &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;, &quot;VI&quot;, &quot;VIc&quot;</p>
</td></tr>
<tr><td><code id="emis_det_+3A_speed">speed</code></td>
<td>
<p>Numeric; Speed to return Number of emission factor and not a function.
It needs units in km/h</p>
</td></tr>
<tr><td><code id="emis_det_+3A_km">km</code></td>
<td>
<p>Numeric; accumulated mileage in km.</p>
</td></tr>
<tr><td><code id="emis_det_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
<tr><td><code id="emis_det_+3A_show.equation">show.equation</code></td>
<td>
<p>Option to see or not the equation parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a numeric vector representing the increase in emissions due to normal deterioring
</p>


<h3>Note</h3>

<p>The deterioration factors functions are available for technologies
euro &quot;II&quot;, &quot;III&quot; and &quot;IV&quot;. In order to cover all euro technologies, this
function assumes that the deterioration function of &quot;III&quot; and &quot;IV&quot; applies
for &quot;V&quot;, &quot;VI&quot; and &quot;VIc&quot;. However, as these technologies are relative
new,  accumulated milage is low and hence, deteerioration factors small.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(fkm)
pckm &lt;- fkm[[1]](1:24); pckma &lt;- cumsum(pckm)
km &lt;- units::set_units(pckma[1:11], km)
# length eu = length km = 1
emis_det(po = "CO", cc = "&lt;=1400", eu = "III", km = km[5], show.equation = TRUE)
# length eu = length km = 1, length speed &gt; 1
emis_det(po = "CO", cc = "&lt;=1400", eu = "III", km = km[5], speed = Speed(1:10))
# length km != length eu error
# (cod1 &lt;- emis_det(po = "CO", cc = "&lt;=1400", eu = c("III", "IV"), speed = Speed(30),
# km = km[4]))
# length eu = 1 length km &gt; 1
emis_det(po = "CO", cc = "&lt;=1400", eu = "III", km = km)
# length eu = 2, length km = 2 (if different length, error!)
(cod1 &lt;- emis_det(po = "CO", cc = "&lt;=1400", eu = c("III", "IV"), km = km[4:5]))
# length eu = 2, length km = 2, length speed &gt; 1
(cod1 &lt;- emis_det(po = "CO", cc = "&lt;=1400", eu = c("III", "IV"), speed = Speed(0:130),
km = km[4:5]))
euros &lt;- c("V","V","V", "IV", "IV", "IV", "III", "III", "III", "III")
# length eu = 2, length km = 2, length speed &gt; 1
(cod1 &lt;- emis_det(po = "CO", cc = "&lt;=1400", eu = euros, speed = Speed(1:100),
km = km[1:10]))
cod1 &lt;- as.matrix(cod1[, 1:11])
filled.contour(cod1, col = cptcity::cpt(6277, n = 20))
filled.contour(cod1, col = cptcity::lucky(n = 19))
euro &lt;- c(rep("V", 5), rep("IV", 5), "III")
euros &lt;- rbind(euro, euro)
(cod1 &lt;- emis_det(po = "CO", cc = "&lt;=1400", eu = euros, km = km))

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_dist'>Allocate emissions into spatial objects (street emis to grid)</h2><span id='topic+emis_dist'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_dist">emis_dist</a></code> allocates emissions proportionally to
each feature. &quot;Spatial&quot; objects are converter to &quot;sf&quot; objects. Currently,
'LINESTRING' or 'MULTILINESTRING' supported. The emissions are distributed
in each street.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_dist(gy, spobj, pro, osm, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_dist_+3A_gy">gy</code></td>
<td>
<p>Numeric; a unique total (top-down)</p>
</td></tr>
<tr><td><code id="emis_dist_+3A_spobj">spobj</code></td>
<td>
<p>A spatial dataframe of class &quot;sp&quot; or &quot;sf&quot;. When class is &quot;sp&quot;
it is transformed to &quot;sf&quot;.</p>
</td></tr>
<tr><td><code id="emis_dist_+3A_pro">pro</code></td>
<td>
<p>Matrix or data-frame profiles, for instance, pc_profile.</p>
</td></tr>
<tr><td><code id="emis_dist_+3A_osm">osm</code></td>
<td>
<p>Numeric; vector of length 5, for instance, c(5, 3, 2, 1, 1).
The first element covers 'motorway' and 'motorway_link.
The second element covers 'trunk' and 'trunk_link'.
The third element covers 'primary' and 'primary_link'.
The fourth element covers 'secondary' and 'secondary_link'.
The fifth element covers 'tertiary' and 'tertiary_link'.</p>
</td></tr>
<tr><td><code id="emis_dist_+3A_verbose">verbose</code></td>
<td>
<p>Logical; to show more info.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When spobj is a 'Spatial' object (class of sp), they are converted
into 'sf'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
po &lt;- 1000
t1 &lt;- emis_dist(gy = po, spobj = net)
head(t1)
sum(t1$gy)
#t1 &lt;- emis_dist(gy = po, spobj = net, osm = c(5, 3, 2, 1, 1) )
t1 &lt;- emis_dist(gy = po, spobj = net, pro = pc_profile)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_emfac'>Emission calculation based on EMFAC emission factors</h2><span id='topic+emis_emfac'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_emfac">emis_emfac</a></code> estimates emissions based on
an emission factors database from EMFAC.You must download the
emission factors from EMFAC website.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_emfac(
  ef,
  veh,
  lkm,
  speed,
  vehname,
  pol = "CO_RUNEX",
  modelyear = 2021:1982,
  noyear = 2022,
  hours = paste0("S", 1:24),
  vkm = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_emfac_+3A_ef">ef</code></td>
<td>
<p>Character path to EMFAC ef (g/miles)</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_veh">veh</code></td>
<td>
<p>Vehicles data.frame</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_lkm">lkm</code></td>
<td>
<p>Distance per street-link in miles</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_speed">speed</code></td>
<td>
<p>Speed data.frame in niles/hour</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_vehname">vehname</code></td>
<td>
<p>numeric vector for heavy good vehicles or trucks</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_pol">pol</code></td>
<td>
<p>character, &quot;CO_RUNEX&quot;</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_modelyear">modelyear</code></td>
<td>
<p>numeric vector, 2021:1982</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_noyear">noyear</code></td>
<td>
<p>newest numeric year to take out from ef</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_hours">hours</code></td>
<td>
<p>Character, name of hours in speed, paste0(&quot;S&quot;, 1:24) data-frame profile for passenger cars, 24 hours only.</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_vkm">vkm</code></td>
<td>
<p>logical, to return vkm</p>
</td></tr>
<tr><td><code id="emis_emfac_+3A_verbose">verbose</code></td>
<td>
<p>logical, to show more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table with emission estimation in long format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# do not run

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_evap'>Estimation of evaporative emissions</h2><span id='topic+emis_evap'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_evap">emis_evap</a></code> estimates evaporative emissions from
EMEP/EEA emisison guidelines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_evap(
  veh,
  x,
  ed,
  hotfi,
  hotc,
  warmc,
  carb = 0,
  p,
  params,
  pro_month,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_evap_+3A_veh">veh</code></td>
<td>
<p>Numeric or data.frame of Vehicles with untis 'veh'.</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_x">x</code></td>
<td>
<p>Numeric which can be either, daily mileage by age of use
with units 'lkm', number of trips or number of proc. When it
has units 'lkm', all the emission factors must be in 'g/km'.
When ed is in g/day, x it is the number of days (without units).
When hotfi, hotc or warmc are in g/trip, x it is the number of trips (without units).
When hotfi, hotc or warmc are in g/proced, x it is the number of proced (without units).</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_ed">ed</code></td>
<td>
<p>average daily evaporative emissions. If x has units 'lkm', the units
of ed must be 'g/km', other case, this are simply g/day (without units).</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_hotfi">hotfi</code></td>
<td>
<p>average hot running losses or soak evaporative factor
for vehicles with fuel injection and returnless fuel systems.
If x has units 'lkm', the units of ed must be 'g/km',
other case, this is simply g/trip or g/proced</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_hotc">hotc</code></td>
<td>
<p>average running losses or soak evaporative factor for vehicles with
carburetor or fuel return system
for vehicles with fuel injection and returnless fuel systems.
If x has units 'lkm', the units of ed must be 'g/km',</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_warmc">warmc</code></td>
<td>
<p>average cold and warm running losses or soak evaporative factor
for vehicles with carburetor or fuel return system
for vehicles with fuel injection and returnless fuel systems.
If x has units 'lkm', the units of ed must be 'g/km',</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_carb">carb</code></td>
<td>
<p>fraction of gasoline vehicles with carburetor or fuel return system.</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_p">p</code></td>
<td>
<p>Fraction of trips finished with hot engine</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_params">params</code></td>
<td>
<p>Character; Add columns with information to returning data.frame</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_pro_month">pro_month</code></td>
<td>
<p>Numeric; monthly profile to distribute annual mileage in each month.</p>
</td></tr>
<tr><td><code id="emis_evap_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of emission estimation in grams
</p>


<h3>Note</h3>

<p>When veh is a &quot;Vehicles&quot; data.frame, emission factors are evaluated till the
number of columns of veh. For instance, if the length of the emission factor is 20
but the number of columns of veh is 10, the 10 first emission factors are used.
</p>


<h3>References</h3>

<p>Mellios G and Ntziachristos 2016. Gasoline evaporation. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2009
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_evap">ef_evap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
(a &lt;- Vehicles(1:10))
(lkm &lt;- units::as_units(1:10, "km"))
(ef &lt;- EmissionFactors(1:10))
(ev &lt;- emis_evap(veh = a, x = lkm, hotfi = ef))

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_evap2'>Estimation of evaporative emissions 2</h2><span id='topic+emis_evap2'></span>

<h3>Description</h3>

<p><code>emis_evap</code> performs the estimation of evaporative emissions
from EMEP/EEA emission guidelines with Tier 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_evap2(
  veh,
  name,
  size,
  fuel,
  aged,
  nd4,
  nd3,
  nd2,
  nd1,
  hs_nd4,
  hs_nd3,
  hs_nd2,
  hs_nd1,
  rl_nd4,
  rl_nd3,
  rl_nd2,
  rl_nd1,
  d_nd4,
  d_nd3,
  d_nd2,
  d_nd1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_evap2_+3A_veh">veh</code></td>
<td>
<p>Total number of vehicles by age of use. If is a list of 'Vehicles'
data-frames, it will sum the columns of the eight element of the list
representing the 8th hour. It was chosen this hour because it is morning rush
hour but the user can adapt the data to this function</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_name">name</code></td>
<td>
<p>Character of type of vehicle</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_size">size</code></td>
<td>
<p>Character of size of vehicle</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_fuel">fuel</code></td>
<td>
<p>Character of fuel of vehicle</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_aged">aged</code></td>
<td>
<p>Age distribution vector. E.g.: 1:40</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_nd4">nd4</code></td>
<td>
<p>Number of days with temperature between 20 and 35 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_nd3">nd3</code></td>
<td>
<p>Number of days with temperature between 10 and 25 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_nd2">nd2</code></td>
<td>
<p>Number of days with temperature between 0 and 15 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_nd1">nd1</code></td>
<td>
<p>Number of days with temperature between -5 and 10 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_hs_nd4">hs_nd4</code></td>
<td>
<p>average daily hot-soak evaporative emissions for days with
temperature between 20 and 35 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_hs_nd3">hs_nd3</code></td>
<td>
<p>average daily hot-soak evaporative emissions for days with
temperature between 10 and 25 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_hs_nd2">hs_nd2</code></td>
<td>
<p>average daily hot-soak evaporative emissions for days with
temperature between 0 and 15 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_hs_nd1">hs_nd1</code></td>
<td>
<p>average daily hot-soak evaporative emissions for days with
temperature between -5 and 10 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_rl_nd4">rl_nd4</code></td>
<td>
<p>average daily running losses evaporative emissions for days with
temperature between 20 and 35 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_rl_nd3">rl_nd3</code></td>
<td>
<p>average daily running losses evaporative emissions for days with
temperature between 10 and 25 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_rl_nd2">rl_nd2</code></td>
<td>
<p>average daily running losses evaporative emissions for days with
temperature between 0 and 15 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_rl_nd1">rl_nd1</code></td>
<td>
<p>average daily running losses evaporative emissions for days with
temperature between -5 and 10 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_d_nd4">d_nd4</code></td>
<td>
<p>average daily diurnal evaporative emissions for days with
temperature between 20 and 35 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_d_nd3">d_nd3</code></td>
<td>
<p>average daily diurnal evaporative emissions for days with
temperature between 10 and 25 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_d_nd2">d_nd2</code></td>
<td>
<p>average daily diurnal evaporative emissions for days with
temperature between 0 and 15 Celsius degrees</p>
</td></tr>
<tr><td><code id="emis_evap2_+3A_d_nd1">d_nd1</code></td>
<td>
<p>average daily diurnal evaporative emissions for days with
temperature between -5 and 10 Celsius degrees</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of emission estimation in grams/days
</p>


<h3>References</h3>

<p>Mellios G and Ntziachristos 2016. Gasoline evaporation. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
ef1 &lt;- ef_evap(ef = "erhotc",v = "PC", cc = "&lt;=1400", dt = "0_15", ca = "no")
dfe &lt;- emis_evap2(veh = pc1,
                 name = "PC",
                 size = "&lt;=1400",
                 fuel = "G",
                 aged = 1:ncol(pc1),
                 nd4 = 10,
                 nd3 = 4,
                 nd2 = 2,
                 nd1 = 1,
                 hs_nd4 = ef1*1:ncol(pc1),
                 hs_nd3 = ef1*1:ncol(pc1),
                 hs_nd2 = ef1*1:ncol(pc1),
                 hs_nd1 = ef1*1:ncol(pc1),
                 d_nd4 = ef1*1:ncol(pc1),
                 d_nd3 = ef1*1:ncol(pc1),
                 d_nd2 = ef1*1:ncol(pc1),
                 d_nd1 = ef1*1:ncol(pc1),
                 rl_nd4 = ef1*1:ncol(pc1),
                 rl_nd3 = ef1*1:ncol(pc1),
                 rl_nd2 = ef1*1:ncol(pc1),
                 rl_nd1 = ef1*1:ncol(pc1))
lpc &lt;- list(pc1, pc1, pc1, pc1,
            pc1, pc1, pc1, pc1)
dfe &lt;- emis_evap2(veh = lpc,
                 name = "PC",
                 size = "&lt;=1400",
                 fuel = "G",
                 aged = 1:ncol(pc1),
                 nd4 = 10,
                 nd3 = 4,
                 nd2 = 2,
                 nd1 = 1,
                 hs_nd4 = ef1*1:ncol(pc1),
                 hs_nd3 = ef1*1:ncol(pc1),
                 hs_nd2 = ef1*1:ncol(pc1),
                 hs_nd1 = ef1*1:ncol(pc1),
                 d_nd4 = ef1*1:ncol(pc1),
                 d_nd3 = ef1*1:ncol(pc1),
                 d_nd2 = ef1*1:ncol(pc1),
                 d_nd1 = ef1*1:ncol(pc1),
                 rl_nd4 = ef1*1:ncol(pc1),
                 rl_nd3 = ef1*1:ncol(pc1),
                 rl_nd2 = ef1*1:ncol(pc1),
                 rl_nd1 = ef1*1:ncol(pc1))

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_grid'>Allocate emissions into a grid returning point emissions or flux</h2><span id='topic+emis_grid'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_grid">emis_grid</a></code> allocates emissions proportionally to each grid
cell. The process is performed by the intersection between geometries and the grid.
It means that requires &quot;sr&quot; according to your location for the projection.
It is assumed that spobj is a Spatial*DataFrame or an &quot;sf&quot; with the pollutants
in data. This function returns an object of class &quot;sf&quot;.
</p>
<p>It is
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_grid(spobj = net, g, sr, type = "lines", FN = "sum", flux = TRUE, k = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_grid_+3A_spobj">spobj</code></td>
<td>
<p>A spatial dataframe of class &quot;sp&quot; or &quot;sf&quot;. When class is &quot;sp&quot;
it is transformed to &quot;sf&quot;.</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_g">g</code></td>
<td>
<p>A grid with class &quot;SpatialPolygonsDataFrame&quot; or &quot;sf&quot;.</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_sr">sr</code></td>
<td>
<p>Spatial reference e.g: 31983. It is required if spobj and g are
not projected. Please, see http://spatialreference.org/.</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_type">type</code></td>
<td>
<p>type of geometry: &quot;lines&quot;, &quot;points&quot; or &quot;polygons&quot;.</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_fn">FN</code></td>
<td>
<p>Character indicating the function. Default is &quot;sum&quot;</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_flux">flux</code></td>
<td>
<p>Logical, if TRUE, it return flux (mass / area / time (implicit))
in a polygon grid, if false,  mass / time (implicit) as points, in a similar fashion
as EDGAR provide data.</p>
</td></tr>
<tr><td><code id="emis_grid_+3A_k">k</code></td>
<td>
<p>Numeric to multiply emissions</p>
</td></tr>
</table>


<h3>Note</h3>

<p><strong>1) If flux = TRUE (default), emissions are flux = mass / area / time (implicit), as polygons.</strong>
<strong>If flux = FALSE, emissions are mass / time (implicit), as points.</strong>
<strong>Time untis are not displayed because each use can have different time units</strong>
<strong>for instance, year, month, hour second, etc.</strong>
</p>
<p><strong>2) Therefore, it is good practice to have time units in 'spobj'. </strong>
<strong>This implies that spobj MUST include units!. </strong>
</p>
<p><strong>3) In order to check the sum of the emissions, you must calculate the grid-area</strong>
<strong>in km^2 and multiply by each column of the resulting emissions grid, and then sum.</strong>
</p>
<p><strong>4) If FN = &quot;sum&quot;, is mass conservative!. </strong>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
g &lt;- make_grid(net, 1/102.47/2) #500m in degrees
names(net)
netsf &lt;- sf::st_as_sf(net)
netg &lt;- emis_grid(spobj = netsf[, c("ldv", "hdv")], g = g, sr= 31983)
plot(netg["ldv"],
     axes = TRUE,
     graticule = TRUE,
     bg = "black",
     lty = 0)
g &lt;- sf::st_make_grid(net, 1/102.47/2, square = FALSE) #500m in degrees
g &lt;- st_sf(i  =1, geometry = g)
netg &lt;- emis_grid(spobj = netsf[, c("ldv", "hdv")], g = g, sr= 31983)
plot(netg["ldv"],
     axes = TRUE,
     graticule = TRUE,
     bg = "black",
     lty = 0)
plot(netg["hdv"], axes = TRUE)
netg &lt;- emis_grid(spobj = netsf[, c("ldv", "hdv")], g = g, sr= 31983, FN = "mean")
plot(netg["ldv"], axes = TRUE)
plot(netg["hdv"], axes = TRUE)
netg &lt;- emis_grid(spobj = netsf[, c("ldv", "hdv")], g = g, sr= 31983, flux = FALSE)
plot(netg["ldv"],
     axes = TRUE,
     pch = 16,
     pal = cptcity::cpt(colorRampPalette= TRUE,
                        rev = TRUE),
     cex = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_hot_td'>Estimation of hot exhaust emissions with a top-down approach</h2><span id='topic+emis_hot_td'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_hot_td">emis_hot_td</a></code> estimates cold start emissions with
a top-down appraoch. This is, annual or monthly emissions or region.
Especifically, the emissions are estimated for the row of the simple feature (row
of the spatial feature).
</p>
<p>In general was designed so that each simple feature is a region with
different average monthly temperature.
This function, as others in this package, adapts to the class of the input data.
providing flexibility to the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_hot_td(
  veh,
  lkm,
  ef,
  pro_month,
  params,
  verbose = FALSE,
  fortran = FALSE,
  nt = ifelse(check_nt() == 1, 1, check_nt()/2)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_hot_td_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or spatial feature, where columns are the
age distribution of that vehicle. and rows each simple feature or region.</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_lkm">lkm</code></td>
<td>
<p>Numeric; mileage by the age of use of each vehicle.</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_ef">ef</code></td>
<td>
<p>Numeric or data.frame; emission factors. When it is a data.frame
number of rows can be for each region, or also, each region repeated
along 12 months. For instance, if you have 10 regions the number
of rows of ef can also be 120 (10 * 120).
when you have emission factors that varies with month, see <code><a href="#topic+ef_china">ef_china</a></code>.</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_pro_month">pro_month</code></td>
<td>
<p>Numeric or data.frame; monthly profile to distribute annual mileage
in each month. When it is a data.frame, each region (row) can have a different
monthly profile.</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_params">params</code></td>
<td>
<p>List of parameters; Add columns with information to returning data.frame</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_fortran">fortran</code></td>
<td>
<p>Logical; to try the fortran calculation.</p>
</td></tr>
<tr><td><code id="emis_hot_td_+3A_nt">nt</code></td>
<td>
<p>Integer; Number of threads which must be lower than max available. See <code><a href="#topic+check_nt">check_nt</a></code>.
Only when fortran = TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>List  to make easier to use this function.
</p>

<ol>
<li><p>'pro_month' is data.frame AND rows of 'ef' and 'veh' are equal.
</p>
</li>
<li><p>'pro_month' is numeric AND rows of 'ef' and 'veh' are equal.
</p>
</li>
<li><p>'pro_month' is data.frame AND rows of 'ef' is 12X rows of 'veh'.
</p>
</li>
<li><p>'pro_month' is numeric AND rows of 'ef' is 12X rows of 'veh'.
</p>
</li>
<li><p>&lsquo;pro_month' is data,frame AND class of 'ef' is &rsquo;units'.
</p>
</li>
<li><p>&lsquo;pro_month' is numeric AND class of 'ef' is &rsquo;units'.
</p>
</li>
<li><p>NO &lsquo;pro_month' AND class of 'ef' is &rsquo;units'.
</p>
</li>
<li><p>NO 'pro_month' AND 'ef' is data.frame.
</p>
</li>
<li><p>'pro_month' is numeric AND rows of 'ef' is 12 (monthly 'ef').
</p>
</li></ol>



<h3>Value</h3>

<p>Emissions data.frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code> <code><a href="#topic+ef_china">ef_china</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
euros &lt;- c("V", "V", "IV", "III", "II", "I", "PRE", "PRE")
efh &lt;- ef_ldv_speed(
  v = "PC", t = "4S", cc = "&lt;=1400", f = "G",
  eu = euros, p = "CO", speed = Speed(34)
)
lkm &lt;- units::as_units(c(20:13), "km") * 1000
veh &lt;- age_ldv(1:10, agemax = 8)
system.time(
  a &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    verbose = TRUE
  )
)
system.time(
  a2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd7f.f95
identical(a, a2)

# adding columns
emis_hot_td(
  veh = veh,
  lkm = lkm,
  ef = EmissionFactors(as.numeric(efh[, 1:8])),
  verbose = TRUE,
  params = list(paste0("data_", 1:10), "moredata")
)

# monthly profile (numeric) with numeric ef
veh_month &lt;- c(rep(8, 1), rep(10, 5), 9, rep(10, 5))
system.time(
  aa &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    pro_month = veh_month,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    pro_month = veh_month,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd5f.f95
aa$emissions &lt;- round(aa$emissions, 8)
aa2$emissions &lt;- round(aa2$emissions, 8)
identical(aa, aa2)

# monthly profile (numeric) with data.frame ef
veh_month &lt;- c(rep(8, 1), rep(10, 5), 9, rep(10, 5))
def &lt;- matrix(EmissionFactors(as.numeric(efh[, 1:8])),
  nrow = nrow(veh), ncol = ncol(veh), byrow = TRUE
)
def &lt;- EmissionFactors(def)
system.time(
  aa &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = def,
    pro_month = veh_month,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = def,
    pro_month = veh_month,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd1f.f95
aa$emissions &lt;- round(aa$emissions, 8)
aa2$emissions &lt;- round(aa2$emissions, 8)
identical(aa, aa2)

# monthly profile (data.frame)
dfm &lt;- matrix(c(rep(8, 1), rep(10, 5), 9, rep(10, 5)),
  nrow = 10, ncol = 12,
  byrow = TRUE
)
system.time(
  aa &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    pro_month = dfm,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = EmissionFactors(as.numeric(efh[, 1:8])),
    pro_month = dfm,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd6f.f95
aa$emissions &lt;- round(aa$emissions, 2)
aa2$emissions &lt;- round(aa2$emissions, 2)
identical(aa, aa2)

# Suppose that we have a EmissionsFactor data.frame with number of rows for each month
# number of rows are 10 regions
# number of columns are 12 months
tem &lt;- runif(n = 6 * 10, min = -10, max = 35)
temp &lt;- c(rev(tem[order(tem)]), tem[order(tem)])
plot(temp)
dftemp &lt;- celsius(matrix(temp, ncol = 12))
dfef &lt;- ef_evap(
  ef = c(rep("eshotfi", 8)),
  v = "PC",
  cc = "&lt;=1400",
  dt = dftemp,
  show = F,
  ca = "small",
  ltrip = units::set_units(10, km),
  pollutant = "NMHC"
)
dim(dfef) # 120 rows and 9 columns, 8 ef (g/km) and 1 for month
system.time(
  aa &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = dfef,
    pro_month = veh_month,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = dfef,
    pro_month = veh_month,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd3f.f95
aa$emissions &lt;- round(aa$emissions, 2)
aa2$emissions &lt;- round(aa2$emissions, 2)
identical(aa, aa2)
plot(aggregate(aa$emissions, by = list(aa$month), sum)$x)

# Suppose that we have a EmissionsFactor data.frame with number of rows for each month
# monthly profile (data.frame)
system.time(
  aa &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = dfef,
    pro_month = dfm,
    verbose = TRUE
  )
)
system.time(
  aa2 &lt;- emis_hot_td(
    veh = veh,
    lkm = lkm,
    ef = dfef,
    pro_month = dfm,
    verbose = TRUE,
    fortran = TRUE
  )
) # emistd4f.f95
aa$emissions &lt;- round(aa$emissions, 8)
aa2$emissions &lt;- round(aa2$emissions, 8)
identical(aa, aa2)
plot(aggregate(aa$emissions, by = list(aa$month), sum)$x)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_long'>Estimation with long format</h2><span id='topic+emis_long'></span>

<h3>Description</h3>

<p>Emissions estimates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_long(x, lkm, ef, tfs, speed, verbose = TRUE, array = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_long_+3A_x">x</code></td>
<td>
<p>Vehicles data.frame. x repeats down for each hour</p>
</td></tr>
<tr><td><code id="emis_long_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in km. lkm repeats down for each hour</p>
</td></tr>
<tr><td><code id="emis_long_+3A_ef">ef</code></td>
<td>
<p>data.frame. ef repeats down for each hour</p>
</td></tr>
<tr><td><code id="emis_long_+3A_tfs">tfs</code></td>
<td>
<p>temporal factor</p>
</td></tr>
<tr><td><code id="emis_long_+3A_speed">speed</code></td>
<td>
<p>Speed data.frame (nrow x)</p>
</td></tr>
<tr><td><code id="emis_long_+3A_verbose">verbose</code></td>
<td>
<p>Logical to show more info</p>
</td></tr>
<tr><td><code id="emis_long_+3A_array">array</code></td>
<td>
<p>Logical to return EmissionsArray or not</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame
</p>


<h3>See Also</h3>

<p>Other China: 
<code><a href="#topic+ef_china_det">ef_china_det</a>()</code>,
<code><a href="#topic+ef_china_hu">ef_china_hu</a>()</code>,
<code><a href="#topic+ef_china_h">ef_china_h</a>()</code>,
<code><a href="#topic+ef_china_long">ef_china_long</a>()</code>,
<code><a href="#topic+ef_china_speed">ef_china_speed</a>()</code>,
<code><a href="#topic+ef_china_s">ef_china_s</a>()</code>,
<code><a href="#topic+ef_china_te">ef_china_te</a>()</code>,
<code><a href="#topic+ef_china_th">ef_china_th</a>()</code>,
<code><a href="#topic+ef_china">ef_china</a>()</code>,
<code><a href="#topic+emis_china">emis_china</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
net &lt;- net[1:100, ]
data(pc_profile)
x &lt;- age_ldv(net$ldv)
pc_week &lt;- temp_fact(net$ldv+net$hdv, pc_profile[[1]])
df &lt;- netspeed(pc_week,
               net$ps,
               net$ffs,
               net$capacity,
               net$lkm,
               alpha = 1)

s  &lt;- do.call("rbind",lapply(1:ncol(df), function(i) {
 as.data.frame(replicate(ncol(x), df[, i]))
}))

ef &lt;- ef_wear(wear = "tyre",
              type = "PC",
              pol = "PM10",
              speed = as.data.frame(s))

e &lt;- emis_long(x = x,
               lkm = net$lkm,
               ef = ef,
               tfs = pc_profile[[1]],
               speed = df)

ae &lt;- emis_long(x = x,
               lkm = net$lkm,
               ef = ef,
               tfs = pc_profile[[1]],
               speed = df,
               array = TRUE)
}
</code></pre>

<hr>
<h2 id='emis_merge'>Merge several emissions files returning data-frames or 'sf' of lines</h2><span id='topic+emis_merge'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_merge">emis_merge</a></code> reads rds files and returns a data-frame
or an object of 'spatial feature' of streets, merging several files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_merge(
  pol = "CO",
  what = "STREETS.rds",
  streets = T,
  net,
  FN = "sum",
  ignore,
  path = "emi",
  crs,
  under = "after",
  as_list = FALSE,
  k = 1,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_merge_+3A_pol">pol</code></td>
<td>
<p>Character. Pollutant.</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_what">what</code></td>
<td>
<p>Character. Word to search the emissions names, &quot;STREETS&quot;, &quot;DF&quot; or
whatever name. It is important to include the extension .'rds'. For instance,
If you have several files &quot;XX_CO_STREETS.rds&quot;, what should be &quot;STREETS.rds&quot;</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_streets">streets</code></td>
<td>
<p>Logical. If true, <code><a href="#topic+emis_merge">emis_merge</a></code> will read the street
emissions created with <code><a href="#topic+emis_post">emis_post</a></code> by &quot;streets_wide&quot;, returning an
object with class 'sf'. If false, it will read the emissions data-frame and
rbind them.</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_net">net</code></td>
<td>
<p>'Spatial feature' or 'SpatialLinesDataFrame' with the streets.
It is expected #' that the number of rows is equal to the number of rows of
street emissions. If #' not, the function will stop.</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_fn">FN</code></td>
<td>
<p>Character indicating the function. Default is &quot;sum&quot;</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_ignore">ignore</code></td>
<td>
<p>Character; Which pollutants or other charavter would you like to remove?</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_path">path</code></td>
<td>
<p>Character. Path where emissions are located</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_crs">crs</code></td>
<td>
<p>coordinate reference system in numeric format from
http://spatialreference.org/ to transform/project spatial data using sf::st_transform</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_under">under</code></td>
<td>
<p>&quot;Character&quot;; &quot;after&quot; when you stored your pollutant x as 'X_'
&quot;before&quot; when '_X' and &quot;none&quot; for merging directly the files.</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_as_list">as_list</code></td>
<td>
<p>&quot;Logical&quot;; for returning the results as list or not.</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_k">k</code></td>
<td>
<p>factor</p>
</td></tr>
<tr><td><code id="emis_merge_+3A_verbose">verbose</code></td>
<td>
<p>Logical to display more information or not. Default is TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'Spatial feature' of lines or a dataframe of emissions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run


## End(Not run)
</code></pre>

<hr>
<h2 id='emis_order'>Re-order the emission to match specific hours and days</h2><span id='topic+emis_order'></span><span id='topic+weekly'></span>

<h3>Description</h3>

<p>Emissions are usually estimated for a year, 24 hours, or one week from monday to sunday (with 168 hours). This depends on the availability of traffic data.
When an air quality simulation is going to be done, they cover
specific periods of time. For instance, WRF Chem emissions files support periods of time,
or two emissions sets for a representative day (0-12z 12-0z). Also a WRF Chem simulation
scan starts a Thursday at 00:00 UTC, cover 271 hours of simulations, but hour emissions are in local
time and cover only 168 hours starting on Monday. This function tries to transform our emissions
in local time to the desired UTC time, by recycling the local emissions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_order(
  x,
  lt_emissions,
  start_utc_time,
  desired_length,
  tz_lt = Sys.timezone(),
  seconds = 0,
  k = 1,
  net,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_order_+3A_x">x</code></td>
<td>
<p>one of the following:
</p>

<ul>
<li><p> Spatial object of class &quot;Spatial&quot;. Columns are hourly emissions.
</p>
</li>
<li><p> Spatial Object of class &quot;sf&quot;. Columns are hourly emissions.
</p>
</li>
<li><p> &quot;data.frame&quot;, &quot;matrix&quot; or &quot;Emissions&quot;.
</p>
</li></ul>

<p>In all cases, columns are hourly emissions.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_lt_emissions">lt_emissions</code></td>
<td>
<p>Local time of the emissions at the first hour. It must be
the <strong>before</strong>  time of start_utc_time. For instance, if
start_utc_time is 2020-02-02 00:00, and your emissions starts monday at 00:00,
your lt_emissions must be 2020-01-27 00:00. The argument tz_lt will detect your
current local time zone and do the rest for you.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_start_utc_time">start_utc_time</code></td>
<td>
<p>UTC time for the desired first hour. For instance,
the first hour of the namelist.input for WRF.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_desired_length">desired_length</code></td>
<td>
<p>Integer; length to recycle or subset local emissions. For instance, the length
of the WRF Chem simulations, states at namelist.input.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_tz_lt">tz_lt</code></td>
<td>
<p>Character, Time zone of the local emissions. Default value is derived from
Sys.timezone(), however, it accepts any other. If you enter a wrong tz, this function will show
you a menu to choose one of the 697 time zones available.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_seconds">seconds</code></td>
<td>
<p>Number of seconds to add</p>
</td></tr>
<tr><td><code id="emis_order_+3A_k">k</code></td>
<td>
<p>Numeric, factor.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;.</p>
</td></tr>
<tr><td><code id="emis_order_+3A_verbose">verbose</code></td>
<td>
<p>Logical, to show more information, default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf or data.frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GriddedEmissionsArray">GriddedEmissionsArray</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#do not run
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::set_units(fkm[[1]](1:24), "km")
pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(co1, cod, v = "PC", t = "4S", cc = "&lt;=1400",
                     f = "G",p = "CO", eu=co1$Euro_LDV)
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
              profile = pc_profile, simplify = TRUE)
class(E_CO)
E_CO_STREETS &lt;- emis_post(arra = E_CO, pollutant = "CO", by = "streets", net = net)
g &lt;- make_grid(net, 1/102.47/2, 1/102.47/2) #500m in degrees
E_CO_g &lt;- emis_grid(spobj = E_CO_STREETS, g = g, sr= 31983)
head(E_CO_g) #class sf
gr &lt;- GriddedEmissionsArray(E_CO_g, rows = 19, cols = 23, times = 168, T)
wCO &lt;- emis_order(x = E_CO_g,
                   lt_emissions = "2020-02-19 00:00",
                   start_utc_time = "2020-02-20 00:00",
                   desired_length = 241)

## End(Not run)

</code></pre>

<hr>
<h2 id='emis_paved'>Estimation of resuspension emissions from paved roads</h2><span id='topic+emis_paved'></span>

<h3>Description</h3>

<p><code>emis_paved</code> estimates vehicular emissions from paved roads.
The vehicular emissions are estimated as the product of the vehicles on a
road, length of the road, emission factor from AP42 13.2.1 Paved roads.
It is assumed dry hours and annual aggregation should consider moisture factor.
It depends on Average Daily Traffic (ADT)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_paved(
  veh,
  adt,
  lkm,
  k = 0.62,
  sL1 = 0.6,
  sL2 = 0.2,
  sL3 = 0.06,
  sL4 = 0.03,
  W,
  net = net
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_paved_+3A_veh">veh</code></td>
<td>
<p>Numeric vector with length of elements equals to number of streets
It is an array with dimenssions number of streets x hours of day x days of week</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_adt">adt</code></td>
<td>
<p>Numeric vector of with Average Daily Traffic (ADT)</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_k">k</code></td>
<td>
<p>K_PM30 = 3.23 (g/vkm), K_PM15 = 0.77 (g/vkm), K_PM10 = 0.62 (g/vkm)
and K_PM2.5 = 0.15  (g/vkm).</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_sl1">sL1</code></td>
<td>
<p>Silt loading (g/m2) for roads with ADT &lt;= 500</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_sl2">sL2</code></td>
<td>
<p>Silt loading (g/m2) for roads with ADT &gt; 500 and &lt;= 5000</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_sl3">sL3</code></td>
<td>
<p>Silt loading (g/m2) for roads with ADT &gt; 5000 and &lt;= 1000</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_sl4">sL4</code></td>
<td>
<p>Silt loading (g/m2) for roads with ADT &gt; 10000</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_w">W</code></td>
<td>
<p>array of dimensions of veh. It consists in the hourly averaged
weight of traffic fleet in each road</p>
</td></tr>
<tr><td><code id="emis_paved_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission estimation  g/h
</p>


<h3>Note</h3>

<p>silt values can vary a lot. For comparison:
</p>

<table>
<tr>
 <td style="text-align: left;">
  ADT         </td><td style="text-align: center;"> US-EPA g/m2  </td><td style="text-align: center;">  CENMA (Chile) g/m2 </td>
</tr>
<tr>
 <td style="text-align: left;">
  &lt; 500       </td><td style="text-align: center;"> 0.6           </td><td style="text-align: center;">  2.4   </td>
</tr>
<tr>
 <td style="text-align: left;">
  500-5000    </td><td style="text-align: center;"> 0.2           </td><td style="text-align: center;">  0.7   </td>
</tr>
<tr>
 <td style="text-align: left;">
  5000-1000   </td><td style="text-align: center;"> 0.06          </td><td style="text-align: center;">  0.6   </td>
</tr>
<tr>
 <td style="text-align: left;">
  &gt;10000      </td><td style="text-align: center;">  0.03         </td><td style="text-align: center;">  0.3   </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>EPA, 2016. Emission factor documentation for AP-42. Section
13.2.1, Paved Roads. https://www3.epa.gov/ttn/chief/ap42/ch13/final/c13s0201.pdf
</p>
<p>CENMA Chile: Actualizacion de inventario de emisiones de contaminntes atmosfericos RM 2020
Universidad de Chile#'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
veh &lt;- matrix(1000, nrow = 10,ncol = 10)
W &lt;- veh*1.5
lkm &lt;-  1:10
ADT &lt;-1000:1010
emi  &lt;- emis_paved(veh = veh, adt = ADT, lkm = lkm, k = 0.65, W = W)
class(emi)
head(emi)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_post'>Post emissions</h2><span id='topic+emis_post'></span>

<h3>Description</h3>

<p><code>emis_post</code> simplify emissions estimated as total per type category of
vehicle or by street. It reads EmissionsArray and Emissions classes. It can return a dataframe
with hourly emissions at each street, or a database with emissions by vehicular
category, hour, including size, fuel and other characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_post(arra, veh, size, fuel, pollutant, by = "veh", net, type_emi, k = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_post_+3A_arra">arra</code></td>
<td>
<p>Array of emissions 4d: streets x category of vehicles x hours x days or
3d: streets x category of vehicles x hours</p>
</td></tr>
<tr><td><code id="emis_post_+3A_veh">veh</code></td>
<td>
<p>Character, type of vehicle</p>
</td></tr>
<tr><td><code id="emis_post_+3A_size">size</code></td>
<td>
<p>Character, size or weight</p>
</td></tr>
<tr><td><code id="emis_post_+3A_fuel">fuel</code></td>
<td>
<p>Character, fuel</p>
</td></tr>
<tr><td><code id="emis_post_+3A_pollutant">pollutant</code></td>
<td>
<p>Pollutant</p>
</td></tr>
<tr><td><code id="emis_post_+3A_by">by</code></td>
<td>
<p>Type of output, &quot;veh&quot; for total vehicular category ,
&quot;streets_narrow&quot; or &quot;streets&quot;. &quot;streets&quot; returns  a dataframe with
rows as number of streets and columns the hours as days*hours considered, e.g.
168 columns as the hours of a whole week and &quot;streets repeats the
row number of streets by hour and day of the week</p>
</td></tr>
<tr><td><code id="emis_post_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;. Only
when by = 'streets_wide'</p>
</td></tr>
<tr><td><code id="emis_post_+3A_type_emi">type_emi</code></td>
<td>
<p>Character, type of emissions(exhaust, evaporative, etc)</p>
</td></tr>
<tr><td><code id="emis_post_+3A_k">k</code></td>
<td>
<p>Numeric, factor</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function depends on EmissionsArray objests which currently has
4 dimensions. However, a future version of VEIN will produce EmissionsArray
with 3 dimensiones and his fungeorge soros drugsction also will change. This change will be
made in order to not produce inconsistencies with previous versions, therefore,
if the user count with an EmissionsArry with 4 dimension, it will be able
to use this function.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
# Estimation for morning rush hour and local emission factors
speed &lt;- data.frame(S8 = net$ps)
p1h &lt;- matrix(1)
lef &lt;- EmissionFactorsList(fe2015[fe2015$Pollutant=="CO", "PC_G"])
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed,
             profile = p1h)
E_CO_STREETS &lt;- emis_post(arra = E_CO, pollutant = "CO", by = "streets_wide")
summary(E_CO_STREETS)
E_CO_STREETSsf &lt;- emis_post(arra = E_CO, pollutant = "CO",
                           by = "streets", net = net)
summary(E_CO_STREETSsf)
plot(E_CO_STREETSsf, main = "CO emissions (g/h)")
# arguments required: arra, veh, size, fuel, pollutant ad by
E_CO_DF &lt;- emis_post(arra = E_CO,  veh = "PC", size = "&lt;1400", fuel = "G",
pollutant = "CO", by = "veh")
# Estimation 168 hours
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::set_units(fkm[[1]](1:24),"km"); pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(dfcol = cod, v = "PC",  cc = "&lt;=1400",
                     f = "G",p = "CO", eu=co1$Euro_LDV)
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
             profile = pc_profile)
# arguments required: arra, pollutant ad by
E_CO_STREETS &lt;- emis_post(arra = E_CO, pollutant = "CO", by = "streets")
summary(E_CO_STREETS)
# arguments required: arra, veh, size, fuel, pollutant ad by
E_CO_DF &lt;- emis_post(arra = E_CO,  veh = "PC", size = "&lt;1400", fuel = "G",
pollutant = "CO", by = "veh")
head(E_CO_DF)
# recreating 24 profile
lpc &lt;-list(pc1*0.2, pc1*0.1, pc1*0.1, pc1*0.2, pc1*0.5, pc1*0.8,
           pc1, pc1*1.1, pc1,
           pc1*0.8, pc1*0.5, pc1*0.5,
           pc1*0.5, pc1*0.5, pc1*0.5, pc1*0.8,
           pc1, pc1*1.1, pc1,
           pc1*0.8, pc1*0.5, pc1*0.3, pc1*0.2, pc1*0.1)
E_COv2 &lt;- emis(veh = lpc,  lkm = net$lkm, ef = lef, speed = speed[, 1:24],
            agemax = 41, hour = 24, day = 1)
plot(E_COv2)
E_CO_DFv2 &lt;- emis_post(arra = E_COv2,
                       veh = "PC",
                       size = "&lt;1400",
                       fuel = "G",
                       type_emi = "Exhaust",
                       pollutant = "CO", by = "veh")
head(E_CO_DFv2)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_to_streets'>Emis to streets distribute top-down emissions into streets</h2><span id='topic+emis_to_streets'></span>

<h3>Description</h3>

<p><code><a href="#topic+emis_to_streets">emis_to_streets</a></code> allocates emissions proportionally to
each feature. &quot;Spatial&quot; objects are converter to &quot;sf&quot; objects. Currently,
'LINESTRING' or 'MULTILINESTRING' supported. The emissions are distributed
in each street.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_to_streets(streets, dfemis, by = "ID", stpro, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_to_streets_+3A_streets">streets</code></td>
<td>
<p>sf object with geometry 'LINESTRING' or 'MULTILINESTRING'. Or
SpatialLinesDataFrame</p>
</td></tr>
<tr><td><code id="emis_to_streets_+3A_dfemis">dfemis</code></td>
<td>
<p>data.frame with emissions</p>
</td></tr>
<tr><td><code id="emis_to_streets_+3A_by">by</code></td>
<td>
<p>Character indicating the columns that must be present in both
'street' and 'dfemis'</p>
</td></tr>
<tr><td><code id="emis_to_streets_+3A_stpro">stpro</code></td>
<td>
<p>data.frame with two columns, category of streets and value.
The name of the first column must be &quot;stpro&quot; and the sf streets must also
have a column with the nam &quot;stpro&quot; indicating the category of streets.
The second column must have the name &quot;VAL&quot; indicating the associated values
to each category of street</p>
</td></tr>
<tr><td><code id="emis_to_streets_+3A_verbose">verbose</code></td>
<td>
<p>Logical; to show more info.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When spobj is a 'Spatial' object (class of sp), they are converted
into 'sf'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+add_polid">add_polid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
stpro = data.frame(stpro = as.character(unique(net$tstreet)),
                   VAL = 1:9)
dnet &lt;- net["ldv"]
dnet$stpro &lt;- as.character(net$tstreet)
dnet$ID &lt;- "A"
df2 &lt;- data.frame(BC = 10, CO = 20, ID = "A")
ste &lt;- emis_to_streets(streets = dnet, dfemis = df2)
sum(ste$ldv)
sum(net$ldv)
sum(ste$BC)
sum(df2$BC)
ste2 &lt;- emis_to_streets(streets = dnet, dfemis = df2, stpro = stpro)
sum(ste2$ldv)
sum(net$ldv)
sum(ste2$BC)
sum(df2$BC)

## End(Not run)
</code></pre>

<hr>
<h2 id='emis_wear'>Emission estimation from tyre, brake and road surface wear</h2><span id='topic+emis_wear'></span>

<h3>Description</h3>

<p><code>emis_wear</code> estimates wear emissions. The sources are tyres,
breaks and road surface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emis_wear(
  veh,
  lkm,
  ef,
  what = "tyre",
  speed,
  agemax = ncol(veh),
  profile,
  hour = nrow(profile),
  day = ncol(profile)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emis_wear_+3A_veh">veh</code></td>
<td>
<p>Object of class &quot;Vehicles&quot;</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_lkm">lkm</code></td>
<td>
<p>Length of the road in km.</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_ef">ef</code></td>
<td>
<p>list of emission factor functions class &quot;EmissionFactorsList&quot;,
length equals to hours.</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_what">what</code></td>
<td>
<p>Character for indicating &quot;tyre&quot;, &quot;break&quot; or &quot;road&quot;</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_speed">speed</code></td>
<td>
<p>Speed data-frame with number of columns as hours</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_agemax">agemax</code></td>
<td>
<p>Age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_profile">profile</code></td>
<td>
<p>Numerical or dataframe with nrows equal to 24 and ncol
7 day of the week</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_hour">hour</code></td>
<td>
<p>Number of considered hours in estimation</p>
</td></tr>
<tr><td><code id="emis_wear_+3A_day">day</code></td>
<td>
<p>Number of considered days in estimation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission estimation  g/h
</p>


<h3>References</h3>

<p>Ntziachristos and Boulter 2016. Automobile tyre and break wear
and road abrasion. In: EEA, EMEP. EEA air pollutant emission inventory
guidebook-2009. European Environment Agency, Copenhagen, 2016
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
pc_week &lt;- temp_fact(net$ldv[1:10] + net$hdv[1:10], pc_profile[, 1])
df &lt;- netspeed(pc_week, net$ps[1:10], net$ffs[1:10],
              net$capacity[1:10], net$lkm[1:10], alpha = 1)
ef &lt;- ef_wear(wear = "tyre", type = "PC", pol = "PM10", speed = df)
emi &lt;- emis_wear(veh = age_ldv(net$ldv[1:10], name = "VEH"),
                 lkm = net$lkm[1:10], ef = ef, speed = df,
                 profile = pc_profile[, 1])
emi

## End(Not run)
</code></pre>

<hr>
<h2 id='EmissionFactors'>Construction function for class &quot;EmissionFactors&quot;</h2><span id='topic+EmissionFactors'></span><span id='topic+print.EmissionFactors'></span><span id='topic+summary.EmissionFactors'></span><span id='topic+plot.EmissionFactors'></span>

<h3>Description</h3>

<p><code>EmissionFactors</code> returns a transformed object with class
&quot;EmissionFactors&quot; and units g/km.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EmissionFactors(x, mass = "g", dist = "km", ...)

## S3 method for class 'EmissionFactors'
print(x, ...)

## S3 method for class 'EmissionFactors'
summary(object, ...)

## S3 method for class 'EmissionFactors'
plot(
  x,
  pal = "mpl_viridis",
  rev = TRUE,
  fig1 = c(0, 0.8, 0, 0.8),
  fig2 = c(0, 0.8, 0.55, 1),
  fig3 = c(0.7, 1, 0, 0.8),
  mai1 = c(0.2, 0.82, 0.82, 0.42),
  mai2 = c(1.3, 0.82, 0.82, 0.42),
  mai3 = c(0.7, 0.62, 0.82, 0.42),
  bias = 1.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EmissionFactors_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot; or &quot;numeric&quot;</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_mass">mass</code></td>
<td>
<p>Character to be the time units as numerator, default &quot;g&quot; for grams</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_dist">dist</code></td>
<td>
<p>String indicating the units of the resulting distance in speed.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_object">object</code></td>
<td>
<p>object with class &quot;EmissionFactors'</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_pal">pal</code></td>
<td>
<p>Palette of colors available or the number of the position</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_rev">rev</code></td>
<td>
<p>Logical; to internally revert order of rgb color vectors.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_fig1">fig1</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_fig2">fig2</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_fig3">fig3</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_mai1">mai1</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_mai2">mai2</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_mai3">mai3</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="EmissionFactors_+3A_bias">bias</code></td>
<td>
<p>positive number. Higher values give more widely spaced colors at the high end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;EmissionFactors&quot; or &quot;units&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(fe2015)
names(fe2015)
class(fe2015)
df &lt;- fe2015[fe2015$Pollutant=="CO", c(ncol(fe2015)-1,ncol(fe2015))]
ef1 &lt;- EmissionFactors(df)
class(ef1)
summary(ef1)
plot(ef1)
print(ef1)

## End(Not run)
</code></pre>

<hr>
<h2 id='EmissionFactorsList'>Construction function for class &quot;EmissionFactorsList&quot;</h2><span id='topic+EmissionFactorsList'></span><span id='topic+print.EmissionFactorsList'></span><span id='topic+summary.EmissionFactorsList'></span><span id='topic+plot.EmissionFactorsList'></span>

<h3>Description</h3>

<p><code>EmissionFactorsList</code> returns a transformed object with
class&quot;EmissionsFactorsList&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EmissionFactorsList(x, ...)

## S3 method for class 'EmissionFactorsList'
print(x, ..., default = FALSE)

## S3 method for class 'EmissionFactorsList'
summary(object, ...)

## S3 method for class 'EmissionFactorsList'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EmissionFactorsList_+3A_x">x</code></td>
<td>
<p>Object with class &quot;list&quot;</p>
</td></tr>
<tr><td><code id="EmissionFactorsList_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="EmissionFactorsList_+3A_default">default</code></td>
<td>
<p>Logical value. When TRUE prints default list, when FALSE
prints messages with description of list</p>
</td></tr>
<tr><td><code id="EmissionFactorsList_+3A_object">object</code></td>
<td>
<p>Object with class &quot;EmissionFactorsList&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;EmissionFactorsList&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(fe2015)
names(fe2015)
class(fe2015)
df &lt;- fe2015[fe2015$Pollutant=="CO", c(ncol(fe2015)-1,ncol(fe2015))]
ef1 &lt;- EmissionFactorsList(df)
class(ef1)
length(ef1)
length(ef1[[1]])
summary(ef1)
ef1

## End(Not run)
</code></pre>

<hr>
<h2 id='Emissions'>Construction function for class &quot;Emissions&quot;</h2><span id='topic+Emissions'></span><span id='topic+print.Emissions'></span><span id='topic+summary.Emissions'></span><span id='topic+plot.Emissions'></span>

<h3>Description</h3>

<p><code>Emissions</code> returns a transformed object with class &quot;Emissions&quot;.
The type of objects supported are of classes &quot;matrix&quot;, &quot;data.frame&quot; and
&quot;numeric&quot;. If the class of the object is &quot;matrix&quot; this function returns a
dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Emissions(x, mass = "g", time, ...)

## S3 method for class 'Emissions'
print(x, ...)

## S3 method for class 'Emissions'
summary(object, ...)

## S3 method for class 'Emissions'
plot(
  x,
  pal = "colo_angelafaye_Coloured_sky_in",
  rev = FALSE,
  fig1 = c(0, 0.8, 0, 0.8),
  fig2 = c(0, 0.8, 0.55, 1),
  fig3 = c(0.7, 1, 0, 0.8),
  mai1 = c(0.2, 0.82, 0.82, 0.42),
  mai2 = c(1.3, 0.82, 0.82, 0.42),
  mai3 = c(0.7, 0.72, 0.82, 0.42),
  main = NULL,
  bias = 1.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Emissions_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot; or &quot;numeric&quot;</p>
</td></tr>
<tr><td><code id="Emissions_+3A_mass">mass</code></td>
<td>
<p>Character to be the time units as numerator, default &quot;g&quot; for grams</p>
</td></tr>
<tr><td><code id="Emissions_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;h&quot;</p>
</td></tr>
<tr><td><code id="Emissions_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="Emissions_+3A_object">object</code></td>
<td>
<p>object with class &quot;Emissions&quot;</p>
</td></tr>
<tr><td><code id="Emissions_+3A_pal">pal</code></td>
<td>
<p>Palette of colors available or the number of the position</p>
</td></tr>
<tr><td><code id="Emissions_+3A_rev">rev</code></td>
<td>
<p>Logical; to internally revert order of rgb color vectors.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_fig1">fig1</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_fig2">fig2</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_fig3">fig3</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_mai1">mai1</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_mai2">mai2</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_mai3">mai3</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Emissions_+3A_main">main</code></td>
<td>
<p>title of plot</p>
</td></tr>
<tr><td><code id="Emissions_+3A_bias">bias</code></td>
<td>
<p>positive number. Higher values give more widely spaced colors at the high end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;Emissions&quot; or &quot;units&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::as_units(fkm[[1]](1:24), "km"); pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(co1, cod, v = "PC",  cc = "&lt;=1400",
                     f = "G", p = "CO", eu=co1$Euro_LDV)
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
             profile = pc_profile)
dim(E_CO) # streets x vehicle categories x hours x days
class(E_CO)
plot(E_CO)
####
Emissions(1)
Emissions(1, time = "h")

## End(Not run)
</code></pre>

<hr>
<h2 id='EmissionsArray'>Construction function for class &quot;EmissionsArray&quot;</h2><span id='topic+EmissionsArray'></span><span id='topic+print.EmissionsArray'></span><span id='topic+summary.EmissionsArray'></span><span id='topic+plot.EmissionsArray'></span>

<h3>Description</h3>

<p><code>EmissionsArray</code> returns a transformed object with class
&quot;EmissionsArray&quot; with 4 dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EmissionsArray(x, ...)

## S3 method for class 'EmissionsArray'
print(x, ...)

## S3 method for class 'EmissionsArray'
summary(object, ...)

## S3 method for class 'EmissionsArray'
plot(x, main = "average emissions", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EmissionsArray_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot; or &quot;numeric&quot;</p>
</td></tr>
<tr><td><code id="EmissionsArray_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="EmissionsArray_+3A_object">object</code></td>
<td>
<p>object with class &quot;EmissionsArray'</p>
</td></tr>
<tr><td><code id="EmissionsArray_+3A_main">main</code></td>
<td>
<p>Title for plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;EmissionsArray&quot;
</p>


<h3>Note</h3>

<p>Future version of this function will return an Array of 3 dimensions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::set_units(fkm[[1]](1:24), "km"); pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(co1, cod, v = "PC", cc = "&lt;=1400",
                     f = "G",p = "CO", eu=co1$Euro_LDV)
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
             profile = pc_profile, simplify = TRUE)
class(E_CO)
summary(E_CO)
E_CO
plot(E_CO)
lpc &lt;- list(pc1, pc1)
E_COv2 &lt;- emis(veh = lpc,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
             profile = pc_profile, hour = 2, day = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='fe2015'>Emission factors from Environmental Agency of Sao Paulo CETESB</h2><span id='topic+fe2015'></span>

<h3>Description</h3>

<p>A dataset containing emission factors from CETESB and its
equivalency with EURO
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fe2015)
</code></pre>


<h3>Format</h3>

<p>A data frame with 288 rows and 12 variables:
</p>

<dl>
<dt>Age</dt><dd><p>Age of use</p>
</dd>
<dt>Year</dt><dd><p>Year of emission factor</p>
</dd>
<dt>Pollutant</dt><dd><p>Pollutants included: &quot;CH4&quot;, &quot;CO&quot;, &quot;CO2&quot;, &quot;HC&quot;,
&quot;N2O&quot;, &quot;NMHC&quot;, &quot;NOx&quot;, and &quot;PM&quot;</p>
</dd>
<dt>Proconve_LDV</dt><dd><p>Proconve emission standard: &quot;PP&quot;, &quot;L1&quot;, &quot;L2&quot;,
&quot;L3&quot;, &quot;L4&quot;, &quot;L5&quot;, &quot;L6&quot;</p>
</dd>
<dt>t_Euro_LDV</dt><dd><p>Euro emission standard equivalence: &quot;PRE_ECE&quot;,
&quot;I&quot;, &quot;II&quot;, &quot;III&quot;,&quot;IV&quot;, &quot;V&quot;</p>
</dd>
<dt>Euro_LDV</dt><dd><p>Euro emission standard equivalence: &quot;PRE_ECE&quot;,
&quot;I&quot;, &quot;II&quot;, &quot;III&quot;,&quot;IV&quot;, &quot;V&quot;</p>
</dd>
<dt>Proconve_HDV</dt><dd><p>Proconve emission standard: &quot;PP&quot;, &quot;P1&quot;, &quot;P2&quot;,
&quot;P3&quot;, &quot;P4&quot;, &quot;P5&quot;, &quot;P7&quot;</p>
</dd>
<dt>Euro_HDV</dt><dd><p>Euro emission standard equivalence: &quot;PRE&quot;, &quot;I&quot;,
&quot;II&quot;, &quot;III&quot;, &quot;V&quot;</p>
</dd>
<dt>PC_G</dt><dd><p>CETESB emission standard for Passenger Cars with Gasoline (g/km)</p>
</dd>
<dt>LT</dt><dd><p>CETESB emission standard for Light Trucks with Diesel (g/km)</p>
</dd>
</dl>



<h3>Source</h3>

<p>CETESB
</p>

<hr>
<h2 id='fkm'>List of functions of mileage in km fro Brazilian fleet</h2><span id='topic+fkm'></span>

<h3>Description</h3>

<p>Functions from CETESB:
Antonio de Castro Bruni and Marcelo Pereira Bales. 2013.
Curvas de intensidade de uso por tipo de veiculo automotor da frota da cidade de Sao Paulo
This functions depends on the age of use of the vehicle
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fkm)
</code></pre>


<h3>Format</h3>

<p>A data frame with 288 rows and 12 variables:
</p>

<dl>
<dt>KM_PC_E25</dt><dd><p>Mileage in km of Passenger Cars using Gasoline with 25% Ethanol</p>
</dd>
<dt>KM_PC_E100</dt><dd><p>Mileage in km of Passenger Cars using Ethanol 100%</p>
</dd>
<dt>KM_PC_FLEX</dt><dd><p>Mileage in km of Passenger Cars using Flex engines</p>
</dd>
<dt>KM_LCV_E25</dt><dd><p>Mileage in km of Light Commercial Vehicles using Gasoline with 25% Ethanol</p>
</dd>
<dt>KM_LCV_FLEX</dt><dd><p>Mileage in km of Light Commercial Vehicles using Flex</p>
</dd>
<dt>KM_PC_B5</dt><dd><p>Mileage in km of Passenger Cars using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_TRUCKS_B5</dt><dd><p>Mileage in km of Trucks using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_BUS_B5</dt><dd><p>Mileage in km of Bus using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_LCV_B5</dt><dd><p>Mileage in km of Light Commercial Vehicles using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_SBUS_B5</dt><dd><p>Mileage in km of Small Bus using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_ATRUCKS_B5</dt><dd><p>Mileage in km of Articulated Trucks using Diesel with 5% biodiesel</p>
</dd>
<dt>KM_MOTO_E25</dt><dd><p>Mileage in km of Motorcycles using Gasoline with 25% Ethanol</p>
</dd>
<dt>KM_LDV_GNV</dt><dd><p>Mileage in km of Light Duty Vehicles using Natural Gas</p>
</dd>
</dl>



<h3>Source</h3>

<p>CETESB
</p>

<hr>
<h2 id='fuel_corr'>Correction due Fuel effects</h2><span id='topic+fuel_corr'></span>

<h3>Description</h3>

<p>Take into account the effect of better fuels on vehicles with
older technology. If the ratio is less than 1, return 1. It means that it is
nota degradation function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fuel_corr(
  euro,
  g = c(e100 = 52, aro = 39, o2 = 0.4, e150 = 86, olefin = 10, s = 165),
  d = c(den = 840, pah = 9, cn = 51, t95 = 350, s = 400)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fuel_corr_+3A_euro">euro</code></td>
<td>
<p>Character; Euro standards (&quot;PRE&quot;, &quot;I&quot;, &quot;II&quot;, &quot;III&quot;, &quot;IV&quot;, &quot;V&quot;,
VI, &quot;VIc&quot;)</p>
</td></tr>
<tr><td><code id="fuel_corr_+3A_g">g</code></td>
<td>
<p>Numeric; vector with parameters of gasoline with the names:
e100(vol. 
(sulphur, ppm)</p>
</td></tr>
<tr><td><code id="fuel_corr_+3A_d">d</code></td>
<td>
<p>Numeric; vector with parameters for diesel with the names:
den (density at 15 Celsius degrees kg/m3), pah (
(Back end distillation in Celsius degrees) and s  (sulphur, ppm)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the correction of emission factors.
</p>


<h3>Note</h3>

<p>This function cannot be used to account for deterioration, therefore,
it is restricted to values between 0 and 1.
Parameters for gasoline (g):
</p>
<p>O2 = Oxygenates in 
</p>
<p>S = Sulphur content in ppm
</p>
<p>ARO = Aromatics content in 
</p>
<p>OLEFIN = Olefins content in 
</p>
<p>E100 = Mid range volatility in 
</p>
<p>E150 = Tail-end volatility in 
</p>
<p>Parameters for diesel (d):
</p>
<p>DEN = Density at 15 C (kg/m3)
</p>
<p>S = Sulphur content in ppm
</p>
<p>PAH = Aromatics content in 
</p>
<p>CN = Cetane number
</p>
<p>T95 = Back-end distillation in o C.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
f &lt;- fuel_corr(euro = "I")
names(f)

## End(Not run)
</code></pre>

<hr>
<h2 id='get_project'>Download vein project</h2><span id='topic+get_project'></span>

<h3>Description</h3>

<p><code><a href="#topic+get_project">get_project</a></code> downloads a project for running vein.
The projects are available on Github.com/atmoschem/vein/projects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_project(directory, case = "brazil_bu_chem", url)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_project_+3A_directory">directory</code></td>
<td>
<p>Character; Path to an existing or a new directory to be created.</p>
</td></tr>
<tr><td><code id="get_project_+3A_case">case</code></td>
<td>
<p>Character; One of  of the following:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <strong>case</strong>       </td><td style="text-align: left;"> <strong>Description</strong></td><td style="text-align: left;">  <strong>EF</strong> </td><td style="text-align: left;"> <strong>Outputs</strong>   </td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil or brazil_bu or brasil or brasil_bu</td><td style="text-align: left;"> Bottom-up </td><td style="text-align: left;"> CETESB </td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  emislacovid         </td><td style="text-align: left;"> Bottom-up March 2020</td><td style="text-align: left;"> CETESB </td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_csvgz     </td><td style="text-align: left;"> Bottom-up </td><td style="text-align: left;"> CETESB+tunnel </td><td style="text-align: left;">  .csv.gz</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_csv         </td><td style="text-align: left;"> Bottom-up. Faster but heavier</td><td style="text-align: left;"> CETESB</td><td style="text-align: left;">  .csv</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_td_chem      </td><td style="text-align: left;"> Top-down with chemical mechanisms</td><td style="text-align: left;"> CETESB</td><td style="text-align: left;">  .csv and .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_chem      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_chem_streets      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms for streets and MUNICH</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_td_chem_im      </td><td style="text-align: left;"> Top-down with chemical mechanisms+IM</td><td style="text-align: left;"> CETESB</td><td style="text-align: left;">  .csv and .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_chem_im      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms+IM</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_chem_month  </td><td style="text-align: left;"> Bottom-up  chemical mechanisms</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  brazil_bu_chem_streets_im      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms for streets and MUNICH+IM</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  sebr_cb05co2      </td><td style="text-align: left;"> Top-down SP, MG and RJ</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  amazon2014      </td><td style="text-align: left;"> Top-down Amazon</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  curitiba      </td><td style="text-align: left;"> Bottom-down +GTFS</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  masp2020      </td><td style="text-align: left;"> Bottom-down</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  ecuador_td      </td><td style="text-align: left;"> Top-down</td><td style="text-align: left;"> EEA</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  ecuador_td_im      </td><td style="text-align: left;"> Top-down</td><td style="text-align: left;"> EEA</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  ecuador_td_hot      </td><td style="text-align: left;"> Top-down</td><td style="text-align: left;"> EEA</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  ecuador_td_hot_month      </td><td style="text-align: left;"> Top-down</td><td style="text-align: left;"> EEA</td><td style="text-align: left;">  csv and.rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  moves_bu      </td><td style="text-align: left;"> Bottom-up</td><td style="text-align: left;"> US/EPA MOVES </td><td style="text-align: left;">  csv and.rds (requires MOVES &gt;=3.0 on Windows)</td>
</tr>
<tr>
 <td style="text-align: left;">
  manizales_bu      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms</td><td style="text-align: left;"> EEA</td><td style="text-align: left;">  csv, csv.gz, .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  sebr_cb05co2_im  </td><td style="text-align: left;"> Top-down SP, MG and RJ IM</td><td style="text-align: left;"> CETESB+tunnel</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  eu_bu_chem      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms</td><td style="text-align: left;"> EEA 2019</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  eu_bu_chem_simple </td><td style="text-align: left;"> Bottom-up  chemical mechanisms 7 veh</td><td style="text-align: left;"> EEA 2019</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
  china_bu_chem      </td><td style="text-align: left;"> Bottom-up  chemical mechanisms</td><td style="text-align: left;"> MEE China</td><td style="text-align: left;">  .rds</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="get_project_+3A_url">url</code></td>
<td>
<p>String, with the URL to download VEIN project</p>
</td></tr>
</table>


<h3>Note</h3>

<p>default case can be any of &quot;brasil&quot;, &quot;brazil&quot;, &quot;brazil_bu&quot;, &quot;brasil_bu&quot;, they are
the same
In any case, if you find any error, please, send a pull request in github.
</p>
<p>In Sao Paulo the IM programs was functioning until 2011.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#do not run
get_project("awesomecity")

## End(Not run)

</code></pre>

<hr>
<h2 id='grid_emis'>Allocate emissions gridded emissions into streets (grid to emis street)</h2><span id='topic+grid_emis'></span>

<h3>Description</h3>

<p><code><a href="#topic+grid_emis">grid_emis</a></code> it is sort of the opposite of
<code><a href="#topic+emis_grid">emis_grid</a></code>. It allocates gridded emissions into streets.
This function applies <code><a href="#topic+emis_dist">emis_dist</a></code> into each grid cell using
lapply. This function is in development and pull request are welcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid_emis(spobj, g, top_down = FALSE, sr, pro, char, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grid_emis_+3A_spobj">spobj</code></td>
<td>
<p>A spatial dataframe of class &quot;sp&quot; or &quot;sf&quot;. When class is &quot;sp&quot;
it is transformed to &quot;sf&quot;.</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_g">g</code></td>
<td>
<p>A grid with class &quot;SpatialPolygonsDataFrame&quot; or &quot;sf&quot;. This grid
includes the total emissions with the column &quot;emission&quot;. If the profile is going
to be used, the column 'emission' must include the sum of the emissions
for each profile. For instance, if profile covers the hourly emissions,
the column 'emission' bust be the sum of the hourly emissions.</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_top_down">top_down</code></td>
<td>
<p>Logical; requires emissions named 'emissions' and allows
to apply profile factors. If your data is hourly emissions or a spatial
grid with several emissions at different hours, being each hour a column,
it is better to use top_down = FALSE. In this way all the hourly emissions
are considered, however, each hourly emissions has to have the name &quot;V&quot; and the
number of the hour like &quot;V1&quot;</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_sr">sr</code></td>
<td>
<p>Spatial reference e.g: 31983. It is required if spobj and g are
not projected. Please, see http://spatialreference.org/.</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_pro">pro</code></td>
<td>
<p>Numeric, Matrix or data-frame profiles, for instance, pc_profile.</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_char">char</code></td>
<td>
<p>Character, name of the first letter of hourly emissions. New variables in R
start with the letter &quot;V&quot;, for your hourly emissions might start with the letter &quot;h&quot;. This option
applies when top_down is FALSE. For instance, if your hourly emissions are: &quot;h1&quot;, &quot;h2&quot;,
&quot;h3&quot;... 'char&ldquo; can be &quot;h&quot;</p>
</td></tr>
<tr><td><code id="grid_emis_+3A_verbose">verbose</code></td>
<td>
<p>Logical; to show more info.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><strong>Your gridded emissions might have flux units (mass / area / time(implicit))</strong>
<strong>You must multiply your emissions with the area to return to the original units.</strong>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
133833,138441,142682,171029,151048,115228,98664,126444,101027,
       84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
# Estimation for morning rush hour and local emission factors
lef &lt;- EmissionFactorsList(ef_cetesb("CO", "PC_G"))
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef,
            profile = 1, speed = Speed(1))
E_CO_STREETS &lt;- emis_post(arra = E_CO, by = "streets", net = net)

g &lt;- make_grid(net, 1/102.47/2) #500m in degrees

gCO &lt;- emis_grid(spobj = E_CO_STREETS, g = g)
gCO$emission &lt;- gCO$V1
area &lt;- sf::st_area(gCO)
area &lt;- units::set_units(area, "km^2") #Check units!
gCO$emission &lt;- gCO$emission*area
#
\dontrun{
#do not run
library(osmdata)
library(sf)
osm &lt;- osmdata_sf(
add_osm_feature(
opq(bbox = st_bbox(gCO)),
key = 'highway'))$osm_lines[, c("highway")]
st &lt;- c("motorway", "motorway_link", "trunk", "trunk_link",
"primary", "primary_link", "secondary", "secondary_link",
"tertiary", "tertiary_link")
osm &lt;- osm[osm$highway %in% st, ]
plot(osm, axes = T)
# top_down requires name `emissions` into gCO`
xnet &lt;- grid_emis(osm, gCO, top_down = TRUE)
plot(xnet, axes = T)
# bottom_up requires that emissions are named `V` plus the hour like `V1`
xnet &lt;- grid_emis(osm, gCO,top_down= FALSE)
plot(xnet["V1"], axes = T)
}

## End(Not run)
</code></pre>

<hr>
<h2 id='GriddedEmissionsArray'>Construction function for class &quot;GriddedEmissionsArray&quot;</h2><span id='topic+GriddedEmissionsArray'></span><span id='topic+print.GriddedEmissionsArray'></span><span id='topic+summary.GriddedEmissionsArray'></span><span id='topic+plot.GriddedEmissionsArray'></span>

<h3>Description</h3>

<p><code>GriddedEmissionsArray</code> returns a transformed object with class
&quot;EmissionsArray&quot; with 4 dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GriddedEmissionsArray(x, ..., cols, rows, times = ncol(x), rotate = "default")

## S3 method for class 'GriddedEmissionsArray'
print(x, ...)

## S3 method for class 'GriddedEmissionsArray'
summary(object, ...)

## S3 method for class 'GriddedEmissionsArray'
plot(x, ..., times = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GriddedEmissionsArray_+3A_x">x</code></td>
<td>
<p>Object with class &quot;SpatialPolygonDataFrame&quot;, &quot;sf&quot; &quot;data.frame&quot; or
&quot;matrix&quot;</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_cols">cols</code></td>
<td>
<p>Number of columns</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_rows">rows</code></td>
<td>
<p>Number of rows</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_times">times</code></td>
<td>
<p>Number of times</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_rotate">rotate</code></td>
<td>
<p>Character, rotate array:&quot;default&quot;,  &quot;left&quot;, &quot;right&quot;,
&quot;cols&quot;,&quot;rows&quot;, &quot;both&quot;, &quot;br&quot;, &quot;colsbr&quot;, &quot;rowsbr&quot;, &quot;bothbr&quot;.
br means starting a matrix byrow</p>
</td></tr>
<tr><td><code id="GriddedEmissionsArray_+3A_object">object</code></td>
<td>
<p>object with class &quot;EmissionsArray'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;GriddedEmissionsArray&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
data(fe2015)
data(fkm)
PC_G &lt;- c(33491,22340,24818,31808,46458,28574,24856,28972,37818,49050,87923,
          133833,138441,142682,171029,151048,115228,98664,126444,101027,
          84771,55864,36306,21079,20138,17439, 7854,2215,656,1262,476,512,
          1181, 4991, 3711, 5653, 7039, 5839, 4257,3824, 3068)
veh &lt;- data.frame(PC_G = PC_G)
pc1 &lt;- my_age(x = net$ldv, y = PC_G, name = "PC")
pcw &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
speed &lt;- netspeed(pcw, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
pckm &lt;- units::set_units(fkm[[1]](1:24), "km")
pckma &lt;- cumsum(pckm)
cod1 &lt;- emis_det(po = "CO", cc = 1000, eu = "III", km = pckma[1:11])
cod2 &lt;- emis_det(po = "CO", cc = 1000, eu = "I", km = pckma[12:24])
#vehicles newer than pre-euro
co1 &lt;- fe2015[fe2015$Pollutant=="CO", ] #24 obs!!!
cod &lt;- c(co1$PC_G[1:24]*c(cod1,cod2),co1$PC_G[25:nrow(co1)])
lef &lt;- ef_ldv_scaled(co1, cod, v = "PC", t = "4S", cc = "&lt;=1400",
                     f = "G",p = "CO", eu=co1$Euro_LDV)
E_CO &lt;- emis(veh = pc1,lkm = net$lkm, ef = lef, speed = speed, agemax = 41,
              profile = pc_profile, simplify = TRUE)
class(E_CO)
E_CO_STREETS &lt;- emis_post(arra = E_CO, pollutant = "CO", by = "streets",
                          net = net, k = units::set_units(1, "1/h"))
g &lt;- make_grid(net, 1/102.47/2, 1/102.47/2) #500m in degrees
E_CO_g &lt;- emis_grid(spobj = E_CO_STREETS, g = g, sr= 31983)
plot(E_CO_g["V9"])
# check all
rots &lt;- c("default", "left", "right",
          "cols","rows", "both",
          "br", "colsbr", "rowsbr", "bothbr")
oldpar &lt;- par()
par(mfrow = c(2,5))
lg &lt;- lapply(seq_along(rots), function(i){
            x &lt;- GriddedEmissionsArray(E_CO_g,
                                rows = 19,
                                cols = 23,
                                times = 168,
                                rotate = rots[i])
         plot(x, main = rots[i])
        })

par(mfrow = c(1,1))

## End(Not run)
</code></pre>

<hr>
<h2 id='invcop'>Helper function to copy and zip projects</h2><span id='topic+invcop'></span>

<h3>Description</h3>

<p><code>invcop</code> help to copy and zip projects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invcop(
  in_name = getwd(),
  out_name,
  all = FALSE,
  main = TRUE,
  ef = TRUE,
  est = TRUE,
  network = TRUE,
  veh_rds = FALSE,
  veh_csv = TRUE,
  zip = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invcop_+3A_in_name">in_name</code></td>
<td>
<p>Character; Name of current project.</p>
</td></tr>
<tr><td><code id="invcop_+3A_out_name">out_name</code></td>
<td>
<p>Character; Name of output project.</p>
</td></tr>
<tr><td><code id="invcop_+3A_all">all</code></td>
<td>
<p>Logical; copy ALL (and for once) or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_main">main</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_ef">ef</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_est">est</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_network">network</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_veh_rds">veh_rds</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_veh_csv">veh_csv</code></td>
<td>
<p>Logical; copy or not.</p>
</td></tr>
<tr><td><code id="invcop_+3A_zip">zip</code></td>
<td>
<p>Logical; zip or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission estimation  g/h
</p>


<h3>Note</h3>

<p>This function was created to copy and zip project without the emis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run

## End(Not run)
</code></pre>

<hr>
<h2 id='inventory'>Inventory function.</h2><span id='topic+inventory'></span>

<h3>Description</h3>

<p><code>inventory</code> produces an structure of directories and scripts
in order to run vein. It is required to know the vehicular composition of the
fleet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inventory(
  name,
  vehcomp = c(PC = 1, LCV = 1, HGV = 1, BUS = 1, MC = 1),
  show.main = FALSE,
  scripts = TRUE,
  show.dir = FALSE,
  show.scripts = FALSE,
  clear = TRUE,
  rush.hour = FALSE,
  showWarnings = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inventory_+3A_name">name</code></td>
<td>
<p>Character, path to new main directory for running vein.
NO BLANK SPACES</p>
</td></tr>
<tr><td><code id="inventory_+3A_vehcomp">vehcomp</code></td>
<td>
<p>Vehicular composition of the fleet. It is required a named
numerical vector with the names &quot;PC&quot;, &quot;LCV&quot;, &quot;HGV&quot;, &quot;BUS&quot; and &quot;MC&quot;. In the
case that there are no vehicles for one category of the composition, the name
should be included with the number zero, for example, PC = 0. The maximum
number allowed is 99 per category.</p>
</td></tr>
<tr><td><code id="inventory_+3A_show.main">show.main</code></td>
<td>
<p>Logical; Do you want to see the new main.R file?</p>
</td></tr>
<tr><td><code id="inventory_+3A_scripts">scripts</code></td>
<td>
<p>Logical Do you want to generate or no R scripts?</p>
</td></tr>
<tr><td><code id="inventory_+3A_show.dir">show.dir</code></td>
<td>
<p>Logical value for printing the created directories.</p>
</td></tr>
<tr><td><code id="inventory_+3A_show.scripts">show.scripts</code></td>
<td>
<p>Logical value for printing the created scripts.</p>
</td></tr>
<tr><td><code id="inventory_+3A_clear">clear</code></td>
<td>
<p>Logical value for removing recursively the directory and create
another one.</p>
</td></tr>
<tr><td><code id="inventory_+3A_rush.hour">rush.hour</code></td>
<td>
<p>Logical, to create a template for morning rush hour.</p>
</td></tr>
<tr><td><code id="inventory_+3A_showwarnings">showWarnings</code></td>
<td>
<p>Logical, showWarnings?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Structure of directories and scripts for automating the compilation of
vehicular emissions inventory. The structure can be used with another type of
sources of emissions. The structure of the directories is: daily, ef, emi,
est, images, network and veh. This structure is a suggestion and the user can
use another.
'
ef: it is for storing the emission factors data-frame, similar to data(fe2015)
but including one column for each of the categories of the vehicular
composition. For instance, if PC = 5, there should be 5 columns with emission
factors in this file. If LCV = 5, another 5 columns should be present, and
so on.
</p>
<p>emi: Directory for saving the estimates. It is suggested to use .rds
extension instead of .rda.
</p>
<p>est: Directory with subdirectories matching the vehicular composition for
storing the scripts named input.R.
</p>
<p>images: Directory for saving images.
</p>
<p>network: Directory for saving the road network with the required attributes.
This file will include the vehicular flow per street to be used by age*
functions.
</p>
<p>veh: Directory for storing the distribution by age of use of each category of
the vehicular composition. Those are data-frames with number of columns with
the age distribution and number of rows as the number of streets. The class
of these objects is &quot;Vehicles&quot;. Future versions of vein will generate
Vehicles objects with the explicit spatial component.
</p>
<p>The name of the scripts and directories are based on the vehicular
composition, however, there is included a file named main.R which is just
an R script to estimate all the emissions. It is important to note that the
user must add the emission factors for other pollutants. Also, this function
creates the scripts input.R where the user must specify the inputs for the
estimation of emissions of each category. Also, there is a file called
traffic.R to generate objects of class &quot;Vehicles&quot;.
The user can rename these scripts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
name = file.path(tempdir(), "YourCity")
inventory(name = name)

## End(Not run)

</code></pre>

<hr>
<h2 id='long_to_wide'>Transform data.frame from long to wide format</h2><span id='topic+long_to_wide'></span>

<h3>Description</h3>

<p><code><a href="#topic+long_to_wide">long_to_wide</a></code> transform data.frame from long to
wide format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_to_wide(
  df,
  column_with_new_names = names(df)[1],
  column_with_data = "emission",
  column_fixed,
  net
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="long_to_wide_+3A_df">df</code></td>
<td>
<p>data.frame with three column.</p>
</td></tr>
<tr><td><code id="long_to_wide_+3A_column_with_new_names">column_with_new_names</code></td>
<td>
<p>Character, column that has new column names</p>
</td></tr>
<tr><td><code id="long_to_wide_+3A_column_with_data">column_with_data</code></td>
<td>
<p>Character column with data</p>
</td></tr>
<tr><td><code id="long_to_wide_+3A_column_fixed">column_fixed</code></td>
<td>
<p>Character,  column that will remain fixed</p>
</td></tr>
<tr><td><code id="long_to_wide_+3A_net">net</code></td>
<td>
<p>To return a sf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>wide data.frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emis_hot_td">emis_hot_td</a></code> <code><a href="#topic+emis_cold_td">emis_cold_td</a></code> <code><a href="#topic+wide_to_long">wide_to_long</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
df &lt;- data.frame(pollutant = rep(c("CO", "propadiene", "NO2"), 10),
                 emission = vein::Emissions(1:30),
                 region = rep(letters[1:2], 15))
df
long_to_wide(df)
long_to_wide(df, column_fixed = "region")

## End(Not run)
</code></pre>

<hr>
<h2 id='make_grid'>Creates rectangular grid for emission allocation</h2><span id='topic+make_grid'></span>

<h3>Description</h3>

<p><code>make_grid</code> creates a sf grid of polygons. The spatial
reference is taken from the spatial object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_grid(spobj, width, height = width, polygon, crs = 3857)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_grid_+3A_spobj">spobj</code></td>
<td>
<p>A spatial object of class sp or sf.</p>
</td></tr>
<tr><td><code id="make_grid_+3A_width">width</code></td>
<td>
<p>Width of grid cell. It is recommended to use projected values.</p>
</td></tr>
<tr><td><code id="make_grid_+3A_height">height</code></td>
<td>
<p>Height of grid cell.</p>
</td></tr>
<tr><td><code id="make_grid_+3A_polygon">polygon</code></td>
<td>
<p>Deprecated! <code><a href="#topic+make_grid">make_grid</a></code> returns only sf grid of
polygons.</p>
</td></tr>
<tr><td><code id="make_grid_+3A_crs">crs</code></td>
<td>
<p>coordinate reference system in numeric
format from
http://spatialreference.org/ to transform/project spatial data using sf::st_transform.
The default value is 3857, Pseudo Mercator</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A grid of polygons class 'sf'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
grid &lt;- make_grid(net, width = 0.5/102.47) #500 mts
plot(grid, axes = TRUE) #class sf
# make grid now returns warnings for crs with form +init...
#grid &lt;- make_grid(net, width = 0.5/102.47) #500 mts


## End(Not run)
</code></pre>

<hr>
<h2 id='moves_ef'>MOVES emission factors</h2><span id='topic+moves_ef'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_ef">moves_ef</a></code> reads and filter MOVES
data.frame of emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_ef(
  ef,
  vehicles,
  source_type_id = 21,
  process_id = 1,
  fuel_type_id = 1,
  pollutant_id = 2,
  road_type_id = 5,
  speed_bin
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_ef_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_vehicles">vehicles</code></td>
<td>
<p>Name of category, with length equal to fuel_type_id and other with id</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_source_type_id">source_type_id</code></td>
<td>
<p>Number to identify type of vehicle as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_process_id">process_id</code></td>
<td>
<p>Number to identify emission process defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_fuel_type_id">fuel_type_id</code></td>
<td>
<p>Number to identify type of fuel as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_pollutant_id">pollutant_id</code></td>
<td>
<p>Number to identify type of pollutant as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_road_type_id">road_type_id</code></td>
<td>
<p>Number to identify type of road as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_ef_+3A_speed_bin">speed_bin</code></td>
<td>
<p>Data.frame or vector of avgSpeedBinID as defined by MOVES.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EmissionFactors data.frame
</p>


<h3>Note</h3>

<p>'decoder' shows a decoder for MOVES to identify
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpd'>MOVES estimation of using rates per distance</h2><span id='topic+moves_rpd'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpd">moves_rpd</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpd(
  veh,
  lkm,
  ef,
  fuel_type,
  speed_bin,
  profile,
  source_type_id = 21,
  fuel_type_id = 1,
  pollutant_id = 91,
  road_type_id = 5,
  process_id = 1,
  vehicle = NULL,
  vehicle_type = NULL,
  fuel_subtype = NULL,
  net,
  path_all,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpd_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that ype of vehicle.
The number of rows is equal to the number of streets link.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_fuel_type">fuel_type</code></td>
<td>
<p>Data.frame of fuelSubtypeID exported by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_speed_bin">speed_bin</code></td>
<td>
<p>Data.frame or vector of avgSpeedBinID as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_profile">profile</code></td>
<td>
<p>Data.frame or Matrix with nrows equal to 24 and ncol 7 day of
the week</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_source_type_id">source_type_id</code></td>
<td>
<p>Number to identify type of vehicle as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_fuel_type_id">fuel_type_id</code></td>
<td>
<p>Number to identify type of fuel as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_pollutant_id">pollutant_id</code></td>
<td>
<p>Number to identify type of pollutant as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_road_type_id">road_type_id</code></td>
<td>
<p>Number to identify type of road as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_process_id">process_id</code></td>
<td>
<p>Number to identify type of pollutant as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_vehicle">vehicle</code></td>
<td>
<p>Character, type of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_vehicle_type">vehicle_type</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_fuel_subtype">fuel_subtype</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_net">net</code></td>
<td>
<p>Road network class sf</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_path_all">path_all</code></td>
<td>
<p>Character to export whole estimation. It is not recommended since it
is usually too heavy.</p>
</td></tr>
<tr><td><code id="moves_rpd_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories. See <code>link{emis_post}</code>
</p>


<h3>Note</h3>

<p>'decoder' shows a decoder for MOVES
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpdy'>MOVES estimation of using rates per distance by model year</h2><span id='topic+moves_rpdy'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpdy">moves_rpdy</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpdy(
  veh,
  lkm,
  ef,
  source_type_id = 21,
  fuel_type_id = 1,
  pollutant_id = 91,
  road_type_id = 5,
  fuel_type,
  speed_bin,
  profile,
  vehicle,
  vehicle_type,
  fuel_subtype,
  process_id,
  net,
  path_all,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpdy_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that ype of vehicle.
The number of rows is equal to the number of streets link.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_source_type_id">source_type_id</code></td>
<td>
<p>Number to identify type of vehicle as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_fuel_type_id">fuel_type_id</code></td>
<td>
<p>Number to identify type of fuel as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_pollutant_id">pollutant_id</code></td>
<td>
<p>Number to identify type of pollutant as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_road_type_id">road_type_id</code></td>
<td>
<p>Number to identify type of road as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_fuel_type">fuel_type</code></td>
<td>
<p>Data.frame of fuelSubtypeID exported by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_speed_bin">speed_bin</code></td>
<td>
<p>Data.frame or vector of avgSpeedBinID as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_profile">profile</code></td>
<td>
<p>Data.frame or Matrix with nrows equal to 24 and ncol 7 day of
the week</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_vehicle">vehicle</code></td>
<td>
<p>Character, type of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_vehicle_type">vehicle_type</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_fuel_subtype">fuel_subtype</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_process_id">process_id</code></td>
<td>
<p>Character, processID</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_net">net</code></td>
<td>
<p>Road network class sf</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_path_all">path_all</code></td>
<td>
<p>Character to export whole estimation. It is not recommended since it
is usually too heavy.</p>
</td></tr>
<tr><td><code id="moves_rpdy_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories. See <code>link{emis_post}</code>
</p>


<h3>Note</h3>

<p>'decoder' shows a decoder for MOVES
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpdy_meta'>MOVES estimation of using rates per distance by model year</h2><span id='topic+moves_rpdy_meta'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpdy_meta">moves_rpdy_meta</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpdy_meta(
  metadata,
  lkm,
  ef,
  fuel_type,
  speed_bin,
  profile,
  agemax = 31,
  net,
  simplify = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpdy_meta_+3A_metadata">metadata</code></td>
<td>
<p>data.frame with the metadata for a vein project for MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_fuel_type">fuel_type</code></td>
<td>
<p>Data.frame of fuelSubtypeID exported by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_speed_bin">speed_bin</code></td>
<td>
<p>Data.frame or vector of avgSpeedBinID as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_profile">profile</code></td>
<td>
<p>Data.frame or Matrix with nrows equal to 24 and ncol 7 day of
the week</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_agemax">agemax</code></td>
<td>
<p>Integer; max age for the fleet, assuming the same for all vehicles.</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_net">net</code></td>
<td>
<p>Road network class sf</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_simplify">simplify</code></td>
<td>
<p>Logical, to return the whole object or processed by streets and veh</p>
</td></tr>
<tr><td><code id="moves_rpdy_meta_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories.
</p>


<h3>Note</h3>

<p>The idea is the user enter with emissions factors by pollutant
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpdy_sf'>MOVES estimation of using rates per distance by model year</h2><span id='topic+moves_rpdy_sf'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpdy_sf">moves_rpdy_sf</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpdy_sf(
  veh,
  lkm,
  ef,
  speed_bin,
  profile,
  source_type_id = 21,
  vehicle = NULL,
  vehicle_type = NULL,
  fuel_subtype = NULL,
  path_all,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpdy_sf_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that ype of vehicle.
The number of rows is equal to the number of streets link.</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES
filtered by sourceTypeID and fuelTypeID.</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_speed_bin">speed_bin</code></td>
<td>
<p>Data.frame or vector of avgSpeedBinID as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_profile">profile</code></td>
<td>
<p>numeric vector  of normalized traffic for the morning rush hour</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_source_type_id">source_type_id</code></td>
<td>
<p>Number to identify type of vehicle as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_vehicle">vehicle</code></td>
<td>
<p>Character, type of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_vehicle_type">vehicle_type</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_fuel_subtype">fuel_subtype</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_path_all">path_all</code></td>
<td>
<p>Character to export whole estimation. It is not recommended since it
is usually too heavy.</p>
</td></tr>
<tr><td><code id="moves_rpdy_sf_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories. See <code>link{emis_post}</code>
</p>


<h3>Note</h3>

<p>'decoder' shows a decoder for MOVES
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpsy_meta'>MOVES estimation of using rates per start by model year</h2><span id='topic+moves_rpsy_meta'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpsy_meta">moves_rpsy_meta</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpsy_meta(
  metadata,
  lkm,
  ef,
  fuel_type,
  profile,
  agemax = 31,
  net,
  simplify = TRUE,
  verbose = FALSE,
  colk,
  colkt = F
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpsy_meta_+3A_metadata">metadata</code></td>
<td>
<p>data.frame with the metadata for a vein project for MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_fuel_type">fuel_type</code></td>
<td>
<p>Data.frame of fuelSubtypeID exported by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_profile">profile</code></td>
<td>
<p>Data.frame or Matrix with nrows equal to 24 and ncol 7 day of
the week</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_agemax">agemax</code></td>
<td>
<p>Integer; max age for the fleet, assuming the same for all vehicles.</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_net">net</code></td>
<td>
<p>Road network class sf</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_simplify">simplify</code></td>
<td>
<p>Logical, to return the whole object or processed by streets and veh</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_colk">colk</code></td>
<td>
<p>Character identifying a column in 'metadata' to multiply the emission factor</p>
</td></tr>
<tr><td><code id="moves_rpsy_meta_+3A_colkt">colkt</code></td>
<td>
<p>Logical, TRUE if 'colk' is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories.
</p>


<h3>Note</h3>

<p>The idea is the user enter with emissions factors by pollutant
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_rpsy_sf'>MOVES estimation of using rates per start by model year</h2><span id='topic+moves_rpsy_sf'></span>

<h3>Description</h3>

<p><code><a href="#topic+moves_rpsy_sf">moves_rpsy_sf</a></code> estimates running exhaust emissions
using MOVES emission factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_rpsy_sf(
  veh,
  lkm,
  ef,
  profile,
  source_type_id = 21,
  vehicle = NULL,
  vehicle_type = NULL,
  fuel_subtype = NULL,
  net,
  path_all,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_rpsy_sf_+3A_veh">veh</code></td>
<td>
<p>&quot;Vehicles&quot; data-frame or list of &quot;Vehicles&quot; data-frame. Each data-frame
as number of columns matching the age distribution of that type of vehicle.
The number of rows is equal to the number of streets link.</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link in miles</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_ef">ef</code></td>
<td>
<p>emission factors from EmissionRates_running exported from MOVES
filtered by sourceTypeID and fuelTypeID.</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_profile">profile</code></td>
<td>
<p>numeric vector  of normalized traffic for the morning rush hour</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_source_type_id">source_type_id</code></td>
<td>
<p>Number to identify type of vehicle as defined by MOVES.</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_vehicle">vehicle</code></td>
<td>
<p>Character, type of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_vehicle_type">vehicle_type</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_fuel_subtype">fuel_subtype</code></td>
<td>
<p>Character, subtype of vehicle</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_net">net</code></td>
<td>
<p>Road network class sf</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_path_all">path_all</code></td>
<td>
<p>Character to export whole estimation. It is not recommended since it
is usually too heavy.</p>
</td></tr>
<tr><td><code id="moves_rpsy_sf_+3A_verbose">verbose</code></td>
<td>
<p>Logical; To show more information. Not implemented yet</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with emissions at each street and data.base aggregated by categories. See <code>link{emis_post}</code>
</p>


<h3>Note</h3>

<p>'decoder' shows a decoder for MOVES
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(decoder)
decoder
}
</code></pre>

<hr>
<h2 id='moves_speed'>Return speed bins according to US/EPA MOVES model</h2><span id='topic+moves_speed'></span>

<h3>Description</h3>

<p><code>speed_moves</code> return an object of average speed bins as defined by
US EPA MOVES. The input must be speed as miles/h (mph)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moves_speed(x, net)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moves_speed_+3A_x">x</code></td>
<td>
<p>Object with class, &quot;sf&quot;,  &quot;data.frame&quot;, &quot;matrix&quot; or &quot;numeric&quot; with speeds
in miles/h (mph)</p>
</td></tr>
<tr><td><code id="moves_speed_+3A_net">net</code></td>
<td>
<p>optional  spatial dataframe of class &quot;sf&quot;.
it is transformed to &quot;sf&quot;.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
net$mph &lt;- units::set_units(net$ps, "miles/h")
net$speed_bins &lt;- moves_speed(net$mph)
head(net)
moves_speed(net["ps"])
}
</code></pre>

<hr>
<h2 id='my_age'>Returns amount of vehicles at each age</h2><span id='topic+my_age'></span>

<h3>Description</h3>

<p><code>my_age</code> returns amount of vehicles at each age using a
numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>my_age(
  x,
  y,
  agemax,
  name = "vehicle",
  k = 1,
  pro_street,
  net,
  verbose = FALSE,
  namerows
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="my_age_+3A_x">x</code></td>
<td>
<p>Numeric; vehicles by street (or spatial feature).</p>
</td></tr>
<tr><td><code id="my_age_+3A_y">y</code></td>
<td>
<p>Numeric or data.frame; when pro_street is not available, y must be
'numeric', else, a 'data.frame'. The names of the columns of this data.frame
must be the same as the elements of pro_street and each column must have a
profile of age of use of vehicle. When 'y' is 'numeric' the vehicles
has the same age distribution to all streets. When 'y' is a data.frame,
the distribution by age of use varies the streets.</p>
</td></tr>
<tr><td><code id="my_age_+3A_agemax">agemax</code></td>
<td>
<p>Integer; age of oldest vehicles for that category</p>
</td></tr>
<tr><td><code id="my_age_+3A_name">name</code></td>
<td>
<p>Character; of vehicle assigned to columns of dataframe.</p>
</td></tr>
<tr><td><code id="my_age_+3A_k">k</code></td>
<td>
<p>Integer; multiplication factor. If its length is &gt; 1, it must match the length of x</p>
</td></tr>
<tr><td><code id="my_age_+3A_pro_street">pro_street</code></td>
<td>
<p>Character; each category of profile for each street.
The length of this character vector must be equal to the length of 'x'. The
names of the data.frame 'y' must have the same content of 'pro_street'</p>
</td></tr>
<tr><td><code id="my_age_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="my_age_+3A_verbose">verbose</code></td>
<td>
<p>Logical; message with average age and total number of vehicles.</p>
</td></tr>
<tr><td><code id="my_age_+3A_namerows">namerows</code></td>
<td>
<p>Any vector to be change row.names. For instance, the name of
regions or streets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of age distribution of vehicles.
</p>


<h3>Note</h3>

<p>The functions age* produce distribution of the circulating fleet by age of use.
The order of using these functions is:
</p>
<p>1. If you know the distribution of the vehicles by age of use , use:  <code><a href="#topic+my_age">my_age</a></code>
2. If you know the sales of vehicles, or (the regis)*better) the registry of new vehicles,
use <code><a href="#topic+age">age</a></code> to apply a survival function.
3. If you know the theoretical shape of the circulating fleet and you can use
<code><a href="#topic+age_ldv">age_ldv</a></code>, <code><a href="#topic+age_hdv">age_hdv</a></code> or <code><a href="#topic+age_moto">age_moto</a></code>. For instance,
you dont know the sales or registry of vehicles, but somehow you know
the shape of this curve.
4. You can use/merge/transform/adapt any of these functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
dpc &lt;- c(seq(1,20,3), 20:10)
PC_E25_1400 &lt;- my_age(x = net$ldv, y = dpc, name = "PC_E25_1400")
class(PC_E25_1400)
plot(PC_E25_1400)
PC_E25_1400sf &lt;- my_age(x = net$ldv, y = dpc, name = "PC_E25_1400", net = net)
class(PC_E25_1400sf)
plot(PC_E25_1400sf)
PC_E25_1400nsf &lt;- sf::st_set_geometry(PC_E25_1400sf, NULL)
class(PC_E25_1400nsf)
yy &lt;- data.frame(a = 1:5, b = 5:1)    # perfiles por categoria de calle
pro_street &lt;- c("a", "b", "a")         # categorias de cada calle
x &lt;- c(100,5000, 3)                               # vehiculos
my_age(x = x, y =  yy, pro_street = pro_street)

## End(Not run)
</code></pre>

<hr>
<h2 id='net'>Road network of the west part of Sao Paulo city</h2><span id='topic+net'></span>

<h3>Description</h3>

<p>This dataset is an sf class object with roads
from a traffic simulation made by CET Sao Paulo, Brazil
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(net)
</code></pre>


<h3>Format</h3>

<p>A Spatial data.frame (sf) with 1796 rows and 1 variables:
</p>

<dl>
<dt>ldv</dt><dd><p>Light Duty Vehicles (veh/h)</p>
</dd>
<dt>hdv</dt><dd><p>Heavy Duty Vehicles (veh/h)</p>
</dd>
<dt>lkm</dt><dd><p>Length of the link (km)</p>
</dd>
<dt>ps</dt><dd><p>Peak Speed (km/h)</p>
</dd>
<dt>ffs</dt><dd><p>Free Flow Speed (km/h)</p>
</dd>
<dt>tstreet</dt><dd><p>Type of street</p>
</dd>
<dt>lanes</dt><dd><p>Number of lanes per link</p>
</dd>
<dt>capacity</dt><dd><p>Capacity of vehicles in each link (1/h)</p>
</dd>
<dt>tmin</dt><dd><p>Time for travelling each link (min)</p>
</dd>
<dt>geometry</dt><dd><p>geometry</p>
</dd>
</dl>


<hr>
<h2 id='netspeed'>Calculate speeds of traffic network</h2><span id='topic+netspeed'></span>

<h3>Description</h3>

<p><code>netspeed</code> Creates a dataframe of speeds for different hours
and each link based on morning rush traffic data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>netspeed(
  q = 1,
  ps,
  ffs,
  cap,
  lkm,
  alpha = 0.15,
  beta = 4,
  net,
  scheme = FALSE,
  dist = "km"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="netspeed_+3A_q">q</code></td>
<td>
<p>Data-frame of traffic flow to each hour (veh/h)</p>
</td></tr>
<tr><td><code id="netspeed_+3A_ps">ps</code></td>
<td>
<p>Peak speed (km/h)</p>
</td></tr>
<tr><td><code id="netspeed_+3A_ffs">ffs</code></td>
<td>
<p>Free flow speed (km/h)</p>
</td></tr>
<tr><td><code id="netspeed_+3A_cap">cap</code></td>
<td>
<p>Capacity of link (veh/h)</p>
</td></tr>
<tr><td><code id="netspeed_+3A_lkm">lkm</code></td>
<td>
<p>Distance of link (km)</p>
</td></tr>
<tr><td><code id="netspeed_+3A_alpha">alpha</code></td>
<td>
<p>Parameter of BPR curves</p>
</td></tr>
<tr><td><code id="netspeed_+3A_beta">beta</code></td>
<td>
<p>Parameter of BPR curves</p>
</td></tr>
<tr><td><code id="netspeed_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="netspeed_+3A_scheme">scheme</code></td>
<td>
<p>Logical to create a Speed data-frame with 24 hours and a
default  profile. It needs ffs and ps:</p>
</td></tr>
<tr><td><code id="netspeed_+3A_dist">dist</code></td>
<td>
<p>String indicating the units of the resulting distance in speed.
Default is units from peak speed 'ps'
</p>

<table>
<tr>
 <td style="text-align: right;">
  00:00-06:00 </td><td style="text-align: left;"> ffs</td>
</tr>
<tr>
 <td style="text-align: right;">
  06:00-07:00 </td><td style="text-align: left;"> average between ffs and ps</td>
</tr>
<tr>
 <td style="text-align: right;">
  07:00-10:00 </td><td style="text-align: left;"> ps</td>
</tr>
<tr>
 <td style="text-align: right;">
  10:00-17:00 </td><td style="text-align: left;"> average between ffs and ps</td>
</tr>
<tr>
 <td style="text-align: right;">
  17:00-20:00 </td><td style="text-align: left;"> ps</td>
</tr>
<tr>
 <td style="text-align: right;">
  20:00-22:00 </td><td style="text-align: left;"> average between ffs and ps</td>
</tr>
<tr>
 <td style="text-align: right;">
  22:00-00:00 </td><td style="text-align: left;"> ffs</td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe speeds with units or sf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
data(pc_profile)
pc_week &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
df &lt;- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
class(df)
plot(df) #plot of the average speed at each hour, +- sd
# net$ps &lt;- units::set_units(net$ps, "miles/h")
# net$ffs &lt;- units::set_units(net$ffs, "miles/h")
# df &lt;- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, alpha = 1)
# class(df)
# plot(df) #plot of the average speed at each hour, +- sd
# df &lt;- netspeed(ps = net$ps, ffs = net$ffs, scheme = TRUE)
# class(df)
# plot(df) #plot of the average speed at each hour, +- sd
# dfsf &lt;- netspeed(ps = net$ps, ffs = net$ffs, scheme = TRUE, net = net)
# class(dfsf)
# head(dfsf)
# plot(dfsf, pal = cptcity::lucky(colorRampPalette = TRUE, rev = TRUE),
# key.pos = 1, max.plot = 9)
}
</code></pre>

<hr>
<h2 id='pc_cold'>Profile of Vehicle start patterns</h2><span id='topic+pc_cold'></span>

<h3>Description</h3>

<p>This dataset is a dataframe with percentage of hourly starts with a lapse
of 6 hours with engine turned off. Data source is:
Lents J., Davis N., Nikkila N., Osses M. 2004. Sao Paulo vehicle activity
study. ISSRC. www.issrc.org
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pc_cold)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 1 variables:
</p>

<dl>
<dt>V1</dt><dd><p>24 hours profile vehicle starts for Monday</p>
</dd>
</dl>


<hr>
<h2 id='pc_profile'>Profile of traffic data 24 hours 7 n days of the week</h2><span id='topic+pc_profile'></span>

<h3>Description</h3>

<p>This dataset is a dataframe with traffic activity normalized
monday 08:00-09:00. This data is normalized at 08:00-09:00.
It comes from data of toll stations near Sao Paulo City.
The source is ARTESP (www.artesp.com.br)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pc_profile)
</code></pre>


<h3>Format</h3>

<p>A data frame with 24 rows and 7 variables:
</p>

<dl>
<dt>V1</dt><dd><p>24 hours profile for Monday</p>
</dd>
<dt>V2</dt><dd><p>24 hours profile for Tuesday</p>
</dd>
<dt>V3</dt><dd><p>24 hours profile for Wednesday</p>
</dd>
<dt>V4</dt><dd><p>24 hours profile for Thursday</p>
</dd>
<dt>V5</dt><dd><p>24 hours profile for Friday</p>
</dd>
<dt>V6</dt><dd><p>24 hours profile for Saturday</p>
</dd>
<dt>V7</dt><dd><p>24 hours profile for Sunday</p>
</dd>
</dl>


<hr>
<h2 id='pollutants'>Data.frame with pollutants names and molar mass used in VEIN</h2><span id='topic+pollutants'></span>

<h3>Description</h3>

<p>This dataset also includes MIR, MOIR and EBIR is Carter SAPRC07.xls
https://www.engr.ucr.edu/~carter/SAPRC/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pollutants)
</code></pre>


<h3>Format</h3>

<p>A data frame with 148 rows and 10 variables:
</p>

<dl>
<dt>n</dt><dd><p>Number for each pollutant, from 1 to 132</p>
</dd>
<dt>group1</dt><dd><p>classification for pollutants including &quot;NMHC&quot;,
&quot;PAH&quot;, &quot;METALS&quot;, &quot;PM&quot;, &quot;criteria&quot; and &quot;PCDD&quot; </p>
</dd>
<dt>group2</dt><dd><p>A sub classification for pollutants including &quot;alkenes&quot;,
&quot;alkynes&quot;, &quot;aromatics&quot;, &quot;alkanes&quot;,  &quot;PAH&quot;,, &quot;aldehydes&quot;, &quot;ketones&quot;, &quot;METALS&quot;,
&quot;PM_char&quot;, &quot;criteria&quot;, &quot;cycloalkanes&quot;, &quot;NMHC&quot;,  &quot;PCDD&quot;, &quot;PM10&quot;, &quot;PM2.5&quot;</p>
</dd>
<dt>pollutant</dt><dd><p>1 of the 132 pollutants covered</p>
</dd>
<dt>CAS</dt><dd><p>CAS Registry Number</p>
</dd>
<dt>g_mol</dt><dd><p>molar mass</p>
</dd>
<dt>MIR</dt><dd><p>Maximum incremental Reactivity (gm O3 / gm VOC)</p>
</dd>
<dt>MOIR</dt><dd><p>Reactivity (gm O3 / gm VOC)</p>
</dd>
<dt>EBIR</dt><dd><p>Reactivity (gm O3 / gm VOC)</p>
</dd>
<dt>notes</dt><dd><p>Inform some assumption for molar mass</p>
</dd>
</dl>


<hr>
<h2 id='profiles'>Profile of traffic data 24 hours 7 n days of the week</h2><span id='topic+profiles'></span>

<h3>Description</h3>

<p>This dataset is n a list of data-frames with traffic activity normalized
monday 08:00-09:00. It comes from data of toll stations near Sao Paulo City.
The source is ARTESP (www.artesp.com.br) for months January and June and
years 2012, 2013 and 2014. The type of vehicles covered are PC, LCV, MC and
HGV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(pc_profile)
</code></pre>


<h3>Format</h3>

<p>A list of data-frames with 24 rows and 7 variables:
</p>

<dl>
<dt>PC_JUNE_2012</dt><dd><p>168 hours</p>
</dd>
<dt>PC_JUNE_2013</dt><dd><p>168 hours</p>
</dd>
<dt>PC_JUNE_2014</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JUNE_2012</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JUNE_2013</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JUNE_2014</dt><dd><p>168 hours</p>
</dd>
<dt>MC_JUNE_2012</dt><dd><p>168 hours</p>
</dd>
<dt>MC_JUNE_2013</dt><dd><p>168 hours</p>
</dd>
<dt>MC_JUNE_2014</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JUNE_2012</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JUNE_2013</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JUNE_2014</dt><dd><p>168 hours</p>
</dd>
<dt>PC_JANUARY_2012</dt><dd><p>168 hours</p>
</dd>
<dt>PC_JANUARY_2013</dt><dd><p>168 hours</p>
</dd>
<dt>PC_JANUARY_2014</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JANUARY_2012</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JANUARY_2013</dt><dd><p>168 hours</p>
</dd>
<dt>LCV_JANUARY_2014</dt><dd><p>168 hours</p>
</dd>
<dt>MC_JANUARY_2012</dt><dd><p>168 hours</p>
</dd>
<dt>MC_JANUARY_2014</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JANUARY_2012</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JANUARY_2013</dt><dd><p>168 hours</p>
</dd>
<dt>HGV_JANUARY_2014</dt><dd><p>168 hours</p>
</dd>
</dl>


<hr>
<h2 id='remove_units'>Remove units</h2><span id='topic+remove_units'></span>

<h3>Description</h3>

<p><code><a href="#topic+remove_units">remove_units</a></code> Remove units from sf,  data.frames, matrix or units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_units(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_units_+3A_x">x</code></td>
<td>
<p>Object with class &quot;sf&quot;,  &quot;data.frame&quot;, &quot;matrix&quot; or &quot;units&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>&quot;sf&quot;, data.frame&quot;, &quot;matrix&quot; or numeric
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ef1 &lt;- ef_cetesb(p = "CO", c("PC_G", "PC_FE"))
class(ef1)
sapply(ef1, class)
a &lt;- remove_units(ef1)

## End(Not run)
</code></pre>

<hr>
<h2 id='running_losses-deprecated'>Estimation of average daily  hot-soak evaporative emissions</h2><span id='topic+running_losses-deprecated'></span>

<h3>Description</h3>

<p><code>hot_soak</code> estimates of evaporative emissions from EMEP/EEA
emisison guidelines
</p>
<p><code>running_losses</code> estimates evaporative emissions from
EMEP/EEA emisison guidelines
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="running_losses-deprecated_+3A_eshotc">eshotc</code></td>
<td>
<p>average daily hot-soak evaporative factor for vehicles with
carburetor or fuel return system</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_eswarmc">eswarmc</code></td>
<td>
<p>average daily cold-warm-soak evaporative factor for vehicles
with carburator or fuel return system</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_eshotfi">eshotfi</code></td>
<td>
<p>average daily hot-soak evaporative factor for vehicles
with fuel injection and returnless fuel systems</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_x">x</code></td>
<td>
<p>Numeric or data.frame; Mean number of trips per vehicle per day or Vehicles.</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_erhotfi">erhotfi</code></td>
<td>
<p>average daily hot running losses evaporative factor
for vehicles with fuel injection and returnless fuel systems</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_lkm">lkm</code></td>
<td>
<p>Numeric with class units and unit km.</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_carb">carb</code></td>
<td>
<p>fraction of gasoline vehicles with carburetor or fuel return system.</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_p">p</code></td>
<td>
<p>Fraction of trips finished with hot engine</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_erhotc">erhotc</code></td>
<td>
<p>average daily running losses evaporative factor for vehicles with
carburator or fuel return system</p>
</td></tr>
<tr><td><code id="running_losses-deprecated_+3A_erwarmc">erwarmc</code></td>
<td>
<p>average daily cold and warm running losses evaporative factor
for vehicles with carburetor or fuel return system</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of emission estimation in grams
</p>
<p>numeric vector of emission estimation in grams
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vein-deprecated">vein-deprecated</a></code>
</p>
<p><code><a href="#topic+vein-deprecated">vein-deprecated</a></code>
</p>

<hr>
<h2 id='speciate'>Speciation of emissions</h2><span id='topic+speciate'></span>

<h3>Description</h3>

<p><code>speciate</code> separates emissions in different compounds.
It covers black carbon and organic matter from particulate matter. Soon it
will be added more speciations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>speciate(
  x = 1,
  spec = "bcom",
  veh,
  fuel,
  eu,
  list = FALSE,
  pmpar,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="speciate_+3A_x">x</code></td>
<td>
<p>Emissions estimation</p>
</td></tr>
<tr><td><code id="speciate_+3A_spec">spec</code></td>
<td>
<p>The speciations are:
</p>

<ul>
<li><p>&quot;bcom&quot;: Splits PM2.5 in black carbon and organic matter.
</p>
</li>
<li><p>&quot;tyre&quot; or &quot;tire&quot;: Splits PM in PM10, PM2.5, PM1 and PM0.1.
</p>
</li>
<li><p>&quot;brake&quot;: Splits PM in PM10, PM2.5, PM1 and PM0.1.
</p>
</li>
<li><p>&quot;road&quot;: Splits PM in PM10 and PM2.5.
</p>
</li>
<li><p>&quot;nox&quot;: Splits NOx in NO and NO2.
</p>
</li>
<li><p>&quot;nmhc&quot;: Splits NMHC in compounds, see <code><a href="#topic+ef_ldv_speed">ef_ldv_speed</a></code>.
</p>
</li>
<li><p>&quot;pmiag&quot;, &quot;pmneu&quot;,  &quot;pmneu2&quot;: Splits PM in groups, see note below.
</p>
</li></ul>
</td></tr>
<tr><td><code id="speciate_+3A_veh">veh</code></td>
<td>
<p>Type of vehicle:
</p>

<ul>
<li><p>&quot;bcom&quot;: veh can be &quot;PC&quot;, &quot;LCV&quot;, HDV&quot; or &quot;Motorcycle&quot;.
</p>
</li>
<li><p>&quot;tyre&quot; or &quot;tire&quot;: not necessary.
</p>
</li>
<li><p>&quot;brake&quot;: not necessary.
</p>
</li>
<li><p>&quot;road&quot;: not necessary.
</p>
</li>
<li><p>&quot;nox&quot;: veh can be &quot;PC&quot;, &quot;LCV&quot;, HDV&quot; or &quot;Motorcycle&quot;.
</p>
</li>
<li><p>&quot;nmhc&quot;see below
</p>
</li>
<li><p>&quot;&quot;pmiag&quot;, &quot;pmneu&quot;,  &quot;pmneu2&quot;: not necessary.
</p>
</li></ul>
</td></tr>
<tr><td><code id="speciate_+3A_fuel">fuel</code></td>
<td>
<p>Fuel.
</p>

<ul>
<li><p>&quot;bcom&quot;: &quot;G&quot; or &quot;D&quot;.
</p>
</li>
<li><p>&quot;tyre&quot; or &quot;tire&quot;: not necessary.
</p>
</li>
<li><p>&quot;brake&quot;: not necessary.
</p>
</li>
<li><p>&quot;road&quot;: not necessary.
</p>
</li>
<li><p>&quot;nox&quot;: &quot;G&quot;, &quot;D&quot;, &quot;LPG&quot;, &quot;E85&quot; or &quot;CNG&quot;.
</p>
</li>
<li><p>&quot;nmhc&quot;see below
</p>
</li>
<li><p>&quot;pmiag&quot;, &quot;pmneu&quot;,  &quot;pmneu2&quot;: not necessary.
</p>
</li></ul>
</td></tr>
<tr><td><code id="speciate_+3A_eu">eu</code></td>
<td>
<p>Emission standard
</p>

<ul>
<li><p>&quot;bcom&quot;: &quot;G&quot; or &quot;D&quot;.
</p>
</li>
<li><p>&quot;tyre&quot; or &quot;tire&quot;: not necessary.
</p>
</li>
<li><p>&quot;brake&quot;: not necessary.
</p>
</li>
<li><p>&quot;road&quot;: not necessary.
</p>
</li>
<li><p>&quot;nox&quot;: &quot;G&quot;, &quot;D&quot;, &quot;LPG&quot;, &quot;E85&quot; or &quot;CNG&quot;.
</p>
</li>
<li><p>&quot;nmhc&quot;see below
</p>
</li>
<li><p>&quot;pmiag&quot;, &quot;pmneu&quot;,  &quot;pmneu2&quot;: not necessary.
</p>
</li></ul>
</td></tr>
<tr><td><code id="speciate_+3A_list">list</code></td>
<td>
<p>when TRUE returns a list with number of elements of the list as
the number species of pollutants</p>
</td></tr>
<tr><td><code id="speciate_+3A_pmpar">pmpar</code></td>
<td>
<p>Numeric vector for PM speciation eg:
c(e_so4i = 0.0077,  e_so4j = 0.0623,  e_no3i = 0.00247,
e_no3j = 0.01053,  e_pm25i = 0.1,  e_pm25j = 0.3,
e_orgi = 0.0304,  e_orgj = 0.1296,  e_eci = 0.056,
e_ecj = 0.024,  h2o = 0.277) These are default values. however, when this
argument is present, new values are used.</p>
</td></tr>
<tr><td><code id="speciate_+3A_verbose">verbose</code></td>
<td>
<p>Logical to show more information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dataframe of speciation in grams or mols
</p>


<h3>Note</h3>

<p>options for spec &quot;nmhc&quot;:
</p>

<table>
<tr>
 <td style="text-align: center;">
   veh </td><td style="text-align: center;"> fuel </td><td style="text-align: center;"> eu          </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> PRE         </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> I           </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> all         </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> all         </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> LPG  </td><td style="text-align: center;"> all         </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> Evaporative </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E25  </td><td style="text-align: center;"> Evaporative </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E100 </td><td style="text-align: center;"> Evaporative </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E25  </td><td style="text-align: center;"> Exhaust     </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E100 </td><td style="text-align: center;"> Exhaust     </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> B5   </td><td style="text-align: center;"> Exhaust     </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E85  </td><td style="text-align: center;"> Exhaust     </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> E85  </td><td style="text-align: center;"> Evaporative </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> CNG  </td><td style="text-align: center;"> Exhaust     </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL </td><td style="text-align: center;"> E100 </td><td style="text-align: center;"> Liquid      </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> Liquid      </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL </td><td style="text-align: center;"> E25  </td><td style="text-align: center;"> Liquid      </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL </td><td style="text-align: center;"> ALL  </td><td style="text-align: center;"> OM          </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001      </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002      </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003      </td>
</tr>
<tr>
 <td style="text-align: center;">
   MC  </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-004      </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL  </td><td style="text-align: center;"> LPG </td><td style="text-align: center;"> OM-005      </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-001  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-002  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-003  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-004  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-005  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-006  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-001-007  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-001  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-002  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-003  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-004  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-005  </td>
</tr>
<tr>
 <td style="text-align: center;">
   LDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-002-006  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-001  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-002  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-003  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-004  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-005  </td>
</tr>
<tr>
 <td style="text-align: center;">
   HDV </td><td style="text-align: center;"> D    </td><td style="text-align: center;"> OM-003-006  </td>
</tr>
<tr>
 <td style="text-align: center;">
   MC  </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-004-001  </td>
</tr>
<tr>
 <td style="text-align: center;">
   MC  </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-004-002  </td>
</tr>
<tr>
 <td style="text-align: center;">
   MC  </td><td style="text-align: center;"> G    </td><td style="text-align: center;"> OM-004-003  </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL  </td><td style="text-align: center;"> ALL    </td><td style="text-align: center;"> urban  </td>
</tr>
<tr>
 <td style="text-align: center;">
   ALL  </td><td style="text-align: center;"> ALL    </td><td style="text-align: center;"> highway  </td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>

<p>after eu = OM, all profiles are Chinese
# the following specs will be removed soon
</p>

<ul>
<li><p>&quot;iag_racm&quot;: ethanol emissions added in hc3.
</p>
</li>
<li><p>&quot;iag&quot; or &quot;iag_cb05&quot;: Splits NMHC by CB05 (WRF exb05_opt1) group .
</p>
</li>
<li><p>&quot;petroiag_cb05&quot;: Splits NMHC by CB05 (WRF exb05_opt1) group .
</p>
</li>
<li><p>&quot;iag_cb05v2&quot;: Splits NMHC by CB05 (WRF exb05_opt2) group .
</p>
</li>
<li><p>&quot;neu_cb05&quot;: Splits NMHC by CB05 (WRF exb05_opt2) group alternative.
</p>
</li>
<li><p>&quot;petroiag_cb05v2&quot;: Splits NMHC by CB05 (WRF exb05_opt2) group alternative.
</p>
</li></ul>

<p>spec <strong>&quot;pmiag&quot;</strong> speciate pm2.5 into e_so4i, e_so4j, e_no3i,
e_no3j, e_mp2.5i, e_mp2.5j, e_orgi, e_orgj, e_eci, e_ecj and h2o. Reference:
Rafee, S.: Estudo numerico do impacto das emissoes veiculares e fixas da
cidade de Manaus nas concentracoes de poluentes atmosfericos da regiao
amazonica, Master thesis, Londrina: Universidade Tecnologica Federal do
Parana, 2015.
</p>
<p>specs: &quot;neu_cb05&quot;, &quot;pmneu&quot; and &quot;pmneu2&quot; provided by Daniel Schuch,
from Northeastern University.
&quot;pm2023&quot; provided by Iara da Silva; Leila D. Martins
</p>
<p>Speciation with fuels <strong>&quot;E25&quot;, &quot;E100&quot; and &quot;B5&quot;</strong> made by Prof. Leila Martins (UTFPR),
represents BRAZILIAN fuel
</p>
<p>pmiag2 pass the mass only on j fraction
</p>


<h3>References</h3>

<p>&quot;bcom&quot;: Ntziachristos and Zamaras. 2016. Passenger cars, light
commercial trucks, heavy-duty vehicles including buses and motorcycles. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2016
</p>
<p>&quot;tyre&quot;, &quot;brake&quot; and &quot;road&quot;: Ntziachristos and Boulter 2016.
Automobile tyre and brake wear and road abrasion. In: EEA, EMEP. EEA air
pollutant emission inventory
guidebook-2009. European Environment Agency, Copenhagen, 2016
</p>
<p>&quot;iag&quot;: Ibarra-Espinosa S. Air pollution modeling in Sao Paulo
using bottom-up vehicular emissions inventories. 2017. PhD thesis. Instituto de
Astronomia, Geofisica e Ciencias Atmosfericas, Universidade de Sao Paulo,
Sao Paulo, page 88.
Speciate EPA: https://cfpub.epa.gov/speciate/. :
K. Sexton, H. Westberg, &quot;Ambient hydrocarbon and ozone measurements downwind
of a large automotive painting plant&quot; Environ. Sci. Tchnol. 14:329 (1980).P.A.
Scheff, R.A. Schauer, James J., Kleeman, Mike J., Cass, Glen R., Characterization
and Control of Organic Compounds Emitted from Air Pollution Sources, Final Report,
Contract 93-329, prepared for California Air Resources Board Research Division,
Sacramento, CA, April 1998.
2004 NPRI National Databases as of April 25, 2006,
http://www.ec.gc.ca/pdb/npri/npri_dat_rep_e.cfm. Memorandum
Proposed procedures for preparing composite speciation profiles using
Environment Canada s National Pollutant Release Inventory (NPRI) for
stationary sources, prepared by Ying Hsu and Randy Strait of E.H. Pechan
Associates, Inc. for David Niemi, Marc Deslauriers, and Lisa Graham of
Environment Canada, September 26, 2006.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
pm &lt;- rnorm(n = 100, mean = 400, sd = 2)
(df &lt;- speciate(pm, veh = "PC", fuel = "G", eu = "I"))
(df &lt;- speciate(pm, spec = "brake", veh = "PC", fuel = "G", eu = "I"))
(dfa &lt;- speciate(pm, spec = "iag", veh = "veh", fuel = "G", eu = "Exhaust"))
(dfb &lt;- speciate(pm, spec = "iag_cb05v2", veh = "veh", fuel = "G", eu = "Exhaust"))
(dfb &lt;- speciate(pm, spec = "neu_cb05", veh = "veh", fuel = "G", eu = "Exhaust"))
pm &lt;- units::set_units(pm, "g/km^2/h")
#(dfb &lt;- speciate(as.data.frame(pm), spec = "pmiag", veh = "veh", fuel = "G", eu = "Exhaust"))
#(dfb &lt;- speciate(as.data.frame(pm), spec = "pmneu", veh = "veh", fuel = "G", eu = "Exhaust"))
#(dfb &lt;- speciate(as.data.frame(pm), spec = "pmneu2", veh = "veh", fuel = "G", eu = "Exhaust"))
# new
(pah &lt;- speciate(spec = "pah", veh = "LDV", fuel = "G", eu = "I"))
(xs &lt;- speciate(spec = "pcdd", veh = "LDV", fuel = "G", eu = "I"))
(xs &lt;- speciate(spec = "pmchar", veh = "LDV", fuel = "G", eu = "I"))
(xs &lt;- speciate(spec = "metals", veh = "LDV", fuel = "G", eu = "all"))

## End(Not run)
</code></pre>

<hr>
<h2 id='Speed'>Construction function for class &quot;Speed&quot;</h2><span id='topic+Speed'></span><span id='topic+print.Speed'></span><span id='topic+summary.Speed'></span><span id='topic+plot.Speed'></span>

<h3>Description</h3>

<p><code>Speed</code> returns a transformed object with class &quot;Speed&quot; and units
km/h. This function includes two arguments, distance and time. Therefore,
it is possible to change the units of the speed to &quot;m&quot; to &quot;s&quot; for example.
This function returns a data.frame with units for speed. When this function
is applied to numeric vectors it adds class &quot;units&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Speed(x, ..., dist = "km", time = "h")

## S3 method for class 'Speed'
print(x, ...)

## S3 method for class 'Speed'
summary(object, ...)

## S3 method for class 'Speed'
plot(
  x,
  pal = "mpl_inferno",
  rev = FALSE,
  fig1 = c(0, 0.8, 0, 0.8),
  fig2 = c(0, 0.8, 0.55, 1),
  fig3 = c(0.7, 1, 0, 0.8),
  mai1 = c(1, 0.82, 0.82, 0.42),
  mai2 = c(1.8, 0.82, 0.5, 0.42),
  mai3 = c(1, 1, 0.82, 0.2),
  bias = 1.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Speed_+3A_x">x</code></td>
<td>
<p>Object with class &quot;data.frame&quot;, &quot;matrix&quot; or &quot;numeric&quot;</p>
</td></tr>
<tr><td><code id="Speed_+3A_...">...</code></td>
<td>
<p>ignored
Default is units is &quot;km&quot;</p>
</td></tr>
<tr><td><code id="Speed_+3A_dist">dist</code></td>
<td>
<p>String indicating the units of the resulting distance in speed.</p>
</td></tr>
<tr><td><code id="Speed_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, default is &quot;h&quot;</p>
</td></tr>
<tr><td><code id="Speed_+3A_object">object</code></td>
<td>
<p>Object with class &quot;Speed&quot;</p>
</td></tr>
<tr><td><code id="Speed_+3A_pal">pal</code></td>
<td>
<p>Palette of colors available or the number of the position</p>
</td></tr>
<tr><td><code id="Speed_+3A_rev">rev</code></td>
<td>
<p>Logical; to internally revert order of rgb color vectors.</p>
</td></tr>
<tr><td><code id="Speed_+3A_fig1">fig1</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_fig2">fig2</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_fig3">fig3</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_mai1">mai1</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_mai2">mai2</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_mai3">mai3</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Speed_+3A_bias">bias</code></td>
<td>
<p>positive number. Higher values give more widely spaced colors at the high end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Constructor for class &quot;Speed&quot; or &quot;units&quot;
</p>


<h3>Note</h3>

<p>default time unit for speed is hour
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+units">units</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
data(net)
data(pc_profile)
speed &lt;- Speed(net$ps)
class(speed)
plot(speed, type = "l")
pc_week &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
df &lt;- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm)
summary(df)
plot(df)
# changing to miles
net$ps &lt;- units::set_units(net$ps, "miles/h")
net$ffs &lt;- units::set_units(net$ffs, "miles/h")
net$lkm &lt;- units::set_units(net$lkm, "miles")
df &lt;- netspeed(pc_week, net$ps, net$ffs, net$capacity, net$lkm, dist = "miles")
plot(df)
}
</code></pre>

<hr>
<h2 id='split_emis'>Split street emissions based on a grid</h2><span id='topic+split_emis'></span>

<h3>Description</h3>

<p><code><a href="#topic+split_emis">split_emis</a></code> split street emissions into a grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_emis(net, distance, add_column, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_emis_+3A_net">net</code></td>
<td>
<p>A spatial dataframe of class &quot;sp&quot; or &quot;sf&quot;. When class is &quot;sp&quot;
it is transformed to &quot;sf&quot; with emissions.</p>
</td></tr>
<tr><td><code id="split_emis_+3A_distance">distance</code></td>
<td>
<p>Numeric distance or a grid with class &quot;sf&quot;.</p>
</td></tr>
<tr><td><code id="split_emis_+3A_add_column">add_column</code></td>
<td>
<p>Character indicating name of column of distance. For instance,
if distance is an sf object, and you wand to add one extra column to the
resulting object.</p>
</td></tr>
<tr><td><code id="split_emis_+3A_verbose">verbose</code></td>
<td>
<p>Logical, to show more information.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
g &lt;- make_grid(net, 1/102.47/2) #500m in degrees
names(net)
dim(net)
netsf &lt;- sf::st_as_sf(net)[, "ldv"]
x &lt;- split_emis(net = netsf, distance = g)
dim(x)
g$A &lt;- rep(letters, length = 20)[1:nrow(g)]
g$B &lt;- rev(g$A)
netsf &lt;- sf::st_as_sf(net)[, c("ldv", "hdv")]
xx &lt;- split_emis(netsf, g, add_column = c("A", "B"))

## End(Not run)
</code></pre>

<hr>
<h2 id='temp_fact'>Expansion of hourly traffic data</h2><span id='topic+temp_fact'></span>

<h3>Description</h3>

<p><code>temp_fact</code> is a matrix multiplication between traffic and
hourly expansion data-frames to obtain a data-frame of traffic
at each link to every hour
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp_fact(q, pro, net, time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temp_fact_+3A_q">q</code></td>
<td>
<p>Numeric; traffic data per each link</p>
</td></tr>
<tr><td><code id="temp_fact_+3A_pro">pro</code></td>
<td>
<p>Numeric; expansion factors data-frames</p>
</td></tr>
<tr><td><code id="temp_fact_+3A_net">net</code></td>
<td>
<p>SpatialLinesDataFrame or Spatial Feature of &quot;LINESTRING&quot;</p>
</td></tr>
<tr><td><code id="temp_fact_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;1/h&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data-frames of expanded traffic or sf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
data(net)
data(pc_profile)
pc_week &lt;- temp_fact(net$ldv+net$hdv, pc_profile)
plot(pc_week)
pc_weeksf &lt;- temp_fact(net$ldv+net$hdv, pc_profile, net = net)
plot(pc_weeksf)

## End(Not run)
</code></pre>

<hr>
<h2 id='temp_veh'>Expanded Vehicles data.frame by hour</h2><span id='topic+temp_veh'></span>

<h3>Description</h3>

<p><code><a href="#topic+temp_veh">temp_veh</a></code> multiplies
vehicles with temporal factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temp_veh(x, tfs, array = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temp_veh_+3A_x">x</code></td>
<td>
<p>Vehicles data.frame</p>
</td></tr>
<tr><td><code id="temp_veh_+3A_tfs">tfs</code></td>
<td>
<p>temporal factor</p>
</td></tr>
<tr><td><code id="temp_veh_+3A_array">array</code></td>
<td>
<p>Logical, to return an array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table
</p>


<h3>See Also</h3>

<p><code><a href="#topic+temp_fact">temp_fact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
data(pc_profile)
x &lt;- age_ldv(x = net$ldv)
dx &lt;- temp_veh(x = x, tfs = pc_profile[[1]])
plot(Vehicles(as.data.frame(dx[, 1:50])))
dx2 &lt;- temp_veh(x = x,
                tfs = pc_profile[[1]],
                array = TRUE)
plot(EmissionsArray(dx2))

## End(Not run)
</code></pre>

<hr>
<h2 id='to_latex'>creates a .tex a table from a data.frame</h2><span id='topic+to_latex'></span>

<h3>Description</h3>

<p><code><a href="#topic+to_latex">to_latex</a></code> reads a data.frme an dgenerates a .tex
table, aiming to replicate the method of tablegenerator.com
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_latex(df, file, caption = "My table", label = "tab:df")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_latex_+3A_df">df</code></td>
<td>
<p>data.frame with three column.</p>
</td></tr>
<tr><td><code id="to_latex_+3A_file">file</code></td>
<td>
<p>Character, name of new .tex file</p>
</td></tr>
<tr><td><code id="to_latex_+3A_caption">caption</code></td>
<td>
<p>Character caption of table</p>
</td></tr>
<tr><td><code id="to_latex_+3A_label">label</code></td>
<td>
<p>Character,  label of table</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a text file with extension .tex.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vein_notes">vein_notes</a></code>  <code><a href="#topic+long_to_wide">long_to_wide</a></code>
</p>
<p>Other helpers: 
<code><a href="#topic+colplot">colplot</a>()</code>,
<code><a href="#topic+dmonth">dmonth</a>()</code>,
<code><a href="#topic+wide_to_long">wide_to_long</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
df &lt;- data.frame(pollutant = rep(c("CO", "propadiene", "NO2"), 10),
                 emission = vein::Emissions(1:30),
                 region = rep(letters[1:2], 15))
df
long_to_wide(df)
(df2 &lt;- long_to_wide(df, column_fixed = "region"))
to_latex(df2)
to_latex(long_to_wide(df, column_fixed = "region"),
file = paste0(tempfile(), ".tex"))

## End(Not run)
</code></pre>

<hr>
<h2 id='Vehicles'>Construction function for class &quot;Vehicles&quot;</h2><span id='topic+Vehicles'></span><span id='topic+print.Vehicles'></span><span id='topic+summary.Vehicles'></span><span id='topic+plot.Vehicles'></span>

<h3>Description</h3>

<p><code>Vehicles</code> returns a tranformed object with class &quot;Vehicles&quot; and units
'veh'. The type of objects supported are of classes &quot;matrix&quot;, &quot;data.frame&quot;,
&quot;numeric&quot; and &quot;array&quot;. If the object is a matrix it is converted to data.frame.
If the object is &quot;numeric&quot; it is converted to class &quot;units&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Vehicles(x, ..., time = NULL)

## S3 method for class 'Vehicles'
print(x, ...)

## S3 method for class 'Vehicles'
summary(object, ...)

## S3 method for class 'Vehicles'
plot(
  x,
  pal = "colo_lightningmccarl_into_the_night",
  rev = TRUE,
  bk = NULL,
  fig1 = c(0, 0.8, 0, 0.8),
  fig2 = c(0, 0.8, 0.55, 1),
  fig3 = c(0.7, 1, 0, 0.8),
  mai1 = c(1, 0.82, 0.82, 0.42),
  mai2 = c(1.8, 0.82, 0.5, 0.42),
  mai3 = c(1, 1, 0.82, 0.2),
  bias = 1.5,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Vehicles_+3A_x">x</code></td>
<td>
<p>Object with class &quot;Vehicles&quot;</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_time">time</code></td>
<td>
<p>Character to be the time units as denominator, eg &quot;1/h&quot;</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_object">object</code></td>
<td>
<p>Object with class &quot;Vehicles&quot;</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_pal">pal</code></td>
<td>
<p>Palette of colors available or the number of the position</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_rev">rev</code></td>
<td>
<p>Logical; to internally revert order of rgb color vectors.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_bk">bk</code></td>
<td>
<p>Break points in sorted order to indicate the intervals for assigning the colors.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_fig1">fig1</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_fig2">fig2</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_fig3">fig3</code></td>
<td>
<p>par parameters for fig, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_mai1">mai1</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_mai2">mai2</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_mai3">mai3</code></td>
<td>
<p>par parameters for mai, <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="Vehicles_+3A_bias">bias</code></td>
<td>
<p>positive number. Higher values give more widely spaced colors at the high end.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Objects of class &quot;Vehicles&quot; or &quot;units&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lt &lt;- rnorm(100, 300, 10)
class(lt)
vlt &lt;- Vehicles(lt)
class(vlt)
plot(vlt)
LT_B5 &lt;- age_hdv(x = lt,name = "LT_B5")
summary(LT_B5)
plot(LT_B5)

## End(Not run)
</code></pre>

<hr>
<h2 id='vein_notes'>Notes with sysinfo</h2><span id='topic+vein_notes'></span>

<h3>Description</h3>

<p><code><a href="#topic+vein_notes">vein_notes</a></code> creates aa text file '.txt' for
writting technical notes about this emissions inventory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vein_notes(
  notes,
  file = "README",
  yourname = Sys.info()["login"],
  title = "Notes for this VEIN run",
  approach = "Top Down",
  traffic = "Your traffic information",
  composition = "Your traffic information",
  ef = "Your information about emission factors",
  cold_start = "Your information about cold starts",
  evaporative = "Your information about evaporative emission factors",
  standards = "Your information about standards",
  mileage = "Your information about mileage"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vein_notes_+3A_notes">notes</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_file">file</code></td>
<td>
<p>Character; Name of the file. The function will generate a file
with an extension '.txt'.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_yourname">yourname</code></td>
<td>
<p>Character; Name of the inventor compiler.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_title">title</code></td>
<td>
<p>Character; Title of this file. For instance: &quot;Vehicular Emissions
Inventory of Region XX, Base year XX&quot;</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_approach">approach</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_traffic">traffic</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_composition">composition</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_ef">ef</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_cold_start">cold_start</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_evaporative">evaporative</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_standards">standards</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
<tr><td><code id="vein_notes_+3A_mileage">mileage</code></td>
<td>
<p>Character; vector of notes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Writes a text file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#do not run
a &lt;- "delete"
f &lt;- vein_notes("notes", file = a)
file.remove(f)

## End(Not run)
</code></pre>

<hr>
<h2 id='vein-deprecated'>DEPRECATED Construction function for class &quot;EmissionsList&quot;</h2><span id='topic+vein-deprecated'></span><span id='topic+EmissionsList'></span><span id='topic+print.EmissionsList'></span><span id='topic+summary.EmissionsList'></span><span id='topic+plot.EmissionsList'></span><span id='topic+Evaporative'></span><span id='topic+print.Evaporative'></span><span id='topic+summary.Evaporative'></span><span id='topic+plot.Evaporative'></span><span id='topic+ef_ive'></span><span id='topic+emis_source'></span><span id='topic+emis_wrf'></span><span id='topic+hot_soak'></span><span id='topic+running_losses'></span>

<h3>Description</h3>

<p><code>EmissionsList</code> returns a transformed object with class &quot;EmissionsList&quot;.
</p>
<p><code>Evaporative</code> returns a transformed object with class &quot;Evaporative&quot; and
units g. This class represents the daily emissions presented by
Mellios G and Ntziachristos (2016) Gasoline evaporation, Tier 2. Eventually
it will be incorporated the techniques of Tier 3.
</p>
<p>This function was deprecated. If the user want some UF-based EF, run MOVES
and extract EF
</p>
<p><code><a href="#topic+emis_source">emis_source</a></code> source vein scripts
</p>
<p><code>emis_wrf</code> returns a dataframe with columns lat, long, id, pollutants, local time
and GMT time. This dataframe has the proper format to be used with WRF
assimilation system: &quot;ASimilation System 4 WRF (AS4WRF Vera-Vala et al (2016))
</p>
<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("-deprecated")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EmissionsList(x, ...)

Evaporative(x, ...)

ef_ive(
  description = "Auto/Sml Truck",
  fuel = "Petrol",
  weight = "Light",
  air_fuel_control = "Carburetor",
  exhaust = "None",
  evaporative = "PCV",
  mileage,
  pol,
  details = FALSE
)

emis_source(
  path = "est",
  pattern = ".R",
  ignore = "~",
  first,
  ask = TRUE,
  recursive = TRUE,
  full.names = TRUE,
  echo = FALSE
)

emis_wrf(sdf, nr = 1, dmyhm, tz, crs = 4326, islist)

hot_soak(x, carb, p, eshotc, eswarmc, eshotfi)

running_losses(x, erhotfi, lkm, carb, p, erhotc, erwarmc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vein-deprecated_+3A_x">x</code></td>
<td>
<p>Object with class &quot;numeric&quot;</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_description">description</code></td>
<td>
<p>Character; &quot;Auto/Sml Truck&quot; &quot;Truck/Bus&quot; or&quot;Sml Engine&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_fuel">fuel</code></td>
<td>
<p>Character; &quot;Petrol&quot;, &quot;NG Retrofit&quot;, &quot;Natural Gas&quot;, &quot;Prop Retro.&quot;,
&quot;Propane&quot;, &quot;EthOH Retrofit&quot;, &quot;OEM Ethanol&quot;, &quot;Diesel&quot;, &quot;Ethanol&quot; or &quot;CNG/LPG&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_weight">weight</code></td>
<td>
<p>Character; &quot;Light&quot;, &quot;Medium&quot;, &quot;Heavy&quot;, &quot;Lt&quot;, &quot;Med&quot; or &quot;Hvy&quot;</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_air_fuel_control">air_fuel_control</code></td>
<td>
<p>Character; One of the following characters: &quot;Carburetor&quot;,
&quot;Single-Pt FI&quot;, &quot;Multi-Pt FI&quot;, &quot;Carb/Mixer&quot;, &quot;FI&quot;, &quot;Pre-Chamber Inject.&quot;,
&quot;Direct Injection&quot;, &quot;2-Cycle&quot;, &quot;2-Cycle, FI&quot;, &quot;4-Cycle, Carb&quot;, &quot;4-Cycle, FI&quot;
&quot;4-Cycle&quot;</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_exhaust">exhaust</code></td>
<td>
<p>Character: &quot;None&quot;, &quot;2-Way&quot;, &quot;2-Way/EGR&quot;, &quot;3-Way&quot;, &quot;3-Way/EGR&quot;,
&quot;None/EGR&quot;, &quot;LEV&quot;, &quot;ULEV&quot;, &quot;SULEV&quot;, &quot;EuroI&quot;, &quot;EuroII&quot;, &quot;EuroIII&quot;, &quot;EuroIV&quot;,
&quot;Hybrid&quot;, &quot;Improved&quot;, &quot;EGR+Improv&quot;, &quot;Particulate&quot;, &quot;Particulate/NOx&quot;,
&quot;EuroV&quot;, &quot;High Tech&quot; or &quot;Catalyst&quot;</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_evaporative">evaporative</code></td>
<td>
<p>Character: &quot;PCV&quot;, &quot;PCV/Tank&quot; or&quot;None&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_mileage">mileage</code></td>
<td>
<p>Numeric; mileage of vehicle by age of use km.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_pol">pol</code></td>
<td>
<p>Character; One of the following characters: &quot;Carburetor&quot;,
&quot;Single-Pt FI&quot;, &quot;Multi-Pt FI&quot;, &quot;Carb/Mixer&quot;, &quot;FI&quot;, &quot;Pre-Chamber Inject.&quot;,
&quot;Direct Injection&quot;, &quot;2-Cycle&quot;, &quot;2-Cycle, FI&quot;, &quot;4-Cycle, Carb&quot;, &quot;4-Cycle, FI&quot;
&quot;4-Cycle&quot;
#' </p>

<table>
<tr>
 <td style="text-align: center;">
  "VOC_gkm" </td><td style="text-align: center;"> "CO_gkm" </td><td style="text-align: center;"> "NOx_gkm" </td><td style="text-align: center;"> "PM_gkm" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "Pb_gkm" </td><td style="text-align: center;"> "SO2_gkm" </td><td style="text-align: center;"> "NH3_gkm" </td><td style="text-align: center;"> "1,3-butadiene_gkm" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "formaldehyde_gkm" </td><td style="text-align: center;"> "acetaldehyde_gkm" </td><td style="text-align: center;"> "benzene_gkm" </td><td style="text-align: center;"> "EVAP_gkm" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "CO2_gkm" </td><td style="text-align: center;"> "N20_gkm" </td><td style="text-align: center;"> "CH4_gkm" </td><td style="text-align: center;"> "VOC_gstart" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "CO_gstart" </td><td style="text-align: center;"> "NOx_gstart" </td><td style="text-align: center;"> "PM_gstart" </td><td style="text-align: center;"> "Pb_gstart" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "SO2_gstart" </td><td style="text-align: center;"> "NH3_gstart" </td><td style="text-align: center;"> "1,3-butadiene_gstart" </td><td style="text-align: center;"> "formaldehyde_gstart" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "acetaldehyde_gstart" </td><td style="text-align: center;"> "benzene_gstart" </td><td style="text-align: center;"> "EVAP_gstart" </td><td style="text-align: center;"> "CO2_gstart" </td>
</tr>
<tr>
 <td style="text-align: center;">
  "N20_gstart" </td><td style="text-align: center;"> "CH4_gstart" </td><td style="text-align: center;">   </td><td style="text-align: center;">  </td>
</tr>
<tr>
 <td style="text-align: center;">
</td>
</tr>

</table>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_details">details</code></td>
<td>
<p>Logical; option to see or not more information about vehicle.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_path">path</code></td>
<td>
<p>Character; path to source scripts. Default is &quot;est&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_pattern">pattern</code></td>
<td>
<p>Character; extensions of R scripts. Default is &quot;.R&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_ignore">ignore</code></td>
<td>
<p>Character; character to be excluded. Default is &quot;~&quot;. Sometimes,
the OS creates automatic back-ups, for instance &quot;run.R~&quot;, the idea is to
avoid sourcing these files.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_first">first</code></td>
<td>
<p>Character; first script.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_ask">ask</code></td>
<td>
<p>Logical; Check inputs or not. Default is &quot;FALSE&quot;. It allows to
stop inputs</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_recursive">recursive</code></td>
<td>
<p>Logical; recursive or not. Default is &quot;TRUE&quot;</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_full.names">full.names</code></td>
<td>
<p>Logical; full.names or not. Default is &quot;TRUE&quot;.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_echo">echo</code></td>
<td>
<p>Source with echo?</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_sdf">sdf</code></td>
<td>
<p>Gridded emissions, which can be a SpatialPolygonsDataFrame, or a list
of SpatialPolygonsDataFrame, or a sf object of &quot;POLYGON&quot;. The user must enter
a list with 36 SpatialPolygonsDataFrame with emissions for the mechanism CBMZ.</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_nr">nr</code></td>
<td>
<p>Number of repetitions of the emissions period</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_dmyhm">dmyhm</code></td>
<td>
<p>String indicating Day Month Year Hour and Minute in the format
&quot;d-m-Y H:M&quot; e.g.: &quot;01-05-2014 00:00&quot; It represents the time of the first
hour of emissions in Local Time</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_tz">tz</code></td>
<td>
<p>Time zone as required in for function <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code></p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_crs">crs</code></td>
<td>
<p>Coordinate reference system, e.g: &quot;+init=epsg:4326&quot;. Used to
transform the coordinates of the output</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_islist">islist</code></td>
<td>
<p>logical value to indicate if sdf is a list or not</p>
</td></tr>
<tr><td><code id="vein-deprecated_+3A_object">object</code></td>
<td>
<p>Object with class &quot;Evaporative&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+ef_ive">ef_ive</a></code> returns the base emission factors from the the IVE
model. This function depend on vectorized mileage, which means your can
enter with the mileage by age of use and the name of the pollutant.
</p>


<h3>Value</h3>

<p>Objects of class &quot;EmissionsList&quot; and numeric elements as &quot;units&quot;
</p>
<p>Objects of class &quot;Evaporative&quot; or &quot;units&quot;
</p>
<p>An emission factor by annual mileage.
</p>


<h3><code>Evaporative</code></h3>

<p>For <code>Evaporative</code>, use <code><a href="#topic+emis_evap">emis_evap</a></code>.
</p>
<p>For <code>running_losses</code>, use <code><a href="#topic+emis_evap">emis_evap</a></code>.
</p>
<p>For <code>running_losses</code>, use <code><a href="#topic+emis_evap">emis_evap</a></code>.
</p>


<h3>References</h3>

<p>Nicole Davis, James Lents, Mauricio Osses, Nick Nikkila,
Matthew Barth. 2005. Development and Application of an International
Vehicle Emissions Model. Transportation Research Board, 81st Annual Meeting,
January 2005, Washington, D.C.
</p>
<p>Mellios G and Ntziachristos 2016. Gasoline evaporation. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2009
</p>
<p>Mellios G and Ntziachristos 2016. Gasoline evaporation. In:
EEA, EMEP. EEA air pollutant emission inventory guidebook-2009. European
Environment Agency, Copenhagen, 2009
</p>


<h3>See Also</h3>

<p><code><a href="#topic+vein-deprecated">vein-deprecated</a></code>
</p>
<p><code><a href="#topic+vein-deprecated">vein-deprecated</a></code>
</p>
<p><code><a href="#topic+vein-deprecated">vein-deprecated</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# do not run
# DEPRECATED

## End(Not run)
## Not run: 
# do not run
# DEPRECATED

## End(Not run)
## Not run: 
# Do not run
# Passenger Cars PC
data(fkm)
# cumulative mileage from 1 to 50 years of use, 40:50
mil &lt;- cumsum(fkm$KM_PC_E25(1:50))
ef_ive("Truck/Bus", mileage = mil, pol = "CO_gkm")
ef_ive(mileage = mil, pol = "CO_gkm", details = TRUE)

## End(Not run)
## Not run: 
# Do not run

## End(Not run)
## Not run: 
# do not run
# Use library(eixport)
# eixport::to_as4wrf()

## End(Not run)
## Not run: 
# Do not run

## End(Not run)
## Not run: 
# Do not run

## End(Not run)

</code></pre>

<hr>
<h2 id='vein-package'>vein: Vehicular Emissions Inventories</h2><span id='topic+vein'></span><span id='topic+vein-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Elaboration of vehicular emissions inventories, consisting in four stages, pre-processing activity data, preparing emissions factors, estimating the emissions and post-processing of emissions in maps and databases. More details in Ibarra-Espinosa et al (2018) <a href="https://doi.org/10.5194/gmd-11-2209-2018">doi:10.5194/gmd-11-2209-2018</a>. Before using VEIN you need to know the vehicular composition of your study area, in other words, the combination of of type of vehicles, size and fuel of the fleet. Then, it is recommended to start with the project to download a template to create a structure of directories and scripts.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sergio Ibarra-Espinosa <a href="mailto:zergioibarra@gmail.com">zergioibarra@gmail.com</a> (<a href="https://orcid.org/0000-0002-3162-1905">ORCID</a>)
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Daniel Schuch <a href="mailto:underschuch@gmail.com">underschuch@gmail.com</a> (<a href="https://orcid.org/0000-0001-5977-4519">ORCID</a>) [contributor]
</p>
</li>
<li><p> Joao Bazzo <a href="mailto:joao.bazzo@gmail.com">joao.bazzo@gmail.com</a> (<a href="https://orcid.org/0000-0002-7371-1116">ORCID</a>) [contributor]
</p>
</li>
<li><p> Mario Gavidia-Calderón <a href="mailto:mario.calderon@iag.usp.br">mario.calderon@iag.usp.br</a> (<a href="https://orcid.org/0000-0003-4536-5006">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/atmoschem/vein">https://github.com/atmoschem/vein</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/atmoschem/vein/issues">https://github.com/atmoschem/vein/issues</a>
</p>
</li></ul>


<hr>
<h2 id='vkm'>Estimation of VKM</h2><span id='topic+vkm'></span>

<h3>Description</h3>

<p><code>vkm</code> consists in the product of the number of vehicles and
the distance driven by these vehicles in km. This function reads hourly
vehicles and then extrapolates the vehicles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vkm(
  veh,
  lkm,
  profile,
  hour = nrow(profile),
  day = ncol(profile),
  array = TRUE,
  as_df = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vkm_+3A_veh">veh</code></td>
<td>
<p>Numeric vector with number of vehicles per street</p>
</td></tr>
<tr><td><code id="vkm_+3A_lkm">lkm</code></td>
<td>
<p>Length of each link (km)</p>
</td></tr>
<tr><td><code id="vkm_+3A_profile">profile</code></td>
<td>
<p>Numerical or dataframe with nrows equal to 24 and ncol 7 day of the week</p>
</td></tr>
<tr><td><code id="vkm_+3A_hour">hour</code></td>
<td>
<p>Number of considered hours in estimation</p>
</td></tr>
<tr><td><code id="vkm_+3A_day">day</code></td>
<td>
<p>Number of considered days in estimation</p>
</td></tr>
<tr><td><code id="vkm_+3A_array">array</code></td>
<td>
<p>When FALSE produces a dataframe of the estimation. When TRUE expects a
profile as a dataframe producing an array with dimensions (streets x hours x days)</p>
</td></tr>
<tr><td><code id="vkm_+3A_as_df">as_df</code></td>
<td>
<p>Logical; when TRUE transform returning array in data.frame (streets x hour*days)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>emission estimation  of vkm
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Do not run
pc &lt;- lkm &lt;- abs(rnorm(10,1,1))*100
pro &lt;- matrix(abs(rnorm(24*7,0.5,1)), ncol=7, nrow=24)
vkms  &lt;- vkm(veh = pc, lkm = lkm, profile = pro)
class(vkms)
dim(vkms)
vkms2  &lt;- vkm(veh = pc, lkm = lkm, profile = pro, as_df = FALSE)
class(vkms2)
dim(vkms2)

## End(Not run)
</code></pre>

<hr>
<h2 id='wide_to_long'>Transform data.frame from wide to long format</h2><span id='topic+wide_to_long'></span>

<h3>Description</h3>

<p><code><a href="#topic+wide_to_long">wide_to_long</a></code> transform data.frame from wide to
long format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wide_to_long(df, column_with_data = names(df), column_fixed, geometry)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wide_to_long_+3A_df">df</code></td>
<td>
<p>data.frame with three column.</p>
</td></tr>
<tr><td><code id="wide_to_long_+3A_column_with_data">column_with_data</code></td>
<td>
<p>Character column with data</p>
</td></tr>
<tr><td><code id="wide_to_long_+3A_column_fixed">column_fixed</code></td>
<td>
<p>Character,  column that will remain fixed</p>
</td></tr>
<tr><td><code id="wide_to_long_+3A_geometry">geometry</code></td>
<td>
<p>To return a sf</p>
</td></tr>
</table>


<h3>Value</h3>

<p>long data.frame.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emis_hot_td">emis_hot_td</a></code> <code><a href="#topic+emis_cold_td">emis_cold_td</a></code>  <code><a href="#topic+long_to_wide">long_to_wide</a></code>
</p>
<p>Other helpers: 
<code><a href="#topic+colplot">colplot</a>()</code>,
<code><a href="#topic+dmonth">dmonth</a>()</code>,
<code><a href="#topic+to_latex">to_latex</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(net)
net &lt;- sf::st_set_geometry(net, NULL)
df &lt;- wide_to_long(df = net)
head(df)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
