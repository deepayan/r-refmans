<!DOCTYPE html><html><head><title>Help for package NPP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NPP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BerMNPP_MCMC1'><p>MCMC Sampling for Bernoulli Population with Multiple Historical Data using Normalized Power Prior</p></a></li>
<li><a href='#BerMNPP_MCMC2'><p>MCMC Sampling for Bernoulli Population of multiple historical data using Normalized Power Prior</p></a></li>
<li><a href='#BerNPP_MCMC'><p>MCMC Sampling for Bernoulli Population using Normalized Power Prior</p></a></li>
<li><a href='#BerOMNPP_MCMC1'><p>MCMC Sampling for Bernoulli Population of multiple ordered historical data using Normalized Power Prior</p></a></li>
<li><a href='#BerOMNPP_MCMC2'><p>MCMC Sampling for Bernoulli Population of multiple ordered historical data using Normalized Power Prior</p></a></li>
<li><a href='#LaplacelogC'>
<p>A Function to Calculate <code class="reqn">logC(\delta)</code> Based on Laplace Approximation</p></a></li>
<li><a href='#LMMNPP_MCMC1'>
<p>MCMC Sampling for Linear Regression Model of multiple historical data using</p>
Normalized Power Prior</a></li>
<li><a href='#LMMNPP_MCMC2'>
<p>MCMC Sampling for Linear Regression Model of multiple historical data using</p>
Normalized Power Prior</a></li>
<li><a href='#LMNPP_MCMC'><p>MCMC Sampling for Normal Linear Model using Normalized Power Prior</p></a></li>
<li><a href='#LMOMNPP_MCMC1'>
<p>MCMC Sampling for Linear Regression Model of multiple historical data using</p>
Ordered Normalized Power Prior</a></li>
<li><a href='#LMOMNPP_MCMC2'>
<p>MCMC Sampling for Linear Regression Model of multiple historical data using</p>
Ordered Normalized Power Prior</a></li>
<li><a href='#logCdelta'>
<p>A Function to Interpolate <code class="reqn">logC(\delta)</code> Based on Its Values on Selected Knots</p></a></li>
<li><a href='#logCknot'>
<p>A Function to Calculate <code class="reqn">logC(\delta)</code> on Selected Knots</p></a></li>
<li><a href='#loglikBerD0'>
<p>A Function to Calculate Log-likelihood of the Historical Data, Given Matrix-valued Parameters, for Bernoulli Population</p></a></li>
<li><a href='#loglikNormD0'>
<p>A Function to Calculate Log-likelihood of the Historical Data, Given Array-valued Parameters, for Normal Population</p></a></li>
<li><a href='#ModeDeltaBerNPP'><p>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Bernoulli Population</p></a></li>
<li><a href='#ModeDeltaLMNPP'><p>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search,</p>
Normal Linear Model</a></li>
<li><a href='#ModeDeltaMultinomialNPP'><p>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Multinomial Population</p></a></li>
<li><a href='#ModeDeltaNormalNPP'><p>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Normal Population</p></a></li>
<li><a href='#ModeDeltaPoisNPP'><p>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Poisson Population</p></a></li>
<li><a href='#MultinomialNPP_MCMC'><p>MCMC Sampling for Multinomial Population using Normalized Power Prior</p></a></li>
<li><a href='#NormalNPP_MCMC'><p>MCMC Sampling for Normal Population using Normalized Power Prior</p></a></li>
<li><a href='#PHData'>
<p>PH Data on four sites in Virginia</p></a></li>
<li><a href='#PoiMNPP_MCMC1'><p>MCMC Sampling for Poisson Population using Normalized Power Prior with Multiple Historical Data</p></a></li>
<li><a href='#PoiMNPP_MCMC2'><p>MCMC Sampling for Poisson Population of multiple historical data using Normalized Power Prior</p></a></li>
<li><a href='#PoiOMNPP_MCMC1'><p>MCMC Sampling for Poisson Population of multiple ordered historical data using Normalized Power Prior</p></a></li>
<li><a href='#PoiOMNPP_MCMC2'><p>MCMC Sampling for Poisson Population of multiple ordered historical data using Normalized Power Prior</p></a></li>
<li><a href='#PoissonNPP_MCMC'><p>MCMC Sampling for Bernoulli Population using Normalized Power Prior</p></a></li>
<li><a href='#SPDData'>
<p>Dataset for Diagnostic Test (PartoSure Test, Medical Device) Evaluation for Spontaneous Preterm Delivery</p></a></li>
<li><a href='#VaccineData'>
<p>Dataset of a Vaccine Trial for RotaTeq and Multiple Historical Trials for Control Group</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Normalized Power Prior Bayesian Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.6.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Zifei Han, Qiang Zhang, Tianyu Bai Yuyan Duan and Keying Ye</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zifei Han &lt;hanzifei1@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Posterior sampling in several commonly used distributions using
    normalized power prior as described in 
    Duan, Ye and Smith (2006) &lt;<a href="https://doi.org/10.1002%2Fenv.752">doi:10.1002/env.752</a>&gt; and 
    Ibrahim et.al. (2015) &lt;<a href="https://doi.org/10.1002%2Fsim.6728">doi:10.1002/sim.6728</a>&gt;. 
    Sampling of the power parameter is achieved via 
    either independence Metropolis-Hastings or random walk Metropolis-Hastings 
    based on transformation. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-12 04:10:43 UTC; zifeihan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-12 04:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='BerMNPP_MCMC1'>MCMC Sampling for Bernoulli Population with Multiple Historical Data using Normalized Power Prior</h2><span id='topic+BerMNPP_MCMC1'></span>

<h3>Description</h3>

<p>Incorporate multiple historical data sets for posterior sampling of a Bernoulli population using the normalized power prior. The Metropolis-Hastings algorithm, with either an independence proposal or a random walk proposal on the logit scale, is applied for the power parameter <code class="reqn">\delta</code>. Gibbs sampling is utilized for the model parameter <code class="reqn">p</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  BerMNPP_MCMC1(n0, y0, n, y, prior_p, prior_delta_alpha,
                prior_delta_beta, prop_delta_alpha, prop_delta_beta,
                delta_ini, prop_delta, rw_delta, nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BerMNPP_MCMC1_+3A_n0">n0</code></td>
<td>
<p>A non-negative integer vector representing the number of trials in historical data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_y0">y0</code></td>
<td>
<p>A non-negative integer vector denoting the number of successes in historical data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_n">n</code></td>
<td>
<p>A non-negative integer indicating the number of trials in the current data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_y">y</code></td>
<td>
<p>A non-negative integer for the number of successes in the current data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prior_p">prior_p</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prop_delta_alpha">prop_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the proposal distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prop_delta_beta">prop_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the proposal distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_delta_ini">delta_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_prop_delta">prop_delta</code></td>
<td>
<p>the class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_rw_delta">rw_delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>. Only applicable if prop_delta = 'RW'.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\delta)\pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{\delta_{k}}}{\int \pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{\delta_{k}} d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\delta</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\delta_k</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; comprising:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>Acceptance rate in MCMC sampling for <code class="reqn">\delta</code> via the Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>Posterior distribution of the model parameter <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>Posterior distribution of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerMNPP_MCMC2">BerMNPP_MCMC2</a></code>;
<code><a href="#topic+BerOMNPP_MCMC1">BerOMNPP_MCMC1</a></code>;
<code><a href="#topic+BerOMNPP_MCMC2">BerOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BerMNPP_MCMC1(n0 = c(275, 287), y0 = c(92, 125), n = 39, y = 17,
              prior_p = c(1/2,1/2), prior_delta_alpha = c(1/2,1/2),
              prior_delta_beta = c(1/2,1/2),
              prop_delta_alpha = c(1,1)/2, prop_delta_beta = c(1,1)/2,
              delta_ini = NULL, prop_delta = "IND",
              nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='BerMNPP_MCMC2'>MCMC Sampling for Bernoulli Population of multiple historical data using Normalized Power Prior</h2><span id='topic+BerMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple historical data are combined individually.
The NPP of multiple historical data is the product of the NPP of each historical data.
Conduct posterior sampling for Bernoulli population with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter <code class="reqn">p</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BerMNPP_MCMC2(n0, y0, n, y, prior_p, prior_delta_alpha, prior_delta_beta,
              prop_delta_alpha, prop_delta_beta, delta_ini, prop_delta,
              rw_delta, nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BerMNPP_MCMC2_+3A_n0">n0</code></td>
<td>
<p>a non-negative integer vector: number of trials in historical data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_y0">y0</code></td>
<td>
<p>a non-negative integer vector: number of successes in historical data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_n">n</code></td>
<td>
<p>a non-negative integer: number of trials in the current data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_y">y</code></td>
<td>
<p>a non-negative integer: number of successes in the current data.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prior_p">prior_p</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prop_delta_alpha">prop_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the proposal distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prop_delta_beta">prop_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the proposal distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_delta_ini">delta_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_prop_delta">prop_delta</code></td>
<td>
<p>the class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_rw_delta">rw_delta</code></td>
<td>
<p>the stepsize (variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>. Only applicable if prop_delta = 'RW'.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after burnin.</p>
</td></tr>
<tr><td><code id="BerMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\delta)\prod_{k=1}^{K}\frac{\pi_0(\theta)L(\theta|D_{0k})^{\delta_{k}}}{\int \pi_0(\theta)L(\theta|D_{0k})^{\delta_{k}} d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\delta</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\delta_k</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerMNPP_MCMC1">BerMNPP_MCMC1</a></code>;
<code><a href="#topic+BerOMNPP_MCMC1">BerOMNPP_MCMC1</a></code>;
<code><a href="#topic+BerOMNPP_MCMC2">BerOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BerMNPP_MCMC2(n0 = c(275, 287), y0 = c(92, 125), n = 39, y = 17,
              prior_p=c(1/2,1/2), prior_delta_alpha=c(1/2,1/2),
              prior_delta_beta=c(1/2,1/2), prop_delta_alpha=c(1,1)/2,
              prop_delta_beta=c(1,1)/2, delta_ini=NULL, prop_delta="IND",
              nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='BerNPP_MCMC'>MCMC Sampling for Bernoulli Population using Normalized Power Prior</h2><span id='topic+BerNPP_MCMC'></span>

<h3>Description</h3>

<p>Conduct posterior sampling for Bernoulli population with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter <code class="reqn">p</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BerNPP_MCMC(Data.Cur = c(100, 50), Data.Hist = c(100, 50),
            CompStat = list(n0 = NULL, y0 = NULL, n1 = NULL, y1 = NULL),
            prior = list(p.alpha = 1, p.beta = 1, delta.alpha = 1, delta.beta = 1),
            MCMCmethod = 'IND', rw.logit.delta = 0.1,
            ind.delta.alpha = 1, ind.delta.beta = 1, nsample = 5000,
            control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BerNPP_MCMC_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of two elements: c(number of trials, number of successes) in the current data.</p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of two elements: c(number of trials, number of successes) in the historical data.</p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_compstat">CompStat</code></td>
<td>
<p>a list of four elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">p</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
Note: in Bernoulli population providing <code>CompStat</code> is equivalent to provide the data summary as in
<code>Data.Cur</code> and <code>Data.Cur</code>.
</p>
<p><code>n0</code> is the number of trials in the historical data.
</p>
<p><code>y0</code> is the number of successes in the historical data.
</p>
<p><code>n1</code> is the number of trials in the current data.
</p>
<p><code>y1</code> is the number of successes in the current data.
</p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">p</code> and <code class="reqn">\delta</code>.
</p>
<p><code>p.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.
</p>
<p><code>p.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_mcmcmethod">MCMCmethod</code></td>
<td>
<p>sampling method for <code class="reqn">\delta</code> in MCMC. It can be either 'IND' for independence proposal; or 'RW' for
random walk proposal on logit scale. </p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_rw.logit.delta">rw.logit.delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>.
Only applicable if <code>MCMCmethod = 'RW'. </code> </p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_ind.delta.alpha">ind.delta.alpha</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\alpha</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_ind.delta.beta">ind.delta.beta</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\beta</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="BerNPP_MCMC_+3A_control.mcmc">control.mcmc</code></td>
<td>
<p>a list of three elements used in posterior sampling.
</p>
<p><code>delta.ini</code> is the initial value of <code class="reqn">\delta</code> in MCMC sampling.
</p>
<p><code>burnin</code> is the number of burn-ins. The output will only show MCMC samples after bunrin.
</p>
<p><code>thin</code> is the thinning parameter in MCMC sampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm. </p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>the deviance information criteria for model diagnostics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultinomialNPP_MCMC">MultinomialNPP_MCMC</a></code>;
<code><a href="#topic+NormalNPP_MCMC">NormalNPP_MCMC</a></code>;
<code><a href="#topic+PoissonNPP_MCMC">PoissonNPP_MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BerNPP_MCMC(Data.Cur = c(493, 473), Data.Hist = c(680, 669),
            prior = list(p.alpha = 0.5, p.beta = 0.5, delta.alpha = 1, delta.beta = 1),
            MCMCmethod = 'RW', rw.logit.delta = 1, nsample = 5000,
            control.mcmc = list(delta.ini = NULL, burnin = 2000, thin = 5))
</code></pre>

<hr>
<h2 id='BerOMNPP_MCMC1'>MCMC Sampling for Bernoulli Population of multiple ordered historical data using Normalized Power Prior</h2><span id='topic+BerOMNPP_MCMC1'></span>

<h3>Description</h3>

<p>Multiple ordered historical data are incorporated together.
Conduct posterior sampling for Bernoulli population with normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with independence proposal is used.
For the model parameter <code class="reqn">p</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    BerOMNPP_MCMC1(n0, y0, n, y, prior_gamma, prior_p, gamma_ind_prop,
                   gamma_ini, nsample, burnin, thin, adjust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BerOMNPP_MCMC1_+3A_n0">n0</code></td>
<td>
<p>a non-negative integer vector: number of trials in historical data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_y0">y0</code></td>
<td>
<p>a non-negative integer vector: number of successes in historical data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_n">n</code></td>
<td>
<p>a non-negative integer: number of trials in the current data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_y">y</code></td>
<td>
<p>a non-negative integer: number of successes in the current data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_prior_p">prior_p</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after burnin.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC1_+3A_adjust">adjust</code></td>
<td>
<p>Logical, indicating whether or not to adjust the parameters of the proposal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\gamma</code>.
The normalized power prior distribution is given by:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\gamma)\pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}}{\int \pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}d\theta}.</code>
</p>

<p>Here, <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>. It is equal to the cumulative sum of <code class="reqn">\gamma</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerMNPP_MCMC1">BerMNPP_MCMC1</a></code>,
<code><a href="#topic+BerMNPP_MCMC2">BerMNPP_MCMC2</a></code>,
<code><a href="#topic+BerOMNPP_MCMC2">BerOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BerOMNPP_MCMC1(n0 = c(275, 287), y0 = c(92, 125), n = 39, y = 17, prior_gamma=c(1,1,1)/3,
               prior_p=c(1/2,1/2), gamma_ind_prop=rep(1,3)/2, gamma_ini=NULL,
               nsample = 2000, burnin = 500, thin = 2, adjust = FALSE)
</code></pre>

<hr>
<h2 id='BerOMNPP_MCMC2'>MCMC Sampling for Bernoulli Population of multiple ordered historical data using Normalized Power Prior</h2><span id='topic+BerOMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple ordered historical data are combined individually.
Conduct posterior sampling for Bernoulli population with normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with independence proposal is used.
For the model parameter <code class="reqn">p</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BerOMNPP_MCMC2(n0, y0, n, y, prior_gamma, prior_p, gamma_ind_prop, gamma_ini,
               nsample, burnin, thin, adjust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BerOMNPP_MCMC2_+3A_n0">n0</code></td>
<td>
<p>a vector of non-negative integers: numbers of trials in historical data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_y0">y0</code></td>
<td>
<p>a vector of non-negative integers: numbers of successes in historical data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_n">n</code></td>
<td>
<p>a non-negative integer: number of trials in the current data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_y">y</code></td>
<td>
<p>a non-negative integer: number of successes in the current data.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_prior_p">prior_p</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after burn-in.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
<tr><td><code id="BerOMNPP_MCMC2_+3A_adjust">adjust</code></td>
<td>
<p>Whether or not to adjust the parameters of the proposal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\gamma</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\gamma)\prod_{k=1}^{K}\frac{\pi_0(\theta)L(\theta|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}}{\int \pi_0(\theta)L(\theta|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)} d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>. It is equal to the cumulative sum of <code class="reqn">\gamma</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerMNPP_MCMC1">BerMNPP_MCMC1</a></code>;
<code><a href="#topic+BerMNPP_MCMC2">BerMNPP_MCMC2</a></code>;
<code><a href="#topic+BerOMNPP_MCMC1">BerOMNPP_MCMC1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>BerOMNPP_MCMC2(n0 = c(275, 287), y0 = c(92, 125), n = 39, y = 17, prior_gamma=c(1,1,1)/3,
               prior_p=c(1/2,1/2),  gamma_ind_prop=rep(1,3)/2, gamma_ini=NULL,
               nsample = 2000, burnin = 500, thin = 2, adjust = FALSE)
</code></pre>

<hr>
<h2 id='LaplacelogC'>
A Function to Calculate <code class="reqn">logC(\delta)</code> Based on Laplace Approximation
</h2><span id='topic+LaplacelogC'></span>

<h3>Description</h3>

<p>The function assumes that the prior of the model parameters is very flat that had very minor impact on the
shape of the power prior (posterior based on the D0).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LaplacelogC(delta, loglikmle, detHessian, ntheta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LaplacelogC_+3A_delta">delta</code></td>
<td>
<p>the power parameter between 0 and 1. The function returns <code class="reqn">logC(\delta)</code> </p>
</td></tr>
<tr><td><code id="LaplacelogC_+3A_loglikmle">loglikmle</code></td>
<td>
<p>a scalar; the loglikelihood of the historical data evaluated at the maximum likelihood
estimates based on the historical data</p>
</td></tr>
<tr><td><code id="LaplacelogC_+3A_dethessian">detHessian</code></td>
<td>
<p>determinant of the Hessian matrix evaluated at the loglikelihood function with respect to the maximum likelihood
estimates based on the historical data</p>
</td></tr>
<tr><td><code id="LaplacelogC_+3A_ntheta">ntheta</code></td>
<td>
<p>an positive integer indicating number of parameters in the model </p>
</td></tr>
</table>


<h3>Value</h3>

<p><code class="reqn">logC(\delta)</code> based on the Laplace approximation. Can be used for the posterior sampling in the normalized power prior.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logCknot">logCknot</a></code>
</p>

<hr>
<h2 id='LMMNPP_MCMC1'>
MCMC Sampling for Linear Regression Model of multiple historical data using
Normalized Power Prior
</h2><span id='topic+LMMNPP_MCMC1'></span>

<h3>Description</h3>

<p>Multiple historical data are incorporated together.
Conduct posterior sampling for Linear Regression Model with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameters <code class="reqn">(\beta, \sigma^2)</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMMNPP_MCMC1(D0, X, Y, a0, b, mu0, R, delta_ini, prop_delta,
             prior_delta_alpha, prior_delta_beta, prop_delta_alpha,
             prop_delta_beta, rw_delta, nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMMNPP_MCMC1_+3A_d0">D0</code></td>
<td>
<p>a list of <code class="reqn">k</code> elements representing <code class="reqn">k</code> historical data, where the
<code class="reqn">i^{th}</code> element corresponds to the <code class="reqn">i^{th}</code> historical data named
as &ldquo;D0i&rdquo;.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_x">X</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the
number of observations.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_y">Y</code></td>
<td>
<p>a vector of individual level of the response y in the current data.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_a0">a0</code></td>
<td>
<p>a positive shape parameter for inverse-gamma prior on model parameter                        <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_b">b</code></td>
<td>
<p>a positive scale parameter for inverse-gamma prior on model parameter                        <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_mu0">mu0</code></td>
<td>
<p>a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_r">R</code></td>
<td>
<p>a inverse matrix of the covariance matrix for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_delta_ini">delta_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_prop_delta">prop_delta</code></td>
<td>
<p>the class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the prior                                     distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the prior distribution                         <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_prop_delta_alpha">prop_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the proposal                                  distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_prop_delta_beta">prop_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the proposal                                   distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_rw_delta">rw_delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk                        proposal of logit <code class="reqn">\delta</code>. Only applicable if prop_delta = 'RW'.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameters and power parameter,
acceptance rate in sampling <code class="reqn">\delta</code>.
Let <code class="reqn">\theta</code>=<code class="reqn">(\beta, \sigma^2)</code>, the normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\delta)\pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{\delta_k}}{\int \pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^{\delta_k}\,d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\delta</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\delta_k</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using
Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\beta</code> in vector or matrix form.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LMMNPP_MCMC2">LMMNPP_MCMC2</a></code>;
<code><a href="#topic+LMOMNPP_MCMC1">LMOMNPP_MCMC1</a></code>;
<code><a href="#topic+LMOMNPP_MCMC2">LMOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1234)
sigsq0 = 1

n01 = 100
theta01 = c(0, 1, 1)
X01 = cbind(1, rnorm(n01, mean=0, sd=1), runif(n01, min=-1, max=1))
Y01 = X01%*%as.vector(theta01) + rnorm(n01, mean=0, sd=sqrt(sigsq0))
D01 = cbind(X01, Y01)

n02 = 70
theta02 = c(0, 2, 3)
X02 = cbind(1, rnorm(n02, mean=0, sd=1), runif(n02, min=-1, max=1))
Y02 = X02%*%as.vector(theta02) + rnorm(n02, mean=0, sd=sqrt(sigsq0))
D02 = cbind(X02, Y02)

n03 = 50
theta03 = c(0, 3, 5)
X03 = cbind(1, rnorm(n03, mean=0, sd=1), runif(n03, min=-1, max=1))
Y03 = X03%*%as.vector(theta03) + rnorm(n03, mean=0, sd=sqrt(sigsq0))
D03 = cbind(X03, Y03)

D0 = list(D01, D02, D03)
n0 = c(n01, n02, n03)

n = 100
theta = c(0, 3, 5)
X = cbind(1, rnorm(n, mean=0, sd=1), runif(n, min=-1, max=1))
Y = X%*%as.vector(theta) + rnorm(n, mean=0, sd=sqrt(sigsq0))

LMMNPP_MCMC1(D0=D0, X=X, Y=Y, a0=2, b=2, mu0=c(0,0,0), R=diag(c(1/64,1/64,1/64)),
             delta_ini=NULL, prior_delta_alpha=c(1,1,1), prior_delta_beta=c(1,1,1),
             prop_delta_alpha=c(1,1,1), prop_delta_beta=c(1,1,1),
             prop_delta="RW", rw_delta=0.9, nsample=5000, burnin=1000, thin=3)

## End(Not run)
</code></pre>

<hr>
<h2 id='LMMNPP_MCMC2'>
MCMC Sampling for Linear Regression Model of multiple historical data using
Normalized Power Prior
</h2><span id='topic+LMMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple historical data are combined individually.
The NPP of multiple historical data is the product of the NPP of each historical data.
Conduct posterior sampling for Linear Regression Model with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameters <code class="reqn">(\beta, \sigma^2)</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMMNPP_MCMC2(D0, X, Y, a0, b, mu0, R, delta_ini, prop_delta,
             prior_delta_alpha, prior_delta_beta, prop_delta_alpha,
             prop_delta_beta, rw_delta, nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMMNPP_MCMC2_+3A_d0">D0</code></td>
<td>
<p>a list of <code class="reqn">k</code> elements representing <code class="reqn">k</code> historical data, where the
<code class="reqn">i^{th}</code> element corresponds to the <code class="reqn">i^{th}</code> historical data named
as &ldquo;D0i&rdquo;.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_x">X</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the
number of observations.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_y">Y</code></td>
<td>
<p>a vector of individual level of the response y in the current data.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_a0">a0</code></td>
<td>
<p>a positive shape parameter for inverse-gamma prior on model parameter                          <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_b">b</code></td>
<td>
<p>a positive scale parameter for inverse-gamma prior on model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_mu0">mu0</code></td>
<td>
<p>a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_r">R</code></td>
<td>
<p>a inverse matrix of the covariance matrix for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_delta_ini">delta_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_prop_delta">prop_delta</code></td>
<td>
<p>the class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the prior distribution                          <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the prior distribution                           <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_prop_delta_alpha">prop_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the proposal                                    distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_prop_delta_beta">prop_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the proposal distribution                        <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_rw_delta">rw_delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal
of logit <code class="reqn">\delta</code>. Only applicable if prop_delta = 'RW'.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="LMMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameters and power parameter,
acceptance rate in sampling <code class="reqn">\delta</code>.
Let <code class="reqn">\theta</code>=<code class="reqn">(\beta, \sigma^2)</code>, the normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\delta)\prod_{k=1}^{K}\frac{\pi_0(\theta)L(\theta|D_{0k})^{\delta_k}}{\int \pi_0(\theta)L(\theta|D_{0k})^{\delta_k} \,d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\delta</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\delta_k</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using
Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\beta</code> in vector or matrix form.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LMMNPP_MCMC1">LMMNPP_MCMC1</a></code>;
<code><a href="#topic+LMOMNPP_MCMC1">LMOMNPP_MCMC1</a></code>;
<code><a href="#topic+LMOMNPP_MCMC2">LMOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1234)
sigsq0 = 1

n01 = 100
theta01 = c(0, 1, 1)
X01 = cbind(1, rnorm(n01, mean=0, sd=1), runif(n01, min=-1, max=1))
Y01 = X01%*%as.vector(theta01) + rnorm(n01, mean=0, sd=sqrt(sigsq0))
D01 = cbind(X01, Y01)

n02 = 70
theta02 = c(0, 2, 3)
X02 = cbind(1, rnorm(n02, mean=0, sd=1), runif(n02, min=-1, max=1))
Y02 = X02%*%as.vector(theta02) + rnorm(n02, mean=0, sd=sqrt(sigsq0))
D02 = cbind(X02, Y02)

n03 = 50
theta03 = c(0, 3, 5)
X03 = cbind(1, rnorm(n03, mean=0, sd=1), runif(n03, min=-1, max=1))
Y03 = X03%*%as.vector(theta03) + rnorm(n03, mean=0, sd=sqrt(sigsq0))
D03 = cbind(X03, Y03)

D0 = list(D01, D02, D03)
n0 = c(n01, n02, n03)

n = 100
theta = c(0, 3, 5)
X = cbind(1, rnorm(n, mean=0, sd=1), runif(n, min=-1, max=1))
Y = X%*%as.vector(theta) + rnorm(n, mean=0, sd=sqrt(sigsq0))

LMMNPP_MCMC2(D0=D0, X=X, Y=Y, a0=2, b=2, mu0=c(0,0,0), R=diag(c(1/64,1/64,1/64)),
             delta_ini=NULL, prior_delta_alpha=c(1,1,1), prior_delta_beta=c(1,1,1),
             prop_delta_alpha=c(1,1,1), prop_delta_beta=c(1,1,1),
             prop_delta="RW", rw_delta=0.9, nsample=5000, burnin=1000, thin=5)

## End(Not run)
</code></pre>

<hr>
<h2 id='LMNPP_MCMC'>MCMC Sampling for Normal Linear Model using Normalized Power Prior</h2><span id='topic+LMNPP_MCMC'></span>

<h3>Description</h3>

<p>Conduct posterior sampling for normal linear model with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the regression parameter <code class="reqn">\beta</code> and <code class="reqn">\sigma^2</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMNPP_MCMC(y.Cur, y.Hist, x.Cur = NULL, x.Hist = NULL,
           prior = list(a = 1.5, b = 0, mu0 = 0,
                   Rinv = matrix(1, nrow = 1), delta.alpha = 1, delta.beta = 1),
           MCMCmethod = 'IND', rw.logit.delta = 0.1,
           ind.delta.alpha= 1, ind.delta.beta= 1, nsample = 5000,
           control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMNPP_MCMC_+3A_y.cur">y.Cur</code></td>
<td>
<p>a vector of individual level of the response y in current data.</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_y.hist">y.Hist</code></td>
<td>
<p>a vector of individual level of the response y in historical data.</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_x.cur">x.Cur</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the number of
observations.</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_x.hist">x.Hist</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the historical data.
If more than 1 covariate available, the number of rows is equal to the number of
observations.</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for model parameters
<code class="reqn">(\beta, \sigma^2)</code> and <code class="reqn">\delta</code>.
The form of the prior for model parameter <code class="reqn">(\beta, \sigma^2)</code> is in the section &quot;Details&quot;.
</p>
<p><code>a</code> a positive hyperparameter for prior on model parameters. It is the power <code class="reqn">a</code> in formula <code class="reqn">(1/\sigma^2)^a</code>;
See details.
</p>
<p><code>b</code> equals 0 if a flat prior is used for <code class="reqn">\beta</code>. Equals 1 if a normal prior is used for <code class="reqn">\beta</code>; See details.
</p>
<p><code>mu0</code> a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>. Only applicable if <code>b = 1</code>.
</p>
<p><code>Rinv</code> inverse of the matrix <code class="reqn">R</code>. The covariance matrix of the prior for <code class="reqn">\beta|\sigma^2</code> is <code class="reqn">\sigma^2 R^{-1}</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_mcmcmethod">MCMCmethod</code></td>
<td>
<p>sampling method for <code class="reqn">\delta</code> in MCMC. It can be either 'IND' for independence proposal; or 'RW' for
random walk proposal on logit scale. </p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_rw.logit.delta">rw.logit.delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>.
Only applicable if <code>MCMCmethod = 'RW'. </code> </p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_ind.delta.alpha">ind.delta.alpha</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\alpha</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_ind.delta.beta">ind.delta.beta</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\beta</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="LMNPP_MCMC_+3A_control.mcmc">control.mcmc</code></td>
<td>
<p>a list of three elements used in posterior sampling.
</p>
<p><code>delta.ini</code> is the initial value of <code class="reqn">\delta</code> in MCMC sampling.
</p>
<p><code>burnin</code> is the number of burn-ins. The output will only show MCMC samples after bunrin.
</p>
<p><code>thin</code> is the thinning parameter in MCMC sampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">b = 1</code>, prior for <code class="reqn">(\beta, \sigma)</code> is <code class="reqn">(1/\sigma^2)^a * N(mu0, \sigma^2 R^{-1})</code>, which includes the g-prior.
If <code class="reqn">b = 0</code>, prior for <code class="reqn">(\beta, \sigma)</code> is <code class="reqn">(1/\sigma^2)^a</code>.
The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate when sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with five elements:
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\beta</code> in vector or matrix form.</p>
</td></tr>
<tr><td><code>sigmasq</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>the deviance information criteria for model diagnostics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>
<p>Berger, J.O. and Bernardo, J.M. (1992).
On the development of reference priors.
<em>Bayesian Statistics 4: Proceedings of
the Fourth Valencia International Meeting, Bernardo, J.M, Berger,
J.O., Dawid, A.P. and Smith, A.F.M. eds., 35-60, Clarendon Press:Oxford.</em>
</p>
<p>Jeffreys, H. (1946).
An Invariant Form for the Prior Probability in Estimation Problems.
<em>Proceedings of the Royal Statistical Society of London, Series A  186:453-461.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerNPP_MCMC">BerNPP_MCMC</a></code>;
<code><a href="#topic+MultinomialNPP_MCMC">MultinomialNPP_MCMC</a></code>;
<code><a href="#topic+PoissonNPP_MCMC">PoissonNPP_MCMC</a></code>;
<code><a href="#topic+NormalNPP_MCMC">NormalNPP_MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x1 = runif(100, min = 0, max = 10)
x0 = runif(100, min = 0, max = 1)
y1 = 10+ 2*x1 + rnorm(100, mean = 0, sd = 1)
y0 = 10+ 1.5*x0 + rnorm(100, mean = 0, sd = 1)

RegPost = LMNPP_MCMC(y.Cur = y1, y.Hist = y0, x.Cur = x1, x.Hist = x0,
                     prior = list(a = 1.5, b = 0, mu0 = c(0, 0),
                                  Rinv = diag(100, nrow = 2),
                     delta.alpha = 1, delta.beta = 1), MCMCmethod = 'IND',
                     ind.delta.alpha= 1, ind.delta.beta= 1, nsample = 5000,
                     control.mcmc = list(delta.ini = NULL,
                                         burnin = 2000, thin = 2))
</code></pre>

<hr>
<h2 id='LMOMNPP_MCMC1'>
MCMC Sampling for Linear Regression Model of multiple historical data using
Ordered Normalized Power Prior
</h2><span id='topic+LMOMNPP_MCMC1'></span>

<h3>Description</h3>

<p>Multiple historical data are incorporated together.
Conduct posterior sampling for Linear Regression Model with ordered normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with
independence proposal is used.
For the model parameters <code class="reqn">(\beta, \sigma^2)</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMOMNPP_MCMC1(D0, X, Y, a0, b, mu0, R, gamma_ini, prior_gamma,
              gamma_ind_prop, nsample, burnin, thin, adjust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMOMNPP_MCMC1_+3A_d0">D0</code></td>
<td>
<p>a list of <code class="reqn">k</code> elements representing <code class="reqn">k</code> historical data, where the
<code class="reqn">i^{th}</code> element corresponds to the <code class="reqn">i^{th}</code> historical data named
as &ldquo;D0i&rdquo;.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_x">X</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the
number of observations.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_y">Y</code></td>
<td>
<p>a vector of individual level of the response y in the current data.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_a0">a0</code></td>
<td>
<p>a positive shape parameter for inverse-gamma prior on model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_b">b</code></td>
<td>
<p>a positive scale parameter for inverse-gamma prior on model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_mu0">mu0</code></td>
<td>
<p>a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_r">R</code></td>
<td>
<p>a inverse matrix of the covariance matrix for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution
<code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution                                          <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC1_+3A_adjust">adjust</code></td>
<td>
<p>Whether or not to adjust the parameters of the proposal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameters and power parameter,
acceptance rate in sampling <code class="reqn">\gamma</code>.
Let <code class="reqn">\theta</code>=<code class="reqn">(\beta, \sigma^2)</code>, the normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\gamma)\pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^(\sum_{i=1}^{k}\gamma_i)}{\int \pi_0(\theta)\prod_{k=1}^{K}L(\theta|D_{0k})^(\sum_{i=1}^{k}\gamma_i)\,d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using
Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\beta</code> in vector or matrix form.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LMMNPP_MCMC1">LMMNPP_MCMC1</a></code>;
<code><a href="#topic+LMMNPP_MCMC2">LMMNPP_MCMC2</a></code>;
<code><a href="#topic+LMOMNPP_MCMC2">LMOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1234)
sigsq0 = 1

n01 = 100
theta01 = c(0, 1, 1)
X01 = cbind(1, rnorm(n01, mean=0, sd=1), runif(n01, min=-1, max=1))
Y01 = X01%*%as.vector(theta01) + rnorm(n01, mean=0, sd=sqrt(sigsq0))
D01 = cbind(X01, Y01)

n02 = 70
theta02 = c(0, 2, 3)
X02 = cbind(1, rnorm(n02, mean=0, sd=1), runif(n02, min=-1, max=1))
Y02 = X02%*%as.vector(theta02) + rnorm(n02, mean=0, sd=sqrt(sigsq0))
D02 = cbind(X02, Y02)

n03 = 50
theta03 = c(0, 3, 5)
X03 = cbind(1, rnorm(n03, mean=0, sd=1), runif(n03, min=-1, max=1))
Y03 = X03%*%as.vector(theta03) + rnorm(n03, mean=0, sd=sqrt(sigsq0))
D03 = cbind(X03, Y03)

D0 = list(D01, D02, D03)
n0 = c(n01, n02, n03)

n = 100
theta = c(0, 3, 5)
X = cbind(1, rnorm(n, mean=0, sd=1), runif(n, min=-1, max=1))
Y = X%*%as.vector(theta) + rnorm(n, mean=0, sd=sqrt(sigsq0))

LMOMNPP_MCMC1(D0=D0, X=X, Y=Y, a0=2, b=2, mu0=c(0,0,0), R=diag(c(1/64,1/64,1/64)),
              gamma_ini=NULL, prior_gamma=rep(1/4,4), gamma_ind_prop=rep(1/4,4),
              nsample=5000, burnin=1000, thin=5, adjust=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='LMOMNPP_MCMC2'>
MCMC Sampling for Linear Regression Model of multiple historical data using
Ordered Normalized Power Prior
</h2><span id='topic+LMOMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple historical data are combined individually.
The NPP of multiple historical data is the product of the NPP of each historical data.
Conduct posterior sampling for Linear Regression Model with ordered normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with
independence proposal is used.
For the model parameters <code class="reqn">(\beta, \sigma^2)</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LMOMNPP_MCMC2(D0, X, Y, a0, b, mu0, R, gamma_ini, prior_gamma,
              gamma_ind_prop, nsample, burnin, thin, adjust)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LMOMNPP_MCMC2_+3A_d0">D0</code></td>
<td>
<p>a list of <code class="reqn">k</code> elements representing <code class="reqn">k</code> historical data, where the
<code class="reqn">i^{th}</code> element corresponds to the <code class="reqn">i^{th}</code> historical data named
as &ldquo;D0i&rdquo;.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_x">X</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the
number of observations.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_y">Y</code></td>
<td>
<p>a vector of individual level of the response y in the current data.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_a0">a0</code></td>
<td>
<p>a positive shape parameter for inverse-gamma prior on model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_b">b</code></td>
<td>
<p>a positive scale parameter for inverse-gamma prior on model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_mu0">mu0</code></td>
<td>
<p>a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_r">R</code></td>
<td>
<p>a inverse matrix of the covariance matrix for prior <code class="reqn">\beta|\sigma^2</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution
<code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution                                          <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
<tr><td><code id="LMOMNPP_MCMC2_+3A_adjust">adjust</code></td>
<td>
<p>Whether or not to adjust the parameters of the proposal distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameters and power parameter,
acceptance rate in sampling <code class="reqn">\gamma</code>.
Let <code class="reqn">\theta</code>=<code class="reqn">(\beta, \sigma^2)</code>, the normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\gamma)\prod_{k=1}^{K}\frac{\pi_0(\theta)L(\theta|D_{0k})^(\sum_{i=1}^{k}\gamma_i)}{\int \pi_0(\theta)L(\theta|D_{0k})^(\sum_{i=1}^{k}\gamma_i)\,d\theta}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\theta)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\theta</code>, respectively. <code class="reqn">L(\theta|D_{0k})</code> is the likelihood function
of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using
Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\beta</code> in vector or matrix form.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LMMNPP_MCMC1">LMMNPP_MCMC1</a></code>;
<code><a href="#topic+LMMNPP_MCMC2">LMMNPP_MCMC2</a></code>;
<code><a href="#topic+LMOMNPP_MCMC1">LMOMNPP_MCMC1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
set.seed(1234)
sigsq0 = 1

n01 = 100
theta01 = c(0, 1, 1)
X01 = cbind(1, rnorm(n01, mean=0, sd=1), runif(n01, min=-1, max=1))
Y01 = X01%*%as.vector(theta01) + rnorm(n01, mean=0, sd=sqrt(sigsq0))
D01 = cbind(X01, Y01)

n02 = 70
theta02 = c(0, 2, 3)
X02 = cbind(1, rnorm(n02, mean=0, sd=1), runif(n02, min=-1, max=1))
Y02 = X02%*%as.vector(theta02) + rnorm(n02, mean=0, sd=sqrt(sigsq0))
D02 = cbind(X02, Y02)

n03 = 50
theta03 = c(0, 3, 5)
X03 = cbind(1, rnorm(n03, mean=0, sd=1), runif(n03, min=-1, max=1))
Y03 = X03%*%as.vector(theta03) + rnorm(n03, mean=0, sd=sqrt(sigsq0))
D03 = cbind(X03, Y03)

D0 = list(D01, D02, D03)
n0 = c(n01, n02, n03)

n = 100
theta = c(0, 3, 5)
X = cbind(1, rnorm(n, mean=0, sd=1), runif(n, min=-1, max=1))
Y = X%*%as.vector(theta) + rnorm(n, mean=0, sd=sqrt(sigsq0))

LMOMNPP_MCMC1(D0=D0, X=X, Y=Y, a0=2, b=2, mu0=c(0,0,0), R=diag(c(1/64,1/64,1/64)),
              gamma_ini=NULL, prior_gamma=rep(1/4,4), gamma_ind_prop=rep(1/4,4),
              nsample=5000, burnin=1000, thin=5, adjust=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='logCdelta'>
A Function to Interpolate <code class="reqn">logC(\delta)</code> Based on Its Values on Selected Knots
</h2><span id='topic+logCdelta'></span>

<h3>Description</h3>

<p>The function returns the interpolated value (a scalar) of <code class="reqn">logC(\delta)</code> based on its results on selected knots,
given input vector of <code class="reqn">\delta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logCdelta(delta, deltaknot, lCknot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logCdelta_+3A_delta">delta</code></td>
<td>
<p>a scalar of the input value of <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="logCdelta_+3A_deltaknot">deltaknot</code></td>
<td>
<p>a vector of the knots for <code class="reqn">\delta</code>. It should be selected before conduct the sampling.</p>
</td></tr>
<tr><td><code id="logCdelta_+3A_lcknot">lCknot</code></td>
<td>
<p>a vector of the values <code class="reqn">logC(\delta)</code> on selected knots, coming from the function <code>logCknot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sequence of the values, <code class="reqn">logC(\delta)</code> on selected knots.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikNormD0">loglikNormD0</a></code>;
<code><a href="#topic+loglikBerD0">loglikBerD0</a></code>;
<code><a href="#topic+logCknot">logCknot</a></code>
</p>

<hr>
<h2 id='logCknot'>
A Function to Calculate <code class="reqn">logC(\delta)</code> on Selected Knots
</h2><span id='topic+logCknot'></span>

<h3>Description</h3>

<p>The function returns a sequence of the values, <code class="reqn">logC(\delta)</code> on selected knots, given
input vector of <code class="reqn">\delta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logCknot(deltaknot, llikf0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logCknot_+3A_deltaknot">deltaknot</code></td>
<td>
<p>a vector of the knots for <code class="reqn">\delta</code>. It should be selected before conduct the sampling.</p>
</td></tr>
<tr><td><code id="logCknot_+3A_llikf0">llikf0</code></td>
<td>
<p>a matrix of the log-likelihoods of class &quot;npp&quot;. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sequence of the values, <code class="reqn">logC(\delta)</code> on selected knots.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikNormD0">loglikNormD0</a></code>;
<code><a href="#topic+loglikBerD0">loglikBerD0</a></code>;
<code><a href="#topic+logCdelta">logCdelta</a></code>
</p>

<hr>
<h2 id='loglikBerD0'>
A Function to Calculate Log-likelihood of the Historical Data, Given Matrix-valued Parameters, for Bernoulli Population
</h2><span id='topic+loglikBerD0'></span>

<h3>Description</h3>

<p>The function returns a matrix of class &quot;npp&quot;, each element is a log-likelihood of the historical data.
It is an intermediate step to calculate the &quot;normalizing constant&quot; <code class="reqn">C(\delta)</code> in the normalized
power prior, for the purpose of providing a flexible implementation.
Users can specify their own likelihood function of the same class following this structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikBerD0(D0, thetalist, ntheta = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikBerD0_+3A_d0">D0</code></td>
<td>
<p>a vector of each observation(binary) in historical data.</p>
</td></tr>
<tr><td><code id="loglikBerD0_+3A_thetalist">thetalist</code></td>
<td>
<p>a list of parameter values. The number of elements is equal to <code>ntheta</code>.
Each element is a matrix. The sample should come from the posterior of the
powered likelihood for historical data, with each column corresponds to a
distinct value of the power parameter <code class="reqn">\delta</code>
(the corresponding power parameter increases from left to right).
The number of rows is the number of Monte Carlo samples for each <code class="reqn">\delta</code> fixed.
The number of columns is the number of selected knots (number of distinct <code class="reqn">\delta</code>).
</p>
</td></tr>
<tr><td><code id="loglikBerD0_+3A_ntheta">ntheta</code></td>
<td>
<p>a positive integer indicating number of parameters to be estimated in the model. Default is 1 for Bernoulli. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of log-likelihood, for the historical data given the matrix(or array)-valued parameters.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikNormD0">loglikNormD0</a></code>;
<code><a href="#topic+logCknot">logCknot</a></code>;
<code><a href="#topic+logCdelta">logCdelta</a></code>
</p>

<hr>
<h2 id='loglikNormD0'>
A Function to Calculate Log-likelihood of the Historical Data, Given Array-valued Parameters, for Normal Population
</h2><span id='topic+loglikNormD0'></span>

<h3>Description</h3>

<p>The function returns a matrix of class &quot;npp&quot;, each element is a log-likelihood of the historical data.
It is an intermediate step to calculate the &quot;normalizing constant&quot; <code class="reqn">C(\delta)</code> in the normalized
power prior, for the purpose of providing a flexible implementation.
Users can specify their own likelihood function of the same class following this structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglikNormD0(D0, thetalist, ntheta = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglikNormD0_+3A_d0">D0</code></td>
<td>
<p>a vector of each observation in historical data.</p>
</td></tr>
<tr><td><code id="loglikNormD0_+3A_thetalist">thetalist</code></td>
<td>
<p>a list of parameter values. The number of elements is equal to <code>ntheta</code>.
Each element is a matrix. The sample should come from the posterior of the
powered likelihood for historical data, with each column corresponds to a
distinct value of the power parameter <code class="reqn">\delta</code>
(the corresponding power parameter increases from left to right).
The number of rows is the number of Monte Carlo samples for each <code class="reqn">\delta</code> fixed.
The number of columns is the number of selected knots (number of distinct <code class="reqn">\delta</code>).
</p>
</td></tr>
<tr><td><code id="loglikNormD0_+3A_ntheta">ntheta</code></td>
<td>
<p>a positive integer indicating number of parameters to be estimated in the model. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix of log-likelihood, for the historical data given the matrix(or array)-valued parameters.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+loglikBerD0">loglikBerD0</a></code>;
<code><a href="#topic+logCknot">logCknot</a></code>;
<code><a href="#topic+logCdelta">logCdelta</a></code>
</p>

<hr>
<h2 id='ModeDeltaBerNPP'>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Bernoulli Population</h2><span id='topic+ModeDeltaBerNPP'></span>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in Bernoulli population.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModeDeltaBerNPP(Data.Cur, Data.Hist,
                CompStat = list(n0 = NULL, y0 = NULL, n1 = NULL, y1 = NULL),
                npoints = 1000,
                prior = list(p.alpha = 1, p.beta = 1,
                             delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModeDeltaBerNPP_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of two elements: c(number of success, number of failure) in the current data.</p>
</td></tr>
<tr><td><code id="ModeDeltaBerNPP_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of two elements: c(number of success, number of failure) in the historical data.</p>
</td></tr>
<tr><td><code id="ModeDeltaBerNPP_+3A_compstat">CompStat</code></td>
<td>
<p>a list of four elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">p</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
Note: in Bernoulli population providing <code>CompStat</code> is equivalent to provide the data summary as in
<code>Data.Cur</code> and <code>Data.Cur</code>.
</p>
<p><code>n0</code> is the number of trials in the historical data.
</p>
<p><code>y0</code> is the number of successes in the historical data.
</p>
<p><code>n1</code> is the number of trials in the current data.
</p>
<p><code>y1</code> is the number of successes in the current data.
</p>
</td></tr>
<tr><td><code id="ModeDeltaBerNPP_+3A_npoints">npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td></tr>
<tr><td><code id="ModeDeltaBerNPP_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">p</code> and <code class="reqn">\delta</code>.
</p>
<p><code>p.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.
</p>
<p><code>p.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">p</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See example.
</p>


<h3>Value</h3>

<p>A numeric value between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModeDeltaNormalNPP">ModeDeltaNormalNPP</a></code>;
<code><a href="#topic+ModeDeltaPoisNPP">ModeDeltaPoisNPP</a></code>;
<code><a href="#topic+ModeDeltaMultinomialNPP">ModeDeltaMultinomialNPP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ModeDeltaBerNPP(Data.Cur = c(100, 40), Data.Hist = c(100, 40), npoints = 1000,
                prior = list(p.alpha = 1, p.beta = 1, delta.alpha = 1, delta.beta = 1))

ModeDeltaBerNPP(Data.Cur = c(100, 40), Data.Hist = c(100, 35), npoints = 1000,
                prior = list(p.alpha = 1, p.beta = 1, delta.alpha = 1, delta.beta = 1))

ModeDeltaBerNPP(Data.Cur = c(100, 40), Data.Hist = c(100, 50), npoints = 1000,
                prior = list(p.alpha = 1, p.beta = 1, delta.alpha = 1, delta.beta = 1))
</code></pre>

<hr>
<h2 id='ModeDeltaLMNPP'>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search,
Normal Linear Model</h2><span id='topic+ModeDeltaLMNPP'></span>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in normal linear model.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModeDeltaLMNPP(y.Cur, y.Hist, x.Cur = NULL, x.Hist = NULL, npoints = 1000,
               prior = list(a = 1.5, b = 0, mu0 = 0, Rinv = matrix(1, nrow = 1),
                            delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModeDeltaLMNPP_+3A_y.cur">y.Cur</code></td>
<td>
<p>a vector of individual level of the response y in current data.</p>
</td></tr>
<tr><td><code id="ModeDeltaLMNPP_+3A_y.hist">y.Hist</code></td>
<td>
<p>a vector of individual level of the response y in historical data.</p>
</td></tr>
<tr><td><code id="ModeDeltaLMNPP_+3A_x.cur">x.Cur</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the current data.
If more than 1 covariate available, the number of rows is equal to the number of
observations.</p>
</td></tr>
<tr><td><code id="ModeDeltaLMNPP_+3A_x.hist">x.Hist</code></td>
<td>
<p>a vector or matrix or data frame of covariate observed in the historical data.
If more than 1 covariate available, the number of rows is equal to the number of
observations.</p>
</td></tr>
<tr><td><code id="ModeDeltaLMNPP_+3A_npoints">npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td></tr>
<tr><td><code id="ModeDeltaLMNPP_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for model parameters
<code class="reqn">(\beta, \sigma^2)</code> and <code class="reqn">\delta</code>.
The form of the prior for model parameter <code class="reqn">(\beta, \sigma^2)</code> is in the section &quot;Details&quot;.
</p>
<p><code>a</code> a positive hyperparameter for prior on model parameters. It is the power <code class="reqn">a</code> in formula <code class="reqn">(1/\sigma^2)^a</code>;
See details.
</p>
<p><code>b</code> equals 0 if a flat prior is used for <code class="reqn">\beta</code>. Equals 1 if a normal prior is used for <code class="reqn">\beta</code>; See details.
</p>
<p><code>mu0</code> a vector of the mean for prior <code class="reqn">\beta|\sigma^2</code>. Only applicable if <code>b = 1</code>.
</p>
<p><code>Rinv</code> inverse of the matrix <code class="reqn">R</code>. The covariance matrix of the prior for <code class="reqn">\beta|\sigma^2</code> is <code class="reqn">\sigma^2 R^{-1}</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">b = 1</code>, prior for <code class="reqn">(\beta, \sigma)</code> is <code class="reqn">(1/\sigma^2)^a * N(mu0, \sigma^2 R^{-1})</code>, which includes the g-prior.
If <code class="reqn">b = 0</code>, prior for <code class="reqn">(\beta, \sigma)</code> is <code class="reqn">(1/\sigma^2)^a</code>.
The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate when sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>
<p>Berger, J.O. and Bernardo, J.M. (1992).
On the development of reference priors.
<em>Bayesian Statistics 4: Proceedings of
the Fourth Valencia International Meeting, Bernardo, J.M, Berger,
J.O., Dawid, A.P. and Smith, A.F.M. eds., 35-60, Clarendon Press:Oxford.</em>
</p>
<p>Jeffreys, H. (1946).
An Invariant Form for the Prior Probability in Estimation Problems.
<em>Proceedings of the Royal Statistical Society of London, Series A  186:453-461.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModeDeltaBerNPP">ModeDeltaBerNPP</a></code>;
<code><a href="#topic+ModeDeltaNormalNPP">ModeDeltaNormalNPP</a></code>;
<code><a href="#topic+ModeDeltaMultinomialNPP">ModeDeltaMultinomialNPP</a></code>;
<code><a href="#topic+ModeDeltaNormalNPP">ModeDeltaNormalNPP</a></code>
</p>

<hr>
<h2 id='ModeDeltaMultinomialNPP'>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Multinomial Population</h2><span id='topic+ModeDeltaMultinomialNPP'></span>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in multinomial population.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModeDeltaMultinomialNPP(Data.Cur, Data.Hist, CompStat = list(n0 = NULL, n1 = NULL),
                        npoints = 1000, prior = list(theta.dir.alpha = c(0.5, 0.5, 0.5),
                        delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModeDeltaMultinomialNPP_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of <code class="reqn">K</code> elements:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>)
in the current data.</p>
</td></tr>
<tr><td><code id="ModeDeltaMultinomialNPP_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of <code class="reqn">K</code> elements:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>)
in the historical data.</p>
</td></tr>
<tr><td><code id="ModeDeltaMultinomialNPP_+3A_compstat">CompStat</code></td>
<td>
<p>a list of two elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">\theta</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
Note: in multinomial case providing <code>CompStat</code> is equivalent to provide the data summary as in
<code>Data.Cur</code> and <code>Data.Cur</code>.
</p>
<p><code>n0</code> is a non-negative integer vector of <code class="reqn">K</code> elements for compatible statistics in historical data:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>).
</p>
<p><code>n1</code> is a non-negative integer vector of <code class="reqn">K</code> elements for compatible statistics in current data:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>).
</p>
</td></tr>
<tr><td><code id="ModeDeltaMultinomialNPP_+3A_npoints">npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td></tr>
<tr><td><code id="ModeDeltaMultinomialNPP_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">p</code> and <code class="reqn">\delta</code>.
</p>
<p><code>theta.dir</code> is a vector of <code class="reqn">K</code> elements of the hyperparameter <code class="reqn">\alpha</code>
in the prior distribution <code class="reqn">Dir(\alpha[1],\alpha[2],...,\alpha[K])</code> for <code class="reqn">\theta</code>.
</p>
<p><code>delta.alpha</code> a scalar, the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> a scalar, the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See example.
</p>


<h3>Value</h3>

<p>A numeric value between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModeDeltaBerNPP">ModeDeltaBerNPP</a></code>;
<code><a href="#topic+ModeDeltaNormalNPP">ModeDeltaNormalNPP</a></code>;
<code><a href="#topic+ModeDeltaPoisNPP">ModeDeltaPoisNPP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ModeDeltaMultinomialNPP(CompStat = list(n0 = c(25,25,25,25), n1 = c(25,25,25,25)),
                        prior = list(theta.dir.alpha = c(0.5, 0.5, 0.5, 0.5),
                                     delta.alpha = 1, delta.beta = 1))

ModeDeltaMultinomialNPP(CompStat = list(n0 = c(22,25,28,25), n1 = c(25,22,25,28)),
                        prior = list(theta.dir.alpha = c(0.5, 0.5, 0.5, 0.5),
                                     delta.alpha = 1, delta.beta = 1))

ModeDeltaMultinomialNPP(CompStat = list(n0 = c(15,25,30,30), n1 = c(25,25,25,25)),
                        prior = list(theta.dir.alpha = c(0.5, 0.5, 0.5, 0.5),
                                     delta.alpha = 1, delta.beta = 1))
</code></pre>

<hr>
<h2 id='ModeDeltaNormalNPP'>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Normal Population</h2><span id='topic+ModeDeltaNormalNPP'></span>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in multinomial population.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModeDeltaNormalNPP(Data.Cur, Data.Hist,
                   CompStat = list(n0 = NULL, mean0 = NULL, var0 = NULL,
                                   n1 = NULL, mean1 = NULL, var1 = NULL),
                   npoints = 1000,
                   prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModeDeltaNormalNPP_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a vector of individual level current data.</p>
</td></tr>
<tr><td><code id="ModeDeltaNormalNPP_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a vector of individual level historical data.</p>
</td></tr>
<tr><td><code id="ModeDeltaNormalNPP_+3A_compstat">CompStat</code></td>
<td>
<p>a list of six elements(scalar) that represents the
&quot;compatibility(sufficient) statistics&quot; for model parameters.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
</p>
<p><code>n0</code> is the sample size of historical data.
</p>
<p><code>mean0</code> is the sample mean of the historical data.
</p>
<p><code>var0</code> is the sample variance of the historical data.
</p>
<p><code>n1</code> is the sample size of current data.
</p>
<p><code>mean1</code> is the sample mean of the current data.
</p>
<p><code>var1</code> is the sample variance of the current data.
</p>
</td></tr>
<tr><td><code id="ModeDeltaNormalNPP_+3A_npoints">npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td></tr>
<tr><td><code id="ModeDeltaNormalNPP_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">(\mu, \sigma^2)</code> and <code class="reqn">\delta</code>.
The form of the prior for model parameter <code class="reqn">(\mu, \sigma^2)</code> is <code class="reqn">(1/\sigma^2)^a</code>.
When <code class="reqn">a = 1</code> it corresponds to the reference prior, and when <code class="reqn">a = 1.5</code> it
corresponds to the Jeffrey's prior.
</p>
<p><code>a</code> is the power <code class="reqn">a</code> in formula <code class="reqn">(1/\sigma^2)^a</code>, the prior for <code class="reqn">(\mu, \sigma^2)</code> jointly.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See example.
</p>


<h3>Value</h3>

<p>A numeric value between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>
<p>Berger, J.O. and Bernardo, J.M. (1992).
On the development of reference priors.
<em>Bayesian Statistics 4: Proceedings of
the Fourth Valencia International Meeting, Bernardo, J.M, Berger,
J.O., Dawid, A.P. and Smith, A.F.M. eds., 35-60, Clarendon Press:Oxford.</em>
</p>
<p>Jeffreys, H. (1946).
An Invariant Form for the Prior Probability in Estimation Problems.
<em>Proceedings of the Royal Statistical Society of London, Series A  186:453-461.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModeDeltaBerNPP">ModeDeltaBerNPP</a></code>;
<code><a href="#topic+ModeDeltaMultinomialNPP">ModeDeltaMultinomialNPP</a></code>;
<code><a href="#topic+ModeDeltaPoisNPP">ModeDeltaPoisNPP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ModeDeltaNormalNPP(CompStat = list(n0 = 50, mean0 = 0, var0 = 1,
                                   n1 = 50, mean1 = 0, var1 = 1), npoints = 1000,
                   prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1))

ModeDeltaNormalNPP(CompStat = list(n0 = 50, mean0 = 0, var0 = 1,
                                   n1 = 40, mean1 = 0.2, var1 = 1), npoints = 1000,
                   prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1))

ModeDeltaNormalNPP(CompStat = list(n0 = 50, mean0 = 0, var0 = 1,
                                   n1 = 40, mean1 = 0.6, var1 = 1), npoints = 1000,
                   prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1))

</code></pre>

<hr>
<h2 id='ModeDeltaPoisNPP'>Calculate Posterior Mode of the Power Parameter in Normalized Power Prior with Grid Search, Poisson Population</h2><span id='topic+ModeDeltaPoisNPP'></span>

<h3>Description</h3>

<p>The function returns the posterior mode of the power parameter <code class="reqn">\delta</code> in multinomial population.
It calculates the log of the posterior density (up to a normalizing constant), and conduct a grid search
to find the approximate mode.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModeDeltaPoisNPP(Data.Cur, Data.Hist,
                 CompStat = list(n0 = NULL, mean0 = NULL, n1 = NULL, mean1 = NULL),
                 npoints = 1000, prior = list(lambda.shape = 1/2,
                 lambda.scale = 100, delta.alpha = 1, delta.beta = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModeDeltaPoisNPP_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of each observed current data.</p>
</td></tr>
<tr><td><code id="ModeDeltaPoisNPP_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of each observed historical data.</p>
</td></tr>
<tr><td><code id="ModeDeltaPoisNPP_+3A_compstat">CompStat</code></td>
<td>
<p>a list of four elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">\lambda</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
</p>
<p><code>n0</code> is the number of observations in the historical data.
</p>
<p><code>mean0</code> is the sample mean of the historical data.
</p>
<p><code>n1</code> is the number of observations in the current data.
</p>
<p><code>mean1</code> is the sample mean of the current data.
</p>
</td></tr>
<tr><td><code id="ModeDeltaPoisNPP_+3A_npoints">npoints</code></td>
<td>
<p>is a non-negative integer scalar indicating number of points on a regular spaced grid between [0, 1],
where we calculate the log of the posterior and search for the mode.</p>
</td></tr>
<tr><td><code id="ModeDeltaPoisNPP_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">\lambda</code> and <code class="reqn">\delta</code>.
A Gamma distribution is used as the prior of <code class="reqn">\lambda</code>, and a Beta distribution is used as the prior of <code class="reqn">\delta</code>.
</p>
<p><code>lambda.shape</code> is the shape (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>lambda.scale</code> is the scale (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See example.
</p>


<h3>Value</h3>

<p>A numeric value between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ModeDeltaBerNPP">ModeDeltaBerNPP</a></code>;
<code><a href="#topic+ModeDeltaNormalNPP">ModeDeltaNormalNPP</a></code>;
<code><a href="#topic+ModeDeltaMultinomialNPP">ModeDeltaMultinomialNPP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 10), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))

ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 9.5), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))

ModeDeltaPoisNPP(CompStat = list(n0 = 50, mean0 = 10, n1 = 50, mean1 = 9), npoints = 1000,
                 prior = list(lambda.shape = 1/2, lambda.scale = 100,
                              delta.alpha = 1, delta.beta = 1))
</code></pre>

<hr>
<h2 id='MultinomialNPP_MCMC'>MCMC Sampling for Multinomial Population using Normalized Power Prior</h2><span id='topic+MultinomialNPP_MCMC'></span>

<h3>Description</h3>

<p>Conduct posterior sampling for multinomial population with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter vector <code class="reqn">\theta</code>, Gibbs sampling is used.
Assume the prior for model parameter <code class="reqn">\theta</code> comes from a Dirichlet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultinomialNPP_MCMC(Data.Cur = c(10, 10, 10), Data.Hist = c(10, 10, 10),
                    CompStat = list(n0 = NULL, n1 = NULL),
                    prior = list(theta.dir = c(0.5, 0.5, 0.5),
                                 delta.alpha = 1, delta.beta = 1),
                    MCMCmethod = 'IND', rw.logit.delta = 0.1,
                    ind.delta.alpha = 1, ind.delta.beta = 1, nsample = 5000,
                    control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultinomialNPP_MCMC_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of <code class="reqn">K</code> elements:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>)
in the current data.</p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of <code class="reqn">K</code> elements:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>)
in the historical data.</p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_compstat">CompStat</code></td>
<td>
<p>a list of two elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">\theta</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
Note: in multinomial case providing <code>CompStat</code> is equivalent to provide the data summary as in
<code>Data.Cur</code> and <code>Data.Cur</code>.
</p>
<p><code>n0</code> is a non-negative integer vector of <code class="reqn">K</code> elements for compatible statistics in historical data:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>).
</p>
<p><code>n1</code> is a non-negative integer vector of <code class="reqn">K</code> elements for compatible statistics in current data:
c(number of success in group 1, number of success in group 2, ..., number of success in group <code class="reqn">K</code>).
</p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">p</code> and <code class="reqn">\delta</code>.
</p>
<p><code>theta.dir</code> is a vector of <code class="reqn">K</code> elements of the hyperparameter <code class="reqn">\alpha</code>
in the prior distribution
<code class="reqn">Dir(\alpha[1],\alpha[2],...,\alpha[K])</code> for <code class="reqn">\theta</code>.
</p>
<p><code>delta.alpha</code> a scalar, the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> a scalar, the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_mcmcmethod">MCMCmethod</code></td>
<td>
<p>sampling method for <code class="reqn">\delta</code> in MCMC. It can be either 'IND' for independence proposal; or 'RW' for
random walk proposal on logit scale. </p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_rw.logit.delta">rw.logit.delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>.
Only applicable if <code>MCMCmethod = 'RW'. </code> </p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_ind.delta.alpha">ind.delta.alpha</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\alpha</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_ind.delta.beta">ind.delta.beta</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\beta</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="MultinomialNPP_MCMC_+3A_control.mcmc">control.mcmc</code></td>
<td>
<p>a list of three elements used in posterior sampling.
</p>
<p><code>delta.ini</code> is the initial value of <code class="reqn">\delta</code> in MCMC sampling.
</p>
<p><code>burnin</code> is the number of burn-ins. The output will only show MCMC samples after bunrin.
</p>
<p><code>thin</code> is the thinning parameter in MCMC sampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>p</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\theta</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm. </p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>the deviance information criteria for model diagnostics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Tianyu Bai <a href="mailto:tianyu.bai24@gmail.com">tianyu.bai24@gmail.com</a>
Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerNPP_MCMC">BerNPP_MCMC</a></code>;
<code><a href="#topic+NormalNPP_MCMC">NormalNPP_MCMC</a></code>;
<code><a href="#topic+PoissonNPP_MCMC">PoissonNPP_MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MultinomialNPP_MCMC(Data.Cur = c(3,11,3,669), Data.Hist = c(9,20,9,473),
                    prior = list(theta.dir = c(1,1,1,1),
                    delta.alpha = 1, delta.beta = 1),
                    MCMCmethod = 'IND', rw.logit.delta = 0.1,
                    ind.delta.alpha = 1, ind.delta.beta = 1, nsample = 10000,
                    control.mcmc = list(delta.ini = NULL,
                    burnin = 2000, thin = 5))
</code></pre>

<hr>
<h2 id='NormalNPP_MCMC'>MCMC Sampling for Normal Population using Normalized Power Prior</h2><span id='topic+NormalNPP_MCMC'></span>

<h3>Description</h3>

<p>Conduct posterior sampling for normal population with normalized power prior.
The initial prior <code class="reqn">\pi(\mu|\sigma^2)</code> is a flat prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter <code class="reqn">\mu</code> and <code class="reqn">\sigma^2</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NormalNPP_MCMC(Data.Cur, Data.Hist,
               CompStat = list(n0 = NULL, mean0 = NULL, var0 = NULL,
                               n1 = NULL, mean1 = NULL, var1 = NULL),
               prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1),
               MCMCmethod = 'IND', rw.logit.delta = 0.1,
               ind.delta.alpha= 1, ind.delta.beta= 1, nsample = 5000,
               control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NormalNPP_MCMC_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a vector of individual level current data.</p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a vector of individual level historical data.</p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_compstat">CompStat</code></td>
<td>
<p>a list of six elements(scalar) that represents the
&quot;compatibility(sufficient) statistics&quot; for model parameters.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
</p>
<p><code>n0</code> is the sample size of historical data.
</p>
<p><code>mean0</code> is the sample mean of the historical data.
</p>
<p><code>var0</code> is the sample variance of the historical data.
</p>
<p><code>n1</code> is the sample size of current data.
</p>
<p><code>mean1</code> is the sample mean of the current data.
</p>
<p><code>var1</code> is the sample variance of the current data.
</p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">(\mu, \sigma^2)</code> and <code class="reqn">\delta</code>.
The form of the prior for model parameter <code class="reqn">(\mu, \sigma^2)</code> is <code class="reqn">(1/\sigma^2)^a</code>.
When <code class="reqn">a = 1</code> it corresponds to the reference prior, and when <code class="reqn">a = 1.5</code> it
corresponds to the Jeffrey's prior.
</p>
<p><code>a</code> is the power <code class="reqn">a</code> in formula <code class="reqn">(1/\sigma^2)^a</code>, the prior for <code class="reqn">(\mu, \sigma^2)</code> jointly.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_mcmcmethod">MCMCmethod</code></td>
<td>
<p>sampling method for <code class="reqn">\delta</code> in MCMC. It can be either 'IND' for independence proposal; or 'RW' for
random walk proposal on logit scale. </p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_rw.logit.delta">rw.logit.delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>.
Only applicable if <code>MCMCmethod = 'RW'. </code> </p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_ind.delta.alpha">ind.delta.alpha</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\alpha</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_ind.delta.beta">ind.delta.beta</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\beta</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="NormalNPP_MCMC_+3A_control.mcmc">control.mcmc</code></td>
<td>
<p>a list of three elements used in posterior sampling.
</p>
<p><code>delta.ini</code> is the initial value of <code class="reqn">\delta</code> in MCMC sampling.
</p>
<p><code>burnin</code> is the number of burn-ins. The output will only show MCMC samples after bunrin.
</p>
<p><code>thin</code> is the thinning parameter in MCMC sampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with five elements:
</p>
<table>
<tr><td><code>mu</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\mu</code>.</p>
</td></tr>
<tr><td><code>sigmasq</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\sigma^2</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>the deviance information criteria for model diagnostics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>
<p>Berger, J.O. and Bernardo, J.M. (1992).
On the development of reference priors.
<em>Bayesian Statistics 4: Proceedings of
the Fourth Valencia International Meeting, Bernardo, J.M, Berger,
J.O., Dawid, A.P. and Smith, A.F.M. eds., 35-60, Clarendon Press:Oxford.</em>
</p>
<p>Jeffreys, H. (1946).
An Invariant Form for the Prior Probability in Estimation Problems.
<em>Proceedings of the Royal Statistical Society of London, Series A  186:453-461.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BerNPP_MCMC">BerNPP_MCMC</a></code>;
<code><a href="#topic+MultinomialNPP_MCMC">MultinomialNPP_MCMC</a></code>;
<code><a href="#topic+PoissonNPP_MCMC">PoissonNPP_MCMC</a></code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
NormalData0 &lt;- rnorm(n = 100, mean= 20, sd = 1)

set.seed(12345)
NormalData1 &lt;- rnorm(n = 50, mean= 30, sd = 1)

NormalNPP_MCMC(Data.Cur = NormalData1, Data.Hist = NormalData0,
               CompStat = list(n0 = 100, mean0 = 10, var0 = 1,
               n1 = 100, mean1 = 10, var1 = 1),
               prior = list(a = 1.5, delta.alpha = 1, delta.beta = 1),
               MCMCmethod = 'RW', rw.logit.delta = 1,
               ind.delta.alpha= 1, ind.delta.beta= 1, nsample = 10000,
               control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>

<hr>
<h2 id='PHData'>
PH Data on four sites in Virginia
</h2><span id='topic+PHData'></span>

<h3>Description</h3>

<p>The dataset is used to assess if there is site impairment.
The site impairment is defined as whether the pH values at a site indicate that the site violates a
(lower) standard of 6.0 more than 10% of the time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("PHData")</code></pre>


<h3>Format</h3>

<p>A data frame with 325 observations on the following 3 variables.
</p>

<dl>
<dt><code>Station</code></dt><dd><p>the site number, labeled as 1 to 4</p>
</dd>
<dt><code>Data.Time</code></dt><dd><p>indicator of historical data (coded as 0) or current data (coded as 1)</p>
</dd>
<dt><code>PH</code></dt><dd><p>value of PH on the site </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(PHData)
</code></pre>

<hr>
<h2 id='PoiMNPP_MCMC1'>MCMC Sampling for Poisson Population using Normalized Power Prior with Multiple Historical Data</h2><span id='topic+PoiMNPP_MCMC1'></span>

<h3>Description</h3>

<p>This function incorporates multiple sets of historical data for posterior sampling in a Poisson population using a normalized power prior. The power parameter <code class="reqn">\delta</code> uses a Metropolis-Hastings algorithm, which can be either an independence proposal or a random walk proposal on its logit scale. For the model parameter <code class="reqn">\lambda</code>, Gibbs sampling is employed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoiMNPP_MCMC1(n0, n, prior_lambda, prop_delta, prior_delta_alpha,
              prior_delta_beta, rw_delta, delta_ini, nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoiMNPP_MCMC1_+3A_n0">n0</code></td>
<td>
<p>A vector of natural numbers: number of successes in historical data.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_n">n</code></td>
<td>
<p>A natural number: number of successes in the current data.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_prior_lambda">prior_lambda</code></td>
<td>
<p>A vector of hyperparameters for the prior distribution <code class="reqn">Gamma(\alpha, \beta)</code> of <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_prop_delta">prop_delta</code></td>
<td>
<p>The class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>A vector of hyperparameter <code class="reqn">\alpha</code> for the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>A vector of hyperparameter <code class="reqn">\beta</code> for the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_rw_delta">rw_delta</code></td>
<td>
<p>The stepsize (variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>. This is only applicable if <code>prop_delta = 'RW'</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_delta_ini">delta_ini</code></td>
<td>
<p>The initial value for <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>Specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>The number of burn-ins. Only the MCMC samples after this burn-in will be shown in the output.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>The thinning parameter used in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns posteriors for both the model and power parameters, as well as the acceptance rate for sampling <code class="reqn">\delta</code>. The normalized power prior distribution is given by:
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\delta)\pi_0(\lambda)\prod_{k=1}^{K}L(\lambda|D_{0k})^{\delta_{k}}}{\int \pi_0(\lambda)\prod_{k=1}^{K}L(\lambda|D_{0k})^{\delta_{k}} d\lambda}.</code>
</p>

<p>Here, <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\lambda)</code> are the initial prior distributions for <code class="reqn">\delta</code> and <code class="reqn">\lambda</code>, respectively. <code class="reqn">L(\lambda|D_{0k})</code> is the likelihood function based on historical data <code class="reqn">D_{0k}</code>, with <code class="reqn">\delta_k</code> being its corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; comprising:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>The acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using the Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Posterior samples of the model parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>Posterior samples of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y., and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K., and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PoiMNPP_MCMC2">PoiMNPP_MCMC2</a></code>,
<code><a href="#topic+PoiOMNPP_MCMC1">PoiOMNPP_MCMC1</a></code>,
<code><a href="#topic+PoiOMNPP_MCMC2">PoiOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PoiMNPP_MCMC1(n0 = c(0, 3, 5), n = 3, prior_lambda = c(1, 1/10), prop_delta = "IND",
              prior_delta_alpha = c(1, 1, 1), prior_delta_beta = c(1, 1, 1),
              rw_delta = 0.1, delta_ini = NULL, nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='PoiMNPP_MCMC2'>MCMC Sampling for Poisson Population of multiple historical data using Normalized Power Prior</h2><span id='topic+PoiMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple historical data are combined individually.
Conduct posterior sampling for Poisson population with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter <code class="reqn">\lambda</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoiMNPP_MCMC2(n0,n,prior_lambda,prop_delta,prior_delta_alpha,
                  prior_delta_beta,rw_delta, delta_ini,nsample,burnin,thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoiMNPP_MCMC2_+3A_n0">n0</code></td>
<td>
<p>a natural number vector : number of successes in historical data.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_n">n</code></td>
<td>
<p>a natural number : number of successes in the current data.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_prior_lambda">prior_lambda</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Gamma(\alpha, \beta)</code> for <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_prop_delta">prop_delta</code></td>
<td>
<p>the class of proposal distribution for <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_prior_delta_alpha">prior_delta_alpha</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_prior_delta_beta">prior_delta_beta</code></td>
<td>
<p>a vector of the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for each <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_rw_delta">rw_delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>. Only applicable if prop_delta = 'RW'.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_delta_ini">delta_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\delta</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="PoiMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\delta)\prod_{k=1}^{K}\frac{\pi_0(\lambda)L(\lambda|D_{0k})^{\delta_{k}}}{\int \pi_0(\lambda)L(\lambda|D_{0k})^{\delta_{k}} d\lambda}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\delta)</code> and <code class="reqn">\pi_0(\lambda)</code> are the initial prior distributions of <code class="reqn">\delta</code> and <code class="reqn">\lambda</code>, respectively. <code class="reqn">L(\lambda|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\delta_k</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PoiMNPP_MCMC1">PoiMNPP_MCMC1</a></code>;
<code><a href="#topic+PoiOMNPP_MCMC1">PoiOMNPP_MCMC1</a></code>;
<code><a href="#topic+PoiOMNPP_MCMC2">PoiOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PoiMNPP_MCMC2(n0=c(0,3,5),n=3,prior_lambda=c(1,1/10),prop_delta="IND",
              prior_delta_alpha=c(1,1,1), prior_delta_beta=c(1,1,1), rw_delta=0.1,
              delta_ini=NULL, nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='PoiOMNPP_MCMC1'>MCMC Sampling for Poisson Population of multiple ordered historical data using Normalized Power Prior</h2><span id='topic+PoiOMNPP_MCMC1'></span>

<h3>Description</h3>

<p>Multiple ordered historical data are incorporated together.
Conduct posterior sampling for Poisson population with normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with independence proposal is used.
For the model parameter <code class="reqn">\lambda</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoiOMNPP_MCMC1(n0,n,prior_gamma,prior_lambda, gamma_ind_prop,
               gamma_ini,nsample,burnin,thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_n0">n0</code></td>
<td>
<p>a natural number vector : number of successes in historical data.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_n">n</code></td>
<td>
<p>a natural number : number of successes in the current data.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_prior_lambda">prior_lambda</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Gamma(\alpha, \beta)</code> for <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC1_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\gamma</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\frac{\pi_0(\gamma)\pi_0(\lambda)\prod_{k=1}^{K}L(\lambda|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}}{\int \pi_0(\lambda)\prod_{k=1}^{K}L(\lambda|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}d\lambda }.</code>
</p>

<p>Here <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\lambda)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\lambda</code>, respectively. <code class="reqn">L(\lambda|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>. It is equal to the cumulative sum of <code class="reqn">\gamma</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PoiMNPP_MCMC1">PoiMNPP_MCMC1</a></code>;
<code><a href="#topic+PoiMNPP_MCMC2">PoiMNPP_MCMC2</a></code>;
<code><a href="#topic+PoiOMNPP_MCMC2">PoiOMNPP_MCMC2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PoiOMNPP_MCMC1(n0=c(0,3,5),n=3,prior_gamma=c(1/2,1/2,1/2,1/2), prior_lambda=c(1,1/10),
               gamma_ind_prop=rep(1,4),gamma_ini=NULL, nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='PoiOMNPP_MCMC2'>MCMC Sampling for Poisson Population of multiple ordered historical data using Normalized Power Prior</h2><span id='topic+PoiOMNPP_MCMC2'></span>

<h3>Description</h3>

<p>Multiple ordered historical data are combined individually.
Conduct posterior sampling for Poisson population with normalized power prior.
For the power parameter <code class="reqn">\gamma</code>, a Metropolis-Hastings algorithm with independence proposal is used.
For the model parameter <code class="reqn">\lambda</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoiOMNPP_MCMC2(n0,n,prior_gamma,prior_lambda, gamma_ind_prop,gamma_ini,
               nsample, burnin, thin)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_n0">n0</code></td>
<td>
<p>a natural number vector : number of successes in historical data.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_n">n</code></td>
<td>
<p>a natural number : number of successes in the current data.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_prior_gamma">prior_gamma</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_prior_lambda">prior_lambda</code></td>
<td>
<p>a vector of the hyperparameters in the prior distribution <code class="reqn">Gamma(\alpha, \beta)</code> for <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_gamma_ind_prop">gamma_ind_prop</code></td>
<td>
<p>a vector of the hyperparameters in the proposal distribution <code class="reqn">Dirichlet(\alpha_1, \alpha_2, ... ,\alpha_K)</code> for <code class="reqn">\gamma</code>.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_gamma_ini">gamma_ini</code></td>
<td>
<p>the initial value of <code class="reqn">\gamma</code> in MCMC sampling.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_burnin">burnin</code></td>
<td>
<p>the number of burn-ins. The output will only show MCMC samples after bunrin.</p>
</td></tr>
<tr><td><code id="PoiOMNPP_MCMC2_+3A_thin">thin</code></td>
<td>
<p>the thinning parameter in MCMC sampling.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\gamma</code>.
The normalized power prior distribution is
</p>
<p style="text-align: center;"><code class="reqn">\pi_0(\gamma)\prod_{k=1}^{K}\frac{\pi_0(\lambda)L(\lambda|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)}}{\int \pi_0(\lambda)L(\lambda|D_{0k})^{(\sum_{i=1}^{k}\gamma_i)} d\lambda}.</code>
</p>

<p>Here <code class="reqn">\pi_0(\gamma)</code> and <code class="reqn">\pi_0(\lambda)</code> are the initial prior distributions of <code class="reqn">\gamma</code> and <code class="reqn">\lambda</code>, respectively. <code class="reqn">L(\lambda|D_{0k})</code> is the likelihood function of historical data <code class="reqn">D_{0k}</code>, and <code class="reqn">\sum_{i=1}^{k}\gamma_i</code> is the corresponding power parameter.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with three elements:
</p>
<table>
<tr><td><code>acceptrate</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\gamma</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>. It is equal to the cumulative sum of <code class="reqn">\gamma</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qiang Zhang <a href="mailto:zqzjf0408@163.com">zqzjf0408@163.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PoiMNPP_MCMC1">PoiMNPP_MCMC1</a></code>;
<code><a href="#topic+PoiMNPP_MCMC2">PoiMNPP_MCMC2</a></code>;
<code><a href="#topic+PoiOMNPP_MCMC1">PoiOMNPP_MCMC1</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PoiOMNPP_MCMC2(n0=c(0,3,5),n=3,prior_gamma=c(1/2,1/2,1/2,1/2),
               prior_lambda=c(1,1/10), gamma_ind_prop=rep(1,4),
               gamma_ini=NULL, nsample = 2000, burnin = 500, thin = 2)
</code></pre>

<hr>
<h2 id='PoissonNPP_MCMC'>MCMC Sampling for Bernoulli Population using Normalized Power Prior</h2><span id='topic+PoissonNPP_MCMC'></span>

<h3>Description</h3>

<p>Conduct posterior sampling for Poisson population with normalized power prior.
For the power parameter <code class="reqn">\delta</code>, a Metropolis-Hastings algorithm with either
independence proposal, or a random walk proposal on its logit scale is used.
For the model parameter <code class="reqn">\lambda</code>, Gibbs sampling is used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PoissonNPP_MCMC(Data.Cur, Data.Hist,
                CompStat = list(n0 = NULL, mean0 = NULL, n1 = NULL, mean1 = NULL),
                prior = list(lambda.shape = 1/2, lambda.scale = 100,
                             delta.alpha = 1, delta.beta = 1),
                MCMCmethod = 'IND', rw.logit.delta = 0.1,
                ind.delta.alpha= 1, ind.delta.beta= 1, nsample = 5000,
                control.mcmc = list(delta.ini = NULL, burnin = 0, thin = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PoissonNPP_MCMC_+3A_data.cur">Data.Cur</code></td>
<td>
<p>a non-negative integer vector of each observed current data.</p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_data.hist">Data.Hist</code></td>
<td>
<p>a non-negative integer vector of each observed historical data.</p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_compstat">CompStat</code></td>
<td>
<p>a list of four elements that represents the
&quot;compatibility(sufficient) statistics&quot; for <code class="reqn">\lambda</code>.
Default is <code>NULL</code> so the fitting will be based on
the data. If the <code>CompStat</code> is provided then the inputs in
<code>Data.Cur</code> and <code>Data.Hist</code> will be ignored.
</p>
<p><code>n0</code> is the number of observations in the historical data.
</p>
<p><code>mean0</code> is the sample mean of the historical data.
</p>
<p><code>n1</code> is the number of observations in the current data.
</p>
<p><code>mean1</code> is the sample mean of the current data.
</p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_prior">prior</code></td>
<td>
<p>a list of the hyperparameters in the prior for both <code class="reqn">\lambda</code> and <code class="reqn">\delta</code>.
A Gamma distribution is used as the prior of <code class="reqn">\lambda</code>, and a Beta distribution is used as the prior of <code class="reqn">\delta</code>.
</p>
<p><code>lambda.shape</code> is the shape (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>lambda.scale</code> is the scale (hyper)parameter in the prior distribution <code class="reqn">Gamma(shape, scale)</code> for <code class="reqn">\lambda</code>.
</p>
<p><code>delta.alpha</code> is the hyperparameter <code class="reqn">\alpha</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
<p><code>delta.beta</code> is the hyperparameter <code class="reqn">\beta</code> in the prior distribution <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code>.
</p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_mcmcmethod">MCMCmethod</code></td>
<td>
<p>sampling method for <code class="reqn">\delta</code> in MCMC. It can be either 'IND' for independence proposal; or 'RW' for
random walk proposal on logit scale. </p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_rw.logit.delta">rw.logit.delta</code></td>
<td>
<p>the stepsize(variance of the normal distribution) for the random walk proposal of logit <code class="reqn">\delta</code>.
Only applicable if <code>MCMCmethod = 'RW'. </code> </p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_ind.delta.alpha">ind.delta.alpha</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\alpha</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_ind.delta.beta">ind.delta.beta</code></td>
<td>
<p>specifies the first parameter <code class="reqn">\beta</code> when
independent proposal <code class="reqn">Beta(\alpha, \beta)</code> for <code class="reqn">\delta</code> is used. Only applicable if <code>MCMCmethod = 'IND'</code></p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_nsample">nsample</code></td>
<td>
<p>specifies the number of posterior samples in the output.</p>
</td></tr>
<tr><td><code id="PoissonNPP_MCMC_+3A_control.mcmc">control.mcmc</code></td>
<td>
<p>a list of three elements used in posterior sampling.
</p>
<p><code>delta.ini</code> is the initial value of <code class="reqn">\delta</code> in MCMC sampling.
</p>
<p><code>burnin</code> is the number of burn-ins. The output will only show MCMC samples after bunrin.
</p>
<p><code>thin</code> is the thinning parameter in MCMC sampling.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The outputs include posteriors of the model parameter(s) and power parameter, acceptance rate in sampling <code class="reqn">\delta</code>, and
the deviance information criteria.
</p>


<h3>Value</h3>

<p>A list of class &quot;NPP&quot; with four elements:
</p>
<table>
<tr><td><code>lambda</code></td>
<td>
<p>posterior of the model parameter <code class="reqn">\lambda</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>posterior of the power parameter <code class="reqn">\delta</code>.</p>
</td></tr>
<tr><td><code>acceptance</code></td>
<td>
<p>the acceptance rate in MCMC sampling for <code class="reqn">\delta</code> using Metropolis-Hastings algorithm.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>the deviance information criteria for model diagnostics.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zifei Han <a href="mailto:hanzifei1@gmail.com">hanzifei1@gmail.com</a>
</p>


<h3>References</h3>

<p>Ibrahim, J.G., Chen, M.-H., Gwon, Y. and Chen, F. (2015).
The Power Prior: Theory and Applications.
<em>Statistics in Medicine  34:3724-3749.</em>
</p>
<p>Duan, Y., Ye, K. and Smith, E.P. (2006).
Evaluating Water Quality: Using Power Priors to Incorporate Historical Information.
<em>Environmetrics  17:95-106.</em>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultinomialNPP_MCMC">MultinomialNPP_MCMC</a></code>;
<code><a href="#topic+NormalNPP_MCMC">NormalNPP_MCMC</a></code>;
<code><a href="#topic+BerNPP_MCMC">BerNPP_MCMC</a></code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
DataHist &lt;- rpois(n = 100, lambda = 49)
set.seed(12345)
DataCur &lt;- rpois(n = 100, lambda = 49)

PoissonNPP_MCMC(Data.Cur = DataCur, Data.Hist = DataHist,
                CompStat = list(n0 = 20, mean0 = 10, n1 = 30, mean1 = 11),
                prior = list(lambda.shape = 1/2, lambda.scale = 100,
                             delta.alpha = 1, delta.beta = 1),
                MCMCmethod = 'RW', rw.logit.delta = 1,
                ind.delta.alpha= 1, ind.delta.beta= 1,nsample = 10000,
                control.mcmc = list(delta.ini = NULL, burnin = 2000, thin = 1))
</code></pre>

<hr>
<h2 id='SPDData'>
Dataset for Diagnostic Test (PartoSure Test, Medical Device) Evaluation for Spontaneous Preterm Delivery
</h2><span id='topic+SPDData'></span>

<h3>Description</h3>

<p>The diagnostic test was developed to aid in rapidly assess the risk of
spontaneouspreterm delivery within 7 days from the time of diagnosis in pre-pregnant
women with signs and symptoms.
The same diagnostic test was used for two populations in US and EU respectively.
The number of counts in the four cells (True positive, false positive, false negative, true negative)
was recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SPDData")</code></pre>


<h3>Format</h3>

<p>A data frame with 2 observations on the following 5 variables.
</p>

<dl>
<dt><code>Data.Region</code></dt><dd><p>region where the diagnostic test was conducted</p>
</dd>
<dt><code>TPDP</code></dt><dd><p>number of subjects with tested positive and the disease status positive (true positive)</p>
</dd>
<dt><code>TPDN</code></dt><dd><p>number of subjects with tested positive but the disease status negative (false positive)</p>
</dd>
<dt><code>TNDP</code></dt><dd><p>number of subjects with tested negative and the disease status positive (false negative)</p>
</dd>
<dt><code>TNDN</code></dt><dd><p>number of subjects with tested negative and the disease status negative (true negative)</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://www.accessdata.fda.gov/cdrh_docs/pdf16/P160052C.pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SPDData)
</code></pre>

<hr>
<h2 id='VaccineData'>
Dataset of a Vaccine Trial for RotaTeq and Multiple Historical Trials for Control Group
</h2><span id='topic+VaccineData'></span>

<h3>Description</h3>

<p>The study was designed to investigate the concomitant use of RotaTeq(Test Vaccine)
and some routine pediatric vaccines between 2001-2005.
The dataset includes four historical control trials.
The purpose of the study is to borrow the historical controls for the non-inferiority trial.
The interest is in the response rate to the routine vaccines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("VaccineData")</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 7 variables.
</p>

<dl>
<dt><code>Data.Time</code></dt><dd><p>indicator of historical data (coded as 0) or current data (coded as 1).</p>
</dd>
<dt><code>StudyID</code></dt><dd><p>character to distinguish different studies.</p>
</dd>
<dt><code>Group</code></dt><dd><p>indicator of control group (coded as 0) or treatment group (coded as 1). </p>
</dd>
<dt><code>Start.Year</code></dt><dd><p>start year of the trial </p>
</dd>
<dt><code>End.Year</code></dt><dd><p>end year of the trial</p>
</dd>
<dt><code>N</code></dt><dd><p>total number of patients enrolled and dosed in the group</p>
</dd>
<dt><code>y</code></dt><dd><p>total number of patients respond to the vaccine</p>
</dd>
</dl>



<h3>References</h3>

<p>Liu, G.F. (2018).
A Dynamic Power Prior for Borrowing Historical
Data in Noninferiority Trials with Binary Endpoint.
<em>Pharmaceutical Statistics  17:61-73.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(VaccineData)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
