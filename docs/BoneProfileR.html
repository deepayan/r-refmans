<!DOCTYPE html><html><head><title>Help for package BoneProfileR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BoneProfileR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BoneProfileR-package'><p>A Model for Bone Compactness.</p></a></li>
<li><a href='#BP'><p>Run a shiny application to fit bone section</p></a></li>
<li><a href='#BP_AutoFit'><p>Fit model automatically</p></a></li>
<li><a href='#BP_ChooseBackground'><p>Let the use to choose the background color of an image</p></a></li>
<li><a href='#BP_ChooseCenter'><p>Let the user to choose the center of the bone</p></a></li>
<li><a href='#BP_ChooseForeground'><p>Let the user to choose the foreground color of an image</p></a></li>
<li><a href='#BP_DetectBackground'><p>Detects the background color of an image</p></a></li>
<li><a href='#BP_DetectCenters'><p>Detect the centers of an image</p></a></li>
<li><a href='#BP_DetectForeground'><p>Detects the foreground color of an image</p></a></li>
<li><a href='#BP_DuplicateAnalysis'><p>Duplicates an analysis stored in an object</p></a></li>
<li><a href='#BP_EstimateCompactness'><p>Estimation of the compactness of a bone section</p></a></li>
<li><a href='#BP_FitBayesianCompactness'><p>Estimation of Bayesian model of a bone section</p></a></li>
<li><a href='#BP_FitMLCompactness'><p>Estimation of the likelihood of a bone section</p></a></li>
<li><a href='#BP_FitMLRadialCompactness'><p>Estimation of the likelihood of a bone section</p></a></li>
<li><a href='#BP_GetFittedParameters'><p>Return the fitted parameters</p></a></li>
<li><a href='#BP_ListAnalyses'><p>List the analyses stored in an object</p></a></li>
<li><a href='#BP_LnLCompactness'><p>Estimation of the likelihood of a bone section</p></a></li>
<li><a href='#BP_OpenImage'><p>Open an image</p></a></li>
<li><a href='#BP_Report'><p>Generate a pdf report for the analyzed bone</p></a></li>
<li><a href='#Erinaceus_europaeus'><p>Example of hedgehog femur</p></a></li>
<li><a href='#plot.BoneProfileR'><p>Plot a bone section</p></a></li>
<li><a href='#summary.BoneProfileR'><p>Plot a bone section</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Study Bone Compactness</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Girondot &lt;marc.girondot@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Girondot &lt;marc.girondot@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>imager, HelpersMG (&ge; 5.3-1), knitr, rmarkdown, R (&ge; 4.1),
shiny</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tiff, ijtiff, openxlsx, parallel, scatterplot3d</td>
</tr>
<tr>
<td>Description:</td>
<td>Bone Profiler is a scientific method and a software used to model 
    bone section for paleontological and ecological studies. See Girondot and Laurin 
    (2003) <a href="https://www.researchgate.net/publication/280021178_Bone_profiler_A_tool_to_quantify_model_and_statistically_compare_bone-section_compactness_profiles">https://www.researchgate.net/publication/280021178_Bone_profiler_A_tool_to_quantify_model_and_statistically_compare_bone-section_compactness_profiles</a>
    and Gônet, Laurin and Girondot (2022) <a href="https://palaeo-electronica.org/content/2022/3590-bone-section-compactness-model">https://palaeo-electronica.org/content/2022/3590-bone-section-compactness-model</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-06 20:51:09 UTC; marcgirondot</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-06 21:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BoneProfileR-package'>A Model for Bone Compactness.</h2><span id='topic+BoneProfileR-package'></span>

<h3>Description</h3>

<p>A Model for Bone Compactness.<br />
The lastest version of this package can always been installed using:<br />
install.packages(c(&quot;imager&quot;, &quot;tiff&quot;, &quot;ijtiff&quot;, &quot;HelpersMG&quot;, &quot;knitr&quot;, &quot;rmarkdown&quot;, &quot;openxlsx&quot;, &quot;shiny&quot;))<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/HelpersMG.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/BoneProfileR.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
BoneProfileR uses a new results management software that is developed as part of the HelpersMG 
package. Using this results management system (RM), all the results are stored as part of the 
analyzed image.<br />
This results management software has been developed to help users to maintain the results 
associated with the methodology used to obtain it. It is part of the large movement in 
science of replicative research.<br />
An analysis is then stored with the image in a single file with the following information:<br />
name, timestamp, bg, fg, threshold, contour, centers, peripherie, compactness, 
array.compactness, cut.distance.center, cut.angle, used.centers, compactness.synthesis, 
partial, rotation.angle, global.compactness, optim, optimRadial<br />
Several analyses can be stored within a single file.<br />
<img src="../help/figures/E.png" alt="BoneProfileR logo" />

</p>


<h3>Details</h3>

<p>A model for bone compactness.
</p>

<table>
<tr>
 <td style="text-align: left;">
 Package: </td><td style="text-align: left;"> BoneProfileR</td>
</tr>
<tr>
 <td style="text-align: left;">
 Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
 Version: </td><td style="text-align: left;"> 2.4 build 766</td>
</tr>
<tr>
 <td style="text-align: left;">
 Date: </td><td style="text-align: left;"> 2022-09-06</td>
</tr>
<tr>
 <td style="text-align: left;">
 License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
 LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Girondot M, Laurin M (2003) Bone Profiler: a tool to quantify, model, and 
statistically compare bone-section compactness profiles. Journal of 
Vertebrate Paleontology 23: 458-461
</p>
<p>Laurin M, Girondot M, Loth M-M (2004) The evolution of long bone microstructure 
and lifestyle in lissamphibians. Paleobiology 30: 589-613
</p>
<p>Gônet, Jordan, Jérémie Bardin, Marc Girondot, John R. Hutchinson, and Michel 
Laurin. 2022. The Reptilian Locomotor and Postural Diversity Seen through the Prism of 
Femoral Microanatomy: Paleobiological Implications for Some Permian and Mesozoic Reptiles. 
Submitted
</p>
<p>Gônet, Jordan, Michel Laurin, and Marc Girondot.  2022.  “Bone 
Profiler: The Next Step to Quantify, Model and Statistically Compare Bone 
Section Compactness Profiles.”  Paleontologica Electronica. 25(1): a12
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 plot(bone, type="original")
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 plot(bone, type="original")
 plot(bone, type="mineralized")
 plot(bone, type="unmineralized")
 plot(bone, type="section")
 plot(bone, type="colors")
 plot(bone, type="3Dcolors")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic", center="ontogenetic")
 plot(bone, type="original")
 plot(bone, type="mineralized")
 plot(bone, type="observations")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone, type="model", analysis=1)
 plot(bone, type="observations+model", analysis=1)
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1, K2=1), 
                fixed.parameters=NULL, analysis="flexit")
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
# pdf(file = "Figure 2.pdf", width = 8, height = 10, pointsize = 12)
layout(1:2)
plot(bone, type="observations+model", analysis="logistic", restorePar=FALSE, mar=c(4, 4, 2, 5))
plot(bone, type="observations+model", analysis="flexit", restorePar=FALSE, mar=c(4, 4, 2, 5))
layout(1)
# dev.off()
 out4p &lt;- plot(bone, type="observations+model", analysis="logistic")
 out6p &lt;- plot(bone, type="observations+model", analysis="flexit")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="logistic")
 plot(bone, type="observations+model", CI="MCMC")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="flexit")
 plot(bone, type="observations+model", CI="MCMC", analysis="flexit")
 plot(bone, type="mcmc", parameter="P", 
      options.mcmc=list(xlim=c(0.55, 0.57), breaks=seq(from=0, to=1, by=0.001)))
 plot(bone, type="mcmc", parameter="S", 
      options.mcmc=list(xlim=c(0.02, 0.05), breaks=seq(from=0.02, to=.05, by=0.001)))
 plot(bone, type="mcmc", parameter="Min", 
      options.mcmc=list(xlim=c(0.05, 0.08), breaks=seq(from=0, to=1, by=0.001)))
 plot(bone, type="mcmc", parameter="Max", 
      options.mcmc=list(xlim=c(0.95, 0.97), breaks=seq(from=0, to=1, by=0.001)))
 outMCMC &lt;- RM_get(x = bone, RM = "RM", RMname = "logistic", valuename = "mcmc")
 summary(outMCMC)
 outMCMC &lt;- RM_get(x = bone, RM = "RM", RMname = "flexit", valuename = "mcmc")
 summary(outMCMC)
 # pdf(file = "Figure 3.pdf", width = 8, height = 10, pointsize = 12)
 layout(1:2)
 plot(bone, type="mcmc", parameter="K1", analysis="flexit", 
      options.mcmc=list(xlim=c(-1, 3), ylim=c(0,10), 
      breaks=seq(from=-1, to=3, by=0.001), 
      legend = FALSE, show.prior = FALSE, mar=c(4, 4, 1, 6)), restorePar=FALSE)
 segments(x0=1, x1=1, 
         y0=0, y1=10, lty=4, lwd=3)
 text(x=ScalePreviousPlot(x=0.95, y=0.95)$x, 
      y=ScalePreviousPlot(x=0.95, y=0.95)$y, labels="A", cex=3)
 plot(bone, type="mcmc", parameter="K2", analysis="flexit", 
      options.mcmc=list(xlim=c(-1, 3), ylim=c(0,10), 
      breaks=seq(from=-1, to=3, by=0.001), 
      legend = FALSE, show.prior = FALSE, mar=c(4, 4, 1, 6)), restorePar=FALSE)
 segments(x0=1, x1=1, 
         y0=0, y1=10, lty=4, lwd=3)
 text(x=ScalePreviousPlot(x=0.95, y=0.95)$x, 
      y=ScalePreviousPlot(x=0.95, y=0.95)$y, labels="B", cex=3)
 # dev.off()
 
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis = "flexit")
 plot(bone, type="radial", radial.variable=c("P", "S"), analysis = "flexit")
 plot(bone, type="radial", radial.variable=c("P", "S", "Min", "Max"), analysis = "flexit")
 out &lt;- RM_get(x=bone, RMname="flexit", valuename = "optimRadial")$synthesis
 mean(out[, "P"]); sd(out[, "P"])
 range(out[, "S"])
 quantile(out[, "S"])
 # pdf(file = "Figure 4.pdf", width=7, height = 9, pointsize = 12)
 layout(1:2)
 plot(bone, type="radial", radial.variable="P", analysis = "flexit", restorePar=FALSE)
 text(x=ScalePreviousPlot(x=0.95, y=0.95)$x, 
      y=ScalePreviousPlot(x=0.95, y=0.95)$y, labels="A", cex=3)
 plot(bone, type="radial", radial.variable="S", analysis = "flexit", restorePar=FALSE)
 text(x=ScalePreviousPlot(x=0.95, y=0.95)$x, 
      y=ScalePreviousPlot(x=0.95, y=0.95)$y, labels="B", cex=3)
 # dev.off()

## End(Not run)
</code></pre>

<hr>
<h2 id='BP'>Run a shiny application to fit bone section</h2><span id='topic+BP'></span>

<h3>Description</h3>

<p>Run a shiny application to fit bone section
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP()
</code></pre>


<h3>Details</h3>

<p>BP runs a shiny application to fit bone section
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
BP()

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_AutoFit'>Fit model automatically</h2><span id='topic+BP_AutoFit'></span>

<h3>Description</h3>

<p>Open an image, fit a model and generate a report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_AutoFit(
  file = file.choose(),
  xlsx = TRUE,
  rotation.angle = 0,
  center = "ontogenetic"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_AutoFit_+3A_file">file</code></td>
<td>
<p>The file to be opened</p>
</td></tr>
<tr><td><code id="BP_AutoFit_+3A_xlsx">xlsx</code></td>
<td>
<p>TRUE, FALSE or the name and path of the report</p>
</td></tr>
<tr><td><code id="BP_AutoFit_+3A_rotation.angle">rotation.angle</code></td>
<td>
<p>The angle of rotation for analysis</p>
</td></tr>
<tr><td><code id="BP_AutoFit_+3A_center">center</code></td>
<td>
<p>Which center to be used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_AutoFit fits model automatically
</p>


<h3>Value</h3>

<p>Characteristics of an image with all the fit information
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_AutoFit(file=path_Hedgehog, xlsx=TRUE)
 # or to open a dialog box
 bone &lt;- BP_AutoFit()

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_ChooseBackground'>Let the use to choose the background color of an image</h2><span id='topic+BP_ChooseBackground'></span>

<h3>Description</h3>

<p>Let the user to choose the background color of an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_ChooseBackground(bone, analysis = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_ChooseBackground_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_ChooseBackground_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_ChooseBackground lets the use to choose the background color of an image
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for background color
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
 path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.tif", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_ChooseBackground(bone=bone)
 bone &lt;- BP_ChooseForeground(bone=bone)
 plot(bone)
 
## End(Not run)
</code></pre>

<hr>
<h2 id='BP_ChooseCenter'>Let the user to choose the center of the bone</h2><span id='topic+BP_ChooseCenter'></span>

<h3>Description</h3>

<p>Let the user to choose the center of the bone.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_ChooseCenter(bone, analysis = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_ChooseCenter_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_ChooseCenter_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_ChooseCenter lets the use to choose the center of the bone
</p>


<h3>Value</h3>

<p>The orignal bone object with a new attribute for center
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 bone &lt;- BP_ChooseCenter(bone=bone)
 # For partial section, only BP_ChooseCenter() must be used
 path_Dicynodon &lt;- system.file("extdata", "Dicynodon_tibia_11.11.1.T_b_b-1.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Dicynodon)
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 bone &lt;- BP_ChooseCenter(bone=bone)
 bone &lt;- BP_EstimateCompactness(bone, center="user", partial=TRUE)
 bone &lt;- BP_FitMLCompactness(bone, analysis=1)
 plot(bone, type="observations+model")

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_ChooseForeground'>Let the user to choose the foreground color of an image</h2><span id='topic+BP_ChooseForeground'></span>

<h3>Description</h3>

<p>Let the user to choose the foreground color of an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_ChooseForeground(bone, analysis = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_ChooseForeground_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_ChooseForeground_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_ChooseForeground let the user to choose the foreground color of an image
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for foreground color
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@u-psud.fr">marc.girondot@u-psud.fr</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
 bone &lt;- BP_OpenImage()
 bone &lt;- BP_ChooseBackground(bone=bone)
 bone &lt;- BP_ChooseForeground(bone=bone)
 plot(bone)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_DetectBackground'>Detects the background color of an image</h2><span id='topic+BP_DetectBackground'></span>

<h3>Description</h3>

<p>Detects the background color of an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_DetectBackground(bone, analysis = 1, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_DetectBackground_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_DetectBackground_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_DetectBackground_+3A_show.plot">show.plot</code></td>
<td>
<p>should plot is shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_DetectBackground detects the background color of an image
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for background color
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
 bone &lt;- BP_OpenImage()
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 plot(bone)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_DetectCenters'>Detect the centers of an image</h2><span id='topic+BP_DetectCenters'></span>

<h3>Description</h3>

<p>Detects the centers of an image. Note that this function must not be used with partial bone section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_DetectCenters(bone, analysis = 1, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_DetectCenters_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_DetectCenters_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_DetectCenters_+3A_show.plot">show.plot</code></td>
<td>
<p>should plot is shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_DetectCenters detects the centers of an image
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for centers
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
 bone &lt;- BP_OpenImage()
 # or 
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 bone &lt;- BP_DetectCenters(bone=bone)
 plot(bone, type="mineralized", show.grid=FALSE)
 plot(bone, type="unmineralized", show.grid=FALSE)
 plot(bone, type="section", show.grid=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_DetectForeground'>Detects the foreground color of an image</h2><span id='topic+BP_DetectForeground'></span>

<h3>Description</h3>

<p>Detects the foreground color of an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_DetectForeground(bone, analysis = 1, show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_DetectForeground_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_DetectForeground_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_DetectForeground_+3A_show.plot">show.plot</code></td>
<td>
<p>should plot is shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_DetectForeground detects the foreground color of an image
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for foreground color
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
 bone &lt;- BP_OpenImage()
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 plot(bone)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_DuplicateAnalysis'>Duplicates an analysis stored in an object</h2><span id='topic+BP_DuplicateAnalysis'></span>

<h3>Description</h3>

<p>Duplicates an analysis stored in an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_DuplicateAnalysis(bone, from = 1, to = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_DuplicateAnalysis_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_DuplicateAnalysis_+3A_from">from</code></td>
<td>
<p>The name or rank of analysis to be duplicated</p>
</td></tr>
<tr><td><code id="BP_DuplicateAnalysis_+3A_to">to</code></td>
<td>
<p>The name or rank of analysis to be created</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_DuplicateAnalysis duplicates an analysis stored in an object
</p>


<h3>Value</h3>

<p>The orignial bone object with a new analysis
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_EstimateCompactness'>Estimation of the compactness of a bone section</h2><span id='topic+BP_EstimateCompactness'></span>

<h3>Description</h3>

<p>Estimation of the compactness of a bone section.<br />
The reference for radial estimation of compactness is the trigonometric circle for rotation.angle=0 in 
BP_EstimateCompactness():<br />
- The top of the section is located at -pi/2.<br />
- The left of the section is located at -pi and +pi.<br />
- The bottom of the section is located at pi/2.<br />
- The right of the section is 0.<br />
If rotation.angle is different from 0, the value of rotation.angle is added to the angle modulo 2.pi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_EstimateCompactness(
  bone,
  center = "ontogenetic",
  partial = FALSE,
  cut.angle = 60,
  cut.distance = 100,
  rotation.angle = 0,
  analysis = 1,
  show.plot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_EstimateCompactness_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_center">center</code></td>
<td>
<p>Which center to be used: user, mineralized, unmineralized, section, ontogenetic</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_partial">partial</code></td>
<td>
<p>Is the section partial?</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_cut.angle">cut.angle</code></td>
<td>
<p>Number of angles</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_cut.distance">cut.distance</code></td>
<td>
<p>Number of distances</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_rotation.angle">rotation.angle</code></td>
<td>
<p>The angle of rotation for analysis</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_analysis">analysis</code></td>
<td>
<p>The name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_EstimateCompactness_+3A_show.plot">show.plot</code></td>
<td>
<p>should plot is shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_EstimateCompactness estimates the compactness of a bone section
</p>


<h3>Value</h3>

<p>The orignial bone object with a new attribute for compactness
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
 bone &lt;- BP_OpenImage()
 # or 
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 bone &lt;- BP_DetectCenters(bone=bone)
 bone &lt;- BP_EstimateCompactness(bone)
 plot(bone, type="original", show.grid=FALSE)
 plot(bone, type="mineralized", show.grid=FALSE)
 plot(bone, type="unmineralized", show.grid=FALSE)
 plot(bone, type="section", show.grid=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_FitBayesianCompactness'>Estimation of Bayesian model of a bone section</h2><span id='topic+BP_FitBayesianCompactness'></span>

<h3>Description</h3>

<p>Estimation of Bayesian model of a bone section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_FitBayesianCompactness(
  bone = stop("A result from BP_FitMLCompactness() must be provided"),
  priors = NULL,
  n.iter = 10000,
  n.chains = 1,
  n.adapt = 100,
  thin = 1,
  analysis = 1,
  silent = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_FitBayesianCompactness_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_priors">priors</code></td>
<td>
<p>Priors</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of chains</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iteration to adapt</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_thin">thin</code></td>
<td>
<p>Thin parameter for analysis</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_analysis">analysis</code></td>
<td>
<p>Name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_FitBayesianCompactness_+3A_silent">silent</code></td>
<td>
<p>Should some information must me shown ?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_FitBayesianCompactness estimates Bayesian model of a bone section
</p>


<h3>Value</h3>

<p>The -Ln L
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
 library(BoneProfileR)
 path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1, K2=1), 
                fixed.parameters=NULL, analysis="flexit")
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
 out4p &lt;- plot(bone, type="observations+model", analysis="logistic")
 out6p &lt;- plot(bone, type="observations+model", analysis="flexit")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="logistic")
 plot(bone, type="observations+model", CI="MCMC", analysis="logistic")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="flexit")
 plot(bone, type="observations+model", CI="MCMC", analysis="flexit")

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_FitMLCompactness'>Estimation of the likelihood of a bone section</h2><span id='topic+BP_FitMLCompactness'></span>

<h3>Description</h3>

<p>Estimation of the model of compactness of a bone section.<br />
The two-steps analysis performs first a quasi-Newton method, then a Bayesian MCMC and finally again a quasi-Newton method. 
It generally ensures that global minimum is found. On the other hand, it doubles the time to complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_FitMLCompactness(
  bone,
  fitted.parameters = c(P = 0.5, S = 0.05, Min = 0.001, Max = 0.999),
  priors = NULL,
  fixed.parameters = c(K1 = 1, K2 = 1),
  twosteps = TRUE,
  replicates.CI = 10000,
  analysis = 1,
  silent = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_FitMLCompactness_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Parameters of the model to be fitted</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_priors">priors</code></td>
<td>
<p>Priors used for intermediate estimations</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Fixed parameters of the model</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_twosteps">twosteps</code></td>
<td>
<p>Does a 2-steps analysis be performed?</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_replicates.ci">replicates.CI</code></td>
<td>
<p>Number of replicates to estimate confidence interval</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_analysis">analysis</code></td>
<td>
<p>Name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_FitMLCompactness_+3A_silent">silent</code></td>
<td>
<p>Should information be shown?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_FitMLCompactness estimates likelihood of model of a bone section
</p>


<h3>Value</h3>

<p>The -Ln L
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
 bone &lt;- BP_OpenImage()
 # or, to use the package imager to open a tiff image
 bone &lt;- BP_OpenImage(ijtiff=TRUE)
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 plot(bone, type="mineralized", show.grid=FALSE)
 plot(bone, type="unmineralized", show.grid=FALSE)
 plot(bone, type="section", show.grid=FALSE)
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic", twosteps=TRUE)
 BP_GetFittedParameters(bone)
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 BP_ListAnalyses(bone)
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1, K2=1), 
                fixed.parameters=NULL, analysis="flexit", twosteps=TRUE)
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
 out4p &lt;- plot(bone, type="observations+model", analysis="logistic")
 out6p &lt;- plot(bone, type="observations+model", analysis="flexit")

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_FitMLRadialCompactness'>Estimation of the likelihood of a bone section</h2><span id='topic+BP_FitMLRadialCompactness'></span>

<h3>Description</h3>

<p>Estimation of the compactness of a bone section using radial model.<br />
If the fitted.parameters and fixed.parameters are NULL and the analysis includes a 
BP_FitMLCompactness() result, the values of this result is used as a reference for 
fitted.parameters and fixed.parameters.<br />
If no BP_FitMLCompactness() result is available, it will use:<br />
fitted.parameters=c(P=0.5, S=0.05, Min=-2, Max=5); fixed.parameters=c(K1=1, K2=1).<br />
The reference for radial estimation of compactness is the trigonometric circle for rotation.angle=0 in 
BP_EstimateCompactness():<br />
- The top of the section is located at -pi/2.<br />
- The left of the section is located at -pi and +pi.<br />
- The bottom of the section is located at pi/2.<br />
- The right of the section is 0.<br />
If rotation.angle is different from 0, the value of rotation.angle is added to the angle modulo 2.pi.<br />
The two-steps analysis performs first a quasi-Newton method, then a Bayesian MCMC and finally again a quasi-Newton method. 
It generally ensures that global minimum is found. On the other hand, it doubles the time to complete for each angle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_FitMLRadialCompactness(
  bone,
  fitted.parameters = NULL,
  priors = NULL,
  fixed.parameters = NULL,
  analysis = 1,
  silent = FALSE,
  twosteps = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_fitted.parameters">fitted.parameters</code></td>
<td>
<p>Parameters of the model to be fitted</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_priors">priors</code></td>
<td>
<p>If twosteps is TRUE, ell what prior should be used.</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Fixed parameters of the model</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_analysis">analysis</code></td>
<td>
<p>Name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_silent">silent</code></td>
<td>
<p>Should the function displays some information?</p>
</td></tr>
<tr><td><code id="BP_FitMLRadialCompactness_+3A_twosteps">twosteps</code></td>
<td>
<p>Should a 2-steps analysis be performed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_FitMLRadialCompactness estimates likelihood of model of a bone section
</p>


<h3>Value</h3>

<p>The -Ln L
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 # or 
 bone &lt;- BP_OpenImage(ijtiff=TRUE)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic", cut.angle=30)
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1.01, K2=1.01), 
                fixed.parameters=NULL, analysis="flexit")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="flexit")
 mcmc &lt;- RM_get(bone, RMname = "flexit", value="mcmc")
 fittedpar &lt;- as.parameters(mcmc)
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=fittedpar, 
                fixed.parameters=NULL, analysis="flexit")
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
 out4p &lt;- plot(bone, type="observations+model", analysis="logistic")
 out6p &lt;- plot(bone, type="observations+model", analysis="flexit")
 # The twosteps fit is more acurate but is around 100 times slower
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis="logistic", twosteps=TRUE)
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis="logistic", twosteps=FALSE)
 plot(bone, type="observations", angle=0)
 plot(bone, type="model", analysis="logistic", angle=0)
 plot(bone, type="observations+model", angle=0)
 plot(bone, type="observations+model", angle=pi)
 plot(bone, type="radial", radial.variable=c("P", "S"), analysis="logistic")
 plot(bone, type="radial", radial.variable=c("P", "S", "Min", "Max"), analysis="logistic")
 plot(bone, type="radial", radial.variable=c("TRC"), analysis="logistic")
 # Test using the change of orientation using default.angle from BP_EstimateCompactness():
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="logistic_rotation_pi")
 # With a pi rotation, the top moves to the bottom and the left moves to the right
 bone &lt;- BP_EstimateCompactness(bone, rotation.angle=pi, analysis="logistic_rotation_pi")
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis="logistic_rotation_pi")
 plot(bone, type="radial", radial.variable=c("P", "S"), analysis="logistic")
 plot(bone, type="radial", radial.variable=c("P", "S"), analysis="logistic_rotation_pi")
 BP_Report(bone=bone, 
           analysis=1,
           docx=NULL, 
           pdf=NULL, 
           xlsx=file.path(getwd(), "report.xlsx"), 
           author="Marc Girondot", 
           title=attributes(bone)$name)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_GetFittedParameters'>Return the fitted parameters</h2><span id='topic+BP_GetFittedParameters'></span>

<h3>Description</h3>

<p>Return the fitted parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_GetFittedParameters(bone, analysis = 1, alloptim = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_GetFittedParameters_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_GetFittedParameters_+3A_analysis">analysis</code></td>
<td>
<p>Name or rank of analysis</p>
</td></tr>
<tr><td><code id="BP_GetFittedParameters_+3A_alloptim">alloptim</code></td>
<td>
<p>If TRUE, return the complete object returned by optim</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_GetFittedParameters returns the fitted parameters
</p>


<h3>Value</h3>

<p>The fitted parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 BP_GetFittedParameters(bone, analysis="logistic")

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_ListAnalyses'>List the analyses stored in an object</h2><span id='topic+BP_ListAnalyses'></span>

<h3>Description</h3>

<p>Get the analyses stored in an object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_ListAnalyses(bone, silent = TRUE, max.level = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_ListAnalyses_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_ListAnalyses_+3A_silent">silent</code></td>
<td>
<p>Should the results be shown ?</p>
</td></tr>
<tr><td><code id="BP_ListAnalyses_+3A_max.level">max.level</code></td>
<td>
<p>If TRUE, will return all list element of the objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_ListAnalyses lists the analyses stored in an object
</p>


<h3>Value</h3>

<p>The list of analyses
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 BP_ListAnalyses(bone)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_LnLCompactness'>Estimation of the likelihood of a bone section</h2><span id='topic+BP_LnLCompactness'></span>

<h3>Description</h3>

<p>Estimation of the compactness of a bone section.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_LnLCompactness(
  par,
  bone = NULL,
  data_m = NULL,
  data_nm = NULL,
  distance.center = NULL,
  fixed.parameters = NULL,
  analysis = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_LnLCompactness_+3A_par">par</code></td>
<td>
<p>Parameters of the model</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_bone">bone</code></td>
<td>
<p>The bone image to be used</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_data_m">data_m</code></td>
<td>
<p>Number of mineralized pixels</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_data_nm">data_nm</code></td>
<td>
<p>Number of non-mineralized pixels</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_distance.center">distance.center</code></td>
<td>
<p>Distances to the center</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Fixed parameters of the model</p>
</td></tr>
<tr><td><code id="BP_LnLCompactness_+3A_analysis">analysis</code></td>
<td>
<p>Name or rank of analysis</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_LnLCompactness estimates likelihood of model of a bone section
</p>


<h3>Value</h3>

<p>The -Ln L
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone)
 bone &lt;- BP_DetectForeground(bone=bone)
 bone &lt;- BP_DetectCenters(bone=bone)
 bone &lt;- BP_EstimateCompactness(bone)
 plot(bone)

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_OpenImage'>Open an image</h2><span id='topic+BP_OpenImage'></span>

<h3>Description</h3>

<p>Open an image.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_OpenImage(file = file.choose(), name = NULL, ijtiff = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_OpenImage_+3A_file">file</code></td>
<td>
<p>The file to be opened</p>
</td></tr>
<tr><td><code id="BP_OpenImage_+3A_name">name</code></td>
<td>
<p>Name of this slice</p>
</td></tr>
<tr><td><code id="BP_OpenImage_+3A_ijtiff">ijtiff</code></td>
<td>
<p>Should the ijtiff must be used to read tiff image</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_OpenImage opens an image
</p>


<h3>Value</h3>

<p>Characteristics of an image
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 plot(bone)
 path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.tif", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 plot(bone)
 bone &lt;- BP_OpenImage(file=path_Hedgehog, ijtiff=TRUE)
 plot(bone)
 # A partial section
 path_Dicynodon &lt;- system.file("extdata", "Dicynodon_tibia_11.11.1.T_b_b-1.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Dicynodon)
 plot(bone)
 # To open a file with a dialog:
 bone &lt;- BP_OpenImage()

## End(Not run)
</code></pre>

<hr>
<h2 id='BP_Report'>Generate a pdf report for the analyzed bone</h2><span id='topic+BP_Report'></span>

<h3>Description</h3>

<p>Generate a docx, xlsx, or pdf report.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BP_Report(
  bone = stop("A bone section must be provided"),
  control.plot = list(message = NULL, show.centers = TRUE, show.colors = TRUE, show.grid
    = TRUE, CI = "ML", show.legend = TRUE),
  analysis = 1,
  docx = file.path(getwd(), "report.docx"),
  pdf = file.path(getwd(), "report.pdf"),
  xlsx = file.path(getwd(), "report.xlsx"),
  author = NULL,
  title = attributes(bone)$name
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BP_Report_+3A_bone">bone</code></td>
<td>
<p>The bone image</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_control.plot">control.plot</code></td>
<td>
<p>A list with the parameters used for plot</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_analysis">analysis</code></td>
<td>
<p>Indicate analysis name or rank that you want report</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_docx">docx</code></td>
<td>
<p>Name of Word file</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_pdf">pdf</code></td>
<td>
<p>Name of pdf file</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_xlsx">xlsx</code></td>
<td>
<p>Name of Excel file</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_author">author</code></td>
<td>
<p>Name indicated in the report</p>
</td></tr>
<tr><td><code id="BP_Report_+3A_title">title</code></td>
<td>
<p>Title of the report</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BP_Report save a pdf report for the analyzed bone
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1, K2=1), 
                fixed.parameters=NULL, analysis="flexit")
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis="logistic")
 # Test using the change of orientation using default.angle from BP_EstimateCompactness():
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="logistic_rotation_pi")
 # With a pi rotation, the top moves to the bottom and the left moves to the right
 bone &lt;- BP_EstimateCompactness(bone, rotation.angle=pi, analysis="logistic_rotation_pi")
 bone &lt;- BP_FitMLRadialCompactness(bone, analysis="logistic_rotation_pi")
 BP_Report(bone=bone, 
           analysis=1,
           docx=NULL, 
           pdf=NULL, 
           xlsx=file.path(getwd(), "report.xlsx"), 
           author="Marc Girondot", 
           title=attributes(bone)$name)
           
 BP_Report(bone=bone, 
           analysis=1,
           docx=NULL, 
           pdf=file.path(getwd(), "report.pdf"), 
           xlsx=NULL, 
           author="Marc Girondot", 
           title=attributes(bone)$name)
           
 BP_Report(bone=bone, 
           analysis=1,
           docx=file.path(getwd(), "report.docx"), 
           pdf=NULL, 
           xlsx=NULL, 
           author="Marc Girondot", 
           title=attributes(bone)$name)

## End(Not run)
</code></pre>

<hr>
<h2 id='Erinaceus_europaeus'>Example of hedgehog femur</h2><span id='topic+Erinaceus_europaeus'></span>

<h3>Description</h3>

<p>Example of hedgehog femur. A drawing produced by Michel Laurin.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Erinaceus_europaeus
</code></pre>


<h3>Format</h3>

<p>A png image.
</p>


<h3>Details</h3>

<p>Example of hedgehog femur
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bone &lt;- Erinaceus_europaeus
plot(bone)
</code></pre>

<hr>
<h2 id='plot.BoneProfileR'>Plot a bone section</h2><span id='topic+plot.BoneProfileR'></span>

<h3>Description</h3>

<p>Display a bone section.<br />
type value can be:<br />
Image plot: original, mineralized, unmineralized, section<br />
Original is the original image, mineralized is the mineral interpretation of the section, 
unmineralized is the unmineralized interpretation of the section, section is the interpretation of the section.<br />
colors show the histograms of pixel information with foreground and background colors if they are defined.<br />
3Dcolors show the pixels colors in 3D<br />
Global analysis: observations, model, observations+model<br />
Radial analysis: radial<br />
If angle is not null and a radial analysis exists, it will show the model for this angle.<br />
mcmc: It will show the posterior distribution of parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BoneProfileR'
plot(
  x,
  message = NULL,
  type = "original",
  angle = NULL,
  show.centers = TRUE,
  show.colors = TRUE,
  show.grid = TRUE,
  analysis = 1,
  parameter.mcmc = "S",
  options.mcmc = list(),
  restorePar = TRUE,
  mar = NULL,
  angle.3D = 55,
  CI = "ML",
  radial.variable = "S",
  show.legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BoneProfileR_+3A_x">x</code></td>
<td>
<p>The bone image</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_message">message</code></td>
<td>
<p>The message to be displayed</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_type">type</code></td>
<td>
<p>The type of plot; see description</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_angle">angle</code></td>
<td>
<p>Which angle model to show</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_show.centers">show.centers</code></td>
<td>
<p>Should the centers be shown?</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_show.colors">show.colors</code></td>
<td>
<p>Should the background and foreground colors be shown?</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_show.grid">show.grid</code></td>
<td>
<p>Should the grid be shown?</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_analysis">analysis</code></td>
<td>
<p>Name or number of analysis to be plotted</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_parameter.mcmc">parameter.mcmc</code></td>
<td>
<p>The posterior parameter to show for type = &quot;mcmc&quot;</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_options.mcmc">options.mcmc</code></td>
<td>
<p>The option to plot type mcmc output</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_restorepar">restorePar</code></td>
<td>
<p>If TRUE, restore the par parameter at the exit</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_mar">mar</code></td>
<td>
<p>The margin for type being &quot;model&quot; or &quot;observations&quot;</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_angle.3d">angle.3D</code></td>
<td>
<p>The angle between x and y for 3Dcolors graph</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_ci">CI</code></td>
<td>
<p>Which confidence interval should be plotted: MCMC or ML</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_radial.variable">radial.variable</code></td>
<td>
<p>Name of the radial variable to plot</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_show.legend">show.legend</code></td>
<td>
<p>Should a legend be shown?</p>
</td></tr>
<tr><td><code id="plot.BoneProfileR_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.BoneProfileR displays a bone section
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+summary.BoneProfileR">summary.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
 bone &lt;- BP_OpenImage()
 # or 
 path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 plot(bone, type="colors")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 plot(bone, type="3Dcolors")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic", rotation.angle = 1)
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 # 
path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 bone &lt;- BP_DetectBackground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectForeground(bone=bone, analysis="logistic")
 bone &lt;- BP_DetectCenters(bone=bone, analysis="logistic")
 bone &lt;- BP_EstimateCompactness(bone, analysis="logistic")
 bone &lt;- BP_FitMLCompactness(bone, analysis="logistic")
 plot(bone)
 plot(bone, type="observations")
 plot(bone, type="observations+model", analysis=1)
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 fittedpar &lt;- BP_GetFittedParameters(bone, analysis="logistic")
 bone &lt;- BP_DuplicateAnalysis(bone, from="logistic", to="flexit")
 bone &lt;- BP_FitMLCompactness(bone, 
                fitted.parameters=c(fittedpar, K1=1, K2=1), 
                fixed.parameters=NULL, analysis="flexit")
 compare_AIC(Logistic=BP_GetFittedParameters(bone, analysis="logistic", alloptim=TRUE), 
             Flexit=BP_GetFittedParameters(bone, analysis="flexit", alloptim=TRUE))
 out4p &lt;- plot(bone, type="observations+model", analysis="logistic")
 out6p &lt;- plot(bone, type="observations+model", analysis="flexit")
 bone &lt;- BP_FitBayesianCompactness(bone, analysis="logistic")
 plot(bone, type="observations+model", CI="MCMC")
 bone &lt;- BP_FitMLRadialCompactness(bone)
 plot(bone, type="radial", radial.variable=c("P", "S"))
 plot(bone, type="radial", radial.variable=c("P", "S", "Min", "Max"))

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.BoneProfileR'>Plot a bone section</h2><span id='topic+summary.BoneProfileR'></span>

<h3>Description</h3>

<p>Display information of bone section
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BoneProfileR'
summary(object, max.level = FALSE, analysis = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BoneProfileR_+3A_object">object</code></td>
<td>
<p>The bone image</p>
</td></tr>
<tr><td><code id="summary.BoneProfileR_+3A_max.level">max.level</code></td>
<td>
<p>If TRUE, will return all list element of the objects</p>
</td></tr>
<tr><td><code id="summary.BoneProfileR_+3A_analysis">analysis</code></td>
<td>
<p>The analysis to report the global compacteness</p>
</td></tr>
<tr><td><code id="summary.BoneProfileR_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.BoneProfileR displays a bone section
</p>


<h3>Value</h3>

<p>An invisible list with recorded information
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other BoneProfileR: 
<code><a href="#topic+BP_AutoFit">BP_AutoFit</a>()</code>,
<code><a href="#topic+BP_ChooseBackground">BP_ChooseBackground</a>()</code>,
<code><a href="#topic+BP_ChooseCenter">BP_ChooseCenter</a>()</code>,
<code><a href="#topic+BP_ChooseForeground">BP_ChooseForeground</a>()</code>,
<code><a href="#topic+BP_DetectBackground">BP_DetectBackground</a>()</code>,
<code><a href="#topic+BP_DetectCenters">BP_DetectCenters</a>()</code>,
<code><a href="#topic+BP_DetectForeground">BP_DetectForeground</a>()</code>,
<code><a href="#topic+BP_DuplicateAnalysis">BP_DuplicateAnalysis</a>()</code>,
<code><a href="#topic+BP_EstimateCompactness">BP_EstimateCompactness</a>()</code>,
<code><a href="#topic+BP_FitBayesianCompactness">BP_FitBayesianCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLCompactness">BP_FitMLCompactness</a>()</code>,
<code><a href="#topic+BP_FitMLRadialCompactness">BP_FitMLRadialCompactness</a>()</code>,
<code><a href="#topic+BP_GetFittedParameters">BP_GetFittedParameters</a>()</code>,
<code><a href="#topic+BP_ListAnalyses">BP_ListAnalyses</a>()</code>,
<code><a href="#topic+BP_LnLCompactness">BP_LnLCompactness</a>()</code>,
<code><a href="#topic+BP_OpenImage">BP_OpenImage</a>()</code>,
<code><a href="#topic+BP_Report">BP_Report</a>()</code>,
<code><a href="#topic+Erinaceus_europaeus">Erinaceus_europaeus</a></code>,
<code><a href="#topic+plot.BoneProfileR">plot.BoneProfileR</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Not run:
library(BoneProfileR)
 bone &lt;- BP_OpenImage()
 # or 
 path_Hedgehog &lt;- system.file("extdata", "Erinaceus_europaeus_fem_2-1_small.png", 
                             package = "BoneProfileR")
 bone &lt;- BP_OpenImage(file=path_Hedgehog)
 summary(bone)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
