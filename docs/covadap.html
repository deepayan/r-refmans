<!DOCTYPE html><html lang="en"><head><title>Help for package covadap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covadap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BSD'><p>Big Stick Design</p></a></li>
<li><a href='#BSD.sim'><p>Simulations of the Big Stick Design</p></a></li>
<li><a href='#CABCD'><p>Covariate-Adjusted Biased Coin Design</p></a></li>
<li><a href='#CABCD.sim'><p>Simulations of the Covariate-Adjusted Biased Coin Design</p></a></li>
<li><a href='#covadap-internal'><p>Internal covadap Functions</p></a></li>
<li><a href='#covadap-package'><p>covadap: Implements Covariate-Adaptive Randomization procedures</p></a></li>
<li><a href='#DABCD'><p><code class="reqn">D_A</code>-optimum biased coin design</p></a></li>
<li><a href='#DABCD.sim'><p>Simulations of the <code class="reqn">D_A</code>-optimum biased coin design</p></a></li>
<li><a href='#ECADE'><p>Efficient Covariate-Adaptive Design</p></a></li>
<li><a href='#ECADE.sim'><p>Simulations of the Efficient Covariate-Adaptive Design</p></a></li>
<li><a href='#HuHu'><p>Covariate-Adaptive randomization by Hu and Hu</p></a></li>
<li><a href='#HuHu.sim'>
<p>Simulations of the Covariate-Adaptive randomization by Hu and Hu</p></a></li>
<li><a href='#KER'><p>Covariate-Adaptive randomization by Ma and Hu</p></a></li>
<li><a href='#KER.sim'><p>Simulations of the Covariate-Adaptive randomization by Ma and Hu</p></a></li>
<li><a href='#Pocock+20and+20Simon+20design'><p>Pocock and Simon's minimization method</p></a></li>
<li><a href='#Pocock+20and+20Simon+20design+20simulations'><p>Simulations of the Pocock and Simon's minimization method</p></a></li>
<li><a href='#summary_covadap'>
<p>Summary of Covariate-Adaptive Designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Implement Covariate-Adaptive Randomization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Rosamarie Frieri [aut, cre],
  Marco Novelli [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rosamarie Frieri &lt;rosamarie.frieri2@unibo.it&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementing seven Covariate-Adaptive Randomization to assign patients to two treatments. 
    Three of these procedures can also accommodate quantitative and mixed covariates. Given a set of covariates, the user can
    generate a single sequence of allocations or replicate the design multiple times by simulating the patients' covariate
    profiles. At the end, an extensive assessment of the performance of the randomization procedures is provided, calculating
    several imbalance measures. See Baldi Antognini A, Frieri R, Zagoraiou M and Novelli M (2022) &lt;<a href="https://doi.org/10.1007%2Fs00362-022-01381-1">doi:10.1007/s00362-022-01381-1</a>&gt; for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-06 16:47:46 UTC; marco</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-06 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BSD'>Big Stick Design</h2><span id='topic+BSD'></span>

<h3>Description</h3>

<p>Implements the Big Stick Design by Soares and Wu (1963) for assigning patients to two treatments A and B. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BSD(data, bound = 3, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BSD_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to the covariate profile of a patient. </p>
</td></tr>
<tr><td><code id="BSD_+3A_bound">bound</code></td>
<td>
<p>integer parameter representing the maximum tolerated imbalance. The default value is set to 3.</p>
</td></tr>
<tr><td><code id="BSD_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B with the Big Stick Design as described in Soares and Wu (1983).
</p>
<p>The argument <code>bound</code> is the maximum tolerated imbalance that the experiment can accept: complete randomization is used as long as the imbalance of the treatment allocation does not exceed <code>bound</code>. When the imbalance reaches the value set in <code>bound</code>, a deterministic assignment is made to lower the imbalance.
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B. The strata imbalances measures report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata</code>-<code>N.strata</code>. The within-covariate imbalances report, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B. See also Value.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each covariate,
</p>
<p><code>var_names</code> name of covariates and levels,
</p>
<p><code>parameter_a</code> design parameter (see above).
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end of the
study (<code>Loss</code> loss, <code>Mahal</code> Mahalanobis
distance, <code>overal.imb</code> difference in the total
number of patients assigned to A and B).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>a data frame containing for each possiblue stratum the
corresponding imbalances:
<code>N.strata</code> is the total number of
patients assigned to the stratum;
<code>A.strata</code> is the total number of patients
assigned to A  within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures:
</p>
<p><code>Imb.measures</code> (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance),
</p>
<p><code>Overall.imb</code> difference in the total number of patients
assigned to A and B,
</p>
<p><code>Within.strata</code> within-stratum imbalance for all strata,
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>a data frame with all the observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Soares F, Wu CFJ. <em>Some restricted randomization rules in sequential designs</em>. Communications in Statistics
Theory and Methods 1963, 12: 2017-2034.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+BSD.sim">BSD.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

# Create a sample dataset
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
BSD(data = df1, bound = 3, print.results = TRUE)
# To view a summary and create a list containing all the metrics of the design
res &lt;- BSD(data = df1, bound = 3, print.results = TRUE)
res
</code></pre>

<hr>
<h2 id='BSD.sim'>Simulations of the Big Stick Design</h2><span id='topic+BSD.sim'></span>

<h3>Description</h3>

<p>Implements the Big Stick Design by Soares and Wu (1963) for assigning patients to two treatments A and B  by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe
BSD.sim(data, covar = NULL, n = NULL, bound = 3, nrep = 1000,
        print.results = TRUE)
#With covariates
BSD.sim(data = NULL, covar, n, bound = 3, nrep = 1000,
        print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BSD.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to
the covariate profile of a patient. To be specified if covariate
profiles should be sampled from an existing dataset provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="BSD.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
It could be a vector with length equal to the number
of covariates and elements equal to the number of levels for each
covariate. Otherwise it is a list containing the covariates with their
levels (e.g. one covariate with two levels and one with three <code>covar
              = list(cov1 = c("lev1", "lev2"), cov2 = c("lev1", "lev2", "lev3"))</code>. </p>
</td></tr>
<tr><td><code id="BSD.sim_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>).</p>
</td></tr>
<tr><td><code id="BSD.sim_+3A_bound">bound</code></td>
<td>
<p>integer parameter representing the maximum tolerated imbalance. The default value is set to 3.</p>
</td></tr>
<tr><td><code id="BSD.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="BSD.sim_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the Big Stick Design by Soares and Wu (1983) (see <code><a href="#topic+BSD">BSD</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications. See also <code><a href="#topic+BSD">BSD</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate,
</p>
<p><code>var_names</code> name of the covariates,
</p>
<p><code>n.rep</code> number of replications,
</p>
<p><code>Maximum_tolerated_imbalance</code> for the BSD procedure.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial:
</p>
<p><code>Imb.measures</code> summary of overall imbalances  (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance, <code>overall.imb</code>
difference in the total number of patients
assigned to A and B),
</p>
<p><code>within.imb</code>  within-covariate imbalance: difference in the number of
patients assigned to A and B for each level of each
qualitative covariate,
</p>
<p><code>strata.imb</code>  the within-stratum imbalance (i.e. difference in the
total number of patients assigned to A and B within
the stratum),
<code>strata.A</code>    total number of patients assigned to A within the
stratum,
</p>
<p><code>strata.N</code>  total number of patients assigned to each stratum,
</p>
<p><code>obs.strata</code> matrix of the possible strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>) </p>
</td></tr>
</table>


<h3>References</h3>

<p>Soares F, Wu CFJ. <em>Some restricted randomization rules in sequential designs</em>. Communications in Statistics
Theory and Methods 1963, 12: 2017-2034.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+BSD">BSD</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 100 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.


### With existing dataframe
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# Simulate the design
res1 &lt;- BSD.sim(data = df1, covar = NULL, n = NULL, bound = 3, nrep = 100,
                print.results = TRUE)
### With covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- BSD.sim(data = NULL, covar = c(2,2,3), n = 100, bound = 3,  nrep = 100,
                print.results = TRUE)

</code></pre>

<hr>
<h2 id='CABCD'>Covariate-Adjusted Biased Coin Design</h2><span id='topic+CABCD'></span>

<h3>Description</h3>

<p>Implements the Covariate-adjusted Biased Coin Design by Baldi Antognini and Zagoraiou (2011), a stratified randomization procedure for two treatments A and B. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CABCD(data, a = 3, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CABCD_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to the covariate profile of a patient. </p>
</td></tr>
<tr><td><code id="CABCD_+3A_a">a</code></td>
<td>
<p>(non-negative) design parameter determining the degree of randomness: <code class="reqn">a = 0</code> gives the completely
randomized design; <code class="reqn">a \rightarrow \infty</code> gives a deterministic design. The default value is set to 3. </p>
</td></tr>
<tr><td><code id="CABCD_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B as described in Baldi Antognini and Zagoraiou (2011).
</p>
<p>The parameter <code>a</code> determines the degree of randomness of the procedure.
</p>
<p>At the end of the study, the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B. The strata imbalances measures report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata</code>-<code>N.strata</code>. The within-covariate imbalances report, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B. See also Value.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each covariate,
</p>
<p><code>var_names</code> name of covariates and levels,
</p>
<p><code>parameter_a</code> design parameter (see above).
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end of the
study (<code>Loss</code> loss, <code>Mahal</code> Mahalanobis
distance, <code>overall.imb</code> difference in the total
number of patients assigned to A and B).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>a data frame containing for each possiblue stratum the corresponding
imbalances:
<code>N.strata</code> is the total number of
patients assigned to the stratum;
<code>A.strata</code> is the total number of patients
assigned to A  within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures:
</p>
<p><code>Imb.measures</code> (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance),
</p>
<p><code>Overall.imb</code> difference in the total number of patients
assigned to A and B,
</p>
<p><code>Within.strata</code> within-stratum imbalance for all strata,
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>a data frame with all the observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Baldi Antognini A and Zagoraiou M. <em>The covariate-adaptive biased coin design for balancing clinical trials in the presence of prognostic factors</em>. Biometrika, 2011, 98(3): 519-535.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CABCD.sim">CABCD.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

# Create a sample dataset
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
CABCD(data = df1, a = 3)
# To view a summary
# and create a list containing all the metrics of the design
res &lt;- CABCD(data = df1, a = 3)
res
</code></pre>

<hr>
<h2 id='CABCD.sim'>Simulations of the Covariate-Adjusted Biased Coin Design</h2><span id='topic+CABCD.sim'></span>

<h3>Description</h3>

<p>Implements the Covariate-adjusted Biased Coin Design by Baldi Antognini and Zagoraiou (2011) by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe
CABCD.sim(data, covar = NULL, n = NULL, a = 3, nrep = 1000,
          print.results = TRUE)
#With covariates
CABCD.sim(data = NULL, covar, n, a = 3, nrep = 1000,
          print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CABCD.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to
the covariate profile of a patient. To be specified if covariate
profiles should be sampled from an existing dataset provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="CABCD.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
It could be a vector with length equal to the number
of covariates and elements equal to the number of levels for each
covariate. Otherwise it is a list containing the covariates with their
levels (e.g. one covariate with two levels and one with three <code>covar
              = list(cov1 = c("lev1", "lev2"), cov2 = c("lev1", "lev2", "lev3"))</code>. </p>
</td></tr>
<tr><td><code id="CABCD.sim_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>).</p>
</td></tr>
<tr><td><code id="CABCD.sim_+3A_a">a</code></td>
<td>
<p>(non-negative) design parameter determining the degree of randomness:
<code class="reqn">a = 0</code> gives the completely randomized design;
<code class="reqn">a \rightarrow \infty</code> gives a deterministic design.
The default value is set to 3.</p>
</td></tr>
<tr><td><code id="CABCD.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="CABCD.sim_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the Covariate-Adjusted Biased Coin Design (see <code><a href="#topic+CABCD">CABCD</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covat</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications. See also <code><a href="#topic+CABCD">CABCD</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate,
</p>
<p><code>var_names</code> name of the covariates,
</p>
<p><code>n.rep</code> number of replications,
</p>
<p><code>parameter_a</code> design parameter (see above).
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial:
</p>
<p><code>Imb.measures</code> summary of overall imbalances  (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance, <code>overall.imb</code>
difference in the total number of patients
assigned to A and B),
</p>
<p><code>within.imb</code>  within-covariate imbalance: difference in the number of
patients assigned to A and B for each level of each
qualitative covariate,
</p>
<p><code>strata.imb</code>  the within-stratum imbalance (i.e. difference in the
total number of patients assigned to A and B within
the stratum),
</p>
<p><code>strata.A</code>    total number of patients assigned to A within the
stratum,
</p>
<p><code>strata.N</code>  total number of patients assigned to each stratum,
</p>
<p><code>obs.strata</code> matrix of the possible strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Baldi Antognini A and Zagoraiou M. <em>The covariate-adaptive biased coin design for balancing clinical trials in the presence of prognostic factors</em>. Biometrika, 2011, 98(3): 519-535.
</p>


<h3>See Also</h3>

<p>See Also  <code><a href="#topic+CABCD">CABCD</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 100 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.


### With existing dataframe
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                 stringsAsFactors = TRUE)
# Simulate the design
res1 &lt;- CABCD.sim(data = df1, n = NULL, a = 3, nrep = 100)
### With covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- CABCD.sim(covar = c(2,2,3), n = 100, a = 3,  nrep = 100)
</code></pre>

<hr>
<h2 id='covadap-internal'>Internal covadap Functions</h2><span id='topic+data_preproc'></span><span id='topic+p.inverse'></span><span id='topic+Imb.m'></span><span id='topic+Imb.m.sim'></span><span id='topic+print_covadap'></span><span id='topic+print_sim'></span><span id='topic+print_mixed.covadap'></span><span id='topic+print_mixed.sim'></span>

<h3>Description</h3>

<p>Internal covadap functions.
</p>


<h3>Value</h3>

<p>No return value, called for side effects.</p>


<h3>Note</h3>

<p>These functions are not to be called by the user (or in some cases are just
waiting for proper documentation to be written).
</p>

<hr>
<h2 id='covadap-package'>covadap: Implements Covariate-Adaptive Randomization procedures</h2><span id='topic+covadap'></span>

<h3>Description</h3>

<p>Implementing seven Covariate-Adaptive Randomization to assign patients to two treatments. Three of these procedures can also accommodate quantitative and mixed covariates. Given a set of covariates, the user can generate a single sequence of allocations or replicate the design multiple times by simulating the patients' covariate profiles. At the end, an extensive assessment of the performance of the randomization procedures is provided, calculating several imbalance measures.
</p>


<h3>Acknowledgement</h3>

<p>This work was supported by the EU funding within the NextGenerationEU PRIN2022 <em>Optimal and adaptive designs for modern medical experimentation</em> (2022TRB44L).</p>


<h3>Author(s)</h3>

<p>R. Frieri <a href="mailto:rosamarie.frieri2@unibo.it">rosamarie.frieri2@unibo.it</a>, M. Novelli <a href="mailto:m.novelli@unibo.it">m.novelli@unibo.it</a></p>


<h3>References</h3>

<p>Atkinson A C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>
<p>Baldi Antognini A, Frieri R, Zagoraiou M, Novelli M. <em>The Efficient Covariate-Adaptive Design for high-order balancing of quantitative and qualitative covariates</em>. Statistical Papers, 2022.
</p>
<p>Baldi Antognini A and Zagoraiou M. <em>The covariate-adaptive biased coin design for balancing clinical trials in the presence of prognostic factors</em>. Biometrika, 2011, 98(3): 519-535.
</p>
<p>Efron B, <em>Forcing a sequential experiment to be balanced</em>. Biometrika, 1971, 58(3): 403-418.
</p>
<p>Hu Y, Hu F. <em>Asymptotic properties of covariate-adaptive randomization</em>. The Annals of Statistics, 2012, 40(3): 1974-1815.
</p>
<p>Ma Z and Hu F. <em>Balancing continuous covariates based on Kernel densities</em>. Contemporary Clinical Trials, 2013, 34(2): 262-269.
</p>
<p>Pocock S J, Simon R. <em>Sequential treatment assignment with balancing for prognostic factors in the controlled clinical trial</em>. Biometrics, 1975, 31(1): 103-115.
</p>
<p>Soares F, Wu CFJ.  <em>Some restricted randomization rules in sequential designs</em>. Communications in Statistics
Theory and Methods 1983, 12: 2017-2034.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CABCD">CABCD</a>, <a href="#topic+HuHu">HuHu</a>, <a href="#topic+PocSim">PocSim</a>, <a href="#topic+BSD">BSD</a>, <a href="#topic+DABCD">DABCD</a>, <a href="#topic+ECADE">ECADE</a>, <a href="#topic+KER">KER</a>.</code>
</p>

<hr>
<h2 id='DABCD'><code class="reqn">D_A</code>-optimum biased coin design</h2><span id='topic+DABCD'></span>

<h3>Description</h3>

<p>Implements the  <code class="reqn">D_A</code>-optimum BCD by A. Atkinson (1982) for assigning patients to two treatments A and B in order to minimize the variance of the estimated treatment difference sequentially. The procedure works with qualitative and quantitative covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DABCD(data, all.cat, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DABCD_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
</p>
</td></tr>
<tr><td><code id="DABCD_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative must be set equal to <code>TRUE</code>, otherwise
must be set equal to <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="DABCD_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B with the <code class="reqn">D_A</code>-optimum BCD as described in Atkinson (1982).
</p>
<p>This randomization procedure can be used when <code>data</code> contains only qualitative covariate, in this case set <code>all.cat = TRUE</code>, when <code>data</code> contains only quantitative covariates or when covariates of mixed nature are present, in these two latter cases set <code>all.cat = FALSE</code>.  The function's output is slighly different according to these three scenarios as described in Value.
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B.
</p>
<p>Only when <code>all.cat = TRUE</code>, the function returns the strata imbalances measures, that report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata</code>-<code>N.strata</code>.
</p>
<p>If at least one qualitative covariate is present, the function returns the within-covariate imbalances reporting, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B.
</p>
<p>If at least one quantitative covariate is present, the function returns the difference in means. For each quantitative covariate, is reported the difference in the mean in group A and B.
</p>
<p>See Value for more details.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if
<code>all.cat = TRUE</code> or only quantitative covariates are present).
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>cov_levels_names</code> levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n_quantitative_variables</code> number of quantitative
covariates.  Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end
of the study (<code>Loss</code> loss, <code>Mahal</code>
Mahalanobis distance,
<code>overall.imb</code> difference in the total number
of patients assigned to A and B).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame
containing for each possiblue stratum the
corresponding imbalances: <code>N.strata</code> is the total number of
patients assigned to the stratum; <code>A.strata</code> is the total
number of patients assigned to A within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum).
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures.
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total
number of patients assigned to A and B).
</p>
<p><code>Within.strata</code> (only if <code>all.cat = TRUE</code>)
within-stratum imbalance for all strata.
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate (is <code>NULL</code> if only quantitative
covariates are present).
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>diff_mean</code></td>
<td>
<p>(only if <code>all.cat = FALSE</code>) the difference in mean of the
quantitative covariates in group A and B.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame with all the
observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+DABCD.sim">DABCD.sim</a></code> to for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

### Implement with qualitative covariates (set all.cat = TRUE)
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
DABCD(data = df1,  all.cat = TRUE, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- DABCD(data = df1, all.cat = TRUE, print.results = TRUE)
res1


### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
DABCD(data = ff1[,5:6],  all.cat = FALSE, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res2 &lt;- DABCD(data = ff1[,5:6], all.cat = FALSE, print.results = TRUE)
res2

### With mixed covariates (set all.cat = FALSE)
# To just view a summary of the metrics of the design
DABCD(data = ff1,  all.cat = FALSE, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res3 &lt;- DABCD(data = ff1, all.cat = FALSE, print.results = TRUE)
res3
</code></pre>

<hr>
<h2 id='DABCD.sim'>Simulations of the <code class="reqn">D_A</code>-optimum biased coin design</h2><span id='topic+DABCD.sim'></span>

<h3>Description</h3>

<p>Implements the <code class="reqn">D_A</code>-optimum biased coin design BCD by A. Atkinson (1982) for assigning patients to two treatments A and B in order to minimize the variance of the estimated treatment difference sequentially  by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative and quantitative covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe provided in data
DABCD.sim(data, covar = NULL,  n = NULL, all.cat, nrep = 1000,
          print.results = TRUE)
#With covariates
DABCD.sim(data = NULL, covar, n, all.cat, nrep = 1000,
          print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DABCD.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
To be specified if covariate profiles should be sampled from an existing
dataset provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="DABCD.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
If <code>all.cat = TRUE</code> can be a vector with length equal to the
number of covariates and elements equal to the number of levels
for each covariate.
Otherwise is a list containing <code>cat</code>, the list of the qualitative
covariates with their level and <code>quant</code>, the list the quantitative
covariates that are simulated from the normal distribution with the
given mean and standard deviation (see Examples).  </p>
</td></tr>
<tr><td><code id="DABCD.sim_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>).</p>
</td></tr>
<tr><td><code id="DABCD.sim_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative
must be set equal to <code>TRUE</code>, otherwise must be set equal to <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="DABCD.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replication. </p>
</td></tr>
<tr><td><code id="DABCD.sim_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the <code class="reqn">D_A</code>-optimum BCD by Atkinson (see <code><a href="#topic+DABCD">DABCD</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications according to the nature of the covariates. See also <code><a href="#topic+DABCD">DABCD</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>n_quantitative_variables</code> number of
quantitative covariates. Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if <code>all.cat = TRUE</code>
or only quantitative covariates are present.
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n.rep</code> number of replications.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total number of patients
assigned to A and B).
</p>
<p><code>within.imb</code>  within-covariate imbalance:
difference in the number of patients assigned to A and B for
each level of each qualitative covariate
(is <code>NULL</code> if only quantitative covariates are present).
</p>
<p><code>strata.imb</code> (only if <code>all.cat = TRUE</code>) the within-stratum imbalance
(i.e. difference in the total number of patients assigned to A and B
within the stratum).
</p>
<p><code>strata.A</code> (only if <code>all.cat = TRUE</code>) is the total number of patients
assigned to A within the stratum.
</p>
<p><code>strata.N</code> (only if <code>all.cat = TRUE</code>)
is the total number of patients assigned to each stratum.
</p>
<p><code>diff_mean</code> the difference in mean in group A and B for each
quantitative covariate. Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
<p><code>obs.strata</code> (only if <code>all.cat = TRUE</code>) matrix of the possible strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+DABCD">DABCD</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

# Here we set nrep = 50 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.

### Implement with qualitative covariates (set all.cat = TRUE)
#### With an existing dataset
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
DABCD.sim(data = df1,  covar = NULL, n = NULL, all.cat = TRUE, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- DABCD.sim(data = df1, covar = NULL, n = NULL, all.cat = TRUE,
                  nrep = 50)
#### By specifying the covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- DABCD.sim(data = NULL, covar = c(2,3,3), n = 100,
                  all.cat = TRUE, nrep = 50)


### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
#### With an existing dataset
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
DABCD.sim(data = ff1[,5:6], covar = NULL, n = NULL,  all.cat = FALSE,
          nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res3 &lt;- DABCD.sim(data = ff1[,5:6],  covar = NULL, n = NULL,
                  all.cat = FALSE, nrep = 50)
#### By specifying the covariates
# e.g. 2 quantitative covariates:
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
covar = list(quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
# To just view a summary of the metrics of the design
DABCD.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
          nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res4 &lt;- DABCD.sim(data = NULL, covar = covar, n = 100,
                  all.cat = FALSE,  nrep = 50)


### With mixed covariates (set all.cat = FALSE)
#### With an existing dataset
# To just view a summary of the metrics of the design
DABCD.sim(data = ff1, covar = NULL, n = NULL,  all.cat = FALSE,
          nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res5 &lt;- DABCD.sim(data = ff1, covar = NULL, n = NULL,
                  all.cat = FALSE, nrep = 50)
#### By specifying the covariates
# e.g. one qualitative covariate and 2 quantitative covariates:
# gender with levels M and F
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
covar = list(cat = list(gender = c("M", "F")),
             quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
#To just view a summary of the metrics of the design
DABCD.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
          nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res6 &lt;- DABCD.sim(data = NULL, covar = covar, n = 100,
                  all.cat = FALSE,  nrep = 50)

</code></pre>

<hr>
<h2 id='ECADE'>Efficient Covariate-Adaptive Design</h2><span id='topic+ECADE'></span>

<h3>Description</h3>

<p>Implements the  Efficient Covariate-Adaptive DEsign by Baldi Antognini et al. (2022) for assigning patients to two treatments A and B. The procedure works with qualitative and quantitative covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECADE(data, all.cat, rho = 0.85, alloc.function = "Efron",
      print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ECADE_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
</p>
</td></tr>
<tr><td><code id="ECADE_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative
must be set equal to <code>TRUE</code>, otherwise must be set equal
to <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="ECADE_+3A_rho">rho</code></td>
<td>
<p>biasing probability, to be used only with the Efron allocation function
(<code class="reqn">1/2 \leq \rho  \leq 1</code>). The default value is 0.85.</p>
</td></tr>
<tr><td><code id="ECADE_+3A_alloc.function">alloc.function</code></td>
<td>
<p>a character specifying the allocation function used in
the randomization procedure:
<code>="Efron"</code> for Efron's, if the assignment probability to A is
<code class="reqn">e+(1-2e)[1-\Phi(x)]</code> with <code class="reqn">e=0.1</code> <code>alloc.function="norm1"</code>
while <code>alloc.function="norm2"</code>  for <code class="reqn">e=0.2</code>.  </p>
</td></tr>
<tr><td><code id="ECADE_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B with the Efficient Covariate-Adaptive Design as described in Baldi Antognini et al. (2022).
</p>
<p>This randomization procedure can be used when <code>data</code> contains only qualitative covariate, in this case set <code>all.cat = TRUE</code>, when <code>data</code> contains only quantitative covariates or when covariates of mixed nature are present, in these two latter cases set <code>all.cat = FALSE</code>.  The function's output is slighly different according to these three scenarios as described in Value.
</p>
<p>The assignment probability to A of each patient is based on the Efron's allocation function (Efron, 1971) with biasing probability equal to <code>rho</code> if <code>alloc.function = "Efron"</code>. Otherwise the allocation ptobability to A is based on the cumulative distribution function of the standard normal distribution <code class="reqn">\Phi</code> (see Arguments).
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B.
</p>
<p>Only when <code>all.cat = TRUE</code>, the function returns the strata imbalances measures, that report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata-N.strata</code>.
</p>
<p>If at least one qualitative covariate is present, the function returns the within-covariate imbalances reporting, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B.
</p>
<p>If at least one quantitative covariate is present, the function returns the difference in means. For each quantitative covariate, is reported the difference in the mean in group A and B.
</p>
<p>See Value for more details.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if
<code>all.cat = TRUE</code> or only quantitative covariates are present).
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>cov_levels_names</code> levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n_quantitative_variables</code> number of quantitative
covariates.  Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end
of the study (<code>Loss</code> loss, <code>Mahal</code>
Mahalanobis distance,
<code>overall.imb</code> difference in the total number
of patients assigned to A and B ).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame
containing for each possiblue stratum the
corresponding imbalances: <code>N.strata</code> is the total number of
patients assigned to the stratum; <code>A.strata</code> is the total
number of patients assigned to A within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum).
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures.
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total
number of patients assigned to A and B).
</p>
<p><code>Within.strata</code> (only if <code>all.cat = TRUE</code>) within-stratum                                                                               imbalance for all strata.
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate (is <code>NULL</code> if only quantitative
covariates are present).
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>diff_mean</code></td>
<td>
<p>(only if <code>all.cat = FALSE</code>) the difference in mean of the
quantitative covariates in group A and B.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame with all the
observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Baldi Antognini A, Frieri R, Zagoraiou M, Novelli M. <em>The Efficient Covariate-Adaptive Design for high-order balancing of quantitative and qualitative covariates</em>. Statistical Papers, 2022.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>
<p>Efron B, <em>Forcing a sequential experiment to be balanced</em>. Biometrika, 1971, 58(3): 403-418.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+ECADE.sim">ECADE.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Assume we choose Efron's allocation function with rho  = 0.85

### Implement with qualitative covariates (set all.cat = TRUE)
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
ECADE(data = df1,  all.cat = TRUE, alloc.function = "Efron",
      rho = 0.85, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- ECADE(data = df1,  all.cat = TRUE, alloc.function = "Efron",
              rho = 0.85, print.results = TRUE)
res1


### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
ECADE(data = ff1[,5:6],  all.cat = FALSE, alloc.function = "Efron",
      rho = 0.85, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res2 &lt;- ECADE(data = ff1[,5:6],  all.cat = FALSE, alloc.function = "Efron",
              rho = 0.85, print.results = TRUE)
res2

### With mixed covariates (set all.cat = FALSE)
# To just view a summary of the metrics of the design
ECADE(data = ff1, all.cat = FALSE, alloc.function = "Efron",
      rho = 0.85, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res3 &lt;- ECADE(data = ff1, all.cat = FALSE, alloc.function = "Efron",
              rho = 0.85, print.results = TRUE)
res3

</code></pre>

<hr>
<h2 id='ECADE.sim'>Simulations of the Efficient Covariate-Adaptive Design</h2><span id='topic+ECADE.sim'></span>

<h3>Description</h3>

<p>Implements the  Efficient Covariate-Adaptive DEsign by Baldi Antognini et al. (2022) for assigning patients to two treatments A and B by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative and quantitative covariates.</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe provided in data
ECADE.sim(data, covar = NULL, n = NULL, all.cat, nrep = 1000,
          rho = 0.85, alloc.function = "Efron", print.results = TRUE)
#With covariates
ECADE.sim(data = NULL, covar, n, all.cat, nrep = 1000, rho = 0.85,
          alloc.function = "Efron", print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ECADE.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
To be specified if covariate profiles should be sampled from an existing
dataset provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
If <code>all.cat = TRUE</code> is a vector with length equal to the number of
covariates and elements equal to the number of levels for each
covariate.
Otherwise is a list containing <code>cat</code>, the list of the qualitative
covariates with their level and <code>quant</code>, the list the quantitative
covariates that are simulated from the normal distribution with the
given mean
and standard deviation.  </p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>)</p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative
must be set equal to <code>TRUE</code>, otherwise must be set equal to <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_rho">rho</code></td>
<td>
<p>biasing probability, to be used only with the Efron allocation function
(<code class="reqn">1/2 \leq \rho  \leq 1</code>). The default value is 0.85. Is <code>NULL</code> if other allocation functions are used.</p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_alloc.function">alloc.function</code></td>
<td>
<p>a character specifying the allocation function
used in the randomization procedure:  <code>="Efron"</code> for Efron's,
if the assignment probability to A
is <code class="reqn">e+(1-2e)[1-\Phi(x)]</code> with <code class="reqn">e=0.1</code>
<code>alloc.function="norm1"</code> while <code>alloc.function="norm2"</code>
for <code class="reqn">e=0.2</code>.  </p>
</td></tr>
<tr><td><code id="ECADE.sim_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the Efficient Covariate-Adaptive Design as described in Baldi Antognini et al. (see <code><a href="#topic+ECADE">ECADE</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications according to the nature of the covariates. See also <code><a href="#topic+ECADE">ECADE</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>n_quantitative_variables</code> number of
quantitative covariates. Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if <code>all.cat = TRUE</code>
or only quantitative covariates are present.
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n.rep</code> number of replications.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total number of patients
assigned to A and B).
</p>
<p><code>within.imb</code> within-covariate
imbalance: difference in the number of patients assigned to A and B for
each level of each qualitative covariate
(is <code>NULL</code> if only quantitative covariates are present).
</p>
<p><code>strata.imb</code> (only if <code>all.cat = TRUE</code>) the within-stratum imbalance
(i.e. difference in the total number of patients assigned to A and B
within the stratum).
</p>
<p><code>strata.A</code> (only if <code>all.cat = TRUE</code>) is the total number of
patients assigned to A within the stratum.
</p>
<p><code>strata.N</code> (only if <code>all.cat = TRUE</code>) is the total number of
patients assigned to each stratum.
</p>
<p><code>diff_mean</code> (only if <code>all.cat = FALSE</code>) the difference in mean in
group A and B for each quantitative covariate.
</p>
<p><code>obs.strata</code> (only if <code>all.cat = TRUE</code>) matrix of the possible
strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Baldi Antognini A, Frieri R, Zagoraiou M, Novelli M. <em>The Efficient Covariate-Adaptive Design for high-order balancing of quantitative and qualitative covariates</em>. Statistical Papers, 2022.
</p>


<h3>See Also</h3>

<p>See Also <code><a href="#topic+ECADE">ECADE</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 50 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.


### Implement with qualitative covariates (set all.cat = TRUE)
#### With an existing dataset
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
ECADE.sim(data = df1,  covar = NULL, n = NULL, all.cat = TRUE,
          alloc.function = "Efron", rho = 0.85, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- ECADE.sim(data = df1, covar = NULL, n = NULL, all.cat = TRUE,
                  alloc.function = "Efron", rho = 0.85, nrep = 50)

#### By specifying the covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- ECADE.sim(data = NULL, covar = c(2,3,3), n = 100, all.cat = TRUE,
                  alloc.function = "Efron",  rho = 0.85, nrep = 50)



### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
#### With an existing dataset
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
ECADE.sim(data = ff1[,5:6], covar = NULL, n = NULL,  all.cat = FALSE,
          alloc.function = "Efron", rho = 0.85, nrep = 50)
# To view a summary and create a list containing all the metrics of the design
res3 &lt;- ECADE.sim(data = ff1[,5:6],  covar = NULL, n = NULL, all.cat = FALSE,
                  alloc.function = "Efron", rho = 0.85, nrep = 50)
#### By specifying the covariates
# e.g. 2 quantitative covariates:
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
covar = list(quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
# To just view a summary of the metrics of the design
ECADE.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
          alloc.function = "Efron", rho = 0.85, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res4 &lt;- ECADE.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
                  alloc.function = "Efron", rho = 0.85,  nrep = 50)



### With mixed covariates (set all.cat = FALSE)
#### With an existing dataset
# To just view a summary of the metrics of the design
ECADE.sim(data = ff1, covar = NULL, n = NULL,  all.cat = FALSE,
          alloc.function = "Efron",  rho = 0.85, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res5 &lt;- ECADE.sim(data = ff1, covar = NULL, n = NULL,  all.cat = FALSE,
                  alloc.function = "Efron", rho = 0.85, nrep = 50)
#### By specifying the covariates
# e.g. one qualitative covariate and 2 quantitative covariates:
# gender with levels M and F
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
covar = list(cat = list(gender = c("M", "F")),
             quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
# To just view a summary of the metrics of the design
ECADE.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
          alloc.function = "Efron", rho = 0.85, nrep = 50)
# To view a summary and
# create a list containing all the metrics of the design
res6 &lt;- ECADE.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
                  alloc.function = "Efron", rho = 0.85, nrep = 50)

</code></pre>

<hr>
<h2 id='HuHu'>Covariate-Adaptive randomization by Hu and Hu</h2><span id='topic+HuHu'></span>

<h3>Description</h3>

<p>Implements the Covariate-Adaptive randomization by Hu and Hu (2012) for assigning patients to two treatments A and B. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HuHu(data, p = 0.85, omega = NULL, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HuHu_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to the covariate profile of a patient. </p>
</td></tr>
<tr><td><code id="HuHu_+3A_p">p</code></td>
<td>
<p>biased coin probability for the Efron's allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>). The default value is 0.85.</p>
</td></tr>
<tr><td><code id="HuHu_+3A_omega">omega</code></td>
<td>
<p>vector of weights for the overall, within-stratum, and within-covariate-margin levels. If <code>NULL</code> (default) <code>omega = rep(1/(n_cov + 2), n_cov + 2)</code>.</p>
</td></tr>
<tr><td><code id="HuHu_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B as described in Hu and Hu (2012).
</p>
<p>The assignment probability to A of each patient is based on the Efron's allocation function (Efron, 1971) with biasing probability equal to <code>p</code>.
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B. The strata imbalances measures report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata</code>-<code>N.strata</code>. The within covariate imbalances report, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B. See also Value.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each covariate,
</p>
<p><code>var_names</code> name of covariates and levels,
</p>
<p><code>parameter_a</code> design parameter (see above).
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end of the
study (<code>Loss</code> loss, <code>Mahal</code> Mahalanobis
distance, <code>overal.imb</code> difference in the total
number of patients assigned to A and B).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>a data frame containing for each possiblue stratum the
corresponding imbalances:
<code>N.strata</code> is the total number of
patients assigned to the stratum;
<code>A.strata</code> is the total number of patients
assigned to A  within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures:
</p>
<p><code>Imb.measures</code> (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance),
</p>
<p><code>Overall.imb</code> difference in the total number of patients
assigned to A and B,
</p>
<p><code>Within.strata</code> within-stratum imbalance for all strata,
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>a data frame with all the observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hu Y, Hu F. <em>Asymptotic properties of covariate-adaptive randomization</em>. The Annals of Statistics, 2012, 40(3): 1794-1815.
</p>
<p>Efron B, <em>Forcing a sequential experiment to be balanced</em>. Biometrika, 1971, 58(3): 403-418.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HuHu.sim">HuHu.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)


# Create a sample dataset
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 200, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 200, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 200, TRUE),
                   stringsAsFactors = TRUE)
# To view a summary of the metrics of the design
HuHu(df1, p = 0.85, omega = NULL, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res &lt;- HuHu(df1, p = 0.85, omega = NULL, print.results = TRUE)
res
</code></pre>

<hr>
<h2 id='HuHu.sim'>
Simulations of the Covariate-Adaptive randomization by Hu and Hu
</h2><span id='topic+HuHu.sim'></span>

<h3>Description</h3>

<p>Implements the Covariate-Adaptive randomization by Hu and Hu (2012) for assigning patients to two treatments A and B by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe
HuHu.sim(data, covar = NULL, n = NULL, p = 0.85,
         omega = NULL, nrep = 1000, print.results = TRUE)
#With covariates
HuHu.sim(data = NULL, covar, n, p = 0.85, omega = NULL,
         nrep = 1000, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="HuHu.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to
the covariate profile of a patient. To be specified if covariate
profiles should be sampled from an existing dataset provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
It could be a vector with length equal to the number
of covariates and elements equal to the number of levels for each
covariate. Otherwise it is a list containing the covariates with their
levels (e.g. one covariate with two levels and one with three <code>covar
              = list(cov1 = c("lev1", "lev2"), cov2 = c("lev1", "lev2", "lev3"))</code>. </p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>).</p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_p">p</code></td>
<td>
<p>biased coin probability for the Efron's allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>). The default is 0.85.</p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_omega">omega</code></td>
<td>
<p>vector of weights for the overall, within-stratum, and within-covariate-margin levels. If <code>NULL</code> (default) <code>omega = rep(1/(n_cov + 2), n_cov + 2)</code>.</p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="HuHu.sim_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the Covariate-Adaptive randomization procedure proposed by Hu and Hu (see <code><a href="#topic+HuHu">HuHu</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications. See also <code><a href="#topic+HuHu">HuHu</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate,
</p>
<p><code>var_names</code> name of the covariates,
</p>
<p><code>n.rep</code> number of replications,
</p>
<p><code>Maximum_tolerated_imbalance</code> for the BSD procedure.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial:
</p>
<p><code>Imb.measures</code> summary of overall imbalances  (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance, <code>overall.imb</code>
difference in the total number of patients
assigned to A and B),
</p>
<p><code>within.imb</code>  within-covariate imbalance: difference in the number of
patients assigned to A and B for each level of each
qualitative covariate,
</p>
<p><code>strata.imb</code>  the within-stratum imbalance (i.e. difference in the
total number of patients assigned to A and B within
the stratum),
</p>
<p><code>strata.A</code>    total number of patients assigned to A within the
stratum,
</p>
<p><code>strata.N</code>  total number of patients assigned to each stratum,
</p>
<p><code>obs.strata</code> matrix of the possible strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Hu Y, Hu F. <em>Asymptotic properties of covariate-adaptive randomization</em>. The Annals of Statistics, 2012, 40(3): 1794-1815.
</p>


<h3>See Also</h3>

<p>See Also  <code><a href="#topic+HuHu">HuHu</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 100 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.


### With existing dataframe
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# Simulate the design
res2 &lt;- HuHu.sim(data = df1, covar = NULL, n = NULL, p = 0.85,  omega = NULL,
                 nrep = 100)
### With covariate
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- HuHu.sim(data = NULL, covar = c(2,2,3), n = 100, p = 0.85,  omega = NULL,
                 nrep = 100)

</code></pre>

<hr>
<h2 id='KER'>Covariate-Adaptive randomization by Ma and Hu</h2><span id='topic+KER'></span>

<h3>Description</h3>

<p>Implements the Covariate-Adaptive randomization by Ma and Hu (2013) for assigning patients to two treatments A and B in order to minimize the distance
between the covariate distribution in the two treatment groups. The procedure works with qualitative and quantitative covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>KER(data, all.cat, p = 0.8, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KER_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
</p>
</td></tr>
<tr><td><code id="KER_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative must be set equal to                 <code>TRUE</code>, otherwise must be set equal to <code>FALSE</code>.  </p>
</td></tr>
<tr><td><code id="KER_+3A_p">p</code></td>
<td>
<p>biasing probability for the Efron's allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>). The default value is 0.8. </p>
</td></tr>
<tr><td><code id="KER_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B with the Covariate-Adaptive randomization based on kernel density estimation as described in Ma and Hu (2013).
</p>
<p>This randomization procedure can be used when <code>data</code> contains only qualitative covariate, in this case set <code>all.cat = TRUE</code>, when <code>data</code> contains only quantitative covariates or when covariates of mixed nature are present, in these two latter cases set <code>all.cat = FALSE</code>.  The function's output is slighly different according to these three scenarios as described in Value.
</p>
<p>The assignment probability to A of each patient is based on the Efron's allocation function (Efron, 1971) with biasing probability equal to <code>p</code>.
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B.
</p>
<p>Only when <code>all.cat = TRUE</code>, the function returns the strata imbalances measures, that report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata-N.strata</code>.
</p>
<p>If at least one qualitative covariate is present, the function returns the within-covariate imbalances reporting, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B.
</p>
<p>If at least one quantitative covariate is present, the function returns the difference in means. For each quantitative covariate, is reported the difference in the mean in group A and B.
</p>
<p>See Value for more details.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if
<code>all.cat = TRUE</code> or only quantitative covariates are present).
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>cov_levels_names</code> levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n_quantitative_variables</code> number of quantitative
covariates.  Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end
of the study (<code>Loss</code> loss, <code>Mahal</code>
Mahalanobis distance,
<code>overall.imb</code> difference in the total number
of patients assigned to A and B ).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame
containing for each possiblue stratum the
corresponding imbalances: <code>N.strata</code> is the total number of
patients assigned to the stratum; <code>A.strata</code> is the total
number of patients assigned to A within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum).
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures.
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total
number of patients assigned to A and B).
</p>
<p><code>Within.strata</code> (only if <code>all.cat = TRUE</code>) within-stratum
imbalance for all strata.
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate (is <code>NULL</code> if only quantitative
covariates are present).
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>diff_mean</code></td>
<td>
<p>(only if <code>all.cat = FALSE</code>) the difference in mean of the
quantitative covariates in group A and B.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>(only if <code>all.cat = TRUE</code>) a data frame with all the
observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Ma Z and Hu F. <em>Balancing continuous covariates based on Kernel densities</em>. Contemporary Clinical Trials, 2013, 34(2): 262-269.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>
<p>Efron B, <em>Forcing a sequential experiment to be balanced</em>. Biometrika, 1971, 58(3): 403-418.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+KER.sim">KER.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

### Implement with qualitative covariates (set all.cat = TRUE)
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
KER(data = df1,  all.cat = TRUE, p = 0.8, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- KER(data = df1,  all.cat = TRUE, p = 0.8, print.results = TRUE)
res1


### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
KER(data = ff1[,5:6],  all.cat = FALSE, p = 0.8, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res2 &lt;- KER(data = ff1[,5:6], p = 0.8, all.cat = FALSE, print.results = TRUE)
res2

### With mixed covariates
# In this case the user must set all.cat = FALSE
# To just view a summary of the metrics of the design
KER(data = ff1, all.cat = FALSE, p = 0.8, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res3 &lt;- KER(data = ff1, all.cat = FALSE, p = 0.8, print.results = TRUE)
res3

</code></pre>

<hr>
<h2 id='KER.sim'>Simulations of the Covariate-Adaptive randomization by Ma and Hu</h2><span id='topic+KER.sim'></span>

<h3>Description</h3>

<p>Implements the Covariate-Adaptive randomization by Ma and Hu (2013) for assigning patients to two treatments A and B in order to minimize the distance
between the covariate distribution in the two treatment groups by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative and quantitative covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe
KER.sim(data, covar = NULL, n = NULL, all.cat, nrep = 1000,
        p = 0.8, print.results = TRUE)
#With covariates
KER.sim(data = NULL, covar, n, all.cat, nrep = 1000,
        p = 0.8, print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="KER.sim_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. It can be a matrix only when <code>all.cat =
                TRUE</code>. Each row of <code>data</code> corresponds to the covariate profile of a
patient.
To be specified if covariate profiles should be sampled from an existing
dataset provided in <code>data</code>.</p>
</td></tr>
<tr><td><code id="KER.sim_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
If <code>all.cat = TRUE</code> is a vector with length equal to the number of
covariates and elements equal to the number of levels for
each covariate.
Otherwise is a list containing <code>cat</code>, the list of the qualitative
covariates with their level and <code>quant</code>, the list the quantitative
covariates that are simulated from the normal distribution with
the given mean
and standard deviation.  </p>
</td></tr>
<tr><td><code id="KER.sim_+3A_n">n</code></td>
<td>
<p>number of patients.</p>
</td></tr>
<tr><td><code id="KER.sim_+3A_all.cat">all.cat</code></td>
<td>
<p>logical. If all the covariates in <code>data</code> are qualitative
must be set equal to <code>TRUE</code>, otherwise must be set
equal to <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="KER.sim_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="KER.sim_+3A_p">p</code></td>
<td>
<p>biasing probability for the Efron allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>). The default value is 0.8.</p>
</td></tr>
<tr><td><code id="KER.sim_+3A_print.results">print.results</code></td>
<td>
<p>logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the Efficient Covariate-Adaptive Design as described in Ma and Hu (see <code><a href="#topic+KER">KER</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications according to the nature of the covariates. See also <code><a href="#topic+KER">KER</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design.
</p>
<p><code>Sample_size</code> number of patients.
</p>
<p><code>n_cov</code> number of covariates.
</p>
<p><code>var_names</code> name of the covariates.
</p>
<p><code>n_quantitative_variables</code> number of
quantitative covariates. Is <code>NULL</code> if <code>all.cat = TRUE</code>.
</p>
<p><code>n_categorical_variables</code>  number of levels of each
covariate. Is <code>NULL</code> if <code>all.cat = TRUE</code>
or only quantitative covariates are present.
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate.
Is <code>NULL</code> if only quantitative covariates are present.
</p>
<p><code>n.rep</code> number of replications.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial
</p>
<p><code>Imb.measures</code> summary of overall imbalances
(<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance,
<code>overall.imb</code> difference in the total number of patients
assigned to A and B).
</p>
<p><code>within.imb</code>  within-covariate imbalance:
difference in the number of patients assigned to A and B for
each level of each qualitative covariate
(is <code>NULL</code> if only quantitative covariates are present).
</p>
<p><code>strata.imb</code> (only if <code>all.cat = TRUE</code>) the within-stratum
imbalance (i.e. difference in the total number of patients assigned
to A and B within the stratum).
</p>
<p><code>strata.A</code> (only if <code>all.cat = TRUE</code>) is the total number of
patients assigned to A within the stratum.
</p>
<p><code>strata.N</code> (only if <code>all.cat = TRUE</code>) is the total number
of patients assigned to each stratum.
</p>
<p><code>diff_mean</code> (only if <code>all.cat = FALSE</code>) the difference in mean
in group A and B for each quantitative covariate.
</p>
<p><code>obs.strata</code> (only if <code>all.cat = TRUE</code>) matrix of the possible
strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Ma Z and Hu F. <em>Balancing continuous covariates based on Kernel densities</em>. Contemporary Clinical Trials, 2013, 34(2): 262-269.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+KER">KER</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 50 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.


### Implement with qualitative covariates (set all.cat = TRUE)
#### With an existing dataset
# Create a sample dataset with qualitative covariates
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
KER.sim(data = df1,  covar = NULL, n = NULL, all.cat = TRUE,
        p = 0.8, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res1 &lt;- KER.sim(data = df1, covar = NULL, n = NULL, all.cat = TRUE,
                p = 0.8, nrep = 50)
#### By specifying the covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- KER.sim(data = NULL, covar = c(2,3,3), n = 100, all.cat = TRUE,
                p = 0.8, nrep = 50)



### Implement with quantitative or mixed covariates
# Create a sample dataset with covariates of mixed nature
ff1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("0-30", "30-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hypertension"), 10,
                  TRUE),
                 "smoke" = sample(c("yes", "no"), 100, TRUE, c(2 / 3, 1 / 3)),
                 "cholesterol" = round(rnorm(100, 200, 8),1),
                 "height" = rpois(100,160),
                  stringsAsFactors = TRUE)

### With quantitative covariates only (set all.cat = FALSE)
#### With an existing dataset
# select only column 5 and 6 of the sample dataset
# To just view a summary of the metrics of the design
KER.sim(data = ff1[,5:6], covar = NULL, n = NULL,  all.cat = FALSE, p = 0.8,
        nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res3 &lt;- KER.sim(data = ff1[,5:6],  covar = NULL, n = NULL, all.cat = FALSE,
                p = 0.8, nrep = 50)

#### By specifying the covariates
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
covar = list(quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
# To just view a summary of the metrics of the design
KER.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
        p = 0.8, nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res4 &lt;- KER.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
                  p = 0.8,  nrep = 50)

### With mixed covariates (set all.cat = FALSE)
#### With an existing dataset
# To just view a summary of the metrics of the design
KER.sim(data = ff1, covar = NULL, n = NULL, all.cat = FALSE, p = 0.8,
        nrep = 50)
# To view a summary
# and create a list containing all the metrics of the design
res5 &lt;- KER.sim(data = ff1, covar = NULL, n = NULL, all.cat = FALSE,
                 p = 0.8, nrep = 50)
#### By specifying the covariates
# e.g. one qualitative covariate and 2 quantitative covariates:
# BMI normally distributed with mean 26 and standard deviation 5
# cholesterol normally distributed with mean 200 and standard deviation 34
# gender with levels M and F
covar = list(cat = list(gender = c("M", "F")),
             quant = list(BMI = c(26, 5), cholesterol = c(200, 34)))
# To just view a summary of the metrics of the design
KER.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
        p = 0.8, nrep = 50)
# To view a summary and create a list containing all the metrics of the design
res6 &lt;- KER.sim(data = NULL, covar = covar, n = 100, all.cat = FALSE,
                  p = 0.8, nrep = 50)

</code></pre>

<hr>
<h2 id='Pocock+20and+20Simon+20design'>Pocock and Simon's minimization method</h2><span id='topic+PocSim'></span>

<h3>Description</h3>

<p>Implements the Pocock and Simon's minimization method by Pocock and Simon (1975) for assigning patients to two treatments A and B. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PocSim(data, p = 0.85, print.results = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to the covariate profile of a patient. </p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design_+3A_p">p</code></td>
<td>
<p>biased coin probability for the Efron's allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>).
The default value is 0.85.</p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function assigns patients to treatments A or B as described in Pocock and Simon (1975).
</p>
<p>The assignment probability to A of each patient is based on the Efron's allocation function (Efron, 1971) with biasing probability equal to <code>p</code>.
</p>
<p>At the end of the study the imbalance measures reported are the loss of estimation precision as described in Atkinson (1982), the Mahalanobis distance and the overall imbalance, defined as the difference in the total number of patients assigned to treatment A and B. The strata imbalances measures report, for each stratum, the total number of patients assigned (<code>N.strata</code>), the number of patients assigned to A (<code>A.strata</code>) and the within-stratum imbalance (<code>D.strata</code>), calculated as <code>2*A.strata</code>-<code>N.strata</code>. The within-covariate imbalances report, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B. See also Value.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each covariate,
</p>
<p><code>var_names</code> name of covariates and levels,
</p>
<p><code>parameter_a</code> design parameter (see above).
</p>
</td></tr>
<tr><td><code>Assignments</code></td>
<td>
<p>a vector with the treatment assignments.</p>
</td></tr>
<tr><td><code>Imbalances.summary</code></td>
<td>
<p>summary of overall imbalance measures at the end of the
study (<code>Loss</code> loss, <code>Mahal</code> Mahalanobis
distance, <code>overal.imb</code> difference in the total
number of patients assigned to A and B).</p>
</td></tr>
<tr><td><code>Strata.measures</code></td>
<td>
<p>a data frame containing for each possiblue stratum the
corresponding imbalances:
<code>N.strata</code> is the total number of
patients assigned to the stratum;
<code>A.strata</code> is the total number of patients
assigned to A  within the stratum;
<code>D.strata</code> is the within-stratum imbalance,
i.e. difference in the total number of patients
assigned to A and B within the stratum.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list containing all the imbalance measures:
</p>
<p><code>Imb.measures</code> (<code>Loss</code> loss,
<code>Mahal</code> Mahalanobis distance),
</p>
<p><code>Overall.imb</code> difference in the total number of patients
assigned to A and B,
</p>
<p><code>Within.strata</code> within-stratum imbalance for all strata,
</p>
<p><code>Within.cov</code> within-covariate imbalance: difference in the
number of patients assigned to A and B for each level of each
qualitative covariate.
</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>the data provided in input.</p>
</td></tr>
<tr><td><code>observed.strata</code></td>
<td>
<p>a data frame with all the observed strata.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Pocock S J, Simon R. <em>Sequential treatment assignment with balancing for prognostic factors in the controlled clinical trial</em>. Biometrics, 1975, 31(1): 103-115.
</p>
<p>Efron B, <em>Forcing a sequential experiment to be balanced</em>. Biometrika, 1971, 58(3): 403-418.
</p>
<p>Atkinson A. C. <em>Optimum biased coin designs for sequential clinical trials with prognostic factors</em>. Biometrika, 1982, 69(1): 61-67.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+PocSim.sim">PocSim.sim</a></code> for allocating patients by simulating their covariate profiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)

# Create a sample dataset
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# To just view a summary of the metrics of the design
PocSim(df1, p = 0.85, print.results = TRUE)
# To view a summary
# and create a list containing all the metrics of the design
res &lt;- PocSim(df1, p = 0.85, print.results = TRUE)
res
</code></pre>

<hr>
<h2 id='Pocock+20and+20Simon+20design+20simulations'>Simulations of the Pocock and Simon's minimization method</h2><span id='topic+PocSim.sim'></span>

<h3>Description</h3>

<p>Implements the Pocock and Simon's minimization method by Pocock and Simon (1975) for assigning patients to two treatments A and B by simulating the covariate profile of each patient using an existing dataset or specifying number and levels of the covariates. The procedure works with qualitative covariates only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>#With existing dataframe
PocSim.sim(data, covar = NULL, n = NULL, p = 0.85, nrep = 1000,
           print.results = TRUE)
#With covariates
PocSim.sim(data = NULL, covar, n, p = 0.85, nrep = 1000,
           print.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_data">data</code></td>
<td>
<p>a data frame or a matrix. Each row of <code>data</code> corresponds to
the covariate profile of a patient. To be specified if covariate
profiles should be sampled from an existing dataset provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_covar">covar</code></td>
<td>
<p>either a vector or a list to be specified only if <code>data = NULL</code>.
It could be a vector with length equal to the number
of covariates and elements equal to the number of levels for each
covariate. Otherwise it is a list containing the covariates with their
levels (e.g. one covariate with two levels and one with three <code>covar
              = list(cov1 = c("lev1", "lev2"), cov2 = c("lev1", "lev2", "lev3"))</code> </p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_n">n</code></td>
<td>
<p>number of patients (to be specified only if <code>data = NULL</code>).</p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_p">p</code></td>
<td>
<p>biased coin probability for the Efron's allocation function (<code class="reqn">1/2 \leq p  \leq 1</code>). The default value is 0.85.</p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_nrep">nrep</code></td>
<td>
<p>number of trial replications.</p>
</td></tr>
<tr><td><code id="Pocock+2B20and+2B20Simon+2B20design+2B20simulations_+3A_print.results">print.results</code></td>
<td>
<p> logical. If TRUE a summary of the results is printed. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates <code>nrep</code> times a clinical study assigning patients to treatments A and B with the minimization method by Pocock and Simon (see <code><a href="#topic+PocSim">PocSim</a></code>).
</p>
<p>When <code>covar</code> is provided, the function finds all the possible combination of the levels of the covariates, i.e., the strata and, at each trial replication, the patients' covariate profiles are uniformly sampled within those strata. The specification of <code>covar</code> requires the specification of the number of patients <code>n</code>.
</p>
<p>When <code>data</code> is provided, at each trial replication, the patients' covariate profiles are sampled from the observed strata with uniform distribution. In this case the number of patients equals the number of rows of <code>data</code>.
</p>
<p>The summary printed when <code>print.results = TRUE</code> reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications. See also <code><a href="#topic+PocSim">PocSim</a></code>.
</p>


<h3>Value</h3>

<p>It returns an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, which is a list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>summary.info</code></td>
<td>

<p><code>Design</code> name of the design,
</p>
<p><code>Sample_size</code> number of patients,
</p>
<p><code>n_cov</code> number of covariates,
</p>
<p><code>n_levels</code> number of levels of each qualitative covariate,
</p>
<p><code>var_names</code> name of the covariates,
</p>
<p><code>n.rep</code> number of trial replications,
</p>
<p><code>Maximum_tolerated_imbalance</code> for the BSD procedure.
</p>
</td></tr>
<tr><td><code>Imbalances</code></td>
<td>
<p>a list with the imbalance measures at the end of each simulated trial:
</p>
<p><code>Imb.measures</code> summary of overall imbalances  (<code>Loss</code> loss,
<code> Mahal</code> Mahalanobis distance, <code>overall.imb</code>
difference in the total number of patients
assigned to A and B),
</p>
<p><code>within.imb</code>  within-covariate imbalance: difference in the number of
patients assigned to A and B for each level of each
qualitative covariate,
</p>
<p><code>strata.imb</code>  the within-stratum imbalance (i.e. difference in the
total number of patients assigned to A and B within
the stratum),
</p>
<p><code>strata.A</code>    total number of patients assigned to A within the
stratum,
</p>
<p><code>strata.N</code>  total number of patients assigned to each stratum,
</p>
<p><code>obs.strata</code> matrix of the possible strata.
</p>
</td></tr>
<tr><td><code>out</code></td>
<td>
<p>For each replication returns a list of the data provided in input (<code>data</code>) and the resulting assignments (<code>Assignment</code>). </p>
</td></tr>
</table>


<h3>References</h3>

<p>Pocock S J, Simon R. <em>Sequential treatment assignment with balancing for prognostic factors in the controlled clinical trial</em>. Biometrics, 1975, 31(1): 103-115.
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="#topic+PocSim">PocSim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(covadap)
# Here we set nrep = 100 for illustrative purposes,
# Set it equal to at least 5000 for more reliable Monte Carlo estimates.

### With existing dataframe
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                  "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                  "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                   stringsAsFactors = TRUE)
# Simulate the design
res1 &lt;- PocSim.sim(data = df1, covar = NULL, n = NULL, p = 0.85, nrep = 100)
### With covariates
# e.g. two binary covariates and one with three levels and 100 patients
res2 &lt;- PocSim.sim(data = NULL, covar = c(2,2,3), n = 100,
                   p = 0.85, nrep = 100)
</code></pre>

<hr>
<h2 id='summary_covadap'>
Summary of Covariate-Adaptive Designs
</h2><span id='topic+summary_covadap'></span>

<h3>Description</h3>

<p>This function automatically recognizes the design implemented and provides a summary of the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_covadap(res)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_covadap_+3A_res">res</code></td>
<td>

<p>An object of class <code>"covadap"</code> or <code>"covadapsim"</code>  resulting from the application of a covariate-adaptive design.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When applied to an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadap"</code>:
if at least one qualitative covariate is present, the function returns the within-covariate imbalances reporting, for each level of each qualitative covariate, the difference in the number of patients assigned to A and B.
If instead at least one quantitative covariate is present, the function returns the difference in means. For each quantitative covariate, the difference in the mean in group A and B is reported.
</p>
<p>When applied to an object of <code><a href="base.html#topic+class">class</a></code> <code>"covadapsim"</code>, it reports the averages, in absolute value, of the imbalance measures, strata imbalances and within-covariate imbalances of the <code>nrep</code> trial replications according to the nature of the covariates.
</p>


<h3>Value</h3>

<p>The form of the value returned by <code>summary_covadap</code> depends on the class of the argument provided (see Details). </p>


<h3>Examples</h3>

<pre><code class='language-R'>#Create a sample dataset
df1 &lt;- data.frame("gender" = sample(c("female", "male"), 100, TRUE, c(1 / 3, 2 / 3)),
                 "age" = sample(c("18-35", "36-50", "&gt;50"), 100, TRUE),
                 "bloodpressure" = sample(c("normal", "high", "hyper"), 100, TRUE),
                 stringsAsFactors = TRUE)

res1 &lt;- ECADE(data = df1, all.cat = TRUE,
                  alloc.function = "Efron", rho = 0.85)
summary_covadap(res1)


res2 &lt;- ECADE.sim(data = df1, cov = NULL, n = NULL, all.cat = TRUE,
                  alloc.function = "Efron", rho = 0.85, nrep = 100)
summary_covadap(res2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
