<!DOCTYPE html><html><head><title>Help for package orthogonalsplinebasis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {orthogonalsplinebasis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#orthogonalsplinebasis-package'><p>A Matrix Representation for Spline Basis Functions</p></a></li>
<li><a href='#evaluate-methods'><p>Generic evaluate method</p></a></li>
<li><a href='#expand.knots'><p>Expands knots for appropriate number of knots in B-splines</p></a></li>
<li><a href='#fitLS'><p>Fitting splines with penalized least squares.</p></a></li>
<li><a href='#GramMatrix'><p>Computing the Gram Matrix for a set of Spline Basis</p></a></li>
<li><a href='#Hankel'><p> Generating a Hankel Matrix</p></a></li>
<li><a href='#integrate-methods'><p> Methods for Function integrate</p></a></li>
<li><a href='#MatrixPower'><p>Matrix Power</p></a></li>
<li><a href='#orthogonalize-methods'><p> Methods for Function orthogonalize</p></a></li>
<li><a href='#OrthogonalizeBasis'><p> Orthogonalize a Spline Basis</p></a></li>
<li><a href='#OuterProdSecondDerivative'><p>Outer Product of Second Derivatives of Spline Bases</p></a></li>
<li><a href='#SplineBasis'><p>Creating <code>SplineBasis</code> Objects.</p></a></li>
<li><a href='#SplineBasis-class'><p>Classes <code>SplineBasis</code> and <code>OrthogonalSplineBasis</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Orthogonal B-Spline Basis Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-10</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Redd</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, stats, graphics</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Redd &lt;andrew.redd@hsc.utah.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Represents the basis functions for B-splines in a simple matrix
    formulation that facilitates, taking integrals, derivatives, and
    making orthogonal the basis functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/halpo/obsplines">https://github.com/halpo/obsplines</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-23 17:56:17 UTC; u0092104</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-23 19:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='orthogonalsplinebasis-package'>A Matrix Representation for Spline Basis Functions</h2><span id='topic+orthogonalsplinebasis-package'></span><span id='topic+orthogonalsplinebasis'></span>

<h3>Description</h3>

<p>This package provides functions for manipulation of spline basis functions.
A matrix representation for the basis functions is at the center of the functions.
The matrix representation simplifies the process of orthogonalization as well as differentiation and integration.
</p>


<h3>Author(s)</h3>

<p>Andrew Redd
Maintainer: Andrew Redd <a href="mailto:andrew.redd@hsc.utah.edu">andrew.redd@hsc.utah.edu</a>
</p>

<hr>
<h2 id='evaluate-methods'>Generic evaluate method</h2><span id='topic+evaluate-methods'></span><span id='topic+evaluate'></span>

<h3>Description</h3>

<p>Methods for function <code>evaluate</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>object = &quot;SplineBasis&quot;, x = &quot;numeric&quot;</dt><dd><p> Evaluates a <code>SplineBasis</code> object for the spline basis curves at points <code>x</code>. See <a href="#topic+SplineBasis-class">SplineBasis</a></p>
</dd>
</dl>

<hr>
<h2 id='expand.knots'>Expands knots for appropriate number of knots in B-splines</h2><span id='topic+expand.knots'></span>

<h3>Description</h3>

<p>This function is for convenience of specifying knots for B-splines.
Since the user usually only want to specify the interval that they are interested in the end knots are usually duplicated.
This function interprets the first and last knots as the end points and duplicates them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand.knots(interior, order = 4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand.knots_+3A_interior">interior</code></td>
<td>
<p>The knots including all interior and endpoint knots</p>
</td></tr>
<tr><td><code id="expand.knots_+3A_order">order</code></td>
<td>
<p>the order of the splines that the knots are to be used with.  Defaults to 4, being cubic splines </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of knots with the order specified as an attribute </p>


<h3>Author(s)</h3>

<p>Andrew Redd </p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineBasis">SplineBasis</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(knots&lt;-expand.knots(1:10))
plot(OBasis(knots))
</code></pre>

<hr>
<h2 id='fitLS'>Fitting splines with penalized least squares.</h2><span id='topic+fitLS'></span>

<h3>Description</h3>

<p>Estimates the control vector for a spline fit by penalized least squares.
The penalty being the penalty parameter times the functional inner product of the second derivative of the spline curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitLS(object, x, y, penalty = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitLS_+3A_object">object</code></td>
<td>
<p> The <code>SplineBasis</code> object to be used to make the fit </p>
</td></tr>
<tr><td><code id="fitLS_+3A_x">x</code></td>
<td>
<p> predictor variable. </p>
</td></tr>
<tr><td><code id="fitLS_+3A_y">y</code></td>
<td>
<p> response variable. </p>
</td></tr>
<tr><td><code id="fitLS_+3A_penalty">penalty</code></td>
<td>
<p> The penalty multiplier. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For numeric vector y, and x, and a set of basis functions, represented in <code>object</code>, defined on the knots <code class="reqn">(k_0,\ldots,k_m)</code>.
The likelihood is defined by</p>
<p style="text-align: center;"><code class="reqn">
	\sum\limits_{i=1}^n(y_i-b(x_i)\mu) + \int\limits_{k_0}^{k_m} \mu^Tb^{\prime\prime}(t)^Tb^{\prime\prime}(t)\mu dt
	</code>
</p>

<p>The function estimates <code class="reqn">\mu</code>.
</p>


<h3>Value</h3>

<p>a vector of the control points.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SplineBasis-class">SplineBasis</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>knots&lt;-c(0,0,0,0:5,5,5,5)
base&lt;-SplineBasis(knots)
x&lt;-seq(0,5,by=.5)
y&lt;-exp(x)+rnorm(length(x),sd=5)
fitLS(base,x,y)
</code></pre>

<hr>
<h2 id='GramMatrix'>Computing the Gram Matrix for a set of Spline Basis</h2><span id='topic+GramMatrix'></span>

<h3>Description</h3>

<p>Function for computing the Gram matrix of a spline basis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>		GramMatrix(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GramMatrix_+3A_object">object</code></td>
<td>
<p>a <a href="#topic+SplineBasis">SplineBasis</a> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the Gram Matrix.  If <code>object</code> denotes the basis functions <code class="reqn">b(t) = \{b_1(t),\ldots,b_J(t)\}</code> then the Gram Matrix is,</p>
<p style="text-align: center;"><code class="reqn">
		G = \int b^T(t)b(t) \mathrm{d}t
	</code>
</p>



<h3>Value</h3>

<p>a matrix as defined above.
</p>

<hr>
<h2 id='Hankel'> Generating a Hankel Matrix </h2><span id='topic+Hankel'></span>

<h3>Description</h3>

<p>Functions to generate a Hankel matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hankel(x, nrow = length(x)%/%2, ncol = length(x)%/%2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hankel_+3A_x">x</code></td>
<td>
<p> numeric vector to specify the entries of the matrix.  Should have an even number of entries.</p>
</td></tr>
<tr><td><code id="Hankel_+3A_nrow">nrow</code></td>
<td>
<p> integer, must be at most length(x) </p>
</td></tr>
<tr><td><code id="Hankel_+3A_ncol">ncol</code></td>
<td>
<p> integer, must be at most length(x) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes a Hankel matrix.  If we denote the vector <code class="reqn">x=(x_1,\dots,x_n)</code> the Hankel matrix is defined and formed as
</p>
<p style="text-align: center;"><code class="reqn">H=\left(
\begin{array}{ccccc}
	x_1&amp;x_2&amp;x_3&amp;\cdots&amp;x_{1/2}\\
	x_2&amp;x_3&amp;&amp;\vdots&amp;\vdots\\
	x_3&amp;&amp;\vdots&amp;&amp;\vdots\\
	\vdots&amp;\vdots&amp;&amp;&amp;\vdots\\
	x_{1/2}&amp;\cdots&amp;\cdots&amp;\cdots&amp;x_n
\end{array}\right).
	</code>
</p>



<h3>Value</h3>

<p>a matrix as defined above.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Hankel(1:6)
</code></pre>

<hr>
<h2 id='integrate-methods'> Methods for Function integrate</h2><span id='topic+integrate-methods'></span><span id='topic+integrate'></span>

<h3>Description</h3>

<p>Methods for function <code>integrate</code>.  <code>integrate</code> integrates generic objects for which an integral is defined.
</p>


<h3>Methods</h3>


<dl>
<dt>object = &quot;SplineBasis&quot;</dt><dd><p> Returns a new <code>SplineBasis</code> object for the integral of the basis functions.  See <code><a href="#topic+SplineBasis-class">SplineBasis</a></code></p>
</dd>
</dl>

<hr>
<h2 id='MatrixPower'>Matrix Power</h2><span id='topic+MatrixPower'></span>

<h3>Description</h3>

<p>Performs the matrix power operation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MatrixPower(A, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MatrixPower_+3A_a">A</code></td>
<td>
<p> A square matrix. </p>
</td></tr>
<tr><td><code id="MatrixPower_+3A_n">n</code></td>
<td>
<p> An integer telling the exponent.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only well defined for integers the matrix power operation is a convenience function to multiply a matrix, <code>A</code>, with itself <code>n</code> times.
</p>


<h3>Value</h3>

<p>A matrix of the same dimension as <code>A</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>A&lt;-rbind(0,cbind(diag(1:5),0))  #a nilpotent matrix
A
MatrixPower(A,3)
MatrixPower(A,5)
MatrixPower(A,6)    #Gets to a zero matrix
</code></pre>

<hr>
<h2 id='orthogonalize-methods'> Methods for Function orthogonalize</h2><span id='topic+orthogonalize-methods'></span><span id='topic+orthogonalize'></span>

<h3>Description</h3>

<p>A generic function for orthogonalizing an object and returning the orthogonal object
</p>


<h3>Methods</h3>


<dl>
<dt>object = &quot;SplineBasis&quot;</dt><dd><p> Orthogonalize the spline basis functions. See <code><a href="#topic+SplineBasis">SplineBasis</a></code></p>
</dd>
</dl>

<hr>
<h2 id='OrthogonalizeBasis'> Orthogonalize a Spline Basis </h2><span id='topic+OrthogonalizeBasis'></span>

<h3>Description</h3>

<p>Specific function for orthogonalizing the functions in a  <code>SplineBasis</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OrthogonalizeBasis(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OrthogonalizeBasis_+3A_object">object</code></td>
<td>
<p> A <code>SplineBasis</code> object</p>
</td></tr>
<tr><td><code id="OrthogonalizeBasis_+3A_...">...</code></td>
<td>
<p> ignored </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code><a href="#topic+OrthogonalSplineBasis-class">OrthogonalSplineBasis</a></code> object.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+OrthogonalSplineBasis-class">OrthogonalSplineBasis</a></code>, <code><a href="#topic+SplineBasis-class">SplineBasis</a></code>,<code><a href="#topic+orthogonalize">orthogonalize</a></code> </p>

<hr>
<h2 id='OuterProdSecondDerivative'>Outer Product of Second Derivatives of Spline Bases</h2><span id='topic+OuterProdSecondDerivative'></span>

<h3>Description</h3>

<p>Provides the functional outer product of second derivatives of a set of basis functions in a <code>SplineBasis</code> object.
It a convenient form for forming a penalty on curve smoothness when fitting a spline curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OuterProdSecondDerivative(basis)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OuterProdSecondDerivative_+3A_basis">basis</code></td>
<td>
<p>A <code>SplineBasis</code> object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A square matrix of order <code>nrow(basis)</code>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SplineBasis-class">SplineBasis</a></code>,<code><a href="#topic+fitLS">fitLS</a></code> </p>

<hr>
<h2 id='SplineBasis'>Creating <code>SplineBasis</code> Objects.</h2><span id='topic+SplineBasis'></span><span id='topic+OrthogonalSplineBasis'></span><span id='topic+OBasis'></span>

<h3>Description</h3>

<p>The function to create <code>SplineBasis</code> and <code>OrthogonalSplineBasis</code> Objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	SplineBasis(knots, order=4, keep.duplicates=FALSE)
	OrthogonalSplineBasis(knots, ...)
	OBasis(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SplineBasis_+3A_knots">knots</code></td>
<td>
<p>The full set of knots used to define the basis functions.</p>
</td></tr>
<tr><td><code id="SplineBasis_+3A_order">order</code></td>
<td>
<p>Order of the spline fit.(degree= order-1)</p>
</td></tr>
<tr><td><code id="SplineBasis_+3A_keep.duplicates">keep.duplicates</code></td>
<td>
<p>Should duplicate interior knots that could cause computation problem be kept or removed.  Defaults to false, which removes duplicate knots with a warning if duplicate interior knots are found.</p>
</td></tr>
<tr><td><code id="SplineBasis_+3A_...">...</code></td>
<td>
<p>Other arguments either ignored or passed onto other functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SplineBasis</code> produces an object representing the basis functions used in spline fitting.  Provides a compact easily evaluated representation of the functions.  Produces a class of object <code>SplineBasis</code>.
<code>OrthogonalSplineBasis</code> is a shortcut to obtain a set of orthogonalized basis functions from the knots. <code>OBasis</code> is an alias for <code>OrthogonalSplineBasis</code>. Both provide an object of class <code>OrthogonalSplineBasis</code>.  The class <code>OrthogonalSplineBasis</code> inherits directly from <code>SplineBasis</code> meaning all functions that apply to <code>SplineBasis</code> functions also apply to the orthogonalized version.
</p>


<h3>Value</h3>

<p>Object of class <code>SplineBasis</code> or <code>OrthogonalSplineBasis</code>
</p>


<h3>References</h3>

<p><em>General matrix representations for B-splines</em> Kaihuai, Qin, The Visual Computer 2000 16:177&ndash;186
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineBasis-class">SplineBasis</a></code>, <code><a href="stats.html#topic+spline">spline</a></code>, <a href="#topic+orthogonalsplinebasis-package">orthogonalsplinebasis-package</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>knots&lt;-c(0,0,0,0:10,10,10,10)
plot(SplineBasis(knots))
obase&lt;-OBasis(knots)
plot(obase)
dim(obase)[2] #number of functions
evaluate(obase, 1:10-.5)
</code></pre>

<hr>
<h2 id='SplineBasis-class'>Classes <code>SplineBasis</code> and <code>OrthogonalSplineBasis</code></h2><span id='topic+SplineBasis-class'></span><span id='topic+OrthogonalSplineBasis-class'></span><span id='topic+deriv+2CSplineBasis-method'></span><span id='topic+dim+2CSplineBasis-method'></span><span id='topic+evaluate+2CSplineBasis+2Cnumeric-method'></span><span id='topic+integrate+2CSplineBasis-method'></span><span id='topic+orthogonalize+2CSplineBasis-method'></span><span id='topic+plot+2CSplineBasis+2Cmissing-method'></span><span id='topic+plot+2CSplineBasis+2Cvector-method'></span><span id='topic+plot+2CSplineBasis+2Cmatrix-method'></span>

<h3>Description</h3>

<p>Contains the matrix representation for spline basis functions.  The <code>OrthogonalSplineBasis</code> class has the basis functions orthogonalized.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code><a href="#topic+SplineBasis">SplineBasis</a>(knots, order)</code> or to generate orthogonal spline basis functions directly <code><a href="#topic+OrthogonalSplineBasis">OrthogonalSplineBasis</a>(knots, order)</code> or the short version <code><a href="#topic+OBasis">OBasis</a>(knots,order)</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>transformation</code>:</dt><dd><p>Object of class <code>"matrix"</code> Only applicable on <code>OrthogonalSplineBasis</code> class, shows the transformation matrix use to get from regular basis functions to orthogonal basis functions.</p>
</dd>
<dt><code>knots</code>:</dt><dd><p>Object of class <code>"numeric"</code> </p>
</dd>
<dt><code>order</code>:</dt><dd><p>Object of class <code>"integer"</code> </p>
</dd>
<dt><code>Matrices</code>:</dt><dd><p>Object of class <code>"array"</code> </p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>deriv</dt><dd><p><code>signature(expr = "SplineBasis")</code>: Computes the derivative of the basis functions.  Returns an object of class <code>SplineBasis</code>.</p>
</dd>
<dt>dim</dt><dd><p><code>signature(x = "SplineBasis")</code>: gives the dim as the order and number of basis functions.  Returns numeric of length 2.</p>
</dd>
<dt>evaluate</dt><dd><p><code>signature(object = "SplineBasis", x = "numeric")</code>: Evaluates the basis functions and the points provided in x.  Returns a matrix with <code>length(x)</code> rows and <code>dim(object)[2]</code> columns.</p>
</dd>
<dt>integrate</dt><dd><p><code>signature(object = "SplineBasis")</code>: computes the integral of the basis functions defined by <code class="reqn">\int\limits_{k_0}^x b(t)dt</code> where <code class="reqn">k_0</code> is the first knot.  Returns an object of class <code>SplineBasis</code>.</p>
</dd>
<dt>orthogonalize</dt><dd><p><code>signature(object = "SplineBasis")</code>: Takes in a <code>SplineBasis</code> object, computes the orthogonalization transformation and returns an object of class <code>OrthogonalSplineBasis</code>.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "SplineBasis", y = "missing")</code>: Takes an object of class <code>SplineBasis</code> and plots the basis functions for the domain defined by the knots in object.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "SplineBasis", y = "vector")</code>: Interprets y as a vector of coefficients and plots the resulting curve.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "SplineBasis", y = "matrix")</code>: Interprets y as a matrix of coefficients and plots the resulting curves.</p>
</dd>
</dl>



<h3>References</h3>

<p><em>General matrix representations for B-splines</em> Kaihuai Qin, The Visual Computer 2000 16:177&ndash;186
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineBasis">SplineBasis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("SplineBasis")

knots&lt;-c(0,0,0,0:5,5,5,5)
(base &lt;-SplineBasis(knots))
(obase&lt;-OBasis(knots))
plot(base)
plot(obase)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
