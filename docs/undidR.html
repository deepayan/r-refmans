<!DOCTYPE html><html lang="en"><head><title>Help for package undidR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {undidR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#undidR-package'><p>undidR: Difference-in-Differences with Unpoolable Data</p></a></li>
<li><a href='#create_diff_df'><p>Creates the <code>empty_diff_df.csv</code></p></a></li>
<li><a href='#create_init_csv'><p>Creates the <code>init.csv</code></p></a></li>
<li><a href='#plot_parallel_trends'><p>Plots parallel trends figures</p></a></li>
<li><a href='#silo71'><p>Example merit data</p></a></li>
<li><a href='#undid_date_formats'><p>Shows valid date formats</p></a></li>
<li><a href='#undid_stage_three'><p>Computes UNDID results</p></a></li>
<li><a href='#undid_stage_two'><p>Runs UNDID stage two procedures</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Difference-in-Differences with Unpoolable Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Jamieson &lt;ericbrucejamieson@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework for estimating difference-in-differences with
 unpoolable data, based on Karim, Webb, Austin, and Strumpf (2024)
 &lt;<a href="https://doi.org/10.48550%2FarXiv.2403.15910">doi:10.48550/arXiv.2403.15910</a>&gt;. Supports common or staggered adoption, multiple
 groups, and the inclusion of covariates. Also computes p-values for the
 aggregate average treatment effect on the treated via the
 randomization inference procedure described in MacKinnon and Webb (2020)
 &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2020.04.024">doi:10.1016/j.jeconom.2020.04.024</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, grDevices, stats, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ebjamieson97/undidR">https://github.com/ebjamieson97/undidR</a>,
<a href="https://ebjamieson97.github.io/undidR/">https://ebjamieson97.github.io/undidR/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ebjamieson97/undidR/issues">https://github.com/ebjamieson97/undidR/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-24 19:30:40 UTC; Eric Bruce Jamieson</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Jamieson [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-24 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='undidR-package'>undidR: Difference-in-Differences with Unpoolable Data</h2><span id='topic+undidR'></span><span id='topic+undidR-package'></span>

<h3>Description</h3>

<p>A framework for estimating difference-in-differences with unpoolable data, based on Karim, Webb, Austin, and Strumpf (2024) <a href="https://doi.org/10.48550/arXiv.2403.15910">doi:10.48550/arXiv.2403.15910</a>. Supports common or staggered adoption, multiple groups, and the inclusion of covariates. Also computes p-values for the aggregate average treatment effect on the treated via the randomization inference procedure described in MacKinnon and Webb (2020) <a href="https://doi.org/10.1016/j.jeconom.2020.04.024">doi:10.1016/j.jeconom.2020.04.024</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Eric Jamieson <a href="mailto:ericbrucejamieson@gmail.com">ericbrucejamieson@gmail.com</a> [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ebjamieson97/undidR">https://github.com/ebjamieson97/undidR</a>
</p>
</li>
<li> <p><a href="https://ebjamieson97.github.io/undidR/">https://ebjamieson97.github.io/undidR/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ebjamieson97/undidR/issues">https://github.com/ebjamieson97/undidR/issues</a>
</p>
</li></ul>


<hr>
<h2 id='create_diff_df'>Creates the <code>empty_diff_df.csv</code></h2><span id='topic+create_diff_df'></span>

<h3>Description</h3>

<p>Creates the <code>empty_diff_df.csv</code> which lists all of the differences that
need to calculated at each silo in order to compute the aggregate ATT.
The <code>empty_diff_df.csv</code> is then to be sent out to each silo to be filled out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_diff_df(
  init_filepath,
  date_format,
  freq,
  covariates = FALSE,
  freq_multiplier = FALSE,
  weights = "standard",
  filename = "empty_diff_df.csv",
  filepath = tempdir()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_diff_df_+3A_init_filepath">init_filepath</code></td>
<td>
<p>A character filepath to the <code>init.csv</code>.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_date_format">date_format</code></td>
<td>
<p>A character specifying the date format used in the
<code>init.csv</code>. Call <code><a href="#topic+undid_date_formats">undid_date_formats()</a></code> to see a list of valid date formats.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_freq">freq</code></td>
<td>
<p>A character indicating the length of the time periods to be used
when computing the differences in mean outcomes between periods at each
silo. Options are: <code>"yearly"</code>, <code>"monthly"</code>, <code>"weekly"</code>, or <code>"daily"</code>.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_covariates">covariates</code></td>
<td>
<p>A character vector specifying covariates to be considered
at each silo. If <code>FALSE</code> (default) uses covariates from the <code>init.csv</code>.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_freq_multiplier">freq_multiplier</code></td>
<td>
<p>A numeric value or <code>FALSE</code> (default).
Specify if the frequency should be multiplied by a non-zero integer.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_weights">weights</code></td>
<td>
<p>A character indicating the weighting to use in the case of
common adoption. The <code>"standard"</code> (default) weight is calculated as
<code class="reqn">w_s = \frac{N_s^{\text{post}}}{N_s^{\text{post}} + N_s^{\text{pre}}}</code>.
Options are: <code>"standard"</code>.</p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_filename">filename</code></td>
<td>
<p>A character filename for the created CSV file. Defaults to
<code>"empty_diff_df.csv"</code></p>
</td></tr>
<tr><td><code id="create_diff_df_+3A_filepath">filepath</code></td>
<td>
<p>Filepath to save the CSV file. Defaults to <code>tempdir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ensure that dates in the <code>init.csv</code> are entered consistently
in the same date format. Call <code><a href="#topic+undid_date_formats">undid_date_formats()</a></code> to see a list of valid
date formats. Covariates specified when calling <code>create_diff_df()</code> will
override any covariates specified in the <code>init.csv</code>.
</p>


<h3>Value</h3>

<p>A data frame detailing the silo and time combinations for which
differences must be calculated in order to compute the aggregate ATT. A
CSV copy is saved to the specified directory which is then to be sent out
to each silo.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file_path &lt;- system.file("extdata/staggered", "init.csv",
                         package = "undidR")
create_diff_df(
  init_filepath = file_path,
  date_format = "yyyy",
  freq = "yearly"
)
unlink(file.path(tempdir(), "empty_diff_df.csv"))
</code></pre>

<hr>
<h2 id='create_init_csv'>Creates the <code>init.csv</code></h2><span id='topic+create_init_csv'></span>

<h3>Description</h3>

<p>The <code>create_init_csv()</code> function generates a CSV file with information
on each silo's start times, end times, and treatment times.
If parameters are left empty, generates a blank CSV with only the headers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_init_csv(
  silo_names = character(),
  start_times = character(),
  end_times = character(),
  treatment_times = character(),
  covariates = character(),
  filename = "init.csv",
  filepath = tempdir()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_init_csv_+3A_silo_names">silo_names</code></td>
<td>
<p>A character vector of silo names.</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_start_times">start_times</code></td>
<td>
<p>A character vector of start times.</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_end_times">end_times</code></td>
<td>
<p>A character vector of end times.</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_treatment_times">treatment_times</code></td>
<td>
<p>A character vector of treatment times.</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_covariates">covariates</code></td>
<td>
<p>A character vector of covariates, or, <code>FALSE</code> (default).</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_filename">filename</code></td>
<td>
<p>A character filename for the created initializing CSV file.
Defaults to <code>"init.csv"</code>.</p>
</td></tr>
<tr><td><code id="create_init_csv_+3A_filepath">filepath</code></td>
<td>
<p>Filepath to save the CSV file. Defaults to <code>tempdir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ensure dates are entered consistently in the same date format.
Call <code><a href="#topic+undid_date_formats">undid_date_formats()</a></code> to view valid date formats. Control silos
should be marked as <code>"control"</code> in the <code>treatment_times</code> vector. If
<code>covariates</code> is <code>FALSE</code>, no covariate column will be included in the CSV.
</p>


<h3>Value</h3>

<p>A data frame containing the contents written to the CSV file.
The CSV file is saved in the specified directory (or in a temporary
directory by default) with the default filename <code>init.csv</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_init_csv(
  silo_names = c("73", "46", "54", "23", "86", "32",
                 "71", "58", "64", "59", "85", "57"),
  start_times = "1989",
  end_times = "2000",
  treatment_times = c(rep("control", 6),
                      "1991", "1993", "1996", "1997", "1997", "1998"),
  covariates = c("asian", "black", "male")
)
unlink(file.path(tempdir(), "init.csv"))
</code></pre>

<hr>
<h2 id='plot_parallel_trends'>Plots parallel trends figures</h2><span id='topic+plot_parallel_trends'></span>

<h3>Description</h3>

<p>The <code>plot_parallel_trends()</code> function combines the various
trends data CSV files and plots parallel trends figures.
All treatment and all control groups can be combined so that there
is one control line and one treatment line by setting <code>combine = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_parallel_trends(
  dir_path,
  covariates = FALSE,
  save_csv = FALSE,
  combine = FALSE,
  pch = NA,
  pch_control = NA,
  pch_treated = NA,
  control_colour = c("darkgrey", "lightgrey"),
  control_color = NULL,
  treatment_colour = c("darkred", "lightcoral"),
  treatment_color = NULL,
  lwd = 2,
  xlab = NA,
  ylab = NA,
  title = NA,
  xticks = 4,
  date_format = "%Y-%m-%d",
  xdates = NULL,
  xaxlabsz = 0.8,
  save_png = FALSE,
  width = 800,
  height = 600,
  ylim = NULL,
  yaxlabsz = 0.8,
  ylabels = NULL,
  yticks = 4,
  ydecimal = 2,
  legend_location = "topright",
  simplify_legend = TRUE,
  legend_cex = 0.7,
  legend_on = TRUE,
  treatment_indicator_col = "grey",
  treatment_indicator_alpha = 0.5,
  treatment_indicator_lwd = 2,
  treatment_indicator_lty = 2,
  interpolate = FALSE,
  filepath = tempdir(),
  filenamecsv = "combined_trends_data.csv",
  filenamepng = "undid_plot.png"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_parallel_trends_+3A_dir_path">dir_path</code></td>
<td>
<p>A character filepath to the folder containing all
of the trends data CSV files.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_covariates">covariates</code></td>
<td>
<p>A logical value (defaults to <code>FALSE</code>) indicating whether or
not to consider covariates, i.e. whether or not to use the <code>mean_outcome</code>
column or the <code>mean_outcome_residualized</code> column from the trends data CSV
files.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_save_csv">save_csv</code></td>
<td>
<p>A logical value (defaults to <code>FALSE</code>)
indicating whether or not to save the <code>combined_trends_data.csv</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_combine">combine</code></td>
<td>
<p>A logical value (defaults to <code>FALSE</code>) indicating whether
to plot each silo separately or to combine silos based on treatment status.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_pch">pch</code></td>
<td>
<p>An integer (0 to 25) or vector of integers (from 0 to 25)
which determine the style of points used on the plot. Setting to <code>NA</code>
(default) will omit points from the plot.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_pch_control">pch_control</code></td>
<td>
<p>An integer (from 0 to 25) or vector of integers
(from 0 to 25) which determine the style of points used on the plot
for control silos. Takes value of pch if set to <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_pch_treated">pch_treated</code></td>
<td>
<p>An integer (from 0 to 25) or vector of integers
(from 0 to 25) which determine the style of points used on the plot
for treated silos. Takes value of pch if set to <code>NULL</code> (default).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_control_colour">control_colour</code></td>
<td>
<p>A character vector of colours
(defaults to <code>c("darkgrey", "lightgrey")</code>) for the control silo lines.
If <code>combine = TRUE</code>, takes the 1st value to determine the colour of
the control line.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_control_color">control_color</code></td>
<td>
<p>Overrides <code>control_colour</code> if used. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_colour">treatment_colour</code></td>
<td>
<p>A character vector of colours
(defaults to <code>c("darkred", "lightcoral")</code>) for the treatment silos.
If combine = TRUE, takes the 1st value to determine the colour of
the control line.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_color">treatment_color</code></td>
<td>
<p>Overrides <code>control_colour</code> if used.
Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_lwd">lwd</code></td>
<td>
<p>An integer (defaults to <code>2</code>) for selecting the line widths.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_xlab">xlab</code></td>
<td>
<p>A character value for the x-axis label (defaults to <code>NA</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_ylab">ylab</code></td>
<td>
<p>A character value for the y-axis label (defaults to <code>NA</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_title">title</code></td>
<td>
<p>A character value for the title of the plot (defaults to <code>NA</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_xticks">xticks</code></td>
<td>
<p>An integer value denoting how many ticks to display
on the x-axis (defaults to <code>4</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_date_format">date_format</code></td>
<td>
<p>A string value denoting the format with which to display
the dates along the x-axis (defaults to <code>"%Y"</code>).
Uses standard R date formatting styles.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_xdates">xdates</code></td>
<td>
<p>Takes in a vector of date objects to be used as the dates shown
along the x-axis (defaults to <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_xaxlabsz">xaxlabsz</code></td>
<td>
<p>A double indicating the x-axis label sizes in comparison
to a standardized default size (defaults to <code>0.8</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_save_png">save_png</code></td>
<td>
<p>A logical value indicating whether or not to save the plot
as a PNG file (defaults to <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_width">width</code></td>
<td>
<p>An integer denoting the width of the saved PNG file.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_height">height</code></td>
<td>
<p>An integer denoting the height of the saved PNG file.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_ylim">ylim</code></td>
<td>
<p>A vector of two doubles defining the min and max range of the
values on the y-axis. Defaults to the min and max values of the values
to be plotted.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_yaxlabsz">yaxlabsz</code></td>
<td>
<p>A double for specifying the y-axis label sizes
(defaults to <code>0.8</code>) in comparison to a standardized default size.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_ylabels">ylabels</code></td>
<td>
<p>A vector of values that you would like to appear
on the y-axis (defaults to <code>NULL</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_yticks">yticks</code></td>
<td>
<p>An integer denoting how many values to display
along the y-axis (defaults to <code>4</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_ydecimal">ydecimal</code></td>
<td>
<p>An integer value denoting to which decimal point
the values along the y-axis are rounded to.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_legend_location">legend_location</code></td>
<td>
<p>A character value for determining the location
of the legend (defaults to <code>"topright"</code>). Options are: <code>"topright"</code>,
<code>"topleft"</code>, <code>"bottomright"</code>, <code>"bottomleft"</code>, <code>"top"</code>, <code>"bottom"</code>,
<code>"left"</code>, <code>"right"</code>, <code>"center"</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_simplify_legend">simplify_legend</code></td>
<td>
<p>A logical value which if set to <code>TRUE</code> shows one
colour for the treatment silos in the legend and one colour for the control
silos. Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_legend_cex">legend_cex</code></td>
<td>
<p>A double for adjusting the size of the text in the legend
compared to a standard default size. Defaults to <code>0.7</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_legend_on">legend_on</code></td>
<td>
<p>A logical value for turning the legend on or off
(defaults to <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_indicator_col">treatment_indicator_col</code></td>
<td>
<p>A character value for determining the colour
of the dashed vertical lines showing when treatment times were
(defaults to <code>"grey"</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_indicator_alpha">treatment_indicator_alpha</code></td>
<td>
<p>A double for for determining the
transparency level of the dashed vertical lines showing the treatment
times (defaults to <code>0.5</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_indicator_lwd">treatment_indicator_lwd</code></td>
<td>
<p>A double for selecting the line width
of the treatment indicator lines (defaults to <code>2</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_treatment_indicator_lty">treatment_indicator_lty</code></td>
<td>
<p>An integer for the selecting the lty option,
i.e. the line style, for the treatment_indicator lines (defaults to <code>2</code>).</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_interpolate">interpolate</code></td>
<td>
<p>A logical value (either <code>TRUE</code> or <code>FALSE</code>) which
determines if interpolation should be used to fill missing trends data.
Defaults to <code>FALSE</code>. Uses a piecewise linear function.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_filepath">filepath</code></td>
<td>
<p>Filepath to save the CSV file. Defaults to <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_filenamecsv">filenamecsv</code></td>
<td>
<p>A string filename for the combined trends data
Defaults to <code>"combined_trends_data.csv"</code>.</p>
</td></tr>
<tr><td><code id="plot_parallel_trends_+3A_filenamepng">filenamepng</code></td>
<td>
<p>A string filename for the PNG file output.
Defaults to <code>"undid_plot.png"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame built from the trends data from all CSV
files in the specified directory. If <code>combine = FALSE</code>, the
data frame includes all silos joined by row. If <code>combine = TRUE</code>,
the data frame merges treated silos into a single treatment group
and control silos into a single control group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Get path to example data included with package
dir_path &lt;- system.file("extdata/staggered", package = "undidR")

# Basic usage with default parameters
plot_parallel_trends(dir_path)

# Custom plot with modified parameters
plot_parallel_trends(dir_path, combine = TRUE, lwd = 4,
                     xdates = as.Date(c("1989-01-01", "1991-01-01",
                                        "1993-01-01", "1995-01-01",
                                        "1997-01-01", "1999-01-01")))
</code></pre>

<hr>
<h2 id='silo71'>Example merit data</h2><span id='topic+silo71'></span>

<h3>Description</h3>

<p>A dataset containing college enrollment and demographic data for analyzing
the effects of merit programs in state 71.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>silo71
</code></pre>


<h3>Format</h3>

<p>A tibble with 569 rows and 7 variables:
</p>

<dl>
<dt>coll</dt><dd><p>Binary indicator for college enrollment (outcome variable)</p>
</dd>
<dt>merit</dt><dd><p>Binary indicator for merit program (treatment variable)</p>
</dd>
<dt>male</dt><dd><p>Binary indicator for male students</p>
</dd>
<dt>black</dt><dd><p>Binary indicator for Black students</p>
</dd>
<dt>asian</dt><dd><p>Binary indicator for Asian students</p>
</dd>
<dt>year</dt><dd><p>Year of observation</p>
</dd>
<dt>state</dt><dd><p>State identifier</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://economics.uwo.ca/people/conley_docs/code_to_download.html">https://economics.uwo.ca/people/conley_docs/code_to_download.html</a>
</p>

<hr>
<h2 id='undid_date_formats'>Shows valid date formats</h2><span id='topic+undid_date_formats'></span>

<h3>Description</h3>

<p>The <code>undid_date_formats()</code> function returns a list of all valid date formats
that can be used within the <code>undidR</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>undid_date_formats()
</code></pre>


<h3>Details</h3>

<p>The date formats returned by this function are used to ensure
consistency in date processing within the <code>undidR</code> package.
</p>


<h3>Value</h3>

<p>A named list containing valid date formats:
</p>

<ul>
<li> <p><code>General_Formats</code>: General date formats compatible with the package.
</p>
</li>
<li> <p><code>R_Specific_Formats</code>: Date formats specific to R.
</p>
</li>
<li> <p><code>Other_Formats</code>: Formats seen sometimes in Stata.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>undid_date_formats()
</code></pre>

<hr>
<h2 id='undid_stage_three'>Computes UNDID results</h2><span id='topic+undid_stage_three'></span>

<h3>Description</h3>

<p>Takes in all of the filled diff df CSV files and uses them to compute
group level ATTs as well as the aggregate ATT and its standard errors
and p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>undid_stage_three(
  dir_path,
  agg = "silo",
  weights = TRUE,
  covariates = FALSE,
  interpolation = FALSE,
  save_csv = FALSE,
  filename = "UNDID_results.csv",
  filepath = tempdir(),
  nperm = 1001,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="undid_stage_three_+3A_dir_path">dir_path</code></td>
<td>
<p>A character specifying the filepath to the folder containing
all of the filled diff df CSV files.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_agg">agg</code></td>
<td>
<p>A character which specifies the aggregation methodology for
computing the aggregate ATT in the case of staggered adoption.
Options are: <code>"silo"</code>, <code>"g"</code>, or <code>"gt"</code>. Defaults to <code>"silo"</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_weights">weights</code></td>
<td>
<p>A logical value (either <code>TRUE</code> or <code>FALSE</code>) which determines
whether or not the weights should be used in the case of common adoption.
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_covariates">covariates</code></td>
<td>
<p>A logical value (either <code>TRUE</code> or <code>FALSE</code>) which specifies
whether to use the <code>diff_estimate</code> column or the <code>diff_estimate_covariates</code>
column from the filled diff df CSV files when computing ATTs.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_interpolation">interpolation</code></td>
<td>
<p>A logical value or a character which specifies which,
if any, method of interpolation/extrapolation for missing values of
<code>diff_estimate</code> or <code>diff_estimate_covariates</code> should be used.
There must be at least one <code>diff_estimate</code> or <code>diff_estimate_covariates</code>
value for the (silo,g) group for which a missing value is being estimated
in order for interpolation to work. Options are: <code>"linear_function"</code>,
<code>"nearest_value"</code>, or <code>"piecewise_linear"</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_save_csv">save_csv</code></td>
<td>
<p>A logical value, either <code>TRUE</code> or <code>FALSE</code> (default),
which determines if a CSV copy of the UNDID results will be saved or not.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_filename">filename</code></td>
<td>
<p>A string filename for the created CSV file.
Defaults to <code>"UNDID_results.csv"</code></p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_filepath">filepath</code></td>
<td>
<p>Filepath to save the CSV file. Defaults to <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_nperm">nperm</code></td>
<td>
<p>Number of random permutations of gvar &amp; silo pairs to consider
when calculating the randomization inference p-value. Defaults to <code>1001</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_three_+3A_verbose">verbose</code></td>
<td>
<p>A logical value (either <code>TRUE</code> or <code>FALSE</code>) which toggles
messages showing the progress of the randomization inference.
Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>agg</code> parameter specifies the aggregation method used in the
case of staggered adoption. By default it is set to <code>"silo"</code> so that the ATTs
are aggregated across silos with each silo having equal weight, but can be
set to <code>"gt"</code> or <code>"g"</code> instead. Aggregating across <code>"g"</code> calculates ATTs for
groups based on when the treatment time was, with each <code>"g"</code> group having
equal weight. Aggregating across <code>"gt"</code> calculates ATTs for groups based on
when the treatment time was and the time for which the ATT is calculated.
The <code>agg</code> parameter is ignored in the case of a common treatment time and
only takes effect in the case of staggered adoption. For common adoption,
refer to the <code>weights</code> parameter.
</p>


<h3>Value</h3>

<p>A data frame containing the aggregate ATT and its
standard errors and p-values from two-sided tests of <code>agg_ATT</code> == 0.
Also returns group (silo, g, or gt) level ATTs for staggered adoption.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Execute `undid_stage_three()`
dir &lt;- system.file("extdata/staggered", package = "undidR")
undid_stage_three(dir, agg = "g", nperm = 501, verbose = FALSE)

</code></pre>

<hr>
<h2 id='undid_stage_two'>Runs UNDID stage two procedures</h2><span id='topic+undid_stage_two'></span>

<h3>Description</h3>

<p>Based on the information given in the received <code>empty_diff_df.csv</code>,
computes the appropriate differences in mean outcomes at the local silo
and saves as <code>filled_diff_df_$silo_name.csv</code>. Also stores trends data
as <code>trends_data_$silo_name.csv</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>undid_stage_two(
  empty_diff_filepath,
  silo_name,
  silo_df,
  time_column,
  outcome_column,
  silo_date_format,
  consider_covariates = TRUE,
  filepath = tempdir()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="undid_stage_two_+3A_empty_diff_filepath">empty_diff_filepath</code></td>
<td>
<p>A character filepath to the <code>empty_diff_df.csv</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_silo_name">silo_name</code></td>
<td>
<p>A character indicating the name of the local silo. Ensure
spelling is the same as it is written in the <code>empty_diff_df.csv</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_silo_df">silo_df</code></td>
<td>
<p>A data frame of the local silo's data. Ensure any covariates
are spelled the same in this data frame as they are in the
<code>empty_diff_df.csv</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_time_column">time_column</code></td>
<td>
<p>A character which indicates the name of the column in
the <code>silo_df</code> which contains the date data. Ensure the <code>time_column</code>
references a column of character values.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_outcome_column">outcome_column</code></td>
<td>
<p>A character which indicates the name of the column in
the <code>silo_df</code> which contains the outcome of interest. Ensure the
<code>outcome_column</code> references a column of numeric values.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_silo_date_format">silo_date_format</code></td>
<td>
<p>A character which indicates the date format which
the date strings in the <code>time_column</code> are written in.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_consider_covariates">consider_covariates</code></td>
<td>
<p>An optional logical parameter which if set to
<code>FALSE</code> ignores any of the computations involving the covariates.
Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="undid_stage_two_+3A_filepath">filepath</code></td>
<td>
<p>Character value indicating the filepath to
save the CSV files. Defaults to <code>tempdir()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariates at the local silo should be renamed to match the
spelling used in the <code>empty_diff_df.csv</code>.
</p>


<h3>Value</h3>

<p>A list of data frames. The first being the filled differences
data frame, and the second being the trends data data frame. Use
the suffix $diff_df to access the filled differences data frame, and
use $trends_data to access the trends data data frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
silo_data &lt;- silo71
empty_diff_path &lt;- system.file("extdata/staggered", "empty_diff_df.csv",
                               package = "undidR")

# Run `undid_stage_two()`
results &lt;- undid_stage_two(
  empty_diff_filepath = empty_diff_path,
  silo_name = "71",
  silo_df = silo_data,
  time_column = "year",
  outcome_column = "coll",
  silo_date_format = "yyyy"
)

# View results
head(results$diff_df)
head(results$trends_data)

# Clean up temporary files
unlink(file.path(tempdir(), c("diff_df_71.csv",
                             "trends_data_71.csv")))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
