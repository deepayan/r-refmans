<!DOCTYPE html><html><head><title>Help for package BayesianPower</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesianPower}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayes_error'><p>Determine the unconditional error probabilities for a set of simulated</p>
Bayes factors.</a></li>
<li><a href='#bayes_power'><p>Determine the 'power' for a Bayesian hypothesis test</p></a></li>
<li><a href='#bayes_sampsize'><p>Determine the required sample size for a Bayesian hypothesis test</p></a></li>
<li><a href='#calc_bf'><p>Compute a Bayes factor</p></a></li>
<li><a href='#calc_fc'><p>Compute the complexity or fit for two hypotheses.</p></a></li>
<li><a href='#eval_const'><p>Evaluate a constraint matrix for a set of prior/posterior samples</p></a></li>
<li><a href='#samp_bf'><p>Sample multiple datasets and compute the Bayes factor in each</p></a></li>
<li><a href='#samp_dist'><p>Sample from prior or posterior distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sample Size and Power for Comparing Inequality Constrained
Hypotheses</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Fayette Klaassen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fayette Klaassen &lt;klaassen.fayette@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of methods to determine the required sample size for
    the evaluation of inequality constrained hypotheses by means of a Bayes 
    factor. Alternatively, for a given sample size, the unconditional error 
    probabilities or the expected conditional error probabilities can be
    determined. Additional material on the methods in this package is 
    available in Klaassen, F., Hoijtink, H. &amp; Gu, X. (2019) 
    &lt;<a href="https://doi.org/10.31219%2Fosf.io%2Fd5kf3">doi:10.31219/osf.io/d5kf3</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-22 08:07:44 UTC; 31643</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-22 08:40:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayes_error'>Determine the unconditional error probabilities for a set of simulated
Bayes factors.</h2><span id='topic+bayes_error'></span>

<h3>Description</h3>

<p>Determine the unconditional error probabilities for a set of simulated
Bayes factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes_error(BFs1, BFs2, bound1 = 1, bound2 = 1/bound1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes_error_+3A_bfs1">BFs1</code></td>
<td>
<p>A vector. Simulated BF12 under H1 for a given n</p>
</td></tr>
<tr><td><code id="bayes_error_+3A_bfs2">BFs2</code></td>
<td>
<p>A vector. Simulated BF12 under H2 for a given n</p>
</td></tr>
<tr><td><code id="bayes_error_+3A_bound1">bound1</code></td>
<td>
<p>A number. The boundary above which BF12 favors H1</p>
</td></tr>
<tr><td><code id="bayes_error_+3A_bound2">bound2</code></td>
<td>
<p>A number. The boundary below which BF12 favors H2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector. The Type 1, Type 2, Decision error and Area of Indecision probabilities
and the median Bayes factors under H1 and H2
</p>

<hr>
<h2 id='bayes_power'>Determine the 'power' for a Bayesian hypothesis test</h2><span id='topic+bayes_power'></span>

<h3>Description</h3>

<p>Determine the 'power' for a Bayesian hypothesis test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes_power(
  n,
  h1,
  h2,
  m1,
  m2,
  sd1 = 1,
  sd2 = 1,
  scale = 1000,
  bound1 = 1,
  bound2 = 1/bound1,
  datasets = 1000,
  nsamp = 1000,
  seed = 31
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes_power_+3A_n">n</code></td>
<td>
<p>A number. The sample size</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_h1">h1</code></td>
<td>
<p>A constraint matrix defining H1</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_h2">h2</code></td>
<td>
<p>A constraint matrix defining H2</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_m1">m1</code></td>
<td>
<p>A vector of expected population means under H1</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_m2">m2</code></td>
<td>
<p>A vector of expected populations means under H2
<code>m2</code> must be of same length as <code>m1</code></p>
</td></tr>
<tr><td><code id="bayes_power_+3A_sd1">sd1</code></td>
<td>
<p>A vector of standard deviations under H1. Must be a single number (equal
standard deviation under all populations), or a vector of the same length as <code>m1</code></p>
</td></tr>
<tr><td><code id="bayes_power_+3A_sd2">sd2</code></td>
<td>
<p>A vector of standard deviations under H2. Must be a single number (equal
standard deviation under all populations), or a vector of the same length as <code>m2</code></p>
</td></tr>
<tr><td><code id="bayes_power_+3A_scale">scale</code></td>
<td>
<p>A number specifying the prior scale</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_bound1">bound1</code></td>
<td>
<p>A number. The boundary above which BF12 favors H1</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_bound2">bound2</code></td>
<td>
<p>A number. The boundary below which BF12 favors H2</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_datasets">datasets</code></td>
<td>
<p>A number. The number of datasets to compute the error probabilities</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of prior or posterior samples to determine the
fit and complexity</p>
</td></tr>
<tr><td><code id="bayes_power_+3A_seed">seed</code></td>
<td>
<p>A number. The random seed to be set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Type 1, Type 2, Decision error and Area of Indecision probability and
the median BF12s under H1 and H2
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Short example WITH SMALL AMOUNT OF SAMPLES
h1 &lt;- matrix(c(1,-1,0,0,1,-1), nrow= 2, byrow= TRUE)
h2 &lt;- "c"
m1 &lt;- c(.4,.2,0)
m2 &lt;- c(.2,0,.1)
bayes_power(40, h1, h2, m1, m2, datasets = 50, nsamp = 50)
</code></pre>

<hr>
<h2 id='bayes_sampsize'>Determine the required sample size for a Bayesian hypothesis test</h2><span id='topic+bayes_sampsize'></span>

<h3>Description</h3>

<p>Determine the required sample size for a Bayesian hypothesis test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes_sampsize(
  h1,
  h2,
  m1,
  m2,
  sd1 = 1,
  sd2 = 1,
  scale = 1000,
  type = 1,
  cutoff,
  bound1 = 1,
  bound2 = 1/bound1,
  datasets = 1000,
  nsamp = 1000,
  minss = 2,
  maxss = 1000,
  seed = 31
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayes_sampsize_+3A_h1">h1</code></td>
<td>
<p>A constraint matrix defining H1.</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_h2">h2</code></td>
<td>
<p>A constraint matrix defining H2.</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_m1">m1</code></td>
<td>
<p>A vector of expected population means under H1 (standardized).</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_m2">m2</code></td>
<td>
<p>A vector of expected populations means under H2 (standardized).
<code>m2</code> must be of same length as <code>m1</code></p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_sd1">sd1</code></td>
<td>
<p>A vector of standard deviations under H1. Must be a single number (equal
standard deviation under all populations), or a vector of the same length as <code>m1</code></p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_sd2">sd2</code></td>
<td>
<p>A vector of standard deviations under H2. Must be a single number (equal
standard deviation under all populations), or a vector of the same length as <code>m2</code></p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_scale">scale</code></td>
<td>
<p>A number specifying the prior scale</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_type">type</code></td>
<td>
<p>A character. The type of error to be controlled
options are: <code>"1", "2", "de", "aoi", "med.1", "med.2"</code></p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_cutoff">cutoff</code></td>
<td>
<p>A number. The cutoff criterion for type.
If <code>type</code> is <code>"1", "2", "de", "aoi"</code>, <code>cutoff</code> must be between 0 and 1
If <code>type</code> is <code>"med.1" or "med.2"</code>, <code>cutoff</code> must be larger than 1</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_bound1">bound1</code></td>
<td>
<p>A number. The boundary above which BF12 favors H1</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_bound2">bound2</code></td>
<td>
<p>A number. The boundary below which BF12 favors H2</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_datasets">datasets</code></td>
<td>
<p>A number. The number of datasets to compute the error probabilities</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of prior or posterior samples to determine the
fit and complexity</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_minss">minss</code></td>
<td>
<p>A number. The minimum sample size to consider</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_maxss">maxss</code></td>
<td>
<p>A number. The maximum sample size to consider</p>
</td></tr>
<tr><td><code id="bayes_sampsize_+3A_seed">seed</code></td>
<td>
<p>A number. The random seed to be set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The sample size for which the chosen type of error probability
is at the set cutoff, and the according error probabilities and median Bayes factors
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Short computation example NOT SUFFICIENT SAMPLES
h1 &lt;- matrix(c(1,-1), nrow= 1, byrow= TRUE)
h2 &lt;- 'c'
m1 &lt;- c(.4, 0)
m2 &lt;- c(0, .1)
bayes_sampsize(h1, h2, m1, m2, sd1 = 1, sd2 = 1, scale = 1000,
type = "de", cutoff = .125, nsamp = 50, datasets = 50,
minss = 40, maxss = 70)
</code></pre>

<hr>
<h2 id='calc_bf'>Compute a Bayes factor</h2><span id='topic+calc_bf'></span>

<h3>Description</h3>

<p>Compute a Bayes factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_bf(data, h1, h2, scale, nsamp = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_bf_+3A_data">data</code></td>
<td>
<p>A matrix. The dataset for which the BF must be computed</p>
</td></tr>
<tr><td><code id="calc_bf_+3A_h1">h1</code></td>
<td>
<p>A constraint matrix defining H1.</p>
</td></tr>
<tr><td><code id="calc_bf_+3A_h2">h2</code></td>
<td>
<p>A constraint matrix defining H2.</p>
</td></tr>
<tr><td><code id="calc_bf_+3A_scale">scale</code></td>
<td>
<p>A number specifying the prior scale.</p>
</td></tr>
<tr><td><code id="calc_bf_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of prior or posterior samples to determine the</p>
</td></tr>
</table>


<h3>Value</h3>

<p>BF12, that is, the evidence for H1 relative to H2
</p>

<hr>
<h2 id='calc_fc'>Compute the complexity or fit for two hypotheses.</h2><span id='topic+calc_fc'></span>

<h3>Description</h3>

<p>Compute the complexity or fit for two hypotheses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_fc(hyp, hyp2, means, sds, nsamp = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc_fc_+3A_hyp">hyp</code></td>
<td>
<p>A constraint matrix defining H1.</p>
</td></tr>
<tr><td><code id="calc_fc_+3A_hyp2">hyp2</code></td>
<td>
<p>A constraint matrix defining H2 OR a character <code>'u'</code>
or <code>'c'</code> specifying an unconstrained or complement hypothesis</p>
</td></tr>
<tr><td><code id="calc_fc_+3A_means">means</code></td>
<td>
<p>A vector of posterior or prior means</p>
</td></tr>
<tr><td><code id="calc_fc_+3A_sds">sds</code></td>
<td>
<p>A vector or posterior or prior standard deviation</p>
</td></tr>
<tr><td><code id="calc_fc_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of prior or posterior samples to determine the
fit and complexity</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector.
The proportion of posterior samples in agreement with H1 and with H2
</p>

<hr>
<h2 id='eval_const'>Evaluate a constraint matrix for a set of prior/posterior samples</h2><span id='topic+eval_const'></span>

<h3>Description</h3>

<p>Evaluate a constraint matrix for a set of prior/posterior samples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eval_const(hyp, samples)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eval_const_+3A_hyp">hyp</code></td>
<td>
<p>A constraint matrix defining a hypothesis.</p>
</td></tr>
<tr><td><code id="eval_const_+3A_samples">samples</code></td>
<td>
<p>A matrix. Prior or posterior samples, the number of columns
corresponds to the number of groups, the number of rows the number of samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number between 0 and 1. The proportion of samples in which the
constraints are met.
</p>

<hr>
<h2 id='samp_bf'>Sample multiple datasets and compute the Bayes factor in each</h2><span id='topic+samp_bf'></span>

<h3>Description</h3>

<p>Sample multiple datasets and compute the Bayes factor in each
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samp_bf(datasets, n, ngroup, means, sds, h1, h2, scale, nsamp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samp_bf_+3A_datasets">datasets</code></td>
<td>
<p>A number. The number of datasets to simulate for each
sample size <code>n</code></p>
</td></tr>
<tr><td><code id="samp_bf_+3A_n">n</code></td>
<td>
<p>A number. The group sample size to be used in data simulation</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_ngroup">ngroup</code></td>
<td>
<p>A number. The number of groups.</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_means">means</code></td>
<td>
<p>A vector of expected population means.</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_sds">sds</code></td>
<td>
<p>A vector of expected population standard deviations
Note, when standardized, this is a vector of 1s</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_h1">h1</code></td>
<td>
<p>A constraint matrix defining H1.</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_h2">h2</code></td>
<td>
<p>A constraint matrix defining H2.</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_scale">scale</code></td>
<td>
<p>A number specifying the prior scale.</p>
</td></tr>
<tr><td><code id="samp_bf_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of samples for the fit and complexity
See <code>?BayesianPower::calc_fc</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of Bayes factors BF12 for each of the simulated datasets
</p>

<hr>
<h2 id='samp_dist'>Sample from prior or posterior distribution</h2><span id='topic+samp_dist'></span>

<h3>Description</h3>

<p>Sample from prior or posterior distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>samp_dist(nsamp, means, sds)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="samp_dist_+3A_nsamp">nsamp</code></td>
<td>
<p>A number. The number of prior or posterior samples to determine the
fit and complexity</p>
</td></tr>
<tr><td><code id="samp_dist_+3A_means">means</code></td>
<td>
<p>A vector. The prior or posterior means for each group</p>
</td></tr>
<tr><td><code id="samp_dist_+3A_sds">sds</code></td>
<td>
<p>A number or a vector. The standard deviations for each group
If a number is used, the same prior or posterior standard deviation is
used for each group.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of <code>nsamp</code> rows and as many columns as the
length of <code>means</code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
