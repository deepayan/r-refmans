<!DOCTYPE html><html><head><title>Help for package XNomial</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {XNomial}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#xmonte'><p>Perform Multinomial Goodness-Of-Fit Test By Monte-Carlo Simulations</p></a></li>
<li><a href='#xmulti'><p>Perform Multinomial Goodness-Of-Fit Test By Full Enumeration</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Exact Goodness-of-Fit Test for Multinomial Data with Fixed
Probabilities</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-12-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Bill Engels &lt;wrengels@wisc.edu&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bill Engels &lt;wrengels@wisc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tests whether a set of counts fit a given expected ratio. For
    example, a genetic cross might be expected to produce four types in the
    relative frequencies of 9:3:3:1. To see whether a set of observed counts
    fits this expectation, one can examine all possible outcomes with xmulti() or a
    random sample of them with xmonte() and find the probability of an observation
    deviating from the expectation by at least as much as the observed. As a
    measure of deviation from the expected, one can use the log-likelihood
    ratio, the multinomial probability, or the classic chi-square statistic. A
    histogram of the test statistic can also be plotted and compared with the
    asymptotic curve.</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.14)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-12-23 23:08:28 UTC; WRE</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-12-24 08:19:02</td>
</tr>
</table>
<hr>
<h2 id='xmonte'>Perform Multinomial Goodness-Of-Fit Test By Monte-Carlo Simulations</h2><span id='topic+xmonte'></span>

<h3>Description</h3>

<p>Use <code>xmonte</code> to compute a P value to test whether a set of counts fits a specific multinomial distribution. It does this by examining a large number of random outcomes and finding the probability of those cases which deviate from the expectation by at least as much as the observed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xmonte(obs, expr, ntrials = 1e+05, statName = "LLR", histobins = F,
  histobounds = c(0, 0), showCurve = T, detail = 1, safety = 1e+08)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xmonte_+3A_obs">obs</code></td>
<td>
<p>vector containing the observed numbers. All are non-negative integers summing to <code>&gt; 0</code>.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_expr">expr</code></td>
<td>
<p>vector containing expectation. The length should be the same as that of <code>obs</code> and they should be non-negative summing to <code>&gt; 0</code>. They need not be integers or sum to one.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_ntrials">ntrials</code></td>
<td>
<p>the number of random trials to look at, such as <code>ntrials=100000</code></p>
</td></tr>
<tr><td><code id="xmonte_+3A_statname">statName</code></td>
<td>
<p>name of the test statistic to use as a measure of how deviant an observation is from the expectation. The choices are: &ldquo;LLR&rdquo; for the log-likelihood ratio, &ldquo;Prob&rdquo; for the probability, &ldquo;Chisq&rdquo; for the chisquare statistic.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_histobins">histobins</code></td>
<td>
<p>specifies histogram plot. If set to 0, <code>F</code> or <code>FALSE</code> no histogram is plotted. If set to 1 or <code>T</code> or <code>TRUE</code> a histogram with 500 bins will be plotted. If set to a number <code>&gt; 1</code> a histogram with that number of bins is plotted.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_histobounds">histobounds</code></td>
<td>
<p>vector of length 2 indicating the bounds for the histogram, if any. If unspecified, bounds will be determined to include about 99.9 percent of the distribution.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_showcurve">showCurve</code></td>
<td>
<p>should an asymptotic curve be drawn over the histogram?</p>
</td></tr>
<tr><td><code id="xmonte_+3A_detail">detail</code></td>
<td>
<p>how much detail should be reported concerning the P value. If 0, nothing is printed for cases where the function is used programmatically. Minimal information is printed if <code>detail</code> is set to 1, and additional information if it is set to 2.</p>
</td></tr>
<tr><td><code id="xmonte_+3A_safety">safety</code></td>
<td>
<p>a large number, such as one billion, to set a limit on how many samples will be examined. This limit is there to avoid long computations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>xmonte</code> returns a list with the following components:
</p>
<table>
<tr><td><code>$ obs</code></td>
<td>
<p>the observed numbers used as imput</p>
</td></tr>
<tr><td><code>$ expr</code></td>
<td>
<p>expected ratios, arbitrary scale</p>
</td></tr>
<tr><td><code>$ ntrials</code></td>
<td>
<p>the number of random tables examined</p>
</td></tr>
<tr><td><code>$ statType</code></td>
<td>
<p>which test statistic was used</p>
</td></tr>
<tr><td><code>$ pLLR/pProb/pChi</code></td>
<td>
<p>the P value computed for the given test statistic</p>
</td></tr>
<tr><td><code>$ standard.error</code></td>
<td>
<p>the binomial standard error of the estimated P value</p>
</td></tr>
<tr><td><code>$ observedLLR</code></td>
<td>
<p>the value of LLR statistic for these data</p>
</td></tr>
<tr><td><code>$ observedProb</code></td>
<td>
<p>the multinomial probability of the observed data under the null hypothesis</p>
</td></tr>
<tr><td><code>$ observedChi</code></td>
<td>
<p>observed value of the chi square statistic</p>
</td></tr>
<tr><td><code>$ histobins</code></td>
<td>
<p>number of bins in the histogram (suppressed if zero)</p>
</td></tr>
<tr><td><code>$ histobounds</code></td>
<td>
<p>range in histogram (suppressed if not used)</p>
</td></tr>
<tr><td><code>$ histoData</code></td>
<td>
<p>data for histogram (suppressed if not used) Length is <code>histobins</code></p>
</td></tr>
<tr><td><code>$ asymptotoc.p.value</code></td>
<td>
<p>the P value obtained from the classical asymptotic test &ndash; use for comparison only</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#One of Gregor Mendel's crosses produced four types of pea seeds in the numbers as follows:
peas &lt;- c(315, 108, 101, 32)
#and he expected them to appear in the ratio of 9:3:3:1 according to his genetic model.
expected &lt;- c(9, 3, 3, 1)
#Test Mendels theory using
xmonte(peas, expected)
#To see a histogram of the likelihood ratio statistic, use:
xmonte(peas, expected, histobins = TRUE)
#The red areas of the histogram represent those outcomes deviating from the expected 9:3:3:1 ratio 
#at least as much as the observed numbers. (Much has been made of the tendency for Mendel's data 
#to fit the expectations better than expected!)
#If you wish to use the standard chisquare statistic as a measure of goodness-of-fit instead 
#of the LLR, use:
xmonte(peas, expected, statName="Chisq", histobins=TRUE)
</code></pre>

<hr>
<h2 id='xmulti'>Perform Multinomial Goodness-Of-Fit Test By Full Enumeration</h2><span id='topic+xmulti'></span>

<h3>Description</h3>

<p>Use <code>xmulti</code> to compute a P value to test whether a set of counts fits a specific multinomial distribution. It does this by examining all possible outcomes with the same total count and determining the total (multinomial) probability of those cases which deviate from the expectation by at least as much as the observed. Please see the vignette for more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xmulti(obs, expr, statName = "LLR", histobins = F, histobounds = c(0, 0),
  showCurve = T, detail = 1, safety = 1e+09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xmulti_+3A_obs">obs</code></td>
<td>
<p>vector containing the observed numbers. All are non-negative integers summing to <code>&gt; 0</code>.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_expr">expr</code></td>
<td>
<p>vector containing expectation. The length should be the same as that of <code>obs</code> and they should be non-negative summing to <code>&gt; 0</code>. They need not be integers or sum to one.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_statname">statName</code></td>
<td>
<p>name of the test statistic to use as a measure of how deviant an observation is from the expectation. The choices are: &ldquo;LLR&rdquo; for the log-likelihood ratio, &ldquo;Prob&rdquo; for the probability, &ldquo;Chisq&rdquo; for the chisquare statistic.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_histobins">histobins</code></td>
<td>
<p>specifies histogram plot. If set to 0, <code>F</code> or <code>FALSE</code> no histogram is plotted. If set to 1 or <code>T</code> or <code>TRUE</code> a histogram with 500 bins will be plotted. If set to a number <code>&gt; 1</code> a histogram with that number of bins is plotted.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_histobounds">histobounds</code></td>
<td>
<p>vector of length 2 indicating the bounds for the histogram, if any. If unspecified, bounds will be determined to include about 99.9 percent of the distribution.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_showcurve">showCurve</code></td>
<td>
<p>should an asymptotic curve be drawn over the histogram?</p>
</td></tr>
<tr><td><code id="xmulti_+3A_detail">detail</code></td>
<td>
<p>how much detail should be reported concerning the P value. If 0, nothing is printed for cases where the function is used programmatically. Minimal information is printed if <code>detail</code> is set to 1, and additional information if it is set to 2.</p>
</td></tr>
<tr><td><code id="xmulti_+3A_safety">safety</code></td>
<td>
<p>a large number, such as one billion, to set a limit on how many samples will be examined. This limit is there to avoid long computations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>xmulti</code> returns a list with the following components:
</p>
<table>
<tr><td><code>$ obs</code></td>
<td>
<p>the observed numbers used as imput</p>
</td></tr>
<tr><td><code>$ expr</code></td>
<td>
<p>expected ratios</p>
</td></tr>
<tr><td><code>$ statType</code></td>
<td>
<p>which test statistic was used</p>
</td></tr>
<tr><td><code>$ pLLR</code></td>
<td>
<p>the P value with LLR as the test statistic</p>
</td></tr>
<tr><td><code>$ pProb</code></td>
<td>
<p>the P value with the multinomial probability as test statistic</p>
</td></tr>
<tr><td><code>$ pChi</code></td>
<td>
<p>the P value with the chisquare as test statistic</p>
</td></tr>
<tr><td><code>$ observedLLR</code></td>
<td>
<p>the value of LLR statistic for these data</p>
</td></tr>
<tr><td><code>$ observedProb</code></td>
<td>
<p>the multinomial probability of the observed data under the null hypothesis</p>
</td></tr>
<tr><td><code>$ observedChi</code></td>
<td>
<p>observed value of the chi square statistic</p>
</td></tr>
<tr><td><code>$ histobins</code></td>
<td>
<p>number of bins in the histogram (suppressed if zero)</p>
</td></tr>
<tr><td><code>$ histobounds</code></td>
<td>
<p>range in histogram (suppressed if not used)</p>
</td></tr>
<tr><td><code>$ histoData</code></td>
<td>
<p>data for histogram (suppressed if not used) Length is <code>histobins</code></p>
</td></tr>
<tr><td><code>$ asymptotoc.p.value</code></td>
<td>
<p>the P value obtained from the classical asymptotic test</p>
</td></tr>
<tr><td><code>$ cases.examined</code></td>
<td>
<p>the total number of possible tables</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#
#One of Gregor Mendel's crosses produced four types of pea seeds in the numbers:
#
peas &lt;- c(315, 108, 101, 32)
#
#and he expected them to appear in the ratio of 9:3:3:1 according to his genetic model.
#
expected &lt;- c(9, 3, 3, 1)
#
#Test Mendel's theory using
#
xmulti(peas, expected)
#
#In this example, the number of cases examined was 28956759,
#and it probably took your computer less than half a second.
#To see a histogram of the likelihood ratio statistic, use:
#
xmulti(peas, expected, histobins = TRUE)
#
#The red areas of the histogram represent those outcomes deviating from the expected 9:3:3:1 ratio 
#at least as much as the observed numbers. (Much has been made of the tendency for Mendel's data 
#to fit the expectations better than expected!)
#If you wish to use the standard chisquare statistic as a measure of goodness-of-fit instead 
#of the LLR, use:
#
xmulti(peas, expected, statName="Chisq", histobins=TRUE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
