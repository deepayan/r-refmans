<!DOCTYPE html><html><head><title>Help for package tidypmc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidypmc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#collapse_rows'><p>Collapse a list of PubMed Central tables</p></a></li>
<li><a href='#pmc_caption'><p>Split captions into sentences</p></a></li>
<li><a href='#pmc_metadata'><p>Get article metadata</p></a></li>
<li><a href='#pmc_reference'><p>Format references cited</p></a></li>
<li><a href='#pmc_table'><p>Convert table nodes to tibbles</p></a></li>
<li><a href='#pmc_text'><p>Split section paragraphs into sentences</p></a></li>
<li><a href='#pmc_xml'><p>Download XML from PubMed Central</p></a></li>
<li><a href='#separate_genes'><p>Separate genes and operons into multiple rows</p></a></li>
<li><a href='#separate_refs'><p>Separate references cited into multiple rows</p></a></li>
<li><a href='#separate_tags'><p>Separate locus tag into multiple rows</p></a></li>
<li><a href='#separate_text'><p>Separate all matching text into multiple rows</p></a></li>
<li><a href='#tidypmc'><p><code>tidypmc</code> package</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Parse Full Text XML Documents from PubMed Central</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Parse XML documents from the Open Access subset of Europe PubMed Central <a href="https://europepmc.org">https://europepmc.org</a>
    including section paragraphs, tables, captions and references.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cstubben/tidypmc">https://github.com/cstubben/tidypmc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/tidypmc/issues">https://github.com/ropensci/tidypmc/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>xml2, tokenizers, stringr, tibble, dplyr, readr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>europepmc, tidytext, rmarkdown, knitr, testthat, covr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-07-29 17:41:47 UTC; chrisstubben</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris Stubben [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris Stubben &lt;chris.stubben@hci.utah.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-01 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='collapse_rows'>Collapse a list of PubMed Central tables</h2><span id='topic+collapse_rows'></span>

<h3>Description</h3>

<p>Collapse rows into a semi-colon delimited list with column names and cell
values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collapse_rows(pmc, na.string)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapse_rows_+3A_pmc">pmc</code></td>
<td>
<p>a list of tables, usually from <code><a href="#topic+pmc_table">pmc_table</a></code></p>
</td></tr>
<tr><td><code id="collapse_rows_+3A_na.string">na.string</code></td>
<td>
<p>additional cell values to skip, default is NA and &quot;&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with table and row number and collapsed text
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(
  genes = c("aroB", "glnP", "ndhA", "pyrF"),
  fold_change = c(2.5, 1.7, -3.1, -2.6)
)
collapse_rows(list(`Table 1` = x))
</code></pre>

<hr>
<h2 id='pmc_caption'>Split captions into sentences</h2><span id='topic+pmc_caption'></span>

<h3>Description</h3>

<p>Split figure, table and supplementary material captions into sentences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_caption(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_caption_+3A_doc">doc</code></td>
<td>
<p><code>xml_document</code> from PubMed Central</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with tag, label, sentence number and text
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364") # OR
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
  package = "tidypmc"
))
x &lt;- pmc_caption(doc)
x
dplyr::filter(x, sentence == 1)
</code></pre>

<hr>
<h2 id='pmc_metadata'>Get article metadata</h2><span id='topic+pmc_metadata'></span>

<h3>Description</h3>

<p>Get a list of journal and article metadata in /front tag
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_metadata(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_metadata_+3A_doc">doc</code></td>
<td>
<p><code>xml_document</code> from PubMed Central</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364") # OR
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
  package = "tidypmc"
))
pmc_metadata(doc)
</code></pre>

<hr>
<h2 id='pmc_reference'>Format references cited</h2><span id='topic+pmc_reference'></span>

<h3>Description</h3>

<p>Format references cited
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_reference(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_reference_+3A_doc">doc</code></td>
<td>
<p><code>xml_document</code> from PubMed Central</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with id, pmid, authors, year, title, journal, volume, pages,
and doi.
</p>


<h3>Note</h3>

<p>Mixed citations without any child tags are added to the author column.
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364")
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
  package = "tidypmc"
))
x &lt;- pmc_reference(doc)
x
</code></pre>

<hr>
<h2 id='pmc_table'>Convert table nodes to tibbles</h2><span id='topic+pmc_table'></span>

<h3>Description</h3>

<p>Convert PubMed Central table nodes into a list of tibbles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_table(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_table_+3A_doc">doc</code></td>
<td>
<p><code>xml_document</code> from PubMed Central</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of tibbles
</p>


<h3>Note</h3>

<p>Saves the caption and footnotes as attributes and collapses multiline
headers, expands all rowspan and colspan attributes and adds
subheadings to column one.
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364")
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
  package = "tidypmc"
))
x &lt;- pmc_table(doc)
sapply(x, dim)
x
attributes(x[[1]])
</code></pre>

<hr>
<h2 id='pmc_text'>Split section paragraphs into sentences</h2><span id='topic+pmc_text'></span>

<h3>Description</h3>

<p>Split section paragraph tags into a table with subsection titles and
sentences using <code>tokenize_sentences</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_text(doc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_text_+3A_doc">doc</code></td>
<td>
<p><code>xml_document</code> from PubMed Central</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with section, paragraph and sentence number and text
</p>


<h3>Note</h3>

<p>Subsections may be nested to arbitrary depths and this function will
return the entire path to the subsection title as a delimited string like
&quot;Results; Predicted functions; Pathogenicity&quot;.  Tables, figures and
formulas that are nested in section paragraphs are removed, superscripted
references are replaced with brackets, and any other superscripts or
subscripts are separared with ^ and _.
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364")
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
  package = "tidypmc"
))
txt &lt;- pmc_text(doc)
txt
dplyr::count(txt, section, sort = TRUE)
</code></pre>

<hr>
<h2 id='pmc_xml'>Download XML from PubMed Central</h2><span id='topic+pmc_xml'></span>

<h3>Description</h3>

<p>Download XML from PubMed Central
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_xml(id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_xml_+3A_id">id</code></td>
<td>
<p>a PMC id starting with 'PMC'</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>xml_document</code>
</p>


<h3>Source</h3>

<p><a href="https://europepmc.org/RestfulWebService">https://europepmc.org/RestfulWebService</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
doc &lt;- pmc_xml("PMC2231364")

## End(Not run)

</code></pre>

<hr>
<h2 id='separate_genes'>Separate genes and operons into multiple rows</h2><span id='topic+separate_genes'></span>

<h3>Description</h3>

<p>Separate genes and operons mentioned in full text into multiple rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>separate_genes(txt, pattern = "\\b[A-Za-z][a-z]{2}[A-Z0-9]+\\b",
  genes, operon = 6, column = "text")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="separate_genes_+3A_txt">txt</code></td>
<td>
<p>a table</p>
</td></tr>
<tr><td><code id="separate_genes_+3A_pattern">pattern</code></td>
<td>
<p>regular expression to match genes, default is to match
microbial genes like AbcD, default [A-Za-z][a-z]2[A-Z0-9]+</p>
</td></tr>
<tr><td><code id="separate_genes_+3A_genes">genes</code></td>
<td>
<p>an optional vector of genes, set pattern to NA to only match
this list.</p>
</td></tr>
<tr><td><code id="separate_genes_+3A_operon">operon</code></td>
<td>
<p>operon length, default 6. Split genes with 6 or more letters
into separate genes, for example AbcDEF is split into abcD, abcE and abcF.</p>
</td></tr>
<tr><td><code id="separate_genes_+3A_column">column</code></td>
<td>
<p>column name to search, default &quot;text&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with gene name, matching text and rows.
</p>


<h3>Note</h3>

<p>Check for genes in italics using <code>xml_text(xml_find_all(doc,
"//sec//p//italic"))</code> and update the pattern or add additional genes as an
optional vector if needed
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(row = 1, text = "Genes like YacK, hmu and sufABC")
separate_genes(x)
separate_genes(x, genes = "hmu")
</code></pre>

<hr>
<h2 id='separate_refs'>Separate references cited into multiple rows</h2><span id='topic+separate_refs'></span>

<h3>Description</h3>

<p>Separates references cited in brackets or parentheses into multiple rows and
splits the comma-delimited numeric strings and expands ranges like 7-9 into
new rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>separate_refs(txt, column = "text")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="separate_refs_+3A_txt">txt</code></td>
<td>
<p>a table</p>
</td></tr>
<tr><td><code id="separate_refs_+3A_column">column</code></td>
<td>
<p>column name, default &quot;text&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(row = 1, text = "some important studies [7-9,15]")
separate_refs(x)
</code></pre>

<hr>
<h2 id='separate_tags'>Separate locus tag into multiple rows</h2><span id='topic+separate_tags'></span>

<h3>Description</h3>

<p>Separates locus tags mentioned in full text and expands ranges like
YPO1970-74 into new rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>separate_tags(txt, pattern, column = "text")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="separate_tags_+3A_txt">txt</code></td>
<td>
<p>a table</p>
</td></tr>
<tr><td><code id="separate_tags_+3A_pattern">pattern</code></td>
<td>
<p>regular expression to match locus tags like YPO[0-9-]+ or
the locus tag prefix like YPO.</p>
</td></tr>
<tr><td><code id="separate_tags_+3A_column">column</code></td>
<td>
<p>column name to search, default &quot;text&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with locus tag, matching text and rows.
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- data.frame(row = 1, text = "some genes like YPO1002 and YPO1970-74")
separate_tags(x, "YPO")
</code></pre>

<hr>
<h2 id='separate_text'>Separate all matching text into multiple rows</h2><span id='topic+separate_text'></span>

<h3>Description</h3>

<p>Separate all matching text into multiple rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>separate_text(txt, pattern, column = "text")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="separate_text_+3A_txt">txt</code></td>
<td>
<p>a tibble, usually results from <code>pmc_text</code></p>
</td></tr>
<tr><td><code id="separate_text_+3A_pattern">pattern</code></td>
<td>
<p>either a regular expression or a vector of words to find in
text</p>
</td></tr>
<tr><td><code id="separate_text_+3A_column">column</code></td>
<td>
<p>column name, default &quot;text&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble
</p>


<h3>Note</h3>

<p>passed to <code>grepl</code> and <code>str_extract_all</code>
</p>


<h3>Author(s)</h3>

<p>Chris Stubben
</p>


<h3>Examples</h3>

<pre><code class='language-R'># doc &lt;- pmc_xml("PMC2231364")
doc &lt;- xml2::read_xml(system.file("extdata/PMC2231364.xml",
        package = "tidypmc"))
txt &lt;- pmc_text(doc)
separate_text(txt, "[ATCGN]{5,}")
separate_text(txt, "\\([A-Z]{3,6}s?\\)")
# pattern can be a vector of words
separate_text(txt, c("hmu", "ybt", "yfe", "yfu"))
# wrappers for separate_text with extra step to expand matched ranges
separate_refs(txt)
separate_genes(txt)
separate_tags(txt, "YPO")

</code></pre>

<hr>
<h2 id='tidypmc'><code>tidypmc</code> package</h2><span id='topic+tidypmc'></span><span id='topic+tidypmc-package'></span>

<h3>Description</h3>

<p>Parse full text XML documents from PubMed Central
</p>


<h3>Details</h3>

<p>See the Github page for details at <a href="https://github.com/ropensci/tidypmc">https://github.com/ropensci/tidypmc</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
