<!DOCTYPE html><html><head><title>Help for package PCovR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PCovR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alexithymia'>
<p>Effect of alexithymia on depression and self-esteem</p></a></li>
<li><a href='#ErrorRatio'>
<p>Error variance ratio</p></a></li>
<li><a href='#pcovr'><p>Full Principal covariates regression analysis of a specific data set</p></a></li>
<li><a href='#pcovr_est'><p>Estimation of Principal Covariates Regression parameters, given a prespecified weighting value and number of components</p></a></li>
<li><a href='#PCovR-package'><p>Principal Covariates Regression</p></a></li>
<li><a href='#promin'><p>Promin rotation</p></a></li>
<li><a href='#psychiatrists'>
<p>Effect of psychiatric symptoms on toxicomania, schizophrenia, depression and anxiety disorder</p></a></li>
<li><a href='#SortLoadings'><p>Sorting a component loading matrix</p></a></li>
<li><a href='#tarrotob'><p>Oblique target rotation</p></a></li>
<li><a href='#wvarim'><p>Weighted varimax</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Principal Covariates Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>GPArotation, ThreeWay, MASS, stats, graphics, Matrix</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzing regression data with many and/or highly collinear predictor variables, by simultaneously reducing the predictor variables to a limited number of components and regressing the criterion variables on these components (de Jong S. &amp; Kiers H. A. L. (1992) &lt;<a href="https://doi.org/10.1016%2F0169-7439%2892%2980100-I">doi:10.1016/0169-7439(92)80100-I</a>&gt;). Several rotation and model selection options are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Marlies Vervloet [aut, cre],
  Henk Kiers [aut],
  Eva Ceulemans [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kristof Meers &lt;kristof.meers+cran@kuleuven.be&gt;</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-25 15:00:45 UTC; u0046811</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-26 07:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='alexithymia'>
Effect of alexithymia on depression and self-esteem
</h2><span id='topic+alexithymia'></span>

<h3>Description</h3>

<p>The data contain the scores of 122 Belgian psychology students on the 20-item Toronto Alexithymia Scale (TAS-20; Bagby, Parker, &amp; Taylor, 1994), which measures the inability to recognize and verbalize emotions, the Center for Epidemiological Studies Depression Scale (CES-D; Radloff, 1977), and the Rosenberg Self-Esteem Scale (RSE; Rosenberg, 1989). These data can be used to examine the extent to which the degree of depressive symptomatology (measured by the total CES-D score), and the degree of self-esteem (measured by the total RSE-score), can be predicted by the separate items of the TAS-20. We investigate the individual items because Bankier, Aigner and Bach (2001) emphasize that alexithymia is a multidimensional construct and authors disagree about the number and nature of the dimensions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(alexithymia)</code></pre>


<h3>Format</h3>

<p>List of 2
</p>


<h4>$ X:'data.frame':  122 obs. of  20 variables:</h4>


<dl>
<dt><code>confused</code></dt><dd><p>I am often confused about what emotion I am feeling</p>
</dd>
<dt><code>right words</code></dt><dd><p>It is difficult for me to find the right words for my feelings</p>
</dd>
<dt><code>sensations</code></dt><dd><p>I have physical sensations that even doctors don't understand</p>
</dd>
<dt><code>describe</code></dt><dd><p>I am able to describe my feelings easily</p>
</dd>
<dt><code>analyze problems</code></dt><dd><p>I prefer to analyze problems rather than just describe them</p>
</dd>
<dt><code>upset</code></dt><dd><p>When I am upset, I don't know if I am sad, frightened, or angry</p>
</dd>
<dt><code>puzzled</code></dt><dd><p>I am often puzzled by sensations in my body</p>
</dd>
<dt><code>let happen</code></dt><dd><p>I prefer to just let things happen rather than to understand why they turned out that way</p>
</dd>
<dt><code>let happen</code></dt><dd><p>I have feelings that I can't quite identify</p>
</dd>
<dt><code>essential</code></dt><dd><p>Being in touch with emotions is essential</p>
</dd>
<dt><code>feel about people</code></dt><dd><p>I find it hard to describe how I feel about people</p>
</dd>
<dt><code>describe more</code></dt><dd><p>People tell me to describe my feelings more</p>
</dd>
<dt><code>going on</code></dt><dd><p>I don't know what's going on inside me</p>
</dd>
<dt><code>why angry</code></dt><dd><p>I often don't know why I am angry</p>
</dd>
<dt><code>daily activities</code></dt><dd><p>I prefer talking to people about their daily activities rather than their feelings</p>
</dd>
<dt><code>entertainment</code></dt><dd><p>I prefer to watch &quot;light&quot; entertainment shows rather than psychological dramas</p>
</dd>
<dt><code>reveal feelings</code></dt><dd><p>It is difficult for me to reveal my innermost feelings, even to close friends</p>
</dd>
<dt><code>close</code></dt><dd><p>I can feel close  to someone, even in moments of silence</p>
</dd>
<dt><code>useful</code></dt><dd><p>I find examination of my feelings useful in solving personal problems</p>
</dd>
<dt><code>hidden meanings</code></dt><dd><p>Looking for hidden meanings in movies or plays distracts from their enjoyment</p>
</dd>
</dl>



<h4>$ Y:'data.frame':  122 obs. of  2 variables:</h4>


<dl>
<dt><code>CES-D</code></dt><dd><p>Degree of depressive symptomatology</p>
</dd>
<dt><code>RSE</code></dt><dd><p>Degree of self-esteem</p>
</dd>
</dl>



<h3>References</h3>

<p><cite>Bagby, R. M., Parker, J. D., &amp; Taylor, G. J. (1994). The twenty-item Toronto Alexithymia Scale: Item selection and cross-validation of the factor structure. Journal of Psychosomatic Research , 38 (1), 23-32.</cite>
</p>
<p><cite>Bankier, B., Aigner, M., &amp; Bach, M. (2001). Alexithymia in DSM-IV Disorder: Comparative Evaluation of Somatoform Disorder, Panic Disorder, Obsessive-Compulsive Disorder, and Depression. Psychosomatics , 42 (3), 235-240.</cite>
</p>
<p><cite>Radloff, R. S. (1977). The CES-D scale: A self-report depression scale for research in the general population. Applied psychological measurement , 1 (3), 385-401.</cite>
</p>
<p><cite>Rosenberg, M. (1989). Society and the adolescent self-image. Middletown: Wesleyan University Press.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alexithymia)
str(alexithymia)
</code></pre>

<hr>
<h2 id='ErrorRatio'>
Error variance ratio
</h2><span id='topic+ErrorRatio'></span>

<h3>Description</h3>

<p>Estimating the ratio of the error variance of the predictor block, versus the error variance of the criterion block.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ErrorRatio(X, Y, Rmin = 1, Rmax = ncol(X)/3, prepX="stand",prepY="stand")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ErrorRatio_+3A_x">X</code></td>
<td>
<p>Dataframe containing predictor scores</p>
</td></tr>
<tr><td><code id="ErrorRatio_+3A_y">Y</code></td>
<td>
<p>Dataframe containing criterion scores</p>
</td></tr>
<tr><td><code id="ErrorRatio_+3A_rmin">Rmin</code></td>
<td>
<p>Lowest number of components considered</p>
</td></tr>
<tr><td><code id="ErrorRatio_+3A_rmax">Rmax</code></td>
<td>
<p>Highest number of components considered</p>
</td></tr>
<tr><td><code id="ErrorRatio_+3A_prepx">prepX</code></td>
<td>
<p>Preprocessing of predictor scores: standardizing (<kbd>stand</kbd>) or centering data (<kbd>cent</kbd>)</p>
</td></tr>
<tr><td><code id="ErrorRatio_+3A_prepy">prepY</code></td>
<td>
<p>Preprocessing of criterion scores: standardizing (<kbd>stand</kbd>) or centering data (<kbd>cent</kbd>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An estimate for the error variance of <kbd>X</kbd> can be obtained by applying principal component analysis to <kbd>X</kbd> and determining the optimal number of components through a scree test; the estimate equals the associated percentage of unexplained variance. The estimate for the error variance of <kbd>Y</kbd> boils down to the percentage of unexplained variance when <kbd>Y</kbd> is regressed on <kbd>X</kbd>.  This approach for estimating  and  was based on the work of Wilderjans, Ceulemans, Van Mechelen, and Van den Berg (2011).
</p>


<h3>Value</h3>

<p>The returned value is the estimated error variance of <kbd>X</kbd>, divided by the estimated error variance of <kbd>Y</kbd>.
</p>


<h3>Author(s)</h3>

<p>Marlies Vervloet
</p>


<h3>References</h3>

<p><cite>Wilderjans, T. F., Ceulemans, E., Van Mechelen, I., &amp; Van den Berg, R. A. (2011). Simultaneous analysis of coupled data matrices subject to different amounts of noise. British Journal of Mathematical and Statistical Psychology , 64, 277-290.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(psychiatrists)
ratio &lt;- ErrorRatio(psychiatrists$X,psychiatrists$Y)
</code></pre>

<hr>
<h2 id='pcovr'>Full Principal covariates regression analysis of a specific data set
</h2><span id='topic+pcovr.default'></span><span id='topic+pcovr'></span><span id='topic+plot.pcovr'></span><span id='topic+print.pcovr'></span><span id='topic+summary.pcovr'></span>

<h3>Description</h3>

<p>Application of a PCovR analysis consists of the following steps: preprocessing the data, running PCovR analyses with different numbers of components and/or weighting parameter values, performing model selection, and rotating the retained solution for easier interpretation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcovr(X,Y,modsel="seq",Rmin=1,Rmax=ncol(X)/3,R=NULL,weight=NULL,rot="varimax", 
target=NULL, prepX="stand",prepY="stand", ratio="estimation", fold="LeaveOneOut",
zeroloads=ncol(X))

## S3 method for class 'pcovr'
plot(x,cpal=NULL,lpal=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcovr_+3A_x">X</code></td>
<td>
<p>Dataframe containing predictor scores</p>
</td></tr>
<tr><td><code id="pcovr_+3A_y">Y</code></td>
<td>
<p>Dataframe containing criterion scores</p>
</td></tr>
<tr><td><code id="pcovr_+3A_modsel">modsel</code></td>
<td>
<p>Model selection procedure (<kbd>seq</kbd>, <kbd>seqRcv</kbd>, <kbd>seqAcv</kbd> or <kbd>sim</kbd>)
</p>
</td></tr>
<tr><td><code id="pcovr_+3A_rmin">Rmin</code></td>
<td>
<p>Lowest number of components considered </p>
</td></tr>
<tr><td><code id="pcovr_+3A_rmax">Rmax</code></td>
<td>
<p>Highest number of components considered</p>
</td></tr>
<tr><td><code id="pcovr_+3A_r">R</code></td>
<td>
<p>Number of components (overrules <kbd>Rmin</kbd> and <kbd>Rmax</kbd>)</p>
</td></tr>
<tr><td><code id="pcovr_+3A_weight">weight</code></td>
<td>
<p>Weighting values considered</p>
</td></tr>
<tr><td><code id="pcovr_+3A_rot">rot</code></td>
<td>
<p>Rotation criterion (<kbd>varimax</kbd>, <kbd>quartimin</kbd>, <kbd>targetT</kbd>, <kbd>targetQ</kbd>, <code><a href="#topic+wvarim">wvarim</a></code> or <code><a href="#topic+promin">promin</a></code>)</p>
</td></tr>
<tr><td><code id="pcovr_+3A_target">target</code></td>
<td>
<p>Target matrix for target rotation (components x predictor variables)</p>
</td></tr>
<tr><td><code id="pcovr_+3A_prepx">prepX</code></td>
<td>
<p>Preprocessing of predictor scores: standardizing (<kbd>stand</kbd>) or centering data (<kbd>cent</kbd>)</p>
</td></tr>
<tr><td><code id="pcovr_+3A_prepy">prepY</code></td>
<td>
<p>Preprocessing of criterion scores: standardizing (<kbd>stand</kbd>) or centering data (<kbd>cent</kbd>)</p>
</td></tr>
<tr><td><code id="pcovr_+3A_ratio">ratio</code></td>
<td>
<p>Ratio of the estimated error variances of the predictor block and the criterion block</p>
</td></tr>
<tr><td><code id="pcovr_+3A_fold">fold</code></td>
<td>
<p>Value of <em>k</em> when performing <em>k</em>-fold cross-validation. By default, leave-one-out cross-validation is performed.</p>
</td></tr>
<tr><td><code id="pcovr_+3A_zeroloads">zeroloads</code></td>
<td>
<p>Number of near-zero loadings of the target for <kbd>simplimax</kbd> rotation</p>
</td></tr>
<tr><td><code id="pcovr_+3A_x">x</code></td>
<td>
<p>An object of the type produced by <kbd>pcovr</kbd></p>
</td></tr>
<tr><td><code id="pcovr_+3A_cpal">cpal</code></td>
<td>
<p>Vector of <code><a href="grDevices.html#topic+colors">colors</a></code> used for model selection plots</p>
</td></tr>
<tr><td><code id="pcovr_+3A_lpal">lpal</code></td>
<td>
<p>Vector of line types used for model selection plots</p>
</td></tr>
<tr><td><code id="pcovr_+3A_...">...</code></td>
<td>
<p>Further graphical arguments</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Preprocessing</h4>

<p>The PCovR package includes two preprocessing options, which can be applied to <kbd>X</kbd> and/or <kbd>Y</kbd>. Specifically, it is possible to only center the data (<kbd>prepX="cent"</kbd>, <kbd>prepY="cent"</kbd>). However, the default option is to standardize the data (<kbd>prepX="stand"</kbd>, <kbd>prepY="stand"</kbd>), which implies that <kbd>X</kbd> and/or <kbd>Y</kbd> are centered and normalized (i.e., each variable has a mean of zero and a standard deviation of one).</p>



<h4>Model selection</h4>



<h5>Sequential procedure</h5>

<p>The fastest and therefore default model selection setting (<kbd>modsel="seq"</kbd>) implies a sequential procedure in which the weighting value is determined on the basis of maximum likelihood principles (Vervloet, Van den Noortgate, Van Deun, &amp; Ceulemans, 2013), but taking the  weighting values entered by the user (i.e., specified with the parameter <kbd>weight</kbd>) into account. Specifically, if the weighting value does not equal one of those values, the entered weighting value that is closest to the maximum likelihood weighting value (in absolute sense) is used. Note that the default error variance ratio is estimated with the function <code><a href="#topic+ErrorRatio">ErrorRatio</a></code>, but can be specified otherwise with the parameter <kbd>ratio</kbd>. However, this is only possible for datasets with more observations than predictor variables. Among all models with the selected weighting value and a number of components between <kbd>Rmin</kbd> and <kbd>Rmax</kbd>, the solution is picked that has the highest <em>st</em> value (Cattell, 1966; Wilderjans, Ceulemans, &amp; Meers, 2012). However, models for which the fit is less than 1% better than the fit of a less complex model are excluded. Note that the  assessment of the optimal number of components can be overruled, in case one is only interested in the solutions with a particular number of components. In particular, when specifying the input parameter <kbd>R</kbd>, <kbd>Rmin</kbd> and <kbd>Rmax</kbd> will be ignored, and the specified number of components will be used when running the analysis and determining the weighting value.
</p>
<p>The package also provides two sequential procedures that incorporate a cross-validation step (<kbd>modsel="seqRcv"</kbd> and <kbd>modsel="seqAcv"</kbd>). <kbd>seqRcv</kbd> also starts with the selection of the weighting value based on maximum likelihood principles, but in the next step, the number of components is determined using leave-one-out cross-validation. <kbd>seqAcv</kbd> is identical to the default procedure, but has an extra step: after the selection of the number of components, leave-one-out cross-validation is applied to choose the weighting value.</p>



<h5>Simultaneous procedure</h5>

<p>The simultaneous procedure (<kbd>modsel="sim"</kbd>) performs leave-one-out cross-validation for all considered weighting values (<kbd>weight</kbd>; by default, 100 values between .01 and 1) and all numbers of components between <kbd>Rmin</kbd> (default: 1) and <kbd>Rmax</kbd> (default: number of predictors divided by 3). The weighting parameter value and number of components that maximize the cross-validation fit are retained. Note that the parameter <kbd>fold</kbd> can be used to alter the number of roughly equal-sized parts in which the data are split for cross-validation (Hastie, Tibshirani, &amp; Friedman, 2001). The default value of <kbd>fold</kbd> is <kbd>"LeaveOneOut"</kbd>, implying that the data is split in <em>N</em> (number of observations) parts. </p>




<h4>Interpreting the component matrices</h4>

<p>The rotation criteria that are implemented in the PCovR package are <kbd>varimax</kbd>, <kbd>quartimin</kbd>, <kbd>targetT</kbd>, <kbd>targetQ</kbd>, <code><a href="#topic+wvarim">wvarim</a></code> and <code><a href="#topic+promin">promin</a></code>. One can also request the original solution by typing <kbd>rot="none"</kbd>. Target rotation (Browne, 1972) orthogonally rotates the loading matrix towards a target matrix (<kbd>target</kbd>) that is specified by the user. 
Note that Simplimax requires the specification of a number of zero elements. By default, <kbd>zeroloads</kbd> equals the number of predictors.   
</p>
<p>The interpretation of the obtained solution usually starts with the interpretation of the loading matrix. Specifically, the components are labeled by considering what the predictors that have the highest loadings (in absolute sense), have in common. Given these labels, the regression weights can be interpreted.</p>


<h3>Value</h3>

<p><code>pcovr</code> returns a list that contains the following objects (note that some objects can be empty, depending on the model selection settings used) :
</p>
<table>
<tr><td><code>Px</code></td>
<td>
<p>Loading matrix (components x predictor variables)</p>
</td></tr>
<tr><td><code>Py</code></td>
<td>
<p>Regression weights matrix (components x criterion variables)</p>
</td></tr>
<tr><td><code>Te</code></td>
<td>
<p>Component score matrix (observations x components)</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Component weights matrix (predictor variables x components)</p>
</td></tr>
<tr><td><code>Rx2</code></td>
<td>
<p>Proportion of explained variance in <span class="env">X</span></p>
</td></tr>
<tr><td><code>Ry2</code></td>
<td>
<p>Proportion of explained variance in <span class="env">Y</span></p>
</td></tr>
<tr><td><code>Qy2</code></td>
<td>
<p>Cross-validation fit as a function of weighting parameter and number of components (weighting parameter x number of components)</p>
</td></tr>
<tr><td><code>VAFsum</code></td>
<td>
<p>Weighted sum of the variance accounted for in <span class="env">X</span> and in <span class="env">Y</span> as a function of number of components (1 x number of components)</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Selected value of the weighting parameter</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Selected number of components</p>
</td></tr>
<tr><td><code>modsel</code></td>
<td>
<p>Model selection procedure that was used</p>
</td></tr>
<tr><td><code>rot</code></td>
<td>
<p>Rotation criterion that was used</p>
</td></tr>
<tr><td><code>prepX</code></td>
<td>
<p>Method of preprocessing that was used for the predictor scores</p>
</td></tr>
<tr><td><code>prepY</code></td>
<td>
<p>Method of preprocessing that was used for the criterion scores</p>
</td></tr>
<tr><td><code>Rvalues</code></td>
<td>
<p>Numbers of components that were considered</p>
</td></tr>
<tr><td><code>Alphavalues</code></td>
<td>
<p>Weighting parameter values that were considered</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>Browne, M. W. (1972). Oblique rotation to a partially specified target. British Journal of Mathematical and Statistical Psychology , 25 (2), 207-212.</cite>
</p>
<p><cite>Cattell, R. B. (1966). The scree test for the number of factors. Multivariate behavioral research , 1 (2), 245-276.</cite>
</p>
<p><cite>De Jong, S., &amp; Kiers, H. A. (1992). Principal covariates regression: Part I. Theory. Chemometrics and Intelligent Laboratory Systems , 155-164.</cite>
</p>
<p><cite>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2001). The elements of statistical learning: Data mining, inference and prediction. New York: Springer.</cite>
</p>
<p><cite>Vervloet, M., Van Deun, K., Van den Noortgate, W., &amp; Ceulemans, E. (2013). On the selection of the weighting parameter value in Principal Covariates Regression. Chemometrics and Intelligent Laboratory Systems.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>
<p><cite>Wilderjans, T. F., Ceulemans, E., &amp; Meers, K. (2012). CHull: A generic convex-hull-based model selection method. Behavior research methods .</cite></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alexithymia)
results &lt;- pcovr(alexithymia$X, alexithymia$Y)
summary(results)
plot(results)
</code></pre>

<hr>
<h2 id='pcovr_est'>Estimation of Principal Covariates Regression parameters, given a prespecified weighting value and number of components</h2><span id='topic+pcovr_est'></span>

<h3>Description</h3>

<p>Analyzing regression data with many and/or highly collinear predictor variables, by simultaneously reducing the predictor variables to a given number of components and regressing the criterion variables on these components. A weighting parameter value is specified that determines the extent to which both aspects influence the solution. Cross-validation (Hastie, Tibshirani &amp; Friedman, 2001) options are included.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcovr_est(X, Y, r, a, cross = FALSE, fold = "LeaveOneOut")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcovr_est_+3A_x">X</code></td>
<td>
<p>Matrix containing predictor scores (observations x predictors)</p>
</td></tr>
<tr><td><code id="pcovr_est_+3A_y">Y</code></td>
<td>
<p>Matrix containing criterion scores (observations x criteria)</p>
</td></tr>
<tr><td><code id="pcovr_est_+3A_r">r</code></td>
<td>
<p>The desired number of components</p>
</td></tr>
<tr><td><code id="pcovr_est_+3A_a">a</code></td>
<td>
<p>The desired weighting parameter value</p>
</td></tr>
<tr><td><code id="pcovr_est_+3A_cross">cross</code></td>
<td>
<p>Logical. If <kbd>TRUE</kbd> cross-validation is performed</p>
</td></tr>
<tr><td><code id="pcovr_est_+3A_fold">fold</code></td>
<td>
<p>Value of <em>k</em> when performing <em>k</em>-fold cross-validation. By default, leave-one-out cross-validation is performed.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>W</code></td>
<td>
<p>Component weights matrix (predictors x components)</p>
</td></tr>
<tr><td><code>B</code></td>
<td>
<p>Regression weights for predictors (predictors x criteria)</p>
</td></tr>
<tr><td><code>Rx2</code></td>
<td>
<p>Proportion of explained variance in <span class="env">X</span></p>
</td></tr>
<tr><td><code>Ry2</code></td>
<td>
<p>Proportion of explained variance in <span class="env">Y</span></p>
</td></tr>
<tr><td><code>Te</code></td>
<td>
<p>Component score matrix (observations x components)</p>
</td></tr>
<tr><td><code>Px</code></td>
<td>
<p>Loading matrix of components (components x predictors)</p>
</td></tr>
<tr><td><code>Py</code></td>
<td>
<p>Regression weights matrix (components x criteria)</p>
</td></tr>
<tr><td><code>Qy2</code></td>
<td>
<p>Cross-validation fit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>De Jong, S., &amp; Kiers, H. A. (1992). Principal covariates regression: Part I. Theory. Chemometrics and Intelligent Laboratory Systems , 155-164.</cite>
</p>
<p><cite>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2001). The elements of statistical learning: Data mining, inference and prediction. New York: Springer.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alexithymia)
X &lt;- data.matrix(alexithymia$X)
Y &lt;- data.matrix(alexithymia$Y)
results &lt;- pcovr_est(X, Y, r=2, a=.90)
str(results)
</code></pre>

<hr>
<h2 id='PCovR-package'>Principal Covariates Regression</h2><span id='topic+PCovR-package'></span><span id='topic+PCovR'></span>

<h3>Description</h3>

<p>Analyzing regression data with many and/or highly collinear predictor variables, by simultaneously reducing the predictor variables to a limited number of components and regressing the criterion variables on these components. Several rotation options are provided in this package, as well as model selection options.</p>


<h3>Details</h3>

<p>This package contains the function <code><a href="#topic+pcovr">pcovr</a></code>, which runs a full PCovR analysis of a data set and provides several preprocessing, model selection, and rotation options. This function calls the function <code><a href="#topic+pcovr_est">pcovr_est</a></code>, which estimates the PCovR parameters given a specific weigthing parameter value and a particular number of components. This function was originally written in MATLAB by De Jong &amp; Kiers (1992). Two illustrative data sets are included: <code><a href="#topic+alexithymia">alexithymia</a></code> and <code><a href="#topic+psychiatrists">psychiatrists</a></code>.
</p>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>S. de Jong, H.A.L. Kiers, Principal covariates regression: Part I. Theory, Chemom. intell. lab. syst 14 (1992) 155-164.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite></p>


<h3>See Also</h3>

<p><code><a href="#topic+pcovr">pcovr</a></code>
</p>
<p><code><a href="#topic+pcovr_est">pcovr_est</a></code>
</p>
<p><code><a href="#topic+alexithymia">alexithymia</a></code>
</p>
<p><code><a href="#topic+psychiatrists">psychiatrists</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(alexithymia)
results &lt;- pcovr(alexithymia$X, alexithymia$Y)
summary(results)
plot(results)
</code></pre>

<hr>
<h2 id='promin'>Promin rotation</h2><span id='topic+promin'></span>

<h3>Description</h3>

<p>This is a rotation criterion, developed by Lorenzo-Seva (1999), in which oblique target rotation (<code><a href="#topic+tarrotob">tarrotob</a></code>) is applied using the Weighted Varimax solution (<code><a href="#topic+wvarim">wvarim</a></code>) as the target matrix. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>promin(F1, nrs = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="promin_+3A_f1">F1</code></td>
<td>
<p>Matrix to be rotated</p>
</td></tr>
<tr><td><code id="promin_+3A_nrs">nrs</code></td>
<td>
<p>Number of random starts</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Th</code></td>
<td>
<p>Transformation matrix to the pattern</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>Rotated matrix</p>
</td></tr>
<tr><td><code>U</code></td>
<td>
<p>Transformation matrix to the structure</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>Lorenzo-Seva, U. (1999). Promin: A method for oblique factor rotation. Multivariate Behavioral Research, 34(3), 347-365.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Px &lt;- matrix(rnorm(36),12,3)
print(Px)

Px_r &lt;- promin(Px)
print(Px_r$loadings)
</code></pre>

<hr>
<h2 id='psychiatrists'>
Effect of psychiatric symptoms on toxicomania, schizophrenia, depression and anxiety disorder
</h2><span id='topic+psychiatrists'></span>

<h3>Description</h3>

<p>The data contain the scores of 30 Belgian psychiatric patients on 23 psychiatric symptoms and 4 psychiatric disorders (toxicomania, schizophrenia, depression, and anxiety disorder). Each score is the sumscore of the binary symptom and disorder scores that were given by 15 different psychiatrists. The data can be used to examine the extent to which the degree of toxicomania, schizophrenia, depression and anxiety disorder, can be predicted by the 23 psychiatric symptoms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(psychiatrists)</code></pre>


<h3>Format</h3>

<p>The format is:
List of 2
</p>


<h4>$ X:'data.frame':  30 obs. of  23 variables:</h4>


<dl>
<dt><code>desorganised_speech</code></dt><dd></dd>
<dt><code>agitation</code></dt><dd></dd>
<dt><code>hallucinations</code></dt><dd></dd>
<dt><code>inappropriate</code></dt><dd></dd>
<dt><code>desorientation</code></dt><dd></dd>
<dt><code>depression</code></dt><dd></dd>
<dt><code>fear</code></dt><dd></dd>
<dt><code>suicide</code></dt><dd></dd>
<dt><code>somatic_concern</code></dt><dd></dd>
<dt><code>narcotics</code></dt><dd></dd>
<dt><code>antisocial</code></dt><dd></dd>
<dt><code>retardation</code></dt><dd></dd>
<dt><code>social_isolation</code></dt><dd></dd>
<dt><code>routine</code></dt><dd></dd>
<dt><code>alcohol</code></dt><dd></dd>
<dt><code>negativism</code></dt><dd></dd>
<dt><code>denial</code></dt><dd></dd>
<dt><code>grandeur</code></dt><dd></dd>
<dt><code>suspicion</code></dt><dd></dd>
<dt><code>intellectual_obstruction</code></dt><dd></dd>
<dt><code>impulse_control</code></dt><dd></dd>
<dt><code>social_leveling</code></dt><dd></dd>
<dt><code>occupational_dysfunction</code></dt><dd></dd>
</dl>



<h4>$ Y:'data.frame':  30 obs. of  4 variables:</h4>


<dl>
<dt><code>toxicomania</code></dt><dd></dd>
<dt><code>schizophrenia</code></dt><dd></dd>
<dt><code>depression</code></dt><dd></dd>
<dt><code>anxiety_disorder</code></dt><dd></dd>
</dl>



<h3>References</h3>

<p><cite>Van Mechelen, I., &amp; De Boeck, P. (1990). Projection of a binary criterion into a model of hierarchical classes. Psychometrika , 55 (4), 677-694.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(psychiatrists)
str(psychiatrists)
</code></pre>

<hr>
<h2 id='SortLoadings'>Sorting a component loading matrix</h2><span id='topic+SortLoadings'></span>

<h3>Description</h3>

<p>A loading matrix indicates how predictors that have been reduced to components - e.g., in principal covariates regression (De Jong &amp; Kiers, 1992) - relate to these components. Usually, components are interpreted by looking at what the predictors with a clear non-zero loading have in common.
To make this easier, this function changes the order of the predictors presented in a loading matrix, so that the firstly, the predictors with clear non-zero loadings on the first component (with decreasing loadings) are presented, then the predictors with clear non-zero loadings on the second component, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SortLoadings(Px)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SortLoadings_+3A_px">Px</code></td>
<td>
<p>Dataframe that contains component loadings (components x predictors)</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>SortLoadings</code> returns a dataframe with the same dimensions and labels as the original loading matrix, but with the columns (referring to the predictors) presented in a different order.
</p>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>De Jong, S., &amp; Kiers, H. A. (1992). Principal covariates regression: Part I. Theory. Chemometrics and Intelligent Laboratory Systems , 155-164.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pcovr">pcovr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute loading matrix of alexithymia dataset
data(alexithymia)
results &lt;- pcovr(alexithymia$X,alexithymia$Y)
Px &lt;- results$Px
print(Px)

# Sort loading matrix
sorted_Px &lt;- SortLoadings(results$Px)
print(sorted_Px)
</code></pre>

<hr>
<h2 id='tarrotob'>Oblique target rotation</h2><span id='topic+tarrotob'></span>

<h3>Description</h3>

<p>Oblique target rotation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tarrotob(F1, W)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tarrotob_+3A_f1">F1</code></td>
<td>
<p>Matrix to be rotated</p>
</td></tr>
<tr><td><code id="tarrotob_+3A_w">W</code></td>
<td>
<p>Target binary matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>T</code></td>
<td>
<p>Rotation matrix</p>
</td></tr>
<tr><td><code>A</code></td>
<td>
<p>Rotated matrix</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>Examples</h3>

<pre><code class='language-R'>Px &lt;- matrix(rnorm(36),12,3)
print(Px)

W &lt;- matrix(rbinom(36,1,.4),12,3)
Px_r &lt;- tarrotob(Px,W)
print(Px_r$A)
</code></pre>

<hr>
<h2 id='wvarim'>Weighted varimax</h2><span id='topic+wvarim'></span>

<h3>Description</h3>

<p>This is an oblique rotation criterion, developed by Cureton and Mulaik (1975).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wvarim(F1, nrs = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wvarim_+3A_f1">F1</code></td>
<td>
<p>Matrix to be rotated</p>
</td></tr>
<tr><td><code id="wvarim_+3A_nrs">nrs</code></td>
<td>
<p>Number of random starts</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Th</code></td>
<td>
<p>Rotation matrix</p>
</td></tr>
<tr><td><code>loadings</code></td>
<td>
<p>Rotated matrix</p>
</td></tr>
<tr><td><code>W</code></td>
<td>
<p>Matrix of weights</p>
</td></tr>
<tr><td><code>fr</code></td>
<td>
<p>Varimax function value</p>
</td></tr>
<tr><td><code>ir</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marlies Vervloet (<a href="mailto:marlies.vervloet@ppw.kuleuven.be">marlies.vervloet@ppw.kuleuven.be</a>)</p>


<h3>References</h3>

<p><cite>Cureton, E. E., &amp; Mulaik, S. A. (1975). The weighted varimax rotation and the promax rotation. Psychometrika, 40(2), 183-195.</cite>
</p>
<p><cite>Marlies Vervloet, Henk A. Kiers, Wim Van den Noortgate, Eva Ceulemans (2015). PCovR: An R Package for Principal Covariates Regression. Journal of Statistical Software, 65(8), 1-14. URL http://www.jstatsoft.org/v65/i08/.</cite>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Px &lt;- matrix(rnorm(36),12,3)
print(Px)

Px_r &lt;- wvarim(Px)
print(Px_r$loadings)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
