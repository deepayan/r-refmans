<!DOCTYPE html><html><head><title>Help for package spsurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spsurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#spsurv-package'><p>The 'spsurv' package.</p></a></li>
<li><a href='#bp.basis'><p>Bernstein basis polynomials calculations</p></a></li>
<li><a href='#bpaft'><p>Bernstein Polynomial Based Accelerated Failure Time Model</p></a></li>
<li><a href='#bpph'><p>Bernstein Polynomial Based Proportional Hazards Model</p></a></li>
<li><a href='#bppo'><p>Bernstein Polynomial Based Proportional Odds Model</p></a></li>
<li><a href='#coef'><p>Generic S3 method coef</p></a></li>
<li><a href='#coef.spbp'><p>Estimated regression coefficients</p></a></li>
<li><a href='#confint'><p>Generic S3 method confint</p></a></li>
<li><a href='#confint.spbp'><p>Confidence intervals for the regression coefficients</p></a></li>
<li><a href='#extract'><p>Generic S3 method extract</p></a></li>
<li><a href='#extract.spbp'><p>Extract method for fitted spbp models</p></a></li>
<li><a href='#itsamp'><p>Inverse Transform Sampling To Generate Time-to-event Data From Parametric Models</p></a></li>
<li><a href='#mode'><p>Calculate the posterior mode</p></a></li>
<li><a href='#model.matrix.spbp'><p>Model.matrix method for fitted spbp models</p></a></li>
<li><a href='#print.spbp'><p>Bernstein Polynomial Based Regression Object Print</p></a></li>
<li><a href='#print.summary.bpaft.bayes'><p>Bernstein Polynomial Based Regression Object Summary BPAFT Bayes</p></a></li>
<li><a href='#print.summary.bpaft.mle'><p>Bernstein Polynomial Based Regression Object Summary BPAFT MLE</p></a></li>
<li><a href='#print.summary.bpph.bayes'><p>Bernstein Polynomial Based Regression Object Summary BPPH Bayes</p></a></li>
<li><a href='#print.summary.bpph.mle'><p>Bernstein Polynomial Based Regression Object Summary BPPH MLE</p></a></li>
<li><a href='#print.summary.bppo.bayes'><p>Bernstein Polynomial Based Regression Object Summary BPPO Bayes</p></a></li>
<li><a href='#print.summary.bppo.mle'><p>Bernstein Polynomial Based Regression Object BPPO MLE</p></a></li>
<li><a href='#print.summary.spbp.bayes'><p>Bernstein Polynomial Based Regression Object Summary Bayes</p></a></li>
<li><a href='#print.summary.spbp.mle'><p>Bernstein Polynomial Based Regression Object Summary MLE</p></a></li>
<li><a href='#residuals.spbp'><p>BP based models residuals.</p></a></li>
<li><a href='#spbp'><p>spbp: The BP Based Survival Analysis Function</p></a></li>
<li><a href='#spbp.default'><p>spbp: The BP Based Semiparametric Survival Analysis Function</p></a></li>
<li><a href='#stan_dens'><p>Generic S3 method extract</p></a></li>
<li><a href='#stan_dens.spbp'><p>Density plots method for fitted spbp models</p></a></li>
<li><a href='#summary.spbp'><p>Bernstein Polynomial Based Regression Object Summary</p></a></li>
<li><a href='#survivor'><p>Generic S3 method vcov</p></a></li>
<li><a href='#traceplot'><p>Generic S3 method traceplot</p></a></li>
<li><a href='#traceplot.spbp'><p>Traceplot method for fitted spbp models</p></a></li>
<li><a href='#vcov'><p>Generic S3 method vcov</p></a></li>
<li><a href='#vcov.spbp'><p>Covariance of the regression coefficients</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bernstein Polynomial Based Semiparametric Survival Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Renato Panaro &lt;renatovp@ime.usp.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of reliable routines to ease semiparametric survival regression modeling based on Bernstein polynomials. 'spsurv' includes proportional hazards, proportional odds and accelerated failure time frameworks for right-censored data. RV Panaro (2020) &lt;<a href="https://doi.org/10.48550/arXiv.2003.10548">doi:10.48550/arXiv.2003.10548</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), survival (&ge; 2.44-1.1), loo (&ge; 2.1.0), coda (&ge;
0.19-3), MASS (&ge; 7.3-51.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), rstan (&ge; 2.18.1), rstantools (&ge;
1.5.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
rstan (&ge; 2.18.1), StanHeaders (&ge; 2.18.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, devtools, roxygen2, testthat, KMsurv</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rvpanaro/spsurv/issues">https://github.com/rvpanaro/spsurv/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-30 19:45:20 UTC; renato</td>
</tr>
<tr>
<td>Author:</td>
<td>Renato Panaro <a href="https://orcid.org/0000-0002-1903-2091"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre] (https://rvpanaro.github.io/),
  Fábio Demarqui <a href="https://orcid.org/0000-0001-9236-1986"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Vinícius Mayrink <a href="https://orcid.org/0000-0002-5683-8326"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-31 10:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='spsurv-package'>The 'spsurv' package.</h2><span id='topic+spsurv-package'></span><span id='topic+spsurv'></span>

<h3>Description</h3>

<p>A set of flexible routines to allow semiparametric
survival regression modeling based on Bernstein polynomial, including Bernstein based proportinal hazards model (BPPH), Bernstein polynomial based proportional odds model (BPPO) and
Bernstein based accelerated failure time model (BPAFT) for right-censored data.
</p>


<h3>Details</h3>

<p><code><a href="#topic+spbp">spbp</a></code> fits semi-parametric models for time-to-event survival data.
Non-informative right-censoring assumption is available. Any user-defined Bernstein polynomial can
be user-defined using an arbitrary degree, i.e. highest basis polynomials order.
</p>
<p>The framework takes advantage of fully likelihood methods since the polynomial parameters are used
to estimate the baseline functions. Even so, this is said to be semi-parametric since this approach
does not rely on any distribution. Unlike the Cox model, the BP based models provide smooth hazard and survival curve estimates.
</p>


<h3>Value</h3>

<p>none
</p>


<h3>Author(s)</h3>

<p>Renato Valladares Panaro (renatovp@ime.usp.br).
</p>


<h3>References</h3>

<p>Panaro R.V. (2020). spsurv: An R package for semi-parametric survival analysis. arXiv preprint arXiv:2003.10548.
</p>
<p>Demarqui, F. N., &amp; Mayrink, V. D. (2019). A fully likelihood-based approach to model survival data with crossing survival curves. arXiv preprint arXiv:1910.02406.
</p>
<p>Demarqui, F. N., Mayrink, V. D., &amp; Ghosh, S. K. (2019). An Unified Semiparametric Approach to Model Lifetime Data with Crossing Survival Curves. arXiv preprint arXiv:1910.04475.
</p>
<p>Osman, M., &amp; Ghosh, S. K. (2012). Nonparametric regression models for right-censored data using Bernstein polynomials. Computational Statistics &amp; Data Analysis, 56(3), 559-573.
</p>
<p>Lorentz, G. G. (1953). Bernstein polynomials. American Mathematical Society.
</p>

<hr>
<h2 id='bp.basis'>Bernstein basis polynomials calculations</h2><span id='topic+bp.basis'></span>

<h3>Description</h3>

<p>Bernstein basis polynomials calculations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bp.basis(time, degree, tau = max(time))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bp.basis_+3A_time">time</code></td>
<td>
<p>a vector of times.</p>
</td></tr>
<tr><td><code id="bp.basis_+3A_degree">degree</code></td>
<td>
<p>Bernstein polynomial degree</p>
</td></tr>
<tr><td><code id="bp.basis_+3A_tau">tau</code></td>
<td>
<p>must be greater than times maximum value observed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing matrices b and B corresponding BP basis and corresponding tau value used to compute them.
</p>

<hr>
<h2 id='bpaft'>Bernstein Polynomial Based Accelerated Failure Time Model</h2><span id='topic+bpaft'></span>

<h3>Description</h3>

<p>Fits the BPAFT model to time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpaft(formula, degree, data, approach = c("mle", "bayes"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpaft_+3A_formula">formula</code></td>
<td>
<p>a Surv object with time to event observations, right censoring status and explanatory terms.</p>
</td></tr>
<tr><td><code id="bpaft_+3A_degree">degree</code></td>
<td>
<p>Bernstein polynomial degree.</p>
</td></tr>
<tr><td><code id="bpaft_+3A_data">data</code></td>
<td>
<p>a data.frame object.</p>
</td></tr>
<tr><td><code id="bpaft_+3A_approach">approach</code></td>
<td>
<p>Bayesian or maximum likelihood estimation methods, default is approach = &quot;mle&quot;.</p>
</td></tr>
<tr><td><code id="bpaft_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'spbp'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+bpph">bpph</a></code> and <code><a href="#topic+bppo">bppo</a></code> for other BP based models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpaft(Surv(time, status) ~ karno + celltype,
data = veteran)

summary(fit)

</code></pre>

<hr>
<h2 id='bpph'>Bernstein Polynomial Based Proportional Hazards Model</h2><span id='topic+bpph'></span>

<h3>Description</h3>

<p>Fits the BPPH model to time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bpph(formula, degree, data, approach = c("mle", "bayes"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bpph_+3A_formula">formula</code></td>
<td>
<p>a Surv object with time to event observations, right censoring status and explanatory terms.</p>
</td></tr>
<tr><td><code id="bpph_+3A_degree">degree</code></td>
<td>
<p>Bernstein polynomial degree.</p>
</td></tr>
<tr><td><code id="bpph_+3A_data">data</code></td>
<td>
<p>a data.frame object.</p>
</td></tr>
<tr><td><code id="bpph_+3A_approach">approach</code></td>
<td>
<p>Bayesian or maximum likelihood estimation methods, default is approach = &quot;mle&quot;.</p>
</td></tr>
<tr><td><code id="bpph_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'spbp'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+bppo">bppo</a></code> and <code><a href="#topic+bpaft">bpaft</a></code> for other BP based models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

summary(fit)

</code></pre>

<hr>
<h2 id='bppo'>Bernstein Polynomial Based Proportional Odds Model</h2><span id='topic+bppo'></span>

<h3>Description</h3>

<p>Fits the BPPO model to time-to-event data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bppo(formula, degree, data, approach = c("mle", "bayes"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bppo_+3A_formula">formula</code></td>
<td>
<p>a Surv object with time-to-event observations, right censoring status and explanatory terms.</p>
</td></tr>
<tr><td><code id="bppo_+3A_degree">degree</code></td>
<td>
<p>Bernstein polynomial degree.</p>
</td></tr>
<tr><td><code id="bppo_+3A_data">data</code></td>
<td>
<p>a data.frame object.</p>
</td></tr>
<tr><td><code id="bppo_+3A_approach">approach</code></td>
<td>
<p>Bayesian or maximum likelihood estimation methods, default is approach = &quot;mle&quot;.</p>
</td></tr>
<tr><td><code id="bppo_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'spbp'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+bpph">bpph</a></code> and <code><a href="#topic+bpaft">bpaft</a></code> for other BP based models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bppo(Surv(time, status) ~ karno + celltype,
data = veteran)

summary(fit)

</code></pre>

<hr>
<h2 id='coef'>Generic S3 method coef</h2><span id='topic+coef'></span>

<h3>Description</h3>

<p>Generic S3 method coef
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="coef_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated regression coefficients
</p>

<hr>
<h2 id='coef.spbp'>Estimated regression coefficients</h2><span id='topic+coef.spbp'></span>

<h3>Description</h3>

<p>Estimated regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
coef(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.spbp_+3A_spbp">spbp</code></td>
<td>
<p>an object of the class spbp</p>
</td></tr>
<tr><td><code id="coef.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated regression coefficients
</p>

<hr>
<h2 id='confint'>Generic S3 method confint</h2><span id='topic+confint'></span>

<h3>Description</h3>

<p>Generic S3 method confint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="confint_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the estimated regression coefficients
</p>

<hr>
<h2 id='confint.spbp'>Confidence intervals for the regression coefficients</h2><span id='topic+confint.spbp'></span>

<h3>Description</h3>

<p>Confidence intervals for the regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
confint(spbp, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.spbp_+3A_spbp">spbp</code></td>
<td>
<p>an object of the class spbp</p>
</td></tr>
<tr><td><code id="confint.spbp_+3A_level">level</code></td>
<td>
<p>the confidence level required</p>
</td></tr>
<tr><td><code id="confint.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>100(1-alpha) confidence intervals for the regression coefficients
</p>

<hr>
<h2 id='extract'>Generic S3 method extract</h2><span id='topic+extract'></span>

<h3>Description</h3>

<p>Generic S3 method extract
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="extract_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>extract the MCMC chain values of a Bayesian fit.
</p>

<hr>
<h2 id='extract.spbp'>Extract method for fitted spbp models</h2><span id='topic+extract.spbp'></span>

<h3>Description</h3>

<p>Extract samples from a fitted <code><a href="#topic+spbp">spbp</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
extract(spbp, pars = c("beta", "gamma"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract.spbp_+3A_spbp">spbp</code></td>
<td>
<p>an object of class 'spbp' result of a <code><a href="#topic+spbp">spbp</a></code> fit.</p>
</td></tr>
<tr><td><code id="extract.spbp_+3A_pars">pars</code></td>
<td>
<p>parameters to be selected.</p>
</td></tr>
<tr><td><code id="extract.spbp_+3A_...">...</code></td>
<td>
<p>arguments inherent from <code><a href="rstan.html#topic+extract">extract</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="rstan.html#topic+extract">extract</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+stan_dens.spbp">stan_dens.spbp</a></code>, <code><a href="#topic+traceplot.spbp">traceplot.spbp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

extract(fit)

</code></pre>

<hr>
<h2 id='itsamp'>Inverse Transform Sampling To Generate Time-to-event Data From Parametric Models</h2><span id='topic+itsamp'></span>

<h3>Description</h3>

<p>Random survival times generation for the weibull or
log-logistic distributions with parameters 'scale' and 'shape'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>itsamp(
  n,
  beta = c(2, -1),
  event_scale = 10,
  censor_scale = 4,
  features = data.frame(x1 = rnorm(n, 0), x2 = rnorm(n, 0)),
  shape = 2,
  model = c("ph", "po", "aft"),
  dist = c("weibull", "llogis"),
  censor = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="itsamp_+3A_n">n</code></td>
<td>
<p>integer; sample size</p>
</td></tr>
<tr><td><code id="itsamp_+3A_beta">beta</code></td>
<td>
<p>vector of regression coefficients</p>
</td></tr>
<tr><td><code id="itsamp_+3A_event_scale">event_scale</code>, <code id="itsamp_+3A_censor_scale">censor_scale</code></td>
<td>
<p>event and censoring scale parameters</p>
</td></tr>
<tr><td><code id="itsamp_+3A_features">features</code></td>
<td>
<p>matrix of features (columns)</p>
</td></tr>
<tr><td><code id="itsamp_+3A_shape">shape</code></td>
<td>
<p>event and censoring distribution shape</p>
</td></tr>
<tr><td><code id="itsamp_+3A_model">model</code></td>
<td>
<p>either &quot;ph&quot; (default) or &quot;aft&quot; for weibull and
&quot;po&quot; or &quot;aft&quot; for log-logistic distribution</p>
</td></tr>
<tr><td><code id="itsamp_+3A_dist">dist</code></td>
<td>
<p>&quot;weibull&quot; or &quot;llogis&quot;</p>
</td></tr>
<tr><td><code id="itsamp_+3A_censor">censor</code></td>
<td>
<p>logical; if 'TRUE', censoring is required, that is
mean(status) &gt; 0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>sim_surv returns weibull (log-logistic) randomly
generated survival times. According to Collett (2003), the
accelerated failure time model encompasses a wide variety of parametric
models, including weibull and log-logistic models.
</p>


<h3>Value</h3>

<p>data.frame of 'ncol(x) +2' columns in which the
survival times are the response variable denoted by 'y',
'status' indicates failure (0 = failure) and the features
are appended to the next columns.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rows &lt;- 200

categorical &lt;- rbinom(rows, size = 3, prob = .5)
x &lt;- data.frame(numerical = rnorm(rows),
           cat0 = as.numeric(categorical == 0),
           cat1 = as.numeric(categorical == 1),
           cat2 = as.numeric(categorical == 2),
           cat3 = as.numeric(categorical == 3))

newdata &lt;- itsamp(n = rows, beta = c(1, -2, .5, .1, 1),
  features = x, model = 'ph', dist = 'weibull')

</code></pre>

<hr>
<h2 id='mode'>Calculate the posterior mode</h2><span id='topic+mode'></span>

<h3>Description</h3>

<p>Calculate the posterior mode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mode(ext)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mode_+3A_ext">ext</code></td>
<td>
<p>rstan extracted sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the posterior mode of each sample.
</p>

<hr>
<h2 id='model.matrix.spbp'>Model.matrix method for fitted spbp models</h2><span id='topic+model.matrix.spbp'></span>

<h3>Description</h3>

<p>Model.matrix of a fitted <code><a href="#topic+spbp">spbp</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
model.matrix(
  object,
  data = eval(object$call$data, envir = parent.frame()),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.matrix.spbp_+3A_object">object</code></td>
<td>
<p>an object of class 'spbp', see <code><a href="#topic+spbp">spbp</a></code>.</p>
</td></tr>
<tr><td><code id="model.matrix.spbp_+3A_data">data</code></td>
<td>
<p>data.frame object.</p>
</td></tr>
<tr><td><code id="model.matrix.spbp_+3A_...">...</code></td>
<td>
<p>arguments inherent from <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The explanatory variables matrix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="stats.html#topic+model.matrix">model.matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

model.matrix(fit)

</code></pre>

<hr>
<h2 id='print.spbp'>Bernstein Polynomial Based Regression Object Print</h2><span id='topic+print.spbp'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Print
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
print(
  x,
  digits = max(getOption("digits") - 4, 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.spbp_+3A_x">x</code></td>
<td>
<p>an object of class spbp</p>
</td></tr>
<tr><td><code id="print.spbp_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
<tr><td><code id="print.spbp_+3A_signif.stars">signif.stars</code></td>
<td>
<p>see <code><a href="base.html#topic+getOption">getOption</a></code></p>
</td></tr>
<tr><td><code id="print.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bpaft.bayes'>Bernstein Polynomial Based Regression Object Summary BPAFT Bayes</h2><span id='topic+print.summary.bpaft.bayes'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary BPAFT Bayes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bpaft.bayes'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bpaft.bayes_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bpaft.mle'>Bernstein Polynomial Based Regression Object Summary BPAFT MLE</h2><span id='topic+print.summary.bpaft.mle'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary BPAFT MLE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bpaft.mle'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bpaft.mle_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bpph.bayes'>Bernstein Polynomial Based Regression Object Summary BPPH Bayes</h2><span id='topic+print.summary.bpph.bayes'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary BPPH Bayes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bpph.bayes'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bpph.bayes_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bpph.mle'>Bernstein Polynomial Based Regression Object Summary BPPH MLE</h2><span id='topic+print.summary.bpph.mle'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary BPPH MLE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bpph.mle'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bpph.mle_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bppo.bayes'>Bernstein Polynomial Based Regression Object Summary BPPO Bayes</h2><span id='topic+print.summary.bppo.bayes'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary BPPO Bayes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bppo.bayes'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bppo.bayes_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.bppo.mle'>Bernstein Polynomial Based Regression Object BPPO MLE</h2><span id='topic+print.summary.bppo.mle'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object BPPO MLE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.bppo.mle'
print(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.bppo.mle_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.spbp.bayes'>Bernstein Polynomial Based Regression Object Summary Bayes</h2><span id='topic+print.summary.spbp.bayes'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary Bayes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.spbp.bayes'
print(x, digits = max(getOption("digits") - 4, 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.spbp.bayes_+3A_x">x</code></td>
<td>
<p>a summary.spbp.bayes object</p>
</td></tr>
<tr><td><code id="print.summary.spbp.bayes_+3A_digits">digits</code></td>
<td>
<p>number of digits to display.</p>
</td></tr>
<tr><td><code id="print.summary.spbp.bayes_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='print.summary.spbp.mle'>Bernstein Polynomial Based Regression Object Summary MLE</h2><span id='topic+print.summary.spbp.mle'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary MLE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.spbp.mle'
print(
  x,
  digits = max(getOption("digits") - 4, 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.spbp.mle_+3A_x">x</code></td>
<td>
<p>a summary.spbp.mle object</p>
</td></tr>
<tr><td><code id="print.summary.spbp.mle_+3A_digits">digits</code></td>
<td>
<p>number of digits to display.</p>
</td></tr>
<tr><td><code id="print.summary.spbp.mle_+3A_signif.stars">signif.stars</code></td>
<td>
<p>see <code><a href="base.html#topic+getOption">getOption</a></code></p>
</td></tr>
<tr><td><code id="print.summary.spbp.mle_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>

<hr>
<h2 id='residuals.spbp'>BP based models residuals.</h2><span id='topic+residuals.spbp'></span>

<h3>Description</h3>

<p>Residuals for a fitted <code><a href="#topic+spbp">spbp</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
residuals(object, type = c("cox-snell"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.spbp_+3A_object">object</code></td>
<td>
<p>an object of class 'spbp' result of a <code><a href="#topic+spbp">spbp</a></code> fit.</p>
</td></tr>
<tr><td><code id="residuals.spbp_+3A_type">type</code></td>
<td>
<p>type of residuals, default is &quot;cox-snell&quot;</p>
</td></tr>
<tr><td><code id="residuals.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

residuals(fit)

</code></pre>

<hr>
<h2 id='spbp'>spbp: The BP Based Survival Analysis Function</h2><span id='topic+spbp'></span>

<h3>Description</h3>

<p>Semiparametric Survival Analysis Using Bernstein Polynomial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spbp(formula, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spbp_+3A_formula">formula</code></td>
<td>
<p>a Surv object with time to event, status and explanatory terms.</p>
</td></tr>
<tr><td><code id="spbp_+3A_...">...</code></td>
<td>
<p>Arguments passed to 'rstan::sampling' (e.g. iter, chains) or 'rstan::optimizing'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits Bernstein Polynomial based Proportional regression to survival data.
</p>


<h3>Value</h3>

<p>An object of class 'spbp'.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp.default">spbp.default</a></code>
</p>
<p><code><a href="#topic+spbp.default">spbp.default</a></code>,  <code><a href="#topic+bpph">bpph</a></code>,  <code><a href="#topic+bppo">bppo</a></code>, <code><a href="#topic+bpaft">bpaft</a></code>, <a href="https://mc-stan.org/users/documentation/">https://mc-stan.org/users/documentation/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran") ## imports from survival package

fit_mle &lt;- spbp(Surv(time, status) ~ karno + factor(celltype),
 data = veteran, model = "po")
summary(fit_mle)

fit_bayes &lt;- spbp(Surv(time, status) ~ karno + factor(celltype),
                  data = veteran, model = "po", approach = "bayes",
                   cores = 1, iter = 300, chains = 1,
                    priors = list(beta = c("normal(0,4)"),
                     gamma = "lognormal(0,4)"))

summary(fit_bayes)

</code></pre>

<hr>
<h2 id='spbp.default'>spbp: The BP Based Semiparametric Survival Analysis Function</h2><span id='topic+spbp.default'></span>

<h3>Description</h3>

<p>spbp: The BP Based Semiparametric Survival Analysis Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
spbp(
  formula,
  degree,
  data,
  approach = c("mle", "bayes"),
  model = c("ph", "po", "aft"),
  priors = list(beta = c("normal(0,4)"), gamma = "lognormal(0,10)"),
  scale = TRUE,
  cores = parallel::detectCores(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spbp.default_+3A_formula">formula</code></td>
<td>
<p>a Surv object with time to event, status and explanatory terms</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_degree">degree</code></td>
<td>
<p>Bernstein Polynomial degree</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_data">data</code></td>
<td>
<p>a data.frame object</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_approach">approach</code></td>
<td>
<p>Bayesian or Maximum Likelihood estimation methods, default is approach = &quot;bayes&quot;</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_model">model</code></td>
<td>
<p>Proportional Hazards or Proportional Odds BP based regression, default is model = &quot;ph&quot;</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_priors">priors</code></td>
<td>
<p>prior settings for the Bayesian approach; 'normal' or 'cauchy' for beta; 'gamma', 'inv_gamma' or 'lognormal' for gamma (BP coefficients)</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_scale">scale</code></td>
<td>
<p>logical; indicates whether to center and scale the data</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_cores">cores</code></td>
<td>
<p>number of core threads to use</p>
</td></tr>
<tr><td><code id="spbp.default_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>spbp</code>
</p>

<hr>
<h2 id='stan_dens'>Generic S3 method extract</h2><span id='topic+stan_dens'></span>

<h3>Description</h3>

<p>Generic S3 method extract
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stan_dens(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stan_dens_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="stan_dens_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density plot of a MCMC chain.
</p>

<hr>
<h2 id='stan_dens.spbp'>Density plots method for fitted spbp models</h2><span id='topic+stan_dens.spbp'></span>

<h3>Description</h3>

<p>Posterior density of samples from a fitted <code><a href="#topic+spbp">spbp</a></code> model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
stan_dens(spbp, pars = c("beta", "gamma"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stan_dens.spbp_+3A_spbp">spbp</code></td>
<td>
<p>the result of a <code><a href="#topic+spbp">spbp</a></code> fit.</p>
</td></tr>
<tr><td><code id="stan_dens.spbp_+3A_pars">pars</code></td>
<td>
<p>parameters to be selected.</p>
</td></tr>
<tr><td><code id="stan_dens.spbp_+3A_...">...</code></td>
<td>
<p>arguments inherent from <code><a href="rstan.html#topic+stan_dens">stan_dens</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="rstan.html#topic+stan_dens">stan_dens</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+traceplot.spbp">traceplot.spbp</a></code>, <code><a href="#topic+extract.spbp">extract.spbp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

stan_dens(fit)

</code></pre>

<hr>
<h2 id='summary.spbp'>Bernstein Polynomial Based Regression Object Summary</h2><span id='topic+summary.spbp'></span>

<h3>Description</h3>

<p>Bernstein Polynomial Based Regression Object Summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
summary(object, interval = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.spbp_+3A_object">object</code></td>
<td>
<p>an object of class spbp</p>
</td></tr>
<tr><td><code id="summary.spbp_+3A_interval">interval</code></td>
<td>
<p>interval coverage (confidence or credibility)</p>
</td></tr>
<tr><td><code id="summary.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class analogous to for e.g. 'summary.bppo.bayes'.
</p>

<hr>
<h2 id='survivor'>Generic S3 method vcov</h2><span id='topic+survivor'></span>

<h3>Description</h3>

<p>Generic S3 method vcov
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survivor(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survivor_+3A_spbp">spbp</code></td>
<td>
<p>an object of class spbp</p>
</td></tr>
<tr><td><code id="survivor_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>estimates survival for each dataset individual (line).
Spbp Object Observed Survival
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+itsamp">itsamp</a></code>
</p>

<hr>
<h2 id='traceplot'>Generic S3 method traceplot</h2><span id='topic+traceplot'></span>

<h3>Description</h3>

<p>Generic S3 method traceplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="traceplot_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the traceplot of a MCMC chain.
</p>

<hr>
<h2 id='traceplot.spbp'>Traceplot method for fitted spbp models</h2><span id='topic+traceplot.spbp'></span>

<h3>Description</h3>

<p>Traceplot of a Bayesian fit <code><a href="#topic+spbp">spbp</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
traceplot(spbp, pars = c("beta", "gamma"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceplot.spbp_+3A_spbp">spbp</code></td>
<td>
<p>an object of class 'spbp' result of a <code><a href="#topic+spbp">spbp</a></code> fit.</p>
</td></tr>
<tr><td><code id="traceplot.spbp_+3A_pars">pars</code></td>
<td>
<p>parameters to be selected.</p>
</td></tr>
<tr><td><code id="traceplot.spbp_+3A_...">...</code></td>
<td>
<p>arguments inherent from <code><a href="rstan.html#topic+traceplot">traceplot</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>see <code><a href="rstan.html#topic+traceplot">traceplot</a></code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spbp">spbp</a></code>, <code><a href="#topic+stan_dens.spbp">stan_dens.spbp</a></code>, <code><a href="#topic+extract.spbp">extract.spbp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library("spsurv")
data("veteran")

fit &lt;- bpph(Surv(time, status) ~ karno + factor(celltype),
data = veteran)

traceplot(fit)

</code></pre>

<hr>
<h2 id='vcov'>Generic S3 method vcov</h2><span id='topic+vcov'></span>

<h3>Description</h3>

<p>Generic S3 method vcov
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vcov(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov_+3A_spbp">spbp</code></td>
<td>
<p>a fitted model object</p>
</td></tr>
<tr><td><code id="vcov_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variance-covariance matrix associated the regression coefficients.
</p>

<hr>
<h2 id='vcov.spbp'>Covariance of the regression coefficients</h2><span id='topic+vcov.spbp'></span>

<h3>Description</h3>

<p>Covariance of the regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spbp'
vcov(spbp, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.spbp_+3A_spbp">spbp</code></td>
<td>
<p>an object of the class spbp</p>
</td></tr>
<tr><td><code id="vcov.spbp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the variance-covariance matrix associated with the regression coefficients.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
