<!DOCTYPE html><html lang="en"><head><title>Help for package GDAtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GDAtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ahc.plots'><p>Plots for Ascending Hierarchical Clustering</p></a></li>
<li><a href='#angles.csa'><p>Cosine similarities and angles between CSA and MCA</p></a></li>
<li><a href='#barplot_contrib'><p>Bar plot of contributions</p></a></li>
<li><a href='#bcMCA'><p>Between-class MCA</p></a></li>
<li><a href='#bcPCA'><p>Between-class Principal Component Analysis</p></a></li>
<li><a href='#bootvalid_supvars'><p>Bootstrap validation (supplementary variables)</p></a></li>
<li><a href='#bootvalid_variables'><p>Bootstrap validation (active variables)</p></a></li>
<li><a href='#burt'><p>Burt table</p></a></li>
<li><a href='#coiMCA'><p>Coinertia analysis between two groups of categorical variables</p></a></li>
<li><a href='#coiPCA'><p>Coinertia analysis between two groups of numerical variables</p></a></li>
<li><a href='#conc.ellipse'><p>Concentration ellipses</p></a></li>
<li><a href='#contrib'><p>Contributions of active variables</p></a></li>
<li><a href='#csMCA'><p>Class Specific Analysis</p></a></li>
<li><a href='#DA'><p>Discriminant Analysis</p></a></li>
<li><a href='#DAQ'><p>Discriminant Analysis of Qualitative Variables</p></a></li>
<li><a href='#dichotom'><p>Dichotomizes the variables in a data frame</p></a></li>
<li><a href='#dichotomixed'><p>Dichotomizes the factor variables in a mixed format data frame</p></a></li>
<li><a href='#dimcontrib'><p>Description of the contributions to axes</p></a></li>
<li><a href='#dimdescr'><p>Description of the dimensions</p></a></li>
<li><a href='#dimeta2'><p>Correlation ratios (aka eta-squared) of supplementary variables</p></a></li>
<li><a href='#dimtypicality'><p>Typicality tests for supplementary variables</p></a></li>
<li><a href='#dist.chi2'><p>Chi-squared distance</p></a></li>
<li><a href='#flip.mca'><p>Flips the coordinates</p></a></li>
<li><a href='#getindexcat'><p>Names of the categories in a data frame</p></a></li>
<li><a href='#ggadd_attractions'><p>Plot of attractions between categories</p></a></li>
<li><a href='#ggadd_chulls'><p>Convex hulls for a categorical supplementary variable</p></a></li>
<li><a href='#ggadd_corr'><p>Heatmap of under/over-representation of a supplementary variable</p></a></li>
<li><a href='#ggadd_density'><p>Density plot of a supplementary variable</p></a></li>
<li><a href='#ggadd_ellipses'><p>Confidence ellipses</p></a></li>
<li><a href='#ggadd_interaction'><p>Plot of interactions between two categorical supplementary variables</p></a></li>
<li><a href='#ggadd_kellipses'><p>Concentration ellipses and k-inertia ellipses</p></a></li>
<li><a href='#ggadd_supind'><p>Plot of supplementary individuals</p></a></li>
<li><a href='#ggadd_supvar'><p>Plot of a categorical supplementary variable</p></a></li>
<li><a href='#ggadd_supvars'><p>Plot of categorical supplementary variables</p></a></li>
<li><a href='#ggaxis_variables'><p>Plot of variables on a single axis</p></a></li>
<li><a href='#ggbootvalid_supvars'><p>Ellipses of bootstrap validation (supplementary variables)</p></a></li>
<li><a href='#ggbootvalid_variables'><p>Ellipses of bootstrap validation (active variables)</p></a></li>
<li><a href='#ggcloud_indiv'><p>Plot of the cloud of individuals</p></a></li>
<li><a href='#ggcloud_variables'><p>Plot of the cloud of variables</p></a></li>
<li><a href='#ggeta2_variables'><p>eta-squared plot</p></a></li>
<li><a href='#ggsmoothed_supvar'><p>Plots the density a supplementary variable</p></a></li>
<li><a href='#gPCA'><p>Generalized Principal Component Analysis</p></a></li>
<li><a href='#homog.test'><p>Homogeneity test for a categorical supplementary variable</p></a></li>
<li><a href='#ijunk'><p>App for junk categories of specific MCA</p></a></li>
<li><a href='#MCAiv'><p>Multiple Correspondence Analysis with Instrumental Variables</p></a></li>
<li><a href='#MCAoiv'><p>Multiple Correspondence Analysis with Orthogonal Instrumental Variables</p></a></li>
<li><a href='#medoids'><p>Medoids of clusters</p></a></li>
<li><a href='#modif.rate'><p>Benzecri's modified rates of variance</p></a></li>
<li><a href='#multiMCA'><p>Multiple Factor Analysis</p></a></li>
<li><a href='#Music'><p>Music (data)</p></a></li>
<li><a href='#nsCA'><p>Nonsymmetric Correspondence Analysis</p></a></li>
<li><a href='#nsca.biplot'><p>Biplot for Nonsymmetric Correspondence Analysis</p></a></li>
<li><a href='#PCAiv'><p>Principal Component Analysis with Instrumental Variables</p></a></li>
<li><a href='#PCAoiv'><p>Principal Component Analysis with Orthogonal Instrumental Variables</p></a></li>
<li><a href='#planecontrib'><p>Contributions to a plane</p></a></li>
<li><a href='#plot.csMCA'><p>Plot of class specific MCA</p></a></li>
<li><a href='#plot.multiMCA'><p>Plot of Multiple Factor Analysis</p></a></li>
<li><a href='#plot.speMCA'><p>Plot of specific MCA</p></a></li>
<li><a href='#plot.stMCA'><p>Plot of standardized MCA</p></a></li>
<li><a href='#quadrant'><p>Quadrant of active individuals</p></a></li>
<li><a href='#quasindep'><p>Quasi-correspondence analysis</p></a></li>
<li><a href='#rvcoef'><p>RV coefficient</p></a></li>
<li><a href='#speMCA'><p>specific MCA</p></a></li>
<li><a href='#stMCA'><p>Standardized MCA</p></a></li>
<li><a href='#supind'><p>Statistics for supplementary individuals</p></a></li>
<li><a href='#supvar'><p>Statistics for a categorical supplementary variable</p></a></li>
<li><a href='#supvars'><p>Statistics for categorical supplementary variables</p></a></li>
<li><a href='#tabcontrib'><p>Table with the main contributions of categories to an axis</p></a></li>
<li><a href='#Taste'><p>Taste (data)</p></a></li>
<li><a href='#textindsup'><p>Plot of supplementary individuals</p></a></li>
<li><a href='#textvarsup'><p>Plot of a categorical supplementary variable</p></a></li>
<li><a href='#translate.logit'><p>Deprecated function</p></a></li>
<li><a href='#wcMCA'><p>Within-class MCA</p></a></li>
<li><a href='#wcPCA'><p>Within-class Principal Component Analysis</p></a></li>
<li><a href='#wtable'><p>Deprecated functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Geometric Data Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>descriptio (&ge; 1.2), FactoMineR, ggplot2, ggrepel, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, rmarkdown, knitr, rmdformats, TraMineR, sf, shiny,
miniUI, esquisse, rclipboard, factoextra, ade4</td>
</tr>
<tr>
<td>Description:</td>
<td>Many tools for Geometric Data Analysis (Le Roux &amp; Rouanet (2005) &lt;<a href="https://doi.org/10.1007%2F1-4020-2236-0">doi:10.1007/1-4020-2236-0</a>&gt;), such as MCA variants (Specific Multiple Correspondence Analysis, Class Specific Analysis), many graphical and statistical aids to interpretation (structuring factors, concentration ellipses, inductive tests, bootstrap validation, etc.) and multiple-table analysis (Multiple Factor Analysis, between- and inter-class analysis, Principal Component Analysis and Correspondence Analysis with Instrumental Variables, etc.).</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nicolas-robette/GDAtools">https://github.com/nicolas-robette/GDAtools</a>,
<a href="https://nicolas-robette.github.io/GDAtools/">https://nicolas-robette.github.io/GDAtools/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nicolas-robette/GDAtools/issues">https://github.com/nicolas-robette/GDAtools/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-07 09:02:14 UTC; nicolas</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicolas Robette [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicolas Robette &lt;nicolas.robette@uvsq.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-07 09:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='ahc.plots'>Plots for Ascending Hierarchical Clustering</h2><span id='topic+ahc.plots'></span>

<h3>Description</h3>

<p>Draws various plots for Ascending Hierarchical Clustering results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ahc.plots(ahc, distance = NULL, max.cl = 20, type = "dist")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ahc.plots_+3A_ahc">ahc</code></td>
<td>
<p>object of class <code>hclust</code> or <code>agnes</code></p>
</td></tr>
<tr><td><code id="ahc.plots_+3A_distance">distance</code></td>
<td>
<p>A dissimilarity matrix or a <code>dist</code> object. Only used if <code>type</code> is &quot;inert&quot; or &quot;loss&quot;. Default is NULL.</p>
</td></tr>
<tr><td><code id="ahc.plots_+3A_max.cl">max.cl</code></td>
<td>
<p>Integer. Maximum number of clusters taken into account in the plots.</p>
</td></tr>
<tr><td><code id="ahc.plots_+3A_type">type</code></td>
<td>
<p>Character string. If &quot;dist&quot; (default), the distance between agregated clusters is plotted. If &quot;inert&quot;, it is the percentage of explained inertia (pseudo-R2). If &quot;loss&quot;, it is the relative loss of explained inertia (pseudo-R2).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The three kinds of plots proposed with this function are aimed at guiding in the choice of the number of clusters.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+dist.chi2">dist.chi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Taste)
# clustering of a subsample of the data
disjonctif &lt;- dichotom(Taste[1:200, 1:11])
distance &lt;- dist(disjonctif)
cah &lt;- stats::hclust(distance, method = "ward.D2")
# distance between aggregated clusters
ahc.plots(cah, max.cl = 15, type = "dist")
# percentage of explained inertia
ahc.plots(cah, distance = distance, max.cl = 15, type = "inert")
# relative loss of explained inertia
ahc.plots(cah, distance = distance, max.cl = 15, type = "loss")
</code></pre>

<hr>
<h2 id='angles.csa'>Cosine similarities and angles between CSA and MCA</h2><span id='topic+angles.csa'></span>

<h3>Description</h3>

<p>Computes the cosines similarities and angles between the components of a CSA and those of a MCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>angles.csa(rescsa, resmca)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="angles.csa_+3A_rescsa">rescsa</code></td>
<td>
<p>object of class <code>csMCA</code></p>
</td></tr>
<tr><td><code id="angles.csa_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code> or <code>speMCA</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of matrices:
</p>
<table role = "presentation">
<tr><td><code>cosines</code></td>
<td>
<p>Cosine similarities</p>
</td></tr>
<tr><td><code>angles</code></td>
<td>
<p>Angles</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is adapted from <code>csa.measures</code> in <code>sco.ca</code> package.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="FactoMineR.html#topic+MCA">MCA</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Performs a specific MCA and a CSA on the Music example data set
## and computes cosine similarities and angles
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
resmca &lt;- speMCA(Music[,1:5], excl = junk)
female &lt;- Music$Gender=="Women"
rescsa &lt;- csMCA(Music[,1:5], subcloud = female, excl = junk)
angles.csa(rescsa, resmca)
</code></pre>

<hr>
<h2 id='barplot_contrib'>Bar plot of contributions</h2><span id='topic+barplot_contrib'></span>

<h3>Description</h3>

<p>From MCA results, plots contributions to the axes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>
barplot_contrib(resmca, dim = 1, which = "var",
  sort = FALSE, col = "tomato4", repel = FALSE)
  </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="barplot_contrib_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>PCA</code> or <code>CA</code></p>
</td></tr>
<tr><td><code id="barplot_contrib_+3A_dim">dim</code></td>
<td>
<p>the dimension to use. Default is 1.</p>
</td></tr>
<tr><td><code id="barplot_contrib_+3A_which">which</code></td>
<td>
<p>If <code>resmca</code> is of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code> or <code>PCA</code>, should be <code>"var"</code> to plot contributions of variables or <code>"ind"</code> to plot contributions of individuals. If <code>resmca</code> is of class <code>CA</code>, should be <code>"row"</code> to plot contributions of rows or <code>"col"</code> to plot contributions of columns. Default is <code>"var"</code>.</p>
</td></tr>
<tr><td><code id="barplot_contrib_+3A_sort">sort</code></td>
<td>
<p>logical. If <code>TRUE</code>, bars are sorted by decreasing VIPs. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="barplot_contrib_+3A_col">col</code></td>
<td>
<p>color of the bars</p>
</td></tr>
<tr><td><code id="barplot_contrib_+3A_repel">repel</code></td>
<td>
<p>logical. If <code>TRUE</code>, the names of the variables are repelled with <code>geom_text_repel</code>. Default is <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contributions are multiplied by the sign of the coordinates, so that the plot shows on which side of the axis they contribute, which makes the interpretation easier.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+tabcontrib">tabcontrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on the Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# contributions of categories
barplot_contrib(mca)
</code></pre>

<hr>
<h2 id='bcMCA'>Between-class MCA</h2><span id='topic+bcMCA'></span>

<h3>Description</h3>

<p>Between-class MCA, also called Barycentric Discriminant Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcMCA(data, class, excl = NULL, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcMCA_+3A_data">data</code></td>
<td>
<p>data frame with only categorical variables, i.e. factors</p>
</td></tr>
<tr><td><code id="bcMCA_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="bcMCA_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="bcMCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="bcMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Between-class MCA is sometimes also called Barycentric Discriminant Analysis or Discriminant Correspondence Analysis. It consists in three steps :
1. Transformation of <code>data</code> into an indicator matrix (i.e. disjunctive table)
2. Computation of the barycenter of the transformed data for each category of <code>class</code>
3. Correspondence Analysis of the set of barycenters
Between-class MCA can also be viewed as a special case of MCA with instrumental variables, with only one categorical instrumental variable.
</p>


<h3>Value</h3>

<p>An object of class <code>CA</code> from <code>FactoMineR</code> package, with the indicator matrix of <code>data</code> as supplementary rows, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the between-class inertia percentage</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Abdi H., 2007, &quot;Discriminant Correspondence Analysis&quot;, In: Neil Salkind (Ed.), <em>Encyclopedia of Measurement and Statistics</em>, Thousand Oaks (CA): Sage. 
</p>
<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DAQ">DAQ</a></code>, <code><a href="#topic+MCAiv">MCAiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(tea)
res &lt;- bcMCA(tea[,1:18], tea$SPC)
# categories of class
plot(res, invisible = c("col", "row.sup"))
# Variables in tea data
plot(res, invisible = c("row", "row.sup"))
# between-class inertia percentage
res$ratio
</code></pre>

<hr>
<h2 id='bcPCA'>Between-class Principal Component Analysis</h2><span id='topic+bcPCA'></span>

<h3>Description</h3>

<p>Between-class Principal Component Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcPCA(data, class, row.w = NULL, scale.unit = TRUE, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcPCA_+3A_data">data</code></td>
<td>
<p>data frame with only numeric variables</p>
</td></tr>
<tr><td><code id="bcPCA_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="bcPCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="bcPCA_+3A_scale.unit">scale.unit</code></td>
<td>
<p>logical. If TRUE (default) then data are scaled to unit variance.</p>
</td></tr>
<tr><td><code id="bcPCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Between-class Principal Component Analysis consists in two steps :
1. Computation of the barycenter of <code>data</code> rows for each category of <code>class</code>
2. Principal Component Analysis of the set of barycenters
</p>
<p>It is a quite similar to Linear Discriminant Analysis, but the metric is different.
</p>
<p>It can be seen as a special case of PCA with instrumental variables, with only one categorical instrumental variable.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with the original data as supplementary individuals, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the between-class inertia percentage</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PCAiv">PCAiv</a></code>, <code><a href="#topic+DA">DA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
points &lt;- cut(decathlon$Points, c(7300, 7800, 8000, 8120, 8900), c("Q1","Q2","Q3","Q4"))
res &lt;- bcPCA(decathlon[,1:10], points)
# categories of class
plot(res, choix = "ind", invisible = "ind.sup")
# variables in decathlon data
plot(res, choix = "var")
# between-class inertia percentage
res$ratio
</code></pre>

<hr>
<h2 id='bootvalid_supvars'>Bootstrap validation (supplementary variables)</h2><span id='topic+bootvalid_supvars'></span>

<h3>Description</h3>

<p>Bootstrap validation of MCA, through the computation of the coordinates of supplementary variables for bootstrap replications of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootvalid_supvars(resmca, vars = NULL, axes = c(1,2), K = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootvalid_supvars_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>speMCA</code>.</p>
</td></tr>
<tr><td><code id="bootvalid_supvars_+3A_vars">vars</code></td>
<td>
<p>a data frame of categorical supplementary variables. All these variables should be factors.</p>
</td></tr>
<tr><td><code id="bootvalid_supvars_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="bootvalid_supvars_+3A_k">K</code></td>
<td>
<p>integer. Number of bootstrap replications (default is 30).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap technique is used here as an internal and non-parametric validation procedure of the results of a multiple correspondence analysis. For supplementary variables, only &quot;partial bootstrap&quot; is possible. The partial bootstrap does not compute new MCAs: it projects bootstrap replications of the initial data as supplementary elements of the MCA (see references for more details).
</p>


<h3>Value</h3>

<p>A data frame with the following elements :
</p>
<table role = "presentation">
<tr><td><code>varcat</code></td>
<td>
<p>Names of the active categories</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Indexes of the bootstrap replications</p>
</td></tr>
<tr><td><code>dim.x</code></td>
<td>
<p>Bootstrap coordinates on the first selected axis</p>
</td></tr>
<tr><td><code>dim.y</code></td>
<td>
<p>Bootstrap coordinates on the second selected axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Lebart L. (2006). &quot;Validation Techniques in Multiple Correspondence Analysis&quot;. In M. Greenacre et J. Blasius (eds), <em>Multiple Correspondence Analysis and related techniques</em>, Chapman and Hall/CRC, p.179-196.
</p>
<p>Lebart L. (2007). &quot;Which bootstrap for principal axes methods?&quot;. In P. Brito et al. (eds), <em>Selected Contributions in Data Analysis and Classification</em>, Springer, p.581-588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggbootvalid_supvars">ggbootvalid_supvars</a></code>, <code><a href="#topic+bootvalid_variables">bootvalid_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
resmca &lt;- speMCA(Taste[,1:11], excl = junk)
supvars &lt;- Taste[,c("Gender", "Age", "Educ")]
bv &lt;- bootvalid_supvars(resmca, supvars, K = 5)
str(bv)
</code></pre>

<hr>
<h2 id='bootvalid_variables'>Bootstrap validation (active variables)</h2><span id='topic+bootvalid_variables'></span>

<h3>Description</h3>

<p>Bootstrap validation of MCA, through the computation of the coordinates of active variables for bootstrap replications of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootvalid_variables(resmca, axes = c(1,2), type = "partial", K = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootvalid_variables_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>speMCA</code>.</p>
</td></tr>
<tr><td><code id="bootvalid_variables_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="bootvalid_variables_+3A_type">type</code></td>
<td>
<p>character string. Can be &quot;partial&quot;, &quot;total1&quot;, &quot;total2&quot; or &quot;total3&quot; (see details). Default is &quot;partial&quot;.</p>
</td></tr>
<tr><td><code id="bootvalid_variables_+3A_k">K</code></td>
<td>
<p>integer. Number of bootstrap replications (default is 30).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap technique is used here as an internal and non-parametric validation procedure of the results of a multiple correspondence analysis. Following the work of Ludovic Lebart, several methods are proposed. The &quot;total bootstrap&quot; uses new MCAs computed from bootstrap replications of the initial data. In the type 1 total bootstrap (<code>type</code> = &quot;total1&quot;), the sign of the coordinates is corrected if necessary (the direction of the axes of an ACM being arbitrary). In type 2 (<code>type</code> = &quot;total2&quot;), the order of the axes and the sign of the coordinates are corrected if necessary. In type 3 (<code>type</code> = &quot;total3&quot;), a procrustean rotation is used to find the best superposition between the initial axes and the replicated axes.
The &quot;partial bootstrap&quot;&quot; (<code>type</code> = &quot;partial&quot;) does not compute new MCAs: it projects bootstrap replications of the initial data as supplementary elements of the MCA. It gives a more optimistic view of the stability of the results than the total bootstrap. It also runs faster. See references for more details, pros and cons of the various types, etc.
</p>


<h3>Value</h3>

<p>A data frame with the following elements :
</p>
<table role = "presentation">
<tr><td><code>varcat</code></td>
<td>
<p>Names of the active categories</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Indexes of the bootstrap replications</p>
</td></tr>
<tr><td><code>dim.x</code></td>
<td>
<p>Bootstrap coordinates on the first selected axis</p>
</td></tr>
<tr><td><code>dim.y</code></td>
<td>
<p>Bootstrap coordinates on the second selected axis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Lebart L. (2006). &quot;Validation Techniques in Multiple Correspondence Analysis&quot;. In M. Greenacre et J. Blasius (eds), <em>Multiple Correspondence Analysis and related techniques</em>, Chapman and Hall/CRC, p.179-196.
</p>
<p>Lebart L. (2007). &quot;Which bootstrap for principal axes methods?&quot;. In P. Brito et al. (eds), <em>Selected Contributions in Data Analysis and Classification</em>, Springer, p.581-588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggbootvalid_variables">ggbootvalid_variables</a></code>, <code><a href="#topic+bootvalid_supvars">bootvalid_supvars</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
resmca &lt;- speMCA(Taste[,1:11], excl = junk)
bv &lt;- bootvalid_variables(resmca, type = "partial", K = 5)
str(bv)
</code></pre>

<hr>
<h2 id='burt'>Burt table</h2><span id='topic+burt'></span>

<h3>Description</h3>

<p>Computes a Burt table from a data frame composed of categorical variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>burt(data)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="burt_+3A_data">data</code></td>
<td>
<p>data frame with n rows (individuals) and p columns (categorical variables)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A Burt table is a symmetric table that is used in correspondence analysis. 
It shows the frequencies for all combinations of categories of pairs of variables.
</p>


<h3>Value</h3>

<p>Returns a square matrix. Its dimension is equal to the total number of categories in the data frame.</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dichotom">dichotom</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Burt table of variables in columns 1 to 5
## in the Music example data set
data(Music)
burt(Music[,1:5])
</code></pre>

<hr>
<h2 id='coiMCA'>Coinertia analysis between two groups of categorical variables</h2><span id='topic+coiMCA'></span>

<h3>Description</h3>

<p>Coinertia analysis between two groups of categorical variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coiMCA(Xa, Xb, 
       excl.a = NULL, excl.b = NULL,
       row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coiMCA_+3A_xa">Xa</code></td>
<td>
<p>data frame with the first group of categorical variables</p>
</td></tr>
<tr><td><code id="coiMCA_+3A_xb">Xb</code></td>
<td>
<p>data frame with the second group of categorical variables</p>
</td></tr>
<tr><td><code id="coiMCA_+3A_excl.a">excl.a</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories in <code>Xa</code> (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="coiMCA_+3A_excl.b">excl.b</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories in <code>Xb</code> (default is NULL). See <code>excl.a</code> argument.</p>
</td></tr>
<tr><td><code id="coiMCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="coiMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coinertia analysis aims at capturing the structure common to two groups of variables. With groups of numerical variables, it is equivalent to Tucker's inter-battery analysis.
With categorical data, it consists in the following steps :
1. Transformation of <code>Xa</code> and <code>Xb</code> into indicator matrices (i.e. disjunctive tables) <code>Xad</code> and <code>Xbd</code>
2. Computation of the covariance matrix t(Xad).Xbd
3. CA of the matrix
</p>


<h3>Value</h3>

<p>An object of class <code>CA</code> from <code>FactoMineR</code> package, with an additional item :
</p>
<table role = "presentation">
<tr><td><code>RV</code></td>
<td>
<p>the RV coefficient between the two groups of variabels</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Tucker, L.R.. (1958) An inter-battery method of factor analysis. <em>Psychometrika</em>, 23-2, 111-136.
</p>
<p>Dolédec, S. and Chessel, D. (1994) Co-inertia analysis: an alternative method for studying species-environment relationships. <em>Freshwater Biology</em>, 31, 277–294.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coiPCA">coiPCA</a></code>, <code><a href="#topic+rvcoef">rvcoef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
# music tastes
Xa &lt;- Music[,1:5]
# gender and age
Xb &lt;- Music[,6:7]
# coinertia analysis
res &lt;- coiMCA(Xa, Xb)
plot(res)
# RV coefficient
res$RV
</code></pre>

<hr>
<h2 id='coiPCA'>Coinertia analysis between two groups of numerical variables</h2><span id='topic+coiPCA'></span>

<h3>Description</h3>

<p>Coinertia analysis between two groups of numerical variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coiPCA(Xa, Xb, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coiPCA_+3A_xa">Xa</code></td>
<td>
<p>data frame with the first group of numerical variables</p>
</td></tr>
<tr><td><code id="coiPCA_+3A_xb">Xb</code></td>
<td>
<p>data frame with the second group of numerical variables</p>
</td></tr>
<tr><td><code id="coiPCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="coiPCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Coinertia analysis aims at capturing the structure common to two groups of variables. With groups of numerical variables, it is equivalent to Tucker's inter-battery analysis.
It consists in the following steps :
1. Variables in Xa and Xb are centered and scaled
2. Computation of the covariance matrix t(Xa).Xb
3. PCA of the matrix
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with an additional item :
</p>
<table role = "presentation">
<tr><td><code>RV</code></td>
<td>
<p>the RV coefficient between the two groups of variabels</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Tucker, L.R. (1958) An inter-battery method of factor analysis. <em>Psychometrika</em>, 23-2, 111-136.
</p>
<p>Dolédec, S. and Chessel, D. (1994) Co-inertia analysis: an alternative method for studying species-environment relationships. <em>Freshwater Biology</em>, 31, 277–294.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coiMCA">coiMCA</a></code>, <code><a href="#topic+rvcoef">rvcoef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
# variables of results for each sport 
Xa &lt;- decathlon[,1:10]
# rank and points variables
Xb &lt;- decathlon[,11:12]
# coinertia analysis
res &lt;- coiPCA(Xa, Xb)
# plot of variables in Xa
plot(res, choix = "ind")
# plot of variables in Xb
plot(res, choix = "var")
# RV coefficient
res$RV
</code></pre>

<hr>
<h2 id='conc.ellipse'>Concentration ellipses</h2><span id='topic+conc.ellipse'></span>

<h3>Description</h3>

<p>Adds concentration ellipses or other kinds of inertia ellipses to the cloud of individuals of a MCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>conc.ellipse(resmca, var, sel = 1:nlevels(var), axes = c(1, 2),
 kappa = 2, col = rainbow(length(sel)), pcol = rainbow(length(sel)), pcex = 0.2,
 lty = 1, lwd = 1, tcex = 1, text.lab = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conc.ellipse_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>multiMCA</code> or <code>stMCA</code></p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_var">var</code></td>
<td>
<p>supplementary variable to plot</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_sel">sel</code></td>
<td>
<p>numeric vector of indexes of the categories to plot (by default, ellipses are plotted for every categories)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_axes">axes</code></td>
<td>
<p>length 2 vector specifying the components to plot (default is c(1,2))</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_kappa">kappa</code></td>
<td>
<p>numeric. The kappa value (i.e. &quot;index&quot;) of the inertia ellipses. By default, kappa = 2, which means that concentration ellipses are plotted.</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_col">col</code></td>
<td>
<p>vector of colors for the ellipses of plotted categories (by default, rainbow palette is used)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_pcol">pcol</code></td>
<td>
<p>vector of colors for the points at the center of ellipses of plotted categories (by default, rainbow palette is used)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_pcex">pcex</code></td>
<td>
<p>numerical value giving the amount by which points at the center of ellipses should be magnified (default is 0.2)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_lty">lty</code></td>
<td>
<p>line type for ellipses (default is 1)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_lwd">lwd</code></td>
<td>
<p>line width for the ellipses (default is 1)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_tcex">tcex</code></td>
<td>
<p>numerical value giving the amount by which labels at the center of ellipses should be magnified (default is 0.2)</p>
</td></tr>
<tr><td><code id="conc.ellipse_+3A_text.lab">text.lab</code></td>
<td>
<p>whether the labels at the center of ellipses should be displayed (default is TRUE)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>kappa=2</code>, ellipses are called &quot;concentration&quot; ellipses and, for a normally shaped subcloud, contain 86.47 percents of the points of the subcloud. If <code>kappa=1</code>, ellipses are &quot;indicator&quot; ellipses and contain 39.35 percents of the points of the subcloud. If <code>kappa=1.177</code>, ellipses are &quot;median&quot; ellipses and contain 50 percents of the points of the subcloud.
This function has to be used after the cloud of individuals has been drawn.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.speMCA">plot.speMCA</a></code>, <code><a href="#topic+plot.csMCA">plot.csMCA</a></code>, <code><a href="#topic+plot.multiMCA">plot.multiMCA</a></code>, <code><a href="#topic+plot.stMCA">plot.stMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Performs specific MCA (excluding 'NA' categories) of 'Taste' example data set,
## plots the cloud of categories
## and adds concentration ellipses for gender variable
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
plot(mca, type = "i")
conc.ellipse(mca, Taste$Gender)

## Draws a blue concentration ellipse for men only
plot(mca, type = "i")
conc.ellipse(mca, Taste$Gender, sel = 1, col = "blue")
</code></pre>

<hr>
<h2 id='contrib'>Contributions of active variables</h2><span id='topic+contrib'></span>

<h3>Description</h3>

<p>From MCA results, computes contributions of categories and variables to the axes and the overall cloud.</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrib(resmca)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrib_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code> or <code>csMCA</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The contribution of a point to an axis depends both on the distance from the point to the origin point along the axis 
and on the weight of the point. The contributions of points to axes are the main aid to interpretation 
(see Le Roux and Rouanet, 2004 and 2010).
</p>


<h3>Value</h3>

<p>A list of data frames:
</p>
<table role = "presentation">
<tr><td><code>ctr</code></td>
<td>
<p>Data frame with the contributions of categories to axes</p>
</td></tr>
<tr><td><code>var.ctr</code></td>
<td>
<p>Data frame with the contributions of variables to axes</p>
</td></tr>
<tr><td><code>ctr.cloud</code></td>
<td>
<p>Data frame with the contributions of categories to the overall cloud</p>
</td></tr>
<tr><td><code>vctr.cloud</code></td>
<td>
<p>Data frame with the contributions of variables to the overall cloud</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+supvar">supvar</a></code>, <code><a href="#topic+tabcontrib">tabcontrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on the Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# contributions of variables
contrib(mca)
</code></pre>

<hr>
<h2 id='csMCA'>Class Specific Analysis</h2><span id='topic+csMCA'></span>

<h3>Description</h3>

<p>Performs a &quot;class specific&quot;&quot; Multiple Correspondence Analysis, i.e. a variant of MCA consisting in analyzing a subcloud of individuals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>csMCA(data, subcloud = rep(TRUE, times = nrow(data)), excl = NULL, ncp = 5, 
row.w = rep(1, times = nrow(data)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="csMCA_+3A_data">data</code></td>
<td>
<p>data frame with n rows (individuals) and p columns (categorical variables)</p>
</td></tr>
<tr><td><code id="csMCA_+3A_subcloud">subcloud</code></td>
<td>
<p>a vector of logical values and length n. The subcloud of individuals analyzed with class specific MCA is made of the individuals with value <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="csMCA_+3A_excl">excl</code></td>
<td>
<p>nnumeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="csMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (default is 5)</p>
</td></tr>
<tr><td><code id="csMCA_+3A_row.w">row.w</code></td>
<td>
<p>an optional numeric vector of row weights (by default, a vector of 1 for uniform row weights)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This variant of MCA is used to study a subset of individuals with reference to the whole set of individuals, i.e. to determine the specific features of the subset. It consists in proceeding to the search of the principal axes of the subcloud associated with the subset of individuals (see references).
</p>


<h3>Value</h3>

<p>An object of class <code>csMCA</code>, i.e. a list including:
</p>
<table role = "presentation">
<tr><td><code>eig</code></td>
<td>
<p>a list of vectors containing all the eigenvalues, the percentage of variance, the cumulative percentage of variance, the modified rates and the cumulative modified rates</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a list with informations about input data</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>a list of matrices containing the results for the individuals (coordinates, contributions)</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>a list of matrices containing all the results for the categories and variables (weights, coordinates, squared cosines, categories contributions to axes and cloud, test values (v.test), squared correlation ratio (eta2), variable contributions to axes and cloud</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ijunk">ijunk</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># class specific MCA of the subcloud of women
# from the Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
female &lt;- Music$Gender=="Women"
mca &lt;- csMCA(Music[,1:5],
             subcloud = female,
             excl = junk)
plot(mca)
</code></pre>

<hr>
<h2 id='DA'>Discriminant Analysis</h2><span id='topic+DA'></span>

<h3>Description</h3>

<p>Descriptive discriminant analysis, aka &quot;Analyse Factorielle Discriminante&quot; for the French school of multivariate data analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DA(data, class, row.w = NULL, type = "FR")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DA_+3A_data">data</code></td>
<td>
<p>data frame with only numeric variables</p>
</td></tr>
<tr><td><code id="DA_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="DA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="DA_+3A_type">type</code></td>
<td>
<p>If &quot;FR&quot; (default), the inverse of the total covariance matrix is used as metric. If &quot;GB&quot;, it is the inverse of the within-class covariance matrix (Mahalanobis metric), which makes the results equivalent to linear discriminant analysis as implemented in <code>lda</code> function in <code>MASS</code> package.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The results are the same with <code>type</code> &quot;FR&quot; or &quot;GB&quot;, only the eigenvalues vary. With <code>type="FR"</code>, these eigenvalues vary between 0 and 1 and can be interpreted as &quot;discriminant power&quot;.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with <code>class</code> as qualitative supplementary variable, and one additional item :
</p>
<table role = "presentation">
<tr><td><code>cor_ratio</code></td>
<td>
<p>correlation ratios between <code>class</code> and the discriminant factors</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The code is adapted from a script from Marie Chavent.
See: https://marie-chavent.perso.math.cnrs.fr/teaching/
</p>


<h3>Author(s)</h3>

<p>Marie Chavent, Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>
<p>Saporta G., 2006, <em>Probabilités, analyses des données et statistique</em>, Editions Technip.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcPCA">bcPCA</a></code>, <code><a href="#topic+PCAiv">PCAiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
points &lt;- cut(decathlon$Points, c(7300, 7800, 8000, 8120, 8900), c("Q1","Q2","Q3","Q4"))
res &lt;- DA(decathlon[,1:10], points)
# plot of observations colored by class
plot(res, choix = "ind", invisible = "quali", habillage = res$call$quali.sup$numero)
# plot of class categories
plot(res, choix = "ind", invisible = "ind", col.quali = "darkblue")
# plot of variables
plot(res, choix = "varcor", invisible = "none")
</code></pre>

<hr>
<h2 id='DAQ'>Discriminant Analysis of Qualitative Variables</h2><span id='topic+DAQ'></span>

<h3>Description</h3>

<p>Descriptive discriminant analysis (aka &quot;Analyse Factorielle Discriminante&quot; for the French school of multivariate data analysis) with qualitative variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DAQ(data, class, excl = NULL, row.w = NULL,
    type = "FR", select = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DAQ_+3A_data">data</code></td>
<td>
<p>data frame with only categorical variables</p>
</td></tr>
<tr><td><code id="DAQ_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="DAQ_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="DAQ_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="DAQ_+3A_type">type</code></td>
<td>
<p>character string. If &quot;FR&quot; (default), the inverse of the total covariance matrix is used as metric. If &quot;GB&quot;, it is the inverse of the within-class covariance matrix (Mahalanobis metric), which makes the results equivalent to linear discriminant analysis as implemented in <code>lda</code> function in <code>MASS</code> package.</p>
</td></tr>  
<tr><td><code id="DAQ_+3A_select">select</code></td>
<td>
<p>logical. If TRUE (default), only a selection of components of the MCA are used for the discriminant analysis step. The selected components are those corresponding to eigenvalues higher of equal to 1/Q, with Q the number of variables in <code>data</code>. If FALSE, all components are used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This approach is also known as &quot;disqual&quot; and was developed by G. Saporta (see references). It consists in two steps : 
1. Multiple Correspondence Analysis of the data
2. Discriminant analysis of the components from the MCA
</p>
<p>The results are the same with <code>type</code> &quot;FR&quot; or &quot;GB&quot;, only the eigenvalues vary. With <code>type="FR"</code>, these eigenvalues vary between 0 and 1 and can be interpreted as &quot;discriminant power&quot;.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with <code>class</code> as qualitative supplementary variable and the disjunctive table of <code>data</code> as quantitative supplementary variables, and two additional items :
</p>
<table role = "presentation">
<tr><td><code>cor_ratio</code></td>
<td>
<p>correlation ratios between <code>class</code> and the discriminant factors</p>
</td></tr>
<tr><td><code>mca</code></td>
<td>
<p>an object of class <code>speMCA</code> with the results of the MCA of the first step</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If there are NAs in <code>data</code>, these NAs will be automatically considered as junk categories. If one desires more flexibility, <code>data</code> should be recoded to add explicit factor levels for NAs and then <code>excl</code> option may be used to select the junk categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>
<p>Saporta G., 1977, &quot;Une méthode et un programme d'analyse discriminante sur variables qualitatives&quot;, <em>Premières Journées Internationales, Analyses des données et informatiques</em>, INRIA, Rocquencourt.
</p>
<p>Saporta G., 2006, <em>Probabilités, analyses des données et statistique</em>, Editions Technip.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DA">DA</a></code>, <code><a href="#topic+bcMCA">bcMCA</a></code>, <code><a href="#topic+MCAiv">MCAiv</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(tea)
res &lt;- DAQ(tea[,1:18], tea$SPC)
# plot of observations colored by class
plot(res, choix = "ind", invisible = "quali", 
     label = "quali", habillage = res$call$quali.sup$numero)
# plot of class categories
plot(res, choix = "ind", invisible = "ind", col.quali = "black")
# plot of the variables in data
plot(res, choix = "var", invisible = "var")
# plot of the components of the MCA
plot(res, choix = "varcor", invisible = "quanti.sup")
</code></pre>

<hr>
<h2 id='dichotom'>Dichotomizes the variables in a data frame</h2><span id='topic+dichotom'></span>

<h3>Description</h3>

<p>Dichotomizes the variables in a data frame exclusively composed of categorical variables, i.e. transforms the data into an indicator matrix (also known as disjunctive table)</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichotom(data, out = "numeric")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dichotom_+3A_data">data</code></td>
<td>
<p>data frame of categorical variables</p>
</td></tr>
<tr><td><code id="dichotom_+3A_out">out</code></td>
<td>
<p>character string defining the format for dichotomized variables in the output data frame. 
Format may be &quot;numeric&quot; (default) or &quot;factor&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with dichotomized variables. The number of columns is equal to the total number of categories in the input data.</p>


<h3>Author(s)</h3>

<p>Nicolas Robette, Julien Barnier</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Dichotomizes Music example data frame
data(Music)
dic &lt;- dichotom(Music[,1:5])
str(dic)

## with output variables in factor format
dic &lt;- dichotom(Music[,1:5], out='factor')
str(dic)
</code></pre>

<hr>
<h2 id='dichotomixed'>Dichotomizes the factor variables in a mixed format data frame</h2><span id='topic+dichotomixed'></span>

<h3>Description</h3>

<p>Dichotomizes the factor variables in a data frame composed of mixed format variables, i.e. transforms the factors into an indicator matrix (also known as disjunctive table) and keeps the numerical variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichotomixed(data, out = "numeric")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dichotomixed_+3A_data">data</code></td>
<td>
<p>data frame of categorical and numerical variables</p>
</td></tr>
<tr><td><code id="dichotomixed_+3A_out">out</code></td>
<td>
<p>character string defining the format for dichotomized variables in the output data frame. Format may be &quot;numeric&quot; (default) or &quot;factor&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with numerical variables and dichotomized factor variables</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Dichotomizes Music example data frame
data(Music)
## recodes Age as numerical, for the sake of the example
Music$Age &lt;- as.numeric(Music$Age)
## dichotomization
dic &lt;- dichotomixed(Music)
str(dic)
</code></pre>

<hr>
<h2 id='dimcontrib'>Description of the contributions to axes</h2><span id='topic+dimcontrib'></span>

<h3>Description</h3>

<p>Identifies the categories and individuals that contribute the most to each dimension obtained 
by a Multiple Correspondence Analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimcontrib(resmca, dim = c(1,2), best = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dimcontrib_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="dimcontrib_+3A_dim">dim</code></td>
<td>
<p>numerical vector of the dimensions to describe (default is c(1,2))</p>
</td></tr>
<tr><td><code id="dimcontrib_+3A_best">best</code></td>
<td>
<p>logical. If FALSE, displays all the categories. If TRUE (default), displays only categories and individuals with contributions higher than average</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Contributions are sorted and assigned a positive or negative sign according to the corresponding categories or individuals coordinates, so as to facilitate interpretation.
</p>


<h3>Value</h3>

<p>Returns a list with the following items : 
</p>
<table role = "presentation">
<tr><td><code>var</code></td>
<td>
<p>a list of categories contributions to axes</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>a list of individuals contributions to axes</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tabcontrib">tabcontrib</a></code>, <code><a href="#topic+dimdescr">dimdescr</a></code>, <code><a href="#topic+dimeta2">dimeta2</a></code>, <code><a href="#topic+dimtypicality">dimtypicality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# contributions to axes 1 and 2
dimcontrib(mca)
</code></pre>

<hr>
<h2 id='dimdescr'>Description of the dimensions</h2><span id='topic+dimdescr'></span>

<h3>Description</h3>

<p>Identifies the variables and the categories that are the most characteristic according to each dimension obtained by a MCA. It is inspired by <code><a href="FactoMineR.html#topic+dimdesc">dimdesc</a></code> function in <code>FactoMineR</code> package (see Husson et al, 2010), but allows to analyze variants of MCA, such as specific MCA or class specific MCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimdescr(resmca, vars = NULL, dim = c(1,2), 
         limit = NULL, correlation = "pearson",
         na.rm.cat = FALSE, na.value.cat = "NA", na.rm.cont = FALSE,
         nperm = NULL, distrib = "asympt",
         shortlabs = TRUE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dimdescr_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="dimdescr_+3A_vars">vars</code></td>
<td>
<p>data frame of variables to describes the MCA dimensions with. If NULL (default), the active variables of the MCA will be used.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_dim">dim</code></td>
<td>
<p>the dimensions which are described. Default is c(1,2)</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_limit">limit</code></td>
<td>
<p>for the relationship between a dimension and a categorical variable, only associations (measured with point-biserial correlations) higher or equal to limit will be displayed. If NULL (default), they are all displayed.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_correlation">correlation</code></td>
<td>
<p>character string. The type of correlation measure to be used between two numerical variables : &quot;pearson&quot; (default), &quot;spearman&quot; or &quot;kendall&quot;.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_na.rm.cat">na.rm.cat</code></td>
<td>
<p>logical, indicating whether NA values in the categorical variables should be silently removed before the computation proceeds. If FALSE (default), an additional level is added to the categorical variables (see na.value.cat argument).</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_na.value.cat">na.value.cat</code></td>
<td>
<p>character string. Name of the level for NA category. Default is &quot;NA&quot;. Only used if <code>na.rm.cat = FALSE</code>.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_na.rm.cont">na.rm.cont</code></td>
<td>
<p>logical indicating whether NA values in the numerical variables should be silently removed before the computation proceeds. Default is FALSE.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_nperm">nperm</code></td>
<td>
<p>numeric. Number of permutations for the permutation tests of independence. If NULL (default), no permutation test is performed.</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_distrib">distrib</code></td>
<td>
<p>the null distribution of permutation test of independence can be approximated by its asymptotic distribution (<code>"asympt"</code>, default) or via Monte Carlo resampling (<code>"approx"</code>).</p>
</td></tr>
<tr><td><code id="dimdescr_+3A_shortlabs">shortlabs</code></td>
<td>
<p>logical. If TRUE (default), the data frame will have short column names, so that all columns can be displayed side by side on a laptop screen.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+condesc">condesc</a></code>.
</p>


<h3>Value</h3>

<p>Returns a list of <code>ncp</code> lists including: 
</p>
<table role = "presentation">
<tr><td><code>variables</code></td>
<td>
<p>associations between dimensions of the MCA and the variables in <code>vars</code></p>
</td></tr>
<tr><td><code>categories</code></td>
<td>
<p>a data frame with categorical variables from <code>vars</code> and associations measured by correlation coefficients</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Husson, F., Le, S. and Pages, J. (2010). <em>Exploratory Multivariate Analysis by Example Using R</em>, Chapman and Hall.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+condesc">condesc</a></code>, <code><a href="#topic+dimcontrib">dimcontrib</a></code>, <code><a href="#topic+dimeta2">dimeta2</a></code>, <code><a href="#topic+dimtypicality">dimtypicality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# description of the dimensions
dimdescr(mca, limit = 0.1, nperm = 10)
</code></pre>

<hr>
<h2 id='dimeta2'>Correlation ratios (aka eta-squared) of supplementary variables</h2><span id='topic+dimeta2'></span>

<h3>Description</h3>

<p>Computes correlation ratios (also known as eta-squared) for a list of supplementary variables of a MCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimeta2(resmca, vars, dim = c(1,2))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dimeta2_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="dimeta2_+3A_vars">vars</code></td>
<td>
<p>a data frame of supplementary variables</p>
</td></tr>
<tr><td><code id="dimeta2_+3A_dim">dim</code></td>
<td>
<p>the axes for which eta2 are computed. Default is c(1,2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with supplementary variables as rows and MCA axes as columns.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dimdescr">dimdescr</a></code>, <code><a href="#topic+dimcontrib">dimcontrib</a></code>, <code><a href="#topic+dimtypicality">dimtypicality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# correlation ratios
dimeta2(mca, Music[, c("Gender", "Age")])
</code></pre>

<hr>
<h2 id='dimtypicality'>Typicality tests for supplementary variables</h2><span id='topic+dimtypicality'></span>

<h3>Description</h3>

<p>Computes typicality tests for a list of supplementary variables of a MCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dimtypicality(resmca, vars, dim = c(1,2), max.pval = 1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dimtypicality_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="dimtypicality_+3A_vars">vars</code></td>
<td>
<p>a data frame of supplementary variables</p>
</td></tr>
<tr><td><code id="dimtypicality_+3A_dim">dim</code></td>
<td>
<p>the axes for which typicality tests are computed. Default is c(1,2)</p>
</td></tr>
<tr><td><code id="dimtypicality_+3A_max.pval">max.pval</code></td>
<td>
<p>only categories with a p-value lower or equal to <code>max.pval</code> are displayed. If 1 (default), all categories are displayed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of data frames giving the typicality test statistics and p-values of the supplementary categories for the different axes.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dimdescr">dimdescr</a></code>, <code><a href="#topic+dimeta2">dimeta2</a></code>, <code><a href="#topic+dimcontrib">dimcontrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# typicality tests for gender and age
dimtypicality(mca, Music[, c("Gender", "Age")])
</code></pre>

<hr>
<h2 id='dist.chi2'>Chi-squared distance</h2><span id='topic+dist.chi2'></span>

<h3>Description</h3>

<p>Computes the chi-squared distance between the rows of a data frame of factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.chi2(X)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dist.chi2_+3A_x">X</code></td>
<td>
<p>data frame. All variables should be factors.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adapted from <code>chi2Dist</code> function in <code>ExPosition</code> package.
</p>


<h3>Value</h3>

<p>A symmetrical matrix of distances
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
d &lt;- dist.chi2(Music[,1:5])
# a short piece of the distance matrix
d[1:3, 1:3]
</code></pre>

<hr>
<h2 id='flip.mca'>Flips the coordinates</h2><span id='topic+flip.mca'></span>

<h3>Description</h3>

<p>Flips the coordinates of the individuals and the categories on one or more dimensions of a MCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>flip.mca(resmca, dim = 1)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flip.mca_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="flip.mca_+3A_dim">dim</code></td>
<td>
<p>numerical vector of the dimensions for which the coordinates are flipped. By default, only the first dimension is flipped</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of the same class as <code>resmca</code>
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># MCA of Music example data set
data(Music)
mca &lt;- speMCA(Music[,1:5])
ggcloud_variables(mca, legend = "none")
# Flips dimensions 1 and 2
flipped_mca &lt;- flip.mca(mca, dim = c(1,2))
ggcloud_variables(flipped_mca, legend = "none")
</code></pre>

<hr>
<h2 id='getindexcat'>Names of the categories in a data frame</h2><span id='topic+getindexcat'></span>

<h3>Description</h3>

<p>Returns a vector of names corresponding the the categories in a data frame exclusively composed of categorical variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getindexcat(data)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getindexcat_+3A_data">data</code></td>
<td>
<p>data frame of categorical variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function may be useful prior to a specific MCA, to identify the indexes of the 'junk' categories to exclude.</p>


<h3>Value</h3>

<p>Returns a character vector with the names of the categories of the variables in the data frame</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+ijunk">ijunk</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
getindexcat(Music[,1:5])
mca &lt;- speMCA(Music[,1:5], excl = c(3,6,9,12,15))
</code></pre>

<hr>
<h2 id='ggadd_attractions'>Plot of attractions between categories</h2><span id='topic+ggadd_attractions'></span>

<h3>Description</h3>

<p>Adds attractions between categories, as measured by phi coefficients or percentages of maximum deviation (PEM), by plotting segments onto a MCA cloud of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_attractions(p, resmca, axes = c(1,2), measure = "phi", min.asso = 0.3,
col.segment = "lightgray", col.text = "black", text.size = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_attractions_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_measure">measure</code></td>
<td>
<p>character string. The measure for attractions: &quot;phi&quot; (default) for phi coefficients, &quot;pem&quot; for percentages of maximum deviation (PEM).</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_min.asso">min.asso</code></td>
<td>
<p>numerical value ranging from 0 to 1. The minimal attraction value for segments to be plotted. Default is 0.3.</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_col.segment">col.segment</code></td>
<td>
<p>Character string with the color of the segments. Default is lightgray.</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_col.text">col.text</code></td>
<td>
<p>Character string with the color of the labels of the categories. Default is black.</p>
</td></tr>
<tr><td><code id="ggadd_attractions_+3A_text.size">text.size</code></td>
<td>
<p>Size of the labels of categories. Default is 3.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Cibois, Philippe. <em>Les méthodes d’analyse d’enquêtes</em>. Nouvelle édition [en ligne]. Lyon: ENS Éditions, 2014. &lt;http://books.openedition.org/enseditions/1443&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# Plots attractions
p &lt;- ggcloud_variables(mca, col="white", legend="none")
ggadd_attractions(p, mca, measure="phi", min.asso=0.1)
</code></pre>

<hr>
<h2 id='ggadd_chulls'>Convex hulls for a categorical supplementary variable</h2><span id='topic+ggadd_chulls'></span>

<h3>Description</h3>

<p>Adds convex hulls for a categorical variable to a MCA cloud of individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_chulls(p, resmca, var, sel = 1:nlevels(var), axes = c(1,2), prop = 1, 
alpha = 0.2, label = TRUE, label.size = 5, legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_chulls_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of individuals</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_var">var</code></td>
<td>
<p>Factor. The categorical variable used to plot chulls.</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_sel">sel</code></td>
<td>
<p>numeric vector of indexes of the categories to plot (by default, ellipses are plotted for every categories)</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_prop">prop</code></td>
<td>
<p>proportion of all the points to be included in the hull (default is 1).</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_alpha">alpha</code></td>
<td>
<p>Numerical value from 0 to 1. Transparency of the polygon's fill. Default is O.2</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_label">label</code></td>
<td>
<p>Logical. Should the labels of the categories be plotted at the center of chulls ? Default is TRUE.</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_label.size">label.size</code></td>
<td>
<p>Size of the labels of the categories at the center of chulls. Default is 5.</p>
</td></tr>
<tr><td><code id="ggadd_chulls_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>Chulls are colored according to the categories of the variable, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> and <code>scale_fill_*</code> functions, such as <code>scale_color_brewer()</code> and <code>scale_fill_brewer()</code>, <code>scale_color_grey()</code> and <code>scale_fill_grey()</code>, or <code>scale_color_manual()</code> and <code>scale_fill_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# hierarchical clustering 
# and partition of the individuals into 3 clusters
d &lt;- dist(mca$ind$coord[, c(1,2)])
hca &lt;- hclust(d, "ward.D2")
cluster &lt;- factor(cutree(hca, 3))
# cloud of individuals
# with convex hulls for the clusters.
p &lt;- ggcloud_indiv(mca, col = "black")
ggadd_chulls(p, mca, cluster)
</code></pre>

<hr>
<h2 id='ggadd_corr'>Heatmap of under/over-representation of a supplementary variable</h2><span id='topic+ggadd_corr'></span>

<h3>Description</h3>

<p>Adds a heatmap representing the correlation coefficients to a MCA cloud of individuals, for a numerical supplementary variable or one category of a categorical supplementary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_corr(p, resmca, var, cat = levels(var)[1], axes = c(1,2),
xbins = 20, ybins = 20, min.n = 1, pal = "RdYlBu", limits = NULL, legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_corr_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_var">var</code></td>
<td>
<p>factor or numerical vector. The supplementary variable used for the heatmap.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_cat">cat</code></td>
<td>
<p>character string. The category of <code>var</code> to plot (by default, the first level of <code>var</code> is plotted). Only used if var is a factor.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_xbins">xbins</code></td>
<td>
<p>integer. Number of bins in the x axis. Default is 20.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_ybins">ybins</code></td>
<td>
<p>integer. Number of bins in the y axis. Default is 20.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_min.n">min.n</code></td>
<td>
<p>integer. Minimal number of points for a tile to be drawn. By default, every tiles are drawn.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_pal">pal</code></td>
<td>
<p>character string. Name of a (preferably diverging) palette from the <code>RColorBrewer</code> package. Default is &quot;RdYlBu&quot;.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_limits">limits</code></td>
<td>
<p>numerical vector of length 2. Lower and upper limits of the correlation coefficients for the color scale. Should be centered around 0 for a better view of under/over-representations (for example c(-0.2,0.2)). By default, the maximal absolute value of the correlation coefficients is used.</p>
</td></tr>
<tr><td><code id="ggadd_corr_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each tile of the heatmap, a correlation coefficient is computed between the supplementary variable and the fact of belonging to the tile. This gives a view of the under/over-representation of the supplementary variable according to the position in the cloud of individuals.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# correlation heatmap for Age = 50+
p &lt;- ggcloud_indiv(mca, col = "lightgrey")
ggadd_corr(p, mca, var = Taste$Age, cat = "50+", xbins = 10, ybins = 10)
</code></pre>

<hr>
<h2 id='ggadd_density'>Density plot of a supplementary variable</h2><span id='topic+ggadd_density'></span>

<h3>Description</h3>

<p>For a given category of a supplementary variable, adds a layer representing the density of points to the cloud of individuals, either with contours or areas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_density(p, resmca, var, cat = levels(var)[1], axes = c(1,2),
density = "contour", col.contour = "darkred", pal.area = "viridis",
alpha.area = 0.2, ellipse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_density_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_var">var</code></td>
<td>
<p>factor or numerical vector. The supplementary variable to be plotted.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_cat">cat</code></td>
<td>
<p>character string. The category of <code>var</code> to plot (by default, the first level of <code>var</code> is plotted). Only used if var is a factor.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_density">density</code></td>
<td>
<p>If &quot;contour&quot; (default), density is plotted with contours. If &quot;area&quot;, density is plotted with areas.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_col.contour">col.contour</code></td>
<td>
<p>character string. The color of the contours.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_pal.area">pal.area</code></td>
<td>
<p>character string. The name of a viridis palette for areas.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_alpha.area">alpha.area</code></td>
<td>
<p>numeric. Transparency of the areas. Default is 0.2.</p>
</td></tr>
<tr><td><code id="ggadd_density_+3A_ellipse">ellipse</code></td>
<td>
<p>logical. If TRUE, a concentration ellipse is added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
p &lt;- ggcloud_indiv(mca, col='lightgrey')
# density plot for Age = 50+ (with contours)
ggadd_density(p, mca, var = Taste$Age, cat = "50+")
# density plot for Age = 50+ (with contours)
ggadd_density(p, mca, var = Taste$Age, cat = "50+", density = "area")
</code></pre>

<hr>
<h2 id='ggadd_ellipses'>Confidence ellipses</h2><span id='topic+ggadd_ellipses'></span>

<h3>Description</h3>

<p>Adds confidence ellipses for a categorical variable to a MCA cloud of individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_ellipses(p, resmca, var, sel = 1:nlevels(var), axes = c(1,2),
level = 0.05, label = TRUE, label.size = 3, size = 0.5, points = TRUE,
legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_ellipses_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of individuals</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_var">var</code></td>
<td>
<p>Factor. The categorical variable used to plot ellipses.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_sel">sel</code></td>
<td>
<p>numeric vector of indexes of the categories to plot (by default, ellipses are plotted for every categories)</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_level">level</code></td>
<td>
<p>The level at which to draw an ellipse (see <code>stat_ellipse</code>). Default is 0.05, which means 95 percents confidence ellipses are plotted.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_label">label</code></td>
<td>
<p>Logical. Should the labels of the categories be plotted at the center of ellipses ? Default is TRUE.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_label.size">label.size</code></td>
<td>
<p>Size of the labels of the categories at the center of ellipses. Default is 3.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_size">size</code></td>
<td>
<p>Size of the lines of the ellipses. Default is 0.5.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_points">points</code></td>
<td>
<p>If TRUE (default), the points are coloured according to their subcloud.</p>
</td></tr>
<tr><td><code id="ggadd_ellipses_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A confidence ellipse aims at measuring how the &quot;true&quot; mean point of a category differs from its observed mean point. This is achieved by constructing a confidence zone around the observed mean point. If we choose a conventional level alpha (e.g. 0.05), a (1 - alpha) (e.g. 95 percents) confidence zone is defined as the set of possible mean points that are not significantly different from the observed mean point.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>Ellipses are colored according to the categories of the variable, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# confidence ellipses for Age
p &lt;- ggcloud_indiv(mca, col = "lightgrey")
ggadd_ellipses(p, mca, Music$Age)
</code></pre>

<hr>
<h2 id='ggadd_interaction'>Plot of interactions between two categorical supplementary variables</h2><span id='topic+ggadd_interaction'></span>

<h3>Description</h3>

<p>Adds the interactions between two categorical supplementary variables to a MCA cloud of variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_interaction(p, resmca, v1, v2, sel1 = 1:nlevels(v1), sel2 = 1:nlevels(v2),
axes = c(1,2), textsize = 5, legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_interaction_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_v1">v1</code></td>
<td>
<p>Factor. The first categorical supplementary variable.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_v2">v2</code></td>
<td>
<p>Factor. The second categorical supplementary variable.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_sel1">sel1</code></td>
<td>
<p>Numeric vector of indexes of the categories of the first supplementary variable to be used in interaction. By default, every categories are used.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_sel2">sel2</code></td>
<td>
<p>Numeric vector of indexes of the categories of the second supplementary variable to be used in interaction. By default, every categories are used.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_textsize">textsize</code></td>
<td>
<p>Size of the labels of categories. Default is 5.</p>
</td></tr>
<tr><td><code id="ggadd_interaction_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>Lines and labels are colored according to the variables, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# interaction between Gender and Age
p &lt;- ggcloud_variables(mca, col = "lightgrey", shapes = FALSE)
ggadd_interaction(p, mca, Taste$Gender, Taste$Age)
</code></pre>

<hr>
<h2 id='ggadd_kellipses'>Concentration ellipses and k-inertia ellipses</h2><span id='topic+ggadd_kellipses'></span>

<h3>Description</h3>

<p>Adds concentration ellipses and other kinds of k-inertia ellipses for a categorical variable to a MCA cloud of individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_kellipses(p, resmca, var, sel = 1:nlevels(var), axes = c(1,2),
kappa = 2, label = TRUE, label.size = 3, size = 0.5, points = TRUE,
legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_kellipses_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of individuals</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_var">var</code></td>
<td>
<p>Factor. The categorical variable used to plot ellipses.</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_sel">sel</code></td>
<td>
<p>numeric vector of indexes of the categories to plot (by default, ellipses are plotted for every categories)</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_kappa">kappa</code></td>
<td>
<p>numeric. The kappa value (i.e. &quot;index&quot;) of the inertia ellipses. By default, kappa = 2, which means that concentration ellipses are plotted.</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_label">label</code></td>
<td>
<p>Logical. Should the labels of the categories be plotted at the center of ellipses ? Default is TRUE.</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_label.size">label.size</code></td>
<td>
<p>Size of the labels of the categories at the center of ellipses. Default is 3.</p>
</td></tr>  
<tr><td><code id="ggadd_kellipses_+3A_size">size</code></td>
<td>
<p>Size of the lines of the ellipses. Default is 0.5.</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_points">points</code></td>
<td>
<p>If TRUE (default), the points are coloured according to their subcloud.</p>
</td></tr>
<tr><td><code id="ggadd_kellipses_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If kappa=2, ellipses are called &quot;concentration&quot; ellipses and, for a normally shaped subcloud, contain 86.47 percents of the points of the subcloud. If kappa=1, ellipses are &quot;indicator&quot; ellipses and contain 39.35 percents of the points of the subcloud. If kappa=1.177, ellipses are &quot;median&quot; ellipses and contain 50 percents of the points of the subcloud.
This function has to be used after the cloud of individuals has been drawn.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>Ellipses are colored according to the categories of the variable, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# concentration ellipses for Age
p &lt;- ggcloud_indiv(mca, col = "lightgrey")
ggadd_ellipses(p, mca, Music$Age)
</code></pre>

<hr>
<h2 id='ggadd_supind'>Plot of supplementary individuals</h2><span id='topic+ggadd_supind'></span>

<h3>Description</h3>

<p>Adds supplementary individuals to a MCA cloud of the individuals</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_supind(p, resmca, dfsup, axes = c(1,2), 
col = "black", textsize = 5, pointsize = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_supind_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_dfsup">dfsup</code></td>
<td>
<p>data frame with the supplementary individuals. It must have the same factors as the data frame used as input for the initial MCA.</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the dimensions (axes) to plot (default is c(1,2))</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_col">col</code></td>
<td>
<p>color for the labels and points of the individuals (default is black)</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_textsize">textsize</code></td>
<td>
<p>Size of the labels of the individuals. Default is 5.</p>
</td></tr>
<tr><td><code id="ggadd_supind_+3A_pointsize">pointsize</code></td>
<td>
<p>Size of the points of the individuals. If NULL, only labels are plotted. Default is 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the row names of <code>dfsup</code> as labels for the individuals.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+supind">supind</a></code>, <code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
rownames(Music) &lt;- paste0("i", 1:nrow(Music))
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# adds individuals 1, 20 and 300 as supplementary individuals 
# onto the cloud of individuals
p &lt;- ggcloud_indiv(mca, col = "lightgrey")
ggadd_supind(p, mca, Music[c(1,20,300), 1:5])
</code></pre>

<hr>
<h2 id='ggadd_supvar'>Plot of a categorical supplementary variable</h2><span id='topic+ggadd_supvar'></span>

<h3>Description</h3>

<p>Adds a categorical supplementary variable to a MCA cloud of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_supvar(p, resmca, var, sel = 1:nlevels(var), axes = c(1,2),
col = "black", shape = 1, prop = NULL, textsize = 3, shapesize = 6,
segment = FALSE, vname = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_supvar_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_var">var</code></td>
<td>
<p>Factor. The categorical supplementary variable. It does not need to have been used at the MCA step.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_sel">sel</code></td>
<td>
<p>Numeric vector of indexes of the categories of the supplementary variable to be added to the plot. By default, labels are plotted for every categories.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_col">col</code></td>
<td>
<p>Character. Color of the shapes and labels of the categories. Default is black.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_shape">shape</code></td>
<td>
<p>Symbol to be used in addition the the labels of categories (default is 1). If NULL, only labels are plotted.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_prop">prop</code></td>
<td>
<p>If NULL, the size of the labels (if shape=NULL) or the shapes (otherwise) is constant. If 'n', the size is proportional the the weights of categories; if 'vtest1', the size is proportional to the test values of the categories on the first dimension of the plot; if 'vtest2', the size is proportional to the test values of the categories on the second dimension of the plot; if 'cos1', the size is proportional to the cosines of the categories on the first dimension of the plot; if 'cos2', the size is proportional to the cosines of the categories on the second dimension of the plot; if 'cos12', the size is proportional to the total cosines of the categories on the two dimensions of the plot.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_textsize">textsize</code></td>
<td>
<p>Size of the labels of categories if shape is not NULL, or if shape=NULL and prop=NULL. Default is 3.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_shapesize">shapesize</code></td>
<td>
<p>Size of the shapes if prop=NULL, maximum size of the shapes in other cases. Default is 6.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_segment">segment</code></td>
<td>
<p>Logical. Should one add lines between categories ? Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggadd_supvar_+3A_vname">vname</code></td>
<td>
<p>A character string to be used as a prefix for the labels of the categories. If NULL (default), no prefix is added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# adds Age as a supplementary variable
# onto the cloud of variables
p &lt;- ggcloud_variables(mca, col = "lightgrey", shapes = FALSE)
ggadd_supvar(p, mca, Music$Age, segment = TRUE)
</code></pre>

<hr>
<h2 id='ggadd_supvars'>Plot of categorical supplementary variables</h2><span id='topic+ggadd_supvars'></span>

<h3>Description</h3>

<p>Adds categorical supplementary variables to a MCA cloud of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggadd_supvars(p, resmca, vars, excl = NULL, points = "all", min.cos2 = 0.1,
axes = c(1,2), col = NULL,
shapes = FALSE, prop = NULL, textsize = 3, shapesize = 6,
vlab = TRUE, vname = NULL,
force = 1, max.overlaps = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggadd_supvars_+3A_p">p</code></td>
<td>
<p><code>ggplot2</code> object with the cloud of variables</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_vars">vars</code></td>
<td>
<p>A data frame of categorical supplementary variables. All these variables should be factors.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_excl">excl</code></td>
<td>
<p>character vector of supplementary categories to exclude from the plot, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;Gender.Men&quot;). If NULL (default), all the supplementary categories are plotted.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all categories are plotted (default); if 'besth' only those with a minimum squared cosine on horizontal axis are plotted; if 'bestv' only those with a minimum squared cosine on vertical axis are plotted; if 'besthv' only those with a minimum squared cosine on horizontal or vertical axis are plotted; if 'best' only those with a minimum squared cosine on the plane are plotted.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_min.cos2">min.cos2</code></td>
<td>
<p>numerical value. The minimal squared cosine if 'points' argument is different from 'all'. Default </p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_col">col</code></td>
<td>
<p>character string. Color name for the labels (and the shapes if <code>shapes=TRUE</code>) of the categories. If NULL, the default palette of <code>ggplot2</code> is used, with one color per variable.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_shapes">shapes</code></td>
<td>
<p>Logical. If TRUE, symbols are used in addition to the labels of categories. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_prop">prop</code></td>
<td>
<p>If NULL, the size of the labels (if <code>shapes=FALSE</code>), or of the labels and the shapes (if <code>shapes=TRUE</code>) is constant. If 'n', the size is proportional the the weights of categories; if 'vtest1', the size is proportional to the test values of the categories on the first dimension of the plot; if 'vtest2', the size is proportional to the test values of the categories on the second dimension of the plot; if 'cos1', the size is proportional to the cosines of the categories on the first dimension of the plot; if 'cos2', the size is proportional to the cosines of the categories on the second dimension of the plot; if 'cos12', the size is proportional to the total cosines of the categories on the two dimensions of the plot.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_textsize">textsize</code></td>
<td>
<p>Size of the labels of categories if <code>shapes</code> is TRUE, or if <code>shapes</code> is FALSE and <code>prop</code> is NULL. Default is 3.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_shapesize">shapesize</code></td>
<td>
<p>Size of the shapes if <code>prop=NULL</code>, maximum size of the shapes in other cases. Default is 6.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_vlab">vlab</code></td>
<td>
<p>Logical. If TRUE (default), the variable name is added as a prefix for the labels of the categories.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_vname">vname</code></td>
<td>
<p>deprecated, use vlab instead</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_force">force</code></td>
<td>
<p>Force of repulsion between overlapping text labels. Defaults to 1. If 0, labels are not repelled at all.</p>
</td></tr>
<tr><td><code id="ggadd_supvars_+3A_max.overlaps">max.overlaps</code></td>
<td>
<p>Exclude text labels that overlap too many things. Defaults to Inf, which means no labels are excluded.</p>
</td></tr>  
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>Shapes and labels are colored according to the categories of the variable, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggsmoothed_supvar">ggsmoothed_supvar</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# adds several supplementary variables
# onto the cloud of variables
p &lt;- ggcloud_variables(mca, col = "lightgrey", shapes = FALSE)
ggadd_supvars(p, mca, Music[, c("Gender","Age")])
# the same, excluding men
ggadd_supvars(p, mca, Music[, c("Gender","Age")], excl = "Gender.Men")
# the same, keeping only categories
# with cos2 &gt;= 0.001 for dimension 1
ggadd_supvars(p, mca, Music[, c("Gender","Age")], points = "besth", min.cos2 = 0.001)
</code></pre>

<hr>
<h2 id='ggaxis_variables'>Plot of variables on a single axis</h2><span id='topic+ggaxis_variables'></span>

<h3>Description</h3>

<p>Plots variables on a single axis of a Multiple Correspondence Analysis. Variables can be active or supplementary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggaxis_variables(resmca, var = NULL, axis = 1, prop = NULL,
underline = FALSE, col = NULL, vlab = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggaxis_variables_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_var">var</code></td>
<td>
<p>If NULL (default), all the active variables of the MCA are plotted. If a character string, the named active variables of the MCA is plotted. If a factor, it is plotted as a supplementary variable.</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_axis">axis</code></td>
<td>
<p>numeric value. The MCA axis to plot. Default is 1.</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_prop">prop</code></td>
<td>
<p>If NULL (default), the size of the labels is constant. If &quot;freq&quot;, the size is proportional to the weights of categories. If &quot;ctr&quot;, it's proportional to the contributions of categories (only used for active variables). If &quot;cos2&quot;, it's proportional to the squared cosines of the categories. If &quot;pval&quot;, it's proportional to 1 minus the p-values of typicality tests (only used for supplementary variables). If &quot;cor&quot;, it's proportional to the point biserial correlation of the categories (only used for supplementary variables).</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_underline">underline</code></td>
<td>
<p>logical. If TRUE, the labels of the categories with contributions above average are underlined. Default is FALSE. Only used for active variables.</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_col">col</code></td>
<td>
<p>character string. Color name for the labels of the categories. If NULL and <code>var=NULL</code>, the default palette of <code>ggplot2</code> is used, with one color per variable. If NULL and <code>var</code> is not NULL, labels are black.</p>
</td></tr>
<tr><td><code id="ggaxis_variables_+3A_vlab">vlab</code></td>
<td>
<p>Logical. Should the variable names be used as a prefix for the labels of the categories. Default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# plots all the active categories on axis 1
ggaxis_variables(mca)
# the same with other plotting options
ggaxis_variables(mca, prop = "freq", underline = TRUE, col = "black")
# plots Active variable Classical on axis 1
ggaxis_variables(mca, var = "Classical", axis = 1, prop = "ctr", underline = TRUE)
# plots supplementary variable Educ on axis 1
ggaxis_variables(mca, var = Taste$Educ, axis = 1, prop = "pval")
</code></pre>

<hr>
<h2 id='ggbootvalid_supvars'>Ellipses of bootstrap validation (supplementary variables)</h2><span id='topic+ggbootvalid_supvars'></span>

<h3>Description</h3>

<p>Ellipses for bootstrap validation of MCA, through the computation of the coordinates of supplementary variables for bootstrap replications of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggbootvalid_supvars(resmca, vars = NULL, axes = c(1,2), K = 30,
                    ellipse = "norm", level = 0.95,
                    col = NULL, active = FALSE, legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggbootvalid_supvars_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>speMCA</code>.</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_vars">vars</code></td>
<td>
<p>A data frame of categorical supplementary variables. All these variables should be factors.</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_k">K</code></td>
<td>
<p>integer. Number of bootstrap replications (default is 30).</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_ellipse">ellipse</code></td>
<td>
<p>character string. The type of ellipse. The default &quot;norm&quot; assumes a multivariate normal distribution, &quot;t&quot; assumes a multivariate t-distribution, and &quot;euclid&quot; draws a circle with the radius equal to level, representing the euclidean distance from the center.</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_level">level</code></td>
<td>
<p>numerical value. The level at which to draw an ellipse, or, if <code>ellipse</code>=&quot;euclid&quot;, the radius of the circle to be drawn.</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_col">col</code></td>
<td>
<p>Character string. Color name for the ellipses and labels of the categories. If NULL (default), the default <code>ggplot2</code> palette is used, with one color per variable.</p>
</td></tr>
<tr><td><code id="ggbootvalid_supvars_+3A_active">active</code></td>
<td>
<p>logical. If TRUE, the labels of active variables are added to the plot in lightgray. Default is FALSE.</p>
</td></tr>  
<tr><td><code id="ggbootvalid_supvars_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The bootstrap technique is used here as an internal (and non-parametric) validation procedure of the results of a multiple correspondence analysis. For supplementary variables, only partial bootstrap is possible. The partial bootstrap does not compute new MCAs: it projects bootstrap replications of the initial data as supplementary elements of the MCA. 
See references for more details.
</p>
<p>The default parameters for ellipses assume a multivariate normal distribution drawn at level 0.95.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>If <code>col</code> argument is NULL, ellipses and labels are colored according to the variables, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Lebart L. (2006). &quot;Validation Techniques in Multiple Correspondence Analysis&quot;. In M. Greenacre et J. Blasius (eds), <em>Multiple Correspondence Analysis and related techniques</em>, Chapman and Hall/CRC, p.179-196.
</p>
<p>Lebart L. (2007). &quot;Which bootstrap for principal axes methods?&quot;. In P. Brito et al. (eds), <em>Selected Contributions in Data Analysis and Classification</em>, Springer, p.581-588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootvalid_supvars">bootvalid_supvars</a></code>, <code><a href="#topic+ggbootvalid_variables">ggbootvalid_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# bootstrap validation ellipses
# for three supplementary variables
sup &lt;- Taste[,c("Gender", "Age", "Educ")]
ggbootvalid_supvars(mca, sup)
</code></pre>

<hr>
<h2 id='ggbootvalid_variables'>Ellipses of bootstrap validation (active variables)</h2><span id='topic+ggbootvalid_variables'></span>

<h3>Description</h3>

<p>Ellipses for bootstrap validation of MCA, through the computation of the coordinates of active variables for bootstrap replications of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggbootvalid_variables(resmca, axes = c(1,2), type = "partial", K = 30,
                      ellipse = "norm", level = 0.95,
                      col = NULL, legend = "right")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggbootvalid_variables_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>speMCA</code>.</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_type">type</code></td>
<td>
<p>character string. Can be &quot;partial&quot;, &quot;total1&quot;, &quot;total2&quot; or &quot;total3&quot; (see details). Default is &quot;partial&quot;.</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_k">K</code></td>
<td>
<p>integer. Number of bootstrap replications (default is 30).</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_ellipse">ellipse</code></td>
<td>
<p>character string. The type of ellipse. The default &quot;norm&quot; assumes a multivariate normal distribution, &quot;t&quot; assumes a multivariate t-distribution, and &quot;euclid&quot; draws a circle with the radius equal to level, representing the euclidean distance from the center.</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_level">level</code></td>
<td>
<p>numerical value. The level at which to draw an ellipse, or, if <code>ellipse</code>=&quot;euclid&quot;, the radius of the circle to be drawn.</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_col">col</code></td>
<td>
<p>Character string. Color name for the ellipses and labels of the categories. If NULL (default), the default <code>ggplot2</code> palette is used, with one color per variable.</p>
</td></tr>
<tr><td><code id="ggbootvalid_variables_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The bootstrap technique is used here as an internal (and non-parametric) validation procedure of the results of a multiple correspondence analysis. Following the work of Lebart, several methods are proposed. The total bootstrap uses new MCAs computed from bootstrap replications of the initial data. In the type 1 bootstrap (<code>type</code> = &quot;total1&quot;), the sign of the coordinates is corrected if necessary (the direction of the axes of an ACM being arbitrary). In type 2 (<code>type</code> = &quot;total2&quot;), the order of the axes and the sign of the coordinates are corrected if necessary. In type 3 (<code>type</code> = &quot;total3&quot;), a procrustean rotation is used to find the best superposition between the initial axes and the replicated axes.
The partial bootstrap (<code>type</code> = &quot;partial&quot;) does not compute new MCAs: it projects bootstrap replications of the initial data as supplementary elements of the MCA. It gives a more optimistic view of the stability of the results than the total bootstrap. It is also faster. See references for more details, pros and cons of the various types, etc.
</p>
<p>The default parameters for ellipses assume a multivariate normal distribution drawn at level 0.95.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>If <code>col</code> argument is NULL, ellipses and labels are colored according to the variables, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Lebart L. (2006). &quot;Validation Techniques in Multiple Correspondence Analysis&quot;. In M. Greenacre et J. Blasius (eds), <em>Multiple Correspondence Analysis and related techniques</em>, Chapman and Hall/CRC, p.179-196.
</p>
<p>Lebart L. (2007). &quot;Which bootstrap for principal axes methods?&quot;. In P. Brito et al. (eds), <em>Selected Contributions in Data Analysis and Classification</em>, Springer, p.581-588.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bootvalid_variables">bootvalid_variables</a></code> , <code><a href="#topic+ggbootvalid_supvars">ggbootvalid_supvars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# bootstrap validation ellipses for active variables
ggbootvalid_variables(mca, type = "partial", K = 5)
</code></pre>

<hr>
<h2 id='ggcloud_indiv'>Plot of the cloud of individuals</h2><span id='topic+ggcloud_indiv'></span>

<h3>Description</h3>

<p>Plots a Multiple Correspondence Analysis cloud of individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggcloud_indiv(resmca, type = "i", points = "all", axes = c(1,2), 
col = "dodgerblue4", point.size = 0.5, alpha = 0.6,
repel = FALSE, text.size = 2,
density = NULL, col.contour = "darkred", hex.bins = 50, hex.pal = "viridis")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggcloud_indiv_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_type">type</code></td>
<td>
<p>If 'i', points are plotted. If 'inames', labels of individuals are plotted.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all points are plotted (default). If 'besth' only those who contribute most to horizontal axis are plotted. If 'bestv' only those who contribute most to vertical axis are plotted. If 'besthv' only those who contribute most to horizontal or vertical axis are plotted. If 'best' only those who contribute most to the plane are plotted.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_col">col</code></td>
<td>
<p>If a factor, points or labels are colored according to their category regarding this factor. If a string with color name, every points or labels have the same color. Default is &quot;dodgerblue4&quot;.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_point.size">point.size</code></td>
<td>
<p>Size of the points of individuals. Default is 0.5.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_alpha">alpha</code></td>
<td>
<p>Transparency of the points or labels of individuals. Default is 0.6.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_repel">repel</code></td>
<td>
<p>Logical. When <code>type="inames"</code>&quot;, should labels of individuals be repeled ? Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_text.size">text.size</code></td>
<td>
<p>Size of the labels of individuals. Default is 2.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_density">density</code></td>
<td>
<p>If NULL (default), no density layer is added. If &quot;contour&quot;, density is plotted with contours. If &quot;hex&quot;, density is plotted with hexagon bins.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_col.contour">col.contour</code></td>
<td>
<p>character string. The color of the contours. Only used if density=&quot;contour&quot;.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_hex.bins">hex.bins</code></td>
<td>
<p>integer. The number of bins in both vertical and horizontal directions. Only used if <code>density="hex"</code>.</p>
</td></tr>
<tr><td><code id="ggcloud_indiv_+3A_hex.pal">hex.pal</code></td>
<td>
<p>character string. The name of a viridis palette for hexagon bins. Only used if <code>density="hex"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Sometimes the dots are too many and overlap. It is then difficult to get an accurate idea of the distribution of the cloud of individuals. The <code>density</code> argument allows you to add an additional layer to represent the density of points in the plane, in the form of contours or hexagonal areas.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>If <code>col</code> argument is a factor, points or labels are colored according to the categories of the factor, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>


<h3>Author(s)</h3>

<p>Anton Perdoncin, Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# cloud of individuals
ggcloud_indiv(mca)
# points are colored according to gender
ggcloud_indiv(mca, col=Taste$Gender)
# a density layer of contours is added
ggcloud_indiv(mca, density = "contour")
# a density layer of hexagon bins is added
ggcloud_indiv(mca, density = "hex", hex.bin = 10)
</code></pre>

<hr>
<h2 id='ggcloud_variables'>Plot of the cloud of variables</h2><span id='topic+ggcloud_variables'></span>

<h3>Description</h3>

<p>Plots a Multiple Correspondence Analysis cloud of variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggcloud_variables(resmca, axes = c(1,2), points = "all", 
min.ctr = NULL, max.pval = 0.01, face = "pp",
shapes = TRUE, prop = NULL, textsize = 3, shapesize = 3,
col = NULL, col.by.group = TRUE, alpha = 1,
segment.alpha = 0.5, vlab = TRUE, sep = ".", legend = "right",
force = 1, max.overlaps = Inf)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggcloud_variables_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all categories are plotted (default); if 'besth' only those who contribute most to horizontal axis are plotted; if 'bestv' only those who contribute most to vertical axis are plotted; if 'besthv' only those who contribute most to horizontal or vertical axis are plotted; if 'best' only those who contribute most to the plane are plotted.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_min.ctr">min.ctr</code></td>
<td>
<p>Numerical value between 0 and 100. The minimum contribution (in percent) for a category to be displayed if the <code>points</code> argument is equal to &quot;best&quot;, &quot;besth&quot; or &quot;bestv&quot; and <code>resmca</code> is of type <code>MCA</code>, <code>speMCA</code> or <code>csMCA</code>. If NULL (default), only the categories that contribute more than the average (i.e. 100 / number of modalities) are displayed.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_max.pval">max.pval</code></td>
<td>
<p>Numerical value between 0 and 100. The maximal p-value derived from test-values for a category to be displayed if the <code>points</code> argument is equal to &quot;best&quot;, &quot;besth&quot; or &quot;bestv&quot; and <code>resmca</code> is of type <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_face">face</code></td>
<td>
<p>character string. Changes the face of the category labels when their contribution is greater than <code>min.ctr</code>. The first letter refers to the first represented axis, the second letter to the second. &quot;p&quot; is for plain text, &quot;u&quot; for underlined, &quot;i&quot; for italic and &quot;b&quot; for bold. For example, &quot;ui&quot; means that the labels of the most contributing categories on the first axis will be underlined and the labels of the most contributing categories on the second axis will be italicized. By default (&quot;pp&quot;), no font face change is made.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_shapes">shapes</code></td>
<td>
<p>Logical. Should shapes be plotted for categories (in addition to labels) ? Default is TRUE.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_prop">prop</code></td>
<td>
<p>If NULL, the size of the labels (if shapes=FALSE) or the shapes (if shapes=TRUE) is constant. If 'n', the size is proportional the the weights of categories; if 'ctr1', the size is proportional to the contributions of the categories on the first dimension of the plot; if 'ctr2', the size is proportional to the contributions of the categories on the second dimension of the plot; if 'ctr12', the size is proportional to the contributions of the categories on the plane ; if 'ctr.cloud', the size is proportional to the total contributions of the categories on the whole cloud; if 'cos1', the size is proportional to the quality of representation (squared cosines) of the categories on the first dimension of the plot; if 'cos2', the size is proportional to the quality of representation of the categories on the second dimension of the plot; if 'cos12', the size is proportional to the quality of representation of the categories on the plane; if 'vtest1', the size is proportional to the test-values of the categories on the first dimension of the plot; if 'vtest2', the size is proportional to the test-values of the categories on the second dimension of the plot.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_textsize">textsize</code></td>
<td>
<p>Size of the labels of categories if shapes=TRUE, or if shapes=FALSE and prop=NULL. Default is 3.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_shapesize">shapesize</code></td>
<td>
<p>Size if the shapes of categories if shapes=TRUE and prop=FALSE. Default is 3.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_col">col</code></td>
<td>
<p>Character string. Color name for the shapes and labels of the categories. If NULL (default), the default <code>ggplot2</code> palette is used, with one color per variable.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_col.by.group">col.by.group</code></td>
<td>
<p>Logical. If <code>resmca</code> is of type <code>multimCA</code>, categories are colored by group from the MFA if TRUE (default) and by variable if FALSE.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_alpha">alpha</code></td>
<td>
<p>Transparency of the shapes and labels of categories. Default is 1.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_segment.alpha">segment.alpha</code></td>
<td>
<p>Transparency of the line segment beside labels of categories. Default is 0.5.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_vlab">vlab</code></td>
<td>
<p>Logical. Should the variable names be used as a prefix for the labels of the categories. Default is TRUE.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_sep">sep</code></td>
<td>
<p>Character string used as a separator if vlab=TRUE.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_legend">legend</code></td>
<td>
<p>the position of legends (&quot;none&quot;, &quot;left&quot;, &quot;right&quot;, &quot;bottom&quot;, &quot;top&quot;, or two-element numeric vector). Default is right.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_force">force</code></td>
<td>
<p>Force of repulsion between overlapping text labels. Defaults to 1. If 0, labels are not repelled at all.</p>
</td></tr>
<tr><td><code id="ggcloud_variables_+3A_max.overlaps">max.overlaps</code></td>
<td>
<p>Exclude text labels that overlap too many things. Defaults to Inf, which means no labels are excluded.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Note</h3>

<p>If <code>col</code> argument is NULL, shapes or labels are colored according to the variables, using the default <code>ggplot2</code> palette. The palette can be customized using any <code>scale_color_*</code> function, such as <code>scale_color_brewer()</code>, <code>scale_color_grey()</code> or <code>scale_color_manual()</code>.
</p>
<p>If <code>resmca</code> is of type <code>stMCA</code> or <code>multiMCA</code> and <code>points</code> is not equal to <code>"all"</code>, test-values are used instead of contributions (which are not available for these MCA variants) to select the most important categories ; if <code>points</code> is equal to <code>best</code>, only categories with high test-values for horizontal axis or vertical axis are plotted.
</p>


<h3>Author(s)</h3>

<p>Anton Perdoncin, Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# cloud of variables
ggcloud_variables(mca)
# cloud of variables with only categories contributing the most
ggcloud_variables(mca, points = "best", prop = "n")
# cloud of variables with other plotting options
ggcloud_variables(mca, shapes = FALSE, legend = "none",
col = "black", face = "ui")
</code></pre>

<hr>
<h2 id='ggeta2_variables'>eta-squared plot</h2><span id='topic+ggeta2_variables'></span>

<h3>Description</h3>

<p>Plots the eta-squared (squared correlation ratios) of the active variables of a MCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggeta2_variables(resmca, axes = c(1,2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggeta2_variables_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggeta2_variables_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This plot was proposed by Escofier and Pagès (2008) under the name &quot;carré des liaisons&quot;, i.e. square of relationships, using correlation ratios to measure these relationships. Eta-squared (i.e. correlation ratio) is a measure of global association between a continuous variable and a categorical variable : it measures the share of variance of the continuous variables &quot;explained&quot; by the categorical variable. Here, it is used to plot the association between the active variables and the axes of the MCA cloud.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Escofier B. and Pagès J., 2008, <em>Analyses factorielles simples et multiples</em>, Dunod.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+ggadd_attractions">ggadd_attractions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
junk &lt;- c("FrenchPop.NA","Rap.NA","Jazz.NA","Classical.NA","Rock.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
ggeta2_variables(mca)
</code></pre>

<hr>
<h2 id='ggsmoothed_supvar'>Plots the density a supplementary variable</h2><span id='topic+ggsmoothed_supvar'></span>

<h3>Description</h3>

<p>Plots the density of a supplementary variable in a MCA space, using a grid, smoothing and interpolation (via inverse distance weighting.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggsmoothed_supvar(resmca, var, cat, axes = c(1,2), 
                  center = FALSE, scale = FALSE,
                  nc = c(20, 20), power = 2,
                  limits = NULL, pal = "RdBu")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ggsmoothed_supvar_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>PCA</code>, <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code>.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_var">var</code></td>
<td>
<p>factor or numeric vector. The supplementary variable to be plotted.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_cat">cat</code></td>
<td>
<p>character string. If <code>var</code> is a factor, the name of the level of the supplementary variable to be plotted.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_center">center</code></td>
<td>
<p>logical. Whether the supplementary variable should be centered or not. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_scale">scale</code></td>
<td>
<p>logical. Whether the supplementary variable should be scaled to unit variance or not. Default is FALSE.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_nc">nc</code></td>
<td>
<p>integer vector of length 2. Number of grid cells in x and y direction (columns, rows).</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_power">power</code></td>
<td>
<p>numerical value. The power to use in weight calculation for inverse distance weighting. Default is 2.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_limits">limits</code></td>
<td>
<p>numerical vector of length 2. Lower and upper limit of the scale for the supplementary variable.</p>
</td></tr>
<tr><td><code id="ggsmoothed_supvar_+3A_pal">pal</code></td>
<td>
<p>character string. Name of a (preferably diverging) palette from the <code>RColorBrewer</code> package. Default is &quot;RdBu&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The construction of the plot takes place in several steps. First, the two-dimensional MCA space is cut into a grid of hexagonal cells. Then, for each cell, the average value of the supplementary variable is calculated for the observations located in that cell (if the variable is numerical), or the proportion of observations belonging to the category studied (if the variable is categorical). The results are interpolated and smoothed to make the plot easier to read, using the <em>inverse distance weighting</em> technique, which is very common in spatial analysis.
</p>
<p>The supplementary variable can be centered beforehand, to represent deviations from the mean (for a numerical variable) or from the mean proportion (for a categorical variable). It can also be scaled to measure deviations in numbers of standard deviations, which can be useful for comparing the results of several supplementary variables.
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Shepard, Donald (1968). &quot;A two-dimensional interpolation function for irregularly-spaced data&quot;. <em>Proceedings of the 1968 ACM National Conference</em>. pp. 517–524. doi:10.1145/800186.810616
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+ggadd_kellipses">ggadd_kellipses</a></code>, <code><a href="#topic+ggadd_ellipses">ggadd_ellipses</a></code>, <code><a href="#topic+ggadd_interaction">ggadd_interaction</a></code>, <code><a href="#topic+ggadd_corr">ggadd_corr</a></code>, <code><a href="#topic+ggadd_chulls">ggadd_chulls</a></code>, <code><a href="#topic+ggadd_density">ggadd_density</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Taste example data set
data(Taste)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA",
          "Comedy.NA", "Crime.NA", "Animation.NA", "SciFi.NA", "Love.NA", 
          "Musical.NA")
mca &lt;- speMCA(Taste[,1:11], excl = junk)
# density plot for Educ = "High"
ggsmoothed_supvar(mca, Taste$Educ, "High")
# centered and scaled density plot for Age
ggsmoothed_supvar(mca, as.numeric(Taste$Age), center = TRUE, scale = TRUE)
</code></pre>

<hr>
<h2 id='gPCA'>Generalized Principal Component Analysis</h2><span id='topic+gPCA'></span>

<h3>Description</h3>

<p>Generalized Principal Component Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gPCA(X, row.w = NULL, col.w = NULL, center = FALSE, scale = FALSE, tol = 1e-07)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gPCA_+3A_x">X</code></td>
<td>
<p>data frame of active variables</p>
</td></tr>
<tr><td><code id="gPCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="gPCA_+3A_col.w">col.w</code></td>
<td>
<p>numeric vector of column weights. If NULL (default), a vector of 1 for uniform column weights is used.</p>
</td></tr>
<tr><td><code id="gPCA_+3A_center">center</code></td>
<td>
<p>logical. If TRUE, variables are centered (default is FALSE).</p>
</td></tr>  
<tr><td><code id="gPCA_+3A_scale">scale</code></td>
<td>
<p>logical. If TRUE, variables are scaled to unit variance (default is FALSE).</p>
</td></tr> 
<tr><td><code id="gPCA_+3A_tol">tol</code></td>
<td>
<p>a tolerance threshold for null eigenvalues (a value less than <code>tol</code> times the first one is considered as null)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generalized PCA is basically a PCA with the possibility to specify row weights (i.e. &quot;masses&quot;) and variable weights (i.e. the &quot;metric&quot;), and to choose whether to center and scale the variables. This flexibility makes it the building block of many variants of PCA, such as Correspondence Analysis and Multiple Correspondence Analysis.
</p>
<p>Generalized PCA is also known as &quot;biweighted PCA&quot;, &quot;duality diagram&quot; or &quot;generalized singular value decomposition&quot;.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1995, <em>Analyses factorielles simples</em>, Economica.
</p>
<p>Escofier B. and Pagès J., <em>Analyses factorielles simples et multiples</em>, Dunod (2008).
</p>
<p>Escoufier, Y. (1987) The duality diagram : a means of better practical applications In <em>Development in numerical ecology</em>, Legendre, P. &amp; Legendre, L. (Eds.) NATO advanced Institute, Serie G. Springer Verlag, Berlin, 139–156.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
res &lt;- gPCA(decathlon[,1:10], center = TRUE, scale = TRUE)
plot(res, choix = "var")
</code></pre>

<hr>
<h2 id='homog.test'>Homogeneity test for a categorical supplementary variable</h2><span id='topic+homog.test'></span>

<h3>Description</h3>

<p>From MCA results, computes a homogeneity test between categories of a supplementary variable, i.e. 
characterizes the homogeneity of several subclouds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>homog.test(resmca, var, dim = c(1,2))</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="homog.test_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="homog.test_+3A_var">var</code></td>
<td>
<p>the categorical supplementary variable. It does not need to have been used at the MCA step.</p>
</td></tr>
<tr><td><code id="homog.test_+3A_dim">dim</code></td>
<td>
<p>the axes which are described. Default is c(1,2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of lists, one for each selected dimension in the MCA.
Each list has 2 elements :
</p>
<table role = "presentation">
<tr><td><code>test.stat</code></td>
<td>
<p>The square matrix of test statistics</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>The square matrix of p-values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+supvar">supvar</a></code>, <code><a href="#topic+supvars">supvars</a></code>, <code><a href="#topic+dimtypicality">dimtypicality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# homogeneity test for variable Age
homog.test(mca, Music$Age)
</code></pre>

<hr>
<h2 id='ijunk'>App for junk categories of specific MCA</h2><span id='topic+ijunk'></span>

<h3>Description</h3>

<p>This function launches a shiny app to define interactively the junk categories before a specific MCA.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ijunk(data, init_junk = NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ijunk_+3A_data">data</code></td>
<td>
<p>data frame of categorical variables to be used as active in a specific MCA</p>
</td></tr>
<tr><td><code id="ijunk_+3A_init_junk">init_junk</code></td>
<td>
<p>optional vector of junk categories. Can be a numeric vector indicating the indexes of the junk categories or a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;). Default is NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Once the selection of junk categories is interactively done, the function provides the code to use in a script.
It also offer the opportunity to select a set of junk categories at once by writing the common suffix of these categories.</p>


<h3>Value</h3>

<p>A character vector of junk categories</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>, <code><a href="#topic+getindexcat">getindexcat</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(Music)
ijunk(Music[,1:5])
# or
junk &lt;- ijunk(Music[,1:5])
# To update an existing vector of junk categories
junk &lt;- ijunk(Music[,1:5], init_junk = c("Rock.NA", "Rap.NA"))
# and then
mca &lt;- speMCA(Music[,1:5], excl = junk)

## End(Not run)
</code></pre>

<hr>
<h2 id='MCAiv'>Multiple Correspondence Analysis with Instrumental Variables</h2><span id='topic+MCAiv'></span>

<h3>Description</h3>

<p>Multiple Correspondence Analysis with Instrumental Variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCAiv(Y, X, excl = NULL, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCAiv_+3A_y">Y</code></td>
<td>
<p>data frame with only factors</p>
</td></tr>
<tr><td><code id="MCAiv_+3A_x">X</code></td>
<td>
<p>data frame of instrumental variables, which can be numeric or factors. It must have the same number of rows as <code>Y</code>.</p>
</td></tr>
<tr><td><code id="MCAiv_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr> 
<tr><td><code id="MCAiv_+3A_row.w">row.w</code></td>
<td>
<p>Numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="MCAiv_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple Correspondence Analysis with Instrumental Variables consists in three steps :
1. Specific MCA of <code>Y</code>, keeping all the dimensions of the space
2. Computation of one linear regression for each dimension in the specific MCA, with individual coordinates as response and all variables in <code>X</code> as explanatory variables.
3. Principal Component Analysis of the set of predicted values from the regressions in 2.
</p>
<p>Multiple Correspondence Analysis with Instrumental Variables is also known as &quot;Canonical Correspondence Analysis&quot; or &quot;Constrained Correspondence Analysis&quot;.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with <code>Y</code> and <code>X</code> as supplementary variables, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the share of inertia explained by the instrumental variables</p>
</td></tr></table>
<p>.
</p>


<h3>Note</h3>

<p>If there are NAs in <code>Y</code>, these NAs will be automatically considered as junk categories. If one desires more flexibility, <code>Y</code> should be recoded to add explicit factor levels for NAs and then <code>excl</code> option may be used to select the junk categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcMCA">bcMCA</a></code>, <code><a href="#topic+DAQ">DAQ</a></code>, <code><a href="#topic+bcPCA">bcPCA</a></code>, <code><a href="#topic+DA">DA</a></code>, <code><a href="#topic+PCAiv">PCAiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(tea)
# MCAIV of tea data
# with age, sex, SPC and Sport as instrumental variables
mcaiv &lt;- MCAiv(tea[,1:18], tea[,19:22])
mcaiv$ratio
plot(mcaiv, choix = "ind", invisible = "ind", col.quali = "black")
</code></pre>

<hr>
<h2 id='MCAoiv'>Multiple Correspondence Analysis with Orthogonal Instrumental Variables</h2><span id='topic+MCAoiv'></span>

<h3>Description</h3>

<p>Multiple Correspondence Analysis with Orthogonal Instrumental Variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCAoiv(X, Z, excl = NULL, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MCAoiv_+3A_x">X</code></td>
<td>
<p>data frame with only factors</p>
</td></tr>
<tr><td><code id="MCAoiv_+3A_z">Z</code></td>
<td>
<p>data frame of instrumental variables, which can be numeric or factors. It must have the same number of rows as <code>X</code>.</p>
</td></tr>
<tr><td><code id="MCAoiv_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr> 
<tr><td><code id="MCAoiv_+3A_row.w">row.w</code></td>
<td>
<p>Numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="MCAoiv_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiple Correspondence Analysis with Orthogonal Instrumental Variables consists in three steps :
1. Specific MCA of <code>Y</code>, keeping all the dimensions of the space
2. Computation of one linear regression for each dimension in the specific MCA, with individual coordinates as response and all variables in <code>X</code> as explanatory variables.
3. Principal Component Analysis of the set of residuals from the regressions in 2.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with <code>X</code> as supplementary variables, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the share of inertia not explained by the instrumental variables</p>
</td></tr></table>
<p>.
</p>


<h3>Note</h3>

<p>If there are NAs in <code>Y</code>, these NAs will be automatically considered as junk categories. If one desires more flexibility, <code>Y</code> should be recoded to add explicit factor levels for NAs and then <code>excl</code> option may be used to select the junk categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wcMCA">wcMCA</a></code>, <code><a href="#topic+wcPCA">wcPCA</a></code>, <code><a href="#topic+PCAoiv">PCAoiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(tea)
mcaoiv &lt;- MCAoiv(tea[,1:18], tea[,19:22])
mcaoiv$ratio
plot(mcaoiv, choix = "ind", invisible = "ind", col.quali = "black")
</code></pre>

<hr>
<h2 id='medoids'>Medoids of clusters</h2><span id='topic+medoids'></span>

<h3>Description</h3>

<p>Computes the medoids of a cluster solution.</p>


<h3>Usage</h3>

<pre><code class='language-R'>medoids(D, cl)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="medoids_+3A_d">D</code></td>
<td>
<p>square distance matrix (n rows * n columns, i.e. n individuals) or <code>dist</code> object</p>
</td></tr>
<tr><td><code id="medoids_+3A_cl">cl</code></td>
<td>
<p>vector with the clustering solution (its length should be n)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A medoid is a representative object of a cluster whose average dissimilarity to all the objects in the cluster is minimal. Medoids are always members of the data set (contrary to means or centroids).
</p>


<h3>Value</h3>

<p>Returns a numeric vector with the indexes of medoids.</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Kaufman, L. and Rousseeuw, P.J. (1990). <em>Finding Groups in Data: An Introduction to Cluster Analysis</em>. Wiley, New York.
</p>
<p>Anja Struyf, Mia Hubert &amp; Peter J. Rousseeuw (1996). &quot;Clustering in an Object-Oriented Environment&quot;. <em>Journal of Statistical Software</em>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dist">dist</a></code>, <code>cluster</code>, <code><a href="stats.html#topic+hclust">hclust</a></code>, <code><a href="stats.html#topic+cutree">cutree</a></code> , <code>pam</code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># hierarchical clustering of the Music example data set, 
# partition into 3 groups
# and then computation of the medoids.
data(Music)
temp &lt;- dichotom(Music[,1:5])
d &lt;- dist(temp)
clus &lt;- cutree(hclust(d), 3)
medoids(d, clus)
</code></pre>

<hr>
<h2 id='modif.rate'>Benzecri's modified rates of variance</h2><span id='topic+modif.rate'></span>

<h3>Description</h3>

<p>Computes Benzecri's modified rates of variance of a multiple correspondence analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>modif.rate(resmca)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="modif.rate_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>As MCA clouds often have a high dimensionality, the variance rates of the first principle axes may be quite low, which makes them hard to interpret. Benzecri (1992, p.412) proposed to use <em>modified rates</em> to better appreciate the relative importance of the principal axes.
</p>


<h3>Value</h3>

<p>Returns a list of two data frames.
The first one is called <code>raw</code> and has 3 variables:
</p>
<table role = "presentation">
<tr><td><code>eigen</code></td>
<td>
<p>eigen values</p>
</td></tr>
<tr><td><code>rate</code></td>
<td>
<p>rates</p>
</td></tr>
<tr><td><code>cum.rate</code></td>
<td>
<p>cumulative rates</p>
</td></tr>
</table>
<p>The second one is called <code>modif</code> and has 2 variables:
</p>
<table role = "presentation">
<tr><td><code>mrate</code></td>
<td>
<p>modified rates</p>
</td></tr>
<tr><td><code>cum.mrate</code></td>
<td>
<p>cumulative modified rates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Benzecri J.P., <em>Correspondence analysis handbook</em>, New-York: Dekker (1992).
</p>
<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="FactoMineR.html#topic+MCA">MCA</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># MCA of Music' example data set
data(Music)
mca &lt;- speMCA(Music[,1:5])
# modified rates of variance
modif.rate(mca)
</code></pre>

<hr>
<h2 id='multiMCA'>Multiple Factor Analysis</h2><span id='topic+multiMCA'></span>

<h3>Description</h3>

<p>Performs Multiple Factor Analysis, drawing on the work of Escofier and Pages (1994). It allows the use of 
MCA variants (e.g. specific MCA or class specific MCA) as inputs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiMCA(l_mca, ncp = 5, compute.rv = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiMCA_+3A_l_mca">l_mca</code></td>
<td>
<p>a list of objects of class <code>MCA</code>, <code>speMCA</code> or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="multiMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (default is 5)</p>
</td></tr>
<tr><td><code id="multiMCA_+3A_compute.rv">compute.rv</code></td>
<td>
<p>whether RV coefficients should be computed or not (default is FALSE, which makes the function execute faster)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function binds individual coordinates from every MCA in <code>l_mca</code> argument, weights them by the first eigenvalue, and the resulting data frame is used as input for Principal Component Analysis (PCA).
</p>


<h3>Value</h3>

<p>Returns an object of class <code>multiMCA</code>, i.e. a list:
</p>
<table role = "presentation">
<tr><td><code>eig</code></td>
<td>
<p>a list of numeric vector for eigenvalues, percentage of variance and cumulative percentage of variance</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>a list of matrices with results for input MCAs components (coordinates, correlations between variables and axes, squared cosines, contributions)</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>a list of matrices with results for individuals (coordinates, squared cosines, contributions)</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a list with informations about input data</p>
</td></tr>
<tr><td><code>VAR</code></td>
<td>
<p>a list of matrices with results for categories and variables in the input MCAs (coordinates, squared cosines, test-values, variances)</p>
</td></tr>
<tr><td><code>my.mca</code></td>
<td>
<p>lists the content of the objects in <code>l_mca</code> argument</p>
</td></tr>
<tr><td><code>RV</code></td>
<td>
<p>a matrix of RV coefficients</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Escofier, B. and Pages, J. (1994) &quot;Multiple Factor Analysis (AFMULT package)&quot;. <em>Computational Statistics and Data Analysis</em>, 18, 121-140.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.multiMCA">plot.multiMCA</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Taste)
# specific MCA on music variables of Taste example data set
mca1 &lt;- speMCA(Taste[,1:5], excl = c(3,6,9,12,15))
# specific MCA on movie variables of Taste example data set
mca2 &lt;- speMCA(Taste[,6:11], excl = c(3,6,9,12,15,18))
# Multiple Factor Analysis of the two sets of variables
mfa &lt;- multiMCA(list(mca1,mca2))
plot.multiMCA(mfa)
</code></pre>

<hr>
<h2 id='Music'>Music (data)</h2><span id='topic+Music'></span>

<h3>Description</h3>

<p>The data concerns tastes for music of a set of 500 individuals. It contains 5 variables of likes for music genres (french pop, rap, rock, jazz and classical), 2 variables about music listening and 2 additional variables (gender and age).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Music)</code></pre>


<h3>Format</h3>

<p>A data frame with 500 observations and the following 7 variables:
</p>

<dl>
<dt><code>FrenchPop</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Rap</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Rock</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Jazz</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Classical</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Gender</code></dt><dd><p>factor with levels <code>Men</code>, <code>Women</code></p>
</dd>
<dt><code>Age</code></dt><dd><p>factor with levels <code>15-24</code>, <code>25-49</code>, <code>50+</code></p>
</dd>
<dt><code>OnlyMus</code></dt><dd><p>factor with levels <code>Daily</code>, <code>Often</code>, <code>Rare</code>, <code>Never</code>, indicating how often one only listens to music.</p>
</dd>
<dt><code>Daily</code></dt><dd><p>is a factor with levels <code>No</code>, <code>Yes</code> indicating if one listens to music every day.</p>
</dd>
</dl>



<h3>Details</h3>

<p><code>NA</code> stands for &quot;not available&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
str(Music)
</code></pre>

<hr>
<h2 id='nsCA'>Nonsymmetric Correspondence Analysis</h2><span id='topic+nsCA'></span>

<h3>Description</h3>

<p>Nonsymmetric correspondence analysis, for analysing contingency tables with a dependence structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsCA(X, ncp = 5, row.sup = NULL,
     col.sup = NULL, quanti.sup = NULL, quali.sup = NULL, 
     graph = FALSE, axes = c(1,2), row.w = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nsCA_+3A_x">X</code></td>
<td>
<p>a data frame or a table with <em>n</em> rows and <em>p</em> columns, i.e. a contingency table. Predictor variable should be in rows and response variable in columns.</p>
</td></tr>
<tr><td><code id="nsCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
<tr><td><code id="nsCA_+3A_row.sup">row.sup</code></td>
<td>
<p>a vector indicating the indexes of the supplementary rows</p>
</td></tr>
<tr><td><code id="nsCA_+3A_col.sup">col.sup</code></td>
<td>
<p>a vector indicating the indexes of the supplementary columns</p>
</td></tr>
<tr><td><code id="nsCA_+3A_quanti.sup">quanti.sup</code></td>
<td>
<p>a vector indicating the indexes of the supplementary continuous variables</p>
</td></tr>
<tr><td><code id="nsCA_+3A_quali.sup">quali.sup</code></td>
<td>
<p>a vector indicating the indexes of the categorical supplementary variables</p>
</td></tr>
<tr><td><code id="nsCA_+3A_graph">graph</code></td>
<td>
<p>boolean, if TRUE a graph is displayed</p>
</td></tr>
<tr><td><code id="nsCA_+3A_axes">axes</code></td>
<td>
<p>a length 2 vector specifying the components to plot</p>
</td></tr>
<tr><td><code id="nsCA_+3A_row.w">row.w</code></td>
<td>
<p>an optional row weights (by default, a vector of 1 and each row has a weight equals to its margin); the weights are given only for the active rows</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When dealing with a contingency table with a dependence structure, i.e. when the role of the two variables is not symmetrical but, on the contrary, one can be considered as predicting the other, nonsymmetric correspondence analysis (NSCA) can be used to represent the predictive structure in the table and to assess the predictive power of the predictor variable.
</p>
<p>Technically, NSCA is very similar to the standard CA, the main difference being that the columns of the contingency table are not weighted by their rarity (i.e. the inverse of the marginal frequencies).
</p>


<h3>Value</h3>

<p>An object of class <code>CA</code> from <code>FactoMineR</code> package, with an additional item :
</p>
<table role = "presentation">
<tr><td><code>GK.tau</code></td>
<td>
<p>Goodman and Kruskal tau</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The code is adapted from the <code>CA</code> function in <code>FactoMineR</code> package.</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Kroonenberg P.M. and Lombardo R., 1999, &quot;Nonsymmetric Correspondence Analysis: A Tool for Analysing Contingency Tables with a Dependence Structure&quot;, <em>Multivariate Behavioral Research</em>, 34 (3), 367-396.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nsca.biplot">nsca.biplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
# The combination of Gender and Age is the predictor variable
# "Focused" listening to music is the response variable
tab &lt;- with(Music, table(interaction(Gender, Age), OnlyMus))
nsca &lt;- nsCA(tab)
nsca.biplot(nsca)
# Goodman and Kruskal tau
nsca$GK.tau
</code></pre>

<hr>
<h2 id='nsca.biplot'>Biplot for Nonsymmetric Correspondence Analysis</h2><span id='topic+nsca.biplot'></span>

<h3>Description</h3>

<p>Biplot for Nonsymmetric correspondence analysis, for analysing contingency tables with a dependence structure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nsca.biplot(nsca, axes = c(1,2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nsca.biplot_+3A_nsca">nsca</code></td>
<td>
<p>an object of class <code>CA</code> created by <code>nsCA()</code> function</p>
</td></tr>
<tr><td><code id="nsca.biplot_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot. Default is c(1,2).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The biplots of an NSCA reflect the dependency structure of the contingency table and thus should not be interpreted as the planes of a standard CA. A first principle is that the graph displays the centred row profiles. A second principle is that the relationships between rows and columns are contained in their inner products : the rows are depicted as vectors, also called biplot axes, and the columns are projected on these vectors. If some columns have projections on the row vector far away from the origin, then the row has a comparatively large increase in predictability, and its profile deviates considerably from the marginal one, especially for that column.
</p>
<p>For more detailed interpretational guidelines, see Kroonenberg and Lombardo (1999, pp.377-378).
</p>


<h3>Value</h3>

<p>a <code>ggplot2</code> object</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Kroonenberg P.M. and Lombardo R., 1999, &quot;Nonsymmetric Correspondence Analysis: A Tool for Analysing Contingency Tables with a Dependence Structure&quot;, <em>Multivariate Behavioral Research</em>, 34 (3), 367-396.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nsCA">nsCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
# The combination of Gender and Age is the predictor variable
# "Focused" listening to music is the response variable
tab &lt;- with(Music, table(interaction(Gender, Age), OnlyMus))
nsca &lt;- nsCA(tab)
nsca.biplot(nsca)
# Goodman and Kruskal tau
nsca$GK.tau
</code></pre>

<hr>
<h2 id='PCAiv'>Principal Component Analysis with Instrumental Variables</h2><span id='topic+PCAiv'></span>

<h3>Description</h3>

<p>Principal Component Analysis with Instrumental Variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAiv(Y, X, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PCAiv_+3A_y">Y</code></td>
<td>
<p>data frame with only numeric variables</p>
</td></tr>
<tr><td><code id="PCAiv_+3A_x">X</code></td>
<td>
<p>data frame of instrumental variables, which can be numeric or factors. It must have the same number of rows as <code>Y</code>.</p>
</td></tr>
<tr><td><code id="PCAiv_+3A_row.w">row.w</code></td>
<td>
<p>Numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="PCAiv_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Principal Component Analysis with Instrumental Variables consists in two steps :
1. Computation of one linear regression for each variable in <code>Y</code>, with this variable as response and all variables in <code>X</code> as explanatory variables.
2. Principal Component Analysis of the set of predicted values from the regressions in 1 (&quot;Y hat&quot;).
</p>
<p>Principal Component Analysis with Instrumental Variables is also known as &quot;redundancy analysis&quot;
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with <code>X</code> as supplementary variables, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the share of inertia explained by the instrumental variables</p>
</td></tr></table>
<p>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcPCA">bcPCA</a></code>, <code><a href="#topic+DA">DA</a></code>, <code><a href="#topic+bcMCA">bcMCA</a></code>, <code><a href="#topic+DAQ">DAQ</a></code>, <code><a href="#topic+MCAiv">MCAiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
# PCAiv of decathlon data set
# with Points and Competition as instrumental variables
pcaiv &lt;- PCAiv(decathlon[,1:10], decathlon[,12:13])
pcaiv$ratio
# plot of \code{Y} variables + quantitative instrumental variables (here Points)
plot(pcaiv, choix = "var")
# plot of qualitative instrumental variables (here Competition)
plot(pcaiv, choix = "ind", invisible = "ind", col.quali = "black")
</code></pre>

<hr>
<h2 id='PCAoiv'>Principal Component Analysis with Orthogonal Instrumental Variables</h2><span id='topic+PCAoiv'></span>

<h3>Description</h3>

<p>Principal Component Analysis with Orthogonal Instrumental Variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCAoiv(X, Z, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PCAoiv_+3A_x">X</code></td>
<td>
<p>data frame with only numeric variables</p>
</td></tr>
<tr><td><code id="PCAoiv_+3A_z">Z</code></td>
<td>
<p>data frame of instrumental variables to be &quot;partialled out&quot;&quot;, which can be numeric or factors. It must have the same number of rows as <code>X</code>.</p>
</td></tr>
<tr><td><code id="PCAoiv_+3A_row.w">row.w</code></td>
<td>
<p>Numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="PCAoiv_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Principal Component Analysis with Orthogonal Instrumental Variables consists in two steps :
1. Computation of one linear regression for each variable in <code>X</code>, with this variable as response and all variables in <code>Z</code> as explanatory variables.
2. Principal Component Analysis of the set of residuals from the regressions in 1.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, and an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the share of inertia not explained by the instrumental variables</p>
</td></tr></table>
<p>.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., 1996, <em>Analyses factorielles multiples</em>, Economica.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wcPCA">wcPCA</a></code>, <code><a href="#topic+wcMCA">wcMCA</a></code>, <code><a href="#topic+MCAoiv">MCAoiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FactoMineR)
data(decathlon)
pcaoiv &lt;- PCAoiv(decathlon[,1:10], decathlon[,12:13])
plot(pcaoiv, choix = "var", invisible = "quanti.sup")
</code></pre>

<hr>
<h2 id='planecontrib'>Contributions to a plane</h2><span id='topic+planecontrib'></span>

<h3>Description</h3>

<p>For a given plane of a MCA, computes contributions and squared cosines of the active variables and categories and of the active individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planecontrib(resmca, axes = c(1,2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="planecontrib_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code> or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="planecontrib_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the axes forming the plane to describe. Default is c(1,2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two lists. The first deals with variables :
</p>
<table role = "presentation">
<tr><td><code>ctr</code></td>
<td>
<p>vector of contributions of the active categories to the plane</p>
</td></tr>
<tr><td><code>cos2</code></td>
<td>
<p>vector of squared cosines of the active categories in the plane</p>
</td></tr>
<tr><td><code>vctr</code></td>
<td>
<p>vector of contributions of the active variables to the plane</p>
</td></tr>
</table>
<p>The second deals with observations :
</p>
<table role = "presentation">
<tr><td><code>ctr</code></td>
<td>
<p>vector of contributions of the observations to the plane</p>
</td></tr>
<tr><td><code>cos2</code></td>
<td>
<p>vector of squared cosines of the observations in the plane</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).</p>


<h3>See Also</h3>

<p><code><a href="#topic+dimcontrib">dimcontrib</a></code>, <code><a href="#topic+tabcontrib">tabcontrib</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Music)
junk &lt;- c("FrenchPop.NA","Rap.NA","Jazz.NA","Classical.NA","Rock.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
co &lt;- planecontrib(mca)
co$var
</code></pre>

<hr>
<h2 id='plot.csMCA'>Plot of class specific MCA</h2><span id='topic+plot.csMCA'></span>

<h3>Description</h3>

<p>Plots a class specific Multiple Correspondence Analysis (resulting from <code><a href="#topic+csMCA">csMCA</a></code> function), i.e. the clouds of individuals or categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'csMCA'
plot(x, type = "v", axes = 1:2, points = "all",
col = "dodgerblue4", app = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.csMCA_+3A_x">x</code></td>
<td>
<p>object of class <code>csMCA</code></p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_type">type</code></td>
<td>
<p>character string: 'v' to plot the categories (default), 'i' to plot individuals' points, 'inames' to plot individuals' names</p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot (c(1,2) is default)</p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all points are plotted (default); if 'besth' only those who contribute most to horizontal axis are plotted; if 'bestv' only those who contribute most to vertical axis are plotted; if 'besthv' only those who contribute most to horizontal or vertical axis are plotted.</p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_col">col</code></td>
<td>
<p>color for the points of the individuals or for the labels of the categories (default is 'dodgerblue4')</p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_app">app</code></td>
<td>
<p>numerical value. If 0 (default), only the labels of the categories are plotted and their size is constant; if 1, only the labels are plotted and their size is proportional to the weights of the categories; if 2, points (triangles) and labels are plotted, and points size is proportional to the weight of the categories.</p>
</td></tr>
<tr><td><code id="plot.csMCA_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods, such as cex, cex.main, ...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A category is considered to be one of the most contributing to a given axis if its contribution is 
higher than the average contribution, i.e. 100 divided by the total number of categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+csMCA">csMCA</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+conc.ellipse">conc.ellipse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># class specific MCA on Music example data set
# ignoring every NA values categories 
# and focusing on the subset of women,
data(Music)
female &lt;- Music$Gender=="Women"
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- csMCA(Music[,1:5], subcloud = female, excl = junk)
# cloud of categories
plot(mca)
# cloud of most contributing categories
plot(mca,axes=c(2,3), points = "besthv", col = "darkred", app = 1)
</code></pre>

<hr>
<h2 id='plot.multiMCA'>Plot of Multiple Factor Analysis</h2><span id='topic+plot.multiMCA'></span>

<h3>Description</h3>

<p>Plots Multiple Factor Analysis data, resulting from <code><a href="#topic+multiMCA">multiMCA</a></code> function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multiMCA'
plot(x, type = "v", axes = c(1, 2), points = "all", threshold = 2.58,
groups = 1:x$call$ngroups, col = rainbow(x$call$ngroups), app = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.multiMCA_+3A_x">x</code></td>
<td>
<p>object of class <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_type">type</code></td>
<td>
<p>character string: 'v' to plot the categories (default), 'i' to plot individuals' points, 'inames' to plot individuals' names</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot (c(1,2) is default)</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all points are plotted (default); if 'besth' only those who are the most correlated to horizontal axis are plotted; if 'bestv' only those who are the most correlated to vertical axis are plotted; if 'best' only those who are the most coorelated to horizontal or vertical axis are plotted.</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_threshold">threshold</code></td>
<td>
<p>numeric value. V-test minimal value for the selection of plotted categories.</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_groups">groups</code></td>
<td>
<p>numeric vector specifying the groups of categories to plot. By default, every groups of categories will be plotted</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_col">col</code></td>
<td>
<p>a color for the points of the individuals or a vector of colors for the labels of the groups of categories (by default, rainbow palette is used)</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_app">app</code></td>
<td>
<p>numerical value. If 0 (default), only the labels of the categories are plotted and their size is constant; if 1, only the labels are plotted and their size is proportional to the weights of the categories; if 2, points (triangles) and labels are plotted, and points size is proportional to the weight of the categories.</p>
</td></tr>
<tr><td><code id="plot.multiMCA_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods, such as cex, cex.main, ...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A category is considered to be one of the most correlated to a given axis if its test-value is higher then 2.58 (which corresponds to a 0.05 threshold).
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Escofier, B. and Pages, J. (1994) &quot;Multiple Factor Analysis (AFMULT package)&quot;. <em>Computational Statistics and Data Analysis</em>, 18, 121-140.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multiMCA">multiMCA</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA on music variables of Taste example data set
## another one on movie variables of 'Taste' example data set, 
## and then a Multiple Factor Analysis and plots the results.
data(Taste)
# specific MCA on music variables of Taste example data set
mca1 &lt;- speMCA(Taste[,1:5], excl = c(3,6,9,12,15))
# specific MCA on movie variables of Taste example data set
mca2 &lt;- speMCA(Taste[,6:11], excl = c(3,6,9,12,15,18))
# Multiple Factor Analysis
mfa &lt;- multiMCA(list(mca1,mca2))
# plot
plot.multiMCA(mfa, col = c("darkred", "darkblue"))
# plot of the second set of variables (movie)
plot.multiMCA(mfa, groups = 2, app = 1)
</code></pre>

<hr>
<h2 id='plot.speMCA'>Plot of specific MCA</h2><span id='topic+plot.speMCA'></span>

<h3>Description</h3>

<p>Plots a specific Multiple Correspondence Analysis (resulting from <code><a href="#topic+speMCA">speMCA</a></code> function), i.e. the clouds of individuals or categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'speMCA'
plot(x, type = "v", axes = c(1,2), points = "all", col = "dodgerblue4", app = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.speMCA_+3A_x">x</code></td>
<td>
<p>object of class <code>speMCA</code></p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_type">type</code></td>
<td>
<p>character string: 'v' to plot the categories (default), 'i' to plot individuals' points, 'inames' to plot individuals' names</p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot (c(1,2) is default)</p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all points are plotted (default); if 'besth' only those who contribute most to horizontal axis are plotted; if 'bestv' only those who contribute most to vertical axis are plotted; if 'besthv' only those who contribute most to horizontal or vertical axis are plotted; if 'best' only those who contribute most to the plane are plotted.</p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_col">col</code></td>
<td>
<p>color for the points of the individuals or for the labels of the categories (default is 'dodgerblue4')</p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_app">app</code></td>
<td>
<p>numerical value. If 0 (default), only the labels of the categories are plotted and their size is constant; if 1, only the labels are plotted and their size is proportional to the weights of the categories; if 2, points (triangles) and labels are plotted, and points size is proportional to the weight of the categories.</p>
</td></tr>
<tr><td><code id="plot.speMCA_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods, such as cex, cex.main, ...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A category is considered to be one of the most contributing to a given axis if its contribution is 
higher than the average contribution, i.e. 100 divided by the total number of categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+conc.ellipse">conc.ellipse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# cloud of categories
plot(mca)
</code></pre>

<hr>
<h2 id='plot.stMCA'>Plot of standardized MCA</h2><span id='topic+plot.stMCA'></span>

<h3>Description</h3>

<p>Plots a standardized Multiple Correspondence Analysis (resulting from <code><a href="#topic+stMCA">stMCA</a></code> function), i.e. the clouds of individuals or categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stMCA'
plot(x, type = "v", axes = 1:2, points = "all", threshold = 2.58, groups=NULL, 
                            col = "dodgerblue4", app = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.stMCA_+3A_x">x</code></td>
<td>
<p>object of class <code>stMCA</code></p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_type">type</code></td>
<td>
<p>character string: 'v' to plot the categories (default), 'i' to plot individuals' points, 'inames' to plot individuals' names</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the components (axes) to plot (c(1,2) is default)</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_points">points</code></td>
<td>
<p>character string. If 'all' all points are plotted (default); if 'besth' only those who are the most correlated to horizontal axis are plotted; if 'bestv' only those who are the most correlated to vertical axis are plotted; if 'best' only those who are the most coorelated to horizontal or vertical axis are plotted.</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_threshold">threshold</code></td>
<td>
<p>numeric value. V-test minimal value for the selection of plotted categories.</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_groups">groups</code></td>
<td>
<p>only if x$call$input.mca = 'multiMCA', i.e. if the MCA standardized to x object was a <code>multiMCA</code> object. Numeric vector specifying the groups of categories to plot. By default, every groups of categories will be plotted</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_col">col</code></td>
<td>
<p>color for the points of the individuals or for the labels of the categories (default is 'dodgerblue4')</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_app">app</code></td>
<td>
<p>numerical value. If 0 (default), only the labels of the categories are plotted and their size is constant; if 1, only the labels are plotted and their size is proportional to the weights of the categories; if 2, points (triangles) and labels are plotted, and points size is proportional to the weight of the categories.</p>
</td></tr>
<tr><td><code id="plot.stMCA_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods, such as cex, cex.main, ...</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A category is considered to be one of the most correlated to a given axis if its test-value is higher then 2.58 (which corresponds to a 0.05 threshold).
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., Robette N., Roueff O., 2016, « A dialogue of the deaf in the statistical theater? Adressing structural effects within a geometric data analysis framework », <em>Quality &amp; Quantity</em>, 50(3), pp 1009–1020 [https://link.springer.com/article/10.1007/s11135-015-0187-z]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stMCA">stMCA</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+conc.ellipse">conc.ellipse</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># standardized MCA of Music example data set
# controlling for age
## and then draws the cloud of categories.
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
stmca &lt;- stMCA(mca, control = list(Music$Age))
# cloud of categories
plot(stmca)
# cloud of categories on dimensions 2 and 3
plot(stmca, axes = c(2,3), points = "best", col = "darkred", app = 1)
</code></pre>

<hr>
<h2 id='quadrant'>Quadrant of active individuals</h2><span id='topic+quadrant'></span>

<h3>Description</h3>

<p>Computes the quadrant of active individuals from a MCA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadrant(resmca, dim = c(1,2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quadrant_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="quadrant_+3A_dim">dim</code></td>
<td>
<p>dimensions of the space (default is c(1,2))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a factor with four levels : upper_left, lower_left, upper_right, lower_right
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+speMCA">speMCA</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# distribution of the quadrants
table(quadrant(mca, c(1,2)))
</code></pre>

<hr>
<h2 id='quasindep'>Quasi-correspondence analysis</h2><span id='topic+quasindep'></span>

<h3>Description</h3>

<p>Transforms a symmetrical contingency table so that it can be used for quasi-correspondence analysis, also called correspondence analysis of incomplete contingency table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quasindep(tab, order = 3, tol = 1e-6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quasindep_+3A_tab">tab</code></td>
<td>
<p>a symmetric table or matrix</p>
</td></tr>
<tr><td><code id="quasindep_+3A_order">order</code></td>
<td>
<p>numeric value. Order of reconstitution of the quasi-independence data. Default is 3.</p>
</td></tr>
<tr><td><code id="quasindep_+3A_tol">tol</code></td>
<td>
<p>numeric value. The tolerance threshold to be considered for convergence to null during iteration process. Default is 1e-6.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In order to carry out a &quot;quasi-correspondence analysis&quot;, also called &quot;correspondence analysis of incomplete table&quot;, the principle is to stop analyzing the differences between the observed data and the situation of independence between the variable in rows and the variable in columns, as it is the case in the classical correspondence analysis, and to consider the differences between the data and a situation of quasi-independence, i.e. independence for some cells of the table only. In the most common situation, it is therefore a matter of applying the independence hypothesis to the off-diagonal cells only and replacing the diagonal with values that do not influence the analysis. Such values are obtained in an iterative way by replacing the numbers of the cells of the diagonal by their third order reconstruction, then by recalculating the correspondence analysis until convergence is reached. The algorithm used is developed in van der Heijden (1992: 11-12).
</p>


<h3>Value</h3>

<p>An object of the same class and dimensions as <code>tab</code> : the quasi-independence data to be analyzed with Correspondence Analysis.
</p>


<h3>Note</h3>

<p>This function is adapted from Milan Bouchet-Valat's script in the supplementary material of his article indicated in the reference section.
</p>


<h3>References</h3>

<p>De Leeuw J et van der Heijden PGM (1985) <em>Quasi-Correspondence Analysis</em>. Leiden: University
of Leiden.
</p>
<p>Van der Heijden PGM (1992) Three Approaches to Study the Departure from Quasi-independence. <em>Statistica Applicata</em> 4: 465-80.
</p>
<p>Bouchet-Valat M (2015) L'analyse statistique des tables de contingence carrées - L'homogamie socioprofessionnelle en
France - I, L'analyse des correspondances <em>Bulletin de Méthodologie Sociologique</em> 125: 65–88. &lt;doi:10.1177/0759106314555655&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
tab &lt;- matrix(c(165,49,70,100,48,223,
                6,201,226,212,90,216,
                4,96,446,214,72,77,
                5,84,305,317,126,188,
                3,52,151,190,110,189,
                17,234,310,601,309,1222),
                nrow = 6, ncol = 6, byrow = TRUE)
newtab &lt;- quasindep(tab)

## End(Not run)
</code></pre>

<hr>
<h2 id='rvcoef'>RV coefficient</h2><span id='topic+rvcoef'></span>

<h3>Description</h3>

<p>Computes the RV coefficient between two groups of numerical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rvcoef(Xa, Xb, row.w = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rvcoef_+3A_xa">Xa</code></td>
<td>
<p>data frame with the first group of numerical variables</p>
</td></tr>
<tr><td><code id="rvcoef_+3A_xb">Xb</code></td>
<td>
<p>data frame with the second group of numerical variables</p>
</td></tr>
<tr><td><code id="rvcoef_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Xa</code> and <code>Xb</code> should have the same number of rows.
</p>


<h3>Value</h3>

<p>numerical value : the RV coefficient
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette
</p>


<h3>References</h3>

<p>Escouffier, Y. (1973) Le traitement des variables vectorielles. <em>Biometrics</em> 29 751–760.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+coiPCA">coiPCA</a></code>, <code><a href="#topic+coiMCA">coiMCA</a></code>, <code><a href="#topic+multiMCA">multiMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># RV coefficient between decathlon results by sport
# and Rank and Points
library(FactoMineR)
data(decathlon)
Xa &lt;- decathlon[,1:10]
Xb &lt;- decathlon[,11:12]
str(Xa)
str(Xb)
rvcoef(Xa, Xb)
</code></pre>

<hr>
<h2 id='speMCA'>specific MCA</h2><span id='topic+speMCA'></span>

<h3>Description</h3>

<p>Performs a specific Multiple Correspondence Analysis, i.e. a variant of MCA that allows to treat undesirable categories as passive categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>speMCA(data, excl = NULL, ncp = 5, row.w = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="speMCA_+3A_data">data</code></td>
<td>
<p>data frame with n rows (individuals) and p columns (categorical variables)</p>
</td></tr>
<tr><td><code id="speMCA_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="speMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (default is 5)</p>
</td></tr>
<tr><td><code id="speMCA_+3A_row.w">row.w</code></td>
<td>
<p>an optional numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Undesirable (i.e. &quot;junk&quot;) categories may be of several kinds: infrequent categories (say, &lt;5 percents), heterogeneous categories (e.g. &quot;others&quot;) or uninterpretable categories (e.g. &quot;not available&quot;). In these cases, specific MCA may be useful to ignore these categories for the determination of distances between individuals (see references).
</p>
<p>If there are NAs in <code>data</code>, these NAs will be automatically considered as junk categories. If one desires more flexibility, <code>data</code> should be recoded to add explicit factor levels for NAs and then <code>excl</code> option may be used to select the junk categories.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>speMCA</code>, i.e. a list including:
</p>
<table role = "presentation">
<tr><td><code>eig</code></td>
<td>
<p>a list of vectors containing all the eigenvalues, the percentage of variance, the cumulative percentage of variance, the modified rates and the cumulative modified rates</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>a list with informations about input data</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>a list of matrices containing the results for the individuals (coordinates, contributions, squared cosines and total distances)</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>a list of matrices containing all the results for the categories and variables (weights, coordinates, squared cosines, categories contributions to axes and cloud, test values (v.test), squared correlation ratio (eta2), variable contributions to axes and cloud, total distances</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+getindexcat">getindexcat</a></code>, <code><a href="#topic+ijunk">ijunk</a></code>, <code><a href="#topic+plot.speMCA">plot.speMCA</a></code>, <code><a href="#topic+ggcloud_indiv">ggcloud_indiv</a></code>, <code><a href="#topic+ggcloud_variables">ggcloud_variables</a></code>, <code><a href="#topic+csMCA">csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# This is equivalent to :
mca &lt;- speMCA(Music[,1:5], excl = c(3,6,9,12,15))
</code></pre>

<hr>
<h2 id='stMCA'>Standardized MCA</h2><span id='topic+stMCA'></span>

<h3>Description</h3>

<p>Performs a standardized Multiple Correspondence Analysis, i.e it takes MCA results and forces all the dimensions to be orthogonal to a supplementary &quot;control&quot; variable.</p>


<h3>Usage</h3>

<pre><code class='language-R'>stMCA(resmca, control)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stMCA_+3A_resmca">resmca</code></td>
<td>
<p>an object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="stMCA_+3A_control">control</code></td>
<td>
<p>a list of control variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Standardized MCA unfolds in several steps.
1. First, for each dimension of an input MCA, individual coordinates are used as dependent variable in a linear regression model and the 'control' variable is included as covariate in the same model.
2. The residuals from every models are retained and bound together. The resulting data frame is composed of continuous variables and its number of columns is equal to the number of dimensions in the input MCA.
3. Lastly, this data frame is used as input in a Principal Component Analysis.
</p>
<p>It is exactly equivalent to MCA with one orthogonal instrumental variable (see <code><a href="#topic+MCAoiv">MCAoiv</a></code>)
</p>


<h3>Value</h3>

<p>Returns an object of class <code>stMCA</code>. This object will be similar to <code>resmca</code> argument, still it does not comprehend modified rates, categories contributions and variables contributions.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Bry X., Robette N., Roueff O., 2016, « A dialogue of the deaf in the statistical theater? Adressing structural effects within a geometric data analysis framework », <em>Quality &amp; Quantity</em>, 50(3), pp 1009–1020 [https://link.springer.com/article/10.1007/s11135-015-0187-z]
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.stMCA">plot.stMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># standardized MCA of Music example data set
# controlling for age
## and then draws the cloud of categories.
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
stmca &lt;- stMCA(mca, control = list(Music$Age))
</code></pre>

<hr>
<h2 id='supind'>Statistics for supplementary individuals</h2><span id='topic+supind'></span><span id='topic+indsup'></span>

<h3>Description</h3>

<p>From MCA results, computes statistics (coordinates, squared cosines) for 
supplementary individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supind(resmca, supdata)

indsup(resmca, supdata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="supind_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code> or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="supind_+3A_supdata">supdata</code></td>
<td>
<p>data frame with the supplementary individuals. It must have the same factors as the data frame used as input for the initial MCA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following items :
</p>
<table role = "presentation">
<tr><td><code>coord</code></td>
<td>
<p>matrix of individuals coordinates</p>
</td></tr>
<tr><td><code>cos2</code></td>
<td>
<p>matrix of individuals squared cosines</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code>indsup</code> is softly deprecated. Please use <code>supind</code> instead.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ggadd_supind">ggadd_supind</a></code>,<code><a href="#topic+textindsup">textindsup</a></code>, <code><a href="#topic+supvar">supvar</a></code>, <code><a href="#topic+supvars">supvars</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
# excluding the first two observations
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[3:nrow(Music),1:5], excl = junk)
# computes coordinates and squared cosines
# of the first two (supplementary) observations
supind(mca,Music[1:2,1:5])
</code></pre>

<hr>
<h2 id='supvar'>Statistics for a categorical supplementary variable</h2><span id='topic+supvar'></span><span id='topic+varsup'></span>

<h3>Description</h3>

<p>From MCA results, computes statistics (weights, coordinates, contributions, test-values, variances) for 
a categorical supplementary variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supvar(resmca, var)

varsup(resmca, var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="supvar_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="supvar_+3A_var">var</code></td>
<td>
<p>the categorical supplementary variable. It does not need to have been used at the MCA step.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list:
</p>
<table role = "presentation">
<tr><td><code>weight</code></td>
<td>
<p>numeric vector of categories weights</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>data frame of categories coordinates</p>
</td></tr>
<tr><td><code>cos2</code></td>
<td>
<p>data frame of categories squared cosines</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>data frame of categories within variances, variance between and within categories and variable squared correlation ratio (eta2)</p>
</td></tr>
<tr><td><code>typic</code></td>
<td>
<p>data frame of categories typicality test statistics</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>data frame of categories p-values from typicality test statistics</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>data frame of categories correlation coefficients</p>
</td></tr>  
</table>


<h3>Note</h3>

<p><code>varsup</code> is softly deprecated. Please use <code>supvar</code> instead.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+supvars">supvars</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+supind">supind</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# computes statistics for Age supplementary variable
supvar(mca,Music$Age)
</code></pre>

<hr>
<h2 id='supvars'>Statistics for categorical supplementary variables</h2><span id='topic+supvars'></span><span id='topic+varsups'></span>

<h3>Description</h3>

<p>From MCA results, computes statistics (weights, coordinates, squared cosines, contributions, test-values, variances) for categorical supplementary variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supvars(resmca, vars)

varsups(resmca, vars)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="supvars_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="supvars_+3A_vars">vars</code></td>
<td>
<p>A data frame of categorical supplementary variables. All these variables should be factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with the following items :
</p>
<table role = "presentation">
<tr><td><code>weight</code></td>
<td>
<p>numeric vector of categories weights</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>data frame of categories coordinates</p>
</td></tr>
<tr><td><code>cos2</code></td>
<td>
<p>data frame of categories squared cosines</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>a list of data frames of categories within variances, variance between and within categories and variable square correlation ratio (eta2)</p>
</td></tr>
<tr><td><code>typic</code></td>
<td>
<p>data frame of categories typicality test statistics</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>data frame of categories p-values from typicality test statistics</p>
</td></tr>
<tr><td><code>cor</code></td>
<td>
<p>data frame of categories correlation coefficients</p>
</td></tr>  
</table>


<h3>Note</h3>

<p><code>varsups</code> is softly deprecated. Please use <code>supvars</code> instead.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+supvar">supvar</a></code>, <code><a href="#topic+ggadd_supvar">ggadd_supvar</a></code>, <code><a href="#topic+ggadd_supvars">ggadd_supvars</a></code>, <code><a href="#topic+textvarsup">textvarsup</a></code>, <code><a href="#topic+supind">supind</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# computes statistics for Gender and Age supplementary variables
supvars(mca, Music[, c("Gender","Age")])
</code></pre>

<hr>
<h2 id='tabcontrib'>Table with the main contributions of categories to an axis</h2><span id='topic+tabcontrib'></span>

<h3>Description</h3>

<p>Identifies the categories that contribute the most to a given dimension of a Multiple Correspondence 
Analysis and organizes these informations into a fancy table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tabcontrib(resmca, dim = 1, best = TRUE, dec = 2, shortlabs = FALSE)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tabcontrib_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="tabcontrib_+3A_dim">dim</code></td>
<td>
<p>dimension to describe (default is 1st dimension)</p>
</td></tr>
<tr><td><code id="tabcontrib_+3A_best">best</code></td>
<td>
<p>if FALSE, displays all the categories; if TRUE (default), displays only categories with contributions higher than average</p>
</td></tr>
<tr><td><code id="tabcontrib_+3A_dec">dec</code></td>
<td>
<p>integer. The number of decimals for the results (default is 2)</p>
</td></tr>
<tr><td><code id="tabcontrib_+3A_shortlabs">shortlabs</code></td>
<td>
<p>logical. If TRUE, the data frame will have short column names, so that all columns can be displayed side by side on a laptop screen. Default is FALSE (long explicit column names).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the following contributions.: 
</p>
<table role = "presentation">
<tr><td><code>Variable</code></td>
<td>
<p>names of the variables</p>
</td></tr>
<tr><td><code>Category</code></td>
<td>
<p>names of the categories</p>
</td></tr>
<tr><td><code>Weight</code></td>
<td>
<p>weights of the categories</p>
</td></tr>
<tr><td><code>Quality of representation</code></td>
<td>
<p>quality of representation (squared cosine) of the categories on the axis</p>
</td></tr>
<tr><td><code>Contribution (left)</code></td>
<td>
<p>contributions of the categories located on one side of the axis</p>
</td></tr>
<tr><td><code>Contribution (right)</code></td>
<td>
<p>contributions of the categories located on the other side of the axis</p>
</td></tr>
<tr><td><code>Total contribution</code></td>
<td>
<p>contributions summed by variable</p>
</td></tr>
<tr><td><code>Cumulated contribution</code></td>
<td>
<p>cumulated sum of the contributions</p>
</td></tr>
<tr><td><code>Contribution of deviation</code></td>
<td>
<p>for each variable, contribution of the deviation between the barycenter of the categories located on one side of the axis and the barycenter of those located on the other side</p>
</td></tr>
<tr><td><code>Proportion to variable</code></td>
<td>
<p>contribution of deviation expressed as a proportion of the contribution of the variable</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Le Roux B. and Rouanet H., <em>Multiple Correspondence Analysis</em>, SAGE, Series: Quantitative Applications in the Social Sciences, Volume 163, CA:Thousand Oaks (2010).
</p>
<p>Le Roux B. and Rouanet H., <em>Geometric Data Analysis: From Correspondence Analysis to Stuctured Data Analysis</em>, Kluwer Academic Publishers, Dordrecht (June 2004).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dimcontrib">dimcontrib</a></code>, <code><a href="#topic+dimdescr">dimdescr</a></code>, <code><a href="#topic+dimeta2">dimeta2</a></code>, <code><a href="#topic+dimtypicality">dimtypicality</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# main contributions on axis 1
tabcontrib(mca, 1)
# main contributions on axis 2
tabcontrib(mca, 2)
</code></pre>

<hr>
<h2 id='Taste'>Taste (data)</h2><span id='topic+Taste'></span>

<h3>Description</h3>

<p>The data concerns tastes for music and movies of a set of 2000 individuals. It contains 5 variables of likes for music genres (french pop, rap, rock, jazz and classical), 6 variables of likes for movie genres (comedy, crime, animation, science fiction, love, musical) and 2 additional variables (gender and age).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Taste)</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 observations and the following 13 variables:
</p>

<dl>
<dt><code>FrenchPop</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Rap</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Rock</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Jazz</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Classical</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Comedy</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Crime</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Animation</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>SciFi</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Love</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Musical</code></dt><dd><p>factor with levels <code>No</code>, <code>Yes</code>, <code>NA</code></p>
</dd>
<dt><code>Gender</code></dt><dd><p>factor with levels <code>Men</code>, <code>Women</code></p>
</dd>
<dt><code>Age</code></dt><dd><p>factor with levels <code>15-24</code>, <code>25-49</code>, <code>50+</code></p>
</dd>
<dt><code>Educ</code></dt><dd><p>factor with levels <code>none</code>, <code>low</code>, <code>medium</code>, <code>high</code></p>
</dd>
</dl>



<h3>Details</h3>

<p><code>NA</code> stands for &quot;not available&quot;</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Taste)
str(Taste)
</code></pre>

<hr>
<h2 id='textindsup'>Plot of supplementary individuals</h2><span id='topic+textindsup'></span>

<h3>Description</h3>

<p>Adds supplementary individuals to a MCA cloud of the individuals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>textindsup(resmca, supdata, axes = c(1, 2), col = "darkred")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="textindsup_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, or <code>csMCA</code></p>
</td></tr>
<tr><td><code id="textindsup_+3A_supdata">supdata</code></td>
<td>
<p>data frame with the supplementary individuals. It must have the same factors as the data frame used as input for the initial MCA.</p>
</td></tr>
<tr><td><code id="textindsup_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the dimensions (axes) to plot (default is c(1,2))</p>
</td></tr>
<tr><td><code id="textindsup_+3A_col">col</code></td>
<td>
<p>color for the labels of the categories (default is &quot;darkred&quot;)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+supind">supind</a></code>, <code><a href="#topic+plot.speMCA">plot.speMCA</a></code>, <code><a href="#topic+plot.csMCA">plot.csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
# excluding the first two observations
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[3:nrow(Music), 1:5], excl = junk)
# cloud of active individuals
# with the two supplementary individuals
plot(mca, type = "i")
textindsup(mca, Music[1:2, 1:5])
</code></pre>

<hr>
<h2 id='textvarsup'>Plot of a categorical supplementary variable</h2><span id='topic+textvarsup'></span>

<h3>Description</h3>

<p>Adds a categorical supplementary variable to a MCA cloud of categories.</p>


<h3>Usage</h3>

<pre><code class='language-R'>textvarsup(resmca, var, sel = 1:nlevels(var), axes = c(1, 2), 
           col = "black", app = 0, vname = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="textvarsup_+3A_resmca">resmca</code></td>
<td>
<p>object of class <code>MCA</code>, <code>speMCA</code>, <code>csMCA</code>, <code>stMCA</code> or <code>multiMCA</code></p>
</td></tr>
<tr><td><code id="textvarsup_+3A_var">var</code></td>
<td>
<p>the categorical supplementary variable. It does not need to have been used at the MCA step.</p>
</td></tr>
<tr><td><code id="textvarsup_+3A_sel">sel</code></td>
<td>
<p>numeric vector of indexes of the categories of the supplementary variable to be added to the plot (by default, labels are plotted for every categories)</p>
</td></tr>
<tr><td><code id="textvarsup_+3A_axes">axes</code></td>
<td>
<p>numeric vector of length 2, specifying the dimensions (axes) to plot (default is c(1,2))</p>
</td></tr>
<tr><td><code id="textvarsup_+3A_col">col</code></td>
<td>
<p>color for the labels of the categories (default is black)</p>
</td></tr>
<tr><td><code id="textvarsup_+3A_app">app</code></td>
<td>
<p>numerical value. If 0 (default), only the labels are plotted and their size is constant; if 1, only the labels are plotted and their size is proportional to the weights of the categories; if 2, points (triangles) and labels are plotted, and points size is proportional to the weight of the categories.</p>
</td></tr>
<tr><td><code id="textvarsup_+3A_vname">vname</code></td>
<td>
<p>a character string to be used as a prefix for the labels of the categories (null by default)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>See Also</h3>

<p><code><a href="#topic+supvar">supvar</a></code>, <code><a href="#topic+supvars">supvars</a></code>, <code><a href="#topic+plot.speMCA">plot.speMCA</a></code>, <code><a href="#topic+plot.csMCA">plot.csMCA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># specific MCA of Music example data set
data(Music)
junk &lt;- c("FrenchPop.NA", "Rap.NA", "Rock.NA", "Jazz.NA", "Classical.NA")
mca &lt;- speMCA(Music[,1:5], excl = junk)
# cloud of categories
# with Gender and Age supplementary variables
plot(mca, col = "gray")
textvarsup(mca, Music$Gender,col = "darkred")
textvarsup(mca, Music$Age, sel = c(1,3), col = "orange",
           vname = "age", app = 1)
</code></pre>

<hr>
<h2 id='translate.logit'>Deprecated function</h2><span id='topic+translate.logit'></span>

<h3>Description</h3>

<p>This function has been moved to the <code>translate.logit</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>translate.logit(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="translate.logit_+3A_...">...</code></td>
<td>
<p>arguments are ignored</p>
</td></tr>
</table>

<hr>
<h2 id='wcMCA'>Within-class MCA</h2><span id='topic+wcMCA'></span>

<h3>Description</h3>

<p>Within-class MCA, also called conditional MCA
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wcMCA(data, class, excl = NULL, row.w = NULL, ncp = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wcMCA_+3A_data">data</code></td>
<td>
<p>data frame with only categorical variables, i.e. factors</p>
</td></tr>
<tr><td><code id="wcMCA_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="wcMCA_+3A_excl">excl</code></td>
<td>
<p>numeric vector indicating the indexes of the &quot;junk&quot; categories (default is NULL). See <code><a href="#topic+getindexcat">getindexcat</a></code> or use <code><a href="#topic+ijunk">ijunk</a></code> interactive function to identify these indexes. It may also be a character vector of junk categories, specified in the form &quot;namevariable.namecategory&quot; (for instance &quot;gender.male&quot;).</p>
</td></tr>
<tr><td><code id="wcMCA_+3A_row.w">row.w</code></td>
<td>
<p>numeric vector of row weights. If NULL (default), a vector of 1 for uniform row weights is used.</p>
</td></tr>
<tr><td><code id="wcMCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within-class Multiple Correspondence Analysis is a MCA where the active categories are centered on the mean of their class (i.e. conditional frequencies) instead of the overall mean (i.e. marginal frequencies).
</p>
<p>It is also known as &quot;conditional MCA&quot; and can be seen as a special case of MCA on orthogonal instrumental variables, with only one (categorical) instrumental variable.
</p>


<h3>Value</h3>

<p>An object of class <code>speMCA</code>, with an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the within-class inertia percentage</p>
</td></tr></table>
<p>.
</p>


<h3>Note</h3>

<p>The code is adapted from <code>speMCA</code> function.
</p>
<p>As in <code>speMCA</code>, if there are NAs in <code>data</code>, these NAs will be automatically considered as junk categories. If one desires more flexibility, <code>data</code> should be recoded to add explicit factor levels for NAs and then <code>excl</code> option may be used to select the junk categories.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Escofier B., 1990, Analyse des correspondances multiples conditionnelle, <em>La revue de Modulad</em>, 5, 13-28.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MCAoiv">MCAoiv</a></code>, <code><a href="#topic+wcPCA">wcPCA</a></code>, <code><a href="#topic+PCAoiv">PCAoiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># within-class analysis of tea data
# with SPC as class
library(FactoMineR)
data(tea)
res &lt;- wcMCA(tea[,1:18], tea$SPC)
res$ratio
ggcloud_variables(res)
</code></pre>

<hr>
<h2 id='wcPCA'>Within-class Principal Component Analysis</h2><span id='topic+wcPCA'></span>

<h3>Description</h3>

<p>Within-class Principal Component Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wcPCA(X, class, scale.unit = TRUE, ncp = 5, ind.sup = NULL, quanti.sup = NULL, 
          quali.sup = NULL, row.w = NULL, col.w = NULL, graph = FALSE, 
          axes = c(1, 2))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wcPCA_+3A_x">X</code></td>
<td>
<p>a data frame with <em>n</em> rows (individuals) and <em>p</em> columns (numeric variables)</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_class">class</code></td>
<td>
<p>factor specifying the class</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_scale.unit">scale.unit</code></td>
<td>
<p>a boolean, if TRUE (default) then data are scaled to unit variance</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_ncp">ncp</code></td>
<td>
<p>number of dimensions kept in the results (by default 5)</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_ind.sup">ind.sup</code></td>
<td>
<p>a vector indicating the indexes of the supplementary individuals</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_quanti.sup">quanti.sup</code></td>
<td>
<p>a vector indicating the indexes of the quantitative supplementary variables</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_quali.sup">quali.sup</code></td>
<td>
<p>a vector indicating the indexes of the categorical supplementary variables</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_row.w">row.w</code></td>
<td>
<p>an optional row weights (by default, a vector of 1 for uniform row weights); the weights are given only for the active individuals</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_col.w">col.w</code></td>
<td>
<p>an optional column weights (by default, uniform column weights); the weights are given only for the active variables</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_graph">graph</code></td>
<td>
<p>boolean, if TRUE a graph is displayed. Default is FALSE.</p>
</td></tr>
<tr><td><code id="wcPCA_+3A_axes">axes</code></td>
<td>
<p>a length 2 vector specifying the components to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Within-class Principal Component Analysis is a PCA where the active variables are centered on the mean of their class instead of the overall mean.
</p>
<p>It is a &quot;conditional&quot; PCA and can be seen as a special case of PCA with orthogonal instrumental variables, with only one (categorical) instrumental variable.
</p>


<h3>Value</h3>

<p>An object of class <code>PCA</code> from <code>FactoMineR</code> package, with an additional item :
</p>
<table role = "presentation">
<tr><td><code>ratio</code></td>
<td>
<p>the within-class inertia percentage</p>
</td></tr></table>
<p>.
</p>


<h3>Note</h3>

<p>The code is adapted from <code>PCA</code> function from <code>FactoMineR</code> package.
</p>


<h3>Author(s)</h3>

<p>Nicolas Robette</p>


<h3>References</h3>

<p>Escofier B., 1990, Analyse des correspondances multiples conditionnelle, <em>La revue de Modulad</em>, 5, 13-28.
</p>
<p>Lebart L., Morineau A. et Warwick K., 1984, <em>Multivariate Descriptive Statistical Analysis</em>, John Wiley and sons, New-York.)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PCAoiv">PCAoiv</a></code>, <code><a href="#topic+wcMCA">wcMCA</a></code>, <code><a href="#topic+MCAoiv">MCAoiv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># within-class analysis of decathlon data
# with quatiles of points as class
library(FactoMineR)
data(decathlon)
points &lt;- cut(decathlon$Points, c(7300, 7800, 8000, 8120, 8900), c("Q1","Q2","Q3","Q4"))
res &lt;- wcPCA(decathlon[,1:10], points)
plot(res, choix = "var")
</code></pre>

<hr>
<h2 id='wtable'>Deprecated functions</h2><span id='topic+wtable'></span><span id='topic+pem'></span><span id='topic+phi.table'></span><span id='topic+assoc.twocont'></span><span id='topic+assoc.twocat'></span><span id='topic+assoc.catcont'></span><span id='topic+assoc.yx'></span><span id='topic+darma'></span><span id='topic+catdesc'></span><span id='topic+condesc'></span><span id='topic+ggassoc_phiplot'></span><span id='topic+ggassoc_boxplot'></span><span id='topic+ggassoc_scatter'></span><span id='topic+ggassoc_crosstab'></span>

<h3>Description</h3>

<p>These functions have been moved to the <code>descriptio</code> package. You may check its documentation here :
https://nicolas-robette.github.io/descriptio/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wtable(...)

pem(...)

phi.table(...)

assoc.twocont(...)

assoc.twocat(...)

assoc.catcont(...)

assoc.yx(...)

darma(...)

catdesc(...)

condesc(...)

ggassoc_phiplot(...)

ggassoc_boxplot(...)

ggassoc_scatter(...)

ggassoc_crosstab(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wtable_+3A_...">...</code></td>
<td>
<p>arguments are ignored</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
