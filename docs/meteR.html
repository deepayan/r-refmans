<!DOCTYPE html><html><head><title>Help for package meteR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {meteR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anbo'><p>Community abundance data for a desert grassland (anza borrego)</p></a></li>
<li><a href='#arth'><p>Arthropod community abundance data</p></a></li>
<li><a href='#downscaleSAR'><p>Downscale the species area relationship (SAR) or endemics area relationship (EAR)</p></a></li>
<li><a href='#ebar'><p>Relationship between mean metabolic rate (<code class="reqn">\bar{\epsilon}</code>) and abundance</p></a></li>
<li><a href='#empiricalSAR'><p>Empirical SAR or EAR</p></a></li>
<li><a href='#ipd'><p>Individual Power Distribution</p></a></li>
<li><a href='#logLik.meteDist'><p>Compute log-likelihood of a meteDist object</p></a></li>
<li><a href='#logLikZ'><p>Compute log-likelihood z-score</p></a></li>
<li><a href='#meteDist2Rank'><p>meteDist2Rank</p></a></li>
<li><a href='#meteESF'><p>meteESF</p></a></li>
<li><a href='#meteNu'><p>Equation of the PMF for the METE species metabolic rate distribution</p></a></li>
<li><a href='#metePhi'><p>Equation of the METE species abundance distribution</p></a></li>
<li><a href='#metePi'><p>Equation of the PMF of the METE spatial species abundance distribution</p></a></li>
<li><a href='#metePsi'><p>Equation of the PMF for the METE individual metabolic rate distribution</p></a></li>
<li><a href='#meteR-package'>
<p>Analyses with the Maximum Entropy Theory of Ecology (METE)</p></a></li>
<li><a href='#meteSAR'><p>Compute METE species area relationship (SAR)</p></a></li>
<li><a href='#meteSSF'><p>meteSSF</p></a></li>
<li><a href='#meteTheta'><p>Equation of the PMF for the METE Intra-specific metabolic rate distribution</p></a></li>
<li><a href='#mse'><p>Computes mean squared error for rank or cdf</p></a></li>
<li><a href='#mseZ'><p>Compute z-score of mean squared error</p></a></li>
<li><a href='#plot.damuth'><p>Plot the relationship between abundance and metabolic rate, i.e. objects of class damuth</p></a></li>
<li><a href='#plot.meteDist'><p>Plot METE distributions and associated data</p></a></li>
<li><a href='#plot.meteRelat'><p>Plot predicted METE relationships and associated observed relationship seen in data</p></a></li>
<li><a href='#plot.sar'><p>Plot the species abundance distribution (SAR), i.e. objects of class sar</p></a></li>
<li><a href='#predictESF'><p>predictESF</p></a></li>
<li><a href='#print.damuth'><p>print.damuth</p></a></li>
<li><a href='#print.meteDist'><p>Print summaries of <code>meteDist</code> objects</p></a></li>
<li><a href='#print.meteESF'><p>print.meteESF</p></a></li>
<li><a href='#print.meteRelat'><p>Print summaries of <code>meteRelat</code> objects</p></a></li>
<li><a href='#print.sar'><p>print.sar</p></a></li>
<li><a href='#residuals.meteDist'><p>Compute residuals between METE predictions and data of a meteDist object</p></a></li>
<li><a href='#residuals.meteRelat'><p>Compute residuals between METE predictions and date of a meteRelat object</p></a></li>
<li><a href='#sad'><p>METE species abundance distribution</p></a></li>
<li><a href='#sipd'><p>Generic method to obtain the species-level individual power distribution (SIPD)</p></a></li>
<li><a href='#spd'><p>Species Power Distribution</p></a></li>
<li><a href='#ssad'><p>Species Spatial Abundance Distribution</p></a></li>
<li><a href='#upscaleSAR'><p>upscale SAR</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting and Plotting Tools for the Maximum Entropy Theory of
Ecology (METE)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-06-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Andy Rominger, Cory Merow</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cory Merow &lt;cory.merow@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and plot macroecological patterns predicted by the Maximum
    Entropy Theory of Ecology (METE).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cmerow/meteR">https://github.com/cmerow/meteR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cmerow/meteR/issues">https://github.com/cmerow/meteR/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>nleqslv, distr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-06-27 14:02:00 UTC; ctg</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-06-27 17:22:44</td>
</tr>
</table>
<hr>
<h2 id='anbo'>Community abundance data for a desert grassland (anza borrego)</h2><span id='topic+anbo'></span>

<h3>Description</h3>

<p>A dataset containing the community abundace data for plant species, as well
as the locations of plots with respect to one another
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anbo
</code></pre>


<h3>Format</h3>

<p>A data frame with 121 rows and 4 variables:
</p>

<dl>
<dt>row</dt><dd><p>plot coordinate</p>
</dd>
<dt>column</dt><dd><p>plot coordinate</p>
</dd>
<dt>spp</dt><dd><p>species ID</p>
</dd>
<dt>count</dt><dd><p>number of individuals</p>
</dd>
</dl>

<hr>
<h2 id='arth'>Arthropod community abundance data</h2><span id='topic+arth'></span>

<h3>Description</h3>

<p>A dataset containing the community abundace data for individuals, as well
as their body mass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arth
</code></pre>


<h3>Format</h3>

<p>A data frame with 547 rows and 3 variables:
</p>

<dl>
<dt>spp</dt><dd><p>species ID</p>
</dd>
<dt>count</dt><dd><p>number of individuals</p>
</dd>
<dt>mass</dt><dd><p>biomass</p>
</dd>
</dl>


<h3>Source</h3>

<p>Gruner, D. S. 2007. Geological age, ecosystem development, and local resource constraints on arthropod community structure in the Hawaiian Islands. Biological Journal of the Linnean Society, 90: 551&ndash;570.
</p>

<hr>
<h2 id='downscaleSAR'>Downscale the species area relationship (SAR) or endemics area relationship (EAR)</h2><span id='topic+downscaleSAR'></span>

<h3>Description</h3>

<p>Compute METE SAR by downscaling from some larger area <code>A0</code> to a smaller areas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downscaleSAR(x, A, A0, EAR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="downscaleSAR_+3A_x">x</code></td>
<td>
<p>an object of class meteESF</p>
</td></tr>
<tr><td><code id="downscaleSAR_+3A_a">A</code></td>
<td>
<p>numerical vector of areas (&lt;= <code>A0</code>) for which the METE prediction is desired</p>
</td></tr>
<tr><td><code id="downscaleSAR_+3A_a0">A0</code></td>
<td>
<p>total study area</p>
</td></tr>
<tr><td><code id="downscaleSAR_+3A_ear">EAR</code></td>
<td>
<p>logical. TRUE computes the endemics area relatinship</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Downscaling is done non-iteratively (i.e. the SAD and SSAD are calculated based on state variables at the anchor scale A0) thus unlike the upscaling SAR function, downscaling can be computed for any arbitrary scale
<code class="reqn">\leq A_0</code>.
</p>


<h3>Value</h3>

<p>an object of class <code>sar</code> inheriting from <code>data.frame</code> with
columns <code>A</code> and <code>S</code> giving area and species richness, respectively
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteESF, meteSAR, empiricalSAR, upscaleSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.esf &lt;- meteESF(spp=anbo$spp, abund=anbo$count)
anbo.thr.downscale &lt;- downscaleSAR(anbo.esf, 2^(seq(-3, 4, length=7)), 16)
plot(anbo.thr.downscale)

## theoretical SARs from state variables only
thr.downscale &lt;- downscaleSAR(meteESF(S0=40, N0=400), 2^seq(-1,4,by=1), 16)
thr.downscaleEAR &lt;- downscaleSAR(meteESF(S0=40, N0=400), 2^seq(-1, 4, by=1), 16, EAR=TRUE)
plot(thr.downscale, ylim=c(0, 40), col='red')
plot(thr.downscaleEAR, add=TRUE, col='blue')
</code></pre>

<hr>
<h2 id='ebar'>Relationship between mean metabolic rate (<code class="reqn">\bar{\epsilon}</code>) and abundance</h2><span id='topic+ebar'></span>

<h3>Description</h3>

<p><code>ebar</code> calculates the relationship between average metabolic rate of a species and that species' abundance. Also known as the Damuth relationship
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ebar(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ebar_+3A_x">x</code></td>
<td>
<p>an object of class meteESF.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples.
</p>


<h3>Value</h3>

<p>An object of class <code>meteRelaT</code>. The object contains a list with the following elements.
</p>

<dl>
<dt><code>pred</code></dt><dd><p>predicted relationship</p>
</dd>
<dt><code>obs</code></dt><dd><p>observed relationship</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteDist, sad.meteESF, metePsi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
               abund=arth$count,
               power=arth$mass^(.75),
               minE=min(arth$mass^(.75)))
damuth &lt;- ebar(esf1)
</code></pre>

<hr>
<h2 id='empiricalSAR'>Empirical SAR or EAR</h2><span id='topic+empiricalSAR'></span>

<h3>Description</h3>

<p>computes observed SAR or EAR from raw data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>empiricalSAR(spp, abund, row, col, x, y, Amin, A0, EAR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="empiricalSAR_+3A_spp">spp</code></td>
<td>
<p>vector of species identities</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_abund">abund</code></td>
<td>
<p>numberic vector abundances associated with each record</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_row">row</code></td>
<td>
<p>identity of row in a gridded landscape associated with each record, or desired number of rows to divide the landcape into</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_col">col</code></td>
<td>
<p>identity of column in a gridded landscape associated with each recod, or desired number of columns to divide the landcape into</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_x">x</code></td>
<td>
<p>the x-coordinate of an individual if recorded</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_y">y</code></td>
<td>
<p>the y-coordinate of an individual if recorded</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_amin">Amin</code></td>
<td>
<p>the smallest area, either the anchor area for upscaling or the desired area to downscale to</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_a0">A0</code></td>
<td>
<p>the largest area, either the area to upscale to or the total area from which to downscale</p>
</td></tr>
<tr><td><code id="empiricalSAR_+3A_ear">EAR</code></td>
<td>
<p>logical, should the EAR or SAR be computed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently only doublings of area are supported. There are
several options for specifying areas. Either <code>row</code> and <code>col</code> or
<code>x</code> and <code>y</code> must be provided for each data entry (i.e. the
length of <code>row</code> and <code>col</code> or <code>x</code> and <code>y</code> must equal
the length of <code>spp</code> and <code>abund</code>). If <code>x</code> and <code>y</code>
are provided then the landscape is gridded either by specifying
<code>Amin</code> (the size of the smallest grid cell) or by providing the
number or desired rows and columns via the <code>row</code> and <code>col</code>
arguments. If only <code>row</code> and <code>col</code> are provided these are taken
to be the row and column identities of each data entry
</p>


<h3>Value</h3>

<p>an object of class <code>sar</code> inheriting from <code>data.frame</code> with
columns <code>A</code> and <code>S</code> giving area and species richness, respectively
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteESF, meteSAR, downscaleSAR, upscaleSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.obs.sar &lt;- empiricalSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
plot(anbo.obs.sar)
anbo.obs.ear &lt;- empiricalSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16, EAR=TRUE)
plot(anbo.obs.ear)

## empirical SAR from simulated x, y data
anbo$x &lt;- runif(nrow(anbo), 0, 1) + anbo$column
anbo$y &lt;- runif(nrow(anbo), 0, 1) + anbo$row
meteSAR(anbo$spp, anbo$count, x=anbo$x, y=anbo$y, row=4, col=4)
</code></pre>

<hr>
<h2 id='ipd'>Individual Power Distribution</h2><span id='topic+ipd'></span><span id='topic+ipd.meteESF'></span>

<h3>Description</h3>

<p><code>ipd.meteESF</code> calculates the distribution Psi(e | N0, S0, E0),
the distribution of metabolic rates across all individuals in a commmunity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipd(x, ...)

## S3 method for class 'meteESF'
ipd(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipd_+3A_x">x</code></td>
<td>
<p>an object of class meteESF.</p>
</td></tr>
<tr><td><code id="ipd_+3A_...">...</code></td>
<td>
<p>additiona arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples.
</p>


<h3>Value</h3>

<p>An object of class <code>meteDist</code>. The object contains a list with the following elements.
</p>

<dl>
<dt>data</dt><dd><p>The data used to construct the prediction</p>
</dd>
<dt>d</dt><dd><p>density funciton</p>
</dd>
<dt>p</dt><dd><p>cumulative density function</p>
</dd>
<dt>q</dt><dd><p>quantile funtion</p>
</dd>
<dt>r</dt><dd><p>random number generator</p>
</dd>
<dt>La</dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt>state.var</dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
<dt>type</dt><dd><p>Specifies the type of distribution is 'sad'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteDist, sad.meteESF, metePsi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
               abund=arth$count,
               power=arth$mass^(.75),
               minE=min(arth$mass^(.75)))
ipd1 &lt;- ipd(esf1)
</code></pre>

<hr>
<h2 id='logLik.meteDist'>Compute log-likelihood of a meteDist object</h2><span id='topic+logLik.meteDist'></span>

<h3>Description</h3>

<p><code>logLik.meteDist</code> computes log-likelihood of a meteDist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteDist'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.meteDist_+3A_object">object</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="logLik.meteDist_+3A_...">...</code></td>
<td>
<p>arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Degrees of freedom are assumed to be equal to the number of Lagrange
multpliers needed to specify the METE prediction. See Examples for usage.
</p>


<h3>Value</h3>

<p>object of class <code>logLik</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology:
a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>sad, ssad, ipd, sipd
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
## object holding ecosystem structure function
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
## calculate individual power distribution and its likelihood
ipd1 &lt;- ipd(esf1)
logLik(ipd1)
</code></pre>

<hr>
<h2 id='logLikZ'>Compute log-likelihood z-score</h2><span id='topic+logLikZ'></span><span id='topic+logLikZ.meteDist'></span>

<h3>Description</h3>

<p><code>logLikZ.meteDist</code> computes a log-likelihood z-score by simulation from a
fitted METE distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLikZ(x, ...)

## S3 method for class 'meteDist'
logLikZ(x, nrep = 999, return.sim = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLikZ_+3A_x">x</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="logLikZ_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="logLikZ_+3A_nrep">nrep</code></td>
<td>
<p>number of simulations from the fitted METE distribution</p>
</td></tr>
<tr><td><code id="logLikZ_+3A_return.sim">return.sim</code></td>
<td>
<p>logical; return the simulated liklihood values</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>logLikZ.meteDist</code> simulates from a fitted METE distribution (e.g. a species
abundance distribution or individual power distribution) and calculates the
likelihood of these simulated data sets. The distribution of these values is compared
against the likelihood of the data to obtain a z-score, specifically
z = ((logLik_obs - mean(logLik_sim)) / sd(logLik_sim))^2.
This value is squared so that it will be approximately Chi-squared distributed and a
goodness of fit test naturally arrises as <code>1 - pchisq(z, df=1)</code>.
</p>


<h3>Value</h3>

<p>list with elements
</p>

<dl>
<dt>z</dt><dd><p>The z-score</p>
</dd>
<dt>sim</dt><dd><p><code>nrep</code> Simulated values (scaled by mean and sd as is the z-score) if return.sim=TRUE, NULL otherwise</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>mseZ.meteDist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
## object holding ecosystem structure function
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
## calculate individual power distribution
ipd1 &lt;- ipd(esf1)
## calculate z-score, keeping all simulated log likelihoods for plotting
llz &lt;- logLikZ(ipd1, nrep=100, return.sim=TRUE)

plot(density(llz$sim),xlim=range(c(llz$sim,llz$obs)),
     xlab='scaled log(likelihood)^2',col='red')
abline(v=llz$z,lty=2)
legend('top',legend=c('data','simulated'),col=c('black','red'),
      lty=c(1,1),bty='n')
</code></pre>

<hr>
<h2 id='meteDist2Rank'>meteDist2Rank</h2><span id='topic+meteDist2Rank'></span>

<h3>Description</h3>

<p><code>meteESF</code> calculate the rank distribution of a meteDist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteDist2Rank(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteDist2Rank_+3A_x">x</code></td>
<td>
<p><code>meteDist</code> object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts the predicted rank distribution from a <code>meteDist</code> object.
This is effectively the quantile function of the distribution. Used, e.g.,
in <code>plot.meteDist</code>
</p>


<h3>Value</h3>

<p>A vector of predicted quantiles, typically used to compare against data as in <code>plot.meteDist</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
sad1 &lt;- sad(esf1)
meteDist2Rank(sad1)
</code></pre>

<hr>
<h2 id='meteESF'>meteESF</h2><span id='topic+meteESF'></span>

<h3>Description</h3>

<p><code>meteESF</code> Calculates the &ldquo;ecosystem structure
function&rdquo; <code class="reqn">R(n,\epsilon)</code> which forms the core of the Maximum Entropy Theory of
Ecology
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteESF(spp, abund, power, S0 = NULL, N0 = NULL, E0 = NULL, minE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteESF_+3A_spp">spp</code></td>
<td>
<p>A vector of species names</p>
</td></tr>
<tr><td><code id="meteESF_+3A_abund">abund</code></td>
<td>
<p>A vector of abundances</p>
</td></tr>
<tr><td><code id="meteESF_+3A_power">power</code></td>
<td>
<p>A vector of metabolic rates</p>
</td></tr>
<tr><td><code id="meteESF_+3A_s0">S0</code></td>
<td>
<p>Total number of species</p>
</td></tr>
<tr><td><code id="meteESF_+3A_n0">N0</code></td>
<td>
<p>Total number of individuals</p>
</td></tr>
<tr><td><code id="meteESF_+3A_e0">E0</code></td>
<td>
<p>Total metabolic rate; defaults to N0*1e6 if not specified or
calculated from <code>power</code> to allow one to fit models that
do not depend on metabolic rates</p>
</td></tr>
<tr><td><code id="meteESF_+3A_mine">minE</code></td>
<td>
<p>Minimum possible metabolic rate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses either data or state variables to calculate the Ecosystem Structure
Function (ESF). <code>power</code> nor <code>E0</code> need not be specified; if missing an arbitrarily
large value is assigned to E0 (N0*1e5) such that it will minimally affect
estimation of Lagrange multipliers. Consider using sensitivity analysis to
confirm this assumption. Examples show different ways of combining data and state
variables to specify constraints
</p>


<h3>Value</h3>

<p>An object of class <code>meteESF</code> with elements
</p>

<dl>
<dt><code>data</code></dt><dd><p>The data used to construct the ESF</p>
</dd>
<dt><code>emin</code></dt><dd><p>The minimum metabolic rate used to rescale metabolic rates</p>
</dd>
<dt><code>La</code></dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt><code>La.info</code></dt><dd><p>Termination information from optimization procedure</p>
</dd>
<dt><code>state.var</code></dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
<dt><code>Z</code></dt><dd><p>Normalization constant for ESF</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>metePi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## case where complete data availible
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
esf1

## excluding metabolic rate data
esf2 &lt;- meteESF(spp=arth$spp,
                abund=arth$count)
esf2

## using state variables only
esf3 &lt;- meteESF(S0=50, N0=500, E0=5000)
esf3
esf4 &lt;- meteESF(S0=50, N0=500)
esf4
</code></pre>

<hr>
<h2 id='meteNu'>Equation of the PMF for the METE species metabolic rate distribution</h2><span id='topic+meteNu'></span>

<h3>Description</h3>

<p><code>meteNu</code> is a low level function to calculate the value of
<code class="reqn">\nu(e | N_0, S_0, E_0)</code> (the distribution of metabolic rates/power across all species in a commmunity) at the given value of <code>e</code>; vectorized in <code>e</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteNu(e, la1, la2, Z, S0, N0, E0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteNu_+3A_e">e</code></td>
<td>
<p>the value (metabolic rate/power) at which to calculate <code class="reqn">\Psi</code></p>
</td></tr>
<tr><td><code id="meteNu_+3A_la1">la1</code>, <code id="meteNu_+3A_la2">la2</code></td>
<td>
<p>Lagrange multipliers</p>
</td></tr>
<tr><td><code id="meteNu_+3A_z">Z</code></td>
<td>
<p>partition function</p>
</td></tr>
<tr><td><code id="meteNu_+3A_s0">S0</code></td>
<td>
<p>Total number of species</p>
</td></tr>
<tr><td><code id="meteNu_+3A_n0">N0</code></td>
<td>
<p>Total number of individuals</p>
</td></tr>
<tr><td><code id="meteNu_+3A_e0">E0</code></td>
<td>
<p>Total metabolic rate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typically only used in <code>spd.meteESF</code> and not called by the user.
</p>


<h3>Value</h3>

<p>numeric vector of length equal to length of <code>e</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>spd.mete</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
meteNu(1:10,
       esf1$La[1],esf1$La[2],
       esf1$Z,esf1$state.var['S0'],
       esf1$state.var['N0'],
       esf1$state.var['E0'])
</code></pre>

<hr>
<h2 id='metePhi'>Equation of the METE species abundance distribution</h2><span id='topic+metePhi'></span>

<h3>Description</h3>

<p><code>metePhi</code> returns the species abundance distribution
(Phi(n)) predicted by METE; vectorized in n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metePhi(n, la1, la2, Z, S0, N0, E0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metePhi_+3A_n">n</code></td>
<td>
<p>the value (number of individuals) at which to calculate </p>
<p style="text-align: center;"><code class="reqn">\Phi</code>
</p>
</td></tr>
<tr><td><code id="metePhi_+3A_la1">la1</code>, <code id="metePhi_+3A_la2">la2</code></td>
<td>
<p>Lagrange multipliers</p>
</td></tr>
<tr><td><code id="metePhi_+3A_z">Z</code></td>
<td>
<p>partition function</p>
</td></tr>
<tr><td><code id="metePhi_+3A_s0">S0</code></td>
<td>
<p>Total number of species</p>
</td></tr>
<tr><td><code id="metePhi_+3A_n0">N0</code></td>
<td>
<p>Total number of individuals</p>
</td></tr>
<tr><td><code id="metePhi_+3A_e0">E0</code></td>
<td>
<p>Total metabolic rate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples
</p>


<h3>Value</h3>

<p>numeric
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>sad.mete</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>esf1=meteESF(spp=arth$spp,
              abund=arth$count,
              power=arth$mass^(.75),
              minE=min(arth$mass^(.75)))
metePhi(min(arth$mass^(.75)),
       esf1$La[1],esf1$La[2],
       esf1$Z,esf1$state.var['S0'],
       esf1$state.var['N0'],
       esf1$state.var['E0'])
</code></pre>

<hr>
<h2 id='metePi'>Equation of the PMF of the METE spatial species abundance distribution</h2><span id='topic+metePi'></span>

<h3>Description</h3>

<p><code>metePi</code> is a low level function that returns the spatial species abundance
distribution <code class="reqn">Pi(n)</code> predicted by METE; vectorized in n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metePi(n, la, n0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metePi_+3A_n">n</code></td>
<td>
<p>A vector giving abundances of each entry</p>
</td></tr>
<tr><td><code id="metePi_+3A_la">la</code></td>
<td>
<p>The spatial Lagrange multiplier returned by <code>meteSSF</code></p>
</td></tr>
<tr><td><code id="metePi_+3A_n0">n0</code></td>
<td>
<p>Total abundance in area A0</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples
</p>


<h3>Value</h3>

<p>a numeric vector giving the probability of each entry in <code>n</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>metePi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>metePi(0:10, 0.01, 100)
</code></pre>

<hr>
<h2 id='metePsi'>Equation of the PMF for the METE individual metabolic rate distribution</h2><span id='topic+metePsi'></span>

<h3>Description</h3>

<p><code>metePsi</code> is a low level function to calculate the value of
<code class="reqn">\Psi(e | N_0, S_0, E_0)</code> (the distribution of metabolic rates/power across all individuals in a commmunity) at the given value of <code>e</code>; vectorized in <code>e</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metePsi(e, la1, la2, Z, S0, N0, E0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metePsi_+3A_e">e</code></td>
<td>
<p>the value (metabolic rate/power) at which to calculate <code class="reqn">\Psi</code></p>
</td></tr>
<tr><td><code id="metePsi_+3A_la1">la1</code>, <code id="metePsi_+3A_la2">la2</code></td>
<td>
<p>Lagrange multipliers</p>
</td></tr>
<tr><td><code id="metePsi_+3A_z">Z</code></td>
<td>
<p>partition function</p>
</td></tr>
<tr><td><code id="metePsi_+3A_s0">S0</code></td>
<td>
<p>Total number of species</p>
</td></tr>
<tr><td><code id="metePsi_+3A_n0">N0</code></td>
<td>
<p>Total number of individuals</p>
</td></tr>
<tr><td><code id="metePsi_+3A_e0">E0</code></td>
<td>
<p>Total metabolic rate</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Typically only used in <code>ipd.meteESF</code> and not called by the user.
</p>


<h3>Value</h3>

<p>numeric vector of length equal to length of <code>e</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>ipd.mete</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
metePsi(1:10,
        esf1$La[1],esf1$La[2],
        esf1$Z,esf1$state.var['S0'],
        esf1$state.var['N0'],
        esf1$state.var['E0'])
</code></pre>

<hr>
<h2 id='meteR-package'>
Analyses with the Maximum Entropy Theory of Ecology (METE)
</h2><span id='topic+meteR-package'></span><span id='topic+meteR'></span>

<h3>Description</h3>

<p>Fits and plots macroecological patterns predicted by the Maximum Entropy Theory of Ecology (METE)
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> meteR</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2014-01-04</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>





<h3>Author(s)</h3>

<p>Andy Rominger, Cory Merow, John Harte
</p>
<p>Maintainer: Cory Merow <a href="mailto:cory.merow@gmail.com">cory.merow@gmail.com</a>
</p>


<h3>References</h3>

<p>Harte, J., Zillio, T., Conlisk, E. &amp; Smith, A. (2008). Maximum entropy and the state-variable approach to macroecology. Ecology, 89, 2700-2711.
</p>
<p>Harte, J. (2008). From Spatial Pattern in the Distribution and Abundance of Species to a Unified Theory of Ecology: The Role of Maximum Entropy Methods. Applied Optimization pp. 243-272. Applied Optimization. Springer Berlin Heidelberg, Berlin, Heidelberg.
</p>
<p>Harte, J., Smith, A.B. &amp; Storch, D. (2009). Biodiversity scales from plots to biomes with a universal species-area curve. Ecology Letters, 12, 789-797.
</p>
<p>Harte, J. (2011). Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press, Oxford, UK.
</p>

<hr>
<h2 id='meteSAR'>Compute METE species area relationship (SAR)</h2><span id='topic+meteSAR'></span>

<h3>Description</h3>

<p>Uses raw data or state variables to calculate METE SAR
and EAR (endemics area relatiohsip) as well as compute the observed
SAR or EAR from data, if provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteSAR(spp, abund, row, col, x, y, S0 = NULL, N0 = NULL, Amin, A0,
  upscale = FALSE, EAR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteSAR_+3A_spp">spp</code></td>
<td>
<p>vector of species identities</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_abund">abund</code></td>
<td>
<p>numberic vector abundances associated with each record</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_row">row</code></td>
<td>
<p>identity of row in a gridded landscape associated with each record, or desired number of rows to divide the landcape into</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_col">col</code></td>
<td>
<p>identity of column in a gridded landscape associated with each recod, or desired number of columns to divide the landcape into</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_x">x</code></td>
<td>
<p>the x-coordinate of an individual if recorded</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_y">y</code></td>
<td>
<p>the y-coordinate of an individual if recorded</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_s0">S0</code></td>
<td>
<p>total number of species</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_n0">N0</code></td>
<td>
<p>total abundance</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_amin">Amin</code></td>
<td>
<p>the smallest area, either the anchor area for upscaling or the desired area to downscale to</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_a0">A0</code></td>
<td>
<p>the largest area, either the area to upscale to or the total area from which to downscale</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_upscale">upscale</code></td>
<td>
<p>logical, should upscaling or downscaling be carried out</p>
</td></tr>
<tr><td><code id="meteSAR_+3A_ear">EAR</code></td>
<td>
<p>logical, should the EAR or SAR be computed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently only doublings of area are supported. Predictions
and comparison to data can be made via several options. If <code>spp</code>
and <code>abund</code> are not provided then only theoretical predictions
are returned without emperical SAR or EAR results. In this case areas
can either be specified by providing <code>Amin</code> and <code>A0</code> from
which a vector of doubling areas is computed, or my providing <code>row</code>,
<code>col</code> and <code>A0</code> in which case <code>row</code> and <code>col</code> are
taken to be the number of desired rows and columns used to construct
a grid across the landscape. If data are provided in the form of
<code>spp</code> and <code>abund</code> then either <code>row</code> and <code>col</code> or
<code>x</code> and <code>y</code> must be provided for each data entry (i.e. the
length of <code>row</code> and <code>col</code> or <code>x</code> and <code>y</code> must equal
the length of <code>spp</code> and <code>abund</code>). If <code>x</code> and <code>y</code>
are provided then the landscape is gridded either by specifying
<code>Amin</code> (the size of the smallest grid cell) or by providing the
number or desired rows and columns via the <code>row</code> and <code>col</code>
arguments.
</p>
<p>SARs and EARs can be predicted either interatively or non-iteratively.
In the non-iterative case the SAD and SSAD (which are used to calculate
the SAR or EAR prediction) are derived from state variables at one
anchor scale. In the iterative approach state variables are re-calculated
at each scale. Currently downscaling and upscaling are done differently (
downscaling is only implemented in the non-iterative approach, whereas
upscaling is only implemented in the iterative approach). The reason is
largely historical (downscaling as originally done non-iteratively while
upscaling was first proposed in an iterative framework). Future implementations
in <code>meteR</code> will allow for both iterative and non-iterative approaches
to upscaling and downscaling.  While iterative and non-iterative methods lead to
slightly different predictions these are small in comparison to typical ranges of
state variables (see Harte 2011).
</p>


<h3>Value</h3>

<p>an object of class <code>meteRelat</code> with elements
</p>

<dl>
<dt><code>pred</code></dt><dd><p>predicted relationship; an object of class <code>sar</code></p>
</dd>
<dt><code>obs</code></dt><dd><p>observed relationship; an object of class<code>sar</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>sad, meteESF, metePi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(anbo)

## using row and col from anbo dataset
anbo.sar1 &lt;- meteSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
plot(anbo.sar1)

## using simulated x, y data
anbo.sar2 &lt;- meteSAR(anbo$spp, anbo$count, x=anbo$x, y=anbo$y, row=4, col=4)
plot(anbo.sar2)

## using just state variable
thr.sar &lt;- meteSAR(Amin=1, A0=16, S0=50, N0=500)

## End(Not run)
</code></pre>

<hr>
<h2 id='meteSSF'>meteSSF</h2><span id='topic+meteSSF'></span>

<h3>Description</h3>

<p><code>meteSSF</code> calculates the &ldquo;spatial structure
function&rdquo; <code class="reqn">\Pi(n)</code> (analogous to the ecosystem structure function). From
the SSF the spatial abundance distribution can be calculated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteSSF(spp, sppID, abund, row, col, x, y, n0 = sum(abund), A, A0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteSSF_+3A_spp">spp</code></td>
<td>
<p>A vector of species names</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_sppid">sppID</code></td>
<td>
<p>A character giving the name of the desired species (as it appears in &lsquo;spp&rsquo;)</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_abund">abund</code></td>
<td>
<p>A vector of abundances</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_row">row</code></td>
<td>
<p>A vector of row IDs for each observation</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_col">col</code></td>
<td>
<p>A vector of column IDs for each observation</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_x">x</code></td>
<td>
<p>A vector of x coordinates for each observation</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_y">y</code></td>
<td>
<p>A vector of y coordinates for each observation</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_n0">n0</code></td>
<td>
<p>Total abundance in area A0</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_a">A</code></td>
<td>
<p>The area at which abundances were recorded</p>
</td></tr>
<tr><td><code id="meteSSF_+3A_a0">A0</code></td>
<td>
<p>Total study area</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses either data or state variables to calculate the Spatial Structure
Function (SSF). Uses internal code to determine when computation-saving approximations
can be safely made
</p>


<h3>Value</h3>

<p>An object of class <code>meteSSF</code> with elements
</p>

<dl>
<dt><code>data</code></dt><dd><p>The data used to construct the SSF</p>
</dd>
<dt><code>La</code></dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt><code>La.info</code></dt><dd><p>Termination information from optimization procedure</p>
</dd>
<dt><code>state.var</code></dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>metePi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
## calculate SSF Pi
pi1 &lt;- meteSSF(anbo$spp, 'crcr', anbo$count, row=anbo$row, col=anbo$column, A=1, A0=16)
pi1
</code></pre>

<hr>
<h2 id='meteTheta'>Equation of the PMF for the METE Intra-specific metabolic rate distribution</h2><span id='topic+meteTheta'></span>

<h3>Description</h3>

<p>Distribution of metabolic rates over individuals within a species of abundance n0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meteTheta(e, n, la2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meteTheta_+3A_e">e</code></td>
<td>
<p>Metabolic rate</p>
</td></tr>
<tr><td><code id="meteTheta_+3A_n">n</code></td>
<td>
<p>Number of individuals in species</p>
</td></tr>
<tr><td><code id="meteTheta_+3A_la2">la2</code></td>
<td>
<p>Lagrange multiplier (lambda_2) as obtained from <code>meteESF</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector of length equal to lengthof <code>e</code>
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>metePsi, ipd
</p>
<p>Other Theta: <code><a href="#topic+sipd">sipd</a></code>, <code><a href="#topic+sipd.meteESF">sipd.meteESF</a></code>
</p>

<hr>
<h2 id='mse'>Computes mean squared error for rank or cdf</h2><span id='topic+mse'></span><span id='topic+mse.meteDist'></span>

<h3>Description</h3>

<p><code>mse.meteDist</code> computes mean squared error for rank or cdf between METE prediction and data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mse(x, ...)

## S3 method for class 'meteDist'
mse(x, type = c("rank", "cumulative"), relative = TRUE,
  log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mse_+3A_x">x</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="mse_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="mse_+3A_type">type</code></td>
<td>
<p>'rank' or 'cumulative'</p>
</td></tr>
<tr><td><code id="mse_+3A_relative">relative</code></td>
<td>
<p>logical; if true use relative MSE</p>
</td></tr>
<tr><td><code id="mse_+3A_log">log</code></td>
<td>
<p>logical; if TRUE calculate MSE on logged distirbution. If FALSE use arithmetic scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples.
</p>


<h3>Value</h3>

<p>numeric; the value of the mean squared error.
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>mseZ.meteDist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
sad1 &lt;- sad(esf1)
mse(sad1, type='rank', relative=FALSE)
ebar1 &lt;- ebar(esf1)
mse(ebar1)
</code></pre>

<hr>
<h2 id='mseZ'>Compute z-score of mean squared error</h2><span id='topic+mseZ'></span><span id='topic+mseZ.meteDist'></span>

<h3>Description</h3>

<p><code>mseZ.meteDist</code> Compute z-score of mean squared error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mseZ(x, ...)

## S3 method for class 'meteDist'
mseZ(x, nrep, return.sim = TRUE, type = c("rank",
  "cumulative"), relative = TRUE, log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mseZ_+3A_x">x</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="mseZ_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="mseZ_+3A_nrep">nrep</code></td>
<td>
<p>number of simulations from the fitted METE distribution</p>
</td></tr>
<tr><td><code id="mseZ_+3A_return.sim">return.sim</code></td>
<td>
<p>logical; return the simulated liklihood values</p>
</td></tr>
<tr><td><code id="mseZ_+3A_type">type</code></td>
<td>
<p>either &quot;rank&quot; or &quot;cumulative&quot;</p>
</td></tr>
<tr><td><code id="mseZ_+3A_relative">relative</code></td>
<td>
<p>logical; if true use relative MSE</p>
</td></tr>
<tr><td><code id="mseZ_+3A_log">log</code></td>
<td>
<p>logical; if TRUE calculate MSE on logged distirbution. If FALSE use arithmetic scale</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mseZ.meteDist</code> simulates from a fitted METE distribution (e.g. a species abundance distribution or individual power distribution) and calculates the MSE between the simulated data sets and the METE prediction. The distribution of these values is compared against the MSE of the data to obtain a z-score in the same was as <code>logLikZ</code>; see that help document for more details.
</p>


<h3>Value</h3>

<p>list with elements
</p>

<dl>
<dt>z</dt><dd><p>The z-score</p>
</dd>
<dt>sim</dt><dd><p><code>nrep</code> Simulated values</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>logLikZ
</p>


<h3>Examples</h3>

<pre><code class='language-R'>esf1=meteESF(spp=arth$spp,
              abund=arth$count,
              power=arth$mass^(4/3),
              minE=min(arth$mass^(4/3)))
sad1=sad(esf1)
mseZ(sad1, nrep=100, type='rank',return.sim=TRUE)
</code></pre>

<hr>
<h2 id='plot.damuth'>Plot the relationship between abundance and metabolic rate, i.e. objects of class damuth</h2><span id='topic+plot.damuth'></span>

<h3>Description</h3>

<p>Plot abundance-metabolic rate relationship with flexibility to adjust plotting parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'damuth'
plot(x, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.damuth_+3A_x">x</code></td>
<td>
<p>an object of class damuth</p>
</td></tr>
<tr><td><code id="plot.damuth_+3A_add">add</code></td>
<td>
<p>logical; should new <code>damuth</code> object be added to current plot or made its own plot</p>
</td></tr>
<tr><td><code id="plot.damuth_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>see examples
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>empiricalSAR, downscaleSAR, upscaleSAR, meteSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(arth$spp, arth$count, arth$mass^0.75)
ebar1 &lt;- ebar(esf1)
plot(ebar1)
</code></pre>

<hr>
<h2 id='plot.meteDist'>Plot METE distributions and associated data</h2><span id='topic+plot.meteDist'></span>

<h3>Description</h3>

<p><code>plot.meteDist</code> plots both the theoretical prediction and data for a
<code>meteDist</code> object using either a rank or cumulative distribution plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteDist'
plot(x, ptype = c("cdf", "rad"), th.col = "red",
  lower.tail = TRUE, add.legend = TRUE, add.line = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.meteDist_+3A_x">x</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_ptype">ptype</code></td>
<td>
<p>type of plot; either &quot;cdf&quot; or &quot;rad&quot;</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_th.col">th.col</code></td>
<td>
<p>line color of theoretical prediction</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; choose TRUE to highlight differences between data and theory at low abundance; choose FALSE to highlight differences at high abundance.</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_add.legend">add.legend</code></td>
<td>
<p>logical; add a legend</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_add.line">add.line</code></td>
<td>
<p>add the curve for a fitted model to the existing plot</p>
</td></tr>
<tr><td><code id="plot.meteDist_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.meteDist</code> automatically extracts the prediction and data (if used
in <code>meteESF</code>) from the <code>meteDist</code> object. Additional plotting
arguments can be passed to <code>...</code>.
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>sad, ipd, ssad, sipd, print.meteDist
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
               abund=arth$count,
               power=arth$mass^(.75),
               minE=min(arth$mass^(.75)))
ipd1 &lt;- ipd(esf1)
plot(ipd1)
plot(ipd1, ptype='rad')
</code></pre>

<hr>
<h2 id='plot.meteRelat'>Plot predicted METE relationships and associated observed relationship seen in data</h2><span id='topic+plot.meteRelat'></span>

<h3>Description</h3>

<p><code>plot.meteRelat</code> plots both the theoretical prediction and data for a
<code>meteRelat</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteRelat'
plot(x, add.legend = TRUE, th.col = "red", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.meteRelat_+3A_x">x</code></td>
<td>
<p>a <code>meteRelat</code> object</p>
</td></tr>
<tr><td><code id="plot.meteRelat_+3A_add.legend">add.legend</code></td>
<td>
<p>logical; add a legend</p>
</td></tr>
<tr><td><code id="plot.meteRelat_+3A_th.col">th.col</code></td>
<td>
<p>line color of theoretical prediction</p>
</td></tr>
<tr><td><code id="plot.meteRelat_+3A_...">...</code></td>
<td>
<p>arguments to be passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.meteRelat</code> automatically extracts the prediction and data (if used
in <code>meteESF</code>) from the <code>meteDist</code> object. Additional plotting
arguments can be passed to <code>...</code>.
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.sar &lt;- meteSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
plot(anbo.sar)
</code></pre>

<hr>
<h2 id='plot.sar'>Plot the species abundance distribution (SAR), i.e. objects of class sar</h2><span id='topic+plot.sar'></span>

<h3>Description</h3>

<p>Plot species or endemics area relationship with flexibility to adjust plotting parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sar'
plot(x, add = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.sar_+3A_x">x</code></td>
<td>
<p>an object of class SAR made with</p>
</td></tr>
<tr><td><code id="plot.sar_+3A_add">add</code></td>
<td>
<p>logical; should new <code>sar</code> object be added to current plot or made its own plot</p>
</td></tr>
<tr><td><code id="plot.sar_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>see examples
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>empiricalSAR, downscaleSAR, upscaleSAR, meteSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.obs.sar &lt;- empiricalSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
plot(anbo.obs.sar)
</code></pre>

<hr>
<h2 id='predictESF'>predictESF</h2><span id='topic+predictESF'></span>

<h3>Description</h3>

<p><code>predict</code> predicts the probabilities for given combinations of abundance and energ from the  &ldquo;ecosystem structure
function&rdquo; <code class="reqn">R(n,\epsilon)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictESF(esf, abund, power)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictESF_+3A_esf">esf</code></td>
<td>
<p>A fitted object of class <code>meteESF</code></p>
</td></tr>
<tr><td><code id="predictESF_+3A_abund">abund</code></td>
<td>
<p>A vector of abundances</p>
</td></tr>
<tr><td><code id="predictESF_+3A_power">power</code></td>
<td>
<p>A vector of metabolic rates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses a fitted object of class <code>meteESF</code> and user supplied values of abundance and power to predict values of the ESF
</p>


<h3>Value</h3>

<p>a data.frame with abundance, power, and the predicted value of the ESF
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteESF
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## case where complete data availible
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
predictESF(esf1,
           abund=c(10,3),
           power=c(.01,3))
</code></pre>

<hr>
<h2 id='print.damuth'>print.damuth</h2><span id='topic+print.damuth'></span>

<h3>Description</h3>

<p>S3 method for class <code>damuth</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'damuth'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.damuth_+3A_x">x</code></td>
<td>
<p>an object of class <code>damuth</code></p>
</td></tr>
<tr><td><code id="print.damuth_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples
</p>


<h3>Value</h3>

<p>Returns the object silently
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(arth$spp, arth$count, arth$mass^0.75)
ebar1 &lt;- ebar(esf1)
print(ebar1)
</code></pre>

<hr>
<h2 id='print.meteDist'>Print summaries of <code>meteDist</code> objects</h2><span id='topic+print.meteDist'></span>

<h3>Description</h3>

<p>S3 method for class <code>meteDist</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteDist'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.meteDist_+3A_x">x</code></td>
<td>
<p>a <code>meteDist</code> object (e.g. from <code>ipd.mete</code> or <code>sad.mete</code>)</p>
</td></tr>
<tr><td><code id="print.meteDist_+3A_...">...</code></td>
<td>
<p>arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Prints state variables and lagrange multipliers
</p>


<h3>Value</h3>

<p>The <code>meteDist</code> object is returned invisibly
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
ipd1 &lt;- ipd(esf1)
ipd1
</code></pre>

<hr>
<h2 id='print.meteESF'>print.meteESF</h2><span id='topic+print.meteESF'></span>

<h3>Description</h3>

<p><code>print.meteESF</code> prints an object of class <code>meteESF</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteESF'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.meteESF_+3A_x">x</code></td>
<td>
<p>an object of class <code>meteESF</code></p>
</td></tr>
<tr><td><code id="print.meteESF_+3A_...">...</code></td>
<td>
<p>arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples
</p>


<h3>Value</h3>

<p><code>x</code> silently
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
print(esf1)
esf1 # alternatively...
</code></pre>

<hr>
<h2 id='print.meteRelat'>Print summaries of <code>meteRelat</code> objects</h2><span id='topic+print.meteRelat'></span>

<h3>Description</h3>

<p>S3 method for class <code>meteRelat</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteRelat'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.meteRelat_+3A_x">x</code></td>
<td>
<p>an object of class meteRelat</p>
</td></tr>
<tr><td><code id="print.meteRelat_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x silently
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>

<hr>
<h2 id='print.sar'>print.sar</h2><span id='topic+print.sar'></span>

<h3>Description</h3>

<p>S3 method for class <code>sar</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sar'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.sar_+3A_x">x</code></td>
<td>
<p>an object of class <code>sar</code></p>
</td></tr>
<tr><td><code id="print.sar_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples
</p>


<h3>Value</h3>

<p>Returns the object silently
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.sar &lt;- meteSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
print(anbo.sar)
anbo.sar # alternatively
</code></pre>

<hr>
<h2 id='residuals.meteDist'>Compute residuals between METE predictions and data of a meteDist object</h2><span id='topic+residuals.meteDist'></span>

<h3>Description</h3>

<p><code>residuals.meteDist</code> computes residuals between METE predictions and
data of a meteDist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteDist'
residuals(object, type = c("rank", "cumulative"),
  relative = TRUE, log = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.meteDist_+3A_object">object</code></td>
<td>
<p>a <code>meteDist</code> object</p>
</td></tr>
<tr><td><code id="residuals.meteDist_+3A_type">type</code></td>
<td>
<p>'rank' or 'cumulative'</p>
</td></tr>
<tr><td><code id="residuals.meteDist_+3A_relative">relative</code></td>
<td>
<p>logical; if true use relative MSE</p>
</td></tr>
<tr><td><code id="residuals.meteDist_+3A_log">log</code></td>
<td>
<p>logical; if TRUE calculate MSE on logged distirbution. If FALSE use arithmetic scale.</p>
</td></tr>
<tr><td><code id="residuals.meteDist_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples. Typically not called directly by the user and rather used for
calculating the mean square error with <code>mse.meteDist</code>. If <code>type='rank'</code>
returned value will be of length equal to number of observations (e.g. number of
species in case of SAD) but if <code>type='cumulative'</code> returned value will be of
length equal to number of unique ovservations (e.g. number of unique abundances in
case of SAR).
</p>


<h3>Value</h3>

<p>a numeic vector giving residuals for each data point
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>mse.meteDist</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
sad1 &lt;- sad(esf1)
residuals(sad1)
</code></pre>

<hr>
<h2 id='residuals.meteRelat'>Compute residuals between METE predictions and date of a meteRelat object</h2><span id='topic+residuals.meteRelat'></span>

<h3>Description</h3>

<p><code>residuals.meteRelat</code> computes residuals between METE predictions and
data of a meteDist object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'meteRelat'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.meteRelat_+3A_object">object</code></td>
<td>
<p>a <code>meteRelat</code> object</p>
</td></tr>
<tr><td><code id="residuals.meteRelat_+3A_...">...</code></td>
<td>
<p>arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples. Typically not called directly by the user and rather used for
calculating the mean square error with <code>mse.meteRelat</code>.
</p>


<h3>Value</h3>

<p>a numeic vector giving residuals for each data point
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p><code>mse.meteDist</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
ebar1 &lt;- ebar(esf1)
residuals(ebar1)
</code></pre>

<hr>
<h2 id='sad'>METE species abundance distribution</h2><span id='topic+sad'></span><span id='topic+sad.meteESF'></span>

<h3>Description</h3>

<p><code>sad.mete</code> returns the species abundance distribution
predicted by METE (<code class="reqn">\Phi(n)</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sad(x)

## S3 method for class 'meteESF'
sad(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sad_+3A_x">x</code></td>
<td>
<p>an object of class mete.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Examples.
</p>


<h3>Value</h3>

<p>An object of class <code>meteDist</code>. The object contains a list with the following elements.
</p>

<dl>
<dt>data</dt><dd><p>The data used to construct the prediction</p>
</dd>
<dt>d</dt><dd><p>density funciton</p>
</dd>
<dt>p</dt><dd><p>cumulative density function</p>
</dd>
<dt>q</dt><dd><p>quantile funtion</p>
</dd>
<dt>r</dt><dd><p>random number generator</p>
</dd>
<dt>La</dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt>state.var</dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
<dt>type</dt><dd><p>Specifies the type of distribution is 'sad'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>metePhi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
sad1 &lt;- sad(esf1)
sad1
sad1$r(20)
sad1$q(seq(0,1,length=10))
</code></pre>

<hr>
<h2 id='sipd'>Generic method to obtain the species-level individual power distribution (SIPD)</h2><span id='topic+sipd'></span><span id='topic+sipd.meteESF'></span>

<h3>Description</h3>

<p>Extract species level individual power distribution
from ESF object and return object inheriting from meteDist. This distribution (Theta) describes the distribution of metabolic rates across the individuals of a species with n individuls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sipd(x, ...)

## S3 method for class 'meteESF'
sipd(x, sppID, n, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sipd_+3A_x">x</code></td>
<td>
<p>An object of class meteESF (i.e. the fitted distribution <code class="reqn">R(n,e)</code>)</p>
</td></tr>
<tr><td><code id="sipd_+3A_...">...</code></td>
<td>
<p>arguments to be passed to methods</p>
</td></tr>
<tr><td><code id="sipd_+3A_sppid">sppID</code></td>
<td>
<p>the name or index of the species of interest as listed in the <code>spp</code> argument passed to <code>meteESF</code></p>
</td></tr>
<tr><td><code id="sipd_+3A_n">n</code></td>
<td>
<p>integer. Alternatively can extract METE prediction by indicating number of individuals in the species</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>n</code> is provided then only the theoretical prediction is returned (because
data from multiple species could map to the same n). Thus if data and prediction are
desired use <code>sppID</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>meteDist</code>. The object contains a list with the following elements.
</p>

<dl>
<dt>data</dt><dd><p>The data used to construct the prediction</p>
</dd>
<dt>d</dt><dd><p>density funciton</p>
</dd>
<dt>p</dt><dd><p>cumulative density function</p>
</dd>
<dt>q</dt><dd><p>quantile funtion</p>
</dd>
<dt>r</dt><dd><p>random number generator</p>
</dd>
<dt>La</dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt>state.var</dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
<dt>type</dt><dd><p>Specifies the type of distribution is 'sad'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>sad.meteESF, ipd.meteESF, metePsi
</p>
<p>Other Theta: <code><a href="#topic+meteTheta">meteTheta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
                abund=arth$count,
                power=arth$mass^(.75),
                minE=min(arth$mass^(.75)))
sipd1 &lt;- sipd(esf1, sppID=5)
sipd1
</code></pre>

<hr>
<h2 id='spd'>Species Power Distribution</h2><span id='topic+spd'></span><span id='topic+spd.meteESF'></span>

<h3>Description</h3>

<p><code>spd.meteESF</code> calculates the distribution nu(e | N0, S0, E0),
the distribution of average metabolic rates across for each species in a commmunity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spd(x)

## S3 method for class 'meteESF'
spd(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spd_+3A_x">x</code></td>
<td>
<p>an object of class meteESF.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See examples.
</p>


<h3>Value</h3>

<p>An object of class <code>meteDist</code>. The object contains a list with the following elements.
</p>

<dl>
<dt>data</dt><dd><p>The data used to construct the prediction</p>
</dd>
<dt>d</dt><dd><p>density funciton</p>
</dd>
<dt>p</dt><dd><p>cumulative density function</p>
</dd>
<dt>q</dt><dd><p>quantile funtion</p>
</dd>
<dt>r</dt><dd><p>random number generator</p>
</dd>
<dt>La</dt><dd><p>Vector of Lagrange multipliers</p>
</dd>
<dt>state.var</dt><dd><p>State variables used to constrain entropy maximization</p>
</dd>
<dt>type</dt><dd><p>Specifies the type of distribution is 'sad'</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteDist, sad.meteESF, metePsi
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(arth)
esf1 &lt;- meteESF(spp=arth$spp,
               abund=arth$count,
               power=arth$mass^(.75),
               minE=min(arth$mass^(.75)))
spd1 &lt;- spd(esf1)
</code></pre>

<hr>
<h2 id='ssad'>Species Spatial Abundance Distribution</h2><span id='topic+ssad'></span><span id='topic+ssad.meteSSF'></span>

<h3>Description</h3>

<p>Species Spatial Abundance Distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ssad(x)

## S3 method for class 'meteSSF'
ssad(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ssad_+3A_x">x</code></td>
<td>
<p>An objects of class meteSSF; i.e. the spatial structure function <code class="reqn">\Pi(n)</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
pi1 &lt;- meteSSF(anbo$spp, 'crcr', anbo$count, row=anbo$row, col=anbo$col, A=1, A0=16)
plot(ssad(pi1))
</code></pre>

<hr>
<h2 id='upscaleSAR'>upscale SAR</h2><span id='topic+upscaleSAR'></span>

<h3>Description</h3>

<p>Based on information at an anchor scale (<code>A0</code>)
calcuate predicted species area relationship at larger scales
</p>


<h3>Usage</h3>

<pre><code class='language-R'>upscaleSAR(x, A0, Aup, EAR = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="upscaleSAR_+3A_x">x</code></td>
<td>
<p>an object of class meteESF</p>
</td></tr>
<tr><td><code id="upscaleSAR_+3A_a0">A0</code></td>
<td>
<p>the anchor scale at which community data are availible.</p>
</td></tr>
<tr><td><code id="upscaleSAR_+3A_aup">Aup</code></td>
<td>
<p>the larges area to which to upscale</p>
</td></tr>
<tr><td><code id="upscaleSAR_+3A_ear">EAR</code></td>
<td>
<p>logical. TRUE computes the endemics area relatinship; currently not supported</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently only doublings of area are supported and only
the SAR (not EAR) is supported. Upscaling works by iteratively
solving for the constraints (<code class="reqn">S</code> and <code class="reqn">N</code> at larger scales)
that would lead to the observed data at the anchor scale. See
references for more details on this approach.
</p>


<h3>Value</h3>

<p>an object of class <code>sar</code> inheriting from <code>data.frame</code> with
columns <code>A</code> and <code>S</code> giving area and species richness, respectively
</p>


<h3>Author(s)</h3>

<p>Andy Rominger &lt;ajrominger@gmail.com&gt;, Cory Merow
</p>


<h3>References</h3>

<p>Harte, J. 2011. Maximum entropy and ecology: a theory of abundance, distribution, and energetics. Oxford University Press.
</p>


<h3>See Also</h3>

<p>meteESF, meteSAR, empiricalSAR, downscaleSAR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(anbo)
anbo.sar &lt;- meteSAR(anbo$spp, anbo$count, anbo$row, anbo$col, Amin=1, A0=16)
anbo.sar
plot(anbo.sar, xlim=c(1, 2^10), ylim=c(3, 50), log='xy')

## get upscaled SAR and add to plot
anbo.esf &lt;- meteESF(spp=anbo$spp, abund=anbo$count) # need ESF for upscaling
anbo.sarUP &lt;- upscaleSAR(anbo.esf, 16, 2^10)
plot(anbo.sarUP, add=TRUE, col='blue')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
