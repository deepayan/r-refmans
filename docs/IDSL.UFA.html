<!DOCTYPE html><html><head><title>Help for package IDSL.UFA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IDSL.UFA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aggregatedIPdbListGenerator'>
<p>aggregatedIPdbListGenerator</p></a></li>
<li><a href='#aligned_molecular_formula_annotator'>
<p>Aligned Molecular Formula Annotator</p></a></li>
<li><a href='#detect_formula_sets+20'>
<p>Organic Class Detection by Repeated Unit Patterns</p></a></li>
<li><a href='#element_sorter'>
<p>Element Sorter</p></a></li>
<li><a href='#extendedSENIORrule'>
<p>extended SENIOR rule check</p></a></li>
<li><a href='#formula_adduct_calculator'>
<p>Formula Adduct Calculator</p></a></li>
<li><a href='#formula_vector_generator'>
<p>Molecular Formula Vector Generator</p></a></li>
<li><a href='#hill_molecular_formula_printer'>
<p>Print Hill Molecular Formula</p></a></li>
<li><a href='#identificationScoreCalculator'>
<p>Multiplicative Identification Score for the IDSL.UFA pipeline</p></a></li>
<li><a href='#ionization_pathway_deconvoluter'>
<p>Ionization Pathway Deconvoluter</p></a></li>
<li><a href='#isotopic_profile_calculator'>
<p>Isotopic Profile Calculator</p></a></li>
<li><a href='#molecular_formula_annotator'>
<p>Molecular Formula Annotator</p></a></li>
<li><a href='#molecular_formula_elements_filter'>
<p>molecular_formula_elements_filter</p></a></li>
<li><a href='#molecular_formula_library_generator'>
<p>Molecular Formula Database Producer</p></a></li>
<li><a href='#molecular_formula_library_search'>
<p>Molecular Formula Library Search</p></a></li>
<li><a href='#molecularFormula2IPdb'>
<p>Molecular Formula to IPDB</p></a></li>
<li><a href='#monoisotopicMassCalculator'>
<p>Monoisotopic Mass Calculator</p></a></li>
<li><a href='#scoreCoefficientsEvaluation'>
<p>Score Coefficient Evaluation</p></a></li>
<li><a href='#scoreCoefficientsOptimization'>
<p>Coefficients Score Optimization</p></a></li>
<li><a href='#scoreCoefficientsReplicate'>
<p>Zero Score Function</p></a></li>
<li><a href='#UFA_enumerated_chemical_space'>
<p>IPDBs from UFA Enumerated Chemical Space (ECS) approach</p></a></li>
<li><a href='#UFA_enumerated_chemical_space_xlsxAnalyzer'>
<p>IPDBs from UFA Enumerated Chemical Space (ECS) xlsx Analyzer</p></a></li>
<li><a href='#UFA_formula_source'>
<p>IPDB from a Molecular Formulas Source</p></a></li>
<li><a href='#UFA_formula_source_xlsxAnalyzer'>
<p>UFA Formula Source xlsxAnalyzer</p></a></li>
<li><a href='#UFA_IPdbMerger'>
<p>UFA IPDB Merger</p></a></li>
<li><a href='#UFA_locate_regex'>
<p>UFA Locate regex</p></a></li>
<li><a href='#UFA_PubChem_formula_extraction'>
<p>UFA PubChem Formula Extraction</p></a></li>
<li><a href='#UFA_score_coefficients_corrector'>
<p>Score Coefficients Corrector for MolecularFormulaAnnotationTable</p></a></li>
<li><a href='#UFA_score_function_optimization'>
<p>UFA Score Coefficient Workflow</p></a></li>
<li><a href='#UFA_score_function_optimization_xlsxAnalyzer'>
<p>UFA Score Optimization xlsx Analyzer</p></a></li>
<li><a href='#UFA_workflow'>
<p>UFA Workflow</p></a></li>
<li><a href='#UFA_xlsxAnalyzer'>
<p>UFA xlsx Analyzer</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>United Formula Annotation (UFA) for HRMS Data Processing</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>IDSL.IPA (&ge; 2.7), readxl</td>
</tr>
<tr>
<td>Suggests:</td>
<td>GA</td>
</tr>
<tr>
<td>Author:</td>
<td>Sadjad Fakouri-Baygi
    <a href="https://orcid.org/0000-0002-6864-6911"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Dinesh Barupal <a href="https://orcid.org/0000-0002-9954-8628"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dinesh Barupal &lt;dinesh.barupal@mssm.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A pipeline to annotate chromatography peaks from the 'IDSL.IPA' workflow &lt;<a href="https://doi.org/10.1021%2Facs.jproteome.2c00120">doi:10.1021/acs.jproteome.2c00120</a>&gt; with molecular formulas of a prioritized chemical space using an isotopic profile matching approach. The 'IDSL.UFA' workflow only requires mass spectrometry level 1 (MS1) data for formula annotation. The 'IDSL.UFA' methods was described in &lt;<a href="https://doi.org/10.1021%2Facs.analchem.2c00563">doi:10.1021/acs.analchem.2c00563</a>&gt; .</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/idslme/idsl.ufa">https://github.com/idslme/idsl.ufa</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/idslme/idsl.ufa/issues">https://github.com/idslme/idsl.ufa/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Archs:</td>
<td>i386, x64</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-18 19:31:04 UTC; sfbaygi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-18 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aggregatedIPdbListGenerator'>
aggregatedIPdbListGenerator
</h2><span id='topic+aggregatedIPdbListGenerator'></span>

<h3>Description</h3>

<p>aggregatedIPdbListGenerator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggregatedIPdbListGenerator(MassMAIso)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggregatedIPdbListGenerator_+3A_massmaiso">MassMAIso</code></td>
<td>

<p>MassMAIso
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>AggregatedList
</p>

<hr>
<h2 id='aligned_molecular_formula_annotator'>
Aligned Molecular Formula Annotator
</h2><span id='topic+aligned_molecular_formula_annotator'></span>

<h3>Description</h3>

<p>This function detects frequent molecular formulas across multiple samples on the aligned peak table matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aligned_molecular_formula_annotator(PARAM)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aligned_molecular_formula_annotator_+3A_param">PARAM</code></td>
<td>

<p>a parameter driven from the UFA_xlsxAnalyzer module.
</p>
</td></tr>
</table>

<hr>
<h2 id='detect_formula_sets+20'>
Organic Class Detection by Repeated Unit Patterns
</h2><span id='topic+detect_formula_sets'></span>

<h3>Description</h3>

<p>This function sorts a vector of molecular formulas to aggregate organic compound classes with repeated/non-repeated substructure units. This function only works for molecular formulas with following elements: c(&quot;As&quot;, &quot;Br&quot;, &quot;Cl&quot;, &quot;Na&quot;, &quot;Se&quot;, &quot;Si&quot;, &quot;B&quot;, &quot;C&quot;, &quot;F&quot;, &quot;H&quot;, &quot;I&quot;, &quot;K&quot;, &quot;N&quot;, &quot;O&quot;, &quot;P&quot;, &quot;S&quot;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_formula_sets(molecular_formulas, ratio_delta_HBrClFI_C = 2,
mixed.HBrClFI.allowed = FALSE, min_molecular_formula_class = 2,
max_number_formula_class = 100, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_formula_sets+2B20_+3A_molecular_formulas">molecular_formulas</code></td>
<td>

<p>a vector of molecular formulas
</p>
</td></tr>
<tr><td><code id="detect_formula_sets+2B20_+3A_ratio_delta_hbrclfi_c">ratio_delta_HBrClFI_C</code></td>
<td>

<p>c(2, 1/2, 0).
2 to detect structures with linear carbon chains such as PFAS, lipids, chlorinated paraffins, etc.
1/2 to detect structures with cyclic chains such as PAHs.
0 to detect molecular formulas with a fixed structures but changing H/Br/Cl/F/I atoms similar to PCBs, PBDEs, etc.
</p>
</td></tr>
<tr><td><code id="detect_formula_sets+2B20_+3A_mixed.hbrclfi.allowed">mixed.HBrClFI.allowed</code></td>
<td>

<p>mixed.HBrClFI.allowed = c(TRUE, FALSE). Select 'FALSE' to detect halogenated-saturated compounds similar to PFOS or select 'TRUE' to detect mixed halogenated compounds with hydrogen.
</p>
</td></tr>
<tr><td><code id="detect_formula_sets+2B20_+3A_min_molecular_formula_class">min_molecular_formula_class</code></td>
<td>

<p>minimum number of molecular formulas in each class. This number should be greater than or equal to 2.
</p>
</td></tr>
<tr><td><code id="detect_formula_sets+2B20_+3A_max_number_formula_class">max_number_formula_class</code></td>
<td>

<p>maximum number of molecular formulas in each class
</p>
</td></tr>
<tr><td><code id="detect_formula_sets+2B20_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded computations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of clustered classes of organic molecular formulas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molecular_formulas &lt;- c("C3F7O3S", "C4F9O3S", "C5F11O3S", "C6F9O3S", "C8F17O3S",
"C9F19O3S", "C10F21O3S", "C7ClF14O4", "C10ClF20O4", "C11ClF22O4", "C11Cl2F21O4",
"C12ClF24O4")
##
ratio_delta_HBrClFI_C &lt;- 2 # to aggregate polymeric classes
mixed.HBrClFI.allowed &lt;- FALSE # To detect only halogen saturated classes
min_molecular_formula_class &lt;- 2
max_number_formula_class &lt;- 20
##
classes &lt;- detect_formula_sets(molecular_formulas, ratio_delta_HBrClFI_C,
mixed.HBrClFI.allowed, min_molecular_formula_class, max_number_formula_class,
number_processing_threads = 1)
</code></pre>

<hr>
<h2 id='element_sorter'>
Element Sorter
</h2><span id='topic+element_sorter'></span>

<h3>Description</h3>

<p>This module sorts 84 non-labeled and 14 labeled elements in the periodic table for molecular formula deconvolution and isotopic profile calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>element_sorter(ElementList = "all", alphabeticalOrder = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="element_sorter_+3A_elementlist">ElementList</code></td>
<td>

<p>A string vector of elements needed for isotopic profile calculation. The default value for this parameter is a vector string of entire elements.
</p>
</td></tr>
<tr><td><code id="element_sorter_+3A_alphabeticalorder">alphabeticalOrder</code></td>
<td>

<p>'TRUE' should be used to sort the elements for elemental deconvolution (default value), 'FALSE' should be used to keep the input order.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>Elements</code></td>
<td>

<p>A string vector of elements (alphabetically sorted or unsorted)
</p>
</td></tr>
<tr><td><code>massAbundanceList</code></td>
<td>

<p>A list of isotopic mass and abundance of elements.
</p>
</td></tr>
<tr><td><code>Valence</code></td>
<td>

<p>A vector of electron valences.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>EL_mass_abundance_val &lt;- element_sorter()
</code></pre>

<hr>
<h2 id='extendedSENIORrule'>
extended SENIOR rule check
</h2><span id='topic+extendedSENIORrule'></span>

<h3>Description</h3>

<p>This function checks whether a molecular formula follows the extended SENIOR rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extendedSENIORrule(mol_vec, valence_vec, ionization_correction = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extendedSENIORrule_+3A_mol_vec">mol_vec</code></td>
<td>

<p>A vector of the deconvoluted molecular formula
</p>
</td></tr>
<tr><td><code id="extendedSENIORrule_+3A_valence_vec">valence_vec</code></td>
<td>

<p>A vector of the valences from the molecular formula. Valences may be acquired from the 'IUPAC_Isotopes' data.
</p>
</td></tr>
<tr><td><code id="extendedSENIORrule_+3A_ionization_correction">ionization_correction</code></td>
<td>

<p>A number to compensate for the ionization losses/gains. For example, &lsquo;-1' for [M+H/K/Na] ionization pathways and '+1&rsquo; for [M-H] ionization pathway.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>rule2</code></td>
<td>

<p>TURE for when the molecular formula passes the rule and FALSE for when the molecular formula fails to pass the rule.
</p>
</td></tr>
</table>

<hr>
<h2 id='formula_adduct_calculator'>
Formula Adduct Calculator
</h2><span id='topic+formula_adduct_calculator'></span>

<h3>Description</h3>

<p>This function takes a formula and a vector of ionization pathways and returns the adduct formulas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_adduct_calculator(molecular_formula, IonPathways)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_adduct_calculator_+3A_molecular_formula">molecular_formula</code></td>
<td>

<p>molecular formula
</p>
</td></tr>
<tr><td><code id="formula_adduct_calculator_+3A_ionpathways">IonPathways</code></td>
<td>

<p>A vector of ionization pathways. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathways &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of adduct formulas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molecular_formula = "C15H10O7"
IonPathways = c("[M+]","[M+H]","[M+H20+H]","[M+Na]")
Formula_adducts &lt;- formula_adduct_calculator(molecular_formula, IonPathways)
</code></pre>

<hr>
<h2 id='formula_vector_generator'>
Molecular Formula Vector Generator
</h2><span id='topic+formula_vector_generator'></span>

<h3>Description</h3>

<p>This function convert a molecular formulas into a numerical vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_vector_generator(molecular_formula, Elements, LElements = length(Elements),
allowedRedundantElements = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_vector_generator_+3A_molecular_formula">molecular_formula</code></td>
<td>

<p>molecular formula
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_elements">Elements</code></td>
<td>

<p>a string vector of elements. This value must be driven from the 'element_sorter' function.
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_lelements">LElements</code></td>
<td>

<p>number of elements. To speed up loop calculations, consider calculating the number of elements outside of the loop.
</p>
</td></tr>
<tr><td><code id="formula_vector_generator_+3A_allowedredundantelements">allowedRedundantElements</code></td>
<td>

<p>'TRUE' should be used to deconvolute molecular formulas with redundant elements (e.g. CO2CH3O), and 'FALSE' should be used to skip such complex molecular formulas.(default value)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical vector for the molecular formula. This function returns a vector of -Inf values when the molecular formula has elements not listed in the 'Elements' string vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>molecular_formula &lt;- "[13]C2C12H2Br5Cl3O"
Elements_molecular_formula &lt;- c("[13]C", "C", "H", "O", "Br", "Cl")
EL &lt;- element_sorter(ElementList = Elements_molecular_formula, alphabeticalOrder = TRUE)
Elements &lt;- EL[["Elements"]]
LElements &lt;- length(Elements)
##
mol_vec &lt;- formula_vector_generator(molecular_formula, Elements, LElements,
allowedRedundantElements = TRUE)
##
regenerated_molecular_formula &lt;- hill_molecular_formula_printer(Elements, mol_vec)
</code></pre>

<hr>
<h2 id='hill_molecular_formula_printer'>
Print Hill Molecular Formula
</h2><span id='topic+hill_molecular_formula_printer'></span>

<h3>Description</h3>

<p>This function produces molecular formulas from a list numerical vectors in the Hill notation system
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hill_molecular_formula_printer(Elements, MolVecMat, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hill_molecular_formula_printer_+3A_elements">Elements</code></td>
<td>

<p>A vector string of the used elements.
</p>
</td></tr>
<tr><td><code id="hill_molecular_formula_printer_+3A_molvecmat">MolVecMat</code></td>
<td>

<p>A matrix of numerical vectors of molecular formulas in each row.
</p>
</td></tr>
<tr><td><code id="hill_molecular_formula_printer_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded processing
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of molecular formulas
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Elements &lt;- c("C", "H", "O", "N", "Br", "Cl")
MoleFormVec1 &lt;- c(2, 6, 1, 0, 0, 0) # C2H6O
MoleFormVec2 &lt;- c(8, 10, 2, 4, 0 ,0) # C8H10N4O2
MoleFormVec3 &lt;- c(12, 2, 1, 0, 5, 3) # C12H2Br5Cl3O
MolVecMat &lt;- rbind(MoleFormVec1, MoleFormVec2, MoleFormVec3)
H_MolF &lt;- hill_molecular_formula_printer(Elements, MolVecMat)
</code></pre>

<hr>
<h2 id='identificationScoreCalculator'>
Multiplicative Identification Score for the IDSL.UFA pipeline
</h2><span id='topic+identificationScoreCalculator'></span>

<h3>Description</h3>

<p>This function calculates the score values to rank candidate molecular formulas for a mass spectrometry-chromatography peak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identificationScoreCalculator(scoreCoefficients, nIisotopologues, PCS, RCS, NEME,
R13C_PL, R13C_IP)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identificationScoreCalculator_+3A_scorecoefficients">scoreCoefficients</code></td>
<td>

<p>A vector of seven numbers equal or greater than 0
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_niisotopologues">nIisotopologues</code></td>
<td>

<p>Number of isotopologues in the theoretical isotopic profiles.
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_pcs">PCS</code></td>
<td>

<p>PCS (per mille)
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_rcs">RCS</code></td>
<td>

<p>RCS (percentage)
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_neme">NEME</code></td>
<td>

<p>NEME (mDa)
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_r13c_pl">R13C_PL</code></td>
<td>

<p>R13C of the peak from IDSL.IPA peaklists
</p>
</td></tr>
<tr><td><code id="identificationScoreCalculator_+3A_r13c_ip">R13C_IP</code></td>
<td>

<p>R13C from theoretical isotopic profiles
</p>
</td></tr>
</table>

<hr>
<h2 id='ionization_pathway_deconvoluter'>
Ionization Pathway Deconvoluter
</h2><span id='topic+ionization_pathway_deconvoluter'></span>

<h3>Description</h3>

<p>This function deconvolutes ionization pathways into a coefficient and a numerical vector to simplify prediction ionization pathways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ionization_pathway_deconvoluter(IonPathways, Elements)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ionization_pathway_deconvoluter_+3A_ionpathways">IonPathways</code></td>
<td>

<p>A vector of ionization pathways. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathways &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
<tr><td><code id="ionization_pathway_deconvoluter_+3A_elements">Elements</code></td>
<td>

<p>A vector string of the used elements
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of adduct calculation values for each ionization pathway.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Elements &lt;- element_sorter(alphabeticalOrder = TRUE)[["Elements"]]
IonPathways &lt;- c("[M]+", "[M+H]+", "[2M-Cl]-", "[3M+CO2-H2O+Na-KO2+HCl-NH4]-")
Ion_DC &lt;- ionization_pathway_deconvoluter(IonPathways, Elements)
</code></pre>

<hr>
<h2 id='isotopic_profile_calculator'>
Isotopic Profile Calculator
</h2><span id='topic+isotopic_profile_calculator'></span>

<h3>Description</h3>

<p>This function was designed to calculate isotopic profile distributions for small molecules with masses &lt;= 1200 Da. Nonetheless, this function may suit more complicated tasks with complex biological compounds. Details of the equations used in this function are available in the reference[1]. In this function, neighboring isotopologues are merged using the satellite clustering merging (SCM) method described in the reference[2].
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotopic_profile_calculator(MoleFormVec, massAbundanceList, peak_spacing,
intensity_cutoff, UFA_IP_memeory_variables = c(1e30, 1e-12, 100))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isotopic_profile_calculator_+3A_moleformvec">MoleFormVec</code></td>
<td>

<p>A numerical vector of the molecular formula
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_massabundancelist">massAbundanceList</code></td>
<td>

<p>A list of isotopic mass and abundance of elements obtained from the 'element_sorter' function
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_peak_spacing">peak_spacing</code></td>
<td>

<p>A maximum space between two isotopologues in Da
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_intensity_cutoff">intensity_cutoff</code></td>
<td>

<p>A minimum intensity threshold for isotopic profiles in percentage
</p>
</td></tr>
<tr><td><code id="isotopic_profile_calculator_+3A_ufa_ip_memeory_variables">UFA_IP_memeory_variables</code></td>
<td>

<p>A vector of three variables. Default values are c(1e30, 1e-12, 100) to manage memory usage. UFA_IP_memeory_variables[1] is used to control the overall size of isotopic combinations. UFA_IP_memeory_variables[2] indicates the minimum relative abundance (RA calculated by eq(1) in the reference [1]) of an isotopologue to include in the isotopic profile calculations. UFA_IP_memeory_variables[3] is the maximum elapsed time to calculate the isotopic profile on the 'setTimeLimit' function of base R.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of isotopic profile. The first and second column represents the mass and intensity profiles, respectively.
</p>


<h3>References</h3>

<p>[1] Fakouri Baygi, S., Crimmins, B.S., Hopke, P.K. Holsen, T.M. (2016). Comprehensive emerging chemical discovery: novel polyfluorinated compounds in Lake Michigan trout. <em>Environmental Science and Technology</em>, 50(17), 9460-9468, <a href="https://doi.org/10.1021/acs.est.6b01349">doi:10.1021/acs.est.6b01349</a>.
</p>
<p>[2] Fakouri Baygi, S., Fernando, S., Hopke, P.K., Holsen, T.M. and Crimmins, B.S. (2019). Automated Isotopic Profile Deconvolution for High Resolution Mass Spectrometric Data (APGC-QToF) from Biological Matrices. <em>Analytical chemistry</em>, 91(24), 15509-15517, <a href="https://doi.org/10.1021/acs.analchem.9b03335">doi:10.1021/acs.analchem.9b03335</a>.
</p>


<h3>See Also</h3>

<p><a href="https://ipc.idsl.me/">https://ipc.idsl.me/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>EL &lt;- element_sorter(alphabeticalOrder = TRUE)
Elements &lt;- EL[["Elements"]]
massAbundanceList &lt;- EL[["massAbundanceList"]]
peak_spacing &lt;- 0.005 # mDa
intensity_cutoff &lt;- 1 # (in percentage)
MoleFormVec &lt;- formula_vector_generator("C8H10N4O2", Elements)
IP &lt;- isotopic_profile_calculator(MoleFormVec, massAbundanceList, peak_spacing,
intensity_cutoff)
</code></pre>

<hr>
<h2 id='molecular_formula_annotator'>
Molecular Formula Annotator
</h2><span id='topic+molecular_formula_annotator'></span>

<h3>Description</h3>

<p>This module annotates candidate molecular formulas in the peaklists from the IDSL.IPA pipeline using isotopic profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molecular_formula_annotator(IPDB, spectraList, peaklist, selectedIPApeaks,
massAccuracy, maxNEME, minPCS, minNDCS, minRCS, scoreCoefficients, RTtolerance = NA,
correctedRTpeaklist = NULL, exportSpectraParameters = NULL, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molecular_formula_annotator_+3A_ipdb">IPDB</code></td>
<td>

<p>An isotopic profile database produced by the IDSL.UFA functions.
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_spectralist">spectraList</code></td>
<td>

<p>a list of mass spectra in each chromatogram scan.
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_peaklist">peaklist</code></td>
<td>

<p>Peaklist from the IDSL.IPA pipeline
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_selectedipapeaks">selectedIPApeaks</code></td>
<td>

<p>selected IPA peaklist
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_massaccuracy">massAccuracy</code></td>
<td>

<p>Mass accuracy in Da
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_maxneme">maxNEME</code></td>
<td>

<p>Maximum value for Normalized Euclidean Mass Error (NEME) in mDa
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_minpcs">minPCS</code></td>
<td>

<p>Minimum value for Profile Cosine Similarity (PCS)
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_minndcs">minNDCS</code></td>
<td>

<p>Minimum value for Number of Detected Chromatogram Scans (NDCS)
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_minrcs">minRCS</code></td>
<td>

<p>Minimum value for Ratio of Chromatogram Scans (RCS) in percentage
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_scorecoefficients">scoreCoefficients</code></td>
<td>

<p>A vector of five numbers representing coefficients of the identification score
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_rttolerance">RTtolerance</code></td>
<td>

<p>Retention time tolerance (min)
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_correctedrtpeaklist">correctedRTpeaklist</code></td>
<td>

<p>corrected retention time peaklist
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_exportspectraparameters">exportSpectraParameters</code></td>
<td>

<p>Parameters for export MS/MS match figures
</p>
</td></tr>
<tr><td><code id="molecular_formula_annotator_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded processing
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of candidate molecular formulas
</p>

<hr>
<h2 id='molecular_formula_elements_filter'>
molecular_formula_elements_filter
</h2><span id='topic+molecular_formula_elements_filter'></span>

<h3>Description</h3>

<p>molecular_formula_elements_filter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molecular_formula_elements_filter(molecularFormulaMatrix, Elements)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molecular_formula_elements_filter_+3A_molecularformulamatrix">molecularFormulaMatrix</code></td>
<td>

<p>molecularFormulaMatrix
</p>
</td></tr>
<tr><td><code id="molecular_formula_elements_filter_+3A_elements">Elements</code></td>
<td>

<p>Elements
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of molecularFormulaMatrix and elementSorterList.
</p>

<hr>
<h2 id='molecular_formula_library_generator'>
Molecular Formula Database Producer
</h2><span id='topic+molecular_formula_library_generator'></span>

<h3>Description</h3>

<p>This function generates an efficient database for molecular formula matching against a database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molecular_formula_library_generator(entire_molecular_formulas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molecular_formula_library_generator_+3A_entire_molecular_formulas">entire_molecular_formulas</code></td>
<td>

<p>A string vector of molecular formulas (redundancy is allowed)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of frequency of molecular formulas in the database.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>entire_molecular_formulas &lt;- c("C2H6O", "C2H6O", "C2H6O", "C2H6O", "CH4O", "CH4O",
"CH4O", "NH4", "C6H12O6")
db &lt;- molecular_formula_library_generator(entire_molecular_formulas)
freq &lt;- db[c("C6H12O6", "CH4O")]
</code></pre>

<hr>
<h2 id='molecular_formula_library_search'>
Molecular Formula Library Search
</h2><span id='topic+molecular_formula_library_search'></span>

<h3>Description</h3>

<p>This function attempts to match candidate molecular formulas against a library of molecular formulas using a set of ionization pathways.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molecular_formula_library_search(MolecularFormulaAnnotationTable, MFlibrary,
IonPathways, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molecular_formula_library_search_+3A_molecularformulaannotationtable">MolecularFormulaAnnotationTable</code></td>
<td>

<p>A molecular formula annotation table from the 'molecular_formula_annotator' module.
</p>
</td></tr>
<tr><td><code id="molecular_formula_library_search_+3A_mflibrary">MFlibrary</code></td>
<td>

<p>A library of molecular formulas generated using the 'molecular_formula_library_generator' module.
</p>
</td></tr>
<tr><td><code id="molecular_formula_library_search_+3A_ionpathways">IonPathways</code></td>
<td>

<p>A vector of ionization pathways. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathways &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
<tr><td><code id="molecular_formula_library_search_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded processing
</p>
</td></tr>
</table>

<hr>
<h2 id='molecularFormula2IPdb'>
Molecular Formula to IPDB
</h2><span id='topic+molecularFormula2IPdb'></span>

<h3>Description</h3>

<p>A function to calculate IPDBs from a vector of molecular formulas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>molecularFormula2IPdb(molecularFormulaDatabase, retentionTime = NULL, peak_spacing = 0,
intensity_cutoff_str = 1, IonPathways = "[M]+", number_processing_threads = 1,
UFA_IP_memeory_variables = c(1e30, 1e-12, 100), allowedMustRunCalculation = FALSE,
allowedVerbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="molecularFormula2IPdb_+3A_molecularformuladatabase">molecularFormulaDatabase</code></td>
<td>

<p>A vector string of molecular formulas OR a list of elements and molecular formula matrix
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_retentiontime">retentionTime</code></td>
<td>

<p>retention time
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_peak_spacing">peak_spacing</code></td>
<td>

<p>A maximum space between isotopologues in Da to merge neighboring isotopologues.
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_intensity_cutoff_str">intensity_cutoff_str</code></td>
<td>

<p>A minimum intensity threshold for isotopic profiles in percentage. This parameter may be a string piece of R commands using c, b, br, cl, k, s, se, and si variables corresponding to the same elements.
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_ionpathways">IonPathways</code></td>
<td>

<p>A vector of ionization pathways. Pathways should be like [Coeff*M+ADD1-DED1+...] where &quot;Coeff&quot; should be an integer between 1-9 and ADD1 and DED1 may be ionization pathways. ex: 'IonPathways &lt;- c(&quot;[M]+&quot;, &quot;[M+H]+&quot;, &quot;[2M-Cl]-&quot;, &quot;[3M+CO2-H2O+Na-KO2+HCl-NH4]-&quot;)'
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>number of processing cores for multi-threaded computations.
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_ufa_ip_memeory_variables">UFA_IP_memeory_variables</code></td>
<td>

<p>A vector of three variables. Default values are c(1e30, 1e-12, 100) to manage memory usage. UFA_IP_memeory_variables[1] is used to control the overall size of isotopic combinations. UFA_IP_memeory_variables[2] indicates the minimum relative abundance (RA calculated by eq(1) in the reference [1]) of an isotopologue to include in the isotopic profile calculations. UFA_IP_memeory_variables[3] is the maximum elapsed time to calculate the isotopic profile on the 'setTimeLimit' function of the base R.
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_allowedmustruncalculation">allowedMustRunCalculation</code></td>
<td>

<p>c(TRUE, FALSE). A 'TRUE' allowedMustRunCalculation applies a brute-force method to calculate complex isotopic profiles. When 'TRUE', this option may significantly reduce the speed for multithreaded processing.
</p>
</td></tr>
<tr><td><code id="molecularFormula2IPdb_+3A_allowedverbose">allowedVerbose</code></td>
<td>

<p>c(TRUE, FALSE). A 'TRUE' allowedVerbose provides messages about the flow of the function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An IPDB list of isotopic profiles
</p>


<h3>References</h3>

<p>[1] Fakouri Baygi, S., Crimmins, B.S., Hopke, P.K. Holsen, T.M. (2016). Comprehensive emerging chemical discovery: novel polyfluorinated compounds in Lake Michigan trout. <em>Environmental Science and Technology</em>, 50(17), 9460-9468, <a href="https://doi.org/10.1021/acs.est.6b01349">doi:10.1021/acs.est.6b01349</a>.
</p>


<h3>See Also</h3>

<p><a href="https://ipc.idsl.me/">https://ipc.idsl.me/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(IDSL.UFA, attach.required = TRUE)
molecular_formula &lt;- c("C13F8N8O2", "C20H22", "C8HF16ClSO3", "C12Cl10", "C123H193N35O37")
peak_spacing &lt;- 0.005 # in Da for QToF instruments
# Use this piece of code for intensity cutoff to preserve significant isotopologues
intensity_cutoff_str &lt;- "if (s&gt;0 &amp; si&gt;0) {min(c(c, 10, si*3, s*4))}
else if (s&gt;0 &amp; si==0) {min(c(c, 10, s*4))}
else if (s==0 &amp; si&gt;0) {min(c(c, 10, si*3))}
else if (s==0 &amp; si==0) {min(c(c, 10))}"
UFA_IP_memeory_variables &lt;- c(1e30, 1e-12, 100)
IonPathways &lt;- c("[M+H]+", "[M+Na]+", "[M-H2O+H]+")
number_processing_threads &lt;- 2
listIsoProDataBase &lt;- molecularFormula2IPdb(molecular_formula, retentionTime = NULL,
peak_spacing, intensity_cutoff_str, IonPathways, number_processing_threads,
UFA_IP_memeory_variables, allowedMustRunCalculation = FALSE, allowedVerbose = TRUE)
save(listIsoProDataBase, file = "listIsoProDataBase.Rdata")

</code></pre>

<hr>
<h2 id='monoisotopicMassCalculator'>
Monoisotopic Mass Calculator
</h2><span id='topic+monoisotopicMassCalculator'></span>

<h3>Description</h3>

<p>This function calculates monoisotopic mass of a molecular formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monoisotopicMassCalculator(MoleFormVec, massAbundanceList,
LElements = length(massAbundanceList))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monoisotopicMassCalculator_+3A_moleformvec">MoleFormVec</code></td>
<td>

<p>A numerical vector molecular formula
</p>
</td></tr>
<tr><td><code id="monoisotopicMassCalculator_+3A_massabundancelist">massAbundanceList</code></td>
<td>

<p>A list of isotopic mass and abundance of elements obtained from the 'element_sorter' function
</p>
</td></tr>
<tr><td><code id="monoisotopicMassCalculator_+3A_lelements">LElements</code></td>
<td>

<p>length of elements
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The monoisotopic mass
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Elements &lt;- c("C", "H", "O")
MoleFormVec &lt;- c(2, 6, 1) # C2H6O
EL_mass_abundance &lt;- element_sorter(ElementList = Elements, alphabeticalOrder = FALSE)
massAbundanceList &lt;- EL_mass_abundance[["massAbundanceList"]]
MImass &lt;- monoisotopicMassCalculator(MoleFormVec, massAbundanceList)
</code></pre>

<hr>
<h2 id='scoreCoefficientsEvaluation'>
Score Coefficient Evaluation
</h2><span id='topic+scoreCoefficientsEvaluation'></span>

<h3>Description</h3>

<p>This function evaluates the efficiency of the optimization process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreCoefficientsEvaluation(PARAM_ScoreFunc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreCoefficientsEvaluation_+3A_param_scorefunc">PARAM_ScoreFunc</code></td>
<td>

<p>PARAM_ScoreFunc is a variable derived from the 'UFA_coefficient_xlsxAnalyzer' function
</p>
</td></tr>
</table>

<hr>
<h2 id='scoreCoefficientsOptimization'>
Coefficients Score Optimization
</h2><span id='topic+scoreCoefficientsOptimization'></span>

<h3>Description</h3>

<p>This function optimizes the coefficients of the score function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreCoefficientsOptimization(PARAM_ScoreFunc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreCoefficientsOptimization_+3A_param_scorefunc">PARAM_ScoreFunc</code></td>
<td>

<p>PARAM_ScoreFunc is a variable derived from the 'UFA_score_function_optimization_xlsxAnalyzer' function
</p>
</td></tr>
</table>

<hr>
<h2 id='scoreCoefficientsReplicate'>
Zero Score Function
</h2><span id='topic+scoreCoefficientsReplicate'></span>

<h3>Description</h3>

<p>This function generates the input for the score optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scoreCoefficientsReplicate(PARAM_ScoreFunc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scoreCoefficientsReplicate_+3A_param_scorefunc">PARAM_ScoreFunc</code></td>
<td>

<p>PARAM_ScoreFunc is a variable derived from the 'UFA_coefficient_xlsxAnalyzer' function
</p>
</td></tr>
</table>

<hr>
<h2 id='UFA_enumerated_chemical_space'>
IPDBs from UFA Enumerated Chemical Space (ECS) approach
</h2><span id='topic+UFA_enumerated_chemical_space'></span>

<h3>Description</h3>

<p>This function produces the isotopic profile database using the UFA enumerated chemical space (ECS) approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_enumerated_chemical_space(PARAM_ECS)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_enumerated_chemical_space_+3A_param_ecs">PARAM_ECS</code></td>
<td>

<p>A dataframe of the molecular formula constraints in the UFA spreadsheet
</p>
</td></tr>
</table>

<hr>
<h2 id='UFA_enumerated_chemical_space_xlsxAnalyzer'>
IPDBs from UFA Enumerated Chemical Space (ECS) xlsx Analyzer
</h2><span id='topic+UFA_enumerated_chemical_space_xlsxAnalyzer'></span>

<h3>Description</h3>

<p>This function evaluates the molecular formula generation constraints in the spreadsheet to create the isotopic profile database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_enumerated_chemical_space_xlsxAnalyzer(spreadsheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_enumerated_chemical_space_xlsxAnalyzer_+3A_spreadsheet">spreadsheet</code></td>
<td>

<p>UFA spreadsheet
</p>
</td></tr>
</table>

<hr>
<h2 id='UFA_formula_source'>
IPDB from a Molecular Formulas Source
</h2><span id='topic+UFA_formula_source'></span>

<h3>Description</h3>

<p>This function produces IPDB from a molecular formula source (a .csv/.txt/.xlsx file).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_formula_source(PARAM_FormSource)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_formula_source_+3A_param_formsource">PARAM_FormSource</code></td>
<td>

<p>PARAM_FormSource is an internal variable of the IDSL.UFA package.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an IPDB is saved in the destination address
</p>

<hr>
<h2 id='UFA_formula_source_xlsxAnalyzer'>
UFA Formula Source xlsxAnalyzer
</h2><span id='topic+UFA_formula_source_xlsxAnalyzer'></span>

<h3>Description</h3>

<p>This function evaluates the parameter spreadsheet for score coefficients optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_formula_source_xlsxAnalyzer(spreadsheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_formula_source_xlsxAnalyzer_+3A_spreadsheet">spreadsheet</code></td>
<td>

<p>The parameter spreadsheet in the .xlsx format.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a processed parameter to feed the 'UFA_molecular_formulas_source' function.
</p>

<hr>
<h2 id='UFA_IPdbMerger'>
UFA IPDB Merger
</h2><span id='topic+UFA_IPdbMerger'></span>

<h3>Description</h3>

<p>To merge multiple IPDBs into one IPDB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_IPdbMerger(path, vecIPDB)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_IPdbMerger_+3A_path">path</code></td>
<td>

<p>path
</p>
</td></tr>
<tr><td><code id="UFA_IPdbMerger_+3A_vecipdb">vecIPDB</code></td>
<td>

<p>a vector of IPDBs
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>IPDB
</p>

<hr>
<h2 id='UFA_locate_regex'>
UFA Locate regex
</h2><span id='topic+UFA_locate_regex'></span>

<h3>Description</h3>

<p>Locate indices of the pattern in the string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_locate_regex(string, pattern, ignore.case = FALSE, perl = FALSE, fixed = FALSE,
useBytes = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_locate_regex_+3A_string">string</code></td>
<td>

<p>a string as character
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_pattern">pattern</code></td>
<td>

<p>a pattern to screen
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_ignore.case">ignore.case</code></td>
<td>

<p>ignore.case
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_perl">perl</code></td>
<td>

<p>perl
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_fixed">fixed</code></td>
<td>

<p>fixed
</p>
</td></tr>
<tr><td><code id="UFA_locate_regex_+3A_usebytes">useBytes</code></td>
<td>

<p>useBytes
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns 'NULL' when no matches are detected for the pattern.
</p>


<h3>Value</h3>

<p>A 2-column matrix of location indices. The first and second columns represent start and end positions, respectively.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pattern &lt;- "Cl"
string &lt;- "NaCl.5HCl"
Location_Cl &lt;- UFA_locate_regex(string, pattern)
</code></pre>

<hr>
<h2 id='UFA_PubChem_formula_extraction'>
UFA PubChem Formula Extraction
</h2><span id='topic+UFA_PubChem_formula_extraction'></span>

<h3>Description</h3>

<p>This module is to extract molecular formulas from a database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_PubChem_formula_extraction(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_PubChem_formula_extraction_+3A_path">path</code></td>
<td>

<p>path to store information
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Molecular formulas in <a href="https://pubchem.ncbi.nlm.nih.gov/">https://pubchem.ncbi.nlm.nih.gov/</a> are stored in the provided 'path' in the .txt format.
</p>


<h3>References</h3>

<p>Kim S, Chen J, Cheng T, Gindulyte A, He J, He S, Li Q, Shoemaker BA, Thiessen PA, Yu B, Zaslavsky L, Zhang J, Bolton EE. PubChem in 2021: new data content and improved web interfaces. <em>Nucleic Acids Res.</em>, 2021 Jan 8; 49(D1):D1388–D1395 , <a href="https://doi.org/10.1093/nar/gkaa971">doi:10.1093/nar/gkaa971</a>.
</p>

<hr>
<h2 id='UFA_score_coefficients_corrector'>
Score Coefficients Corrector for MolecularFormulaAnnotationTable
</h2><span id='topic+UFA_score_coefficients_corrector'></span>

<h3>Description</h3>

<p>This function updates ranking orders of the individual MolecularFormulaAnnotationTable when score coefficients changed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_score_coefficients_corrector(input_annotated_molf_address,
output_annotated_molf_address, scoreCoefficients, number_processing_threads = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_score_coefficients_corrector_+3A_input_annotated_molf_address">input_annotated_molf_address</code></td>
<td>

<p>Address to load the individual MolecularFormulaAnnotationTables.
</p>
</td></tr>
<tr><td><code id="UFA_score_coefficients_corrector_+3A_output_annotated_molf_address">output_annotated_molf_address</code></td>
<td>

<p>Address to save the individual MolecularFormulaAnnotationTables.
</p>
</td></tr>
<tr><td><code id="UFA_score_coefficients_corrector_+3A_scorecoefficients">scoreCoefficients</code></td>
<td>

<p>A vector of five numbers representing coefficients of the identification score function.
</p>
</td></tr>
<tr><td><code id="UFA_score_coefficients_corrector_+3A_number_processing_threads">number_processing_threads</code></td>
<td>

<p>Number of processing threads for multi-threaded computations.
</p>
</td></tr>
</table>

<hr>
<h2 id='UFA_score_function_optimization'>
UFA Score Coefficient Workflow
</h2><span id='topic+UFA_score_function_optimization'></span>

<h3>Description</h3>

<p>This function runs the score optimization workflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_score_function_optimization(PARAM_ScoreFunc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_score_function_optimization_+3A_param_scorefunc">PARAM_ScoreFunc</code></td>
<td>

<p>PARAM_ScoreFunc from the 'UFA_score_function_optimization_xlsxAnalyzer' module
</p>
</td></tr>
</table>

<hr>
<h2 id='UFA_score_function_optimization_xlsxAnalyzer'>
UFA Score Optimization xlsx Analyzer
</h2><span id='topic+UFA_score_function_optimization_xlsxAnalyzer'></span>

<h3>Description</h3>

<p>This function evaluates the parameter spreadsheet for score coefficients optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_score_function_optimization_xlsxAnalyzer(spreadsheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_score_function_optimization_xlsxAnalyzer_+3A_spreadsheet">spreadsheet</code></td>
<td>

<p>The parameter spreadsheet in the .xlsx format.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a processed parameter to feed the 'UFA_score_function_optimization' function.
</p>

<hr>
<h2 id='UFA_workflow'>
UFA Workflow
</h2><span id='topic+UFA_workflow'></span>

<h3>Description</h3>

<p>This function executes the UFA workflow in order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_workflow(spreadsheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_workflow_+3A_spreadsheet">spreadsheet</code></td>
<td>

<p>UFA spreadsheet
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function organizes the UFA file processing for better performance using the template spreadsheet.
</p>

<hr>
<h2 id='UFA_xlsxAnalyzer'>
UFA xlsx Analyzer
</h2><span id='topic+UFA_xlsxAnalyzer'></span>

<h3>Description</h3>

<p>This function processes the spreadsheet of the UFA parameters to ensure the parameter inputs are consistent with the requirements of the IDSL.UFA pipeline.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UFA_xlsxAnalyzer(spreadsheet)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UFA_xlsxAnalyzer_+3A_spreadsheet">spreadsheet</code></td>
<td>

<p>UFA spreadsheet
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns the UFA parameters to feed the UFA_workflow function.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
