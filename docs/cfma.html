<!DOCTYPE html><html><head><title>Help for package cfma</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cfma}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cfma-package'>
<p>Causal Functional Mediation Analysis</p></a></li>
<li><a href='#env.concurrent'><p> Simulated data from the concurrent mediation model</p></a></li>
<li><a href='#env.historical'><p> Simulated data from the historical influence mediation model</p></a></li>
<li><a href='#FMA.concurrent'><p> Functional mediation analysis under concurrent regression model</p></a></li>
<li><a href='#FMA.concurrent.boot'><p> Functional mediation analysis under concurrent regression model with point-wise bootstrap confidence interval</p></a></li>
<li><a href='#FMA.concurrent.CV'><p> Functional mediation analysis under concurrent regression model</p></a></li>
<li><a href='#FMA.historical'><p> Functional mediation analysis under historical influence model</p></a></li>
<li><a href='#FMA.historical.boot'><p> Functional mediation analysis under historical influence regression model with point-wise bootstrap confidence interval</p></a></li>
<li><a href='#FMA.historical.CV'><p> Functional mediation analysis under historical influence model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Functional Mediation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-05-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Yi Zhao &lt;zhaoyi1026@gmail.com&gt;, Xi Luo &lt;xi.rossi.luo@gmail.com&gt;, Martin Lindquist &lt;mal2053@gmail.com&gt;, Brian Caffo &lt;bcaffo@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yi Zhao &lt;zhaoyi1026@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs causal functional mediation analysis (CFMA) for functional treatment, functional mediator, and functional outcome. This package includes two functional mediation model types: (1) a concurrent mediation model and (2) a historical influence mediation model. See Zhao et al. (2018), Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data, &lt;<a href="https://doi.org/10.48550/arXiv.1805.06923">doi:10.48550/arXiv.1805.06923</a>&gt; for details.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-05-22 14:15:59 UTC; yizhao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-05-24 12:45:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='cfma-package'>
Causal Functional Mediation Analysis
</h2><span id='topic+cfma-package'></span><span id='topic+cfma'></span>

<h3>Description</h3>

<p>cfma package performs causal functional mediation analysis (CFMA) for functional treatment, functional mediator, and functional outcome. This package includes two functional mediation model type: (1) a concurrent mediation model and (2) a historical influence mediation model.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
	Package: </td><td style="text-align: left;"> cfma </td>
</tr>
<tr>
 <td style="text-align: left;">
	Type: </td><td style="text-align: left;"> Package </td>
</tr>
<tr>
 <td style="text-align: left;">
	Version: </td><td style="text-align: left;"> 1.0 </td>
</tr>
<tr>
 <td style="text-align: left;">
	Date: </td><td style="text-align: left;"> 2018-05-16 </td>
</tr>
<tr>
 <td style="text-align: left;">
	License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Yi Zhao &lt;zhaoyi1026@gmail.com&gt; and Xi Luo &lt;xi.rossi.luo@gmail.com&gt; and Martin Lindquist &lt;mal2053@gmail.com&gt; and Brian Caffo &lt;bcaffo@gmail.com&gt;
</p>
<p>Maintainer: Yi Zhao &lt;zhaoyi1026@gmail.com&gt;
</p>

<hr>
<h2 id='env.concurrent'> Simulated data from the concurrent mediation model
</h2><span id='topic+env.concurrent'></span>

<h3>Description</h3>

<p> &quot;env.concurrent&quot; is an R environment containing the data generated from a concurrent mediation model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("env.concurrent")</code></pre>


<h3>Format</h3>

<p>An R environment
</p>

<dl>
<dt><code>Z</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, treatment trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>M</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, mediator trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>Y</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, outcome trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a length <code class="reqn">T</code> vector model coefficient.</p>
</dd>
<dt><code>beta</code></dt><dd><p>a length <code class="reqn">T</code> vector model coefficient.</p>
</dd>
<dt><code>gamma</code></dt><dd><p>a length <code class="reqn">T</code> vector model coefficient.</p>
</dd>
</dl>



<h3>Details</h3>

<p> The data was generated from the concurrent mediation model
</p>
<p style="text-align: center;"><code class="reqn">M(t)=Z(t)\alpha(t)+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">R(t)=Z(t)\gamma(t)+M(t)\beta(t)+\epsilon_{2}(t).</code>
</p>

<p><code class="reqn">Z(t)</code> is the convolution of hemodynamic response function (HRF) and event onsets. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(env.concurrent)
Z&lt;-get("Z",env.concurrent)
M&lt;-get("M",env.concurrent)
Y&lt;-get("Y",env.concurrent)
</code></pre>

<hr>
<h2 id='env.historical'> Simulated data from the historical influence mediation model
</h2><span id='topic+env.historical'></span>

<h3>Description</h3>

<p> &quot;env.historical&quot; is an R environment containing the data generated from a historical influence mediation model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("env.historical")</code></pre>


<h3>Format</h3>

<p>An R environment
</p>

<dl>
<dt><code>Z</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, treatment trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>M</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, mediator trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>Y</code></dt><dd><p>a <code class="reqn">n\times T</code> data matrix, outcome trajectory of <code class="reqn">n</code> subjects for <code class="reqn">T</code> time points.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>a <code class="reqn">T\times T</code> matrix model coefficient.</p>
</dd>
<dt><code>beta</code></dt><dd><p>a <code class="reqn">T\times T</code> matrix model coefficient.</p>
</dd>
<dt><code>gamma</code></dt><dd><p>a <code class="reqn">T\times T</code> matrix model coefficient.</p>
</dd>
</dl>



<h3>Details</h3>

<p> The data was generated from the historical influence mediation model
</p>
<p style="text-align: center;"><code class="reqn">M(t)=\int_{\Omega_{t}^{1}}Z(s)\alpha(s,t)ds+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=\int_{\Omega_{t}^{2}}Z(s)\gamma(s,t)ds+\int_{\Omega_{t}^{3}}M(s)\beta(s,t)ds+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(s,t)</code>, <code class="reqn">\beta(s,t)</code>, <code class="reqn">\gamma(s,t)</code> are coefficient curves; <code class="reqn">\Omega_{t}^{j}=[(t-\delta_{j})\vee 0,t]</code> for <code class="reqn">j=1,2,3</code>. <code class="reqn">Z(t)</code> is the convolution of hemodynamic response function (HRF) and event onsets. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(env.historical)
Z&lt;-get("Z",env.historical)
M&lt;-get("M",env.historical)
Y&lt;-get("Y",env.historical)
</code></pre>

<hr>
<h2 id='FMA.concurrent'> Functional mediation analysis under concurrent regression model
</h2><span id='topic+FMA.concurrent'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the concurrent model with given tuning parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.concurrent(Z, M, Y, intercept = TRUE, basis = NULL, Ld2.basis = NULL, 
    basis.type = c("fourier"), nbasis = 3, timeinv = c(0, 1), timegrids = NULL, 
    lambda.m = 0.01, lambda.y = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.concurrent_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_basis">basis</code></td>
<td>
<p> a data matrix. Basis function used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_ld2.basis">Ld2.basis</code></td>
<td>
<p> a data matrix. The second derivative of the basis function. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_nbasis">nbasis</code></td>
<td>
<p> an integer, the number of basis function included. If <code>basis</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_lambda.m">lambda.m</code></td>
<td>
<p> a numeric value of the tuning parameter in the mediator model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent_+3A_lambda.y">lambda.y</code></td>
<td>
<p> a numeric value of the tuning parameter in the outcome model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The concurrent mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=Z(t)\alpha(t)+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=Z(t)\gamma(t)+M(t)\beta(t)+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(t)</code>, <code class="reqn">\beta(t)</code>, <code class="reqn">\gamma(t)</code> are coefficient curves. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr><td><code>basis</code></td>
<td>
<p>the basis functions used in the analysis.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>a list of output for the mediator model
</p>
<p><code>coefficient</code>the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>M</code>
</p>
<p><code>lambda</code>: <code class="reqn">\lambda</code> value
</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a list of output for the outcome model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>Y</code>
</p>
<p><code>lambda</code>: <code class="reqn">\lambda</code> value
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for the indirect effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>coefficients</code>: the coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for the direct effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>coefficients</code>: the coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Concurrent functional mediation model
data(env.concurrent)
Z&lt;-get("Z",env.concurrent)
M&lt;-get("M",env.concurrent)
Y&lt;-get("Y",env.concurrent)

# consider Fourier basis
fit&lt;-FMA.concurrent(Z,M,Y,intercept=FALSE,timeinv=c(0,300))

# estimate of alpha
plot(fit$M$curve[1,],type="l",lwd=5)
lines(get("alpha",env.concurrent),lty=2,lwd=2,col=2)

# estimate of gamma
plot(fit$Y$curve[1,],type="l",lwd=5)
lines(get("gamma",env.concurrent),lty=2,lwd=2,col=2)

# estimate of beta
plot(fit$Y$curve[2,],type="l",lwd=5)
lines(get("beta",env.concurrent),lty=2,lwd=2,col=2)

# estimate of causal curves
plot(fit$IE$curve,type="l",lwd=5)
plot(fit$DE$curve,type="l",lwd=5)
##################################################
</code></pre>

<hr>
<h2 id='FMA.concurrent.boot'> Functional mediation analysis under concurrent regression model with point-wise bootstrap confidence interval
</h2><span id='topic+FMA.concurrent.boot'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the concurrent model with given tuning parameter. Point-wise confidence bands are obtained from bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.concurrent.boot(Z, M, Y, intercept = TRUE, basis = NULL, Ld2.basis = NULL, 
    basis.type = c("fourier"), nbasis = 3, timeinv = c(0, 1), timegrids = NULL, 
    lambda.m = 0.01, lambda.y = 0.01, sims = 1000, boot = TRUE, 
    boot.ci.type = c("bca", "perc"), conf.level = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.concurrent.boot_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_basis">basis</code></td>
<td>
<p> a data matrix. Basis function used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_ld2.basis">Ld2.basis</code></td>
<td>
<p> a data matrix. The second derivative of the basis function. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_nbasis">nbasis</code></td>
<td>
<p> an integer, the number of basis function included. If <code>basis</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_lambda.m">lambda.m</code></td>
<td>
<p> a numeric value of the tuning parameter in the mediator model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_lambda.y">lambda.y</code></td>
<td>
<p> a numeric value of the tuning parameter in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_sims">sims</code></td>
<td>
<p> an integer indicating the number of simulations for inference.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_boot">boot</code></td>
<td>
<p> a logical value, indicating whether or not bootstrap should be used. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_boot.ci.type">boot.ci.type</code></td>
<td>
<p> a character of confidence interval method. <code>boot.ci.type = "bca"</code> bias corrected confidence interval; <code>boot.ci.type = "perc"</code> percentile confidence interval.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_conf.level">conf.level</code></td>
<td>
<p> a number of significance level. Default is 0.95.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.boot_+3A_verbose">verbose</code></td>
<td>
<p> a logical value, indicating whether print out bootstrap replications.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The concurrent mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=Z(t)\alpha(t)+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=Z(t)\gamma(t)+M(t)\beta(t)+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(t)</code>, <code class="reqn">\beta(t)</code>, <code class="reqn">\gamma(t)</code> are coefficient curves. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>a list of output for <code class="reqn">\alpha</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>: a list of output for <code class="reqn">\gamma</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>a list of output for <code class="reqn">\beta</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for indirect effect estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for direct effect estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Concurrent functional mediation model
data(env.concurrent)
Z&lt;-get("Z",env.concurrent)
M&lt;-get("M",env.concurrent)
Y&lt;-get("Y",env.concurrent)


# consider Fourier basis
fit.boot&lt;-FMA.concurrent.boot(Z,M,Y,intercept=FALSE,timeinv=c(0,300))

##################################################
</code></pre>

<hr>
<h2 id='FMA.concurrent.CV'> Functional mediation analysis under concurrent regression model
</h2><span id='topic+FMA.concurrent.CV'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the concurrent model. Tuning parameter is chosen based on cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.concurrent.CV(Z, M, Y, intercept = TRUE, basis = NULL, Ld2.basis = NULL, 
    basis.type = c("fourier"), nbasis = 3, timeinv = c(0, 1), timegrids = NULL, 
    lambda = NULL, nfolds = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.concurrent.CV_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_basis">basis</code></td>
<td>
<p> a data matrix. Basis function used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_ld2.basis">Ld2.basis</code></td>
<td>
<p> a data matrix. The second derivative of the basis function. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_nbasis">nbasis</code></td>
<td>
<p> an integer, the number of basis function included. If <code>basis</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_lambda">lambda</code></td>
<td>
<p> a numeric vector of tuning parameter values. 
</p>
</td></tr>
<tr><td><code id="FMA.concurrent.CV_+3A_nfolds">nfolds</code></td>
<td>
<p> a number gives the number of folds in cross-validation. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The concurrent mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=Z(t)\alpha(t)+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=Z(t)\gamma(t)+M(t)\beta(t)+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(t)</code>, <code class="reqn">\beta(t)</code>, <code class="reqn">\gamma(t)</code> are coefficient curves. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss. Tuning parameter <code class="reqn">\lambda</code> controls the smoothness of the estimated curves, and is chosen by cross-validation.
</p>


<h3>Value</h3>

<table>
<tr><td><code>basis</code></td>
<td>
<p>the basis functions used in the analysis.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>a list of output for the mediator model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>M</code>
</p>
<p><code>lambda</code>: the chosen <code class="reqn">\lambda</code> value
</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a list of output for the outcome model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>Y</code>
</p>
<p><code>lambda</code>: the chosen <code class="reqn">\lambda</code> value
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for the indirect effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>coefficients</code>: the coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for the direct effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>coefficients</code>: the coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Concurrent functional mediation model
data(env.concurrent)
Z&lt;-get("Z",env.concurrent)
M&lt;-get("M",env.concurrent)
Y&lt;-get("Y",env.concurrent)


# consider Fourier basis
fit&lt;-FMA.concurrent.CV(Z,M,Y,intercept=FALSE,timeinv=c(0,300))

# estimate of alpha
plot(fit$M$curve[1,],type="l",lwd=5)
lines(get("alpha",env.concurrent),lty=2,lwd=2,col=2)

# estimate of gamma
plot(fit$Y$curve[1,],type="l",lwd=5)
lines(get("gamma",env.concurrent),lty=2,lwd=2,col=2)

# estimate of beta
plot(fit$Y$curve[2,],type="l",lwd=5)
lines(get("beta",env.concurrent),lty=2,lwd=2,col=2)

# estimate of causal curves
plot(fit$IE$curve,type="l",lwd=5)
plot(fit$DE$curve,type="l",lwd=5)

##################################################
</code></pre>

<hr>
<h2 id='FMA.historical'> Functional mediation analysis under historical influence model
</h2><span id='topic+FMA.historical'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the historical influence model with given tuning parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.historical(Z, M, Y, delta.grid1 = 1, delta.grid2 = 1, delta.grid3 = 1, 
    intercept = TRUE, basis1 = NULL, Ld2.basis1 = NULL, basis2 = NULL, Ld2.basis2 = NULL, 
    basis.type = c("fourier"), nbasis1 = 3, nbasis2 = 3, 
    timeinv = c(0, 1), timegrids = NULL, 
    lambda1.m = 0.01, lambda2.m = 0.01, lambda1.y = 0.01, lambda2.y = 0.01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.historical_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_delta.grid1">delta.grid1</code></td>
<td>
<p> a number indicates the width of treatment-mediator time interval in the mediator model.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_delta.grid2">delta.grid2</code></td>
<td>
<p> a number indicates the width of treatment-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_delta.grid3">delta.grid3</code></td>
<td>
<p> a number indicates the width of mediator-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_basis1">basis1</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">s</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_ld2.basis1">Ld2.basis1</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">s</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_basis2">basis2</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">t</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_ld2.basis2">Ld2.basis2</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">t</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_nbasis1">nbasis1</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">s</code> domain included. If <code>basis1</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_nbasis2">nbasis2</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">t</code> domain included. If <code>basis2</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_lambda1.m">lambda1.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the mediator model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_lambda2.m">lambda2.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the mediator model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_lambda1.y">lambda1.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the outcome model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical_+3A_lambda2.y">lambda2.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the outcome model. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The historical influence mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=\int_{\Omega_{t}^{1}}Z(s)\alpha(s,t)ds+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=\int_{\Omega_{t}^{2}}Z(s)\gamma(s,t)ds+\int_{\Omega_{t}^{3}}M(s)\beta(s,t)ds+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(s,t)</code>, <code class="reqn">\beta(s,t)</code>, <code class="reqn">\gamma(s,t)</code> are coefficient curves; <code class="reqn">\Omega_{t}^{j}=[(t-\delta_{j})\vee 0,t]</code> for <code class="reqn">j=1,2,3</code>. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr><td><code>basis1</code></td>
<td>
<p>the basis functions on the <code class="reqn">s</code> domain used in the analysis.</p>
</td></tr>
<tr><td><code>basis2</code></td>
<td>
<p>the basis functions on the <code class="reqn">t</code> domain used in the analysis.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>a list of output for the mediator model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>M</code>
</p>
<p><code>lambda1</code>: the <code class="reqn">\lambda</code> value on the <code class="reqn">s</code> domain
</p>
<p><code>lambda2</code>: the <code class="reqn">\lambda</code> value on the <code class="reqn">t</code> domain
</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a list of output for the outcome model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>Y</code>
</p>
<p><code>lambda1</code>: the <code class="reqn">\lambda</code> value on the <code class="reqn">s</code> domain
</p>
<p><code>lambda2</code>: the <code class="reqn">\lambda</code> value on the <code class="reqn">t</code> domain
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for the indirect effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for the direct effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Historical influence functional mediation model
data(env.historical)
Z&lt;-get("Z",env.historical)
M&lt;-get("M",env.historical)
Y&lt;-get("Y",env.historical)

# consider Fourier basis
fit&lt;-FMA.historical(Z,M,Y,delta.grid1=3,delta.grid2=3,delta.grid3=3,
    intercept=FALSE,timeinv=c(0,300))

# estimate of causal curves
plot(fit$IE$curve,type="l",lwd=5)
plot(fit$DE$curve,type="l",lwd=5)
##################################################
</code></pre>

<hr>
<h2 id='FMA.historical.boot'> Functional mediation analysis under historical influence regression model with point-wise bootstrap confidence interval
</h2><span id='topic+FMA.historical.boot'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the historical influence model with given tuning parameter. Point-wise confidence bands are obtained from bootstrap.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.historical.boot(Z, M, Y, delta.grid1 = 1, delta.grid2 = 1, delta.grid3 = 1, 
    intercept = TRUE, basis1 = NULL, Ld2.basis1 = NULL, basis2 = NULL, Ld2.basis2 = NULL, 
    basis.type = c("fourier"), nbasis1 = 3, nbasis2 = 3, 
    timeinv = c(0, 1), timegrids = NULL, 
    lambda1.m = 0.01, lambda2.m = 0.01, lambda1.y = 0.01, lambda2.y = 0.01, 
    sims = 1000, boot = TRUE, boot.ci.type = c("bca", "perc"), 
    conf.level = 0.95, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.historical.boot_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_delta.grid1">delta.grid1</code></td>
<td>
<p> a number indicates the width of treatment-mediator time interval in the mediator model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_delta.grid2">delta.grid2</code></td>
<td>
<p> a number indicates the width of treatment-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_delta.grid3">delta.grid3</code></td>
<td>
<p> a number indicates the width of mediator-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_basis1">basis1</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">s</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_ld2.basis1">Ld2.basis1</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">s</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_basis2">basis2</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">t</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_ld2.basis2">Ld2.basis2</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">t</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_nbasis1">nbasis1</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">s</code> domain included. If <code>basis1</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_nbasis2">nbasis2</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">t</code> domain included. If <code>basis2</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_lambda1.m">lambda1.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the mediator model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_lambda2.m">lambda2.m</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the mediator model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_lambda1.y">lambda1.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain in the outcome model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_lambda2.y">lambda2.y</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain in the outcome model. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_sims">sims</code></td>
<td>
<p> an integer indicating the number of simulations for inference.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_boot">boot</code></td>
<td>
<p> a logical value, indicating whether or not bootstrap should be used. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_boot.ci.type">boot.ci.type</code></td>
<td>
<p> a character of confidence interval method. <code>boot.ci.type = "bca"</code> bias corrected confidence interval; <code>boot.ci.type = "perc"</code> percentile confidence interval.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_conf.level">conf.level</code></td>
<td>
<p> a number of significance level. Default is 0.95.
</p>
</td></tr>
<tr><td><code id="FMA.historical.boot_+3A_verbose">verbose</code></td>
<td>
<p> a logical value, indicating whether print out bootstrap replications.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The historical influence mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=\int_{\Omega_{t}^{1}}Z(s)\alpha(s,t)ds+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=\int_{\Omega_{t}^{2}}Z(s)\gamma(s,t)ds+\int_{\Omega_{t}^{3}}M(s)\beta(s,t)ds+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(s,t)</code>, <code class="reqn">\beta(s,t)</code>, <code class="reqn">\gamma(s,t)</code> are coefficient curves; <code class="reqn">\Omega_{t}^{j}=[(t-\delta_{j})\vee 0,t]</code> for <code class="reqn">j=1,2,3</code>. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>a list of output for <code class="reqn">\alpha</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>a list of output for <code class="reqn">\gamma</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>a list of output for <code class="reqn">\beta</code> estimate
</p>
<p><code>coefficients</code>: the result of the coefficient estimates corresponding to the basis function
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for indirect effect estimate
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for direct effect estimate
</p>
<p><code>curve</code>: the point-wise estimate of the coefficient curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Historical influence functional mediation model
data(env.historical)
Z&lt;-get("Z",env.historical)
M&lt;-get("M",env.historical)
Y&lt;-get("Y",env.historical)


# consider Fourier basis
fit.boot&lt;-FMA.historical.boot(Z,M,Y,delta.grid1=3,delta.grid2=3,delta.grid3=3,
    intercept=FALSE,timeinv=c(0,300))

##################################################
</code></pre>

<hr>
<h2 id='FMA.historical.CV'> Functional mediation analysis under historical influence model
</h2><span id='topic+FMA.historical.CV'></span>

<h3>Description</h3>

<p> This function performs functional mediation regression under the historical influence model. Tuning parameter is chosen based on cross-validation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FMA.historical.CV(Z, M, Y, delta.grid1 = 1, delta.grid2 = 1, delta.grid3 = 1, 
    intercept = TRUE, basis1 = NULL, Ld2.basis1 = NULL, basis2 = NULL, Ld2.basis2 = NULL, 
    basis.type = c("fourier"), nbasis1 = 3, nbasis2 = 3, 
    timeinv = c(0, 1), timegrids = NULL, lambda1 = NULL, lambda2 = NULL, nfolds = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FMA.historical.CV_+3A_z">Z</code></td>
<td>
<p> a data matrix. <code>Z</code> is the treatment trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_m">M</code></td>
<td>
<p> a data matrix. <code>M</code> is the mediator trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_y">Y</code></td>
<td>
<p> a data matrix. <code>Y</code> is the outcome trajectory in the mediation analysis. The number of rows is the number of subjects, and the number of columns is the number of measured time points.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_delta.grid1">delta.grid1</code></td>
<td>
<p> a number indicates the width of treatment-mediator time interval in the mediator model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_delta.grid2">delta.grid2</code></td>
<td>
<p> a number indicates the width of treatment-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_delta.grid3">delta.grid3</code></td>
<td>
<p> a number indicates the width of mediator-outcome time interval in the outcome model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_intercept">intercept</code></td>
<td>
<p> a logic variable. Default is <code>TRUE</code>, an intercept term is included in the regression model.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_basis1">basis1</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">s</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_ld2.basis1">Ld2.basis1</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">s</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_basis2">basis2</code></td>
<td>
<p> a data matrix. Basis function on the <code class="reqn">t</code> domain used in the functional data analysis. The number of columns is the number of basis function considered. If <code>basis = NULL</code>, Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_ld2.basis2">Ld2.basis2</code></td>
<td>
<p> a data matrix. The second derivative of the basis function on the <code class="reqn">t</code> domain. The number of columns is the number of basis function considered. If <code>Ld2.basis = NULL</code>, the second derivative of Fourier basis functions will be generated.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_basis.type">basis.type</code></td>
<td>
<p> a character of basis function type. Default is Fourier basis (<code>basis.type = "fourier"</code>).
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_nbasis1">nbasis1</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">s</code> domain included. If <code>basis1</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_nbasis2">nbasis2</code></td>
<td>
<p> an integer, the number of basis function on the <code class="reqn">t</code> domain included. If <code>basis2</code> is provided, this argument will be ignored.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_timeinv">timeinv</code></td>
<td>
<p> a numeric vector of length two, the time interval considered in the analysis. Default is (0,1).
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_timegrids">timegrids</code></td>
<td>
<p> a numeric vector of time grids of measurement. If <code>timegrids = NULL</code>, it is assumed the between measurement time interval is constant.
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_lambda1">lambda1</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">s</code> domain. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_lambda2">lambda2</code></td>
<td>
<p> a numeric vector of tuning parameter values on the <code class="reqn">t</code> domain. 
</p>
</td></tr>
<tr><td><code id="FMA.historical.CV_+3A_nfolds">nfolds</code></td>
<td>
<p> a number gives the number of folds in cross-validation. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p> The historical influence mediation model is
</p>
<p style="text-align: center;"><code class="reqn">M(t)=\int_{\Omega_{t}^{1}}Z(s)\alpha(s,t)ds+\epsilon_{1}(t),</code>
</p>

<p style="text-align: center;"><code class="reqn">Y(t)=\int_{\Omega_{t}^{2}}Z(s)\gamma(s,t)ds+\int_{\Omega_{t}^{3}}M(s)\beta(s,t)ds+\epsilon_{2}(t),</code>
</p>

<p>where <code class="reqn">\alpha(s,t)</code>, <code class="reqn">\beta(s,t)</code>, <code class="reqn">\gamma(s,t)</code> are coefficient curves; <code class="reqn">\Omega_{t}^{j}=[(t-\delta_{j})\vee 0,t]</code> for <code class="reqn">j=1,2,3</code>. The model coefficient curves are estimated by minimizing the penalized <code class="reqn">L_{2}</code>-loss. Tuning parameter <code class="reqn">\lambda</code> controls the smoothness of the estimated curves, and is chosen by cross-validation.
</p>


<h3>Value</h3>

<table>
<tr><td><code>basis1</code></td>
<td>
<p>the basis functions on the <code class="reqn">s</code> domain used in the analysis.</p>
</td></tr>
<tr><td><code>basis2</code></td>
<td>
<p>the basis functions on the <code class="reqn">t</code> domain used in the analysis.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>a list of output for the mediator model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>M</code>
</p>
<p><code>lambda1</code>: the chosen <code class="reqn">\lambda</code> value on the <code class="reqn">s</code> domain
</p>
<p><code>lambda2</code>: the chosen <code class="reqn">\lambda</code> value on the <code class="reqn">t</code> domain
</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>a list of output for the outcome model
</p>
<p><code>coefficient</code>: the estimated coefficient with respect to the basis function
</p>
<p><code>curve</code>: the estimated coefficient curve
</p>
<p><code>fitted</code>: the fitted value of <code>Y</code>
</p>
<p><code>lambda1</code>: the chosen <code class="reqn">\lambda</code> value on the <code class="reqn">s</code> domain
</p>
<p><code>lambda2</code>: the chosen <code class="reqn">\lambda</code> value on the <code class="reqn">t</code> domain
</p>
</td></tr>
<tr><td><code>IE</code></td>
<td>
<p>a list of output for the indirect effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
<tr><td><code>DE</code></td>
<td>
<p>a list of output for the direct effect comparing <code class="reqn">Z_{1}(t)=1</code> versus <code class="reqn">Z_{0}(t)=0</code>
</p>
<p><code>curve</code>: the estimated causal curve
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Yi Zhao, Johns Hopkins University, <a href="mailto:zhaoyi1026@gmail.com">zhaoyi1026@gmail.com</a>;
</p>
<p>Xi Luo, Brown University <a href="mailto:xi.rossi.luo@gmail.com">xi.rossi.luo@gmail.com</a>; 
</p>
<p>Martin Lindquist, Johns Hopkins University, <a href="mailto:mal2053@gmail.com">mal2053@gmail.com</a>; 
</p>
<p>Brian Caffo, Johns Hopkins University, <a href="mailto:bcaffo@gmail.com">bcaffo@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhao et al. (2017). <em>Functional Mediation Analysis with an Application to Functional Magnetic Resonance Imaging Data.</em> arXiv preprint arXiv:1805.06923.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##################################################
# Historical influence functional mediation model
data(env.historical)
Z&lt;-get("Z",env.historical)
M&lt;-get("M",env.historical)
Y&lt;-get("Y",env.historical)


# consider Fourier basis
fit&lt;-FMA.historical.CV(Z,M,Y,delta.grid1=3,delta.grid2=3,delta.grid3=3,
    intercept=FALSE,timeinv=c(0,300))

##################################################
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
