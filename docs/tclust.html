<!DOCTYPE html><html><head><title>Help for package tclust</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tclust}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ctlcurves'><p> Classification Trimmed Likelihood Curves</p></a></li>
<li><a href='#discr_coords'><p> Discriminant coordinates/canonical variates of tclust objects</p></a></li>
<li><a href='#DiscrFact'><p> Discriminant Factor Analysis for tclust Objects</p></a></li>
<li><a href='#geyser2'><p> Old Faithful Geyser Data</p></a></li>
<li><a href='#M5data'><p> Mixture M5 Data</p></a></li>
<li><a href='#plot.ctlcurves'><p> plot Method for ctlcurves Objects</p></a></li>
<li><a href='#plot.DiscrFact'><p> plot Method for DiscrFact Objects</p></a></li>
<li><a href='#plot.tclust'><p> plot Method for tclust Objects</p></a></li>
<li><a href='#summary.DiscrFact'><p> summary Method for DiscrFact Objects</p></a></li>
<li><a href='#swissbank'><p> SwissBankNotes Data</p></a></li>
<li><a href='#tclust'><p> General Trimming Approach to Robust Cluster Analysis</p></a></li>
<li><a href='#tkmeans'><p> Trimmed k-means Cluster Analysis</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5-6</td>
</tr>
<tr>
<td>VersionNote:</td>
<td>Released 1.5-5 on 2023-12-07 on CRAN</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Trimmed Clustering</td>
</tr>
<tr>
<td>Author:</td>
<td>Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Valentin Todorov &lt;valentin.todorov@chello.at&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for robust trimmed clustering. The methods are described in Garcia-Escudero (2008) &lt;<a href="https://doi.org/10.1214%2F07-AOS515">doi:10.1214/07-AOS515</a>&gt;, Fritz et al. (2012) &lt;<a href="https://doi.org/10.18637%2Fjss.v047.i12">doi:10.18637/jss.v047.i12</a>&gt;, Garcia-Escudero et al. (2011)  &lt;<a href="https://doi.org/10.1007%2Fs11222-010-9194-z">doi:10.1007/s11222-010-9194-z</a>&gt; and others.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.6.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mclust, cluster, mvtnorm, sn</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/valentint/tclust">https://github.com/valentint/tclust</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/valentint/tclust/issues">https://github.com/valentint/tclust/issues</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-07 07:09:56 UTC; valen</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ctlcurves'> Classification Trimmed Likelihood Curves </h2><span id='topic+ctlcurves'></span><span id='topic+print.ctlcurves'></span>

<h3>Description</h3>

<p>The function applies <code><a href="#topic+tclust">tclust</a></code> several times on a given dataset while parameters <code>alpha</code> and <code>k</code>
are altered. The resulting object gives an idea of the optimal trimming level and number of clusters considering a particular dataset. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctlcurves (x, k = 1:4, alpha = seq (0, 0.2, len = 6), 
           restr.fact = 50, trace = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctlcurves_+3A_x">x</code></td>
<td>
<p> A matrix or data frame of dimension <code>n</code> x <code>p</code>, containing the observations (row-wise). </p>
</td></tr>
<tr><td><code id="ctlcurves_+3A_k">k</code></td>
<td>
<p> A vector of cluster numbers to be checked. By default cluster numbers from 1 to 5 are examined. </p>
</td></tr>
<tr><td><code id="ctlcurves_+3A_alpha">alpha</code></td>
<td>
<p> A vector containing the alpha levels to be checked. By default alpha levels from 0 to 0.2 (continuously increased by 0.01), are checked. </p>
</td></tr>





<tr><td><code id="ctlcurves_+3A_restr.fact">restr.fact</code></td>
<td>
<p> The restriction factor passed to <code><a href="#topic+tclust">tclust</a></code>. </p>
</td></tr>
<tr><td><code id="ctlcurves_+3A_...">...</code></td>
<td>
<p> Further arguments (as e.g. <code>restr</code>), passed to <code><a href="#topic+tclust">tclust</a></code>. </p>
</td></tr>
<tr><td><code id="ctlcurves_+3A_trace">trace</code></td>
<td>
<p> Defines the tracing level, which is set to <code>1</code> by default. Tracing level <code>2</code> gives additional information on the current iteration. </p>
</td></tr>

</table>


<h3>Details</h3>

<p> These curves show the values of the trimmed classification (log-)likelihoods when altering the trimming proportion <code>alpha</code> and the number of clusters <code>k</code>. The careful examination of these curves provides valuable information for choosing these parameters in a clustering problem. For instance, an appropriate <code>k</code> to be chosen is one that we do not observe a clear increase in the trimmed classification likelihood curve for k with respect to the k+1 curve for almost all the range of alpha values. Moreover, an appropriate choice of parameter alpha may be derived by determining where an initial fast increase of the trimmed classification likelihood curve stops for the final chosen k. A more detailed explanation can be found in García-Escudero et al. (2010). </p>


<h3>Value</h3>

<p> The function returns an S3 object of type <code>ctlcurves</code> with components: 
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p> A list containing all the parameters passed to this function. </p>
</td></tr>
<tr><td><code>obj</code></td>
<td>
<p> An array containing the objective functions values of each computed cluster-solution. </p>
</td></tr>
<tr><td><code>min.weights</code></td>
<td>
<p> An array containing the minimum cluster weight of each computed cluster-solution. </p>
</td></tr>


</table>
<p>So far there is no output available for <code>print.ctlcurves</code>. Use <code>plot</code> on an <code>ctlcurves</code> object for a graphical interpretation of it.
</p>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

 

<p>García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2010), &quot;Exploring the number of groups in robust model-based clustering.&quot; Statistics and Computing, (Forthcoming). <br />
Preprint available at www.eio.uva.es/infor/personas/langel.html.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.ctlcurves">plot.ctlcurves</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#--- EXAMPLE 1 ------------------------------------------

sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(108, cen * 0,   sig),
	       mvtnorm::rmvnorm(162, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(30, cen * 2.5, sig * 50)
)

ctl &lt;- ctlcurves (x, k = 1:4)

  ##  ctl-curves 
plot (ctl)  ##  --&gt; selecting k = 2, alpha = 0.08

  ##  the selected model 
plot (tclust (x, k = 2, alpha = 0.08, restr.fact = 7))

#--- EXAMPLE 2 ------------------------------------------

data (geyser2)
ctl &lt;- ctlcurves (geyser2, k = 1:5)

  ##  ctl-curves 
plot (ctl)  ##  --&gt; selecting k = 3, alpha = 0.08

  ##  the selected model
plot (tclust (geyser2, k = 3, alpha = 0.08, restr.fact = 5))


#--- EXAMPLE 3 ------------------------------------------

data (swissbank)
ctl &lt;- ctlcurves (swissbank, k = 1:5, alpha = seq (0, 0.3, by = 0.025))

  ##  ctl-curves 
plot (ctl)  ##  --&gt; selecting k = 2, alpha = 0.1

  ##  the selected model
plot (tclust (swissbank, k = 2, alpha = 0.1, restr.fact = 50))

## End(Not run)

</code></pre>

<hr>
<h2 id='discr_coords'> Discriminant coordinates/canonical variates of tclust objects </h2><span id='topic+discr_coords'></span>

<h3>Description</h3>

 
<p>Computes the two first discriminant coordinates (canonical coordinates) directly from a <code>tclust</code> object to obtain a graphical representations of cluster solutions in higher dimensional (p &gt; 2) cases. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'> discr_coords(x, equal.weights)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discr_coords_+3A_x">x</code></td>
<td>
<p> A <code>tclust</code> object. </p>
</td></tr>
<tr><td><code id="discr_coords_+3A_equal.weights">equal.weights</code></td>
<td>
<p> A logical value, controlling whether the clusters should be considered as equal-sized (<code>TRUE</code>) when combining their covariance structures, or if their actual size shall be considered (<code>FALSE</code>). By default value <code>x$par$equal.weights</code> is assumed</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>The functionality of <code>discr_coords</code> is directly derived from <code>discrcoord</code> as implemented in the package &quot;fpc&quot; by Christian Hennig. It has been adopted in order to directly use the covariance information contained in the <code>tclust</code>-object. The function fails, if &quot;<code>store.x = FALSE</code>&quot; is specified in <code><a href="#topic+tclust">tclust</a></code>, because the original data matrix is required here.
</p>


<h3>Value</h3>

<p> A two-dimensional matrix, containing the canonical coordinates of all observations given by the <code>tclust</code>-object. </p>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

<p> Hennig, C. and Christlieb, N. (2002), &quot;Validating visual clusters in large datasets: fixed point clusters of spectral features.&quot;, Computational Statistics and Data Analysis Vol.40, 723-739. </p>

<hr>
<h2 id='DiscrFact'> Discriminant Factor Analysis for tclust Objects</h2><span id='topic+DiscrFact'></span><span id='topic+print.DiscrFact'></span>

<h3>Description</h3>

<p> Analyzes a <code>tclust</code>-object by calculating discriminant factors and comparing the quality of the actual cluster assignments and the second best possible assignment for each observation. Discriminant factors, measuring the strength of the &quot;trimming&quot; decision may also be defined. 
Cluster assignments of observations with large discriminant factors are considered as &quot;doubtful&quot; decisions. Silhouette plots give a graphical overview of the discriminant factors distribution (see <code><a href="#topic+plot.DiscrFact">plot.DiscrFact</a></code>). More details can be found in García-Escudero et al. (2010).</p>


<h3>Usage</h3>

<pre><code class='language-R'>DiscrFact(x, threshold = 1/10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DiscrFact_+3A_x">x</code></td>
<td>
<p> A <code>tclust</code> object. </p>
</td></tr>
<tr><td><code id="DiscrFact_+3A_threshold">threshold</code></td>
<td>
 
<p>A cluster assignment or a trimming decision for an observation with a discriminant factor larger than <code>log(threshold)</code> is considered as a &quot;doubtful&quot; decision. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function compares the actual (best) assignment of each observation to its second best possible assignment. This comparison is based on the discriminant factors of each observation, which are calculated here. If the discriminant factor of an observation is larger than a given level (<code>log (threshold)</code>), the observation is considered as &quot;doubtfully&quot; assigned to a cluster. More information is shown when <a href="#topic+plot.DiscrFact">plotting</a> the returned <code>DiscrFact</code> object.
</p>


<h3>Value</h3>

<p>The function returns an S3 object of type <code>DiscrFact</code> containing the following components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p> A <code>tclust</code> object. </p>
</td></tr>
<tr><td><code>ylimmin</code></td>
<td>
<p> A minimum y-limit calculated for plotting purposes. </p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p> The actual cluster assignment. </p>
</td></tr>
<tr><td><code>ind2</code></td>
<td>
<p> The second most likely cluster assignment for each observation. </p>
</td></tr>
<tr><td><code>disc</code></td>
<td>
<p> The (weighted) likelihood of the actual cluster assignment of each observation. </p>
</td></tr>
<tr><td><code>disc2</code></td>
<td>
<p> The (weighted) likelihood of the second best cluster assignment of each observation. </p>
</td></tr>
<tr><td><code>assignfact</code></td>
<td>
<p> The factor <code>log (disc/disc2)</code>. </p>
</td></tr>
<tr><td><code>threshold</code></td>
<td>
<p> The threshold used for deciding whether <code>assignfact</code> indicates a &quot;doubtful&quot; assignment. </p>
</td></tr>
<tr><td><code>mean.DiscrFact</code></td>
<td>
<p> A vector of length <code>k + 1</code> containing the mean discriminant factors for each cluster (including the outliers). </p>
</td></tr>
</table>


<h3>Author(s)</h3>

 
<p>Agustin Mayo-Iscar, Luis Angel García-Escudero, Heinrich Fritz 
</p>


<h3>References</h3>

 
<p>García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2011), 
&quot;Exploring the number of groups in robust model-based clustering.&quot; <em>Statistics and Computing</em>, <b>21</b> 
pp. 585-599, &lt;doi:10.1007/s11222-010-9194-z&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.DiscrFact">plot.DiscrFact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
	       mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
)
clus.1 &lt;- tclust (x, k = 2, alpha = 0.1, restr.fact = 12)

clus.2 &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact = 1)
  ##  restr.fact and k are chosen improperly for pointing out the 
  ##    difference in the plot of DiscrFact

dsc.1 &lt;- DiscrFact (clus.1)
plot(dsc.1)

dsc.2 &lt;- DiscrFact (clus.2)
plot (dsc.2)

</code></pre>

<hr>
<h2 id='geyser2'> Old Faithful Geyser Data </h2><span id='topic+geyser2'></span>

<h3>Description</h3>

 
<p>A bivariate data set obtained from the Old Faithful Geyser, containing the eruption length and the length of the previous eruption for 271 eruptions of this geyser in minutes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(geyser2)</code></pre>


<h3>Format</h3>


<dl>
<dt><code>Eruption length</code></dt><dd><p> The eruption length in minutes. </p>
</dd>
<dt><code>Previous eruption length</code></dt><dd><p> The length of the previous eruption in minutes. </p>
</dd>
</dl>



<h3>Source</h3>

<p>This particular data structure can be obtained by applying the following code
to the &quot;Old Faithful Geyser&quot; (<code>faithful</code> data set (Härdle 1991) in the 
package <code>datasets</code>):
<br />
<code>f1 &lt;- faithful[,1]</code><br />
<code>geyser2 &lt;- cbind (f1[-length(f1)], f1[-1])</code><br />
<code>colnames (geyser2) &lt;- c("Eruption length",</code><br />
<code>                      "Previous eruption length")</code>
</p>


<h3>References</h3>

<p>García-Escudero, L.A.; Gordaliza, A. (1999). &quot;Robustness properties of k-means and trimmed k-means&quot;. Journal of the American Statistical Assoc., Vol.94, No.447, 956-969.<br />
Härdle, W. (1991). &quot;Smoothing Techniques with Implementation in S.&quot;, New York: Springer.
</p>

<hr>
<h2 id='M5data'> Mixture M5 Data </h2><span id='topic+M5data'></span>

<h3>Description</h3>

 
<p>A bivariate data set obtained from three normal bivariate distributions with different scales and proportions 1:2:2. One of the components is very overlapped with another one. A 10% background noise is added uniformly distributed in a rectangle containing the three normal components and not very overlapped with the three mixture components. A precise description of the M5 data set can be found in García-Escudero et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(M5data)</code></pre>


<h3>Format</h3>

<p>The first two columns are the two variables. The last column is the true classification vector where symbol &quot;0&quot; stands for the contaminating data points.
</p>


<h3>Source</h3>

<p> García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2008), &quot;A General Trimming Approach to Robust Cluster Analysis&quot;. Annals of Statistics, Vol.36, pp. 1324-1345. Technical report available at http://www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf </p>

<hr>
<h2 id='plot.ctlcurves'> plot Method for ctlcurves Objects </h2><span id='topic+plot.ctlcurves'></span>

<h3>Description</h3>

<p> The <code>plot</code> method for class <code>ctlcurves</code>: This function plots a <code>ctlcurves</code> object, comparing the target functions values with different values of parameter <code>restr.fact</code>.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ctlcurves'
 plot(x, what = c ("obj", "min.weights", "doubtful"),
         main, xlab, ylab, xlim, ylim, col, lty = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.ctlcurves_+3A_x">x</code></td>
<td>
<p> The ctlcurves object to be printed. </p>
</td></tr>
<tr><td><code id="plot.ctlcurves_+3A_what">what</code></td>
<td>
<p>A string indicating which type of plot shall be drawn. See the details section for more information.</p>
</td></tr>





<tr><td><code id="plot.ctlcurves_+3A_main">main</code></td>
<td>
<p> A character-string containing the title of the plot. </p>
</td></tr>
<tr><td><code id="plot.ctlcurves_+3A_xlab">xlab</code>, <code id="plot.ctlcurves_+3A_ylab">ylab</code>, <code id="plot.ctlcurves_+3A_xlim">xlim</code>, <code id="plot.ctlcurves_+3A_ylim">ylim</code></td>
<td>
<p> Arguments passed to <code>plot()</code>. </p>
</td></tr>


<tr><td><code id="plot.ctlcurves_+3A_col">col</code></td>
<td>
<p> A single value or vector of line colors passed to <code><a href="graphics.html#topic+lines">lines</a></code>. </p>
</td></tr>
<tr><td><code id="plot.ctlcurves_+3A_lty">lty</code></td>
<td>
<p> A single value or vector of line types passed to <code><a href="graphics.html#topic+lines">lines</a></code>. </p>
</td></tr>
<tr><td><code id="plot.ctlcurves_+3A_...">...</code></td>
<td>
<p> Arguments to be passed to or from other methods. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> These curves show the values of the trimmed classification 
(log-)likelihoods when altering the trimming proportion <code>alpha</code>
and the number of clusters <code>k</code>.
The careful examination of these curves provides valuable 
information for choosing these parameters in a clustering problem.
For instance, an appropriate <code>k</code> to be chosen is one that we do
not observe a clear increase in the trimmed classification likelihood
curve for k with respect to the k+1 curve for almost all the range of
alpha values. Moreover, an appropriate choice of parameter alpha may
be derived by determining where an initial fast increase of the
trimmed classification likelihood curve stops for the final chosen k.
A more detailed explanation can be found in García-Escudero et al. (2010).
</p>
<p>This function implements a series of plots, which display characteristic values of the each model, computed with different values for <code>k</code> and <code>alpha</code>.
The plot type is selected by setting argument <code>what</code> to one of the following values:
</p>

<dl>
<dt><code>"obj"</code></dt><dd><p>Objective function values.</p>
</dd>











<dt><code>"min.weights"</code></dt><dd><p>The minimum cluster weight found for each computed model.
This plot is intended to spot spurious clusters, which in 
general yield quite small weights.
</p>
</dd>
<dt><code>"doubtful"</code></dt><dd><p>The number of &quot;doubtful&quot; decisions identified by 
<code><a href="#topic+DiscrFact">DiscrFact</a></code>. </p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

 

<p>García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2010), &quot;Exploring the number of groups in robust model-based clustering.&quot; Statistics and Computing, (Forthcoming). <br />
Preprint available at www.eio.uva.es/infor/personas/langel.html.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(108, cen * 0,   sig),
	       mvtnorm::rmvnorm(162, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(30, cen * 2.5, sig * 50)
)

ctl &lt;- ctlcurves(x, k = 1:4)
plot(ctl)

</code></pre>

<hr>
<h2 id='plot.DiscrFact'> plot Method for DiscrFact Objects </h2><span id='topic+plot.DiscrFact'></span><span id='topic+plot_DiscrFact_p2'></span><span id='topic+plot_DiscrFact_p3'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for class <code>DiscrFact</code>: Next to a plot of the <code>tclust</code> object which has been used for creating the <code>DiscrFact</code> object, a silhouette plot indicates the presence of groups with a large amount of doubtfully assigned observations. A third plot similar to the standard <code>tclust</code> plot serves to highlight the identified doubtful observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscrFact'
 plot(x, enum.plots = FALSE, ...)
plot_DiscrFact_p2 (x, xlab = "Discriminant Factor", 
                   ylab = "Clusters", main, xlim, 
                   print.Discr = TRUE, main.pre, ...)
                  
                  
                  
plot_DiscrFact_p3 (x, main = "Doubtful Assignments", col, pch, 
                   col.nodoubt = grey (0.8), by.cluster = FALSE, 
                   ...)
                   

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.DiscrFact_+3A_x">x</code></td>
<td>
<p> An object of class &quot;<code>DiscrFact</code>&quot; as from <code>DiscrFact ()</code>. </p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_enum.plots">enum.plots</code></td>
<td>
<p> A logical value indicating whether the plots shall be enumerated in their title (&quot;(a)&quot;, &quot;(b)&quot;, &quot;(c)&quot;). </p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_xlab">xlab</code>, <code id="plot.DiscrFact_+3A_ylab">ylab</code>, <code id="plot.DiscrFact_+3A_xlim">xlim</code></td>
<td>
<p> Arguments passed to funcion <code><a href="#topic+plot.tclust">plot.tclust</a></code>. </p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_main">main</code></td>
<td>
<p> Argument passed to funcion <code>plot()</code>. </p>
</td></tr>

<tr><td><code id="plot.DiscrFact_+3A_print.discr">print.Discr</code></td>
<td>
<p> A logical value indicating whether each clusters mean discriminant factor shall be plotted </p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_main.pre">main.pre</code></td>
<td>
<p>An optional string which is appended to the plot's caption.</p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_pch">pch</code>, <code id="plot.DiscrFact_+3A_col">col</code></td>
<td>
<p>Arguments passed to function <code>plot()</code>.</p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_col.nodoubt">col.nodoubt</code></td>
<td>
<p>Color of all observations not considered as to be assigned doubtfully.</p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_by.cluster">by.cluster</code></td>
<td>
<p>Logical value indicating whether parameters <code>pch</code> and <code>col</code> refer to observations (<code>FALSE</code>) or clusters (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="plot.DiscrFact_+3A_...">...</code></td>
<td>
<p> Arguments to be passed to or from other methods. </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>plot.DiscrFact.p2</code> displays a silhouette plot based on the discriminant factors of the observations. A solution with many large discriminant factors is not reliable. Such clusters can be identified with this silhouette plot. 
Thus <code>plot.DiscrFact.p3</code> displays the dataset, highlighting observations with discriminant factors greater than the given threshold. Function <code>plot.DiscrFact</code> combines the standard plot of a <code>tclust</code> object, and the two plots introduced here.
</p>


<h3>Value</h3>

<p> No return value is provided.</p>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel García Escudero, Heinrich Fritz </p>


<h3>References</h3>



<p>García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2010), &quot;Exploring the number of groups in robust model-based clustering.&quot; Statistics and Computing, (Forthcoming). <br />
Preprint available at www.eio.uva.es/infor/personas/langel.html.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
	       mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
)

clus.1 &lt;- tclust (x, k = 2, alpha=0.1, restr.fact=12)
clus.2 &lt;- tclust (x, k = 3, alpha=0.1, restr.fact=1)

dsc.1 &lt;- DiscrFact (clus.1)
plot(dsc.1)

dsc.2 &lt;- DiscrFact (clus.2)
plot (dsc.2)

dev.off ()
plot_DiscrFact_p2 (dsc.1)
plot_DiscrFact_p3 (dsc.2)
</code></pre>

<hr>
<h2 id='plot.tclust'> plot Method for tclust Objects </h2><span id='topic+plot.tclust'></span><span id='topic+plot.tkmeans'></span>

<h3>Description</h3>

<p>The <code>plot</code> method for classes <code>tclust</code> and <code>tkmeans</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tclust'
 plot(x, ...)
## S3 method for class 'tkmeans'
 plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tclust_+3A_x">x</code></td>
<td>

<p>The <code>tclust</code> or <code>tkmeans</code> object to be displayed.
</p>
</td></tr>
<tr><td><code id="plot.tclust_+3A_...">...</code></td>
<td>

<p>Further (optional) arguments which specify the details of the 
resulting plot (see section &quot;Further Arguments&quot;).
</p>
</td></tr>
</table>


<h3>Details</h3>







<p>One and two dimensional structures are treated separately
(e.g. tolerance intervals/ellipses are displayed).
Higher dimensional structures are displayed by plotting the two first Fisher's
canonical coordinates (evaluated by <code><a href="#topic+discr_coords">discr_coords</a></code>)
and derived from the final cluster assignments (trimmed observations are not
taken into account). <code>plot.tclust.Nd</code> can be called with one or
two-dimensional <code>tclust</code>-objects too.
The function fails, if &quot;<code>store.x = FALSE</code>&quot; is specified in
<code><a href="#topic+tclust">tclust</a></code>, because the original data matrix is required
here.
</p>


<h3>Further Arguments</h3>


<dl>
<dt><code>xlab, ylab, xlim, ylim, pch, col</code></dt><dd>
<p>Arguments passed to <code>plot()</code>.
</p>
</dd>
<dt><code>main</code></dt><dd>
<p>The title of the plot.
Use &quot;/p&quot; for displaying the chosen parameters <code>alpha</code> 
and <code>k</code> or &quot;/r&quot; for plotting the chosen restriction (<code>tclust</code> only).
</p>
</dd>
<dt><code>main.pre</code></dt><dd>
<p>An optional string which is added to the plot's caption.
</p>
</dd>
<dt><code>sub</code></dt><dd>
<p>A string specifying the subtitle of the plot.
Use &quot;/p&quot; (default) for displaying the chosen parameters <code>alpha</code> 
and <code>k</code>, &quot;/r&quot; for plotting the chosen restriction (<code>tclust</code> only) and &quot;/pr&quot; for both.
</p>
</dd>
<dt><code>sub1</code></dt><dd>
<p>A secondary (optional) subtitle.
</p>
</dd>
<dt><code>labels</code></dt><dd>
<p>A string specifying the type of labels to be drawn. Either <code>"none"</code>
(default), <code>"cluster"</code> or <code>"observation"</code> can be specified.
If specified, parameter <code>pch</code> is ignored.

</p>
</dd>
<dt><code>text</code></dt><dd>
<p>A vector of length <code>n</code> (the number of observations) containing strings
which are used as labels for each observation.
If specified, the parameters <code>labels</code> and <code>pch</code> are ignored.
</p>
</dd>
<dt><code>by.cluster</code></dt><dd>
<p>Logical value indicating whether parameters <code>pch</code> and <code>col</code>
refer to observations (<code>FALSE</code>) or clusters (<code>TRUE</code>).
</p>
</dd>
<dt><code>jitter.y</code></dt><dd>
<p>Logical value, specifying whether the drawn values shall be jittered in
y-direction for better visibility of structures in 1 dimensional data.
</p>
</dd>
<dt><code>tol</code></dt><dd>
<p>The tolerance interval.
95% tolerance ellipsoids (assuming normality) are plotted by default (<code>tclust</code> only).
</p>
</dd>
<dt><code>tol.col, tol.lty, tol.lwd</code></dt><dd>
<p>Vectors of length <code>k</code> or <code>1</code> containing the <code>col</code>,
<code>lty</code> and <code>lwd</code> arguments for the tolerance ellipses/lines (<code>tclust</code> only).
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>Examples</h3>

<pre><code class='language-R'>#--- EXAMPLE 1------------------------------
sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
	       mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
)
# Two groups and 10% trimming level
a &lt;- tclust (x, k = 2, alpha = 0.1, restr.fact = 12)

plot (a)
plot (a, labels = "observation")
plot (a, labels = "cluster")
plot (a, by.cluster = TRUE)

#--- EXAMPLE 2------------------------------
x &lt;- c(	rnorm(72,	0,   1),
		rnorm(108, 10,   1),
		rnorm(20,  2.5, 10))

a &lt;- tkmeans (x, k = 2, alpha = 0.1)
plot (a, jitter.y = TRUE)

</code></pre>

<hr>
<h2 id='summary.DiscrFact'> summary Method for DiscrFact Objects</h2><span id='topic+summary.DiscrFact'></span>

<h3>Description</h3>

<p> The <code><a href="base.html#topic+summary">summary</a></code> method for class <code>DiscrFact</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'DiscrFact'
 summary(object, hide.emtpy = TRUE, show.clust, show.alt, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.DiscrFact_+3A_object">object</code></td>
<td>
<p> An object of class &quot;<code>DiscrFact</code>&quot; as from <code>DiscrFact ()</code>. </p>
</td></tr>
<tr><td><code id="summary.DiscrFact_+3A_hide.emtpy">hide.emtpy</code></td>
<td>
<p> A logical value specifying whether clusters without doubtful assignment shall be hidden. </p>
</td></tr>
<tr><td><code id="summary.DiscrFact_+3A_show.clust">show.clust</code></td>
<td>
<p> A logical value specifying whether the number of doubtful assignments per cluster shall be displayed. </p>
</td></tr>
<tr><td><code id="summary.DiscrFact_+3A_show.alt">show.alt</code></td>
<td>
<p> A logical value specifying whether the alternative cluster assignment shall be displayed. </p>
</td></tr>
<tr><td><code id="summary.DiscrFact_+3A_...">...</code></td>
<td>
<p> Arguments passed to or from other methods. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> No return value is provided.</p>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

<p> García-Escudero, L.A.; Gordaliza, A.; Matrán, C. and Mayo-Iscar, A. (2009), &quot;Exploring the number of groups in robust model-based clustering&quot;.<br />
Preprint available at www.eio.uva.es/infor/personas/langel.html. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.DiscrFact">plot.DiscrFact</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>sig &lt;- diag (2)
cen &lt;- rep (1, 2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
	       mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
	       mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
)
clus.1 &lt;- tclust (x, k = 2, alpha = 0.1, restr.fact = 12)

clus.2 &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact = 1)  
  ##  restr.fact and k are chosen improperly for pointing out the 
  ##    difference in the plot of DiscrFact

dsc.1 &lt;- DiscrFact (clus.1)
summary(dsc.1)

dsc.2 &lt;- DiscrFact (clus.2)
summary (dsc.2)

</code></pre>

<hr>
<h2 id='swissbank'> SwissBankNotes Data </h2><span id='topic+swissbank'></span>

<h3>Description</h3>

 
<p>Six variables measured on 100 genuine and 100 counterfeit old Swiss 1000-franc bank notes (Flury and Riedwyl, 1988). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(swissbank)</code></pre>


<h3>Format</h3>


<dl>
<dt><code>Length</code></dt><dd><p> Length of the bank note </p>
</dd>
<dt><code>Ht_Left</code></dt><dd><p> Height of the bank note, measured on the left </p>
</dd>
<dt><code>Ht_Right</code></dt><dd><p> Height of the bank note, measured on the right </p>
</dd>
<dt><code>IF_Lower</code></dt><dd><p> Distance of inner frame to the lower border </p>
</dd>
<dt><code>IF_Upper</code></dt><dd><p> Distance of inner frame to the upper border </p>
</dd>
<dt><code>Diagonal</code></dt><dd><p> Length of the diagonal </p>
</dd>
</dl>



<h3>Details</h3>

<p>Observations 1-100 are the genuine bank notes and the other 100 observations are the counterfeit bank notes. </p>


<h3>Source</h3>

<p> Flury, B. and Riedwyl, H. (1988). Multivariate Statistics, A Practical Approach, Cambridge University Press. </p>

<hr>
<h2 id='tclust'> General Trimming Approach to Robust Cluster Analysis  </h2><span id='topic+tclust'></span><span id='topic+print.tclust'></span>

<h3>Description</h3>

 
<p><code>tclust</code> searches for <code>k</code> (or less) clusters with different
covariance structures in a data matrix <code>x</code>.
Relative cluster scatter can be restricted by a constant value
<code>restr.fact</code>. For robustifying the estimation, a proportion
<code>alpha</code> of observations may be trimmed. 


In particular, the trimmed k-means method (<code><a href="#topic+tkmeans">tkmeans</a></code>)is represented by the <code>tclust</code>
method, setting parameters <code>restr = "eigen"</code>, <code>restr.fact = 1</code>
and <code>equal.weights = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
tclust (x, k = 3, alpha = 0.05, nstart = 50, iter.max = 20, 
        restr = c ("eigen", "deter", "sigma"), restr.fact = 12, 
        equal.weights = FALSE, center, scale, store.x = TRUE, 
        drop.empty.clust = TRUE, trace = 0, warnings = 3, 
        zero.tol = 1e-16)



</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tclust_+3A_x">x</code></td>
<td>

<p>A matrix or data.frame of dimension <code>n</code> x <code>p</code>, containing the
observations (row-wise).
</p>
</td></tr>
<tr><td><code id="tclust_+3A_k">k</code></td>
<td>

<p>The number of clusters initially searched for.
</p>
</td></tr>
<tr><td><code id="tclust_+3A_alpha">alpha</code></td>
<td>

<p>The proportion of observations to be trimmed.
</p>
</td></tr>







<tr><td><code id="tclust_+3A_nstart">nstart</code></td>
<td>

<p>The number of random initializations to be performed.
</p>
</td></tr>
<tr><td><code id="tclust_+3A_iter.max">iter.max</code></td>
<td>

<p>The maximum number of concentration steps to be performed.
The concentration steps are stopped, whenever two consecutive steps lead
to the same data partition.
</p>
</td></tr>
<tr><td><code id="tclust_+3A_restr">restr</code></td>
<td>

<p>The type of restriction to be applied on the cluster scatter matrices.
Valid values are <code>"eigen"</code> (default), <code>"deter"</code> and
<code>"sigma"</code>.

See the detail section for further explanation. </p>
</td></tr>
<tr><td><code id="tclust_+3A_restr.fact">restr.fact</code></td>
<td>

<p>The constant <code>restr.fact &gt;= 1</code> constrains the allowed differences
among group scatters.
Larger values imply larger differences of group scatters, a value of 1
specifies the strongest restriction.
When using <code>restr = "sigma"</code> this parameter is not considered, as all
cluster variances are averaged, always implying <code>restr.fact = 1</code>.




</p>
</td></tr>
<tr><td><code id="tclust_+3A_equal.weights">equal.weights</code></td>
<td>

<p>A logical value, specifying whether equal cluster weights (<code>TRUE</code>) or
not (<code>FALSE</code>) shall be considered in the concentration and assignment 
steps.
</p>
</td></tr>
<tr><td><code id="tclust_+3A_center">center</code>, <code id="tclust_+3A_scale">scale</code></td>
<td>

<p>A center and scale vector, each of length <code>p</code> which can optionally 
be specified for centering and scaling <code>x</code> before calculation




</p>
</td></tr>
<tr><td><code id="tclust_+3A_store.x">store.x</code></td>
<td>

<p>A logical value, specifying whether the data matrix <code>x</code> shall be 
included in the result structure.
By default this value is set to <code>TRUE</code>, because functions
<code> <a href="#topic+plot.tclust">plot.tclust</a></code> and<code> <a href="#topic+DiscrFact">DiscrFact</a></code> depend on this 
information.
However, when big data matrices are handled, the result structure's size 
can be decreased noticeably when setting this parameter to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tclust_+3A_drop.empty.clust">drop.empty.clust</code></td>
<td>

<p>Logical value specifying, whether empty clusters shall be omitted in the 
resulting object.
(The result structure does not contain center and covariance estimates of 
empty clusters anymore.
Cluster names are reassigned such that the first <code>l</code> clusters
(<code>l &lt;= k</code>) always have at least one observation.
</p>
</td></tr>






<tr><td><code id="tclust_+3A_trace">trace</code></td>
<td>

<p>Defines the tracing level, which is set to <code>0</code> by default.
Tracing level <code>2</code> gives additional information on the iteratively
decreasing objective function's value.
</p>
</td></tr>





<tr><td><code id="tclust_+3A_warnings">warnings</code></td>
<td>

<p>The warning level (0: no warnings; 1: warnings on unexpected behavior;
2: warnings if <code>restr.fact</code> causes artificially restricted results).
</p>
</td></tr>
<tr><td><code id="tclust_+3A_zero.tol">zero.tol</code></td>
<td>
<p> The zero tolerance used. By default set to 1e-16. </p>
</td></tr>












</table>


<h3>Details</h3>

<p>This iterative algorithm initializes <code>k</code> clusters randomly and performs
&quot;concentration steps&quot; in order to improve the current cluster assignment.
The number of maximum concentration steps to be performed is given by
<code>iter.max</code>.
For approximately obtaining the global optimum, the system is initialized
<code>nstart</code> times and concentration steps are performed until convergence
or <code>iter.max</code> is reached.
When processing more complex data sets higher values of <code>nstart</code> and 
<code>iter.max</code> have to be specified 
(obviously implying extra computation time).
However, if more then half of the iterations would not converge, a warning
message is issued, indicating that <code>nstart</code> has to be increased.
</p>
<p>The parameter <code>restr</code> defines the cluster's shape restrictions, which 
are applied on all clusters during each iteration.
Options <code>"eigen"</code>/<code>"deter"</code> restrict the ratio between the maximum 
and minimum eigenvalue/determinant of all cluster's covariance structures to 
parameter <code>restr.fact</code>. Setting <code>restr.fact</code> to <code>1</code>, yields 
the strongest restriction, forcing all eigenvalues/determinants to be equal 
and so the method looks for similarly scattered (respectively spherical)
clusters.
Option <code>"sigma"</code> is a simpler restriction, which averages the covariance 
structures during each iteration (weighted by cluster sizes) in order to get 
similar (equal) cluster scatters.




















</p>


<h3>Value</h3>

<p>The function returns an S3 object of type <code>tclust</code>, containing the 
following values:
</p>
<table>
<tr><td><code>centers</code></td>
<td>

<p>A matrix of size <code>p</code> x <code>k</code> containing the centers (column-wise)
of each cluster.
</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>

<p>An array of size  <code>p</code> x <code>p</code> x <code>k</code> containing the covariance 
matrices  of each cluster.
</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>

<p>A numerical vector of size <code>n</code> containing the cluster assignment for
each observation. Cluster names are integer numbers from <code>1</code> to
<code>k</code>, <code>0</code> indicates trimmed observations.
</p>
</td></tr>
<tr><td><code>par</code></td>
<td>

<p>A list, containing the parameters the algorithm has been called with
(<code>x</code>, if not suppressed by <code>store.x = FALSE</code>,<code> k</code>,
<code> alpha</code>,<code> restr.fact</code>,<code> nstart</code>,<code> KStep</code>, and
<code> equal.weights</code>).
</p>
</td></tr>
<tr><td><code>k</code></td>
<td>

<p>The (final) resulting number of clusters.
Some solutions with a smaller number of clusters might be found when using
the option <code>equal.weights = FALSE</code>.
</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>

<p>The value of the objective function of the best (returned) solution.
</p>
</td></tr>
<tr><td><code>size</code></td>
<td>

<p>An integer vector of size k, returning the number of observations contained by each cluster.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>A numerical vector of length k, containing the weights of each cluster.
</p>
</td></tr>
<tr><td><code>int</code></td>
<td>

<p>A list of values internally used by function related to <code>tclust</code> objects.
</p>
</td></tr>













</table>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

 
<p>Garcia-Escudero, L.A.; Gordaliza, A.; Matran, C. and Mayo-Iscar, A. (2008), &quot;A General Trimming Approach to Robust Cluster Analysis&quot;. Annals of Statistics, Vol.36, 1324-1345. Technical Report available at www.eio.uva.es/inves/grupos/representaciones/trTCLUST.pdf<br />
Fritz, H.; Garcia-Escudero, L.A.; Mayo-Iscar, A. (2012), &quot;tclust: An R Package for a Trimming Approach to Cluster Analysis&quot;. Journal of Statistical Software, 47(12), 1-26. URL http://www.jstatsoft.org/v47/i12/</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- EXAMPLE 1 ------------------------------------------
sig &lt;- diag (2)
cen &lt;- rep (1,2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
           mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
           mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
           )

# Two groups and 10% trimming level
clus &lt;- tclust (x, k = 2, alpha = 0.1, restr.fact = 8)

plot (clus)
plot (clus, labels = "observation")
plot (clus, labels = "cluster")

# Three groups (one of them very scattered) and 0% trimming level
clus &lt;- tclust (x, k = 3, alpha=0.0, restr.fact = 100)

plot (clus)






#--- EXAMPLE 3 ------------------------------------------
data (M5data)
x &lt;- M5data[, 1:2]

clus.a &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact =  1,
                  restr = "eigen", equal.weights = TRUE, warnings = 1)
clus.b &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact =  1,
                   equal.weights = TRUE, warnings = 1)
clus.c &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact =  1,
                  restr = "deter", equal.weights = TRUE, iter.max = 100,
		  warnings = 1)
clus.d &lt;- tclust (x, k = 3, alpha = 0.1, restr.fact = 50,
                  restr = "eigen", equal.weights = FALSE)

pa &lt;- par (mfrow = c (2, 2))
plot (clus.a, main = "(a) tkmeans")
plot (clus.b, main = "(b) Gallegos and Ritter")
plot (clus.c, main = "(c) Gallegos")
plot (clus.d, main = "(d) tclust")
par (pa)

#--- EXAMPLE 4 ------------------------------------------
data (swissbank)
# Two clusters and 8% trimming level
clus &lt;- tclust (swissbank, k = 2, alpha = 0.08, restr.fact = 50)

                            # Pairs plot of the clustering solution
pairs (swissbank, col = clus$cluster + 1)
                                  # Two coordinates
plot (swissbank[, 4], swissbank[, 6], col = clus$cluster + 1,
     xlab = "Distance of the inner frame to lower border",
     ylab = "Length of the diagonal")
plot (clus)

# Three clusters and 0% trimming level
clus &lt;- tclust (swissbank, k = 3, alpha = 0.0, restr.fact = 110)

                            # Pairs plot of the clustering solution
pairs (swissbank, col = clus$cluster + 1)

                                   # Two coordinates
plot (swissbank[, 4], swissbank[, 6], col = clus$cluster + 1, 
      xlab = "Distance of the inner frame to lower border", 
      ylab = "Length of the diagonal")

plot (clus)


</code></pre>

<hr>
<h2 id='tkmeans'> Trimmed k-means Cluster Analysis  </h2><span id='topic+tkmeans'></span><span id='topic+print.tkmeans'></span>

<h3>Description</h3>

 
<p><code>tkmeans</code> searches for <code>k</code> (or less) spherical clusters in a data matrix <code>x</code>, whereas the <code>ceiling (alpha n)</code> most outlying observations are trimmed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tkmeans (x, k = 3, alpha = 0.05, nstart = 50, iter.max = 20, 
         equal.weights = FALSE, center = 0, scale = 1, store.x = TRUE,
         drop.empty.clust = TRUE, trace = 0, warnings = 2, zero.tol = 1e-16)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tkmeans_+3A_x">x</code></td>
<td>

<p>A matrix or data.frame of dimension <code>n</code> x <code>p</code>, containing the
observations (row-wise).
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_k">k</code></td>
<td>

<p>The number of clusters initially searched for.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_alpha">alpha</code></td>
<td>

<p>The proportion of observations to be trimmed.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_nstart">nstart</code></td>
<td>

<p>The number of random initializations to be performed.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_iter.max">iter.max</code></td>
<td>

<p>The maximum number of concentration steps to be performed.
The concentration steps are stopped, whenever two consecutive steps lead
to the same data partition.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_equal.weights">equal.weights</code></td>
<td>

<p>A logical value, specifying whether equal cluster weights (<code>TRUE</code>) or
not (<code>FALSE</code>) shall be considered in the concentration and assignment 
steps.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_center">center</code>, <code id="tkmeans_+3A_scale">scale</code></td>
<td>

<p>A center and scale vector, each of length <code>p</code> which can optionally 
be specified for centering and scaling <code>x</code> before calculation




</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_store.x">store.x</code></td>
<td>

<p>A logical value, specifying whether the data matrix <code>x</code> shall be 
included in the result structure.
By default this value is set to <code>TRUE</code>, because functions
<code> <a href="#topic+plot.tkmeans">plot.tkmeans</a></code> depends on this information.
However, when big data matrices are handled, the result structure's size 
can be decreased noticeably when setting this parameter to <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_drop.empty.clust">drop.empty.clust</code></td>
<td>

<p>Logical value specifying, whether empty clusters shall be omitted in the 
resulting object.
(The result structure does not contain center and covariance estimates of 
empty clusters anymore.
Cluster names are reassigned such that the first <code>l</code> clusters
(<code>l &lt;= k</code>) always have at least one observation.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_trace">trace</code></td>
<td>

<p>Defines the tracing level, which is set to <code>0</code> by default.
Tracing level <code>2</code> gives additional information on the iteratively
decreasing objective function's value.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_warnings">warnings</code></td>
<td>

<p>The warning level (0: no warnings; 1: warnings on unexpected behavior.
</p>
</td></tr>
<tr><td><code id="tkmeans_+3A_zero.tol">zero.tol</code></td>
<td>
<p> The zero tolerance used. By default set to 1e-16. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an S3 object of type <code>tkmeans</code>, containing the 
following values:
</p>
<table>
<tr><td><code>centers</code></td>
<td>

<p>A matrix of size <code>p</code> x <code>k</code> containing the centers (column-wise)
of each cluster.
</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>

<p>A numerical vector of size <code>n</code> containing the cluster assignment for
each observation. Cluster names are integer numbers from <code>1</code> to
<code>k</code>, <code>0</code> indicates trimmed observations.
</p>
</td></tr>
<tr><td><code>par</code></td>
<td>

<p>A list, containing the parameters the algorithm has been called with
(<code>x</code>, if not suppressed by <code>store.x = FALSE</code>,<code> k</code>,
<code> alpha</code>,<code> restr.fact</code>,<code> nstart</code>,<code> KStep</code>, and
<code> equal.weights</code>).
</p>
</td></tr>
<tr><td><code>k</code></td>
<td>

<p>The (final) resulting number of clusters.
Some solutions with a smaller number of clusters might be found when using
the option <code>equal.weights = FALSE</code>.
</p>
</td></tr>
<tr><td><code>obj</code></td>
<td>

<p>The value of the objective function of the best (returned) solution.
</p>
</td></tr>
<tr><td><code>size</code></td>
<td>

<p>An integer vector of size k, returning the number of observations contained by each cluster.
</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>

<p>A numerical vector of length k, containing the weights of each cluster.
</p>
</td></tr>
<tr><td><code>int</code></td>
<td>

<p>A list of values internally used by function related to <code>tkmeans</code> objects.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Agustin Mayo Iscar, Luis Angel Garcia Escudero, Heinrich Fritz </p>


<h3>References</h3>

 
<p>Cuesta-Albertos, J. A.; Gordaliza, A. and Matrán, C. (1997), &quot;Trimmed k-means: an attempt to robustify quantizers&quot;. Annals of Statistics, Vol. 25 (2), 553-576. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#--- EXAMPLE 1 ------------------------------------------
sig &lt;- diag (2)
cen &lt;- rep (1,2)
x &lt;- rbind(mvtnorm::rmvnorm(360, cen * 0,   sig),
            mvtnorm::rmvnorm(540, cen * 5,   sig * 6 - 2),
            mvtnorm::rmvnorm(100, cen * 2.5, sig * 50)
            )

# Two groups and 10% trimming level
clus &lt;- tkmeans (x, k = 2, alpha = 0.1)

plot (clus)
plot (clus, labels = "observation")
plot (clus, labels = "cluster")

#--- EXAMPLE 2 ------------------------------------------
data (geyser2)
clus &lt;- tkmeans (geyser2, k = 3, alpha = 0.03)
plot (clus)

#--- EXAMPLE 3 ------------------------------------------
data (swissbank)
# Two clusters and 8% trimming level
clus &lt;- tkmeans (swissbank, k = 2, alpha = 0.08)

                            # Pairs plot of the clustering solution
pairs (swissbank, col = clus$cluster + 1)
                                  # Two coordinates
plot (swissbank[, 4], swissbank[, 6], col = clus$cluster + 1,
     xlab = "Distance of the inner frame to lower border",
     ylab = "Length of the diagonal")
plot (clus)

# Three clusters and 0% trimming level
clus &lt;- tkmeans (swissbank, k = 3, alpha = 0.0)

                            # Pairs plot of the clustering solution
pairs (swissbank, col = clus$cluster + 1)

                                   # Two coordinates
plot (swissbank[, 4], swissbank[, 6], col = clus$cluster + 1, 
      xlab = "Distance of the inner frame to lower border", 
      ylab = "Length of the diagonal")

plot (clus)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
