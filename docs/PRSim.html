<!DOCTYPE html><html><head><title>Help for package PRSim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PRSim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pRsim'><p>Simulate for one station</p></a></li>
<li><a href='#PRSim-package'>
<p>Stochastic Simulation of Streamflow Time Series using Phase Randomization</p></a></li>
<li><a href='#pRsim.wave'><p>Simulate for multiple stations</p></a></li>
<li><a href='#pRsim.weather'><p>Weather simulation (temperature and precipitation) for multiple stations</p></a></li>
<li><a href='#runoff'>
<p>Sample runoff of a catchment</p></a></li>
<li><a href='#runoff_multi_site_T'>
<p>Sample runoff and temperature data of two catchments with a similar discharge regime</p></a></li>
<li><a href='#runoff_multi_sites'>
<p>Sample runoff of four catchments with a similar discharge regime</p></a></li>
<li><a href='#simulations'>
<p>Simulated runoff</p></a></li>
<li><a href='#simulations_multi_sites'>
<p>Simulated runoff for four catchments</p></a></li>
<li><a href='#weather_multi_sites'>
<p>Sample temperature and precipitation of four catchments derived from the ERA5-Land gridded dataset</p></a></li>
<li><a href='#weather_sim_multi_sites'>
<p>Simulated temperature and precipitation for two grid cells</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Stochastic Simulation of Streamflow Time Series using Phase
Randomization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Manuela Brunner <a href="https://orcid.org/0000-0001-8824-877X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Reinhard Furrer <a href="https://orcid.org/0000-0002-6319-2332"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  R Core Teamn [ctb, cph] (ks_test.c)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Manuela Brunner &lt;manuela.brunner@env.ethz.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a simulation framework to simulate streamflow time series with similar main characteristics as observed data. These characteristics include the distribution of daily streamflow values and their temporal correlation as expressed by short- and long-range dependence. The approach is based on the randomization of the phases of the Fourier transform or the phases of the wavelet transform. The function prsim() is applicable to single site simulation and uses the Fourier transform. The function prsim.wave() extends the approach to multiple sites and is based on the complex wavelet transform. The function prsim.weather() extends the approach to multiple variables for weather generation. We further use the flexible four-parameter Kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternatively, the empirical or any other distribution can be used. 
  A detailed description of the simulation approach for single sites and an application example can be found in Brunner et al. (2019) &lt;<a href="https://doi.org/10.5194%2Fhess-23-3175-2019">doi:10.5194/hess-23-3175-2019</a>&gt;.
  A detailed description and evaluation of the wavelet-based multi-site approach can be found in Brunner and Gilleland (2020) &lt;<a href="https://doi.org/10.5194%2Fhess-24-3967-2020">doi:10.5194/hess-24-3967-2020</a>&gt;.
  A detailed description and evaluation of the multi-variable and multi-site weather generator can be found in Brunner et al. (2021) &lt;<a href="https://doi.org/10.5194%2Fesd-12-621-2021">doi:10.5194/esd-12-621-2021</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://git.math.uzh.ch/reinhard.furrer/PRSim-devel">https://git.math.uzh.ch/reinhard.furrer/PRSim-devel</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://git.math.uzh.ch/reinhard.furrer/PRSim-devel/-/issues">https://git.math.uzh.ch/reinhard.furrer/PRSim-devel/-/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice, ismev, evd, GB2, boot, MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, methods, lmomco, mev, goftest, wavScalogram, splus2R</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-18 09:03:40 UTC; brunnerm</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-19 09:00:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='pRsim'>Simulate for one station</h2><span id='topic+PRsim'></span><span id='topic+prsim'></span>

<h3>Description</h3>

<p>Applies the algorithm to a single station
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prsim(data, station_id="Qobs", number_sim=1, win_h_length=15,
      marginal=c("kappa","empirical"), n_par=4, marginalpar=TRUE, 
      GoFtest=NULL, verbose=TRUE, suppWarn=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pRsim_+3A_data">data</code></td>
<td>
<p>data frame containing the time indications and runoff of at least one station. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_station_id">station_id</code></td>
<td>
<p>identifies the station in case several runoffs are present in <code>data</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_number_sim">number_sim</code></td>
<td>
<p>number of simulations to be carried out.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_win_h_length">win_h_length</code></td>
<td>
<p>(half-)length of moving window size.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_marginal">marginal</code></td>
<td>
<p>marginal distribution to be used for the backtransformation. Can be either <code>"kappa"</code>, <code>"empirical"</code>, or any type of CDF (see &lsquo;Details&rsquo;). <code>"kappa"</code> uses the four-parameter kappa distribution for backtransformation, <code>"empirical"</code> uses the empirical distribution. CDF allows for specifying any distribution &lsquo;Examples&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_n_par">n_par</code></td>
<td>
<p>number of parameters of the marginal distribution used</p>
</td></tr>
<tr><td><code id="pRsim_+3A_goftest">GoFtest</code></td>
<td>
<p>If (non-null) a GoF test for daily data should be performed: <code>"KS"</code> performs a Kolmogorof-Smirnov test, and <code>"AD"</code> performs an Anderson-Darling test.  see &lsquo;Details&rsquo;)</p>
</td></tr>
<tr><td><code id="pRsim_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should progress be reported?</p>
</td></tr>
<tr><td><code id="pRsim_+3A_marginalpar">marginalpar</code></td>
<td>
<p>logical. Should the estimated parameters of the distribution used be returned?</p>
</td></tr>
<tr><td><code id="pRsim_+3A_suppwarn">suppWarn</code></td>
<td>
<p>logical. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim_+3A_...">...</code></td>
<td>
<p>any other argument passed to the sub-function specifying the cdf for fitting.  See &lsquo;Details&rsquo; and  &lsquo;Examples&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time can be given with three columns named <code>"YYYY"</code>, <code>"MM"</code>, <code>"DD"</code>, or as in POSIXct format <code>YYYY-MM-DD</code>.
All leap days (Feb 29th) will be omitted from the analysis, but no missing observations are allowed.
</p>
<p>Stations are identified by column name (default <code>"Qobs"</code>), or by column index.
</p>
<p>The function <code>homtest::par.kappa</code> might issue quite a few warnings of type <code>In fn(par, ...) : value out of range in 'gammafn'</code>. The argument <code>suppWarn</code> allows to silence warnings for the specific function call via <code>suppressWarnings()</code>. Of course, a subsequent check via <code>warnings()</code> is recommended.
</p>
<p>Alternative distributions can be specified by providing three functions: (1) a function fitting the parameters of a distributions and providing a vector of these parameters as output (CDF_fit), (2) a function simulating random numbers from this distribution (rCDF), and (3) a function specifying the distribution (pCDF). See &lsquo;Examples&rsquo; for the generalized beta for the second kind and for the Generalized Extreme Values (GEV) distribution.
</p>
<p>When using the kappa distribution, the AD test can for certain values of the parameter h not be performed. 
</p>


<h3>Value</h3>

<p>A list with elements 
</p>
<table>
<tr><td><code>simulation</code></td>
<td>
<p>A data frame with time information, observations, deseaonalized observations and 
<code>number_sim</code> columns containing the simulated runoff.</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>A matrix containing the estimated parameters of the marginal distribution (if <code>marginalpar</code>).</p>
</td></tr>
<tr><td><code>p_val</code></td>
<td>
<p>A vector containing the p-values of <code>ks.test</code> or <code>ad.test</code> applied to the daily detrended data (if <code>GoFtest</code> is not NULL)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Manuela Brunner
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>


<h3>See Also</h3>

<p><code>ks.test</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(runoff)
out &lt;- prsim( runoff[ runoff$YYYY&lt;1980, ], "Qobs", 1, suppWarn=TRUE)
# warnings() # as a follow-up to `suppWarn=TRUE`


## Specifying particular CDFs:
## (1) example with the Generalized Extreme Value (GEV) distribution
require("evd")
require("ismev")
rGEV &lt;- function(n, theta)   rgev(n, theta[1], theta[2], theta[3])
pGEV &lt;- function(x, theta)   pgev(x, theta[1], theta[2], theta[3])
GEV_fit &lt;- function( xdat, ...)   gev.fit( xdat, ...)$mle
  

## (2) example with generalized Beta distribution of the second kind

require( "GB2")
rGB2 &lt;- function(n, theta)  rgb2(n, theta[1], theta[2], theta[3], theta[4])
pGB2 &lt;- function(x, theta)  pgb2(x, theta[1], theta[2], theta[3], theta[4])
GB2_fit &lt;- function( xdat, ...)   ml.gb2( xdat, ...)$opt1$par


</code></pre>

<hr>
<h2 id='PRSim-package'>
Stochastic Simulation of Streamflow Time Series using Phase Randomization
</h2><span id='topic+PRSim-package'></span><span id='topic+PRSim'></span>

<h3>Description</h3>

<p>Provides a simulation framework to simulate streamflow time series with similar main characteristics as observed data. These characteristics include the distribution of daily streamflow values and their temporal correlation as expressed by short- and long-range dependence. The approach is based on the randomization of the phases of the Fourier transform or the phases of the wavelet transform. The function prsim() is applicable to single site simulation and uses the Fourier transform. The function prsim.wave() extends the approach to multiple sites and is based on the complex wavelet transform. The function prsim.weather() extends the approach to multiple variables for weather generation. We further use the flexible four-parameter Kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternatively, the empirical or any other distribution can be used. 
  A detailed description of the simulation approach for single sites and an application example can be found in Brunner et al. (2019) &lt;doi:10.5194/hess-23-3175-2019&gt;.
  A detailed description and evaluation of the wavelet-based multi-site approach can be found in Brunner and Gilleland (2020) &lt;doi:10.5194/hess-24-3967-2020&gt;.
  A detailed description and evaluation of the multi-variable and multi-site weather generator can be found in Brunner et al. (2021) &lt;doi:10.5194/esd-12-621-2021&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PRSim</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Stochastic Simulation of Streamflow Time Series using Phase
Randomization</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.4-4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-09-18</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Manuela", "Brunner", role = c("aut", "cre"),
             email = "manuela.brunner@env.ethz.ch", 
             comment = c(ORCID = "0000-0001-8824-877X")),
             person("Reinhard", "Furrer", role = c("aut"),  
             email = "reinhard.furrer@math.uzh.ch", 
             comment = c(ORCID = "0000-0002-6319-2332")),
             person("R Core Teamn", role = c("ctb", "cph"), comment="ks_test.c")) </td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Manuela Brunner [aut, cre]  (&lt;https://orcid.org/0000-0001-8824-877X&gt;), Reinhard Furrer [aut] (&lt;https://orcid.org/0000-0002-6319-2332&gt;), R Core Teamn [ctb, cph] (ks_test.c)</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Manuela Brunner &lt;manuela.brunner@env.ethz.ch&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Provides a simulation framework to simulate streamflow time series with similar main characteristics as observed data. These characteristics include the distribution of daily streamflow values and their temporal correlation as expressed by short- and long-range dependence. The approach is based on the randomization of the phases of the Fourier transform or the phases of the wavelet transform. The function prsim() is applicable to single site simulation and uses the Fourier transform. The function prsim.wave() extends the approach to multiple sites and is based on the complex wavelet transform. The function prsim.weather() extends the approach to multiple variables for weather generation. We further use the flexible four-parameter Kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternatively, the empirical or any other distribution can be used. 
  A detailed description of the simulation approach for single sites and an application example can be found in Brunner et al. (2019) &lt;doi:10.5194/hess-23-3175-2019&gt;.
  A detailed description and evaluation of the wavelet-based multi-site approach can be found in Brunner and Gilleland (2020) &lt;doi:10.5194/hess-24-3967-2020&gt;.
  A detailed description and evaluation of the multi-variable and multi-site weather generator can be found in Brunner et al. (2021) &lt;doi:10.5194/esd-12-621-2021&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://git.math.uzh.ch/reinhard.furrer/PRSim-devel</td>
</tr>
<tr>
 <td style="text-align: left;">
BugReports: </td><td style="text-align: left;"> https://git.math.uzh.ch/reinhard.furrer/PRSim-devel/-/issues</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
Encoding: </td><td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyData: </td><td style="text-align: left;"> true</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.5.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> lattice, ismev, evd, GB2, boot, MASS</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> stats, methods, lmomco, mev, goftest, wavScalogram, splus2R</td>
</tr>
<tr>
 <td style="text-align: left;">
RoxygenNote: </td><td style="text-align: left;"> 7.2.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Archs: </td><td style="text-align: left;"> x64</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
PRSim-package           Stochastic Simulation of Streamflow Time Series
                        using Phase Randomization
PRsim                   Simulate for one station
PRsim.wave              Simulate for multiple stations
PRsim.weather           Weather simulation (temperature and
                        precipitation) for multiple stations
runoff                  Sample runoff of a catchment
runoff_multi_site_T     Sample runoff and temperature data of two
                        catchments with a similar discharge regime
runoff_multi_sites      Sample runoff of four catchments with a similar
                        discharge regime
simulations             Simulated runoff
simulations_multi_sites
                        Simulated runoff for four catchments
weather_multi_sites     Sample temperature and precipitation of four
                        catchments derived from the ERA5-Land gridded
                        dataset
weather_sim_multi_sites
                        Simulated temperature and precipitation for two
                        grid cells
</pre>
<p>Contains two functions for the stochastic simulation of continuous discharge time series: prsim and prsim.wave both using phase randomization. prsim is based on the Fourier transform while prsim.wave uses the wavelet transform.
</p>
<p>prsim: Simulation in the frequency domain is based on the randomization of the phases of the Fourier transform. We here combine phase randomization simulation with the flexible, four-parameter kappa distribution, which allows for the extrapolation to yet unobserved low and high flows. Alternative distributions or the empirical distribution can be used instead. The
simulation approach consists of eight steps: (1) fitting of theoretical Kappa distribution, (2) normalization and deseasonalization, (3) Fourier transformation, (4) Fourier phases computation, (5) random phase generation, (6) inverse Fourier transformation, (7) back transformation, and (8) simulation.
</p>
<p>prsim.wave: Simulation for multiple sites in the frequency domain based on the randomization of the phases of the continuous wavelet transform. We combine phase randomization with the flexible, four-parameter kappa distribution. Alternative theoretical distributions or the empirical distribution can be used instead. The simulation procedure consists of five steps: (1) Derivation of random phases from a white noise time series, (2) Fitting of kappa distribution, (3) Wavelet transform, (4) Inverse wavelet transform, and (5) Transformation to the kappa distribution (or the distribution of choice).
</p>
<p>prsim.weather: Simulation of two variables (temperature and precipitation) for multiple sites in the frequency domain based on the randomization of the phases of the continuous wavelet transform. We combine phase randomization with the flexible, skewed exponential power (sep) and extended generalized pareto distributions (egpd). Alternative theoretical distributions can be used instead. The simulation procedure consists of five steps: (1) Derivation of random phases from a randomly sampled time series, (2) Fitting of temperature and precipitation disstributions, (3) Wavelet transform, (4) Inverse wavelet transform, and (5) Transformation to the desired distributions.
</p>


<h3>Author(s)</h3>

<p>Manuela Brunner [aut, cre]  (&lt;https://orcid.org/0000-0001-8824-877X&gt;), Reinhard Furrer [aut] (&lt;https://orcid.org/0000-0002-6319-2332&gt;), R Core Teamn [ctb, cph] (ks_test.c)
</p>
<p>Maintainer: Manuela Brunner &lt;manuela.brunner@env.ethz.ch&gt;
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>
<p>Brunner, M. I., and E. Gilleland (2020). Stochastic simulation of streamflow and spatial extremes: a continuous, wavelet-based approach, Hydrology and Earth System Sciences, https://doi.org/10.5194/hess-24-3967-2020.
</p>
<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
demo("PRSim")
demo("PRSim-validate")
demo("PRSim_wave")
demo("PRSim_wave-validate")
demo("PRSim_weather")
demo("PRSim_weather-validate")

</code></pre>

<hr>
<h2 id='pRsim.wave'>Simulate for multiple stations</h2><span id='topic+PRsim.wave'></span><span id='topic+prsim.wave'></span><span id='topic+prsim_wave'></span>

<h3>Description</h3>

<p>Applies the wavelet-based simulation algorithm to multiple sites (single site possible as well)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prsim.wave(data, station_id="Qobs", number_sim=1, win_h_length=15, 
                  marginal=c("kappa","empirical"), n_par=4, n_wave=100, marginalpar=TRUE, 
                  GoFtest=NULL, verbose=TRUE, suppWarn=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pRsim.wave_+3A_data">data</code></td>
<td>
<p>list of data frames. One list entry, i.e. data frame, corresponds to one station. Each data frame contains the time indications and runoff of one station. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_station_id">station_id</code></td>
<td>
<p>identifies the station in case several time series are present in <code>data</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_number_sim">number_sim</code></td>
<td>
<p>number of simulations to be carried out.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_win_h_length">win_h_length</code></td>
<td>
<p>(half-)length of moving window size.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_marginal">marginal</code></td>
<td>
<p>marginal distribution to be used for the backtransformation. Can be either <code>"kappa"</code>, <code>"empirical"</code>, or any type of CDF (see &lsquo;Details&rsquo;). <code>"kappa"</code> uses the four-parameter kappa distribution for backtransformation, <code>"empirical"</code> uses the empirical distribution. CDF allows for specifying any distribution &lsquo;Examples&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_n_par">n_par</code></td>
<td>
<p>number of parameters of the marginal distribution used</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_goftest">GoFtest</code></td>
<td>
<p>If (non-null) a GoF test for daily data should be performed: <code>"KS"</code> performs a Kolmogorof-Smirnov test, and <code>"AD"</code> performs an Anderson-Darling test.  see &lsquo;Details&rsquo;)</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should progress be reported?</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_marginalpar">marginalpar</code></td>
<td>
<p>logical. Should the estimated parameters of the distribution used be returned?</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_n_wave">n_wave</code></td>
<td>
<p>number of scales to be considered in the continuous wavelet transform.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_suppwarn">suppWarn</code></td>
<td>
<p>logical. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.wave_+3A_...">...</code></td>
<td>
<p>any other argument passed to the sub-function specifying the cdf for fitting.  See &lsquo;Details&rsquo; and  &lsquo;Examples&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time can be given with three columns named <code>"YYYY"</code>, <code>"MM"</code>, <code>"DD"</code>, or as in POSIXct format <code>YYYY-MM-DD</code>.
All leap days (Feb 29th) will be omitted from the analysis, but no missing observations are allowed.
</p>
<p>Stations are identified by list index.
</p>
<p>The function <code>homtest::par.kappa</code> might issue quite a few warnings of type <code>In fn(par, ...) : value out of range in 'gammafn'</code>. The argument <code>suppWarn</code> allows to silence warnings for the specific function call via <code>suppressWarnings()</code>. Of course, a subsequent check via <code>warnings()</code> is recommended.
</p>
<p>Alternative distributions can be specified by providing three functions: (1) a function fitting the parameters of a distributions and providing a vector of these parameters as output (CDF_fit), (2) a function simulating random numbers from this distribution (rCDF), and (3) a function specifying the distribution (pCDF). See &lsquo;Examples&rsquo; for the generalized beta for the second kind and for the Generalized Extreme Values (GEV) distribution.
</p>
<p>When using the kappa distribution, the AD test can for certain values of the parameter h not be performed. 
</p>


<h3>Value</h3>

<p>A list with elements 
</p>
<table>
<tr><td><code>simulation</code></td>
<td>
<p>A data frame with time information, observations, and 
<code>number_sim</code> columns containing the simulated runoff.</p>
</td></tr>
<tr><td><code>pars</code></td>
<td>
<p>A matrix containing the estimated parameters of the marginal distribution (if <code>marginalpar</code>).</p>
</td></tr>
<tr><td><code>p_val</code></td>
<td>
<p>A vector containing the p-values of <code>ks.test</code> or <code>ad.test</code> applied to the daily detrended data (if <code>GoFtest</code> is not NULL)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Manuela Brunner
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2020). Stochastic simulation of streamflow and spatial extremes: a continuous, wavelet-based approach, Hydrology and Earth System Sciences, https://doi.org/10.5194/hess-24-3967-2020.</p>


<h3>See Also</h3>

<p><code>ks.test</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(runoff_multi_sites)

## Specifying particular CDFs:
## (1) example with the Generalized Extreme Value (GEV) distribution

require("evd")
require("ismev")
rGEV &lt;- function(n, theta)   rgev(n, theta[1], theta[2], theta[3])
pGEV &lt;- function(x, theta)   pgev(x, theta[1], theta[2], theta[3])
GEV_fit &lt;- function( xdat, ...)   gev.fit( xdat, ...)$mle


## (2) example with generalized Beta distribution of the second kind

require( "GB2")
rGB2 &lt;- function(n, theta)  rgb2(n, theta[1], theta[2], theta[3], theta[4])
pGB2 &lt;- function(x, theta)  pgb2(x, theta[1], theta[2], theta[3], theta[4])
GB2_fit &lt;- function( xdat, ...)   ml.gb2( xdat, ...)$opt1$par


</code></pre>

<hr>
<h2 id='pRsim.weather'>Weather simulation (temperature and precipitation) for multiple stations</h2><span id='topic+PRsim.weather'></span><span id='topic+prsim.weather'></span><span id='topic+prsim_weather'></span>

<h3>Description</h3>

<p>Applies the wavelet-based weather simulation algorithm to multiple sites (single site possible as well)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prsim.weather(data_p, data_t, station_id_p="Precip",
station_id_t="Temp", number_sim=1, win_h_length=15,
n_wave=100,verbose=TRUE,t_margin='sep',p_margin='egpd',...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pRsim.weather_+3A_data_p">data_p</code></td>
<td>
<p>list of precipitation data frames. One list entry, i.e. data frame, corresponds to one station/grid cell. Each data frame contains the time indications and precipitation of one station. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_data_t">data_t</code></td>
<td>
<p>list of temperature data frames. One list entry, i.e. data frame, corresponds to one station/grid cell. Each data frame contains the time indications and temperature of one station. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_station_id_p">station_id_p</code></td>
<td>
<p>identifies the precipitation variable name in case several time series are present in <code>data_p</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_station_id_t">station_id_t</code></td>
<td>
<p>identifies the temperature variable name in case several time series are present in <code>data_t</code>. See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_number_sim">number_sim</code></td>
<td>
<p>number of simulations to be carried out.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_win_h_length">win_h_length</code></td>
<td>
<p>(half-)length of moving window size.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_t_margin">t_margin</code></td>
<td>
<p>marginal distribution to be used for the backtransformation of temperature. Can be either <code>"sep"</code> or any type of CDF (see &lsquo;Details&rsquo;). <code>"sep"</code> uses the four-parameter skewed-exponential power for backtransformation. CDF allows for specifying any distribution &lsquo;Examples&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_p_margin">p_margin</code></td>
<td>
<p>marginal distribution to be used for the backtransformation of precipitation. Can be either <code>"egpd"</code> or any type of CDF (see &lsquo;Details&rsquo;). <code>"egpd"</code> uses the extended GPD for backtransformation. CDF allows for specifying any distribution &lsquo;Examples&rsquo;.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should progress be reported?</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_n_wave">n_wave</code></td>
<td>
<p>number of scales to be considered in the continuous wavelet transform.</p>
</td></tr>
<tr><td><code id="pRsim.weather_+3A_...">...</code></td>
<td>
<p>any other argument passed to the sub-function specifying the cdf for fitting.  See &lsquo;Details&rsquo; and  &lsquo;Examples&rsquo;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time can be given with three columns named <code>"YYYY"</code>, <code>"MM"</code>, <code>"DD"</code>, or as in POSIXct format <code>YYYY-MM-DD</code>.
All leap days (Feb 29th) will be omitted from the analysis, but no missing observations are allowed.
</p>
<p>Stations are identified by list index.
</p>
<p>Alternative distributions can be specified by providing three functions: (1) a function fitting the parameters of a distributions and providing a vector of these parameters as output (CDF_fit), (2) a function simulating random numbers from this distribution (rCDF), and (3) a function specifying the distribution (pCDF). See &lsquo;Examples&rsquo; for the generalized beta for the second kind and for the Generalized Extreme Values (GEV) distribution.
</p>


<h3>Value</h3>

<p>A list with elements temperature and precipitation of
</p>
<table>
<tr><td><code>simulation</code></td>
<td>
<p>data frames with time information, observations, and 
<code>number_sim</code> columns containing the simulated data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Manuela Brunner
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.</p>

<hr>
<h2 id='runoff'>
Sample runoff of a catchment
</h2><span id='topic+runoff'></span>

<h3>Description</h3>

<p>Artifical runoff data based on actual and simulated observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("runoff")</code></pre>


<h3>Format</h3>

<p>A data frame with 15695 observations of the following 4 variables.
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>Qobs</code></dt><dd><p>a numeric vector, synthetic observed runoff</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data mimiks the runoff of the river Plessur at the gauging station Chur, Switzerland. The the flow regime of the river is melt dominated. More information is given in the reference below.
</p>


<h3>Source</h3>

<p>The provided data is a weighted average of the acutually observed values and a particular simulated runoff. 
The actual discharge data can be ordered from
<a href="http://www.bafu.admin.ch/wasser/13462/13494/15076/index">http://www.bafu.admin.ch/wasser/13462/13494/15076/index</a>. 
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(runoff)
str(runoff) 
runoff$timestamp &lt;- paste(runoff$YYYY, runoff$MM, runoff$DD, sep=" ")
runoff$timestamp &lt;- as.POSIXct(strptime(runoff$timestamp,
                                 format="%Y %m %d", tz="GMT"))
plot(runoff$timestamp[1:1000], runoff$Qobs[1:1000], type="l", 
  xlab="Time [d]", ylab=expression(paste("Discharge [m"^3,"/s]")))
</code></pre>

<hr>
<h2 id='runoff_multi_site_T'>
Sample runoff and temperature data of two catchments with a similar discharge regime
</h2><span id='topic+runoff_multi_site_T'></span><span id='topic+runoff+20multi+20site+20T'></span>

<h3>Description</h3>

<p>Observed runoff data from two catchments in Switzerland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("runoff_multi_site_T")</code></pre>


<h3>Format</h3>

<p>A list of two data frames (one list per station) of the following 5 variables.
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>Qobs</code></dt><dd><p>a numeric vector, observed runoff</p>
</dd>
<dt><code>T</code></dt><dd><p>a numeric vector, average temperature</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data contains runoff for two Swiss gages: (i) Thur Andelfingen (FOEN 2044) and (ii) Alpbach Erstfeld (FOEN 2299). 
</p>


<h3>Source</h3>

<p>The actual discharge data were ordered from
<a href="https://www.bafu.admin.ch/bafu/en/home/topics/water/state/data/obtaining-monitoring-data-on-the-topic-of-water/hydrological-data-service-for-watercourses-and-lakes.html">https://www.bafu.admin.ch/bafu/en/home/topics/water/state/data/obtaining-monitoring-data-on-the-topic-of-water/hydrological-data-service-for-watercourses-and-lakes.html</a>. Temperature averages were computed from E-OBS (<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/insitu-gridded-observations-europe?tab=overview">https://cds.climate.copernicus.eu/cdsapp#!/dataset/insitu-gridded-observations-europe?tab=overview</a>).
</p>


<h3>References</h3>

<p>Brunner, M. I. and Eric Gilleland in preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(runoff_multi_site_T)
str(runoff_multi_site_T) 
runoff_multi_site_T[[1]]$timestamp &lt;- paste(runoff_multi_site_T[[1]]$YYYY, 
runoff_multi_site_T[[1]]$MM, runoff_multi_site_T[[1]]$DD, sep=" ")
runoff_multi_site_T[[1]]$timestamp &lt;- 
as.POSIXct(strptime(runoff_multi_site_T[[1]]$timestamp,format="%Y %m %d", tz="GMT"))
plot(runoff_multi_site_T[[1]]$timestamp[1:1000], runoff_multi_site_T[[1]]$Qobs[1:1000], type="l", 
  xlab="Time [d]", ylab=expression(paste("Discharge [m"^3,"/s]")))
</code></pre>

<hr>
<h2 id='runoff_multi_sites'>
Sample runoff of four catchments with a similar discharge regime
</h2><span id='topic+runoff_multi_sites'></span><span id='topic+runoff+20multi+20sites'></span>

<h3>Description</h3>

<p>Observed runoff data from four USGS sites.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("runoff_multi_sites")</code></pre>


<h3>Format</h3>

<p>A list of four data frames (one list per station) of the following 4 variables.
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>Qobs</code></dt><dd><p>a numeric vector, observed runoff</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data contains runoff for four USGS gages: (i) Calawah River near Forks, WA (USGS 12043000), (ii) NF Stillaguamish River near Arlington, WA (USGS 12167000), (iii) Nehalem River near Foss, OR (USGS 14301000), and (iv) Steamboat Creek near Glide, OR (USGS 14316700). 
</p>


<h3>Source</h3>

<p>The actual discharge data were downloaded from
<a href="https://waterdata.usgs.gov/nwis">https://waterdata.usgs.gov/nwis</a>.
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(runoff_multi_sites)
str(runoff_multi_sites) 
runoff_multi_sites[[1]]$timestamp &lt;- paste(runoff_multi_sites[[1]]$YYYY, 
runoff_multi_sites[[1]]$MM, runoff_multi_sites[[1]]$DD, sep=" ")
runoff_multi_sites[[1]]$timestamp &lt;- 
as.POSIXct(strptime(runoff_multi_sites[[1]]$timestamp,format="%Y %m %d", tz="GMT"))
plot(runoff_multi_sites[[1]]$timestamp[1:1000], runoff_multi_sites[[1]]$Qobs[1:1000], type="l", 
  xlab="Time [d]", ylab=expression(paste("Discharge [m"^3,"/s]")))
</code></pre>

<hr>
<h2 id='simulations'>
Simulated runoff
</h2><span id='topic+simulations'></span>

<h3>Description</h3>

<p>The dataset is generated with the package own routines and represent 5 series of 18 years of runoff
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simulations")</code></pre>


<h3>Format</h3>

<p>A list of three elements, containing (i) a data frame with 6570 observations of the following variables
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>timestamp</code></dt><dd><p><code>POSIXct</code> vector of the daily runoff</p>
</dd>
<dt><code>deseasonalized</code></dt><dd><p>deseasonalized time series</p>
</dd>
<dt><code>Qobs</code></dt><dd><p>observed runoff</p>
</dd>
<dt><code>r1</code>,...,<code>r5</code></dt><dd><p>5 simulated runoff series</p>
</dd>
</dl>

<p>(ii) a data frame with the daily fitted kappa parameters and (iii) p-values of the daily <code>ks.test</code>.
</p>


<h3>Details</h3>

<p>The data is included to illustrate the validation and visualization routines in <code>demo("PRSim-validate")</code>.
</p>


<h3>Source</h3>

<p>The data has been generated with 
</p>
<p><code>set.seed(14); prsim( runoff[ runoff$YYYY&gt;1999,], number_sim=5,
  KStest=TRUE)</code> 
</p>
<p>(default values for all other arguments).
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simulations)
names(simulations) 
sim &lt;- simulations$simulation
dim(sim)
sim$day_id &lt;- rep(seq(1:365), times=length(unique(sim$YYYY)))
mean_obs &lt;- aggregate(sim$Qobs, by=list(sim$day_id), FUN=mean, simplify=FALSE)
plot(unlist(mean_obs[,2]),lty=1,lwd=1,col="black", ylab="Discharge [m3/s]",
     xlab="Time [d]", main="Mean hydrographs", ylim=c(0,22), type="l")

for(r in 7:(length(names(sim))-1)){
  mean_hydrograph &lt;- aggregate(sim[,r], by=list(sim$day_id), FUN=mean, simplify=FALSE)
  lines(mean_hydrograph, lty=1, lwd=1, col="gray")
}
lines( mean_obs, lty=1, lwd=1, col="black")
</code></pre>

<hr>
<h2 id='simulations_multi_sites'>
Simulated runoff for four catchments
</h2><span id='topic+simulations.multi.sites'></span><span id='topic+simulations_multi_sites'></span>

<h3>Description</h3>

<p>The dataset is generated with the package own routines and represent 5 series of 38 years of runoff for four catchments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simulations_multi_sites")</code></pre>


<h3>Format</h3>

<p>A list of four elements (one per catchment), containing a data frame each holding information about the observed time series and the stochastic simulations
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>timestamp</code></dt><dd><p><code>POSIXct</code> vector of the daily runoff</p>
</dd>
<dt><code>Qobs</code></dt><dd><p>observed runoff</p>
</dd>
<dt><code>r1</code>,...,<code>r5</code></dt><dd><p>5 simulated runoff series</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data is included to illustrate the validation and visualization routines in <code>demo("PRSim_wave-validate")</code>.
</p>


<h3>Source</h3>

<p>The data has been generated with 
</p>
<p><code>prsim.wave(data=runoff_multi_sites, number_sim=5, marginal="kappa",
                  GoFtest = NULL,pars=NULL, p_val=NULL)</code> 
</p>
<p>(default values for all other arguments).
</p>


<h3>References</h3>

<p>Brunner, M. I., A. Bárdossy, and R. Furrer (2019). Technical note: Stochastic simulation of streamflow time series using phase randomization. Hydrology and Earth System Sciences, 23, 3175-3187, https://doi.org/10.5194/hess-23-3175-2019.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- par(mfrow = c(2, 1), mar = c(3, 3, 2, 1))
### greys
col_vect_obs &lt;- c('#cccccc','#969696','#636363','#252525')
### oranges
col_vect_sim &lt;- c('#fdbe85','#fd8d3c','#e6550d','#a63603')
data(simulations_multi_sites)
sim &lt;- simulations_multi_sites
dim(sim[[1]])
### plot time series for multiple sites
par(mfrow=c(2,1),mar=c(3,3,2,1))
### determine ylim
ylim_max &lt;- max(sim[[1]]$Qobs)*1.5
### observed
plot(sim[[1]]$Qobs[1:1000],
    ylab=expression(bold(
        paste("Specific discharge [mm/d]"))),
    xlab="Time [d]",type="l",col=col_vect_obs[1],
    ylim=c(0,ylim_max),main='Observations')
for(l in 2:4){
  lines(sim[[l]]$Qobs[1:1000],col=col_vect_obs[l])
}
legend('topleft',legend=c('Station 1','Station 2',
        'Station 3','Station 4'),
    lty=1,col=col_vect_obs[1:4])
### simulated (one run)
plot(sim[[1]]$r1[1:1000],
    ylab=expression(bold(paste("Specific discharge [mm/d]"))),
    xlab="Time [d]",type="l",col=col_vect_sim[1],
    ylim=c(0,ylim_max),
    main='Stochastic simulations')
for(l in 2:4){
  lines(sim[[l]]$r1[1:1000],col=col_vect_sim[l])
}
par(oldpar)
</code></pre>

<hr>
<h2 id='weather_multi_sites'>
Sample temperature and precipitation of four catchments derived from the ERA5-Land gridded dataset
</h2><span id='topic+weather_multi_sites'></span><span id='topic+weather+20multi+20sites'></span>

<h3>Description</h3>

<p>Reanalysis data of four grid cells from ERA5-Land.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("weather_multi_sites")</code></pre>


<h3>Format</h3>

<p>Contains two lists data_p and data_t containing precipitation and temperature
data, respectively.
Each list consists of four data frames (one list per station/grid cell) of the following 4 variables.
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>Precip/Temp</code></dt><dd><p>a numeric vector, observed precipitation/temperature</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data contains data for four grid cells in the Pacific Northwest.
</p>


<h3>Source</h3>

<p>The preciptation data were downloaded from ERA5-Land
<a href="https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=overview">https://cds.climate.copernicus.eu/cdsapp#!/dataset/reanalysis-era5-land?tab=overview</a>.
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(weather_multi_sites)
weather_multi_sites[[1]][[1]]$timestamp &lt;- paste(weather_multi_sites[[1]][[1]]$YYYY, 
weather_multi_sites[[1]][[1]]$MM, weather_multi_sites[[1]][[1]]$DD, sep=" ")
weather_multi_sites[[1]][[1]]$timestamp &lt;- 
as.POSIXct(strptime(weather_multi_sites[[1]][[1]]$timestamp,
format="%Y %m %d", tz="GMT"))
plot(weather_multi_sites[[1]][[1]]$timestamp[1:1000],
weather_multi_sites[[1]][[1]]$Qobs[1:1000], type="l", 
xlab="Time [d]", ylab=expression(paste("Temperature [degrees]")))
</code></pre>

<hr>
<h2 id='weather_sim_multi_sites'>
Simulated temperature and precipitation for two grid cells
</h2><span id='topic+weather.sim.multi.sites'></span><span id='topic+weather_sim_multi_sites'></span>

<h3>Description</h3>

<p>The dataset is generated with the package own routines and represent 5 series of 38 years of meteorological data for two grid cells
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("weather_sim_multi_sites")</code></pre>


<h3>Format</h3>

<p>Two lists (one per variable) of four elements (one per catchment), containing a data frame each holding information about the observed time series and the stochastic simulations
</p>

<dl>
<dt><code>YYYY</code></dt><dd><p>a numeric vector, year</p>
</dd>
<dt><code>MM</code></dt><dd><p>a numeric vector, month</p>
</dd>
<dt><code>DD</code></dt><dd><p>a numeric vector, day</p>
</dd>
<dt><code>timestamp</code></dt><dd><p><code>POSIXct</code> vector of the daily runoff</p>
</dd>
<dt><code>Prec/Temp</code></dt><dd><p>observed precipitation/temperature</p>
</dd>
<dt><code>r1</code>,...,<code>r5</code></dt><dd><p>5 simulated data series</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data is included to illustrate the validation and visualization routines in <code>demo("PRSim_weather-validate")</code>.
</p>


<h3>Source</h3>

<p>The data has been generated with 
</p>
<p><code>prsim.weather(data_p=data_p, data_t=data_t, number_sim=5, p_margin='egpd',t_margin='sep')</code> 
</p>
<p>(default values for all other arguments).
</p>


<h3>References</h3>

<p>Brunner, M. I., and E. Gilleland (2021). Spatial compound hot-dry events in the United States: assessment using a multi-site multi-variable weather generator, in preparation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>oldpar &lt;- par(mfrow = c(2, 1), mar = c(3, 3, 2, 1))
data(weather_sim_multi_sites)
sim &lt;- weather_sim_multi_sites
### define plotting colors
col_sim &lt;- adjustcolor("#fd8d3c",alpha=0.8)
col_sim_tran &lt;- adjustcolor("#fd8d3c",alpha=0.2)
col_obs &lt;- adjustcolor( "black", alpha.f = 0.2)
### greys
col_vect_obs &lt;- c('#cccccc','#969696','#636363','#252525')
### oranges
col_vect_sim &lt;- c('#fdbe85','#fd8d3c','#e6550d','#a63603')

### plot time series for multiple sites

### Temperature (first list entry)
par(mfrow=c(2,1),mar=c(3,3,2,1))
### determine ylim
ylim_max &lt;- max(sim[[1]][[1]]$Temp)*1.5
### observed
plot(sim[[1]][[1]]$Temp[1:1000],
ylab=expression(bold(paste("Temperature [degrees]"))),
xlab="Time [d]",type="l",col=col_vect_obs[1],
ylim=c(0,ylim_max),main='Observations')
for(l in 2){
  lines(sim[[l]][[1]]$Temp[1:1000],col=col_vect_obs[l])
}
# legend('topleft',legend=c('Station 1','Station 2'
# ),lty=1,col=col_vect_obs[1:2])
### simulated (one run)
plot(sim[[1]][[1]]$r1[1:1000],
ylab=expression(bold(paste("Temperature [degrees]"))),
xlab="Time [d]",type="l",col=col_vect_sim[1],
ylim=c(0,ylim_max),main='Stochastic simulations')
for(l in 2){
  lines(sim[[l]][[1]]$r1[1:1000],col=col_vect_sim[l])
}


### precipitation (second list entry)
ylim_max &lt;- max(sim[[1]][[2]]$Prec)*1
### observed
plot(sim[[1]][[2]]$Prec[1:1000],
ylab=expression(bold(paste("Precipitation [mm/d]"))),
xlab="Time [d]",type="l",col=col_vect_obs[1],
ylim=c(0,ylim_max),main='Observations')
for(l in 2){
  lines(sim[[l]][[2]]$Prec[1:1000],col=col_vect_obs[l])
}
# legend('topleft',legend=c('Station 1','Station 2'
# ),lty=1,col=col_vect_obs[1:2])
### simulated (one run)
plot(sim[[1]][[2]]$r1[1:1000],
ylab=expression(bold(paste("Precipitation [mm/d]"))),
xlab="Time [d]",type="l",col=col_vect_sim[1],
ylim=c(0,ylim_max),main='Stochastic simulations')
for(l in 2){
  lines(sim[[l]][[2]]$r1[1:1000],col=col_vect_sim[l])
}
par(oldpar)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
