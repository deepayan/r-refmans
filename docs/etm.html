<!DOCTYPE html><html><head><title>Help for package etm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {etm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#abortion'><p>Pregnancies exposed to coumarin derivatives</p></a></li>
<li><a href='#clos'><p>Change in Length of Stay</p></a></li>
<li><a href='#closPseudo'>
<p>Pseudo Value Regression for the Extra Length-of-Stay</p></a></li>
<li><a href='#etm'><p>Computation of the empirical transition matrix</p></a></li>
<li><a href='#etmCIF'>
<p>Cumulative incidence functions of competing risks</p></a></li>
<li><a href='#etmprep'>
<p>Data transformation function for using etm</p></a></li>
<li><a href='#fourD'>
<p>Placebo data from the 4D study</p></a></li>
<li><a href='#lines.etm'>
<p>Lines method for 'etm' objects</p></a></li>
<li><a href='#los.data'><p>Length of hospital stay</p></a></li>
<li><a href='#plot.clos.etm'>
<p>Plot method for 'clos.etm' objects</p></a></li>
<li><a href='#plot.etm'><p>Plot method for an etm object</p></a></li>
<li><a href='#plot.etmCIF'>
<p>Plot cumulative incidence functions</p></a></li>
<li><a href='#prepare.los.data'><p>Prepare the data for clos</p></a></li>
<li><a href='#print.clos.etm'>
<p>Print function for 'clos.etm' objects</p></a></li>
<li><a href='#print.etm'><p>Print method for object of class 'etm'</p></a></li>
<li><a href='#print.etmCIF'>
<p>Print function for <code>cifETM</code> objects</p></a></li>
<li><a href='#sir.cont'><p>Ventilation status in intensive care unit patients</p></a></li>
<li><a href='#summary.etm'><p>Summary methods for an 'etm' object</p></a></li>
<li><a href='#summary.etmCIF'>
<p>Summary function for cifETM</p></a></li>
<li><a href='#tra'>
<p>Matrix of possible transitions</p></a></li>
<li><a href='#trprob.etm'>
<p>Function to extract transition probabilities and (co)variance</p></a></li>
<li><a href='#xyplot.etm'><p>xyplot method for object of class 'etm'</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Empirical Transition Matrix</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>The etm (empirical transition matrix) package permits to estimate the matrix of transition probabilities for any time-inhomogeneous multi-state model with finite state space using the Aalen-Johansen estimator. Functions for data preparation and for displaying are also included (Allignol et al., 2011 &lt;<a href="https://doi.org/10.18637%2Fjss.v038.i04">doi:10.18637/jss.v038.i04</a>&gt;). Functionals of the Aalen-Johansen estimator, e.g., excess length-of-stay in an intermediate state, can also be computed (Allignol et al. 2011 &lt;<a href="https://doi.org/10.1007%2Fs00180-010-0200-x">doi:10.1007/s00180-010-0200-x</a>&gt;).</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Clements &lt;mark.clements@ki.se&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>survival, lattice, data.table, Rcpp (&ge; 0.11.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ggplot2, kmi, geepack</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-08 06:24:32 UTC; marcle</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-08 13:40:03 UTC</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Clements [aut, cre],
  Arthur Allignol [aut]</td>
</tr>
</table>
<hr>
<h2 id='abortion'>Pregnancies exposed to coumarin derivatives</h2><span id='topic+abortion'></span>

<h3>Description</h3>

<p>Outcomes of pregnancies exposed to coumarin derivatives. The aim is to
investigate whether exposition to coumarin derivatives increases the
probability of spontaneous abortions. Apart from spontaneous abortion,
pregnancy may end in induced abortion or live birth, leading to a
competing risks situation. Moreover, data are left-truncated as women
usually enter the study several weeks after conception.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(abortion)</code></pre>


<h3>Format</h3>

<p>A data frame with 1186 observations on the following 5 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Identification number</p>
</dd>
<dt><code>entry</code></dt><dd><p>Entry times into the cohort</p>
</dd>
<dt><code>exit</code></dt><dd><p>Event times</p>
</dd>
<dt><code>group</code></dt><dd><p>Group. 0: control, 1: exposed to coumarin
derivatives</p>
</dd>
<dt><code>cause</code></dt><dd><p>Cause of failure. 1: induced abortion, 2: life
birth, 3: spontaneous abortion</p>
</dd>
</dl>



<h3>Source</h3>

<p>Meiester, R. and Schaefer, C (2008). Statistical methods for
estimating the probability of spontaneous abortion in observational
studies &ndash; Analyzing pregnancies exposed to coumarin
derivatives. Reproductive Toxicology, 26, 31&ndash;35
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abortion)
</code></pre>

<hr>
<h2 id='clos'>Change in Length of Stay</h2><span id='topic+clos'></span><span id='topic+clos.etm'></span><span id='topic+clos.msfit'></span>

<h3>Description</h3>

<p>The function estimates the expected change in length of stay (LOS)
associated with an intermediate event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clos(x, aw, ratio, ...)
## S3 method for class 'etm'
clos(x, aw = FALSE, ratio = FALSE, ...)
## S3 method for class 'msfit'
clos(x, aw = FALSE, ratio = FALSE, cox_model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clos_+3A_x">x</code></td>
<td>
<p>An object of class <code>etm</code>. Argument <code>delta.na</code> in
<code><a href="#topic+etm">etm</a></code> must be set to <code>TRUE</code> in order to use this
function.</p>
</td></tr>
<tr><td><code id="clos_+3A_aw">aw</code></td>
<td>
<p>Logical. Whether to compute the expected change of LOS using
alternative weighting. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="clos_+3A_ratio">ratio</code></td>
<td>
<p>Logical. Compute the ratio of the expected length-of-stay
given instermediate event status instead of a difference. Default
value is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="clos_+3A_cox_model">cox_model</code></td>
<td>
<p>TODO</p>
</td></tr>
<tr><td><code id="clos_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approach for evaluating the impact of an intermediate
event on the expected change in length of stay is based on Schulgen
and Schumacher (1996). They suggested to consider the difference of
the expected subsequent stay given infectious status at time s. 
</p>
<p>Extensions to the methods of Schulgen and Schumacher and the earlier
implementation in the <span class="pkg">changeLOS</span> include the possibility to
compute the extra length of stay both for competing endpoints and the
more simple case of one absorbing state, as well as the possibility to
compute this quantity for left-truncated data. 
</p>


<h3>Value</h3>

<p>An object of class <code>clos.etm</code> with the following components:
</p>
<table>
<tr><td><code>e.phi</code></td>
<td>
<p>Change in length of stay</p>
</td></tr>
<tr><td><code>phi.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS} | X_s =
      \mbox{intermediate event})</code> for
all observed transition times <code class="reqn">s</code>, where
<code class="reqn">X_s</code>denotes the state by time <code class="reqn">s</code></p>
</td></tr>
<tr><td><code>phi.control</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS} | X_s =
      \mbox{initial state})</code> for
all observed transition times <code class="reqn">s</code>.</p>
</td></tr>
<tr><td><code>e.phi2</code></td>
<td>
<p>Weighted average of the difference between
<code>phi2.case</code> and <code>phi2.control</code>.</p>
</td></tr>
<tr><td><code>phi2.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{discharge}) | X_s =
      \mbox{intermediate event})</code>, where <code class="reqn">\mathbf{1}</code> denotes
the indicator function.</p>
</td></tr>
<tr><td><code>phi2.control</code></td>
<td>
<p><code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{discharge}) | X_s =
      \mbox{initial state})</code>.</p>
</td></tr>
<tr><td><code>e.phi3</code></td>
<td>
<p>Weighted average of the difference between
<code>phi3.case</code> and <code>phi3.control</code>.</p>
</td></tr>
<tr><td><code>phi3.case</code></td>
<td>
<p>Estimates of <code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{death}) | X_s =
      \mbox{intermediate event})</code>.</p>
</td></tr>
<tr><td><code>phi3.control</code></td>
<td>
<p><code class="reqn">E(\mbox{LOS}
      \mathbf{1}(X_{\mbox{LOS}} = \mbox{death}) | X_s =
      \mbox{initial state})</code>.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>Weights used to compute the weighted averages.</p>
</td></tr>
<tr><td><code>w.time</code></td>
<td>
<p>Times at which the weights are computed.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>All transition times.</p>
</td></tr>
<tr><td><code>e.phi.weights.1</code></td>
<td>
<p>Expected change in LOS using <code>weights.1</code></p>
</td></tr>
<tr><td><code>e.phi.weights.other</code></td>
<td>
<p>Expected change in LOS using
<code>weights.other</code></p>
</td></tr>
<tr><td><code>weights.1</code></td>
<td>
<p>Weights corresponding to the conditional waiting
time in the intial state given one experiences the intermediate event.</p>
</td></tr>
<tr><td><code>weights.other</code></td>
<td>
<p>Weights corresponding to the conditional
waiting time given one does not experience the intermediate event.</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>,
Matthias Wangler, Jan Beyersmann</p>


<h3>References</h3>

<p>G Schulgen and M Schumacher (1996). Estimation of prolongation of
hospital stay attributable to nosocomial infections.  <em>Lifetime
Data Analysis</em> 2, 219-240.
</p>
<p>J Beyersmann, P Gastmeier, H Grundmann, S Baerwolf, C Geffers,
M Behnke, H Rueden, and M Schumacher (2006). Use of Multistate
Models to Assess Prolongation of Intensive Care Unit Stay Due to
Nosocomial Infection. <em>Infection Control and Hospital
Epidemiology</em> 27, 493-499.
</p>
<p>Allignol A, Schumacher M, Beyersmann J: Estimating summary functionals
in multistate models with an application to hospital infection
data. <em>Computation Stat</em>, 2011; 26: 181-197.
</p>
<p>M Wrangler, J Beyersmann and M Schumacher (2006). changeLOS: An
R-package for change in length of hospital stay based on the
Aalen-Johansen estimator. <em>R News</em> 6(2), 31&ndash;35.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(los.data)

## putting los.data in the long format
my.observ &lt;- prepare.los.data(x=los.data)

tra &lt;- matrix(FALSE, 4, 4)
tra[1, 2:4] &lt;- TRUE
tra[2, 3:4] &lt;- TRUE

tr.prob &lt;- etm(my.observ, c("0","1","2","3"), tra, NULL, 0)

cLOS &lt;- etm::clos(tr.prob)
plot(cLOS)


### Compute bootstrapped SE

## function that performs the bootstrap
## nboot: number of bootstrap samples. Other arguments are as in etm()
boot.clos &lt;- function(data, state.names, tra, cens.name, s = 0, nboot) {
    res &lt;- double(nboot)
    for (i in seq_len(nboot)) {
        index &lt;- sample(unique(data$id), replace = TRUE)
        inds &lt;- new.id &lt;- NULL
        for (j in seq_along(index)){
            ind &lt;- which(data$id == index[j])
            new.id &lt;- c(new.id, rep(j, length(ind)))
            inds &lt;- c(inds, ind)
        }
        dboot &lt;- cbind(data[inds, ], new.id)
        dboot[, which(names(dboot) == "id")]
        dboot$id &lt;- dboot$new.id
        tr.prob &lt;- etm(dboot, state.names, tra, cens.name, s, cova = FALSE)
        res[i] &lt;- etm::clos(tr.prob)$e.phi
    }
    res
}

## bootstrap
se &lt;- sqrt(var(boot.clos(my.observ, c("0","1","2","3"), tra, NULL, 0,
                         nboot = 10)))
</code></pre>

<hr>
<h2 id='closPseudo'>
Pseudo Value Regression for the Extra Length-of-Stay
</h2><span id='topic+closPseudo'></span>

<h3>Description</h3>

<p>Pseudo Value Regression for the Extra Length-of-Stay
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closPseudo(data, state.names, tra, cens.name, s = 0,
           formula, na.action,
           aw = FALSE, ratio = FALSE,
           ncores = 1,
           trick_ties = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="closPseudo_+3A_data">data</code></td>
<td>

<p>data.frame of the form data.frame(id,from,to,time)
or (id,from,to,entry,exit)
</p>

<dl>
<dt>id:</dt><dd><p>patient id</p>
</dd>
<dt>from:</dt><dd><p>the state from where the transition occurs</p>
</dd>
<dt>to:</dt><dd><p>the state to which a transition occurs</p>
</dd>
<dt>time:</dt><dd><p>time when a transition occurs</p>
</dd>
<dt>entry:</dt><dd><p>entry time in a state</p>
</dd>
<dt>exit:</dt><dd><p>exit time from a state</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="closPseudo_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_tra">tra</code></td>
<td>
<p>A quadratic matrix of logical values describing the possible
transitions within the multistate model.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_cens.name">cens.name</code></td>
<td>
<p> A character giving the code for censored
observations in the column 'to' of <code>data</code>. If there is no
censored observations in your data, put 'NULL'.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_s">s</code></td>
<td>
<p>Starting value for computing the transition probabilities.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_formula">formula</code></td>
<td>
<p>A formula with the covariates at the right of a
<code>~</code> operator. Leave the left part empty.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_na.action">na.action</code></td>
<td>
<p>A function which indicates what should happen when the data
contain 'NA's.  The default is set by the 'na.action' setting
of 'options', and is 'na.fail' if that is unset.  The
'factory-fresh' default is 'na.omit'.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_aw">aw</code></td>
<td>
<p>Logical. Whether to compute the expected change of LOS using
alternative weighting. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_ratio">ratio</code></td>
<td>
<p>Logical. Compute the ratio of the expected length-of-stay
given instermediate event status instead of a difference. Default
value is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="closPseudo_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used if doing parallel computation using
the <span class="pkg">parallel</span> package</p>
</td></tr>
<tr><td><code id="closPseudo_+3A_trick_ties">trick_ties</code></td>
<td>
<p>If <code>TRUE</code>, pseudo values are computed only one
per subject sharing the same entry, exit times / transition types.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the pseudo-observations for the extra
length-of-stay for each individual. These pseudo-observations can then
be used to fit a direct regression model using generalized estimating
equation (e.g., package <span class="pkg">geepack</span>).
</p>
<p>Computation of the pseudo-observations can be parallelised using the
<code>mclapply</code> function of the <span class="pkg">parallel</span> package. See argument
<code>ncores</code>.
</p>
<p>Recent versions of R have changed the <code>data.frame</code> function,
where the default for the <code>stringsAsFactors</code>
argument from <code>TRUE</code> to <code>FALSE</code>. <code>etm</code> currently
depends on the states being factors, so that the user should use
<code>data.frame(..., stringsAsFactors=TRUE)</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>closPseudo</code> with the following components:
</p>
<table>
<tr><td><code>pseudoData</code></td>
<td>
<p>a data.frame containing <code>id</code>, computed pseudo
values (see details) and the covariates as specified in the formula</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>Estimates of excess LoS in the whole sample</p>
</td></tr>
<tr><td><code>aw</code></td>
<td>
<p>like in the function call</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Function call</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>References</h3>

<p>Andersen, P.K, Klein, J.P, Rosthoj, S. (2003). Generalised
linear  models for correlated pseudo-observations,
with applications to multi-state models. <em>Biometrika</em>,
90(1):15&ndash;27.
</p>


<h3>See Also</h3>

<p><code><a href="parallel.html#topic+mclapply">mclapply</a></code>, <code><a href="#topic+clos">clos</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require("kmi", quietly = TRUE)) {

    ## data in kmi package
    data(icu.pneu)
    my.icu.pneu &lt;- icu.pneu
    
    my.icu.pneu &lt;- my.icu.pneu[order(my.icu.pneu$id, my.icu.pneu$start), ]
    masque &lt;- diff(my.icu.pneu$id)
    
    my.icu.pneu$from &lt;- 0
    my.icu.pneu$from[c(1, masque) == 0] &lt;- 1
    
    my.icu.pneu$to2 &lt;- my.icu.pneu$event
    my.icu.pneu$to2[my.icu.pneu$status == 0] &lt;- "cens"
    my.icu.pneu$to2[c(masque, 1) == 0] &lt;- 1
    
    
    my.icu.pneu$to &lt;- ifelse(my.icu.pneu$to2 %in% c(2, 3), 2,
                             my.icu.pneu$to2)

    my.icu.pneu &lt;- my.icu.pneu[, c("id", "start", "stop", "from", "to",
                                   "to2", "age", "sex")]
    names(my.icu.pneu)[c(2, 3)] &lt;- c("entry", "exit")

    ## computation of the pseudo-observations
    ## Not run: 
        ps.icu.pneu &lt;- closPseudo(my.icu.pneu, c("0", "1", "2"), tra_ill(), "cens",
                                  formula = ~ sex + age)
        
        ## regression model using geepack
        require(geepack)
        fit &lt;- geeglm(ps.e.phi ~ sex + age, id = id, data = ps.icu.pneu$pseudoData,
                      family = gaussian)
        
        summary(fit)
    
## End(Not run)
} else {
    print("This example requires the kmi package")
}
</code></pre>

<hr>
<h2 id='etm'>Computation of the empirical transition matrix</h2><span id='topic+etm'></span><span id='topic+etm.data.frame'></span>

<h3>Description</h3>

<p>This function computes the empirical transition matrix, also called
Aalen-Johansen estimator, of the transition probability matrix of any
multistate model. The covariance matrix is also computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data.frame'
etm(data, state.names, tra, cens.name, s, t = "last",
    covariance = TRUE, delta.na = TRUE, modif = FALSE,
    c = 1, alpha = NULL, strata, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etm_+3A_data">data</code></td>
<td>
<p>data.frame of the form data.frame(id,from,to,time)
or (id,from,to,entry,exit)
</p>

<dl>
<dt>id:</dt><dd><p>patient id</p>
</dd>
<dt>from:</dt><dd><p>the state from where the transition occurs</p>
</dd>
<dt>to:</dt><dd><p>the state to which a transition occurs</p>
</dd>
<dt>time:</dt><dd><p>time when a transition occurs</p>
</dd>
<dt>entry:</dt><dd><p>entry time in a state</p>
</dd>
<dt>exit:</dt><dd><p>exit time from a state</p>
</dd>
</dl>

<p>This data.frame is transition-oriented, <em>i.e.</em> it contains one
row per transition, and possibly several rows per patient. Specifying
an entry and exit time permits to take into account left-truncation. </p>
</td></tr>
<tr><td><code id="etm_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the states names.</p>
</td></tr>
<tr><td><code id="etm_+3A_tra">tra</code></td>
<td>
<p>A quadratic matrix of logical values describing the possible
transitions within the multistate model. </p>
</td></tr>
<tr><td><code id="etm_+3A_cens.name">cens.name</code></td>
<td>
<p> A character giving the code for censored
observations in the column 'to' of <code>data</code>. If there is no
censored observations in your data, put 'NULL'.</p>
</td></tr>
<tr><td><code id="etm_+3A_s">s</code></td>
<td>
<p>Starting value for computing the transition probabilities.</p>
</td></tr>
<tr><td><code id="etm_+3A_t">t</code></td>
<td>
<p>Ending value. Default is &quot;last&quot;, meaning that the transition
probabilities are computed over <code class="reqn">(s, t]</code>, <code class="reqn">t</code>
being the last time in the data set.</p>
</td></tr>
<tr><td><code id="etm_+3A_covariance">covariance</code></td>
<td>
<p>Logical. Decide whether or not computing the
covariance matrix. May be useful for, say, simulations, as the variance
computation is a bit long. Default is TRUE.</p>
</td></tr>
<tr><td><code id="etm_+3A_delta.na">delta.na</code></td>
<td>
<p>Logical. Whether to export the array containing the
increments of the Nelson-Aalen estimator. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="etm_+3A_modif">modif</code></td>
<td>
<p>Logical. Whether to apply the modification of Lai and
Ying for small risk sets</p>
</td></tr>
<tr><td><code id="etm_+3A_c">c</code></td>
<td>
<p>Constant for the Lai and Ying modification. Either <code>c</code>
contains only one value that will be used for all the states,
otherwise <code>c</code> should be the same length as
<code>state.names</code>.</p>
</td></tr>
<tr><td><code id="etm_+3A_alpha">alpha</code></td>
<td>
<p>Constant for the Lai and Ying modification. If NULL (the
default) then only <code>c</code> is used and the Lai and Ying
modification discards the event times for which <code class="reqn">Y(t) \geq
      t</code>. Otherwise <code class="reqn">cn^\alpha</code> is used. It is
recommanded to let <code>alpha</code> equal NULL for multistate models.</p>
</td></tr>
<tr><td><code id="etm_+3A_strata">strata</code></td>
<td>
<p>Character vector giving variables on which to stratify
the analysis.</p>
</td></tr>
<tr><td><code id="etm_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data are considered to arise from a time-inhomogeneous Markovian
multistate model with finite state space, and possibly subject to
independent right-censoring and left-truncation.
</p>
<p>The matrix of the transition probabilities is estimated by the
Aalen-Johansen estimator / empirical transition matrix (Andersen et
al., 1993), which is the product integral over the time period
<code class="reqn">(s, t]</code> of I + the matrix of the increments of the
Nelson-Aalen estimates of the cumulative transition hazards. The
<code class="reqn">(i, j)-th</code> entry of the empirical transition matrix
estimates the transition probability of being in state <code class="reqn">j</code> at
time <code class="reqn">t</code> given that one has been in state j at time <code class="reqn">s</code>.
</p>
<p>The covariance matrix is computed using the recursion formula (4.4.19)
in Anderson et al. (1993, p. 295). This estimator of the covariance
matrix is an estimator of the Greenwood type.
</p>
<p>If the multistate model is not Markov, but censorship is entirely
random, the Aalen-Johansen estimator still consistently estimates the
state occupation probabilities of being in state <code class="reqn">i</code> at time
<code class="reqn">t</code> (Datta &amp; Satten, 2001; Glidden, 2002)
</p>
<p>Recent versions of R have changed the <code>data.frame</code> function,
where the default for the <code>stringsAsFactors</code>
argument from <code>TRUE</code> to <code>FALSE</code>. <code>etm</code> currently
depends on the states being factors, so that the user should use
<code>data.frame(..., stringsAsFactors=TRUE)</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>est</code></td>
<td>
<p>Transition probability estimates. This is a 3 dimension
array with the first dimension being the state from where transitions
occur, the second the state to which transitions occur, and the
last one being the event times.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>Estimated covariance matrix. Each cell of the matrix gives
the covariance between the transition probabilities given by the
rownames and the colnames, respectively.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Event times at which the transition probabilities are
computed. That is all the observed times between <code class="reqn">(s, t]</code>.</p>
</td></tr>
<tr><td><code>s</code></td>
<td>
<p>Start of the time interval.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>End of the time interval.</p>
</td></tr>
<tr><td><code>trans</code></td>
<td>
<p>A <code>data.frame</code> giving the possible transitions.</p>
</td></tr>
<tr><td><code>state.names</code></td>
<td>
<p>A vector of character giving the state names.</p>
</td></tr>
<tr><td><code>cens.name</code></td>
<td>
<p>How the censored observation are coded in the data
set.</p>
</td></tr>
<tr><td><code>n.risk</code></td>
<td>
<p>Matrix indicating the number of individuals at risk just
before an event</p>
</td></tr>
<tr><td><code>n.event</code></td>
<td>
<p>Array containing the number of transitions at each
times</p>
</td></tr>
<tr><td><code>delta.na</code></td>
<td>
<p>A 3d array containing the increments of the
Nelson-Aalen estimator.</p>
</td></tr>
<tr><td><code>ind.n.risk</code></td>
<td>
<p>When <code>modif</code> is true, risk set size for which
the indicator function is 1</p>
</td></tr>
</table>
<p>If the analysis is stratified, a list of <code>etm</code> objects is
returned.
</p>


<h3>Note</h3>

<p>Transitions into a same state, mathematically superfluous, are not
allowed. If transitions into the same state are detected in the data,
the function will stop. Equally, <code>diag(tra)</code> must be set to
FALSE, see the example below.</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>References</h3>

<p>Beyersmann J, Allignol A, Schumacher M: Competing Risks and Multistate
Models with R (Use R!), Springer Verlag, 2012 (Use R!)
</p>
<p>Allignol, A., Schumacher, M. and Beyersmann, J. (2011).
Empirical Transition Matrix of Multi-State Models: The etm Package.
<em>Journal of Statistical Software</em>, 38.
</p>
<p>Andersen, P.K., Borgan, O., Gill, R.D. and Keiding,
N. (1993). <em>Statistical models based on counting
processes</em>. Springer Series in Statistics. New York, NY: Springer.
</p>
<p>Aalen, O. and Johansen, S. (1978). An empirical transition matrix for
non-homogeneous Markov chains based on censored
observations. <em>Scandinavian Journal of Statistics</em>, 5: 141-150.
</p>
<p>Gill, R.D. and Johansen, S. (1990). A survey of product-integration
with a view towards application in survival analysis. <em>Annals of
statistics</em>, 18(4): 1501-1555.
</p>
<p>Datta, S. and Satten G.A. (2001). Validity of the Aalen-Johansen
estimators of stage occupation probabilities and Nelson-Aalen
estimators of integrated transition hazards for non-Markov
models. <em>Statistics and Probability Letters</em>, 55(4): 403-411.
</p>
<p>Glidden, D. (2002). Robust inference for event probabilities with
non-Markov data. <em>Biometrics</em>, 58: 361-368.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.etm">print.etm</a></code>, <code><a href="#topic+summary.etm">summary.etm</a></code>, <code><a href="#topic+sir.cont">sir.cont</a></code>,
<code><a href="#topic+xyplot.etm">xyplot.etm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sir.cont)

# Modification for patients entering and leaving a state
# at the same date
# Change on ventilation status is considered
# to happen before end of hospital stay
sir.cont &lt;- sir.cont[order(sir.cont$id, sir.cont$time), ]
for (i in 2:nrow(sir.cont)) {
  if (sir.cont$id[i]==sir.cont$id[i-1]) {
    if (sir.cont$time[i]==sir.cont$time[i-1]) {
      sir.cont$time[i-1] &lt;- sir.cont$time[i-1] - 0.5
    }
  }
}

### Computation of the transition probabilities
# Possible transitions.
tra &lt;- matrix(ncol=3,nrow=3,FALSE)
tra[1, 2:3] &lt;- TRUE
tra[2, c(1, 3)] &lt;- TRUE

# etm
tr.prob &lt;- etm(sir.cont, c("0", "1", "2"), tra, "cens", 1)

tr.prob
summary(tr.prob)

# plotting
if (require("lattice")) {
xyplot(tr.prob, tr.choice=c("0 0", "1 1", "0 1", "0 2", "1 0", "1 2"),
       layout=c(2, 3), strip=strip.custom(bg="white",
         factor.levels=
     c("0 to 0", "1 to 1", "0 to 1", "0 to 2", "1 to 0", "1 to 2")))
}

### example with left-truncation

data(abortion)

# Data set modification in order to be used by etm
names(abortion) &lt;- c("id", "entry", "exit", "from", "to")
abortion$to &lt;- abortion$to + 1

## computation of the matrix giving the possible transitions
tra &lt;- matrix(FALSE, nrow = 5, ncol = 5)
tra[1:2, 3:5] &lt;- TRUE

## etm
fit &lt;- etm(abortion, as.character(0:4), tra, NULL, s = 0)

## plot
xyplot(fit, tr.choice = c("0 0", "1 1", "0 4", "1 4"),
       ci.fun = c("log-log", "log-log", "cloglog", "cloglog"),
       strip = strip.custom(factor.levels = c("P(T &gt; t) -- control",
                                              "P(T &gt; t) -- exposed",
                                 "CIF spontaneous abortion -- control",
                                 "CIF spontaneous abortion --
exposed")))
</code></pre>

<hr>
<h2 id='etmCIF'>
Cumulative incidence functions of competing risks
</h2><span id='topic+etmCIF'></span>

<h3>Description</h3>

<p><code>etmCIF</code> is a wrapper around the <code>etm</code> function for
facilitating the computation of the cumulative incidence functions in
the competing risks framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etmCIF(formula, data, etype, subset, na.action, failcode = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etmCIF_+3A_formula">formula</code></td>
<td>
<p>A <code>formula</code> object, that must have a <code>Surv</code>
object on the left of ~ operator, and a discrete covariate (or 1) on
the right. The status indicator should be 1 (or TRUE) for an event
(whatever the type of this event, 0 (or FALSE) for censored
observations.)</p>
</td></tr>
<tr><td><code id="etmCIF_+3A_data">data</code></td>
<td>
<p>A data.frame in which to interpret the terms of the
formula</p>
</td></tr>
<tr><td><code id="etmCIF_+3A_etype">etype</code></td>
<td>
<p>Competing risks event indicator. When the status
indicator is 1 (or TRUE) in the formula, <code>etype</code> describes the
type of event, otherwise, for censored observation, the value of
<code>etype</code> is ignored</p>
</td></tr>
<tr><td><code id="etmCIF_+3A_subset">subset</code></td>
<td>
<p>Expression saying that only a subset of the data should
be used.</p>
</td></tr>
<tr><td><code id="etmCIF_+3A_na.action">na.action</code></td>
<td>
<p>Missing-data filter function. Default is
<code>options()$na.action</code>.</p>
</td></tr>
<tr><td><code id="etmCIF_+3A_failcode">failcode</code></td>
<td>
<p>Indicates the failure type of interest. Default is
one. This option is only relevant for some options of the
<code>plot</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the cumulative incidence functions in a
competing risks setting using the <code>etm</code> machinery, without having
to specify the matrix of possible transitions and using the more usual
formula specification with <code>Surv</code>
</p>


<h3>Value</h3>

<p>Returns a list of <code>etm</code> objects (1 per covariate level) plus
additional informations:
</p>
<table>
<tr><td><code>failcode</code></td>
<td>
<p>As in function call</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>Function call</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>A matrix giving the name of the covariate (if present) and
the levels of this covariate.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.alignol@gmail.com">arthur.alignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>, <code><a href="#topic+print.etmCIF">print.etmCIF</a></code>,
<code><a href="#topic+summary.etmCIF">summary.etmCIF</a></code>, <code><a href="#topic+plot.etmCIF">plot.etmCIF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(abortion)

cif.ab &lt;- etmCIF(survival::Surv(entry, exit, cause != 0) ~ group, abortion,
                 etype = cause, failcode = 3)

cif.ab

plot(cif.ab, ci.type = "bars", pos.ci = 24,
     col = c(1, 2), lty = 1, curvlab = c("Control", "Exposed"))

</code></pre>

<hr>
<h2 id='etmprep'>
Data transformation function for using etm
</h2><span id='topic+etmprep'></span>

<h3>Description</h3>

<p>The function transforms a data set in the wide format (i.e., one raw
per subject) into the long format (i.e., one raw per transition, and
possibly several raws per subjects) in a suitable way for using the
<code>etm</code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>etmprep(time, status, data, tra, state.names, cens.name = NULL,
start = NULL, id = NULL, keep)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="etmprep_+3A_time">time</code></td>
<td>
<p>A character vector giving the name of the columns
containing the transition times or last follow-up times. The
length of <code>time</code> have to be equal to the number of states, some
elements may be NA. See Details.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_status">status</code></td>
<td>
<p>A character vector giving the name of the columns
indicating whether a state has been visited (0 if not, 1
otherwise).</p>
</td></tr>
<tr><td><code id="etmprep_+3A_data">data</code></td>
<td>
<p>A data frame in which to look for the columns specified in
<code>time</code> and <code>status</code>.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_tra">tra</code></td>
<td>
<p>A quadratic matrix of logical values describing the
possible transitions within the multistate model. The <code class="reqn">(i,
      j)</code>th element of <code>tra</code> is TRUE if a transition from
state <code class="reqn">i</code> to state <code class="reqn">j</code> is possible, FALSE
otherwise. The diagonal must be set to FALSE.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the states names. If
missing, state names are set to be 0:(number of states).</p>
</td></tr>
<tr><td><code id="etmprep_+3A_cens.name">cens.name</code></td>
<td>
<p>A character string specifying how censored
observations will be indicated in the new data set. Default is NULL,
i.e., no censored observation.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_start">start</code></td>
<td>
<p>A list containing two elements, <code>state</code> and
<code>time</code>, giving the starting states and times for all
individuals. Default is NULL, in which case all individuals are
considered to start in the initial state at time 0.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_id">id</code></td>
<td>
<p>A character string specifying in which column of <code>data</code>
the user ids are. Default is NULL, and the ids will be <code>1:n</code>.</p>
</td></tr>
<tr><td><code id="etmprep_+3A_keep">keep</code></td>
<td>
<p>A character vector indicating the column names of the
covariate one might want to keep in the new data.frame.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only works for irreversible acyclic Markov processes. 
Therefore, the multistate model will have initial
states, into which no transition are possible. For these, NAs are
allowed in <code>time</code> and <code>status</code>.
</p>


<h3>Value</h3>

<p>The function returns a data.frame suitable for using the <code>etm</code>
function. The data frame contains the following components:
</p>
<table>
<tr><td><code>id</code></td>
<td>
<p>Individual id number</p>
</td></tr>
<tr><td><code>entry</code></td>
<td>
<p>Entry time into a state</p>
</td></tr>
<tr><td><code>exit</code></td>
<td>
<p>Exit time from a state</p>
</td></tr>
<tr><td><code>from</code></td>
<td>
<p>State from which a transition occurs</p>
</td></tr>
<tr><td><code>to</code></td>
<td>
<p>State into which a transition occurs</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>Further columns specified in <code>keep</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### creation of fake data in the wild format, following an illness-death model
## transition times
tdisease &lt;- c(3, 4, 3, 6, 8, 9)
tdeath &lt;- c(6, 9, 8, 6, 8, 9)

## transition status
stat.disease &lt;- c(1, 1, 1, 0, 0, 0)
stat.death &lt;- c(1, 1, 1, 1, 1, 0)

## a covariate that we want to keep in the new data
cova &lt;- rbinom(6, 1, 0.5)

dat &lt;- data.frame(tdisease, tdeath,
                  stat.disease, stat.death,
                  cova, stringsAsFactors = TRUE)

## Possible transitions
tra &lt;- matrix(FALSE, 3, 3)
tra[1, 2:3] &lt;- TRUE
tra[2, 3] &lt;- TRUE

## data preparation
newdat &lt;- etmprep(c(NA, "tdisease", "tdeath"),
                  c(NA, "stat.disease", "stat.death"),
                  data = dat, tra = tra, cens.name = "cens")
</code></pre>

<hr>
<h2 id='fourD'>
Placebo data from the 4D study
</h2><span id='topic+fourD'></span>

<h3>Description</h3>

<p>Data from the placebo group of the 4D study. This study aimed at
comparing atorvastatin to placebo for patients with type 2 diabetes
and receiving hemodialysis in terms of cariovascular events. The
primary endpoint was a composite of
death from cardiac causes, stroke and non-fatal myocardial infarction.
Competing event was death from other causes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(fourD)</code></pre>


<h3>Format</h3>

<p>A data frame with 636 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>Patients' id number</p>
</dd>
<dt><code>sex</code></dt><dd><p>Patients' gender</p>
</dd>
<dt><code>age</code></dt><dd><p>Patients' age</p>
</dd>
<dt><code>medication</code></dt><dd><p>Character vector indicating treatment
affiliation. Here only equal to <code>"Placebo"</code></p>
</dd>
<dt><code>status</code></dt><dd><p>Status at the end of the follow-up. 1 for the
event of interest, 2 for death from other causes and 0 for
censored observations</p>
</dd>
<dt><code>time</code></dt><dd><p>Survival time</p>
</dd>
<dt><code>treated</code></dt><dd><p>Numeric vector indicated whether patients are
treated or not. Here always equal to zero</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wanner, C., Krane, V., Maerz, W., Olschewski, M., Mann, J., Ruf, G.,
Ritz, E (2005). Atorvastatin in patients with type 2 diabetes mellitus
undergoing hemodialysis. New England Journal of Medicine, 353(3),
238&ndash;248.
</p>


<h3>References</h3>

<p>Allignol, A., Schumacher, M., Wanner, C., Dreschler, C. and
Beyersmann, J. (2010). Understanding competing risks: a simulation
point of view. Research report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(fourD)
</code></pre>

<hr>
<h2 id='lines.etm'>
Lines method for 'etm' objects
</h2><span id='topic+lines.etm'></span>

<h3>Description</h3>

<p>Lines method for <code>etm</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
lines(x, tr.choice, col = 1, lty,
      conf.int = FALSE, level = 0.95, ci.fun = "linear",
      ci.col = col, ci.lty = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lines.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>etm</code>.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>character vector of the form <code>c("from to","from to")</code>
specifying which transitions should be plotted. By default, all the
direct transition probabilities are plotted</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_col">col</code></td>
<td>
<p>Vector of colours. Default is black.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical specifying whether to plot confidence
intervals. Default is FALSE.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_level">level</code></td>
<td>
<p>Level of the confidence interval. Default is 0.95.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_ci.fun">ci.fun</code></td>
<td>
<p>Transformation applied to the confidence intervals. It
could be different for all transition probabilities, though if
<code>length(ci.fun) != number of transitions</code>, only <code>ci.fun[1]</code>
will be used. Possible choices are &quot;linear&quot;, &quot;log&quot;, &quot;log-log&quot; and
&quot;cloglog&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colours of the confidence intervals. Default value is
the same as <code>col</code>.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line types for the confidence intervals. Default is 3.</p>
</td></tr>
<tr><td><code id="lines.etm_+3A_...">...</code></td>
<td>
<p>Further arguments for <code>lines</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>, <code><a href="#topic+plot.etm">plot.etm</a></code>, <code><a href="#topic+xyplot.etm">xyplot.etm</a></code>
</p>

<hr>
<h2 id='los.data'>Length of hospital stay</h2><span id='topic+los.data'></span>

<h3>Description</h3>

<p> The <code>los.data</code> data frame has 756 rows, one row for
each patient, and 7 columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(los.data)</code></pre>


<h3>Format</h3>

<p>A data frame with the following columns:
</p>

<dl>
<dt>adm.id</dt><dd><p> admision id of the patient</p>
</dd>
<dt>j.01</dt><dd><p> observed time for jump from 0 (initial state) to 1
(intermediate state)</p>
</dd>
<dt>j.02</dt><dd><p> observed time for jump from 0 to 2 (discharge)</p>
</dd>
<dt>j.03</dt><dd><p> observed time for jump from 0 to 3 (death)</p>
</dd>
<dt>j.12</dt><dd><p> observed time for jump from 1 to 2</p>
</dd>
<dt>j.13</dt><dd><p> observed time for jump from 1 to 3</p>
</dd>
<dt>cens</dt><dd><p> censoring time (either in initial or intermediate state) </p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(los.data)
my.data &lt;- prepare.los.data(los.data)
</code></pre>

<hr>
<h2 id='plot.clos.etm'>
Plot method for 'clos.etm' objects
</h2><span id='topic+plot.clos.etm'></span>

<h3>Description</h3>

<p>Plot method for objects of class <code>clos.etm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clos.etm'
plot(x, xlab = "Time", ylab.e = "Expected LOS",
ylab.w = "Weights", xlim, ylim.e, ylim.w, col.e = c(1, 2), col.w = 1,
lty.e = c(1, 1), lty.w = 1, legend = TRUE, legend.pos, curvlab,
legend.bty = "n", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.clos.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>clos.etm</code></p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_ylab.e">ylab.e</code></td>
<td>
<p>Label for the y-axis in the plot of the expected LOS</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_ylab.w">ylab.w</code></td>
<td>
<p>Label for the y-axis in the plot of the weights</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plots</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_ylim.e">ylim.e</code></td>
<td>
<p>Limits of the y-axis for the expected LOS plot</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_ylim.w">ylim.w</code></td>
<td>
<p>Limits of the y-axis for the weights plot</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_col.e">col.e</code></td>
<td>
<p>Vector of colours for the plot of expected LOS</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_col.w">col.w</code></td>
<td>
<p>Vector of colours for the plot of the weights</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_lty.e">lty.e</code></td>
<td>
<p>Vector of line type for the plot of expected LOS</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_lty.w">lty.w</code></td>
<td>
<p>Vector of line type for the plot of the weights</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_legend">legend</code></td>
<td>
<p>Logical. Whether to draw a legend for the plot of
expected LOS</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position. See
<code><a href="graphics.html#topic+legend">legend</a></code> for details</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_curvlab">curvlab</code></td>
<td>
<p>Character or expression vector to appear in the
legend. Default is <code>c("Intermediate event by time t", "No
      intermediate event by time t")</code></p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend</p>
</td></tr>
<tr><td><code id="plot.clos.etm_+3A_...">...</code></td>
<td>
<p>Further arguments for plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two graphs are drawn. The lower graph displays the expected LOS for
patients who have experienced the intermediate event and for those who
have not. The upper graph displays the weights used to compute
the weighted average.
</p>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>, Matthias Wangler
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clos">clos</a></code>
</p>

<hr>
<h2 id='plot.etm'>Plot method for an etm object</h2><span id='topic+plot.etm'></span>

<h3>Description</h3>

<p>Plot method for an object of class 'etm'. It draws the estimated
transition probabilities in a basic scatterplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
plot(x, tr.choice, xlab = "Time",
     ylab = "Transition Probability", col = 1, lty, xlim, ylim,
     conf.int = FALSE, level = 0.95, ci.fun = "linear",
     ci.col = col, ci.lty = 3,
     legend = TRUE, legend.pos, curvlab, legend.bty = "n", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.etm_+3A_x">x</code></td>
<td>
<p>An object of class 'etm'</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_tr.choice">tr.choice</code></td>
<td>
<p> character vector of the form 'c(&quot;from to&quot;,&quot;from
to&quot;)' specifying which transitions should be plotted. Default, all
the transition probabilities are plotted</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label. Default is &quot;Time&quot;</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. Default is &quot;Transition Probability&quot;</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_col">col</code></td>
<td>
<p>Vector of colour. Default is black</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_lty">lty</code></td>
<td>
<p>Vector of line type. Default is 1:number of transitions</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_xlim">xlim</code></td>
<td>
<p>Limits of x-axis for the plot</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_ylim">ylim</code></td>
<td>
<p>Limits of y-axis for the plot</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to display pointwise confidence
intervals. Default is FALSE.</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_level">level</code></td>
<td>
<p>Level of the conficence intervals. Default is 0.95.</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_ci.fun">ci.fun</code></td>
<td>
<p>Transformation applied to the confidence intervals. It
could be different for all transition probabilities, though if
<code>length(ci.fun) != number of transitions</code>, only <code>ci.fun[1]</code>
will be used. Possible choices are &quot;linear&quot;, &quot;log&quot;, &quot;log-log&quot; and
&quot;cloglog&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour of the confidence intervals. Default is
<code>col</code>.</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type of the confidence intervals. Default is 3.</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_legend">legend</code></td>
<td>
<p>A logical specifying if a legend should be added</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position. See
<code><a href="graphics.html#topic+legend">legend</a></code> for further details</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the
legend. Default is the name of the transitions</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend</p>
</td></tr>
<tr><td><code id="plot.etm_+3A_...">...</code></td>
<td>
<p>Further arguments for plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, if the argument <code>strata</code> was used for creating the <code>etm</code>
object, the first transition probability for all strata will be
plotted. If there is no strata, all transition probabilities are
plotted by default.
</p>
<p>In any case, a legend with be created by the labels are likely to be
ugly. Please use the <code>curvlab</code> argument to control the test or
use <code>legend = FALSE</code> and build your own legend. 
</p>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot.default">plot.default</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, <code><a href="#topic+etm">etm</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sir.cont)

# Modification for patients entering and leaving a state
# at the same date
sir.cont &lt;- sir.cont[order(sir.cont$id, sir.cont$time), ]
for (i in 2:nrow(sir.cont)) {
  if (sir.cont$id[i]==sir.cont$id[i-1]) {
    if (sir.cont$time[i]==sir.cont$time[i-1]) {
      sir.cont$time[i-1] &lt;- sir.cont$time[i-1] - 0.5
    }
  }
}

tra &lt;- matrix(ncol=3,nrow=3,FALSE)
tra[1, 2:3] &lt;- TRUE
tra[2, c(1, 3)] &lt;- TRUE

my.etm &lt;- etm(sir.cont,c("0","1","2"),tra,"cens", s = 0)

plot(my.etm, tr.choice = c("0 0"))
</code></pre>

<hr>
<h2 id='plot.etmCIF'>
Plot cumulative incidence functions
</h2><span id='topic+plot.etmCIF'></span>

<h3>Description</h3>

<p>Plot function for <code>etmCIF</code> objects. The function plots cumulative
incidence curves, possibly with pointwise confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etmCIF'
plot(x, which.cif, xlim, ylim,
    ylab = "Cumulative Incidence", xlab = "Time", col = 1, lty, lwd = 1,
    ci.type = c("none", "bars", "pointwise"), ci.fun = "cloglog",
    ci.col = col, ci.lty = 3, legend = TRUE, legend.pos, curvlab,
    legend.bty = "n", pos.ci = 27, ci.lwd = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.etmCIF_+3A_x">x</code></td>
<td>
<p>A <code>etmCIF</code> object</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_which.cif">which.cif</code></td>
<td>
<p>A numeric vector indicating which CIFs should be
plotted. When missing, only the CIF of interest is plotted
(determined through the <code>failcode</code> argument in <code><a href="#topic+etmCIF">etmCIF</a></code>.)</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits for the plot. By default, <code>c(0, max(time))</code></p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ylim">ylim</code></td>
<td>
<p>y-axis limits. Default is <code>c(0, 1)</code></p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ylab">ylab</code></td>
<td>
<p>Label for y-axis. Default is <code>"Cumulative Incidence"</code></p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_xlab">xlab</code></td>
<td>
<p>Label for x-axis. Default is &quot;Time&quot;</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_col">col</code></td>
<td>
<p>Vector describing colours used for the CIF curves. Default
is black</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_lty">lty</code></td>
<td>
<p>Vector of line type</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_lwd">lwd</code></td>
<td>
<p>Thickness of the lines</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ci.type">ci.type</code></td>
<td>
<p>One of <code>c("none", "bars",
      "pointwise")</code>. <code>none</code> plots no confidence interval,
<code>bars</code> plots the confidence intervals in the form of a segment
for one time point, and <code>pointwise</code> draws pointwise confidence
intervals for the whole follow-up period.</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ci.fun">ci.fun</code></td>
<td>
<p>Transformation used for the confidence intervals. Default is
&quot;clolog&quot;, and is a better choice for cumulative incidences. Other
choices are &quot;log&quot; and &quot;log-log&quot;</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ci.col">ci.col</code></td>
<td>
<p>Colour for the pointwise confidence interval
curves. Default is same as the CIF curves</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ci.lty">ci.lty</code></td>
<td>
<p>Line type for the confidence intervals. Default is 3</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_legend">legend</code></td>
<td>
<p>Logical. Whether to draw a legend. Default is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_legend.pos">legend.pos</code></td>
<td>
<p>A vector giving the legend's position. See
<code><a href="graphics.html#topic+legend">legend</a></code> for further details</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_curvlab">curvlab</code></td>
<td>
<p>A character or expression vector to appear in the
legend. Default is CIF + event label</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_legend.bty">legend.bty</code></td>
<td>
<p>Box type for the legend. Default is none (&quot;n&quot;)</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_pos.ci">pos.ci</code></td>
<td>
<p>If <code>ci.type = "bars"</code>, vector of integers indicating at which
time point to put the confidence interval bars. Default is 27</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_ci.lwd">ci.lwd</code></td>
<td>
<p>Thickness of the confidence interval segment (for
<code>ci.type = "bars"</code>)</p>
</td></tr>
<tr><td><code id="plot.etmCIF_+3A_...">...</code></td>
<td>
<p>Further graphical arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function relies on <code>plot.etm</code> and <code>lines.etm</code> with more
or less the same options. Exception is the drawing of the confidence
intervals, for which several displays are possible.
</p>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etmCIF">etmCIF</a></code>, <code><a href="#topic+plot.etm">plot.etm</a></code>, <code><a href="#topic+lines.etm">lines.etm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(abortion)

cif.ab &lt;- etmCIF(survival::Surv(entry, exit, cause != 0) ~ group, abortion,
                 etype = cause, failcode = 3)

cif.ab

plot(cif.ab, ci.type = "bars", pos.ci = 24,
     col = c(1, 2), lty = 1, curvlab = c("Control", "Exposed"))

plot(cif.ab, which = c(1, 2))
</code></pre>

<hr>
<h2 id='prepare.los.data'>Prepare the data for clos</h2><span id='topic+prepare.los.data'></span>

<h3>Description</h3>

<p>Prepare data to be passed to clos() in package etm.</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare.los.data(x) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare.los.data_+3A_x">x</code></td>
<td>
<p>data.frame of the form data.frame(id, j.01, j.02, j.03, j.12, j.13, cens):
</p>

<dl>
<dt>id:</dt><dd><p>id (patient id, admision id)</p>
</dd>      
<dt>j.01:</dt><dd><p>observed time for jump from 0 to 1</p>
</dd>
<dt>j.02:</dt><dd><p>observed time for jump from 0 to 2</p>
</dd>
<dt>j.03:</dt><dd><p>observed time for jump from 0 to 3</p>
</dd>
<dt>j.12:</dt><dd><p>observed time for jump from 1 to 2</p>
</dd>
<dt>j.13:</dt><dd><p>observed time for jump from 1 to 3</p>
</dd>
<dt>cens:</dt><dd><p>censoring time (either in initial or intermediate state)</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p> a data.frame of the form data.frame(id, from, to, time, oid):
</p>
<table>
<tr><td><code>id:</code></td>
<td>
<p> id (patient id, admision id)</p>
</td></tr>
<tr><td><code>from:</code></td>
<td>
<p> the state from where a transition occurs</p>
</td></tr>
<tr><td><code>to:</code></td>
<td>
<p> the state to which a transition occurs</p>
</td></tr>
<tr><td><code>time:</code></td>
<td>
<p> time of the transition</p>
</td></tr>
<tr><td><code>oid:</code></td>
<td>
<p> the observation id</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Matthias Wangler</p>


<h3>See Also</h3>

 <p><code><a href="#topic+clos">clos</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(los.data)
my.observ &lt;- prepare.los.data(x=los.data)
</code></pre>

<hr>
<h2 id='print.clos.etm'>
Print function for 'clos.etm' objects
</h2><span id='topic+print.clos.etm'></span>

<h3>Description</h3>

<p>Print method for object of class <code>clos.etm</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clos.etm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.clos.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>clos.etm</code></p>
</td></tr>
<tr><td><code id="print.clos.etm_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clos">clos</a></code>
</p>

<hr>
<h2 id='print.etm'>Print method for object of class 'etm'</h2><span id='topic+print.etm'></span>

<h3>Description</h3>

<p>Print method for objects of class <code>etm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
print(x, covariance = FALSE, whole = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>etm</code>.</p>
</td></tr>
<tr><td><code id="print.etm_+3A_covariance">covariance</code></td>
<td>
<p>Whether print the covariance matrix. Default is
TRUE</p>
</td></tr>
<tr><td><code id="print.etm_+3A_whole">whole</code></td>
<td>
<p>Whether to plot the entire covariance matrix. If set to
FALSE, rows and columns containing only 0 will be removed for
printing.</p>
</td></tr>
<tr><td><code id="print.etm_+3A_...">...</code></td>
<td>
<p>Further arguments for print or summary.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function prints a matrix giving the possible transitions, along
with the estimates of <code class="reqn">P(s, t)</code> and <code class="reqn">cov(P(s,
    t))</code>.
</p>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code></p>

<hr>
<h2 id='print.etmCIF'>
Print function for <code>cifETM</code> objects
</h2><span id='topic+print.etmCIF'></span>

<h3>Description</h3>

<p>Print method for <code>cifETM</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etmCIF'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.etmCIF_+3A_x">x</code></td>
<td>
<p>An object of class <code>etmCIF</code></p>
</td></tr>
<tr><td><code id="print.etmCIF_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No value returned
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etmCIF">etmCIF</a></code>
</p>

<hr>
<h2 id='sir.cont'>Ventilation status in intensive care unit patients</h2><span id='topic+sir.cont'></span>

<h3>Description</h3>

<p>Time-dependent ventilation status for intensive care unit (ICU)
patients, a random sample from the SIR-3 study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sir.cont)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1141 rows and 6 columns:
</p>

<dl>
<dt>id:</dt><dd><p>Randomly generated patient id</p>
</dd>
<dt>from:</dt><dd><p>State from which a transition occurs</p>
</dd>
<dt>to:</dt><dd><p>State to which a transition occurs</p>
</dd>
<dt>time:</dt><dd><p>Time when a transition occurs</p>
</dd>
<dt>age:</dt><dd><p>Age at inclusion</p>
</dd>
<dt>sex:</dt><dd><p>Sex. <code>F</code> for female and <code>M</code> for male</p>
</dd>
</dl>

<p>The possible states are:
</p>
<p>0: No ventilation
</p>
<p>1: Ventilation
</p>
<p>2: End of stay
</p>
<p>And <code>cens</code> stands for censored observations.
</p>


<h3>Details</h3>

<p>This data frame consists in a random sample of the SIR-3 cohort
data. It focuses on the effect of ventilation on the length of stay
(combined endpoint discharge/death). Ventilation status is considered
as a transcient state in an illness-death model. 
</p>
<p>The data frame is directly formated to be used with the <code>etm</code>
function, i.e. it is transition-oriented with one row per transition.
</p>


<h3>References</h3>

<p>Beyersmann, J., Gastmeier, P., Grundmann, H.,
Baerwolff, S., Geffers, C., Behnke, M.,
Rueden, H., and Schumacher, M. Use of multistate
models to assess prolongation of intensive care unit stay due to
nosocomial infection. <em>Infection Control and Hospital
Epidemiology</em>, 27:493-499, 2006.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sir.cont)
</code></pre>

<hr>
<h2 id='summary.etm'>Summary methods for an 'etm' object</h2><span id='topic+summary.etm'></span><span id='topic+print.summary.etm'></span>

<h3>Description</h3>

<p>Summary method for objects of class <code>etm</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
summary(object, tr.choice,
        ci.fun = "linear", level = 0.95, times, ...)
## S3 method for class 'summary.etm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.etm_+3A_object">object</code></td>
<td>
<p>An object of class <code>etm</code>.</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>Character vector of the form 'c(&quot;from to&quot;,&quot;from
to&quot;)' specifying which transitions should be summarized. Default to all
the transition probabilities</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_ci.fun">ci.fun</code></td>
<td>
<p>A character vector specifying the transformation to be
applied to the pointwise confidence intervals. It could be different
for each transition probability, though if <code>length(ci.fun) !=
      number of transitions</code>, only <code>ci.fun[1]</code> will be used. The
function displays the transition probabilities in the following
order: first the direct transitions in alphabetical order, e.g., 0 to
1, 0 to 2, 1 to 2, ..., then the state occupation probabilities in
alphabetical order, e.g., 0 to 0, 1 to 1, ... The
possible transformations are &quot;linear&quot;, &quot;log&quot;, &quot;log-log&quot; and
&quot;cloglog&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_level">level</code></td>
<td>
<p>Level of the two-sided confidence intervals. Default is
0.95.</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_x">x</code></td>
<td>
<p>A <code>summary.cpf</code> object</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_times">times</code></td>
<td>
<p>Time points for which estimates should be
returned. Default to all transition times.</p>
</td></tr>
<tr><td><code id="summary.etm_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of data.frames giving the transition probability and stage
occupation probability estimates. List items are named after the
possible transition.
</p>
<table>
<tr><td><code>P</code></td>
<td>
<p>Transition probability estimates</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Variance estimates</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>Lower confidence limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>Upper confidence limit</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Transition times</p>
</td></tr>
<tr><td><code>n.risk</code></td>
<td>
<p>Number of individuals at risk of experiencing a transition
just before time <code class="reqn">t</code></p>
</td></tr>
<tr><td><code>n.event</code></td>
<td>
<p>Number of events at time <code class="reqn">t</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code></p>

<hr>
<h2 id='summary.etmCIF'>
Summary function for cifETM
</h2><span id='topic+summary.etmCIF'></span><span id='topic+print.summary.etmCIF'></span>

<h3>Description</h3>

<p>Summary function for objects of class <code>cifETM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etmCIF'
summary(object, ci.fun = "cloglog",
        level = 0.95, ...)
## S3 method for class 'summary.etmCIF'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.etmCIF_+3A_object">object</code></td>
<td>
<p>An object of class <code>etmCIF</code></p>
</td></tr>
<tr><td><code id="summary.etmCIF_+3A_ci.fun">ci.fun</code></td>
<td>
<p>Transformation applied to the pointwise confidence
intervals. On of <code>"linear", "log", "log-log",
      "cloglog"</code>. Default is <code>"cloglog"</code>.</p>
</td></tr>
<tr><td><code id="summary.etmCIF_+3A_level">level</code></td>
<td>
<p>Level of the confidence intervals. Default is 0.95.</p>
</td></tr>
<tr><td><code id="summary.etmCIF_+3A_x">x</code></td>
<td>
<p>An object of class <code>cifETM</code>.</p>
</td></tr>
<tr><td><code id="summary.etmCIF_+3A_...">...</code></td>
<td>
<p>Further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame per covariate level and competing event
</p>
<table>
<tr><td><code>P</code></td>
<td>
<p>Transition probability estimates</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>Variance estimates</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>Lower confidence limit</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>Upper confidence limit</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>Transition times</p>
</td></tr>
<tr><td><code>n.risk</code></td>
<td>
<p>Number of individuals at risk of experiencing a transition
just before time <code class="reqn">t</code></p>
</td></tr>
<tr><td><code>n.event</code></td>
<td>
<p>Number of events at time <code class="reqn">t</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etmCIF">etmCIF</a></code>
</p>

<hr>
<h2 id='tra'>
Matrix of possible transitions
</h2><span id='topic+tra'></span><span id='topic+tra_ill'></span><span id='topic+tra_ill_comp'></span><span id='topic+tra_comp'></span><span id='topic+tra_surv'></span>

<h3>Description</h3>

<p>Miscellaneous functions that compute the matrix of possible
transitions used as argument in the <code>etm</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tra_ill(state.names = c("0", "1", "2"))
tra_ill_comp(nComp = 2,
     state.names = as.character(seq(0, nComp + 1, 1)))
tra_comp(nComp = 2,
         state.names = as.character(seq(0, nComp)))
tra_surv(state.names = c("0", "1"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tra_+3A_state.names">state.names</code></td>
<td>
<p>A vector of characters giving the states names</p>
</td></tr>
<tr><td><code id="tra_+3A_ncomp">nComp</code></td>
<td>
<p>For the competing risks models, the number of competing
events</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions compute the matrix of possible transitions that is
used as argument in, e.g., the <code>etm</code> function. <code>tra_surv</code> is
for the usual survival model, <code>tra_comp</code> for the competing risks
model, <code>tra_ill</code> for the illness-death model and
<code>tra_ill_comp</code> for the illness-death model with competing
terminal events. By default, state names are from 0 to ...
</p>


<h3>Value</h3>

<p>A quadratic matrix with <code>TRUE</code> if a transition is possible,
<code>FALSE</code> otherwise.
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tra_ill()

## competing risks model with 4 competing events non-default state names
tra_comp(4, state.names = c("healthy", "Cardiac problems", "Cancer",
                           "Rhenal failure", "Other"))
</code></pre>

<hr>
<h2 id='trprob.etm'>
Function to extract transition probabilities and (co)variance
</h2><span id='topic+trprob.etm'></span><span id='topic+trprob'></span><span id='topic+trcov'></span><span id='topic+trcov.etm'></span>

<h3>Description</h3>

<p>The <code>trprob</code> method is used to extract transition probabilities,
while <code>trcov</code> is used to obtain the (co)variance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
trprob(x, tr.choice, timepoints, ...)
## S3 method for class 'etm'
trcov(x, tr.choice, timepoints, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trprob.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>etm</code>.</p>
</td></tr>
<tr><td><code id="trprob.etm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>A character vector of the form &quot;from to&quot; describing
for which transition one wishes to obtain the transition probabilities
or covariance estimates. For <code>trprob</code>, <code>tr.choice</code> must be
of length 1, while it can be of length 2 for <code>trcov</code>.</p>
</td></tr>
<tr><td><code id="trprob.etm_+3A_timepoints">timepoints</code></td>
<td>
<p>Time points at which one want the estimates. When
missing, estimates are obtained for all event times.</p>
</td></tr>
<tr><td><code id="trprob.etm_+3A_...">...</code></td>
<td>
<p>Further arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the transition probabilities or covariance
estimates either at the time specified in <code>timepoints</code> or at all
transition times.
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sir.cont)

# Modification for patients entering and leaving a state
# at the same date
# Change on ventilation status is considered
# to happen before end of hospital stay
sir.cont &lt;- sir.cont[order(sir.cont$id, sir.cont$time), ]
for (i in 2:nrow(sir.cont)) {
  if (sir.cont$id[i]==sir.cont$id[i-1]) {
    if (sir.cont$time[i]==sir.cont$time[i-1]) {
      sir.cont$time[i-1] &lt;- sir.cont$time[i-1] - 0.5
    }
  }
}

### Computation of the transition probabilities
# Possible transitions.
tra &lt;- matrix(ncol=3,nrow=3,FALSE)
tra[1, 2:3] &lt;- TRUE
tra[2, c(1, 3)] &lt;- TRUE

# etm
fit.etm &lt;- etm(sir.cont, c("0", "1", "2"), tra, "cens", 0)

## extract P_01(0, t) and variance
p01 &lt;- trprob(fit.etm, "0 1")
var.p01 &lt;- trcov(fit.etm, "0 1")

## covariance between P_00 and P_01
cov.00.01 &lt;- trcov(fit.etm, c("0 0", "0 1"))

## P_01 at some time points
trprob(fit.etm, "0 1", c(0, 15, 50, 100))
</code></pre>

<hr>
<h2 id='xyplot.etm'>xyplot method for object of class 'etm'</h2><span id='topic+xyplot.etm'></span>

<h3>Description</h3>

<p>xyplot function for objects of class <code>etm</code>. Estimates of the 
transition probabilities are plotted as a function of time for all the
transitions specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'etm'
xyplot(x, data = NULL, tr.choice, col = c(1, 1, 1),
       lty = c(1, 3, 3),  xlab = "Time",
       ylab = "Transition probability",
       conf.int = TRUE, ci.fun = "linear", level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xyplot.etm_+3A_x">x</code></td>
<td>
<p>An object of class <code>etm</code>.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_data">data</code></td>
<td>
<p><em>Useless</em>.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_tr.choice">tr.choice</code></td>
<td>
<p>A character vector of the form c(&quot;from to&quot;, &quot;from
to&quot;, ...) specifying the transition probabilities to be plotted. By
default, all the direct transition probabilities are displayed.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_col">col</code></td>
<td>
<p>Vector of colours for the curves.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_lty">lty</code></td>
<td>
<p>Vector of line types.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_xlab">xlab</code></td>
<td>
<p>x-axis label. Default is &quot;Time&quot;.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label. Default is &quot;Estimated transition
probability&quot;.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_conf.int">conf.int</code></td>
<td>
<p>Logical. Whether to draw pointwise confidence
intervals. Default is TRUE.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_ci.fun">ci.fun</code></td>
<td>
<p>A character vector specifying the transformation to be
applied to the pointwise confidence intervals. It could be different
for each transition probability, though if <code>length(ci.fun) !=
      length(tr.choice)</code>, only <code>ci.fun[1]</code> will be used. The
possible transformations are &quot;linear&quot;, &quot;log&quot;, &quot;log-log&quot; and
&quot;cloglog&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_level">level</code></td>
<td>
<p>Level of the two-sided confidence intervals. Default is
0.95.</p>
</td></tr>
<tr><td><code id="xyplot.etm_+3A_...">...</code></td>
<td>
<p>Further arguments for <code>xyplot</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>trellis</code>.
</p>


<h3>Author(s)</h3>

<p>Arthur Allignol, <a href="mailto:arthur.allignol@gmail.com">arthur.allignol@gmail.com</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+etm">etm</a></code>, <code><a href="lattice.html#topic+xyplot">xyplot</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
