<!DOCTYPE html><html><head><title>Help for package gtfsrouter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gtfsrouter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#berlin_gtfs'><p>berlin_gtfs</p></a></li>
<li><a href='#berlin_gtfs_to_zip'><p>berlin_gtfs_to_zip</p></a></li>
<li><a href='#extract_gtfs'><p>extract_gtfs</p></a></li>
<li><a href='#frequencies_to_stop_times'><p>frequencies_to_stop_times</p></a></li>
<li><a href='#go_home'><p>go_home</p></a></li>
<li><a href='#go_to_work'><p>go_to_work</p></a></li>
<li><a href='#gtfs_route'><p>gtfs_route</p></a></li>
<li><a href='#gtfs_route_headway'><p>Route headway</p></a></li>
<li><a href='#gtfs_timetable'><p>gtfs_timetable</p></a></li>
<li><a href='#gtfs_transfer_table'><p>gtfs_transfer_table</p></a></li>
<li><a href='#gtfs_traveltimes'><p>gtfs_traveltimes</p></a></li>
<li><a href='#gtfsrouter'><p>gtfsrouter</p></a></li>
<li><a href='#process_gtfs_local'><p>process_gtfs_local</p></a></li>
<li><a href='#summary.gtfs'><p>summary.gtfs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Routing with 'GTFS' (General Transit Feed Specification) Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Use 'GTFS' (General Transit Feed Specification) data for routing
    from nominated start and end stations, for extracting 'isochrones', and
    travel times from any nominated start station to all other stations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/UrbanAnalyst/gtfsrouter">https://github.com/UrbanAnalyst/gtfsrouter</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/UrbanAnalyst/gtfsrouter/issues">https://github.com/UrbanAnalyst/gtfsrouter/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, data.table, geodist, methods, Rcpp (&ge; 0.12.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>digest, dodgr, dplyr, ggplot2, here, hms, knitr, lubridate,
lwgeom, markdown, pbapply, rmarkdown, testthat</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-22 08:30:51 UTC; smexus</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark Padgham [aut, cre],
  Marcin Stepniak <a href="https://orcid.org/0000-0002-6489-5443"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Alexandra Kapp [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mark Padgham &lt;mark.padgham@email.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-23 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='berlin_gtfs'>berlin_gtfs</h2><span id='topic+berlin_gtfs'></span>

<h3>Description</h3>

<p>Sample GTFS data from Verkehrsverbund Berlin-Brandenburg street, reduced to U
and S Bahn only (underground and overground trains), and between the hours of
12:00-13:00. Only those components of the GTFS data necessary for routing
have been retained. Note that non-ASCII characters have been removed from
these data, so umlauts are simply removed and eszetts become &quot;ss&quot;. The
package will nevertheless work with full GTFS feeds and non-ASCII (UTF-8)
characters.
</p>


<h3>Format</h3>

<p>A list of five <span class="pkg">data.table</span> items necessary for routing:
</p>

<ul>
<li><p> calendar
</p>
</li>
<li><p> routes
</p>
</li>
<li><p> trips
</p>
</li>
<li><p> stop_times
</p>
</li>
<li><p> stops
</p>
</li>
<li><p> transfers
</p>
</li></ul>



<h3>Value</h3>

<p>For single (from, to) values, a <code>data.frame</code> describing the route,
with each row representing one stop. For multiple (from, to) values, a list
of <code>data.frames</code>, each of which describes one route between the i'th start
and end stations (<code>from</code> and <code>to</code> values). Origin and destination stations
for which no route is possible return <code>NULL</code>.
</p>


<h3>Note</h3>

<p>Can be re-created with the script in
<a href="https://github.com/UrbanAnalyst/gtfsrouter/blob/master/data-raw/data-script.Rmd">https://github.com/UrbanAnalyst/gtfsrouter/blob/master/data-raw/data-script.Rmd</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr_dt &lt;- data.table::setDTthreads (1)
nthr_omp &lt;- Sys.getenv ("OMP_THREAD_LIMIT")
Sys.setenv ("OMP_THREAD_LIMIT" = 1L)

berlin_gtfs_to_zip () # Write sample feed from Berlin, Germany to tempdir
f &lt;- file.path (tempdir (), "vbb.zip") # name of feed
gtfs &lt;- extract_gtfs (f)
from &lt;- "Innsbrucker Platz" # U-bahn station, not "S"
to &lt;- "Alexanderplatz"
start_time &lt;- 12 * 3600 + 120 # 12:02

route &lt;- gtfs_route (gtfs, from = from, to = to, start_time = start_time)

# Specify day of week
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday"
)

# specify travel by "U" = underground only
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^U"
)
# specify travel by "S" = street-level only (not underground)
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^S"
)

# Route queries are generally faster if the GTFS data are pre-processed with
# `gtfs_timetable()`:
gt &lt;- gtfs_timetable (gtfs, day = "Sunday", route_pattern = "^S")
route &lt;- gtfs_route (gt, from = from, to = to, start_time = start_time)

data.table::setDTthreads (nthr_dt)
Sys.setenv ("OMP_THREAD_LIMIT" = nthr_omp)
</code></pre>

<hr>
<h2 id='berlin_gtfs_to_zip'>berlin_gtfs_to_zip</h2><span id='topic+berlin_gtfs_to_zip'></span>

<h3>Description</h3>

<p>Write a zip archive of the internal package data, <a href="#topic+berlin_gtfs">berlin_gtfs</a> to
a file named &quot;vbb.zip&quot; to <code>tempdir()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>berlin_gtfs_to_zip()
</code></pre>


<h3>Value</h3>

<p>Path to newly created zip file
</p>


<h3>See Also</h3>

<p>Other extract: 
<code><a href="#topic+extract_gtfs">extract_gtfs</a>()</code>,
<code><a href="#topic+gtfs_timetable">gtfs_timetable</a>()</code>
</p>

<hr>
<h2 id='extract_gtfs'>extract_gtfs</h2><span id='topic+extract_gtfs'></span>

<h3>Description</h3>

<p>Extract data from a GTFS <code>zip</code> archive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_gtfs(filename = NULL, quiet = FALSE, stn_suffixes = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_gtfs_+3A_filename">filename</code></td>
<td>
<p>Name of GTFS archive</p>
</td></tr>
<tr><td><code id="extract_gtfs_+3A_quiet">quiet</code></td>
<td>
<p>If <code>FALSE</code>, display progress information on screen</p>
</td></tr>
<tr><td><code id="extract_gtfs_+3A_stn_suffixes">stn_suffixes</code></td>
<td>
<p>Any values provided will be removed from terminal
characters of station IDs. Useful for feeds like NYC for which some stations
are appended with values of &quot;N&quot; and &quot;S&quot; to indicate directions. Specifying
<code>stn_suffixes = c ("N", "S")</code> will automatically remove these suffixes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of several <span class="pkg">data.table</span> objects corresponding to the tables
present in the nominated GTFS data set.
</p>


<h3>Note</h3>

<p>Column types in each table of the returned object conform to GTFS
standards (<a href="https://developers.google.com/transit/gtfs/reference">https://developers.google.com/transit/gtfs/reference</a>),
except that &quot;Time&quot; fields in the &quot;stop_times&quot; table are converted to integer
values, rather than as character or &quot;Time&quot; objects (&quot;HH:MM:SS&quot;). These can be
converted back to comply with GTFS standards by applying the <code>hms::hms()</code>
function to the two time columns of the &quot;stop_times&quot; table.
</p>


<h3>See Also</h3>

<p>Other extract: 
<code><a href="#topic+berlin_gtfs_to_zip">berlin_gtfs_to_zip</a>()</code>,
<code><a href="#topic+gtfs_timetable">gtfs_timetable</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>berlin_gtfs_to_zip () # Write sample feed from Berlin, Germany to tempdir
f &lt;- file.path (tempdir (), "vbb.zip") # name of feed
gtfs &lt;- extract_gtfs (f)

</code></pre>

<hr>
<h2 id='frequencies_to_stop_times'>frequencies_to_stop_times</h2><span id='topic+frequencies_to_stop_times'></span>

<h3>Description</h3>

<p>Convert a GTFS 'frequencies' table to equivalent 'stop_times' that can be
used for routing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frequencies_to_stop_times(gtfs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frequencies_to_stop_times_+3A_gtfs">gtfs</code></td>
<td>
<p>A set of GTFS data returned from <a href="#topic+extract_gtfs">extract_gtfs</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input GTFS data with data from the 'frequencies' table converted
to equivalent 'arrival_time' and 'departure_time' values in <code>stop_times</code>.
</p>


<h3>See Also</h3>

<p>Other augment: 
<code><a href="#topic+gtfs_transfer_table">gtfs_transfer_table</a>()</code>
</p>

<hr>
<h2 id='go_home'>go_home</h2><span id='topic+go_home'></span>

<h3>Description</h3>

<p>Use local environmental variables specifying home and work stations and
locations of locally-stored GTFS data to route from work to home location
with next available service.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>go_home(wait = 0, start_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="go_home_+3A_wait">wait</code></td>
<td>
<p>An integer specifying the n-th next service. That is, <code>wait = n</code>
will return the n-th available service after the next immediate service.</p>
</td></tr>
<tr><td><code id="go_home_+3A_start_time">start_time</code></td>
<td>
<p>If given, search for connections after specified time; if
not given, search for connections from current time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function, and the complementary function <a href="#topic+go_to_work">go_to_work</a>,
requires three local environmental variables specifying the names of home and
work stations, and the location on local storage of the GTFS data set to be
used for routing. These are respectively called <code>gtfs_home</code>, <code>gtfs_work</code>, and
<code>gtfs_data</code>. This data set must also be pre-processed using the
<a href="#topic+process_gtfs_local">process_gtfs_local</a> function.
</p>
<p>See <a href="base.html#topic+Startup">Startup</a> for details on how to set environmental variables.
Briefly, this can be done in two main ways: By setting them at the start of
each session, in which case the variables may be set with:
<code>Sys.setenv ("gtfs_home" = "&lt;my home station&gt;")</code>
<code>Sys.setenv ("gtfs_work" = "&lt;my work station&gt;")</code>
<code>Sys.setenv ("gtfs_data" = "/full/path/to/gtfs.zip")</code>
Alternatively, to set these automatically for each session, paste those lines
into the file <code style="white-space: pre;">&#8288;~/.Renviron&#8288;</code> - that is, a file named &quot;.Renviron&quot; in the user's
home directory.
</p>
<p>The <a href="#topic+process_gtfs_local">process_gtfs_local</a> function reduces the GTFS data set to the
minimal possible size necessary for local routing.  GTFS data are
nevertheless typically quite large, and both the <a href="#topic+go_home">go_home</a> and
<a href="#topic+go_to_work">go_to_work</a> functions may take some time to execute. Most of this time
is devoted to loading the data in to the current workspace and as such is
largely unavoidable.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> specifying the next available route from work to home.
</p>


<h3>See Also</h3>

<p>Other additional: 
<code><a href="#topic+go_to_work">go_to_work</a>()</code>,
<code><a href="#topic+process_gtfs_local">process_gtfs_local</a>()</code>,
<code><a href="#topic+summary.gtfs">summary.gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# For general use, please set these three variables:
Sys.setenv ("gtfs_home" = "&lt;my home station&gt;")
Sys.setenv ("gtfs_work" = "&lt;my work station&gt;")
Sys.setenv ("gtfs_data" = "/full/path/to/gtfs.zip")

# The following illustrate use with sample data bundled with package
Sys.setenv ("gtfs_home" = "Tempelhof")
Sys.setenv ("gtfs_work" = "Alexanderplatz")
Sys.setenv ("gtfs_data" = file.path (tempdir (), "vbb.zip"))
process_gtfs_local () # If not already done
go_home (start_time = "12:00") # next available service after 12:00
go_home (3, start_time = "12:00") # Wait until third service after that

# Generally, `start_time` will not be specified, in which case `go_home` will
# return next available service from current system time, so calls will
# generally be as simple as:
go_home ()
go_home (3)

## End(Not run)
</code></pre>

<hr>
<h2 id='go_to_work'>go_to_work</h2><span id='topic+go_to_work'></span>

<h3>Description</h3>

<p>Use local environmental variables specifying home and work stations and
locations of locally-stored GTFS data to route from home to work location
with next available service.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>go_to_work(wait = 0, start_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="go_to_work_+3A_wait">wait</code></td>
<td>
<p>An integer specifying the n-th next service. That is, <code>wait = n</code>
will return the n-th available service after the next immediate service.</p>
</td></tr>
<tr><td><code id="go_to_work_+3A_start_time">start_time</code></td>
<td>
<p>If given, search for connections after specified time; if
not given, search for connections from current time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function, and the complementary function <a href="#topic+go_to_work">go_to_work</a>,
requires three local environmental variables specifying the names of home and
work stations, and the location on local storage of the GTFS data set to be
used for routing. These are respectively called <code>gtfs_home</code>, <code>gtfs_work</code>, and
<code>gtfs_data</code>. This data set must also be pre-processed using the
<a href="#topic+process_gtfs_local">process_gtfs_local</a> function.
</p>
<p>See <a href="base.html#topic+Startup">Startup</a> for details on how to set environmental variables.
Briefly, this can be done in two main ways: By setting them at the start of
each session, in which case the variables may be set with:
<code>Sys.setenv ("gtfs_home" = "&lt;my home station&gt;")</code>
<code>Sys.setenv ("gtfs_work" = "&lt;my work station&gt;")</code>
<code>Sys.setenv ("gtfs_data" = "/full/path/to/gtfs.zip")</code>
Alternatively, to set these automatically for each session, paste those lines
into the file <code style="white-space: pre;">&#8288;~/.Renviron&#8288;</code> - that is, a file named &quot;.Renviron&quot; in the user's
home directory.
</p>
<p>The <a href="#topic+process_gtfs_local">process_gtfs_local</a> function reduces the GTFS data set to the
minimal possible size necessary for local routing.  GTFS data are
nevertheless typically quite large, and both the <a href="#topic+go_home">go_home</a> and
<a href="#topic+go_to_work">go_to_work</a> functions may take some time to execute. Most of this time
is devoted to loading the data in to the current workspace and as such is
largely unavoidable.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> specifying the next available route from work to home.
</p>


<h3>See Also</h3>

<p>Other additional: 
<code><a href="#topic+go_home">go_home</a>()</code>,
<code><a href="#topic+process_gtfs_local">process_gtfs_local</a>()</code>,
<code><a href="#topic+summary.gtfs">summary.gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# For general use, please set these three variables:
Sys.setenv ("gtfs_home" = "&lt;my home station&gt;")
Sys.setenv ("gtfs_work" = "&lt;my work station&gt;")
Sys.setenv ("gtfs_data" = "/full/path/to/gtfs.zip")

# The following illustrate use with sample data bundled with package
Sys.setenv ("gtfs_home" = "Tempelhof")
Sys.setenv ("gtfs_work" = "Alexanderplatz")
Sys.setenv ("gtfs_data" = file.path (tempdir (), "vbb.zip"))
process_gtfs_local () # If not already done
go_to_work (start_time = "12:00") # next available service after 12:00
go_to_work (3, start_time = "12:00") # Wait until third service after that

# Generally, `start_time` will not be specified, in which case `go_to_work`
# will return next available service from current system time, so calls will
# generally be as simple as:
go_to_work ()
go_to_work (3)

## End(Not run)
</code></pre>

<hr>
<h2 id='gtfs_route'>gtfs_route</h2><span id='topic+gtfs_route'></span>

<h3>Description</h3>

<p>Calculate single route between a start and end station departing at or after
a specified time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtfs_route(
  gtfs,
  from,
  to,
  start_time = NULL,
  day = NULL,
  route_pattern = NULL,
  earliest_arrival = TRUE,
  include_ids = FALSE,
  grep_fixed = TRUE,
  max_transfers = NA,
  from_to_are_ids = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtfs_route_+3A_gtfs">gtfs</code></td>
<td>
<p>A set of GTFS data returned from <a href="#topic+extract_gtfs">extract_gtfs</a> or, for more
efficient queries, pre-processed with <a href="#topic+gtfs_timetable">gtfs_timetable</a>.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_from">from</code></td>
<td>
<p>Names, IDs, or approximate (lon, lat) coordinates of start
stations (as <code>stop_name</code> or <code>stop_id</code> entry in the <code>stops</code> table, or a vector
of two numeric values). See Note.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_to">to</code></td>
<td>
<p>Corresponding Names, IDs, or coordinates of end station.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_start_time">start_time</code></td>
<td>
<p>Desired departure time at <code>from</code> station, either in seconds
after midnight, a vector of two or three integers (hours, minutes) or (hours,
minutes, seconds), an object of class <a href="base.html#topic+difftime">difftime</a>, <span class="pkg">hms</span>, or
<span class="pkg">lubridate</span>. If not provided, current time is used.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_day">day</code></td>
<td>
<p>Day of the week on which to calculate route, either as an
unambiguous string (so &quot;tu&quot; and &quot;th&quot; for Tuesday and Thursday), or a number
between 1 = Sunday and 7 = Saturday. If not given, the current day will be
used. (Not used if <code>gtfs</code> has already been prepared with
<a href="#topic+gtfs_timetable">gtfs_timetable</a>.)</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_route_pattern">route_pattern</code></td>
<td>
<p>Using only those routes matching given pattern, for
example, &quot;^U&quot; for routes starting with &quot;U&quot; (as commonly used for underground
or subway routes. To negate the <code>route_pattern</code> &ndash; that is, to include all
routes except those matching the pattern &ndash; prepend the value with &quot;!&quot;; for
example &quot;!^U&quot; will include all services except those starting with &quot;U&quot;. (This
parameter is not used at all if <code>gtfs</code> has already been prepared with
<a href="#topic+gtfs_timetable">gtfs_timetable</a>.)</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_earliest_arrival">earliest_arrival</code></td>
<td>
<p>If <code>FALSE</code>, routing will be with the first-departing
service, which may not provide the earliest arrival at the <code>to</code> station. This
may nevertheless be useful for bulk queries, as earliest arrival searches
require two routing queries, while earliest departure searches require just
one, and so will be generally twice as fast.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_include_ids">include_ids</code></td>
<td>
<p>If <code>TRUE</code>, result will include columns containing
GTFS-specific identifiers for routes, trips, and stops.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_grep_fixed">grep_fixed</code></td>
<td>
<p>If <code>FALSE</code>, match station names (when passed as character
string) with <code>grep(..., fixed = FALSE)</code>, to allow use of <code>grep</code> expressions.
This is useful to refine matches in cases where desired stations may match
multiple entries.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_max_transfers">max_transfers</code></td>
<td>
<p>If not <code>NA</code>, specify a desired maximum number of
transfers for the route (including but not exceeding this number). This
parameter may be used to generate alternative routes with fewer transfers,
although actual numbers of transfers may still exceed this number if the
value specified is less than the minimal feasible number of transfers.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_from_to_are_ids">from_to_are_ids</code></td>
<td>
<p>Set to <code>TRUE</code> to enable <code>from</code> and <code>to</code> parameter to
specify entries in <code>stop_id</code> rather than <code>stop_name</code> column of the <code>stops</code>
table.</p>
</td></tr>
<tr><td><code id="gtfs_route_+3A_quiet">quiet</code></td>
<td>
<p>Set to <code>TRUE</code> to suppress screen messages (currently just
regarding timetable construction).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For single (from, to) values, a <code>data.frame</code> describing the route,
with each row representing one stop. For multiple (from, to) values, a list
of <code>data.frames</code>, each of which describes one route between the i'th start
and end stations (<code>from</code> and <code>to</code> values). Origin and destination stations
for which no route is possible return <code>NULL</code>.
</p>


<h3>Note</h3>

<p>This function will by default calculate the route that arrives earliest
at the specified destination, although this may depart later than the
earliest departing service. Routes which depart at the earliest possible time
can be calculated by setting <code>earliest_arrival = FALSE</code>.
</p>


<h3>See Also</h3>

<p>Other main: 
<code><a href="#topic+gtfs_route_headway">gtfs_route_headway</a>()</code>,
<code><a href="#topic+gtfs_traveltimes">gtfs_traveltimes</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr_dt &lt;- data.table::setDTthreads (1)
nthr_omp &lt;- Sys.getenv ("OMP_THREAD_LIMIT")
Sys.setenv ("OMP_THREAD_LIMIT" = 1L)

berlin_gtfs_to_zip () # Write sample feed from Berlin, Germany to tempdir
f &lt;- file.path (tempdir (), "vbb.zip") # name of feed
gtfs &lt;- extract_gtfs (f)
from &lt;- "Innsbrucker Platz" # U-bahn station, not "S"
to &lt;- "Alexanderplatz"
start_time &lt;- 12 * 3600 + 120 # 12:02

route &lt;- gtfs_route (gtfs, from = from, to = to, start_time = start_time)

# Specify day of week
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday"
)

# specify travel by "U" = underground only
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^U"
)
# specify travel by "S" = street-level only (not underground)
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^S"
)

# Route queries are generally faster if the GTFS data are pre-processed with
# `gtfs_timetable()`:
gt &lt;- gtfs_timetable (gtfs, day = "Sunday", route_pattern = "^S")
route &lt;- gtfs_route (gt, from = from, to = to, start_time = start_time)

data.table::setDTthreads (nthr_dt)
Sys.setenv ("OMP_THREAD_LIMIT" = nthr_omp)
</code></pre>

<hr>
<h2 id='gtfs_route_headway'>Route headway</h2><span id='topic+gtfs_route_headway'></span>

<h3>Description</h3>

<p>Calculate a vector of headway values &ndash; that is, time intervals between
consecutive services &ndash; for all routes between two specified stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtfs_route_headway(
  gtfs,
  from,
  to,
  from_to_are_ids = FALSE,
  grep_fixed = TRUE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtfs_route_headway_+3A_gtfs">gtfs</code></td>
<td>
<p>A set of GTFS data returned from <a href="#topic+extract_gtfs">extract_gtfs</a> or, for more
efficient queries, pre-processed with <a href="#topic+gtfs_timetable">gtfs_timetable</a>.</p>
</td></tr>
<tr><td><code id="gtfs_route_headway_+3A_from">from</code></td>
<td>
<p>Names, IDs, or approximate (lon, lat) coordinates of start
stations (as <code>stop_name</code> or <code>stop_id</code> entry in the <code>stops</code> table, or a vector
of two numeric values). See Note.</p>
</td></tr>
<tr><td><code id="gtfs_route_headway_+3A_to">to</code></td>
<td>
<p>Corresponding Names, IDs, or coordinates of end station.</p>
</td></tr>
<tr><td><code id="gtfs_route_headway_+3A_from_to_are_ids">from_to_are_ids</code></td>
<td>
<p>Set to <code>TRUE</code> to enable <code>from</code> and <code>to</code> parameter to
specify entries in <code>stop_id</code> rather than <code>stop_name</code> column of the <code>stops</code>
table.</p>
</td></tr>
<tr><td><code id="gtfs_route_headway_+3A_grep_fixed">grep_fixed</code></td>
<td>
<p>If <code>FALSE</code>, match station names (when passed as character
string) with <code>grep(..., fixed = FALSE)</code>, to allow use of <code>grep</code> expressions.
This is useful to refine matches in cases where desired stations may match
multiple entries.</p>
</td></tr>
<tr><td><code id="gtfs_route_headway_+3A_quiet">quiet</code></td>
<td>
<p>If <code>TRUE</code>, display a progress bar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single vector of integer values containing headways between all
services across a single 24-hour period
</p>


<h3>See Also</h3>

<p>Other main: 
<code><a href="#topic+gtfs_route">gtfs_route</a>()</code>,
<code><a href="#topic+gtfs_traveltimes">gtfs_traveltimes</a>()</code>
</p>

<hr>
<h2 id='gtfs_timetable'>gtfs_timetable</h2><span id='topic+gtfs_timetable'></span>

<h3>Description</h3>

<p>Convert GTFS data into format able to be used to calculate routes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtfs_timetable(
  gtfs,
  day = NULL,
  date = NULL,
  route_pattern = NULL,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtfs_timetable_+3A_gtfs">gtfs</code></td>
<td>
<p>A set of GTFS data returned from <a href="#topic+extract_gtfs">extract_gtfs</a>.</p>
</td></tr>
<tr><td><code id="gtfs_timetable_+3A_day">day</code></td>
<td>
<p>Day of the week on which to calculate route, either as an
unambiguous string (so &quot;tu&quot; and &quot;th&quot; for Tuesday and Thursday), or a number
between 1 = Sunday and 7 = Saturday. If not given, the current day will be
used - unless the following 'date' parameter is give.</p>
</td></tr>
<tr><td><code id="gtfs_timetable_+3A_date">date</code></td>
<td>
<p>Some systems do not specify days of the week within their
'calendar' table; rather they provide full timetables for specified calendar
dates via a 'calendar_date' table. Providing a date here as a single 8-digit
number representing 'yyyymmdd' will filter the data to the specified date.
Also the 'calendar' is scanned for services that operate on the selected
date. Therefore also a merge of feeds that combine 'calendar' and
'calendar_dates' options is covered.</p>
</td></tr>
<tr><td><code id="gtfs_timetable_+3A_route_pattern">route_pattern</code></td>
<td>
<p>Using only those routes matching given pattern, for
example, &quot;^U&quot; for routes starting with &quot;U&quot; (as commonly used for underground
or subway routes. To negative the <code>route_pattern</code> &ndash; that is, to include all
routes except those matching the patter &ndash; prepend the value with &quot;!&quot;; for
example &quot;!^U&quot; with include all services except those starting with &quot;U&quot;.</p>
</td></tr>
<tr><td><code id="gtfs_timetable_+3A_quiet">quiet</code></td>
<td>
<p>Set to <code>TRUE</code> to suppress screen messages (currently just
regarding timetable construction).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input data with an addition items, <code>timetable</code>, <code>stations</code>, and
<code>trips</code>, containing data formatted for more efficient use with
<a href="#topic+gtfs_route">gtfs_route</a> (see Note).
</p>


<h3>Note</h3>

<p>This function is merely provided to speed up calls to the primary
function, <a href="#topic+gtfs_route">gtfs_route</a>. If the input data to that function do not
include a formatted <code>timetable</code>, it will be calculated anyway, but queries in
that case will generally take longer.
</p>


<h3>See Also</h3>

<p>Other extract: 
<code><a href="#topic+berlin_gtfs_to_zip">berlin_gtfs_to_zip</a>()</code>,
<code><a href="#topic+extract_gtfs">extract_gtfs</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr_dt &lt;- data.table::setDTthreads (1)
nthr_omp &lt;- Sys.getenv ("OMP_THREAD_LIMIT")
Sys.setenv ("OMP_THREAD_LIMIT" = 1L)

berlin_gtfs_to_zip () # Write sample feed from Berlin, Germany to tempdir
f &lt;- file.path (tempdir (), "vbb.zip") # name of feed
gtfs &lt;- extract_gtfs (f)
from &lt;- "Innsbrucker Platz" # U-bahn station, not "S"
to &lt;- "Alexanderplatz"
start_time &lt;- 12 * 3600 + 120 # 12:02

route &lt;- gtfs_route (gtfs, from = from, to = to, start_time = start_time)

# Specify day of week
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday"
)

# specify travel by "U" = underground only
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^U"
)
# specify travel by "S" = street-level only (not underground)
route &lt;- gtfs_route (
    gtfs,
    from = from,
    to = to,
    start_time = start_time,
    day = "Sunday",
    route_pattern = "^S"
)

# Route queries are generally faster if the GTFS data are pre-processed with
# `gtfs_timetable()`:
gt &lt;- gtfs_timetable (gtfs, day = "Sunday", route_pattern = "^S")
route &lt;- gtfs_route (gt, from = from, to = to, start_time = start_time)

data.table::setDTthreads (nthr_dt)
Sys.setenv ("OMP_THREAD_LIMIT" = nthr_omp)
</code></pre>

<hr>
<h2 id='gtfs_transfer_table'>gtfs_transfer_table</h2><span id='topic+gtfs_transfer_table'></span>

<h3>Description</h3>

<p>Construct a transfer table for a GTFS feed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtfs_transfer_table(
  gtfs,
  d_limit = 200,
  min_transfer_time = 120,
  network = NULL,
  network_times = FALSE,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtfs_transfer_table_+3A_gtfs">gtfs</code></td>
<td>
<p>A GTFS feed obtained from the <a href="#topic+extract_gtfs">extract_gtfs</a> function.</p>
</td></tr>
<tr><td><code id="gtfs_transfer_table_+3A_d_limit">d_limit</code></td>
<td>
<p>Upper straight-line distance limit in metres for transfers.</p>
</td></tr>
<tr><td><code id="gtfs_transfer_table_+3A_min_transfer_time">min_transfer_time</code></td>
<td>
<p>Minimum time in seconds for transfers; all values
below this will be replaced with this value, particularly all those defining
in-place transfers where stop longitudes and latitudes remain identical.</p>
</td></tr>
<tr><td><code id="gtfs_transfer_table_+3A_network">network</code></td>
<td>
<p>Optional Open Street Map representation of the street network
encompassed by the GTFS feed (see Examples).</p>
</td></tr>
<tr><td><code id="gtfs_transfer_table_+3A_network_times">network_times</code></td>
<td>
<p>If <code>TRUE</code>, transfer times are calculated by routing
throughout the underlying street network. If this is not provided as the
<code>net</code> parameter, it will be automatically downloaded. If a network, is
provided, this parameter is automatically set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="gtfs_transfer_table_+3A_quiet">quiet</code></td>
<td>
<p>Set to <code>TRUE</code> to suppress screen messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Modified version of the <code>gtfs</code> input with additional transfers table.
</p>


<h3>See Also</h3>

<p>Other augment: 
<code><a href="#topic+frequencies_to_stop_times">frequencies_to_stop_times</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr &lt;- data.table::setDTthreads (1)

berlin_gtfs_to_zip ()
f &lt;- file.path (tempdir (), "vbb.zip")
g &lt;- extract_gtfs (f, quiet = TRUE)
g &lt;- gtfs_transfer_table (g, d_limit = 200)
# g$transfers then has fewer rows than original, because original transfer
# table contains duplicated rows.

data.table::setDTthreads (nthr)
</code></pre>

<hr>
<h2 id='gtfs_traveltimes'>gtfs_traveltimes</h2><span id='topic+gtfs_traveltimes'></span>

<h3>Description</h3>

<p>Travel times from a nominated station departing at a nominated time to every
other reachable station in a system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtfs_traveltimes(
  gtfs,
  from,
  start_time_limits,
  day = NULL,
  from_is_id = FALSE,
  grep_fixed = TRUE,
  route_pattern = NULL,
  minimise_transfers = FALSE,
  max_traveltime = 60 * 60,
  quiet = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtfs_traveltimes_+3A_gtfs">gtfs</code></td>
<td>
<p>A set of GTFS data returned from <a href="#topic+extract_gtfs">extract_gtfs</a> or, for more
efficient queries, pre-processed with <a href="#topic+gtfs_timetable">gtfs_timetable</a>.</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_from">from</code></td>
<td>
<p>Name, ID, or approximate (lon, lat) coordinates of start station
(as <code>stop_name</code> or <code>stop_id</code> entry in the <code>stops</code> table, or a vector of two
numeric values).</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_start_time_limits">start_time_limits</code></td>
<td>
<p>A vector of two integer values denoting the earliest
and latest departure times in seconds for the traveltime values.</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_day">day</code></td>
<td>
<p>Day of the week on which to calculate route, either as an
unambiguous string (so &quot;tu&quot; and &quot;th&quot; for Tuesday and Thursday), or a number
between 1 = Sunday and 7 = Saturday. If not given, the current day will be
used. (Not used if <code>gtfs</code> has already been prepared with
<a href="#topic+gtfs_timetable">gtfs_timetable</a>.)</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_from_is_id">from_is_id</code></td>
<td>
<p>Set to <code>TRUE</code> to enable <code>from</code> parameter to specify entry
in <code>stop_id</code> rather than <code>stop_name</code> column of the <code>stops</code> table (same as
<code>from_to_are_ids</code> parameter of <a href="#topic+gtfs_route">gtfs_route</a>).</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_grep_fixed">grep_fixed</code></td>
<td>
<p>If <code>FALSE</code>, match station names (when passed as character
string) with <code>grep(..., fixed = FALSE)</code>, to allow use of <code>grep</code> expressions.
This is useful to refine matches in cases where desired stations may match
multiple entries.</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_route_pattern">route_pattern</code></td>
<td>
<p>Using only those routes matching given pattern, for
example, &quot;^U&quot; for routes starting with &quot;U&quot; (as commonly used for underground
or subway routes. To negate the <code>route_pattern</code> &ndash; that is, to include all
routes except those matching the pattern &ndash; prepend the value with &quot;!&quot;; for
example &quot;!^U&quot; will include all services except those starting with &quot;U&quot;. (This
parameter is not used at all if <code>gtfs</code> has already been prepared with
<a href="#topic+gtfs_timetable">gtfs_timetable</a>.)</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_minimise_transfers">minimise_transfers</code></td>
<td>
<p>If <code>TRUE</code>, isochrones are calculated with
minimal-transfer connections to each end point, even if those connections are
slower than alternative connections with transfers.</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_max_traveltime">max_traveltime</code></td>
<td>
<p>The maximal traveltime to search for, specified in
seconds (with default of 1 hour). See note for details.</p>
</td></tr>
<tr><td><code id="gtfs_traveltimes_+3A_quiet">quiet</code></td>
<td>
<p>Set to <code>TRUE</code> to suppress screen messages (currently just
regarding timetable construction).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> of travel times and required numbers of transfers to
all stations reachable from the given <code>from</code> station. Additional columns
include &quot;start_time&quot;  of connection, and information on destination stops
including &quot;id&quot; numbers, names, and geographical coordinates.
</p>


<h3>Note</h3>

<p>Higher values of <code>max_traveltime</code> will return traveltimes for greater
numbers of stations, but may lead to considerably longer calculation times.
For repeated usage, it is recommended to first establish a value sufficient
to reach all or most stations desired for a particular query, rather than set
<code>max_traveltime</code> to an arbitrarily high value.
</p>


<h3>See Also</h3>

<p>Other main: 
<code><a href="#topic+gtfs_route_headway">gtfs_route_headway</a>()</code>,
<code><a href="#topic+gtfs_route">gtfs_route</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr &lt;- data.table::setDTthreads (1)

berlin_gtfs_to_zip ()
f &lt;- file.path (tempdir (), "vbb.zip")
g &lt;- extract_gtfs (f)
g &lt;- gtfs_timetable (g)
from &lt;- "Alexanderplatz"
start_times &lt;- 12 * 3600 + c (0, 60) * 60 # 8:00-9:00
res &lt;- gtfs_traveltimes (g, from, start_times)

data.table::setDTthreads (nthr)
</code></pre>

<hr>
<h2 id='gtfsrouter'>gtfsrouter</h2><span id='topic+gtfsrouter'></span><span id='topic+gtfsrouter-package'></span>

<h3>Description</h3>

<p>Routing engine for GTFS (General Transit Feed Specification) data, including
one-to-one and one-to-many routing routines.
</p>


<h3>Main Functions</h3>


<ul>
<li> <p><code><a href="#topic+gtfs_route">gtfs_route()</a></code>: Route between given start and end stations using a
nominated GTFS data set.
</p>
</li>
<li> <p><code><a href="#topic+go_home">go_home()</a></code>: Automatic routing between work and home stations specified
with local environmental variables
</p>
</li>
<li> <p><code><a href="#topic+go_to_work">go_to_work()</a></code>: Automatic routing between work and home stations
specified with local environmental variables
</p>
</li>
<li> <p><code><a href="#topic+gtfs_traveltimes">gtfs_traveltimes()</a></code>: One-to-many routing from a nominated start
station to all stations reachable within a specified travel duration.
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Mark Padgham <a href="mailto:mark.padgham@email.com">mark.padgham@email.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Marcin Stepniak <a href="mailto:marcinstepniak@ucm.es">marcinstepniak@ucm.es</a> (<a href="https://orcid.org/0000-0002-6489-5443">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Alexandra Kapp <a href="mailto:alk@mobilityinstitute.com">alk@mobilityinstitute.com</a> [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/UrbanAnalyst/gtfsrouter">https://github.com/UrbanAnalyst/gtfsrouter</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/UrbanAnalyst/gtfsrouter/issues">https://github.com/UrbanAnalyst/gtfsrouter/issues</a>
</p>
</li></ul>


<hr>
<h2 id='process_gtfs_local'>process_gtfs_local</h2><span id='topic+process_gtfs_local'></span>

<h3>Description</h3>

<p>Process a local GTFS data set with environmental variables described in
<a href="#topic+go_home">go_home</a> into a condensed version for use in <a href="#topic+go_home">go_home</a> and
<code>go_to_work</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process_gtfs_local(expand = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process_gtfs_local_+3A_expand">expand</code></td>
<td>
<p>The data set is reduced to the bounding box defined by the
home and work stations, expanded by this multiple. If the function appears to
behave strangely, try re-running this function with a higher value of this
parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. The function saves processed data to a local cache.
</p>


<h3>See Also</h3>

<p>Other additional: 
<code><a href="#topic+go_home">go_home</a>()</code>,
<code><a href="#topic+go_to_work">go_to_work</a>()</code>,
<code><a href="#topic+summary.gtfs">summary.gtfs</a>()</code>
</p>

<hr>
<h2 id='summary.gtfs'>summary.gtfs</h2><span id='topic+summary.gtfs'></span>

<h3>Description</h3>

<p>summary.gtfs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gtfs'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.gtfs_+3A_object">object</code></td>
<td>
<p>A <code>gtfs</code> object to be summarised</p>
</td></tr>
<tr><td><code id="summary.gtfs_+3A_...">...</code></td>
<td>
<p>ignored here</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing; this function only prints a summary to the console.
</p>


<h3>See Also</h3>

<p>Other additional: 
<code><a href="#topic+go_home">go_home</a>()</code>,
<code><a href="#topic+go_to_work">go_to_work</a>()</code>,
<code><a href="#topic+process_gtfs_local">process_gtfs_local</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Examples must be run on single thread only:
nthr &lt;- data.table::setDTthreads (1)

berlin_gtfs_to_zip ()
f &lt;- file.path (tempdir (), "vbb.zip")
g &lt;- extract_gtfs (f)
summary (g)
g &lt;- gtfs_timetable (g)
summary (g) # also summarizes additional timetable information

data.table::setDTthreads (nthr)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
