<!DOCTYPE html><html lang="en"><head><title>Help for package NADA2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NADA2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anosimPlot'><p>Permutation Analysis of Similarity (anosim) for Censored Data</p></a></li>
<li><a href='#atrazine'><p>Atrazine concentrations in Nebraska ground water</p></a></li>
<li><a href='#ATS'><p>Akritas-Theil-Sen line for censored data</p></a></li>
<li><a href='#ATSmini'><p>Kendall's tau and ATS line for censored data</p></a></li>
<li><a href='#bestaic'><p>Find the lowest AIC multiple regression model</p></a></li>
<li><a href='#binaryClust'><p>Cluster Matrix of Binary Censored Data</p></a></li>
<li><a href='#binaryDiss'><p>Binary dissimilarity coefficient matrix</p></a></li>
<li><a href='#binaryMDS'><p>Plot Nonmetric Multidimensional Scaling of binary censored data</p></a></li>
<li><a href='#binarySim'><p>Binary similarity coefficient matrix</p></a></li>
<li><a href='#Brumbaugh'><p>Brumbaugh</p></a></li>
<li><a href='#cboxplot'><p>Draws censored boxplots</p></a></li>
<li><a href='#cen_ecdf'><p>Censored Empirical Cumulative Distribution Function</p></a></li>
<li><a href='#cen_paired'><p>Censored data paired t-test</p></a></li>
<li><a href='#cen_signedranktest'><p>Wilcoxcon Signed-Rank test for censored data</p></a></li>
<li><a href='#cen_signtest'><p>Sign test for censored data</p></a></li>
<li><a href='#cen1way'><p>Peto-Peto one-factor test</p></a></li>
<li><a href='#cen2means'><p>Censored data two-group test for difference in means</p></a></li>
<li><a href='#cen2way'><p>Parametric Two Factor Fixed Effects ANOVA for censored data</p></a></li>
<li><a href='#cenanova'><p>ANOVA for censored data</p></a></li>
<li><a href='#cenCompareCdfs'><p>Comparison of empirical cdf of censored data</p></a></li>
<li><a href='#cenCompareQQ'><p>Censored Q-Q Plot comparison</p></a></li>
<li><a href='#cencorreg'><p>Correlation and Regression with censored data</p></a></li>
<li><a href='#cenperm2'><p>Censored two-group permutation test</p></a></li>
<li><a href='#cenpermanova'><p>Censored data one-factor permutation test</p></a></li>
<li><a href='#cenPredInt'><p>Prediction interval for censored data</p></a></li>
<li><a href='#cenQQ'><p>Q-Q Plot censored data</p></a></li>
<li><a href='#cenregQQ'><p>Q-Q plot of censored regression residuals</p></a></li>
<li><a href='#censeaken'><p>Seasonal Kendall permutation test on censored data</p></a></li>
<li><a href='#cenTolInt'><p>Upper Tolerance interval for censored data</p></a></li>
<li><a href='#centrend'><p>Trend analysis of censored data with a covariate</p></a></li>
<li><a href='#centrendsea'><p>Trend analysis of censored data with a covariate and seasonal blocks</p></a></li>
<li><a href='#cfit'><p>Compute an ECDF and Distribution Parameters for Censored Data</p></a></li>
<li><a href='#computeS'><p>Kendall's S-statistic for permutations of censored data</p></a></li>
<li><a href='#equivalent_n'><p>Censored data sample size</p></a></li>
<li><a href='#Example1'><p>Example1</p></a></li>
<li><a href='#Example2'><p>Example2</p></a></li>
<li><a href='#Example3'><p>Example3</p></a></li>
<li><a href='#Gales_Creek'><p>Gales_Creek</p></a></li>
<li><a href='#kenplot'><p>Plot robust median ATS line for censored data</p></a></li>
<li><a href='#markers'><p>Markers</p></a></li>
<li><a href='#ordranks'><p>Computes ranks of data with one or multiple detection limits</p></a></li>
<li><a href='#partplots'><p>Partial plots for censored MLE regression</p></a></li>
<li><a href='#PbHeron'><p>PbHeron</p></a></li>
<li><a href='#Pollen_Thia'><p>Thiamethoxam concentrations in pollen</p></a></li>
<li><a href='#ppw.test'><p>Test for difference in left-censored samples</p></a></li>
<li><a href='#quantile_CI'><p>quantile confidence interval</p></a></li>
<li><a href='#ReconLogistic'><p>ReconLogistic</p></a></li>
<li><a href='#ROSci'><p>Computes confidence intervals on regression on order statistics (ROS) mean</p></a></li>
<li><a href='#TCE2'><p>TCE2</p></a></li>
<li><a href='#uMDS'><p>Plot U-score Nonmetric Multidimensional Scaling of censored data</p></a></li>
<li><a href='#Usc'><p>U-scores for (non-interval, sinle-column) Censored Data</p></a></li>
<li><a href='#Usci'><p>Interval-censored U-Score</p></a></li>
<li><a href='#uscore'><p>U-score (individual value)</p></a></li>
<li><a href='#uscores'><p>Uscores for multiple columns of censored data</p></a></li>
<li><a href='#uscoresi'><p>U-scores for interval-censored data (multiple columns)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Data Analysis for Censored Environmental Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Julian &lt;pauljulianphd@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/SwampThingPaul/NADA2">https://github.com/SwampThingPaul/NADA2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/SwampThingPaul/NADA2/issues">https://github.com/SwampThingPaul/NADA2/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Contains methods described by Dennis Helsel in 
             his book "Statistics for Censored Environmental Data
             using Minitab and R" (2011) and courses and videos at 
             <a href="https://practicalstats.com">https://practicalstats.com</a>. This package adds new functions to 
             the 'NADA' Package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6), EnvStats (&ge; 2.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils, fitdistrplus, Kendall,
multcomp, NADA, perm, survminer, mgcv, cenGAM, vegan, coin,
survival</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, bestglm, car, nlme, rms</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-06 13:15:44 UTC; PaulJulian</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Julian [aut, cre],
  Dennis Helsel [aut, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-06 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anosimPlot'>Permutation Analysis of Similarity (anosim) for Censored Data</h2><span id='topic+anosimPlot'></span>

<h3>Description</h3>

<p>Plots the permutation histogram and test statistic produced by an anosim (nonparametric multivariate) test of differences between groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anosimPlot(
  ano.out,
  hcol = "light blue",
  title = "Histogram of anosim permutations"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anosimPlot_+3A_ano.out">ano.out</code></td>
<td>
<p>an <code>anosim</code> object. See details and example</p>
</td></tr>
<tr><td><code id="anosimPlot_+3A_hcol">hcol</code></td>
<td>
<p>color of histogram</p>
</td></tr>
<tr><td><code id="anosimPlot_+3A_title">title</code></td>
<td>
<p>title of histogram</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots a histogram of the permutation test statistics representing the null hypothesis along with the observed test statistic from the data.  The p-value is the proportion of test statistics equal to or more extreme than the observed test statistic.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Oksanen, J., Guillaume, F., 2018. Vegan: ecological diversity. CRAN R-Project. <a href="https://cran.r-project.org/package=vegan">https://cran.r-project.org/package=vegan</a>
</p>


<h3>See Also</h3>

<p><a href="vegan.html#topic+anosim">vegan::anosim</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

# ROS model for each group
PbHeron.high &lt;- with(subset(PbHeron,DosageGroup=="High"),NADA::ros(Blood,BloodCen))
PbHeron.high &lt;- data.frame(PbHeron.high)
PbHeron.high$DosageGroup &lt;- "High"

PbHeron.low &lt;- with(subset(PbHeron,DosageGroup=="Low"),NADA::ros(Blood,BloodCen))
PbHeron.low &lt;- data.frame(PbHeron.low)
PbHeron.low$DosageGroup &lt;- "Low"

PbHeron.ros=rbind(PbHeron.high,PbHeron.low)

# ANOSIM analysis
library(vegan)
PbHeron.anosim &lt;- with(PbHeron.ros,anosim(modeled,DosageGroup))
summary(PbHeron.anosim)

# Plot
anosimPlot(PbHeron.anosim)
</code></pre>

<hr>
<h2 id='atrazine'>Atrazine concentrations in Nebraska ground water</h2><span id='topic+atrazine'></span>

<h3>Description</h3>

<p>From the <code>NADA</code> R-Package.
</p>
<p>Atrazine concentrations in a series of Nebraska wells before (June) and after (September) the growing season.
</p>
<p>Objective is to determine if concentrations increase from June to September. There is one detection limit, at 0.01 ug/L. Used in Chapters 4, 5, and 9 of the Helsel (2011) book.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(atrazine)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 24 rows and 4 columns.
</p>


<h3>Source</h3>

<p>Junk et al., 1980. Areal, vertical, and temporal differences in ground water chemistry: II. Journal of Environmental Quality. 9(3) 479 - 483.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. 2011. Statistics for Censored Environmental Data Using Minitab and R. 2nd ed. John Wiley and Sons, USA, N.J.
</p>

<hr>
<h2 id='ATS'>Akritas-Theil-Sen line for censored data</h2><span id='topic+ATS'></span>

<h3>Description</h3>

<p>Computes Kendall's tau and the Akritas-Theil-Sen (ATS) line for censored data, along with the test that the slope (and Kendall's tau) equal zero.  For one x variable regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ATS(
  y.var,
  y.cen,
  x.var,
  x.cen = rep(0, times = length(x.var)),
  LOG = TRUE,
  retrans = FALSE,
  xlabel = NULL,
  ylabel = NULL,
  printstat = TRUE,
  drawplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ATS_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="ATS_+3A_y.cen">y.cen</code></td>
<td>
<p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and <code>0</code> (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="ATS_+3A_x.var">x.var</code></td>
<td>
<p>The column of x (explanatory variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="ATS_+3A_x.cen">x.cen</code></td>
<td>
<p>The x-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>x.var</code> column, and <code>0</code> (or <code>FALSE</code>) indicates a detected value in <code>x.var</code>.</p>
</td></tr>
<tr><td><code id="ATS_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the ATS line in the original y units, or for their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="ATS_+3A_retrans">retrans</code></td>
<td>
<p>Indicator of whether to retransform the plot and line back to original Y-variable units.  Not needed when <code>LOG = FALSE</code>. When <code>retrans = FALSE</code> &amp; <code>LOG = TRUE</code> the plot is drawn with logY units (default). When <code>retrans =  TRUE</code> &amp; <code>LOG = TRUE</code> the plot is drawn with original Y units.</p>
</td></tr>
<tr><td><code id="ATS_+3A_xlabel">xlabel</code></td>
<td>
<p>Custom label for the x axis of plots.  Default is x variable column name.</p>
</td></tr>
<tr><td><code id="ATS_+3A_ylabel">ylabel</code></td>
<td>
<p>Custom label for the y axis of plots.  Default is y variable column name.</p>
</td></tr>
<tr><td><code id="ATS_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="ATS_+3A_drawplot">drawplot</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to draw plots or not. Default is <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Coefficients (intercept and slope) for the ATS line are printed, along with Kendall's tau correlation coefficient, test statistic S, and the (single) p-value for the test that tau and slope both equal zero. A scatterplot with the fitted trend-line superimposed is also drawn.
</p>


<h3>References</h3>

<p>Akritas, M.G., Murphy, S.A., LaValley, M.P., 1995. The Theil-Sen Estimator With Doubly Censored Data and Applications to Astronomy. Journal of the American Statistical Association 90, 170–177. https://doi.org/10.2307/2291140
</p>
<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Both y and x are censored
data(PbHeron)
with(PbHeron, ATS(Blood, BloodCen, Kidney, KidneyCen))

# x is not censored
data(Brumbaugh)
with(Brumbaugh,ATS(Hg, HgCen, PctWetland))
</code></pre>

<hr>
<h2 id='ATSmini'>Kendall's tau and ATS line for censored data</h2><span id='topic+ATSmini'></span>

<h3>Description</h3>

<p>Computes Kendall's tau and the Akritas-Theil-Sen (ATS) line for censored data.  Is called by censeaken because it is much faster than the ATS function.  It is not expected to be of much use to users on its own. The x variable (time) may not be censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ATSmini(y.var, y.cen, x.var)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ATSmini_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits.</p>
</td></tr>
<tr><td><code id="ATSmini_+3A_y.cen">y.cen</code></td>
<td>
<p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="ATSmini_+3A_x.var">x.var</code></td>
<td>
<p>The column of x (time for a trend test) values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the intercept and slope (ATS line), tau (Kendall's tau), p-value and S-value (test statistic).
</p>


<h3>References</h3>

<p>Akritas, M.G., Murphy, S.A., LaValley, M.P., 1995. The Theil-Sen Estimator With Doubly Censored Data and Applications to Astronomy. Journal of the American Statistical Association 90, 170–177. https://doi.org/10.2307/2291140
</p>
<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="NADA.html#topic+cenken">NADA::cenken</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># x may not be censored.  Use the ATS function when x is censored.
data(Brumbaugh)

with(Brumbaugh, ATSmini(Hg, HgCen, SedLOI))
</code></pre>

<hr>
<h2 id='bestaic'>Find the lowest AIC multiple regression model</h2><span id='topic+bestaic'></span>

<h3>Description</h3>

<p>Computes (2^k-1) censored regression models and their AIC statistics.  Prints out the lowest AIC models and the terms used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestaic(y.var, cen.var, x.vars, LOG = TRUE, n.models = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bestaic_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits.</p>
</td></tr>
<tr><td><code id="bestaic_+3A_cen.var">cen.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value is in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="bestaic_+3A_x.vars">x.vars</code></td>
<td>
<p>One or more uncensored explanatory variable(s). See Details</p>
</td></tr>
<tr><td><code id="bestaic_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="bestaic_+3A_n.models">n.models</code></td>
<td>
<p>The number of models with their AIC values to be printed in the console window.  All (2^k-1) models are computed internally. This sets how many &quot;best&quot; (lowest AIC) models have output printed to the console.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x.vars</code>: If 1 x variable only, enter its name.  If multiple x variables, enter the name of a data frame of columns of the x variables. No extra columns unused in the regression allowed. Create this by <code>x.frame &lt;- data.frame (Temp, Flow, Time)</code> for 3 variables (temperature, flow and time).
</p>
<p>AIC of each model is printed from lowest to highest AIC to help evaluate the ‘best’ regression model. n.models determines how many lines of model info is printed.
</p>
<p>LOG: The default is that the Y variable will be log transformed (LOG = TRUE).
</p>


<h3>Value</h3>

<p>Prints number of <code>x.vars</code>, lists <code>x.vars</code> and AIC values.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

# Multiple regression
bestaic(Brumbaugh$Hg, Brumbaugh$HgCen, Brumbaugh[, c("SedMeHg","PctWetland", "SedAVS")])
</code></pre>

<hr>
<h2 id='binaryClust'>Cluster Matrix of Binary Censored Data</h2><span id='topic+binaryClust'></span>

<h3>Description</h3>

<p>Performs clustering of a matrix of 0s and 1s, ie. the censoring indicator columns for multiple variables. If there are multiple detection limits within a column first convert the 0/1 designated to be Below vs Above the highest detection limit in the column.  Detection limits may differ among columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binaryClust(dat.frame, method = "ward.D2", group = NULL, ncluster = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binaryClust_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame containing only the 0/1 columns, one column per chemical parameter.</p>
</td></tr>
<tr><td><code id="binaryClust_+3A_method">method</code></td>
<td>
<p>Method of forming clusters.  The default is <code>"ward.D2"</code>, which is appropriate for a variety of types of data.  Another appropriate option is <code style="white-space: pre;">&#8288;“average”&#8288;</code> – average distances between cluster centers.  See the vegan package for other possible clustering methods.</p>
</td></tr>
<tr><td><code id="binaryClust_+3A_group">group</code></td>
<td>
<p>Optional grouping variable. If used, sites being clustered will be represented by their group name, rather than by the row number.</p>
</td></tr>
<tr><td><code id="binaryClust_+3A_ncluster">ncluster</code></td>
<td>
<p>Optional number of clusters to be differentiated on the graph. Clusters are fenced off with rectangles.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a cluster dendrogram based on clustering method
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

# without group specified
binaryClust(PbHeron[,4:15])

# With Group argument
binaryClust(PbHeron[,4:15],group=PbHeron$DosageGroup)
</code></pre>

<hr>
<h2 id='binaryDiss'>Binary dissimilarity coefficient matrix</h2><span id='topic+binaryDiss'></span>

<h3>Description</h3>

<p>Computes a simple matching dissimilarity coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binaryDiss(dat.frame)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binaryDiss_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame containing only the 0/1 columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a binary dissimilarity matrix.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="vegan.html#topic+designdist">vegan::designdist</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

binaryDiss(PbHeron$LiverCen)
</code></pre>

<hr>
<h2 id='binaryMDS'>Plot Nonmetric Multidimensional Scaling of binary censored data</h2><span id='topic+binaryMDS'></span>

<h3>Description</h3>

<p>Plots an NMDS of a matrix of 0s and 1s, the censoring indicator columns for multiple variables, to discern the pattern of data below vs. above the detection limit.  With multiple detection limits within a column, re-censoring to the highest limit in the column must be done prior to running this function.  May have different censoring levels in different columns.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binaryMDS(dat.frame, group = NULL, title = NULL, legend.pos = "bottomleft")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binaryMDS_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame containing only the columns of 0/1 values.</p>
</td></tr>
<tr><td><code id="binaryMDS_+3A_group">group</code></td>
<td>
<p>Optional grouping variable. Sites will be represented by different colored symbols for each group.</p>
</td></tr>
<tr><td><code id="binaryMDS_+3A_title">title</code></td>
<td>
<p>Optional title for the NMDS graph.</p>
</td></tr>
<tr><td><code id="binaryMDS_+3A_legend.pos">legend.pos</code></td>
<td>
<p>When group is specified, determines the location of the legend on the graph showing the colors representing each group’s data.  Default is “bottomleft”.  Alternatives are “topright” and “centerleft”, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Binary data may not provide sufficient information to discern differences in location on the plot if sample size is small.  Prior to running this analysis it is suggested to consult best analysis practice when performing NMDS. As a rule of thumb, an NMDS ordination with a stress value around or above 0.2 is deemed suspect and a stress value approaching 0.3 indicates that the ordination is arbitrary. Stress values equal to or below 0.1 are considered fair, while values equal to or below 0.05 indicate good fit.
</p>


<h3>Value</h3>

<p>Plots an NMDS of censored data represented as the binary Above vs Below a detection limit for each parameter.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="vegan.html#topic+metaMDS">vegan::metaMDS</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(PbHeron)

# without group specified
binaryMDS(PbHeron[,4:15])

# With Group argument
binaryMDS(PbHeron[,4:15],group=PbHeron$DosageGroup)

</code></pre>

<hr>
<h2 id='binarySim'>Binary similarity coefficient matrix</h2><span id='topic+binarySim'></span>

<h3>Description</h3>

<p>Computes a simple matching similarity coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binarySim(dat.frame)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="binarySim_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame containing only the 0/1 columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a binary similarity matrix.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="vegan.html#topic+designdist">vegan::designdist</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

binarySim(PbHeron$LiverCen)

</code></pre>

<hr>
<h2 id='Brumbaugh'>Brumbaugh</h2><span id='topic+Brumbaugh'></span>

<h3>Description</h3>

<p>From the <code>NADA</code> R-Package.
</p>
<p>Mercury concentrations in fish across the United States.
</p>
<p>Objective is to determine if mercury concentrations differ by watershed land use. Can concentrations be related to water and sediment characteristics of the streams?
</p>
<p>There are three detection limits, at 0.03, 0.05, and 0.10 ug/g wet weight. Used in Chapters 10, 11 and 12 of the Helsel (2011) book.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Brumbaugh)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 133 rows and 14 columns.
</p>


<h3>Source</h3>

<p>Brumbaugh et al., 2001, USGS Biological Science Report BSR-2001-0009.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>

<hr>
<h2 id='cboxplot'>Draws censored boxplots</h2><span id='topic+cboxplot'></span>

<h3>Description</h3>

<p>Draws boxplots for left-censored data with one ore more detection limit(s). Portions below the maximum detection limit(s) are not shown by default, as their percentiles are not known.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cboxplot(
  x1,
  x2,
  xgroup = NULL,
  LOG = FALSE,
  show = FALSE,
  ordr = NULL,
  Ylab = yname,
  Xlab = gname,
  Title = NULL,
  dl.loc = "topright",
  dl.col = "red",
  dl.lwd = 2,
  dl.lty = "longdash",
  bxcol = "white",
  Ymax = NULL,
  minmax = FALSE,
  printstat = FALSE,
  Hlines = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cboxplot_+3A_x1">x1</code></td>
<td>
<p>The column of x (response variable) values plus detection limits.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_x2">x2</code></td>
<td>
<p>The x-variable censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the y1 column, and 0 (or <code>FALSE</code>) indicates a detected value in y1.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_xgroup">xgroup</code></td>
<td>
<p>An optional column of a grouping variable.  Draws side-by-side boxplots if this variable is present.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_log">LOG</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> indicator of whether to plot the Y axis data on the original scale (<code>FALSE</code>) or log scale (<code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_show">show</code></td>
<td>
<p><code>TRUE</code>\/<code>FALSE</code> indicator of whether to show estimated values computed using ROS for the portion of the box below the maximum DL (<code>TRUE</code>), or just leave the lower portion blank (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_ordr">ordr</code></td>
<td>
<p>A vector indicating the order of boxes to be drawn on the boxplot, if not in alphabetical order (the default).  Example: for 4 boxplots for groups A, B, C, D, to change the order to the reverse type ordr = c(4, 3, 2, 1).  Example 2: To change the order to A, C, D, B, type ordr = c(1, 3, 4, 2)</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_ylab">Ylab</code></td>
<td>
<p>Y axis label text, if something is wanted other than the Y variable name in the dataset.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_xlab">Xlab</code></td>
<td>
<p>X axis label text, if something is wanted other than the group variable name in the dataset.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_title">Title</code></td>
<td>
<p>Text to show as the graph title.  Default is blank.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_dl.loc">dl.loc</code></td>
<td>
<p>Location indicator of where to plot the &quot;MaxDL=&quot; text on some versions of the plot.  Possible entries are “topleft”, “topright”, “topcenter”, and the corresponding “bottom” text.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_dl.col">dl.col</code></td>
<td>
<p>Color of the max detection limit line(s), and the legend text stating the max DL.  Default is “red”, but all standard R colors may be used.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_dl.lwd">dl.lwd</code></td>
<td>
<p>line wide of max detection limit line(s).</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_dl.lty">dl.lty</code></td>
<td>
<p>line type of max detection limit line(s).</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_bxcol">bxcol</code></td>
<td>
<p>Color for interior of boxplots. Specify just one color if all boxes are to be the same color.  If a different color is desired for each of three boxplots, as one example, use bxcol = c(“red”, “white”, “blue”) etc.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_ymax">Ymax</code></td>
<td>
<p>Maximum Y value to be shown on the plot.  Used to cut off high outliers on plot and better show the bulk of the boxplots.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_minmax">minmax</code></td>
<td>
<p><code>TRUE</code>/<code>FALSE</code> indicator of whether to draw outliers individually. Default is to show outliers. Setting <code>minmax = TRUE</code> will draw the whiskers out to the max and min of the dataset.</p>
</td></tr>
<tr><td><code id="cboxplot_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="cboxplot_+3A_hlines">Hlines</code></td>
<td>
<p>Data to add horizontal reference lines to the boxplot. Required input is a data frame of 4 columns.  See Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If maximum detection limits vary among groups, separate maxDL lines will be drawn for each group's boxplot. If one group has fewer than 3 detected observations its boxplot will not be drawn.  Its detection limits will not count when computing the maximum limit.  However, if only one boxplot is drawn for the entire dataset by not specifying a group variable, the detection limits from the portion that is the mostly ND group will be used when computing the maximum limit.
</p>
<p>The reuired input to draw additional horizontal lines (Hlines option) is a data frame with 4 columns of input, one row per horizontal line.  More than one line may be drawn.  Column one is the Y axis value for the line.  Column 2 is the line color, column 3 is the line type (lty) and column 4 is the text to be added just above the line.  To add one line at a value of 40, for example, use Hlines = yline, after defining yline = data.frame(c(40, &quot;purple&quot;, &quot;dotted&quot;, &quot;New Health Std&quot;)).  To draw two lines, define yline as yline = data.frame(matrix(c(40, &quot;purple&quot;, &quot;dotted&quot;, &quot;New Health Std&quot;, 70, &quot;blue&quot;, &quot;longdash&quot;, &quot;Old Health Std&quot;), ncol = 4, byrow=TRUE))) . If no text is wanted use &quot; &quot; for the column 4 entry for that line. See ?par under lty for standard line types.
</p>


<h3>Value</h3>

<p>Prints a boxplot with detection limit identified and a concatenated list of the maximum detection limit for each group.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)
cboxplot(PbHeron$Liver,PbHeron$LiverCen,PbHeron$Group)
</code></pre>

<hr>
<h2 id='cen_ecdf'>Censored Empirical Cumulative Distribution Function</h2><span id='topic+cen_ecdf'></span>

<h3>Description</h3>

<p>Plots ecdfs of one or more groups of censored data.  Illustrates the differences between groups for group tests such as those done using cen1way or cenanova.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen_ecdf(
  x.var,
  cens.var,
  xgroup = NULL,
  xlim = c(0, max(y.var)),
  Ylab = varname
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen_ecdf_+3A_x.var">x.var</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen_ecdf_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cen_ecdf_+3A_xgroup">xgroup</code></td>
<td>
<p>Optional - grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cen_ecdf_+3A_xlim">xlim</code></td>
<td>
<p>Limits for the x (data) axis of the ecdf plot.  Default is 0 to the maximum of the y.var variable.  To change, use option xlim = c(0, 50) if 50 is to be the maximum on the plot.</p>
</td></tr>
<tr><td><code id="cen_ecdf_+3A_ylab">Ylab</code></td>
<td>
<p>Optional – input text in quotes to be used as the variable name on the ecdf plot.  The default is the name of the <code>y.var</code> input variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots an empirical cumulative distribution function. If <code>group=NULL</code> the ECDF of the entire dataset is produced. If <code>group</code> is identified then ECDFs are plotted for each group seperately and a legend added.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

# with groups
with(PbHeron, cen_ecdf(Liver, LiverCen, DosageGroup))

# all data
with(PbHeron, cen_ecdf(Liver, LiverCen))
</code></pre>

<hr>
<h2 id='cen_paired'>Censored data paired t-test</h2><span id='topic+cen_paired'></span>

<h3>Description</h3>

<p>Performs a parametric test of whether the mean difference between two columns of paired censored data equals 0. Assumes that the paired differences follow a gaussian (normal) distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen_paired(xd, xc, yd, yc, alternative = "two.sided", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen_paired_+3A_xd">xd</code></td>
<td>
<p>The first column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen_paired_+3A_xc">xc</code></td>
<td>
<p>The column of censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the xd column, and 0 (or <code>FALSE</code>) indicates a detected value in xd.</p>
</td></tr>
<tr><td><code id="cen_paired_+3A_yd">yd</code></td>
<td>
<p>The second column of data values plus detection limits, or a single number representing a standard / guideline value.</p>
</td></tr>
<tr><td><code id="cen_paired_+3A_yc">yc</code></td>
<td>
<p>The column of censoring indicators for yd, where 1 (or <code>TRUE</code>) indicates a detection limit in the yd column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>yd</code>. Not needed if <code>yd</code> is a single standard number.</p>
</td></tr>
<tr><td><code id="cen_paired_+3A_alternative">alternative</code></td>
<td>
<p>The usual notation for the alternate hypothesis.  Default is <code style="white-space: pre;">&#8288;“two.sided”&#8288;</code>.  Options are <code style="white-space: pre;">&#8288;“greater”&#8288;</code> or <code style="white-space: pre;">&#8288;“less”&#8288;</code>.</p>
</td></tr>
<tr><td><code id="cen_paired_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>You may also test for whether the mean of the <code>xd</code> data exceeds a standard by entering the single number for the standard as <code>yd</code>.  In that case no <code>yc</code> is required.
</p>


<h3>Value</h3>

<p>A list of statistics containing the following components:
</p>

<ul>
<li> <p><code>n</code> Number of observations
</p>
</li>
<li> <p><code>Z</code> The value of the test statistic
</p>
</li>
<li> <p><code>p.value</code> the p-value of the test
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Mean difference&#8288;</code> the mean difference between <code>xd</code> and <code>yd</code>
</p>
</li></ul>



<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(atrazine)

cen_paired(atrazine$June,atrazine$JuneCen,atrazine$Sept,atrazine$SeptCen)

# Comparing standard/guieline value
cen_paired(atrazine$June, atrazine$JuneCen, 0.01, alternative = "greater")
</code></pre>

<hr>
<h2 id='cen_signedranktest'>Wilcoxcon Signed-Rank test for censored data</h2><span id='topic+cen_signedranktest'></span>

<h3>Description</h3>

<p>Performs a nonparametric Wilcoxon signed-rank test of whether the median difference between two columns of paired censored data equals 0.  Uses the Pratt adjustment for pairs of equal or indistinguishable values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen_signedranktest(xd, xc, yd, yc, alternative = "two.sided", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen_signedranktest_+3A_xd">xd</code></td>
<td>
<p>The first column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen_signedranktest_+3A_xc">xc</code></td>
<td>
<p>The column of censoring indicators for <code>xd</code>, where 1 (or <code>TRUE</code>) indicates a detection limit in the xd column, and 0 (or <code>FALSE</code>) indicates a detected value in xd.</p>
</td></tr>
<tr><td><code id="cen_signedranktest_+3A_yd">yd</code></td>
<td>
<p>The second column of data values plus detection limits, or a single number representing a standard / guideline value.</p>
</td></tr>
<tr><td><code id="cen_signedranktest_+3A_yc">yc</code></td>
<td>
<p>The column of censoring indicators for yd, where 1 (or <code>TRUE</code>) indicates a detection limit in the yd column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>yd</code>. Not needed if <code>yd</code> is a single standard number.</p>
</td></tr>
<tr><td><code id="cen_signedranktest_+3A_alternative">alternative</code></td>
<td>
<p>The usual notation for the alternate hypothesis.  Default is <code style="white-space: pre;">&#8288;“two.sided”&#8288;</code>.  Options are <code style="white-space: pre;">&#8288;“greater”&#8288;</code> or <code style="white-space: pre;">&#8288;“less”&#8288;</code>.</p>
</td></tr>
<tr><td><code id="cen_signedranktest_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a list of Wilcoxon Signed-Rank test with Pratt correction for ties statistics containing the following components:
</p>

<ul>
<li> <p><code>n</code> Number of samples
</p>
</li>
<li> <p><code>Z</code> The value of the test statistic
</p>
</li>
<li> <p><code>p.value</code> the p-value of the test
</p>
</li></ul>



<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Page, E.B., 1963. Ordered Hypotheses for Multiple Treatments: A Significance Test for Linear Ranks. Journal of the American Statistical Association 58, 216–230. doi: <a href="https://doi.org/10.2307/2282965">10.2307/2282965</a>
</p>
<p>Pratt, J.W., 1959. Remarks on Zeros and Ties in the Wilcoxon Signed Rank Procedures. Journal of the American Statistical Association 54, 655–667. doi: <a href="https://doi.org/10.2307/2282543">10.2307/2282543</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(atrazine)

cen_signedranktest(atrazine$June,atrazine$JuneCen,atrazine$Sept,atrazine$SeptCen)
</code></pre>

<hr>
<h2 id='cen_signtest'>Sign test for censored data</h2><span id='topic+cen_signtest'></span>

<h3>Description</h3>

<p>Performs a nonparametric sign test of whether the median difference between two columns of paired censored data equals 0. Uses the Fong adjustment for pairs of equal values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen_signtest(xd, xc, yd, yc, alternative = "two.sided", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen_signtest_+3A_xd">xd</code></td>
<td>
<p>The first column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen_signtest_+3A_xc">xc</code></td>
<td>
<p>The column of censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the xd column, and 0 (or <code>FALSE</code>) indicates a detected value in xd.</p>
</td></tr>
<tr><td><code id="cen_signtest_+3A_yd">yd</code></td>
<td>
<p>The second column of data values plus detection limits.</p>
</td></tr>
<tr><td><code id="cen_signtest_+3A_yc">yc</code></td>
<td>
<p>The column of censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>yd</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>yd</code>.</p>
</td></tr>
<tr><td><code id="cen_signtest_+3A_alternative">alternative</code></td>
<td>
<p>The usual notation for the alternate hypothesis.  Default is <code style="white-space: pre;">&#8288;“two.sided”&#8288;</code>.  Options are <code style="white-space: pre;">&#8288;“greater”&#8288;</code> or <code style="white-space: pre;">&#8288;“less”&#8288;</code>.</p>
</td></tr>
<tr><td><code id="cen_signtest_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the number of <code>xd</code> and <code>yd</code> values greater than, less than and tied. Corrected and uncorrected <code>p-value</code> for ties also displayed.
</p>


<h3>References</h3>

<p>Fong, D.Y.T., Kwan, C.W., Lam, K.F., Lam, K.S.L., 2003. Use of the Sign Test for the Median in the Presence of Ties. The American Statistician 57, 237–240.
</p>
<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
#'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(atrazine)

cen_signtest(atrazine$June,atrazine$JuneCen,atrazine$Sept,atrazine$SeptCen)
</code></pre>

<hr>
<h2 id='cen1way'>Peto-Peto one-factor test</h2><span id='topic+cen1way'></span>

<h3>Description</h3>

<p>Performs a Peto-Peto nonparametric test of differences in cdfs between groups.  If more than two groups, the test is followed by a nonparametric multiple comparison test.  Uses the BH method of adjusting p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen1way(x1, x2, group, mcomp.method = "BH", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen1way_+3A_x1">x1</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen1way_+3A_x2">x2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the y1 column, and 0 (or <code>FALSE</code>) indicates a detected value in y1.</p>
</td></tr>
<tr><td><code id="cen1way_+3A_group">group</code></td>
<td>
<p>Grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cen1way_+3A_mcomp.method">mcomp.method</code></td>
<td>
<p>One of the standard methods for adjusting p-values for multiple comparisons.  Type ?p.adjust for the list of possible methods. Default is Benjamini-Hochberg &quot;BH&quot; false discover rate.</p>
</td></tr>
<tr><td><code id="cen1way_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of summary statistics for each group evaluated containing the following components:
</p>

<ul>
<li> <p><code>N</code> Number of samples
</p>
</li>
<li> <p><code>PctND</code> Percentage of non-detects
</p>
</li>
<li> <p><code>KMmean</code> Kaplan-Meier estimate of the mean
</p>
</li>
<li> <p><code>KMsd</code> Kaplan-Meier estimate of standard deviation
</p>
</li>
<li> <p><code>KMmedian</code> Kaplan-Meier estmate of the median
</p>
</li></ul>

<p>Peto-Peto test results including Chi-Squared value, degrees of freedom and <code>p-value</code> of the test.
</p>
<p>If more than two groups, <code>p-values</code> of the pairwise multiple comparisons, adjusted using the BH false-discovery rate, are reported.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Peto, R., Peto, J., 1972. Asymptotically Efficient Rank Invariant Test Procedures. Journal of the Royal Statistical Society. Series A (General) 135, 185. doi: <a href="https://doi.org/10.2307/2344317">10.2307/2344317</a>
</p>
<p>Benjamini, Y., Hochberg, Y., 1995. Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing.  Journal of the Royal Statistical Society. Series B (Methodological), 57, 289-300.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

# Two Groups
cen1way(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup)

# More than two groups
cen1way(PbHeron$Liver,PbHeron$LiverCen,PbHeron$Group)
</code></pre>

<hr>
<h2 id='cen2means'>Censored data two-group test for difference in means</h2><span id='topic+cen2means'></span>

<h3>Description</h3>

<p>Performs a parametric test of differences in means between two groups of censored data, either in original or in log units (the latter becomes a test for difference in geometric means).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen2means(x1, x2, group, LOG = TRUE, printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen2means_+3A_x1">x1</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen2means_+3A_x2">x2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the y1 column, and 0 (or <code>FALSE</code>) indicates a detected value in y1.</p>
</td></tr>
<tr><td><code id="cen2means_+3A_group">group</code></td>
<td>
<p>Grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cen2means_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute tests in the original units, or on their logarithms.  The default is to use the logarithms (LOG = <code>TRUE</code>).  To compute in original units, specify the option LOG = <code>FALSE</code> (or LOG = 0).</p>
</td></tr>
<tr><td><code id="cen2means_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because this is an MLE procedure, when a normal distribution model is used (LOG=FALSE) values may be modeled as below zero.  When this happens the means may be too low and the p-values may be unreal (often lower than they should be).  Because of this, testing in log units is preferable and is the default.
</p>


<h3>Value</h3>

<p>Q-Q Plot with Shapiro-Francia test for normality W and p-values.
Returns the Maximum Likelihood Estimation (MLE) test results including Chi-Squared value, degrees of freedom and <code>p-value</code> of the test.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Shapiro, S.S., Francia, R.S., 1972. An approximate analysis of variance test for normality. Journal of the American Statistical Association 67, 215–216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(PbHeron)
cen2means(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup)
</code></pre>

<hr>
<h2 id='cen2way'>Parametric Two Factor Fixed Effects ANOVA for censored data</h2><span id='topic+cen2way'></span>

<h3>Description</h3>

<p>Computes tests for each of the two factors and optionally for their interaction using likelihood ratio tests. p-values will not be identical to the usual method of moments ANOVA tests but will be similar.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cen2way(y1, y2, fac1, fac2, LOG = TRUE, interact = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cen2way_+3A_y1">y1</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cen2way_+3A_y2">y2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y1</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y1</code>.</p>
</td></tr>
<tr><td><code id="cen2way_+3A_fac1">fac1</code></td>
<td>
<p>The first grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cen2way_+3A_fac2">fac2</code></td>
<td>
<p>The second grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cen2way_+3A_log">LOG</code></td>
<td>
<p>A logical variable indicating whether natural logs are to be taken of the 'y1' column data. Default is TRUE.</p>
</td></tr>
<tr><td><code id="cen2way_+3A_interact">interact</code></td>
<td>
<p>A logical variable indicating whether to compute an interaction term between the two variables. Default is TRUE.
#' @keywords two-way two-factor factorial ANOVA analysis of variance censored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tests are computed using Maximum Likelihood Estimation. When a gaussian	distribution model is	used (LOG=FALSE) modeled values may fall below zero, producing unreal p-values (often lower than they should be).  Because of this, testing in log units is preferable and is the default unless you are transforming the y values prior to running the function (such as taking cube roots to approximate a gamma distribution).  The 'delta.lr0x2' stat output is the -2loglikehood for the test of the model versus an intercept-only model.
</p>


<h3>Value</h3>

<p>Q-Q plots of residuals. Likelihood ratio test statistics (&quot;chisquare&quot;), degrees of freedom (&quot;df&quot;) and p-values (pval) for two factors and optionally the interaction. Data on the underlying models, including AIC and R2 are also provided.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Gales_Creek)
Gales_Creek$Period &lt;- c(rep("early", 35), rep("middle", 12), rep("late", 16))
with(Gales_Creek,cen2way(TCr, CrND, Season, Period))

</code></pre>

<hr>
<h2 id='cenanova'>ANOVA for censored data</h2><span id='topic+cenanova'></span>

<h3>Description</h3>

<p>Performs a parametric test of differences in means between groups of censored data, followed by a parametric Tukey's multiple comparison test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenanova(x1, x2, group, LOG = TRUE, printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenanova_+3A_x1">x1</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cenanova_+3A_x2">x2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y1</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y1</code>.</p>
</td></tr>
<tr><td><code id="cenanova_+3A_group">group</code></td>
<td>
<p>Grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cenanova_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute tests in the original units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="cenanova_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Test is computed using Maximum Likelihood Estimation. When a gaussian	distribution model is	used (LOG=FALSE) modeled values may fall below zero, producing unreal p-values (often lower than they should be).  Because of this, testing in log units is preferable and is the default.
</p>


<h3>Value</h3>

<p>Returns the Maximum Likelihood Estimation (MLE) comparison results including Chi-Squared value, degrees of freedom and <code>p-value</code> of the test. Test assumes log-normal(<code>LOG=TRUE</code>) or normal(<code>LOG=FALSE</code>) distribution of residuals from group means.
</p>
<p>Tukey's multiple comparison p-values of pairwise differences in group means are also printed.
</p>

<ul>
<li><p> Group Names of groups (NOTE: <code style="white-space: pre;">&#8288;== 0&#8288;</code> indicates null hypothesis of &quot;equals zero&quot;).
</p>
</li>
<li> <p><code>Estimate</code> Estimated difference between group means.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Std. Error&#8288;</code> Standard error of estimate.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;z value&#8288;</code> Test statistic.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;Pr(&gt;|z|)&#8288;</code> P-values for test that difference in means equals zero.
</p>
</li></ul>



<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>#' @examples
data(PbHeron)
cenanova(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup)
</p>
<p>cenanova(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup,LOG=FALSE)
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>

<hr>
<h2 id='cenCompareCdfs'>Comparison of empirical cdf of censored data</h2><span id='topic+cenCompareCdfs'></span>

<h3>Description</h3>

<p>Plots the empirical cdf and cdfs of three theoretical distributions, fit by maximum likelihood estimation (MLE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenCompareCdfs(x.var, cens.var, dist3 = "norm", Yname = yname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenCompareCdfs_+3A_x.var">x.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="cenCompareCdfs_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cenCompareCdfs_+3A_dist3">dist3</code></td>
<td>
<p>Name of the third distribution to be plotted, default is <code>norm</code> (normal distribution). Alternate third distribution is <code>weibull</code>(for Weibull distribution).  Log-normal and gamma distributions are always used.</p>
</td></tr>
<tr><td><code id="cenCompareCdfs_+3A_yname">Yname</code></td>
<td>
<p>Optional – input text in quotes to be used as the variable name.  The default is the name of the <code>y.var</code> input variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints a plot of the empirical CDFs with BIC value for each distribution.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Delignette-Muller, M., Dutang, C., 2015. fitdistrplus : An R Package for Fitting Distributions. Journal of Statistical Software, 64, 1-34. http://www.jstatsoft.org/v64/i04/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)
cenCompareCdfs(Brumbaugh$Hg,Brumbaugh$HgCen)

# With Weibull distribution
cenCompareCdfs(Brumbaugh$Hg,Brumbaugh$HgCen,dist3="weibull")

# Using an distribution not supported by this function (yet)
# you will get an error message
## Not run: cenCompareCdfs(Brumbaugh$Hg,Brumbaugh$HgCen,dist3="beta")

# With Yname specified
cenCompareCdfs(Brumbaugh$Hg,Brumbaugh$HgCen,Yname="TCE Conc (ug/L)\nLong Island, NY USA")
</code></pre>

<hr>
<h2 id='cenCompareQQ'>Censored Q-Q Plot comparison</h2><span id='topic+cenCompareQQ'></span>

<h3>Description</h3>

<p>Produces three quantile-quantile (Q-Q) plots, also called probability plots, based on three distributions (normal, lognormal and gamma distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenCompareQQ(x.var, cens.var, Yname = yname, printrslt = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenCompareQQ_+3A_x.var">x.var</code></td>
<td>
<p>The column of x (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="cenCompareQQ_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cenCompareQQ_+3A_yname">Yname</code></td>
<td>
<p>Optional – input text in quotes to be used as the variable name on all plots.  The default <code>Yname</code> is the name of the <code>y.var</code> input variable.</p>
</td></tr>
<tr><td><code id="cenCompareQQ_+3A_printrslt">printrslt</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the best distribution in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="cenCompareQQ_+3A_...">...</code></td>
<td>
<p>further graphical parameters (from par), such as srt, family and xpd.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces three Q-Q plots and reports which one has the highest Shapiro-Francia test statistic (W).  The distribution with the highest W is the best fit of the three.
</p>


<h3>Value</h3>

<p>Plots three Q-Q plots based on normal, lognormal and gamma distributions and prints the best-fit distribution.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>
<p>Shapiro, S.S., Francia, R.S., 1972. An approximate analysis of variance test for normality. Journal of the American Statistical Association 67, 215–216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)
cenCompareQQ(Brumbaugh$Hg,Brumbaugh$HgCen)
</code></pre>

<hr>
<h2 id='cencorreg'>Correlation and Regression with censored data</h2><span id='topic+cencorreg'></span>

<h3>Description</h3>

<p>Computes three parametric correlation coefficients for one X variable and the corresponding R squared for multiple X variables, and a regression equation for censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cencorreg(
  y.var,
  cen.var,
  x.vars,
  LOG = TRUE,
  verbose = 2,
  pred.plot = FALSE,
  pred.col = "purple"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cencorreg_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits.</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_cen.var">cen.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value is in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_x.vars">x.vars</code></td>
<td>
<p>One or more uncensored explanatory variable(s). For multiple variables it must be a data frame of numeric, character and factor variables. See Details</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_verbose">verbose</code></td>
<td>
<p>default <code>verbose=2</code>, see details.</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_pred.plot">pred.plot</code></td>
<td>
<p>default is FALSE. Produces a plot of data and regression model predictions.  To do this the first (or only) x variable in the X dataframe must be a continuous (not factor) variable, and it becomes the x variable in the plot.</p>
</td></tr>
<tr><td><code id="cencorreg_+3A_pred.col">pred.col</code></td>
<td>
<p>default is &quot;purple&quot;.  Changes the color of the predicted lines in the prediction plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>x.vars</code>: If one x variable only, enter its name.  If multiple x variables, enter the name of a data frame of columns of the x variables. Only columns used as <code>X</code> variables in the regression are allowed. Create this by <code>x.frame &lt;- data.frame (Temp, Flow, Time)</code> for 3 variables (temperature, flow and time) used as the <code>X</code> variables in the regression.  To produce a pred.plot plot of predicted values the first variable in the array must be a continuous (not a factor) variable.
</p>
<p>AIC and BIC are printed to help evaluate the ‘best’ regression model.  Lower values are better when comparing models with the same Y units and same data.Cannot be used to compare models with differing Y units (such as Y~X versus logY~X). Can be used to compare models with differing X units such as Y~X vs Y~logX.
</p>
<p>The default Y units are that the Y variable will be log transformed.  Change this with the LOG = option, setting LOG = FALSE.
</p>
<p><code>verbose</code> option. Default is 2 which provides full output in the console and qqplots in a graphics window. A value of 1 only provides partial results in the console and no plots. A value of 0 provides no output; the returning computations will be stored in the specified object.
</p>
<p>The Y parameter in the model output (modelname$y) is -1 times the data that were input. This is due to the shift from left censored data to the required right censored data of the survreg function.  The original data are not changed and are used to draw the pred.plot.
</p>


<h3>Value</h3>

<p>When <code>x.vars</code> is one variable, likelihood, rescaled likelihood and McFaddens correlation coefficient (<code>R</code>) are printed.
When <code>x.vars</code> is a <code>data.frame</code> of more than one variable, likelihood, rescaled likelihood and McFaddens coefficent of determination (<code>R2</code>) are printed.
</p>
<p>Model coefficients (intercept and slopes), Chi-Squared statistic and p-value for the test that all slope coefficients equal zero (overall test), and model AIC and BIC are provided.
</p>
<p>A Q-Q plot of model residuals with corresponding Shapiro-Francia W and p-value are plotted for evaluation of model distributional assumptions when <code>verbose=2</code> (the default).
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Helsel, D.R., 2005. Nondetects and Data Analysis: Statistics for Censored Environmental Data, 1st ed. John Wiley and Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

# One variable
cencorreg(Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh$SedMeHg)

# One variable with pred.plot=T
cencorreg(Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh$SedMeHg,pred.plot=TRUE)

# More than one variable for demostration purposes
cencorreg(Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh[,c("SedMeHg","PctWetland")])

</code></pre>

<hr>
<h2 id='cenperm2'>Censored two-group permutation test</h2><span id='topic+cenperm2'></span>

<h3>Description</h3>

<p>Performs a permutation test of differences in means between two groups of censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenperm2(y1, y2, grp, R = 9999, alternative = "two.sided", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenperm2_+3A_y1">y1</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="cenperm2_+3A_y2">y2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y1</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y1</code>.</p>
</td></tr>
<tr><td><code id="cenperm2_+3A_grp">grp</code></td>
<td>
<p>Grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cenperm2_+3A_r">R</code></td>
<td>
<p>The number of permutations used. Default is 9999</p>
</td></tr>
<tr><td><code id="cenperm2_+3A_alternative">alternative</code></td>
<td>
<p>indicates the alternative hypothesis and must be one of &quot;<code>two.sided</code>&quot;, &quot;<code>greater</code>&quot; or &quot;<code>less</code>&quot;. You may also specify just the initial letter. Default is &quot;<code>two.sided</code>&quot;.</p>
</td></tr>
<tr><td><code id="cenperm2_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because this is a permutation test it avoids the problem with MLE tests (<code>cen2means</code>) that assume a normal distribution.  No values are modeled as below zero and <code>p-values</code> are trustworthy. Ranges in means and p-values are due to interval-censoring of censored data means.
</p>


<h3>Value</h3>

<p>Permutation test results with the number of permutations, range in group means and their difference, and range in <code>p-value</code>.
</p>


<h3>References</h3>

<p>Good, P., 2000. Permutation Tests: A Practical Guide to Resampling Methods for Testing Hypotheses, 2nd ed, Springer Series in Statistics. Springer-Verlag, New York, NY. doi: <a href="https://doi.org/10.1007/978-1-4757-3235-1">10.1007/978-1-4757-3235-1</a>
</p>
<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Shapiro, S.S., Francia, R.S., 1972. An approximate analysis of variance test for normality. Journal of the American Statistical Association 67, 215–216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)
cenperm2(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup,alternative="t")
</code></pre>

<hr>
<h2 id='cenpermanova'>Censored data one-factor permutation test</h2><span id='topic+cenpermanova'></span>

<h3>Description</h3>

<p>Performs a permutation test of differences in means between groups of censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenpermanova(y1, y2, grp, R = 9999, printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenpermanova_+3A_y1">y1</code></td>
<td>
<p>The column of data values plus detection limits.</p>
</td></tr>
<tr><td><code id="cenpermanova_+3A_y2">y2</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y1</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y1</code>.</p>
</td></tr>
<tr><td><code id="cenpermanova_+3A_grp">grp</code></td>
<td>
<p>Grouping or factor variable. Can be either a text or numeric value indicating the group assignment.</p>
</td></tr>
<tr><td><code id="cenpermanova_+3A_r">R</code></td>
<td>
<p>The number of permutations used. Default is 9999.</p>
</td></tr>
<tr><td><code id="cenpermanova_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Because this is a permutation test it avoids the problem with MLE tests (see <code>cenanova</code>) that assume a normal distribution.  No values are modeled as below zero and group means and <code>p-values</code> are trustworthy.
</p>


<h3>Value</h3>

<p>Permutation test results with the number of permutations, range in test statistics and <code>p-value</code> values through the various permutations. Group means are also listed.
</p>


<h3>References</h3>

<p>Good, P., 2000. Permutation Tests: A Practical Guide to Resampling Methods for Testing Hypotheses, 2nd ed, Springer Series in Statistics. Springer-Verlag, New York, NY. doi: <a href="https://doi.org/10.1007/978-1-4757-3235-1">10.1007/978-1-4757-3235-1</a>
</p>
<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(PbHeron)
cenpermanova(PbHeron$Liver,PbHeron$LiverCen,PbHeron$DosageGroup)
</code></pre>

<hr>
<h2 id='cenPredInt'>Prediction interval for censored data</h2><span id='topic+cenPredInt'></span>

<h3>Description</h3>

<p>Computes prediction intervals for censored data assuming lognormal, gamma and normal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenPredInt(
  x.var,
  cens.var,
  pi.type = "two-sided",
  conf = 0.95,
  newobs = 1,
  method = "mle",
  printstat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenPredInt_+3A_x.var">x.var</code></td>
<td>
<p>The column of x (response variable) detected values plus detection limits</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_pi.type">pi.type</code></td>
<td>
<p>Designation of either a <code style="white-space: pre;">&#8288;“two-sided”&#8288;</code> interval (default) or a 1-sided <code style="white-space: pre;">&#8288;“upper”&#8288;</code> or 1-sided <code style="white-space: pre;">&#8288;“lower”&#8288;</code> interval.</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_conf">conf</code></td>
<td>
<p>Confidence coefficient of the interval, 0.95 (default).</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_newobs">newobs</code></td>
<td>
<p>The number of new observations to be contained in the interval.</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_method">method</code></td>
<td>
<p>Character string specifying the method of estimation. Default is <code>mle</code> (maximum likelihood). See details.</p>
</td></tr>
<tr><td><code id="cenPredInt_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes prediction intervals for three distributions.  This is a front-end to the individual functions from the EnvStats package.  By default all three are computed using maximum likelihood estimation (mle). The gamma distribution for censored data uses the Wilson-Hilferty approximation (normal distribution on cube roots of data). Other methods are available in EnvStats, but few methods are available for all three distributions. For info on other methods, see help for elnormCensored and enormCensored commands in EnvStats.
</p>


<h3>Value</h3>

<p>A table of prediction limits based on user provided confidence coefficient (<code>conf</code>) and prediction invterval type (<code>pi.type</code>)
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>
<p>Krishnamoorthy, K., Mathew, T., Mukherjee, S., 2008. Normal-Based Methods for a Gamma Distribution, Technometrics, 50, 69-78.
</p>


<h3>See Also</h3>

<p><a href="EnvStats.html#topic+enormCensored">EnvStats::enormCensored</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

# Default
cenPredInt(PbHeron$Liver,PbHeron$LiverCen)

# User defined confidence coefficient
cenPredInt(PbHeron$Liver,PbHeron$LiverCen, conf=0.5)

# User defined confidence coefficient outside of acceptable range
# the procedure will stop and give an error.
# cenPredInt(PbHeron$Liver,PbHeron$LiverCen, conf=1.1)

# User defined prediction interval type
cenPredInt(PbHeron$Liver,PbHeron$LiverCen,pi.type="lower")
cenPredInt(PbHeron$Liver,PbHeron$LiverCen,pi.type="upper")

</code></pre>

<hr>
<h2 id='cenQQ'>Q-Q Plot censored data</h2><span id='topic+cenQQ'></span>

<h3>Description</h3>

<p>Plots a quantile-quantile (Q-Q) plot of censored data versus a fitted data distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenQQ(x.var, cens.var, dist = "lnorm", Yname = yname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenQQ_+3A_x.var">x.var</code></td>
<td>
<p>The column of <code>x</code> (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="cenQQ_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cenQQ_+3A_dist">dist</code></td>
<td>
<p>One of three distributional shapes to fit to your data:  lognormal (<code>lnorm</code>), normal (<code>norm</code>) or gamma (<code>gamma</code>).</p>
</td></tr>
<tr><td><code id="cenQQ_+3A_yname">Yname</code></td>
<td>
<p>Optional – input text in quotes to be used as the variable name on the Q-Q plot.  The default is the <code>Yname</code> name of the <code>y.var</code> input variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Q-Q plot of data fitted by normal, lognormal or gamma distributions with Shapiro-Francia W value printed on plot.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Shapiro, S.S., Francia, R.S., 1972. An approximate analysis of variance test for normality. Journal of the American Statistical Association 67, 215–216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)
cenQQ(Brumbaugh$Hg,Brumbaugh$HgCen)

# User defined distribution
cenQQ(Brumbaugh$Hg,Brumbaugh$HgCen,dist="gamma")

</code></pre>

<hr>
<h2 id='cenregQQ'>Q-Q plot of censored regression residuals</h2><span id='topic+cenregQQ'></span>

<h3>Description</h3>

<p>Plots a quantile-quantile (Q-Q) plot of censored regression residuals for simple or multiple regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenregQQ(y.var, cen.var, x.vars, LOG = TRUE, intcens = FALSE, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenregQQ_+3A_y.var">y.var</code></td>
<td>
<p>The column of <code>y</code> (response variable) values plus detection limits. Alternatively, with interval-censord data, the column of the lower end of the interval.</p>
</td></tr>
<tr><td><code id="cenregQQ_+3A_cen.var">cen.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.  Alternatively, with interval-censored data the column of the high end of the interval.</p>
</td></tr>
<tr><td><code id="cenregQQ_+3A_x.vars">x.vars</code></td>
<td>
<p>One or more uncensored explanatory variable(s). See Details</p>
</td></tr>
<tr><td><code id="cenregQQ_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="cenregQQ_+3A_intcens">intcens</code></td>
<td>
<p>a logical value indicating the input data is interval-censored instead of a column of values plus a column of indicators.</p>
</td></tr>
<tr><td><code id="cenregQQ_+3A_main">main</code></td>
<td>
<p>overall title for the plot. A default titel will be used if none is specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Q-Q Plot of model residuals and Shapiro-Francia test results.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>
<p>Shapiro, S.S., Francia, R.S., 1972. An approximate analysis of variance test for normality. Journal of the American Statistical Association 67, 215–216.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)

# One variable
cenregQQ(Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh$PctWetland)

# More than one variable for demostration purposes
cenregQQ(Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh[,c("PctWetland","SedLOI","Weight")])
</code></pre>

<hr>
<h2 id='censeaken'>Seasonal Kendall permutation test on censored data</h2><span id='topic+censeaken'></span>

<h3>Description</h3>

<p>Seasonal Kendall permutation test on censored data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>censeaken(
  time,
  y,
  y.cen,
  group,
  LOG = FALSE,
  R = 4999,
  nmin = 4,
  seaplots = FALSE,
  printstat = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="censeaken_+3A_time">time</code></td>
<td>
<p>Column of the time variable, either a sequence of days or decimal times, etc.  Will be the scale used for time in the trend analysis.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_y">y</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="censeaken_+3A_y.cen">y.cen</code></td>
<td>
<p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_group">group</code></td>
<td>
<p>Column of the season classifications. A factor in R, so usually though not necessarily a text variable.  If numeric, define as a factor before running the script.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the trend analysis in the original y units, or on their logarithms.  The default is to use the logarithms (LOG = <code>TRUE</code>).  To compute in original units, specify the option LOG = <code>FALSE</code> (or LOG = 0).</p>
</td></tr>
<tr><td><code id="censeaken_+3A_r">R</code></td>
<td>
<p>The number of repetitions in the permutation process.  R is often between 999 and 9999 (adding +1 to represent the observed test statistic produces 1000 to 10000 repetitions). By default R=4999. Increasing R results in lower variation in the p-values produced between runs.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_nmin">nmin</code></td>
<td>
<p>The minimum number of observations needed for the entire time period to be tested, per season.  For example, with 1 sample per year per season over an 8-year period, you have 8 observations for each season.  You can increase this number if you want a higher minimum.  Don’t decrease it below the default of 4.  If there are fewer than nmin values that season is skipped and not included in the overall test and a note of this will be printed in the console.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_seaplots">seaplots</code></td>
<td>
<p>In addition to the plot of the overall Seasonal Kendall trend line, plots of the trend in individual seasons can also be drawn.</p>
</td></tr>
<tr><td><code id="censeaken_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="censeaken_+3A_...">...</code></td>
<td>
<p>other inputs associated with modifying plots produced by this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each season the ATS function is used to compute the season's Kendall-S statistic and p-value for the trend test.  The test is the usual ATS procedure, not a permutation test.  For the overall test there are R (default 4999) random rearrangements of data that are generated with no mixing of data from one season to another season within a permutation &ndash; data over time within a season are randomized.  This retains any between-seasons differences while removing any trend from year to year to use as the permuted &quot;representation of the null hypothesis&quot; of no trend in the R Seasonal Kendall tests. For a 2-sided trend test the p-value is the number of the absolute value of the permutation S statistics that are equal to or greater than the absolute value of the observed S from the original data, plus 1 (for the observed S of the original data), divided by the total (R+1) S values.
</p>
<p>The censeaken function differs from other R packages that do not incorporate censored data in their trend tests (EnvStats, Kendall, rkt and others) in that censeaken uses all of the data across the years without an option to equalize each year's or season's influence by using the overall mean or median of the period's data rather than the original observations. Seasons with more data will have more influence on the outcome, just as years with more data will have more influence. If the numbers of observations differ enough between seasons or years that this is of concern, it is up to the user to perhaps eliminate some data in data-rich periods that are most unlike the conditions or times of data collected in sparse periods.  Or to compute summary statistics such as the median of each season/year combination and run the test on the medians, though this will result in a loss of power to detect trends and will require the user to use methods such as those in NADA2 to compute medians when there are censored data.
</p>
<p>If <code>seaplots=TRUE</code> each season's trend line will be plotted seperately. A plot of the overall Seasonal Kendall (Akritas-Theil-Sen) line is always plotted.
If <code>seaplots=FALSE</code> only the overall Seasonal Kendall (Akritas-Theil-Sen) line will be plotted on a data scatterplot.
</p>


<h3>Value</h3>

<p>Prints the Kendall trend test results for each season individually. The overall Seasonal Kendall test and Theil-Sen line results are both printed and returned.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Hirsch, R.M., Slack, J.R., Smith, R.A., 1982. Techniques of Trend Analysis for Monthly Water Quality Data, Water Res. Reseach 18, 107-121.
</p>


<h3>See Also</h3>

<p><a href="NADA.html#topic+cenken">NADA::cenken</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

# Artificial time and season variables for demonstration purposes
Brumbaugh$time=1:nrow(Brumbaugh)
Brumbaugh$sea=as.factor(round(runif(nrow(Brumbaugh),1,4),0))

with(Brumbaugh,censeaken(time,Hg,HgCen,sea,seaplots = TRUE))

</code></pre>

<hr>
<h2 id='cenTolInt'>Upper Tolerance interval for censored data</h2><span id='topic+cenTolInt'></span>

<h3>Description</h3>

<p>Computes a one-sided upper tolerance interval for censored data assuming log-normal, gamma and normal distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cenTolInt(
  x.var,
  cens.var,
  conf = 0.95,
  cover = 0.9,
  method.fit = "mle",
  printstat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cenTolInt_+3A_x.var">x.var</code></td>
<td>
<p>The column of x (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="cenTolInt_+3A_cens.var">cens.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="cenTolInt_+3A_conf">conf</code></td>
<td>
<p>Confidence coefficient of the interval, 0.95 (default).</p>
</td></tr>
<tr><td><code id="cenTolInt_+3A_cover">cover</code></td>
<td>
<p>Coverage, the percentile probability above which the tolerance interval is computed.  The default is 90, so a tolerance interval will be computed above the 90th percentile of the data.</p>
</td></tr>
<tr><td><code id="cenTolInt_+3A_method.fit">method.fit</code></td>
<td>
<p>The method used to compute the parameters of the distribution.  The default is maximum likelihood (<code style="white-space: pre;">&#8288;“mle”&#8288;</code>). The alternative is robust ROS (<code style="white-space: pre;">&#8288;“rROS”&#8288;</code>).  See Details.</p>
</td></tr>
<tr><td><code id="cenTolInt_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes upper one-sided tolerance intervals for three distributions.  This is a front-end to the individual functions from the EnvStats package.  By default all three are computed using maximum likelihood estimation (mle); robust ROS is available as an alternate method for all three distributions. The gamma distribution for censored data uses the Wilson-Hilferty approximation (normal distribution on cube roots of data). For more info on the relative merits of robust ROS versus mle, see Helsel (2011) and Millard (2013).
</p>


<h3>Value</h3>

<p>Prints and returns the percentile (<code>cover</code>), upper tolerance limit (<code>conf</code>) and BIC of fit for lognormal, normal and approximated gamma distributions. Plots empirical and theoretical CDFs with BIC values in the legend.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Millard, S.P., 2013. EnvStats: An R Package for Environmental Statistics. Springer-Verlag, New York.
</p>
<p>Krishnamoorthy, K., Mathew, T., Mukherjee, S., 2008. Normal-Based Methods for a Gamma Distribution, Technometrics, 50, 69-78.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(PbHeron)

# Default
cenTolInt(PbHeron$Liver,PbHeron$LiverCen)

# User defined conficence interval
cenTolInt(PbHeron$Liver,PbHeron$LiverCen,conf=0.75)

# User defined percentile
cenTolInt(PbHeron$Liver,PbHeron$LiverCen,cover=0.5)

# inputs outside acceptable ranges
# Will result in errors/warnings
# cenTolInt(PbHeron$Liver,PbHeron$LiverCen,cover=1.25)
# cenTolInt(PbHeron$Liver,PbHeron$LiverCen,conf=1.1)
# cenTolInt(PbHeron$Liver,PbHeron$LiverCen,method.fit="ROS")

</code></pre>

<hr>
<h2 id='centrend'>Trend analysis of censored data with a covariate</h2><span id='topic+centrend'></span>

<h3>Description</h3>

<p>Computes the ATS (Mann-Kendall trend test for censored data) after adjustment of censored data for a covariate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centrend(
  y.var,
  y.cens,
  x.var,
  time.var,
  link = "identity",
  Smooth = "cs",
  printstat = TRUE,
  stackplots = FALSE,
  drawplot = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centrend_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="centrend_+3A_y.cens">y.cens</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detectionlimit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="centrend_+3A_x.var">x.var</code></td>
<td>
<p>Column of a covariate (not time).  <code>y.var</code> will be smoothed versus <code>x.var</code> and residuals taken to subtract out the relationship between <code>y</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="centrend_+3A_time.var">time.var</code></td>
<td>
<p>Column of the time variable, either a sequence of days or decimal times, etc.  Will be the scale used for time in ATS trend analysis.</p>
</td></tr>
<tr><td><code id="centrend_+3A_link">link</code></td>
<td>
<p>Default = <code style="white-space: pre;">&#8288;“identity”&#8288;</code> which means it uses data in the original units. See details.</p>
</td></tr>
<tr><td><code id="centrend_+3A_smooth">Smooth</code></td>
<td>
<p>Type of smoother used in the GAM. Default is <code style="white-space: pre;">&#8288;“cs”&#8288;</code>, shrinkage cubic regression splines. See details for other options.</p>
</td></tr>
<tr><td><code id="centrend_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="centrend_+3A_stackplots">stackplots</code></td>
<td>
<p>logical <code>TRUE</code>/<code>FALSE</code> option to stack three plots that are output onto the same page instead of each on separate page.  Default is 'FALSE', each separate.</p>
</td></tr>
<tr><td><code id="centrend_+3A_drawplot">drawplot</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to draw plots or not. Default is <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default <code>link</code> = identity. The y variables are then used in their original units. Other options are available see <code>cenGAM::tobit1</code> for more options.
</p>
<p>Default <code>Smooth</code> is <code>"cs"</code> for shrinkage cubic regression splines. See <code>mgcv::smooth.terms</code> for other types of smoothing algorithms.  '&quot;ts&quot;' is a thin-plate regression spline and is also commonly used.
</p>


<h3>Value</h3>

<p>Prints three plots: Y data vs time with GAM Smooth, Residuals from GAM Smooth vs time, and ATS trend line of residuals vs time.
</p>
<p>Returns GAM residuals and ATS results on trend test of residuals (intercept, slope, Kendall's tau, p-value for trend)
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="mgcv.html#topic+gam">mgcv::gam</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

Brumbaugh$time=1:nrow(Brumbaugh)

with(Brumbaugh,centrend(Hg,HgCen,SedTotHg,time.var=time,drawplot=TRUE))
</code></pre>

<hr>
<h2 id='centrendsea'>Trend analysis of censored data with a covariate and seasonal blocks</h2><span id='topic+centrendsea'></span>

<h3>Description</h3>

<p>Computes the Seasonal Kendall trend test for censored data after adjustment of censored data for a covariate. The adjustment is by subtracting off a censored GAM smooth, removing the effect of the covariate.  Trend analysis is performed on the residuals from the GAM smooth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centrendsea(
  y.var,
  y.cens,
  x.var,
  time.var,
  season,
  R = 4999,
  nmin = 4,
  link = "identity",
  Smooth = "cs",
  printstat = TRUE,
  seaplots = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centrendsea_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_y.cens">y.cens</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detectionlimit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_x.var">x.var</code></td>
<td>
<p>Column of a covariate (not time).  <code>y.var</code> will be smoothed versus <code>x.var</code> and residuals taken to subtract out the relationship between <code>y</code> and <code>x</code>.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_time.var">time.var</code></td>
<td>
<p>Column of the numerical time variable, either a sequence of numbered days or decimal times, etc.  Will be the scale used for time in ATS trend analysis.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_season">season</code></td>
<td>
<p>Column of the seasonal variable.  Usually a text variable but may be numeric.  Will be converted to a factor..</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_r">R</code></td>
<td>
<p>The number of repetitions in the permutation process.  R is often between 999 and 9999 (adding +1 to represent the observed test statistic produces 1000 to 10000 repetitions). By default R=4999. Increasing R results in lower variation in the p-values produced between runs.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_nmin">nmin</code></td>
<td>
<p>The minimum number of observations needed for the entire time period to be tested, per season.  For example, with 1 sample per year per season over an 8-year period, you have 8 observations for each season.  You can increase this number if you want a higher minimum.  Don’t decrease it below the default of 4.  If there are fewer than nmin values that season is skipped and not included in the overall test and a note of this will be printed in the console.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_link">link</code></td>
<td>
<p>Default = <code>"identity"</code> which means it uses data in the original units. See details.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_smooth">Smooth</code></td>
<td>
<p>Type of smoother used in the GAM. Default is <code>"cs"</code>, shrinkage cubic regression splines. See details for other options.</p>
</td></tr>
<tr><td><code id="centrendsea_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="centrendsea_+3A_seaplots">seaplots</code></td>
<td>
<p>logical 'TRUE'/'FALSE' option to print plots with trend line for each season.  Default is 'TRUE'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Default <code>link</code> = identity. The y variables are then used in their original units. Other options are available see <code>cenGAM::tobit1</code> for more options.
</p>
<p>Default <code>Smooth</code> is <code>"cs"</code> for shrinkage cubic regression splines. See <code>mgcv::smooth.terms</code> for other types of smoothing algorithms.  '&quot;ts&quot;' is a thin-plate regression spline and is also commonly used.
</p>
<p>As with the censeaken function, observations are not edited when there are more data in some seasons than others. Seasons with more data will have more influence on the overall SK test than seasons with fewer data. To avoid this (as done with some Seasonal Kendall software) data in the seasons with more can be selectively deleted to better match the data frequency of the seasons with fewer data.
</p>


<h3>Value</h3>

<p>Prints four plots: 1. Y data vs X covariate with GAM Smooth, 2. Residuals from GAM Smooth vs X covariate, 3. histogram of the SK test results illlustrating the p-value, and 4. Seasonal Kendall trend line of residuals vs time.  Plots of data and SK trend line for each season are produced when the seaplots option is TRUE.
</p>
<p>Returns the seasonal Kendall trend test results on residuals (intercept, slope, Kendall's tau, p-value for trend)
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="mgcv.html#topic+gam">mgcv::gam</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Gales_Creek)
with(Gales_Creek,centrendsea(TCr,CrND,discharge,dectime,Season))
</code></pre>

<hr>
<h2 id='cfit'>Compute an ECDF and Distribution Parameters for Censored Data</h2><span id='topic+cfit'></span>

<h3>Description</h3>

<p>Computes the empirical cumulative distribution function (ECDF) for censored data. Estimates parameters of the distribution, including the mean and quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cfit(
  y,
  cens,
  conf = 0.95,
  qtls = c(0.1, 0.25, 0.5, 0.75, 0.9),
  q.type = 6,
  Cdf = TRUE,
  ecdf.col = 1,
  km.orig = TRUE,
  printstat = TRUE,
  Ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cfit_+3A_y">y</code></td>
<td>
<p>Concentrations plus detection limits for indicator formatted data.</p>
</td></tr>
<tr><td><code id="cfit_+3A_cens">cens</code></td>
<td>
<p>Censoring indicators (logical. 1 or <code>TRUE</code> = censored, 0 or FALSE = detected) for indicator formatted data.</p>
</td></tr>
<tr><td><code id="cfit_+3A_conf">conf</code></td>
<td>
<p>The confidence coefficient for confidence intervals around the Kaplan-Meier mean and median. Default = 0.95.</p>
</td></tr>
<tr><td><code id="cfit_+3A_qtls">qtls</code></td>
<td>
<p>Probabilities for the quantiles to be estimated.  Defaults are (0.10, 0.25, 0.50, 0.75, 0.90).  You may add and/or substitute probabilities &ndash; all must be between and not including 0 to 1.</p>
</td></tr>
<tr><td><code id="cfit_+3A_q.type">q.type</code></td>
<td>
<p>an integer between 1 and 9 selecting one of the nine quantile algorithms used only when km.orig = FALSE. See <code>stats::quantile</code> and Details below for more detail, default when km.orig = FLASE is set to 6.</p>
</td></tr>
<tr><td><code id="cfit_+3A_cdf">Cdf</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> indicator of whether to plot the empirical cumulative distribution function (cdf).</p>
</td></tr>
<tr><td><code id="cfit_+3A_ecdf.col">ecdf.col</code></td>
<td>
<p>Color for the ecdf plotted step function line.  Default is black.</p>
</td></tr>
<tr><td><code id="cfit_+3A_km.orig">km.orig</code></td>
<td>
<p>If <code>TRUE</code> (default), Kaplan-Meier results in the realm below detection limits reported as &quot;NA&quot;.  If <code>FALSE</code>, information in the detection limits is used and results in the realm of detection limits reported as &quot;&lt; DL&quot;, where DL is the appropriate detection limit.</p>
</td></tr>
<tr><td><code id="cfit_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
<tr><td><code id="cfit_+3A_ylab">Ylab</code></td>
<td>
<p>Optional input text in quotes to be used as the variable name on the ecdf plot.  The default is the name of the <code>y1</code> input variable.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Moment statistics are estimated using the enparCensored function of the EnvStats package. This avoids a small bias in the mean produced by the NADA package's cenfit function, which uses the reverse Kaplan-Meier procedure, converting left-censored to right-censored data prior to computing the ecdf and mean. See Gillespie et al.(2010) for more discussion on the bias of the estimate of the mean.
</p>
<p>Quantiles and their two-sided confidence limits are estimated using the quantile function of the survfit command. See ?quantiles or Helsel et al. (2020) for choosing the q.type; default q.type = 4 (Kaplan-Meier; prob = i/n) when km.orig = TRUE. This is standard procedure in the survival analysis discipline and in the survival package of R, and is also used by the cenfit function in the NADA package. While this is 'industry standard' in medical applications it is a poor choice for observed sample (rather than census) data because it means that the largest observation is assigned a probability equal to 1, the 100th percentile. This implies that this value is never expected to be exceeded when more sample data are collected. It also means the largest observation is not plotted on the ecdf in most software because it is &quot;off the chart&quot;. For small datasets in particular it is unlikely that the current largest observation is the largest value in the population and so the resulting ecdf quantiles are likely not opotimal. The default q.type = 6 (Weibull; prob = i/(n+1)) when km.orig = FALSE, though that may be changed by the user. the largest observation plots at a probability less than 1 on the ecdf.  Differences in results when differing q.types are used will decrease as sample size increases.
</p>
<p>All printed values will also be output to an object if saved. Confidence intervals on the quantiles are also output when data include nondetects. Values are character because of the possibility of a <code style="white-space: pre;">&#8288;&lt;1&#8288;</code>, but if no <code>&lt;</code> symbol can be converted to numeric using the <code>as.numeric(...)</code> command.  For data without censoring cfit will return numeric values. In that case it returns standard arithmetic mean, standard deviation and quantiles instead of K-M versions.
</p>


<h3>Value</h3>

<p>If <code>printstat=TRUE</code>: Based on the provided <code>conf</code> value, Kaplan-Meier summary statistics (<code>mean</code>,<code>sd</code>,<code>median</code>), lower and upper confidence intervals around the mean and median value, sample size and percent of censored samples are returned. The specified quantile values are also printed and returned.
</p>
<p>If <code>Cdf=TRUE</code>: The ecdf of censored data is plotted.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Gillespie, B.W., et al., 2010.  Estimating Population Distributions When Some Data Are Below a Limit of Detection by Using a Reverse Kaplan-Meier Estimator. Epidemiology 21, 564-570.
</p>
<p>Helsel, D.R., Hirsch, R.M., Ryberg, K.R., Archfield, S.A., and Gilroy, E.J., 2020, Statistical Methods in Water Resources: U.S. Geological Survey Techniques and Methods, book 4, chapter A3, 458 p., https://doi.org/10.3133/tm4a3.
</p>
<p>Millard, S.P, 2013. EnvStats: An R Package for Environmental Statistics, 2nd ed. Springer Science+Business Media, USA, N.Y.  DOI 10.1007/978-1-4614-8456-1© Springer Science+Business Media New York 2013”
</p>
<p>Excerpt From: Steven P. Millard. “EnvStats.” Apple Books.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survfit">survival::survfit</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

cfit(Brumbaugh$Hg,Brumbaugh$HgCen)

</code></pre>

<hr>
<h2 id='computeS'>Kendall's S-statistic for permutations of censored data</h2><span id='topic+computeS'></span>

<h3>Description</h3>

<p>Computes a Kendall rank correlation S-statistic for permutations of censored data. Collectively these represent the variation in S expected when the null hypothesis is true.  Called by censeaken. computeS is not expected to be of much use to users on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeS(x, y, ycen, seas = NULL, R = R)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="computeS_+3A_x">x</code></td>
<td>
<p>Column of the time variable, either a sequence of days or decimal times, etc.  Time data for one season.</p>
</td></tr>
<tr><td><code id="computeS_+3A_y">y</code></td>
<td>
<p>The column of y (response variable) values plus detection limits for one season.</p>
</td></tr>
<tr><td><code id="computeS_+3A_ycen">ycen</code></td>
<td>
<p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y</code>.</p>
</td></tr>
<tr><td><code id="computeS_+3A_seas">seas</code></td>
<td>
<p>Name of a single season classification. Usually though not necessarily a text variable.</p>
</td></tr>
<tr><td><code id="computeS_+3A_r">R</code></td>
<td>
<p>The number of repetitions in the permutation process.  R is often between 999 and 9999 (+ the 1 observed test statistic produces 1000 to 10000 realizations).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An Rx1 matrix containing an S-value for each of the R data permutations.
</p>


<h3>References</h3>

<p>Helsel, D.R., Hirsch, R.M., Ryberg, K.R., Archfield, S.A., Gilroy, E.J., 2020. Statistical Methods in Water Resources. U.S. Geological Survey Techniques and Methods, book 4, chapter A3, 458p., https://doi.org/10.3133/tm4a3.
</p>


<h3>See Also</h3>

<p><a href="Kendall.html#topic+Kendall">Kendall::Kendall</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)

#Artifical time and season variables for demonstration purposes
Brumbaugh$time=1:nrow(Brumbaugh)
Brumbaugh$sea=as.factor(round(runif(nrow(Brumbaugh),1,4),0))


with(Brumbaugh,computeS(time,Hg,HgCen,sea,R=100))

</code></pre>

<hr>
<h2 id='equivalent_n'>Censored data sample size</h2><span id='topic+equivalent_n'></span>

<h3>Description</h3>

<p>Computes the equivalent sample size of censored data.  Observations at lower detection limits have a greater percent of the equivalent information of a detected value than observations at higher detection limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>equivalent_n(y.var, y.cen, printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="equivalent_n_+3A_y.var">y.var</code></td>
<td>
<p>The column of data values plus detection limits.</p>
</td></tr>
<tr><td><code id="equivalent_n_+3A_y.cen">y.cen</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="equivalent_n_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on &quot;Method 2&quot; of Dr. Brenda Gillespie's talk at ASA National Meeting 2019.  This method differs from hers in how the percentile probabilities for the detection limits are computed.  Probabilities here are computed using Regression on Order Statistics (ROS).
</p>
<p>Computes the equivalent n, the number of observations including censored values, as a measure of information content for data with nondetects.
</p>


<h3>Value</h3>

<p>Prints summary statistics including
</p>

<ul>
<li> <p><code>n</code> sample size
</p>
</li>
<li> <p><code>n.cen</code> number of censored data
</p>
</li>
<li> <p><code>pct.cen</code> percent of data censored
</p>
</li>
<li> <p><code>min</code> minimum reported value
</p>
</li>
<li> <p><code>max</code> maximum reported value
</p>
</li></ul>

<p>Summary of censored data including
</p>

<ul>
<li> <p><code>limit</code> detection limit
</p>
</li>
<li> <p><code>n</code> number of censored values per limit
</p>
</li>
<li> <p><code>uncen</code> number of detected values at or above the limit
</p>
</li>
<li> <p><code>pexceed</code> proportion of data that exceeds the limit
</p>
</li></ul>

<p>Summary of the equivalent sample size for detected and censored values.
</p>

<ul>
<li> <p><code>n.equiv</code> the equivalent number of observations
</p>
</li>
<li> <p><code>n.cen.equiv</code> equivalent number of detected obs in the censored data
</p>
</li>
<li> <p><code>n.detected</code> number of uncensored values
</p>
</li></ul>



<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Gillespie, B.W., Dominguez, A., Li, Y., 2019. Quantifying the information in values below the detection limit (left-censored data).  Presented at the 2019 Joint Statistical Meetings of the Amer. Stat. Assoc., Denver, CO., July 31, 2019.
</p>


<h3>See Also</h3>

<p><a href="NADA.html#topic+censummary">NADA::censummary</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)

equivalent_n(Brumbaugh$Hg,Brumbaugh$HgCen)
</code></pre>

<hr>
<h2 id='Example1'>Example1</h2><span id='topic+Example1'></span>

<h3>Description</h3>

<p>Arsenic concentrations (possibly artificial) in groundwater.
</p>
<p>Objective &ndash; To test whether the mean concentration can be show to have exceeded the
10 microgram per liter health standard.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Example1)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 21 rows and 3 columns.
</p>


<h3>Source</h3>

<p>unknown
</p>


<h3>References</h3>

<p>unknown
</p>

<hr>
<h2 id='Example2'>Example2</h2><span id='topic+Example2'></span>

<h3>Description</h3>

<p>Methyl Isobutyl Ketone (MIBK) was measured in air above a medium-sized US city. Data were
reported only as &quot;ND&quot; or as a detected concentration (no information on reporting limits).
</p>
<p>Objective &ndash; To compute an upper confidence limit on the mean without having the value(s)
of the reporting limit(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Example2)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 31 rows and 5 columns.
</p>


<h3>Source</h3>

<p>unknown
</p>


<h3>References</h3>

<p>unknown
</p>

<hr>
<h2 id='Example3'>Example3</h2><span id='topic+Example3'></span>

<h3>Description</h3>

<p>Arsenic concentrations in ground water from a private supply well.  All 14 observations
are below one of several reporting limits (1005 non-detects).
</p>
<p>Objective &ndash; To show what type of comparison to a health standard can be made using a
dataset without detected observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Example3)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 14 rows and 4 columns.
</p>


<h3>Source</h3>

<p>unknown
</p>


<h3>References</h3>

<p>unknown
</p>

<hr>
<h2 id='Gales_Creek'>Gales_Creek</h2><span id='topic+Gales_Creek'></span>

<h3>Description</h3>

<p>Total recoverable chromium concentrations in streamflows of Gales Creek in Oregon, USA.
</p>
<p>Objective is to relate chromium concentrations including censored values to mean daily flows over time and by season (wet versus dry seasons).  Two detection limits decreasing over time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Gales_Creek)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 63 rows and 11 columns.
</p>


<h3>Source</h3>

<p>US Geological Survey.  https://waterdata.usgs.gov/monitoring-location/453026123063401/
</p>


<h3>References</h3>

<p>Publicly available data.
</p>

<hr>
<h2 id='kenplot'>Plot robust median ATS line for censored data</h2><span id='topic+kenplot'></span>

<h3>Description</h3>

<p>Function used by other functions to plot the Akritas-Theil-Sen (ATS) line for censored data.  Only one x variable allowed. Both Y and X variables may be censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kenplot(
  y1,
  ycen,
  x1,
  xcen,
  atsline = FALSE,
  xnam = NULL,
  ynam = NULL,
  Title = "Akritas - Theil - Sen line",
  ylim = NULL,
  xlim = NULL,
  pch = NULL,
  cex = NULL,
  xaxs = "r",
  yaxs = "r",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kenplot_+3A_y1">y1</code></td>
<td>
<p>The column of y (response variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="kenplot_+3A_ycen">ycen</code></td>
<td>
<p>The y-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and <code>0</code> (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_x1">x1</code></td>
<td>
<p>The column of x (explanatory variable) values plus detection limits</p>
</td></tr>
<tr><td><code id="kenplot_+3A_xcen">xcen</code></td>
<td>
<p>The x-variable indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>x.var</code> column, and <code>0</code> (or <code>FALSE</code>) indicates a detected value in <code>x.var</code>.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_atsline">atsline</code></td>
<td>
<p>Indicator of whether to draw the ATS line or not. Default is FALSE.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_xnam">xnam</code></td>
<td>
<p>Custom label for the x axis of plots.  Default is x variable column name.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_ynam">ynam</code></td>
<td>
<p>Custom label for the y axis of plots.  Default is y variable column name.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_title">Title</code></td>
<td>
<p>Custom title for plots.  Default is &quot;Akritas - Theil - Sen line&quot;.</p>
</td></tr>
<tr><td><code id="kenplot_+3A_ylim">ylim</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust y-axis limits; see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_xlim">xlim</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust x-axis limits; see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_pch">pch</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust point type, see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_cex">cex</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust point size; see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_xaxs">xaxs</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust x-axis type; see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_yaxs">yaxs</code></td>
<td>
<p>argument consistent with <code>base</code> plotting to adjust y-axis type; see <code>par</code> for more details</p>
</td></tr>
<tr><td><code id="kenplot_+3A_...">...</code></td>
<td>
<p>argument to adjust other base plotting functions; see <code>par</code> for more details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scatterplot of data plus ATS line.  Censored values are drawn for both X and Y variables as dashed lines up to the detection limits.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>See Also</h3>

<p><a href="NADA.html#topic+cenken">NADA::cenken</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Both y and x are censored
data(PbHeron)
with(PbHeron, kenplot(Blood, BloodCen, Kidney, KidneyCen))

# x is not censored
data(Brumbaugh)
with(Brumbaugh, kenplot(Hg, HgCen, PctWetland,rep(0, times=length(PctWetland))))

</code></pre>

<hr>
<h2 id='markers'>Markers</h2><span id='topic+markers'></span><span id='topic+Markers'></span>

<h3>Description</h3>

<p>Three MST markers of human-origin contamination, and three of animal contamination, were
evaluated along with a general fecal indicator to determine if the pattern of their
levels differed among five coastal sites off the coast of Florida. Data are interval-censored.
</p>
<p>Objective &ndash; Test whether the pattern of six microbial source tracking (MST) markers
is related to the Entero1A indicator of general fecal pollution.  Also determine if the
pattern of markers plus Entero1A indicator differs among five coastal water sites using ANOSIM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Markers)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 30 rows and 15 columns.
</p>


<h3>Source</h3>

<p>Symonds et al. (2016) Journ Applied Microbio  121, p. 1469-1481.
</p>


<h3>References</h3>

<p>Symonds et al. (2016) Journ Applied Microbio  121, p. 1469-1481.
</p>

<hr>
<h2 id='ordranks'>Computes ranks of data with one or multiple detection limits</h2><span id='topic+ordranks'></span>

<h3>Description</h3>

<p>Computes the within-column ranks of data having one or more detection limits. If multiple limits are present in a column, data are first re-censored at the highest detection limit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordranks(dat.frame, paired = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordranks_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame. Default format is paired = <code>TRUE</code>, where for 3 chemical parameters the input format is C1 I1 C2 I2 C3 I3, a concentration column followed by its censoring indicator column.</p>
</td></tr>
<tr><td><code id="ordranks_+3A_paired">paired</code></td>
<td>
<p>An option to specify paired = <code>FALSE</code>, where the input format would be C1 C2 C3 I1 I2 I3 where the C columns contain concentrations or a detection limit, and the I columns are their associated indicators, in the same order as the concentration columns.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns columns of ranks of censored data in the same order as the paired columns of input data.  For 3 chemical parameters, the data frame returned will be R1 R2 R3 where R represents the ranks of the C1 C2 C3 input data accounting for the censoring indicated by columns I1 I2 I3.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(NADA) #For example data
data(PbHeron)

ordranks(PbHeron[,4:15])

</code></pre>

<hr>
<h2 id='partplots'>Partial plots for censored MLE regression</h2><span id='topic+partplots'></span>

<h3>Description</h3>

<p>Draws a partial plot for each X variable in regression of a censored Y variable against multiple X variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partplots(
  y.var,
  cen.var,
  x.vars,
  LOG = TRUE,
  smooth.method = "gam",
  gam.method = "tp",
  multiplot = TRUE,
  printstat = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partplots_+3A_y.var">y.var</code></td>
<td>
<p>The column of y (response variable) values plus detection limits.</p>
</td></tr>
<tr><td><code id="partplots_+3A_cen.var">cen.var</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y.var</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y.var</code>.</p>
</td></tr>
<tr><td><code id="partplots_+3A_x.vars">x.vars</code></td>
<td>
<p>Multiple uncensored explanatory variable(s). See Details</p>
</td></tr>
<tr><td><code id="partplots_+3A_log">LOG</code></td>
<td>
<p>Indicator of whether to compute the censored regression in the original y units, or on their logarithms.  The default is to use the logarithms (<code>LOG = TRUE</code>).  To compute in original Y units, specify the option <code>LOG = FALSE</code> (or <code>LOG = 0</code>).</p>
</td></tr>
<tr><td><code id="partplots_+3A_smooth.method">smooth.method</code></td>
<td>
<p>Method for drawing a smooth on the partial plot.  Options are c(&quot;gam&quot;, &quot;none&quot;). &quot;gam&quot; is a censored generalized additive model using the cenGAM and mgcv packages.</p>
</td></tr>
<tr><td><code id="partplots_+3A_gam.method">gam.method</code></td>
<td>
<p>Method for computing the gam smooth.  See the mgcv package for options.  Default is a thinplate (&quot;tp&quot;) spline.  &quot;cs&quot; is another good option.</p>
</td></tr>
<tr><td><code id="partplots_+3A_multiplot">multiplot</code></td>
<td>
<p>If TRUE, plots are drawn 6 per page.  If FALSE, all plots are drawn on a separate page.</p>
</td></tr>
<tr><td><code id="partplots_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Partial plots for uncensored data often are drawn with superimposed smooths. At times looking only at the data values without a smooth can better enable the human eye to determine whether the overall pattern is linear or not.  If this is the best method for you, use the smooth.method = &quot;none&quot; option to not draw a smooth.  The most common smooth used for uncensored data is loess, which does not recognize censored data and so uses the detection limit (DL) value itself.  This results in biased-high smooths that incorrectly treat values at the DLs equal to uncensored (detected) data. The partplots function in NADA2 was written to provide a better alternative, smoothing the partial residual pattern with a censored generalized additive model (gam).  The censored gam recognizes the nondetects as left-censored data with a maximum at the DL when computing the smooth. DLs may vary with each observation &ndash; multiple DLs in a dataset are not a problem in routines of the NADA2 package.
</p>
<p>'y.var': The default is that the Y variable will be log transformed.
</p>
<p><code>x.vars</code>: Enter the name of a data frame of columns of the x variables. No extra columns unused in the regression allowed. Create this by <code>x.frame &lt;- data.frame (Temp, Flow, Time)</code> for 3 variables (temperature, flow and time).
</p>
<p>Gray open circles represent censored data and are the residual between the detection limit and the predicted value from the censored regression.  The GAM recognizes that the detection limit is an upper limit, predicted values on the regression line are most often below the detection limit, leading to positive residuals.  Note that the true residual for censored data could be anywhere below the plotted value.  That fact is recognized by the censored GAM but is difficult to represent on a plot.
</p>
<p>AIC for regression models with un-transformed X, log and cube-root transforms of X are printed to evaluate which of the three transformations results in the ‘best’ model.
</p>


<h3>Value</h3>

<p>When <code>x.vars</code> is one variable, a message is printed that partial plots are not possible with only one X variable and execution stops.
When <code>x.vars</code> is a data frame of more than one variable, partial plots are drawn for each X variable and text is printed comparing AICs for regression using the untransformed X variable with log and cube-root transforms of the X variable, as a supplement to evaluating linearity on the partial plots alone.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Cook, R.D., 1993. Exploring Partial Residual Plots, Technometrics 35, 351-362.
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survreg">survival::survreg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

# For demostration purposes
partplots (Brumbaugh$Hg,Brumbaugh$HgCen,Brumbaugh[,c("SedMeHg","PctWetland")])
</code></pre>

<hr>
<h2 id='PbHeron'>PbHeron</h2><span id='topic+PbHeron'></span>

<h3>Description</h3>

<p>From the <code>NADA</code> R-Package.
</p>
<p>Lead concentrations in the blood and several organs of herons in Virginia.
</p>
<p>Objective is to determine the relationships between lead concentrations in the blood and various organs. Do concentrations reflect environmental lead concentrations, as represented by dosing groups? There is one detection limit, at 0.02 ug/g. Used in Chapters 10 and 11 of the Helsel (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PbHeron)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 27 rows and 15 columns.
</p>


<h3>Source</h3>

<p>Golden et al., 2003, Environmental Toxicology and Chemistry 22, pp. 1517-1524.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>

<hr>
<h2 id='Pollen_Thia'>Thiamethoxam concentrations in pollen</h2><span id='topic+Pollen_Thia'></span>

<h3>Description</h3>

<p>Thiamethoxam concentrations in pollen from the Ontario Pollen Monitoring Network study https://data.ontario.ca/en/dataset/pollen-monitoring-network-study
</p>
<p>Variables are:
</p>

<dl>
<dt>Thiamethoxam: </dt><dd><p>Thiamethoxam concentration in Concentrations in microgram per gram.</p>
</dd>
<dt>ThiaCens: </dt><dd><p>Censoring indicator.  1 denotes that the value in column 1 is a reporting limit not a specific concentration.</p>
</dd>
<dt>SamplingEvent: </dt><dd><p>A grouping variable from the sample design.  A concentration is from 1 of 4 events in time.</p>
</dd>
<dt>ThiaAbvBelow: </dt><dd><p>A binary variable denoting whether the Thiamethoxam concentration is above or below 0.05 ug/g.</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>data(Pollen_Thia)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 204 rows and 4 columns.
</p>


<h3>Source</h3>

<p>Ontario Ministry of Agriculture, Food and Rural Affairs (Pollen Monitoring Network)
</p>

<hr>
<h2 id='ppw.test'>Test for difference in left-censored samples</h2><span id='topic+ppw.test'></span>

<h3>Description</h3>

<p>Performs a nonparametric Paired Prentice-Wilcoxon test of whether the median difference between two columns of paired censored data equals 0 (O'Brien and Fleming, 1987)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppw.test(xd, xc, yd, yc, alternative = "two.sided", printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ppw.test_+3A_xd">xd</code></td>
<td>
<p>The first column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="ppw.test_+3A_xc">xc</code></td>
<td>
<p>The column of censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the xd column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>xd</code>.</p>
</td></tr>
<tr><td><code id="ppw.test_+3A_yd">yd</code></td>
<td>
<p>The second column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="ppw.test_+3A_yc">yc</code></td>
<td>
<p>The column of censoring indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the yd column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>yd</code></p>
</td></tr>
<tr><td><code id="ppw.test_+3A_alternative">alternative</code></td>
<td>
<p>The usual notation for the alternate hypothesis.  Default is <code style="white-space: pre;">&#8288;“two.sided”&#8288;</code>.  Options are <code style="white-space: pre;">&#8288;“greater”&#8288;</code> or <code style="white-space: pre;">&#8288;“less”&#8288;</code>.</p>
</td></tr>
<tr><td><code id="ppw.test_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Paired Prentice-Wilcoxon test results including Z-statistic, n (sample size), p-value and median difference
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>O’Brien, P.C., Fleming, T.R., 1987. A Paired Prentice-Wilcoxon Test for Censored Paired Data. Biometrics 43, 169–180. https://doi.org/10.2307/2531957
</p>


<h3>See Also</h3>

<p><a href="survival.html#topic+survfit">survival::survfit</a> <a href="survival.html#topic+Surv">survival::Surv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)
ppw.test(PbHeron$Liver,PbHeron$LiverCen,PbHeron$Bone,PbHeron$BoneCen)

</code></pre>

<hr>
<h2 id='quantile_CI'>quantile confidence interval</h2><span id='topic+quantile_CI'></span>

<h3>Description</h3>

<p>quantile confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantile_CI(n, q, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantile_CI_+3A_n">n</code></td>
<td>
<p>length</p>
</td></tr>
<tr><td><code id="quantile_CI_+3A_q">q</code></td>
<td>
<p>quantile</p>
</td></tr>
<tr><td><code id="quantile_CI_+3A_alpha">alpha</code></td>
<td>
<p>CI value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the order statistics and the actual coverage.
</p>

<hr>
<h2 id='ReconLogistic'>ReconLogistic</h2><span id='topic+ReconLogistic'></span>

<h3>Description</h3>

<p>Atrazine exceedances (Y/N) above 1 ug/L in streams throughout the Midwestern United States.
Original concentration data were censored to show either greater than (1) or less than (0) 1 ug/L.
</p>
<p>Objective &ndash; determine if the pattern of atrazine concentrations above versus below 1 ug/L were related
to seven environmental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ReconLogistic)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 423 rows and 8 columns.
</p>


<h3>Source</h3>

<p>Mueller et al., 1997, Journal of Environmental Quality 26, pp. 1223-1230.
</p>


<h3>References</h3>

<p>Chapter 12 of Helsel, Dennis R. (2012).  Statistics for Censored Environmental Data
using Minitab and R.  John Wiley and Sons, USA, NJ..
</p>

<hr>
<h2 id='ROSci'>Computes confidence intervals on regression on order statistics (ROS) mean</h2><span id='topic+ROSci'></span>

<h3>Description</h3>

<p>Uses ROS model output from the <code>NADA</code> package and computes the Zhou and Gao 1997 modified Cox’s method two-sided confidence interval around the mean for a lognormal distribution.  Computes a t-interval for a gaussian ROS model output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROSci(cenros.out, conf = 0.95, printstat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ROSci_+3A_cenros.out">cenros.out</code></td>
<td>
<p>an ROS model output object (see details)</p>
</td></tr>
<tr><td><code id="ROSci_+3A_conf">conf</code></td>
<td>
<p>Confidence coefficient of the interval (Default is 0.95)</p>
</td></tr>
<tr><td><code id="ROSci_+3A_printstat">printstat</code></td>
<td>
<p>Logical <code>TRUE</code>/<code>FALSE</code> option of whether to print the resulting statistics in the console window, or not.  Default is <code>TRUE.</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses an ROS model output based on the <code>ros</code> function in the <code>NADA</code> package.  The lognormal distribution is the default for the NADA package but a gaussian distribution is optional here.
For more detail on ROS modeling see the <code>ros</code> help file (<code>?NADA::ros</code>).
</p>
<p>For implementation of <code>ROSci(...)</code> see the examples below.
</p>


<h3>Value</h3>

<p>Prints a lower (LCL) and upper (UCL) confidence interval based on the <code>conf</code> provided (Default is 95%)
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for censored environmental data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>
<p>Lee, L., Helsel, D., 2005. Statistical analysis of water-quality data containing multiple detection limits: S-language software for regression on order statistics. Computers &amp; Geosciences 31, 1241–1248. doi: <a href="https://doi.org/10.1016/j.cageo.2005.03.012">10.1016/j.cageo.2005.03.012</a>
</p>
<p>Zhou, X.-H., Gao, S., 1997. Confidence Intervals for the Log-Normal Mean. Statistics in Medicine 16, 783–790. doi: <a href="https://doi.org/10.1002/(SICI)1097-0258(19970415)16:7%3C783::AID-SIM488%3E3.0.CO;2-2">10.1002/(SICI)1097-0258(19970415)16:7&lt;783::AID-SIM488&gt;3.0.CO;2-2</a>
</p>


<h3>See Also</h3>

<p><a href="NADA.html#topic+ros">NADA::ros</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)
myros &lt;- NADA::ros(Brumbaugh$Hg,Brumbaugh$HgCen)

summary(myros)

# ROS Mean
mean(myros$modeled)

# 95% CI around the ROS mean
ROSci(myros)
</code></pre>

<hr>
<h2 id='TCE2'>TCE2</h2><span id='topic+TCE2'></span>

<h3>Description</h3>

<p>TCE concentrations (ug/L) in ground waters of Long Island, New York.
Categorized by two of the three land use types (medium and high density residential) surrounding the wells and measured in the study.
</p>
<p>Objective &ndash; determine if TCE concentrations differ in ground water under two land use types.
There are four detection limits, at 1,2,4 and 5 ug/L.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(TCE2)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 222 rows and 6 columns.
</p>


<h3>Source</h3>

<p>Eckhardt et al., 1989,	USGS Water Resources Investigations Report 86-4142.
</p>


<h3>References</h3>

<p>The full dataset with three land use types is used in Chapter 10 of Statistics for
Censored Environmental Data using Minitab and R, by D.R.Helsel; Wiley (2012).
</p>

<hr>
<h2 id='uMDS'>Plot U-score Nonmetric Multidimensional Scaling of censored data</h2><span id='topic+uMDS'></span>

<h3>Description</h3>

<p>Plots an NMDS of uscores output from the <code>uscores</code> or <code>uscoresi</code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uMDS(uscor, group = NULL, title = NULL, legend.pos = "bottomleft")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uMDS_+3A_uscor">uscor</code></td>
<td>
<p>A data frame of uscores or ranks of uscores produced by either the <code>uscores(...)</code> or <code>uscoresi(...)</code> functions</p>
</td></tr>
<tr><td><code id="uMDS_+3A_group">group</code></td>
<td>
<p>Optional grouping variable. Sites will be represented by different colored symbols for each group.</p>
</td></tr>
<tr><td><code id="uMDS_+3A_title">title</code></td>
<td>
<p>Optional title for the NMDS graph.</p>
</td></tr>
<tr><td><code id="uMDS_+3A_legend.pos">legend.pos</code></td>
<td>
<p>For when group is specified, the location of the legend on the graph showing the colors representing each group’s data.  Default is “bottomleft”.  Alternatives are “topright” and “centerleft”, etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints an NMDS plot of censored data groupings based on U-scores
#' @references
Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

PbHeron.u &lt;- uscores(PbHeron[,4:15])
uMDS(PbHeron.u)

# With group specific
uMDS(PbHeron.u,group=PbHeron$DosageGroup)
</code></pre>

<hr>
<h2 id='Usc'>U-scores for (non-interval, sinle-column) Censored Data</h2><span id='topic+Usc'></span>

<h3>Description</h3>

<p>Computes the column of uscores from 2 columns of data in the indicator value format. Multiple detection limits allowed.  Called by the uscores function, Usc (this function) is not expected to be of much use to users on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Usc(y, ind, rnk = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Usc_+3A_y">y</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="Usc_+3A_ind">ind</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y</code>.</p>
</td></tr>
<tr><td><code id="Usc_+3A_rnk">rnk</code></td>
<td>
<p>A <code>TRUE</code>/<code>FALSE</code> variable on whether to compute the multivariate pattern on the uscores, or the ranks of the uscores.  Default is rnk=<code>TRUE</code>, use the ranks. rnk = <code>FALSE</code> returns the uscores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single column of uscores or the ranks of uscores for a single pair of (concentration, indicator) censored data columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)
uscore(Brumbaugh$Hg,Brumbaugh$HgCen)
</code></pre>

<hr>
<h2 id='Usci'>Interval-censored U-Score</h2><span id='topic+Usci'></span>

<h3>Description</h3>

<p>Interval-censored computation of uscores and their ranks for 1 parameter.  Called by uscoresi. Usci is not expected to be of much use to users on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Usci(ylo, yhi, rnk = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Usci_+3A_ylo">ylo</code></td>
<td>
<p>The lower end of the concentration interval</p>
</td></tr>
<tr><td><code id="Usci_+3A_yhi">yhi</code></td>
<td>
<p>The upper end of the concentration interval</p>
</td></tr>
<tr><td><code id="Usci_+3A_rnk">rnk</code></td>
<td>
<p>A <code>TRUE</code>/<code>FALSE</code> variable on whether to compute the multivariate pattern on the uscores, or the ranks of the uscores.  Default is rnk=<code>TRUE</code>, use the ranks. rnk = <code>FALSE</code> returns the uscores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a single column of uscores or the ranks of uscores for a single pair of (low, high) interval-censored data columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Brumbaugh)

# for demonstration purposes create a lower end concentration interval
Brumbaugh$lowHg&lt;-Brumbaugh$Hg*(1-Brumbaugh$HgCen)

with(Brumbaugh,Usci(lowHg,Hg))
</code></pre>

<hr>
<h2 id='uscore'>U-score (individual value)</h2><span id='topic+uscore'></span>

<h3>Description</h3>

<p>Computes the uscore of data (required 2-columns) with one or more detection limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uscore(y, ind, rnk = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uscore_+3A_y">y</code></td>
<td>
<p>The column of data values plus detection limits</p>
</td></tr>
<tr><td><code id="uscore_+3A_ind">ind</code></td>
<td>
<p>The column of indicators, where 1 (or <code>TRUE</code>) indicates a detection limit in the <code>y</code> column, and 0 (or <code>FALSE</code>) indicates a detected value in <code>y</code>.</p>
</td></tr>
<tr><td><code id="uscore_+3A_rnk">rnk</code></td>
<td>
<p>A <code>TRUE</code>/<code>FALSE</code> variable on whether to compute the multivariate pattern on the uscores, or the ranks of the uscores.  Default is rnk=<code>TRUE</code>, use the ranks. rnk = <code>FALSE</code> returns the uscores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>prints the uscore number of observations known to be lower - number of observations known to be higher, for each observation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Brumbaugh)
uscore(Brumbaugh$Hg,Brumbaugh$HgCen)
</code></pre>

<hr>
<h2 id='uscores'>Uscores for multiple columns of censored data</h2><span id='topic+uscores'></span>

<h3>Description</h3>

<p>Computes uscores or the ranks of uscores of censored data in the indicator format. Multiple DLs allowed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uscores(dat.frame, paired = TRUE, rnk = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uscores_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame. Default format is paired = <code>TRUE</code>, where for 3 chemical parameters the input format is C1 I1 C2 I2 C3 I3, a concentration column followed by its corresponding indicator column.</p>
</td></tr>
<tr><td><code id="uscores_+3A_paired">paired</code></td>
<td>
<p>When paired = <code>FALSE</code>, the input format is C1 C2 C3 I1 I2 I3 where the C columns contain concentrations or a detection limit, and the I columns are their associated indicators, in the same order as the concentration columns.</p>
</td></tr>
<tr><td><code id="uscores_+3A_rnk">rnk</code></td>
<td>
<p>A logical <code>TRUE</code>/<code>FALSE</code> variable on whether to compute the multivariate pattern on the uscores, or the ranks of the uscores.  Default is rnk=<code>TRUE</code>, use the ranks. rnk = <code>FALSE</code> returns the uscores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of uscores or ranks of uscores, one column for each chemical parameter.  If there is only one chemical parameter a vector of uscores or ranks of uscores is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PbHeron)

uscores(PbHeron[,4:15])
</code></pre>

<hr>
<h2 id='uscoresi'>U-scores for interval-censored data (multiple columns)</h2><span id='topic+uscoresi'></span>

<h3>Description</h3>

<p>Computes uscores or the ranks off uscores within columns of interval-censored data (the &quot;i&quot;).  Data may have one or more detection limits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uscoresi(dat.frame, paired = TRUE, rnk = TRUE, Cnames = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uscoresi_+3A_dat.frame">dat.frame</code></td>
<td>
<p>A data frame. Default format is: paired = <code>TRUE</code>, the default input format is ylo1 yhi1 ylo2 yhi2 ylo3 yhi3, where ylo is the low end of the interval of possible values, and yhi is the high end. There is a pair of columns for each censored parameter.</p>
</td></tr>
<tr><td><code id="uscoresi_+3A_paired">paired</code></td>
<td>
<p>An option to specify paired = <code>FALSE</code>, where the format would be ylo1 ylo2 ylo3 yhi1 yhi2 yhi3, low values for each parameter followed by the high values in the same order.</p>
</td></tr>
<tr><td><code id="uscoresi_+3A_rnk">rnk</code></td>
<td>
<p>rnk=<code>TRUE</code> returns the ranks of uscores.  rnk = <code>FALSE</code> returns the uscores themselves. Default is rnk = <code>TRUE</code> to return the ranks.</p>
</td></tr>
<tr><td><code id="uscoresi_+3A_cnames">Cnames</code></td>
<td>
<p>Cnames =<code>1</code> uses the &quot;lo&quot; column names to name the uscores columns (the default).  Cnames = <code>2</code> uses the &quot;hi&quot; column names.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input is a data.frame of paired low and high possible range of values, in an interval-censored format. ylo = the lower end of the interval is the first (left) column in the pair.  yhi is the upper end of the interval, at the second (right) column in the pair. For a detected value, ylo=yhi.  For a ND,  ylo != yhi. The uscore is the number of observations known to be lower minus the number of observations known to be higher. Ties, including those such as &lt;1 vs &lt;3 or 4 vs 4 or &lt;3 vs 2, are given a 0 value in the uscore computation. The ranks of uscores provides a scale that is often more manageable than the uscores themselves.
</p>


<h3>Value</h3>

<p>prints the uscore number of observations known to be lower - number of observations known to be higher, for each observation.
</p>


<h3>References</h3>

<p>Helsel, D.R., 2011. Statistics for Censored Environmental Data using Minitab and R, 2nd ed. John Wiley &amp; Sons, USA, N.J.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
