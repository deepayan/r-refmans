<!DOCTYPE html><html><head><title>Help for package bayesGAM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bayesGAM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bayesGAM'><p><code>bayesGAM</code> fits a variety of regression models using Hamiltonian Monte Carlo</p></a></li>
<li><a href='#bayesGAM-package'><p>The 'bayesGAM' package.</p></a></li>
<li><a href='#bayesGAMfit-class'><p>Contains results from <code>rstan</code> as well as the design matrices and other data for the model.</p></a></li>
<li><a href='#bloodpressure'><p>Blood pressure data from a clinical study</p></a></li>
<li><a href='#coefficients'><p>Extract Model Coefficients</p></a></li>
<li><a href='#create_bivariate_design'><p>Creates a design matrix from a bivariate smoothing algorithm</p></a></li>
<li><a href='#extract_log_lik_bgam'><p>Extract the log likelihood from models fit by <code>bayesGAM</code></p></a></li>
<li><a href='#fitted'><p>Extract fitted values from a model fit by <code>bayesGAM</code></p></a></li>
<li><a href='#getDesign'><p>Design matrices from a <code>bayesGAMfit</code> object</p></a></li>
<li><a href='#getModelSlots'><p>Return one or slots from the <code>Stan</code> model in <code>bayesGAM</code></p></a></li>
<li><a href='#getSamples'><p>Extract the MCMC samples from an object of type <code>bayesGAMfit</code></p></a></li>
<li><a href='#getStanResults'><p>Returns the <code>stanfit</code> object generated by <span class="pkg">rstan</span></p></a></li>
<li><a href='#L'><p>Lag function for autoregressive models</p></a></li>
<li><a href='#loo_bgam'><p>Calls the <code>loo</code> package to perform efficient approximate leave-one-out cross-validation on models fit with <code>bayesGAM</code></p></a></li>
<li><a href='#loo_compare_bgam'><p>Calls the <code>loo</code> package to compare models fit by <code>bayesGAMfit</code></p></a></li>
<li><a href='#mcmc_plots'><p>Plotting for MCMC visualization and diagnostics provided by <code>bayesplot</code> package</p></a></li>
<li><a href='#mvcorrplot'><p>Multivariate response correlation plot for <code>bayesGAMfit</code> objects</p></a></li>
<li><a href='#normal'><p>Constructor function for Normal priors</p></a></li>
<li><a href='#np'><p>Creates design matrices for univariate and bivariate applications</p></a></li>
<li><a href='#plot'><p>Additional plotting for MCMC visualization and diagnostics.</p></a></li>
<li><a href='#posterior_predict'><p>Posterior predictive samples from models fit by <code>bayesGAM</code></p></a></li>
<li><a href='#ppc_plots'><p>Plotting for MCMC visualization and diagnostics provided by <code>bayesplot</code> package</p></a></li>
<li><a href='#predict'><p>Posterior predictive samples from models fit by <code>bayesGAM</code>, but with new data</p></a></li>
<li><a href='#reef'><p>Coral reef data from survey data on 6 sites</p></a></li>
<li><a href='#showPrior'><p>Display the priors used in <code>bayesGAM</code></p></a></li>
<li><a href='#st'><p>Constructor function for Student-t priors</p></a></li>
<li><a href='#summary'><p>Summarizing Model Fits from <code>bayesGAM</code></p></a></li>
<li><a href='#waic_bgam'><p>Calls the <code>loo</code> package to calculate the widely applicable information criterion (WAIC)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Fit Multivariate Response Generalized Additive Models using
Hamiltonian Monte Carlo</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The 'bayesGAM' package is designed to provide a user friendly option to fit univariate and multivariate response Generalized Additive Models (GAM) using Hamiltonian Monte Carlo (HMC) with few technical burdens.  The functions in this package use 'rstan' (Stan Development Team 2020)  to call 'Stan' routines that run the HMC simulations. The 'Stan' code for these models is already pre-compiled for the user. The programming formulation for models in 'bayesGAM' is designed to be familiar to analysts who fit statistical models in 'R'.
    Carpenter, B., Gelman, A., Hoffman, M. D., Lee, D., Goodrich, B., Betancourt, M., ... &amp; Riddell, A. (2017). Stan: A probabilistic programming language. Journal of statistical software, 76(1). 
    Stan Development Team. 2018. RStan: the R interface to Stan. R package version 2.17.3.   <a href="https://mc-stan.org/">https://mc-stan.org/</a>
    Neal, Radford (2011) "Handbook of Markov Chain Monte Carlo" ISBN: 978-1420079418.
    Betancourt, Michael, and Mark Girolami. "Hamiltonian Monte Carlo for hierarchical models." Current trends in Bayesian methodology with applications 79.30 (2015): 2-4.
    Thomas, S., Tu, W. (2020) "Learning Hamiltonian Monte Carlo in R" &lt;<a href="https://arxiv.org/abs/2006.16194">arXiv:2006.16194</a>&gt;,
    Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013) "Bayesian Data Analysis" ISBN: 978-1439840955, 
    Agresti, Alan (2015) "Foundations of Linear and Generalized Linear Models ISBN: 978-1118730034, 
    Pinheiro, J., Bates, D. (2006) "Mixed-effects Models in S and S-Plus" ISBN: 978-1441903174.
    Ruppert, D., Wand, M. P., &amp; Carroll, R. J. (2003). Semiparametric regression (No. 12). Cambridge university press. ISBN: 978-0521785167.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel Thomas &lt;samthoma@alumni.iu.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>bayesplot, boot, cluster, corrplot, ggplot2, graphics,
gridExtra, loo, methods, mlbench, Rcpp (&ge; 0.12.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), rstantools (&ge;
2.1.0.9000), SemiPar, stats, geometry, MASS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.18.1), StanHeaders (&ge;
2.18.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-16 23:41:46 UTC; samue</td>
</tr>
<tr>
<td>Author:</td>
<td>Samuel Thomas [cre, aut],
  Wanzhu Tu [ctb],
  Trustees of Columbia University (R/rstanMethods.R) [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-17 08:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='bayesGAM'><code>bayesGAM</code> fits a variety of regression models using Hamiltonian Monte Carlo</h2><span id='topic+bayesGAM'></span>

<h3>Description</h3>

<p>Based on <code><a href="stats.html#topic+glm">glm</a></code>.  <code>bayesGAM</code> is used to fit a variety of statistical models, including linear models, generalized lienar models, mixed effect models with random intercept, and semiparametric regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayesGAM(
  formula,
  random = NULL,
  family = gaussian,
  data,
  offset,
  beta = list(),
  eps = list(),
  lambda = list(),
  a = list(),
  spcontrol = list(qr = TRUE, mvindep = FALSE, ...),
  store_plot_data = FALSE,
  method = "bayesGAMfit",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayesGAM_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code> object describing the model to be fitted.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_random">random</code></td>
<td>
<p>(optional) specify a random intercept in the form '~var'</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_family">family</code></td>
<td>
<p>distribution and link function for the model</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_data">data</code></td>
<td>
<p>(optional) data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_offset">offset</code></td>
<td>
<p>Same as <code><a href="stats.html#topic+glm">glm</a></code></p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_beta">beta</code></td>
<td>
<p>(optional) list of priors for the fixed effects parameters.  Sensible priors are selected as a default.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_eps">eps</code></td>
<td>
<p>(optional) list of priors for the error term in linear regression.  Sensible priors are selecteda as a default.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_lambda">lambda</code></td>
<td>
<p>(optional) list of priors for random effects variance parameters.  Sensible priors are selected as a default.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_a">a</code></td>
<td>
<p>(optional) list of priors for the off diagonal of the LDLT decomposed covariance matrix for multivariate response models.  Vague normal priors are used as a default.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_spcontrol">spcontrol</code></td>
<td>
<p>a list of control parameters for fitting the model in STAN.  See 'details'</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_store_plot_data">store_plot_data</code></td>
<td>
<p>a logical indicator for storing the plot data frame after simulation. Defaults to <code>FALSE</code></p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_method">method</code></td>
<td>
<p>default currently set to 'bayesGAMfit'.</p>
</td></tr>
<tr><td><code id="bayesGAM_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>rstan::sampling</code> (e.g. iter, chains).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Similar to <code>glm</code>, models are typically specified by formula.
The formula typically takes the form <code>response ~ terms</code>, where the response is numeric
and terms specify the linear predictor for the response.  The terms may be numeric variables or factors.
</p>
<p>The link function for the Generalized Linear Model is specified with a <code><a href="stats.html#topic+family">family</a></code> object.
Currently, this package supports gaussian, binomial, and poisson families with all available link functions.
</p>
<p>The list <code>spcontrol</code> currently supports additional parameters to facilitate fitting models.
<code>qr</code> is a logical indicator specifying whether the design matrix should be transformed via QR decomposition prior to HMC sampling.
QR decomposition often improves the efficiency with which HMC samples, as the MCMC chain navigates an orthogonal
space more easily than highly correlated parameters.
<code>mvindep</code> is a logical indicator for multivariate response models with random intercepts. This indicates whether
the multivariate responses should be considered independent. Defaults to <code>FALSE</code>
</p>


<h3>Value</h3>

<p>An object of class <code>bayesGAMfit</code>.  Includes slots:
</p>
<p><code>results</code>:  <code>stanfit</code> object returned by <code>rstan::sampling</code>
</p>
<p><code>model</code>:  <code>glmModel</code> object
</p>
<p><code>offset</code>:  offset vector from the input parameter
</p>
<p><code>spcontrol</code>:  list of control parameters from input
</p>


<h3>References</h3>

<p>Hastie, T. J. (1992) Generalized additive models. Chapter 7 of <em>Statistical Models in S</em> eds J. M. Chambers and T. J. Hastie, Wadsworth &amp; Brooks/Cole.
</p>
<p>Dobson, A. J. (1990) <em>An Introduction to Generalized Linear Models</em>. London: Chapman and Hall.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Dobson (1990) Page 93: Randomized Controlled Trial :
counts &lt;- c(18,17,15,20,10,20,25,13,12)
outcome &lt;- gl(3,1,9)
treatment &lt;- gl(3,3)
fpois&lt;- bayesGAM(counts ~ outcome + treatment, family = poisson(),
                 spcontrol = list(qr = TRUE))
summary(fpois)
</code></pre>

<hr>
<h2 id='bayesGAM-package'>The 'bayesGAM' package.</h2><span id='topic+bayesGAM-package'></span>

<h3>Description</h3>

<p>Fit Bayesian multivariate generalized additive models using Stan
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.1. https://mc-stan.org
</p>

<hr>
<h2 id='bayesGAMfit-class'>Contains results from <code>rstan</code> as well as the design matrices and other data for the model.</h2><span id='topic+bayesGAMfit-class'></span><span id='topic+bayesGAMfit'></span><span id='topic+show+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Returns object generated from model fit by <code>bayesGAM</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bayesGAMfit-class_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> which stores the results from <code>rstan</code>, design matrices, and other data for the model.</p>
</td></tr>
</table>


<h3>Slots</h3>


<dl>
<dt><code>results</code></dt><dd><p>Object of type <code>stanfit</code> returned from calling <code>rstan::sampling</code></p>
</dd>
<dt><code>model</code></dt><dd><p>Object of custom type <code>glmModel</code> with the data and input parameters passed to <code>rstan</code></p>
</dd>
<dt><code>offset</code></dt><dd><p>Optionally numeric offset for the generalized additive model</p>
</dd>
<dt><code>spcontrol</code></dt><dd><p>List of control parameters for <code>bayesGAMfit</code></p>
</dd>
<dt><code>mcmcres</code></dt><dd><p>Matrix of MCMC results for all chains, if plot data is stored</p>
</dd>
<dt><code>pdata</code></dt><dd><p>Dataframe for default plot method, if plot data is stored.</p>
</dd>
</dl>

<hr>
<h2 id='bloodpressure'>Blood pressure data from a clinical study</h2><span id='topic+bloodpressure'></span>

<h3>Description</h3>

<p>Data from 200 subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bloodpressure
</code></pre>


<h3>Format</h3>

<p>A data frame with 2438 rows and 13 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Subject identification number</p>
</dd>
<dt>BIRTH_WT</dt><dd><p>birth weight (lbs)</p>
</dd>
<dt>WEIGHT</dt><dd><p>current weight (lbs)</p>
</dd>
<dt>HEIGHT</dt><dd><p>current height (cm)</p>
</dd>
<dt>BMI</dt><dd><p>current body mass index</p>
</dd>
<dt>age</dt><dd><p>current age (yrs)</p>
</dd>
<dt>dias</dt><dd><p>diastolic blood pressure</p>
</dd>
<dt>sys</dt><dd><p>systolic blood pressure</p>
</dd>
<dt>SexM</dt><dd><p>indicator of sex male</p>
</dd>
<dt>RaceB</dt><dd><p>indicator of race black</p>
</dd>
<dt>RaceW</dt><dd><p>indicator of race white</p>
</dd>
<dt>PHIGHBP</dt><dd><p>indicator that either parent had high blood pressure</p>
</dd>
<dt>PDIABET</dt><dd><p>indicator that either parent had diabetes</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data provided by Wanzhu Tu, Indiana University School of Medicine
</p>


<h3>References</h3>

<p>Tu, W., Eckert, G. J., DiMeglio, L. A., Yu, Z., Jung, J., and Pratt, J. H. (2011). <em>Intensified effect of adiposity on blood pressure in overweight and obese children</em>. Hypertension, 58(5), 818-824.
</p>

<hr>
<h2 id='coefficients'>Extract Model Coefficients</h2><span id='topic+coefficients'></span><span id='topic+coefficients+2CbayesGAMfit-method'></span><span id='topic+coef+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Method for <code>bayesGAMfit</code> objects.  Extracts the specified quantile of the posterior.
The user may specify all or some of the parameters <code class="reqn">\beta</code>, <code class="reqn">\epsilon</code>, <code class="reqn">\lambda</code>, <code class="reqn">u</code>, <code class="reqn">sigma</code>, <code class="reqn">a</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
coefficients(
  object,
  params = c("beta", "eps", "lambda", "u", "sigma", "a"),
  FUN = median
)

## S4 method for signature 'bayesGAMfit'
coef(
  object,
  params = c("beta", "eps", "lambda", "u", "sigma", "a"),
  FUN = median
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coefficients_+3A_object">object</code></td>
<td>
<p>an object of class <code>bayesGAMfit</code>, usually a result of a call to <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="coefficients_+3A_params">params</code></td>
<td>
<p>character vector of the names of parameters to return
</p>

<ul>
<li> <p><code class="reqn">\beta</code> beta
</p>
</li>
<li> <p><code class="reqn">\epsilon</code> eps
</p>
</li>
<li> <p><code class="reqn">\lambda</code> lambda
</p>
</li>
<li> <p><code class="reqn">a] a</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="coefficients_+3A_fun">FUN</code></td>
<td>
<p>function from which to estimate coefficients. Default is <code>median</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of parameter point estimates based on the given <code>prob</code>, with a default of the median estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
coef(f, params=c("beta", "eps"))
</code></pre>

<hr>
<h2 id='create_bivariate_design'>Creates a design matrix from a bivariate smoothing algorithm</h2><span id='topic+create_bivariate_design'></span>

<h3>Description</h3>

<p><code>create_bivariate_design</code> accepts two numeric vectors of equal length as inputs. From these inputs, a bivariate smoothing design matrix is produced using thin plate splines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_bivariate_design(X1, X2, num_knots = NULL, knots = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_bivariate_design_+3A_x1">X1</code></td>
<td>
<p>numeric vector for first variable</p>
</td></tr>
<tr><td><code id="create_bivariate_design_+3A_x2">X2</code></td>
<td>
<p>numeric vector for second variable</p>
</td></tr>
<tr><td><code id="create_bivariate_design_+3A_num_knots">num_knots</code></td>
<td>
<p>optional: number of knots</p>
</td></tr>
<tr><td><code id="create_bivariate_design_+3A_knots">knots</code></td>
<td>
<p>optional: matrix of knot locations for bivariate smoothing</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing the design matrix <code>Z</code> and matrix of <code>knots</code>
</p>


<h3>References</h3>

<p>Ruppert, David, Matt P. Wand, and Raymond J. Carroll. <em>Semiparametric Regression</em>. No. 12. Cambridge university press, 2003. Section 13.5
</p>
<p>Matt Wand (2018). SemiPar: Semiparametric Regression. R package version 1.0-4.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- rnorm(100)
x2 &lt;- rnorm(100)
res &lt;- create_bivariate_design(x1, x2)
res$knots
dim(res$Z)
</code></pre>

<hr>
<h2 id='extract_log_lik_bgam'>Extract the log likelihood from models fit by <code>bayesGAM</code></h2><span id='topic+extract_log_lik_bgam'></span><span id='topic+extract_log_lik_bgam+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Convenience function for extracting the pointwise log-likelihood matrix
or array from a model fit by <code>bayesGAM</code>. Calls the <code>extract_log_lik</code> method
from the <code>loo</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_log_lik_bgam(object, ...)

## S4 method for signature 'bayesGAMfit'
extract_log_lik_bgam(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_log_lik_bgam_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="extract_log_lik_bgam_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to <code>loo::extract_log_lik</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the extracted log likelihood values post-warmup
</p>


<h3>References</h3>

<p>Stan Development Team (2017). The Stan C++ Library, Version 2.16.0. https://mc-stan.org/
</p>
<p>Stan Development Team (2017). RStan: the R interface to Stan, Version 2.16.1. https://mc-stan.org/
</p>
<p>Vehtari A, Gabry J, Magnusson M, Yao Y, Gelman A (2019). “loo: Efficient leave-one-out cross-validation and WAIC for Bayesian models.” R package version 2.2.0, &lt;URL: https://mc-stan.org/loo&gt;.
</p>
<p>Vehtari A, Gelman A, Gabry J (2017). “Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC.” <em>Statistics and Computing</em>, <em>27</em>, 1413-1432. doi:10.1007/s11222-016-9696-4 (URL: https://doi.org/10.1007/s11222-016-9696-4).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women,
              family = gaussian, iter=500, chains = 1)
ll &lt;- extract_log_lik_bgam(f)
</code></pre>

<hr>
<h2 id='fitted'>Extract fitted values from a model fit by <code>bayesGAM</code></h2><span id='topic+fitted'></span><span id='topic+fitted+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Method for <code>bayesGAMfit</code> objects.  Extracts the fitted values based on a specified quantile for the posterior distribution. The median is the default.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted_+3A_object">object</code></td>
<td>
<p>an object of class <code>bayesGAMfit</code>, usually a result of a call to <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="fitted_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code>coefficients</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of fitted values
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
plot(fitted(f), women$weight, type='o', xlab="fitted", ylab="actual")
</code></pre>

<hr>
<h2 id='getDesign'>Design matrices from a <code>bayesGAMfit</code> object</h2><span id='topic+getDesign'></span><span id='topic+getDesign+2CbayesGAMfit-method'></span><span id='topic+getDesign+2CglmModel-method'></span>

<h3>Description</h3>

<p>Contains the design matrices produced for model fitting. The fixed effects design matrix <code>X</code> or random effects design matrix <code>Z</code> can be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDesign(object, ...)

## S4 method for signature 'bayesGAMfit'
getDesign(object, type = "X")

## S4 method for signature 'glmModel'
getDesign(object, type = "X")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getDesign_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code></p>
</td></tr>
<tr><td><code id="getDesign_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>getDesign</code></p>
</td></tr>
<tr><td><code id="getDesign_+3A_type">type</code></td>
<td>
<p>Character for fixed effect design matrix <code>X</code> or random effects design matrix <code>Z</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Contents of <code>stanfit</code> results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
getDesign(f, "Z")
</code></pre>

<hr>
<h2 id='getModelSlots'>Return one or slots from the <code>Stan</code> model in <code>bayesGAM</code></h2><span id='topic+getModelSlots'></span><span id='topic+getModelSlots+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Contains the objects and parameters passed to Stan in object of type <code>glmModel</code>, contained in object type <code>bayesGAMfit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getModelSlots(object, ...)

## S4 method for signature 'bayesGAMfit'
getModelSlots(object, name = "X")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getModelSlots_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code></p>
</td></tr>
<tr><td><code id="getModelSlots_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>getModelSlots</code></p>
</td></tr>
<tr><td><code id="getModelSlots_+3A_name">name</code></td>
<td>
<p>Character name of slot in <code>glmModel</code>
</p>

<ul>
<li><p> X Fixed effects design matrix
</p>
</li>
<li><p> Z Random effects design matrix
</p>
</li>
<li><p> Zlst list of individual random effects design matrices that, combined, form <code>Z</code>
</p>
</li>
<li><p> Zarray array of individual random effects design matrices.  Used for multiple response models
</p>
</li>
<li><p> max_col maximum number of columns of an individual <code>Z</code> matrix.  Padding for STAN
</p>
</li>
<li><p> y numeric response matrix
</p>
</li>
<li><p> p number of beta parameters
</p>
</li>
<li><p> r number of eps parameters
</p>
</li>
<li><p> q number of lambda parameters
</p>
</li>
<li><p> n number of records in the dataset
</p>
</li>
<li><p> has_intercept logical of whether the model includes an intercept term
</p>
</li>
<li><p> zvars number of random effects variables
</p>
</li>
<li><p> names_beta parameter names for beta
</p>
</li>
<li><p> names_u parameter names for the random effects
</p>
</li>
<li><p> names_y response names
</p>
</li>
<li><p> prior <code>prior</code> object with priors used in the model
</p>
</li>
<li><p> knots list of knots used in non-parametric functions
</p>
</li>
<li><p> basis character indicating basis function.  <code>tps</code> for thin-plate splines and <code>trunc.poly</code> for truncated polynomial
</p>
</li>
<li><p> npargs arguments passed to non-parametric functions in the model
</p>
</li>
<li><p> npterms variables used in non-parametric functions
</p>
</li>
<li><p> sub_form formula with the <code>np</code> terms removed
</p>
</li>
<li><p> random_intercept logical indicator of whether a random effects intercept is used
</p>
</li>
<li><p> multresponse logical indicator of whether the model is multiple response
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Contents of slot in <code>glmModel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
getModelSlots(f, "X")
</code></pre>

<hr>
<h2 id='getSamples'>Extract the MCMC samples from an object of type <code>bayesGAMfit</code></h2><span id='topic+getSamples'></span><span id='topic+getSamples+2CbayesGAMfit-method'></span><span id='topic+getSamples+2Cstanfit-method'></span><span id='topic+getSamples+2CglmModel-method'></span>

<h3>Description</h3>

<p>Returns an array of the posterior simulation from <code>Stan</code>. Optionally, may return a subsample from the full MCMC simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSamples(object, ...)

## S4 method for signature 'bayesGAMfit'
getSamples(object, nsamp = NULL, seednum = NULL, ...)

## S4 method for signature 'stanfit'
getSamples(object, nsamp = 1000, seednum = NULL, results = NULL, ...)

## S4 method for signature 'glmModel'
getSamples(object, nsamp = NULL, seednum = NULL, results = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSamples_+3A_object">object</code></td>
<td>
<p>model object of class <code>bayesGAMfit</code></p>
</td></tr>
<tr><td><code id="getSamples_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code>corrplot.mixed</code></p>
</td></tr>
<tr><td><code id="getSamples_+3A_nsamp">nsamp</code></td>
<td>
<p>Optional number of samples to return</p>
</td></tr>
<tr><td><code id="getSamples_+3A_seednum">seednum</code></td>
<td>
<p>Optional integer for seed number when selecting a random sample</p>
</td></tr>
<tr><td><code id="getSamples_+3A_results">results</code></td>
<td>
<p>Matrix of HMC posterior samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>array of the posterior simulation, or subsample of the array
</p>


<h3></h3>

<p>NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
allres &lt;- getSamples(f)             
</code></pre>

<hr>
<h2 id='getStanResults'>Returns the <code>stanfit</code> object generated by <span class="pkg">rstan</span></h2><span id='topic+getStanResults'></span><span id='topic+getStanResults+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Contains the full content of the <code>stanfit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getStanResults(object)

## S4 method for signature 'bayesGAMfit'
getStanResults(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getStanResults_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> returned from <code>bayesGAM</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Contents of <code>stanfit</code> results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, family = gaussian, 
              iter = 500, chains = 1)
sres &lt;- getStanResults(f)
plot(sres) # rstan method
</code></pre>

<hr>
<h2 id='L'>Lag function for autoregressive models</h2><span id='topic+L'></span>

<h3>Description</h3>

<p>Creates lagged variables for use with <code>bayesGAM</code>, including the functionality
to create lags for each specified subject if desired. The input data must be pre-
sorted according by time, and within each subject id if specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L(x, k = 1, id = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L_+3A_x">x</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="L_+3A_k">k</code></td>
<td>
<p>integer vector of lagged variables to create</p>
</td></tr>
<tr><td><code id="L_+3A_id">id</code></td>
<td>
<p>optional identification number for each subject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector or matrix of the lagged variable(s)
</p>


<h3>References</h3>

<p>Zeileis A (2019). dynlm: Dynamic Linear Regression. R package version 0.3-6
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(20)
id &lt;- rep(1:4, each=5)
L(x, 1:2, id)

# autoregressive
ar.ols(lh, demean = FALSE, intercept=TRUE, order=1)
f &lt;- bayesGAM(lh ~ L(lh), family=gaussian)
coef(f)
</code></pre>

<hr>
<h2 id='loo_bgam'>Calls the <code>loo</code> package to perform efficient approximate leave-one-out cross-validation on models fit with <code>bayesGAM</code></h2><span id='topic+loo_bgam'></span><span id='topic+loo_bgam+2CbayesGAMfit-method'></span><span id='topic+loo_bgam+2Carray-method'></span>

<h3>Description</h3>

<p>Computes PSIS-LOO CV, efficient approximate leave-one-out (LOO) cross-validation for
Bayesian models using Pareto smoothed importance sampling (PSIS). This calls the implementation
from the <code>loo</code> package of the methods described in Vehtari, Gelman, and Gabry (2017a, 2017b).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loo_bgam(object, ...)

## S4 method for signature 'bayesGAMfit'
loo_bgam(object, ...)

## S4 method for signature 'array'
loo_bgam(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loo_bgam_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="loo_bgam_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to pass to <code>loo::loo</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list of class <code>c("psis_loo", "loo")</code>
</p>

<dl>
<dt><code>estimates</code></dt><dd>
<p>A matrix with two columns (<code>Estimate</code>, <code>SE</code>) and three rows
(<code>elpd_loo</code>, <code>p_loo</code>, <code>looic</code>). This
contains point estimates and standard errors of the expected log pointwise
predictive density (<code>elpd_loo</code>), the effective number of parameters
(<code>p_loo</code>) and the LOO information criterion <code>looic</code> (which is
just <code>-2 * elpd_loo</code>, i.e., converted to deviance scale).
</p>
</dd>
<dt><code>pointwise</code></dt><dd>
<p>A matrix with five columns (and number of rows equal to the number of
observations) containing the pointwise contributions of the measures
(<code>elpd_loo</code>, <code>mcse_elpd_loo</code>, <code>p_loo</code>, <code>looic</code>, <code>influence_pareto_k</code>).
in addition to the three measures in <code>estimates</code>, we also report
pointwise values of the Monte Carlo standard error of <code>elpd_loo</code>
(<code>mcse_elpd_loo</code>), and statistics describing the influence of
each observation on the posterior distribution (<code>influence_pareto_k</code>).
These are the estimates of the shape parameter <code class="reqn">k</code> of the
generalized Pareto fit to the importance ratios for each leave-one-out
distribution. See the pareto-k-diagnostic page for details.
</p>
</dd>
<dt><code>diagnostics</code></dt><dd>
<p>A named list containing two vectors:
</p>

<ul>
<li> <p><code>pareto_k</code>: Importance sampling reliability diagnostics. By default,
these are equal to the <code>influence_pareto_k</code> in <code>pointwise</code>.
Some algorithms can improve importance sampling reliability and
modify these diagnostics. See the pareto-k-diagnostic page for details.
</p>
</li>
<li> <p><code>n_eff</code>: PSIS effective sample size estimates.
</p>
</li></ul>

</dd>
<dt><code>psis_object</code></dt><dd>
<p>This component will be <code>NULL</code> unless the <code>save_psis</code> argument is set to
<code>TRUE</code> when calling <code>loo()</code>. In that case <code>psis_object</code> will be the object
of class <code>"psis"</code> that is created when the <code>loo()</code> function calls <code>psis()</code>
internally to do the PSIS procedure.
</p>
</dd>
</dl>



<h3>References</h3>

<p>Vehtari, A., Gelman, A., and Gabry, J. (2017a). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing. 27(5), 1413–1432. doi:10.1007/s11222-016-9696-4 (journal version, preprint arXiv:1507.04544).
</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017b). Pareto smoothed importance sampling. preprint arXiv:1507.02646
</p>
<p>Vehtari A, Gabry J, Magnusson M, Yao Y, Gelman A (2019). “loo: Efficient leave-one-out cross-validation and WAIC for Bayesian models.” R package version 2.2.0, &lt;URL: https://mc-stan.org/loo&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women,
              family = gaussian, iter=500, chains = 1)
loo_bgam(f)
</code></pre>

<hr>
<h2 id='loo_compare_bgam'>Calls the <code>loo</code> package to compare models fit by <code>bayesGAMfit</code></h2><span id='topic+loo_compare_bgam'></span><span id='topic+loo_compare_bgam+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Compares fitted models based on ELPD, the expected log pointwise predictive
density for a new dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loo_compare_bgam(object, ...)

## S4 method for signature 'bayesGAMfit'
loo_compare_bgam(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loo_compare_bgam_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="loo_compare_bgam_+3A_...">...</code></td>
<td>
<p>Additional objects of type <code>bayesGAMfit</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix with class <code>compare.loo</code> that has its own print method from the <code>loo</code> package
</p>


<h3>References</h3>

<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely application information criterion in singular learning theory. Journal of Machine Learning Research 11, 3571-3594.
</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017a). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing. 27(5), 1413–1432. doi:10.1007/s11222-016-9696-4 (journal version, preprint arXiv:1507.04544).
</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017b). Pareto smoothed importance sampling. preprint arXiv:1507.02646
</p>
<p>Vehtari A, Gabry J, Magnusson M, Yao Y, Gelman A (2019). “loo: Efficient leave-one-out cross-validation and WAIC for Bayesian models.” R package version 2.2.0, &lt;URL: https://mc-stan.org/loo&gt;.
</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and Gelman, A. (2019), Visualization in Bayesian workflow. J. R. Stat. Soc. A, 182: 389-402. doi:10.1111/rssa.12378
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f1 &lt;- bayesGAM(weight ~ height, data = women,
              family = gaussian, iter=500, chains = 1)
f2 &lt;- bayesGAM(weight ~ np(height), data=women, 
              family = gaussian, iter=500, chains = 1)
loo_compare_bgam(f1, f2)
</code></pre>

<hr>
<h2 id='mcmc_plots'>Plotting for MCMC visualization and diagnostics provided by <code>bayesplot</code> package</h2><span id='topic+mcmc_plots'></span><span id='topic+mcmc_intervals'></span><span id='topic+mcmc_intervals+2CbayesGAMfit-method'></span><span id='topic+mcmc_areas'></span><span id='topic+mcmc_areas+2CbayesGAMfit-method'></span><span id='topic+mcmc_hist'></span><span id='topic+mcmc_hist+2CbayesGAMfit-method'></span><span id='topic+mcmc_hist_by_chain'></span><span id='topic+mcmc_hist_by_chain+2CbayesGAMfit-method'></span><span id='topic+mcmc_dens'></span><span id='topic+mcmc_dens+2CbayesGAMfit-method'></span><span id='topic+mcmc_scatter'></span><span id='topic+mcmc_scatter+2CbayesGAMfit-method'></span><span id='topic+mcmc_hex'></span><span id='topic+mcmc_hex+2CbayesGAMfit-method'></span><span id='topic+mcmc_pairs'></span><span id='topic+mcmc_pairs+2CbayesGAMfit-method'></span><span id='topic+mcmc_acf'></span><span id='topic+mcmc_acf+2CbayesGAMfit-method'></span><span id='topic+mcmc_acf_bar'></span><span id='topic+mcmc_acf_bar+2CbayesGAMfit-method'></span><span id='topic+mcmc_trace'></span><span id='topic+mcmc_trace+2CbayesGAMfit-method'></span><span id='topic+mcmc_rhat'></span><span id='topic+mcmc_rhat+2CbayesGAMfit-method'></span><span id='topic+mcmc_rhat_hist'></span><span id='topic+mcmc_rhat_hist+2CbayesGAMfit-method'></span><span id='topic+mcmc_rhat_data'></span><span id='topic+mcmc_rhat_data+2CbayesGAMfit-method'></span><span id='topic+mcmc_neff'></span><span id='topic+mcmc_neff+2CbayesGAMfit-method'></span><span id='topic+mcmc_neff_hist'></span><span id='topic+mcmc_neff_hist+2CbayesGAMfit-method'></span><span id='topic+mcmc_neff_data'></span><span id='topic+mcmc_neff_data+2CbayesGAMfit-method'></span><span id='topic+mcmc_violin'></span><span id='topic+mcmc_violin+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Plots of Rhat statistics, ratios of effective sample size to total sample
size, and autocorrelation of MCMC draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_intervals(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_intervals(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_areas(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_areas(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_hist(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_hist(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_hist_by_chain(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_hist_by_chain(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_dens(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_dens(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_scatter(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_scatter(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_hex(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_hex(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_pairs(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_pairs(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_acf(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_acf(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_acf_bar(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_acf_bar(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_trace(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_trace(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_rhat(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_rhat(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_rhat_hist(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_rhat_hist(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_rhat_data(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_rhat_data(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_neff(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_neff(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_neff_hist(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_neff_hist(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_neff_data(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_neff_data(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)

mcmc_violin(object, ...)

## S4 method for signature 'bayesGAMfit'
mcmc_violin(
  object,
  regex_pars = c("^beta", "^lambda", "^eps", "^a", "^sigma_u_correlation"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_plots_+3A_object">object</code></td>
<td>
<p>an object of class <code>bayesGAMfit</code></p>
</td></tr>
<tr><td><code id="mcmc_plots_+3A_...">...</code></td>
<td>
<p>optional additional arguments to pass to the <code>bayesplot</code> functions</p>
</td></tr>
<tr><td><code id="mcmc_plots_+3A_regex_pars">regex_pars</code></td>
<td>
<p>character vector of regular expressions of variable names to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>These functions call various plotting functions from the <code>bayesplot</code> package, which returns a list including <code>ggplot2</code> objects.
</p>


<h3>Plot Descriptions from the <code>bayesplot</code> package documentation</h3>


<ul>
<li><p><code>mcmc_hist(object, ...)</code>
Default plot called by <code>plot</code> function.  Histograms of posterior draws with all chains merged.

</p>
</li>
<li><p><code>mcmc_dens(object, ...)</code>
Kernel density plots of posterior draws with all chains merged.

</p>
</li>
<li><p><code>mcmc_hist_by_chain(object, ...)</code>
Histograms of posterior draws with chains separated via faceting.

</p>
</li>
<li><p><code>mcmc_dens_overlay(object, ...)</code>
Kernel density plots of posterior draws with chains separated but
overlaid on a single plot.

</p>
</li>
<li><p><code>mcmc_violin(object, ...)</code>
The density estimate of each chain is plotted as a violin with
horizontal lines at notable quantiles.

</p>
</li>
<li><p><code>mcmc_dens_chains(object, ...)</code>
Ridgeline kernel density plots of posterior draws with chains separated
but overlaid on a single plot. In <code>mcmc_dens_overlay()</code> parameters
appear in separate facets; in <code>mcmc_dens_chains()</code> they appear in the
same panel and can overlap vertically.

</p>
</li>
<li><p><code>mcmc_intervals(object, ...)</code>
Plots of uncertainty intervals computed from posterior draws with all
chains merged.

</p>
</li>
<li><p><code>mcmc_areas(object, ...)</code>
Density plots computed from posterior draws with all chains merged,
with uncertainty intervals shown as shaded areas under the curves.

</p>
</li>
<li><p><code>mcmc_scatter(object, ...)</code>
Bivariate scatterplot of posterior draws. If using a very large number of
posterior draws then <code>mcmc_hex()</code> may be preferable to avoid
overplotting.

</p>
</li>
<li><p><code>mcmc_hex(object, ...)</code>
Hexagonal heatmap of 2-D bin counts. This plot is useful in cases where
the posterior sample size is large enough that <code>mcmc_scatter()</code> suffers
from overplotting.

</p>
</li>
<li><p><code>mcmc_pairs(object, ...)</code>
A square plot matrix with univariate marginal distributions along the
diagonal (as histograms or kernel density plots) and bivariate
distributions off the diagonal (as scatterplots or hex heatmaps).
</p>
<p>For the off-diagonal plots, the default is to split the chains so that
(roughly) half are displayed above the diagonal and half are below (all
chains are always merged together for the plots along the diagonal). Other
possibilities are available by setting the <code>condition</code> argument.

</p>
</li>
<li><p><code>mcmc_rhat(object, ...)</code>, <code>mcmc_rhat_hist(object, ...)</code>
Rhat values as either points or a histogram. Values are colored using
different shades (lighter is better). The chosen thresholds are somewhat
arbitrary, but can be useful guidelines in practice.
</p>

<ul>
<li> <p><em>light</em>: below 1.05 (good)
</p>
</li>
<li> <p><em>mid</em>: between 1.05 and 1.1 (ok)
</p>
</li>
<li> <p><em>dark</em>: above 1.1 (too high)
</p>
</li></ul>

<p><code>mcmc_neff(object, ...)</code>, <code>mcmc_neff_hist(object, ...)</code>
Ratios of effective sample size to total sample size as either points or a
histogram. Values are colored using different shades (lighter is better).
The chosen thresholds are somewhat arbitrary, but can be useful guidelines
in practice.
</p>
 <p><em>light</em>: between 0.5 and 1 (high)
</p>
 <p><em>mid</em>: between 0.1 and 0.5 (good)
</p>
 <p><em>dark</em>: below 0.1 (low)

</p>
<p><code>mcmc_acf(object, ...)</code>, <code>mcmc_acf_bar(object, ...)</code>
Grid of autocorrelation plots by chain and parameter. The <code>lags</code> argument
gives the maximum number of lags at which to calculate the autocorrelation
function. <code>mcmc_acf()</code> is a line plot whereas <code>mcmc_acf_bar()</code> is a
barplot.


</p>
</li></ul>



<h3>References</h3>

<p>Gabry, Jonah and Mahr, Tristan (2019).  <em>bayesplot:  Plotting for Bayesian Models</em>.  <a href="https://mc-stan.org/bayesplot/">https://mc-stan.org/bayesplot/</a>
</p>
<p>Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., and Gelman, A (2019).  <em>Visualization in Bayesian Workflow</em>.  Journal of the Royal Statistical Society: Series A. Vol 182.  Issue 2.  p.389-402.
</p>
<p>Gelman, A. and Rubin, D. (1992) <em>Inference from Iterative Simulation Using Multiple Sequences</em>.  Statistical Science 7(4) 457-472.
</p>
<p>Gelman, A., et. al. (2013) <em>Bayesian Data Analysis</em>.  Chapman and Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter=1000, chains = 1)
mcmc_trace(f)
</code></pre>

<hr>
<h2 id='mvcorrplot'>Multivariate response correlation plot for <code>bayesGAMfit</code> objects</h2><span id='topic+mvcorrplot'></span><span id='topic+mvcorrplot+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Creates a correlation plot of the multivariate responses based on <code>corrplot</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
mvcorrplot(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvcorrplot_+3A_object">object</code></td>
<td>
<p>model object of class <code>bayesGAMfit</code></p>
</td></tr>
<tr><td><code id="mvcorrplot_+3A_...">...</code></td>
<td>
<p>Additional parameters passed to <code>corrplot.mixed</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>corrplot</code> object
</p>


<h3>References</h3>

<p>Taiyun Wei and Viliam Simko (2017). R package <em>corrplot</em>: Visualization of a Correlation Matrix (Version 0.84).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
require(MASS)
sig &lt;- matrix(c(1, 0.5, 0.5, 1), ncol=2)
set.seed(123)
Y &lt;- mvrnorm(50, mu=c(-2, 2), Sigma=sig)
dat &lt;- data.frame(id = rep(1:5, each=10),
                  y1 = Y[, 1], 
                  y2 = Y[, 2])

f &lt;- bayesGAM(cbind(y1, y2) ~ 1, random = ~factor(id), 
              data=dat, 
              a = normal(c(0, 5)), 
              chains = 1, iter = 500)
mvcorrplot(f)

</code></pre>

<hr>
<h2 id='normal'>Constructor function for Normal priors</h2><span id='topic+normal'></span>

<h3>Description</h3>

<p>Used to specify Normal priors for <code>bayesGAM</code> models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal(param_values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal_+3A_param_values">param_values</code></td>
<td>
<p>Numeric vector of length 2 for the mean and standard deviation parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>beta</code> and <code>a</code> parameters, the distribution is assumed to be unconstrained.
For <code>eps</code> and <code>lambda</code>, the priors are half-normal with a support of strictly positive numbers.
</p>


<h3>References</h3>

<p>Stan Development Team. 2018. Stan Modeling Language Users Guide and Reference Manual, Version 2.18.0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
normal(c(0, 10))
</code></pre>

<hr>
<h2 id='np'>Creates design matrices for univariate and bivariate applications</h2><span id='topic+np'></span>

<h3>Description</h3>

<p><code>np</code> accepts one or two numeric vectors of equal length as inputs. From these inputs, univariate or bivariate smoothing design matrices are produced. Currently available basis functions are truncated polynomials and thin plate splines.
When bivariate smoothing is selected, <code>np</code> calls <code><a href="#topic+create_bivariate_design">create_bivariate_design</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>np(x1, x2 = NULL, num_knots = NULL, knots = NULL, basis = "tps", degree = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="np_+3A_x1">x1</code></td>
<td>
<p>numeric vector</p>
</td></tr>
<tr><td><code id="np_+3A_x2">x2</code></td>
<td>
<p>optional vector for bivariate non-parametric function</p>
</td></tr>
<tr><td><code id="np_+3A_num_knots">num_knots</code></td>
<td>
<p>optional number of knots</p>
</td></tr>
<tr><td><code id="np_+3A_knots">knots</code></td>
<td>
<p>optional numeric vector of knots</p>
</td></tr>
<tr><td><code id="np_+3A_basis">basis</code></td>
<td>
<p>character vector for basis function.  <code>tps</code> for thin-plate spline and <code>trunc.poly</code> for truncated polynomial</p>
</td></tr>
<tr><td><code id="np_+3A_degree">degree</code></td>
<td>
<p>for truncated polynomial basis function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with the following elements:
</p>

<ul>
<li> <p><code>X</code> parametric design matrix
</p>
</li>
<li> <p><code>Z</code> non-parametric design matrix
</p>
</li>
<li> <p><code>knots</code> numeric vector of knots for the model
</p>
</li>
<li> <p><code>Xnms</code> names of parameters passed to <code>np</code>
</p>
</li>
<li> <p><code>basis</code> selected basis function
</p>
</li>
<li> <p><code>degree</code> degree for truncated polynomial basis function
</p>
</li></ul>



<h3>References</h3>

<p>Ruppert, David, Matt P. Wand, and Raymond J. Carroll. <em>Semiparametric Regression</em>. No. 12. Cambridge university press, 2003. Section 5.6.
</p>
<p>Matt Wand (2018). SemiPar: Semiparametric Regression. R package version 1.0-4.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- rnorm(100)
res &lt;- np(x1, num_knots=10, basis="trunc.poly", degree=2)
res
</code></pre>

<hr>
<h2 id='plot'>Additional plotting for MCMC visualization and diagnostics.</h2><span id='topic+plot'></span><span id='topic+plot+2CbayesGAMfit+2Cmissing-method'></span><span id='topic+plot+2CpredictPlotObject+2Cmissing-method'></span><span id='topic+plot+2CposteriorPredictObject+2Cmissing-method'></span>

<h3>Description</h3>

<p>Marginal response smooth plot functions for parametric and nonparametric associations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit,missing'
plot(x, y, applylink = TRUE, ...)

## S4 method for signature 'predictPlotObject,missing'
plot(x, y, ...)

## S4 method for signature 'posteriorPredictObject,missing'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>an object of class <code>hmclearn</code>, usually a result of a call to <code>mh</code> or <code>hmc</code></p>
</td></tr>
<tr><td><code id="plot_+3A_y">y</code></td>
<td>
<p>unused</p>
</td></tr>
<tr><td><code id="plot_+3A_applylink">applylink</code></td>
<td>
<p>logical to indicate whether the inverse link function should be applied to the plots</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>optional additional arguments to pass to the <code>ggplot2</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of <em>univariate</em> and <em>bivariate</em> plots generated by plot functions based on <code>ggplot2</code>
</p>


<h3>References</h3>

<p>H. Wickham. <em>ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York, 2016.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcmc_plots">mcmc_plots</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter=500, chains = 1)
plot(f)

</code></pre>

<hr>
<h2 id='posterior_predict'>Posterior predictive samples from models fit by <code>bayesGAM</code></h2><span id='topic+posterior_predict'></span><span id='topic+posterior_predict+2CbayesGAMfit-method'></span><span id='topic+posterior_predict+2CglmModel-method'></span>

<h3>Description</h3>

<p>Draw from the posterior predictive distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_predict(object, ...)

## S4 method for signature 'bayesGAMfit'
posterior_predict(object, draws = NULL, ...)

## S4 method for signature 'glmModel'
posterior_predict(object, draws = NULL, results = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posterior_predict_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>postrior_predict</code></p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default and maximum number of draws is the size of the posterior sample.</p>
</td></tr>
<tr><td><code id="posterior_predict_+3A_results">results</code></td>
<td>
<p>Matrix of HMC posterior samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <em>D</em> by <em>N</em> matrices, where <em>D</em> is the number of draws from the posterior predictive distribution and <em>N</em> is the number of data points being predicted per draw.
</p>


<h3>References</h3>

<p>Goodrich B, Gabry J, Ali I &amp; Brilleman S. (2020). rstanarm: Bayesian applied regression modeling via Stan. R package version 2.19.3 https://mc-stan.org/rstanarm.
</p>
<p>Jonah Gabry, Ben Goodrich and Martin Lysy (2020). rstantools: Tools for Developing R Packages Interfacing with 'Stan'. https://mc-stan.org/rstantools/, https://discourse.mc-stan.org/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter=1000, chains = 1)
res &lt;- posterior_predict(f, draws=100)
</code></pre>

<hr>
<h2 id='ppc_plots'>Plotting for MCMC visualization and diagnostics provided by <code>bayesplot</code> package</h2><span id='topic+ppc_plots'></span><span id='topic+ppc_dens'></span><span id='topic+ppc_dens+2CbayesGAMfit-method'></span><span id='topic+ppc_dens+2CposteriorPredictObject-method'></span><span id='topic+ppc_dens_overlay'></span><span id='topic+ppc_dens_overlay+2CbayesGAMfit-method'></span><span id='topic+ppc_dens_overlay+2CposteriorPredictObject-method'></span><span id='topic+ppc_hist'></span><span id='topic+ppc_hist+2CbayesGAMfit-method'></span><span id='topic+ppc_hist+2CposteriorPredictObject-method'></span><span id='topic+ppc_boxplot'></span><span id='topic+ppc_boxplot+2CbayesGAMfit-method'></span><span id='topic+ppc_boxplot+2CposteriorPredictObject-method'></span><span id='topic+ppc_freqpoly'></span><span id='topic+ppc_freqpoly+2CbayesGAMfit-method'></span><span id='topic+ppc_freqpoly+2CposteriorPredictObject-method'></span><span id='topic+ppc_ecdf_overlay'></span><span id='topic+ppc_ecdf_overlay+2CbayesGAMfit-method'></span><span id='topic+ppc_ecdf_overlay+2CposteriorPredictObject-method'></span>

<h3>Description</h3>

<p>Plots of Rhat statistics, ratios of effective sample size to total sample
size, and autocorrelation of MCMC draws.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ppc_dens(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_dens(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_dens(object, ...)

ppc_dens_overlay(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_dens_overlay(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_dens_overlay(object, ...)

ppc_hist(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_hist(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_hist(object, ...)

ppc_boxplot(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_boxplot(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_boxplot(object, ...)

ppc_freqpoly(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_freqpoly(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_freqpoly(object, ...)

ppc_ecdf_overlay(object, ...)

## S4 method for signature 'bayesGAMfit'
ppc_ecdf_overlay(object, draws = NULL, ...)

## S4 method for signature 'posteriorPredictObject'
ppc_ecdf_overlay(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ppc_plots_+3A_object">object</code></td>
<td>
<p>an object of class <code>bayesGAMfit</code></p>
</td></tr>
<tr><td><code id="ppc_plots_+3A_...">...</code></td>
<td>
<p>optional additional arguments to pass to the <code>bayesplot</code> functions</p>
</td></tr>
<tr><td><code id="ppc_plots_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default and maximum number of draws is the size of the posterior sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>These functions call various plotting functions from the <code>bayesplot</code> package, which returns a list including <code>ggplot2</code> objects.
</p>


<h3>Plot Descriptions from the <code>bayesplot</code> package documentation</h3>


<ul>
<li><p><code>ppc_hist(object, draws=NULL, ...)</code>
A separate histogram estimate is displayed for y and each dataset (row) in yrep. For these plots yrep should therefore contain only a small number of rows.

</p>
</li>
<li><p><code>ppc_boxplot(object, draws=NULL, ...)</code>
A separate box and whiskers plot is displayed for y and each dataset (row) in yrep. For these plots yrep should therefore contain only a small number of rows.

</p>
</li>
<li><p><code>ppc_freqpoly(object, draws=NULL, ...)</code>
A separate shaded frequency polygon is displayed for y and each dataset (row) in yrep. For these plots yrep should therefore contain only a small number of rows.

</p>
</li>
<li><p><code>ppc_dens(object, draws=NULL, ...)</code>
A separate smoothed kernel density estimate is displayed for y and each dataset (row) in yrep. For these plots yrep should therefore contain only a small number of rows.

</p>
</li>
<li><p><code>ppc_dens_overlay(object, draws=NULL, ...)</code>
Kernel density estimates of each dataset (row) in <code>yrep</code> are overlaid, with the distribution of <code>y</code> itself on top (and in a darker shade).

</p>
</li>
<li><p><code>ppc_ecdf_overlay(object, draws=NULL, ...)</code>
Empirical CDF estimates of each dataset (row) in <code>yrep</code> are overlaid, with the distribution of <code>y</code> itself on top (and in a darker shade).

</p>
</li></ul>



<h3>References</h3>

<p>Gabry, Jonah and Mahr, Tristan (2019).  <em>bayesplot:  Plotting for Bayesian Models</em>.  <a href="https://mc-stan.org/bayesplot/">https://mc-stan.org/bayesplot/</a>
</p>
<p>Gabry, J., Simpson, D., Vehtari, A., Betancourt, M., and Gelman, A (2019).  <em>Visualization in Bayesian Workflow</em>.  Journal of the Royal Statistical Society: Series A. Vol 182.  Issue 2.  p.389-402.
</p>
<p>Gelman, A. and Rubin, D. (1992) <em>Inference from Iterative Simulation Using Multiple Sequences</em>.  Statistical Science 7(4) 457-472.
</p>
<p>Gelman, A., et. al. (2013) <em>Bayesian Data Analysis</em>.  Chapman and Hall/CRC.
</p>
<p>Gabry, J. , Simpson, D. , Vehtari, A. , Betancourt, M. and Gelman, A. (2019), Visualization in Bayesian workflow. J. R. Stat. Soc. A, 182: 389-402. doi:10.1111/rssa.12378.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter=500, chains = 1)
ppc_dens(f, draws=2)
</code></pre>

<hr>
<h2 id='predict'>Posterior predictive samples from models fit by <code>bayesGAM</code>, but with new data</h2><span id='topic+predict'></span><span id='topic+predict+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Draw from the posterior predictive distribution applied to new data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
predict(object, newdata, draws = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="predict_+3A_newdata">newdata</code></td>
<td>
<p>A data frame with new data applied to the <code>bayesGAMfit</code> object</p>
</td></tr>
<tr><td><code id="predict_+3A_draws">draws</code></td>
<td>
<p>An integer indicating the number of draws to return. The default and maximum number of draws is the size of the posterior sample.</p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>postrior_predict</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of <em>D</em> by <em>N</em> matrices, where <em>D</em> is the number of draws from the posterior predictive distribution and <em>N</em> is the number of data points being predicted per draw.
</p>


<h3>References</h3>

<p>Goodrich B, Gabry J, Ali I &amp; Brilleman S. (2020). rstanarm: Bayesian applied regression modeling via Stan. R package version 2.19.3 https://mc-stan.org/rstanarm.
</p>
<p>Jonah Gabry, Ben Goodrich and Martin Lysy (2020). rstantools: Tools for Developing R Packages Interfacing with 'Stan'. https://mc-stan.org/rstantools/, https://discourse.mc-stan.org/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(432)
f &lt;- bayesGAM(weight ~ np(height), data = women,
              family = gaussian, iter=500, chains = 1)
newheights &lt;- with(women, rnorm(10, mean = mean(height)), sd=sd(height))
women2 &lt;- data.frame(height=newheights)

pred &lt;- predict(f, women2, draws=100)
</code></pre>

<hr>
<h2 id='reef'>Coral reef data from survey data on 6 sites</h2><span id='topic+reef'></span>

<h3>Description</h3>

<p>Data from 68 subjects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reef
</code></pre>


<h3>Format</h3>

<p>A data frame with 269 rows and 14 variables:
</p>

<dl>
<dt>ZONE</dt><dd><p>Management zone</p>
</dd>
<dt>site</dt><dd><p>Name of the habitat site</p>
</dd>
<dt>complexity</dt><dd><p>habitat benthic complexity</p>
</dd>
<dt>rugosity</dt><dd><p>a measurement related to terrain complexity</p>
</dd>
<dt>LC</dt><dd><p>cover of low complexity</p>
</dd>
<dt>HC</dt><dd><p>cover of high complexity</p>
</dd>
<dt>SCORE1</dt><dd><p>PCA score 1 from Wilson, Graham, Polunin</p>
</dd>
<dt>SCORE2</dt><dd><p>PCA score 2 from Wilson, Graham, Polunin</p>
</dd>
<dt>macro</dt><dd><p>indicator of race white</p>
</dd>
<dt>species</dt><dd><p>fish species</p>
</dd>
<dt>abundance</dt><dd><p>fish abundance</p>
</dd>
<dt>biomass</dt><dd><p>fish biomass</p>
</dd>
</dl>



<h3>Source</h3>

<p>Data from supplementary material provided for Fisher, R., Wilson, S. K., Sin, T. M., Lee, A. C., and Langlois, T. J. (2018). <em>A simple function for full-subsets multiple regression in ecology with R</em>. Ecology and evolution, 8(12), 6104-6113.
</p>


<h3>References</h3>

<p>Wilson, S. K., Graham, N. A. J., and Polunin, N. V. (2007). <em>Appraisal of visual assessments of habitat complexity and benthic composition on coral reefs</em>. Marine Biology, 151(3), 1069-1076.
</p>

<hr>
<h2 id='showPrior'>Display the priors used in <code>bayesGAM</code></h2><span id='topic+showPrior'></span><span id='topic+showPrior+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>Prints a list of priors for <code class="reqn">\beta</code>, <code class="reqn">\lambda</code>, <code class="reqn">\epsilon</code>, and <code class="reqn">a</code>, where applicable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showPrior(object, ...)

## S4 method for signature 'bayesGAMfit'
showPrior(object, params = "all")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showPrior_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code></p>
</td></tr>
<tr><td><code id="showPrior_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>showPrior</code></p>
</td></tr>
<tr><td><code id="showPrior_+3A_params">params</code></td>
<td>
<p>character vector of the names of parameters to return
</p>

<ul>
<li> <p><code class="reqn">\beta</code> beta
</p>
</li>
<li> <p><code class="reqn">\epsilon</code> eps
</p>
</li>
<li> <p><code class="reqn">\lambda</code> lambda
</p>
</li>
<li> <p><code class="reqn">a] a</code>
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter = 500, chains = 1)
showPrior(f)
</code></pre>

<hr>
<h2 id='st'>Constructor function for Student-t priors</h2><span id='topic+st'></span>

<h3>Description</h3>

<p>Used to specify student-t priors for <code>bayesGAM</code> models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>st(param_values)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="st_+3A_param_values">param_values</code></td>
<td>
<p>Numeric vector of length 3 for the degrees of freedom, location, and scale parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the <code>beta</code> and <code>a</code> parameters, the distribution is assumed to be unconstrained.
For <code>eps</code> and <code>lambda</code>, the priors are half-normal with a support of strictly positive numbers.
</p>


<h3>References</h3>

<p>Stan Development Team. 2018. Stan Modeling Language Users Guide and Reference Manual, Version 2.18.0
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(stats); require(graphics)
st(c(3,0,1))
</code></pre>

<hr>
<h2 id='summary'>Summarizing Model Fits from <code>bayesGAM</code></h2><span id='topic+summary'></span><span id='topic+summary+2CbayesGAMfit-method'></span>

<h3>Description</h3>

<p>summary method for class <code>bayesGAMfit</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'bayesGAMfit'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>an object of class <code>hmclearn</code>, usually a result of a call to <code>mh</code> or <code>hmc</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with posterior quantiles and the posterior scale reduction factor statistic for each parameter.
</p>


<h3>References</h3>

<p>Stan Development Team (2020). RStan: the R interface to Stan. R package version 2.21.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women, 
              family = gaussian, iter=500, chains = 1)

summary(f)
</code></pre>

<hr>
<h2 id='waic_bgam'>Calls the <code>loo</code> package to calculate the widely applicable information criterion (WAIC)</h2><span id='topic+waic_bgam'></span><span id='topic+waic_bgam+2CbayesGAMfit-method'></span><span id='topic+waic_bgam+2Carray-method'></span>

<h3>Description</h3>

<p>Computes WAIC by calling the appropriate function from the <code>loo</code> package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>waic_bgam(object, ...)

## S4 method for signature 'bayesGAMfit'
waic_bgam(object, ...)

## S4 method for signature 'array'
waic_bgam(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="waic_bgam_+3A_object">object</code></td>
<td>
<p>Object of type <code>bayesGAMfit</code> generated from <code>bayesGAM</code>.</p>
</td></tr>
<tr><td><code id="waic_bgam_+3A_...">...</code></td>
<td>
<p>Additional parameters to pass to pass to <code>loo::waic</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named list of class <code>c("waic", "loo")</code>
</p>

<dl>
<dt><code>estimates</code></dt><dd>
<p>A matrix with two columns (<code>"Estimate"</code>, <code>"SE"</code>) and three
rows (<code>"elpd_waic"</code>, <code>"p_waic"</code>, <code>"waic"</code>). This contains
point estimates and standard errors of the expected log pointwise predictive
density (<code>elpd_waic</code>), the effective number of parameters
(<code>p_waic</code>) and the information criterion <code>waic</code> (which is just
<code>-2 * elpd_waic</code>, i.e., converted to deviance scale).
</p>
</dd>
<dt><code>pointwise</code></dt><dd>
<p>A matrix with three columns (and number of rows equal to the number of
observations) containing the pointwise contributions of each of the above
measures (<code>elpd_waic</code>, <code>p_waic</code>, <code>waic</code>).
</p>
</dd>
</dl>



<h3>References</h3>

<p>Watanabe, S. (2010). Asymptotic equivalence of Bayes cross validation and widely application information criterion in singular learning theory. Journal of Machine Learning Research 11, 3571-3594.
</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017a). Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC. Statistics and Computing. 27(5), 1413–1432. doi:10.1007/s11222-016-9696-4 (journal version, preprint arXiv:1507.04544).
</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017b). Pareto smoothed importance sampling. preprint arXiv:1507.02646
</p>
<p>Vehtari A, Gabry J, Magnusson M, Yao Y, Gelman A (2019). “loo: Efficient leave-one-out cross-validation and WAIC for Bayesian models.” R package version 2.2.0, &lt;URL: https://mc-stan.org/loo&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- bayesGAM(weight ~ np(height), data = women,
              family = gaussian, iter=500, chains = 1)
waic_bgam(f)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
