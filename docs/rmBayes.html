<!DOCTYPE html><html><head><title>Help for package rmBayes</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rmBayes}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rmBayes-package'><p>The 'rmBayes' package.</p></a></li>
<li><a href='#recall.long'><p>The Repeated-Measures Data: Long Data Format</p></a></li>
<li><a href='#recall.wide'><p>The Repeated-Measures Data: Wide Data Format</p></a></li>
<li><a href='#rmHDI'><p>Bayesian Interval Estimation for Repeated-Measures Designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Performing Bayesian Inference for Repeated-Measures Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.16</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-19</td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian credible interval is interpreted with respect to posterior probability, 
    and this interpretation is far more intuitive than that of a frequentist confidence interval. 
    However, standard highest-density intervals can be wide due to between-subjects variability and tends 
    to hide within-subject effects, rendering its relationship with the Bayes factor less clear 
    in within-subject (repeated-measures) designs. 
    This urgent issue can be addressed by using within-subject intervals in within-subject designs, 
    which integrate four methods including the Wei-Nathoo-Masson (2023) &lt;<a href="https://doi.org/10.3758%2Fs13423-023-02295-1">doi:10.3758/s13423-023-02295-1</a>&gt;, 
    the Loftus-Masson (1994) &lt;<a href="https://doi.org/10.3758%2FBF03210951">doi:10.3758/BF03210951</a>&gt;, 
    the Nathoo-Kilshaw-Masson (2018) &lt;<a href="https://doi.org/10.1016%2Fj.jmp.2018.07.005">doi:10.1016/j.jmp.2018.07.005</a>&gt;, 
    and the Heck (2019) &lt;<a href="https://doi.org/10.31234%2Fosf.io%2Fwhp8t">doi:10.31234/osf.io/whp8t</a>&gt; interval estimates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 0.12.0), RcppParallel, rstan (&ge; 2.26.0),
rstantools (&ge; 2.1.1), stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel, rstan (&ge; 2.26.0), StanHeaders (&ge; 2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhengxiaoUVic/rmBayes">https://github.com/zhengxiaoUVic/rmBayes</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhengxiaoUVic/rmBayes/issues">https://github.com/zhengxiaoUVic/rmBayes/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, testthat, rmarkdown, covr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-19 09:10:51 UTC; sherloconan</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhengxiao Wei <a href="https://orcid.org/0000-0003-1866-2320"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Farouk S. Nathoo <a href="https://orcid.org/0000-0002-2569-3507"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Michael E. J. Masson
    <a href="https://orcid.org/0000-0002-5430-6078"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhengxiao Wei &lt;zhengxiao@uvic.ca&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-19 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='rmBayes-package'>The 'rmBayes' package.</h2><span id='topic+rmBayes'></span><span id='topic+rmBayes-package'></span>

<h3>Description</h3>

<p>Performing Bayesian Inference for Repeated-Measures Designs
</p>
<p>A Bayesian credible interval is interpreted with respect to posterior probability,
and this interpretation is far more intuitive than that of a frequentist confidence interval.
However, standard highest-density intervals can be wide due to between-subjects variability and tends
to hide within-subject effects, rendering its relationship with the Bayes factor less clear
in within-subject (repeated-measures) designs.
This urgent issue can be addressed by using within-subject intervals in within-subject designs,
which integrate four methods including the Wei-Nathoo-Masson (2023) <a href="doi:10.3758/s13423-023-02295-1">doi:10.3758/s13423-023-02295-1</a>,
the Loftus-Masson (1994) <a href="doi:10.3758/BF03210951">doi:10.3758/BF03210951</a>,
the Nathoo-Kilshaw-Masson (2018) <a href="doi:10.1016/j.jmp.2018.07.005">doi:10.1016/j.jmp.2018.07.005</a>,
and the Heck (2019) <a href="doi:10.31234/osf.io/whp8t">doi:10.31234/osf.io/whp8t</a> interval estimates.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Zhengxiao Wei <a href="mailto:zhengxiao@uvic.ca">zhengxiao@uvic.ca</a> (<a href="https://orcid.org/0000-0003-1866-2320">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Farouk S. Nathoo <a href="mailto:nathoo@uvic.ca">nathoo@uvic.ca</a> (<a href="https://orcid.org/0000-0002-2569-3507">ORCID</a>)
</p>
</li>
<li><p> Michael E. J. Masson <a href="mailto:mmasson@uvic.ca">mmasson@uvic.ca</a> (<a href="https://orcid.org/0000-0002-5430-6078">ORCID</a>)
</p>
</li></ul>



<h3>References</h3>

<p>Heck, D. W. (2019). Accounting for estimation uncertainty and shrinkage in Bayesian within-subject intervals: A comment on Nathoo, Kilshaw, and Masson (2018). Journal of Mathematical Psychology, 88, 27–31.
</p>
<p>Loftus, G. R., &amp; Masson, M. E. J. (1994). Using confidence intervals in within-subject designs. Psychonomic Bulletin &amp; Review, 1, 476–490.
</p>
<p>Nathoo, F. S., Kilshaw, R. E., &amp; Masson, M. E. J. (2018). A better (Bayesian) interval estimate for within-subject designs. Journal of Mathematical Psychology, 86, 1–9.
</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., &amp; Province, J. M. (2012). Default Bayes factors for ANOVA designs. Journal of Mathematical Psychology, 56, 356–374.
</p>
<p>Stan Development Team (2024). RStan: the R interface to Stan. R package version 2.32.5 https://mc-stan.org
</p>
<p>Wei, Z., Nathoo, F. S., &amp; Masson, M. E. J. (2023). Investigating the relationship between the Bayes factor and the separation of credible intervals. Psychonomic Bulletin &amp; Review, 30, 1759–1781.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/zhengxiaoUVic/rmBayes">https://github.com/zhengxiaoUVic/rmBayes</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/zhengxiaoUVic/rmBayes/issues">https://github.com/zhengxiaoUVic/rmBayes/issues</a>
</p>
</li></ul>


<hr>
<h2 id='recall.long'>The Repeated-Measures Data: Long Data Format</h2><span id='topic+recall.long'></span>

<h3>Description</h3>

<p>A data frame that is in the long format. A hypothetical experiment is designed to
measure effects of study time in a free-recall paradigm. In this hypothetical experiment,
to-be-recalled 20-word lists are presented at a rate of 1, 2, or 5 sec per word.
Of interest is the relation between study time and number of recalled list words.
Suppose that the experiment is run as a within-subject (repeated-measures) design,
including a total of 10 subjects, each of whom participated in all three study-time conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recall.long
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 rows and 3 variables:
</p>

<dl>
<dt>Subject</dt><dd><p>The factor containing 10 levels of subjects, <code>"s1"</code> to <code>"s10"</code>.</p>
</dd>
<dt>Level</dt><dd><p>The factor containing three levels of the experimental manipulation, <code>"Level1"</code>, <code>"Level2"</code>, and <code>"Level3"</code>.</p>
</dd>
<dt>Response</dt><dd><p>The number of words recalled out of 20 for each of 10 subjects in each of three conditions.</p>
</dd>
</dl>



<h3>References</h3>

<p>Loftus, G. R., &amp; Masson, M. E. J. (1994). Using confidence intervals in within-subject designs. Psychonomic Bulletin &amp; Review, 1, 476–490.
</p>

<hr>
<h2 id='recall.wide'>The Repeated-Measures Data: Wide Data Format</h2><span id='topic+recall.wide'></span>

<h3>Description</h3>

<p>A data frame that is in the wide format. A hypothetical experiment is designed to
measure effects of study time in a free-recall paradigm. In this hypothetical experiment,
to-be-recalled 20-word lists are presented at a rate of 1, 2, or 5 sec per word.
Of interest is the relation between study time and number of recalled list words.
Suppose that the experiment is run as a within-subject (repeated-measures) design,
including a total of 10 subjects, each of whom participated in all three study-time conditions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recall.wide
</code></pre>


<h3>Format</h3>

<p>A data frame with 10 rows (each row corresponds to a subject) and 3 variables:
</p>

<dl>
<dt>Level1</dt><dd><p>The number of words recalled under the first level of the experimental manipulation - 1 second exposure duration per word.</p>
</dd>
<dt>Level2</dt><dd><p>The number of words recalled under the second level of the experimental manipulation - 2 seconds exposure duration per word.</p>
</dd>
<dt>Level3</dt><dd><p>The number of words recalled under the third level of the experimental manipulation - 5 seconds exposure duration per word.</p>
</dd>
</dl>



<h3>References</h3>

<p>Loftus, G. R., &amp; Masson, M. E. J. (1994). Using confidence intervals in within-subject designs. Psychonomic Bulletin &amp; Review, 1, 476–490.
</p>

<hr>
<h2 id='rmHDI'>Bayesian Interval Estimation for Repeated-Measures Designs</h2><span id='topic+rmHDI'></span>

<h3>Description</h3>

<p>For both the homoscedastic and heteroscedastic cases in one-way within-subject (repeated-measures) designs,
this function provides multiple methods to construct the credible intervals for condition means, with each method based on different sets of priors.
The emphasis is on the calculation of intervals that remove the between-subjects variability that is a nuisance in within-subject designs, as
proposed in Loftus and Masson (1994), the Bayesian analog proposed in Nathoo, Kilshaw, and Masson (2018), and the adaptation presented in Heck (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmHDI(
  data = NULL,
  whichSubject = "Subject",
  whichLevel = "Level",
  whichResponse = "Response",
  data.wide = NULL,
  cred = 0.95,
  warmup = 200,
  iter = 2000,
  chains = 4,
  method = 1,
  var.equal = TRUE,
  design = c("within", "between"),
  treat = c("random", "fixed"),
  ht = ifelse(match.arg(treat) == "fixed", 0.5, 1),
  hb = 1,
  seed = sample.int(.Machine$integer.max, 1),
  diagnostics = FALSE,
  permuted = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmHDI_+3A_data">data</code></td>
<td>
<p>A long format matrix or data frame of the within-subject data whose three columns are labeled in <code>whichSubject</code>, <code>whichLevel</code>, and <code>whichResponse</code> (see Examples).</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_whichsubject">whichSubject</code></td>
<td>
<p>A character string specifying the column name of subject variable in the long format data.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_whichlevel">whichLevel</code></td>
<td>
<p>A character string specifying the column name of level variable in the long format data.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_whichresponse">whichResponse</code></td>
<td>
<p>A character string specifying the column name of response variable in the long format data.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_data.wide">data.wide</code></td>
<td>
<p>Alternatively, a wide format matrix or data frame of the within-subject data whose column indices are condition levels (see Examples).
If both <code>data</code> and <code>data.wide</code> are specified, the credible intervals are only computed for <code>data</code>.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_cred">cred</code></td>
<td>
<p>A scalar <code>[0,1]</code> specifying the credibility level of the credible interval. The default is .95.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying the number of warmup (burnin) iterations per chain. The default is 200.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_iter">iter</code></td>
<td>
<p>A positive integer specifying the number of iterations for each chain (excluding warmup). The default is 2000.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_chains">chains</code></td>
<td>
<p>A positive integer specifying the number of Markov chains. The default is 4.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_method">method</code></td>
<td>
<p>A positive integer in <code>0:6</code> specifying which method is used to construct within-subject HDIs (see Details).
<code>method=0</code> implements the approach developed by Nathoo et al. (2018).
<code>method=4</code> implements the approach by Heck (2019).
<code>method=5</code> implements the approach by Heck (2019), but using the standard uniform prior distribution for the standard deviation of subject-specific random effects.
<code>method=6</code> implements the approach by Heck (2019), but using the standard half-Cauchy prior distribution for the standard deviation of subject-specific random effects.
<code>method=1</code> (default) implements the approach by Heck (2019), but using the Jeffreys prior for the overall mean rather than the condition means;
the hierarchical specification regarding the <code class="reqn">g</code>-prior for the standardized subject-specific random effects is discussed in Rouder et al. (2012, p. 361-362).
With the Jeffreys prior for the overall mean and residual variance,
<code>method=2</code> uses the standard uniform prior, and <code>method=3</code> uses the standard half-Cauchy prior for the standard deviation of random effects.
For the computation of the standard HDI, see the <code>design</code> argument below.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_var.equal">var.equal</code></td>
<td>
<p>A logical variable indicating whether to treat the variance of the response within each condition (level of the experimental manipulation) as being equal.
If <code>TRUE</code> (default), the homogeneity of variance holds, and a common variance across conditions is assumed.
Otherwise, <code>FALSE</code> will generate unequal interval widths for conditions.
Two approaches are currently provided for the heteroscedastic within-subject data: <code>method=0</code> implements the approach developed by Nathoo et al. (2018, p. 5);
<code>method=1</code> (default method if <code>var.equal=FALSE</code>) implements the heteroscedastic standard HDI method on the subject-centering transformed data.
If a <code>method</code> option other than <code>0</code> or <code>1</code> is used with <code>var.equal=FALSE</code>,
a pooled estimate of variability will be used just as in the homoscedastic case, and a warning message will be returned.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_design">design</code></td>
<td>
<p>A character string specifying the experimental design.
If <code>"within"</code> (default), construct the within-subject HDIs based on the given <code>method</code> in <code>0:6</code>.
If <code>"between"</code>, construct the standard HDIs using the priors in <code>method=1</code> (but not removing the between-subjects variability).</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_treat">treat</code></td>
<td>
<p>A character string specifying the type of condition effects when <code>method</code> in <code>1:3</code>.
If <code>"fixed"</code>, treat the condition effects as fixed effects through the reduced parametrization proposed by Rouder et al. (2012, p. 363).
If <code>"random"</code> (default), treat the condition effects as random effects.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_ht">ht</code></td>
<td>
<p>A positive real number specifying the prior scale on the variability of standardized condition effects when <code>method=1</code> (see Details). The default is 0.5 when <code>treat="fixed"</code> and 1 when <code>treat="random"</code>.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_hb">hb</code></td>
<td>
<p>A positive real number specifying the prior scale on the variability of standardized subject-specific random effects when <code>method=1</code> or <code>method=4</code> (see Details). The default is 1.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_seed">seed</code></td>
<td>
<p>The seed for random number generation.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_diagnostics">diagnostics</code></td>
<td>
<p>A logical variable indicating whether to return the MCMC summary statistics
when <code>method</code> in <code>1:6</code>.
If <code>FALSE</code> (default), the function returns the HDI result (see Value).
If <code>TRUE</code>, the function returns an additional object of S4 class representing the fitted results for assessing the MCMC convergence.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_permuted">permuted</code></td>
<td>
<p>A logical variable indicating whether to pre-process the input data.
No matter whether the input is long data or wide data, the function eventually converts it to wide data for calculation.
If <code>TRUE</code> (default), the converted wide-format data are first ordered by their column names in alphabetic order.
Then, the data are placed in ascending order by the first and second columns.
If <code>FALSE</code>, the data are not ordered, and the returned HDI results are sensitive to data permutation.
In other words, the row permutation (e.g., switching the first and second rows)
and the column permutation (e.g., switching the first and second columns) will result in slightly different HDI estimates even if <code>seed</code> is set to be the same.</p>
</td></tr>
<tr><td><code id="rmHDI_+3A_...">...</code></td>
<td>
<p>Additional arguments that pass to <code><a href="rstan.html#topic+sampling">sampling</a></code>,
such as <code>thin</code>, <code>algorithm</code>, <code>cores</code>, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wei, Nathoo, and Masson (2023) consider three credible intervals:
(1) the within-subject Bayesian interval developed by Nathoo et al. (2018),
whose derivation conditions on estimated random effects,
(2) a modification of (1) based on a proposal by Heck (2019) to allow for shrinkage and account for estimation uncertainty,
and (3) an alternative to option (2) based on the default priors used in Rouder, Morey, Speckman, and Province (2012).
Markov chain Monte Carlo sampling is also used to obtain the standard highest-density interval (HDI)
for each condition mean in a one-way between-subjects design.
</p>
<p>When the homogeneity of variance holds,
a linear mixed-effects model <code class="reqn">M_1</code> for the mean response in a one-way within-subject design is
</p>
<p style="text-align: center;"><code class="reqn">M_1: Y_{ij} = \mu + \sigma_\epsilon (t_i + b_j) + \epsilon_{ij}  versus  M_0: Y_{ij} = \mu + \sigma_\epsilon b_j + \epsilon_{ij},  \epsilon_{ij} ~ N(0, \sigma_\epsilon^2),  i=1,\ldots,a; j=1,\ldots,n,</code>
</p>

<p>where <code class="reqn">Y_ij</code> represents the mean response for the <code class="reqn">j</code>-th
subject under the <code class="reqn">i</code>-th level of the experimental manipulation;
<code class="reqn">\mu</code> is the overall mean, <code class="reqn">\tau_i = \sigma_\epsilon t_i</code> is the <code class="reqn">i</code>-th level of the experimental manipulation;
<code class="reqn">\mu_i = \mu + \tau_i</code>, for the means model, is the <code class="reqn">i</code>-th condition mean;
<code class="reqn">b_j</code> is the standardized subject-specific random effects;
<code class="reqn">a</code> is the number of levels; <code class="reqn">n</code> is the number of subjects;
<code class="reqn">\epsilon_{ij}</code> are independent and identically distributed.
The effects <code class="reqn">t_i</code> and <code class="reqn">b_j</code> are both standardized relative to the standard deviation of the error <code class="reqn">\sigma_\epsilon</code> and become dimensionless (Rouder et al., 2012).
</p>
<p>An assumption articulated in <code>method=0</code> is the Jeffreys prior for the condition means <code class="reqn">\mu_i</code> and residual variance <code class="reqn">\sigma_\epsilon^2</code> (Nathoo et al., 2018).
</p>
<p>Priors used in <code>method=1</code> are the Jeffreys prior for the overall mean <code class="reqn">\mu</code> and residual variance,
a <code class="reqn">g</code>-prior structure for standardized effects (<code class="reqn">t_i ~ N(0, g_t)</code>, <code class="reqn">b_j ~ N(0, g_b)</code>),
and independent scaled inverse-chi-square priors with one degree of freedom for
the scale hyperparameters of the <code class="reqn">g</code>-priors (<code class="reqn">g_t ~ Scale-inv-\chi^2(1, h_t^2)</code>, <code class="reqn">g_b ~ Scale-inv-\chi^2(1, h_b^2)</code>).
</p>
<p>Priors used in <code>method=2</code> are the Jeffreys prior for the overall mean and residual variance,
a normal distribution for (not standardized) effects (<code class="reqn">\sigma_\epsilon t_i ~ N(0, g_t)</code>, <code class="reqn">\sigma_\epsilon b_j ~ N(0, g_b)</code>),
and the standard uniform distribution for
the square root of <code class="reqn">g</code> parameter (<code class="reqn">sqrt(g_t) ~ Unif(0, 1)</code>, <code class="reqn">sqrt(g_b) ~ Unif(0, 1)</code>).
</p>
<p>Priors used in <code>method=3</code> are the Jeffreys prior for the overall mean and residual variance,
a normal distribution for (not standardized) effects,
and the standard half-Cauchy distribution for the square root of <code class="reqn">g</code> parameter
(<code class="reqn">sqrt(g_t) ~ Half-Cauchy(0, 1)</code>, <code class="reqn">sqrt(g_b) ~ Half-Cauchy(0, 1)</code>).
</p>
<p>Priors used in <code>method=4</code> are the Jeffreys prior for the condition means and residual variance,
a <code class="reqn">g</code>-prior structure for standardized subject-specific random effects, and independent scaled inverse-chi-square priors with one degree of freedom for the scale hyperparameters of the <code class="reqn">g</code>-priors (Heck, 2019).
</p>
<p>Priors used in <code>method=5</code> are the Jeffreys prior for the condition means and residual variance,
a normal distribution for (not standardized) subject-specific random effects, and the standard uniform distribution for the square root of <code class="reqn">g</code> parameter.
</p>
<p>Priors used in <code>method=6</code> are the Jeffreys prior for the condition means and residual variance,
a normal distribution for (not standardized) subject-specific random effects, and the standard half-Cauchy distribution for the square root of <code class="reqn">g</code> parameter.
</p>


<h3>Value</h3>

<p>A <code>list</code> with three components, if <code>diagnostics=FALSE</code>:
</p>
<table>
<tr><td><code>HDI</code></td>
<td>
<p>A matrix of HDI lower and upper bounds, whose row names are the condition levels.</p>
</td></tr>
<tr><td><code>posterior means</code></td>
<td>
<p>The posterior condition means when using <code>method</code> in <code>1:6</code>.</p>
</td></tr>
<tr><td><code>arithmetic means</code></td>
<td>
<p>Or, the arithmetic condition means when using <code>method=0</code>.</p>
</td></tr>
<tr><td><code>width</code></td>
<td>
<p>The HDI width, which is the half-length from the lower bound to the upper bound.</p>
</td></tr>
</table>
<p>A <code>list</code> with four components including an additional object of S4 class representing the fitted results, if <code>diagnostics=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Zhengxiao Wei (<a href="mailto:zhengxiao@uvic.ca">zhengxiao@uvic.ca</a>),
Farouk S. Nathoo (<a href="mailto:nathoo@uvic.ca">nathoo@uvic.ca</a>),
Michael E. J. Masson (<a href="mailto:mmasson@uvic.ca">mmasson@uvic.ca</a>).
</p>


<h3>References</h3>

<p>Heck, D. W. (2019). Accounting for estimation uncertainty and shrinkage in Bayesian within-subject intervals: A comment on Nathoo, Kilshaw, and Masson (2018). Journal of Mathematical Psychology, 88, 27–31.
</p>
<p>Loftus, G. R., &amp; Masson, M. E. J. (1994). Using confidence intervals in within-subject designs. Psychonomic Bulletin &amp; Review, 1, 476–490.
</p>
<p>Nathoo, F. S., Kilshaw, R. E., &amp; Masson, M. E. J. (2018). A better (Bayesian) interval estimate for within-subject designs. Journal of Mathematical Psychology, 86, 1–9.
</p>
<p>Rouder, J. N., Morey, R. D., Speckman, P. L., &amp; Province, J. M. (2012). Default Bayes factors for ANOVA designs. Journal of Mathematical Psychology, 56, 356–374.
</p>
<p>Stan Development Team (2024). RStan: the R interface to Stan. R package version 2.32.5 https://mc-stan.org
</p>
<p>Wei, Z., Nathoo, F. S., &amp; Masson, M. E. J. (2023). Investigating the relationship between the Bayes factor and the separation of credible intervals. Psychonomic Bulletin &amp; Review, 30, 1759–1781.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(recall.wide) # Example data, wide format
rmHDI(data.wide = recall.wide, seed = 277)

data(recall.long) # Example data, long format
rmHDI(recall.long, seed = 277)

colnames(recall.long) &lt;- c("Participant", "Condition", "DV")
rmHDI(recall.long, whichSubject = "Participant",
whichLevel = "Condition", whichResponse = "DV", seed = 277)


## Nathoo et al. (2018) approach
data(recall.long)
rmHDI(recall.long, method = 0)
rmHDI(recall.long, method = 0, var.equal = FALSE)


## Standard HDI
rmHDI(recall.long, design = "between", seed = 277)

## MCMC diagnostics
rmHDI(recall.long, seed = 277, diagnostics = TRUE)$diagnostics

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
