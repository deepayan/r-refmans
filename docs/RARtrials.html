<!DOCTYPE html><html><head><title>Help for package RARtrials</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RARtrials}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RARtrials-package'><p>RARtrials: Response-Adaptive Randomization in Clinical Trials</p></a></li>
<li><a href='#brar_select_au_binary'><p>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Binary Endpoint</p></a></li>
<li><a href='#brar_select_au_known_var'><p>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#brar_select_au_unknown_var'><p>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#convert_chisq_to_gamma'><p>Convert parameters from a Normal-Inverse-Chi-Squared Distribution to a</p>
Normal-Inverse-Gamma Distribution</a></li>
<li><a href='#convert_gamma_to_chisq'><p>Convert parameters from a Normal-Inverse-Gamma Distribution to a</p>
Normal-Inverse-Chi-Squared Distribution</a></li>
<li><a href='#dabcd_max_power'><p>Allocation Probabilities Using Doubly Adaptive Biased Coin Design with Maximal Power Strategy for Binary Endpoint</p></a></li>
<li><a href='#dabcd_min_var'><p>Allocation Probabilities Using Doubly Adaptive Biased Coin Design with Minimal Variance Strategy for Binary Endpoint</p></a></li>
<li><a href='#flgi_cut_off_binary'><p>Cut-off Value of the Forward-looking Gittins Index Rule in Binary Endpoint</p></a></li>
<li><a href='#flgi_cut_off_known_var'><p>Cut-off Value of the Forward-looking Gittins Index Rule in Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#flgi_cut_off_unknown_var'><p>Cut-off Value of the Forward-looking Gittins Index rule in Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#Gittins'><p>Gittins Indices</p></a></li>
<li><a href='#pgreater_beta'><p>Calculate the Futility Stopping Probability for Binary Endpoint with Beta Distribution</p></a></li>
<li><a href='#pgreater_NIX'><p>Calculate the Futility Stopping Probability for Continuous Endpoint with Unknown Variances Using a Normal-Inverse-Chi-Squared Distribution</p></a></li>
<li><a href='#pgreater_normal'><p>Calculate the Futility Stopping Probability for Continuous Endpoint with Known Variances Using Normal Distribution</p></a></li>
<li><a href='#pmax_beta'><p>Posterior Probability that a Particular Arm is the Best for Binary Endpoint</p></a></li>
<li><a href='#pmax_NIX'><p>Posterior Probability that a Particular Arm is the Best for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#pmax_normal'><p>Posterior Probability that a Particular Arm is the Best for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_A_optimal_known_var'><p>Simulate a Trial Using A-Optimal Allocation for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_A_optimal_unknown_var'><p>Simulate a Trial Using A-Optimal Allocation for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#sim_Aa_optimal_known_var'><p>Simulate a Trial Using Aa-Optimal Allocation for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_Aa_optimal_unknown_var'><p>Simulate a Trial Using Aa-Optimal Allocation for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#sim_brar_binary'><p>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Binary Outcomes</p></a></li>
<li><a href='#sim_brar_known_var'><p>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_brar_unknown_var'><p>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#sim_dabcd_max_power'><p>Simulate a Trial Using Doubly Adaptive Biased Coin Design with Maximal Power Strategy for Binary Endpoint</p></a></li>
<li><a href='#sim_dabcd_min_var'><p>Simulate a Trial Using Doubly Adaptive Biased Coin Design with Minmial Variance Strategy for Binary Endpoint</p></a></li>
<li><a href='#sim_flgi_binary'><p>Simulate a Trial Using Forward-Looking Gittins Index for Binary Endpoint</p></a></li>
<li><a href='#sim_flgi_known_var'><p>Simulate a Trial Using Forward-Looking Gittins Index for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_flgi_unknown_var'><p>Simulate a Trial Using Forward-Looking Gittins Index for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#sim_RPTW'><p>Simulate a Trial Using Randomized Play-the-Winner Rule for Binary Endpoint</p></a></li>
<li><a href='#sim_RSIHR_optimal_known_var'><p>Simulate a Trial Using Generalized RSIHR Allocation for Continuous Endpoint with Known Variances</p></a></li>
<li><a href='#sim_RSIHR_optimal_unknown_var'><p>Simulate a Trial Using Generalized RSIHR Allocation for Continuous Endpoint with Unknown Variances</p></a></li>
<li><a href='#update_par_nichisq'><p>Update Parameters of a Normal-Inverse-Chi-Squared Distribution with Available Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Response-Adaptive Randomization in Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chuyao Xu  &lt;cxu870@aucklanduni.ac.nz&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Some response-adaptive randomization methods commonly found in literature are included in this package. These methods include the randomized play-the-winner rule for binary endpoint (Wei and Durham (1978) &lt;<a href="https://doi.org/10.2307%2F2286290">doi:10.2307/2286290</a>&gt;), the doubly adaptive biased coin design with minimal variance strategy for binary endpoint (Atkinson and Biswas (2013) &lt;<a href="https://doi.org/10.1201%2Fb16101">doi:10.1201/b16101</a>&gt;, Rosenberger and Lachin (2015) &lt;<a href="https://doi.org/10.1002%2F9781118742112">doi:10.1002/9781118742112</a>&gt;) and maximal power strategy targeting Neyman allocation for binary endpoint (Tymofyeyev, Rosenberger, and Hu (2007) &lt;<a href="https://doi.org/10.1198%2F016214506000000906">doi:10.1198/016214506000000906</a>&gt;) and RSIHR allocation with each letter representing the first character of the names of the individuals who first proposed this rule (Youngsook and Hu (2010) &lt;<a href="https://doi.org/10.1198%2Fsbr.2009.0056">doi:10.1198/sbr.2009.0056</a>&gt;, Bello and Sabo (2016) &lt;<a href="https://doi.org/10.1080%2F00949655.2015.1114116">doi:10.1080/00949655.2015.1114116</a>&gt;), A-optimal Allocation for continuous endpoint (Sverdlov and Rosenberger (2013) &lt;<a href="https://doi.org/10.1080%2F15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>&gt;), Aa-optimal Allocation for continuous endpoint (Sverdlov and Rosenberger (2013) &lt;<a href="https://doi.org/10.1080%2F15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>&gt;), generalized RSIHR allocation for continuous endpoint (Atkinson and Biswas (2013) &lt;<a href="https://doi.org/10.1201%2Fb16101">doi:10.1201/b16101</a>&gt;), Bayesian response-adaptive randomization with a control group using the Thall \&amp; Wathen method for binary and continuous endpoints (Thall and Wathen (2007) &lt;<a href="https://doi.org/10.1016%2Fj.ejca.2007.01.006">doi:10.1016/j.ejca.2007.01.006</a>&gt;) and the forward-looking Gittins index rule for binary and continuous endpoints (Villar, Wason, and Bowden (2015) &lt;<a href="https://doi.org/10.1111%2Fbiom.12337">doi:10.1111/biom.12337</a>&gt;, Williamson and Villar (2019) &lt;<a href="https://doi.org/10.1111%2Fbiom.13119">doi:10.1111/biom.13119</a>&gt;).</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Collate:</td>
<td>'brar_select_au_binary.r' 'brar_select_au_known_var.r'
'brar_select_au_unknown_var.r' 'convert_gamma_to_chisq.r'
'convert_chisq_to_gamma.r' 'update_par_nichisq.r'
'pgreater_beta.r' 'pgreater_normal.r' 'pgreater_NIX.r'
'pmax_beta.r' 'pmax_normal.r' 'pmax_NIX.r' 'sim_brar_binary.r'
'sim_brar_known_var.r' 'sim_brar_unknown_var.r'
'flgi_cut_off_binary.r' 'flgi_cut_off_known_var.r'
'flgi_cut_off_unknown_var.r' 'Gittins.r' 'sim_flgi_binary.r'
'sim_flgi_known_var.r' 'sim_flgi_unknown_var.r'
'dabcd_max_power.r' 'dabcd_min_var.r' 'sim_RPTW.r'
'sim_A_optimal_known_var.r' 'sim_A_optimal_unknown_var.r'
'sim_Aa_optimal_known_var.r' 'sim_Aa_optimal_unknown_var.r'
'sim_dabcd_max_power.r' 'sim_dabcd_min_var.r'
'sim_RSIHR_optimal_known_var.r'
'sim_RSIHR_optimal_unknown_var.r' 'functions.r' 'RAR-package.r'</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.3), stats, pins</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rdpack(&ge; 0.7)</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/yayayaoyaoyao/RARtrials">https://github.com/yayayaoyaoyao/RARtrials</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-02 12:04:27 UTC; Chuyao</td>
</tr>
<tr>
<td>Author:</td>
<td>Chuyao Xu [aut, cre],
  Thomas Lumley [aut, ths],
  Alain Vandal [aut, ths],
  Sofia S. Villar [cph],
  Kyle J. Wathen [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-04 09:44:57 UTC</td>
</tr>
</table>
<hr>
<h2 id='RARtrials-package'>RARtrials: Response-Adaptive Randomization in Clinical Trials</h2><span id='topic+RARtrials'></span><span id='topic+RARtrials-package'></span>

<h3>Description</h3>

<p>RAR package is designed for simulating most popular response-adaptive randomization 
methods in the literature with comparisons of each treatment group to a control 
group under no delay and delayed scenarios. All the designs are based on one-sided 
tests with a choice from values of 'upper' and 'lower'. The general assumption is 
that binary outcomes follow a Binomial distribution, while continuous outcomes follow 
a normal distribution. Additionally, the number of patients accrued in the population 
follows a Poisson distribution and users can specify the enrollment rate of patients 
enrolled in the trial.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Chuyao Xu <a href="mailto:cxu870@aucklanduni.ac.nz">cxu870@aucklanduni.ac.nz</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Thomas Lumley <a href="mailto:t.lumley@auckland.ac.nz">t.lumley@auckland.ac.nz</a> [thesis advisor]
</p>
</li>
<li><p> Alain Vandal <a href="mailto:alain.vandal@auckland.ac.nz">alain.vandal@auckland.ac.nz</a> [thesis advisor]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Sofia S. Villar <a href="mailto:sofia.villar@mrc-bsu.cam.ac.uk">sofia.villar@mrc-bsu.cam.ac.uk</a> [copyright holder]
</p>
</li>
<li><p> Kyle J. Wathen <a href="mailto:kylewathen@gmail.com">kylewathen@gmail.com</a> [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/yayayaoyaoyao/RARtrials">https://github.com/yayayaoyaoyao/RARtrials</a>
</p>
</li></ul>


<hr>
<h2 id='brar_select_au_binary'>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Binary Endpoint</h2><span id='topic+brar_select_au_binary'></span>

<h3>Description</h3>

<p><code>brar_select_au_binary</code> involves selecting au in Bayesian Response-Adaptive Randomization with a control group
for binary outcomes with two to five arms. The conjugate prior distributions follow Beta (<code class="reqn">Beta(\alpha,\beta)</code>) distributions
and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brar_select_au_binary(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  h,
  N2,
  tp,
  armlabel,
  blocksize,
  alpha1 = 1,
  beta1 = 1,
  alpha2 = alpha1,
  beta2 = beta1,
  alpha3 = alpha1,
  beta3 = beta1,
  alpha4 = alpha1,
  beta4 = beta1,
  alpha5 = alpha1,
  beta5 = beta1,
  minstart,
  deltaa,
  tpp = 0,
  deltaa1,
  side,
  output = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brar_select_au_binary_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_h">h</code></td>
<td>
<p>a vector of success probabilities in hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probabilities
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_alpha1">alpha1</code>, <code id="brar_select_au_binary_+3A_beta1">beta1</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code>, prior for arm 1 which
stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_alpha2">alpha2</code>, <code id="brar_select_au_binary_+3A_beta2">beta2</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code>, prior for arm 2.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_alpha3">alpha3</code>, <code id="brar_select_au_binary_+3A_beta3">beta3</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 3.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_alpha4">alpha4</code>, <code id="brar_select_au_binary_+3A_beta4">beta4</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 4.
Default value is set to <code>alpha1</code> and <code>beta1</code>..</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_alpha5">alpha5</code>, <code id="brar_select_au_binary_+3A_beta5">beta5</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 5.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_output">output</code></td>
<td>
<p>control the output of <code>brar_select_au_binary</code>. If user does not specify anything, the function returns
the entire data set used to select the stopping boundary for each iteration. If the user specifies 'B', the function
only returns the selected stopping boundary for each iteration.</p>
</td></tr>
<tr><td><code id="brar_select_au_binary_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a data set or a value in one iteration for selecting the appropriate au using Bayesian
response-adaptive randomization with a control group under null hypotheses with no delay and delayed scenarios.
The function can handle trials with up to 5 arms for binary outcomes. This function uses the formula
<code class="reqn">\frac{Pr(p_k=max\{p_1,...,p_K\})^{tp}} {\sum_{k=1}^{K}{Pr(p_k=max\{p_1,...,p_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(p_k=min\{p_1,...,p_K\})^{tp}} {\sum_{k=1}^{K}{Pr(p_k=min\{p_1,...,p_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>A list of results generated from formula <code class="reqn">Pr(p_k&gt;p_{control}+\delta|data_{t-1})</code> at each step.
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#brar_select_au_binary with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days, where h1=c(0.2,0.4), tp=0.5,
#early futility stopping is set at -0.085, and the minimal effect size is 0.1.
set.seed(123)
stopbound1&lt;-lapply(1:10,function(x){brar_select_au_binary(Pats=10,
nMax=50000,TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),
enrollrate=0.1,N1=24,armn=2,h=c(0.3,0.3),N2=224,tp=0.5,armlabel=c(1,2),
blocksize=4,alpha1=1,beta1=1,alpha2=1,beta2=1,minstart=24,deltaa=-0.01,
tpp=0,deltaa1=0.1,side='upper')})
simf&lt;-list()
for (xx in 1:10){
    if (any(stopbound1[[xx]][24:223,2]&lt;0.01)){
      simf[[xx]]&lt;-NA
   }  else{
      simf[[xx]]&lt;-stopbound1[[xx]][224,2]
 }
}
simf1&lt;-do.call(rbind,simf)
sum(is.na(simf1))/10  #1, achieve around 10% futility
sum(simf1&gt;0.36,na.rm=TRUE)/10  #0.1
#the selected stopping boundary is 0.36 with an overall upper one-sided type I
#error of 0.1, based on 10 simulations. It is recommended to conduct more simulations 
#(i.e., 1000) to obtain an accurate au.
</code></pre>

<hr>
<h2 id='brar_select_au_known_var'>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Known Variances</h2><span id='topic+brar_select_au_known_var'></span>

<h3>Description</h3>

<p><code>brar_select_au_known_var</code> involves selecting au in Bayesian Response-Adaptive Randomization with a control group
for continuous endpoints with known variance in trials with two to five arms. The conjugate prior distributions follow
Normal (<code class="reqn">N(mean,sd)</code>) distributions and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brar_select_au_known_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  N2,
  tp,
  armlabel,
  blocksize,
  mean,
  sd,
  minstart,
  deltaa,
  tpp,
  deltaa1,
  mean10 = 0,
  mean20 = mean10,
  mean30 = mean10,
  mean40 = mean10,
  mean50 = mean10,
  sd10 = 1,
  sd20 = sd10,
  sd30 = sd10,
  sd40 = sd10,
  sd50 = sd10,
  n10 = 1,
  n20 = n10,
  n30 = n10,
  n40 = n10,
  n50 = n10,
  side,
  output = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brar_select_au_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of treatment labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of means in hypotheses, for example, as c(10,10) where 10 stands for the mean
in both groups. Another example is c(10,12) where 10 and 12 stand for the mean
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviations in hypotheses, for example, as c(2,2) where 2 stands for the standard deviation
in both groups. Another example is c(1,2) where 1 and 2 stand for the standard deviation
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean10">mean10</code>, <code id="brar_select_au_known_var_+3A_sd10">sd10</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 1 in the trial, which stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean20">mean20</code>, <code id="brar_select_au_known_var_+3A_sd20">sd20</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 2 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean30">mean30</code>, <code id="brar_select_au_known_var_+3A_sd30">sd30</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 3 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean40">mean40</code>, <code id="brar_select_au_known_var_+3A_sd40">sd40</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 4 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_mean50">mean50</code>, <code id="brar_select_au_known_var_+3A_sd50">sd50</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 5 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n10">n10</code></td>
<td>
<p>explicit prior n of arm 1 in the trial, which stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n20">n20</code></td>
<td>
<p>explicit prior n of arm 2 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n30">n30</code></td>
<td>
<p>explicit prior n of arm 3 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n40">n40</code></td>
<td>
<p>explicit prior n of arm 4 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_n50">n50</code></td>
<td>
<p>explicit prior n of arm 5 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_output">output</code></td>
<td>
<p>control the output of brar_select_au_binary. If the user does not specify anything, the function returns
the entire dataset used to select the stopping boundary for each iteration. If the user specifies 'B', the function
only returns the selected stopping boundary for each iteration.</p>
</td></tr>
<tr><td><code id="brar_select_au_known_var_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a data set or a value in one iteration for selecting the appropriate au using Bayesian
response-adaptive randomization with a control group under null hypotheses with no delay and delayed scenarios.
The function can handle trials with up to 5 arms for continuous outcomes with known variances. This function uses the formula
<code class="reqn">\frac{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(\mu_k=min\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=min\{\mu_1,...,\mu_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>A list of results generated from formula <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data_{t-1})</code> at each step.
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#brar_select_au_known_var with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days, where mean=c(8.9/100,8.74/100,8.74/100),
#sd=c(0.009,0.009,0.009), tp=0.5 and the minimal effect size is 0.
set.seed(789)
stopbound1&lt;-lapply(1:10,function(x){
brar_select_au_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.1, N1=21,armn=3,
N2=189,tp=0.5,armlabel=c(1,2,3),blocksize=6,mean=c((8.9/100+8.74/100+8.74/100)/3,
(8.9/100+8.74/100+8.74/100)/3,(8.9/100+8.74/100+8.74/100)/3),
sd=c(0.009,0.009,0.009),minstart=21,deltaa=c(0,0.001),tpp=0,deltaa1=c(0,0),
mean10=0.09,mean20=0.09,mean30=0.09, sd10=0.01,sd20=0.01,sd30=0.01,n10=1,n20=1,
n30=1,side='lower')})
simf&lt;-list()
simf1&lt;-list()
for (xx in 1:10){
 if (any(stopbound1[[xx]][21:188,2]&lt;0.01)){
      simf[[xx]]&lt;-NA
   }  else{
      simf[[xx]]&lt;-stopbound1[[xx]][189,2]
 }
 if (any(stopbound1[[xx]][21:188,3]&lt;0.01)){
      simf1[[xx]]&lt;-NA
   }  else{
      simf1[[xx]]&lt;-stopbound1[[xx]][189,3]
 }
}
simf2&lt;-do.call(rbind,simf)
sum(is.na(simf2)) #1, achieve around 10% futility
simf3&lt;-do.call(rbind,simf1)
sum(is.na(simf3)) #1, achieve around 10% futility
stopbound1a&lt;-cbind(simf2,simf3)
stopbound1a[is.na(stopbound1a)] &lt;- 0
sum(stopbound1a[,1]&gt;0.973 | stopbound1a[,2]&gt;0.973)/10 #0.1
#the selected stopping boundary is 0.973 with an overall lower one-sided type I
#error of 0.1, based on 10 simulations. Because it is under the permutation null hypothesis,
#the selected deltaa should be an average of 0 and 0.001 which is 0.0005, although
#deltaa could be close to each other with larger simulation numbers.
#It is recommended to conduct more simulations (i.e., 1000) to obtain an accurate deltaa and au.
#As the simulation number increases, the choice of deltaa could be consistent for comparisons
#of each arm to the control.

</code></pre>

<hr>
<h2 id='brar_select_au_unknown_var'>Select au in Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Unknown Variances</h2><span id='topic+brar_select_au_unknown_var'></span>

<h3>Description</h3>

<p><code>brar_select_au_unknown_var</code> involves selecting au in Bayesian Response-Adaptive Randomization with a control group
for continuous endpoints with unknown variance in trials with two to five arms. The conjugate prior distributions follow
Normal-Inverse-Gamma (NIG) (<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>)
distributions and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brar_select_au_unknown_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  N2,
  tp,
  armlabel,
  blocksize,
  mean,
  sd,
  minstart,
  deltaa,
  tpp,
  deltaa1,
  side,
  output = NULL,
  V01,
  a01,
  b01,
  m01,
  V02 = V01,
  V03 = V01,
  V04 = V01,
  V05 = V01,
  a02 = a01,
  a03 = a01,
  a04 = a01,
  a05 = a01,
  b02 = b01,
  b03 = b01,
  b04 = b01,
  b05 = b01,
  m02 = m01,
  m03 = m01,
  m04 = m01,
  m05 = m01,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brar_select_au_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of treatment labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of means in hypotheses, for example, as c(10,10) where 10 stands for the mean
in both groups. Another example is c(10,12) where 10 and 12 stand for the mean
for the control and the other treatment group, respectively.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviations in hypotheses, for example, as c(2,2) where 2 stands for the standard deviation
in both groups. Another example is c(1,2) where 1 and 2 stand for the standard deviation
for the control and the other treatment group, respectively.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_output">output</code></td>
<td>
<p>control the output of brar_select_au_binary. If the user does not specify anything, the function returns
the entire dataset used to select the stopping boundary for each iteration. If the user specifies 'B', the function
only returns the selected stopping boundary for each iteration.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_v01">V01</code>, <code id="brar_select_au_unknown_var_+3A_a01">a01</code>, <code id="brar_select_au_unknown_var_+3A_b01">b01</code>, <code id="brar_select_au_unknown_var_+3A_m01">m01</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 1 in the trial, which stands for the control.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_v02">V02</code>, <code id="brar_select_au_unknown_var_+3A_a02">a02</code>, <code id="brar_select_au_unknown_var_+3A_b02">b02</code>, <code id="brar_select_au_unknown_var_+3A_m02">m02</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 2 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_v03">V03</code>, <code id="brar_select_au_unknown_var_+3A_a03">a03</code>, <code id="brar_select_au_unknown_var_+3A_b03">b03</code>, <code id="brar_select_au_unknown_var_+3A_m03">m03</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 3 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_v04">V04</code>, <code id="brar_select_au_unknown_var_+3A_a04">a04</code>, <code id="brar_select_au_unknown_var_+3A_b04">b04</code>, <code id="brar_select_au_unknown_var_+3A_m04">m04</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 4 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_v05">V05</code>, <code id="brar_select_au_unknown_var_+3A_a05">a05</code>, <code id="brar_select_au_unknown_var_+3A_b05">b05</code>, <code id="brar_select_au_unknown_var_+3A_m05">m05</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 5 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="brar_select_au_unknown_var_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a data set or a value in one iteration for selecting the appropriate au using Bayesian
response-adaptive randomization with a control group under null hypotheses with no delay and delayed scenarios.
The function can handle trials with up to 5 arms for continuous outcomes with unknown variances. This function uses the formula
<code class="reqn">\frac{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(\mu_k=min\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=min\{\mu_1,...,\mu_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>A list of results generated from formula <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data_{t-1})</code> at each step.
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#brar_select_au_unknown_var with delayed responses follow a normal distribution with
#a mean of 60 days and a standard deviation of 3 days, where 
#mean=c((9.1/100+8.74/100+8.74/100)/3,(9.1/100+8.74/100+8.74/100)/3,
#(9.1/100+8.74/100+8.74/100)/3),sd=c(0.009,0.009,0.009),tp=1 and 
#the minimal effect size is 0. All arms have the same prior distributions.
set.seed(789)
stopbound1&lt;-lapply(1:5,function(x){
brar_select_au_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length( vStartTime ),30, 3)), enrollrate=0.1, N1=48, armn=3, N2=480, tp=1,
armlabel=c(1,2,3), blocksize=6, mean=c((9.1/100+8.74/100+8.74/100)/3,
(9.1/100+8.74/100+8.74/100)/3,(9.1/100+8.74/100+8.74/100)/3) ,
sd=c(0.009,0.009,0.009),minstart=48, deltaa=c(-0.0003,-0.00035), tpp=0, 
deltaa1=c(0,0),V01=1/2,a01=0.3,m01=9/100,b01=0.00001,side='lower')
})

simf&lt;-list()
simf1&lt;-list()
for (xx in 1:5){
 if (any(stopbound1[[xx]][48:479,2]&lt;0.01)){
      simf[[xx]]&lt;-NA
   }  else{
      simf[[xx]]&lt;-stopbound1[[xx]][480,2]
 }
 if (any(stopbound1[[xx]][48:479,3]&lt;0.01)){
      simf1[[xx]]&lt;-NA
   }  else{
      simf1[[xx]]&lt;-stopbound1[[xx]][480,3]
 }
}
simf2&lt;-do.call(rbind,simf)
sum(is.na(simf2)) #1, achieve around 20% futility
simf3&lt;-do.call(rbind,simf1)
sum(is.na(simf3)) #1, achieve around 20% futility
stopbound1a&lt;-cbind(simf2,simf3)
stopbound1a[is.na(stopbound1a)] &lt;- 0
sum(stopbound1a[,1]&gt;0.85 | stopbound1a[,2]&gt;0.85)/5 #0.2
#the selected stopping boundary is 0.85 with an overall lower one-sided type 
#I error of 0.2, based on 5 simulations. Because it is under the permutation null hypothesis,
#the selected deltaa should be an average of -0.0003 and -0.00035 which is -0.000325.
#It is recommended to conduct more simulations (i.e., 1000)  
#to obtain an accurate deltaa and au. As the simulation number increases, the
#choice of deltaa could be consistent for comparisons of each arm to the control.
</code></pre>

<hr>
<h2 id='convert_chisq_to_gamma'>Convert parameters from a Normal-Inverse-Chi-Squared Distribution to a
Normal-Inverse-Gamma Distribution</h2><span id='topic+convert_chisq_to_gamma'></span>

<h3>Description</h3>

<p>Convert parameters from a Normal-Inverse-Chi-Squared distribution to a
Normal-Inverse-Gamma distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_chisq_to_gamma(cpar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_chisq_to_gamma_+3A_cpar">cpar</code></td>
<td>
<p>a list of parameters including mu, kappa, nu, sigsq from a Normal-Chi-Squared distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function convert parameters from a Normal-Inverse-Chi-Squared
(<code class="reqn">(\mu,\sigma^2) \sim NIX(mean=\mu,effective sample size=\kappa,degrees of freedom=\nu,variance=\sigma^2/\kappa)</code>) 
distribution to a Normal-Inverse-Gamma 
(<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>) 
distribution.
</p>


<h3>Value</h3>

<p>a list of parameters including m, V, a, b from a Normal-Inverse-Gamma distribution.
</p>


<h3>References</h3>

<p>Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_chisq_to_gamma(list(mu=0.091,kappa=2,nu=1,sigsq=4e-05))
</code></pre>

<hr>
<h2 id='convert_gamma_to_chisq'>Convert parameters from a Normal-Inverse-Gamma Distribution to a
Normal-Inverse-Chi-Squared Distribution</h2><span id='topic+convert_gamma_to_chisq'></span>

<h3>Description</h3>

<p>Convert parameters from a Normal-Inverse-Gamma distribution to a
Normal-Inverse-Chi-Squared distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_gamma_to_chisq(gpar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_gamma_to_chisq_+3A_gpar">gpar</code></td>
<td>
<p>a list of parameters including m, V, a, b from a Normal-Inverse-Gamma distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function convert parameters from a Normal-Inverse-Gamma 
(<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>) 
distribution to a Normal-Inverse-Chi-Squared 
(<code class="reqn">(\mu,\sigma^2) \sim NIX(mean=\mu,effective sample size=\kappa,degrees of freedom=\nu,variance=\sigma^2/\kappa)</code>) 
distribution.
</p>


<h3>Value</h3>

<p>a list of parameters including mu, kappa, nu, sigsq from a Normal-Inverse-Chi-Squared distribution.
</p>


<h3>References</h3>

<p>Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert_gamma_to_chisq(list(V=1/2,a=0.5,m=9.1/100,b=0.00002))
</code></pre>

<hr>
<h2 id='dabcd_max_power'>Allocation Probabilities Using Doubly Adaptive Biased Coin Design with Maximal Power Strategy for Binary Endpoint</h2><span id='topic+dabcd_max_power'></span>

<h3>Description</h3>

<p><code>dabcd_max_power</code> can be used for doubly adaptive biased coin design with maximal power
strategy for binary outcomes, targeting generalized Neyman allocation and generalized RSIHR allocation. The return 
of this function is a vector of allocation probabilities to each arm, with the pre-specified number of participants in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dabcd_max_power(NN, Ntotal1, armn, BB, type, dabcd = FALSE, gamma = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dabcd_max_power_+3A_nn">NN</code></td>
<td>
<p>a vector representing the number of participants with success results for each arm
estimated from the current data.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_ntotal1">Ntotal1</code></td>
<td>
<p>a vector representing the total number of participants for each arm
estimated from the current data.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_bb">BB</code></td>
<td>
<p>the minimal allocation probability for each arm, which is within the
range of <code class="reqn">[0,1/armn]</code>.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_type">type</code></td>
<td>
<p>allocation type, with choices from 'RSIHR' and 'Neyman'.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_dabcd">dabcd</code></td>
<td>
<p>an indicator of whether to apply Hu &amp; Zhang's formula ((Hu and Zhang 2004)), with choices from FALSE and TRUE.
TRUE represents allocation probabilities calculated using Hu &amp; Zhang's formula;
FALSE represents allocation probabilities calculated before applying Hu &amp; Zhang's formula.
Default value is set to FALSE.</p>
</td></tr>
<tr><td><code id="dabcd_max_power_+3A_gamma">gamma</code></td>
<td>
<p>tuning parameter in Hu &amp; Zhang's formula ((Hu and Zhang 2004)). When <code>dabcd</code>=FALSE, this parameter does not need
to be specified. Default value is set to 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates allocation probabilities for doubly adaptive biased coin design with maximal power strategy targeting
generalized Neyman allocation with 2-5 arms which is provided in (Tymofyeyev et al. 2007) or
generalized RSIHR allocation with 2-3 arms which is provided in (Jeon and Feifang 2010), with modifications for typos
in (Sabo and Bello 2016). All of those methods are not smoothed. The output of this function is based on Hu <code>\&amp;</code> Zhang's formula (Hu and Zhang 2004).
With more than two armd the one-sided nominal level of each test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
</p>


<h3>Value</h3>

<p>A vector of allocation probabilities to each arm.
</p>


<h3>Author(s)</h3>

<p>Chuyao Xu, Thomas Lumley, Alain Vandal
</p>


<h3>References</h3>

<p>Hu F, Zhang L (2004).
&ldquo;Asymptotic Properties of Doubly Adaptive Biased Coin Designs for Multitreatment Clinical Trials.&rdquo;
<em>The Annals of Statistics</em>, <b>32</b>(1), 268&ndash;301.
Tymofyeyev Y, Rosenberger WF, Hu F (2007).
&ldquo;Implementing Optimal Allocation in Sequential Binary Response Experiments.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>102</b>(477), 224-234.
<a href="https://doi.org/10.1198/016214506000000906">doi:10.1198/016214506000000906</a>.
Jeon Y, Feifang H (2010).
&ldquo;Optimal Adaptive Designs for Binary Response Trials With Three Treatments.&rdquo;
<em>Statistics in Biopharmaceutical Research</em>, <b>2</b>, 310-318.
<a href="https://doi.org/10.1198/sbr.2009.0056">doi:10.1198/sbr.2009.0056</a>.
Sabo R, Bello G (2016).
&ldquo;Optimal and lead-in adaptive allocation for binary outcomes: a comparison of Bayesian methodologies.&rdquo;
<em>Communications in Statistics - Theory and Methods</em>, <b>46</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dabcd_max_power(NN=c(54,67,85,63,70),Ntotal1=c(100,88,90,94,102),armn=5,BB=0.2, type='Neyman')
dabcd_max_power(NN=c(54,67,85,63),Ntotal1=c(100,88,90,94),armn=4,BB=0.2, type='Neyman')
</code></pre>

<hr>
<h2 id='dabcd_min_var'>Allocation Probabilities Using Doubly Adaptive Biased Coin Design with Minimal Variance Strategy for Binary Endpoint</h2><span id='topic+dabcd_min_var'></span>

<h3>Description</h3>

<p><code>dabcd_min_var</code> can be used for doubly adaptive biased coin design with minimal variance
strategy for binary outcomes, targeting generalized Neyman allocation and generalized RSIHR allocation. The return 
of this function is a vector of allocation probabilities to each arm, with the pre-specified number of participants in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dabcd_min_var(NN, Ntotal1, armn, type, dabcd = FALSE, gamma = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dabcd_min_var_+3A_nn">NN</code></td>
<td>
<p>a vector representing the number of participants with success results for each arm
estimated from the current data .</p>
</td></tr>
<tr><td><code id="dabcd_min_var_+3A_ntotal1">Ntotal1</code></td>
<td>
<p>a vector representing the total number of participants for each arm
estimated from the current data.</p>
</td></tr>
<tr><td><code id="dabcd_min_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="dabcd_min_var_+3A_type">type</code></td>
<td>
<p>allocation type, with choices from 'RSIHR' and 'Neyman'.</p>
</td></tr>
<tr><td><code id="dabcd_min_var_+3A_dabcd">dabcd</code></td>
<td>
<p>an indicator of whether to apply Hu &amp; Zhang's formula ((Hu and Zhang 2004)), with choices from FALSE and TRUE.
TRUE represents allocation probabilities calculated using Hu &amp; Zhang's formula;
FALSE represents allocation probabilities calculated before applying Hu &amp; Zhang's formula.
Default value is set to FALSE.</p>
</td></tr>
<tr><td><code id="dabcd_min_var_+3A_gamma">gamma</code></td>
<td>
<p>tuning parameter in Hu &amp; Zhang's formula ((Hu and Zhang 2004)). When <code>dabcd</code>=FALSE, this parameter does not need
to be specified. Default value is set to 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates allocation probabilities for doubly adaptive biased coin design with minimal variance strategy targeting
generalized Neyman allocation and generalized RSIHR allocation with 2-5 arms. The output of this function is based on Hu <code>\&amp;</code> Zhang's formula (Hu and Zhang 2004).
With more than two armd the one-sided nominal level of each test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
</p>


<h3>Value</h3>

<p>A vector of allocation probabilities to each arm.
</p>


<h3>Author(s)</h3>

<p>Chuyao Xu, Thomas Lumley, Alain Vandal
</p>


<h3>References</h3>

<p>Hu F, Zhang L (2004).
&ldquo;Asymptotic Properties of Doubly Adaptive Biased Coin Designs for Multitreatment Clinical Trials.&rdquo;
<em>The Annals of Statistics</em>, <b>32</b>(1), 268&ndash;301.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dabcd_min_var(NN=c(54,67,85,63,70),Ntotal1=c(100,88,90,94,102),armn=5, type='Neyman')
dabcd_min_var(NN=c(54,67,85,63),Ntotal1=c(100,88,90,94),armn=4,type='RSIHR')
</code></pre>

<hr>
<h2 id='flgi_cut_off_binary'>Cut-off Value of the Forward-looking Gittins Index Rule in Binary Endpoint</h2><span id='topic+flgi_cut_off_binary'></span>

<h3>Description</h3>

<p>Function for simulating cut-off values at the final stage using the forward-looking Gittins Index rule
and the controlled forward-looking Gittins Index rule for binary outcomes in trials with 2-5 arms.
The conjugate prior distributions follow Beta (<code class="reqn">Beta(\alpha,\beta)</code>) distributions and should be the same for each
arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flgi_cut_off_binary(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  I0,
  K,
  noRuns2 = 100,
  Tsize,
  ptrue,
  block,
  rule,
  ztype
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flgi_cut_off_binary_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'binary' in this function.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0, 0.5, 0.7, 0.99 and 0.995. The maximal sample size can be up to 2000.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. Recommend using the
<code>bmab_gi_multiple_ab</code> function from <code>gittins</code> package. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_i0">I0</code></td>
<td>
<p>a matrix with K rows and 2 columns, where the numbers inside are equal to the prior parameters, and
K is equal to the total number of arms. For example, matrix(1,nrow=2,ncol=2) means that the prior
distributions for two-armed trials are beta(1,1); matrix(c(2,3),nrow=2,ncol=2,byrow = TRUE) means that the prior
distributions for two-armed trials are beta(2,3). The first column represents the prior of the number of successes,
and the second column represents the prior of the number of failures.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100, which is recommended in (Villar et al. 2015).</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_ptrue">ptrue</code></td>
<td>
<p>a vector of hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probability for the control and
the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_binary_+3A_ztype">ztype</code></td>
<td>
<p>Z test statistics, with choice of values from 'pooled' and 'unpooled'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates trials using the forward-looking Gittins Index rule and the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios to obtain
cut-off values at the final stage, with control of type I error. The user is expected to run this function
multiple times to determine a reasonable cut-off value for statistical inference.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>Value of Z test statistics for one trial.
</p>


<h3>References</h3>

<p>Gittins J, Glazebrook K, Weber R (2011).
<em>Multi-Armed Bandit Allocation Indices, 2nd Edition</em>, volume 33.
Hoboken,NJ:John Wiley &amp; Sons.
ISBN 9780470670026, <a href="https://doi.org/10.1002/9780470980033.ch8">doi:10.1002/9780470980033.ch8</a>.
Villar S, Wason J, Bowden J (2015).
&ldquo;Response-Adaptive Randomization for Multi-arm Clinical Trials Using the Forward Looking Gittins Index Rule.&rdquo;
<em>Biometrics</em>, <b>71</b>.
<a href="https://doi.org/10.1111/biom.12337">doi:10.1111/biom.12337</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal distribution
#with a mean of 60 days and a standard deviation of 3 days
#One can run the following command 20000 times to obtain the selected cut-off value around 1.9991
#with an upper one-sided type I error 0.025

stopbound1&lt;-lapply(1:20000,function(x){ flgi_cut_off_binary(Gittinstype='Binary',df=0.5,Pats=10,
nMax=50000,TimeToOutcome=expression(rnorm( length( vStartTime ),60, 3)),
enrollrate=0.9,I0= matrix(1,nrow=2,ncol=2),K=2,Tsize=992,ptrue=c(0.6,0.6),block=20,
rule='FLGI PM',ztype='unpooled')})
stopbound1a&lt;-do.call(rbind,stopbound1)
sum(stopbound1a&gt;(1.9991) )/20000
#The selected cut-off value is around 1.9991 with an overall lower one-sided type I
#error of 0.025, based on 20000 simulations.

</code></pre>

<hr>
<h2 id='flgi_cut_off_known_var'>Cut-off Value of the Forward-looking Gittins Index Rule in Continuous Endpoint with Known Variances</h2><span id='topic+flgi_cut_off_known_var'></span>

<h3>Description</h3>

<p>Function for simulating cut-off values at the final stage using the forward-looking Gittins Index rule
and the controlled forward-looking Gittins Index rule for continuous outcomes with known variance in trials with
2-5 arms. The conjugate prior distributions follow Normal (<code class="reqn">N(mean,sd)</code>) distributions and should be the same for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flgi_cut_off_known_var(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  K,
  noRuns2,
  Tsize,
  block,
  rule,
  prior_n,
  prior_mean,
  mean,
  sd,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flgi_cut_off_known_var_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'KV' in this function.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99 and 0.995. The maximal sample size can be up to 10000.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100, which is recommended in (Villar et al. 2015).</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_prior_n">prior_n</code></td>
<td>
<p>a vector representing the number of observations assumed in prior distributions, eg: c(1,1) for a two-armed trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_prior_mean">prior_mean</code></td>
<td>
<p>a vector representing mean of observations assumed in prior distributions, eg: c(0,0,0) for a three-armed trial,
rep(0,K) can be used to simplify the process. If a negative effect is expected, adjust the mean to a negative value.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of mean hypotheses, for example, c(0.1,0.1) where 0.1 stands for the mean
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the mean for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviation in hypotheses, for example, as c(0.64,0.64) where 0.64 stands for the standard deviation
for both groups. Another example is c(0.64,0.4) where 0.64 and 0.4 stand for the standard deviation for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_known_var_+3A_side">side</code></td>
<td>
<p>direction of one-sided test with the values of 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates trials using the forward-looking Gittins Index rule and the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios to obtain
cut-off values at the final stage, with control of type I error. The user is expected to run this function
multiple times to determine a reasonable cut-off value for statistical inference.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>Value of Z test statistics for one trial.
</p>


<h3>References</h3>

<p>Williamson SF, Villar S (2019).
&ldquo;A Response‐Adaptive Randomization Procedure for Multi‐Armed Clinical Trials with Normally Distributed Outcomes.&rdquo;
<em>Biometrics</em>, <b>76</b>.
<a href="https://doi.org/10.1111/biom.13119">doi:10.1111/biom.13119</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal 
#distribution with a mean of 30 days and a standard deviation of 3 days
#One can run the following command 20000 times to obtain the selected cut-off
#value around -2.1725 with an overall lower one-sided type I error 0.025

stopbound1&lt;-lapply(1:20000,function(x){ 
flgi_cut_off_known_var(Gittinstype='KV',df=0.995,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),enrollrate=0.5,
K=3,noRuns2=100,Tsize=852,block=20,rule='FLGI PM',prior_n=rep(1,3),
prior_mean=rep(9/100,3),mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),
side='lower')})
stopbound1a&lt;-do.call(rbind,stopbound1)
sum(stopbound1a&lt;(-2.1725) )/20000
#The selected cut-off value is around -2.1725 with an overall lower one-sided 
#type I error of 0.025, based on 20000 simulations.



#One can run the following command 20000 times to obtain the selected cut-off 
#value around -2.075 with an overall lower one-sided type I error 0.025

stopbound1&lt;-lapply(1:20000,function(x){
flgi_cut_off_known_var(Gittinstype='KV',df=0.995,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,
K=3,noRuns2=100,Tsize=852,block=20,rule='CFLGI',prior_n=rep(1,3),
prior_mean=rep(9/100,3),mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),
side='lower')})
stopbound1a&lt;-do.call(rbind,stopbound1)
sum(stopbound1a&lt;(-2.075) )/20000
#The selected cut-off value is around -2.075 with an overall lower one-sided type I
#error of 0.025, based on 20000 simulations.

</code></pre>

<hr>
<h2 id='flgi_cut_off_unknown_var'>Cut-off Value of the Forward-looking Gittins Index rule in Continuous Endpoint with Unknown Variances</h2><span id='topic+flgi_cut_off_unknown_var'></span>

<h3>Description</h3>

<p>Function for simulating cut-off values at the final stage using the forward-looking Gittins Index rule
and the controlled forward-looking Gittins Index rule for continuous outcomes with known variance in trials with
2-5 arms. The prior distributions follow Normal-Inverse-Gamma (NIG) (<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>)
distributions and should be the same for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flgi_cut_off_unknown_var(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  K,
  noRuns2,
  Tsize,
  block,
  rule,
  prior_n,
  prior_mean1,
  prior_sd1,
  mean,
  sd,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'UNKV' in this function</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99 and 0.995. The maximal sample size can be up to 10000.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100 times, which is recommended in Villar et al., 2015.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_prior_n">prior_n</code></td>
<td>
<p>a vector representing the number of observations assumed in prior distribution, eg: c(1,1) for a two-armed trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_prior_mean1">prior_mean1</code></td>
<td>
<p>a vector representing mean of observations assumed in prior distributions, eg: c(0,0,0) for a three-armed trial,
rep(0,K) can be used to simplify the process. If a negative effect is expected, adjust the mean to a negative value.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_prior_sd1">prior_sd1</code></td>
<td>
<p>a vector representing the standard deviation of observations assumed in prior distribution, eg: rep(1,3) for a three-armed trial.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of mean hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the mean
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the mean for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviation hypotheses, for example, as c(0.64,0.64) where 0.64 stands for the standard deviation
for both groups. Another example is c(0.64,0.4) where 0.64 and 0.4 stand for the standard deviation for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="flgi_cut_off_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of one-sided test with the values of 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates trials using the forward-looking Gittins Index rule and the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios to obtain
cut-off values at the final stage, with control of type I error. The user is expected to run this function
multiple times to determine a reasonable cut-off value for statistical inference.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p>Value of T test statistics for one trial.
</p>


<h3>References</h3>

<p>Williamson SF, Villar S (2019).
&ldquo;A Response‐Adaptive Randomization Procedure for Multi‐Armed Clinical Trials with Normally Distributed Outcomes.&rdquo;
<em>Biometrics</em>, <b>76</b>.
<a href="https://doi.org/10.1111/biom.13119">doi:10.1111/biom.13119</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal 
#distribution with a mean of 60 days and a standard deviation of 3 days
#One can run the following command 20000 times to obtain the selected cut-off 
#value around -1.9298 with an overall lower one-sided type I error 0.025

stopbound1&lt;-lapply(1:20000,function(x){ 
flgi_cut_off_unknown_var(Gittinstype='UNKV',df=0.5,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),60, 3)),enrollrate=0.9,
K=3,noRuns2=100,Tsize=852,block=20,rule='FLGI PM',prior_n=rep(2,3),
prior_mean1=rep(9/100,3),prior_sd1=rep(0.006324555,3),
mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),side='lower')})
stopbound1a&lt;-do.call(rbind,stopbound1)
sum(stopbound1a&lt;(-1.9298) )/20000
#The selected cut-off value is around -1.9298 with an overall lower one-sided 
#type I error of 0.025, based on 20000 simulations.

</code></pre>

<hr>
<h2 id='Gittins'>Gittins Indices</h2><span id='topic+Gittins'></span>

<h3>Description</h3>

<p><code>Gittins</code> can provide Gittins indices for binary reward processes
and normal reward processes with known and unknown variance for certain discount factors.
Binary reward process can handle scenarios with up to 2000 participants in a trial, while
normal reward process can handle scenarios with up to 10000 participants in a trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Gittins(Gittinstype, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Gittins_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, with choices from 'Binary', 'UNKV' and 'KV'.
'Binary' represents binary outcomes, 'UNKV' and 'KV' represent continuous outcomes with
known and unknown variance respectively.</p>
</td></tr>
<tr><td><code id="Gittins_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99 and 0.995 for <code>Gittinstype</code> in 'UNKV' and 'KV';
0, 0.5, 0.7, 0.99 and 0.995 for <code>Gittinstype</code> in 'binary'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Gittins indices for binary outcomes are generated from <code>bmab_gi_multiple_ab</code> function from <code>gittins</code> package with
time horizon 100, 100, 100, 1000, 1000 for discount factor 0, 0.5, 0.7, 0.99 and 0.995 respectively.
Gittins indices for continuous outcomes are obtained by linear extrapolation using Table 8.1 and Table 8.3
in (Gittins et al. 2011).
</p>


<h3>Value</h3>

<p>A vector of Gittins indices for <code>Gittinstype</code> in 'UNKV' and 'KV'. A matrix of
Gittins indices for <code>Gittinstype</code> in 'Binary'.
</p>


<h3>References</h3>

<p>Gittins J, Glazebrook K, Weber R (2011).
<em>Multi-Armed Bandit Allocation Indices, 2nd Edition</em>, volume 33.
Hoboken,NJ:John Wiley &amp; Sons.
ISBN 9780470670026, <a href="https://doi.org/10.1002/9780470980033.ch8">doi:10.1002/9780470980033.ch8</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Gittins(Gittinstype='KV',df=0.5)

Gittins(Gittinstype='Binary',df=0.995)
Gittins(Gittinstype='UNKV',df=0.99)

</code></pre>

<hr>
<h2 id='pgreater_beta'>Calculate the Futility Stopping Probability for Binary Endpoint with Beta Distribution</h2><span id='topic+pgreater_beta'></span>

<h3>Description</h3>

<p>Calculate the futility stopping probability in Bayesian response-adaptive randomization with
a control group using the Thall <code class="reqn">\&amp;</code> Wathen method for binary outcomes. The conjugate prior distributions follow
Beta (<code class="reqn">Beta(\alpha,\beta)</code>) distributions and can be specified individually for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgreater_beta(a1, b1, a2, b2, delta, side, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgreater_beta_+3A_a1">a1</code>, <code id="pgreater_beta_+3A_b1">b1</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code>, current estimated <code class="reqn">\alpha</code> for the control group.</p>
</td></tr>
<tr><td><code id="pgreater_beta_+3A_a2">a2</code>, <code id="pgreater_beta_+3A_b2">b2</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code>, current estimated <code class="reqn">\alpha</code> for the treatment group which is compared to the control group.</p>
</td></tr>
<tr><td><code id="pgreater_beta_+3A_delta">delta</code></td>
<td>
<p>expected difference in success probabilities between the control group and the treatment group.</p>
</td></tr>
<tr><td><code id="pgreater_beta_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pgreater_beta_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to stats::integrate() (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of <code class="reqn">Pr(p_k&gt;p_{control}+\delta|data)</code> for <code>side</code> equals to
'upper' and the results of <code class="reqn">Pr(p_{control}&gt;p_k+\delta|data)</code> for <code>side</code> equals to 'lower'.
The result indicates the posterior probability of stopping a treatment group due to futility around <code class="reqn">1\%</code> in Bayesian
response-adaptive randomization with a control arm using Thall <code class="reqn">\&amp;</code> Wathen method, with accumulated results
during the conduct of trials.
</p>


<h3>Value</h3>

<p>a posterior probability of <code class="reqn">Pr(p_k&gt;p_{control}+\delta|data)</code> with <code>side</code> equals to 'upper';
a posterior probability of <code class="reqn">Pr(p_{control}&gt;p_k+\delta|data)</code> with <code>side</code> equals to 'lower'.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pgreater_beta(a1=8, b1=10,a2=5, b2=19, delta=0.1, side='upper')
pgreater_beta(a1=65, b1=79,a2=58, b2=68, delta=0, side='lower')
</code></pre>

<hr>
<h2 id='pgreater_NIX'>Calculate the Futility Stopping Probability for Continuous Endpoint with Unknown Variances Using a Normal-Inverse-Chi-Squared Distribution</h2><span id='topic+pgreater_NIX'></span>

<h3>Description</h3>

<p>Calculate the futility stopping probability in Bayesian response-adaptive randomization with
a control group using the Thall <code class="reqn">\&amp;</code> Wathen method for continuous outcomes with unknown variances. The prior distributions
follow Normal-Inverse-Chi-Squared (NIX) distributions and can be specified individually for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgreater_NIX(par1, par2, delta = 0, side, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgreater_NIX_+3A_par1">par1</code></td>
<td>
<p>current parameters including mu, kappa, nu, sigsq of a Normal-Inverse-Chi-Squared distribution from the control group.</p>
</td></tr>
<tr><td><code id="pgreater_NIX_+3A_par2">par2</code></td>
<td>
<p>current parameters including mu, kappa, nu, sigsq of a Normal-Inverse-Chi-Squared distribution from the compared treatment group.</p>
</td></tr>
<tr><td><code id="pgreater_NIX_+3A_delta">delta</code></td>
<td>
<p>pre-specified minimal effect size expected to be observed between the control group and the compared treatment group.</p>
</td></tr>
<tr><td><code id="pgreater_NIX_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pgreater_NIX_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to stats::integrate() (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data)</code> for <code>side</code> equals to
'upper' and the results of <code class="reqn">Pr(\mu_{control}&gt;\mu_k+\delta|data)</code> for <code>side</code> equals to 'lower'.
The result indicates the posterior probability of stopping a treatment group due to futility around <code class="reqn">1\%</code> in Bayesian
response-adaptive randomization with a control arm using Thall <code class="reqn">\&amp;</code> Wathen method, with accumulated results
during the conduct of trials. Parameters used in a Normal-Inverse-Gamma (<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>)
distribution should be converted to parameters equivalent in a Normal-Inverse-Chi-Squared
(<code class="reqn">(\mu,\sigma^2) \sim NIX(mean=\mu,effective sample size=\kappa,degrees of freedom=\nu,variance=\sigma^2/\kappa)</code>)
distribution using <code>convert_gamma_to_chisq</code> before applying this function.
</p>


<h3>Value</h3>

<p>a posterior probability of <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data)</code> with <code>side</code> equals to 'upper';
a posterior probability of <code class="reqn">Pr(\mu_{control}&gt;\mu_k+\delta|data)</code> with <code>side</code> equals to 'lower'.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para&lt;-list(V=1/2,a=0.5,m=9.1/100,b=0.00002)
par&lt;-convert_gamma_to_chisq(para)
set.seed(123451)
y1&lt;-rnorm(100,0.091,0.009)
par1&lt;-update_par_nichisq(y1, par)
set.seed(123452)
y2&lt;-rnorm(90,0.09,0.009)
par2&lt;-update_par_nichisq(y2, par)
pgreater_NIX(par1=par1,par2=par2, side='upper')
pgreater_NIX(par1=par1,par2=par2, side='lower')
</code></pre>

<hr>
<h2 id='pgreater_normal'>Calculate the Futility Stopping Probability for Continuous Endpoint with Known Variances Using Normal Distribution</h2><span id='topic+pgreater_normal'></span>

<h3>Description</h3>

<p>Calculate the futility stopping probability in Bayesian response-adaptive randomization with
a control group using the Thall <code class="reqn">\&amp;</code> Wathen method for continuous outcomes with known variances. The conjugate prior distributions
follow Normal (<code class="reqn">N(mean,sd)</code>) distributions and can be specified individually for each treatment group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgreater_normal(
  mean1 = NULL,
  sd1 = NULL,
  mean2 = NULL,
  sd2 = NULL,
  delta = 0,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgreater_normal_+3A_mean1">mean1</code>, <code id="pgreater_normal_+3A_sd1">sd1</code></td>
<td>
<p>mean and sd in <code class="reqn">N(mean,sd)</code>, current estimated mean and sd for the control group.</p>
</td></tr>
<tr><td><code id="pgreater_normal_+3A_mean2">mean2</code>, <code id="pgreater_normal_+3A_sd2">sd2</code></td>
<td>
<p>mean and sd in <code class="reqn">N(mean,sd)</code>, current estimated mean and sd for the treatment group which is compared to the control group.</p>
</td></tr>
<tr><td><code id="pgreater_normal_+3A_delta">delta</code></td>
<td>
<p>pre-specified minimal effect size expected to be observed between the control group and the compared treatment group.</p>
</td></tr>
<tr><td><code id="pgreater_normal_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pgreater_normal_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to stats::integrate() (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data)</code> for <code>side</code> equals to
'upper' and the results of <code class="reqn">Pr(\mu_{control}&gt;\mu_k+\delta|data)</code> for <code>side</code> equals to 'lower'.
The result indicates the posterior probability of stopping a treatment group due to futility around <code class="reqn">1\%</code> in Bayesian
response-adaptive randomization with a control arm using Thall <code class="reqn">\&amp;</code> Wathen method, with accumulated results
during the conduct of trials.
</p>


<h3>Value</h3>

<p>a posterior probability of <code class="reqn">Pr(\mu_k&gt;\mu_{control}+\delta|data)</code> with <code>side</code> equals to 'upper';
a posterior probability of <code class="reqn">Pr(\mu_{control}&gt;\mu_k+\delta|data)</code> with <code>side</code> equals to 'lower'.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pgreater_normal(mean1=0.091,sd1=0.09,mean2=0.097,sd2=0.08,delta=0,side='upper')
pgreater_normal(mean1=0.091,sd1=0.09,mean2=0.087,sd2=0.1,delta=0,side='lower')
</code></pre>

<hr>
<h2 id='pmax_beta'>Posterior Probability that a Particular Arm is the Best for Binary Endpoint</h2><span id='topic+pmax_beta'></span>

<h3>Description</h3>

<p>Calculate posterior probability that a particular arm is the best in a trial using Bayesian response-adaptive randomization with
a control group (the Thall <code class="reqn">\&amp;</code> Wathen method). The conjugate prior distributions follow Beta (<code class="reqn">Beta(\alpha,\beta)</code>) distributions
for binary outcomes in each arm and can be specified individually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmax_beta(
  armn,
  a1 = NULL,
  b1 = NULL,
  a2 = NULL,
  b2 = NULL,
  a3 = NULL,
  b3 = NULL,
  a4 = NULL,
  b4 = NULL,
  a5 = NULL,
  b5 = NULL,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmax_beta_+3A_armn">armn</code></td>
<td>
<p>number of arms in the trial with values up to 5. When <code>armn</code>=2,
only <code>a1</code> to <code>a2</code> and <code>b1</code> to <code>b2</code> need to be specified.
When <code>armn</code>=3, only <code>a1</code> to <code>a3</code> and  <code>b1</code> to <code>b3</code> need to be specified.
When <code>armn</code>=4, only <code>a1</code> to <code>a4</code> and  <code>b1</code> to <code>b4</code> need to be specified.
When <code>armn</code>=5, <code>a1</code> to <code>a5</code> and  <code>b1</code> to <code>b5</code> need to be specified.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_a1">a1</code>, <code id="pmax_beta_+3A_b1">b1</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code> for the arm to calculate the allocation probability of.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_a2">a2</code>, <code id="pmax_beta_+3A_b2">b2</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code> for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_a3">a3</code>, <code id="pmax_beta_+3A_b3">b3</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code> for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_a4">a4</code>, <code id="pmax_beta_+3A_b4">b4</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code> for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_a5">a5</code>, <code id="pmax_beta_+3A_b5">b5</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in <code class="reqn">Beta(\alpha,\beta)</code> for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pmax_beta_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of formula <code class="reqn">Pr(p_k=max\{p_1,...,p_K\})</code> for
<code>side</code> equals to 'upper' and the results of formula <code class="reqn">Pr(p_k=min\{p_1,...,p_K\})</code> for
<code>side</code> equals to 'lower'. This function returns the probability that the posterior probability of arm
<code class="reqn">k</code> is maximal or minimal in trials with up to five arms.
</p>


<h3>Value</h3>

<p>a probability that a particular arm is the best in trials up to five arms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pmax_beta(armn=5,a1=8,b1=10,a2=5,b2=19,a3=8,b3=21,
a4=6, b4=35, a5=15, b5=4, side='upper')
pmax_beta(armn=4,a1=56,b1=98,a2=25,b2=70,a3=87,b3=107,
a4=106, b4=202, side='lower')
pmax_beta(armn=3,a1=60,b1=46,a2=55,b2=46,a3=35,b3=36,side='upper')
</code></pre>

<hr>
<h2 id='pmax_NIX'>Posterior Probability that a Particular Arm is the Best for Continuous Endpoint with Unknown Variances</h2><span id='topic+pmax_NIX'></span>

<h3>Description</h3>

<p>Calculate posterior probability that a particular arm is the best in a trial using Bayesian response-adaptive randomization with
a control group (the Thall <code class="reqn">\&amp;</code> Wathen method). The conjugate prior distributions follow Normal-Inverse-Chi-Squared (NIX)
distributions for continuous outcomes with unknown variance in each arm and can be specified individually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmax_NIX(
  armn,
  par1 = NULL,
  par2 = NULL,
  par3 = NULL,
  par4 = NULL,
  par5 = NULL,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmax_NIX_+3A_armn">armn</code></td>
<td>
<p>number of arms in the trial with values up to 5. When <code>armn</code>=2,
only <code>par1</code> to <code>par2</code> need to be specified.
When <code>par1</code> to <code>par3</code> need to be specified.
When <code>par1</code> to <code>par4</code> need to be specified.
When <code>par1</code> to <code>par5</code> need to be specified.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_par1">par1</code></td>
<td>
<p>a vector of parameters including m, V, a, b for the arm with a Normal-Inverse-Chi-Squared prior
to calculate the allocation probability of.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_par2">par2</code></td>
<td>
<p>a vector of parameters including m, V, a, b for one of the remaining arms with a Normal-Inverse-Chi-Squared prior.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_par3">par3</code></td>
<td>
<p>a vector of parameters including m, V, a, b for one of the remaining arms with a Normal-Inverse-Chi-Squared prior.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_par4">par4</code></td>
<td>
<p>a vector of parameters including m, V, a, b for one of the remaining arms with a Normal-Inverse-Chi-Squared prior.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_par5">par5</code></td>
<td>
<p>a vector of parameters including m, V, a, b for one of the remaining arms with a Normal-Inverse-Chi-Squared prior.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pmax_NIX_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of formula <code class="reqn">Pr(\mu_k=max\{\mu_1,...,\mu_k\})</code> for
<code>side</code> equals to 'upper' and the results of formula <code class="reqn">Pr(\mu_k=min\{\mu_1,...,\mu_k\})</code> for
<code>side</code> equals to 'lower'. This function returns the probability that the posterior probability of arm
<code class="reqn">k</code> is maximal or minimal in trials with up to five arms. Parameters used in a Normal-Inverse-Gamma 
(<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>)
distribution should be converted to parameters equivalent in a Normal-Inverse-Chi-Squared
(<code class="reqn">(\mu,\sigma^2) \sim NIX(mean=\mu,effective sample size=\kappa,degrees of freedom=\nu,variance=\sigma^2/\kappa)</code>)
distribution using <code>convert_gamma_to_chisq</code> before applying this function.
</p>


<h3>Value</h3>

<p>a probability that a particular arm is the best in trials up to five arms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para&lt;-list(V=1/2,a=0.8,m=9.1,b=1/2)
par&lt;-convert_gamma_to_chisq(para)
set.seed(123451)
y1&lt;-rnorm(100,9.1,1)
par11&lt;-update_par_nichisq(y1, par)
set.seed(123452)
y2&lt;-rnorm(90,9,1)
par22&lt;-update_par_nichisq(y2, par)
set.seed(123453)
y3&lt;-rnorm(110,8.92,1)
par33&lt;-update_par_nichisq(y3, par)
y4&lt;-rnorm(120,8.82,1)
par44&lt;-update_par_nichisq(4, par)
pmax_NIX(armn=4,par1=par11,par2=par22,par3=par33,par4=par44,side='upper')
pmax_NIX(armn=4,par1=par11,par2=par22,par3=par33,par4=par44,side='lower')

para&lt;-list(V=1/2,a=0.5,m=9.1/100,b=0.00002)
par&lt;-convert_gamma_to_chisq(para)
set.seed(123451)
y1&lt;-rnorm(100,0.091,0.009)
par11&lt;-update_par_nichisq(y1, par)
set.seed(123452)
y2&lt;-rnorm(90,0.09,0.009)
par22&lt;-update_par_nichisq(y2, par)
set.seed(123453)
y3&lt;-rnorm(110,0.0892,0.009)
par33&lt;-update_par_nichisq(y3, par)
pmax_NIX(armn=3,par1=par11,par2=par22,par3=par33,side='upper')
pmax_NIX(armn=3,par1=par11,par2=par22,par3=par33,side='lower')
</code></pre>

<hr>
<h2 id='pmax_normal'>Posterior Probability that a Particular Arm is the Best for Continuous Endpoint with Known Variances</h2><span id='topic+pmax_normal'></span>

<h3>Description</h3>

<p>Calculate posterior probability that a particular arm is the best in a trial using Bayesian response-adaptive randomization with
a control group (the Thall <code class="reqn">\&amp;</code> Wathen method). The conjugate prior distributions follow Normal (<code class="reqn">N(mean,sd)</code>) distributions for 
continuous outcomes with known variance in each arm and can be specified individually.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmax_normal(
  armn,
  mean1 = NULL,
  sd1 = NULL,
  mean2 = NULL,
  sd2 = NULL,
  mean3 = NULL,
  sd3 = NULL,
  mean4 = NULL,
  sd4 = NULL,
  mean5 = NULL,
  sd5 = NULL,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmax_normal_+3A_armn">armn</code></td>
<td>
<p>number of arms in the trial with values up to 5. When <code>armn</code>=2,
only <code>mean1</code> to <code>mean2</code> and <code>sd1</code> to <code>sd2</code> need to be specified.
When <code>armn</code>=3, only <code>mean1</code> to <code>mean3</code> and <code>sd1</code> to <code>sd3</code> need to be specified.
When <code>armn</code>=4, only <code>mean1</code> to <code>mean4</code> and <code>sd1</code> to <code>sd4</code> need to be specified.
When <code>armn</code>=5, <code>mean1</code> to <code>mean5</code> and <code>sd1</code> to <code>sd5</code> need to be specified.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_mean1">mean1</code>, <code id="pmax_normal_+3A_sd1">sd1</code></td>
<td>
<p>mean and sd in Normal(mean,sd) for the arm to calculate the allocation probability of.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_mean2">mean2</code>, <code id="pmax_normal_+3A_sd2">sd2</code></td>
<td>
<p>mean and sd in Normal(mean,sd) for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_mean3">mean3</code>, <code id="pmax_normal_+3A_sd3">sd3</code></td>
<td>
<p>mean and sd in Normal(mean,sd) for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_mean4">mean4</code>, <code id="pmax_normal_+3A_sd4">sd4</code></td>
<td>
<p>mean and sd in Normal(mean,sd) for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_mean5">mean5</code>, <code id="pmax_normal_+3A_sd5">sd5</code></td>
<td>
<p>mean and sd in Normal(mean,sd) for one of the remaining arms.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="pmax_normal_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the results of formula <code class="reqn">Pr(\mu_k=max\{\mu_1,...,\mu_K\})</code> for
<code>side</code> equals to 'upper' and the results of formula <code class="reqn">Pr(\mu_k=min\{\mu_1,...,\mu_K\})</code> for
<code>side</code> equals to 'lower'. This function returns the probability that the posterior probability of arm
<code class="reqn">k</code> is maximal or minimal in trials with up to five arms.
</p>


<h3>Value</h3>

<p>a probability that a particular arm is the best in trials up to five arms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pmax_normal(armn=5,mean1=0.8,sd1=0.2,mean2=0.5,sd2=0.1,mean3=0.8,
sd3=0.5,mean4=0.6,sd4=0.2,mean5=0.6,sd5=0.2,side='upper')
pmax_normal(armn=4,mean1=8,sd1=2,mean2=8.5,sd2=2,mean3=8.3,
sd3=1.8,mean4=8.7,sd4=2,side='lower')
pmax_normal(armn=3,mean1=80,sd1=20,mean2=50,sd2=10,mean3=80,
sd3=15,side='upper')
</code></pre>

<hr>
<h2 id='sim_A_optimal_known_var'>Simulate a Trial Using A-Optimal Allocation for Continuous Endpoint with Known Variances</h2><span id='topic+sim_A_optimal_known_var'></span>

<h3>Description</h3>

<p><code>sim_A_optimal_known_var</code> simulates a trial for continuous endpoints with known variances,
and allocation ratios are fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_A_optimal_known_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_A_optimal_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of actual mean for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of actual standard deviation for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describes
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">tr[M^{-1}(\mathbf{\rho})]</code>
and minimize the overall variance of pairwise comparisons. It is generalized Neyman
allocation, specifically designed for continuous endpoints with known variances. With more 
than two arms the one-sided nominal level of each test is <code>alphaa</code> divided by 
<code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_A_optimal_known_var</code> returns an object of class &quot;aoptimal&quot;. An object of class &quot;aoptimal&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected,
Z test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>Author(s)</h3>

<p>Chuyao Xu, Thomas Lumley, Alain Vandal
</p>


<h3>References</h3>

<p>Sverdlov O, Rosenberger W (2013).
&ldquo;On Recent Advances in Optimal Allocation Designs in Clinical Trials.&rdquo;
<em>Journal of Statistical Theory and Practice</em>, <b>7</b>, 753-773.
<a href="https://doi.org/10.1080/15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a two-armed trial
sim_A_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N2=88,armn=2,
mean=c(9.1/100,9.1/100),sd=c(0.009,0.009),alphaa=0.025,armlabel = c(1,2),side='lower')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a two-armed trial
sim_A_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N2=88,armn=2,
mean=c(9.1/100,8.47/100),sd=c(0.009,0.009),alphaa=0.025,armlabel = c(1,2),side='lower')
</code></pre>

<hr>
<h2 id='sim_A_optimal_unknown_var'>Simulate a Trial Using A-Optimal Allocation for Continuous Endpoint with Unknown Variances</h2><span id='topic+sim_A_optimal_unknown_var'></span>

<h3>Description</h3>

<p><code>sim_A_optimal_unknown_var</code> simulates a trial for continuous endpoints with unknown variances,
and the allocation probabilities change based on results of accumulated participants in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_A_optimal_unknown_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of hypotheses of mean for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of hypotheses of standard deviation for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describes
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_A_optimal_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">tr[M^{-1}(\mathbf{\rho})]</code>
and to minimize the overall variance of pairwise comparisons. It is generalized Neyman
allocation, specifically designed for continuous endpoints with known variances.
With more than two arms the one-sided nominal level of each test is <code>alphaa</code>
divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_A_optimal_unknown_var</code> returns an object of class &quot;aoptimal&quot;. An object of class &quot;aoptimal&quot; is a list containing 
final decision based on the T test statistics with 1 stands for selected and 0 stands for not selected,
T test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>Author(s)</h3>

<p>Chuyao Xu, Thomas Lumley, Alain Vandal
</p>


<h3>References</h3>

<p>Sverdlov O, Rosenberger W (2013).
&ldquo;On Recent Advances in Optimal Allocation Designs in Clinical Trials.&rdquo;
<em>Journal of Statistical Theory and Practice</em>, <b>7</b>, 753-773.
<a href="https://doi.org/10.1080/15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a three-armed trial
sim_A_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,N1=12,N2=132,armn=3,
mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel = c(1,2,3),side='upper')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a three-armed trial
sim_A_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,N1=12,N2=132,armn=3,
mean=c(9.1/100,9.28/100,9.28/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel = c(1,2,3),side='upper')
</code></pre>

<hr>
<h2 id='sim_Aa_optimal_known_var'>Simulate a Trial Using Aa-Optimal Allocation for Continuous Endpoint with Known Variances</h2><span id='topic+sim_Aa_optimal_known_var'></span>

<h3>Description</h3>

<p><code>sim_Aa_optimal_known_var</code> simulates a trial for continuous endpoints with known variances,
and the allocation probabilities are fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_Aa_optimal_known_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of hypotheses of mean for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of hypotheses of standard deviation for allarms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describes
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">tr[A^TM^{-1}(\rho)A]</code>
and minimize the overall variance of pairwise comparisons. It is analogous to Neyman
allocation, favoring a higher allocation ratio to the control group. With more than two treatment 
groups the one-sided nominal level of each test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_Aa_optimal_known_var</code> returns an object of class &quot;Aaoptimal&quot;. An object of class &quot;Aaoptimal&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected,
Z test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Sverdlov O, Rosenberger W (2013).
&ldquo;On Recent Advances in Optimal Allocation Designs in Clinical Trials.&rdquo;
<em>Journal of Statistical Theory and Practice</em>, <b>7</b>, 753-773.
<a href="https://doi.org/10.1080/15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a two-armed trial
sim_Aa_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N2=88,armn=2,
mean=c(9.1/100,9.1/100),sd=c(0.009,0.009),alphaa=0.025,armlabel = c(1,2),side='lower')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a two-armed trial
sim_Aa_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N2=88,armn=2,
mean=c(9.1/100,8.47/100),sd=c(0.009,0.009),alphaa=0.025,armlabel = c(1,2),side='lower')
</code></pre>

<hr>
<h2 id='sim_Aa_optimal_unknown_var'>Simulate a Trial Using Aa-Optimal Allocation for Continuous Endpoint with Unknown Variances</h2><span id='topic+sim_Aa_optimal_unknown_var'></span>

<h3>Description</h3>

<p><code>sim_Aa_optimal_unknown_var</code> simulates a trial for continuous endpoints with unknown variances,
and the allocation probabilities change based on results of accumulated participants in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_Aa_optimal_unknown_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of hypotheses of mean for all arms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of hypotheses of standard deviation for allarms in the trial,
with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describes
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_Aa_optimal_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">tr[A^TM^{-1}(\rho)A]</code>
and minimize the overall variance of pairwise comparisons. It is analogous to Neyman
allocation, favoring a higher allocation ratio to the control group. With more than two treatment 
groups the one-sided nominal level of each test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_Aa_optimal_known_var</code> returns an object of class &quot;Aaoptimal&quot;. An object of class &quot;Aaoptimal&quot; is a list containing 
final decision based on the T test statistics with 1 stands for selected and 0 stands for not selected,
T test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>Author(s)</h3>

<p>Chuyao Xu, Thomas Lumley, Alain Vandal
</p>


<h3>References</h3>

<p>Sverdlov O, Rosenberger W (2013).
&ldquo;On Recent Advances in Optimal Allocation Designs in Clinical Trials.&rdquo;
<em>Journal of Statistical Theory and Practice</em>, <b>7</b>, 753-773.
<a href="https://doi.org/10.1080/15598608.2013.783726">doi:10.1080/15598608.2013.783726</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a three-armed trial
sim_Aa_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,N1=12,N2=132,armn=3,
mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel = c(1,2,3),side='upper')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a three-armed trial
sim_Aa_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,N1=12,N2=132,armn=3,
mean=c(9.1/100,9.28/100,9.28/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel = c(1,2,3),side='upper')
</code></pre>

<hr>
<h2 id='sim_brar_binary'>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Binary Outcomes</h2><span id='topic+sim_brar_binary'></span>

<h3>Description</h3>

<p><code>sim_brar_binary</code> simulate a trial with two to five arms using Bayesian Response-Adaptive 
Randomization with a control group for binary outcomes. The conjugate prior distributions follow Beta
(<code class="reqn">Beta(\alpha,\beta)</code>) distributions and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_brar_binary(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  h,
  au,
  N2,
  tp,
  armlabel,
  blocksize,
  alpha1 = 1,
  beta1 = 1,
  alpha2 = alpha1,
  beta2 = beta1,
  alpha3 = alpha1,
  beta3 = beta1,
  alpha4 = alpha1,
  beta4 = beta1,
  alpha5 = alpha1,
  beta5 = beta1,
  minstart,
  deltaa,
  tpp = 0,
  deltaa1,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_brar_binary_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_h">h</code></td>
<td>
<p>a vector of success probabilities in hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probabilities
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_au">au</code></td>
<td>
<p>a vector of cut-off values in the final selection at the end of the trial,
with a length equal to the number of arms minus 1.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_alpha1">alpha1</code>, <code id="sim_brar_binary_+3A_beta1">beta1</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code>, prior for arm 1 which
stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_alpha2">alpha2</code>, <code id="sim_brar_binary_+3A_beta2">beta2</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code>, prior for arm 2.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_alpha3">alpha3</code>, <code id="sim_brar_binary_+3A_beta3">beta3</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 3.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_alpha4">alpha4</code>, <code id="sim_brar_binary_+3A_beta4">beta4</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 4.
Default value is set to <code>alpha1</code> and <code>beta1</code>..</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_alpha5">alpha5</code>, <code id="sim_brar_binary_+3A_beta5">beta5</code></td>
<td>
<p><code class="reqn">\alpha</code> and <code class="reqn">\beta</code> in the <code class="reqn">Beta(\alpha,\beta)</code> prior for arm 5.
Default value is set to <code>alpha1</code> and <code>beta1</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="sim_brar_binary_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a designed trial using Bayesian response-adaptive randomization with
a control group under no delay and delayed scenarios for binary outcomes. The function can handle trials with up to
5 arms. This function uses the formula
<code class="reqn">\frac{Pr(p_k=max\{p_1,...,p_K\})^{tp}} {\sum_{k=1}^{K}{Pr(p_k=max\{p_1,...,p_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(p_k=min\{p_1,...,p_K\})^{tp}} {\sum_{k=1}^{K}{Pr(p_k=min\{p_1,...,p_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_brar_binary</code> returns an object of class &quot;brar&quot;. An object of class &quot;brar&quot; is a list containing 
final decision, test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' results. In the final decision, 'Superiorityfinal' refers to the selected arm, 
while 'Not Selected' indicates the arm stopped due to futility, and 'Control Selected' denotes the control arm chosen 
because other arms did not meet futility criteria before the final stage or were not deemed effective at the final stage. 
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#sim_brar_binary with delayed responses follow a normal distribution with a mean
#of 30 days and a standard deviation of 3 days, where h1=c(0.2,0.4) and tp=0.5.
sim_brar_binary(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),
enrollrate=0.1,N1=24,armn=2,h=c(0.2,0.4),au=0.36,N2=224,tp=0.5,armlabel=c(1,2),blocksize=4,
alpha1=1,beta1=1,alpha2=1,beta2=1,minstart=24,deltaa=-0.01,tpp=0,deltaa1=0.1,side='upper')
</code></pre>

<hr>
<h2 id='sim_brar_known_var'>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Known Variances</h2><span id='topic+sim_brar_known_var'></span>

<h3>Description</h3>

<p><code>sim_brar_known_var</code> simulate a trial with two to five arms using Bayesian Response-Adaptive 
Randomization with a control group for continuous outcomes with known variances. The conjugate prior distributions follow
Normal (<code class="reqn">N(mean,sd)</code>) distributions and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_brar_known_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  au,
  N2,
  tp,
  armlabel,
  blocksize,
  mean,
  sd,
  minstart,
  deltaa,
  tpp,
  deltaa1,
  mean10 = 0,
  mean20 = mean10,
  mean30 = mean10,
  mean40 = mean10,
  mean50 = mean10,
  sd10 = 1,
  sd20 = sd10,
  sd30 = sd10,
  sd40 = sd10,
  sd50 = sd10,
  n10 = 1,
  n20 = n10,
  n30 = n10,
  n40 = n10,
  n50 = n10,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_brar_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_au">au</code></td>
<td>
<p>a vector of cut-off values in the final selection at the end of the trial,
with a length equal to the number of arms minus 1.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of treatment labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of means in hypotheses, for example, as c(10,10) where 10 stands for the mean
in both groups. Another example is c(10,12) where 10 and 12 stand for the mean
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviations in hypotheses, for example, as c(2,2) where 2 stands for the standard deviation
in both groups. Another example is c(1,2) where 1 and 2 stand for the standard deviation
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean10">mean10</code>, <code id="sim_brar_known_var_+3A_sd10">sd10</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 1 in the trial, which stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean20">mean20</code>, <code id="sim_brar_known_var_+3A_sd20">sd20</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 2 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean30">mean30</code>, <code id="sim_brar_known_var_+3A_sd30">sd30</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 3 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean40">mean40</code>, <code id="sim_brar_known_var_+3A_sd40">sd40</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 4 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_mean50">mean50</code>, <code id="sim_brar_known_var_+3A_sd50">sd50</code></td>
<td>
<p>prior mean and sd in <code class="reqn">N(mean,sd)</code> of arm 5 in the trial. Default value is set to <code>mean10</code> and <code>sd10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n10">n10</code></td>
<td>
<p>explicit prior n of arm 1 in the trial, which stands for the control. Default value is set to 1.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n20">n20</code></td>
<td>
<p>explicit prior n of arm 2 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n30">n30</code></td>
<td>
<p>explicit prior n of arm 3 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n40">n40</code></td>
<td>
<p>explicit prior n of arm 4 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_n50">n50</code></td>
<td>
<p>explicit prior n of arm 5 in the trial. Default value is set to <code>n10</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="sim_brar_known_var_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a designed trial using Bayesian response-adaptive randomization with
a control group under no delay and delayed scenarios for continuous outcomes with known variances. The function can handle trials with up to
5 arms. This function uses the formula
<code class="reqn">\frac{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(\mu_k=min\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=min\{\mu_1,...,\mu_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_brar_known_var</code> returns an object of class &quot;brar&quot;. An object of class &quot;brar&quot; is a list containing 
final decision, test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' results. In the final decision, 'Superiorityfinal' refers to the selected arm, 
while 'Not Selected' indicates the arm stopped due to futility, and 'Control Selected' denotes the control arm chosen 
because other arms did not meet futility criteria before the final stage or were not deemed effective at the final stage. 
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Wathen J, Thall P (2017).
&ldquo;A simulation study of outcome adaptive randomization in multi-arm clinical trials.&rdquo;
<em>Clinical Trials</em>, <b>14</b>, 174077451769230.
<a href="https://doi.org/10.1177/1740774517692302">doi:10.1177/1740774517692302</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#sim_brar_known_var with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days, where mean=c(8.9/100,8.74/100,8.74/100),
#sd=c(0.009,0.009,0.009), tp=0.5 and the minimal effect size is 0.
sim_brar_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length(vStartTime),30, 3)),enrollrate=0.1, N1=21,armn=3,au=c(0.973,0.973),
N2=189,tp=0.5,armlabel=c(1,2,3),blocksize=6,mean=c(8.9/100,8.74/100,8.74/100),
sd=c(0.009,0.009,0.009),minstart=21,deltaa=c(0.0005,0.0005),tpp=0,deltaa1=c(0,0),
mean10=0.09,mean20=0.09,mean30=0.09,sd10=0.01,sd20=0.01,sd30=0.01,n10=1,n20=1,n30=1,side='lower')
</code></pre>

<hr>
<h2 id='sim_brar_unknown_var'>Simulate a Trial Using Bayesian Response-Adaptive Randomization with a Control Group for Continuous Endpoint with Unknown Variances</h2><span id='topic+sim_brar_unknown_var'></span>

<h3>Description</h3>

<p><code>sim_brar_unknown_var</code> simulate a trial with two to five arms using Bayesian Response-Adaptive 
Randomization with a control group for continuous outcomes with unknown variances. The conjugate prior distributions
follow Normal-Inverse-Gamma (NIG) (<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>) 
distributions and can be specified individually for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_brar_unknown_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  armn,
  au,
  N2,
  tp,
  armlabel,
  blocksize,
  mean = 0,
  sd = 1,
  minstart,
  deltaa,
  tpp,
  deltaa1,
  V01,
  a01,
  b01,
  m01,
  V02 = V01,
  V03 = V01,
  V04 = V01,
  V05 = V01,
  a02 = a01,
  a03 = a01,
  a04 = a01,
  a05 = a01,
  b02 = b01,
  b03 = b01,
  b04 = b01,
  b05 = b01,
  m02 = m01,
  m03 = m01,
  m04 = m01,
  m05 = m01,
  side,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_brar_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_au">au</code></td>
<td>
<p>a vector of cut-off values in the final selection at the end of the trial,
with a length equal to the number of arms minus 1.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_tp">tp</code></td>
<td>
<p>tuning parameter. Some commonly used numbers are 0.5, 1 and n/2N.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of treatment labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_blocksize">blocksize</code></td>
<td>
<p>size of block used for equal randomization regarding participants in the 'initialization' period.
Recommend to be an even multiple of the number of total arms.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of means in hypotheses, for example, as c(10,10) where 10 stands for the mean
in both groups. Another example is c(10,12) where 10 and 12 stand for the mean
for the control and the other treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviations in hypotheses, for example, as c(2,2) where 2 stands for the standard deviation
in both groups. Another example is c(1,2) where 1 and 2 stand for the standard deviation
for the control and the other treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_minstart">minstart</code></td>
<td>
<p>a specified number of participants when one starts to check decision rules.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_deltaa">deltaa</code></td>
<td>
<p>a vector of minimal effect expected to be observed for early futility stopping in
each arm is approximately <code class="reqn">1\%</code>. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_tpp">tpp</code></td>
<td>
<p>indicator of <code>tp</code> equals to n/2N. When <code>tp</code> is n/2N, <code>tpp</code> should be assigned 1. Default value is set to 0.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_deltaa1">deltaa1</code></td>
<td>
<p>a vector of pre-specified minimal effect size expected to be observed at the final stage
for each arm. The length of this parameter is <code>armn</code>-1.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_v01">V01</code>, <code id="sim_brar_unknown_var_+3A_a01">a01</code>, <code id="sim_brar_unknown_var_+3A_b01">b01</code>, <code id="sim_brar_unknown_var_+3A_m01">m01</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 1 in the trial, which stands for the control.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_v02">V02</code>, <code id="sim_brar_unknown_var_+3A_a02">a02</code>, <code id="sim_brar_unknown_var_+3A_b02">b02</code>, <code id="sim_brar_unknown_var_+3A_m02">m02</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 2 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_v03">V03</code>, <code id="sim_brar_unknown_var_+3A_a03">a03</code>, <code id="sim_brar_unknown_var_+3A_b03">b03</code>, <code id="sim_brar_unknown_var_+3A_m03">m03</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 3 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_v04">V04</code>, <code id="sim_brar_unknown_var_+3A_a04">a04</code>, <code id="sim_brar_unknown_var_+3A_b04">b04</code>, <code id="sim_brar_unknown_var_+3A_m04">m04</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 4 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_v05">V05</code>, <code id="sim_brar_unknown_var_+3A_a05">a05</code>, <code id="sim_brar_unknown_var_+3A_b05">b05</code>, <code id="sim_brar_unknown_var_+3A_m05">m05</code></td>
<td>
<p>prior parameters m, V, a, b in <code class="reqn">NIG(V,m,a,b)</code> of arm 5 in the trial. Default value is set to <code>V01</code>,
<code>a01</code>, <code>b01</code> and <code>m01</code>.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="sim_brar_unknown_var_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code><a href="stats.html#topic+integrate">integrate</a></code> (such as rel.tol) from this function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function generates a designed trial using Bayesian response-adaptive randomization with
a control group under no delay and delayed scenarios for continuous outcomes with unknown variances. 
The function can handle trials with up to 5 arms. This function uses the formula
<code class="reqn">\frac{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=max\{\mu_1,...,\mu_K\})^{tp}}}</code> with <code>side</code> equals to 'upper',
and <code class="reqn">\frac{Pr(\mu_k=min\{\mu_1,...,\mu_K\})^{tp}} {\sum_{k=1}^{K}{Pr(\mu_k=min\{\mu_1,...,\mu_K\}){tp}}}</code> 
with <code>side</code> equals to 'lower', utilizing available data at each step.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_brar_unknown_var</code> returns an object of class &quot;brar&quot;. An object of class &quot;brar&quot; is a list containing 
final decision, test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' results. In the final decision, 'Superiorityfinal' refers to the selected arm, 
while 'Not Selected' indicates the arm stopped due to futility, and 'Control Selected' denotes the control arm chosen 
because other arms did not meet futility criteria before the final stage or were not deemed effective at the final stage. 
Note that before final stage of the trial, test statistics is calculated from <code>deltaa</code>, and test statistics is
calculated from <code>deltaa1</code> at the final stage.
</p>


<h3>References</h3>

<p>Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#sim_brar_unknown_var with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under the null hypothesis,
#where mean=c(9.19/100,8.74/100,8.74/100), sd=c(0.009,0.009,0.009), tp=1 and 
#the minimal effect size is 0.
sim_brar_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length(vStartTime ),30,3)),enrollrate=0.1, N1=48,armn=3,au=c(0.85,0.85),
N2=480,tp=1,armlabel=c(1, 2,3),blocksize=6,mean=c(9.19/100,8.74/100,8.74/100),
sd=c(0.009,0.009,0.009), minstart=48,deltaa=c(-0.000325,-0.000325),
tpp=0,deltaa1=c(0,0),V01=1/2,a01=0.3,m01=9/100,b01=0.00001,side='lower')
</code></pre>

<hr>
<h2 id='sim_dabcd_max_power'>Simulate a Trial Using Doubly Adaptive Biased Coin Design with Maximal Power Strategy for Binary Endpoint</h2><span id='topic+sim_dabcd_max_power'></span>

<h3>Description</h3>

<p><code>sim_dabcd_max_power</code> can be used for doubly adaptive biased coin design with maximal power
strategy for binary outcomes, targeting generalized Neyman allocation and generalized RSIHR allocation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_dabcd_max_power(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  armlabel,
  h,
  BB,
  type,
  gamma = 2,
  alphaa = 0.025,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_dabcd_max_power_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the burn-in period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describes
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_h">h</code></td>
<td>
<p>a vector of success probabilities in hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probabilities
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_bb">BB</code></td>
<td>
<p>the minimal allocation probabilities for each arm, which is within the
range of <code class="reqn">[0,1/armn]</code>.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_type">type</code></td>
<td>
<p>allocation type, with choices from 'RSIHR' and 'Neyman'.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_gamma">gamma</code></td>
<td>
<p>tuning parameter in Hu &amp; Zhang's formula. When dabcd=0, this parameter does not need
to be specified. Default value is set to 2.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_dabcd_max_power_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function simulates a trial for doubly adaptive biased coin design with maximal power strategy targeting
generalized Neyman allocation with 2-5 arms which is provided in (Tymofyeyev et al. 2007) and
generalized RSIHR allocation with 2-3 arms which is provided in (Jeon and Feifang 2010), with modifications for typos
in (Sabo and Bello 2016). All of those methods are not smoothed. The output of this function is based on Hu <code>\&amp;</code> Zhang's formula (Hu and Zhang 2004).
With more than two armd the one-sided nominal level of each test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_dabcd_max_power</code> returns an object of class &quot;dabcd&quot;. An object of class &quot;dabcd&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected,
Z test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Hu F, Zhang L (2004).
&ldquo;Asymptotic Properties of Doubly Adaptive Biased Coin Designs for Multitreatment Clinical Trials.&rdquo;
<em>The Annals of Statistics</em>, <b>32</b>(1), 268&ndash;301.
Tymofyeyev Y, Rosenberger WF, Hu F (2007).
&ldquo;Implementing Optimal Allocation in Sequential Binary Response Experiments.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>102</b>(477), 224-234.
<a href="https://doi.org/10.1198/016214506000000906">doi:10.1198/016214506000000906</a>.
Jeon Y, Feifang H (2010).
&ldquo;Optimal Adaptive Designs for Binary Response Trials With Three Treatments.&rdquo;
<em>Statistics in Biopharmaceutical Research</em>, <b>2</b>, 310-318.
<a href="https://doi.org/10.1198/sbr.2009.0056">doi:10.1198/sbr.2009.0056</a>.
Sabo R, Bello G (2016).
&ldquo;Optimal and lead-in adaptive allocation for binary outcomes: a comparison of Bayesian methodologies.&rdquo;
<em>Communications in Statistics - Theory and Methods</em>, <b>46</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_dabcd_max_power(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length( vStartTime ),30, 3)),enrollrate=0.9,N1=30,N2=300,armn=3,
armlabel=c(1,2,3),h=c(0.2,0.3,0.2),BB=0.1,type='Neyman',
side='upper')
sim_dabcd_max_power(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length( vStartTime ),60, 3)),enrollrate=0.1,N1=50,N2=500,armn=3,
armlabel=c(1,2,3),h=c(0.2,0.3,0.3),BB=0.15,type='RSIHR',
side='upper')

</code></pre>

<hr>
<h2 id='sim_dabcd_min_var'>Simulate a Trial Using Doubly Adaptive Biased Coin Design with Minmial Variance Strategy for Binary Endpoint</h2><span id='topic+sim_dabcd_min_var'></span>

<h3>Description</h3>

<p><code>sim_dabcd_min_var</code> can be used for doubly adaptive biased coin design with minimal variance
strategy for binary outcomes, targeting generalized Neyman allocation and generalized RSIHR allocation
with 2-5 arms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_dabcd_min_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  armlabel,
  h,
  type,
  gamma = 2,
  alphaa = 0.025,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_dabcd_min_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_h">h</code></td>
<td>
<p>a vector of success probabilities in hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probabilities
for the control and the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_type">type</code></td>
<td>
<p>allocation type, with choices from 'RSIHR' and 'Neyman'.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_gamma">gamma</code></td>
<td>
<p>tuning parameter in Hu &amp; Zhang's formula ((Hu and Zhang 2004)). When dabcd=0, this parameter does not need
to be specified. Default value is set to 2.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_dabcd_min_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output of this function is based on Hu <code>\&amp;</code> Zhang's formula (Hu and Zhang 2004).
With more than two arms the one-sided nominal level of each
test is <code>alphaa</code> divided by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_dabcd_min_var</code> returns an object of class &quot;dabcd&quot;. An object of class &quot;dabcd&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected,
Z test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Hu F, Zhang L (2004).
&ldquo;Asymptotic Properties of Doubly Adaptive Biased Coin Designs for Multitreatment Clinical Trials.&rdquo;
<em>The Annals of Statistics</em>, <b>32</b>(1), 268&ndash;301.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sim_dabcd_min_var(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length( vStartTime ),30, 3)),enrollrate=0.9,N1=30,N2=300,armn=3,
armlabel=c(1,2,3),h=c(0.2,0.3,0.2),type='Neyman',
side='upper')
sim_dabcd_min_var(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm(
length( vStartTime ),60, 3)),enrollrate=0.1,N1=50,N2=500,armn=3,
armlabel=c(1,2,3),h=c(0.2,0.3,0.3),type='RSIHR',
side='lower')
</code></pre>

<hr>
<h2 id='sim_flgi_binary'>Simulate a Trial Using Forward-Looking Gittins Index for Binary Endpoint</h2><span id='topic+sim_flgi_binary'></span>

<h3>Description</h3>

<p>Function for simulating a trial using the forward-looking Gittins Index rule and the controlled forward-looking
Gittins Index rule for binary outcomes in trials with 2-5 arms. The conjugate prior distributions
follow Beta (<code class="reqn">Beta(\alpha,\beta)</code>) distributions and should be the same for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_flgi_binary(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  I0,
  K,
  noRuns2 = 100,
  Tsize,
  ptrue,
  block,
  rule,
  ztype,
  stopbound,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_flgi_binary_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'binary' in this function.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0, 0.5, 0.7, 0.99 and 0.995. The maximal sample size can be up to 2000.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. Recommend using the
<code>bmab_gi_multiple_ab</code> function from <code>gittins</code> package. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_i0">I0</code></td>
<td>
<p>a matrix with K rows and 2 columns, where the numbers inside are equal to the prior parameters, and
K is equal to the total number of arms. For example, matrix(1,nrow=2,ncol=2) means that the prior
distributions for two-armed trials are beta(1,1); matrix(c(2,3),nrow=2,ncol=2,byrow = TRUE) means that the prior
distributions for two-armed trials are beta(2,3). The first column represents the prior of the number of successes,
and the second column represents the prior of the number of failures.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100, which is recommended in (Villar et al. 2015).</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_ptrue">ptrue</code></td>
<td>
<p>a vector of hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probability for the control and
the treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_ztype">ztype</code></td>
<td>
<p>Z test statistics, with choice of values from 'pooled' and 'unpooled'.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_stopbound">stopbound</code></td>
<td>
<p>the cut-off value for Z test statistics, which is simulated under the null hypothesis.</p>
</td></tr>
<tr><td><code id="sim_flgi_binary_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates a trial using the forward-looking Gittins Index rule or the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios.
The cut-off value used for <code>stopbound</code> is obtained by simulations using <code>flgi_stop_bound_binary</code>.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_flgi_binary</code> returns an object of class &quot;flgi&quot;. An object of class &quot;flgi&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected, final decision based on 
the maximal Gittins Index value at the final stage, Z test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial. The simulated data set includes 5 columns: participant ID number, enrollment time, 
observed time of results, allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Villar S, Wason J, Bowden J (2015).
&ldquo;Response-Adaptive Randomization for Multi-arm Clinical Trials Using the Forward Looking Gittins Index Rule.&rdquo;
<em>Biometrics</em>, <b>71</b>.
<a href="https://doi.org/10.1111/biom.12337">doi:10.1111/biom.12337</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal distribution
#with a mean of 60 days and a standard deviation of 3 days

sim_flgi_binary(Gittinstype='Binary',df=0.5,Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),60, 3)),enrollrate=0.9,I0= matrix(1,nrow=2,2),
K=2,Tsize=992,ptrue=c(0.6,0.7),block=20,rule='FLGI PM',ztype='unpooled',
stopbound=1.9991,side='upper')
</code></pre>

<hr>
<h2 id='sim_flgi_known_var'>Simulate a Trial Using Forward-Looking Gittins Index for Continuous Endpoint with Known Variances</h2><span id='topic+sim_flgi_known_var'></span>

<h3>Description</h3>

<p>Function for simulating a trial using the forward-looking Gittins Index rule and the controlled forward-looking
Gittins Index rule for continuous outcomes with known variances in trials with 2-5 arms. The conjugate prior distributions
follow Normal (<code class="reqn">N(mean,sd)</code>) distributions and should be the same for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_flgi_known_var(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  K,
  noRuns2,
  Tsize,
  block,
  rule,
  prior_n,
  prior_mean,
  stopbound,
  mean,
  sd,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_flgi_known_var_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'KV' in this function.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99 and 0.995. The maximal sample size can be up to 10000.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100, which is recommended in (Villar et al. 2015).</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_prior_n">prior_n</code></td>
<td>
<p>a vector representing the number of observations assumed in prior distributions, eg: c(1,1) for a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_prior_mean">prior_mean</code></td>
<td>
<p>a vector representing mean of observations assumed in prior distributions, eg: c(0,0,0) for a three-armed trial,
rep(0,K) can be used to simplify the process. If a negative effect is expected, adjust the mean to a negative value.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_stopbound">stopbound</code></td>
<td>
<p>the cut-off value for Z test statistics, which is simulated under the null hypothesis.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of mean hypotheses, for example, c(0.1,0.1) where 0.1 stands for the mean
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the mean for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviation in hypotheses, for example, as c(0.64,0.64) where 0.64 stands for the standard deviation
for both groups. Another example is c(0.64,0.4) where 0.64 and 0.4 stand for the standard deviation for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_flgi_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates a trial using the forward-looking Gittins Index rule or the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios.
The cut-off value used for <code>stopbound</code> is obtained by simulations using <code>flgi_stop_bound_flgi_known_var</code>.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_flgi_known_var</code> returns an object of class &quot;flgi&quot;. An object of class &quot;flgi&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected, final decision based on 
the maximal Gittins Index value at the final stage, Z test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial. The simulated data set includes 5 columns: participant ID number, enrollment time, 
observed time of results, allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Williamson SF, Villar S (2019).
&ldquo;A Response‐Adaptive Randomization Procedure for Multi‐Armed Clinical Trials with Normally Distributed Outcomes.&rdquo;
<em>Biometrics</em>, <b>76</b>.
<a href="https://doi.org/10.1111/biom.13119">doi:10.1111/biom.13119</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal distribution
#with a mean of 30 days and a standard deviation of 3 days

sim_flgi_known_var(Gittinstype='KV',df=0.995,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),enrollrate=0.5,
K=3,noRuns2=100,Tsize=852,block=20,rule='FLGI PM',prior_n=rep(1,3),
prior_mean=rep(9/100,3),stopbound=(-2.1725),mean=c(9.1/100,8.83/100,8.83/100),
sd=c(0.009,0.009,0.009),side='lower')

#The controlled forward-looking Gittins Index rule with delayed responses follow a 
#normal distribution with a mean of 30 days and a standard deviation of 3 days

sim_flgi_known_var(Gittinstype='KV',df=0.995,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),enrollrate=0.1,
K=3,noRuns2=100,Tsize=852,block=20,rule='CFLGI',prior_n=rep(1,3),
prior_mean=rep(9/100,3),stopbound=(-2.075),mean=c(9.1/100,8.83/100,8.83/100),
sd=c(0.009,0.009,0.009),side='lower')

</code></pre>

<hr>
<h2 id='sim_flgi_unknown_var'>Simulate a Trial Using Forward-Looking Gittins Index for Continuous Endpoint with Unknown Variances</h2><span id='topic+sim_flgi_unknown_var'></span>

<h3>Description</h3>

<p>Function for simulating a trial using the forward-looking Gittins Index rule and the controlled forward-looking
Gittins Index rule for continuous outcomes with unknown variances in trials with 2-5 arms. The prior distributions
follow Normal-Inverse-Gamma (NIG) (<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>) 
distributions and should be the same for each arm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_flgi_unknown_var(
  Gittinstype,
  df,
  gittins = NULL,
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  K,
  noRuns2,
  Tsize,
  block,
  rule,
  prior_n,
  prior_mean1,
  prior_sd1,
  stopbound,
  mean,
  sd,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_flgi_unknown_var_+3A_gittinstype">Gittinstype</code></td>
<td>
<p>type of Gittins indices, should be set to 'UNKV' in this function</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_df">df</code></td>
<td>
<p>discount factor which is the multiplier for loss at each additional patient in the future.
Available values are 0.5, 0.6, 0.7, 0.8, 0.9, 0.95, 0.99 and 0.995. The maximal sample size can be up to 10000.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_gittins">gittins</code></td>
<td>
<p>user specified Gittins indices for calculation in this function. If <code>gittins</code> is provided,
<code>Gittinstype</code> and <code>df</code> should be NULL.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_k">K</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_noruns2">noRuns2</code></td>
<td>
<p>number of simulations for simulated allocation probabilities within each block. Default value is
set to 100 times, which is recommended in Villar et al., 2015.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_tsize">Tsize</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_block">block</code></td>
<td>
<p>block size.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_rule">rule</code></td>
<td>
<p>rules can be used in this function, with values 'FLGI PM', 'FLGI PD' or 'CFLGI'.
'FLGI PM' stands for making decision based on posterior mean;
'FLGI PD' stands for making decision based on posterior distribution;
'CFLGI' stands for controlled forward-looking Gittins Index.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_prior_n">prior_n</code></td>
<td>
<p>a vector representing the number of observations assumed in prior distribution, eg: c(1,1) for a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_prior_mean1">prior_mean1</code></td>
<td>
<p>a vector representing mean of observations assumed in prior distributions, eg: c(0,0,0) for a three-armed trial,
rep(0,K) can be used to simplify the process. If a negative effect is expected, adjust the mean to a negative value.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_prior_sd1">prior_sd1</code></td>
<td>
<p>a vector representing the standard deviation of observations assumed in prior distribution, eg: rep(1,3) for a three-armed trial.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_stopbound">stopbound</code></td>
<td>
<p>the cut-off value for T test statistics, which is simulated under the null hypothesis.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of mean hypotheses, for example, as c(0.1,0.1) where 0.1 stands for the mean
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the mean for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of standard deviation hypotheses, for example, as c(0.64,0.64) where 0.64 stands for the standard deviation
for both groups. Another example is c(0.64,0.4) where 0.64 and 0.4 stand for the standard deviation for the control and
a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_flgi_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates a trial using the forward-looking Gittins Index rule or the
controlled forward-looking Gittins Index rule under both no delay and delayed scenarios.
The cut-off value used for <code>stopbound</code> is obtained by simulations using <code>flgi_stop_bound_flgi_unk_var</code>.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_flgi_unknown_var</code> returns an object of class &quot;flgi&quot;. An object of class &quot;flgi&quot; is a list containing 
final decision based on the T test statistics with 1 stands for selected and 0 stands for not selected, final decision based on 
the maximal Gittins Index value at the final stage, T test statistics, the simulated data set and participants accrued for each arm 
at the time of termination of that group in one trial. The simulated data set includes 5 columns: participant ID number, enrollment time, 
observed time of results, allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Williamson SF, Villar S (2019).
&ldquo;A Response‐Adaptive Randomization Procedure for Multi‐Armed Clinical Trials with Normally Distributed Outcomes.&rdquo;
<em>Biometrics</em>, <b>76</b>.
<a href="https://doi.org/10.1111/biom.13119">doi:10.1111/biom.13119</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The forward-looking Gittins Index rule with delayed responses follow a normal 
#with a mean of 60 days and a standard deviation of 3 days

sim_flgi_unknown_var(Gittinstype='UNKV',df=0.5,Pats=10,nMax=50000,
TimeToOutcome=expression(rnorm( length( vStartTime ),60, 3)),enrollrate=0.9,
K=3,noRuns2=100,Tsize=852,block=20,rule='FLGI PM',prior_n=rep(2,3),
prior_mean1=rep(9/100,3),stopbound=(-1.9298),prior_sd1=rep(0.006324555,3),
mean=c(9.1/100,8.83/100,8.83/100),sd=c(0.009,0.009,0.009),side='lower')
</code></pre>

<hr>
<h2 id='sim_RPTW'>Simulate a Trial Using Randomized Play-the-Winner Rule for Binary Endpoint</h2><span id='topic+sim_RPTW'></span>

<h3>Description</h3>

<p>Simulate randomized play-the-winner rule in a two-armed trial with binary endpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_RPTW(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  na0,
  nb0,
  na1,
  nb1,
  h,
  alphaa = 0.025,
  N2,
  side,
  Z = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_RPTW_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_na0">na0</code>, <code id="sim_RPTW_+3A_nb0">nb0</code></td>
<td>
<p>the initial number of balls in the urn represents the control group and the treatment group.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_na1">na1</code>, <code id="sim_RPTW_+3A_nb1">nb1</code></td>
<td>
<p>additional number of balls represents the control group and the treatment group added to 
the urn after the result of each participant.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_h">h</code></td>
<td>
<p>a vector of hypothesis, for example, as c(0.1,0.1) where 0.1 stands for the success probability
for both groups. Another example is c(0.1,0.3) where 0.1 and 0.3 stand for the success probabilities
for the control and a treatment group, respectively.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
<tr><td><code id="sim_RPTW_+3A_z">Z</code></td>
<td>
<p>the selected cut-off value. Only specified Z when the cut-off value is selected by simulations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates trials using the randomized play-the-winner
rule under both no delay and delayed scenarios. This method is a type of urn design 
with the motivation to allocate more participants to the better treatment group.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_RPTW</code> returns an object of class &quot;rptw&quot;. An object of class &quot;rptw&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected, 
Z test statistics, the simulated data set and participants accrued for each arm at the time of termination
of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result with 1 stand for selected and 0 stand for not selected.
</p>


<h3>References</h3>

<p>Wei LJ, Durham S (1978).
&ldquo;The Randomized Play-the-Winner Rule in Medical Trials.&rdquo;
<em>Journal of the American Statistical Association</em>, <b>73</b>(364), 840&ndash;843.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#sim_RPTW with no delay responses
sim_RPTW(Pats=10,nMax=50000,TimeToOutcome=0,enrollrate=0.9,na0=1,nb0=1,na1=1,nb1=1,
h=c(0.1,0.3),alphaa=0.025,N2=168,side='upper')
#sim_RPTW with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days
sim_RPTW(Pats=10,nMax=50000,TimeToOutcome=expression(rnorm( length( vStartTime ),30, 3)),
enrollrate=0.9,na0=1,nb0=1,na1=1,nb1=1,h=c(0.1,0.3),alphaa=0.025,N2=168,side='upper')
</code></pre>

<hr>
<h2 id='sim_RSIHR_optimal_known_var'>Simulate a Trial Using Generalized RSIHR Allocation for Continuous Endpoint with Known Variances</h2><span id='topic+sim_RSIHR_optimal_known_var'></span>

<h3>Description</h3>

<p><code>sim_RSIHR_optimal_known_var</code> simulates a trial for continuous endpoints with known variances,
and the allocation probabilities are fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_RSIHR_optimal_known_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  cc,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_mean">mean</code></td>
<td>
<p>a vector of hypotheses of mean, with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_sd">sd</code></td>
<td>
<p>a vector of hypotheses of standard deviation with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_cc">cc</code></td>
<td>
<p>value in the formula of measure of treatment effectiveness, usually take the average
of mean responses in the hypotheses. <code>cc</code> is the same as C in the details.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_known_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">\sum_{i=1}^{K}n_i\Psi_i</code>
with constraints <code class="reqn">\frac{\sigma_1^2}{n_1}+\frac{\sigma_k^2}{n_k}\leq C</code>, where <code class="reqn">k=2,...,K</code>
for some fixed C. It is equivalent to generalized RSIHR allocation for continuous endpoints with known variances.
With more than two arms the one-sided nominal level of each test is <code>alphaa</code> divided 
by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_RSIHR_optimal_known_var</code> returns an object of class &quot;RSIHRoptimal&quot;. An object of class &quot;RSIHRoptimal&quot; is a list containing 
final decision based on the Z test statistics with 1 stands for selected and 0 stands for not selected,
Z test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Biswas A, Mandal S, Bhattacharya R (2011).
&ldquo;Multi-treatment optimal response-adaptive designs for phase III clinical trials.&rdquo;
<em>Journal of the Korean Statistical Society</em>, <b>40</b>(1), 33-44.
ISSN 1226-3192, <a href="https://doi.org/10.1016/j.jkss.2010.04.004">doi:10.1016/j.jkss.2010.04.004</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a three-armed trial
sim_RSIHR_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N1=9,N2=132,armn=3,
mean=c(9.1/100,9.1/100,9.1/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel=c(1,2,3),cc=mean(c(9.1/100,9.1/100,9.1/100)),side='lower')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a three-armed trial
sim_RSIHR_optimal_known_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm(length( vStartTime ),30, 3)),enrollrate=0.9,N1=9,N2=132,armn=3,
mean=c(9.1/100,8.47/100,8.47/100),sd=c(0.009,0.009,0.009),alphaa=0.025,
armlabel=c(1,2,3),cc=mean(c(9.1/100,8.47/100,8.47/100)),side='lower')
</code></pre>

<hr>
<h2 id='sim_RSIHR_optimal_unknown_var'>Simulate a Trial Using Generalized RSIHR Allocation for Continuous Endpoint with Unknown Variances</h2><span id='topic+sim_RSIHR_optimal_unknown_var'></span>

<h3>Description</h3>

<p><code>sim_RSIHR_optimal_unknown_var</code> simulates a trial for continuous endpoints with unknown variances,
and the allocation probabilities change based on results of accumulated participants in the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_RSIHR_optimal_unknown_var(
  Pats,
  nMax,
  TimeToOutcome,
  enrollrate,
  N1,
  N2,
  armn,
  mean,
  sd,
  alphaa = 0.025,
  armlabel,
  cc,
  side
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_pats">Pats</code></td>
<td>
<p>the number of patients accrued within a certain time frame indicates the
count of individuals who have been affected by the disease during that specific period,
for example, a month or a day. If this number is 10, it represents that
10 people have got the disease within the specified time frame.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_nmax">nMax</code></td>
<td>
<p>the assumed maximum accrued number of patients with the disease in the population, this number
should be chosen carefully to ensure a sufficient number of patients are simulated,
especially when considering the delay mechanism.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_timetooutcome">TimeToOutcome</code></td>
<td>
<p>the distribution of delayed response times or a fixed delay time for responses.
The delayed time could be a month, a week or any other time frame. When the unit changes,
the number of TimeToOutcome should also change. It can be in the format
of expression(rnorm( length( vStartTime ),30, 3)), representing delayed responses
with a normal distribution, where the mean is 30 days and the standard deviation is 3 days.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_enrollrate">enrollrate</code></td>
<td>
<p>probability that patients in the population can enroll in the trial.
This parameter is related to the number of people who have been affected by the disease in the population,
following an exponential distribution.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_n1">N1</code></td>
<td>
<p>number of participants with equal randomization in the 'initialization' period.
Recommend using 10 percent of the total sample size.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_n2">N2</code></td>
<td>
<p>maximal sample size for the trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_armn">armn</code></td>
<td>
<p>number of total arms in the trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_mean">mean</code></td>
<td>
<p>a vector of hypotheses of mean, with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_sd">sd</code></td>
<td>
<p>a vector of hypotheses of standard deviation with the first one serving as the control group.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_alphaa">alphaa</code></td>
<td>
<p>the overall type I error to be controlled for the one-sided test. Default value is set to 0.025.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_armlabel">armlabel</code></td>
<td>
<p>a vector of arm labels with an example of c(1, 2), where 1 and 2 describe
how each arm is labeled in a two-armed trial.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_cc">cc</code></td>
<td>
<p>value in the formula of measure of treatment effectiveness, usually take the average
of mean responses in the hypotheses. <code>cc</code> is the same as C in the details.</p>
</td></tr>
<tr><td><code id="sim_RSIHR_optimal_unknown_var_+3A_side">side</code></td>
<td>
<p>direction of a one-sided test, with values 'upper' or 'lower'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function aims to minimize the criteria <code class="reqn">\sum_{i=1}^{K}n_i\Psi_i</code>
with constraints <code class="reqn">\frac{\sigma_1^2}{n_1}+\frac{\sigma_k^2}{n_k}\leq C</code>, where <code class="reqn">k=2,...,K</code>
for some fixed C. It is equivalent to generalized RSIHR allocation for continuous endpoints with unknown variances.
With more than two arms the one-sided nominal level of each test is <code>alphaa</code> divided 
by <code>arm*(arm-1)/2</code>; a Bonferroni correction.
Considering the delay mechanism, <code>Pats</code> (the number of patients accrued within a certain time frame),
<code>nMax</code> (the assumed maximum accrued number of patients with the disease in the population) and 
<code>TimeToOutcome</code> (the distribution of delayed response times or a fixed delay time for responses) 
are parameters in the functions adapted from <a href="https://github.com/kwathen/IntroBayesianSimulation">https://github.com/kwathen/IntroBayesianSimulation</a>.
Refer to the website for more details.
</p>


<h3>Value</h3>

<p><code>sim_RSIHR_optimal_unknown_var</code> returns an object of class &quot;RSIHRoptimal&quot;. An object of class &quot;RSIHRoptimal&quot; is a list containing 
final decision based on the T test statistics with 1 stands for selected and 0 stands for not selected,
T test statistics, the simulated data set and participants accrued for each arm at the time of termination of that group in one trial.
The simulated data set includes 5 columns: participant ID number, enrollment time, observed time of results,
allocated arm, and participants' result.
</p>


<h3>References</h3>

<p>Biswas A, Mandal S, Bhattacharya R (2011).
&ldquo;Multi-treatment optimal response-adaptive designs for phase III clinical trials.&rdquo;
<em>Journal of the Korean Statistical Society</em>, <b>40</b>(1), 33-44.
ISSN 1226-3192, <a href="https://doi.org/10.1016/j.jkss.2010.04.004">doi:10.1016/j.jkss.2010.04.004</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under null hypothesis
#in a three-armed trial
sim_RSIHR_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.9,N1=8,N2=88,armn=2,
mean=c(9.1/100,9.1/100),sd=c(0.009,0.009),alphaa=0.025,armlabel=c(1,2),
cc=mean(c(9.1/100,9.1/100)),side='upper')

#Run the function with delayed responses follow a normal distribution with
#a mean of 30 days and a standard deviation of 3 days under alternative hypothesis
#in a three-armed trial
sim_RSIHR_optimal_unknown_var(Pats=10,nMax=50000,TimeToOutcome=expression(
rnorm( length( vStartTime ),30, 3)),enrollrate=0.9,N1=8,N2=88,armn=2,
mean=c(9.1/100,8.47/100),sd=c(0.009,0.009),alphaa=0.025,armlabel=c(1,2),
cc=mean(c(9.1/100,8.47/100)),side='upper')
</code></pre>

<hr>
<h2 id='update_par_nichisq'>Update Parameters of a Normal-Inverse-Chi-Squared Distribution with Available Data</h2><span id='topic+update_par_nichisq'></span>

<h3>Description</h3>

<p>Update parameters of a Normal-Inverse-Chi-Squared distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_par_nichisq(y, par)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_par_nichisq_+3A_y">y</code></td>
<td>
<p>observed data.</p>
</td></tr>
<tr><td><code id="update_par_nichisq_+3A_par">par</code></td>
<td>
<p>a vector of current parameters including mu, kappa, nu, sigsq from a Normal-Inverse-Chi-Squared distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function updates parameters of a Normal-Inverse-Chi-Squared 
(<code class="reqn">(\mu,\sigma^2) \sim NIX(mean=\mu,effective sample size=\kappa,degrees of freedom=\nu,variance=\sigma^2/\kappa)</code>) 
distribution with available data to parameters of a posterior Normal-Inverse-Gamma 
(<code class="reqn">(\mu,\sigma^2) \sim NIG(mean=m,variance=V \times \sigma^2,shape=a,rate=b)</code>)distribution.
Those updated parameters can be converted to parameters in a Normal-Inverse-Gamma distribution
for continuous outcomes with unknown variances using <code>convert_chisq_to_gamma</code>.
</p>


<h3>Value</h3>

<p>a list of parameters including mu, kappa, nu, sigsq for a posterior Normal-Inverse-Chi-Squared distribution 
incorporating available data.
</p>


<h3>References</h3>

<p>Murphy K (2007).
&ldquo;Conjugate Bayesian analysis of the Gaussian distribution.&rdquo;
University of British Columbia.
<a href="https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf">https://www.cs.ubc.ca/~murphyk/Papers/bayesGauss.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>para&lt;-list(V=1/2,a=0.5,m=9.1/100,b=0.00002)
par&lt;-convert_gamma_to_chisq(para)
set.seed(123451)
y1&lt;-rnorm(100,0.091,0.009)
update_par_nichisq(y1, par)
set.seed(123452)
y2&lt;-rnorm(90,0.09,0.009)
update_par_nichisq(y2, par)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
