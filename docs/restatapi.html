<!DOCTYPE html><html><head><title>Help for package restatapi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {restatapi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.restatapi_env'><p>Create the cache environment</p></a></li>
<li><a href='#clean_restatapi_cache'><p>Clean restatapi cache</p></a></li>
<li><a href='#create_filter_table'><p>Create a filter table</p></a></li>
<li><a href='#extract_data'><p>Extract data values from SDMX XML</p></a></li>
<li><a href='#extract_dsd'><p>Extract the Data Structure Definition content from SDMX XML</p></a></li>
<li><a href='#extract_toc'><p>Extract the text of the table of contents from SDMX XML</p></a></li>
<li><a href='#filter_raw_data'><p>Filter raw data locally</p></a></li>
<li><a href='#get_compressed_sdmx'><p>Download and extract compressed SDMX XML</p></a></li>
<li><a href='#get_eurostat_bulk'><p>Get Eurostat data in a standardized format</p></a></li>
<li><a href='#get_eurostat_cache'><p>Load an object from cache</p></a></li>
<li><a href='#get_eurostat_codelist'><p>Download the codelist of a concept</p></a></li>
<li><a href='#get_eurostat_data'><p>Download, extract and filter Eurostat data</p></a></li>
<li><a href='#get_eurostat_dsd'><p>Download the Data Structure Definition of a dataset</p></a></li>
<li><a href='#get_eurostat_raw'><p>Get Eurostat data as it is</p></a></li>
<li><a href='#get_eurostat_toc'><p>Download the Table of Contents of Eurostat datasets</p></a></li>
<li><a href='#load_cfg'><p>Load configuration data from JSON</p></a></li>
<li><a href='#put_eurostat_cache'><p>Put an object to cache</p></a></li>
<li><a href='#search_eurostat_dsd'><p>Search for pattern in the Data Structure Definition of a dataset</p></a></li>
<li><a href='#search_eurostat_toc'><p>Search for pattern in the titles, units and short description of the TOC</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Search and Retrieve Data from Eurostat Database</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-25</td>
</tr>
<tr>
<td>Version:</td>
<td>0.23.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Eurostat is the statistical office of the European Union and provides high quality statistics for Europe.
             Large set of the data is disseminated through the Eurostat database (<a href="https://ec.europa.eu/eurostat/web/main/data/database">https://ec.europa.eu/eurostat/web/main/data/database</a>). 
             The tools are using the REST API with the Statistical Data and Metadata eXchange (SDMX) Web Services 
             (<a href="https://wikis.ec.europa.eu/pages/viewpage.action?pageId=44165555">https://wikis.ec.europa.eu/pages/viewpage.action?pageId=44165555</a>) to search and download data from 
             the Eurostat database using the SDMX standard. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://joinup.ec.europa.eu/software/page/eupl">EUPL</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, rjson, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>chron, knitr, rmarkdown, tinytest, remotes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/eurostat/restatapi">https://github.com/eurostat/restatapi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/eurostat/restatapi/issues">https://github.com/eurostat/restatapi/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 21:23:54 UTC; rstudio</td>
</tr>
<tr>
<td>Author:</td>
<td>Mátyás Mészáros [aut, cre],
  Sebastian Weinand [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mátyás Mészáros &lt;matyas.meszaros@ec.europa.eu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-26 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.restatapi_env'>Create the cache environment</h2><span id='topic+.restatapi_env'></span>

<h3>Description</h3>

<p>Create the cache environment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.restatapi_env
</code></pre>


<h3>Format</h3>

<p>An object of class <code>environment</code> of length 4.
</p>

<hr>
<h2 id='clean_restatapi_cache'>Clean restatapi cache</h2><span id='topic+clean_restatapi_cache'></span>

<h3>Description</h3>

<p>Remove all objects from the <code>.restatapi_env</code> except the configuration file, API version number, download method and the country codes.
In addition, it deletes all the .rds files from the default and selected cache directory.
See <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> for more on cache.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clean_restatapi_cache(cache_dir = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clean_restatapi_cache_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to cache directory. If <code>NULL</code> (default) it will clean default temporary cache directory (<code>file.path(tempdir(),"restatapi")</code>). The default 
cache directory is used when the provided <code>cache_dir</code> does not exist. Directory can also be set with <code>options(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="clean_restatapi_cache_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not be printed. Can be set also with
<code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
clean_restatapi_cache(verbose=TRUE) 

</code></pre>

<hr>
<h2 id='create_filter_table'>Create a filter table</h2><span id='topic+create_filter_table'></span>

<h3>Description</h3>

<p>Create filter table from the <code>filters</code> and <code>date_filter</code> strings parameters of the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> to be used in the <code><a href="#topic+filter_raw_data">filter_raw_data</a></code> function for filtering by query or on the local computer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_filter_table(
  filters,
  date_filter = FALSE,
  dsd = NULL,
  exact_match = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_filter_table_+3A_filters">filters</code></td>
<td>
<p>a string, a character or numeric vector or a named list containing words to filter by the different concepts, geographical location or time values.
The words can be any word, Eurostat variable code, or value which are in the Data Structure Definition (DSD) and can be retrieved by the <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code> function. 
If a named list is used, then the name of the list elements should be the concepts from the DSD and the provided values will be used to filter the dataset for the given concept.
The default is <code>NULL</code>, in this case no filter table is created. To filter by time see <code>date_filter</code> below.
In case for filtering for time values, the date shall be defined as character string, and it should follow the format yyyy[-mm][-dd], where the month and the day part is optional.</p>
</td></tr>
<tr><td><code id="create_filter_table_+3A_date_filter">date_filter</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the filter table is genrated only for the time dimension. The default is <code>FALSE</code>, 
in this case a (<code>dsd</code>) should be provided which will be searched for the values given in the <code>filters</code>.</p>
</td></tr>
<tr><td><code id="create_filter_table_+3A_dsd">dsd</code></td>
<td>
<p>a table containing a DSD of an Eurostat dataset which can be retreived by the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> function.</p>
</td></tr>
<tr><td><code id="create_filter_table_+3A_exact_match">exact_match</code></td>
<td>
<p>a logical value with the default value <code>TRUE</code>, if the strings provided in <code>filters</code> shall be matched exactly as it is or as a pattern in the DSD.</p>
</td></tr>
<tr><td><code id="create_filter_table_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="create_filter_table_+3A_...">...</code></td>
<td>
<p>further arguments to the for <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code> function, e.g.: <code>ignore.case</code> or <code>name</code>. 
The <code>ignore.case</code> has the default value <code>FALSE</code>, then the strings provided in <code>filters</code> are matched as is, 
otherwise the case of the letters is ignored. If the <code>name=FALSE</code> then the pattern(s) provided in the <code>filters</code>
argument is only searched in the code column of the DSD, and the names of the codes will not be searched.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> to generate url for the given <code>filters</code> and <code>date_filter</code> in that function. The output can be used also for filtering data 
on the local computer with the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> and <code><a href="#topic+filter_raw_data">filter_raw_data</a></code> function, if the direct response from REST API did not provide data because of too large data set.
</p>


<h3>Value</h3>

<p>a data.table containing in each row a distinct filtering condition to be applied to a raw Eurostat datatable or generate specific query.
</p>
<p>If <code>date_filter=TRUE</code>, the output data table contains two columns with the following names:
</p>

<table>
<tr>
 <td style="text-align: left;">
         <code>sd</code> </td><td style="text-align: left;"> Starting date to be included in the filtered dataset, where date is formatted yyyy[-mm][-dd]</td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>ed</code> </td><td style="text-align: left;"> End date of the period to be included in the filtered dataset, where the date is formatted yyyy[-mm][-dd] 
         </td>
</tr>

</table>
  
<p>In case <code>date_filter=FALSE</code>, the output tables have the following four columns:
</p>

<table>
<tr>
 <td style="text-align: left;">   
         <code>pattern</code> </td><td style="text-align: left;"> Containing those parts of the <code>filters</code> string where the string part (pattern) was found in the <code>dsd</code></td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>concept</code> </td><td style="text-align: left;"> The name of the concepts corresponding to the result in the code/name column where the pattern
         was found in the data structure definition</td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>code</code> </td><td style="text-align: left;"> The list of codes where the pattern was found, or the code of a name (description of the code) 
         where the pattern appears</td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>name</code> </td><td style="text-align: left;"> The name (description of the code) which can be used as label for the code where the pattern was
         found, or the name (description of the code) of the code where the pattern appears 
         </td>
</tr>

</table>



<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code>, <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+filter_raw_data">filter_raw_data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
dsd&lt;-get_eurostat_dsd("avia_par_me") 
create_filter_table(c("KYIV","hu","Quarterly"),dsd=dsd,exact_match=FALSE,ignore.case=TRUE)
create_filter_table(c("KYIV","LHBP","Monthly"),dsd=dsd,exact_match=FALSE,name=FALSE)
create_filter_table(c("2017-03",
                      "2001-03:2005",
                      "&lt;2000-07-01",
                      2012:2014,
                      "2018&lt;",
                      20912,
                      "&lt;3452&lt;",
                      ":2018-04&gt;",
                      "2&lt;034v",
                      "2008:2013"),
                    date_filter=TRUE,
                    verbose=TRUE)
options(timeout=60)

</code></pre>

<hr>
<h2 id='extract_data'>Extract data values from SDMX XML</h2><span id='topic+extract_data'></span>

<h3>Description</h3>

<p>Extracts the data values from the SDMX XML data file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_data(
  xml_lf,
  keep_flags = FALSE,
  stringsAsFactors = FALSE,
  bulk = TRUE,
  check_toc = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_data_+3A_xml_lf">xml_lf</code></td>
<td>
<p>an input XML leaf with data series from an SDMX XML file to extract the value and its dimensions from it</p>
</td></tr>
<tr><td><code id="extract_data_+3A_keep_flags">keep_flags</code></td>
<td>
<p>a logical value if to extract the observation status (flag) information from the XML file. The default value is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="extract_data_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the columns are converted to factors. The default is <code>FALSE</code>, 
in this case the strings are returned as characters.</p>
</td></tr>
<tr><td><code id="extract_data_+3A_bulk">bulk</code></td>
<td>
<p>a logical value with default value <code>TRUE</code> if the input SDMX XML file is from the bulk download facility containing all the observations. 
If the input file has pre-filtered values then the value <code>FALSE</code> should be used.</p>
</td></tr>
<tr><td><code id="extract_data_+3A_check_toc">check_toc</code></td>
<td>
<p>if the data file was downloaded using the URL from the TOC or not. The default is FALSE means not the TOC link is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> and the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> functions.
</p>


<h3>Value</h3>

<p>a data frame containing the values of an SDMX node: the dimensions, value and the optional flag(s)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

id&lt;-"agr_r_milkpr"
url&lt;-paste0("https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/data/",
            id,
            "?format=sdmx_2.1_structured&amp;compressed=true")
if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
  sdmx_xml&lt;-get_compressed_sdmx(url,verbose=TRUE)
  xml_leafs&lt;-xml2::xml_find_all(sdmx_xml,".//Series")
  extract_data(xml_leafs[1])
options(timeout=60)


</code></pre>

<hr>
<h2 id='extract_dsd'>Extract the Data Structure Definition content from SDMX XML</h2><span id='topic+extract_dsd'></span>

<h3>Description</h3>

<p>Extracts values from the XML Data Structure Definition (DSD) file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_dsd(concept = NULL, dsd_xml = NULL, lang = "en")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_dsd_+3A_concept">concept</code></td>
<td>
<p>a character vector with a concept id</p>
</td></tr>
<tr><td><code id="extract_dsd_+3A_dsd_xml">dsd_xml</code></td>
<td>
<p>an XML file with DSD content</p>
</td></tr>
<tr><td><code id="extract_dsd_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the name column 
of the DSD. It is used only in the new API. The default is <code>en</code> - English.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> function.
</p>


<h3>Value</h3>

<p>a matrix with 3 columns if the provided <code>concept</code> has a code list in the DSD file. The first column is the provided <code>concept</code>. The second column 
is the possible codes under the given <code>concept</code>. The last column is the name/description for the code in the second column, which can be used as labels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

id&lt;-"med_rd6"
cfg&lt;-get("cfg",envir=restatapi::.restatapi_env)
rav&lt;-get("rav",envir=restatapi::.restatapi_env)
dsd_url &lt;- paste0(eval(
     parse(text=paste0("cfg$QUERY_BASE_URL$'",rav,"'$ESTAT$metadata$'2.1'$datastructure"))
   ),"/",eval(
     parse(text=paste0("cfg$QUERY_PRIOR_ID$'",rav,"'$ESTAT$metadata"))
   ),id,"?",eval(
     parse(text=paste0("cfg$QUERY_PARAMETERS$'",rav,"'$metadata[2]"))
   ),"=",eval(
     parse(text=paste0("cfg$DATAFLOW_REFERENCES$'",rav,"'$datastructure[1]"))
   )
 )
if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
tryCatch({
  dsd_xml&lt;-xml2::read_xml(dsd_url)}, 
  error=function(e){
  message("Unable to download the xml file.\n",e)}, 
  warning=function(w){
  message("Unable to download the xml file.\n",w)}) 
if (exists("dsd_xml")) extract_dsd("FREQ",dsd_xml) 
options(timeout=60)

</code></pre>

<hr>
<h2 id='extract_toc'>Extract the text of the table of contents from SDMX XML</h2><span id='topic+extract_toc'></span>

<h3>Description</h3>

<p>Extracts the values of a node from the Eurostat XML Table of contents (TOC) file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_toc(ns)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_toc_+3A_ns">ns</code></td>
<td>
<p>an XML node set from the XML TOC file</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code> function.
</p>


<h3>Value</h3>

<p>a character vector with all the values of the node set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cfg&lt;-get("cfg",envir=restatapi::.restatapi_env) 
rav&lt;-get("rav",envir=restatapi::.restatapi_env)
toc_endpoint&lt;-eval(parse(text=paste0("cfg$TOC_ENDPOINT$'",rav,"'$ESTAT$xml")))

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
tryCatch(xml_leafs&lt;-xml2::xml_find_all(xml2::read_xml(toc_endpoint),".//nt:leaf"),
         error = function(e) {xml_leafs&lt;-""},
         warning = function(w) {xml_leafs&lt;-""})
if (exists("xml_leafs")){
   if (Sys.info()[['sysname']]=='Windows'){ 
      xml_node&lt;-as.character(xml_leafs[1])
   }else{
      xml_node&lt;-xml_leafs[1]
   }
   restatapi::extract_toc(xml_node)
}
options(timeout=60)

</code></pre>

<hr>
<h2 id='filter_raw_data'>Filter raw data locally</h2><span id='topic+filter_raw_data'></span>

<h3>Description</h3>

<p>Filter downloaded full raw dataset on local computer if the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> has not provided data due to too large datasets for the REST API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_raw_data(raw_data = NULL, filter_table = NULL, date_filter = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_raw_data_+3A_raw_data">raw_data</code></td>
<td>
<p>an input data.table dataset resulted from the call of the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> function</p>
</td></tr>
<tr><td><code id="filter_raw_data_+3A_filter_table">filter_table</code></td>
<td>
<p>a data table with values for the concepts or time to be filtered out which can be generated by the <code><a href="#topic+create_filter_table">create_filter_table</a></code> function</p>
</td></tr>
<tr><td><code id="filter_raw_data_+3A_date_filter">date_filter</code></td>
<td>
<p>a logical value. If <code>TRUE</code> the filter table should be applied to the <code>time</code> columns of the <code>raw_data</code>. The default is <code>FALSE</code>, 
in this case the filters applied to the other columns of the <code>raw_data</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> to filter data on the local computer if the direct response from REST API did not provide data 
because of too large data set (more than 30 thousands observations). 
The <code>filter_table</code> contains always at least two columns. In case if <code>date_filter=TRUE</code> then the two columns should have the following names and 
the provided conditions are applied to the time column of the the <code>raw_data</code> data.table.
</p>

<table>
<tr>
 <td style="text-align: left;">
         <code>sd</code> </td><td style="text-align: left;"> Starting date to be included, where date is formatted as yyyy[-mm][-dd] (the month and day are
         optional)</td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>ed</code> </td><td style="text-align: left;"> End date of the period to be included in the dataset formatted as yyyy[-mm][-dd] (the month and
         day are optional) 
         </td>
</tr>

</table>
  
<p>In case if <code>date_filter=FALSE</code> then the columns should have the following names:
</p>

<table>
<tr>
 <td style="text-align: left;">
         <code>concept</code> </td><td style="text-align: left;"> Containing concept names, which is a column name in the <code>raw_data</code> data.table</td>
</tr>
<tr>
 <td style="text-align: left;">
         <code>code</code> </td><td style="text-align: left;"> A possible code under the given concept, which is a value in the column of the <code>raw_data</code>
         data.table defined by the concept   
         </td>
</tr>

</table>



<h3>Value</h3>

<p>a filtered data.table containing only the rows of <code>raw_data</code> which fulfills the conditions in the <code>filter_table</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code>, <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+create_filter_table">create_filter_table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

id&lt;-"tus_00age"
if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
rd&lt;-get_eurostat_raw(id)
dsd&lt;-get_eurostat_dsd(id)
ft&lt;-create_filter_table(c("TIME_SP","Hungary",'T'),FALSE,dsd)
filter_raw_data(rd,ft)
options(timeout=60)

</code></pre>

<hr>
<h2 id='get_compressed_sdmx'>Download and extract compressed SDMX XML</h2><span id='topic+get_compressed_sdmx'></span>

<h3>Description</h3>

<p>Downloads  and extracts the data values from the SDMX XML data file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_compressed_sdmx(url = NULL, verbose = FALSE, format = "gz")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_compressed_sdmx_+3A_url">url</code></td>
<td>
<p>a URL from the bulk download facility to download the zipped SDMX XML file</p>
</td></tr>
<tr><td><code id="get_compressed_sdmx_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="get_compressed_sdmx_+3A_format">format</code></td>
<td>
<p>the format of the compression, either &quot;zip&quot; or &quot;gz&quot; the default value</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is a sub-function to use in the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> and the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> functions.
</p>


<h3>Value</h3>

<p>an xml class object with SDMX tags extracted and read from the downloaded file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>id&lt;-"agr_r_milkpr"
url&lt;-paste0("https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/data/",
            id,
            "?format=sdmx_2.1_structured&amp;compressed=true")
if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
sdmx_xml&lt;-get_compressed_sdmx(url,verbose=TRUE,format="gz")
options(timeout=60)
</code></pre>

<hr>
<h2 id='get_eurostat_bulk'>Get Eurostat data in a standardized format</h2><span id='topic+get_eurostat_bulk'></span>

<h3>Description</h3>

<p>Download data sets from <a href="https://ec.europa.eu/eurostat/">Eurostat</a> database and put in a standardized format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_bulk(
  id,
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  stringsAsFactors = TRUE,
  select_freq = NULL,
  keep_flags = FALSE,
  cflags = FALSE,
  check_toc = FALSE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_bulk_+3A_id">id</code></td>
<td>
<p>a code name for the dataset of interest.
See <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> for details how to get an id.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_cache">cache</code></td>
<td>
<p>a logical value whether to do caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_update_cache">update_cache</code></td>
<td>
<p>a logical value with a default value <code>FALSE</code>, whether to update cache. Can be set also with
<code>options(restatapi_update=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The <code>NULL</code> (default) uses the memory as cache. 
If the folder <code>cache_dir</code> directory does not exist it saves in the 'restatapi' directory 
under the temporary directory from <code>tempdir()</code>. Directory can also be set with
<code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical value whether to compress the
RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>a logical value with the default <code>TRUE</code>. In this case the columns are converted to factors. If <code>FALSE</code>, 
the strings are returned as characters.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_select_freq">select_freq</code></td>
<td>
<p>a character symbol for a time frequency when a dataset has multiple time
frequencies. Possible values are:
A = annual, S = semi-annual, H = half-year, Q = quarterly, M = monthly, W = weekly, D = daily. 
The default is <code>NULL</code> as most datasets have only one time frequency. 
In case if there are multiple frequencies and <code>select_freq=NULL</code>, then only the most common frequency kept.
If all the frequencies needed the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> function can be used.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_keep_flags">keep_flags</code></td>
<td>
<p>a logical value whether the observation status (flags) - e.g. &quot;confidential&quot;,
&quot;provisional&quot;, etc. - should be kept in a separate column or if they
can be removed. Default is <code>FALSE</code>. For flag values see: 
<a href="https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en">https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en</a>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_cflags">cflags</code></td>
<td>
<p>a logical value whether the missing observations with flag 'c' - &quot;confidential&quot;
should be kept or not. Default is <code>FALSE</code>, in this case these observations dropped from the dataset. If this parameter 
<code>TRUE</code> then all the flags and the suppressed observations with missing values are kept. In this case the parameter provided in <code>keep_flags</code> is set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_check_toc">check_toc</code></td>
<td>
<p>a logical value whether to check the provided <code>id</code> in the Table of Contents (TOC) or not. The default value 
<code>FALSE</code>, in this case the base URL for the download link is retrieved from the configuration file. 
If the value is <code>TRUE</code> then the TOC is downloaded and the <code>id</code> is checked in it. If it found there then the download link 
is retrieved form the TOC.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_bulk_+3A_...">...</code></td>
<td>
<p>other parameter(s) to pass on the <code><a href="#topic+load_cfg">load_cfg</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data sets are downloaded from <a href="https://wikis.ec.europa.eu/display/EUROSTATHELP/Transition+-+from+Eurostat+Bulk+Download+to+API">the Eurostat bulk download facility</a> 
in TSV format as in this case smaller file has to be downloaded and processed. If there is more then one frequency then
the dataset is filtered for a unique time frequency.
If no frequency is selected and there are multiple frequencies in the dataset, then the most common value is used used for frequency.
</p>
<p>Compared to the ouptut of the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> function, the frequency (FREQ) and time format (TIME_FORMAT) columns are not included in the bulk data  
and the column names for the time period, observation values and status have standardised names: &quot;time&quot;, &quot;values&quot; and &quot;flags&quot; 
independently if the data was downloaded previously in SDMX or TSV format.
</p>
<p>By default all datasets cached as they are often rather large. 
The datasets cached in memory (default) or can be stored in a temporary directory if <code>cache_dir</code> or <code>option(restatpi_cache_dir)</code> is defined.
The cache can be emptied with <code><a href="#topic+clean_restatapi_cache">clean_restatapi_cache</a></code>.
</p>
<p>The <code>id</code>, is a value from the <code>code</code> column of the table of contents (<code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code>), and can be searched for it with the <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> function. The id value can be retrieved from the <a href="https://ec.europa.eu/eurostat/data/database">Eurostat database</a>
as well. The Eurostat database gives codes in the Data Navigation Tree after every dataset
in parenthesis.
</p>


<h3>Value</h3>

<p>a data.table with the following columns: 
</p>

<table>
<tr>
 <td style="text-align: left;">
     dimension names </td><td style="text-align: left;"> One column for each dimension in the data</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>time</code> </td><td style="text-align: left;"> A column for the time dimension</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>values</code> </td><td style="text-align: left;"> A column for numerical values</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>flags</code> </td><td style="text-align: left;"> A column for flags if the <code>keep_flags=TRUE</code> or <code>cflags=TRUE</code> otherwise this column
     is not included in the data table
   </td>
</tr>

</table>

<p>The data.table does not include all missing values. The missing values are dropped if both the value and the flag is missing
on a particular time.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
head(get_eurostat_bulk("agr_r_milkpr",keep_flags=TRUE))
options(restatapi_update=TRUE)
head(get_eurostat_bulk("avia_par_ee",check_toc=TRUE))
head(get_eurostat_bulk("avia_par_ee",select_freq="A",verbose=TRUE))
options(restatapi_update=FALSE)
head(get_eurostat_bulk("agr_r_milkpr",cache_dir=tempdir(),compress_file=FALSE,verbose=TRUE))
clean_restatapi_cache(cache_dir=tempdir(),verbose=TRUE)
options(timeout=60)

</code></pre>

<hr>
<h2 id='get_eurostat_cache'>Load an object from cache</h2><span id='topic+get_eurostat_cache'></span>

<h3>Description</h3>

<p>Search and load the object (dataset/toc/DSD) from cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_cache(oname, cache_dir = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_cache_+3A_oname">oname</code></td>
<td>
<p>a character string with the name of the object (toc, dataset id, DSD id)</p>
</td></tr>
<tr><td><code id="get_eurostat_cache_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory to search in. The default is <code>NULL</code>, 
in this case the object is searched in the memory (in the <code>.restatapi_env</code>). Otherwise
if the <code>cache_dir</code> directory does not exist it searches the 'restatapi' directory
in the temporary directory from <code>tempdir()</code>. Directory can also be set with <code>options(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_cache_+3A_verbose">verbose</code></td>
<td>
<p>a logical value with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the given name or the beginning of the name (for datasets) found in the cache then it returns the value of the object otherwise it returns <code>NULL</code>.
</p>


<h3>Value</h3>

<p>the requested object if exists in the '.restatapi_env' or in the <code>cache_dir</code>, otherwise it returns the <code>NULL</code> value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dt&lt;-data.frame(txt=c("a","b","c"),nr=c(1,2,3))
put_eurostat_cache(dt,"teszt")
get_eurostat_cache("teszt",verbose=TRUE)


</code></pre>

<hr>
<h2 id='get_eurostat_codelist'>Download the codelist of a concept</h2><span id='topic+get_eurostat_codelist'></span>

<h3>Description</h3>

<p>Download codelist of a concept from Eurostat if it is not cached previously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_codelist(
  id,
  lang = "en",
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_codelist_+3A_id">id</code></td>
<td>
<p>a character string with id of the concept. It is a value from the <code>concept</code> column of the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> function.</p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the name column of the codelist. It is used only in the new API. The default is <code>en</code> - English.</p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_cache">cache</code></td>
<td>
<p>a boolean whether to load/save the TOC from/in the cache or not. The default value is <code>TRUE</code>, so that the TOC is checked first in the cache and if does not exist then downloaded from Eurostat and cached.</p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_update_cache">update_cache</code></td>
<td>
<p>a boolean to update cache or not. The default value is <code>FALSE</code>, so the cache is not updated. Can be set also with <code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The default is <code>NULL</code>, in this case the TOC is cached in the memory (in the '.restatapi_env'). Otherwise if the <code>cache_dir</code> directory does not exist it creates the 'restatapi' directory in the temporary directory from <code>tempdir()</code> to save the RDS-file. Directory can also be set with <code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_codelist_+3A_...">...</code></td>
<td>
<p>parameter to pass on the <code>load_cfg</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The codelist is downloaded from Eurostat's website, through the REST API in XML (SDMX-ML) format.
</p>


<h3>Value</h3>

<p>If the codelist does not exist it returns <code>NULL</code> otherwise the result is a table with the 2 columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>code</code> </td><td style="text-align: left;"> All the possible codes under the concept </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>name</code> </td><td style="text-align: left;"> The name/description of the code 
   </td>
</tr>

</table>



<h3>References</h3>

<p>For more information see the detailed documentation of the <a href="https://wikis.ec.europa.eu/display/EUROSTATHELP/API+SDMX+2.1+-+metadata+query">API</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
get_eurostat_codelist("freq",lang="de",cache=FALSE,verbose=TRUE)
options(timeout=60)
</code></pre>

<hr>
<h2 id='get_eurostat_data'>Download, extract and filter Eurostat data</h2><span id='topic+get_eurostat_data'></span>

<h3>Description</h3>

<p>Download full or partial data set from <a href="https://ec.europa.eu/eurostat/web/main/home">Eurostat</a> <a href="https://ec.europa.eu/eurostat/web/main/data/database">database</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_data(
  id,
  filters = NULL,
  lang = "en",
  exact_match = TRUE,
  date_filter = NULL,
  label = FALSE,
  select_freq = NULL,
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  stringsAsFactors = TRUE,
  keep_flags = FALSE,
  cflags = FALSE,
  check_toc = FALSE,
  local_filter = TRUE,
  force_local_filter = FALSE,
  mode = "xml",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_data_+3A_id">id</code></td>
<td>
<p>A code name for the dataset of interest.
See <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> for details how to get an id.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_filters">filters</code></td>
<td>
<p>a string, a character vector or named list containing words to filter by the different concepts or geographical location.
If filter applied only part of the dataset is downloaded through the API. The words can be  
any word, Eurostat variable code, and value which are in the DSD <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code>. 
If a named list is used, then the name of the list elements should be the concepts from the DSD and the provided values will be used to filter the dataset for the given concept.
The default is <code>NULL</code>, in this case the whole dataset is returned via the bulk download. To filter by time see <code>date_filter</code> below.
If after filtering still the dataset has more observations than the limit per query via the API, then the raw download is used to retrieve the whole dataset and apply the filter on the local computer. This option can be disabled with the <code>local_filter=FALSE</code> parameter.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the DSD to search in for the <code>filters</code>. The default is <code>en</code> - English.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_exact_match">exact_match</code></td>
<td>
<p>a boolean with the default value <code>TRUE</code>, if the strings provided in <code>filters</code> shall be matched exactly as it is or as a pattern.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_date_filter">date_filter</code></td>
<td>
<p>a vector which can be numeric or character containing dates to filter the dataset. If date is defined as character string it should follow the format yyyy[-mm][-dd], where the month and the day part is optional. 
If date filter applied only part of the dataset is downloaded through the API. 
The default is <code>NULL</code>, in this case the whole dataset is returned via the bulk download.
If after filtering still the dataset has more observations than the limit per query via the API, then the raw download is used to retrieve the data and apply the filter on the local computer. 
This option can be disabled with the <code>local_filter=FALSE</code> parameter.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_label">label</code></td>
<td>
<p>a boolean with the default <code>FALSE</code>. If it is <code>TRUE</code> then the code values are replaced by the name from the Data Structure Definition (DSD) <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code>.
For example instead of &quot;D1110A&quot;, &quot;Raw cows' milk from farmtype&quot; is used or &quot;HU32&quot; is replaced by &quot;Észak-Alföld&quot;.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_select_freq">select_freq</code></td>
<td>
<p>a character symbol for a time frequency when a dataset has multiple time
frequencies. Possible values are:
A = annual, S = semi-annual, H = half-year, Q = quarterly, M = monthly, W = weekly, D = daily. 
The default is <code>NULL</code> as most datasets have just one time
frequency and in case there are multiple frequencies, then only the most common frequency kept.
If all the frequencies needed the <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> can be used.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_cache">cache</code></td>
<td>
<p>a logical whether to do caching. Default is <code>TRUE</code>. Affects 
only queries without filtering. If <code>filters</code> or <code>date_filter</code> is used then there is no caching.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_update_cache">update_cache</code></td>
<td>
<p>a logical with a default value <code>FALSE</code>, whether to update the data in the cache. Can be set also with
<code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The <code>NULL</code> (default) uses the memory as cache. 
If the folder <code>cache_dir</code> directory does not exist it saves in the 'restatapi' directory 
under the temporary directory from <code>tempdir()</code>. Directory can also be set with
<code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the
RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>if <code>TRUE</code> (the default) the non-numeric columns are
converted to factors. If the value <code>FALSE</code> they are returned as characters.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_keep_flags">keep_flags</code></td>
<td>
<p>a logical whether the observation status (flags) - e.g. &quot;confidential&quot;,
&quot;provisional&quot;, etc. - should be kept in a separate column or if they
can be removed. Default is <code>FALSE</code>. For flag values see: 
<a href="https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en">https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en</a>.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_cflags">cflags</code></td>
<td>
<p>a logical whether the missing observations with flag 'c' - &quot;confidential&quot;
should be kept or not. Default is <code>FALSE</code>, in this case these observations dropped from the dataset. If this parameter 
<code>TRUE</code> then the flags are kept and the parameter provided in <code>keep_flags</code> is not taken into account.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_check_toc">check_toc</code></td>
<td>
<p>a boolean whether to check the provided <code>id</code> in the Table of Contents (TOC) or not. The default value 
<code>FALSE</code>, in this case the base URL for the download link is retrieved from the configuration file. 
If the value is <code>TRUE</code> then the TOC is downloaded and the <code>id</code> is checked in it. If it found then the download link 
is retrieved form the TOC.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_local_filter">local_filter</code></td>
<td>
<p>a boolean whether do the filtering on the local computer or not in case after filtering still the dataset has more observations 
than the limit per query via the API would allow to download. The default is <code>TRUE</code>, in this case if the response footer contains information 
that the result cannot be downloaded becuase it is too large, then the whole raw dataset is downloaded and filtered on the local computer.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_force_local_filter">force_local_filter</code></td>
<td>
<p>a boolean with the default value <code>FALSE</code>. In case, if there are existing filter conditions, then it will do the filtering on the local 
computer and not requesting through the REST API. It can be useful, if the values are not numeric as these are provided as NaN (Not a Number) through the REST API, 
but it is fully listed in the raw dataset.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_mode">mode</code></td>
<td>
<p>defines the format of the dataset response from the API. It can be
<code>csv</code> for SDMX-CSV or <code>xml</code> for the SDMX-ML version.</p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_data_+3A_...">...</code></td>
<td>
<p>further arguments to the for <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code> function, e.g.: <code>ignore.case</code> or <code>name</code>. 
The <code>ignore.case</code> has the default value <code>FALSE</code>, then the strings provided in <code>filters</code> are matched as is, 
otherwise the case of the letters is ignored. If the <code>name=FALSE</code> then the pattern(s) provided in the <code>filters</code>
argument is only searched in the code column of the DSD, and the names of the codes will not be searched.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data sets are downloaded from the Eurostat Web Services 
<a href="https://wikis.ec.europa.eu/pages/viewpage.action?pageId=44165555">SDMX API</a> if there is a filter otherwise the 
<a href="https://wikis.ec.europa.eu/display/EUROSTATHELP/Transition+-+from+Eurostat+Bulk+Download+to+API">the Eurostat bulk download facility</a> is used.
If only the table <code>id</code> is given, the whole table is downloaded from the
bulk download facility. If also <code>filters</code> or <code>date_filter</code> is defined then the SDMX REST API is
used. In case after filtering the dataset has more rows than the limitation of the SDMX REST API (1 million values at one time) then the bulk download is used to retrieve the whole dataset .
</p>
<p>By default all datasets cached as they are often rather large. 
The datasets cached in memory (default) or can be stored in a temporary directory if <code>cache_dir</code> or <code>option(restatpi_cache_dir)</code> is defined.
The cache can be emptied with <code><a href="#topic+clean_restatapi_cache">clean_restatapi_cache</a></code>.
</p>
<p>The <code>id</code>, is a value from the <code>code</code> column of the table of contents (<code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code>), and can be searched 
for with the <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> function. The id value can be retrieved from the <a href="https://ec.europa.eu/eurostat/web/main/data/database">Eurostat database</a>
as well. The Eurostat database gives codes in the Data Navigation Tree after every dataset in parenthesis.
</p>
<p>Filtering can be done by the codes as described in the API documentation providing in the correct order and connecting with &quot;.&quot; and &quot;+&quot;. 
If we do not know the codes we can filter based on words or by the mix of the two putting in a vector like <code>c("AT$","Belgium","persons","Total")</code>. 
Be careful that the filter is case sensitive, if you do not know the code or label exactly you can use the option <code>ignore.case=TRUE</code> and <code>exact_match=FALSE</code>, 
but in this case the results may include unwanted elements as well. In the <code>filters</code> parameter regular expressions can be used as well. 
We do not have to worry about the correct order of the filter, it will be put in the correct place based on the DSD. 
</p>
<p>The <code>date_filter</code> shall be a string in the format yyyy[-mm][-dd]. The month and the day part is optional, but if we use the years and we have monthly frequency then all the data for the given year is retrieved.
The string can be extended by adding the &quot;&lt;&quot; or &quot;&gt;&quot; to the beginning or to the end of the string. In this case the date filter is treated as range, and the date is used as a starting or end date. The data will include the observation of the start/end date.
A single date range can be defined as well by concatenating two dates with the &quot;:&quot;, e.g. <code>"2016-08:2017-03-15"</code>. As seen in the example the dates can have different length: one defined only at year/month level, the other by day level. 
If a date range is defined with &quot;:&quot;, it is not possible to use the &quot;&lt;&quot; or &quot;&gt;&quot; characters in the date filter.
If there are multiple dates which is not a continuous range, it can be put in vector in any order like <code>c("2016-08",2013:2015,"2017-07-01")</code>. In this case, as well, it is  not possible to use the  &quot;&lt;&quot; or &quot;&gt;&quot; characters.
</p>


<h3>Value</h3>

<p>a data.table with the following columns: 
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>freq</code> </td><td style="text-align: left;"> A column for the frequency of the data in case there are multiple frequencies, for
     single frequency this columns is dropped from the data table</td>
</tr>
<tr>
 <td style="text-align: left;">
     dimension names </td><td style="text-align: left;"> One column for each dimension in the data</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>time</code> </td><td style="text-align: left;"> A column for the time dimension</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>values</code> </td><td style="text-align: left;"> A column for numerical values</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>flags</code> </td><td style="text-align: left;"> A column for flags if the <code>keep_flags=TRUE</code> or <code>cflags=TRUE</code> otherwise this column
     is not included in the data table
   </td>
</tr>

</table>

<p>The data.table does not include all missing values. The missing values are dropped if the value and flag are missing
on a particular time.
</p>
<p>In case the provided <code>filters</code> can be found in the DSD, then it is used to query the API or applied locally. If the applied <code>filters</code> with combination of <code>date_filter</code> 
and <code>select_freq</code> has no observation in the data set then the fucntion returns the data.table with 0 row.
</p>
<p>In case none of the provided <code>filters</code>, <code>date_filter</code> or <code>select_freq</code> can be parsed or found in the DSD then the whole dataset downloaded through the bulk download with a warning message.
</p>
<p>In case the <code>id</code> is not exist then the function returns the value <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code>, <code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_bulk">get_eurostat_bulk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>load_cfg()
eu&lt;-get("cc",envir=restatapi::.restatapi_env)



if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
head(get_eurostat_data("NAMA_10_GDP"))
head(get_eurostat_data("htec_cis3",update_cache=TRUE,check_toc=TRUE,verbose=TRUE))
head(get_eurostat_data("agr_r_milkpr",cache_dir="/tmp",cflags=TRUE))
options(restatapi_update=FALSE)
options(restatapi_cache_dir=file.path(tempdir(),"restatapi"))
head(get_eurostat_data("avia_gonc",select_freq="A",cache=FALSE))
head(get_eurostat_data("agr_r_milkpr",date_filter=2008,keep_flags=TRUE))
dt&lt;-get_eurostat_data("avia_par_me",
                      filters="BE$",
                      exact_match=FALSE,
                      date_filter=c(2016,"2017-03","2017-07-01"),
                      select_freq="Q",
                      label=TRUE,
                      name=FALSE)
dt&lt;-get_eurostat_data("agr_r_milkpr",
                      filters=c("BE$","Ungarn"),
                      lang="de",
                      date_filter="2007-06&lt;",
                      keep_flags=TRUE)
dt&lt;-get_eurostat_data("nama_10_a10_e",
                      filters=c("Annual","EU28","Belgium","AT","Total","EMP_DC","person"),
                      date_filter=c("2008",2002,2013:2018))
dt&lt;-get_eurostat_data("vit_t3",
                      filters=c("EU28",eu$EA15,"HU$"),
                      date_filter=c("2015",2007))
dt&lt;-get_eurostat_data("avia_par_me",
                      filters="Q...ME_LYPG_HU_LHBP+ME_LYTV_UA_UKKK",
                      date_filter=c("2016-08","2017-07-01"),
                      select_freq="M")
dt&lt;-get_eurostat_data("htec_cis3",
                       filters="lu",
                       ignore.case=TRUE) 
dt&lt;-get_eurostat_data("bop_its6_det",
                       filters=list(bop_item="SC",
                                    currency="MIO_EUR",
                                    partner="EXT_EU28",
                                    geo=c("EU28","HU"),
                                    stk_flow="BAL",
                                    time="2015:2020"),
                       date_filter="2010:2012",
                       select_freq="A",
                       label=TRUE,
                       name=FALSE)
clean_restatapi_cache("/tmp",verbose=TRUE)                                 
options(timeout=60)

</code></pre>

<hr>
<h2 id='get_eurostat_dsd'>Download the Data Structure Definition of a dataset</h2><span id='topic+get_eurostat_dsd'></span>

<h3>Description</h3>

<p>Download Data Structure Definition (DSD) of a Eurostat dataset if it is not cached previously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_dsd(
  id,
  lang = "en",
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_dsd_+3A_id">id</code></td>
<td>
<p>a character string with the id of the dataset. It is a value from the <code>codename</code> column of the <code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code> function.</p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the name column of the DSD. It is used only in the new API. The default is <code>en</code> - English.</p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_cache">cache</code></td>
<td>
<p>a boolean whether to load/save the DSD from/in the cache or not. The default value is <code>TRUE</code>, so that the DSD is checked first in the cache and if does not exist then downloaded from Eurostat and cached.</p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_update_cache">update_cache</code></td>
<td>
<p>a boolean to update cache or not. The default value is <code>FALSE</code>, so the cache is not updated. Can be set also with <code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The default is <code>NULL</code>, in this case the DSD is cached in the memory (in the '.restatapi_env'). Otherwise if the <code>cache_dir</code> directory does not exist it creates the 'restatapi' directory in the temporary directory from <code>tempdir()</code> to save the RDS-file. Directory can also be set with <code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_dsd_+3A_...">...</code></td>
<td>
<p>parameter to pass on the <code>load_cfg</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The DSD is downloaded from Eurostat's website, through the REST API in XML (SDMX-ML) format.
</p>


<h3>Value</h3>

<p>If the DSD does not exist it returns <code>NULL</code> otherwise the result is a table with the 3 columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>concept</code> </td><td style="text-align: left;"> The name of the concepts in the order of the data structure </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>code</code> </td><td style="text-align: left;"> The possible list of codes under the concept </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>name</code> </td><td style="text-align: left;"> The name/description of the code 
   </td>
</tr>

</table>



<h3>References</h3>

<p>For more information see the detailed documentation of the <a href="https://ec.europa.eu/eurostat/data/web-services">API</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
head(get_eurostat_dsd("med_rd6",lang="de",cache=FALSE,verbose=TRUE))
options(timeout=60)

</code></pre>

<hr>
<h2 id='get_eurostat_raw'>Get Eurostat data as it is</h2><span id='topic+get_eurostat_raw'></span>

<h3>Description</h3>

<p>Download data sets from <a href="https://ec.europa.eu/eurostat">Eurostat</a> database .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_raw(
  id,
  mode = "txt",
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  stringsAsFactors = FALSE,
  keep_flags = FALSE,
  check_toc = FALSE,
  melt = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_raw_+3A_id">id</code></td>
<td>
<p>A code name for the dataset of interest.
See <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> for details how to get an id.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_mode">mode</code></td>
<td>
<p>defines the format of the downloaded dataset. It can be <code>txt</code> (the default value) for 
Tab Separated Values (TSV), or <code>csv</code> for SDMX-CSV, or <code>xml</code> for the SDMX-ML version.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_cache">cache</code></td>
<td>
<p>a logical whether to do caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_update_cache">update_cache</code></td>
<td>
<p>a logical with a default value <code>FALSE</code>, whether to update cache. Can be set also with
<code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The <code>NULL</code> (default) uses the memory as cache. 
If the folder  if the <code>cache_dir</code> directory does not exist it saves in the 'restatapi' directory 
under the temporary directory from <code>tempdir()</code>. Directory can also be set with
<code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the
RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_stringsasfactors">stringsAsFactors</code></td>
<td>
<p>if <code>TRUE</code> the variables which are not numeric are
converted to factors. The default value <code>FALSE</code>, in this case they are returned as characters.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_keep_flags">keep_flags</code></td>
<td>
<p>a logical whether the observation status (flags) - e.g. &quot;confidential&quot;,
&quot;provisional&quot;, etc. - should be kept in a separate column or if they
can be removed. Default is <code>FALSE</code>. For flag values see: 
<a href="https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en">https://ec.europa.eu/eurostat/api/dissemination/sdmx/2.1/codelist/ESTAT/OBS_STATUS/?compressed=false&amp;format=TSV&amp;lang=en</a>.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_check_toc">check_toc</code></td>
<td>
<p>a boolean whether to check the provided <code>id</code> in the Table of Contents (TOC) or not. The default value 
<code>FALSE</code>, in this case the base URL for the download link is retrieved from the configuration file. 
If the value is <code>TRUE</code> then the TOC is downloaded and the <code>id</code> is checked in it. If it found then the download link 
is retrieved form the TOC.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_melt">melt</code></td>
<td>
<p>a boolean with default value <code>TRUE</code> and used only if the <code>mode="txt"</code>. In case it is <code>FALSE</code>, 
the downloaded tsv file is not melted, the time dimension remains in columns and it does not process the flags.</p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_raw_+3A_...">...</code></td>
<td>
<p>further argument for the <code><a href="#topic+load_cfg">load_cfg</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data sets are downloaded from <a href="https://wikis.ec.europa.eu/display/EUROSTATHELP/Transition+-+from+Eurostat+Bulk+Download+to+API">the Eurostat bulk download facility</a> 
in CSV, TSV or SDMX format.
</p>
<p>The <code>id</code>, should be a value from the <code>code</code> column of the table of contents (<code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code>), and can be searched for with the <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code> function. The id value can be retrieved from the <a href="https://ec.europa.eu/eurostat/data/database">Eurostat database</a>
as well. The Eurostat database gives codes in the Data Navigation Tree after every dataset in parenthesis.
By default all datasets downloaded in TSV format and cached as they are often rather large. 
The datasets cached in memory (default) or can be stored in a temporary directory if <code>cache_dir</code> or <code>option(restatpi_cache_dir)</code> is defined.
The cache can be emptied with <code><a href="#topic+clean_restatapi_cache">clean_restatapi_cache</a></code>.
If the <code>id</code> is checked in TOC then the data will saved in the cache with the date from the &quot;lastUpdate&quot; column from the TOC, otherwise it is saved with the current date.
</p>


<h3>Value</h3>

<p>a data.table with the following columns if the default <code>melt=TRUE</code> is used:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>FREQ</code> </td><td style="text-align: left;"> The frequency of the data (<strong>A</strong>nnual, <strong>S</strong>emi-annual, <strong>H</strong>alf-year, <strong>Q</strong>uarterly, <strong>M</strong>onthly,
 <strong>W</strong>eekly, <strong>D</strong>aily)</td>
</tr>
<tr>
 <td style="text-align: left;">
 dimension names </td><td style="text-align: left;"> One column for each dimension in the data</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>TIME_FORMAT</code> </td><td style="text-align: left;"> A column for the time format, if the source file SDMX-ML and the data was not
 loaded from a previously cached TSV download (this column is missing if the source file is TSV)</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>time/TIME_PERIOD</code> </td><td style="text-align: left;"> A column for the time dimension, where the name of the column depends on the
 source file (TSV/SDMX-ML)</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>values/OBS_VALUE</code> </td><td style="text-align: left;"> A column for numerical values, where the name of the column depends on the
 source file (TSV/SDMX-ML)</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>flags/OBS_STATUS</code> </td><td style="text-align: left;"> A column for flags if the <code>keep_flags=TRUE</code> otherwise this column is not included
 in the data table, and the name of the column depends on the source file (TSV/SDMX-ML)
 </td>
</tr>

</table>

<p>The data does not include all missing values. The missing values are dropped if the value and flags are missing
on a particular time. 
</p>
<p>In case <code>melt=FALSE</code> the results is a data.table where the first column contains the comma separated values of the various dimensions, and the columns contains the observations for each time dimension.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+get_eurostat_bulk">get_eurostat_bulk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
head(get_eurostat_raw("agr_r_milkpr",keep_flags=TRUE))
head(get_eurostat_raw("avia_par_ee",mode="xml",check_toc=TRUE,update_cache=TRUE,verbose=TRUE))
options(restatapi_update=FALSE)
head(get_eurostat_raw("avia_par_me",mode="txt",melt=FALSE))
head(get_eurostat_raw("avia_par_me",
                      mode="txt",
                      cache_dir=tempdir(),
                      compress_file=FALSE,
                      verbose=TRUE))
options(timeout=60)

</code></pre>

<hr>
<h2 id='get_eurostat_toc'>Download the Table of Contents of Eurostat datasets</h2><span id='topic+get_eurostat_toc'></span>

<h3>Description</h3>

<p>Download Table of Contents (TOC) of Eurostat datasets if it is not cached previously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_eurostat_toc(
  mode = "xml",
  cache = TRUE,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE,
  lang = "en",
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_eurostat_toc_+3A_mode">mode</code></td>
<td>
<p>a character string either <code>xml</code> or <code>txt</code> defining the download mode. Depending on the mode the 'xml' version or the 'text' version of the TOC is downloaded.
The deafult value is <code>xml</code> as it provides more information (e.g. number of values, short description and  download links in different formats (SDMX, TSV))</p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_cache">cache</code></td>
<td>
<p>a boolean whether to load/save the TOC from/in the cache or not. The default value is <code>TRUE</code>, so that the TOC is checked first in the cache and if does not exist then downloaded from Eurostat and cached.</p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_update_cache">update_cache</code></td>
<td>
<p>a boolean to update cache or not. The default value is <code>FALSE</code>, so the cache is not updated. Can be set also with <code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The default is <code>NULL</code>, in this case the TOC is cached in the memory (in the '.restatapi_env'). Otherwise if the <code>cache_dir</code> directory does not exist it creates the 'restatapi' directory in the temporary directory from <code>tempdir()</code> to save the RDS- file. Directory can also be set with <code>option(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the table of contents. The default is <code>en</code> - English.</p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="get_eurostat_toc_+3A_...">...</code></td>
<td>
<p>parameter to pass on the <code>load_cfg</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The TOC is downloaded from Eurostat websites through the REST API for the <code>xml</code> (default) version or from the bulk download facilities for <code>txt</code> version.
From the downloaded TOC the values in the 'code' column can be used as <code>id</code> in the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code>, <code><a href="#topic+get_eurostat_bulk">get_eurostat_bulk</a></code>, and <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code> functions.
</p>


<h3>Value</h3>

<p>A data table with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>title</code> </td><td style="text-align: left;"> The name of dataset/table in the language provided by the <code>lang</code> parameter</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>code</code> </td><td style="text-align: left;"> The codename of dataset/table which can be used as <code>id</code> in other functions</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>type</code> </td><td style="text-align: left;"> The type of information: 'dataset' or 'table'</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>lastUpdate</code> </td><td style="text-align: left;"> The date when the data was last time updated for tables and datasets</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>lastModified</code></td><td style="text-align: left;"> The date when the structure of the dataset/table was last time modified</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>dataStart</code></td><td style="text-align: left;"> The start date of the data in the dataset/table</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>dataEnd</code></td><td style="text-align: left;"> The end date of the data in the dataset/table</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>values</code></td><td style="text-align: left;"> The number of values in the dataset/table, and it is filled only if the download
 <code>mode</code> is "xml"</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>unit</code></td><td style="text-align: left;"> The unit name for tables in the language provided by the <code>lang</code> parameter, for
 dataset it is empty and this column exists only if the download <code>mode</code> is "xml"</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>shortDescription</code></td><td style="text-align: left;"> The short description of the values for tables in the language provided by the
 <code>lang</code> parameter, for dataset it is empty and this column exists only if the download <code>mode</code> is "xml"</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>metadata.html</code></td><td style="text-align: left;"> The link to the metadata in html format, and this column exists only if the
 download <code>mode</code> is "xml"</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>metadata.sdmx</code></td><td style="text-align: left;"> The link to the metadata in SDMX format, and this column exists only if the
 download <code>mode</code> is "xml"</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>downloadLink.tsv</code></td><td style="text-align: left;"> The link to the whole dataset/table in tab separated values format in the bulk
 download facility and this column exists only if the download <code>mode</code> is "xml"
 </td>
</tr>

</table>



<h3>References</h3>

<p>For more technical information see the detailed documentation of the <a href="https://ec.europa.eu/eurostat/data/web-services">API</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code>, <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code>, <code><a href="#topic+get_eurostat_bulk">get_eurostat_bulk</a></code>, <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
toc_xml&lt;-get_eurostat_toc(cache=FALSE,verbose=TRUE)
head(toc_xml)
toc_txt&lt;-get_eurostat_toc(mode="txt", lang="de")
head(toc_txt)
options(timeout=60)

</code></pre>

<hr>
<h2 id='load_cfg'>Load configuration data from JSON</h2><span id='topic+load_cfg'></span>

<h3>Description</h3>

<p>Load the configuration information to the '.restatapi_env' from the JSON configuration file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>load_cfg(
  api_version = "default",
  cfg_file = "github",
  load_toc = FALSE,
  parallel = TRUE,
  max_cores = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="load_cfg_+3A_api_version">api_version</code></td>
<td>
<p>It can be either &quot;old&quot;, &quot;new&quot;, &quot;test&quot; or &quot;current&quot;. The default value is &quot;current&quot; which defined by the DEFAULT_API_VERSION value of the config file.</p>
</td></tr>
<tr><td><code id="load_cfg_+3A_cfg_file">cfg_file</code></td>
<td>
<p>The location of the config file. It can be either &quot;github&quot; (the default value) or &quot;local&quot;.</p>
</td></tr>
<tr><td><code id="load_cfg_+3A_load_toc">load_toc</code></td>
<td>
<p>The default value <code>FALSE</code>, which means that the XML version of the Table of contents (TOC) will not be downloaded and 
cached automatically in the '.restatapi_env' when the package is loaded.</p>
</td></tr>
<tr><td><code id="load_cfg_+3A_parallel">parallel</code></td>
<td>
<p>A boolean with the default value <code>TRUE</code>. If there are multiple cores/logical processors then part of the data 
extraction is made in parallel reducing significantly the time needed for large datasets. If the value is <code>FALSE</code> the option <code>restatapi_cores</code> set to 1.</p>
</td></tr>
<tr><td><code id="load_cfg_+3A_max_cores">max_cores</code></td>
<td>
<p>A boolean with the default value <code>FALSE</code>. If the parameter 'parallel' is <code>TRUE</code> then this parameter is taken into account otherwise it is ignored.
If the value is <code>TRUE</code>, then the maximum minus one cores/logical processors are used for parallel computing. If the parameter <code>FALSE</code>, 
then the default value of <code>getOption("mc.cores")</code> is used, if it is defined. If <code>mc.cores</code> is <code>NULL</code> then depending on the memory size and number of available cores/threads the <code>restatapi_cores</code> are set to 2 or 4 cores/logical processors. 
Otherwise the parallel processing turned off by setting the option <code>restatapi_cores</code> to 1.
The number of cores used for parallel computing can be changed any time with <code>options(restatapi_cores=...)</code></p>
</td></tr>
<tr><td><code id="load_cfg_+3A_verbose">verbose</code></td>
<td>
<p>A boolean if the verbose message about the configuration to be showed or not. The default is <code>FALSE</code>. Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loads configuration data from a JSON file. The function first tries to load the configuration file from GitHub. 
If it is not possible it loads from the file delivered with the package. By this way different version of the API can be tested. 
Since in many cases there is http/https redirection in the download which can cause problems with the 'wininet' download method, the 'libcurl' method is used when it is available.
This configuration code sets up the parallel processing to handle large XML files efficiently. By default if there is more then 4 cores/logical processors and at least 32 GB of RAM then
4 cores are used for parallel computing. If there is more then 2 cores then 2 cores are used. This default configuration can be overwritten with <code>options(restatapi_cores=...)</code> or with the <code>max_cores=TRUE</code> parameter.
In the second case part of the computation distributed over the maximum number minus one cores. By using the <code>max_cores=TRUE</code> option there is a higher probability that the program will run out off memory for larger datasets.  
In addition, the list of country codes are loaded to the variable <code>cc</code> (country codes), based on the  <a href="https://ec.europa.eu/eurostat/ramon/nomenclatures/index.cfm?TargetUrl=LST_NOM_DTL&amp;StrNom=CL_GEO&amp;StrLanguageCode=EN&amp;IntPcKey=42277583&amp;IntResult=1&amp;StrLayoutCode=HIERARCHIC">Eurostat standard code list</a>
</p>


<h3>Value</h3>

<p>it returns 4 objects in the '.restatapi_env'  
</p>

<ul>
<li> <p><code>cfg</code> a list with all the configuration data
</p>
</li>
<li> <p><code>rav</code> a character string with a number defining the API_VERSION from the configuration file to be used later. It is 
determined based on the <code>api_version</code> parameter.   
</p>
</li>
<li> <p><code>cc</code> a list containing the 2 character country codes of the member states for different EU composition like EU15, EU28 or EA (Euro Area).   
</p>
</li>
<li> <p><code>dmethod</code> the download method to be used to access Eurostat database. If the 'libcurl' method exists under Windows then 
it will be the default method for file download, otherwise it will be set 'auto'. The download method can be changed any time with <code>options(restatapi_dmethod=...)</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
load_cfg(parallel=FALSE)
options(restatapi_dmethod="auto")
load_cfg(api_version="test",verbose=TRUE,max_cores=FALSE)
load_cfg()
eu&lt;-get("cc",envir=.restatapi_env)
eu$EU28
eu$EA15

</code></pre>

<hr>
<h2 id='put_eurostat_cache'>Put an object to cache</h2><span id='topic+put_eurostat_cache'></span>

<h3>Description</h3>

<p>Save the object (dataset/toc/DSD) to cache
</p>


<h3>Usage</h3>

<pre><code class='language-R'>put_eurostat_cache(
  obj,
  oname,
  update_cache = FALSE,
  cache_dir = NULL,
  compress_file = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="put_eurostat_cache_+3A_obj">obj</code></td>
<td>
<p>an object (toc, dataset, DSD)</p>
</td></tr>
<tr><td><code id="put_eurostat_cache_+3A_oname">oname</code></td>
<td>
<p>a character string with the name of the object to reference later in the cache</p>
</td></tr>
<tr><td><code id="put_eurostat_cache_+3A_update_cache">update_cache</code></td>
<td>
<p>a logical with a default value <code>FALSE</code>, whether to update the cache. In this case the existing value in the cache is overwritten.  Can be set also with <code>options(restatapi_update=TRUE)</code></p>
</td></tr>
<tr><td><code id="put_eurostat_cache_+3A_cache_dir">cache_dir</code></td>
<td>
<p>a path to a cache directory. The default is <code>NULL</code>, in this case the object is saved in the memory (in the '.restatapi_env'). Otherwise if the <code>cache_dir</code> directory does not exist it saves in the 'restatapi' directory under the temporary directory from <code>tempdir()</code>. Directory can also be set with <code>options(restatapi_cache_dir=...)</code>.</p>
</td></tr>
<tr><td><code id="put_eurostat_cache_+3A_compress_file">compress_file</code></td>
<td>
<p>a logical whether to compress the RDS-file in caching. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Saves a given object in cache. This can be the memory <code>.restatapi_env</code> or on the hards disk. If the given <code>cache_dir</code> does not exist then the file is saved in the R temp directory (<code>tempdir()</code>). If the file or object with the <code>oname</code> exists in the cache, then the object is not cached.
</p>


<h3>Value</h3>

<p>The function returns the place where the object was cached: either it creates an the object in the memory ('.restatapi_env') or creates an RDS-file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dt&lt;-data.frame(txt=c("a","b","c"),nr=c(1,2,3))
put_eurostat_cache(dt,"teszt")
get("teszt",envir=restatapi::.restatapi_env)
put_eurostat_cache(dt,"teszt",cache_dir=tempdir())
readRDS(file.path(tempdir(),"teszt.rds"))
clean_restatapi_cache(cache_dir=tempdir())

</code></pre>

<hr>
<h2 id='search_eurostat_dsd'>Search for pattern in the Data Structure Definition of a dataset</h2><span id='topic+search_eurostat_dsd'></span>

<h3>Description</h3>

<p>Search the Data Structure Definition (DSD) of a Eurostat dataset for a given pattern. It returns 
the rows where the pattern appears in the code and name column of the output of the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> 
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_eurostat_dsd(pattern, dsd = NULL, name = TRUE, exact_match = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search_eurostat_dsd_+3A_pattern">pattern</code></td>
<td>
<p>a character string or a vector of character string.</p>
</td></tr>
<tr><td><code id="search_eurostat_dsd_+3A_dsd">dsd</code></td>
<td>
<p>a table containing Data Structure Definition (DSD) of a Eurostat dataset which can be retreived by the <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> function.</p>
</td></tr>
<tr><td><code id="search_eurostat_dsd_+3A_name">name</code></td>
<td>
<p>a boolean with the default value <code>TRUE</code>, if the search shall look for the pattern in the name of the code.
If the value <code>FALSE</code>, then only the 'code' column of the DSD will be  searched.</p>
</td></tr>
<tr><td><code id="search_eurostat_dsd_+3A_exact_match">exact_match</code></td>
<td>
<p>a boolean with the default value <code>FALSE</code>, if the strings provided in <code>pattern</code> shall be matched exactly as it is or as a pattern.</p>
</td></tr>
<tr><td><code id="search_eurostat_dsd_+3A_...">...</code></td>
<td>
<p>additional arguments to the <code>grep</code> function like <code>ignore.case=TRUE</code> if the pattern should be searched case sensitive or not. 
The default value for <code>ignore.case</code> is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns the line(s) where the searched pattern appears in the code or in the name column.
</p>


<h3>Value</h3>

<p>If the pattern found then the function returns a data.frame with the 4 columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
 <code>pattern</code> </td><td style="text-align: left;"> The pattern which was searched</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>concept</code> </td><td style="text-align: left;"> The name of the concepts in the data structure</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>code</code> </td><td style="text-align: left;"> The list of codes where the pattern was found, or the code of a name where the pattern appears</td>
</tr>
<tr>
 <td style="text-align: left;">
 <code>name</code> </td><td style="text-align: left;"> The name/description of the code where the pattern found, or the name of the code where the
 pattern appears 
 </td>
</tr>

</table>

<p>Otherwise returns the value <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code>, <code><a href="#topic+create_filter_table">create_filter_table</a></code>, <code><a href="#topic+search_eurostat_toc">search_eurostat_toc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
dsd_example&lt;-get_eurostat_dsd("nama_10_gdp",verbose=TRUE)
search_eurostat_dsd("EU",dsd_example)
search_eurostat_dsd("EU",dsd_example,ignore.case=TRUE)
search_eurostat_dsd("EU27_2019",dsd_example,name=FALSE)
search_eurostat_dsd("EU27_2019",dsd_example,exact_match=TRUE)
options(timeout=60)

</code></pre>

<hr>
<h2 id='search_eurostat_toc'>Search for pattern in the titles, units and short description of the TOC</h2><span id='topic+search_eurostat_toc'></span>

<h3>Description</h3>

<p>Lists names of dataset from Eurostat with the particular
pattern in the title, units or short description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_eurostat_toc(pattern, lang = "en", verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search_eurostat_toc_+3A_pattern">pattern</code></td>
<td>
<p>Character string to search for in the table of contents of Eurostat tables/datasets</p>
</td></tr>
<tr><td><code id="search_eurostat_toc_+3A_lang">lang</code></td>
<td>
<p>a character string either <code>en</code>, <code>de</code> or <code>fr</code> to define the language version for the table of contents. The default is <code>en</code> - English.</p>
</td></tr>
<tr><td><code id="search_eurostat_toc_+3A_verbose">verbose</code></td>
<td>
<p>A boolean with default <code>FALSE</code>, so detailed messages (for debugging) will not printed.
Can be set also with <code>options(restatapi_verbose=TRUE)</code></p>
</td></tr>
<tr><td><code id="search_eurostat_toc_+3A_...">...</code></td>
<td>
<p>other additional parameters to pass to the <code>grepl</code> function like <code>ignore.case=TRUE</code> if the pattern should be searched case sensitive or not. 
The default value for <code>ignore.case</code> is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Downloads the list of all tables and datasets available in the 
Eurostat database and returns all the details from the table of contents of the tables/datasets that contains particular
pattern in the dataset title, unit or short description. E.g. all tables/datasets  mentioning
'energy'.
</p>


<h3>Value</h3>

<p>A table with the following columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
     <code>title</code> </td><td style="text-align: left;"> The name of dataset/table in the language provided by the <code>lang</code> parameter </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>code</code> </td><td style="text-align: left;"> The codename of dataset/table which can be used by the <code>get_eurostat</code> function </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>type</code> </td><td style="text-align: left;"> The type of information: 'dataset' or 'table' </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>lastUpdate</code> </td><td style="text-align: left;"> The date when the data was last time updated for tables and datasets</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>lastModified</code></td><td style="text-align: left;"> The date when the structure of the dataset/table was last time modified</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>dataStart</code></td><td style="text-align: left;"> The start date of the data in the dataset/table</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>dataEnd</code></td><td style="text-align: left;"> The end date of the data in the dataset/table</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>values</code></td><td style="text-align: left;"> The number of values in the dataset/table</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>unit</code></td><td style="text-align: left;"> The unit name for tables in the language provided by the <code>lang</code> parameter, if the <code>type</code> 'dataset' this column is empty </td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>shortDescription</code></td><td style="text-align: left;"> The short description of the values for tables in the language provided by the <code>lang</code> parameterif the <code>type</code> 'dataset' this column is empty</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>metadata.html</code></td><td style="text-align: left;"> The link to the metadata in html format</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>metadata.sdmx</code></td><td style="text-align: left;"> The link to the metadata in SDMX format</td>
</tr>
<tr>
 <td style="text-align: left;">
     <code>downloadLink.tsv</code></td><td style="text-align: left;"> The link to the whole dataset/table in tab separated values format in the bulk download facility
   </td>
</tr>

</table>

<p>The value in the <code>code</code> column can be used as an id in the <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+get_eurostat_bulk">get_eurostat_bulk</a></code>, <code><a href="#topic+get_eurostat_raw">get_eurostat_raw</a></code> and <code><a href="#topic+get_eurostat_dsd">get_eurostat_dsd</a></code> functions.
If there is no hit for the search query, it returns <code>NULL</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_eurostat_dsd">search_eurostat_dsd</a></code>, <code><a href="#topic+get_eurostat_data">get_eurostat_data</a></code>, <code><a href="#topic+get_eurostat_toc">get_eurostat_toc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

if (!(grepl("amzn|-aws|-azure ",Sys.info()['release']))) options(timeout=2)
head(search_eurostat_toc("energy",verbose=TRUE))
nrow(search_eurostat_toc("energy"))
head(search_eurostat_toc("energie",lang="de",ignore.case=TRUE))
nrow(search_eurostat_toc("energie",lang="de",ignore.case=TRUE))
options(timeout=60)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
