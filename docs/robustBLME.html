<!DOCTYPE html><html lang="en"><head><title>Help for package robustBLME</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robustBLME}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ergoStool'><p>Ergometrics experiment with stool types</p></a></li>
<li><a href='#hpd'><p>Empirical Highest Posterior Density Interval</p></a></li>
<li><a href='#kdeFSBT'><p>Full Significance Bayesian Testing</p></a></li>
<li><a href='#rblme'><p>Fits robust Bayesian Linear Mixed-effects Models (LMM) to data via robust REML estimating functions.</p></a></li>
<li><a href='#tune.h'><p>Tune ABC distance bandwidth</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Bayesian Linear Mixed-Effects Models using ABC</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-01-29</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Erlis Ruli &lt;erlisr@yahoo.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian robust fitting of linear mixed effects models through weighted likelihood equations and approximate Bayesian computation as proposed by Ruli et al. (2017) &lt;<a href="https://doi.org/10.48550/arXiv.1706.01752">doi:10.48550/arXiv.1706.01752</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), lme4 (&ge; 1.1.12)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>devtools</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/erlisR/robustBLME">https://github.com/erlisR/robustBLME</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/erlisR/robustBLME/issues">https://github.com/erlisR/robustBLME/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.1), numDeriv, mvtnorm, utils, parallel,
doParallel, foreach, iterators, stats</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Author:</td>
<td>Erlis Ruli [aut, cre],
  Nicola Sartori [aut],
  Laura Ventura [aut]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-01-29 13:15:52 UTC; erlisruli</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-01-30 13:24:20 UTC</td>
</tr>
</table>
<hr>
<h2 id='ergoStool'>Ergometrics experiment with stool types</h2><span id='topic+ergoStool'></span>

<h3>Description</h3>

<p>The <code>ergoStool</code> data frame has 36 rows and 3 columns.
</p>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>effort</dt><dd>
<p>a numeric vector giving the effort (Borg scale) required to
arise from a stool.
</p>
</dd>
<dt>Type</dt><dd>
<p>a factor with levels
<code>T1</code>,
<code>T2</code>,
<code>T3</code>, and
<code>T4</code> giving the stool type.
</p>
</dd>
<dt>Subject</dt><dd>
<p>an ordered factor giving a unique identifier for the subject
in the experiment.
</p>
</dd>
</dl>



<h3>Details</h3>

<p>Devore (2000) cites data from an article in <em>Ergometrics</em> (1993,
pp. 519-535) on &ldquo;The Effects of a Pneumatic Stool and a One-Legged
Stool on Lower Limb Joint Load and Muscular Activity.&rdquo;
</p>


<h3>Source</h3>

<p>Pinheiro, J. C. and Bates, D. M. (2000), <em>Mixed-Effects Models in S
and S-PLUS</em>, Springer, New York.  (Appendix A.9)
</p>
<p>Devore, J. L. (2000), <em>Probability and Statistics for
Engineering and the Sciences (5th ed)</em>, Duxbury, Boston, MA.
</p>

<hr>
<h2 id='hpd'>Empirical Highest Posterior Density Interval</h2><span id='topic+hpd'></span>

<h3>Description</h3>

<p>Computes the Highest Posterior Density (HPD) interval from a posterior sample. Works only for scalar marginal posteriors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpd(x, prob = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hpd_+3A_x">x</code></td>
<td>
<p>a univariate or a posterior sample for a scalar parameter.</p>
</td></tr>
<tr><td><code id="hpd_+3A_prob">prob</code></td>
<td>
<p>posterior probability content.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of two doubles.
</p>

<hr>
<h2 id='kdeFSBT'>Full Significance Bayesian Testing</h2><span id='topic+kdeFSBT'></span>

<h3>Description</h3>

<p>Performs Full Significance Bayesian Testing (FSBT) for univariate sharp
null hypothesis based on a posterior sample. The marginal posterior density is obtained by kernel density estimation from <code>sim.sample</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdeFSBT(H0, sim.sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kdeFSBT_+3A_h0">H0</code></td>
<td>
<p>a scalar value under the null hypothesis.</p>
</td></tr>
<tr><td><code id="kdeFSBT_+3A_sim.sample">sim.sample</code></td>
<td>
<p>a sample from the marginal posterior distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>double
</p>


<h3>References</h3>

<p>Pereira, C. A. d. B., Stern, J. M. and Wechsler, S. (2008) Can a significance test be genuinely Bayesian? <em>Bayesian Analysis</em> <b>3</b>, 79-100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;-  rnorm(1000, 0, 1)
kdeFSBT(-1, x)

</code></pre>

<hr>
<h2 id='rblme'>Fits robust Bayesian Linear Mixed-effects Models (LMM) to data via robust REML estimating functions.</h2><span id='topic+rblme'></span>

<h3>Description</h3>

<p>This function fits robust Bayesian LMMs to data via robust REML estimating functions. The latters are those proposed by Richardson &amp; Welsh (1995), which are robustified versions of restricted maximum likelihood (REML) estimating equations. Posterior sampling is done with an ABC-MCMC algorithm, where the data are summarised through a rescaled version of the aforementioned estimating functions; see Ruli et al. (2017) for the properties and details of the method. The current package version (0.1.2) supports only models with a single random effects. Extensions to more general settings will be provided in the future versions of the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rblme(nabc, h.obj, chain.control = list(trace.init = NULL, thin.by = NULL),
        n.cores = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rblme_+3A_nabc">nabc</code></td>
<td>
<p>number of posterior samples.</p>
</td></tr>
<tr><td><code id="rblme_+3A_h.obj">h.obj</code></td>
<td>
<p>list of objects as returned by the <code><a href="#topic+tune.h">tune.h</a></code> function. Hence <code>tune.h</code> must be called first.</p>
</td></tr>
<tr><td><code id="rblme_+3A_chain.control">chain.control</code></td>
<td>
<p>parameters that control the tracing and the thinning of the chain(s).</p>
</td></tr>
<tr><td><code id="rblme_+3A_n.cores">n.cores</code></td>
<td>
<p>number of cores for parallel computation on non Windows machines. For <code>n.cores</code>&gt;2, <code>n.cores</code> chains are run each on a different core with using the same parameters but with a different random seed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list or list of lists with elements <code>abc</code> and <code>effi</code>. In case of <code>n.cores</code>=1, <code>effi</code> is the actual acceptance rate of the ABC-MCMC algorithm whereas in <code>abc</code> are stored the posterior samples. The latters are stored as a <code class="reqn">(q + c) \times</code>nabc matrix, where <code class="reqn">q</code> is the number of fixed effects, i.e. the number of columns in the design matrix and <code class="reqn">c = 2</code> is the number of variance components. Hence, the first <code class="reqn">q</code> rows of the matrix <code>abc</code> give the posterior samples for the fixed effects and the last two rows give the posterior samples for the log-variances of the fixed effects and the residual term, respectively. If <code>n.cores</code> &gt; 1, i.e. if simulations are performed in parallel, then a list of lists is returned, where each element of the list is a list with elements <code>abc</code> and <code>effi</code>, where <code>abc</code> and <code>effi</code> are as those aforementioned.
</p>


<h3>References</h3>

<p>Ruli E., Sartori N. &amp; Ventura L. (2017)
Robust approximate Bayesian inference with an application to linear mixed models.
<a href="https://arxiv.org/abs/1706.01752">https://arxiv.org/abs/1706.01752</a>
</p>
<p>Richardson A. M. &amp; Welsh A. H. (1995) Robust restricted maximum likelihood in mixed linear models. <em>Biometrics</em> <b>51</b>, 1429-1439.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tune.h">tune.h</a></code>, <code><a href="#topic+ergoStool">ergoStool</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The following example is meant for function documentation.
## For realistic use probably you'll need to take a larger sample and choose a
## "better" bandwidth h.

data(ergoStool)

require(lme4)
fm1 &lt;- lmer(effort~Type + (1| Subject), data = ergoStool)

## tune h to get 0.8% acceptance
hopt &lt;- tune.h(effort~Type + (1|Subject), data = ergoStool, n.samp = 1e+4,
               acc.rate = 0.01, n.sim.HJ = 100, grid.h = seq(0.3, 0.7, len = 3),
               prior = list(beta.sd = 10, s2.scale = 5), n.cores = 1)

## draw posterior samples with hopt.
abc.tmp &lt;- rblme(nabc = 1e+4, h.obj = hopt,
                 n.cores = 1)

# process ABC samples
abc.sim &lt;- t(abc.tmp$abc)
abc.sim[,c(5,6)] &lt;- exp(abc.sim[,c(5,6)])

# ABC posterior
colMeans(abc.sim)

# REML estimates
summary(fm1)

</code></pre>

<hr>
<h2 id='tune.h'>Tune ABC distance bandwidth</h2><span id='topic+tune.h'></span>

<h3>Description</h3>

<p>Tunes the bandwidth <code class="reqn">h</code> of the ABC distance to get the desired level of acceptance rate specified via <code>acc.rate</code>. Besides tuning <code class="reqn">h</code>, the function also builds the relevant quantities needed for running <code><a href="#topic+rblme">rblme</a></code>. For generating such quantities an internal call to <code><a href="lme4.html#topic+lmer">lmer</a></code> is performed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tune.h(formula, data, ..., n.samp = 1e+5, n.sim.HJ = 500, acc.rate, grid.h, prior,
       cHub = 1.345, cHub2 = 2.07,
       init, n.cores = 1, use.h)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tune.h_+3A_formula">formula</code></td>
<td>
<p>two-sided linear formula object describing the
fixed-effects part of the model, with the response on the left of
a <code>~</code> operator and the terms, separated by <code>+</code>
operators on the right.  The <code>"|"</code> character separates an
expression for a model matrix and a grouping factor.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_data">data</code></td>
<td>
<p>optional data frame containing the variables named
in <code>formula</code>. By default the variables are taken from the
environment of <code><a href="lme4.html#topic+lmer">lmer</a></code> called internally.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_...">...</code></td>
<td>
<p>other arguments to be passed to <code>lmer</code>. Currently none is used.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_n.samp">n.samp</code></td>
<td>
<p>number of pilot posterior samples to be drawn with ABC for each value of <code>grid.h</code>.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_n.sim.hj">n.sim.HJ</code></td>
<td>
<p>number of simulations to be used for computing the sensitivity and variability matrices.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_acc.rate">acc.rate</code></td>
<td>
<p>desired acceptance rate of the ABC-MCMC algorithm.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_grid.h">grid.h</code></td>
<td>
<p>grid of <code class="reqn">h</code> values within which the &quot;optimal&quot; value is to be found.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_prior">prior</code></td>
<td>
<p>named list of user-defined prior hyper-parameters. See &quot;Details&quot; below.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_chub">cHub</code></td>
<td>
<p>tuning constant of the Huber function for the location parameter.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_chub2">cHub2</code></td>
<td>
<p>tuning constant of the Huber proposal 2 function for the scale parameter.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_init">init</code></td>
<td>
<p>optional object to use for starting values. Currently ignored as initial values are taken from <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_n.cores">n.cores</code></td>
<td>
<p>number of cores for parallel computation on non Windows machines.</p>
</td></tr>
<tr><td><code id="tune.h_+3A_use.h">use.h</code></td>
<td>
<p>bandwidth to be used for the ABC distance. If provided, no tuning for <code class="reqn">h</code> is performed and <code>acc.rate</code> is ignored.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a specification of the <code>formula</code> and <code>data</code> the function calls internally <code>rlmer</code> and extracts from the resulting object all the necessary quantities. Then proceeds by finding the solution of the REML II robust estimating equations (Richardson &amp; Welsh 1995), with the REML estimate used as starting point. The sensitivity and the variability matrices are computed by simulation at the solution of the robust REML II estimating equation. Depending on whether <code>use.h</code> or <code>acc.rate</code> and <code>grid.h</code> are specified, the function has a different behaviour. If <code>acc.rate</code> and <code>grid.h</code> are provided, then an adaptive step is performed in order to get an &quot;optimal&quot; <code class="reqn">h</code> which gives the desired acceptance rate <code>acc.rate</code>. IN particular, for each value of <code>grid.h</code>, the function draws <code>n.samp</code> posterior samples with the ABC-MCMC algorithm and saves the resulting acceptance rate. Lastly, a function is built via a smoothing spline with acceptance rates being the <code class="reqn">x</code>s and <code>grid.h</code> being the <code class="reqn">y</code>s. The &quot;optimal&quot; value of <code class="reqn">h</code> is found, within <code>grid.h</code>, as the prediction the spline function at <code>acc.rate</code>. If you already have an <code class="reqn">h</code> value in mind then specify it via <code>use.h</code> and leave <code>grid.h</code> and <code>acc.rate</code> unspecified. Note that, in this case the acceptance rate of the ABC-MCMC algorithm may not be the one you wish to obtain since it depends in some complicated way also from <code class="reqn">use.h</code>. Currently, the prior for the <code class="reqn">q</code> fixed effects is the product of <code class="reqn">q</code> scalar normals with mean zero and user-specified variance <code>beta.sd</code> (see Examples) equal for all the parameters. For the variance components the prior is a halfCauchy with user-specified scale <code>s2.scale</code>. Both variance parameters are assumed to have equal prior scale.
</p>


<h3>Value</h3>

<p>list.
</p>


<h3>References</h3>

<p>Ruli E., Sartori N. &amp; Ventura L. (2017)
Robust approximate Bayesian inference with an application to linear mixed models.
<a href="https://arxiv.org/abs/1706.01752">https://arxiv.org/abs/1706.01752</a>
</p>
<p>Richardson A. M. &amp; Welsh A. H. (1995) Robust restricted maximum likelihood in mixed linear models. <em>Biometrics</em> <b>51</b>, 1429-1439.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rblme">rblme</a></code>, <code><a href="#topic+ergoStool">ergoStool</a></code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
