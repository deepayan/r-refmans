<!DOCTYPE html><html lang="en"><head><title>Help for package lmPerm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmPerm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Alfalfa'><p>Alfalfa Data</p></a></li>
<li><a href='#aovp'><p>Fitting and testing ANOVA using permutation tests</p></a></li>
<li><a href='#CC164'><p>Cochran and Cox, p164</p></a></li>
<li><a href='#composite'><p>Test of theroplastic composite</p></a></li>
<li><a href='#Federer276'><p>Federer 276</p></a></li>
<li><a href='#Federer276Numeric'><p>Federer 276 Numeric</p></a></li>
<li><a href='#ghoctane'><p>Octane blends</p></a></li>
<li><a href='#Hald17.4'><p>Hald Data</p></a></li>
<li><a href='#lmp'><p>Fitting and testing linear models with permutation tests.</p></a></li>
<li><a href='#lmPerm-internal'><p>Internal lmPerm function</p></a></li>
<li><a href='#manly126'><p>Manly, p126</p></a></li>
<li><a href='#manly136'><p>Non normal Ephemeroptera counts</p></a></li>
<li><a href='#multResp'><p>Multple response creation</p></a></li>
<li><a href='#NPK'><p>NPK Data</p></a></li>
<li><a href='#permute'><p>Permutation Generation</p></a></li>
<li><a href='#Plasma'><p>Plasma Etching</p></a></li>
<li><a href='#poly.formula'><p>Makes a polynomial model</p></a></li>
<li><a href='#Quinlan'><p>Quinlan's data</p></a></li>
<li><a href='#ratGenotype'><p>ratGenotype Data</p></a></li>
<li><a href='#simDesign'><p>A non-orthogonal design</p></a></li>
<li><a href='#simDesignPartNumeric'><p>A non-orthogonal design</p></a></li>
<li><a href='#summary'><p>Summarizing functions for linear models</p></a></li>
<li><a href='#summaryC'><p>Coefficient summary from aovp</p></a></li>
<li><a href='#wool'><p>wool data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Permutation Tests for Linear Models</td>
</tr>
<tr>
<td>Author:</td>
<td>Bob Wheeler &lt;bwheelerg@gmail.com&gt;, Marco Torchiano &lt;marco.torchiano@polito.it&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Torchiano &lt;marco.torchiano@polito.it&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Linear model functions using permutation tests.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mtorchiano/lmPerm">https://github.com/mtorchiano/lmPerm</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-08-02 00:00:18 UTC; mtk</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-08-02 13:20:03</td>
</tr>
</table>
<hr>
<h2 id='Alfalfa'>Alfalfa Data</h2><span id='topic+Alfalfa'></span>

<h3>Description</h3>

<p>Alfalfa data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Alfalfa)
</code></pre>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>

<hr>
<h2 id='aovp'>Fitting and testing ANOVA using permutation tests</h2><span id='topic+aovp'></span>

<h3>Description</h3>

<p><code>aovp</code> is <code><a href="stats.html#topic+aov">aov</a></code> modified to use permutation tests instead of normal
theory tests. Like <code>aov</code>, the ANOVA model is fitted by a call to <code><a href="#topic+lmp">lmp</a></code> for each
stratum. Timing differences between <code>aovp</code> and <code>aov</code> are negligible.</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovp(formula, data = NULL, perm="Exact", seqs=FALSE, 
              center=TRUE, projections = FALSE, qr = TRUE,
              contrasts = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<p>The arguments are the same as for <code><a href="stats.html#topic+aov">aov</a></code>. 
Additional parameters may be included. They are described in the 
&quot;Additional Parameters&quot; section below. These additional parameters
are the same as for <code><a href="#topic+lmp">lmp</a></code>.
</p>
<table role = "presentation">
<tr><td><code id="aovp_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model.</p>
</td></tr>
<tr><td><code id="aovp_+3A_data">data</code></td>
<td>
<p>A data frame in which the variables specified in the
formula will be found. If missing, the variables are searched for in
the standard way.</p>
</td></tr>
<tr><td><code id="aovp_+3A_perm">perm</code></td>
<td>
<p>&quot;Exact&quot;, &quot;Prob&quot;, &quot;SPR&quot; will produce permutation probabilities. 
Anything else, such as &quot;&quot;, will produce F-test probabilities.</p>
</td></tr>
<tr><td><code id="aovp_+3A_seqs">seqs</code></td>
<td>
<p>If TRUE, will calculate sequential SS. If FALSE, unique SS.</p>
</td></tr>
<tr><td><code id="aovp_+3A_center">center</code></td>
<td>
<p>If TRUE, numerical variables will be centered.</p>
</td></tr>
<tr><td><code id="aovp_+3A_projections">projections</code></td>
<td>
<p>Logical flag: should the projections be returned?</p>
</td></tr>
<tr><td><code id="aovp_+3A_qr">qr</code></td>
<td>
<p>Logical flag: should the QR decomposition be returned?</p>
</td></tr>
<tr><td><code id="aovp_+3A_contrasts">contrasts</code></td>
<td>
<p>A list of contrasts to be used for some of the factors
in the formula. These are not used for any <code>Error</code> term, and
supplying contrasts for factors only in the <code>Error</code> term will give
a warning.</p>
</td></tr>
<tr><td><code id="aovp_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>aovp</code>, such as those listed
below.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model Y=Xb+Zg+e is assumed, where X is the incidence matrix for fixed effects,
and Z is an incidence matrix for random effects, with columns representing the several error strata.
The <code>aovp()</code> algorithm projects Y into strata such that each stratum has a single error term, such
as a stratum defined by whole blocks. X is also projected so that the model
in this stratum becomes P(Y)=P(X)bi+ei. 
</p>
<p>The vector bi is divided into sources with dfj degrees of freedom for the 
jth source, and <code>summary(aovp())</code> will produce an ANOVA table for these sources
in the ith strata. See Venables and Ripley for details.
</p>
<p>Either permutation test p-values or the usual F-test 
p-values will be output. Polynomial model terms are collected into 
sources, so that <code>Y~A+B+I(A^2)</code> will contain two sources, one for A with 2 df,
and one for B with 1 df. Sources for factors are treated as usual, and polynomial
terms and factors may be mixed in one model. The function <code><a href="#topic+poly.formula">poly.formula</a></code> may 
be used to create polynomial models, and the function <code><a href="#topic+multResp">multResp</a></code> may be used to
create multiresponse matrices for the lhs from variables defined in <code>data</code>.
</p>
<p>The <code>Exact</code> method will permute the values exactly. The <code>Prob</code> and <code>SPR</code> methods will approximate
the permutation distribution by randomly exchanging pairs of Y elements. The <code>Exact</code>
method will be used by default when the number of observations is less than 
or equal to <code>maxExact</code>, otherwise <code>Prob</code> will be used.
</p>
<p>Prob:  Iterations terminate when the estimated standard error of the estimated 
proportion p is less than p*Ca. The iteration continues until all sources and 
coefficients meet this criterion or until <code>maxIter</code> is reached. See Anscome(1953) 
for the origin of the criterion. 
</p>
<p>SPR: This method uses sequential probability ratio tests to decide between 
the hypotheses <code>p0</code> and <code>p1</code> for a strength <code>(alpha, beta)</code> test. The test terminates 
upon the acceptance or rejection of p0 or if <code>maxIter</code> is reached. See Wald (1947).
The power of the SPR is beta at p0 and increases to 1-beta at p1. Placing <code>p0</code> and
<code>p1</code> close together makes the cut off sharp.  
</p>
<p>Exact: This method generates all permutations of Y. It will generally be found 
too time consuming for more than 10 or 11 observations, but note that <code><a href="#topic+aovp">aovp</a></code>
may be used to divide the data into small enough blocks for which exact 
permutation tests may be possible.
</p>
<p>For <code>Prob</code> and <code>SPR</code>, one may set <code>nCycle</code> to unity to exchange all elements instead 
of just pairs at each iteration, but there seems to be no advantage to doing this
unless the number of iterations is small &ndash; say less than 100.
</p>
<p>The SS will be calculated <em>sequentially</em>, just as <code><a href="stats.html#topic+lm">lm</a></code> does; or they may be
calculated <em>uniquely</em>, which means that the SS for each source is calculated 
conditionally on all other sources. This is SAS type III, which is also what <code>drop1()</code> 
produces, except that <code>drop1()</code> will not drop main effects when interactions are present. 
The parameter <code>seqs</code> may be used to override the default unique calculation behavior.
</p>


<h3>Value</h3>

<p>The usual output from <code><a href="stats.html#topic+aov">aov</a></code>, with permutation p-values instead of normal 
theory p-values.
</p>
<table role = "presentation">
<tr><td><code>Iter</code></td>
<td>
<p>For <code>Prob</code> and <code>SPR</code>: The number of iterations until the criterion 
is met.</p>
</td></tr>
<tr><td><code>Accept</code></td>
<td>
<p>For <code>SPR</code>: 1 the p0 hypothesis is accepted, and 0 for rejection or when no decision before maxIter occurs.</p>
</td></tr> 
</table>


<h3>Additional Parameters</h3>

<p>These are the same as for <code><a href="#topic+lmp">lmp</a></code>. 
</p>

<dl>
<dt>settings</dt><dd><p>If TRUE, settings such as sequential or unique will
be printed. Default TRUE</p>
</dd>
<dt>useF</dt><dd><p>If TRUE, SS/Resid SS will be used, otherwise SS. The 
default is TRUE</p>
</dd>
<dt>maxIter</dt><dd><p>For Prob and SPR: The maximum number of iterations. 
Default 1000.</p>
</dd>
<dt>Ca</dt><dd><p>For Prob: Stop iterations when estimated standard error 
of the estimated p is less than Ca*p. Default 0.1</p>
</dd>
<dt>p0</dt><dd><p>For SPR: Null hypothesis probability. Default 0.05</p>
</dd>
<dt>p1</dt><dd><p>For SPR: Alternative hypothesis probability. Default 0.06</p>
</dd>
<dt>alpha</dt><dd><p>For SPR: Size of SPR test. Default 0.01</p>
</dd>
<dt>beta</dt><dd><p>For SPR: Type II error for SPR test. Default 0.01</p>
</dd>
<dt>maxExact</dt><dd><p>For Exact: maximum number of observations allowed. 
If data exceeds this, Prob is used. Default 10.</p>
</dd>
<dt>nCycle</dt><dd><p>For Prob and SPR: Performs a complete random permutation, 
instead of pairwise exchanges, every nCycle cycles. Default 1000.</p>
</dd>
</dl>



<h3>Note</h3>

<p>There is a vignette with more details and an example. To access it, type 
</p>
<p>vignette(&quot;lmPerm&quot;)
</p>
<p>The default contrasts are set internally to <code>(contr.sum, contr.poly)</code>, which means
that coefficients are either pairwise contrasts with the last level or polynomial contrasts.
</p>
<p>Numerical variables should be centered in order to make them orthogonal to the constant when
ANOVA is to be done.
</p>
<p>Factors with many levels may cause problems for the methodology used by R. It is
designed to work well with both balanced and unbalanced data, but it is best used 
for factors with no more than four or five levels. If difficulties occur, degrees 
of freedom for high order sources will be reduced, and sometimes the sources will 
be omitted entirely. An error message usually accompanies such behavior. 
</p>
<p>The variables inside the <code>Error()</code> term are treated in the order given. Thus 
<code>Error(A+B)</code> will usually produce components in the order A,B, with B orthogonalized
with respect to A. This may cause confusion for unbalanced block structures.
</p>
<p>This function will behave identically to <code>aov()</code> if the following parameters are set:
<code>perm="", seq=TRUE, center=FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Hald, A. 1952</dt><dd><p>Statistical theory with engineering applications. Wiley. Table 7.4</p>
</dd>
<dt>Venables, W.N, and Ripley, B. D. (2000) </dt><dd><p>Modern applied statistics with S-Plus, p176</p>
</dd> 
<dt>Wald, A. (1947)</dt><dd><p>Sequential analysis, Wiley, Sec. 5.3</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+summary.aovp">summary.aovp</a></code>, <code><a href="#topic+lmp">lmp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## A simple randomized block example. 
# There are 7 blocks and 6 treatments. A first
# analysis with blocks as a factor shows block to be significant and treatments not. 

data(Hald17.4)
summary(aovp(Y~T+block,Hald17.4))

# Using the block to define a separate error strata tells a different story.

summary(aovp(Y~T+Error(block),Hald17.4))

# There appears to be a linear trend in the blocks. This may be investigated by
# extracting a linear component. The factor L was created by copying the block
# factor and assigning it a linear contrast, like this
# contrasts(L,1)&lt;-contr.poly(7). The analysis then becomes.

summary(aovp(Y~T+L+Error(block),Hald17.4))

# The L factor is not significant under permutation. It is significant when aov()
# is used and the test is the usual F-test.


## From Venables and Ripley (2000)
# This is a 2^3 factorial in the variables N,P,K. It is fractioned by using the 
# three way interaction, NPK, into two fractions of 4. Each of these fractions is 
# allocated to 3 blocks, making 6 blocks in all. An analysis with block as a 
# variable is the following. As may be seen, aovp() discards the confounded NPK interaction.

data(NPK)
summary(aovp(yield ~ block + N*P*K, NPK))

# Since the NPK interaction was confounded with blocks, the experimenter no doubt judged 
# it of lesser interest. It may however be examined by including blocks as an additional
# error term as follows. The basic error level between blocks is of course larger than 
# that within blocks, so the NPK interaction would have to be substantially larger that
# it would have had to be were it tested within blocks.
summary(aovp(yield ~  N*P*K + Error(block), NPK))

# The SS calculated by aovp() are unique SS by default. That is,
# they are sums of squares for the difference of a model with and without the source. The
# resulting test is a test of the hypothesis that the source has no effect on the response.
# Sequential SS, which are those produced by aov() may be obtained by setting the
# parameter seqs=TRUE. simDesign is an unbalanced design created by the AlgDesign package.

data(simDesign)
summary(aovp(Y~.,simDesign))
summary(aovp(Y~.,simDesign,seqs=TRUE)) 

# Since there is only one stratum, these results are the same as would be obtained from
anova(lmp(Y~.,simDesign))

# ANOVA for numerical variables. First using contrasts, then numeric variables.
data(Federer276)
summary(aovp(Plants~Variety*Treatment+Error(Rep/Plot),Federer276))
data(Federer276Numeric)
summary(aovp(poly.formula(Plants~quad(Variety,Treatment)+Error(Rep/Plot)),Federer276Numeric))
# The coefficients and their p-values may be obtained by
summaryC(aovp(Plants~Variety*Treatment+Error(Rep/Plot),Federer276))


</code></pre>

<hr>
<h2 id='CC164'>Cochran and Cox, p164</h2><span id='topic+CC164'></span>

<h3>Description</h3>

<p>Factorial Experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(CC164)
</code></pre>


<h3>Details</h3>

<p>A three factor experiment involving lettuce plants. Response is
the number of lettuce plants emerging after treatment by three
levels of either nitrogen or phospate fertilizer.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Chochran, W. and Cox, G. (1957). Experimental Design, 2nd Ed.
John Wiley &amp; Sons, New York. 
</p>

<hr>
<h2 id='composite'>Test of theroplastic composite</h2><span id='topic+composite'></span>

<h3>Description</h3>

<p>Data from a factorial experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(composite)
</code></pre>


<h3>Details</h3>

<p>A two variable factorial experiment to test the strength of a thermoplastic
composite to laser intensity and tape speed. 
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Faraway, J. (2005). Linear Models with R. Chapman and Hall. N.Y. 
</p>

<hr>
<h2 id='Federer276'>Federer 276</h2><span id='topic+Federer276'></span>

<h3>Description</h3>

<p>Randomized block in three replicates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Federer276)
</code></pre>


<h3>Details</h3>

<p>A seed-gemination test on eight varieties of guayule. Four treatments 
were applied to lots of seed from the varieties. 
</p>
<p>A split plot design assigning varieties to whole plots was used. Treatments
formed randomized blocks within whole plots. There were three replicates.
</p>
<p>The whole plots were nested within replicates
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Federer, W.T. (1955). Experimental Design, Macmillan, N.Y. 
</p>

<hr>
<h2 id='Federer276Numeric'>Federer 276 Numeric</h2><span id='topic+Federer276Numeric'></span>

<h3>Description</h3>

<p>Randomized block in three replicates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Federer276)
</code></pre>


<h3>Details</h3>

<p>Varieties and Treatments are numeric variables.
</p>
<p>A seed-gemination test on eight varieties of guayule. Four treatments 
were applied to lots of seed from the varieties. 
</p>
<p>A split plot design assigning varieties to whole plots was used. Treatments
formed randomized blocks within whole plots. There were three replicates.
</p>
<p>The whole plots were nested within replicates
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Federer, W.T. (1955). Experimental Design, Macmillan, N.Y. 
</p>

<hr>
<h2 id='ghoctane'>Octane blends</h2><span id='topic+ghoctane'></span>

<h3>Description</h3>

<p>Gasoline blending mixture experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(ghoctane)
</code></pre>


<h3>Details</h3>

<p>An octane-blending experiment for a ternary system. Motor-octane ratings
were obtained for a seven lattice point design, and two checkpoints.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Gorman, J.W. and Hinman, J.E.  (1962). Simples lattice designs for
multicomponent systems. Technometics. 4-4. 463-487.
John Wiley &amp; Sons, New York. 
</p>

<hr>
<h2 id='Hald17.4'>Hald Data</h2><span id='topic+Hald17.4'></span>

<h3>Description</h3>

<p>Data from Hald Table 17.4 on p 505.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Hald17.4)
</code></pre>


<h3>Details</h3>

<p>A randomized block experiment with 7 blocks and 6 treatments.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Hald, A. (1952). Statistical theory with engineering applications. Wiley. NY.
</p>

<hr>
<h2 id='lmp'>Fitting and testing linear models with permutation tests.</h2><span id='topic+lmp'></span>

<h3>Description</h3>

<p><code>lmp</code> is <code><a href="stats.html#topic+lm">lm</a></code> modified to use permutation tests instead of normal 
theory tests. Like <code>lm</code>, it can be used to carry out regression, 
single stratum analysis of variance and analysis of covariance . Timing 
differences between <code>lmp</code> and <code>lm</code> are negligible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmp(formula, data,  perm="Exact", seqs=FALSE, center=TRUE, subset, weights, na.action, 
	method = "qr", model = TRUE, x = FALSE, y = FALSE, qr = TRUE,
   		singular.ok = TRUE, contrasts = NULL, offset, ...)

</code></pre>


<h3>Arguments</h3>

<p>The arguments are mostly the same as for <code><a href="stats.html#topic+lm">lm</a></code>. 
Additional parameters may be included. They are described in the 
&quot;Additional Parameters&quot; section below. These additional parameters
are the same as for <code><a href="#topic+aovp">aovp</a></code>.
</p>
<table role = "presentation">
<tr><td><code id="lmp_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be fit.</p>
</td></tr>
<tr><td><code id="lmp_+3A_data">data</code></td>
<td>
<p>an optional data frame containing the variables
in the model.  If not found in <code>data</code>, the variables are taken
from <code>environment(formula)</code>, typically the environment from which
<code>lmp</code> is called.</p>
</td></tr>
<tr><td><code id="lmp_+3A_perm">perm</code></td>
<td>
<p>&quot;Exact&quot;, &quot;Prob&quot;, &quot;SPR&quot; will produce permutation probabilities. 
Anyting else, such as &quot;&quot;, will produce F-test probabilites.</p>
</td></tr>
<tr><td><code id="lmp_+3A_seqs">seqs</code></td>
<td>
<p>If TRUE, will calculate sequential SS. If FALSE, unique SS.</p>
</td></tr>
<tr><td><code id="lmp_+3A_center">center</code></td>
<td>
<p>If TRUE will center numerical variables</p>
</td></tr>
<tr><td><code id="lmp_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations
to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="lmp_+3A_weights">weights</code></td>
<td>
<p>an optional vector of weights to be used
in the fitting process. If specified, weighted least squares is used
with weights <code>weights</code> (that is, minimizing <code>sum(w*e^2)</code>);
otherwise ordinary least squares is used.</p>
</td></tr>
<tr><td><code id="lmp_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen
when the data contain <code>NA</code>s.  The default is set by
the <code>na.action</code> setting of <code><a href="base.html#topic+options">options</a></code>, and is
<code><a href="stats.html#topic+na.fail">na.fail</a></code> if that is unset.  The &ldquo;factory-fresh&rdquo;
default is <code><a href="stats.html#topic+na.omit">na.omit</a></code>.  Another possible value is
<code>NULL</code>, no action.  Value <code><a href="stats.html#topic+na.exclude">na.exclude</a></code> can be useful.</p>
</td></tr>
<tr><td><code id="lmp_+3A_method">method</code></td>
<td>
<p>the method to be used; for fitting, currently only
<code>method = "qr"</code> is supported; <code>method = "model.frame"</code> returns
the model frame (the same as with <code>model = TRUE</code>, see below).</p>
</td></tr>
<tr><td><code id="lmp_+3A_model">model</code>, <code id="lmp_+3A_x">x</code>, <code id="lmp_+3A_y">y</code>, <code id="lmp_+3A_qr">qr</code></td>
<td>
<p>logicals.  If <code>TRUE</code> the corresponding
components of the fit (the model frame, the model matrix, the
response, the QR decomposition) are returned.</p>
</td></tr>
<tr><td><code id="lmp_+3A_singular.ok">singular.ok</code></td>
<td>
<p>logical. If <code>FALSE</code> (the default in S but
not in <span class="rlang"><b>R</b></span>) a singular fit is an error.</p>
</td></tr>
<tr><td><code id="lmp_+3A_contrasts">contrasts</code></td>
<td>
<p>an optional list. See the <code>contrasts.arg</code>
of <code><a href="stats.html#topic+model.matrix.default">model.matrix.default</a></code>.</p>
</td></tr>
<tr><td><code id="lmp_+3A_offset">offset</code></td>
<td>
<p>this can be used to specify an <em>a priori</em>
known component to be included in the linear predictor
during fitting.  An <code><a href="stats.html#topic+offset">offset</a></code> term can be included in the
formula instead or as well, and if both are specified their sum is used.</p>
</td></tr>
<tr><td><code id="lmp_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The usual regression model EY=Xb is assumed. The vector b is divided into sources 
with dfi degrees of freedom for the ith source, and <code>anova(lmp())</code> will produce an 
ANOVA table for these sources. Either permutation test p-values or the usual F-test 
p-values will be output. Polynomial model terms are collected into 
sources, so that <code>Y~A+B+I(A^2)</code> will contain two sources, one for A with 2 df,
and one for B with 1 df. Sources for factors are treated as usual, and polynomial
terms and factors may be mixed in one model. The function <code><a href="#topic+poly.formula">poly.formula</a></code> may 
be used to create polynomial models, and the function <code><a href="#topic+multResp">multResp</a></code> may
be used to create a multi-response matrix for the lhs from variables in <code>data</code>.
</p>
<p>One may also use <code>summary(lm())</code> to obtain coefficient estimates and 
estimates of the permutation test p-values. The <code>Exact</code> method will permute
the values exactly. The <code>Prob</code> and <code>SPR</code> methods will approximate
the permutation distribution by randomly exchanging pairs of Y elements. The <code>Exact</code>
method will be used by default when the number of observations is less than 
or equal to <code>maxExact</code>, otherwise <code>Prob</code> will be used.
</p>
<p>Prob:  Iterations terminate when the estimated standard error of the estimated 
proportion p is less than p*Ca. The iteration continues until all sources and 
coefficients meet this criterion or until <code>maxIter</code> is reached. See Anscome(1953) 
for the origin of the criterion. 
</p>
<p>SPR: This method uses sequential probability ratio tests to decide between 
the hypotheses <code>p0</code> and <code>p1</code> for a strength <code>(alpha, beta)</code> test. The test terminates 
upon the acceptance or rejection of <code>p0</code> or if <code>maxIter</code> is reached. See Wald (1947).
The power of the SPR is beta at <code>p0</code> and increases to 1-beta at <code>p1</code>. Placing <code>p0</code> and
<code>p1</code> close together makes the cut off sharp.  
</p>
<p>Exact: This method generates all permutations of Y. It will generally be found 
too time consuming for more than 10 or 11 observations, but note that <code><a href="#topic+aovp">aovp</a></code>
may be used to divide the data into small enough blocks for which exact 
permutation tests may be possible.
</p>
<p>For Prob and SPR, one may set <code>nCycle</code> to unity to exchange all elements instead 
of just pairs at each iteration, but there seems to be no advantage to doing this
unless the number of iterations is small &ndash; say less than 100.
</p>
<p>The SS will be calculated <em>sequentially</em>, just as <code>lm()</code> does; or they may be
calculated <em>uniquely</em>, which means that the SS for each source is calculated 
conditionally on all other sources. This is SAS type III, which is also what <code>drop1()</code>
produces, except that <code>drop1()</code> will not drop main effects when interactions are present. 
The parameter <code>seqs</code> may be used to override the default unique calculation behavior.
</p>


<h3>Value</h3>

<p>The usual output from <code><a href="stats.html#topic+lm">lm</a></code>, with permutation p-values or F-test 
p-values. The p-values for the coefficients are of necessity, two-sided.
</p>
<table role = "presentation">
<tr><td><code>Iter</code></td>
<td>
<p>For Prob and SPR: The number of iterations until the criterion 
is met.</p>
</td></tr>
<tr><td><code>Accept</code></td>
<td>
<p>For SPR: 1 the p0 hypothesis is accepted, and 0 for rejection or when no decision before <code>maxIter</code> occurs.</p>
</td></tr> 
</table>


<h3>Additional parameters</h3>

<p>These are the same as for <code><a href="#topic+aovp">aovp</a></code>. 
</p>

<dl>
<dt>settings</dt><dd><p>If TRUE, settings such as sequential or unique will
be printed. Default TRUE</p>
</dd>
<dt>useF</dt><dd><p>If TRUE, SS/Resid SS will be used, otherwise SS. The 
default is TRUE</p>
</dd>
<dt>maxIter</dt><dd><p>For Prob and SPR: The maximum number of iterations. 
Default 1000.</p>
</dd>
<dt>Ca</dt><dd><p>For Prob: Stop iterations when estimated standard error 
of the estimated p is less than Ca*p. Default 0.1</p>
</dd>
<dt>p0</dt><dd><p>For SPR: Null hypothesis probability. Default 0.05</p>
</dd>
<dt>p1</dt><dd><p>For SPR: Alternative hypothesis probability. Default 0.06</p>
</dd>
<dt>alpha</dt><dd><p>For SPR: Size of SPR test. Default 0.01</p>
</dd>
<dt>beta</dt><dd><p>For SPR: Type II error for SPR test. Default 0.01</p>
</dd>
<dt>maxExact</dt><dd><p>For Exact: maximum number of observations allowed. 
If data exceeds this, Prob is used. Default 10.</p>
</dd>
<dt>nCycle</dt><dd><p>For Prob and SPR: Performs a complete random permutation, 
instead of pairwise exchanges, every nCycle cycles. Default 1000.</p>
</dd>
</dl>



<h3>Note</h3>

<p>There is a vignette with more details and an example. To access it, type 
</p>
<p>vignette(&quot;lmPerm&quot;)
</p>
<p>The default contrasts are set internally to <code>(contr.sum, contr.poly)</code>, which means
that factor coefficients are either pairwise contrasts with the last level or polynomial contrasts.
</p>
<p>Numerical variables should be centered in order to make them orthogonal to the constant when
ANOVA is to be done. 
</p>
<p>This function will behave identically to <code>lm()</code> if the following parameters are set:
<code>perm="", seq=TRUE, center=FALSE</code>. An exception for multiple responses is that an 
ANOVA table for each response is output instead of a call to <code>anova.mlm()</code>.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:rwheeler@echip.com">rwheeler@echip.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Chochran, W. and Cox, G. (1957) p164</dt><dd><p>Experimental Design, 2nd Ed.</p>
</dd>
</dl>
<p>John Wiley &amp; Sons, New York. 
</p>
<dl>
<dt>Wald, A. (1947)</dt><dd><p>Sequential analysis, Wiley, Sec. 5.3</p>
</dd>
<dt>Quinlan, J. (1985)</dt><dd><p>&quot;Product improvement by application of Taguchi methods.&quot; in American Supplier Institute News
(special symposium ed.) Dearborn, MI. American Supplier Institute. 11-16.</p>
</dd>
<dt>Box, G. (1988)</dt><dd><p>Signal-to-noise ratios, performance criteria, and transformations. Technometics. 30-1. 1-17.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+summary.lmp">summary.lmp</a></code>, <code><a href="#topic+aovp">aovp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># 3x3 factorial with ordered factors, each is average of 12. 
# This is a saturated design with no df for error. The results tend to support 
# Cochran and Cox who used a guessed residual SS for their analysis. The design
# is balanced, so the sequential SS are the same as the unique SS. 
data(CC164)
summary(lmp(y ~ N * P, data = CC164, perm="")) # F-value output as if lm() was used.
summary(lmp(y ~ N * P, data = CC164,)) # Default, using "Exact" if possible.
summary(lmp(y ~ N * P, data = CC164, perm="SPR"))
anova(lmp(y ~ N * P, data = CC164))

# A two level factorial. The artificial data is N(0,1) with an effect of
# 1.5 added to factor X4. When the number of iterations are small, as in
# this case, using nCycle=1 is advantageous. 
X&lt;-expand.grid(X1=1:2,X2=1:2,X3=1:2,X4=1:2)
X$Y&lt;-c(0.99,1.34,0.88,1.94,0.63,0.29,-0.78,-0.89,0.43,-0.03,0.50,1.66,1.65,1.78,1.31,1.51)
summary(lmp(Y~(X1+X2+X3+X4)^2,X,"SP"))  # The prob method is used because "SP" is not recognized.
summary(lmp(Y~(X1+X2+X3+X4)^2,X,"SPR"))
summary(lmp(Y~(X1+X2+X3+X4)^2,X,"SPR",nCycle=1)) #An additional parameter being passed.

# A saturated design with 15 variables in 16 runs. The orginal analysis by Quinlan pooled the mean
# squares from the 7 smallest effcts and found many variables to be significant. Box, reanalyzed
# the data using half-normal plots and found only variables E and G to be important. The permutation
# analysis agrees with this conclusion.
data(Quinlan)
summary(lmp(SN~.,Quinlan))

# A design containing both a polynomial variable and a factor
data(simDesignPartNumeric)
anova(lmp(poly.formula(Y~quad(A,B)+C),simDesignPartNumeric))


</code></pre>

<hr>
<h2 id='lmPerm-internal'>Internal lmPerm function</h2><span id='topic+permtst'></span>

<h3>Description</h3>

<p>Internal lmPerm function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permtst(Q, Y, dof, perm="Prob", ... )
</code></pre>


<h3>Details</h3>

<p>This is not to be called by the user.
</p>

<hr>
<h2 id='manly126'>Manly, p126</h2><span id='topic+manly126'></span>

<h3>Description</h3>

<p>Lizard data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(manly126)
</code></pre>


<h3>Details</h3>

<p>Two factor data showing ant consumption by lizards. In addition,
three aditional columns, v1,v2,v3, are included representing
the additions used by Manly to calculate power.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Manly, B.F.J. (1998). Randomization, bootstrap and Monte Carlo
methods in Biology. 2nd Ed. Chapman &amp; Hall, London.
</p>

<hr>
<h2 id='manly136'>Non normal Ephemeroptera counts</h2><span id='topic+manly136'></span>

<h3>Description</h3>

<p>Ephemeroptera counts from New Zealand streams.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(manly136)
</code></pre>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Manly, B.F. (1998). Randomization, bootstrap and monte carlo methods in biology.
Chapman and Hall, NY.
</p>

<hr>
<h2 id='multResp'>Multple response creation</h2><span id='topic+multResp'></span>

<h3>Description</h3>

<p>This function creates a multiple response matrix for its argument variables. When used 
on the lhs of the formula in lmp() or aovp() it will create a matrix containing one or more
response columns from variables defined in the data argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	multResp(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multResp_+3A_...">...</code></td>
<td>
<p>Variable names separated by commas.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with named columns
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>
<p>Please cite this program as follows:
</p>
<p>Wheeler, R.E. (2010). multResp() <em>lmPerm</em>. The R project for statistical computing <a href="http://www.r-project.org/">http://www.r-project.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	A&lt;-1:5
	B&lt;-1:5
	multResp(A,B)

	data(Plasma)
	anova(lmp(multResp(Amin,Pct,sinpoly)~.,Plasma))
</code></pre>

<hr>
<h2 id='NPK'>NPK Data</h2><span id='topic+NPK'></span>

<h3>Description</h3>

<p>Data from Venables and Ripley, Table 6.1, p176.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(NPK)
</code></pre>


<h3>Details</h3>

<p>A fractional factorial with blocks confounded with the three way interaction.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Venables, W.N. and Ripley, B.D. (2000) Modern applied statistics with S-Plus. 3rd ed. Springer, NY.
</p>

<hr>
<h2 id='permute'>Permutation Generation</h2><span id='topic+permute'></span>

<h3>Description</h3>

<p>Generates permutations a pair at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>permute(N=4,K=1,initialize=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="permute_+3A_n">N</code></td>
<td>
<p>The number of elements in the permutation vector. The elements are numbered 1:N</p>
</td></tr>
<tr><td><code id="permute_+3A_k">K</code></td>
<td>
<p>The number of exchange pairs to be returned at each access</p>
</td></tr>
<tr><td><code id="permute_+3A_initialize">initialize</code></td>
<td>
<p>Set to 1 to initialize. Set to 0 for additional pairs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>On first call, set initialize to 1. On subsequent accesses, initialize should be 0. 
The function returns at most K exchange pairs at each access. The function should 
be repeatedly called until result is false.
</p>
<p>The function returns a list.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>result</code></td>
<td>
<p>Returns false when the last permutation has been generated or a failure
has occurred. Returns true for success and at most K new pairs in vec.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The input parameter</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>The input parameter</p>
</td></tr>
<tr><td><code>vec</code></td>
<td>
<p>A 2*K vector of element numbers to be exchanged &ndash; permutations may be
obtained by successively applying these pairs.</p>
</td></tr>
<tr><td><code>initialize</code></td>
<td>
<p>Always returns 1</p>
</td></tr>
<tr><td><code>count</code></td>
<td>
<p>The number of pairs in vec. It may be less than K for the final set.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This is the minimum time and effort routine. It is used for Exact permutation
calculations. The present function is a wrapper for the C code and may be useful
for other purposes. The code follows Reingole and Nievergelt (1977).</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:rwheeler@echip.com">rwheeler@echip.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Reingold, E.M., Nievergelt, J., and Deo, N. (1977)</dt><dd><p>Combinatorial 
Algorithms Theory and Practice. Prentice Hall, New Jersey. p170.</p>
</dd>
</dl>


<hr>
<h2 id='Plasma'>Plasma Etching</h2><span id='topic+Plasma'></span>

<h3>Description</h3>

<p>An experiment designed to guide optimization of a nitride etch process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Plasma)
</code></pre>


<h3>Details</h3>

<p>An orthogonal arry, capable of supporting a linear model only. The 
factors are denoted by their units of measurement. They were W, 
the power applied to the cathode; mTorr, the pressure
in the reaction chamber; cm, gap between anode and cathode; sscm, flow
if the reactant gas. The three responses: Amin, etch rate; Pct, unifomity;
sinpoly, selectivity. 
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Vardeman, Stephen B. (1994).Statistics for engineering problem solving.
PWS publishing Co. Boston. p 596
</p>

<hr>
<h2 id='poly.formula'>Makes a polynomial model</h2><span id='topic+poly.formula'></span>

<h3>Description</h3>

<p>Formulas are expanded to accommodate special functions for continuous and mixture variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	poly.formula(frml)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="poly.formula_+3A_frml">frml</code></td>
<td>
<p>A formula using ~ in the usual way.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function expands formulas to accommodate polynomial models for which R has minimal support.
Assuming for illustration that there are three variables, A, B, and C, the following expressions
may be used.  
</p>
<p>All agruments to quad(), cubic(), and cubicS() must be numeric.
</p>

<ul>
<li><p> quad(A,B,C) makes <code class="reqn">(A+B+C)^2+I(A^2)+I(B^2)+I(C^2)</code>
</p>
</li>
<li><p> cubic(A,B,C) makes <code class="reqn">(A+B+C)^3+I(A^2)+I(B^2)+I(C^2)+I(A^3)+I(B^3)+I(C^3)</code>
</p>
</li>
<li><p> cubicS(A,B,C) makes <code class="reqn">(A+B+C)^3+I(A*B*(A-B))+I(A*C*(A-C))+I(B*C*(B-C))</code>
</p>
</li></ul>

<p>The cubicS() function produces a non-singular representation of a cubic model, when the 
variables are mixture variables, that is when the rows of <code>data</code> sum to a constant
value, usually 1.0. Because of the mixture constraint, models containing mixture variables
should not have a constant term. The linear and quadratic models for mixture variables
A, B, and C are given by <code class="reqn">-1+(A+B+C)</code> and <code class="reqn">-1+(A+B+C)^2</code> respectively. See Gorman and Hinman [1962] for 
details.
</p>


<h3>Value</h3>

<p>An expanded formula is returned.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>
<p>Please cite this program as follows:
</p>
<p>Wheeler, R.E. (2010). poly.formula <em>lmPerm</em>. The R project for statistical computing <a href="http://www.r-project.org/">http://www.r-project.org/</a>
</p>


<h3>References</h3>

<p>Gorman, J.W. and Hinman, J.E. (1962). Simplex lattice designs for 
multicomponent systems. <em>Technometrics</em>. 4-4. 463-487.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
	poly.formula(y~quad(A,B,C)+Error(block))
</code></pre>

<hr>
<h2 id='Quinlan'>Quinlan's data</h2><span id='topic+Quinlan'></span>

<h3>Description</h3>

<p>Data from a Symposium on Taguchi Methods, analyzed by G.E.P. Box
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(Quinlan)
</code></pre>


<h3>Details</h3>

<p>A saturated design: L16 in Taguchi termonology, but just a 2^(15-11)III design using the symbolism in Box (1978).
Reanalyzed by Box (1988).
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Quinlan, J. (1985)</dt><dd><p>&quot;Product improvement by application of Taguchi methods.&quot; in American Supplier Institute News
(special symposium ed.) Dearborn, MI. American Supplier Institute. 11-16.</p>
</dd>
<dt>Box, G.E.P., Hunter, W.G. and Hunter J.S. (1978)</dt><dd><p> Statistics for Experimenters. Wiley, N.Y</p>
</dd>
<dt>Box, G. (1988)</dt><dd><p>Signal-to-noise ratios, performance criteria, and transformations. Technometics. 30-1. 1-17.</p>
</dd>
</dl>


<hr>
<h2 id='ratGenotype'>ratGenotype Data</h2><span id='topic+ratGenotype'></span>

<h3>Description</h3>

<p>Data from Scheffe, p140
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(ratGenotype)
</code></pre>


<h3>Details</h3>

<p>An unbalanced design. The data originally appeared in Bailey (1953), and was reproduced in Scheffe (1959)
with the description:
</p>
<p>&ldquo;...gives the weight of hybrid female rats in a foster-nursing experiment with four types of
rats. (The weights are litter averges in grams at 28 days. The within litter variance was obviously
negligible compared to the between-litter variance.) The factors in the two-way laout are the genotype
of the foster mother and that of the litter.
&rdquo;
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>


<dl>
<dt>Scheffe, H. (1959)</dt><dd><p>The Analysis of Variance, Wiley, NY.</p>
</dd>
<dt>Bailey, D.W. (1953)</dt><dd><p>&ldquo;The inheritance of Maternal Influences on the Growth of the Rat&rdquo;.
Ph.D. thesis, Univ. California</p>
</dd>
</dl>


<hr>
<h2 id='simDesign'>A non-orthogonal design</h2><span id='topic+simDesign'></span>

<h3>Description</h3>

<p>A three factor design created using AlgDesign, with a normal response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(simDesign)
</code></pre>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>

<hr>
<h2 id='simDesignPartNumeric'>A non-orthogonal design</h2><span id='topic+simDesignPartNumeric'></span>

<h3>Description</h3>

<p>A three factor design created using AlgDesign, with a normal response.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(simDesignPartNumeric)
</code></pre>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>

<hr>
<h2 id='summary'>Summarizing functions for linear models</h2><span id='topic+summary.lmp'></span><span id='topic+summary.mlmp'></span><span id='topic+print.summary.lmp'></span><span id='topic+summary.aovp'></span><span id='topic+anova.lmp'></span>

<h3>Description</h3>

<p>Replaces corresponding functions in base package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmp'
summary(object, correlation = FALSE, symbolic.cor = FALSE, ...)
## S3 method for class 'mlmp'
summary(object, ...)
## S3 method for class 'summary.lmp'
print(x, digits = max(3, getOption("digits") - 3),
              symbolic.cor = x$symbolic.cor,
	      signif.stars= getOption("show.signif.stars"),	...)
## S3 method for class 'aovp'
summary(object, intercept = FALSE, split,
                        expand.split = TRUE, keep.zero.df = TRUE, ...)
## S3 method for class 'lmp'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<p> Same as for the corresponding functions in base package:
</p>
<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>an object of class <code>"lm"</code>, usually, a result of a
call to <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_x">x</code></td>
<td>
<p>an object of class <code>"summary.lm"</code>, usually, a result of a
call to <code>summary.lm</code>.</p>
</td></tr>
<tr><td><code id="summary_+3A_correlation">correlation</code></td>
<td>
<p>logical; if <code>TRUE</code>, the correlation matrix of
the estimated parameters is returned and printed.</p>
</td></tr>
<tr><td><code id="summary_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary_+3A_symbolic.cor">symbolic.cor</code></td>
<td>
<p>logical. If <code>TRUE</code>, print the correlations in
a symbolic form (see <code><a href="stats.html#topic+symnum">symnum</a></code>) rather than as numbers.</p>
</td></tr>
<tr><td><code id="summary_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If <code>TRUE</code>, &ldquo;significance stars&rdquo;
are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="summary_+3A_intercept">intercept</code></td>
<td>
<p>logical: should intercept terms be included?</p>
</td></tr>
<tr><td><code id="summary_+3A_split">split</code></td>
<td>
<p>an optional named list, with names corresponding to terms
in the model.  Each component is itself a list with integer
components giving contrasts whose contributions are to be summed.</p>
</td></tr>
<tr><td><code id="summary_+3A_expand.split">expand.split</code></td>
<td>
<p>logical: should the split apply also to
interactions involving the factor?</p>
</td></tr>
<tr><td><code id="summary_+3A_keep.zero.df">keep.zero.df</code></td>
<td>
<p>logical: should terms with no degrees of freedom
be included?</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These modified functions are needed because the perm values, which are 
attached to the object, replace the usual test columns in the output 
from these functions.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:rwheeler@echip.com">rwheeler@echip.com</a>
</p>

<hr>
<h2 id='summaryC'>Coefficient summary from aovp</h2><span id='topic+summaryC'></span>

<h3>Description</h3>

<p>Summarize an analysis of variance model showing coefficients</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'aovlist':
summaryC(object, ...)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryC_+3A_object">object</code></td>
<td>
<p>an object of class <code>aovlist</code></p>
</td></tr>
<tr><td><code id="summaryC_+3A_...">...</code></td>
<td>
<p>further arguments passed on.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Summarizes <code>aovp</code> output in terms of coefficients with p-values.
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:rwheeler@echip.com">rwheeler@echip.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(Alfalfa)
	summaryC(aovp(Yield~Variety*Date+Error(Block/Variety),Alfalfa))</code></pre>

<hr>
<h2 id='wool'>wool data</h2><span id='topic+wool'></span>

<h3>Description</h3>

<p>A three factor experiment with non-normal response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	data(wool)
</code></pre>


<h3>Details</h3>

<p>There are three, 3-level factors: 
</p>

<dl>
<dt>len</dt><dd><p>length of test specimen in mm</p>
</dd>
<dt>amp</dt><dd><p>amplitude of loading cycle in mm</p>
</dd>
<dt>load</dt><dd><p>the load in g</p>
</dd>
</dl>

<p>The response was the number of cycles to failure of worsted yarn under cycles of repeated loading
</p>


<h3>Author(s)</h3>

<p>Bob Wheeler <a href="mailto:bwheelerg@gmail.com">bwheelerg@gmail.com</a>
</p>


<h3>References</h3>

<p>Box, G.E.P. and Cox, D.R. (1964) An analysis of transformations (with discussion). J.R. Statists. Soc. B. 26. 211-246.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
