<!DOCTYPE html><html><head><title>Help for package embryogrowth</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {embryogrowth}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#embryogrowth-package'><p>The package embryogrowth</p></a></li>
<li><a href='#calibrate.datalogger'><p>Calibrate data loggers and correct time series of temperatures</p></a></li>
<li><a href='#ChangeSSM'><p>Generate set of parameters for different forms of thermal norm of reaction</p></a></li>
<li><a href='#DatabaseNestingArea'><p>Database of RMU for marine turtles</p></a></li>
<li><a href='#DatabaseTSD'><p>Database of TSD information for reptiles</p></a></li>
<li><a href='#DatabaseTSD.version'><p>Version of database of TSD information for reptiles</p></a></li>
<li><a href='#dydt.exponential'><p>Return the derivative of the exponential function</p></a></li>
<li><a href='#dydt.Gompertz'><p>Return the derivative of the Gompertz function</p></a></li>
<li><a href='#dydt.linear'><p>Return the derivative of the linear function</p></a></li>
<li><a href='#FormatNests'><p>Create a dataset of class Nests to be used with searchR</p></a></li>
<li><a href='#Generate_hatchling_metric'><p>Generate a data.frame that can be used as hatchling.metric value for searchR()</p></a></li>
<li><a href='#GenerateAnchor'><p>Generate a set of anchored parameters</p></a></li>
<li><a href='#GenerateConstInc'><p>Generate a data.frame with constant incubation temperature and incubation duration</p></a></li>
<li><a href='#GRTRN_MHmcmc'><p>Metropolis-Hastings algorithm for Embryo Growth Rate Thermal Reaction Norm</p></a></li>
<li><a href='#HatchingSuccess.fit'><p>Fit a hatching success model to data using maximum likelihood</p></a></li>
<li><a href='#HatchingSuccess.lnL'><p>Return -log likelihood of the data and the parameters</p></a></li>
<li><a href='#HatchingSuccess.MHmcmc'><p>Metropolis-Hastings algorithm for hatching success</p></a></li>
<li><a href='#HatchingSuccess.MHmcmc_p'><p>Generates set of parameters to be used with HatchingSuccess.MHmcmc()</p></a></li>
<li><a href='#HatchingSuccess.model'><p>Return the hatching success according the set of parameters and temperatures</p></a></li>
<li><a href='#hist.Nests'><p>Show the histogram of temperatures with set of nests</p></a></li>
<li><a href='#hist.NestsResult'><p>Show the histogram of temperatures with set of nests</p></a></li>
<li><a href='#info.nests'><p>Calculte statistics about nests</p></a></li>
<li><a href='#integral.exponential'><p>Return the derivative of the exponential function</p></a></li>
<li><a href='#integral.Gompertz'><p>Return the result of the Gompertz function</p></a></li>
<li><a href='#integral.linear'><p>Return the linear function</p></a></li>
<li><a href='#likelihoodR'><p>Estimate the likelihood of a set of parameters for nest incubation data</p></a></li>
<li><a href='#logLik.HatchingSuccess'><p>Return -log L of a fit</p></a></li>
<li><a href='#logLik.NestsResult'><p>Return Log Likelihood of a fit generated by searchR</p></a></li>
<li><a href='#logLik.STRN'><p>Return Log Likelihood of a fit generated by STRN</p></a></li>
<li><a href='#logLik.tsd'><p>Return Log Likelihood of a fit generated by tsd</p></a></li>
<li><a href='#movement'><p>Analyze movement recorded within a nest with an accelerometer datalogger</p></a></li>
<li><a href='#MovingIncubation'><p>Simulate incubation of a nest with the beginning of incubation varying</p></a></li>
<li><a href='#nest'><p>Timeseries of temperatures for nests</p></a></li>
<li><a href='#nobs.HatchingSuccess'><p>Return number of observations of a fit</p></a></li>
<li><a href='#nobs.NestsResult'><p>Return number of observations of a fit</p></a></li>
<li><a href='#P_TRT'><p>Estimate the transitional range of temperatures based on a set of parameters</p></a></li>
<li><a href='#plot_transition'><p>Show fonction used for transition</p></a></li>
<li><a href='#plot.HatchingSuccess'><p>Plot results of HatchingSuccess.fit() that best describe hatching success</p></a></li>
<li><a href='#plot.NestsResult'><p>Plot the embryo growth</p></a></li>
<li><a href='#plot.tsd'><p>Plot results of tsd() that best describe temperature-dependent sex determination</p></a></li>
<li><a href='#plotR'><p>Plot the fitted growth rate dependent on temperature and its density</p></a></li>
<li><a href='#predict.HatchingSuccess'><p>Return prediction based on a model fitted with HatchingSuccess.fit()</p></a></li>
<li><a href='#predict.tsd'><p>Estimate sex ratio according to constant incubation temperature</p></a></li>
<li><a href='#resultNest_3p_Dallwitz'><p>Fit using the nest database</p></a></li>
<li><a href='#resultNest_3p_Weibull'><p>Result of the fit using the nest database using Weibull function</p></a></li>
<li><a href='#resultNest_4p_normal'><p>Result of the fit using the nest database using asymmetric normal function</p></a></li>
<li><a href='#resultNest_4p_SSM'><p>Fit using the nest database</p></a></li>
<li><a href='#resultNest_4p_SSM_Linear'><p>Fit using the nest database</p></a></li>
<li><a href='#resultNest_4p_transition'><p>Result of the fit using the nest database using transition</p></a></li>
<li><a href='#resultNest_4p_trigo'><p>Result of the fit using the nest database using trigonometric function</p></a></li>
<li><a href='#resultNest_4p_weight'><p>Fit using the nest database with weight</p></a></li>
<li><a href='#resultNest_5p_Dallwitz'><p>Fit using the nest database</p></a></li>
<li><a href='#resultNest_6p_SSM'><p>Fit using the nest database</p></a></li>
<li><a href='#resultNest_mcmc_4p_SSM'><p>Result of the mcmc using the nest database</p></a></li>
<li><a href='#resultNest_mcmc_4p_SSM_Linear'><p>Result of the mcmc using the nest database</p></a></li>
<li><a href='#resultNest_mcmc_6p_SSM'><p>Result of the mcmc using the nest database</p></a></li>
<li><a href='#resultNest_mcmc_newp'><p>Result of the mcmc using the nest database with anchored parameters</p></a></li>
<li><a href='#resultNest_newp'><p>Fit using the nest database with anchored parameters</p></a></li>
<li><a href='#searchR'><p>Fit the parameters that best represent nest incubation data.</p></a></li>
<li><a href='#stages'><p>Database of of embryonic development and thermosensitive period of development for sex determination</p></a></li>
<li><a href='#STRN'><p>Estimate the parameters that best describe the sexualisation thermal reaction norm within the TSP</p></a></li>
<li><a href='#STRN_MHmcmc'><p>Metropolis-Hastings algorithm for Sexualisation Thermal Reaction Norm</p></a></li>
<li><a href='#summary.Nests'><p>Summarize the information from a Nests object.</p></a></li>
<li><a href='#switch.transition'><p>Add a transition parameter on a set of parameters or remove it</p></a></li>
<li><a href='#tempConst'><p>Timeseries of constant temperatures for nests</p></a></li>
<li><a href='#test.parallel'><p>Estimate the likelihood of a set of parameters for nest incubation data with or without parallel computing option</p></a></li>
<li><a href='#TRN_MHmcmc_p'><p>Generates set of parameters to be used with GRTRN_MHmcmc() or STRN_MHmcmc()</p></a></li>
<li><a href='#tsd'><p>Estimate the parameters that best describe temperature-dependent sex determination</p></a></li>
<li><a href='#tsd_MHmcmc'><p>Metropolis-Hastings algorithm for Sex ratio</p></a></li>
<li><a href='#tsd_MHmcmc_p'><p>Generates set of parameters to be used with tsd_MHmcmc()</p></a></li>
<li><a href='#TSP.list'><p>Database of thermosensitive period of development for sex determination</p></a></li>
<li><a href='#uncertainty.datalogger'><p>Uncertainty of average temperatures obtained using temperature data logger</p></a></li>
<li><a href='#web.tsd'><p>Run a shiny application for basic functions of tsd function</p></a></li>
<li><a href='#weightmaxentropy'><p>Search for the weights of the nests which maximize the entropy of nest temperatures distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Analyze the Thermal Reaction Norm of Embryo Growth</td>
</tr>
<tr>
<td>Version:</td>
<td>9.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Girondot &lt;marc.girondot@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Girondot &lt;marc.girondot@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to analyze the embryo growth and the sexualisation thermal reaction norms. See &lt;<a href="https://doi.org/10.7717%2Fpeerj.8451">doi:10.7717/peerj.8451</a>&gt; for tsd functions; see &lt;<a href="https://doi.org/10.1016%2Fj.jtherbio.2014.08.005">doi:10.1016/j.jtherbio.2014.08.005</a>&gt; for thermal reaction norm of embryo growth. </td>
</tr>
<tr>
<td>Depends:</td>
<td>deSolve, optimx, numDeriv, parallel, HelpersMG (&ge; 6.0.3),R
(&ge; 4.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>entropy, shiny, coda, polynom, car, gam, pbapply, cranlogs</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-24 15:27:21 UTC; marcgirondot</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-24 15:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='embryogrowth-package'>The package embryogrowth</h2><span id='topic+embryogrowth-package'></span>

<h3>Description</h3>

<p>Tools to analyze the embryo growth and the sexualisation thermal reaction norms.<br />
The latest version of this package can always been installed using:<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/HelpersMG.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
install.packages(&quot;https://hebergement.universite-paris-saclay.fr/marcgirondot/CRAN/embryogrowth.tar.gz&quot;, repos=NULL, type=&quot;source&quot;)<br />
<img src="../help/figures/E.png" alt="embryogrowth logo" />

</p>


<h3>Details</h3>

<p>Fit a parametric function that describes dependency of embryo growth to temperature
</p>

<table>
<tr>
 <td style="text-align: left;">
 Package: </td><td style="text-align: left;"> embryogrowth</td>
</tr>
<tr>
 <td style="text-align: left;">
 Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
 Version: </td><td style="text-align: left;"> 9.1 build 1630</td>
</tr>
<tr>
 <td style="text-align: left;">
 Date: </td><td style="text-align: left;"> 2023-10-24</td>
</tr>
<tr>
 <td style="text-align: left;">
 License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
 LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
 </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Girondot, M. &amp; Kaska, Y. 2014. A model to predict the thermal 
reaction norm for the embryo growth rate from field data. Journal of
Thermal Biology. 45, 96-102.
</p>
<p>Fuentes, M.M.P.B., Monsinjon, J., Lopez, M., Lara, P., Santos, A., 
dei Marcovaldi, M.A.G., Girondot, M., 2017. Sex ratio estimates for 
species with temperature-dependent sex determination differ according 
to the proxy used. Ecological Modelling 365, 55-67.
</p>
<p>Girondot, M., Monsinjon, J., Guillon, J.-M., 2018. Delimitation of 
the embryonic thermosensitive period for sex determination using an 
embryo growth model reveals a potential bias for sex ratio prediction 
in turtles. Journal of Thermal Biology 73, 32-40.
</p>
<p>Monsinjon, J., Jribi, I., Hamza, A., Ouerghi, A., Kaska, Y., 
Girondot, M., 2017. Embryonic growth rate thermal reaction norm of 
Mediterranean Caretta caretta embryos from two different thermal 
habitats, Turkey and Libya. Chelonian Conservation and 
Biology 16, 172-179.
</p>


<h3>See Also</h3>

<p>Delmas, V., Prevot-Julliard, A.-C., Pieau, C. &amp; Girondot, M. 2008. 
A mechanistic model of temperature-dependent sex determination 
in a Chelonian, the European pond turtle. Functional 
Ecology, 22, 84-93.
</p>
<p>Girondot, M., Ben Hassine, S., Sellos, C., Godfrey, M. &amp; Guillon, 
J.-M. 2010. Modeling thermal influence on animal growth and sex 
determination in Reptiles: being closer of the target gives new 
views. Sexual Development, 4, 29-38.
</p>
<p>Girondot, M. 1999. Statistical description of temperature-dependent 
sex determination using maximum likelihood. Evolutionary Ecology 
Research, 1, 479-486.
</p>
<p>Girondot, M., &amp; Kaska, Y. (2014). Nest temperatures in a loggerhead-
nesting beach in Turkey is more determined by sea surface temperature 
than air temperature. Journal of Thermal Biology, 47, 13-18.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("embryogrowth")
packageVersion("embryogrowth")
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(115.758929130522, 428.649022170996, 503.687251738993, 
12.2621455821612, 306.308841227278, 116.35048615105), .Names = c("DHA", 
"DHH", "DHL", "DT", "T12L", "Rho25"))
# or
x &lt;- structure(c(118.431040984352, 498.205702157603, 306.056280989839, 
118.189669472381), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)

################################################################################
#
# The values of rK=2.093313 and M0=1.7 were used in 
# Girondot, M. &amp; Kaska, Y. 2014. A model to predict the thermal 
# reaction norm for the embryo growth rate from field data. Journal of
# Thermal Biology. 45, 96-102.
#
# Based on recent analysis on table of development for both Emys orbicularis and 
# Caretta caretta, best value for rK should be 1.209 and M0 should be 0.34.
# Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the embryonic 
# thermosensitive period for sex determination using an embryo growth model 
# reveals a potential bias for sex ratio prediction in turtles. Journal of 
# Thermal Biology 73: 32-40 
#
# See the example in the stages datasets
# 
################################################################################

resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=1.7, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)
par(mar=c(4, 4, 1, 1))
plot(resultNest_4p_SSM$data[[1]][, 1]/60/24,resultNest_4p_SSM$data[[1]][, 2], bty="n", las=1, 
     xlab="Days of incubation", ylab="Temperatures in °C", 
     type="l", xlim=c(0,70),ylim=c(20, 35))
for (i in 2:resultNest_4p_SSM$data$IndiceT[["NbTS"]]) {
  par(new=TRUE)
  plot(resultNest_4p_SSM$data[[i]][, 1]/60/24,resultNest_4p_SSM$data[[i]][, 2], 
  bty="n", las=1, xlab="", ylab="", type="l", xlim=c(0,70),ylim=c(20, 35), axes = FALSE)
}
par(mar=c(4, 4, 1, 1))
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_SSM, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM,  
	parametersMCMC=pMCMC, n.iter=10000, n.chains = 1, n.adapt = 0,  
	thin=1, trace=TRUE)
data(resultNest_mcmc_4p_SSM)
out &lt;- as.mcmc(resultNest_mcmc_4p_SSM)
# This out obtained after as.mcmc can be used with coda package
# plot() can use the direct output of GRTRN_MHmcmc() function.
plot(resultNest_mcmc_4p_SSM, parameters=1, xlim=c(0,550))
plot(resultNest_mcmc_4p_SSM, parameters=3, xlim=c(290,320))
# But rather than to use the SD for each parameter independantly, it is
# more logical to estimate the distribution of the curves
new_result &lt;- ChangeSSM(resultmcmc = resultNest_mcmc_4p_SSM, result = resultNest_4p_SSM,
                        temperatures = seq(from = 20, to = 35, by = 0.1), 
                        initial.parameters = NULL)
par(mar=c(4, 4, 1, 5)+0.4)

plotR(result = resultNest_4p_SSM, parameters = new_result$par, 
           ylabH = "Temperatures\ndensity", ylimH=c(0, 0.3), atH=c(0, 0.1, 0.2), 
           ylim=c(0, 3), show.hist=TRUE)
      
# Beautiful density plots

plotR(result = resultNest_4p_SSM, 
             resultmcmc=resultNest_mcmc_4p_SSM, 
             curve = "MCMC quantiles", show.density=TRUE)

plotR(resultNest_6p_SSM, resultmcmc=resultNest_mcmc_6p_SSM, 
            ylim=c(0, 4), show.density=TRUE, show.hist=TRUE, 
            curve = "MCMC quantiles", 
            ylimH=c(0,0.5), atH=c(0, 0.1, 0.2))

# How many times this package has been download
library(cranlogs)
embryogrowth &lt;- cran_downloads("embryogrowth", from = "2014-08-16", 
                            to = Sys.Date() - 1) 
sum(embryogrowth$count)
plot(embryogrowth$date, embryogrowth$count, type="l", bty="n")

## End(Not run)
</code></pre>

<hr>
<h2 id='calibrate.datalogger'>Calibrate data loggers and correct time series of temperatures</h2><span id='topic+calibrate.datalogger'></span>

<h3>Description</h3>

<p>Calibrate a time series of temperatures. Use or gam or glm. If
no temperatures.series is given, it will use the read.temperatures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calibrate.datalogger(
  control.temperatures = stop("Control temperatures is missing"),
  read.temperatures = stop("Read temperatures must be indicated"),
  temperatures.series = NULL,
  gam = TRUE,
  se.fit = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calibrate.datalogger_+3A_control.temperatures">control.temperatures</code></td>
<td>
<p>The true temperatures during the calibration process</p>
</td></tr>
<tr><td><code id="calibrate.datalogger_+3A_read.temperatures">read.temperatures</code></td>
<td>
<p>The read temperatures during the calibration process</p>
</td></tr>
<tr><td><code id="calibrate.datalogger_+3A_temperatures.series">temperatures.series</code></td>
<td>
<p>The temperatures to be converted using calibration</p>
</td></tr>
<tr><td><code id="calibrate.datalogger_+3A_gam">gam</code></td>
<td>
<p>Does gam should be used (TRUE) or glm (FALSE).</p>
</td></tr>
<tr><td><code id="calibrate.datalogger_+3A_se.fit">se.fit</code></td>
<td>
<p>Do standard errors are to be returned</p>
</td></tr>
</table>


<h3>Details</h3>

<p>calibrate.datalogger calibrates data loggers and correct time series of temperatures.
</p>


<h3>Value</h3>

<p>The function will return a corrected time series of temperatures as a vector if se.fit is FALSE or a list if se.fit is TRUE.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Data loggers utilities: 
<code><a href="#topic+movement">movement</a>()</code>,
<code><a href="#topic+uncertainty.datalogger">uncertainty.datalogger</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
calibrate.datalogger(control.temperatures=20:30, 
                     read.temperatures=(20:30)+rnorm(11))

## End(Not run)
</code></pre>

<hr>
<h2 id='ChangeSSM'>Generate set of parameters for different forms of thermal norm of reaction</h2><span id='topic+ChangeSSM'></span>

<h3>Description</h3>

<p>Generate a set of parameters for thermal reaction norm model.<br />
If initial.parameters is NULL and resultmcmc is not NULL, it will generate parameters and SE based on the average of the curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChangeSSM(
  result = NULL,
  resultmcmc = NULL,
  temperatures = seq(from = 20, to = 35, by = 0.1),
  parameters = NULL,
  initial.parameters = NULL,
  fixed.parameters = NULL,
  outmcmc = "quantiles",
  progressbar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ChangeSSM_+3A_result">result</code></td>
<td>
<p>A result obtained by searchR()</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A result obtained by GRTRN_MHmcmc()</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_temperatures">temperatures</code></td>
<td>
<p>A vector with incubation temperatures in degrees Celsius</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_parameters">parameters</code></td>
<td>
<p>A vector of parameters for model to be converted. Not necessary if result is provided.</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_initial.parameters">initial.parameters</code></td>
<td>
<p>NULL or a vector of parameters for initial model model to be fited</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>NULL of a vector of parameters to be used but fixed</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_outmcmc">outmcmc</code></td>
<td>
<p>What statistic will be estimated if a mcmc is provided. Can be &quot;mean-sd&quot; or &quot;quantiles&quot;.</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_progressbar">progressbar</code></td>
<td>
<p>If TRUE, a progressbar is shown</p>
</td></tr>
<tr><td><code id="ChangeSSM_+3A_...">...</code></td>
<td>
<p>A control list to be used with optim, see ?optim</p>
</td></tr>
</table>


<h3>Details</h3>

<p>ChangeSSM convert different forms of thermal norm of reaction
</p>


<h3>Value</h3>

<p>A vector with parameters or a result object formatted with new parameters is result is non null
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(resultNest_6p_SSM)
x1 &lt;- resultNest_6p_SSM$par
data(resultNest_4p_SSM)
x2 &lt;- resultNest_4p_SSM$par
temperaturesC &lt;- (200:350)/10
s &lt;- ChangeSSM(temperatures=temperaturesC, parameters=x1, initial.parameters=x2)
sY &lt;- plotR(resultNest_6p_SSM, ylim=c(0,3), col="black", curve = "ML")
plotR(resultNest_4p_SSM, col="red", scaleY=sY, new=FALSE)
plotR(s$par, col="green", scaleY=sY, new=FALSE, curve = "ML")
legend("topleft", legend=c("r function to mimic", "Initial new r function", 
"Fitted new r function"), lty=c(1, 1, 1), col=c("black", "red", "green"))
# Other example to fit anchored parameters
data(resultNest_4p_SSM)
x0 &lt;- resultNest_4p_SSM$par
t &lt;- hist(resultNest_4p_SSM, plot=FALSE)
x &lt;- c(3.4, 3.6, 5.4, 5.6, 7.6, 7.5, 3.2)
names(x) &lt;- seq(from=range(t$temperatures)[1], to=range(t$temperatures)[2], 
     length.out=7)
newx &lt;- ChangeSSM(temperatures = (200:350)/10, parameters = x0, 
       initial.parameters = x, 
       control=list(maxit=5000))
 # Example on how to generate a set of SSM parameters from anchored parameters
 xanchor &lt;- GenerateAnchor(nests=resultNest_4p_SSM)
 x &lt;- resultNest_4p_SSM$par
 xanchor["294"] &lt;- 0
 xanchor["308"] &lt;- 2.3291035
 x &lt;- ChangeSSM(parameters = xanchor,
                     initial.parameters = x, control=list(maxit=5000))
 sY &lt;- plotR(resultNest_4p_SSM$par, ylim = c(0,3), curve="ML")
 plotR(xprime$par, col="red", scaleY=sY, new=FALSE, curve="ML") 
 legend("topleft", legend=c("Fitted parameters", "Constrainted parameters"), lty=1, 
        col=c("black", "red"))
 # Weibull model
 x &lt;- ChangeSSM(temperatures = (200:350)/10,
                parameters = resultNest_4p_SSM$par,
                initial.parameters = structure(c(73, 300, 26), 
                                               .Names = c("k", "lambda", "scale")), 
                control=list(maxit=1000))
 # normal asymmetric model
 x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 10, 8, 32), 
               .Names = c("Scale", "sdL", "sdH", "Peak")), 
               control=list(maxit=1000))
 # trigonometric model
 x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 20, 40, 32), 
               .Names = c("Max", "LengthB", "LengthE", "Peak")), 
               control=list(maxit=1000))

 # example with a mcmc object, CI being 2.SD
 # Note the symmetric CI
data(resultNest_mcmc_4p_SSM)
new_result &lt;- ChangeSSM(resultmcmc = resultNest_mcmc_4p_SSM, result = resultNest_4p_SSM,
                        temperatures = seq(from = 20, to = 35, by = 0.1), 
                        outmcmc = "mean-sd", 
                        initial.parameters = NULL)

plotR(new_result, ylim=c(0, 3), curve="ML")
 # example with a mcmc object, CI being defined by 2.5%-97.5% quantiles
 # Note the asymmetric CI
data(resultNest_mcmc_4p_SSM)
new_result &lt;- ChangeSSM(resultmcmc = resultNest_mcmc_4p_SSM, result = resultNest_4p_SSM,
                        temperatures = seq(from = 20, to = 35, by = 0.1), 
                        outmcmc = "quantiles", 
                        initial.parameters = NULL)
 
plotR(new_result, ylim=c(0, 3), curve="ML")
plotR(new_result, ylim=c(0, 3), curve="ML quantiles")

# A little trick
# to convert SSM4 to SSM6, you can use:

x4 &lt;- c('DHA' = 69.718935117894063, 
         'DHH' = 497.81709040501079, 
         'T12H' = 308.95543713889509, 
         'Rho25' = 255.24186073771696)

x6 &lt;- c(x4["DHA"], 
.        x4["DHH"], 
.        'DHL' = x4[["DHH"]], 
.        'DT' = 0.5, 
.        'T12L' = x4[["T12H"]], 
.        x4['Rho25'])

## End(Not run)
</code></pre>

<hr>
<h2 id='DatabaseNestingArea'>Database of RMU for marine turtles</h2><span id='topic+DatabaseNestingArea'></span>

<h3>Description</h3>

<p>Database of RMU for marine turtles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatabaseNestingArea
</code></pre>


<h3>Format</h3>

<p>A dataframe with raw data.
</p>


<h3>Details</h3>

<p>Database of RMU for marine turtles
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>
<p>Maria Sousa Martins <a href="mailto:maria.esmartins@gmail.com">maria.esmartins@gmail.com</a>
</p>


<h3>References</h3>

<p>Wallace, B. P., DiMatteo, A. D., Hurley, B. J., Finkbeiner, 
E. M., Bolten, A. B., Chaloupka, M. Y., Hutchinson, B. J., 
Abreu-Grobois, F. A., Amorocho, D., Bjorndal, K. A., Bourjea, J., 
Bowen, B. W., Duenas, R. B., Casale, P., Choudhury, B. C., Costa, A., 
Dutton, P. H., Fallabrino, A., Girard, A., Girondot, M., 
Godfrey, M. H., Hamann, M., Lopez-Mendilaharsu, M., Marcovaldi, 
M. A., Mortimer, J. A., Musick, J. A., Nel, R., Seminoff, J. A., 
Troeng, S., Witherington, B. &amp; Mast, R. B. 2010. Regional management 
units for marine turtles: a novel framework for prioritizing conservation 
and research across multiple scales. Plos One, 5, e15465.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(DatabaseNestingArea)

## End(Not run)
</code></pre>

<hr>
<h2 id='DatabaseTSD'>Database of TSD information for reptiles</h2><span id='topic+DatabaseTSD'></span>

<h3>Description</h3>

<p>Database of TSD information for reptiles<br />
The columns are:<br />
</p>

<ul>
<li> <p><code>Species</code>: Name of the species in binominal nommenclature
</p>
</li>
<li> <p><code>Subspecies</code>: Name of the subspecies
</p>
</li>
<li> <p><code>Country</code>: From which country the eggs come from
</p>
</li>
<li> <p><code>Area</code>: Name of the beach or region the eggs come from
</p>
</li>
<li> <p><code>RMU</code>: For marine turtles, name of the RMU for this population; see Wallace, B.P., DiMatteo, A.D., Hurley, B.J., Finkbeiner, E.M., Bolten, A.B., Chaloupka, M.Y., Hutchinson, B.J., Abreu-Grobois, F.A., Amorocho, D., Bjorndal, K.A., Bourjea, J., Bowen, B.W., Duenas, R.B., Casale, P., Choudhury, B.C., Costa, A., Dutton, P.H., Fallabrino, A., Girard, A., Girondot, M., Godfrey, M.H., Hamann, M., Lopez-Mendilaharsu, M., Marcovaldi, M.A., Mortimer, J.A., Musick, J.A., Nel, R., Seminoff, J.A., Troeng, S., Witherington, B., Mast, R.B., 2010. Regional management units for marine turtles: a novel framework for prioritizing conservation and research across multiple scales. Plos One 5, e15465.
</p>
</li>
<li> <p><code>Incubation.temperature</code>: Nominal incubation temperature
</p>
</li>
<li> <p><code>Incubation.temperature.Constant</code>: Does the incubation temperature was set as constant or CTE was reported
</p>
</li>
<li> <p><code>Incubation.temperature.Accuracy</code>: What is the accuracy of the measure of temperature
</p>
</li>
<li> <p><code>Incubation.temperature.SD</code>: Experimental SD of incubation temperatures
</p>
</li>
<li> <p><code>Incubation.temperature.Amplitude</code>: How much the temperature could fluctuate around nominal temperature
</p>
</li>
<li> <p><code>Correction.factor</code>: Difference between the incubator temperature and the eggs temperature
</p>
</li>
<li> <p><code>IP.min</code>: Shorter incubation period
</p>
</li>
<li> <p><code>IP.max</code>: Longer incubation period
</p>
</li>
<li> <p><code>IP.mean</code>: Mean incubation periods
</p>
</li>
<li> <p><code>IP.SD</code>: Standard deviation for incubation periods
</p>
</li>
<li> <p><code>Total</code>: Total number of eggs incubated
</p>
</li>
<li> <p><code>Hatched</code>: Number of hatchlings
</p>
</li>
<li> <p><code>NotHatched</code>: Number of embryos with development visible but dead during incubation
</p>
</li>
<li> <p><code>Undeveloped</code>: Number of embryos showing no development
</p>
</li>
<li> <p><code>Intersexes</code>: Number of individuals intersexes or ambiguous for sex phenotype
</p>
</li>
<li> <p><code>Males</code>: Number of individuals indentified as males
</p>
</li>
<li> <p><code>Females</code>: Number of individuals indentified as females
</p>
</li>
<li> <p><code>Sexed</code>: Number of sexed individuals
</p>
</li>
<li> <p><code>Clutch</code>: Identity or number of clutches
</p>
</li>
<li> <p><code>Reference</code>: Bibliographic reference
</p>
</li>
<li> <p><code>Note</code>: Diverse information for this incubation
</p>
</li>
<li> <p><code>Version</code>: Date of the last modification for each record
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>DatabaseTSD
</code></pre>


<h3>Format</h3>

<p>A dataframe with raw data.
</p>


<h3>Details</h3>

<p>Database of TSD information for marine turtles
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(DatabaseTSD)
DatabaseTSD.version()
totalIncubation_Lo &lt;- subset(DatabaseTSD, 
         Species=="Lepidochelys olivacea" &amp; (!is.na(Sexed) &amp; Sexed!=0), 
         select=c("Males", "Females", "Incubation.temperature"))
tot_Lo &lt;- with(totalIncubation_Lo, tsd(males=Males, females=Females, 
 temperatures=Incubation.temperature), parameters.initial = c(P=30.5, S=-0.4))
 predict(tot_Lo)

## End(Not run)
</code></pre>

<hr>
<h2 id='DatabaseTSD.version'>Version of database of TSD information for reptiles</h2><span id='topic+DatabaseTSD.version'></span>

<h3>Description</h3>

<p>Return the date of the most recent update of the database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatabaseTSD.version()
</code></pre>


<h3>Details</h3>

<p>Database of TSD information for marine turtles
</p>


<h3>Value</h3>

<p>The date of the lastest updated version
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
DatabaseTSD.version()

## End(Not run)
</code></pre>

<hr>
<h2 id='dydt.exponential'>Return the derivative of the exponential function</h2><span id='topic+dydt.exponential'></span>

<h3>Description</h3>

<p>Return the derivative of the exponential function<br />
dydt.exponential(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dydt.exponential(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dydt.exponential_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="dydt.exponential_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="dydt.exponential_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha and K values being c(alpha=x1, K=x2). K is not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>dydt.exponential returns the derivative of the exponential function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(306.174998729436, 333.708348843241,  
	299.856306141849, 149.046870203155),  
	.Names = c("DHA", "DHH", "T12H", "Rho25"))
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_exponential &lt;- searchR(parameters=x, fixed.parameters=NULL,  
	temperatures=formated, derivate=dydt.exponential, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))

## End(Not run)
</code></pre>

<hr>
<h2 id='dydt.Gompertz'>Return the derivative of the Gompertz function</h2><span id='topic+dydt.Gompertz'></span>

<h3>Description</h3>

<p>Return the derivative of the Gompertz function<br />
dydt.Gompertz(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dydt.Gompertz(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dydt.Gompertz_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="dydt.Gompertz_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="dydt.Gompertz_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha and K values being c(alpha=x1, K=x2)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>dydt.Gompertz returns the derivative of the Gompertz function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(118.768297442004, 475.750095909406, 306.243694918151, 
116.055824800264), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed,  
	temperatures=formated, derivate=dydt.Gompertz, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='dydt.linear'>Return the derivative of the linear function</h2><span id='topic+dydt.linear'></span>

<h3>Description</h3>

<p>Return the derivative of the linear function<br />
dydt.linear(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dydt.linear(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dydt.linear_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="dydt.linear_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="dydt.linear_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha being c(alpha=x1, K=x2). Only alpha is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>dydt.Linear returns the derivative of the linear function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(306.174998729436, 333.708348843241, 299.856306141849,  
	149.046870203155), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_linear &lt;- searchR(parameters=x, fixed.parameters=NULL,  
	temperatures=formated, derivate=dydt.linear, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))

## End(Not run)
</code></pre>

<hr>
<h2 id='FormatNests'>Create a dataset of class Nests to be used with searchR</h2><span id='topic+FormatNests'></span>

<h3>Description</h3>

<p>Will create a dataset of class Nests to be used with searchR<br />
FormatNests(nest, previous=x) with x being a previously formated data.<br />
The raw data must be organized being:<br />
First column is the time in minutes since the beginning of incubation<br />
Each column next is the trace of temperatures, one column for each nest.<br />
For example, for two nests:<br />
Time   Nest1    Nest2<br />
0       29.8     27.6<br />
90      30.2     28.8<br />
120     30.4     30.7<br />
180     31.2     32.6<br />
...<br />
65800   30.8     32.6<br />
65890            30.2<br />
65950            30.4<br />
<br />
The Nest1 ends incubation at 65800 minutes whereas Nest2 ends incubation at 65950 (last row<br />
with temperature for each).<br />
The parameter Weight is a vector: weight=c(Nest1=1, Nest2=1.2)<br />
It can be used to format database already formated with old format; in this case, just use data=xxx with xxx being the old format database.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FormatNests(
  data = stop("A dataset must be provided !"),
  previous = NULL,
  usemiddletime = FALSE,
  simplify = TRUE,
  weight = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FormatNests_+3A_data">data</code></td>
<td>
<p>Data to be newly formated</p>
</td></tr>
<tr><td><code id="FormatNests_+3A_previous">previous</code></td>
<td>
<p>Data already formated</p>
</td></tr>
<tr><td><code id="FormatNests_+3A_usemiddletime">usemiddletime</code></td>
<td>
<p>If TRUE, suppose that recorded temperatures are those at middle segment</p>
</td></tr>
<tr><td><code id="FormatNests_+3A_simplify">simplify</code></td>
<td>
<p>If TRUE, simply the time series by removing identical time series of temperatures</p>
</td></tr>
<tr><td><code id="FormatNests_+3A_weight">weight</code></td>
<td>
<p>Named vector with weight for likelihhod</p>
</td></tr>
</table>


<h3>Details</h3>

<p>FormatNests creates a dataset of class &quot;Nests&quot; to be used with searchR
</p>


<h3>Value</h3>

<p>A list with all the nests formated to be used with searchR.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest, previous=NULL)
formated &lt;- FormatNests(nest)

## End(Not run)
</code></pre>

<hr>
<h2 id='Generate_hatchling_metric'>Generate a data.frame that can be used as hatchling.metric value for searchR()</h2><span id='topic+Generate_hatchling_metric'></span>

<h3>Description</h3>

<p>Generate a data.frame that can be used as hatchling.metric value for searchR()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Generate_hatchling_metric(
  series = stop("A result object or names of series must be provided"),
  hatchling.metric = NULL,
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Generate_hatchling_metric_+3A_series">series</code></td>
<td>
<p>Name of series or object from searchR()</p>
</td></tr>
<tr><td><code id="Generate_hatchling_metric_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>Size or mass at hatching. Will be recycled if necessary</p>
</td></tr>
<tr><td><code id="Generate_hatchling_metric_+3A_previous">previous</code></td>
<td>
<p>Previous formated hatchling.metric data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Generate_hatchling_metric Generate a data.frame that can be used as hatchling.metric value for searchR()
</p>


<h3>Value</h3>

<p>A data.frame with size or mass at hatching for each nest
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
testsize1 &lt;- Generate_hatchling_metric(resultNest_4p_SSM)
testsize2 &lt;- Generate_hatchling_metric(series=resultNest_4p_SSM,  
	hatchling.metric=c(Mean=39.3, SD=1.92))

## End(Not run)
</code></pre>

<hr>
<h2 id='GenerateAnchor'>Generate a set of anchored parameters</h2><span id='topic+GenerateAnchor'></span>

<h3>Description</h3>

<p>Generate a set of anchored parameters.<br />
It is important that the anchors (i.e. the temperatures used as anchors) encompass 
the highest and lowest temperatures that are present in nests.<br />
The value for each anchor is R * 1E5. The 1E5 factor allows to value to be close to unity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateAnchor(
  temperatures = NULL,
  nests = NULL,
  parameters = NULL,
  number.anchors = 7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateAnchor_+3A_temperatures">temperatures</code></td>
<td>
<p>A vector with temperatures to serve as anchors</p>
</td></tr>
<tr><td><code id="GenerateAnchor_+3A_nests">nests</code></td>
<td>
<p>Formated nest data or result object obtained from searchR()</p>
</td></tr>
<tr><td><code id="GenerateAnchor_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters value</p>
</td></tr>
<tr><td><code id="GenerateAnchor_+3A_number.anchors">number.anchors</code></td>
<td>
<p>Number of anchors</p>
</td></tr>
</table>


<h3>Details</h3>

<p>GenerateAnchor Generate a set of anchored parameters
</p>


<h3>Value</h3>

<p>A vector with parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Example to generate anchored parameters
newp &lt;- GenerateAnchor()
newp &lt;- GenerateAnchor(temperatures=seq(from=20, 
  to=35, length.out=7))
newp &lt;- GenerateAnchor(number.anchors=7)
data(nest)
formated &lt;- FormatNests(nest, previous=NULL)
newp &lt;- GenerateAnchor(nests=formated)
newp &lt;- GenerateAnchor(nests=formated, number.anchors=10)
data(resultNest_4p_SSM)
newp &lt;- GenerateAnchor(nests=resultNest_4p_SSM, number.anchors=7)
newp &lt;- GenerateAnchor(nests=resultNest_4p_SSM, temperatures=seq(from=20,
 to=35, length.out=10))
newp &lt;- GenerateAnchor(nests=resultNest_4p_SSM, number.anchors=7)
newp &lt;- c(newp, Scale=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='GenerateConstInc'>Generate a data.frame with constant incubation temperature and incubation duration</h2><span id='topic+GenerateConstInc'></span>

<h3>Description</h3>

<p>Generate a data.frame from constant incubation temperature and incubation duration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GenerateConstInc(
  durations = stop("At least one incubation length must be provided"),
  temperatures = stop("At least one incubation temperature must be provided"),
  names = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GenerateConstInc_+3A_durations">durations</code></td>
<td>
<p>A vector with incubation durations</p>
</td></tr>
<tr><td><code id="GenerateConstInc_+3A_temperatures">temperatures</code></td>
<td>
<p>A vector with incubation temperatures</p>
</td></tr>
<tr><td><code id="GenerateConstInc_+3A_names">names</code></td>
<td>
<p>A vector of column names</p>
</td></tr>
</table>


<h3>Details</h3>

<p>GenerateConstInc generates a data.frame with constant incubation temperature and incubation duration
</p>


<h3>Value</h3>

<p>A date.frame that can be used with FormatNests()
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
temp_cst &lt;- GenerateConstInc(durations=c(150000, 100100, 100000), 
temperatures=c(28, 30.5, 30.6), 
	names=c("T28", "T30.5", "T30.6"))

## End(Not run)
</code></pre>

<hr>
<h2 id='GRTRN_MHmcmc'>Metropolis-Hastings algorithm for Embryo Growth Rate Thermal Reaction Norm</h2><span id='topic+GRTRN_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for data.<br />
The number of iterations is <code>n.iter+n.adapt+1</code> because the initial likelihood is also displayed.<br />
I recommend that thin=1 because the method to estimate SE uses resampling.<br />
If initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
To get the SE of the point estimates from <code>result_mcmc &lt;- GRTRN_MHmcmc(result=try)</code>, use:<br />
<code>result_mcmc$SD</code><br />
<code>coda</code> package is necessary for this function.<br />
The parameters <code>intermediate</code> and <code>filename</code> are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file named <code>filename</code>.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and processes with user limited time.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRTRN_MHmcmc(
  result = NULL,
  n.iter = 10000,
  parametersMCMC = NULL,
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  trace = NULL,
  traceML = FALSE,
  parallel = TRUE,
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GRTRN_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_parallel">parallel</code></td>
<td>
<p>If true, try to use several cores using parallel computing</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="GRTRN_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>GRTRN_MHmcmc runs the Metropolis-Hastings algorithm for data (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "T12H", "DHA",  "DHH", "DHL", "Rho25"
############################################################################
pfixed &lt;- c(rK=1.208968)
M0 = 0.3470893 
############################################################################
# 4 parameters
############################################################################
x c('DHA' = 109.31113503282113, 'DHH' = 617.80695919563857, 
    'T12H' = 306.38890489505093, 'Rho25' = 229.37265815800225)
    
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1, 
embryo.stages="Caretta caretta.SCL")
############################################################################
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_SSM, accept=TRUE)
# Take care, it can be very long; several days
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM, 
   adaptive = TRUE,
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=TRUE)
# The SDProp in pMCMC at the beginning of the Markov chain can 
# be considered as non-optimal. However, the values at the end 
# of the Markoc chain are better due to the use of the option
# adaptive = TRUE. Then a good strategy is to run again the MCMC
# with this final set:
pMCMC[, "SDProp"] &lt;- resultNest_mcmc_4p_SSM$parametersMCMC$SDProp.end
# Also, take the set of parameters fitted as maximim likelihood
# as initial set of value
pMCMC[, "Init"] &lt;- as.parameters(resultNest_mcmc_4p_SSM)
# Then I run again the MCMC; it will ensure to get the optimal distribution
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM, 
   adaptive = TRUE,
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=TRUE)
		
data(resultNest_mcmc_4p_SSM)
out &lt;- as.mcmc(resultNest_mcmc_4p_SSM)
# This out can be used with coda package
# Test for stationarity and length of chain
require(coda)
heidel.diag(out)
raftery.diag(out)
# plot() can use the direct output of GRTRN_MHmcmc() function.
plot(resultNest_mcmc_4p_SSM, parameters=1, xlim=c(0,550))
plot(resultNest_mcmc_4p_SSM, parameters=3, xlim=c(290,320))
# summary() permits to get rapidly the standard errors for parameters
# They are store in the result also.
se &lt;- result_mcmc_4p_SSM$SD
# the confidence interval is better estimated by:
apply(out[[1]], 2, quantile, probs=c(0.025, 0.975))
# The use of the intermediate method is as followed;
# Here the total mcmc iteration is 10000, but every 1000, intermediate
# results are saved in file intermediate1000.Rdata:
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM, 
parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
n.adapt = 0, thin=1, trace=TRUE, 
intermediate=1000, filename="intermediate1000.Rdata")
# If run has been stopped for any reason, it can be resumed with:
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(previous="intermediate1000.Rdata")
# Example to use of the epsilon parameter to get confidence level
resultNest_4p_epsilon &lt;- resultNest_4p
resultNest_4p_epsilon$fixed.parameters &lt;- c(resultNest_4p_epsilon$par, 
                   resultNest_4p_epsilon$fixed.parameters)
resultNest_4p_epsilon$par &lt;- c(epsilon = 0)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_epsilon, accept = TRUE)
resultNest_mcmc_4p_epsilon &lt;- GRTRN_MHmcmc(result = resultNest_4p_epsilon, 
           n.iter = 10000, parametersMCMC = pMCMC,
           n.chains = 1, n.adapt = 0, thin = 1, trace = TRUE, parallel = TRUE)
data(resultNest_mcmc_4p_epsilon)
plot(resultNest_mcmc_4p_epsilon, parameters="epsilon", xlim=c(-11, 11), las=1)
plotR(resultNest_4p_epsilon, SE=c(epsilon = unname(resultNest_mcmc_4p_epsilon$SD)), 
           ylim=c(0, 3), las=1)

## End(Not run)
</code></pre>

<hr>
<h2 id='HatchingSuccess.fit'>Fit a hatching success model to data using maximum likelihood</h2><span id='topic+HatchingSuccess.fit'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
The first version of the model was published in:<br />
Laloë, J.-O., Monsinjon, J., Gaspar, C., Touron, M., Genet, Q., Stubbs, J., Girondot, M. 
&amp; Hays, G.C. (2020) Production of male hatchlings at a remote South Pacific green sea turtle 
rookery: conservation implications in a female-dominated world. Marine Biology, 167, 70.<br />
The version available here is enhanced by using a double flexit model rather than a double 
logistic model. The flexit model is described here:<br />
Abreu-Grobois, F.A., Morales-Mérida, B.A., Hart, C.E., Guillon, J.-M., Godfrey, M.H., 
Navarro, E. &amp; Girondot, M. (2020) Recent advances on the estimation of the thermal 
reaction norm for sex ratios. PeerJ, 8, e8451.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HatchingSuccess.fit(
  par = NULL,
  data = stop("data must be provided"),
  fixed.parameters = NULL,
  column.Incubation.temperature = "Incubation.temperature",
  column.Hatched = "Hatched",
  column.NotHatched = "NotHatched",
  hessian = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HatchingSuccess.fit_+3A_par">par</code></td>
<td>
<p>A set of parameters.</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_data">data</code></td>
<td>
<p>A dataset in a data.frame with a least three columns: Incubation.temperature, Hatched and NotHatched</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of parameters that must not be fitted.</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_column.incubation.temperature">column.Incubation.temperature</code></td>
<td>
<p>Name of the column with incubation temperatures</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_column.hatched">column.Hatched</code></td>
<td>
<p>Name of the column with hatched number</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_column.nothatched">column.NotHatched</code></td>
<td>
<p>Name of the column with not hatched number</p>
</td></tr>
<tr><td><code id="HatchingSuccess.fit_+3A_hessian">hessian</code></td>
<td>
<p>Should Hessian matrix be estimated?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>HatchingSuccess.fit fits a hatching success model to data
</p>


<h3>Value</h3>

<p>Return a object of class HatchingSuccess
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
g.logistic &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)
         
HatchingSuccess.lnL(par=g.logistic$par, data=totalIncubation_Cc)

plot(g.logistic)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, 
         K1.low=1, K2.low=-1, K1.high=1, K2.high=-1, 
         MaxHS=0.8)

g.flexit &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g.flexit$par, data=totalIncubation_Cc)

compare_AICc(logistic=g.logistic, flexit=g.flexit)
plot(x=g.logistic, what = c("observations", "ML", "CI"), replicates=10000)

pMCMC &lt;- HatchingSuccess.MHmcmc_p(result = g.logistic, accept = TRUE)
MCMC &lt;- HatchingSuccess.MHmcmc(result = g.logistic, parametersMCMC = pMCMC,
                            n.iter = 100000, 
                           adaptive = TRUE)

plot(MCMC, parameters = "S.low")
plot(MCMC, parameters = "S.high")
plot(MCMC, parameters = "P.low")
plot(MCMC, parameters = "deltaP")
plot(MCMC, parameters = "MaxHS")

plot(x=g.logistic, what = c("observations", "ML", "CI"), 
        replicates=10000, resultmcmc=MCMC)

####### Exemple with Chelonia mydas
totalIncubation_Cm &lt;- subset(DatabaseTSD, 
Species=="Chelonia mydas" &amp; 
  Note != "Sinusoidal pattern" &amp; 
  !is.na(Total) &amp; Total != 0 &amp; 
  !is.na(NotHatched) &amp; !is.na(Hatched))
  
  totalIncubation_Cm$NotHatched &lt;- totalIncubation_Cm$NotHatched + 
  ifelse(!is.na(totalIncubation_Cm$Undeveloped), totalIncubation_Cm$Undeveloped, 0)
  
  
  plot(x=totalIncubation_Cm$Incubation.temperature, 
  y=totalIncubation_Cm$Hatched/totalIncubation_Cm$Total, bty="n", las=1, 
  xlab="Constant incubation temperature", ylab="Proportion of hatching")

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)

g.logistic &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cm)
plot(g.logistic)

pMCMC &lt;- HatchingSuccess.MHmcmc_p(g.logistic, accept=TRUE)
mcmc &lt;- HatchingSuccess.MHmcmc(result=g.logistic, parameters = pMCMC, 
                  adaptive=TRUE, n.iter=100000, trace=1000)
par &lt;- as.parameters(mcmc)
par &lt;- as.parameters(mcmc, index="median")

plot(mcmc, parameters=c("P.low"))
plot(mcmc, parameters=c("deltaP"))
plot(mcmc, parameters=c("S.low"))
plot(mcmc, parameters=c("S.high"))
plot(mcmc, parameters=c("MaxHS"))

plot(g.logistic, resultmcmc=mcmc, what = c("observations", "CI"))

## End(Not run)
</code></pre>

<hr>
<h2 id='HatchingSuccess.lnL'>Return -log likelihood of the data and the parameters</h2><span id='topic+HatchingSuccess.lnL'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HatchingSuccess.lnL(
  par,
  data,
  fixed.parameters = NULL,
  column.Incubation.temperature = "Incubation.temperature",
  column.Hatched = "Hatched",
  column.NotHatched = "NotHatched"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HatchingSuccess.lnL_+3A_par">par</code></td>
<td>
<p>A set of parameters.</p>
</td></tr>
<tr><td><code id="HatchingSuccess.lnL_+3A_data">data</code></td>
<td>
<p>A dataset in a data.frame with a least three columns: Incubation.temperature, Hatched and NotHatched</p>
</td></tr>
<tr><td><code id="HatchingSuccess.lnL_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of parameters that must not be fitted.</p>
</td></tr>
<tr><td><code id="HatchingSuccess.lnL_+3A_column.incubation.temperature">column.Incubation.temperature</code></td>
<td>
<p>Name of the column with incubation temperatures</p>
</td></tr>
<tr><td><code id="HatchingSuccess.lnL_+3A_column.hatched">column.Hatched</code></td>
<td>
<p>Name of the column with hatched number</p>
</td></tr>
<tr><td><code id="HatchingSuccess.lnL_+3A_column.nothatched">column.NotHatched</code></td>
<td>
<p>Name of the column with not hatched number</p>
</td></tr>
</table>


<h3>Details</h3>

<p>HatchingSuccess.lnL return -log likelihood of the data and the parameters
</p>


<h3>Value</h3>

<p>Return -log likelihood of the data and the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0 &amp; 
                               !is.na(NotHatched) &amp; !is.na(Hatched))

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(par=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

t &lt;- seq(from=20, to=40, by=0.1)
CIq &lt;- predict(g, temperature=t)

par(mar=c(4, 4, 1, 1), +0.4)
plot(g)

## End(Not run)
</code></pre>

<hr>
<h2 id='HatchingSuccess.MHmcmc'>Metropolis-Hastings algorithm for hatching success</h2><span id='topic+HatchingSuccess.MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for hatching success.<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend that thin=1 because the method to estimate SE uses resampling.<br />
If initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
To get the SE from result_mcmc &lt;- HatchingSuccess.MHmcmc(result=try), use:<br />
result_mcmc$BatchSE or result_mcmc$TimeSeriesSE<br />
The batch standard error procedure is usually thought to be not as accurate as the time series methods.<br />
Based on Jones, Haran, Caffo and Neath (2005), the batch size should be equal to sqrt(n.iter).<br />
Jones, G.L., Haran, M., Caffo, B.S. and Neath, R. (2006) Fixed Width Output Analysis for Markov chain Monte Carlo , Journal of the American Statistical Association, 101:1537-1547.<br />
coda package is necessary for this function.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and processes at time limited.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HatchingSuccess.MHmcmc(
  result = stop("Give a result of HatchingSuccess.fit()"),
  n.iter = 10000,
  parametersMCMC = NULL,
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  trace = FALSE,
  traceML = FALSE,
  batchSize = sqrt(n.iter),
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_batchsize">batchSize</code></td>
<td>
<p>Number of observations to include in each batch fo SE estimation</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>HatchingSuccess.MHmcmc runs the Metropolis-Hastings algorithm for hatching success (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)
pMCMC &lt;- HatchingSuccess.MHmcmc_p(g, accept=TRUE)
mcmc &lt;- HatchingSuccess.MHmcmc(result=g, parameters = pMCMC, 
                  adaptive=TRUE, n.iter=100000, trace=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='HatchingSuccess.MHmcmc_p'>Generates set of parameters to be used with HatchingSuccess.MHmcmc()</h2><span id='topic+HatchingSuccess.MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive script used to generate set of parameters to be used with HatchingSuccess.MHmcmc().<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HatchingSuccess.MHmcmc_p(
  result = NULL,
  parameters = NULL,
  fixed.parameters = NULL,
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HatchingSuccess.MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a HatchingSuccess.fit() fit</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_p_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters. Replace the one from result</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_p_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of fixed parameters. Replace the one from result</p>
</td></tr>
<tr><td><code id="HatchingSuccess.MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, the script does not wait user information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>HatchingSuccess.MHmcmc_p generates set of parameters to be used with HatchingSuccess.MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)
pMCMC &lt;- HatchingSuccess.MHmcmc_p(g, accept=TRUE)
mcmc &lt;- HatchingSuccess.MHmcmc(result=g, parameters = pMCMC, 
                  adaptive=TRUE, n.iter=100000, trace=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='HatchingSuccess.model'>Return the hatching success according the set of parameters and temperatures</h2><span id='topic+HatchingSuccess.model'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HatchingSuccess.model(par, temperature)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HatchingSuccess.model_+3A_par">par</code></td>
<td>
<p>A set of parameters.</p>
</td></tr>
<tr><td><code id="HatchingSuccess.model_+3A_temperature">temperature</code></td>
<td>
<p>A vector of temperatures.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>HatchingSuccess.model returns the hatching success according the set of parameters and temperatures
</p>


<h3>Value</h3>

<p>Return the hatching success according the set of parameters and temperatures
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(par=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

plot(g)

## End(Not run)
</code></pre>

<hr>
<h2 id='hist.Nests'>Show the histogram of temperatures with set of nests</h2><span id='topic+hist.Nests'></span>

<h3>Description</h3>

<p>Show the histogram of temperatures with set of nests
hist(data)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Nests'
hist(x, series = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.Nests_+3A_x">x</code></td>
<td>
<p>Data formated using formatdata.</p>
</td></tr>
<tr><td><code id="hist.Nests_+3A_series">series</code></td>
<td>
<p>Series to be used, logical (TRUE ou FALSE), numbers or names. If &quot;all&quot;, all series are used.</p>
</td></tr>
<tr><td><code id="hist.Nests_+3A_...">...</code></td>
<td>
<p>Parameters used by hist function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hist.Nests shows the histogram of temperatures with set of nests
</p>


<h3>Value</h3>

<p>A list with an histogram object with information on histogram or 
NULL if no series was selected and the complete set of temperatures used.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
h &lt;- hist(formated, series="all")

## End(Not run)
</code></pre>

<hr>
<h2 id='hist.NestsResult'>Show the histogram of temperatures with set of nests</h2><span id='topic+hist.NestsResult'></span>

<h3>Description</h3>

<p>Show the histogram of temperatures with set of nests
hist(data)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NestsResult'
hist(x, series = "all", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.NestsResult_+3A_x">x</code></td>
<td>
<p>Results obtained after searchR</p>
</td></tr>
<tr><td><code id="hist.NestsResult_+3A_series">series</code></td>
<td>
<p>Series to be used, logical (TRUE ou FALSE), numbers or names. If &quot;all&quot;, all series are used.</p>
</td></tr>
<tr><td><code id="hist.NestsResult_+3A_...">...</code></td>
<td>
<p>Parameters used by hist function (example main=&quot;Title&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>hist.NestsResult shows the histogram of temperatures with set of nests
</p>


<h3>Value</h3>

<p>A list with an histogram object with information on histogram or 
NULL if no series was selected and the complete set of temperatures used.
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
h &lt;- hist(resultNest_4p_SSM, series=c(1:5))

## End(Not run)
</code></pre>

<hr>
<h2 id='info.nests'>Calculte statistics about nests</h2><span id='topic+info.nests'></span>

<h3>Description</h3>

<p>This function calculates many statistics about nests.<br />
The embryo.stages is a named vector with relative size as compared to final size at the beginning of the stage. Names are the stages.<br />
For example for SCL in Caretta caretta:<br />
embryo.stages=structure(c(8.4, 9.4, 13.6, 13.8, 18.9, 23.5, 32.2, 35.2, 35.5, 38.5)/39.33), <br />
.Names = c(&quot;21&quot;, &quot;22&quot;, &quot;23&quot;, &quot;24&quot;, &quot;25&quot;, &quot;26&quot;, &quot;27&quot;, &quot;28&quot;, &quot;29&quot;, &quot;30&quot;, &quot;31&quot;))<br />
indicates that the stages 21 begins at the relative size of 8.4/39.33 as compared to the final size.<br />
Series can be indicated as the name of the series, their numbers or series or succession of TRUE or FALSE. &quot;all&quot; indicates that all series must be analyzed.<br />
The likelihood object is just the total likelihood of the data in the model.<br />
If one parameter is named &quot;pipping_emergence&quot; it is used as the number of days between pipping and emergence to calculate the 1/3 and 2/3 of incubation.<br />
The summary object is a data.frame composed of these elements with the suffix .mean, .se or .quantile_x with x from the parameter probs.
</p>

<ul>
<li> <p><code>Temperature.max</code> Maximum temperature recorded during incubation
</p>
</li>
<li> <p><code>TimeWeighted.temperature</code> Average temperature during all incubation
</p>
</li>
<li> <p><code>GrowthWeighted.temperature</code> Average temperature weighted by the actual growth during all incubation
</p>
</li>
<li> <p><code>TimeWeighted.GrowthRateWeighted.temperature</code> Average temperature weighted by the growth rate during all incubation
</p>
</li>
<li> <p><code>TSP.TimeWeighted.temperature</code> Average temperature during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.temperature</code> Average temperature weighted by the actual growth during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.temperature</code> Average temperature weighted by the growth rate during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.STRNWeighted.temperature</code> Average temperature weighted by the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.STRNWeighted.temperature</code> Average temperature weighted by actual growth and the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.temperature</code> Average temperature weighted by growth rate and the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.length</code> TSP duration
</p>
</li>
<li> <p><code>TSP.begin</code> Beginning of the TSP
</p>
</li>
<li> <p><code>TSP.end</code> End of the TSP
</p>
</li>
<li> <p><code>TSP.PM.GrowthWeighted</code> Average of male probability for each temperature weighted by actual growth during the TSP
</p>
</li>
<li> <p><code>TSP.PM.TimeWeighted.GrowthRateWeighted</code> Average of male probability for each temperature weighted by growth rate during the TSP
</p>
</li>
<li> <p><code>TSP.PM.TimeWeighted</code> Average of male probability for each temperature during the TSP
</p>
</li>
<li> <p><code>Incubation.length</code> Incubation length duration
</p>
</li>
<li> <p><code>MiddleThird.length</code> Middle third incubation duration
</p>
</li>
<li> <p><code>MiddleThird.begin</code> Beginning of the middle third incubation duration
</p>
</li>
<li> <p><code>MiddleThird.end</code> End of the middle third incubation duration
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.temperature</code> Average temperature during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.GrowthWeighted.temperature</code> Average temperature weighted by the actual growth during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.GrowthRateWeighted.temperature</code> Average temperature weighted by the growth rate during the middle third incubation
</p>
</li>
<li> <p><code>TSP.TimeWeighted.sexratio</code> Sex ratio based on average temperature during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.sexratio</code> Sex ratio based on average temperature weighted by the actual growth during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.sexratio</code> Sex ratio based on average temperature weighted by the growth rate during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.STRNWeighted.sexratio</code> Sex ratio based on average temperature weighted by the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.STRNWeighted.sexratio</code> Sex ratio based on average temperature weighted by the actual growth and thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio</code> Sex ratio based on average temperature weighted by the growth rate and the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.sexratio</code> Sex ratio based on average temperature during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.GrowthWeighted.sexratio</code> Sex ratio based on average temperature weighted by actual growth during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.GrowthRateWeighted.sexratio</code> Sex ratio based on average temperature weighted by growth rate during the middle third incubation
</p>
</li>
<li> <p><code>TimeWeighted.sexratio</code> Sex ratio based on average temperature during all incubation
</p>
</li>
<li> <p><code>GrowthWeighted.sexratio</code> Sex ratio based on average temperature weighted by actual growth during all incubation
</p>
</li>
<li> <p><code>TimeWeighted.GrowthRateWeighted.sexratio</code> Sex ratio based on average temperature weighted by growth rate during all incubation
</p>
</li></ul>

<p>If <code>out</code> is equal to <code>summary</code>, the return is a list with:
</p>

<ul>
<li> <p><code>summary</code> is a data.frame with statistics for each nest.
</p>
</li>
<li> <p><code>dynamic.metric</code> object is a list composed of data.frames with the dynamics of growth for each nest. It showed only temperatures from original dataset.
</p>
</li>
<li> <p><code>summary.dynamic.metric</code> is a data.frame with the following columns with the suffix .mean, .se or .quantile_x with x from the parameter probs.
</p>
</li></ul>

<p>If <code>out</code> is equal to <code>metric</code>, the return is a list with:
</p>

<ul>
<li> <p><code>dynamic.metric</code> object is a list composed of data.frames with the dynamics of growth for each nest
</p>
</li>
<li> <p><code>indices.dynamic.metric</code> is a data.frame with the following columns.
</p>
</li></ul>

<p>The object <code>summary.dynamic.metric</code> or <code>indices.dynamic.metric</code> is a data.frame with the following columns:
</p>

<ul>
<li> <p><code>series</code> Name of the series
</p>
</li>
<li> <p><code>metric.begin.tsp</code> Metric at the beginning of TSP
</p>
</li>
<li> <p><code>metric.end.tsp</code> Metric at the end of TSP
</p>
</li>
<li> <p><code>hatchling.metric.mean</code> Average expected size of hatchlings
</p>
</li>
<li> <p><code>hatchling.metric.sd</code> standard deviation of expected size of hatchlings
</p>
</li>
<li> <p><code>time.begin.tsp</code> Time at the beginning of TSP
</p>
</li>
<li> <p><code>time.end.tsp</code> Time at the end of TSP
</p>
</li>
<li> <p><code>time.begin.middlethird</code> Time at the beginning of the middle third incubation
</p>
</li>
<li> <p><code>time.end.middlethird</code> Time at the end of the middle third incubation
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li>
<li> <p><code>stop.at.hatchling.metric</code> Take the value of NA if stop.at.hatchling.metric was FALSE. TRUE if at least one incubation series was longer than hatchling size and FALSE at contrary
</p>
</li></ul>

<p>If you indicate new set of temperatures, you must probably also indicate new hatchling.metric values.<br />
Note: four species have predefined embryo stages. embryo.stages parameter can take the values:<br />
</p>

<ul>
<li> <p><code>Caretta caretta.SCL</code>
</p>
</li>
<li> <p><code>Chelonia mydas.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.mass</code>
</p>
</li>
<li> <p><code>Podocnemis expansa.SCL</code>
</p>
</li>
<li> <p><code>Lepidochelys olivacea.SCL</code>
</p>
</li>
<li> <p><code>Generic.ProportionDevelopment</code>
</p>
</li></ul>

<p>But remember that mass is not the best proxy to describe the growth of an embryo because it can decrease if the substrate becomes dry.<br />
The progress bar is based on both replicates and timeseries progress. It necessitates the pbapply package.<br />
If replicate.CI is null or 0, only maximum likelihood is used and no confidence interval is calculated.<br />
If replicate.CI is 1, one random value for the parameters is used but no confidence interval is calculated.<br />
In other cases, replicate.CI random samples are used to estimate confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>info.nests(
  x = NULL,
  parameters = NULL,
  NestsResult = NULL,
  resultmcmc = NULL,
  hessian = NULL,
  GTRN.CI = NULL,
  fixed.parameters = NULL,
  SE = NULL,
  temperatures = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  stop.at.hatchling.metric = FALSE,
  M0 = NULL,
  series = "all",
  TSP.borders = NULL,
  embryo.stages = NULL,
  TSP.begin = 0,
  TSP.end = 0.5,
  replicate.CI = 0,
  weight = NULL,
  out = "likelihood",
  fill = NULL,
  probs = c(0.025, 0.5, 0.975),
  SexualisationTRN = NULL,
  SexualisationTRN.mcmc = NULL,
  SexualisationTRN.CI = NULL,
  metric.end.incubation = "observed",
  metabolic.heating = 0,
  temperature.heterogeneity = 0,
  progressbar = FALSE,
  warnings = TRUE,
  parallel = TRUE,
  tsd = NULL,
  tsd.CI = NULL,
  tsd.mcmc = NULL,
  zero = 1e-09,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="info.nests_+3A_x">x</code></td>
<td>
<p>A set of parameters to model the embryo growth thermal reaction norm or a NestsResult object.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters to model the embryo growth thermal reaction norm. It will replace the parameters included in NestsResult (same as x).</p>
</td></tr>
<tr><td><code id="info.nests_+3A_nestsresult">NestsResult</code></td>
<td>
<p>A NestsResult object generated by searchR to model the embryo growth thermal reaction</p>
</td></tr>
<tr><td><code id="info.nests_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A mcmc result for embryo growth thermal reaction norm</p>
</td></tr>
<tr><td><code id="info.nests_+3A_hessian">hessian</code></td>
<td>
<p>An hessian matrix for embryo growth thermal reaction norm. It will replace the hessian matrix included in NestResult object.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_gtrn.ci">GTRN.CI</code></td>
<td>
<p>How to estimate CI for embryo growth thermal reaction norm; can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of fixed parameters to model the embryo growth thermal reaction norm. It will replace the fixed parameters included in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_se">SE</code></td>
<td>
<p>Standard error for each parameter. It will replace the SE in NestsResult. Use SE=NA to remove SE from NestResult</p>
</td></tr>
<tr><td><code id="info.nests_+3A_temperatures">temperatures</code></td>
<td>
<p>Timeseries of temperatures formatted using formatNests(). It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_integral">integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_derivate">derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_stop.at.hatchling.metric">stop.at.hatchling.metric</code></td>
<td>
<p>TRUE or FALSE. If TRUE, the model stops when proxy of size reached the mean hatchling.metric size.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_m0">M0</code></td>
<td>
<p>Measure of hatchling size proxi at laying date. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_series">series</code></td>
<td>
<p>The name or number of the series to be estimated.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsp.borders">TSP.borders</code></td>
<td>
<p>The limits of TSP in stages. See embryo.stages parameter.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_embryo.stages">embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP borders. See note.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsp.begin">TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsp.end">TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI. See description</p>
</td></tr>
<tr><td><code id="info.nests_+3A_weight">weight</code></td>
<td>
<p>Weights of the different nests to estimate likelihood. It will replace the ones in NestsResult.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_out">out</code></td>
<td>
<p>Can take the values of &quot;likelihood&quot;, &quot;summary&quot;, &quot;metric&quot; or &quot;dynamic&quot;.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_fill">fill</code></td>
<td>
<p>Number of minutes between two records. Create new one if they do not exist. NULL does not change the time of temperature recordings.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_probs">probs</code></td>
<td>
<p>Probabilities for metric quantiles.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_sexualisationtrn">SexualisationTRN</code></td>
<td>
<p>A set of parameters used to model sexualisation thermal reaction norm during TSP or a result of STRN()</p>
</td></tr>
<tr><td><code id="info.nests_+3A_sexualisationtrn.mcmc">SexualisationTRN.mcmc</code></td>
<td>
<p>A mcmc object obtained from STRN_MHmcmc() to generate variability for sexualisation thermal reaction norm during TSP</p>
</td></tr>
<tr><td><code id="info.nests_+3A_sexualisationtrn.ci">SexualisationTRN.CI</code></td>
<td>
<p>How to estimate CI of sexualisation thermal reaction norm. Can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_metric.end.incubation">metric.end.incubation</code></td>
<td>
<p>The metric at the end of incubation used to calibrate TSP size. Can be &quot;hatchling.metric&quot;, or &quot;observed&quot;.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_metabolic.heating">metabolic.heating</code></td>
<td>
<p>Degrees Celsius to be added at the end of incubation due to metabolic heating.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_temperature.heterogeneity">temperature.heterogeneity</code></td>
<td>
<p>SD of heterogeneity of temperatures. Can be 2 values, sd_low and sd_high and then HelpersMG::r2norm() is used.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_progressbar">progressbar</code></td>
<td>
<p>If FALSE, the progress bar is not shown (useful for using with sweave or knitr)</p>
</td></tr>
<tr><td><code id="info.nests_+3A_warnings">warnings</code></td>
<td>
<p>If FALSE, does not show warnings</p>
</td></tr>
<tr><td><code id="info.nests_+3A_parallel">parallel</code></td>
<td>
<p>If TRUE use parallel version for nests estimation</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsd">tsd</code></td>
<td>
<p>A object from tsd() that describe the thermal react norm of sex ratio at constant temperatures</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsd.ci">tsd.CI</code></td>
<td>
<p>How to estimate CI for sex ratio thermal reaction norm; Can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_tsd.mcmc">tsd.mcmc</code></td>
<td>
<p>A object from tsd_MHmcmc() .</p>
</td></tr>
<tr><td><code id="info.nests_+3A_zero">zero</code></td>
<td>
<p>Value to replace 0 or 1.</p>
</td></tr>
<tr><td><code id="info.nests_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, show more information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculate statistics about nests
</p>


<h3>Value</h3>

<p>Return or the total likelihood or a list with $metric and $summary depending on out parameter
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
# Some basic calculations to show the advantage of parallel computing
system.time(summary.nests &lt;- info.nests(x=resultNest_4p_SSM, out="summary", 
  embryo.stages="Caretta caretta.SCL", replicate.CI=0, parallel=FALSE))
system.time(summary.nests &lt;- info.nests(x=resultNest_4p_SSM, out="summary", 
  embryo.stages="Caretta caretta.SCL", replicate.CI=0, parallel=TRUE))
system.time(summary.nests &lt;- info.nests(x=resultNest_4p_SSM, out="summary", 
  embryo.stages="Caretta caretta.SCL", replicate.CI=0, parallel=TRUE, progressbar=TRUE))
system.time(summary.nests &lt;- info.nests(x=resultNest_4p_SSM, out="likelihood", 
  embryo.stages="Caretta caretta.SCL", replicate.CI=0, parallel=TRUE, progressbar=FALSE))
  
# By default parallel computing is TRUE but progressbar is FALSE
# When out is "likelihood", it returns only the likelihood
# otherwise, it returns a list with 3 objects "summary", 
#        "dynamic.metric", and "summary.dynamic.metric".

summary.nests &lt;- info.nests(resultNest_4p_SSM, out="summary", 
  embryo.stages="Caretta caretta.SCL", 
  replicate.CI=100, 
  resultmcmc=resultNest_mcmc_4p_SSM, 
  GTRN.CI="MCMC", 
  progressbar=TRUE)
  
summary.nests &lt;- info.nests(resultNest_4p_SSM, 
  embryo.stages="Caretta caretta.SCL", 
  out="summary", replicate.CI=100, 
  GTRN.CI="Hessian", 
  progressbar=TRUE)
  
summary.nests &lt;- info.nests(resultNest_4p_SSM, 
  series = 1, 
  embryo.stages="Caretta caretta.SCL", 
  out="summary", replicate.CI=100, 
  GTRN.CI="SE", 
  progressbar=TRUE)
  
# Example of use of embryo.stages and TSP.borders:
  summary.nests &lt;- info.nests(resultNest_4p_SSM, out="summary", 
                            embryo.stages=c("10"=0.33, "11"=0.33, "12"=0.66, "13"=0.66), 
                            TSP.borders = c(10, 12), 
                            replicate.CI=100,
                            progressbar=TRUE)
                            
#########################################
# Sex ratio using Massey et al. method PM
#########################################

# Massey, M.D., Holt, S.M., Brooks, R.J., Rollinson, N., 2019. Measurement 
# and modelling of primary sex ratios for species with temperature-dependent 
# sex determination. J Exp Biol 222, 1-9.
  
CC_Mediterranean &lt;- subset(DatabaseTSD, RMU=="Mediterranean" &amp; 
Species=="Caretta caretta" &amp; (!is.na(Sexed) &amp; Sexed!=0))
tsdL &lt;- with (CC_Mediterranean, tsd(males=Males, females=Females, 
                                    temperatures=Incubation.temperature, 
                                    equation="logistic", replicate.CI=NULL))
                                    
PM &lt;- info.nests(x=resultNest_4p_SSM, 
  GTRN.CI="Hessian", tsd.CI="Hessian", 
  embryo.stages="Caretta caretta.SCL", replicate.CI=100, 
  out="summary", progressbar=TRUE, tsd=tsdL)
  

plot_errbar(x=PM$summary$TimeWeighted.temperature.mean, 
            y=PM$summary$TSP.PM.GrowthWeighted.mean, 
            y.minus=PM$summary$TSP.PM.GrowthWeighted.quantile_0.025, 
            y.plus=PM$summary$TSP.PM.GrowthWeighted.quantile_0.975, 
            xlab="CTE SCL growth", 
            ylab="PM Massey et al. 2016", xlim=c(26, 32), ylim=c(0, 1), las=1)

# Relationship between growth and growth rate

infoall.df &lt;- info.nests(x=resultNest_4p_SSM, out="summary", 
  embryo.stages="Caretta caretta.SCL", 
  replicate.CI=100, 
  resultmcmc=resultNest_mcmc_4p_SSM, 
  GTRN.CI="MCMC", 
  progressbar=TRUE)
  
  layout(1)
plot(x=infoall.df$dynamic.metric[[1]][, "Time"], 
     y=infoall.df$dynamic.metric[[1]][, "Metric_50%"], 
     type="l", las=1, bty="n", 
     xlab="Time in minute", ylab="Growth", ylim=c(0, 39), xlim=c(0, 100000))
lines(x=infoall.df$dynamic.metric[[1]][, "Time"], 
     y=infoall.df$dynamic.metric[[1]][, "Metric_2.5%"], lty=2)
lines(x=infoall.df$dynamic.metric[[1]][, "Time"], 
     y=infoall.df$dynamic.metric[[1]][, "Metric_97.5%"], lty=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='integral.exponential'>Return the derivative of the exponential function</h2><span id='topic+integral.exponential'></span>

<h3>Description</h3>

<p>Return the derivative of the exponential function<br />
integral.exponential(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integral.exponential(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integral.exponential_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="integral.exponential_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="integral.exponential_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha and K values being c(alpha=x1, K=x2). K is not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>integral.exponential returns the derivative of the exponential function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(306.174998729436, 333.708348843241,  
	299.856306141849, 149.046870203155),  
	.Names = c("DHA", "DHH", "T12H", "Rho25"))
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_exponential &lt;- searchR(parameters=x, fixed.parameters=NULL,  
	temperatures=formated, derivate=dydt.exponential, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))

## End(Not run)
</code></pre>

<hr>
<h2 id='integral.Gompertz'>Return the result of the Gompertz function</h2><span id='topic+integral.Gompertz'></span>

<h3>Description</h3>

<p>Return the result of the Gompertz function as a data.frame with two columns, time and metric<br />
integral.Gompertz(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integral.Gompertz(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integral.Gompertz_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="integral.Gompertz_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="integral.Gompertz_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha and K values being c(alpha=x1, K=x2)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>integral.Gompertz returns the derivative of the Gompertz function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(118.768297442004, 475.750095909406, 306.243694918151, 
116.055824800264), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed,  
	temperatures=formated, integral=integral.Gompertz, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='integral.linear'>Return the linear function</h2><span id='topic+integral.linear'></span>

<h3>Description</h3>

<p>Return the derivative of the linear function<br />
integral.linear(t, size, parms)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integral.linear(t, size, parms)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integral.linear_+3A_t">t</code></td>
<td>
<p>The time in any unit</p>
</td></tr>
<tr><td><code id="integral.linear_+3A_size">size</code></td>
<td>
<p>The current size</p>
</td></tr>
<tr><td><code id="integral.linear_+3A_parms">parms</code></td>
<td>
<p>A vector with alpha being c(alpha=x1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>integral.linear returns the linear function.
</p>


<h3>Value</h3>

<p>A list with the derivative
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(306.174998729436, 333.708348843241, 299.856306141849,  
	149.046870203155), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_linear &lt;- searchR(parameters=x, fixed.parameters=NULL,  
	temperatures=formated, derivate=dydt.linear, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))

## End(Not run)
</code></pre>

<hr>
<h2 id='likelihoodR'>Estimate the likelihood of a set of parameters for nest incubation data</h2><span id='topic+likelihoodR'></span>

<h3>Description</h3>

<p>Estimate the likelihood of a set of parameters for nest incubation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likelihoodR(
  result = NULL,
  parameters = NULL,
  fixed.parameters = NULL,
  temperatures = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  M0 = NULL,
  hessian = FALSE,
  weight = NULL,
  parallel = TRUE,
  echo = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likelihoodR_+3A_result">result</code></td>
<td>
<p>A object obtained after searchR or likelihoodR</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of parameters that will not be changed</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_temperatures">temperatures</code></td>
<td>
<p>Timeseries of temperatures</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_integral">integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_derivate">derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_m0">M0</code></td>
<td>
<p>Measure of hatchling size or mass proxi at laying date</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the hessian matrix is estimated and the SE of parameters estimated.</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_weight">weight</code></td>
<td>
<p>A named vector of the weight for each nest for likelihood estimation</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_parallel">parallel</code></td>
<td>
<p>If true, try to use several cores using parallel computing.</p>
</td></tr>
<tr><td><code id="likelihoodR_+3A_echo">echo</code></td>
<td>
<p>If FALSE, does not display the result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>likelihoodR estimates the likelihood of a set of parameters for nest incubation data
</p>


<h3>Value</h3>

<p>A result object
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
# K for Gompertz must be set as fixed parameter or being a constant K  
# or relative to the hatchling size rK
x &lt;- structure(c(118.768297442004, 475.750095909406, 306.243694918151, 
116.055824800264), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for integral.linear or integral.exponential
LresultNest_4p &lt;- likelihoodR(parameters=x, fixed.parameters=pfixed,  
	temperatures=formated, integral=integral.Gompertz, M0=1.7,  
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)
LresultNest_4p &lt;- likelihoodR(result=resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.HatchingSuccess'>Return -log L of a fit</h2><span id='topic+logLik.HatchingSuccess'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HatchingSuccess'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.HatchingSuccess_+3A_object">object</code></td>
<td>
<p>The return of a fit done with fitHS.</p>
</td></tr>
<tr><td><code id="logLik.HatchingSuccess_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.HatchingSuccess returns -log L of a fit
</p>


<h3>Value</h3>

<p>Return -log L of a fit
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(par=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

t &lt;- seq(from=20, to=40, by=0.1)
CIq &lt;- predict(g, temperature=t)

par(mar=c(4, 4, 1, 1), +0.4)
plot(g)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.NestsResult'>Return Log Likelihood of a fit generated by searchR</h2><span id='topic+logLik.NestsResult'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by searchR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NestsResult'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.NestsResult_+3A_object">object</code></td>
<td>
<p>A result file generated by searchR</p>
</td></tr>
<tr><td><code id="logLik.NestsResult_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.NestsResult Return Log Likelihood of a fit
</p>


<h3>Value</h3>

<p>The Log Likelihood value of the fitted model and data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
logLik(resultNest_4p_SSM)
AIC(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.STRN'>Return Log Likelihood of a fit generated by STRN</h2><span id='topic+logLik.STRN'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by STRN
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'STRN'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.STRN_+3A_object">object</code></td>
<td>
<p>A result file generated by STRN</p>
</td></tr>
<tr><td><code id="logLik.STRN_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.STRN Return Log Likelihood of a fit
</p>


<h3>Value</h3>

<p>The Log Likelihood value of the fitted model and data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
logLik(resultNest_4p_SSM)
AIC(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik.tsd'>Return Log Likelihood of a fit generated by tsd</h2><span id='topic+logLik.tsd'></span>

<h3>Description</h3>

<p>Return Log Likelihood of a fit generated by tsd. The object has 3 attributes:<br />
nall, and nobs the number of observations, df, the number of fitted parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsd'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.tsd_+3A_object">object</code></td>
<td>
<p>A result file generated by tsd</p>
</td></tr>
<tr><td><code id="logLik.tsd_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>logLik.tsd Return Log Likelihood of a fit
</p>


<h3>Value</h3>

<p>The Log Likelihood value of the fitted model and data
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
m &lt;- c(10, 14, 7, 4, 3, 0, 0)
f &lt;- c(0, 1, 2, 4, 15, 10, 13)
t &lt;- c(25, 26, 27, 28, 29, 30, 31)
result &lt;- tsd(males=m, females=f, temperatures=t)
logLik(result)
AIC(result)

## End(Not run)
</code></pre>

<hr>
<h2 id='movement'>Analyze movement recorded within a nest with an accelerometer datalogger</h2><span id='topic+movement'></span>

<h3>Description</h3>

<p>This function is used to evaluate significant movement within a nest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movement(
  x = stop("data.frame must be provided"),
  col.time = "Time",
  col.x = "x",
  col.y = "y",
  col.z = "z",
  NumberRecordBeforeEmergence = 1900,
  k = 4,
  Windowsize = 15
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movement_+3A_x">x</code></td>
<td>
<p>A data.frame with 4 columns, one for time and three for x, y, and z position</p>
</td></tr>
<tr><td><code id="movement_+3A_col.time">col.time</code></td>
<td>
<p>Name of the column with time</p>
</td></tr>
<tr><td><code id="movement_+3A_col.x">col.x</code></td>
<td>
<p>Name of the column with x positions</p>
</td></tr>
<tr><td><code id="movement_+3A_col.y">col.y</code></td>
<td>
<p>Name of the column with y positions</p>
</td></tr>
<tr><td><code id="movement_+3A_col.z">col.z</code></td>
<td>
<p>Name of the column with z positions</p>
</td></tr>
<tr><td><code id="movement_+3A_numberrecordbeforeemergence">NumberRecordBeforeEmergence</code></td>
<td>
<p>Number of records in quiet period</p>
</td></tr>
<tr><td><code id="movement_+3A_k">k</code></td>
<td>
<p>Factor to multiply SD to prevent false positive detection</p>
</td></tr>
<tr><td><code id="movement_+3A_windowsize">Windowsize</code></td>
<td>
<p>Number of records used for moving average</p>
</td></tr>
</table>


<h3>Details</h3>

<p>movement is a function that permits to analyze movement datalogger
</p>


<h3>Value</h3>

<p>The function will return a list
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Data loggers utilities: 
<code><a href="#topic+calibrate.datalogger">calibrate.datalogger</a>()</code>,
<code><a href="#topic+uncertainty.datalogger">uncertainty.datalogger</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
mv &lt;- movement(x=dataf, 
               col.time="Time", 
               col.x="x", col.y="y", col.z="z")

## End(Not run)
</code></pre>

<hr>
<h2 id='MovingIncubation'>Simulate incubation of a nest with the beginning of incubation varying</h2><span id='topic+MovingIncubation'></span>

<h3>Description</h3>

<p>Simulate incubation of a nest with the beginning varying day by day<br />
Temperatures must be in a data.frame with one column (Time) being the time and the second the temperatures (Temperature). A third columns can indicate the temperature at the end of incubation (Temperature.end.incubation). Do not use FormatNests() for this dataframe.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MovingIncubation(
  NestsResult = NULL,
  resultmcmc = NULL,
  GTRN.CI = "Hessian",
  tsd = NULL,
  tsd.CI = NULL,
  tsd.mcmc = NULL,
  SexualisationTRN = NULL,
  SexualisationTRN.CI = "Hessian",
  SexualisationTRN.mcmc = NULL,
  temperatures.df = stop("A data.frame must be provided"),
  temperature.heterogeneity = 0,
  metabolic.heating = 0,
  average.incubation.duration = 60 * 1440,
  max.time = 100 * 24 * 60,
  skip = 1,
  parameters = NULL,
  fixed.parameters = NULL,
  SE = NULL,
  hessian = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  M0 = NULL,
  embryo.stages = "Caretta caretta.SCL",
  TSP.borders = c(21, 26),
  TSP.begin = 0,
  TSP.end = 0.5,
  replicate.CI = 1,
  parallel = TRUE,
  progressbar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MovingIncubation_+3A_nestsresult">NestsResult</code></td>
<td>
<p>A result file generated by searchR</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A mcmc result. Will be used rather than SE if provided.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_gtrn.ci">GTRN.CI</code></td>
<td>
<p>How to estimate CI for embryo growth thermal reaction norm; can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, &quot;pseudohessianfrommcmc&quot; or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsd">tsd</code></td>
<td>
<p>A object from tsd() that describe the thermal react norm of sex ratio at constant temperatures</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsd.ci">tsd.CI</code></td>
<td>
<p>How to estimate CI for sex ratio thermal reaction norm; Can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, &quot;pseudohessianfrommcmc&quot; or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsd.mcmc">tsd.mcmc</code></td>
<td>
<p>A object from tsd_MHmcmc()</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_sexualisationtrn">SexualisationTRN</code></td>
<td>
<p>A model for sexualisation thermal reaction norm during TSP obtained using STRN()</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_sexualisationtrn.ci">SexualisationTRN.CI</code></td>
<td>
<p>How to estimate CI of sexualisation thermal reaction norm. Can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, &quot;pseudohessianfrommcmc&quot; or &quot;Hessian&quot;.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_sexualisationtrn.mcmc">SexualisationTRN.mcmc</code></td>
<td>
<p>MCMC object for STRN.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_temperatures.df">temperatures.df</code></td>
<td>
<p>A data.frame with 2 or 3 columns: Times, Temperatures and Temperatures.end.incubation (facultative)</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_temperature.heterogeneity">temperature.heterogeneity</code></td>
<td>
<p>SD of heterogeneity of temperatures. Can be 2 values, sd_low and sd_high and then HelpersMG::r2norm() is used.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_metabolic.heating">metabolic.heating</code></td>
<td>
<p>Degrees Celsius to be added at the end of incubation due to metabolic heating</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_average.incubation.duration">average.incubation.duration</code></td>
<td>
<p>The average time to complete incubation (not used if metabolic heating is setup)</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_max.time">max.time</code></td>
<td>
<p>Maximum time of incubation</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_skip">skip</code></td>
<td>
<p>Number of data to skip between two runs</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters if result is not provided.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Another set of parameters if result is not provided.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_se">SE</code></td>
<td>
<p>Standard error for each parameter if not present in result is not provided</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_hessian">hessian</code></td>
<td>
<p>A hessian matrix</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_integral">integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_derivate">derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings as a vector ie hatchling.metric=c(Mean=xx, SD=yy)</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_m0">M0</code></td>
<td>
<p>Measure of hatchling size proxi at laying date</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_embryo.stages">embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP length</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsp.borders">TSP.borders</code></td>
<td>
<p>The limits of TSP</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsp.begin">TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_tsp.end">TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of randomizations to estimate CI</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_parallel">parallel</code></td>
<td>
<p>Should parallel computing be used. TRUE or FALSE</p>
</td></tr>
<tr><td><code id="MovingIncubation_+3A_progressbar">progressbar</code></td>
<td>
<p>Should a progress bar be shown ? TRUE or FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MovingIncubation simulate incubation of a nest with the beginning varying day by day
</p>


<h3>Value</h3>

<p>A dataframe with informations about thermosensitive period length and incubation length day by day of incubation
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
ti &lt;- seq(from=0, to=(60*24*100), by=60)
temperatures &lt;- rnorm(length(ti), 29, 5)
temperatures &lt;- temperatures+ti/(60*24*100)/2
layout(mat=1:3)
parpre &lt;- par(mar=c(4, 4, 1, 1)+0.4)
plot(ti/(60*24), temperatures, type="l", xlab="Days", 
     ylab=expression("Nest temperature in "*degree*"C"), bty="n", las=1)
# The sexualisation thermal reaction norm is calculated for South Pacific RMU
out &lt;- MovingIncubation(NestsResult=resultNest_4p_SSM, 
     temperatures.df=data.frame(Time=ti, Temperature=temperatures),
     metabolic.heating = 0, 
     SexualisationTRN = structure(c(71.922411148397, 613.773055147801, 
     318.059753164125, 120.327257089974), 
     .Names = c("DHA", "DHH", "T12H", "Rho25")))
with(out, plot(Time/(60*24), Incubation.length.mean/(60*24), 
     xlab="Days along the season", 
     ylab="Incubation duration", 
     type="l", bty="n", las=1, ylim=c(70, 80)))
with(out, plot(Time/(60*24), TSP.GrowthWeighted.STRNWeighted.temperature.mean, 
     xlab="Days along the season", 
     ylab=expression("CTE for sex ratio in "*degree*"C"), 
      type="l", bty="n", las=1, ylim=c(30, 31)))
par(mar=parpre)
layout(mat=c(1))

## End(Not run)
</code></pre>

<hr>
<h2 id='nest'>Timeseries of temperatures for nests</h2><span id='topic+nest'></span>

<h3>Description</h3>

<p>Timeseries of temperatures for nests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nest
</code></pre>


<h3>Format</h3>

<p>A dataframe with raw data
</p>


<h3>Details</h3>

<p>Timeseries of temperatures for nests
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M. &amp; Kaska, Y. 2014. A model to predict the thermal 
reaction norm for the embryo growth rate from field data. Journal of
Thermal Biology. 45, 96-102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)

## End(Not run)
</code></pre>

<hr>
<h2 id='nobs.HatchingSuccess'>Return number of observations of a fit</h2><span id='topic+nobs.HatchingSuccess'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HatchingSuccess'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.HatchingSuccess_+3A_object">object</code></td>
<td>
<p>The return of a fit done with fitHS.</p>
</td></tr>
<tr><td><code id="nobs.HatchingSuccess_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>nobs.NestsResult Return number of observations of a fit
</p>


<h3>Value</h3>

<p>Return number of observations of a fit
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(par=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

plot(g)

nobs(g)

## End(Not run)
</code></pre>

<hr>
<h2 id='nobs.NestsResult'>Return number of observations of a fit</h2><span id='topic+nobs.NestsResult'></span>

<h3>Description</h3>

<p>Return number of observations of a fit.<br />
This function is used for bbmle::ICtb().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NestsResult'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.NestsResult_+3A_object">object</code></td>
<td>
<p>A result file generated by searchR</p>
</td></tr>
<tr><td><code id="nobs.NestsResult_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>nobs.NestsResult Return number of observations of a fit
</p>


<h3>Value</h3>

<p>Return number of observations of a fit
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
logLik(resultNest_4p_SSM)
AIC(resultNest_4p_SSM)
nobs(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='P_TRT'>Estimate the transitional range of temperatures based on a set of parameters</h2><span id='topic+P_TRT'></span>

<h3>Description</h3>

<p>Estimate the parameters that best describe the thermal reaction norm for sex ratio when temperature-dependent sex determination occurs.<br />
It can be used also to evaluate the relationship between incubation duration and sex ratio.<br />
The parameter l was defined in Girondot (1999). The TRT is defined from the difference between the two boundary temperatures giving sex ratios of l and 1 - l.<br />
In Girondot (1999), l was 0.05 and then the TRT was defined as being the range of temperatures producing from 5
If l is null, TRT is not estimated and only sex ratio is estimated.<br />
if replicate.CI is null or 0, no replicate is used and only point estimate is done.<br />
Standard error is calculated using resampling based on the Hessian matrix with Cholesky decomposition 
or using MCMC chain if resultmcmc is provided. In the former case, a replicate.CI random sample of the 
MCMC results will be used.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P_TRT(
  x = NULL,
  resultmcmc = NULL,
  fixed.parameters = NULL,
  chain = 1,
  equation = NULL,
  l = 0.05,
  replicate.CI = NULL,
  temperatures = NULL,
  durations = NULL,
  SD.temperatures = NULL,
  SD.durations = NULL,
  probs = c(0.025, 0.5, 0.975),
  warn = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P_TRT_+3A_x">x</code></td>
<td>
<p>Set of parameters or a result of tsd()</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A result of tsd_MHmcmc()</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Set of fixed parameters</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_chain">chain</code></td>
<td>
<p>What chain to be used if resultmcmc is provided</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_equation">equation</code></td>
<td>
<p>What equation should be used. Must be provided if x is not a result of tsd()</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_l">l</code></td>
<td>
<p>Sex ratio limits to define TRT are l and 1-l. If NULL, TRT is not estimated.</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>If a result of tsd() is provided, use replicate.CI replicates from the hessian matrix to estimate CI</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_temperatures">temperatures</code></td>
<td>
<p>If provided returns the sex ratio and its quantiles for each temperature</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_durations">durations</code></td>
<td>
<p>If provided returns the sex ratio and its quantiles for each duration</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_sd.temperatures">SD.temperatures</code></td>
<td>
<p>SD of temperatures</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_sd.durations">SD.durations</code></td>
<td>
<p>SD of durations</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_probs">probs</code></td>
<td>
<p>Probabilities used to estimate quantiles</p>
</td></tr>
<tr><td><code id="P_TRT_+3A_warn">warn</code></td>
<td>
<p>Do the warnings must be shown ? TRUE or FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>P_TRT estimates the transitional range of temperatures based on a set of parameters
</p>


<h3>Value</h3>

<p>A list with a P_TRT object containing a matrix with lower and higher bounds for TRT, TRT and P and a P_TRT_quantiles object with quantiles for each and a sexratio_quantiles object
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Girondot, M. 1999. Statistical description of temperature-dependent sex determination using maximum likelihood. Evolutionary Ecology Research, 1, 479-486.
</p>
<p>Godfrey, M.H., Delmas, V., Girondot, M., 2003. Assessment of patterns of temperature-dependent sex determination using maximum likelihood model selection. Ecoscience 10, 265-272.
</p>
<p>Hulin, V., Delmas, V., Girondot, M., Godfrey, M.H., Guillon, J.-M., 2009. Temperature-dependent sex determination and global change: are some species at greater risk? Oecologia 160, 493-506.
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("embryogrowth")
CC_AtlanticSW &lt;- subset(DatabaseTSD, RMU=="Atlantic, SW" &amp; 
                          Species=="Caretta caretta" &amp; Sexed!=0)
tsdL &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="logistic"))
P_TRT(tsdL)
P_TRT(tsdL, replicate.CI=1000)
P_TRT(tsdL, replicate.CI=1000, temperatures=20:35)
P_TRT_out &lt;- P_TRT(tsdL, replicate.CI=1000, temperatures=c(T1=20, T2=35))
attributes(P_TRT_out$sexratio_quantiles)$temperatures
P_TRT(tsdL$par, equation="logistic")
pMCMC &lt;- tsd_MHmcmc_p(tsdL, accept=TRUE)
# Take care, it can be very long
result_mcmc_tsd &lt;- tsd_MHmcmc(result=tsdL, 
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=FALSE, adaptive=TRUE)
P_TRT(result_mcmc_tsd, equation="logistic")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_transition'>Show fonction used for transition</h2><span id='topic+plot_transition'></span>

<h3>Description</h3>

<p>Plot the transition function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_transition(result = NULL, parameters = NULL, sizes = c(0, 40), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_transition_+3A_result">result</code></td>
<td>
<p>A result object</p>
</td></tr>
<tr><td><code id="plot_transition_+3A_parameters">parameters</code></td>
<td>
<p>Set of parameters. If both result and parameters are indicated, parameters have priority.</p>
</td></tr>
<tr><td><code id="plot_transition_+3A_sizes">sizes</code></td>
<td>
<p>The range of possible sizes</p>
</td></tr>
<tr><td><code id="plot_transition_+3A_...">...</code></td>
<td>
<p>Parameters for plot() such as main= or ylim=</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot_transition show fonction used for transition
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
data(resultNest_4p_SSM)
# Get a set of parameters without transition
x1 &lt;- resultNest_4p_SSM$par
# Generate a set of parameters with transition
x2 &lt;- switch.transition(x1)
x2 &lt;- x2[names(x2)!="transition_P"]
x2["transition_S"] &lt;- 4
pfixed &lt;- c(rK=2.093313, transition_P=20)
resultNest_4p_transition &lt;- searchR(parameters=x2, fixed.parameters=pfixed, 
temperatures=formated, integral=integral.Gompertz, M0=1.7, 
hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_transition)
# show the model for smallest size
plotR(resultNest_4p_transition, ylim=c(0,0.3))
# show the model for larger sizes
plotR(resultNest_4p_transition, set.par=2, ylim=c(0,0.3))
# plot model for both together
plotR(resultNest_4p_transition, set.par=c(1,2), ylim=c(0,0.3), 
       col=c("red", "black"), legend=list("Initial", "End"))
plot_transition(result=resultNest_4p_transition, las=1, sizes=c(0,40))
compare_AIC(one.model=list(resultNest_4p_SSM), two.models=list(resultNest_4p_transition))
# Note that the model with fitted transition_P is trivial. Embryos grow fast until  
# they reach hatchling size and then growth rate becomes null!

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.HatchingSuccess'>Plot results of HatchingSuccess.fit() that best describe hatching success</h2><span id='topic+plot.HatchingSuccess'></span>

<h3>Description</h3>

<p>Plot the estimates that best describe hatching success.<br />
If replicates is 0, it returns only the fitted model.<br />
If replicates is null and resultmcmc is not null, it will use all the mcmc data.<br />
if replicates is lower than the number of iterations in resultmcmc, it will use sequence of data regularly thined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HatchingSuccess'
plot(
  x,
  xlim = c(20, 40),
  ylim = c(0, 1),
  xlab = "Constant incubation temperatures",
  ylab = "Hatching success",
  bty = "n",
  las = 1,
  col.observations = "red",
  pch.observations = 19,
  cex.observations = 1,
  show.CI.observations = TRUE,
  col.ML = "black",
  lty.ML = 1,
  lwd.ML = 1,
  col.median = "black",
  lty.median = 2,
  lwd.median = 1,
  col.CI = "black",
  lty.CI = 3,
  lwd.CI = 1,
  replicates = NULL,
  resultmcmc = NULL,
  polygon = TRUE,
  color.polygon = rgb(red = 0.8, green = 0, blue = 0, alpha = 0.1),
  what = c("observations", "ML", "CI"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.HatchingSuccess_+3A_x">x</code></td>
<td>
<p>A result file generated by HatchingSuccess.fit()</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_xlim">xlim</code></td>
<td>
<p>Range of temperatures</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_ylim">ylim</code></td>
<td>
<p>Hatching success range for y-axis</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_xlab">xlab</code></td>
<td>
<p>x label</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_ylab">ylab</code></td>
<td>
<p>y label</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_bty">bty</code></td>
<td>
<p>bty graphival parameter</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_las">las</code></td>
<td>
<p>las graphical parameter</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_col.observations">col.observations</code></td>
<td>
<p>Color of observations</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_pch.observations">pch.observations</code></td>
<td>
<p>Character used for observation (no observations if NULL)</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_cex.observations">cex.observations</code></td>
<td>
<p>Size of characters for observations</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_show.ci.observations">show.CI.observations</code></td>
<td>
<p>Should the confidence interval of the observations be shown ?</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_col.ml">col.ML</code></td>
<td>
<p>Color of the maximum likelihood model</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lty.ml">lty.ML</code></td>
<td>
<p>Line type of the maximum likelihood model (no line if NULL)</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lwd.ml">lwd.ML</code></td>
<td>
<p>Line width of the maximum likelihood model</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_col.median">col.median</code></td>
<td>
<p>Color of the median model</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lty.median">lty.median</code></td>
<td>
<p>Line type of the median model (no line if NULL)</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lwd.median">lwd.median</code></td>
<td>
<p>Line width of the mean model</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_col.ci">col.CI</code></td>
<td>
<p>Color of the 95% confidence interval lines</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lty.ci">lty.CI</code></td>
<td>
<p>Line type of the 95% confidence interval lines (no line if NULL)</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_lwd.ci">lwd.CI</code></td>
<td>
<p>Line width of the 95% confidence interval lines</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates to estimate confidence interval</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>Results obtained using HatchingSuccess.MHmcmc()</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_polygon">polygon</code></td>
<td>
<p>If TRUE, confidence interval is shown as a polygon</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_color.polygon">color.polygon</code></td>
<td>
<p>The color used for polygon</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_what">what</code></td>
<td>
<p>Indicate what to plot: &quot;observations&quot;, &quot;ML&quot;, &quot;CI&quot;</p>
</td></tr>
<tr><td><code id="plot.HatchingSuccess_+3A_...">...</code></td>
<td>
<p>Parameters for plot()</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.HatchingSuccess plot result of HatchingSuccess.fit() or HatchingSuccess.MHmcmc() that best describe hatching success
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+predict.HatchingSuccess">predict.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(par=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

plot(g, replicates=0)
plot(g, replicates=10000)

pMCMC &lt;- HatchingSuccess.MHmcmc_p(g, accept=TRUE)
mcmc &lt;- HatchingSuccess.MHmcmc(result=g, parameters = pMCMC, 
                                adaptive=TRUE, n.iter=100000, trace=1000)
plot(g, resultmcmc=mcmc)
plot(g, resultmcmc=mcmc, pch.observations=NULL, lty.mean=NULL)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.NestsResult'>Plot the embryo growth</h2><span id='topic+plot.NestsResult'></span>

<h3>Description</h3>

<p>Plot the embryo growth from one or several nests.<br />
The embryo.stages is a named vector with relative size as compared to final size at the beginning of the stage. Names are the stages.<br />
For example for SCL in Caretta caretta:<br />
embryo.stages=structure(c(8.4, 9.4, 13.6, 13.8, 18.9, 23.5, 32.2, 35.2, 35.5, 38.5)/39.33), <br />
.Names = c(&quot;21&quot;, &quot;22&quot;, &quot;23&quot;, &quot;24&quot;, &quot;25&quot;, &quot;26&quot;, &quot;27&quot;, &quot;28&quot;, &quot;29&quot;, &quot;30&quot;, &quot;31&quot;))<br />
indicates that the stages 21 begins at the relative size of 8.4/39.33.<br />
Series can be indicated as the name of the series, its number or succesion of TRUE or FALSE. &quot;all&quot; indicates that all series must be printed.<br />
show.fioritures parameter does not affect show.hatchling.metric option.<br />
Note: Four species have predefined embryo stages. embryo.stages parameter can take the values:<br />
</p>

<ul>
<li> <p><code>Caretta caretta.SCL</code>
</p>
</li>
<li> <p><code>Chelonia mydas.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.mass</code>
</p>
</li>
<li> <p><code>Podocnemis expansa.SCL</code>
</p>
</li>
<li> <p><code>Lepidochelys olivacea.SCL</code>
</p>
</li>
<li> <p><code>Generic.ProportionDevelopment</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'NestsResult'
plot(
  x,
  ...,
  parameters = NULL,
  fixed.parameters = NULL,
  resultmcmc = NULL,
  hessian = NULL,
  SE = NULL,
  temperatures = NULL,
  integral = NULL,
  derivate = NULL,
  hatchling.metric = NULL,
  stop.at.hatchling.metric = FALSE,
  M0 = NULL,
  weight = NULL,
  series = "all",
  TSP.borders = NULL,
  embryo.stages = NULL,
  STRN = NULL,
  TSP.begin = 0,
  TSP.end = 0.5,
  replicate.CI = 100,
  metric.end.incubation = "observed",
  col.stages = "blue",
  col.PT = "red",
  col.TSP = "gray",
  col.temperatures = "green",
  col.S = "black",
  lty.temperatures = 1,
  lwd.temperatures = 2,
  ylimT = NULL,
  ylimS = NULL,
  xlim = NULL,
  show.stages = TRUE,
  show.TSP = TRUE,
  show.third = TRUE,
  GTRN.CI = NULL,
  show.metric = TRUE,
  show.fioritures = TRUE,
  show.temperatures = TRUE,
  show.PT = TRUE,
  PT = c(mean = NA, SE = NA),
  show.hatchling.metric = TRUE,
  add = FALSE,
  lab.third = "2nd third of incubation",
  at.lab.third = 10,
  lab.PT = "PT",
  lab.stages = "Stages",
  at.lab.TSP = 8,
  lab.TSP = "TSP",
  mar = c(4, 5, 4, 5) + 0.3,
  xlab = "Days of incubation",
  ylabT = expression("Temperature in " * degree * "C"),
  ylabS = "Embryo metric",
  progress = TRUE,
  parallel = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.NestsResult_+3A_x">x</code></td>
<td>
<p>A result file generated by searchR</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_...">...</code></td>
<td>
<p>Parameters for plot()</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters if result is not provided.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Another set of parameters if result is not provided.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A mcmc result. Will be used rather than SE if provided.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_hessian">hessian</code></td>
<td>
<p>An Hessian matrix.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_se">SE</code></td>
<td>
<p>Standard error for each parameter if result is not provided, or replace the one in NestsResult. Use SE=NA to remove SE from NestResult</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_temperatures">temperatures</code></td>
<td>
<p>Timeseries of temperatures formatted using formatNests(). Will replace the one in result.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_integral">integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_derivate">derivate</code></td>
<td>
<p>Function used to fit embryo growth: dydt.Gompertz, dydt.exponential or dydt.linear. It will replace the one in NestsResult.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>Mean and SD of size of hatchlings</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_stop.at.hatchling.metric">stop.at.hatchling.metric</code></td>
<td>
<p>TRUE or FALSE. If TRUE, the model stops when proxy of size reached the mean hatchling.metric size.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_m0">M0</code></td>
<td>
<p>Measure of hatchling size proxi at laying date</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_weight">weight</code></td>
<td>
<p>Weights of the different nests to estimate likelihood</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_series">series</code></td>
<td>
<p>The name or number of the series to be displayed. Only one series can be displayed at a time.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_tsp.borders">TSP.borders</code></td>
<td>
<p>The limits of TSP in stages. See embryo.stages parameter.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_embryo.stages">embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP borders. See note.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_strn">STRN</code></td>
<td>
<p>An object obtained from STRN()</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_tsp.begin">TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_tsp.end">TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI. If 1, no CI is estimated.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_metric.end.incubation">metric.end.incubation</code></td>
<td>
<p>The expected metric at the end of incubation. Used to calibrate TSP size. If NULL, take the maximum Mean of the hatchling.metric parameter. If NA, use the actual final size. Can be a vector and is recycled if necessary.</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_col.stages">col.stages</code></td>
<td>
<p>The color of the stages</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_col.pt">col.PT</code></td>
<td>
<p>The color of the pivotal temperature</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_col.tsp">col.TSP</code></td>
<td>
<p>The color of the TSP</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_col.temperatures">col.temperatures</code></td>
<td>
<p>The color of the temperatures</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_col.s">col.S</code></td>
<td>
<p>The color of the size or mass. Can be a vector (useful when series=&quot;all&quot; option).</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lty.temperatures">lty.temperatures</code></td>
<td>
<p>Type of line for temperatures</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lwd.temperatures">lwd.temperatures</code></td>
<td>
<p>Width of line for temperatures</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_ylimt">ylimT</code></td>
<td>
<p>Range of temperatures to be displayed</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_ylims">ylimS</code></td>
<td>
<p>Range of size to be displayed</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_xlim">xlim</code></td>
<td>
<p>Range of incubation days to be displayed</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.stages">show.stages</code></td>
<td>
<p>TRUE or FALSE, does the embryo stages should be displayed?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.tsp">show.TSP</code></td>
<td>
<p>TRUE or FALSE, does the TSP boders should be displayed?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.third">show.third</code></td>
<td>
<p>TRUE or FALSE, does the first and second third boders should be displayed?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_gtrn.ci">GTRN.CI</code></td>
<td>
<p>How to estimate CI; can be NULL, &quot;SE&quot;, &quot;MCMC&quot;, or &quot;Hessian&quot;</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.metric">show.metric</code></td>
<td>
<p>TRUE or FALSE, does the plot of embryo metric is shown?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.fioritures">show.fioritures</code></td>
<td>
<p>If FALSE, set show.PT, show.temperatures, show.stages, show.TSP, show.third to FALSE, GTRN.CI to NULL</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.temperatures">show.temperatures</code></td>
<td>
<p>TRUE or FALSE, does the temperatures should be displayed?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.pt">show.PT</code></td>
<td>
<p>TRUE or FALSE, does the pivotal temperature should be displayed?</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_pt">PT</code></td>
<td>
<p>Value for pivotal temperature, mean and SE</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_show.hatchling.metric">show.hatchling.metric</code></td>
<td>
<p>TRUE or FALSE, does the hatchling size should be displayed</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_add">add</code></td>
<td>
<p>If TRUE, all the curves are shown on the same graph</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lab.third">lab.third</code></td>
<td>
<p>Label for 2nd third of incubation</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_at.lab.third">at.lab.third</code></td>
<td>
<p>Position of Label for 2nd third of incubation [default=10]; y-lim is scaled by at.lab.third</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lab.pt">lab.PT</code></td>
<td>
<p>Label for Pivotal Temperature</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lab.stages">lab.stages</code></td>
<td>
<p>Label for Stages</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_at.lab.tsp">at.lab.TSP</code></td>
<td>
<p>Position of Label for TSP [default=8]; y-lim is scaled by at.lab.third</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_lab.tsp">lab.TSP</code></td>
<td>
<p>Label for the TSP</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_mar">mar</code></td>
<td>
<p>Parameter mar used for plot</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_xlab">xlab</code></td>
<td>
<p>Label for axis</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_ylabt">ylabT</code></td>
<td>
<p>Label for temperature axis</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_ylabs">ylabS</code></td>
<td>
<p>Label for size axis</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_progress">progress</code></td>
<td>
<p>If FALSE, the progress bar is not shown (useful for use with sweave or knitr)</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_parallel">parallel</code></td>
<td>
<p>Should parallel computing be used ? TRUE or FALSE</p>
</td></tr>
<tr><td><code id="plot.NestsResult_+3A_nestsresult">NestsResult</code></td>
<td>
<p>A NestsResult file generated by searchR</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.NestsResult Plot the embryo growth
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1,  
	    SE=c(DHA=1.396525, DHH=4.101217, T12H=0.04330405, Rho25=1.00479), 
	    GTRN.CI = "SE", replicate.CI = 100, 
	    embryo.stages="Caretta caretta.SCL")
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1, 
	    GTRN.CI = "Hessian", replicate.CI = 100, 
	    embryo.stages="Caretta caretta.SCL")
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1,  
     resultmcmc = resultNest_mcmc_4p_SSM, 
	    GTRN.CI = "MCMC", replicate.CI = 100, 
     embryo.stages="Caretta caretta.SCL")
# to plot all the nest at the same time, use
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45),  
	    series="all", show.fioritures=FALSE, add=TRUE, 
	    embryo.stages="Caretta caretta.SCL")
# to use color different for series
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), add=TRUE, 
	    series="all", show.fioritures=FALSE, col.S=c(rep("black", 5), rep("red", 6)), 
	    embryo.stages="Caretta caretta.SCL")
	    
# to plot all the temperature profiles

par(mar=c(4, 4, 1, 1))
plot(resultNest_4p_SSM$data[[1]][, 1]/60/24,
     resultNest_4p_SSM$data[[1]][, 2], bty="n", 
     las=1, xlab="Days of incubation", 
     ylab=expression("Temperatures in "*degree*"C"), 
     type="l", xlim=c(0,70),ylim=c(20, 35))
     
     for (i in 2:21) {
          par(new=TRUE)
          plot(resultNest_4p_SSM$data[[i]][, 1]/60/24,
          resultNest_4p_SSM$data[[i]][, 2], bty="n", 
          las=1, xlab="", ylab="", type="l", xlim=c(0,70),
          ylim=c(20, 35), axes = FALSE)
     }

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.tsd'>Plot results of tsd() that best describe temperature-dependent sex determination</h2><span id='topic+plot.tsd'></span>

<h3>Description</h3>

<p>Plot the estimates that best describe temperature-dependent sex determination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsd'
plot(
  x,
  ...,
  show.observations = TRUE,
  show.model = TRUE,
  males.freq = TRUE,
  show.PTRT = TRUE,
  las.x = 1,
  las.y = 1,
  lab.PT = paste("Pivotal ", x$type),
  resultmcmc = NULL,
  chain = 1,
  l = 0.05,
  replicate.CI = 10000,
  range.CI = 0.95,
  mar = c(4, 4, 4, 1) + 0.4,
  temperatures.plot = seq(from = 25, to = 35, by = 0.1),
  durations.plot = seq(from = 40, to = 70, by = 0.1),
  lab.TRT = paste0("Transitional range of ", x$type, "s l=", x$l * 100, "%"),
  col.TRT = "gray",
  col.TRT.CI = rgb(0.8, 0.8, 0.8, 0.5),
  col.PT.CI = rgb(0.8, 0.8, 0.8, 0.5),
  show.CI = TRUE,
  warn = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.tsd_+3A_x">x</code></td>
<td>
<p>A result file generated by tsd()</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_...">...</code></td>
<td>
<p>Parameters for plot()</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_show.observations">show.observations</code></td>
<td>
<p>Should the observations be shown</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_show.model">show.model</code></td>
<td>
<p>Should the model be shown</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_males.freq">males.freq</code></td>
<td>
<p>Should the graph uses males relative frequency [TRUE] or females [FALSE]</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_show.ptrt">show.PTRT</code></td>
<td>
<p>Should the P and TRT information be shown</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_las.x">las.x</code></td>
<td>
<p>las parameter for x axis</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_las.y">las.y</code></td>
<td>
<p>las parameter for y axis</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_lab.pt">lab.PT</code></td>
<td>
<p>Label to describe pivotal temperature</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A result of tsd_MHmcmc()</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_chain">chain</code></td>
<td>
<p>What chain to be used is resultmcmc is provided</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_l">l</code></td>
<td>
<p>Sex ratio limits to define TRT are l and 1-l</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>replicate.CI replicates from the hessian matrix to estimate CI</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_range.ci">range.CI</code></td>
<td>
<p>The range of confidence interval for estimation, default=0.95</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_mar">mar</code></td>
<td>
<p>The par(&quot;mar&quot;) parameter</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_temperatures.plot">temperatures.plot</code></td>
<td>
<p>Temperatures used for showing curves of sex ratio</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_durations.plot">durations.plot</code></td>
<td>
<p>Durations used for showing curves of sex ratio</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_lab.trt">lab.TRT</code></td>
<td>
<p>Label to describe transitional range of temperature</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_col.trt">col.TRT</code></td>
<td>
<p>The color of TRT</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_col.trt.ci">col.TRT.CI</code></td>
<td>
<p>The color of CI of TRT based on range.CI</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_col.pt.ci">col.PT.CI</code></td>
<td>
<p>The color of CI of PT based on range.CI</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_show.ci">show.CI</code></td>
<td>
<p>Do the CI for the curve should be shown</p>
</td></tr>
<tr><td><code id="plot.tsd_+3A_warn">warn</code></td>
<td>
<p>Do the warnings must be shown ? TRUE or FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plot.tsd plot result of tsd() that best describe temperature-dependent sex determination
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>References</h3>

<p>Girondot, M. 1999. Statistical description of temperature-dependent sex determination using maximum likelihood. Evolutionary Ecology Research, 1, 479-486.
</p>
<p>Godfrey, M.H., Delmas, V., Girondot, M., 2003. Assessment of patterns of temperature-dependent sex determination using maximum likelihood model selection. Ecoscience 10, 265-272.
</p>
<p>Hulin, V., Delmas, V., Girondot, M., Godfrey, M.H., Guillon, J.-M., 2009. Temperature-dependent sex determination and global change: are some species at greater risk? Oecologia 160, 493-506.
</p>
<p>Girondot M., Submited. On the concept of embryological thermosensitive period for sex determination in reptiles.
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
CC_AtlanticSW &lt;- subset(DatabaseTSD, RMU=="Atlantic, SW" &amp; 
                          Species=="Caretta caretta" &amp; (!is.na(Sexed) &amp; Sexed!=0))
tsdL &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="logistic"))
plot(tsdL)

## End(Not run)
</code></pre>

<hr>
<h2 id='plotR'>Plot the fitted growth rate dependent on temperature and its density</h2><span id='topic+plotR'></span>

<h3>Description</h3>

<p>Show the fitted growth rate dependent on temperature and its density.<br />
The curve &quot;ML quantiles&quot; is based on delta method.<br />
The curve &quot;ML&quot; just shows the fitted model.<br />
The curve &quot;MCMC quantiles&quot; uses the mcmc replicates to build the quantiles.<br />
The curve &quot;MCMC mean-SD&quot; uses the mcmc replicates to build a symetric credibility interval.<br />
The parameter curve is case insensitive. If only parameters is given, curve must be ML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotR(
  result = NULL,
  resultmcmc = NULL,
  chain = 1,
  parameters = NULL,
  fixed.parameters = NULL,
  temperatures = NULL,
  curve = "ML quantiles",
  set.par = 1,
  ylim = c(0, 5),
  xlim = c(20, 35),
  xlimR = NULL,
  hessian = NULL,
  replicate.CI = 1000,
  cex.lab = par("cex"),
  cex.axis = par("cex"),
  scaleY = "auto",
  lty = 1,
  ltyCI = 3,
  lwd = 1,
  lwdCI = 1,
  col = "black",
  col.polygon = "grey",
  polygon = FALSE,
  probs = 0.95,
  colramp = colorRampPalette(c("white", rgb(red = 0.5, green = 0.5, blue = 0.5))),
  bandwidth = c(0.1, 0.01),
  pch = "",
  main = "",
  xlab = expression("Temperature in " * degree * "C"),
  ylab = NULL,
  yaxt = "s",
  bty = "n",
  las = 1,
  by.temperature = 0.1,
  show.density = FALSE,
  new = TRUE,
  show.hist = FALSE,
  ylimH = NULL,
  atH = NULL,
  ylabH = "Temperature density",
  breaks = "Sturges",
  log.hist = FALSE,
  mar = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotR_+3A_result">result</code></td>
<td>
<p>A result object or a list of result objects</p>
</td></tr>
<tr><td><code id="plotR_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A result object from GRTN_MHmcmc() function</p>
</td></tr>
<tr><td><code id="plotR_+3A_chain">chain</code></td>
<td>
<p>The chain to use in resultmcmc</p>
</td></tr>
<tr><td><code id="plotR_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters - Has the priority over result</p>
</td></tr>
<tr><td><code id="plotR_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of fixed parameters</p>
</td></tr>
<tr><td><code id="plotR_+3A_temperatures">temperatures</code></td>
<td>
<p>A set of temperatures - Has the priority over result</p>
</td></tr>
<tr><td><code id="plotR_+3A_curve">curve</code></td>
<td>
<p>What curve to show: &quot;MCMC quantiles&quot; or &quot;MCMC mean-SD&quot; based on mcmc or &quot;ML&quot; or &quot;ML quantiles&quot; or &quot;ML mean-SE&quot; for maximum-likelihood. Or &quot;none&quot;</p>
</td></tr>
<tr><td><code id="plotR_+3A_set.par">set.par</code></td>
<td>
<p>1 or 2 to designate with set of parameters to show</p>
</td></tr>
<tr><td><code id="plotR_+3A_ylim">ylim</code></td>
<td>
<p>Range of values for y-axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_xlim">xlim</code></td>
<td>
<p>Range of values for x-axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_xlimr">xlimR</code></td>
<td>
<p>description to show the curve</p>
</td></tr>
<tr><td><code id="plotR_+3A_hessian">hessian</code></td>
<td>
<p>An hessian matrix</p>
</td></tr>
<tr><td><code id="plotR_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate confidence interval with Hessian if delta method failed</p>
</td></tr>
<tr><td><code id="plotR_+3A_cex.lab">cex.lab</code></td>
<td>
<p>cex value for axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_cex.axis">cex.axis</code></td>
<td>
<p>cex value for axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_scaley">scaleY</code></td>
<td>
<p>Scaling factor for y axis or &quot;auto&quot;</p>
</td></tr>
<tr><td><code id="plotR_+3A_lty">lty</code></td>
<td>
<p>The type of lines</p>
</td></tr>
<tr><td><code id="plotR_+3A_ltyci">ltyCI</code></td>
<td>
<p>The type of lines</p>
</td></tr>
<tr><td><code id="plotR_+3A_lwd">lwd</code></td>
<td>
<p>The type of lines</p>
</td></tr>
<tr><td><code id="plotR_+3A_lwdci">lwdCI</code></td>
<td>
<p>The type of lines</p>
</td></tr>
<tr><td><code id="plotR_+3A_col">col</code></td>
<td>
<p>The color of the lines</p>
</td></tr>
<tr><td><code id="plotR_+3A_col.polygon">col.polygon</code></td>
<td>
<p>The color of the polygon</p>
</td></tr>
<tr><td><code id="plotR_+3A_polygon">polygon</code></td>
<td>
<p>If TRUE, confidence interval is shown as a polygon with color</p>
</td></tr>
<tr><td><code id="plotR_+3A_probs">probs</code></td>
<td>
<p>Confidence or credibility interval to show</p>
</td></tr>
<tr><td><code id="plotR_+3A_colramp">colramp</code></td>
<td>
<p>Ramp function accepting an integer as an argument and returning n colors.</p>
</td></tr>
<tr><td><code id="plotR_+3A_bandwidth">bandwidth</code></td>
<td>
<p>numeric vector (length 1 or 2) of smoothing bandwidth(s). If missing, a more or less useful default is used. bandwidth is subsequently passed to function bkde2D.</p>
</td></tr>
<tr><td><code id="plotR_+3A_pch">pch</code></td>
<td>
<p>Character for outlayers</p>
</td></tr>
<tr><td><code id="plotR_+3A_main">main</code></td>
<td>
<p>Title of the graph</p>
</td></tr>
<tr><td><code id="plotR_+3A_xlab">xlab</code></td>
<td>
<p>Label for x axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_ylab">ylab</code></td>
<td>
<p>Label for y axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_yaxt">yaxt</code></td>
<td>
<p>The yaxt parameter of y-axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_bty">bty</code></td>
<td>
<p>Box around the pot</p>
</td></tr>
<tr><td><code id="plotR_+3A_las">las</code></td>
<td>
<p>Orientation for labels in y axis</p>
</td></tr>
<tr><td><code id="plotR_+3A_by.temperature">by.temperature</code></td>
<td>
<p>Step to built the temperatures</p>
</td></tr>
<tr><td><code id="plotR_+3A_show.density">show.density</code></td>
<td>
<p>TRUE or FALSE for use with Hessian or MCMC</p>
</td></tr>
<tr><td><code id="plotR_+3A_new">new</code></td>
<td>
<p>Should the graphics be a new one (TRUE) or superimposed to a previous one (FALSE)</p>
</td></tr>
<tr><td><code id="plotR_+3A_show.hist">show.hist</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
<tr><td><code id="plotR_+3A_ylimh">ylimH</code></td>
<td>
<p>Scale of histogram using ylimH=c(min, max)</p>
</td></tr>
<tr><td><code id="plotR_+3A_ath">atH</code></td>
<td>
<p>Position of ticks for scale of histogram</p>
</td></tr>
<tr><td><code id="plotR_+3A_ylabh">ylabH</code></td>
<td>
<p>Label for histogram scale</p>
</td></tr>
<tr><td><code id="plotR_+3A_breaks">breaks</code></td>
<td>
<p>See ?hist</p>
</td></tr>
<tr><td><code id="plotR_+3A_log.hist">log.hist</code></td>
<td>
<p>SHould the y scale for hist is log ?</p>
</td></tr>
<tr><td><code id="plotR_+3A_mar">mar</code></td>
<td>
<p>The value of par(&quot;mar&quot;). If null, it will use default depending on show.dist. If NA, does not change par(&quot;mar&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>plotR plots the fitted growth rate dependent on temperature and the density of the mcmc
</p>


<h3>Value</h3>

<p>A list with the value of scaleY to be used with other plotR function and the plot data in xy list element
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
# Note that the confidence interval is not the same for mcmc and ml quantiles
plotR(result = resultNest_4p_SSM, 
             resultmcmc=resultNest_mcmc_4p_SSM, 
             curve = "MCMC quantiles", ylim=c(0, 8))
plotR(resultNest_4p_SSM, curve="ML quantiles", ylim=c(0, 6))
#################
plotR(resultmcmc=resultNest_mcmc_4p_SSM, ylim=c(0, 10), 
             curve = "MCMC quantiles", show.density=TRUE)
#################
plotR(resultmcmc=resultNest_mcmc_4p_SSM, 
             curve = "MCMC quantiles", polygon=TRUE, ylim=c(0, 10))
#################
plotR(resultmcmc=resultNest_mcmc_6p_SSM, ylim=c(0,8), 
      curve = "MCMC quantiles", polygon=TRUE, col.polygon = rgb(0, 1, 0, 1))
plotR(resultmcmc=resultNest_mcmc_4p_SSM, ylim=c(0,8), 
       curve = "MCMC quantiles", polygon=TRUE, col.polygon = rgb(1, 0, 0, 0.5), 
       new=FALSE)
legend("topleft", legend=c("SSM 4 parameters", "SSM 6 parameters"), 
        pch=c(15, 15), col=c(rgb(1, 0, 0, 0.5), rgb(0, 1, 0, 1)))
#################
sy &lt;- plotR(resultmcmc=resultNest_mcmc_4p_SSM, ylim=c(0, 8), 
             curve = "MCMC quantiles", show.density=FALSE)
plotR(resultmcmc=resultNest_mcmc_6p_SSM, col="red", ylim=c(0, 8), 
             curve = "MCMC quantiles", show.density=FALSE, 
             new=FALSE, scaleY=sy$scaleY)
#################
sy &lt;- plotR(result=resultNest_6p_SSM, curve="none", 
             scaleY=1E5, 
             ylim=c(0, 8), 
             show.hist = TRUE, new = TRUE, mar=c(4, 4, 1, 4))
#################
plotR(result=resultNest_6p_SSM, curve="ML", 
             ylim=c(0, 8), 
             show.hist = TRUE, ylimH=c(0,1), atH=c(0, 0.1, 0.2))
################
plotR(result = resultNest_4p_SSM, ylim=c(0, 8), 
             resultmcmc=resultNest_mcmc_4p_SSM, 
             show.density = TRUE, 
             curve = "MCMC quantiles")
#################
plotR(resultmcmc=resultNest_mcmc_4p_SSM, ylim=c(0, 8), 
             curve = "MCMC quantiles", show.density=TRUE, scaleY=1E5)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.HatchingSuccess'>Return prediction based on a model fitted with HatchingSuccess.fit()</h2><span id='topic+predict.HatchingSuccess'></span>

<h3>Description</h3>

<p>Set of functions to study the hatching success.<br />
If replicates is 0, it returns only the fitted model.<br />
If replicates is null and resultmcmc is not null, it will use all the mcmc data.<br />
if replicates is lower than the number of iterations in resultmcmc, it will use sequence of data regularly thined.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'HatchingSuccess'
predict(
  object,
  ...,
  temperature = NULL,
  probs = c(0.025, 0.5, 0.975),
  replicates = NULL,
  resultmcmc = NULL,
  chain = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.HatchingSuccess_+3A_object">object</code></td>
<td>
<p>The return of a fit done with HatchingSuccess.fit().</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_temperature">temperature</code></td>
<td>
<p>A vector of temperatures.</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_probs">probs</code></td>
<td>
<p>Quantiles.</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates to estimate the confidence interval.</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>Results obtained using HatchingSuccess.MHmcmc()</p>
</td></tr>
<tr><td><code id="predict.HatchingSuccess_+3A_chain">chain</code></td>
<td>
<p>Chain to use in resultmcmc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>predict.HatchingSuccess returns prediction based on a model fitted with HatchingSuccessfit()
</p>


<h3>Value</h3>

<p>Return a matrix with prediction based on a model fitted with HatchingSuccess.fit()
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Hatching success: 
<code><a href="#topic+HatchingSuccess.MHmcmc_p">HatchingSuccess.MHmcmc_p</a>()</code>,
<code><a href="#topic+HatchingSuccess.MHmcmc">HatchingSuccess.MHmcmc</a>()</code>,
<code><a href="#topic+HatchingSuccess.fit">HatchingSuccess.fit</a>()</code>,
<code><a href="#topic+HatchingSuccess.lnL">HatchingSuccess.lnL</a>()</code>,
<code><a href="#topic+HatchingSuccess.model">HatchingSuccess.model</a>()</code>,
<code><a href="#topic+logLik.HatchingSuccess">logLik.HatchingSuccess</a>()</code>,
<code><a href="#topic+nobs.HatchingSuccess">nobs.HatchingSuccess</a>()</code>,
<code><a href="#topic+plot.HatchingSuccess">plot.HatchingSuccess</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
totalIncubation_Cc &lt;- subset(DatabaseTSD, 
                             Species=="Caretta caretta" &amp; 
                               Note != "Sinusoidal pattern" &amp; 
                               !is.na(Total) &amp; Total != 0)

par &lt;- c(S.low=0.5, S.high=0.3, 
         P.low=25, deltaP=10, MaxHS=0.8)
         
HatchingSuccess.lnL(x=par, data=totalIncubation_Cc)

g &lt;- HatchingSuccess.fit(par=par, data=totalIncubation_Cc)

HatchingSuccess.lnL(par=g$par, data=totalIncubation_Cc)

plot(g)

## End(Not run)
</code></pre>

<hr>
<h2 id='predict.tsd'>Estimate sex ratio according to constant incubation temperature</h2><span id='topic+predict.tsd'></span>

<h3>Description</h3>

<p>Estimate sex ratio according to constant incubation temperature<br />
The data.frame has the temperatures or durations in columns and the quantiles in rows.<br />
Note that incubation duration is a very bad proxy for sex ratio. See Georges, 
A., Limpus, C. J. &amp; Stoutjesdijk, R. 1994. Hatchling sex in the marine turtle 
_Caretta caretta_ is determined by proportion of development at a temperature, 
not daily duration of exposure. J. Exp. Zool., 270, 432-444.<br />
If replicate.CI is 0 or NULL, point estimate for maximum likelihood is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsd'
predict(
  object,
  temperatures = NULL,
  durations = NULL,
  SD.temperatures = NULL,
  SD.durations = NULL,
  resultmcmc = NULL,
  chain = 1,
  replicate.CI = 10000,
  probs = c(0.025, 0.5, 0.975),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.tsd_+3A_object">object</code></td>
<td>
<p>A result file generated by tsd</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_temperatures">temperatures</code></td>
<td>
<p>A vector of temperatures</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_durations">durations</code></td>
<td>
<p>A vector of durations</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_sd.temperatures">SD.temperatures</code></td>
<td>
<p>SD of temperatures</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_sd.durations">SD.durations</code></td>
<td>
<p>SD of durations</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_resultmcmc">resultmcmc</code></td>
<td>
<p>A result of tsd_MHmcmc()</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_chain">chain</code></td>
<td>
<p>What chain to be used is resultmcmc is provided</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate CI</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_probs">probs</code></td>
<td>
<p>The quantiles to be returned, default=c(0.025, 0.5, 0.975)</p>
</td></tr>
<tr><td><code id="predict.tsd_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>predict.tsd Estimate sex ratio according to constant incubation temperature
</p>


<h3>Value</h3>

<p>A data.frame with informations about sex-ratio
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
m &lt;- c(10, 14, 7, 4, 3, 0, 0)
f &lt;- c(0, 1, 2, 4, 15, 10, 13)
t &lt;- c(25, 26, 27, 28, 29, 30, 31)
result &lt;- tsd(males=m, females=f, temperatures=t)
plot(result)
predict(result, temperatures=c(25, 31), replicate.CI = 10000)
predict(result, temperatures=c(25, 31), SD.temperatures = c(1, 2), replicate.CI = 10000)
d &lt;- c(72, 70, 65, 63, 62, 60, 59)
result &lt;- tsd(males=m, females=f, durations=d)
predict(result, durations=c(67, 68), replicate.CI = 10000)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_3p_Dallwitz'>Fit using the nest database</h2><span id='topic+resultNest_3p_Dallwitz'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_3p_Dallwitz
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the embryonic thermosensitive period for sex determination using an embryo growth model reveals a potential bias for sex ratio prediction in turtles. Journal of Thermal Biology 73: 32-40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- structure(c(4.88677476830268, 20.4051904475743, 31.5173105860335), 
.Names = c("Dallwitz_b1", "Dallwitz_b2", "Dallwitz_b3"))
pfixed &lt;- c(rK=1.208968)
resultNest_3p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(result=resultNest_3p_Dallwitz, show.hist = TRUE,
             ylim=c(0, 8), curve="ML quantiles")

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_3p_Weibull'>Result of the fit using the nest database using Weibull function</h2><span id='topic+resultNest_3p_Weibull'></span>

<h3>Description</h3>

<p>Fit using the nest database using Weibull function.
The model is:<br />
rT &lt;- dweibull(T, shape=abs(parms[&quot;k&quot;]), <br />
scale=abs(parms[&quot;lambda&quot;]))*parms[&quot;scale&quot;]*1E-5<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_3p_Weibull
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database using Weibull function
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# Weibull model
 x &lt;- ChangeSSM(temperatures = (200:350)/10,
                parameters = resultNest_4p_SSM$par,
                initial.parameters = structure(c(73.4009010417375, 304.142079511996, 
                                                27.4671689276281), 
                                        .Names = c("k", "lambda", "scale")), 
                control=list(maxit=1000))
pfixed &lt;- c(rK=2.093313)
resultNest_3p_Weibull &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=1.7, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_3p_Weibull, ylim=c(0, 3))
plotR(resultNest_3p_Weibull, ylim=c(0, 3), ylimH = c(0, 0.9), show.hist=TRUE)
compare_AIC(SSM=resultNest_4p_SSM, Weibull=resultNest_3p_Weibull)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_normal'>Result of the fit using the nest database using asymmetric normal function</h2><span id='topic+resultNest_4p_normal'></span>

<h3>Description</h3>

<p>Fit using the nest database using asymmetric normal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_normal
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database using asymmetric normal function
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 7, 11, 32), 
                               .Names = c("Scale", "sdL", "sdH", "Peak")), 
               control=list(maxit=1000))
pfixed &lt;- c(rK=2.093313)
resultNest_4p_normal &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=1.7, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_4p_normal, ylim=c(0, 3))
plotR(resultNest_4p_normal, ylim=c(0, 3), ylimH = c(0, 0.9), show.hist=TRUE)
compare_AIC(SSM=resultNest_4p_SSM, Asymmetric.normal=resultNest_4p_normal)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_SSM'>Fit using the nest database</h2><span id='topic+resultNest_4p_SSM'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_SSM
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the 
embryonic thermosensitive period for sex determination using an embryo 
growth model reveals a potential bias for sex ratio prediction in turtles. 
Journal of Thermal Biology 73: 32-40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- structure(c(109.683413821537, 614.969219372661, 306.386903812694, 
 229.003478775323), .Names = c("DHA", "DHH", "T12H", "Rho25"))
pfixed &lt;- c(rK=1.208968)
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(result=resultNest_4p_SSM, show.hist = TRUE,
             ylim=c(0, 8), curve="ML quantiles")

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_SSM_Linear'>Fit using the nest database</h2><span id='topic+resultNest_4p_SSM_Linear'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_SSM_Linear
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database with linear progression
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
pfixed &lt;- NULL
M0 = 0
############################################################################
# 4 parameters SSM
############################################################################
x &lt;- c('DHA' = 64.868697530424186, 'DHH' = 673.18292743646771, 
       'T12H' = 400.90952554047749, 'Rho25' = 82.217237723502123)
resultNest_4p_SSM_Linear &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.linear, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92)/39.33)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_transition'>Result of the fit using the nest database using transition</h2><span id='topic+resultNest_4p_transition'></span>

<h3>Description</h3>

<p>Fit using the nest database using transition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_transition
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database using transition
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
data(resultNest_4p_transition)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_trigo'>Result of the fit using the nest database using trigonometric function</h2><span id='topic+resultNest_4p_trigo'></span>

<h3>Description</h3>

<p>Fit using the nest database using trigonometric function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_trigo
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database using trigonometric function
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 20, 40, 32), 
                         .Names = c("Max", "LengthB", "LengthE", "Peak")), 
               control=list(maxit=1000))
pfixed &lt;- c(rK=2.093313)
resultNest_4p_trigo &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=1.7, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_4p_trigo, ylim=c(0, 3))
plotR(resultNest_4p_trigo, ylim=c(0, 3), ylimH = c(0, 0.9), show.hist=TRUE)
compare_AIC(SSM=resultNest_4p_SSM, trigonometric=resultNest_4p_trigo)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_4p_weight'>Fit using the nest database with weight</h2><span id='topic+resultNest_4p_weight'></span>

<h3>Description</h3>

<p>Fit using the nest database with weight
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_4p_weight
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database with weight
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
w &lt;- weightmaxentropy(formated, control_plot=list(xlim=c(20,36)))
x &lt;- structure(c(118.768297442004, 475.750095909406, 306.243694918151, 
116.055824800264), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for integral.linear or integral.exponential
resultNest_4p_weight &lt;- searchR(parameters=x,  
	fixed.parameters=pfixed, temperatures=formated,  
	integral=integral.Gompertz, M0=1.7, hatchling.metric=c(Mean=39.33, SD=1.92),  
	method = "BFGS", weight=w)
data(resultNest_4p_weight)
plotR(resultNest_4p_weight, ylim=c(0,0.50), xlim=c(15, 35))

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_5p_Dallwitz'>Fit using the nest database</h2><span id='topic+resultNest_5p_Dallwitz'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_5p_Dallwitz
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the embryonic thermosensitive period for sex determination using an embryo growth model reveals a potential bias for sex ratio prediction in turtles. Journal of Thermal Biology 73: 32-40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- structure(c(4.91191231405918, 12.7453211281394, 31.2670410811077, 
 5.7449376569153, -0.825689964543813), .Names = c("Dallwitz_b1",
 "Dallwitz_b2", "Dallwitz_b3", "Dallwitz_b4", "Dallwitz_b5"))
pfixed &lt;- c(rK=1.208968)
resultNest_5p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(result=resultNest_5p_Dallwitz, show.hist = TRUE,
             ylim=c(0, 8), curves="ML quantiles")

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_6p_SSM'>Fit using the nest database</h2><span id='topic+resultNest_6p_SSM'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_6p_SSM
</code></pre>


<h3>Format</h3>

<p>A list with fitted information about data(nest)
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the embryonic thermosensitive period for sex determination using an embryo growth model reveals a potential bias for sex ratio prediction in turtles. Journal of Thermal Biology 73: 32-40
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
x &lt;- structure(c(104.954347370542, 3447.10062406071, 661.269363920423, 
 96.3871849546537, 306.456389026151, 232.105840347154), .Names = c("DHA", 
 "DHH", "DHL", "DT", "T12L", "Rho25"))
pfixed &lt;- c(rK=1.208968)
resultNest_6p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(result=resultNest_6p_SSM, show.hist = TRUE,
             ylim=c(0, 8), curve="ML")

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_mcmc_4p_SSM'>Result of the mcmc using the nest database</h2><span id='topic+resultNest_mcmc_4p_SSM'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_mcmc_4p_SSM
</code></pre>


<h3>Format</h3>

<p>A list of class mcmcComposite with mcmc result for data(nest) with 4 parameters and Gompertz model of growth
</p>


<h3>Details</h3>

<p>Result of the mcmc using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(118.431040984352, 498.205702157603, 306.056280989839, 
118.189669472381), .Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=1.7, 
	test=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_SSM, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_4p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM, 
 adaptive = TRUE, 
	parametersMCMC=pMCMC, n.iter=10000, n.chains = 1, n.adapt = 0,  
	thin=1, trace=TRUE)
data(resultNest_mcmc_4p_SSM)
1-rejectionRate(as.mcmc(resultNest_mcmc_4p_SSM))
as.parameters(resultNest_mcmc_4p_SSM)
layout(mat=matrix(1:4, nrow = 2))
plot(resultNest_mcmc_4p_SSM, parameters = "all", scale.prior = TRUE, las = 1)
layout(mat=1)
plotR(resultNest_4p_SSM, resultmcmc=resultNest_mcmc_4p_SSM, ylim=c(0,4), 
         main="Schoolfield, Sharpe &amp; Magnuson 4-parameters", show.density=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_mcmc_4p_SSM_Linear'>Result of the mcmc using the nest database</h2><span id='topic+resultNest_mcmc_4p_SSM_Linear'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_mcmc_4p_SSM_Linear
</code></pre>


<h3>Format</h3>

<p>A list of class mcmcComposite with mcmc result for data(nest) with 4 parameters and linear model of growth
</p>


<h3>Details</h3>

<p>Result of the mcmc using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
pfixed &lt;- NULL
M0 = 0
############################################################################
# 4 parameters SSM
############################################################################
x &lt;- c('DHA' = 64.868697530424186, 'DHH' = 673.18292743646771, 
       'T12H' = 400.90952554047749, 'Rho25' = 82.217237723502123)
resultNest_4p_SSM_Linear &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.linear, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92)/39.33)
data(resultNest_4p_SSM_Linear)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_SSM_Linear, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_4p_SSM_Linear &lt;- GRTRN_MHmcmc(result=resultNest_4p_SSM_Linear, 
 adaptive = TRUE, 
	parametersMCMC=pMCMC, n.iter=10000, n.chains = 1, n.adapt = 0,  
	thin=1, trace=TRUE)
data(resultNest_mcmc_4p_SSM_Linear)
1-rejectionRate(as.mcmc(resultNest_mcmc_4p_SSM_Linear))
as.parameters(resultNest_mcmc_4p_SSM_Linear)
layout(mat=matrix(1:4, nrow = 2))
plot(resultNest_mcmc_4p_SSM_Linear, parameters = "all", scale.prior = TRUE, las = 1)
layout(mat=1)
plotR(resultNest_4p_SSM_Linear, resultmcmc=resultNest_mcmc_4p_SSM_Linear, ylim=c(0,4), 
         main="Schoolfield, Sharpe &amp; Magnuson 4-parameters", show.density=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_mcmc_6p_SSM'>Result of the mcmc using the nest database</h2><span id='topic+resultNest_mcmc_6p_SSM'></span>

<h3>Description</h3>

<p>Fit using the nest database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_mcmc_6p_SSM
</code></pre>


<h3>Format</h3>

<p>A list of class mcmcComposite with mcmc result for data(nest) with 6 parameters and Gompertz model of growth
</p>


<h3>Details</h3>

<p>Result of the mcmc using the nest database
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
x &lt;- structure(c(115.758929130522, 428.649022170996, 503.687251738993, 
12.2621455821612, 306.308841227278, 116.35048615105), .Names = c("DHA", 
"DHH", "DHL", "DT", "T12L", "Rho25"))
pfixed &lt;- c(rK=2.093313)
resultNest_6p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=1.7, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_6p)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_6p_SSM, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_6p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_6p_SSM,  
 adaptive = TRUE,
	parametersMCMC=pMCMC, n.iter=10000, n.chains = 1, n.adapt = 0,  
	thin=1, trace=TRUE)
data(resultNest_mcmc_6p_SSM)
plot(resultNest_mcmc_6p_SSM, parameters="T12L", main="", xlim=c(290, 320), bty="n")

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_mcmc_newp'>Result of the mcmc using the nest database with anchored parameters</h2><span id='topic+resultNest_mcmc_newp'></span>

<h3>Description</h3>

<p>Fit using the nest database with anchored parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_mcmc_newp
</code></pre>


<h3>Format</h3>

<p>A list of class mcmcComposite with mcmc result for data(nest) with anchored parameters
</p>


<h3>Details</h3>

<p>Result of the mcmc using the nest database with anchored parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
newp &lt;- GenerateAnchor(nests=formated, number.anchors=7)
pfixed &lt;- c(rK=2.093313)
resultNest_newp &lt;- searchR(parameters=newp, fixed.parameters=pfixed, 
  temperatures=formated, integral=integral.Gompertz, M0=1.7, 
  hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_newp)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_newp, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_newp &lt;- GRTRN_MHmcmc(result=resultNest_newp,  
  parametersMCMC=pMCMC, n.iter=10000, n.chains = 1, n.adapt = 0,  
	thin=1, trace=TRUE)
data(resultNest_mcmc_newp)
data(resultNest_4p_SSM)
newp &lt;- GenerateAnchor(nests=resultNest_4p_SSM, number.anchors=7)
# Here the confidence interval is built based on anchored parameters
plotR(resultNest_4p_SSM, parameters=newp, SE=resultNest_mcmc_newp$SD, 
 ylim=c(0,4), ylimH=c(0,0.4), show.hist=TRUE, curve="ML quantiles")
# Here the confidence interval is built based on parametric SSM equation
data(resultNest_4p_SSM)
plotR(resultNest_4p_SSM, SE=resultNest_mcmc_4p_SSM$SD,
 ylim=c(0,4), ylimH=c(0,0.4), show.hist=TRUE, curve="ML quantiles")
plot(resultNest_mcmc_newp, las=1, xlim=c(0,30), parameters="294", 
breaks=c(0, 1.00095, 2.0009, 3.00085, 4.0008, 5.00075, 6.0007, 7.00065, 8.0006, 9.00055, 
10.0005, 11.00045, 12.0004, 13.00035, 14.0003, 15.00025, 16.0002, 17.00015, 18.0001, 
19.00005, 20))
plot(resultNest_mcmc_newp, las=1, xlim=c(0,30), parameters="296.333333333333")
plot(resultNest_mcmc_newp, las=1, xlim=c(0,30), parameters=3)

## End(Not run)
</code></pre>

<hr>
<h2 id='resultNest_newp'>Fit using the nest database with anchored parameters</h2><span id='topic+resultNest_newp'></span>

<h3>Description</h3>

<p>Fit using the nest database with anchored parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>resultNest_newp
</code></pre>


<h3>Format</h3>

<p>A list with fitted information from data(nest) with anchored parameters
</p>


<h3>Details</h3>

<p>Result of the fit using the nest database with anchored parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., &amp; Kaska, Y. (2014). A model to predict 
the thermal reaction norm for the embryo growth rate 
from field data. Journal of Thermal Biology, 45, 96-102. 
doi: 10.1016/j.jtherbio.2014.08.005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
newp &lt;- GenerateAnchor(nests=formated, number.anchors=7)
pfixed &lt;- c(rK=2.093313)
resultNest_newp &lt;- searchR(parameters=newp, fixed.parameters=pfixed, 
  temperatures=formated, integral=integral.Gompertz, M0=1.7, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_newp)
plotR(resultNest_newp)

## End(Not run)
</code></pre>

<hr>
<h2 id='searchR'>Fit the parameters that best represent nest incubation data.</h2><span id='topic+searchR'></span>

<h3>Description</h3>

<p>Fit the parameters that best represent data.<br />
hatchling.metric can be a data.frame with two columns Mean and SD and rownames with the nest name.<br />
If SD is na, then least squarre criteria is used for fitting.<br />
Function to fit thermal reaction norm can be expressed as : <br />
</p>

<ul>
<li><p> a 4-parameters Schoolfield, Sharpe, and Magnuson model (1981) with <code>DHH</code>, <code>DHA</code>, <code>T12H</code>, and <code>Rho25</code>;
</p>
</li>
<li><p> a 6-parameters Schoolfield, Sharpe, and Magnuson model (1981) with <code>T12L</code>, <code>DT</code>, <code>DHH</code>, <code>DHL</code>, <code>DHA</code>, and <code>Rho25</code>;
</p>
</li>
<li><p> Each of these two first models can be combined as low and high sets of parameters by adding the <code>_L</code> suffix to one set. Then you must add also <code>transition_S</code> and <code>transition_P</code> parameters and then the growth rate is 1/(1+exp((1/transition_S)*(P-transition_P))) with P being the proportion of development;
</p>
</li>
<li><p> The <code>Rho25_b</code> control the effect of hygrometry (or <code>Rho25_b_L</code>) (It is not fully functional still);
</p>
</li>
<li><p> a Weibull function with <code>k</code> (shape), <code>lambda</code> (scale) and <code>theta</code> parameters;
</p>
</li>
<li><p> a normal function with <code>Peak</code>, <code>Scale</code>, and <code>sd</code> parameters;
</p>
</li>
<li><p> an asymmetric normal fuction with <code>Peak</code>, <code>Scale</code>, <code>sdH</code> and <code>sdL</code> parameters;
</p>
</li>
<li><p> a symmetric trigonometric function with <code>Length</code>, <code>Peak</code>, and <code>Max</code>;
</p>
</li>
<li><p> an asymmetric trigonometric function with <code>LengthB</code>, <code>LengthE</code>, <code>Peak</code>, and <code>Max</code>.
</p>
</li>
<li><p> Dallwitz-Higgins model (1992) can be used using <code>Dallwitz_b1</code>, <code>Dallwitz_b2</code>, <code>Dallwitz_b3</code>, <code>Dallwitz_b4</code> and <code>Dallwitz_b5</code> parameters.
</p>
</li>
<li><p> If <code>Dallwitz_b4</code> is not included, <code>Dallwitz_b4</code> = 6 will be used.
</p>
</li>
<li><p> If <code>Dallwitz_b5</code> is not included, <code>Dallwitz_b5</code> = 0.4 will be used.
</p>
</li>
<li><p> It is possible also to add the parameter <code>epsilon</code> and then the model becomes <code>X + epsilon</code> with X being any of the above model;
</p>
</li>
<li><p> It is possible also to add the parameter <code>epsilon_L</code> and then the model becomes <code>X_L + epsilon_L</code> with <code>X_L</code> being any of the above model with suffix <code>_L</code>;
</p>
</li>
<li><p> If the name of the parameter is a number, then the model is a polynom anchored with the rate being the parameter value at this temperature (the name). see <code>ChangeSSM()</code> function.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>searchR(
  parameters = stop("Initial set of parameters must be provided"),
  fixed.parameters = c(rK = 1.208968),
  temperatures = stop("Formated temperature must be provided !"),
  integral = integral.Gompertz,
  derivate = NULL,
  hatchling.metric = c(Mean = 39.33, SD = 1.92),
  M0 = 0.3470893,
  saveAtMaxiter = FALSE,
  fileName = "intermediate",
  weight = NULL,
  control = list(trace = 1, REPORT = 100, maxit = 500)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="searchR_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters used as initial point for searching</p>
</td></tr>
<tr><td><code id="searchR_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of parameters that will not be changed</p>
</td></tr>
<tr><td><code id="searchR_+3A_temperatures">temperatures</code></td>
<td>
<p>Timeseries of temperatures after formated using FormatNests()</p>
</td></tr>
<tr><td><code id="searchR_+3A_integral">integral</code></td>
<td>
<p>Function used to fit embryo growth: integral.Gompertz, integral.exponential or integral.linear</p>
</td></tr>
<tr><td><code id="searchR_+3A_derivate">derivate</code></td>
<td>
<p>Function used to fit embryo growth: derivate.Gompertz, derivate.exponential or derivate.linear</p>
</td></tr>
<tr><td><code id="searchR_+3A_hatchling.metric">hatchling.metric</code></td>
<td>
<p>A vector with Mean and SD of size of hatchlings, ex. hatchling.metric=c(Mean=39, SD=3). Can be a data.frame also. See description</p>
</td></tr>
<tr><td><code id="searchR_+3A_m0">M0</code></td>
<td>
<p>Measure of hatchling size or mass proxi at laying date</p>
</td></tr>
<tr><td><code id="searchR_+3A_saveatmaxiter">saveAtMaxiter</code></td>
<td>
<p>If True, each time number of interation reach maxiter, current data are saved in file with filename name</p>
</td></tr>
<tr><td><code id="searchR_+3A_filename">fileName</code></td>
<td>
<p>The intermediate results are saved in file with fileName.Rdata name</p>
</td></tr>
<tr><td><code id="searchR_+3A_weight">weight</code></td>
<td>
<p>A named vector of the weight for each nest for likelihood estimation</p>
</td></tr>
<tr><td><code id="searchR_+3A_control">control</code></td>
<td>
<p>List for control parameters for optimx</p>
</td></tr>
</table>


<h3>Details</h3>

<p>searchR fits the parameters that best represent nest incubation data.
</p>


<h3>Value</h3>

<p>A result object
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Angilletta, M.J., 2006. Estimating and comparing thermal performance curves. Journal of Thermal Biology 31, 541-545.
</p>
<p>Dallwitz, M.J., Higgins, J.P., 1992. User’s guide to DEVAR. A computer program for estimating development rate as a function of temperature. CSIRO Aust Div Entomol Rep 2, 1-23.
</p>
<p>Georges, A., Beggs, K., Young, J.E., Doody, J.S., 2005. Modelling development of reptile embryos under fluctuating temperature regimes. Physiological and Biochemical Zoology 78, 18-30.
</p>
<p>Girondot, M., Kaska, Y., 2014. A model to predict the thermal reaction norm for the embryo growth rate from field data. Journal of Thermal Biology 45, 96-102.
</p>
<p>Schoolfield, R.M., Sharpe, P.J., Magnuson, C.E., 1981. Non-linear regression of biological temperature-dependent rate models based on absolute reaction-rate theory. Journal of Theoretical Biology 88, 719-731.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "DT", "DHA",  "DHH", "DHL", "Rho25"
# K for Gompertz must be set as fixed parameter or being a constant K  
# or relative to the hatchling size rK
############################################################################
# From Girondot M, Monsinjon J, Guillon J-M (2018) Delimitation of the 
# embryonic thermosensitive period for sex determination using an embryo 
# growth model reveals a potential bias for sex ratio prediction in turtles. 
# Journal of Thermal Biology 73: 32-40 
#  rK = 1.208968 
#  M0 = 0.3470893 
############################################################################
pfixed &lt;- c(rK=1.208968)
M0 = 0.3470893 
############################################################################
# 4 parameters SSM
############################################################################
x &lt;- c('DHA' = 109.31113503282113, 'DHH' = 617.80695919563857, 
    'T12H' = 306.38890489505093, 'Rho25' = 229.37265815800225)
    
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
	
data(resultNest_4p_SSM)
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1, 
embryo.stages="Caretta caretta.SCL")

############################################################################
# 6 parameters SSM
############################################################################
x &lt;- structure(c(106.567809092008, 527.359011254683, 614.208632495199, 
2720.94506457237, 306.268259715624, 120.336791245212), .Names = c("DHA", 
"DHH", "DHL", "DT", "T12L", "Rho25"))

############################################################################
# example of data.frame for hatchling.metric
############################################################################
thatchling.metric &lt;- data.frame(Mean=rep(39.33, formated$IndiceT["NbTS"]), 
                     SD=rep(1.92, formated$IndiceT["NbTS"]), 
                     row.names=names(formated)[1:formated$IndiceT["NbTS"]])
# It is sometimes difficult to find a good starting point for 
# SSM 6 parameters model. This function helps to find it based on a previoulsy 
# fitted model.

 x &lt;- ChangeSSM(temperatures = (200:350)/10,
                parameters = resultNest_4p_SSM$par,
                initial.parameters = structure(c(106.567809092008, 
                527.359011254683, 614.208632495199, 
                4.94506457237, 306.268259715624, 120.336791245212), 
                .Names = c("DHA", "DHH", "DHL", "DT", "T12L", "Rho25")), 
                control=list(maxit=1000))
                     
resultNest_6p_SSM &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
	                        temperatures=formated, integral=integral.Gompertz, 
	                        M0=M0, 
	                        hatchling.metric=thatchling.metric)
	                        
plotR(resultNest_6p_SSM, ylim=c(0, 1))
	                        
data(resultNest_6p_SSM)
pMCMC &lt;- TRN_MHmcmc_p(resultNest_6p_SSM, accept=TRUE)
# Take care, it can be very long, sometimes several days
resultNest_mcmc_6p_SSM &lt;- GRTRN_MHmcmc(result=resultNest_6p_SSM,  
	                                      parametersMCMC=pMCMC, 
	                                      n.iter=10000, 
	                                      n.chains = 1, 
	                                      n.adapt = 0, 
	                                      thin=1, 
	                                      trace=TRUE)
	
############################################################################
# compare_AIC() is a function from the package "HelpersMG"
compare_AIC(test1=resultNest_4p_SSM, test2=resultNest_6p_SSM)
############################################################################

############################################################################
############ Example as linear progression of development
############ The development progress goes from 0 to 1
############################################################################

pfixed &lt;- NULL
M0 = 0

############################################################################
# 4 parameters SSM
############################################################################
x &lt;- c('DHA' = 64.868697530424186, 'DHH' = 673.18292743646771, 
       'T12H' = 400.90952554047749, 'Rho25' = 82.217237723502123)
resultNest_4p_SSM_Linear &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.linear, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92)/39.33)
plotR(resultNest_4p_SSM_Linear, ylim=c(0, 2), scaleY= 100000)
plot(resultNest_4p_SSM_Linear, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,1.1), 
series=1, embryo.stages="Generic.ProportionDevelopment")

tc &lt;- GenerateConstInc(duration=300*24*60, temperatures = 28)
tc_f &lt;- FormatNests(tc)
plot(resultNest_4p_SSM_Linear, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,1.1), 
series=1, embryo.stages="Generic.ProportionDevelopment", temperatures=tc_f)

############################################################################
############ with new parametrization based on anchor
############ This is a non-parametric version
############################################################################

data(resultNest_4p_SSM)
x0 &lt;- resultNest_4p_SSM$par
t &lt;- range(hist(resultNest_4p_SSM, plot=FALSE)$temperatures)

x &lt;- getFromNamespace(".SSM", ns="embryogrowth")(T=seq(from=t[1], 
                                                       to=t[2], 
                                                       length.out=7), 
                                            parms=x0)[[1]]*1E5
names(x) &lt;- as.character(seq(from=t[1], 
                          to=t[2], 
                          length.out=7))
     
M0 &lt;- 0.3470893 
pfixed &lt;- c(rK=1.208968)
resultNest_newp &lt;- searchR(parameters=x, fixed.parameters=pfixed,
                           temperatures=formated, 
                           integral=integral.Gompertz, M0=M0, 
                           hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_newp, ylim=c(0, 2), 
      xlim=c(23, 34), ylimH=c(0, 3), show.hist=TRUE)
compare_AIC(test4p=resultNest_4p_SSM, 
            test6p=resultNest_6p_SSM, 
            testAnchor=resultNest_newp)
            
############################################
# example with thermal reaction norm fitted from Weibull function
############################################

 x &lt;- ChangeSSM(temperatures = (200:350)/10,
                parameters = resultNest_4p_SSM$par,
                initial.parameters = structure(c(73.4009010417375, 304.142079511996, 
                                                27.4671689276281), 
                                        .Names = c("k", "lambda", "scale")), 
                control=list(maxit=1000))
M0 &lt;- 0.3470893 
pfixed &lt;- c(rK=1.208968)
resultNest_3p_Weibull &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=M0, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_3p_Weibull, ylim=c(0,6), col="Black")
compare_AIC(SSM=resultNest_4p_SSM, Weibull=resultNest_3p_Weibull)

###########################################
# example with thermal reaction norm fitted from asymmetric normal function
############################################

x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 7, 11, 32), 
                               .Names = c("Scale", "sdL", "sdH", "Peak")), 
               control=list(maxit=1000))
M0 &lt;- 0.3470893 
pfixed &lt;- c(rK=1.208968)
resultNest_4p_normal &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=M0, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
                         
###########################################
# example with thermal reaction norm fitted from trigonometric model
############################################

 x &lt;- ChangeSSM(temperatures = (200:350)/10,
               parameters = resultNest_4p_SSM$par,
               initial.parameters = structure(c(3, 20, 40, 32), 
               .Names = c("Max", "LengthB", "LengthE", "Peak")), 
               control=list(maxit=1000))
M0 &lt;- 0.3470893 
pfixed &lt;- c(rK=1.208968)
resultNest_4p_trigo &lt;- searchR(parameters=x$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=M0, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
                         
###############################################################
# example with thermal reaction norm fitted from Dallwitz model
###############################################################
# See: Dallwitz, M.J., Higgins, J.P., 1992. User’s guide to DEVAR. A computer 
# program for estimating development rate as a function of temperature. CSIRO Aust 
# Div Entomol Rep 2, 1-23.

# Note that Dallwitz model has many problems and I recommend to not use it:
# - The 3-parameters is too highly constraint
# - The 5 parameters produced infinite outputs for some sets of parameters that
#   can be generated while using delta method.

x &lt;- c('Dallwitz_b1' = 4.8854060791241816, 
       'Dallwitz_b2' = 20.398366565842029, 
       'Dallwitz_b3' = 31.510995256647092)
M0 &lt;- 0.3470893 
pfixed &lt;- c(rK=1.208968)
resultNest_3p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=M0, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_3p_Dallwitz, ylim=c(0,6))

x &lt;- c('Dallwitz_b1' = 4.9104386262684656, 
       'Dallwitz_b2' = 7.515425231891359, 
       'Dallwitz_b3' = 31.221784599026638, 
       'Dallwitz_b4' = 7.0354467023505682, 
       'Dallwitz_b5' = -1.5955717975708577)
pfixed &lt;- c(rK=1.208968)
resultNest_5p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_5p_Dallwitz, ylim=c(0,3), scaleY=10000)

xp &lt;- resultNest_6p_SSM$par
xp["Rho25"] &lt;- 233
pfixed &lt;- c(rK=1.208968)
resultNest_6p_SSM &lt;- searchR(parameters=xp, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_6p_SSM, ylim=c(0,8))

xp &lt;- ChangeSSM(parameters = resultNest_3p_Dallwitz$par, 
                initial.parameters = resultNest_4p_SSM$par)
pfixed &lt;- c(rK=1.208968)
resultNest_4p_SSM &lt;- searchR(parameters=xp$par, fixed.parameters=pfixed, 
                         temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
                         hatchling.metric=c(Mean=39.33, SD=1.92))
plotR(resultNest_4p_SSM, ylim=c(0,6))

compare_AIC(Dallwitz3p=resultNest_3p_Dallwitz, Dallwitz5p=resultNest_5p_Dallwitz, 
             SSM=resultNest_4p_SSM, SSM=resultNest_6p_SSM)
                         
###########################################
# Example with thermal reaction norm of proportion of development
# fitted from Dallwitz model
# see Woolgar, L., Trocini, S., Mitchell, N., 2013. Key parameters describing 
# temperature-dependent sex determination in the southernmost population of loggerhead 
# sea turtles. Journal of Experimental Marine Biology and Ecology 449, 77-84.
############################################

x &lt;- structure(c(1.48207559695689, 20.1100310234046, 31.5665036287242), 
 .Names = c("Dallwitz_b1", "Dallwitz_b2", "Dallwitz_b3"))
resultNest_PropDev_3p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=NULL, 
                         temperatures=formated, integral=integral.linear, M0=0, 
                         hatchling.metric=c(Mean=1, SD=NA))
 plotR(resultNest_PropDev_3p_Dallwitz, ylim=c(0, 1.5), curve="ML")
 plot(x=resultNest_PropDev_3p_Dallwitz, ylimS=c(0,1), xlim=c(0,60), series=2, 
         embryo.stages="Generic.ProportionDevelopment")
         
x &lt;- structure(c(1.48904182113431, 10.4170365155993, 31.2591665490154, 
6.32355497589913, -1.07425378667104), .Names = c("Dallwitz_b1", 
"Dallwitz_b2", "Dallwitz_b3", "Dallwitz_b4", "Dallwitz_b5"))
resultNest_PropDev_5p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=NULL, 
                         temperatures=formated, integral=integral.linear, M0=0, 
                         hatchling.metric=c(Mean=1, SD=NA))
 plotR(resultNest_PropDev_5p_Dallwitz, ylim=c(0, 1.5))
 plot(x=resultNest_PropDev_5p_Dallwitz, ylimS=c(0,1), xlim=c(0,60), series=2, 
         embryo.stages="Generic.ProportionDevelopment")
         
 plotR(resultNest_PropDev_3p_Dallwitz, ylim=c(0, 1.5), curve="ML")
 plotR(resultNest_PropDev_5p_Dallwitz, ylim=c(0, 1.5), curve="ML", new=FALSE, col="red")
 compare_AICc(Dallwitz3p=resultNest_PropDev_3p_Dallwitz, 
              Dallwitz5p=resultNest_PropDev_5p_Dallwitz)
              
###########################################################################
# Dalwitz model with proportion of development and fitted SD for final size
###########################################################################

x &lt;- c('Dallwitz_b1' = 1.4886497996404355, 
       'Dallwitz_b2' = 10.898310418085916, 
       'Dallwitz_b3' = 31.263224721068056, 
       'Dallwitz_b4' = 6.1624623077734535, 
       'Dallwitz_b5' = -1.0027132357973265, 
       'SD' = 0.041829475961912894)
resultNest_PropDev_5p_Dallwitz &lt;- searchR(parameters=x, fixed.parameters=NULL, 
                         temperatures=formated, integral=integral.linear, M0=0, 
                         hatchling.metric=c(Mean=1))
 plotR(resultNest_PropDev_5p_Dallwitz, ylim=c(0, 1.5), curve="ML")
 # Note that the standard error of the curve cannot be estimated with delta method. 
 # MCMC should be used
 plot(x=resultNest_PropDev_5p_Dallwitz, ylimS=c(0,1), xlim=c(0,60), series=2, 
         embryo.stages="Generic.ProportionDevelopment")
         
##############################################################################         
# Parameters Threshold_Low and Threshold_High are used to truncate growth rate
##############################################################################         

plotR(result=resultNest_PropDev_5p_Dallwitz, 
     fixed.parameters=c(Threshold_Low=26, 
                        Threshold_High=33), 
     ylim=c(0, 1.5), curve="ML")

## End(Not run)
</code></pre>

<hr>
<h2 id='stages'>Database of of embryonic development and thermosensitive period of development for sex determination</h2><span id='topic+stages'></span>

<h3>Description</h3>

<p>Database of embryonic development and thermosensitive period of development for sex 
determination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stages
</code></pre>


<h3>Format</h3>

<p>A list with dataframes including attributes
</p>


<h3>Details</h3>

<p>Database of embryonic development and thermosensitive period of development for sex determination
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Pieau, C., Dorizzi, M., 1981. Determination of temperature sensitive 
stages for sexual differentiation of the gonads in embryos of the turtle, 
Emys orbicularis. Journal of Morphology 170, 373-382.
</p>
<p>Yntema, C.L., Mrosovsky, N., 1982. Critical periods and pivotal temperatures for 
sexual differentiation in loggerhead sea turtles. Canadian Journal of 
Zoology-Revue Canadienne de Zoologie 60, 1012-1016.
</p>
<p>Kaska, Y., Downie, R., 1999. Embryological development of sea turtles (Chelonia mydas, 
Caretta caretta) in the Mediterranean. Zoology in the Middle East 19, 55-69.
</p>
<p>Greenbaum, E., 2002. A standardized series of embryonic stages for the emydid 
turtle Trachemys scripta. Canadian Journal of Zoology-Revue Canadienne de 
Zoologie 80, 1350-1370.
</p>
<p>Magalhães, M.S., Vogt, R.C., Sebben, A., Dias, L.C., de Oliveira, M.F., 
de Moura, C.E.B., 2017. Embryonic development of the Giant South American River Turtle, 
Podocnemis expansa (Testudines: Podocnemididae). Zoomorphology.
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(stages)
names(stages)
levels(as.factor(stages$Species))
# Version of database
stages$Version[1]
kaska99.SCL &lt;- subset(stages, subset=(Species == "Caretta caretta"), 
         select=c("Stage", "SCL_Mean_mm", "SCL_SD_mm", "Days_Begin", "Days_End"))

kaska99.SCL[kaska99.SCL$Stage==31, "Days_Begin"] &lt;- 51
kaska99.SCL[kaska99.SCL$Stage==31, "Days_End"] &lt;- 62
kaska99.SCL &lt;- na.omit(kaska99.SCL)
kaska99.SCL[which(kaska99.SCL$Stage==31), "Stage"] &lt;- c("31a", "31b", "31c")
kaska99.SCL &lt;- cbind(kaska99.SCL, 
                     Days_Mean=(kaska99.SCL[, "Days_Begin"]+kaska99.SCL[, "Days_End"])/2)
kaska99.SCL &lt;- cbind(kaska99.SCL, 
                     Days_SD=(kaska99.SCL[, "Days_End"]-kaska99.SCL[, "Days_Begin"])/4)
Gompertz &lt;- function(x, par) {
   K &lt;- par["K"]
   rT &lt;- par["rT"]
   X0 &lt;- par["X0"]
   y &lt;- abs(K)*exp(log(abs(X0)/abs(K))*exp(-rT*x))
   return(y)
 }

ML.Gompertz &lt;- function(x, par) {
  par &lt;- abs(par)
  y &lt;- Gompertz(x, par)
  return(sum(-dnorm(y, mean=kaska99.SCL[, "SCL_Mean_mm"], 
                    sd=kaska99.SCL[, "SCL_SD_mm"], log=TRUE)))
}

parIni &lt;- structure(c(48.66977358, 0.06178453, 0.38640902), 
                   .Names = c("K", "rT", "X0"))

fitsize.SCL &lt;- optim(parIni, ML.Gompertz, x=kaska99.SCL[, "Days_Mean"], hessian = TRUE)

# Estimation of standard error of parameters using Hessian matrix
sqrt(diag(solve(fitsize.SCL$hessian)))

# Estimation of standard error of parameters using Bayesian  concept and MCMC
pMCMC &lt;- structure(list(Density = c("dunif", "dunif", "dunif"), 
                        Prior1 = c(0, 0, 0), Prior2 = c(90, 1, 2), 
                        SDProp = c(1, 1, 1), 
                        Min = c(0, 0, 0), Max = c(90, 1, 2), 
                        Init = fitsize.SCL$par), 
                   .Names = c("Density", "Prior1", "Prior2", "SDProp", "Min", "Max", "Init"), 
                   row.names = c("K", "rT", "X0"), class = "data.frame")

Bayes.Gompertz &lt;- function(data, x) {
  x &lt;- abs(x)
  y &lt;- Gompertz(data, x)
  return(sum(-dnorm(y, mean=kaska99.SCL[, "SCL_Mean_mm"], 
                    sd=kaska99.SCL[, "SCL_SD_mm"], log=TRUE)))
}

mcmc_run &lt;- MHalgoGen(n.iter=50000, parameters=pMCMC, data=kaska99.SCL[, "Days_Mean"], 
                     likelihood=Bayes.Gompertz, n.chains=1, n.adapt=100, thin=1, trace=1, 
                      adaptive = TRUE)

plot(mcmc_run, xlim=c(0, 90), parameters="K")
plot(mcmc_run, xlim=c(0, 1), parameters="rT")
plot(mcmc_run, xlim=c(0, 2), parameters="X0")

1-rejectionRate(as.mcmc(mcmc_run))

par &lt;- mcmc_run$resultMCMC[[1]]

outsp &lt;- t(apply(par, MARGIN = 1, FUN=function(x) Gompertz(0:70, par=x)))

rangqtiles &lt;- apply(outsp, MARGIN=2, function(x) {quantile(x, probs=c(0.025, 0.5, 0.975))})

par(mar=c(4, 4, 2, 1))
plot_errbar(x=kaska99.SCL[, "Days_Mean"], y=kaska99.SCL[, "SCL_Mean_mm"], 
            errbar.y = 2*kaska99.SCL[, "SCL_SD_mm"], bty="n", las=1, 
            ylim=c(0, 50), xlab="Days", ylab="SCL mm", 
           xlim=c(0, 70), x.plus = kaska99.SCL[, "Days_End"], 
            x.minus = kaska99.SCL[, "Days_Begin"])

lines(0:70, rangqtiles["2.5%", ], lty=2)
lines(0:70, rangqtiles["97.5%", ], lty=2)
lines(0:70, rangqtiles["50%", ], lty=3)

text(x=50, y=10, pos=4, labels=paste("K=", format(x = fitsize.SCL$par["K"], digits = 4)))
text(x=50, y=12.5, pos=4, 
   labels=paste("rK=", format(x = fitsize.SCL$par["K"]/39.33, digits = 4)))
text(x=50, y=15, pos=4, labels=paste("X0=", format(x = fitsize.SCL$par["X0"], digits = 4)))
title("Univariate normal distribution")

# Using a multivariate normal distribution

library(mvtnorm)

 ML.Gompertz.2D &lt;- function(x, par) {
   par &lt;- abs(par)
  y &lt;- Gompertz(x, par)
  L &lt;- 0
  for (i in seq_along(y)) {
    sigma &lt;- matrix(c(kaska99.SCL$SCL_SD_mm[i]^2, 0, 0, kaska99.SCL$Days_SD[i]^2), 
                    nrow=2, byrow=TRUE, 
                    dimnames=list(c("SCL_SD_mm", "Days_SD"), c("SCL_SD_mm", "Days_SD")))
    L &lt;- L -dmvnorm(x=c(SCL_SD_mm=kaska99.SCL$SCL_Mean_mm[i], 
                    Days_SD=kaska99.SCL$Days_Mean[i]), 
                    mean= c(SCL_SD_mm=y[i], Days_SD=kaska99.SCL$Days_Mean[i]), 
                            sigma=sigma, log=TRUE)
  }
  return(L)
}

parIni &lt;- structure(c(48.66977358, 0.06178453, 0.38640902), 
                    .Names = c("K", "rT", "X0"))

fitsize.SCL.2D &lt;- optim(parIni, ML.Gompertz.2D, x=kaska99.SCL[, "Days_Mean"], hessian = TRUE)

# Estimation of standard error of parameters using Hessian matrix
sqrt(diag(solve(fitsize.SCL.2D$hessian)))

# Estimation of standard error of parameters using Bayesian  concept and MCMC
Bayes.Gompertz.2D &lt;- function(data, x) {
  x &lt;- abs(x)
  y &lt;- Gompertz(data, x)
  L &lt;- 0
  for (i in seq_along(y)) {
    sigma &lt;- matrix(c(kaska99.SCL$SCL_SD_mm[i]^2, 0, 0, kaska99.SCL$Days_SD[i]^2), 
                    nrow=2, byrow=TRUE, 
                    dimnames=list(c("SCL_SD_mm", "Days_SD"), c("SCL_SD_mm", "Days_SD")))
    L &lt;- L - dmvnorm(x=c(SCL_SD_mm=kaska99.SCL$SCL_Mean_mm[i], 
                         Days_SD=kaska99.SCL$Days_Mean[i]), 
                    mean= c(SCL_SD_mm=y[i], Days_SD=kaska99.SCL$Days_Mean[i]), 
                    sigma=sigma, log=TRUE)
  }
  return(L)
}

pMCMC &lt;- structure(list(Density = c("dunif", "dunif", "dunif"), 
                        Prior1 = c(0, 0, 0), Prior2 = c(90, 1, 2), 
                        SDProp = c(1, 1, 1), 
                        Min = c(0, 0, 0), Max = c(90, 1, 2), 
                        Init = fitsize.SCL.2D$par), 
                   .Names = c("Density", "Prior1", "Prior2", "SDProp", "Min", "Max", "Init"), 
                   row.names = c("K", "rT", "X0"), class = "data.frame")
mcmc_run.2D &lt;- MHalgoGen(n.iter=50000, parameters=pMCMC, data=kaska99.SCL[, "Days_Mean"], 
                     likelihood=Bayes.Gompertz.2D, n.chains=1, n.adapt=100, thin=1, trace=1, 
                      adaptive = TRUE)

plot(mcmc_run.2D, xlim=c(0, 90), parameters="K")
plot(mcmc_run.2D, xlim=c(0, 1), parameters="rT")
plot(mcmc_run.2D, xlim=c(0, 2), parameters="X0")

1-rejectionRate(as.mcmc(mcmc_run.2D))

par &lt;- mcmc_run.2D$resultMCMC[[1]]

outsp &lt;- t(apply(par, MARGIN = 1, FUN=function(x) Gompertz(0:70, par=x)))

rangqtiles &lt;- apply(outsp, MARGIN=2, function(x) {quantile(x, probs=c(0.025, 0.5, 0.975))})

par(mar=c(4, 4, 2, 1))
plot_errbar(x=kaska99.SCL[, "Days_Mean"], y=kaska99.SCL[, "SCL_Mean_mm"], 
            errbar.y = 2*kaska99.SCL[, "SCL_SD_mm"], bty="n", las=1, 
            ylim=c(0, 50), xlab="Days", ylab="SCL mm", 
           xlim=c(0, 70), x.plus = kaska99.SCL[, "Days_End"], 
            x.minus = kaska99.SCL[, "Days_Begin"])

lines(0:70, rangqtiles["2.5%", ], lty=2)
lines(0:70, rangqtiles["97.5%", ], lty=2)
lines(0:70, rangqtiles["50%", ], lty=3)

text(x=50, y=10, pos=4, 
     labels=paste("K=", format(x = fitsize.SCL.2D$par["K"], digits = 4)))
text(x=50, y=12.5, pos=4, 
     labels=paste("rK=", format(x = fitsize.SCL.2D$par["K"]/39.33, digits = 4)))
text(x=50, y=15, pos=4, 
     labels=paste("X0=", format(x = fitsize.SCL.2D$par["X0"], digits = 4)))
title("Multivariate normal distribution")


## End(Not run)
</code></pre>

<hr>
<h2 id='STRN'>Estimate the parameters that best describe the sexualisation thermal reaction norm within the TSP</h2><span id='topic+STRN'></span>

<h3>Description</h3>

<p>Estimate the parameters that best describe the sexualisation thermal reaction norm within the TSP.<br />
The sexratio parameter is a character string which can be:<br />
</p>

<ul>
<li> <p><code>TSP.TimeWeighted.sexratio.mean</code> Sex ratio based on average temperature during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by the actual growth during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by the growth rate during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.STRNWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.GrowthWeighted.STRNWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by the actual growth and thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by the growth rate and the thermal reaction norm of sexualization during the TSP
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.sexratio.mean</code> Sex ratio based on average temperature during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.GrowthWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by actual growth during the middle third incubation
</p>
</li>
<li> <p><code>MiddleThird.TimeWeighted.GrowthRateWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by growth rate during the middle third incubation
</p>
</li>
<li> <p><code>TimeWeighted.sexratio.mean</code> Sex ratio based on average temperature during all incubation
</p>
</li>
<li> <p><code>GrowthWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by actual growth during all incubation
</p>
</li>
<li> <p><code>TimeWeighted.GrowthRateWeighted.sexratio.mean</code> Sex ratio based on average temperature weighted by growth rate during all incubation
</p>
</li>
<li> <p><code>TSP.PM.TimeWeighted.mean</code> Average sex ratio based on temperature during the TSP
</p>
</li>
<li> <p><code>TSP.PM.GrowthWeighted.mean</code> Average sex ratio based on temperature weighted by the actual growth during the TSP
</p>
</li>
<li> <p><code>TSP.PM.TimeWeighted.GrowthRateWeighted.mean</code> Average sex ratio based on temperature weighted by the growth rate during the TSP
</p>
</li></ul>

<p>If information for sex is not known for some timeseries, set NA for Sexed.<br />
Sexed, Males and Females must be vectors with names. The names must be the same as 
the names of timeseries of temperatures in EmbryoGrowthTRN.<br />
Only two of these 3 parameters are required: Males, Females and Sexed<br />
Note: four species have predefined embryo stages. embryo.stages parameter can take the values:<br />
</p>

<ul>
<li> <p><code>Caretta caretta.SCL</code>
</p>
</li>
<li> <p><code>Chelonia mydas.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.SCL</code>
</p>
</li>
<li> <p><code>Emys orbicularis.mass</code>
</p>
</li>
<li> <p><code>Podocnemis expansa.SCL</code>
</p>
</li>
<li> <p><code>Lepidochelys olivacea.SCL</code>
</p>
</li>
<li> <p><code>Generic.ProportionDevelopment</code>
</p>
</li></ul>

<p>A fifth name <code>fitted</code> must be used when limits of TSP are fitted using <code>BeginTSP</code> and <code>EndTSP</code> parameters.<br />
The parameters that can be used in STRN are:<br />
<code>BeginTSP</code>, <code>EndTSP</code> are the logit of the proportion of development; <br />
To ensure that <code>BeginTSP</code> &lt; <code>EndTSP</code>, it is better to use:<br />
<code>BeginTSP</code>, <code>LengthTSP</code> and then <code>EndTSP</code> is estimated using <code>BeginTSP</code> + <code>abs(LengthTSP)</code><br />
<code>DHA</code>, <code>DHH</code>, <code>T12H</code> are the SSM parameters of sexualisation thermal reaction norm; <br />
<code>dbeta_mu</code>, <code>dbeta_v</code> are the beta mean and variance of the impact of sexualisation according to TSP progress.<br />
Or any parameter that can be used in a TSD model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STRN(
  EmbryoGrowthTRN = stop("Embryo Growth Thermal Reaction Norm must be provided"),
  Initial_STRN = NULL,
  fixed.parameters = NULL,
  TSP.borders = NULL,
  embryo.stages = NULL,
  TSP.begin = 0,
  TSP.end = 0.5,
  tsd = NULL,
  equation = "logistic",
  Sexed = NULL,
  Males = NULL,
  Females = NULL,
  sexratio = "TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean",
  fill = 60,
  parallel = TRUE,
  itnmax = 1000,
  method = c("Nelder-Mead", "BFGS"),
  control = list(trace = 1, REPORT = 10),
  zero = 1e-09,
  verbose = FALSE,
  hessian = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STRN_+3A_embryogrowthtrn">EmbryoGrowthTRN</code></td>
<td>
<p>The Embryo Growth Thermal Reaction Norm obtained with searchR()</p>
</td></tr>
<tr><td><code id="STRN_+3A_initial_strn">Initial_STRN</code></td>
<td>
<p>Values for initial model of Sexualisation Thermal Reaction Norm or tsd model</p>
</td></tr>
<tr><td><code id="STRN_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Value for Sexualisation Thermal Reaction Norm or tsd model that will not be changed</p>
</td></tr>
<tr><td><code id="STRN_+3A_tsp.borders">TSP.borders</code></td>
<td>
<p>The limits of TSP in stages. See embryo.stages parameter.</p>
</td></tr>
<tr><td><code id="STRN_+3A_embryo.stages">embryo.stages</code></td>
<td>
<p>The embryo stages. At least TSP.borders stages must be provided to estimate TSP borders. See note.</p>
</td></tr>
<tr><td><code id="STRN_+3A_tsp.begin">TSP.begin</code></td>
<td>
<p>Where TSP begin during the stage of beginning? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="STRN_+3A_tsp.end">TSP.end</code></td>
<td>
<p>Where TSP begin during the stage of ending? In relative proportion of the stage.</p>
</td></tr>
<tr><td><code id="STRN_+3A_tsd">tsd</code></td>
<td>
<p>The model used to predict sex ratio, obtained from tsd()</p>
</td></tr>
<tr><td><code id="STRN_+3A_equation">equation</code></td>
<td>
<p>If tsd parameter is not provided, equation and parameters in Initial_STRN for tsd model must be provided.</p>
</td></tr>
<tr><td><code id="STRN_+3A_sexed">Sexed</code></td>
<td>
<p>The number of sexed embryos with names identifying timeseries</p>
</td></tr>
<tr><td><code id="STRN_+3A_males">Males</code></td>
<td>
<p>The number of males embryos with names identifying timeseries</p>
</td></tr>
<tr><td><code id="STRN_+3A_females">Females</code></td>
<td>
<p>The number of females embryos with names identifying timeseries</p>
</td></tr>
<tr><td><code id="STRN_+3A_sexratio">sexratio</code></td>
<td>
<p>The sex ratio to be used</p>
</td></tr>
<tr><td><code id="STRN_+3A_fill">fill</code></td>
<td>
<p>See info.nests()</p>
</td></tr>
<tr><td><code id="STRN_+3A_parallel">parallel</code></td>
<td>
<p>Should parallel computing for info.nests() be used</p>
</td></tr>
<tr><td><code id="STRN_+3A_itnmax">itnmax</code></td>
<td>
<p>Maximum number of iterations for each method; if 0, just return the likelihood</p>
</td></tr>
<tr><td><code id="STRN_+3A_method">method</code></td>
<td>
<p>Methods to be used with optimx</p>
</td></tr>
<tr><td><code id="STRN_+3A_control">control</code></td>
<td>
<p>List for control parameters for optimx</p>
</td></tr>
<tr><td><code id="STRN_+3A_zero">zero</code></td>
<td>
<p>The value to replace a null sex ratio</p>
</td></tr>
<tr><td><code id="STRN_+3A_verbose">verbose</code></td>
<td>
<p>If TRUE, will show all intermediate parameters during fit</p>
</td></tr>
<tr><td><code id="STRN_+3A_hessian">hessian</code></td>
<td>
<p>If TRUE, the Hessian approximation is estimated atthe end of the fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>STRN estimates the parameters that best describe the sexualisation thermal reaction norm within the TSP
</p>


<h3>Value</h3>

<p>The list with object return by optim()
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
MedIncubation_Cc &lt;- subset(DatabaseTSD, Species=="Caretta caretta" &amp; 
RMU=="Mediterranean" &amp; Sexed!=0)
Med_Cc &lt;- tsd(males=MedIncubation_Cc$Males, 
             females=MedIncubation_Cc$Females, 
             temperatures=MedIncubation_Cc$Incubation.temperature, 
             par=c(P=29.5, S=-0.1))
plot(Med_Cc, xlim=c(25, 35))
males &lt;- c(7, 0, 0, 0, 0, 5, 6, 3, 5, 3, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0)
names(males) &lt;- rev(rev(names(resultNest_4p_SSM$data))[-(1:2)])
sexed &lt;- rep(10, length(males))
names(sexed) &lt;- rev(rev(names(resultNest_4p_SSM$data))[-(1:2)])

Initial_STRN &lt;- c('DHA' = 1174.6461503413307, 
                  'DHH' = 2001.0619192107047, 
                  'T12H' = 3731.353104743393)
fp &lt;- c(Rho25=100)
fitSTRN &lt;- STRN(Initial_STRN=Initial_STRN, 
                EmbryoGrowthTRN=resultNest_4p_SSM, 
                tsd=Med_Cc, 
                embryo.stages="Caretta caretta.SCL", 
                Sexed=sexed, Males=males, 
                fixed.parameters=fp, 
                sexratio="TSP.GrowthWeighted.STRNWeighted.sexratio.mean")
plotR(fitSTRN, curve ="ML", ylim=c(0,2))
plotR(fitSTRN)
out &lt;- info.nests(NestsResult=resultNest_4p_SSM, 
                  SexualisationTRN=fitSTRN,
                  SexualisationTRN.CI="Hessian",
                  embryo.stages="Caretta caretta.SCL", 
                  GTRN.CI="Hessian", 
                  tsd=Med_Cc, 
                  tsd.CI="Hessian", 
                  replicate.CI=100, 
                  progressbar=TRUE, 
                  warnings=TRUE, 
                  out="summary")$summary
# CTE with growth-weighted temperature average
plot(Med_Cc, xlim=c(25, 35))
points(x=out[, "TSP.GrowthWeighted.STRNWeighted.temperature.mean"], y=males/sexed, 
         col="red", pch=19)
legend("topright", legend=c("CTE with growth-weighted and Sexualization TRN"), 
         pch=19, col=c("red"))
       
#  Fit the beginning and end of TSP

Initial_STRN &lt;- c('BeginTSP' = invlogit(0.33), 
                  'EndTSP' = invlogit(0.66))
fp &lt;- NULL
fitSTRN &lt;- STRN(Initial_STRN=Initial_STRN, 
                EmbryoGrowthTRN=resultNest_4p_SSM, 
                tsd=Med_Cc, 
                embryo.stages="fitted", 
                Sexed=sexed, Males=males, 
                fixed.parameters=fp, 
                sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean")
invlogit(fitSTRN$par)
invlogit(fitSTRN$par-2*fitSTRN$SE)
invlogit(fitSTRN$par+2*fitSTRN$SE)

Initial_STRN &lt;- c('dbeta_mu' = logit(0.5), 
                  'dbeta_v' = 1/12)
fp &lt;- NULL
fitSTRN &lt;- STRN(Initial_STRN=Initial_STRN, 
                EmbryoGrowthTRN=resultNest_4p_SSM, 
                tsd=Med_Cc, 
                embryo.stages="Caretta caretta.SCL", 
                Sexed=sexed, Males=males, 
                fixed.parameters=fp, 
                sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean")
                mu &lt;- invlogit(fitSTRN$par["dbeta_mu"]), 
                v &lt;- abs(fitSTRN$par["dbeta_v"])
                shape1 &lt;- mu * (((mu * (1 - mu))/v) - 1)
                shape2 &lt;- shape1 * (1 - mu)/mu
plot(seq(from=0, to=1, length.out=100), 
     dbeta(seq(from=0, to=1, length.out=100), 
               shape1=shape1, shape2=shape2), 
     type="l", xlab="Progress of TSP", 
     ylab="Force of sexualisation", bty="n", ylim=c(0, 6), las=1)
               
 Initial_STRN &lt;- c('dbeta_mu' = 7.2194053298953236, 
                   'dbeta_v' = 0.00050390986089928467)
fp &lt;- NULL
fitSTRN &lt;- STRN(Initial_STRN=Initial_STRN                                                 , 
                EmbryoGrowthTRN=resultNest_4p_SSM                                         , 
                tsd=Med_Cc                                                                , 
                embryo.stages="Caretta caretta.SCL"                                       , 
                Sexed=sexed                                                               , 
                Males=males                                                               , 
                fixed.parameters=fp                                                       , 
                sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean" )
                
                mu &lt;- invlogit(fitSTRN$par["dbeta_mu"]), 
                v &lt;- abs(fitSTRN$par["dbeta_v"])
                shape1 &lt;- mu * (((mu * (1 - mu))/v) - 1)
                shape2 &lt;- shape1 * (1 - mu)/mu
                
plot(seq(from=0, to=1, length.out=100), 
     dbeta(seq(from=0, to=1, length.out=100), 
               shape1=shape1, shape2=shape2), 
     type="l", xlab="Progress of TSP", 
     ylab="Force of sexualisation", bty="n", ylim=c(0, 0.04), las=1)
               
Initial_STRN &lt;- c('dbeta_mu' = logit(0.5), 
                  'dbeta_v' = 1/12)
L &lt;- STRN(Initial_STRN=NULL                                                        , 
          fixed.parameters=Initial_STRN                                            , 
          EmbryoGrowthTRN=resultNest_4p_SSM                                        , 
          tsd=Med_Cc                                                               , 
          embryo.stages="Caretta caretta.SCL"                                                   , 
          Sexed=sexed                                                              ,
          Males=males                                                              , 
          sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean")
Initial_STRN &lt;- c('dbeta_mu' = logit(0.6), 
                  'dbeta_v' = 1/12)
L &lt;- STRN(Initial_STRN=NULL                                                        , 
          fixed.parameters=Initial_STRN                                            , 
          EmbryoGrowthTRN=resultNest_4p_SSM                                        , 
          tsd=Med_Cc                                                               , 
          embryo.stages="Caretta caretta.SCL"                                                   , 
          Sexed=sexed                                                              ,
          Males=males                                                              , 
          sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean")
 Initial_STRN &lt;- c('dbeta_mu' = 7.2192972077000004, 
                    'dbeta_v' = 0.00050396969999999997)
L &lt;- STRN(Initial_STRN=NULL                                                        , 
          fixed.parameters=Initial_STRN                                            , 
          EmbryoGrowthTRN=resultNest_4p_SSM                                        , 
          tsd=Med_Cc                                                               , 
          embryo.stages="Caretta caretta.SCL"                                      , 
          Sexed=sexed                                                              ,
          Males=males                                                              , 
          sexratio="TSP.TimeWeighted.GrowthRateWeighted.STRNWeighted.sexratio.mean")
                mu &lt;- invlogit(fitSTRN$par["dbeta_mu"]), 
                v &lt;- abs(fitSTRN$par["dbeta_v"])
                shape1 &lt;- mu * (((mu * (1 - mu))/v) - 1)
                shape2 &lt;- shape1 * (1 - mu)/mu
 
   tsp_progress &lt;- seq(from=0, to=1, length.out=100)     
  plot(tsp_progress, 
     dbeta(tsp_progress, 
           shape1=shape1, shape2=shape2), 
       type="l", xlab="Progress of TSP", 
       ylab="Force of sexualisation", bty="n", ylim=c(0, 0.04), las=1)
 segments(x0=0, x1=1, y0=0, y1=0, lty=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='STRN_MHmcmc'>Metropolis-Hastings algorithm for Sexualisation Thermal Reaction Norm</h2><span id='topic+STRN_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for Sexualisation Thermal Reaction Norm.<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend that thin=1 because the method to estimate SE uses resampling.<br />
If initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
To get the SE of the point estimates from <code>result_mcmc &lt;- STRN_MHmcmc(result=try)</code>, use:<br />
<code>result_mcmc$SD</code><br />
coda package is necessary for this function.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and processes at time limited.<br />
If fill is NA, it will use the stored fill value in result.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STRN_MHmcmc(
  result = NULL,
  n.iter = 10000,
  parametersMCMC = NULL,
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  trace = NULL,
  traceML = FALSE,
  batchSize = sqrt(n.iter),
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  parallel = TRUE,
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL,
  fill = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="STRN_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a STRN fit</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_batchsize">batchSize</code></td>
<td>
<p>Number of observations to include in each batch fo SE estimation</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_parallel">parallel</code></td>
<td>
<p>Should parallel computing for info.nests() be used</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
<tr><td><code id="STRN_MHmcmc_+3A_fill">fill</code></td>
<td>
<p>Parameters to be sent to STRN().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>STRN_MHmcmc runs the Metropolis-Hastings algorithm for STRN (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
MedIncubation_Cc &lt;- subset(DatabaseTSD, Species=="Caretta caretta" &amp; 
RMU=="Mediterranean" &amp; Sexed!=0)
Med_Cc &lt;- tsd(males=MedIncubation_Cc$Males, 
             females=MedIncubation_Cc$Females, 
             temperatures=MedIncubation_Cc$Incubation.temperature, 
             par=c(P=29.5, S=-0.1))
plot(Med_Cc, xlim=c(25, 35))
males &lt;- c(7, 0, 0, 0, 0, 5, 6, 3, 5, 3, 2, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0)
names(males) &lt;- rev(rev(names(resultNest_4p_SSM$data))[-(1:2)])
sexed &lt;- rep(10, length(males))
names(sexed) &lt;- rev(rev(names(resultNest_4p_SSM$data))[-(1:2)])
Initial_STRN &lt;- resultNest_4p_SSM$par[c("DHA", "DHH", "T12H")]
Initial_STRN &lt;- structure(c(582.567096666926, 2194.0806711639, 3475.28414940385), 
                          .Names = c("DHA", "DHH", "T12H"))
fp &lt;- c(Rho25=100)
fitSTRN &lt;- STRN(Initial_STRN=Initial_STRN, 
                EmbryoGrowthTRN=resultNest_4p_SSM, 
                tsd=Med_Cc, 
                embryo.stages="Caretta caretta.SCL", 
                Sexed=sexed, Males=males, 
                fixed.parameters=fp, 
                sexratio="TSP.GrowthWeighted.STRNWeighted.sexratio")
                
pMCMC &lt;- TRN_MHmcmc_p(fitSTRN, accept=TRUE)
pMCMC[, "Density"] &lt;- "dunif"
pMCMC[, "Prior2"] &lt;- pMCMC[, "Max"]&lt;- 10000
pMCMC[, "Prior1"] &lt;- pMCMC[, "Min"] &lt;- 1
outMCMC &lt;- STRN_MHmcmc(result = fitSTRN, n.iter = 10000, parametersMCMC = pMCMC,
                n.chains = 1, n.adapt = 0, thin = 1, trace = TRUE,
                adaptive = TRUE, adaptive.lag = 500, 
                intermediate = 1000,
                filename = "intermediate_mcmcSTRN.Rdata")
plot(outMCMC, parameters=1)
plot(outMCMC, parameters=2)
plot(outMCMC, parameters=3)
1-rejectionRate(as.mcmc(x = outMCMC))


## End(Not run)
</code></pre>

<hr>
<h2 id='summary.Nests'>Summarize the information from a Nests object.</h2><span id='topic+summary.Nests'></span>

<h3>Description</h3>

<p>Summarize the information from a Nests object:<br />
- Name of the nests, total incubation length and average temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Nests'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.Nests_+3A_object">object</code></td>
<td>
<p>A object obtained after FormatNests()</p>
</td></tr>
<tr><td><code id="summary.Nests_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>summary.Nests Summarize the information from a Nests object
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest, previous=NULL)
summary(formated)

## End(Not run)
</code></pre>

<hr>
<h2 id='switch.transition'>Add a transition parameter on a set of parameters or remove it</h2><span id='topic+switch.transition'></span>

<h3>Description</h3>

<p>Add a transition parameter on a set of parameters or remove it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switch.transition(parameters = stop("A set of parameters must be supplied"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switch.transition_+3A_parameters">parameters</code></td>
<td>
<p>A vector with parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>switch.transition Add a transition parameter on a set of parameters or remove it
</p>


<h3>Value</h3>

<p>A vector with parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(resultNest_6p_SSM)
# Get a set of parameters without transition
x1 &lt;- resultNest_6p_SSM$par
# Generate a set of parameters with transition
x2 &lt;- switch.transition(x1)
# Generate a set of parameters without transition
x3 &lt;- switch.transition(x3)

## End(Not run)
</code></pre>

<hr>
<h2 id='tempConst'>Timeseries of constant temperatures for nests</h2><span id='topic+tempConst'></span>

<h3>Description</h3>

<p>Timeseries of temperatures for nests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tempConst
</code></pre>


<h3>Format</h3>

<p>A dataframe with raw data.
</p>


<h3>Details</h3>

<p>Timeseries of constant temperatures for nests
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Girondot, M., Kaska, Y., 2014. A model to predict the thermal reaction 
norm for the embryo growth rate from field data. Journal of Thermal Biology 45, 96-102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
# Same as:
# GenerateConstInc(durations = rep(104*60*24, 11),
# temperatures = 25:35,
# names = paste0("T",25:35))
data(tempConst)
tempConst_f &lt;- FormatNests(tempConst)

data(nest)
formated &lt;- FormatNests(nest)
x &lt;- structure(c(109.683413821537, 614.969219372661, 306.386903812694, 
 229.003478775323), .Names = c("DHA", "DHH", "T12H", "Rho25"))
 
 # See the stages dataset examples for justification of M0 and rK
 
pfixed &lt;- c(rK=1.208968)
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=0.3470893, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
	
plotR(result=resultNest_4p_SSM, show.hist = TRUE,
             ylim=c(0, 8), curve="ML quantiles")

# Now use the fited parameters from resultNest_4p_SSM with  
# the constant incubation temperatures:

plot(resultNest_4p_SSM, temperatures=tempConst_f,  
	stop.at.hatchling.metric=TRUE, series="T30", xlim=c(0,50),  
	ylimT=c(22, 32), hatchling.metric=c(Mean=39.33, SD=1.92), 
	embryo.stages="Caretta caretta.SCL")
	
plot(resultNest_4p_SSM, temperatures=tempConst_f,  
	stop.at.hatchling.metric=TRUE, series="T25", xlim=c(0,120),  
	ylimT=c(22, 32), hatchling.metric=c(Mean=39.33, SD=1.92), 
	embryo.stages="Caretta caretta.SCL")
	

## End(Not run)
</code></pre>

<hr>
<h2 id='test.parallel'>Estimate the likelihood of a set of parameters for nest incubation data with or without parallel computing option</h2><span id='topic+test.parallel'></span>

<h3>Description</h3>

<p>Estimate the likelihood of a set of parameters for nest incubation data with or without parallel computing option.
It uses the user time from the print result of system.time() function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.parallel(result = stop("A ResultNest object must be provided"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.parallel_+3A_result">result</code></td>
<td>
<p>A object obtained after searchR or likelihoodR</p>
</td></tr>
</table>


<h3>Details</h3>

<p>test.parallel estimates the likelihood of a set of parameters for nest incubation data with or without parallel computing option
</p>


<h3>Value</h3>

<p>The gain or loss of computing time using parallel version
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(resultNest_4p_SSM)
test.parallel(resultNest_4p_SSM)

## End(Not run)
</code></pre>

<hr>
<h2 id='TRN_MHmcmc_p'>Generates set of parameters to be used with GRTRN_MHmcmc() or STRN_MHmcmc()</h2><span id='topic+TRN_MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive script used to generate set of parameters to be used with GRTRN_MHmcmc() or STRN_MHmcmc().<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TRN_MHmcmc_p(
  result = NULL,
  parameters = NULL,
  fixed.parameters = NULL,
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TRN_MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="TRN_MHmcmc_p_+3A_parameters">parameters</code></td>
<td>
<p>A set of parameters. Replace the one from result</p>
</td></tr>
<tr><td><code id="TRN_MHmcmc_p_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>A set of fixed parameters. Replace the one from result</p>
</td></tr>
<tr><td><code id="TRN_MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, the script does not wait user information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>TRN_MHmcmc_p generates set of parameters to be used with GRTRN_MHmcmc() or STRN_MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
# The initial parameters value can be:
# "T12H", "DHA",  "DHH", "Rho25"
# Or
# "T12L", "T12H", "DHA",  "DHH", "DHL", "Rho25"
############################################################################
pfixed &lt;- c(rK=1.208968)
M0 = 0.3470893 
############################################################################
# 4 parameters
############################################################################
x &lt;- structure(c(105.966881676793, 613.944134764125, 306.449533440186, 
                118.193882815108), .Names = c("DHA", "DHH", "T12H", "Rho25"))
resultNest_4p_SSM &lt;- searchR(parameters=x, fixed.parameters=pfixed, 
	temperatures=formated, integral=integral.Gompertz, M0=M0, 
	hatchling.metric=c(Mean=39.33, SD=1.92))
data(resultNest_4p_SSM)
plot(resultNest_4p_SSM, xlim=c(0,70), ylimT=c(22, 32), ylimS=c(0,45), series=1, 
embryo.stages="Caretta caretta.SCL")
############################################################################
pMCMC &lt;- TRN_MHmcmc_p(resultNest_4p_SSM, accept=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='tsd'>Estimate the parameters that best describe temperature-dependent sex determination</h2><span id='topic+tsd'></span>

<h3>Description</h3>

<p>Estimate the parameters that best describe the thermal reaction norm for sex ratio when temperature-dependent sex determination occurs.<br />
It can be used also to evaluate the relationship between incubation duration and sex ratio.<br />
The parameter l was defined in Girondot (1999). The TRT is defined from the difference between the two boundary temperatures giving sex ratios of <code class="reqn">l</code> and <code class="reqn">1 - l</code>, respectively:<br />
For logistic model (Girondot, 1999), it follows </p>
<p style="text-align: center;"><code class="reqn">TRT_{l}=abs\left ( S\: K_{l} \right )</code>
</p>

<p>where <code class="reqn">K_{l}</code> is a constant equal to <code class="reqn">2\: log\left ( \frac{l}{1-l} \right )</code>.<br />
In Girondot (1999), l was 0.05 and then the TRT was defined as being the range of temperatures producing from 5% to 95% of each sex.<br />
For other models, TRT is calculated numerically.<br />
The basic model is logistic one. This model has the particularity to have a symmetric shape around P.<br />
The other models have been built to alleviate this constraint. Hill and A-logistic models can be asymmetric, but it is impossible to control independently the low and high transitions.<br />
Hulin model is assymmetric but the control of asymmetry is difficult to manage.<br />
If asymmetric model is selected, it is always better to use flexit model.
</p>
<p style="text-align: center;"><code class="reqn">if dose &lt; P then (1 + (2^K1 - 1) *  exp(4 * S1 * (P - x)))^(-1/K1)</code>
</p>

<p style="text-align: center;"><code class="reqn">if dose &gt; P then 1-((1 + (2^K2 - 1) * exp(4 * S2 * (x - P)))^(-1/K2)</code>
</p>

<p>with:<br />
</p>
<p style="text-align: center;"><code class="reqn">S1 = S/((4/K1)*(2^(-K1))^(1/K1+1)*(2^K1-1))</code>
</p>

<p style="text-align: center;"><code class="reqn">S2 = S/((4/K2)*(2^(-K2))^(1/K2+1)*(2^K2-1))</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>tsd(
  df = NULL,
  males = NULL,
  females = NULL,
  N = NULL,
  temperatures = NULL,
  durations = NULL,
  l = 0.05,
  parameters.initial = c(P = NA, S = -2, K = 0, K1 = 1, K2 = 0),
  males.freq = TRUE,
  fixed.parameters = NULL,
  equation = "logistic",
  replicate.CI = 10000,
  range.CI = 0.95,
  SE = TRUE,
  replicate.NullDeviance = 1000,
  control = list(maxit = 1000),
  print = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsd_+3A_df">df</code></td>
<td>
<p>A dataframe with at least two columns named males, females or N and temperatures, Incubation.temperature or durations column</p>
</td></tr>
<tr><td><code id="tsd_+3A_males">males</code></td>
<td>
<p>A vector with male numbers</p>
</td></tr>
<tr><td><code id="tsd_+3A_females">females</code></td>
<td>
<p>A vector with female numbers</p>
</td></tr>
<tr><td><code id="tsd_+3A_n">N</code></td>
<td>
<p>A vector with total numbers</p>
</td></tr>
<tr><td><code id="tsd_+3A_temperatures">temperatures</code></td>
<td>
<p>The constant incubation temperatures used to fit sex ratio</p>
</td></tr>
<tr><td><code id="tsd_+3A_durations">durations</code></td>
<td>
<p>The duration of incubation or TSP used to fit sex ratio</p>
</td></tr>
<tr><td><code id="tsd_+3A_l">l</code></td>
<td>
<p>Sex ratio limits to define TRT are l and 1-l (see Girondot, 1999)</p>
</td></tr>
<tr><td><code id="tsd_+3A_parameters.initial">parameters.initial</code></td>
<td>
<p>Initial values for P, S or K search as a vector, ex. c(P=29, S=-0.3)</p>
</td></tr>
<tr><td><code id="tsd_+3A_males.freq">males.freq</code></td>
<td>
<p>If TRUE data are shown as males frequency</p>
</td></tr>
<tr><td><code id="tsd_+3A_fixed.parameters">fixed.parameters</code></td>
<td>
<p>Parameters that will not be changed</p>
</td></tr>
<tr><td><code id="tsd_+3A_equation">equation</code></td>
<td>
<p>Can be &quot;logistic&quot;, &quot;Hill&quot;, &quot;A-logistic&quot;, &quot;Hulin&quot;, &quot;Double-A-logistic&quot;, &quot;flexit&quot;, &quot;GSD&quot;, &quot;logit&quot;, &quot;probit&quot;</p>
</td></tr>
<tr><td><code id="tsd_+3A_replicate.ci">replicate.CI</code></td>
<td>
<p>Number of replicates to estimate confidence intervals</p>
</td></tr>
<tr><td><code id="tsd_+3A_range.ci">range.CI</code></td>
<td>
<p>The range of confidence interval for estimation, default=0.95</p>
</td></tr>
<tr><td><code id="tsd_+3A_se">SE</code></td>
<td>
<p>If FALSE, does not estimate SE of parameters. Can be use when something wrong happens.</p>
</td></tr>
<tr><td><code id="tsd_+3A_replicate.nulldeviance">replicate.NullDeviance</code></td>
<td>
<p>Number of replicates to estimate null distribution of deviance</p>
</td></tr>
<tr><td><code id="tsd_+3A_control">control</code></td>
<td>
<p>List of parameters used in optim.</p>
</td></tr>
<tr><td><code id="tsd_+3A_print">print</code></td>
<td>
<p>Should the results be printed at screen? TRUE (default) or FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tsd estimates the parameters that best describe temperature-dependent sex determination
</p>


<h3>Value</h3>

<p>A list the pivotal temperature, transitional range of temperatures and their SE
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>References</h3>

<p>Girondot, M. 1999. Statistical description of temperature-dependent sex determination using maximum likelihood. Evolutionary Ecology Research, 1, 479-486.
</p>
<p>Godfrey, M.H., Delmas, V., Girondot, M., 2003. Assessment of patterns of temperature-dependent sex determination using maximum likelihood model selection. Ecoscience 10, 265-272.
</p>
<p>Hulin, V., Delmas, V., Girondot, M., Godfrey, M.H., Guillon, J.-M., 2009. Temperature-dependent sex determination and global change: are some species at greater risk? Oecologia 160, 493-506.
</p>
<p>Abreu-Grobois, F.A., Morales-Mérida, B.A., Hart, C.E., Guillon, J.-M., Godfrey, M.H., Navarro, E., Girondot, M., 2020. Recent advances on the estimation of the thermal reaction norm for sex ratios. PeerJ 8, e8451.
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
CC_AtlanticSW &lt;- subset(DatabaseTSD, RMU=="Atlantic, SW" &amp; 
                          Species=="Caretta caretta" &amp; (!is.na(Sexed) &amp; Sexed!=0) &amp;
                          !is.na(Correction.factor))
tsdL &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="logistic", replicate.CI=NULL))
tsdH &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="Hill", replicate.CI=NULL))
tsdR &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="A-logistic", replicate.CI=NULL))
tsdF &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="Flexit", replicate.CI=NULL))
tsdDR &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="Double-A-logistic", replicate.CI=NULL))
gsd &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature-Correction.factor, 
                                 equation="GSD", replicate.CI=NULL))
compare_AIC(Logistic_Model=tsdL, Hill_model=tsdH, Alogistic_model=tsdR, 
               flexit=tsdF, 
               DoubleAlogistic_model=tsdDR, GSD_model=gsd)
compare_AICc(Logistic_Model=tsdL, Hill_model=tsdH, Alogistic_model=tsdR, 
               DoubleAlogistic_model=tsdDR, GSD_model=gsd, factor.value = -1)
compare_BIC(Logistic_Model=tsdL, Hill_model=tsdH, Alogistic_model=tsdR, 
               DoubleAlogistic_model=tsdDR, GSD_model=gsd, factor.value = -1)
##############
eo &lt;- subset(DatabaseTSD, Species=="Emys orbicularis", c("Males", "Females", 
                                       "Incubation.temperature"))
                                       
eo_Hill &lt;- with(eo, tsd(males=Males, females=Females, 
                                       temperatures=Incubation.temperature,
                                       equation="Hill"))
eo_Hill &lt;- tsd(df=eo, equation="Hill", replicate.CI=NULL)
eo_logistic &lt;- tsd(eo, replicate.CI=NULL)
eo_Alogistic &lt;- with(eo, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature, 
                                 equation="a-logistic", replicate.CI=NULL))
### The Hulin model is a modification of A-logistic (See Hulin et al. 2009)

########## Caution
### It should not be used anymore as it can produce unexpected results
par &lt;- eo_Alogistic$par
names(par)[which(names(par)=="K")] &lt;- "K2"
par &lt;- c(par, K1=0)
eo_Hulin &lt;- with(eo, tsd(males=Males, females=Females, 
                                 parameters.initial=par, 
                                 temperatures=Incubation.temperature, 
                                 equation="Hulin", replicate.CI=NULL))
                                 
### The Double-A-logistic model is a A-logistic model with K1 and K2 using respectively
### below and above P

########## Caution
### The curve is not smooth at pivotal temperature

par &lt;- eo_Alogistic$par
names(par)[which(names(par)=="K")] &lt;- "K2"
par &lt;- c(par, K1=as.numeric(par["K2"])*0.8)
par["K2"] &lt;- par["K2"]*0.8
eo_Double_Alogistic &lt;- with(eo, tsd(males=Males, females=Females,
                                 parameters.initial=par,
                                 temperatures=Incubation.temperature,
                                 equation="Double-a-logistic", replicate.CI=NULL))
                                 
### The flexit model is modeled with K1 and K2 using respectively
### below and above P and smooth transition at P; S is the slope at P

par &lt;- c(eo_logistic$par["P"], 1/4*eo_logistic$par["S"], K1=1, K2=1)
eo_flexit &lt;- with(eo, tsd(males=Males, females=Females,
                                 parameters.initial=par,
                                 temperatures=Incubation.temperature,
                                 equation="flexit", replicate.CI=NULL))
                                 
compare_AIC(Logistic=eo_logistic, Hill=eo_Hill, Alogistic=eo_Alogistic, 
             Hulin=eo_Hulin, Double_Alogistic=eo_Double_Alogistic, 
             flexit=eo_flexit)
## Note that SE for lower limit of TRT is wrong
plot(eo_flexit)
## To get correct confidence interval, check \code{tsd_MHmcmc()}. 
             
### Note the asymmetry of the Double-A-logistic and flexit models
predict(eo_Double_Alogistic, 
       temperatures=c(eo_Double_Alogistic$par["P"]-0.2, eo_Double_Alogistic$par["P"]+0.2))
predict(eo_Double_Alogistic)

(p &lt;- predict(eo_flexit, 
       temperatures=c(eo_flexit$par["P"]-0.3, eo_flexit$par["P"]+0.3)))
p["50%", 1]-0.5; 0.5-p["50%", 2]
predict(eo_flexit)

### It can be used also for incubation duration
CC_AtlanticSW &lt;- subset(DatabaseTSD, RMU=="Atlantic, SW" &amp; 
                          Species=="Caretta caretta" &amp; Sexed!=0)
tsdL_IP &lt;- with (CC_AtlanticSW, tsd(males=Males, females=Females, 
                                 durations=IP.mean, 
                                 equation="logistic", replicate.CI=NULL))
plot(tsdL_IP, xlab="Incubation durations in days")
# Example with Chelonia mydas
cm &lt;- subset(DatabaseTSD, Species=="Chelonia mydas" &amp; !is.na(Sexed), c("Males", "Females", 
                                       "Incubation.temperature", "RMU"))
tsd(subset(cm, subset=RMU=="Pacific, SW"))
tsd(subset(cm, subset=RMU=="Pacific, Northwest"))
tsd(subset(cm, subset=RMU=="Atlantic, S Caribbean"))

### Eretmochelys imbricata
Ei_PacificSW &lt;- subset(DatabaseTSD, RMU=="Pacific, SW" &amp; 
                       Species=="Eretmochelys imbricata")
Ei_AtlanticW &lt;- subset(DatabaseTSD, RMU=="Atlantic, W (Caribbean and E USA)" &amp; 
                       Species=="Eretmochelys imbricata")
Ei_AtlanticSW &lt;- subset(DatabaseTSD, RMU=="Atlantic, SW" &amp; 
                       Species=="Eretmochelys imbricata")
Ei_PacSW &lt;- tsd(Ei_PacificSW)
Ei_AtlW &lt;- tsd(Ei_AtlanticW)
Ei_AtlSW &lt;- tsd(Ei_AtlanticSW)

plot(Ei_PacSW, xlim=c(27, 33), show.PTRT = FALSE, main=expression(italic("Eretmochelys imbricata")))
par(new=TRUE)
plot(Ei_AtlW, xlim=c(27, 33), col="red", xlab="", ylab="", 
     axes=FALSE, xaxt="n", show.PTRT = FALSE, errbar.col="red")
par(new=TRUE)
plot(Ei_AtlSW, xlim=c(27, 33), col="blue", xlab="", ylab="", axes=FALSE, 
     xaxt="n", show.PTRT = FALSE, errbar.col="blue")
legend("topright", legend=c("Pacific, SW", "Atlantic, W", "Atlantic, SW"), lty=1, 
col=c("black", "red", "blue"))

### Chelonia mydas
Cm_PacificSW &lt;- subset(DatabaseTSD, RMU=="Pacific, SW" &amp; !is.na(Sexed) &amp; 
                       Species=="Chelonia mydas")
Cm_PacificNW &lt;- subset(DatabaseTSD, RMU=="Pacific, NW" &amp;  !is.na(Sexed) &amp; 
                       Species=="Chelonia mydas")
Cm_AtlanticSC &lt;- subset(DatabaseTSD, RMU=="Atlantic, S Caribbean" &amp;  !is.na(Sexed) &amp; 
                       Species=="Chelonia mydas")
Cm_IndianSE &lt;- subset(DatabaseTSD, RMU=="Indian, SE" &amp;  !is.na(Sexed) &amp; 
                       Species=="Chelonia mydas")
Cm_PacSW &lt;- tsd(Cm_PacificSW)
Cm_PacNW &lt;- tsd(Cm_PacificNW)
Cm_IndSE &lt;- tsd(Cm_IndianSE)
Cm_AtlSC &lt;- tsd(Cm_AtlanticSC)

plot(Cm_PacSW, xlim=c(24, 34), show.PTRT = FALSE, main=expression(italic("Chelonia mydas")))
par(new=TRUE)
plot(Cm_PacNW, xlim=c(24, 34), col="red", xlab="", ylab="", 
     axes=FALSE, xaxt="n", show.PTRT = FALSE, errbar.col="red")
par(new=TRUE)
plot(Cm_IndSE, xlim=c(24, 34), col="blue", xlab="", ylab="", 
     axes=FALSE, xaxt="n", show.PTRT = FALSE, errbar.col="blue")
par(new=TRUE)
plot(Cm_AtlSC, xlim=c(24, 34), col="green", xlab="", ylab="", 
     axes=FALSE, xaxt="n", show.PTRT = FALSE, errbar.col="green")

# To fit a TSDII or FMF TSD pattern, you must indicate P_low, S_low, P_high, and S_high
# for logistic model and P_low, S_low, K1_low, K2_low, P_high, S_high, K1_high, and K2_high for 
# flexit model
# The model must be 0-1 for low and 1-0 for high with P_low &lt; P_high

Chelydra_serpentina &lt;- subset(DatabaseTSD, !is.na(Sexed) &amp; (Sexed != 0) &amp; 
                       Species=="Chelydra serpentina")
                       
model_TSDII &lt;- tsd(Chelydra_serpentina, males.freq=FALSE, 
                   parameters.initial=c(P_low=21, S_low=0.3, P_high=28, S_high=-0.4), 
                   equation="logistic")
plot(model_TSDII, lab.TRT = "TRT l = 5 %")
priors &lt;- tsd_MHmcmc_p(result=model_TSDII, accept=TRUE)
out_mcmc &lt;- tsd_MHmcmc(result=model_TSDII, n.iter=10000, parametersMCMC=priors)
plot(model_TSDII, resultmcmc=out_mcmc, lab.TRT = "TRT l = 5 %")
predict(model_TSDII, temperatures=25:35)

# Podocnemis expansa
Podocnemis_expansa &lt;- subset(DatabaseTSD, !is.na(Sexed) &amp; (Sexed != 0) &amp; 
                       Species=="Podocnemis expansa")
Podocnemis_expansa_Valenzuela_2001 &lt;- subset(Podocnemis_expansa, 
                   Reference=="Valenzuela, 2001")
PeL2001 &lt;- tsd(df=Podocnemis_expansa_Valenzuela_2001)
# The pivotal temperature is 32.133 °C (CI 95% 31.495;32.766)
# In Valenzuela, 2001: "Using data from the present study alone, 
# the critical temperature was 32.2 °C by both methods and the 95% 
# confidence limits were 31.4 °C and 32.9 °C."
# Data are close but not identical to what was published.

# The pivotal temperature calculated by maximum likelihood and by inverse 
# prediction from logistic regression, was 32.6°C using raw data from 
# 1991 (N. Valenzuela, unpublished data) and from this study. The lower 
# and upper 95% confidence limits of the pivotal temperature were 32.2°C 
# and 33.2°C,

Podocnemis_expansa_Valenzuela_1997 &lt;- subset(Podocnemis_expansa, 
                   subset=(((Reference=="Lance et al., 1992; Valenzuela et al., 1997") | 
                   (Reference=="Valenzuela, 2001")) &amp; 
                   (!is.na(Sexed)) &amp; (Sexed != 0)))

PeL1997 &lt;- tsd(df=Podocnemis_expansa_Valenzuela_1997)

# Gekko japonicus

Gekko_japonicus &lt;- subset(DatabaseTSD, !is.na(Sexed) &amp; (Sexed != 0) &amp; 
Species=="Gekko japonicus")
model_TSDII_gj &lt;- tsd(Gekko_japonicus, males.freq=TRUE, 
                   parameters.initial=c(P_low=26, S_low=1.5, 
                                        P_high=31, S_high=-1.5), 
                   equation="logistic")
plot(model_TSDII_gj, lab.TRT = "TRT l = 5 %")
print(model_TSDII_gj)
prior &lt;- tsd_MHmcmc_p(result = model_TSDII_gj, accept = TRUE)
prior &lt;- structure(list(
  Density = c("dnorm", "dnorm", "dnorm", "dnorm"), 
  Prior1 = c(26, 0.3, 31, -0.4), 
  Prior2 = c(2, 1, 2, 1), 
  SDProp = c(2, 0.5, 2, 0.5), 
  Min = c(25, -2, 25, -2), 
  Max = c(35, 2, 35, 2), 
  Init = c(26, 0.3, 31, -0.4)), 
  row.names = c("P_low",  "S_low", "P_high", "S_high"), 
  class = "data.frame")
  
result_mcmc_tsd_gj &lt;- tsd_MHmcmc(result=model_TSDII_gj, 
parametersMCMC=prior, n.iter=10000, n.chains = 1,  
n.adapt = 0, thin=1, trace=FALSE, adaptive=TRUE)
summary(result_mcmc_tsd_gj)
plot(result_mcmc_tsd_gj, parameters="P_low", scale.prior=TRUE, xlim=c(20, 30), las=1)
plot(result_mcmc_tsd_gj, parameters="P_high", scale.prior=TRUE, xlim=c(25, 35), las=1)
plot(model_TSDII_gj, resultmcmc = result_mcmc_tsd_gj)

# Trachemys scripta elegans
# Take care, the pattern reflects large population variation

Tse &lt;- subset(DatabaseTSD, Species=="Trachemys scripta" &amp; Subspecies == "elegans" &amp; !is.na(Sexed))
Tse_logistic &lt;- tsd(Tse)
plot(Tse_flexit)
compare_AICc(logistic=Tse_logistic, flexit=Tse_flexit)
plot(Tse_flexit)

## End(Not run)
</code></pre>

<hr>
<h2 id='tsd_MHmcmc'>Metropolis-Hastings algorithm for Sex ratio</h2><span id='topic+tsd_MHmcmc'></span>

<h3>Description</h3>

<p>Run the Metropolis-Hastings algorithm for tsd.<br />
Deeply modified from a MCMC script by Olivier Martin (INRA, Paris-Grignon).<br />
The number of iterations is n.iter+n.adapt+1 because the initial likelihood is also displayed.<br />
I recommend that thin=1 because the method to estimate SE uses resampling.<br />
If initial point is maximum likelihood, n.adapt = 0 is a good solution.<br />
To get the SE from result_mcmc &lt;- tsd_MHmcmc(result=try), use:<br />
result_mcmc$BatchSE or result_mcmc$TimeSeriesSE<br />
The batch standard error procedure is usually thought to be not as accurate as the time series methods.<br />
Based on Jones, Haran, Caffo and Neath (2005), the batch size should be equal to sqrt(n.iter).<br />
Jones, G.L., Haran, M., Caffo, B.S. and Neath, R. (2006) Fixed Width Output Analysis for Markov chain Monte Carlo , Journal of the American Statistical Association, 101:1537-1547.<br />
coda package is necessary for this function.<br />
The parameters intermediate and filename are used to save intermediate results every 'intermediate' iterations (for example 1000). Results are saved in a file of name filename.<br />
The parameter previous is used to indicate the list that has been save using the parameters intermediate and filename. It permits to continue a mcmc search.<br />
These options are used to prevent the consequences of computer crash or if the run is very very long and processes at time limited.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsd_MHmcmc(
  result = stop("A result of tsd() fit must be provided"),
  n.iter = 10000,
  parametersMCMC = NULL,
  n.chains = 1,
  n.adapt = 0,
  thin = 1,
  trace = FALSE,
  traceML = FALSE,
  batchSize = sqrt(n.iter),
  adaptive = FALSE,
  adaptive.lag = 500,
  adaptive.fun = function(x) {
     ifelse(x &gt; 0.234, 1.3, 0.7)
 },
  intermediate = NULL,
  filename = "intermediate.Rdata",
  previous = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsd_MHmcmc_+3A_result">result</code></td>
<td>
<p>An object obtained after a SearchR fit</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_n.iter">n.iter</code></td>
<td>
<p>Number of iterations for each step</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_parametersmcmc">parametersMCMC</code></td>
<td>
<p>A set of parameters used as initial point for searching with information on priors</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_n.chains">n.chains</code></td>
<td>
<p>Number of replicates</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_n.adapt">n.adapt</code></td>
<td>
<p>Number of iterations before to store outputs</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_thin">thin</code></td>
<td>
<p>Number of iterations between each stored output</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_trace">trace</code></td>
<td>
<p>TRUE or FALSE or period, shows progress</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_traceml">traceML</code></td>
<td>
<p>TRUE or FALSE to show ML</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_batchsize">batchSize</code></td>
<td>
<p>Number of observations to include in each batch fo SE estimation</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_adaptive">adaptive</code></td>
<td>
<p>Should an adaptive process for SDProp be used</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_adaptive.lag">adaptive.lag</code></td>
<td>
<p>Lag to analyze the SDProp value in an adaptive content</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_adaptive.fun">adaptive.fun</code></td>
<td>
<p>Function used to change the SDProp</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_intermediate">intermediate</code></td>
<td>
<p>Period for saving intermediate result, NULL for no save</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_filename">filename</code></td>
<td>
<p>If intermediate is not NULL, save intermediate result in this file</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_+3A_previous">previous</code></td>
<td>
<p>Previous result to be continued. Can be the filename in which intermediate results are saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tsd_MHmcmc runs the Metropolis-Hastings algorithm for tsd (Bayesian MCMC)
</p>


<h3>Value</h3>

<p>A list with resultMCMC being mcmc.list object, resultLnL being likelihoods and parametersMCMC being the parameters used
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@gmail.com">marc.girondot@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
eo &lt;- subset(DatabaseTSD, Species=="Emys orbicularis", c("Males", "Females", 
                                       "Incubation.temperature"))
eo_logistic &lt;- tsd(eo)
pMCMC &lt;- tsd_MHmcmc_p(eo_logistic, accept=TRUE)
# Take care, it can be very long
result_mcmc_tsd &lt;- tsd_MHmcmc(result=eo_logistic, 
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=FALSE, adaptive=TRUE)
# summary() permits to get rapidly the standard errors for parameters
summary(result_mcmc_tsd)
plot(result_mcmc_tsd, parameters="S", scale.prior=TRUE, xlim=c(-3, 3), las=1)
plot(result_mcmc_tsd, parameters="P", scale.prior=TRUE, xlim=c(25, 35), las=1)

plot(eo_logistic, resultmcmc = result_mcmc_tsd)

1-rejectionRate(as.mcmc(result_mcmc_tsd))
raftery.diag(as.mcmc(result_mcmc_tsd))
heidel.diag(as.mcmc(result_mcmc_tsd))
library(car)
o &lt;- P_TRT(x=eo_logistic, resultmcmc=result_mcmc_tsd)
outEo &lt;- dataEllipse(x=o$P_TRT[, "PT"], 
                     y=o$P_TRT[, "TRT"], 
                     levels=c(0.95), 
                     draw=FALSE)
plot(x = o$P_TRT[, "PT"], 
     y=o$P_TRT[, "TRT"], 
     pch=".", las=1, bty="n", 
     xlab="Pivotal temperature", 
     ylab=paste0("TRT ", as.character(100*eo_logistic$l), "%"), 
     xlim=c(28.4, 28.6), 
     ylim=c(0.8, 1.8))
lines(outEo[, 1], outEo[, 2], col="green", lwd=2)
legend("topleft", legend = c("Emys orbicularis", "95% confidence ellipse"), 
       pch=c(19, NA), col=c("black", "green"), lty=c(0, 1), lwd=c(0, 2))

logistic &lt;- function(x, P, S) {
   return(1/(1+exp((1/S)*(P-x))))
}

q &lt;- as.quantile(result_mcmc_tsd, fun=logistic, 
                 xlim=seq(from=25, to=35, by=0.1), nameparxlim="x")
plot(x=seq(from=25, to=35, by=0.1), y=q[1, ], type="l", las=1, 
     xlab="Temperatures", ylab="Male proportion", bty="n")
lines(x=seq(from=25, to=35, by=0.1), y=q[2, ])


## End(Not run)
</code></pre>

<hr>
<h2 id='tsd_MHmcmc_p'>Generates set of parameters to be used with tsd_MHmcmc()</h2><span id='topic+tsd_MHmcmc_p'></span>

<h3>Description</h3>

<p>Interactive script used to generate set of parameters to be 
used with tsd_MHmcmc().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsd_MHmcmc_p(
  result = stop("An output from tsd() must be provided"),
  accept = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsd_MHmcmc_p_+3A_result">result</code></td>
<td>
<p>An object obtained after a tsd fit</p>
</td></tr>
<tr><td><code id="tsd_MHmcmc_p_+3A_accept">accept</code></td>
<td>
<p>If TRUE, the script does not wait user information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>tsd_MHmcmc_p generates set of parameters to be used with tsd_MHmcmc()
</p>


<h3>Value</h3>

<p>A matrix with the parameters
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+TSP.list">TSP.list</a></code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
eo &lt;- subset(DatabaseTSD, Species=="Emys orbicularis", c("Males", "Females", 
                                       "Incubation.temperature"))
eo_logistic &lt;- with(eo, tsd(males=Males, females=Females, 
                                 temperatures=Incubation.temperature))
pMCMC &lt;- tsd_MHmcmc_p(eo_logistic, accept=TRUE)
# Take care, it can be very long
result_mcmc_tsd &lt;- tsd_MHmcmc(result=eo_logistic, 
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=FALSE, adaptive=TRUE)
# summary() permits to get rapidly the standard errors for parameters
summary(result_mcmc_tsd)
plot(result_mcmc_tsd, parameters="S", scale.prior=TRUE, xlim=c(-3, 3), las=1)
plot(result_mcmc_tsd, parameters="P", scale.prior=TRUE, xlim=c(25, 35), las=1)

eo_flexit &lt;- with(eo, tsd(males=Males, females=Females,
                                 parameters.initial=c(eo_logistic$par["P"], 
                                 1/(4*eo_logistic$par["S"]), 
                                 K1=1, K2=1), 
                                 temperatures=Incubation.temperature,
                                 equation="flexit", replicate.CI=NULL))
pMCMC &lt;- tsd_MHmcmc_p(eo_flexit, accept=TRUE)
result_mcmc_tsd &lt;- tsd_MHmcmc(result=eo_flexit, 
		parametersMCMC=pMCMC, n.iter=10000, n.chains = 1,  
		n.adapt = 0, thin=1, trace=FALSE, adaptive=TRUE)
# summary() permits to get rapidly the standard errors for parameters
summary(result_mcmc_tsd)
plot(result_mcmc_tsd, parameters="S", scale.prior=TRUE, xlim=c(-3, 3), las=1)
plot(result_mcmc_tsd, parameters="P", scale.prior=TRUE, xlim=c(25, 35), las=1)
plot(result_mcmc_tsd, parameters="K1", scale.prior=TRUE, xlim=c(-10, 10), las=1)
plot(result_mcmc_tsd, parameters="K2", scale.prior=TRUE, xlim=c(-10, 10), las=1)

plot(eo_flexit, resultmcmc = result_mcmc_tsd)

## End(Not run)
</code></pre>

<hr>
<h2 id='TSP.list'>Database of thermosensitive period of development for sex determination</h2><span id='topic+TSP.list'></span>

<h3>Description</h3>

<p>Database of thermosensitive period of development for sex determination.<br />
This database can be used with the functions plot() or info.nests().<br />
The attributes TSP.begin.stages and TSP.end.stages for each dataframe give 
respectively the first and the last stages for TSP. Then the metrics for the limits of TSP 
are the average sizes before and after the TSP (see example, below).<br />
If the metric for the stages before the TSP or after the TSP is not known, it will use the 
available information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSP.list
</code></pre>


<h3>Format</h3>

<p>A list with dataframes including attributes
</p>


<h3>Details</h3>

<p>Database of thermosensitive period of development for sex determination
</p>


<h3>Author(s)</h3>

<p>Marc Girondot <a href="mailto:marc.girondot@universite-paris-saclay.fr">marc.girondot@universite-paris-saclay.fr</a>
</p>


<h3>References</h3>

<p>Mrosovsky, N., Pieau, C., 1991. Transitional range of temperature, pivotal 
temperatures and thermosensitive stages for sex determination in reptiles. 
Amphibia-Reptilia 12, 169-179.
</p>


<h3>See Also</h3>

<p>Other Functions for temperature-dependent sex determination: 
<code><a href="#topic+DatabaseTSD.version">DatabaseTSD.version</a>()</code>,
<code><a href="#topic+DatabaseTSD">DatabaseTSD</a></code>,
<code><a href="#topic+P_TRT">P_TRT</a>()</code>,
<code><a href="#topic+plot.tsd">plot.tsd</a>()</code>,
<code><a href="#topic+predict.tsd">predict.tsd</a>()</code>,
<code><a href="#topic+stages">stages</a></code>,
<code><a href="#topic+tsd_MHmcmc_p">tsd_MHmcmc_p</a>()</code>,
<code><a href="#topic+tsd_MHmcmc">tsd_MHmcmc</a>()</code>,
<code><a href="#topic+tsd">tsd</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(TSP.list)
names(TSP.list)
reference &lt;- "Emys_orbicularis.mass"
metric &lt;- TSP.list[[reference]]
TSP.begin &lt;- attributes(TSP.list[[reference]])$TSP.begin.stages
TSP.end &lt;- attributes(TSP.list[[reference]])$TSP.end.stages
# Metric at the beginning of the TSP
del &lt;- ifelse(all(metric$stages == TSP.begin - 1)==FALSE, 0, 1)
(metric$metric[metric$stages == TSP.begin - del] +
    metric$metric[metric$stages == TSP.begin]) / 2
# Metric at the end of the TSP
del &lt;- ifelse(all(metric$stages == TSP.begin + 1)==FALSE, 0, 1)
(metric$metric[metric$stages == TSP.end] +
        metric$metric[metric$stages == del + TSP.end]) / 2

## End(Not run)
</code></pre>

<hr>
<h2 id='uncertainty.datalogger'>Uncertainty of average temperatures obtained using temperature data logger</h2><span id='topic+uncertainty.datalogger'></span>

<h3>Description</h3>

<p>Calculate the uncertainty of average temperature dependent on the 
characteristics of a data logger and sampling rate.<br />
The temperature is supposed to be uniformaly distributed with min and max 
being -accuracy and +accuracy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uncertainty.datalogger(
  max.time = 0,
  sample.rate = 0,
  accuracy = 0.5,
  resolution = 1,
  replicates = 10000,
  method = function(x) {
     2 * qnorm(0.975) * sd(x)
 }
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uncertainty.datalogger_+3A_max.time">max.time</code></td>
<td>
<p>being the maximum time to record in minutes</p>
</td></tr>
<tr><td><code id="uncertainty.datalogger_+3A_sample.rate">sample.rate</code></td>
<td>
<p>The sample rates in minutes</p>
</td></tr>
<tr><td><code id="uncertainty.datalogger_+3A_accuracy">accuracy</code></td>
<td>
<p>The accuracy of the data logger in °C</p>
</td></tr>
<tr><td><code id="uncertainty.datalogger_+3A_resolution">resolution</code></td>
<td>
<p>The resolution of the data logger in °C</p>
</td></tr>
<tr><td><code id="uncertainty.datalogger_+3A_replicates">replicates</code></td>
<td>
<p>The number of replicates to estimate uncertainty.</p>
</td></tr>
<tr><td><code id="uncertainty.datalogger_+3A_method">method</code></td>
<td>
<p>The fonction that will be used to return the uncertainty.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>uncertainty.datalogger Calculate the uncertainty of the average temperature calculated using data gathered by a data logger.
</p>


<h3>Value</h3>

<p>The function will return the uncertainty of the average temperature for the considered period as being the 95
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>See Also</h3>

<p>Other Data loggers utilities: 
<code><a href="#topic+calibrate.datalogger">calibrate.datalogger</a>()</code>,
<code><a href="#topic+movement">movement</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
# Exemple using the hypothesis of Gaussian distribution
uncertainty.datalogger(sample.rate=30, accuracy=1, resolution=0.5, 
                method=function(x) {2*qnorm(0.975)*sd(x)})
# Example without hypothesis about distribution, using quantiles
uncertainty.datalogger(sample.rate=30, accuracy=1, resolution=0.5, 
                method=function(x) {quantile(x, probs=c(0.975))-
                                              quantile(x, probs=c(0.025))})
par(mar=c(4, 4, 1, 1))
plot(x=10:120, uncertainty.datalogger(sample.rate=10:120, 
                                      accuracy=0.5, 
                                      resolution=1), 
     las=1, bty="n", type="l", 
     xlab="Sample rate in minutes", 
     ylab=expression("Uncertainty in "*degree*"C"), 
     ylim=c(0, 0.15), xlim=c(0, 120))  
lines(x=10:120, uncertainty.datalogger(sample.rate=10:120, 
                                            accuracy=1, 
                                            resolution=0.5), col="red")
lines(x=10:120, uncertainty.datalogger(sample.rate=10:120, 
                                       accuracy=1, 
                                       resolution=1), col="blue")
lines(x=10:120, uncertainty.datalogger(sample.rate=10:120, 
                                       accuracy=0.5, 
                                       resolution=0.5), col="yellow")
legend("topleft", legend=c("Accuracy=0.5, resolution=0.5", 
                           "Accuracy=0.5, resolution=1", 
                           "Accuracy=1, resolution=0.5", 
                           "Accuracy=1, resolution=1"), lty=1, 
       col=c("yellow", "black", "red", "blue"), 
       cex=0.6)

## End(Not run)
</code></pre>

<hr>
<h2 id='web.tsd'>Run a shiny application for basic functions of tsd function</h2><span id='topic+web.tsd'></span>

<h3>Description</h3>

<p>Run a shiny application for basic functions of tsd function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>web.tsd()
</code></pre>


<h3>Details</h3>

<p>web.tsd runs a shiny application for basic functions of tsd function
</p>


<h3>Value</h3>

<p>Nothing
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
web.tsd()

## End(Not run)
</code></pre>

<hr>
<h2 id='weightmaxentropy'>Search for the weights of the nests which maximize the entropy of nest temperatures distribution</h2><span id='topic+weightmaxentropy'></span>

<h3>Description</h3>

<p>Search for the weights of the nests which maximize the entropy of nest temperatures distribution. Entropy is measured by Shanon index.<br />
Entropy method must be entropy.empirical because it is the only method insensitive to scaling.<br />
If no weight is given, the initial weight is uniformly distributed.<br />
Use control_optim=list(trace=0) for not show progress of search report.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weightmaxentropy(
  temperatures = stop("Temperature data must be provided !"),
  weight = NULL,
  entropy.method = entropy::entropy.empirical,
  plot = TRUE,
  control_optim = list(trace = 0, maxit = 500),
  control_plot = NULL,
  control_entropy = NULL,
  col = c("black", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weightmaxentropy_+3A_temperatures">temperatures</code></td>
<td>
<p>Timeseries of temperatures formated using FormatNests()</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_weight">weight</code></td>
<td>
<p>A named vector of the initial weight search for each nest for likelihood estimation</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_entropy.method">entropy.method</code></td>
<td>
<p>Entropy function, for example entropy::entropy.empirical. See package entropy for description</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_plot">plot</code></td>
<td>
<p>Do the plot of temperatures before and after weight must be shown ? TRUE or FALSE</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_control_optim">control_optim</code></td>
<td>
<p>A list with control paramaters for optim function</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_control_plot">control_plot</code></td>
<td>
<p>A list with control paramaters for plot function</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_control_entropy">control_entropy</code></td>
<td>
<p>A list with control paramaters for entropy function</p>
</td></tr>
<tr><td><code id="weightmaxentropy_+3A_col">col</code></td>
<td>
<p>Colors for unweighted and weighted distributions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Search for the weights of the nests which maximize the entropy of nest temperatures distribution
</p>


<h3>Value</h3>

<p>A named vector of weights
</p>


<h3>Author(s)</h3>

<p>Marc Girondot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(embryogrowth)
data(nest)
formated &lt;- FormatNests(nest)
w &lt;- weightmaxentropy(formated, control_plot=list(xlim=c(20,36)))
x &lt;- structure(c(120.940334922916, 467.467455887442,  
	306.176613681557, 117.857995419495),  
	.Names = c("DHA", "DHH", "T12H", "Rho25"))
# pfixed &lt;- c(K=82.33) or rK=82.33/39.33
pfixed &lt;- c(rK=2.093313)
# K or rK are not used for dydt.linear or dydt.exponential
resultNest_4p_weight &lt;- searchR(parameters=x,  
	fixed.parameters=pfixed, temperatures=formated,  
	integral=integral.Gompertz, M0=1.7, hatchling.metric=c(Mean=39.33, SD=1.92),  
	method = "BFGS", weight=w)
data(resultNest_4p_weight)
plotR(resultNest_4p_weight, ylim=c(0,0.50), xlim=c(15, 35))
# Standard error of parameters can use the GRTRN_MHmcmc() function

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
