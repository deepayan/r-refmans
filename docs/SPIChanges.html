<!DOCTYPE html><html lang="en-US"><head><title>Help for package SPIChanges</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SPIChanges}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CampinasRain'><p>Daily Rainfall Amounts</p></a></li>
<li><a href='#lonlat'><p>Coordinates for Entire Brazil</p></a></li>
<li><a href='#Map'><p>Changes in Drought Events in Brazil (1980-2024)</p></a></li>
<li><a href='#rainTS4'><p>Rainfall Aggregated at the 4-quasi week time scale</p></a></li>
<li><a href='#SPIChanges'><p>Detect trends and quantify their effect on the probability of SPI values occurring</p></a></li>
<li><a href='#TSaggreg'><p>Aggregates daily rainfall totals at quasi-week time scales</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Improves the Interpretation of the Standardized Precipitation
Index Under Changing Climate Conditions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Improves the interpretation of the Standardized Precipitation
    Index under changing climate conditions. The package uses the
    nonstationary approach proposed in Blain et al. (2022)
    &lt;<a href="https://doi.org/10.1002%2Fjoc.7550">doi:10.1002/joc.7550</a>&gt; to detect trends in rainfall quantities and to
    quantify the effect of such trends on the probability of a drought event
    occurring.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gabrielblain/SPIChanges">https://github.com/gabrielblain/SPIChanges</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gabrielblain/SPIChanges/issues">https://github.com/gabrielblain/SPIChanges/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>gamlss, gamlss.dist, lubridate, MuMIn, rlang, spsUtil, stats,
brglm2, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>archive, curl, doParallel, dplyr, foreach, ggplot2, grid,
knitr, ncdf4, patchwork, RColorBrewer, rmarkdown, roxyglobals,
sf, purrr, testthat (&ge; 3.0.0), tidyr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/roxyglobals/filename:</td>
<td>globals.R</td>
</tr>
<tr>
<td>Config/roxyglobals/unique:</td>
<td>FALSE</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-04 18:56:44 UTC; Gabriel</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriel Constantino Blain
    <a href="https://orcid.org/0000-0001-8832-7734"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Graciela R. Sobierajski
    <a href="https://orcid.org/0000-0002-7211-9268"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Leticia L. Martins
    <a href="https://orcid.org/0000-0002-0299-3005"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Adam H. Sparks <a href="https://orcid.org/0000-0002-0061-8359"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriel Constantino Blain &lt;gabriel.blain@sp.gov.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-05 18:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='CampinasRain'>Daily Rainfall Amounts</h2><span id='topic+CampinasRain'></span>

<h3>Description</h3>

<p>Daily rainfall amounts recorded in millimetre in Campinas state of Sao Paulo, Brazil.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CampinasRain
</code></pre>


<h3>Format</h3>



<h4><code>CampinasRain</code></h4>

<p>A dataframe with 2 columns and 16071 rows:
</p>

<dl>
<dt>Date</dt><dd><p>Date</p>
</dd>
<dt>Rain</dt><dd><p>Daily rainfall amounts recorded in millimetre in Campinas state of Sao Paulo, Brazil</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://psl.noaa.gov/">https://psl.noaa.gov/</a>
</p>

<hr>
<h2 id='lonlat'>Coordinates for Entire Brazil</h2><span id='topic+lonlat'></span>

<h3>Description</h3>

<p>This dataset provides coordinates for Brazil at a spatial resolution of 0.5 x 0.5 degrees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lonlat
</code></pre>


<h3>Format</h3>



<h4><code>lonlat</code></h4>

<p>A matrix with 2841 rows and 2 columns:
</p>

<dl>
<dt>lon</dt><dd><p>Longitude in decimal degrees</p>
</dd>
<dt>lat</dt><dd><p>Latitude in decimal degrees</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>Data generated using information from the Instituto Brasileiro de Geografia e Estatística (IBGE).
For more information, visit: <a href="https://www.ibge.gov.br/">https://www.ibge.gov.br/</a>
</p>

<hr>
<h2 id='Map'>Changes in Drought Events in Brazil (1980-2024)</h2><span id='topic+Map'></span>

<h3>Description</h3>

<p>This dataset provides the changes (in percentage) in Moderate to Extreme, Severe to Extreme, and Extreme Drought events across Brazil
for the four seasons (Summer, Autumn, Winter, and Spring) over the period 1980–2024.
The data were generated using the <code>SPIChanges()</code> function applied to rainfall data from NOAA PSL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Map
</code></pre>


<h3>Format</h3>



<h4><code>Map</code></h4>

<p>A matrix with 2841 rows and 18 columns:
</p>

<dl>
<dt>lon</dt><dd><p>Longitude in decimal degrees</p>
</dd>
<dt>lat</dt><dd><p>Latitude in decimal degrees</p>
</dd>
<dt>SummerModerate</dt><dd><p>Percentage change in moderate drought events in Summer</p>
</dd>
<dt>SummerSevere</dt><dd><p>Percentage change in severe drought events in Summer</p>
</dd>
<dt>SummerExtreme</dt><dd><p>Percentage change in extreme drought events in Summer</p>
</dd>
<dt>SummerModel</dt><dd><p>The selected gamma-based model in Summer</p>
</dd>
<dt>AutumnModerate</dt><dd><p>Percentage change in moderate drought events in Autumn</p>
</dd>
<dt>AutumnSevere</dt><dd><p>Percentage change in severe drought events in Autumn</p>
</dd>
<dt>AutumnExtreme</dt><dd><p>Percentage change in extreme drought events in Autumn</p>
</dd>
<dt>AutumnModel</dt><dd><p>The selected gamma-based model in Autumn</p>
</dd>
<dt>WinterModerate</dt><dd><p>Percentage change in moderate drought events in Winter</p>
</dd>
<dt>WinterSevere</dt><dd><p>Percentage change in severe drought events in Winter</p>
</dd>
<dt>WinterExtreme</dt><dd><p>Percentage change in extreme drought events in Winter</p>
</dd>
<dt>WinterModel</dt><dd><p>The selected gamma-based model in Winter</p>
</dd>
<dt>SpringModerate</dt><dd><p>Percentage change in moderate drought events in Spring</p>
</dd>
<dt>SpringSevere</dt><dd><p>Percentage change in severe drought events in Spring</p>
</dd>
<dt>SpringExtreme</dt><dd><p>Percentage change in extreme drought events in Spring</p>
</dd>
<dt>SpringModel</dt><dd><p>The selected gamma-based model in Spring</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>Generated using the <code>SPIChanges()</code> function applied to rainfall data obtained from NOAA PSL (<a href="https://psl.noaa.gov/">https://psl.noaa.gov/</a>).
</p>

<hr>
<h2 id='rainTS4'>Rainfall Aggregated at the 4-quasi week time scale</h2><span id='topic+rainTS4'></span>

<h3>Description</h3>

<p>Rainfall amounts aggregated using <code>TSaggreg()</code>. Campinas state of Sao Paulo, Brazil.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rainTS4
</code></pre>


<h3>Format</h3>



<h4><code>rainTS4</code></h4>

<p>A matrix with 4 columns and 576 rows:
</p>

<dl>
<dt>Year</dt><dd><p>Year</p>
</dd>
<dt>Month</dt><dd><p>Month</p>
</dd>
<dt>quasiWeek</dt><dd><p>Four quasi-weekly periods in each month</p>
</dd>
<dt>rain.at.TS4</dt><dd><p>Rainfall amounts aggregated at TS equal to four</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://psl.noaa.gov/">https://psl.noaa.gov/</a>
</p>

<hr>
<h2 id='SPIChanges'>Detect trends and quantify their effect on the probability of SPI values occurring</h2><span id='topic+SPIChanges'></span>

<h3>Description</h3>

<p>Detect trends and quantify their effect on the probability of SPI values occurring
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPIChanges(rain.at.TS, only.linear = "Yes")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SPIChanges_+3A_rain.at.ts">rain.at.TS</code></td>
<td>
<p>A 4-column matrix generated with <code>TSaggreg()</code>. No other objects are accepted.
</p>

<ul>
<li><p> 1st column is years (YYYY),
</p>
</li>
<li><p> 2nd is the months (1 to 12),
</p>
</li>
<li><p> 3rd is the quasiWeeks (1 to 4),
</p>
</li>
<li><p> and 4th is the rainfall totals accumulated at a time scale.
</p>
</li></ul>
</td></tr>
<tr><td><code id="SPIChanges_+3A_only.linear">only.linear</code></td>
<td>
<p>A character string value (<code>Yes</code> or <code>No</code>) defining if the function must
consider only linear models (<code>Yes</code>) or linear and non-linear models (<code>No</code>).
Default is <code>Yes</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object with:
</p>

<dl>
<dt>data.week</dt><dd><p>The Rainfall amounts, SPI, cumulative probability of the SPI values under the stationary
approach, cumulative probability of the SPI values under the non-stationary approach,
and the changes in the frequency of below zero SPI values caused by the changes in rainfall patterns.</p>
</dd>
<dt>model.selection</dt><dd><p>The generalized additive model that best fits the rainfall series</p>
</dd>
<dt>Changes.Freq.Drought</dt><dd><p>changes in the frequency of zero precipitation, moderate to extreme,
severe to extreme and extreme drought events,as categorized by the SPI classification system,
caused by the changes in rainfall patterns.
Changes in the precipitation amounts associated describing normal conditions is also shown.</p>
</dd>
<dt>Statistics</dt><dd><p>Year to year changes in the expected frequency of moderate to extreme, severe to extreme
and extreme drought events.</p>
</dd>
<dt>data.week</dt><dd><p>The Rainfall amounts, <abbr><span class="acronym">SPI</span></abbr>, cumulative
probability of the <abbr><span class="acronym">SPI</span></abbr> values under the stationary approach,
cumulative probability of the <abbr><span class="acronym">SPI</span></abbr> values under the non-stationary
approach, and the changes in the frequency of below zero <abbr><span class="acronym">SPI</span></abbr>
values caused by the changes in rainfall patterns.</p>
</dd>
<dt>model.selection</dt><dd><p>The generalized additive model that best fits the
rainfall series</p>
</dd>
<dt>Changes.Freq.Drought</dt><dd><p>changes in the frequency of zero precipitation,
moderate, severe and extreme drought events, as defined by the
<abbr><span class="acronym">SPI</span></abbr> classification system, caused by the changes in rainfall
patterns. Changes in the precipitation amounts associated describing normal
conditions is also shown.</p>
</dd>
<dt>Statistics</dt><dd><p>Year to year changes in the expected frequency of
moderate, severe and extreme drought events.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>
rainTS4 &lt;- rainTS4
Changes_SPI &lt;- SPIChanges(rain.at.TS=rainTS4, only.linear = "yes")
</code></pre>

<hr>
<h2 id='TSaggreg'>Aggregates daily rainfall totals at quasi-week time scales</h2><span id='topic+TSaggreg'></span>

<h3>Description</h3>

<p>Aggregates daily rainfall totals at quasi-week time scales
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSaggreg(daily.rain, start.date, TS = 4L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSaggreg_+3A_daily.rain">daily.rain</code></td>
<td>
<p>Vector, 1-column matrix or data frame with daily rainfall totals.</p>
</td></tr>
<tr><td><code id="TSaggreg_+3A_start.date">start.date</code></td>
<td>
<p>Date at which the aggregation should start. Preferred formats are
&ldquo;YYYY-MM-DD&rdquo;, &ldquo;YYYY/MM/DD&rdquo; but most any valid date format
should work.</p>
</td></tr>
<tr><td><code id="TSaggreg_+3A_ts">TS</code></td>
<td>
<p>Time scale on the quasiWeek basis (integer values between 1 and 96).
Default is 4, which corresponds to the monthly time scale.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with rainfall amounts aggregated at the time scale selected by
the user
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daily.rain &lt;- CampinasRain[,2]
rainTS4 &lt;- TSaggreg(daily.rain=daily.rain,start.date="1980-01-01",TS=4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
