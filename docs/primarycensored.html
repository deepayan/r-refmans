<!DOCTYPE html><html lang="en-GB"><head><title>Help for package primarycensored</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {primarycensored}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#primarycensored-package'><p>primarycensored: Primary Event Censored Distributions</p></a></li>
<li><a href='#.dpcens'><p>Define a fitdistrplus compatible wrapper around dprimarycensored</p></a></li>
<li><a href='#.extract_function_name'><p>Extract base function name</p></a></li>
<li><a href='#.extract_stan_functions'><p>Extract function names or content from Stan code</p></a></li>
<li><a href='#.format_class'><p>Extract and Combine Distribution Names</p></a></li>
<li><a href='#.name_deprecation'><p>Deprecation name helper</p></a></li>
<li><a href='#.ppcens'><p>Define a fitdistrplus compatible wrapper around pprimarycensored</p></a></li>
<li><a href='#add_name_attribute'><p>Helper method for custom distributions</p></a></li>
<li><a href='#check_dprimary'><p>Check if a function is a valid bounded probability density function (PDF)</p></a></li>
<li><a href='#check_pdist'><p>Check if a function is a valid cumulative distribution function (CDF)</p></a></li>
<li><a href='#check_truncation'><p>Check if truncation time is appropriate relative to the maximum delay</p></a></li>
<li><a href='#dprimarycensored'><p>Compute the primary event censored PMF for delays</p></a></li>
<li><a href='#expgrowth'><p>Exponential growth distribution functions</p></a></li>
<li><a href='#fitdistdoublecens'><p>Fit a distribution to doubly censored data</p></a></li>
<li><a href='#new_pcens'><p>S3 class for primary event censored distribution computation</p></a></li>
<li><a href='#pcd_as_stan_data'><p>Prepare data for primarycensored Stan model</p></a></li>
<li><a href='#pcd_cmdstan_model'><p>Create a CmdStanModel with primarycensored Stan functions</p></a></li>
<li><a href='#pcd_dist_name'><p>Get distribution function cdf or pdf name</p></a></li>
<li><a href='#pcd_distributions'><p>Supported delay distributions</p></a></li>
<li><a href='#pcd_load_stan_functions'><p>Load Stan functions as a string</p></a></li>
<li><a href='#pcd_primary_distributions'><p>Supported primary event distributions</p></a></li>
<li><a href='#pcd_stan_dist_id'><p>Get distribution stan ID by name</p></a></li>
<li><a href='#pcd_stan_files'><p>Get Stan files containing specified functions</p></a></li>
<li><a href='#pcd_stan_functions'><p>Get Stan function names from Stan files</p></a></li>
<li><a href='#pcd_stan_path'><p>Get the path to the Stan code</p></a></li>
<li><a href='#pcens_cdf'><p>Compute primary event censored CDF</p></a></li>
<li><a href='#pcens_cdf.default'><p>Default method for computing primary event censored CDF</p></a></li>
<li><a href='#pcens_cdf.pcens_pgamma_dunif'><p>Method for Gamma delay with uniform primary</p></a></li>
<li><a href='#pcens_cdf.pcens_plnorm_dunif'><p>Method for Log-Normal delay with uniform primary</p></a></li>
<li><a href='#pcens_cdf.pcens_pweibull_dunif'><p>Method for Weibull delay with uniform primary</p></a></li>
<li><a href='#pprimarycensored'><p>Compute the primary event censored CDF for delays</p></a></li>
<li><a href='#rprimarycensored'><p>Generate random samples from a primary event censored distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Primary Event Censored Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for working with primary
    event censored distributions and 'Stan' implementations for use in Bayesian
    modeling. Primary event censored distributions are useful for modeling
    delayed reporting scenarios in epidemiology and other fields (Charniga et
    al. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2405.08841">doi:10.48550/arXiv.2405.08841</a>&gt;). It also provides support for
    arbitrary delay distributions, a range of common primary distributions, and
    allows for truncation and secondary event censoring to be accounted for
    (Park et al. (2024) &lt;<a href="https://doi.org/10.1101%2F2024.01.12.24301247">doi:10.1101/2024.01.12.24301247</a>&gt;). A subset of
    common distributions also have analytical solutions implemented, allowing
    for faster computation. In addition, it provides multiple methods for
    fitting primary event censored distributions to data via optional
    dependencies.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://primarycensored.epinowcast.org">https://primarycensored.epinowcast.org</a>,
<a href="https://github.com/epinowcast/primarycensored">https://github.com/epinowcast/primarycensored</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/epinowcast/primarycensored/issues">https://github.com/epinowcast/primarycensored/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lifecycle, pracma, rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bookdown, cmdstanr, dplyr, fitdistrplus, knitr, ggplot2,
rmarkdown, spelling, testthat (&ge; 3.1.9), usethis, withr</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://stan-dev.r-universe.dev">https://stan-dev.r-universe.dev</a></td>
</tr>
<tr>
<td>Config/Needs/hexsticker:</td>
<td>hexSticker, sysfonts, ggplot2</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>r-lib/pkgdown, epinowcast/enwtheme</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-10 19:38:57 UTC; lshsa2</td>
</tr>
<tr>
<td>Author:</td>
<td>Sam Abbott <a href="https://orcid.org/0000-0001-8057-8037"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Sam Brand <a href="https://orcid.org/0000-0003-0645-5367"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Adam Howes <a href="https://orcid.org/0000-0003-2386-4031"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  James Mba Azam <a href="https://orcid.org/0000-0001-5782-7330"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Carl Pearson <a href="https://orcid.org/0000-0003-0701-7860"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sebastian Funk <a href="https://orcid.org/0000-0002-2842-3406"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Kelly Charniga <a href="https://orcid.org/0000-0002-7648-7041"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sam Abbott &lt;contact@samabbott.co.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-10 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='primarycensored-package'>primarycensored: Primary Event Censored Distributions</h2><span id='topic+primarycensored'></span><span id='topic+primarycensored-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides functions for working with primary event censored distributions and 'Stan' implementations for use in Bayesian modeling. Primary event censored distributions are useful for modeling delayed reporting scenarios in epidemiology and other fields (Charniga et al. (2024) <a href="https://doi.org/10.48550/arXiv.2405.08841">doi:10.48550/arXiv.2405.08841</a>). It also provides support for arbitrary delay distributions, a range of common primary distributions, and allows for truncation and secondary event censoring to be accounted for (Park et al. (2024) <a href="https://doi.org/10.1101/2024.01.12.24301247">doi:10.1101/2024.01.12.24301247</a>). A subset of common distributions also have analytical solutions implemented, allowing for faster computation. In addition, it provides multiple methods for fitting primary event censored distributions to data via optional dependencies.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Sam Abbott <a href="mailto:contact@samabbott.co.uk">contact@samabbott.co.uk</a> (<a href="https://orcid.org/0000-0001-8057-8037">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Sam Brand <a href="mailto:usi1@cdc.gov">usi1@cdc.gov</a> (<a href="https://orcid.org/0000-0003-0645-5367">ORCID</a>)
</p>
</li>
<li><p> Carl Pearson <a href="mailto:carl.ab.pearson@gmail.com">carl.ab.pearson@gmail.com</a> (<a href="https://orcid.org/0000-0003-0701-7860">ORCID</a>)
</p>
</li>
<li><p> Sebastian Funk <a href="mailto:sebastian.funk@lshtm.ac.uk">sebastian.funk@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0002-2842-3406">ORCID</a>)
</p>
</li>
<li><p> Kelly Charniga <a href="mailto:kelly.charniga@gmail.com">kelly.charniga@gmail.com</a> (<a href="https://orcid.org/0000-0002-7648-7041">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Adam Howes <a href="mailto:adamthowes@gmail.com">adamthowes@gmail.com</a> (<a href="https://orcid.org/0000-0003-2386-4031">ORCID</a>) [contributor]
</p>
</li>
<li><p> James Mba Azam <a href="mailto:james.azam@lshtm.ac.uk">james.azam@lshtm.ac.uk</a> (<a href="https://orcid.org/0000-0001-5782-7330">ORCID</a>) [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://primarycensored.epinowcast.org">https://primarycensored.epinowcast.org</a>
</p>
</li>
<li> <p><a href="https://github.com/epinowcast/primarycensored">https://github.com/epinowcast/primarycensored</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/epinowcast/primarycensored/issues">https://github.com/epinowcast/primarycensored/issues</a>
</p>
</li></ul>


<hr>
<h2 id='.dpcens'>Define a fitdistrplus compatible wrapper around dprimarycensored</h2><span id='topic+.dpcens'></span>

<h3>Description</h3>

<p>Define a fitdistrplus compatible wrapper around dprimarycensored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.dpcens(x, swindows, pdist, pwindow, D, dprimary, dprimary_args, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".dpcens_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_swindows">swindows</code></td>
<td>
<p>A numeric vector of secondary window sizes corresponding to
each element in x</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id=".dpcens_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the distribution function</p>
</td></tr>
</table>

<hr>
<h2 id='.extract_function_name'>Extract base function name</h2><span id='topic+.extract_function_name'></span>

<h3>Description</h3>

<p>This helper function extracts the base name of a function, removing
namespace prefixes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.extract_function_name(func)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".extract_function_name_+3A_func">func</code></td>
<td>
<p>Function, for example the <code>p</code>- or <code>d</code>- form of a distribution
function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string representing the base name of the function.
</p>

<hr>
<h2 id='.extract_stan_functions'>Extract function names or content from Stan code</h2><span id='topic+.extract_stan_functions'></span>

<h3>Description</h3>

<p>Extract function names or content from Stan code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.extract_stan_functions(content, names_only = FALSE, functions = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".extract_stan_functions_+3A_content">content</code></td>
<td>
<p>Character vector containing Stan code</p>
</td></tr>
<tr><td><code id=".extract_stan_functions_+3A_names_only">names_only</code></td>
<td>
<p>Logical, if TRUE extract function names, otherwise
extract function content.</p>
</td></tr>
<tr><td><code id=".extract_stan_functions_+3A_functions">functions</code></td>
<td>
<p>Optional, character vector of function names to extract
content for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of function names or content
</p>

<hr>
<h2 id='.format_class'>Extract and Combine Distribution Names</h2><span id='topic+.format_class'></span>

<h3>Description</h3>

<p>This helper function attempts to determine distribution names and uses those
to establish a class name for potential analytical solutions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.format_class(pdist, dprimary)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".format_class_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id=".format_class_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character string representing the combined distribution class
</p>

<hr>
<h2 id='.name_deprecation'>Deprecation name helper</h2><span id='topic+.name_deprecation'></span>

<h3>Description</h3>

<p>Provides lifecycle management consistently across several functions.
Currently uses <code><a href="lifecycle.html#topic+deprecate_soft">lifecycle::deprecate_soft()</a></code> - i.e. warns only when used
directly. In future versions, this will switch to warning unconditionally
with <code><a href="lifecycle.html#topic+deprecate_soft">lifecycle::deprecate_warn()</a></code>, then throwing via
<code><a href="lifecycle.html#topic+deprecate_soft">lifecycle::deprecate_warn()</a></code>, and finally be deleted along with the subject
arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.name_deprecation(
  pdist_name,
  dprimary_name,
  env = rlang::caller_env(),
  user_env = rlang::caller_env(2)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".name_deprecation_+3A_pdist_name">pdist_name</code></td>
<td>
<p>the deprecated variable to check</p>
</td></tr>
<tr><td><code id=".name_deprecation_+3A_dprimary_name">dprimary_name</code></td>
<td>
<p>the deprecated variable to check</p>
</td></tr>
<tr><td><code id=".name_deprecation_+3A_env">env</code>, <code id=".name_deprecation_+3A_user_env">user_env</code></td>
<td>
<p>Pair of environments that define where <code style="white-space: pre;">&#8288;deprecate_*()&#8288;</code>
was called (used to determine the package name) and where the function
called the deprecating function was called (used to determine if
<code>deprecate_soft()</code> should message).
</p>
<p>These are only needed if you're calling <code style="white-space: pre;">&#8288;deprecate_*()&#8288;</code> from an internal
helper, in which case you should forward <code>env = caller_env()</code> and
<code>user_env = caller_env(2)</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='.ppcens'>Define a fitdistrplus compatible wrapper around pprimarycensored</h2><span id='topic+.ppcens'></span>

<h3>Description</h3>

<p>Define a fitdistrplus compatible wrapper around pprimarycensored
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.ppcens(q, pdist, pwindow, D, dprimary, dprimary_args, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".ppcens_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id=".ppcens_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to pdist</p>
</td></tr>
</table>

<hr>
<h2 id='add_name_attribute'>Helper method for custom distributions</h2><span id='topic+add_name_attribute'></span>

<h3>Description</h3>

<p><code><a href="#topic+pprimarycensored">pprimarycensored()</a></code> and related functions can identify which distributions
are provided via the <code>pdist</code> and <code>dprimary</code> arguments when those are base R
functions (e.g. <code>punif</code>, <code>dexp</code>) via the <code>name</code> attribute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_name_attribute(func, name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_name_attribute_+3A_func">func</code></td>
<td>
<p>Function, for example the <code>p</code>- or <code>d</code>- form of a distribution
function.</p>
</td></tr>
<tr><td><code id="add_name_attribute_+3A_name">name</code></td>
<td>
<p>Character string, starting with &quot;p&quot; or &quot;d&quot; indicating the
underlying distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you need to use a non-base R implementation, but know the distribution
name, you can use this helper function to set it in a way that will be
detected by <code><a href="#topic+pprimarycensored">pprimarycensored()</a></code> and related functions.
</p>
<p>This is useful as it enables the automatic use of analytical solutions for
distributions where they exist. You can check which analytical solutions are
available using <code>methods(pcens_cdf)</code> and check distribution names using
<code><a href="#topic+pcd_dist_name">pcd_dist_name()</a></code>.
</p>


<h3>Value</h3>

<p>Function, with a &quot;name&quot; attribute added
</p>


<h3>See Also</h3>

<p>Utility functions for working with distributions
<code><a href="#topic+pcd_dist_name">pcd_dist_name</a>()</code>,
<code><a href="#topic+pcd_distributions">pcd_distributions</a></code>,
<code><a href="#topic+pcd_primary_distributions">pcd_primary_distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dist &lt;- add_name_attribute(pnorm, "hello")
attr(dist, "name")
</code></pre>

<hr>
<h2 id='check_dprimary'>Check if a function is a valid bounded probability density function (PDF)</h2><span id='topic+check_dprimary'></span>

<h3>Description</h3>

<p>This function tests whether a given function behaves like a valid PDF by
checking if it integrates to approximately 1 over the specified range
and if it takes the arguments min and max.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_dprimary(dprimary, pwindow, dprimary_args = list(), tolerance = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_dprimary_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id="check_dprimary_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="check_dprimary_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id="check_dprimary_+3A_tolerance">tolerance</code></td>
<td>
<p>The tolerance for the integral to be considered close to 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. The function will stop execution with an error message if
dprimary is not a valid PDF.
</p>


<h3>See Also</h3>

<p>Distribution checking functions
<code><a href="#topic+check_pdist">check_pdist</a>()</code>,
<code><a href="#topic+check_truncation">check_truncation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_dprimary(dunif, pwindow = 1)
</code></pre>

<hr>
<h2 id='check_pdist'>Check if a function is a valid cumulative distribution function (CDF)</h2><span id='topic+check_pdist'></span>

<h3>Description</h3>

<p>This function tests whether a given function behaves like a valid CDF by
checking if it's monotonically increasing and bounded between 0 and 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_pdist(pdist, D, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_pdist_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id="check_pdist_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="check_pdist_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to pdist</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL. The function will stop execution with an error message if
pdist is not a valid CDF.
</p>


<h3>See Also</h3>

<p>Distribution checking functions
<code><a href="#topic+check_dprimary">check_dprimary</a>()</code>,
<code><a href="#topic+check_truncation">check_truncation</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_pdist(pnorm, D = 10)
</code></pre>

<hr>
<h2 id='check_truncation'>Check if truncation time is appropriate relative to the maximum delay</h2><span id='topic+check_truncation'></span>

<h3>Description</h3>

<p>This function checks if the truncation time D is appropriate relative to the
maximum delay. If D is much larger than necessary, it suggests
considering setting it to <code>Inf</code> for better efficiency with minimal accuracy
cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_truncation(delays, D, multiplier = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_truncation_+3A_delays">delays</code></td>
<td>
<p>A numeric vector of delay times</p>
</td></tr>
<tr><td><code id="check_truncation_+3A_d">D</code></td>
<td>
<p>The truncation time</p>
</td></tr>
<tr><td><code id="check_truncation_+3A_multiplier">multiplier</code></td>
<td>
<p>The multiplier for the maximum delay to compare with D.
Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisible NULL. Prints a message if the condition is met.
</p>


<h3>See Also</h3>

<p>Distribution checking functions
<code><a href="#topic+check_dprimary">check_dprimary</a>()</code>,
<code><a href="#topic+check_pdist">check_pdist</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>check_truncation(delays = c(1, 2, 3, 4), D = 10, multiplier = 2)
</code></pre>

<hr>
<h2 id='dprimarycensored'>Compute the primary event censored PMF for delays</h2><span id='topic+dprimarycensored'></span><span id='topic+dpcens'></span>

<h3>Description</h3>

<p>This function computes the primary event censored probability mass function
(PMF) for a given set of quantiles. It adjusts the PMF of the primary event
distribution by accounting for the delay distribution and potential
truncation at a maximum delay (D). The function allows for custom primary
event distributions and delay distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dprimarycensored(
  x,
  pdist,
  pwindow = 1,
  swindow = 1,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  log = FALSE,
  pdist_name = lifecycle::deprecated(),
  dprimary_name = lifecycle::deprecated(),
  ...
)

dpcens(
  x,
  pdist,
  pwindow = 1,
  swindow = 1,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  log = FALSE,
  pdist_name = lifecycle::deprecated(),
  dprimary_name = lifecycle::deprecated(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dprimarycensored_+3A_x">x</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_swindow">swindow</code></td>
<td>
<p>Secondary event window (default: 1)</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_log">log</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p)</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_pdist_name">pdist_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>pdist</code>
instead</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_dprimary_name">dprimary_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>dprimary</code>
instead</p>
</td></tr>
<tr><td><code id="dprimarycensored_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the distribution function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The primary event censored PMF is computed by taking the difference of the
primary event censored cumulative distribution function (CDF) at two points,
<code class="reqn">d + \text{swindow}</code> and <code class="reqn">d</code>. The primary event censored PMF,
<code class="reqn">f_{\text{cens}}(d)</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">
f_{\text{cens}}(d) = F_{\text{cens}}(d + \text{swindow}) - F_{\text{cens}}(d)
</code>
</p>

<p>where <code class="reqn">F_{\text{cens}}</code> is the primary event censored CDF.
</p>
<p>The function first computes the CDFs for all unique points (including both
<code class="reqn">d</code> and <code class="reqn">d + \text{swindow}</code>) using <code><a href="#topic+pprimarycensored">pprimarycensored()</a></code>. It then
creates a lookup table for these CDFs to efficiently calculate the PMF for
each input value. For non-positive delays, the function returns 0.
</p>
<p>If a finite maximum delay <code class="reqn">D</code> is specified, the PMF is normalized to
ensure it sums to 1 over the range [0, D]. This normalization can be
expressed as:
</p>
<p style="text-align: center;"><code class="reqn">
f_{\text{cens,norm}}(d) = \frac{f_{\text{cens}}(d)}{\sum_{i=0}^{D-1}
 f_{\text{cens}}(i)}
</code>
</p>

<p>where <code class="reqn">f_{\text{cens,norm}}(d)</code> is the normalized PMF and
<code class="reqn">f_{\text{cens}}(d)</code> is the unnormalized PMF. For the explanation and
mathematical details of the CDF, refer to the documentation of
<code><a href="#topic+pprimarycensored">pprimarycensored()</a></code>.
</p>


<h3>Value</h3>

<p>Vector of primary event censored PMFs, normalized by D if finite
(truncation adjustment)
</p>


<h3>See Also</h3>

<p>Primary event censored distribution functions
<code><a href="#topic+pprimarycensored">pprimarycensored</a>()</code>,
<code><a href="#topic+rprimarycensored">rprimarycensored</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example: Weibull distribution with uniform primary events
dprimarycensored(c(0.1, 0.5, 1), pweibull, shape = 1.5, scale = 2.0)

# Example: Weibull distribution with exponential growth primary events
dprimarycensored(
  c(0.1, 0.5, 1), pweibull,
  dprimary = dexpgrowth,
  dprimary_args = list(r = 0.2), shape = 1.5, scale = 2.0
)
</code></pre>

<hr>
<h2 id='expgrowth'>Exponential growth distribution functions</h2><span id='topic+expgrowth'></span><span id='topic+dexpgrowth'></span><span id='topic+pexpgrowth'></span><span id='topic+rexpgrowth'></span>

<h3>Description</h3>

<p>Density, distribution function, and random generation for the exponential
growth distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dexpgrowth(x, min = 0, max = 1, r, log = FALSE)

pexpgrowth(q, min = 0, max = 1, r, lower.tail = TRUE, log.p = FALSE)

rexpgrowth(n, min = 0, max = 1, r)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expgrowth_+3A_x">x</code>, <code id="expgrowth_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_min">min</code></td>
<td>
<p>Minimum value of the distribution range. Default is 0.</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_max">max</code></td>
<td>
<p>Maximum value of the distribution range. Default is 1.</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_r">r</code></td>
<td>
<p>Rate parameter for the exponential growth.</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_log">log</code>, <code id="expgrowth_+3A_log.p">log.p</code></td>
<td>
<p>Logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_lower.tail">lower.tail</code></td>
<td>
<p>Logical; if TRUE (default), probabilities are P[X &lt;= x],
otherwise, P[X &gt; x].</p>
</td></tr>
<tr><td><code id="expgrowth_+3A_n">n</code></td>
<td>
<p>Number of observations. If <code>length(n) &gt; 1</code>, the length is taken to
be the number required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exponential growth distribution is defined on the interval [min, max]
with rate parameter (r). Its probability density function (PDF) is:
</p>
<p style="text-align: center;"><code class="reqn">f(x) = \frac{r \cdot \exp(r \cdot (x - min))}{\exp(r \cdot max) -
 \exp(r \cdot min)}</code>
</p>

<p>The cumulative distribution function (CDF) is:
</p>
<p style="text-align: center;"><code class="reqn">F(x) = \frac{\exp(r \cdot (x - min)) - \exp(r \cdot min)}{
 \exp(r \cdot max) - \exp(r \cdot min)}</code>
</p>

<p>For random number generation, we use the inverse transform sampling method:
</p>

<ol>
<li><p> Generate <code class="reqn">u \sim \text{Uniform}(0,1)</code>
</p>
</li>
<li><p> Set <code class="reqn">F(x) = u</code> and solve for <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">
   x = min + \frac{1}{r} \cdot \log(u \cdot (\exp(r \cdot max) -
  \exp(r \cdot min)) + \exp(r \cdot min))
   </code>
</p>

</li></ol>

<p>This method works because of the probability integral transform theorem,
which states that if <code class="reqn">X</code> is a continuous random variable with CDF
<code class="reqn">F(x)</code>, then <code class="reqn">Y = F(X)</code> follows a <code class="reqn">\text{Uniform}(0,1)</code>
distribution. Conversely, if <code class="reqn">U</code> is a <code class="reqn">\text{Uniform}(0,1)</code> random
variable, then <code class="reqn">F^{-1}(U)</code> has the same distribution as <code class="reqn">X</code>, where
<code class="reqn">F^{-1}</code> is the inverse of the CDF.
</p>
<p>In our case, we generate <code class="reqn">u</code> from <code class="reqn">\text{Uniform}(0,1)</code>, then solve
<code class="reqn">F(x) = u</code> for <code class="reqn">x</code> to get a sample from our exponential growth
distribution. The formula for <code class="reqn">x</code> is derived by algebraically solving
the equation:
</p>
<p style="text-align: center;"><code class="reqn">
u = \frac{\exp(r \cdot (x - min)) - \exp(r \cdot min)}{\exp(r \cdot max) -
 \exp(r \cdot min)}
</code>
</p>

<p>When <code class="reqn">r</code> is very close to 0 (<code class="reqn">|r| &lt; 1e-10</code>), the distribution
approximates a uniform distribution on [min, max], and we use a simpler
method to generate samples directly from this uniform distribution.
</p>


<h3>Value</h3>

<p><code>dexpgrowth</code> gives the density, <code>pexpgrowth</code> gives the distribution
function, and <code>rexpgrowth</code> generates random deviates.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rexpgrowth</code>, and is the
maximum of the lengths of the numerical arguments for the other functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- seq(0, 1, by = 0.1)
probs &lt;- dexpgrowth(x, r = 0.2)
cumprobs &lt;- pexpgrowth(x, r = 0.2)
samples &lt;- rexpgrowth(100, r = 0.2)

</code></pre>

<hr>
<h2 id='fitdistdoublecens'>Fit a distribution to doubly censored data</h2><span id='topic+fitdistdoublecens'></span>

<h3>Description</h3>

<p>This function wraps the custom approach for fitting distributions to doubly
censored data using fitdistrplus and primarycensored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitdistdoublecens(
  censdata,
  distr,
  pwindow = 1,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_name = lifecycle::deprecated(),
  dprimary_args = list(),
  truncation_check_multiplier = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitdistdoublecens_+3A_censdata">censdata</code></td>
<td>
<p>A data frame with columns 'left' and 'right' representing
the lower and upper bounds of the censored observations. Unlike
<code><a href="fitdistrplus.html#topic+fitdistcens">fitdistrplus::fitdistcens()</a></code> <code>NA</code> is not supported for either the
upper or lower bounds.</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_distr">distr</code></td>
<td>
<p>A character string naming the distribution to be fitted.</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_dprimary_name">dprimary_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>dprimary</code>
instead</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_truncation_check_multiplier">truncation_check_multiplier</code></td>
<td>
<p>Numeric multiplier to use for checking
if the truncation time D is appropriate relative to the maximum delay.
Set to NULL to skip the check. Default is 2.</p>
</td></tr>
<tr><td><code id="fitdistdoublecens_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="fitdistrplus.html#topic+fitdist">fitdistrplus::fitdist()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function temporarily assigns and then removes functions from the global
environment in order to work with fitdistr. Users should be aware of this
behaviour, especially if they have existing functions with the same names in
their global environment.
</p>


<h3>Value</h3>

<p>An object of class &quot;fitdist&quot; as returned by fitdistrplus::fitdist.
</p>


<h3>See Also</h3>

<p>Modelling wrappers for external fitting packages
<code><a href="#topic+pcd_as_stan_data">pcd_as_stan_data</a>()</code>,
<code><a href="#topic+pcd_cmdstan_model">pcd_cmdstan_model</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with normal distribution
set.seed(123)
n &lt;- 1000
true_mean &lt;- 5
true_sd &lt;- 2
pwindow &lt;- 2
swindow &lt;- 2
D &lt;- 10
samples &lt;- rprimarycensored(
  n, rnorm,
  mean = true_mean, sd = true_sd,
  pwindow = pwindow, swindow = swindow, D = D
)

delay_data &lt;- data.frame(
  left = samples,
  right = samples + swindow
)

fit_norm &lt;- fitdistdoublecens(
  delay_data,
  distr = "norm",
  start = list(mean = 0, sd = 1),
  D = D, pwindow = pwindow
)

summary(fit_norm)

</code></pre>

<hr>
<h2 id='new_pcens'>S3 class for primary event censored distribution computation</h2><span id='topic+new_pcens'></span>

<h3>Description</h3>

<p>S3 class for primary event censored distribution computation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_pcens(
  pdist,
  dprimary,
  dprimary_args,
  pdist_name = lifecycle::deprecated(),
  dprimary_name = lifecycle::deprecated(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_pcens_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id="new_pcens_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id="new_pcens_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id="new_pcens_+3A_pdist_name">pdist_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>pdist</code>
instead</p>
</td></tr>
<tr><td><code id="new_pcens_+3A_dprimary_name">dprimary_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>dprimary</code>
instead</p>
</td></tr>
<tr><td><code id="new_pcens_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to pdist</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code style="white-space: pre;">&#8288;pcens_{pdist_name}_{dprimary_name}&#8288;</code>. This
contains the primary event distribution, the delay distribution, the
delay distribution arguments, and any additional arguments. It can be
used with the <code>pcens_cdf()</code> function to compute the primary event censored
cdf.
</p>


<h3>See Also</h3>

<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+pcens_cdf">pcens_cdf</a>()</code>,
<code><a href="#topic+pcens_cdf.default">pcens_cdf.default</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pgamma_dunif">pcens_cdf.pcens_pgamma_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_plnorm_dunif">pcens_cdf.pcens_plnorm_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pweibull_dunif">pcens_cdf.pcens_pweibull_dunif</a>()</code>
</p>

<hr>
<h2 id='pcd_as_stan_data'>Prepare data for primarycensored Stan model</h2><span id='topic+pcd_as_stan_data'></span>

<h3>Description</h3>

<p>This function takes in delay data and prepares it for use with the
primarycensored Stan model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_as_stan_data(
  data,
  delay = "delay",
  delay_upper = "delay_upper",
  n = "n",
  pwindow = "pwindow",
  relative_obs_time = "relative_obs_time",
  dist_id,
  primary_id,
  param_bounds,
  primary_param_bounds,
  priors,
  primary_priors,
  compute_log_lik = FALSE,
  use_reduce_sum = FALSE,
  truncation_check_multiplier = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_as_stan_data_+3A_data">data</code></td>
<td>
<p>A data frame containing the delay data.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_delay">delay</code></td>
<td>
<p>Column name for observed delays (default: &quot;delay&quot;)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_delay_upper">delay_upper</code></td>
<td>
<p>Column name for upper bound of delays
(default: &quot;delay_upper&quot;)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_n">n</code></td>
<td>
<p>Column name for count of observations (default: &quot;n&quot;)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_pwindow">pwindow</code></td>
<td>
<p>Column name for primary window (default: &quot;pwindow&quot;)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_relative_obs_time">relative_obs_time</code></td>
<td>
<p>Column name for relative observation time
(default: &quot;relative_obs_time&quot;)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_dist_id">dist_id</code></td>
<td>
<p>Integer identifying the delay distribution:
You can use <code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id()</a></code> to get the dist ID for a
distribution or look at the <a href="#topic+pcd_distributions">pcd_distributions</a> data set.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_primary_id">primary_id</code></td>
<td>
<p>Integer identifying the primary distribution:
You can use <code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id()</a></code> to get the primary dist ID for a
distribution (make sure to select the &quot;primary&quot; type) or look at the
<a href="#topic+pcd_primary_distributions">pcd_primary_distributions</a> data set.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_param_bounds">param_bounds</code></td>
<td>
<p>A list with elements <code>lower</code> and <code>upper</code>, each a numeric
vector specifying bounds for the delay distribution parameters.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_primary_param_bounds">primary_param_bounds</code></td>
<td>
<p>A list with elements <code>lower</code> and <code>upper</code>, each a
numeric vector specifying bounds for the primary distribution parameters.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_priors">priors</code></td>
<td>
<p>A list with elements <code>location</code> and <code>scale</code>, each a numeric
vector specifying priors for the delay distribution parameters.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_primary_priors">primary_priors</code></td>
<td>
<p>A list with elements <code>location</code> and <code>scale</code>, each a
numeric vector specifying priors for the primary distribution parameters.</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_compute_log_lik">compute_log_lik</code></td>
<td>
<p>Logical; compute log likelihood? (default: FALSE)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_use_reduce_sum">use_reduce_sum</code></td>
<td>
<p>Logical; use reduce_sum for performance?
(default: FALSE)</p>
</td></tr>
<tr><td><code id="pcd_as_stan_data_+3A_truncation_check_multiplier">truncation_check_multiplier</code></td>
<td>
<p>Numeric multiplier to use for checking
if the truncation time D is appropriate relative to the maximum delay
for each unique D value. Set to NULL to skip the check. Default is 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the data formatted for use with
<code><a href="#topic+pcd_cmdstan_model">pcd_cmdstan_model()</a></code>
</p>


<h3>See Also</h3>

<p>Modelling wrappers for external fitting packages
<code><a href="#topic+fitdistdoublecens">fitdistdoublecens</a>()</code>,
<code><a href="#topic+pcd_cmdstan_model">pcd_cmdstan_model</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- data.frame(
  delay = c(1, 2, 3),
  delay_upper = c(2, 3, 4),
  n = c(10, 20, 15),
  pwindow = c(1, 1, 2),
  relative_obs_time = c(10, 10, 10)
)
stan_data &lt;- pcd_as_stan_data(
  data,
  dist_id = 1,
  primary_id = 1,
  param_bounds = list(lower = c(0, 0), upper = c(10, 10)),
  primary_param_bounds = list(lower = numeric(0), upper = numeric(0)),
  priors = list(location = c(1, 1), scale = c(1, 1)),
  primary_priors = list(location = numeric(0), scale = numeric(0))
)
</code></pre>

<hr>
<h2 id='pcd_cmdstan_model'>Create a CmdStanModel with primarycensored Stan functions</h2><span id='topic+pcd_cmdstan_model'></span>

<h3>Description</h3>

<p>This function creates a CmdStanModel object using the Stan model and
functions from primarycensored and optionally includes additional
user-specified Stan files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_cmdstan_model(include_paths = primarycensored::pcd_stan_path(), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_cmdstan_model_+3A_include_paths">include_paths</code></td>
<td>
<p>Character vector of paths to include for Stan
compilation. Defaults to the result of <code>pcd_stan_path()</code>.</p>
</td></tr>
<tr><td><code id="pcd_cmdstan_model_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to cmdstanr::cmdstan_model().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The underlying Stan model (<code>pcens_model.stan</code>) supports various features:
</p>

<ul>
<li><p> Multiple probability distributions for modeling delays
</p>
</li>
<li><p> Primary and secondary censoring
</p>
</li>
<li><p> Truncation
</p>
</li>
<li><p> Optional use of reduce_sum for improved performance (via
within chain parallelism).
</p>
</li>
<li><p> Flexible prior specifications
</p>
</li>
<li><p> Optional computation of log-likelihood for model comparison
</p>
</li></ul>



<h3>Value</h3>

<p>A CmdStanModel object.
</p>


<h3>See Also</h3>

<p>Modelling wrappers for external fitting packages
<code><a href="#topic+fitdistdoublecens">fitdistdoublecens</a>()</code>,
<code><a href="#topic+pcd_as_stan_data">pcd_as_stan_data</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!is.null(cmdstanr::cmdstan_version(error_on_NA = FALSE))) {
  model &lt;- pcd_cmdstan_model(compile = FALSE)
  model
}

</code></pre>

<hr>
<h2 id='pcd_dist_name'>Get distribution function cdf or pdf name</h2><span id='topic+pcd_dist_name'></span>

<h3>Description</h3>

<p>Get distribution function cdf or pdf name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_dist_name(name, type = c("delay", "primary"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_dist_name_+3A_name">name</code></td>
<td>
<p>String. Distribution name or alias</p>
</td></tr>
<tr><td><code id="pcd_dist_name_+3A_type">type</code></td>
<td>
<p>String. &quot;delay&quot; or &quot;primary&quot; corresponding to the type of
distribution to use as the look up. If delay then <code><a href="#topic+pcd_distributions">pcd_distributions()</a></code>
is used, if primary then <code><a href="#topic+pcd_primary_distributions">pcd_primary_distributions()</a></code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String distribution function name or NA if no base R implementation
</p>


<h3>See Also</h3>

<p>Utility functions for working with distributions
<code><a href="#topic+add_name_attribute">add_name_attribute</a>()</code>,
<code><a href="#topic+pcd_distributions">pcd_distributions</a></code>,
<code><a href="#topic+pcd_primary_distributions">pcd_primary_distributions</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pcd_dist_name("lnorm")
pcd_dist_name("lognormal")
pcd_dist_name("gamma")
pcd_dist_name("weibull")
pcd_dist_name("exp")
pcd_dist_name("unif", type = "primary")
pcd_dist_name("expgrowth", type = "primary")
</code></pre>

<hr>
<h2 id='pcd_distributions'>Supported delay distributions</h2><span id='topic+pcd_distributions'></span>

<h3>Description</h3>

<p>A dataset containing information about the supported delay distributions in
primarycensored. Includes both distributions with base R implementations and
those only available in Stan. Distributions beyond these are not supported
in the stan code but any user functions can be used in the R code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_distributions
</code></pre>


<h3>Format</h3>

<p>A data.frame with 17 rows and 4 columns:
</p>

<dl>
<dt>name</dt><dd><p>Distribution name</p>
</dd>
<dt>pdist</dt><dd><p>R distribution function name (e.g. plnorm), NA if there is no
base R implementation</p>
</dd>
<dt>aliases</dt><dd><p>Alternative names/identifiers</p>
</dd>
<dt>stan_id</dt><dd><p>Stan distribution ID used in the stan code</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Utility functions for working with distributions
<code><a href="#topic+add_name_attribute">add_name_attribute</a>()</code>,
<code><a href="#topic+pcd_dist_name">pcd_dist_name</a>()</code>,
<code><a href="#topic+pcd_primary_distributions">pcd_primary_distributions</a></code>
</p>

<hr>
<h2 id='pcd_load_stan_functions'>Load Stan functions as a string</h2><span id='topic+pcd_load_stan_functions'></span>

<h3>Description</h3>

<p>Load Stan functions as a string
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_load_stan_functions(
  functions = NULL,
  stan_path = primarycensored::pcd_stan_path(),
  wrap_in_block = FALSE,
  write_to_file = FALSE,
  output_file = "pcd_functions.stan"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_load_stan_functions_+3A_functions">functions</code></td>
<td>
<p>Character vector of function names to load. Defaults to all
functions.</p>
</td></tr>
<tr><td><code id="pcd_load_stan_functions_+3A_stan_path">stan_path</code></td>
<td>
<p>Character string, the path to the Stan code. Defaults to the
path to the Stan code in the primarycensored package.</p>
</td></tr>
<tr><td><code id="pcd_load_stan_functions_+3A_wrap_in_block">wrap_in_block</code></td>
<td>
<p>Logical, whether to wrap the functions in a
<code style="white-space: pre;">&#8288;functions{}&#8288;</code> block. Default is FALSE.</p>
</td></tr>
<tr><td><code id="pcd_load_stan_functions_+3A_write_to_file">write_to_file</code></td>
<td>
<p>Logical, whether to write the output to a file. Default
is FALSE.</p>
</td></tr>
<tr><td><code id="pcd_load_stan_functions_+3A_output_file">output_file</code></td>
<td>
<p>Character string, the path to write the output file if
write_to_file is TRUE. Defaults to &quot;pcd_functions.stan&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string containing the requested Stan functions
</p>


<h3>See Also</h3>

<p>Tools for working with package Stan functions
<code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id</a>()</code>,
<code><a href="#topic+pcd_stan_files">pcd_stan_files</a>()</code>,
<code><a href="#topic+pcd_stan_functions">pcd_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_path">pcd_stan_path</a>()</code>
</p>

<hr>
<h2 id='pcd_primary_distributions'>Supported primary event distributions</h2><span id='topic+pcd_primary_distributions'></span>

<h3>Description</h3>

<p>A dataset containing information about the supported primary event
distributions in primarycensored. Distributions beyond these are not
supported in the stan code but any user functions can be used in the R code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_primary_distributions
</code></pre>


<h3>Format</h3>

<p>A data.frame with 2 rows and 4 columns:
</p>

<dl>
<dt>name</dt><dd><p>Distribution name</p>
</dd>
<dt>dprimary</dt><dd><p>R density function name</p>
</dd>
<dt>aliases</dt><dd><p>Alternative names/identifiers</p>
</dd>
<dt>stan_id</dt><dd><p>Stan distribution ID used in the stan code</p>
</dd>
</dl>



<h3>See Also</h3>

<p>Utility functions for working with distributions
<code><a href="#topic+add_name_attribute">add_name_attribute</a>()</code>,
<code><a href="#topic+pcd_dist_name">pcd_dist_name</a>()</code>,
<code><a href="#topic+pcd_distributions">pcd_distributions</a></code>
</p>

<hr>
<h2 id='pcd_stan_dist_id'>Get distribution stan ID by name</h2><span id='topic+pcd_stan_dist_id'></span>

<h3>Description</h3>

<p>Get distribution stan ID by name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_stan_dist_id(name, type = c("delay", "primary"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_stan_dist_id_+3A_name">name</code></td>
<td>
<p>String. Distribution name or alias</p>
</td></tr>
<tr><td><code id="pcd_stan_dist_id_+3A_type">type</code></td>
<td>
<p>String. &quot;delay&quot; or &quot;primary&quot; corresponding to the type of
distribution to use as the look up. If delay then <code><a href="#topic+pcd_distributions">pcd_distributions()</a></code>
is used, if primary then <code><a href="#topic+pcd_primary_distributions">pcd_primary_distributions()</a></code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric distribution ID
</p>


<h3>See Also</h3>

<p>Tools for working with package Stan functions
<code><a href="#topic+pcd_load_stan_functions">pcd_load_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_files">pcd_stan_files</a>()</code>,
<code><a href="#topic+pcd_stan_functions">pcd_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_path">pcd_stan_path</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pcd_stan_dist_id("lnorm")
pcd_stan_dist_id("lognormal")
pcd_stan_dist_id("gamma")
pcd_stan_dist_id("weibull")
pcd_stan_dist_id("exp")
pcd_stan_dist_id("unif", type = "primary")
</code></pre>

<hr>
<h2 id='pcd_stan_files'>Get Stan files containing specified functions</h2><span id='topic+pcd_stan_files'></span>

<h3>Description</h3>

<p>This function retrieves Stan files from a specified directory, optionally
filtering for files that contain specific functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_stan_files(functions = NULL, stan_path = primarycensored::pcd_stan_path())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_stan_files_+3A_functions">functions</code></td>
<td>
<p>Character vector of function names to search for. If NULL,
all Stan files are returned.</p>
</td></tr>
<tr><td><code id="pcd_stan_files_+3A_stan_path">stan_path</code></td>
<td>
<p>Character string specifying the path to the directory
containing Stan files. Defaults to the Stan path of the primarycensored
package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of file paths to Stan files.
</p>


<h3>See Also</h3>

<p>Tools for working with package Stan functions
<code><a href="#topic+pcd_load_stan_functions">pcd_load_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id</a>()</code>,
<code><a href="#topic+pcd_stan_functions">pcd_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_path">pcd_stan_path</a>()</code>
</p>

<hr>
<h2 id='pcd_stan_functions'>Get Stan function names from Stan files</h2><span id='topic+pcd_stan_functions'></span>

<h3>Description</h3>

<p>This function reads all Stan files in the specified directory and extracts
the names of all functions defined in those files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_stan_functions(stan_path = primarycensored::pcd_stan_path())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcd_stan_functions_+3A_stan_path">stan_path</code></td>
<td>
<p>Character string specifying the path to the directory
containing Stan files. Defaults to the Stan path of the primarycensored
package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector containing unique names of all functions found in
the Stan files.
</p>


<h3>See Also</h3>

<p>Tools for working with package Stan functions
<code><a href="#topic+pcd_load_stan_functions">pcd_load_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id</a>()</code>,
<code><a href="#topic+pcd_stan_files">pcd_stan_files</a>()</code>,
<code><a href="#topic+pcd_stan_path">pcd_stan_path</a>()</code>
</p>

<hr>
<h2 id='pcd_stan_path'>Get the path to the Stan code</h2><span id='topic+pcd_stan_path'></span>

<h3>Description</h3>

<p>Get the path to the Stan code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcd_stan_path()
</code></pre>


<h3>Value</h3>

<p>A character string with the path to the Stan code
</p>


<h3>See Also</h3>

<p>Tools for working with package Stan functions
<code><a href="#topic+pcd_load_stan_functions">pcd_load_stan_functions</a>()</code>,
<code><a href="#topic+pcd_stan_dist_id">pcd_stan_dist_id</a>()</code>,
<code><a href="#topic+pcd_stan_files">pcd_stan_files</a>()</code>,
<code><a href="#topic+pcd_stan_functions">pcd_stan_functions</a>()</code>
</p>

<hr>
<h2 id='pcens_cdf'>Compute primary event censored CDF</h2><span id='topic+pcens_cdf'></span>

<h3>Description</h3>

<p>This function dispatches to either analytical solutions (if available) or
numerical integration via the default method. To see which combinations have
analytical solutions implemented, use <code>methods(pcens_cdf)</code>. For example,
<code>pcens_cdf.gamma_unif</code> indicates an analytical solution exists for gamma
delay with uniform primary event distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcens_cdf(object, q, pwindow, use_numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcens_cdf_+3A_object">object</code></td>
<td>
<p>A <code>primarycensored</code> object as created by
<code><a href="#topic+new_pcens">new_pcens()</a></code>.</p>
</td></tr>
<tr><td><code id="pcens_cdf_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pcens_cdf_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pcens_cdf_+3A_use_numeric">use_numeric</code></td>
<td>
<p>Logical, if TRUE forces use of numeric integration
even for distributions with analytical solutions. This is primarily
useful for testing purposes or for settings where the analytical solution
breaks down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of computed primary event censored CDFs
</p>


<h3>See Also</h3>

<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+new_pcens">new_pcens</a>()</code>,
<code><a href="#topic+pcens_cdf.default">pcens_cdf.default</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pgamma_dunif">pcens_cdf.pcens_pgamma_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_plnorm_dunif">pcens_cdf.pcens_plnorm_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pweibull_dunif">pcens_cdf.pcens_pweibull_dunif</a>()</code>
</p>

<hr>
<h2 id='pcens_cdf.default'>Default method for computing primary event censored CDF</h2><span id='topic+pcens_cdf.default'></span>

<h3>Description</h3>

<p>This method serves as a fallback for combinations of delay and primary
event distributions that don't have specific implementations. It uses
a numeric integration method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
pcens_cdf(object, q, pwindow, use_numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcens_cdf.default_+3A_object">object</code></td>
<td>
<p>A <code>primarycensored</code> object as created by
<code><a href="#topic+new_pcens">new_pcens()</a></code>.</p>
</td></tr>
<tr><td><code id="pcens_cdf.default_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pcens_cdf.default_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pcens_cdf.default_+3A_use_numeric">use_numeric</code></td>
<td>
<p>Logical, if TRUE forces use of numeric integration
even for distributions with analytical solutions. This is primarily
useful for testing purposes or for settings where the analytical solution
breaks down.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method implements the numerical integration approach for computing
the primary event censored CDF. It uses the same mathematical formulation
as described in the details section of <code><a href="#topic+pprimarycensored">pprimarycensored()</a></code>, but
applies numerical integration instead of analytical solutions.
</p>


<h3>Value</h3>

<p>Vector of computed primary event censored CDFs
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pprimarycensored">pprimarycensored()</a></code> for the mathematical details of the
primary event censored CDF computation.
</p>
<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+new_pcens">new_pcens</a>()</code>,
<code><a href="#topic+pcens_cdf">pcens_cdf</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pgamma_dunif">pcens_cdf.pcens_pgamma_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_plnorm_dunif">pcens_cdf.pcens_plnorm_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pweibull_dunif">pcens_cdf.pcens_pweibull_dunif</a>()</code>
</p>

<hr>
<h2 id='pcens_cdf.pcens_pgamma_dunif'>Method for Gamma delay with uniform primary</h2><span id='topic+pcens_cdf.pcens_pgamma_dunif'></span>

<h3>Description</h3>

<p>Method for Gamma delay with uniform primary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcens_pgamma_dunif'
pcens_cdf(object, q, pwindow, use_numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcens_cdf.pcens_pgamma_dunif_+3A_object">object</code></td>
<td>
<p>A <code>primarycensored</code> object as created by
<code><a href="#topic+new_pcens">new_pcens()</a></code>.</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pgamma_dunif_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pgamma_dunif_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pgamma_dunif_+3A_use_numeric">use_numeric</code></td>
<td>
<p>Logical, if TRUE forces use of numeric integration
even for distributions with analytical solutions. This is primarily
useful for testing purposes or for settings where the analytical solution
breaks down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of computed primary event censored CDFs
</p>


<h3>See Also</h3>

<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+new_pcens">new_pcens</a>()</code>,
<code><a href="#topic+pcens_cdf">pcens_cdf</a>()</code>,
<code><a href="#topic+pcens_cdf.default">pcens_cdf.default</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_plnorm_dunif">pcens_cdf.pcens_plnorm_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pweibull_dunif">pcens_cdf.pcens_pweibull_dunif</a>()</code>
</p>

<hr>
<h2 id='pcens_cdf.pcens_plnorm_dunif'>Method for Log-Normal delay with uniform primary</h2><span id='topic+pcens_cdf.pcens_plnorm_dunif'></span>

<h3>Description</h3>

<p>Method for Log-Normal delay with uniform primary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcens_plnorm_dunif'
pcens_cdf(object, q, pwindow, use_numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcens_cdf.pcens_plnorm_dunif_+3A_object">object</code></td>
<td>
<p>A <code>primarycensored</code> object as created by
<code><a href="#topic+new_pcens">new_pcens()</a></code>.</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_plnorm_dunif_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_plnorm_dunif_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_plnorm_dunif_+3A_use_numeric">use_numeric</code></td>
<td>
<p>Logical, if TRUE forces use of numeric integration
even for distributions with analytical solutions. This is primarily
useful for testing purposes or for settings where the analytical solution
breaks down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of computed primary event censored CDFs
</p>


<h3>See Also</h3>

<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+new_pcens">new_pcens</a>()</code>,
<code><a href="#topic+pcens_cdf">pcens_cdf</a>()</code>,
<code><a href="#topic+pcens_cdf.default">pcens_cdf.default</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pgamma_dunif">pcens_cdf.pcens_pgamma_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pweibull_dunif">pcens_cdf.pcens_pweibull_dunif</a>()</code>
</p>

<hr>
<h2 id='pcens_cdf.pcens_pweibull_dunif'>Method for Weibull delay with uniform primary</h2><span id='topic+pcens_cdf.pcens_pweibull_dunif'></span>

<h3>Description</h3>

<p>Method for Weibull delay with uniform primary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pcens_pweibull_dunif'
pcens_cdf(object, q, pwindow, use_numeric = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pcens_cdf.pcens_pweibull_dunif_+3A_object">object</code></td>
<td>
<p>A <code>primarycensored</code> object as created by
<code><a href="#topic+new_pcens">new_pcens()</a></code>.</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pweibull_dunif_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pweibull_dunif_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pcens_cdf.pcens_pweibull_dunif_+3A_use_numeric">use_numeric</code></td>
<td>
<p>Logical, if TRUE forces use of numeric integration
even for distributions with analytical solutions. This is primarily
useful for testing purposes or for settings where the analytical solution
breaks down.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of computed primary event censored CDFs
</p>


<h3>See Also</h3>

<p>Low level primary event censored distribution objects and methods
<code><a href="#topic+new_pcens">new_pcens</a>()</code>,
<code><a href="#topic+pcens_cdf">pcens_cdf</a>()</code>,
<code><a href="#topic+pcens_cdf.default">pcens_cdf.default</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_pgamma_dunif">pcens_cdf.pcens_pgamma_dunif</a>()</code>,
<code><a href="#topic+pcens_cdf.pcens_plnorm_dunif">pcens_cdf.pcens_plnorm_dunif</a>()</code>
</p>

<hr>
<h2 id='pprimarycensored'>Compute the primary event censored CDF for delays</h2><span id='topic+pprimarycensored'></span><span id='topic+ppcens'></span>

<h3>Description</h3>

<p>This function computes the primary event censored cumulative distribution
function (CDF) for a given set of quantiles. It adjusts the CDF of the
primary event distribution by accounting for the delay distribution and
potential truncation at a maximum delay (D). The function allows for
custom primary event distributions and delay distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pprimarycensored(
  q,
  pdist,
  pwindow = 1,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  pdist_name = lifecycle::deprecated(),
  dprimary_name = lifecycle::deprecated(),
  ...
)

ppcens(
  q,
  pdist,
  pwindow = 1,
  D = Inf,
  dprimary = stats::dunif,
  dprimary_args = list(),
  pdist_name = lifecycle::deprecated(),
  dprimary_name = lifecycle::deprecated(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pprimarycensored_+3A_q">q</code></td>
<td>
<p>Vector of quantiles</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_pdist">pdist</code></td>
<td>
<p>Distribution function (CDF). The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage the analytical solutions.</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_dprimary">dprimary</code></td>
<td>
<p>Function to generate the probability density function
(PDF) of primary event times. This function should take a value <code>x</code> and a
<code>pwindow</code> parameter, and return a probability density. It should be
normalized to integrate to 1 over [0, pwindow]. Defaults to a uniform
distribution over [0, pwindow]. Users can provide custom functions or use
helper functions like <code>dexpgrowth</code> for an exponential growth distribution.
See <code>primary_dists.R</code> for examples. The package can identify base R
distributions for potential analytical solutions. For non-base R functions,
users can apply <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> to yield properly tagged
functions if they wish to leverage analytical solutions.</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_dprimary_args">dprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to
dprimary. For example, when using <code>dexpgrowth</code>, you would
pass <code>list(min = 0, max = pwindow, r = 0.2)</code> to set the minimum, maximum,
and rate parameters</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_pdist_name">pdist_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>pdist</code>
instead</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_dprimary_name">dprimary_name</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a> this argument will be
ignored in future versions; use <code><a href="#topic+add_name_attribute">add_name_attribute()</a></code> on <code>dprimary</code>
instead</p>
</td></tr>
<tr><td><code id="pprimarycensored_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to pdist</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The primary event censored CDF is computed by integrating the product of
the delay distribution function (CDF) and the primary event distribution
function (PDF) over the primary event window. The integration is adjusted
for truncation if a finite maximum delay (D) is specified.
</p>
<p>The primary event censored CDF, <code class="reqn">F_{\text{cens}}(q)</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">
F_{\text{cens}}(q) = \int_{0}^{pwindow} F(q - p) \cdot f_{\text{primary}}(p)
\, dp
</code>
</p>

<p>where <code class="reqn">F</code> is the CDF of the delay distribution,
<code class="reqn">f_{\text{primary}}</code> is the PDF of the primary event times, and
<code class="reqn">pwindow</code> is the primary event window.
</p>
<p>If the maximum delay <code class="reqn">D</code> is finite, the CDF is normalized by dividing
by <code class="reqn">F_{\text{cens}}(D)</code>:
</p>
<p style="text-align: center;"><code class="reqn">
F_{\text{cens,norm}}(q) = \frac{F_{\text{cens}}(q)}{F_{\text{cens}}(D)}
</code>
</p>

<p>where <code class="reqn">F_{\text{cens,norm}}(q)</code> is the normalized CDF.
</p>
<p>This function creates a <code>primarycensored</code> object using
<code><a href="#topic+new_pcens">new_pcens()</a></code> and then computes the primary event
censored CDF using <code><a href="#topic+pcens_cdf">pcens_cdf()</a></code>. This abstraction allows
for automatic use of analytical solutions when available, while
seamlessly falling back to numerical integration when necessary.
</p>
<p>See <code>methods(pcens_cdf)</code> for which combinations have analytical
solutions implemented.
</p>


<h3>Value</h3>

<p>Vector of primary event censored CDFs, normalized by D if finite
(truncation adjustment)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+new_pcens">new_pcens()</a></code> and <code><a href="#topic+pcens_cdf">pcens_cdf()</a></code>
</p>
<p>Primary event censored distribution functions
<code><a href="#topic+dprimarycensored">dprimarycensored</a>()</code>,
<code><a href="#topic+rprimarycensored">rprimarycensored</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example: Lognormal distribution with uniform primary events
pprimarycensored(c(0.1, 0.5, 1), plnorm, meanlog = 0, sdlog = 1)

# Example: Lognormal distribution with exponential growth primary events
pprimarycensored(
  c(0.1, 0.5, 1), plnorm,
  dprimary = dexpgrowth,
  dprimary_args = list(r = 0.2), meanlog = 0, sdlog = 1
)
</code></pre>

<hr>
<h2 id='rprimarycensored'>Generate random samples from a primary event censored distribution</h2><span id='topic+rprimarycensored'></span><span id='topic+rpcens'></span>

<h3>Description</h3>

<p>This function generates random samples from a primary event censored
distribution. It adjusts the distribution by accounting for the primary
event distribution and potential truncation at a maximum delay (D). The
function allows for custom primary event distributions and delay
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rprimarycensored(
  n,
  rdist,
  pwindow = 1,
  swindow = 1,
  D = Inf,
  rprimary = stats::runif,
  rprimary_args = list(),
  oversampling_factor = 1.2,
  ...
)

rpcens(
  n,
  rdist,
  pwindow = 1,
  swindow = 1,
  D = Inf,
  rprimary = stats::runif,
  rprimary_args = list(),
  oversampling_factor = 1.2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rprimarycensored_+3A_n">n</code></td>
<td>
<p>Number of random samples to generate.</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_rdist">rdist</code></td>
<td>
<p>Function to generate random samples from the delay distribution
for example <code><a href="stats.html#topic+Lognormal">stats::rlnorm()</a></code> for lognormal distribution.</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_pwindow">pwindow</code></td>
<td>
<p>Primary event window</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_swindow">swindow</code></td>
<td>
<p>Integer specifying the window size for rounding the delay
(default is 1). If <code>swindow = 0</code> then no rounding is applied.</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_d">D</code></td>
<td>
<p>Maximum delay (truncation point). If finite, the distribution is
truncated at D. If set to Inf, no truncation is applied. Defaults to Inf.</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_rprimary">rprimary</code></td>
<td>
<p>Function to generate random samples from the primary
distribution (default is <code><a href="stats.html#topic+Uniform">stats::runif()</a></code>).</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_rprimary_args">rprimary_args</code></td>
<td>
<p>List of additional arguments to be passed to rprimary.</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_oversampling_factor">oversampling_factor</code></td>
<td>
<p>Factor by which to oversample the number of
samples to account for truncation (default is 1.2).</p>
</td></tr>
<tr><td><code id="rprimarycensored_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to the distribution function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The mathematical formulation for generating random samples from a primary
event censored distribution is as follows:
</p>

<ol>
<li><p> Generate primary event times (p) from the specified primary event
distribution (f_p) with parameters phi, defined between 0 and the primary
event window (pwindow):
</p>
<p style="text-align: center;"><code class="reqn">p \sim f_p(\phi), \quad p \in [0, pwindow]</code>
</p>

</li>
<li><p> Generate delays (d) from the specified delay distribution (f_d) with
parameters theta:
</p>
<p style="text-align: center;"><code class="reqn">d \sim f_d(\theta)</code>
</p>

</li>
<li><p> Calculate the total delays (t) by adding the primary event times and
the delays:
</p>
<p style="text-align: center;"><code class="reqn">t = p + d</code>
</p>

</li>
<li><p> Apply truncation (i.e. remove any delays that fall outside the observation
window) to ensure that the delays are within the specified range [0, D],
where D is the maximum observable delay:
</p>
<p style="text-align: center;"><code class="reqn">t_{truncated} = \{t \mid 0 \leq t &lt; D\}</code>
</p>

</li>
<li><p> Round the truncated delays to the nearest secondary event window
(swindow):
</p>
<p style="text-align: center;"><code class="reqn">t_{valid} = \lfloor \frac{t_{truncated}}{swindow} \rfloor
     \times swindow</code>
</p>

</li></ol>

<p>The function oversamples to account for potential truncation and generates
additional samples if needed to reach the desired number of valid samples.
</p>


<h3>Value</h3>

<p>Vector of random samples from the primary event censored
distribution censored by the secondary event window.
</p>


<h3>See Also</h3>

<p>Primary event censored distribution functions
<code><a href="#topic+dprimarycensored">dprimarycensored</a>()</code>,
<code><a href="#topic+pprimarycensored">pprimarycensored</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example: Lognormal distribution with uniform primary events
rprimarycensored(10, rlnorm, meanlog = 0, sdlog = 1)

# Example: Lognormal distribution with exponential growth primary events
rprimarycensored(
  10, rlnorm,
  rprimary = rexpgrowth, rprimary_args = list(r = 0.2),
  meanlog = 0, sdlog = 1
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
