<!DOCTYPE html><html><head><title>Help for package descomponer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {descomponer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cdf'><p>Get Auxiliary Matrix</p>
</a></li>
<li><a href='#celec'><p>Consumption of electricity in Spain</p></a></li>
<li><a href='#descomponer'><p> Time series decomposition</p>
</a></li>
<li><a href='#estimardf'><p> Prediction whit Regression in domain frequency</p></a></li>
<li><a href='#FFF'><p> Regression in Fourier Flexible Form</p>
</a></li>
<li><a href='#gdescomponer'><p>Plotting the trend and seasonal</p>
</a></li>
<li><a href='#gdf'><p>Get Frequency Data</p>
</a></li>
<li><a href='#gdt'><p>Get Time Data</p>
</a></li>
<li><a href='#gperiodograma'><p>Plotting method for specturm</p>
</a></li>
<li><a href='#gtd'><p>Plotting method for specturm</p>
</a></li>
<li><a href='#ipi'><p>Indice de Produccion Industrial de Cantabria</p></a></li>
<li><a href='#MW'><p>Get Frequency Data</p></a></li>
<li><a href='#periodograma'><p>Periodogram</p>
</a></li>
<li><a href='#PIB'><p>GDP Volume Index in Spain</p></a></li>
<li><a href='#predictFFF'><p> Prediction whit Regression in FFF</p></a></li>
<li><a href='#predictrdf'><p> Prediction whit Regression in domain frequency</p></a></li>
<li><a href='#rdf'><p> Regression in domain frequency</p>
</a></li>
<li><a href='#td'><p>Cumulative periodogram test</p>
</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Seasonal Adjustment by Frequency Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-08-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Francisco Parra  &lt;parra_fj@cantabria.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Francisco Parra  &lt;parra_fj@cantabria.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Decompose a time series into seasonal, trend and irregular components using transformations to amplitude-frequency domain.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 2.10)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-12 10:18:39 UTC; rstudio-user</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-12 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cdf'>Get Auxiliary Matrix

</h2><span id='topic+cdf'></span>

<h3>Description</h3>

<p>Gets the auxiliary matrix to vector  in time domain, pre-multiplies the vector by the orthogonal matrix,W, and its transpose, Parra F. (2013) 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf(y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of sine and cosine waves  adjusted to time-serie





</p>


<h3>Author(s)</h3>

<p>Francisco Parra 

</p>


<h3>References</h3>

<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100;x&lt;-seq(0,24*pi,length=n);y&lt;-sin(x)+rnorm(n,sd=.3)
cdf(y)


</code></pre>

<hr>
<h2 id='celec'>Consumption of electricity in Spain
</h2><span id='topic+celec'></span>

<h3>Description</h3>

<p>A vector: celec, Miles de Tep, 1995 a 2013 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(celec)</code></pre>


<h3>Source</h3>

<p>Instituto Nacional de Estadistica Spain</p>

<hr>
<h2 id='descomponer'> Time series decomposition

</h2><span id='topic+descomponer'></span>

<h3>Description</h3>

<p>Decompose a time series into seasonal, trend and irregular components using the transform amplitude-frequency domain to time series.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>descomponer(y,frequency,type)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="descomponer_+3A_y">y</code></td>
<td>
<p>a Vector of the observed time-serie values</p>
</td></tr>
<tr><td><code id="descomponer_+3A_frequency">frequency</code></td>
<td>
<p>Number of times in each unit time interval</p>
</td></tr>
<tr><td><code id="descomponer_+3A_type">type</code></td>
<td>
<p>lineal (1), quadratic(2)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>One could use a value of 7 for frequency when the data are sampled daily, and the natural time period is a week, or 4 and 12 when the data are sampled quarterly and monthly and the natural time period is a year.
</p>
<p>Transforms the time series in amplitude-frequency domain, by a band spectrum regresion (Parra, F. ,2013) of the serie y_t and a OLS lineal trend, in which regression is carried out in the low and the sesaonal amplitude-frequency_t .The low frequency are the periodicity a n/2*frequency or (n-1)/2*frequency , if n is odd. The seasonal frequency are the periodicity: 2n/2*frequency,3n/2*frequency,4n/2*frequency,.. .
</p>
<p>Use the &quot;sort.data.frame&quot; function, Kevin Wright 
(http://tolstoy.newcastle.edu.au/R/help/04/07/1076.html). 
</p>
<p>Slow computer in time series higher 1000 data.
</p>
<p>The output is a data.frame object.

</p>


<h3>Value</h3>

<table>
<tr><td><code>y</code></td>
<td>
<p>The Vector of the observed time-serievalues</p>
</td></tr>
<tr><td><code>TDST</code></td>
<td>
<p>The trend and seasonal time serie of y</p>
</td></tr>
<tr><td><code>TD</code></td>
<td>
<p>The trend time serie of y</p>
</td></tr>
<tr><td><code>ST</code></td>
<td>
<p>The seasonal time serie of y</p>
</td></tr>
<tr><td><code>IR</code></td>
<td>
<p>The remainder time serie of y</p>
</td></tr>
<tr><td><code>regresoresTD</code></td>
<td>
<p>The regressors matrix use to the trend estimated</p>
</td></tr>
<tr><td><code>regresoresST</code></td>
<td>
<p>The regressors matrix use to the seasonal estimated</p>
</td></tr>
<tr><td><code>coeficientesTD</code></td>
<td>
<p>The coefficient vector use to the trend estimated</p>
</td></tr>
<tr><td><code>coeficientesSD</code></td>
<td>
<p>The coefficient vector use to the seasonal estimated</p>
</td></tr>





</table>


<h3>References</h3>

<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ipi)
datos &lt;- descomponer(ipi,12,2)
plot(ts(datos$datos,frequency=12))
</code></pre>

<hr>
<h2 id='estimardf'> Prediction whit Regression in domain frequency
</h2><span id='topic+estimardf'></span>

<h3>Description</h3>

<p>Make a prediction for a rdf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimardf(a,b)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimardf_+3A_a">a</code></td>
<td>
<p>a model rdf </p>
</td></tr>
<tr><td><code id="estimardf_+3A_b">b</code></td>
<td>
<p>An optional data frame in which to look for variables with which to predict. If omitted, the fitted values are used.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Use predict.lm, with interval=&quot;prediction&quot;
</p>
<p>Slow computer in time series higher 1000 data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td></tr>
</table>


<h3>References</h3>

<p>DURBIN, J., &quot;Tests for Serial Correlation in Regression Analysis based on the Periodogram ofLeast-Squares Residuals,&quot; Biometrika, 56, (No. 1, 1969), 1-15.
</p>
<p>Engle, Robert F. (1974), Band Spectrum Regression,International Economic Review 15,1-11.
</p>
<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
data(celec)
mod1=rdf(celec,PIB)
newdata=c(20000)
estimardf(mod1,newdata)
</code></pre>

<hr>
<h2 id='FFF'> Regression in Fourier Flexible Form

</h2><span id='topic+FFF'></span>

<h3>Description</h3>

<p>Make a Fourier Flexible Form Regression 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>FFF(y,x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FFF_+3A_y">y</code></td>
<td>
<p>a Vector of the dependent variable</p>
</td></tr>
<tr><td><code id="FFF_+3A_x">x</code></td>
<td>
<p>a Vector of the  independent variable</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The regresion FFF use LM for fitted into the serie y_t and  the fourier coefficients expansion described in Gallant (1984).
</p>
<p>The output is a data.frame object.

</p>


<h3>Value</h3>

<table>
<tr><td><code>fitted</code></td>
<td>
<p>The time - serie fitted</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>The X time - series fourier coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>The time - serie fitted</p>
</td></tr>
</table>


<h3>References</h3>

<p>DURBIN, J., &quot;Tests for Serial Correlation in Regression Analysis based on the Periodogram ofLeast-Squares Residuals,&quot; Biometrika, 56, (No. 1, 1969), 1-15.
</p>
<p>Engle, Robert F. (1974), Band Spectrum Regression,International Economic Review 15,1-11.
</p>
<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Gallant; A. R.(1984), The Fourier Flexible Form. Amer. J. Agr. Econ.66(1984):204-15.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)
</p>
<p>Parra, F.(2021), Econometria con Series de Fourier
(https://econometria.files.wordpress.com/2020/12/curso-de-econometria-avanzado.pdf)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
data(celec)
FFF(celec,PIB)
</code></pre>

<hr>
<h2 id='gdescomponer'>Plotting the trend and seasonal

</h2><span id='topic+gdescomponer'></span>

<h3>Description</h3>

<p>Plotting the trend and seasonal of time series.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdescomponer(y,freq,type,year,q)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gdescomponer_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values    
</p>
</td></tr>
<tr><td><code id="gdescomponer_+3A_freq">freq</code></td>
<td>
<p>Number of times in each unit time interval    
</p>
</td></tr>
<tr><td><code id="gdescomponer_+3A_type">type</code></td>
<td>
<p>lineal (1), quadratic(2)    
</p>
</td></tr>
<tr><td><code id="gdescomponer_+3A_year">year</code></td>
<td>
<p>the year of the first observation    
</p>
</td></tr>
<tr><td><code id="gdescomponer_+3A_q">q</code></td>
<td>
<p>the time of the first observation    
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+descomponer">descomponer</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ipi)
gdescomponer(ipi,12,1,2002,1)
</code></pre>

<hr>
<h2 id='gdf'>Get Frequency Data

</h2><span id='topic+gdf'></span>

<h3>Description</h3>

<p>Transforms the data from the amplitude-time domain  the amplitude-frequency domain pre-multiplied by the orthogonal matrix ,W, whose elements are defined in Harvey A.C. (1978).

</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdf(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gdf_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-series values

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of the estimated coefficients fourier





</p>


<h3>Author(s)</h3>

<p>Francisco Parra 

</p>


<h3>References</h3>

<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+gdt">gdt</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100;x&lt;-seq(0,24*pi,length=n);y&lt;-sin(x)+rnorm(n,sd=.3)
gdf(y)


</code></pre>

<hr>
<h2 id='gdt'>Get Time Data

</h2><span id='topic+gdt'></span>

<h3>Description</h3>

<p>Transforms the data from the amplitude-frequency domain  the amplitude-time domain pre-multiplied by inverse of the orthogonal matrix ,W, whose elements are defined in Harvey A.C. (1978).

</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdt(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gdt_+3A_y">y</code></td>
<td>
<p>a vector of the coefficients fourier

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of the observed time-series values





</p>


<h3>Author(s)</h3>

<p>Francisco Parra 

</p>


<h3>References</h3>

<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+gdf">gdf</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100;x&lt;-seq(0,24*pi,length=n);y&lt;-sin(x)+rnorm(n,sd=.3)
coef &lt;- gdf(y)
gdt(coef)


</code></pre>

<hr>
<h2 id='gperiodograma'>Plotting method for specturm

</h2><span id='topic+gperiodograma'></span>

<h3>Description</h3>

<p>Plotting method for specturm calculate by periodograma function.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>gperiodograma(y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gperiodograma_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values

</p>
</td></tr>
</table>


<h3>References</h3>

<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+periodograma">periodograma</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100;x&lt;-seq(0,24*pi,length=n);y&lt;-sin(x)+rnorm(n,sd=.3)
gperiodograma(y)
</code></pre>

<hr>
<h2 id='gtd'>Plotting method for specturm

</h2><span id='topic+gtd'></span>

<h3>Description</h3>

<p>Plotting cumulative periodogram test.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>gtd(y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gtd_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values

</p>
</td></tr>

</table>


<h3>References</h3>

<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+td">td</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
gtd(PIB)
</code></pre>

<hr>
<h2 id='ipi'>Indice de Produccion Industrial de Cantabria
</h2><span id='topic+ipi'></span>

<h3>Description</h3>

<p>A vector: IPI, Base: 2010. Enero 2002 a Abril 2014 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ipi)</code></pre>


<h3>Source</h3>

<p>Instituto Nacional de Estadistica Spain</p>

<hr>
<h2 id='MW'>Get Frequency Data
</h2><span id='topic+MW'></span>

<h3>Description</h3>

<p>Orthogonal matrix defined in Harvey (1978)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MW(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MW_+3A_n">n</code></td>
<td>
<p>rows and columuns number  
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Orthogonal matrix of n X n dimensions
</p>


<h3>Author(s)</h3>

<p>Francisco Parra 

</p>


<h3>References</h3>

<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>



<h3>See Also</h3>

<p><code><a href="#topic+gdt">gdt</a>,<a href="#topic+gdf">gdf</a>,<a href="#topic+cdf">cdf</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>MW(80)


</code></pre>

<hr>
<h2 id='periodograma'>Periodogram

</h2><span id='topic+periodograma'></span>

<h3>Description</h3>

<p>Calculates and displays the spectrum of the time serie

</p>


<h3>Usage</h3>

<pre><code class='language-R'>periodograma(y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodograma_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values    
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>frecuencia</code></td>
<td>
<p>  Vector of frequencies at which the spectral density is estimated. The units are the reciprocal of cycles per unit time.</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>Is calculated by pi*frecuencia/(n/2) </p>
</td></tr>
<tr><td><code>periodos</code></td>
<td>
<p>n/frecuencia</p>
</td></tr>
<tr><td><code>densidad</code></td>
<td>
<p>Vector of estimates of the spectral density at frequencies corresponding to frecuencia.</p>
</td></tr>





</table>


<h3>References</h3>

<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+gperiodograma">gperiodograma</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n&lt;-100;x&lt;-seq(0,24*pi,length=n);y&lt;-sin(x)+rnorm(n,sd=.3)
periodograma(y)
</code></pre>

<hr>
<h2 id='PIB'>GDP Volume Index in Spain
</h2><span id='topic+PIB'></span>

<h3>Description</h3>

<p>A vector: PIB, Base: 2010. 1995 a 2013 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PIB)</code></pre>


<h3>Source</h3>

<p>Instituto Nacional de Estadistica Spain</p>

<hr>
<h2 id='predictFFF'> Prediction whit Regression in FFF
</h2><span id='topic+predictFFF'></span>

<h3>Description</h3>

<p>Make a prediction for a rdf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictFFF(y,x,new)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictFFF_+3A_y">y</code></td>
<td>
<p>a Vector of the dependent variable</p>
</td></tr>
<tr><td><code id="predictFFF_+3A_x">x</code></td>
<td>
<p>a Vector of the  independent variable</p>
</td></tr>  
<tr><td><code id="predictFFF_+3A_new">new</code></td>
<td>
<p>A data frame in which to look for variables with which to predict. If omitted, the fitted values are used.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Use predict.lm, with interval=&quot;confidence&quot;
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td></tr>
</table>


<h3>References</h3>

<p>DURBIN, J., &quot;Tests for Serial Correlation in Regression Analysis based on the Periodogram ofLeast-Squares Residuals,&quot; Biometrika, 56, (No. 1, 1969), 1-15.
</p>
<p>Engle, Robert F. (1974), Band Spectrum Regression,International Economic Review 15,1-11.
</p>
<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Gallant; A. R.(1984), The Fourier Flexible Form. Amer. J. Agr. Econ.66(1984):204-15.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)
</p>
<p>Parra, F.(2021), Econometria con Series de Fourier
(https://econometria.files.wordpress.com/2020/12/curso-de-econometria-avanzado.pdf)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ipi")
t=seq(1:length(ipi))
Mod1=FFF(ipi,t)
plot(ipi)
lines(Mod1$fitted)
new=(length(t)+1):(length(t)+12)
Mod2=predictFFF(ipi,t,new)
</code></pre>

<hr>
<h2 id='predictrdf'> Prediction whit Regression in domain frequency
</h2><span id='topic+predictrdf'></span>

<h3>Description</h3>

<p>Make a prediction for a rdf object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictrdf(a,b)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictrdf_+3A_a">a</code></td>
<td>
<p>a model rdf </p>
</td></tr>
<tr><td><code id="predictrdf_+3A_b">b</code></td>
<td>
<p>An optional data frame in which to look for variables with which to predict. If omitted, the fitted values are used.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p> Use predict.lm, with interval=&quot;prediction&quot;
</p>
<p>Slow computer in time series higher 1000 data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>vector or matrix as above</p>
</td></tr>
</table>


<h3>References</h3>

<p>DURBIN, J., &quot;Tests for Serial Correlation in Regression Analysis based on the Periodogram ofLeast-Squares Residuals,&quot; Biometrika, 56, (No. 1, 1969), 1-15.
</p>
<p>Engle, Robert F. (1974), Band Spectrum Regression,International Economic Review 15,1-11.
</p>
<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
data(celec)
mod1=rdf(celec,PIB)
newdata=c(100)
predictrdf(mod1,newdata)
</code></pre>

<hr>
<h2 id='rdf'> Regression in domain frequency

</h2><span id='topic+rdf'></span>

<h3>Description</h3>

<p>Make a Band Spectrum Regression using the comun frequencies in cross-spectrum  .

</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdf(y,x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rdf_+3A_y">y</code></td>
<td>
<p>a Vector of the dependent variable</p>
</td></tr>
<tr><td><code id="rdf_+3A_x">x</code></td>
<td>
<p>a Vector of the  independent variable</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Transforms the time series in amplitude-frequency domain, order the fourier coefficient by the comun frequencies in cross-spectrum, make a band spectrum regresion (Parra, F. ,2013) of the serie y_t and x_t for every set of fourier coefficients, and select the model to pass the Durbin test in the significance chosen.
</p>
<p>If not find significance for Band Spectrum Regression, make a OLS.
</p>
<p>The generalized cross validation (gcv), is caluculated by: 
gcv=n*sse/((n-k)^2)
</p>
<p>where &quot;sse&quot; is the residual sums of squares, &quot;n&quot; the observation, and k the coefficients used in the band spectrum regression.
</p>
<p>Slow computer in time series higher 1000 data.
</p>
<p>The output is a data.frame object.

</p>


<h3>Value</h3>

<table>
<tr><td><code>datos$Y</code></td>
<td>
<p>The Y time-serie</p>
</td></tr>
<tr><td><code>datos$X</code></td>
<td>
<p>The X time-serie</p>
</td></tr>
<tr><td><code>datos$F</code></td>
<td>
<p>The time - serie fitted</p>
</td></tr>
<tr><td><code>datos$reg</code></td>
<td>
<p>The error time-serie </p>
</td></tr>
<tr><td><code>Fregresores</code></td>
<td>
<p>The  matrix of regressors choosen in frequency domain</p>
</td></tr>
<tr><td><code>Tregresores</code></td>
<td>
<p>The  matrix of regressors choosen in time domain</p>
</td></tr>
<tr><td><code>Nregresores</code></td>
<td>
<p>The coefficient number of fourier chosen</p>
</td></tr>
<tr><td><code>sse</code></td>
<td>
<p>Residual sums of squares</p>
</td></tr>
<tr><td><code>gcv</code></td>
<td>
<p>Generalized Cross Validation</p>
</td></tr>
</table>


<h3>References</h3>

<p>DURBIN, J., &quot;Tests for Serial Correlation in Regression Analysis based on the Periodogram ofLeast-Squares Residuals,&quot; Biometrika, 56, (No. 1, 1969), 1-15.
</p>
<p>Engle, Robert F. (1974), Band Spectrum Regression,International Economic Review 15,1-11.
</p>
<p>Harvey, A.C. (1978), Linear Regression in the Frequency Domain, International Economic Review, 19, 507-512.
</p>
<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
data(celec)
rdf(celec,PIB)
</code></pre>

<hr>
<h2 id='td'>Cumulative periodogram test

</h2><span id='topic+td'></span>

<h3>Description</h3>

<p>Cumulative periodogram test.

</p>


<h3>Usage</h3>

<pre><code class='language-R'>td(y)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="td_+3A_y">y</code></td>
<td>
<p>a vector of the observed time-serie values

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output is a data.frame object.

</p>


<h3>Value</h3>

<table>
<tr><td><code>s2</code></td>
<td>
<p> Cumulative periodogram.</p>
</td></tr>
<tr><td><code>min</code></td>
<td>
<p>Is calculated by  -c+(t/length(y)) </p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>Is calculated by  c+(t/length(y))</p>
</td></tr>
</table>


<h3>References</h3>

<p>Parra, F. (2014), Amplitude time-frequency regression, (http://econometria.wordpress.com/2013/08/21/estimation-of-time-varying-regression-coefficients/)

</p>


<h3>See Also</h3>

<p><code><a href="#topic+periodograma">periodograma</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PIB)
td(PIB)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
