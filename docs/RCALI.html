<!DOCTYPE html><html><head><title>Help for package RCALI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RCALI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RCALI-package'>
<p>Calculation of the Integrated Flow of Particles Between Polygons</p></a></li>
<li><a href='#as.poly'><p> Create an object  of class 'poly'</p></a></li>
<li><a href='#califlopp'><p> Calculation of the Integrated Flow of Particles</p>
between Polygons</a></li>
<li><a href='#crlistpoly'><p> Create an object of class 'listpoly' from objects of class 'poly'</p></a></li>
<li><a href='#crpoly'><p> Create un object of class 'poly' by clicking on points</p></a></li>
<li><a href='#export'><p> Generic for 'export'</p></a></li>
<li><a href='#export.default'><p>export.default method</p></a></li>
<li><a href='#export.listpoly'><p> Create a polygons file  in format 1.</p></a></li>
<li><a href='#fpollen'><p> Individual pollen dispersion function</p></a></li>
<li><a href='#fseed'><p> Individual seed dispersion function</p></a></li>
<li><a href='#generPoly'><p>  Generate a regular grid of polygons</p></a></li>
<li><a href='#generVois'><p> Generate the neighbors of each polygon of a regular grid</p></a></li>
<li><a href='#getRes'><p> Read a result-file of 'califlopp'</p></a></li>
<li><a href='#listpoly-class'><p>Class 'listpoly'</p></a></li>
<li><a href='#plot.listpoly'><p> Plot of an object of class 'listpoly'</p></a></li>
<li><a href='#plot.poly'><p> Plot of an object of class 'poly'</p></a></li>
<li><a href='#poly-class'><p>Class 'poly'</p></a></li>
<li><a href='#range.listpoly'><p> Range of the coordinates of an object</p>
of class 'listpoly'</a></li>
<li><a href='#readpoly1'><p> Read a  polygons file in format 1</p></a></li>
<li><a href='#readpoly2'><p> Read a  polygons file in format 2</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Calculation of the Integrated Flow of Particles Between Polygons</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-16</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Annie Bouvier [aut, cph],
  Kien Kieu [aut, cph],
  Kasia Adamczyk [aut, cph],
  Herve Monod [aut, cph],
  Jean-Francois Rey [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jean-Francois Rey &lt;jean-francois.rey@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculate the flow of particles between polygons by two integration methods:
  integration by a cubature method and integration on a grid of points.
  Annie Bouvier, Kien Kieu, Kasia Adamczyk and Herve Monod (2009)
  &lt;<a href="https://doi.org/10.1016%2Fj.envsoft.2008.11.006">doi:10.1016/j.envsoft.2008.11.006</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.paca.inrae.fr/biosp/RCALI">https://gitlab.paca.inrae.fr/biosp/RCALI</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>splancs, graphics, grDevices, methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 13:58:15 UTC; jfrey</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='RCALI-package'>
Calculation of the Integrated Flow of Particles Between Polygons
</h2><span id='topic+RCALI-package'></span><span id='topic+RCALI'></span>

<h3>Description</h3>

<p>Calculate the flow of particles between polygons by two integration methods: integration by a cubature method and integration on a grid of points.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> splancs</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or later</td>
</tr>
<tr>
 <td style="text-align: left;">
This package is an interface between R and the programme CaliFloPP: </td>
</tr>
<tr>
 <td style="text-align: left;">
<a href="http://genome.jouy.inra.fr/logiciels/califlopp/">http://genome.jouy.inra.fr/logiciels/califlopp/</a></td>
</tr>
<tr>
 <td style="text-align: left;">
 News</td><td style="text-align: left;">             <code>file.show(system.file("NEWS", package="RCALI"))</code></td>
</tr>
<tr>
 <td style="text-align: left;">
Main function: </td><td style="text-align: left;"> <code><a href="#topic+califlopp">califlopp</a></code>
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Annie Bouvier &lt;annie.bouvier@inra.fr&gt;
</p>

<hr>
<h2 id='as.poly'> Create an object  of class 'poly' </h2><span id='topic+as.poly'></span>

<h3>Description</h3>

<p>Create an object of class <code>"<a href="#topic+poly-class">poly</a>"</code> from two vectors or from a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.poly(x, y=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.poly_+3A_x">x</code></td>
<td>
<p> vector of x-coordinates or two-columns matrix  </p>
</td></tr>
<tr><td><code id="as.poly_+3A_y">y</code></td>
<td>
<p> vector of y-coordinates when 'x' is a vector. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"<a href="#topic+poly-class">poly</a>"</code>, i.e a two-columns matrix  labelled &quot;xcoord&quot;, &quot;ycoord&quot;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+crpoly">crpoly</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># A triangle
a &lt;- as.poly(matrix(c(2,2,2,3,3,3), ncol=2, byrow=TRUE))
</code></pre>

<hr>
<h2 id='califlopp'> Calculation of the Integrated Flow of Particles
between Polygons</h2><span id='topic+califlopp'></span>

<h3>Description</h3>

<p>Calculation of the flow of particles between polygons by two integration methods: integration by a cubature method and
integration on a grid of points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>califlopp(file, dispf=c(1,2), param=NULL, resfile = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="califlopp_+3A_file">file</code></td>
<td>
<p> Pathname of the polygons-file. See details. </p>
</td></tr>
<tr><td><code id="califlopp_+3A_dispf">dispf</code></td>
<td>
<p> The required dispersion functions. Vector of integers  or vector of R functions. The maximum length of this vector is 5.
</p>

<ul>
<li><p>    If vector of integers, the dispersion functions are
then compiled. Five are provided.  To modify them, see
Details.
By default, 
1 is for dispersal of oilseed rape pollen, 2 for dispersal
of oilseed rape seed (dispersals of oilseed rape are the ones
defined in <em>GeneSys</em> - see References),
3 for the constant function, 4 for an
anisotropic version of the dispersal of yellow rust of wheat defined
in <em>Soubeyrand and all</em>, 5 for a discontinuous function.<br />
These functions are viewable in the C file <code>src/functions.cc</code>.
To modify them, see Details.
</p>
</li>
<li><p>    If vector of functions, the dispersion functions are coded in R
(more time consuming than compiled version). Two R dispersal functions are provided,  <code><a href="#topic+fpollen">fpollen</a></code> and
<code><a href="#topic+fseed">fseed</a></code>, the functions used in Genesys.
To specify your own function, see details.
</p>
</li></ul>

</td></tr>
<tr><td><code id="califlopp_+3A_param">param</code></td>
<td>
<p> Optional list of parameters. Valid components are
<code>input</code>, <code>output</code>,
<code>verbose</code>, <code>warn.poly</code>, <code>warn.conv</code>,<code>delim</code>,
<code>poly</code>, <code>send.and.receive</code>, <code>method</code>, <code>dz</code>, <code>dp</code>.
In addition, when <code>method</code> is &ldquo;<code>cub</code>&rdquo;: <code>maxpts</code>,
<code>reler</code>, <code>abser</code>, <code>tz</code>.
When <code>method</code> is &ldquo;<code>grid</code>&rdquo;: <code>seed</code>,
<code>step</code>, <code>nr</code>.
See details. </p>
</td></tr>
<tr><td><code id="califlopp_+3A_resfile">resfile</code></td>
<td>
<p>  Optional pathname of a result-file. When set,
the results are written on it. This file can be read
by using  function
<code><a href="#topic+getRes">getRes</a></code> or <code><a href="utils.html#topic+read.table">read.table</a></code>. See details, as to the content of the file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>The polygons-file</b>
</p>
<p>The coordinates of the polygons should be provided in an ASCII file,
denoted here &quot;polygons-file&quot;. The unit is the meter. The vertices should
be ordered clockwise. The polygons can be closed
or not, but  without holes. The first line contains the number of polygons.
The following lines depend of the <code>input</code>
parameter:
</p>

<dl>
<dt><code>input=1</code></dt><dd><p> Two lines per polygon: on the first one,
an identifier (a positive
integer),   followed by the x-coordinates,
on the second one, the same identifier
followed by the y-coordinates. The function
<a href="#topic+export.listpoly">export.listpoly</a> generates such a file from R structures</p>
</dd>
<dt><code>input=2</code></dt><dd><p> Three lines per polygon: on the first one,
an identifier (a positive
integer),   followed by a name for the polygon and
by the number of its vertices, on the second one, the x-coordinates,
and on the third one, the y-coordinates.</p>
</dd>
</dl>

<p><b>The individual dispersion functions</b>
</p>
<p>The individual dispersion functions can  either be compiled
or R functions.
</p>

<dl>
<dt>
<em>Compiled function:</em></dt><dd><p> Five compiled dispersal functions are
provided (see argument <code>dispf</code>). To  replace them by yours,
you have to download the source of <code>RCALI</code>,
modify and compile it.<br /> 
</p>
<p>Suppose that you have download the tar-archive
in the directory <code>MyDir</code>.
The steps to customize the dispersion functions are:
</p>
<p>1/ Replace one or several functions in
<code>MyDir/RCALI/src/functions.cc</code> by yours:
The dispersion function has one argument,
the current point, <code>p</code>, of class <code>Point</code>.
You can use <code>p.getX()</code>
and <code>p.getY()</code> to get the coordinates of the current point
(in meters*<code>SCALE</code>, where <code>SCALE</code> is the  rescaling
parameter defined in the file <code>src/calicinfig.h</code>),
<code>p.dist0()</code>, the distance of <code>p</code>
from the origin (in meters*<code>SCALE</code>)
and <code>p.angle0()</code>, the angle (in degrees, in <code class="reqn">[-\pi, +\pi]</code>) between the line  (0,<code>p</code>)
and the horizontal   line.
</p>
<p>2/ Create a directory <code>MyDir/RCALI/libs</code>,
place you in <code>MyDir/RCALI/src</code> and  type in:
</p>
<pre>R CMD SHLIB -o ../libs/RCALI.so  *.cc</pre>
<p>to create the compiled shared library.
</p>
<p>3/ To use in a R-session:
</p>
<pre>
      source("MyDir/RCALI/R/sourceDir.R")
      sourceDir("MyDir/RCALI/R")
      dyn.load("MyDir/RCALI/libs/RCALI.so")
  </pre>
<p>The help-files are viewable by opening in a browser
<code>MyDir/RCALI/inst/doc/html/00Index.html</code>
</p>
</dd>
</dl>
<p>You can also build  the tar.gz file again, after modifications,
and install it as a library
by using the standard R commands <code>R CMD build</code> and
<code>R CMD INSTALL --html</code>. 
</p>
<dl>
<dt><em>R function:</em></dt><dd><p>  Two R dispersal functions are provided,  <code><a href="#topic+fpollen">fpollen</a></code> and
<code><a href="#topic+fseed">fseed</a></code>, the functions used in Genesys.<br />
You can define your own R dispersal function:
it should have one vector
argument,  the localization of the current point, <code>p</code>.
The first element of this vector is the distance of <code>p</code> from the origin
(in meters) and the second one is the angle (in degrees, in <code class="reqn">[-\pi, +\pi]</code>) between the line  (0,<code>p</code>)
and the horizontal   line (i.e, stating <code>x</code> and <code>y</code> are the coordinates
of <code>p</code>, the angle is
<code class="reqn">atan2(y,x)*\frac{180}{\pi}</code>)
</p>
</dd></dl>

<p><b>The parameters</b>
</p>
<p>The argument <code>param</code> is a list which valid components are:
</p>

<dl>
<dt><code>input</code></dt><dd><p> format of the polygons-file. 1 or 2 (see above).
Default 2</p>
</dd>
<dt><code>output</code></dt><dd><p> output required  on the screen:
0 nothing, 1: all  results, 2:  progression numbers,
3: the integrated flows and their means per squared meter.
Default 1</p>
</dd>
<dt><code>verbose</code></dt><dd><p> TRUE, if output is required about polygons convexity
and landscape translation. Default FALSE</p>
</dd>
<dt><code>warn.poly</code></dt><dd><p> TRUE, if output is required about polygons simplification. Default FALSE</p>
</dd>
<dt><code>warn.conv</code></dt><dd><p> TRUE, if output is required when
cubature convergence is not reached. Default TRUE</p>
</dd>
<dt><code>delim</code></dt><dd><p> separator character between values in the polygons-file. Default: tabulate</p>
</dd>
<dt><code>send.and.receive</code></dt><dd><p> TRUE, if results are required from
sending polygons to target polygons and from target polygons to
sending polygons (case of anisotropic functions). Default FALSE</p>
</dd>
<dt><code>poly</code></dt><dd><p> required pairs of polygons.
List of vectors of length 2, or two-columns  matrix.
If only one pair is required, it may be a vector of length 2.
Default: all pairs of polygons.</p>
</dd>
<dt><code>method</code></dt><dd><p> string equal to <code>cub</code> for cubature method, <code>grid</code> for the grid
method. Default: <code>cub</code></p>
</dd>
<dt><code>dz</code></dt><dd><p> integer vector, whose length is greater or equal to the number of
required dispersion functions. <code>dz[i]</code> is the distance in meters
beyond which the <code>i</code>st dispersion function is considered as
nul. Default in a standard configuration: 0,21,0,1000,0
for functions number 1 to 5, respectively.</p>
</dd>
<dt><code>dp</code></dt><dd><p> integer vector, whose length is greater or equal
to the number of
required dispersion functions. <code>dp[i]</code> is the distance in meters
beyond which the <code>i</code>st dispersion function is calculated between
centroids only. Default in a standard configuration: 100, 0, 0,
500, 0
for functions number 1 to 5, respectively.</p>
</dd></dl>

<p>In addition, when <code>method</code>  is <code>cub</code>:
</p>

<dl>
<dt><code>maxpts</code></dt><dd><p> maximal
number of evaluation points required for each function.
Vector of length equal to the number of required functions.
Default in a standard configuration: 100000 </p>
</dd>
<dt><code>reler</code></dt><dd><p> relative error required for each function.
Vector of length equal to the number of required functions.
Should be positive when method is cubature.
Default in a standard configuration: 1.0e-3 </p>
</dd>
<dt><code>abser</code></dt><dd><p> absolute error required for each function.
Vector of length equal to the number of required functions.
Should be positive when method is cubature.
Default in a standard configuration: 1.0e-3</p>
</dd>
<dt><code>tz</code></dt><dd><p> integer vector, whose length is greater
or equal       to the number of
required dispersion functions. Mode of triangulation for the
cubature method.
<code>tz[i]</code> should be 1, if, for the <code>i</code>st dispersion
function,
triangulation from (0,0) has to be done
when  (0,0) is included in the integration area and, 0 if not.
1 is recommended  when the dispersion function is very &quot;sharp&quot;
at the origin. Default in a standard configuration: 0,1,0,0,0
for functions number 1 to 5, respectively.</p>
</dd></dl>

<p>When  <code>method</code> is <code>grid</code>:
</p>

<dl>
<dt><code>seed</code></dt><dd><p> seed of the random generator.</p>
</dd>
<dt><code>step</code></dt><dd><p> step of the grid on the x-axis and on the y-axis
in meter. Vector of length 2.</p>
</dd>
<dt><code>nr</code></dt><dd><p> maximal number of replications or grids.</p>
</dd></dl>

<p><b>The result-file</b>
</p>
<p>When the argument <code>resfile</code> is set, a file is created.
On this file, the values are separated by tabulates.
</p>
<p>Its contains, when the method is <code>cub</code>,
</p>

<dl>
<dt> on the first line:</dt><dd><p> &quot;npoly:&quot;,	&quot;input-file:&quot;,
&quot;nfunc:&quot;,	&quot;method:&quot;, each of these identifiers
followed by the actual values.
</p>
</dd>
<dt> on each of the following lines, the results for a couple of
polygons:</dt><dd><p> the identifiers of both polygons;
the integrated flow divided by the area of the second
polygon, for
each dispersal function;
the areas of both polygons; then, for
each dispersal function,
the integrated flow, the lower and upper bounds
of the confidence interval, the absolute error, and the
number of evaluations.</p>
</dd></dl>

<p>Its contains, when the method is <code>grid</code>,
</p>

<dl>
<dt> on the first line:</dt><dd><p> &quot;npoly:&quot;,	&quot;input-file:&quot;,
&quot;nfunc:&quot;,	&quot;method:&quot;, &quot;stepx:&quot;, &quot;stepy:&quot;, each of these identifiers
followed by the actual values.
</p>
</dd>
<dt> on each of the following lines, the results for a couple of
polygons:</dt><dd><p> the identifiers of both polygons;
the integrated flow divided by the area of the second
polygon, for
each dispersal function;
the areas of both polygons; then, for
each dispersal function,
the integrated flow, and the standard deviation.
</p>
</dd></dl>

<p>This file can be read in a R-session by using the function
<code><a href="#topic+getRes">getRes</a></code> or <code><a href="utils.html#topic+read.table">read.table</a></code>, with option
<code>skip=1</code>.
</p>


<h3>Value</h3>

<p>Nothing. To store the results, set the argument <code>resfile</code>,
then use the function
<code><a href="#topic+getRes">getRes</a></code> or <code><a href="utils.html#topic+read.table">read.table</a></code>, with option
<code>skip=1</code></p>


<h3>Side effect</h3>

<p>This function creates a temporary file to store the
parameters, usually in the directory <code>tmp</code> of the user. This file
is destroyed at the end of execution.</p>


<h3>Author(s)</h3>

<p> A. Bouvier </p>


<h3>References</h3>

<p>  - The CaliFloPP software: <a href="http://genome.jouy.inra.fr/logiciels/califlopp/">http://genome.jouy.inra.fr/logiciels/califlopp/</a> <br />
- Main reference paper: A. Bouvier, K. Kieu, K. Adamczyk, and H. Monod. Computation of
integrated flow of particles between polygons. Environmental Modelling
&amp; Software, 24:843&ndash;849, 2009.<br />
- N. Colbach, and all.Genesys: a model of the influence of cropping
system on gene escape from herbicide tolerant rapeseed crops to rape
volunteers. Agriculture, Ecosystems and Environnement, 83:235&ndash;270, 2001. </p>


<h3>See Also</h3>

  <p><code><a href="#topic+getRes">getRes</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Grid method with compiled constant and seed dispersion functions:
param &lt;- list(method="grid",  grid=list(step=c(50,50)))
## Not run: califlopp("MyPolygonsFile",dispf=c(3,1), param=param)

# Cubature method with a R dispersion function:
param &lt;- list( output=1, input=2, dz=0, dp=100, tz=0)
## Not run: califlopp("MyPolygonsFile", dispf=fpollen, param=param)
</code></pre>

<hr>
<h2 id='crlistpoly'> Create an object of class 'listpoly' from objects of class 'poly' </h2><span id='topic+crlistpoly'></span>

<h3>Description</h3>

<p>Create an object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code> from objects of class <code>"<a href="#topic+poly-class">poly</a>"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crlistpoly(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crlistpoly_+3A_...">...</code></td>
<td>
<p> objetcs of class <code>"<a href="#topic+poly-class">poly</a>"</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code> : a list
where each component is a 'poly' object (see <code><a href="#topic+poly-class">poly-class</a></code>).
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+poly-class">poly-class</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># A triangle:
a &lt;- as.poly(matrix(c(2,2,2,3,3,3), ncol=2, byrow=TRUE))
# A square:
b &lt;- as.poly(matrix(c(2.5,2,2.5,2.5,3,2.5,3,2), ncol=2, byrow=TRUE))
# The both:
 z &lt;- crlistpoly(a,b)
</code></pre>

<hr>
<h2 id='crpoly'> Create un object of class 'poly' by clicking on points </h2><span id='topic+crpoly'></span>

<h3>Description</h3>

<p>Create un object of class <code>"<a href="#topic+poly-class">poly</a>"</code>   by clicking on
a graphic: the locations of the clicks will be
the vertices of  the polygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crpoly()
</code></pre>


<h3>Details</h3>

<p>The system prompts the user to enter points on the current graphic
using the mouse or other pointing device. The points are joined
on the screen with the current line symbol. A polygon of the points
entered is drawn on the current graphics device and returned as a 'poly'
object. 
</p>


<h3>Value</h3>

<p>An object of class <code>"<a href="#topic+poly-class">poly</a>"</code> i.e a two-columns matrix with the coordinates.
</p>


<h3>Warning </h3>

<p>A plot should be drawn on the current graphics device
before.</p>


<h3>See Also</h3>

 <p><code><a href="#topic+as.poly">as.poly</a></code>, <code>getpoly</code> of the package <code>splancs</code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: plot(x=c(1,10), y=c(1,10), type='n')
## Not run: a&lt;-crpoly()
#    Enter points with button 1
#    Finish with button 2

</code></pre>

<hr>
<h2 id='export'> Generic for 'export'</h2><span id='topic+export'></span>

<h3>Description</h3>

<p>Generic function for 'export'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export(x, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_+3A_x">x</code></td>
<td>
<p> object to export</p>
</td></tr>
<tr><td><code id="export_+3A_filename">filename</code></td>
<td>
<p> target filename </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+export.listpoly">export.listpoly</a></code></p>

<hr>
<h2 id='export.default'>export.default method </h2><span id='topic+export.default'></span>

<h3>Description</h3>

<p>Default method <code>export</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## Default S3 method:
export(x, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export.default_+3A_x">x</code></td>
<td>
<p> object to export</p>
</td></tr>
<tr><td><code id="export.default_+3A_filename">filename</code></td>
<td>
<p> target filename </p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+export.listpoly">export.listpoly</a></code></p>

<hr>
<h2 id='export.listpoly'> Create a polygons file  in format 1. </h2><span id='topic+export.listpoly'></span>

<h3>Description</h3>

<p>From an object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>,
create a polygons file for input to the software <code>CaliFloPP</code>
or to the function
<a href="#topic+califlopp">califlopp</a>. The format of this file corresponds to the
format <code>1</code> of them, i.e you should set the param <code>input</code> to
<code>1</code> when used as input to  <a href="#topic+califlopp">califlopp</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'listpoly'
export(x, filename)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export.listpoly_+3A_x">x</code></td>
<td>
<p> Object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code></p>
</td></tr>
<tr><td><code id="export.listpoly_+3A_filename">filename</code></td>
<td>
<p> Name of the file to be created.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='fpollen'> Individual pollen dispersion function </h2><span id='topic+fpollen'></span>

<h3>Description</h3>

<p>From a vector of distances, calculate the individual pollen dispersion
function used in  <em>Genesys</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fpollen(point)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fpollen_+3A_point">point</code></td>
<td>
<p> scalar or vector of length 2, whose first element is
a distance expressed in meter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The calculated dispersions.
</p>


<h3>References</h3>

   
<p>Colbach, N. and Clermont-Dauphin, C. and Meynard, J.M. <em>Genesys: a model of the
influence of cropping system on gene escape from herbicide tolerant rapeseed crops
to rape volunteers. i. temporal evolution of a population of rapeseed volunteers in a
field</em>. Agriculture, Ecosystems and Environnement, 83:235-253,
2001.
</p>


<h3>See Also</h3>

 <p><a href="#topic+fseed">fseed</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>distance = seq(1,1.5, by=0.05)
a=matrix(distance, ncol=1)
b= apply(a,1,fpollen)
par(pty="s")
plot(x=distance, y =b)
lines(x=distance, y = apply(a,1,fseed))
</code></pre>

<hr>
<h2 id='fseed'> Individual seed dispersion function</h2><span id='topic+fseed'></span>

<h3>Description</h3>

<p>From a vector of distances, calculate the individual seed dispersion
function used in  <em>Genesys</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fseed(point)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fseed_+3A_point">point</code></td>
<td>
<p> scalar or vector of length 2, whose first element is
a distance expressed in meter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The calculated dispersions.
</p>


<h3>References</h3>

<p> Colbach, N. and Clermont-Dauphin, C. and Meynard, J.M. <em>Genesys: a model of the
influence of cropping system on gene escape from herbicide tolerant rapeseed crops
to rape volunteers. i. temporal evolution of a population of rapeseed volunteers in a
field</em>. Agriculture, Ecosystems and Environnement, 83:235-253,
2001.
</p>


<h3>See Also</h3>

 <p><a href="#topic+fpollen">fpollen</a> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
distance = seq(1,1.5, by=0.05)
a=matrix(distance, ncol=1)
b= apply(a,1,fseed)
par(pty="s")
plot(x=distance, y =b)
</code></pre>

<hr>
<h2 id='generPoly'>  Generate a regular grid of polygons </h2><span id='topic+generPoly'></span>

<h3>Description</h3>

<p>Generate a regular grid of polygons and optionally write
them on a    file for input to <code><a href="#topic+califlopp">califlopp</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generPoly(step = 5, np = 10, file = "data", plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generPoly_+3A_step">step</code></td>
<td>
<p> Step of grid, in meter. </p>
</td></tr>
<tr><td><code id="generPoly_+3A_np">np</code></td>
<td>
<p> Number of polygons on each axis. </p>
</td></tr>
<tr><td><code id="generPoly_+3A_file">file</code></td>
<td>
<p> Pathname of the polygons file to be created. If
NULL, no file created.</p>
</td></tr>
<tr><td><code id="generPoly_+3A_plot">plot</code></td>
<td>
<p> If TRUE, plot of the  polygons. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>file</code> is not NULL, a polygons file is created. It
is in the  format 2 of <code><a href="#topic+califlopp">califlopp</a></code>
and the values separator is tabulate.
</p>


<h3>Value</h3>

<p>An object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>
</p>


<h3>Note</h3>

<p>The polygons are numbered from 1, from
the left to the right, then from bottom to top.
</p>


<h3>See Also</h3>

 <p><code>"<a href="#topic+listpoly-class">listpoly-class</a>"</code>, <code><a href="#topic+plot.listpoly">plot.listpoly</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- generPoly(np=3, file=NULL)
</code></pre>

<hr>
<h2 id='generVois'> Generate the neighbors of each polygon of a regular grid </h2><span id='topic+generVois'></span>

<h3>Description</h3>

<p>For  each polygon of a regular grid, generate the indexes
of its neighbour polygons </p>


<h3>Usage</h3>

<pre><code class='language-R'>generVois(np = 10, nvois = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generVois_+3A_np">np</code></td>
<td>
<p> Number of polygons on each axis of the grid. </p>
</td></tr>
<tr><td><code id="generVois_+3A_nvois">nvois</code></td>
<td>
<p> Number of polygons required in the neighbourhood,
on each direction, for each polygon</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For each polygon P of a regular grid made of <code>np</code>
polygons along each axis, the indexes of its neighbours
are generated: the neighbours are the polygons included
in the square  made of
<code>nvois</code> polygons 
below, above, at the
right and left sides of P,  in the limit
of the grid bounds.
</p>


<h3>Value</h3>

<p>A two-columns matrix, of all pairs of neighbourgs.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+generPoly">generPoly</a></code>,
<code><a href="#topic+califlopp">califlopp</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>generVois(np=3)
</code></pre>

<hr>
<h2 id='getRes'> Read a result-file of 'califlopp' </h2><span id='topic+getRes'></span>

<h3>Description</h3>

<p>Return the results stored on a file created by <code>califlopp</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRes(ficres)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getRes_+3A_ficres">ficres</code></td>
<td>
<p> Pathname of a result-file created by <code><a href="#topic+califlopp">califlopp</a></code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with as many rows as pairs of polygons on the file.
The columns are:
</p>
<table>
<tr><td><code>poly1</code>, <code>poly2</code></td>
<td>
<p>Identifiers of the  polygons.</p>
</td></tr>
<tr><td><code>mean.flow/area</code></td>
<td>
<p>Integrated flow divided by the area of the second polygon.
If several dispersion functions have been studied, as many columns
as
functions. The columns labels are then
<code>mean.flow.f1/area</code>, <code>mean.flow.f2/area</code>, etc...</p>
</td></tr>
<tr><td><code>area1</code>, <code>area2</code></td>
<td>
<p>Areas of the polygons in squared meters.</p>
</td></tr>
<tr><td><code>mean.flow</code>, <code>conf.int.lower</code>, <code>conf.int.upper</code>, <code>abs.err</code>, <code>n.eval</code></td>
<td>

<p>when the method is &quot;cubature&quot;, only: integrated flow, lower and upper bounds
of the confidence interval, absolute error, number of evaluations.
If several dispersion functions have been studied, the columns labels
are suffixed with &quot;.f1&quot;, &quot;f2&quot;, etc...</p>
</td></tr>
<tr><td><code>mean.flow</code>, <code>std</code></td>
<td>

<p>when the method is &quot;grid&quot;, only: mean of the integrated flow,
standard
deviation.
If several dispersion functions have been studied, the columns labels
are suffixed with &quot;.f1&quot;, &quot;f2&quot;, etc...</p>
</td></tr>
</table>


<h3>Note</h3>

<p> This function  works  when <code>RCALI</code>      has been configured with
<code>OUTPUT_FILE_FORMAT = LIGHT</code> only (this is the default; see the
file <code>src/caliconfig.h</code> to be sure your configuration is compatible).
</p>
<p>Details about the returned values can be found in the Reference
Manual.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+califlopp">califlopp</a></code></p>

<hr>
<h2 id='listpoly-class'>Class 'listpoly'  </h2><span id='topic+listpoly-class'></span>

<h3>Description</h3>

<p> A class to store a suite of polygons and its methods.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the function
<code><a href="#topic+crlistpoly">crlistpoly</a></code> and  <code><a href="#topic+generPoly">generPoly</a></code> </p>


<h3>Slots</h3>


<dl>
<dt>list</dt><dd><p>List where each component is an object of
<code><a href="#topic+poly-class">poly-class</a></code>
</p>
</dd>
</dl>



<h3>Methods</h3>

<p><code><a href="#topic+plot.listpoly">plot.listpoly</a></code>, 
<code><a href="#topic+range.listpoly">range.listpoly</a></code>,
<code><a href="#topic+export.listpoly">export.listpoly</a></code></p>


<h3>See Also</h3>

<p><code><a href="#topic+poly-class">poly-class</a></code>
</p>

<hr>
<h2 id='plot.listpoly'> Plot of an object of class 'listpoly' </h2><span id='topic+plot.listpoly'></span>

<h3>Description</h3>

<p>Plot all the polygons of an  object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>, optionnaly with
colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'listpoly'
plot(x, add = F, color = T, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.listpoly_+3A_x">x</code></td>
<td>
<p> Object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>.</p>
</td></tr>
<tr><td><code id="plot.listpoly_+3A_add">add</code></td>
<td>
<p> TRUE, to add to a previous plot, for example after a
zoom. </p>
</td></tr>
<tr><td><code id="plot.listpoly_+3A_color">color</code></td>
<td>
<p> TRUE, to fill each polygon in a different color.</p>
</td></tr>
<tr><td><code id="plot.listpoly_+3A_...">...</code></td>
<td>
<p> List of arguments passed as-is to <a href="#topic+plot.poly">plot.poly</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Note</h3>

<p>To make a zoom, type in: zoom() (see 'splancs') then use this function
with argument &ldquo;add=TRUE&rdquo;.</p>

<hr>
<h2 id='plot.poly'> Plot of an object of class 'poly' </h2><span id='topic+plot.poly'></span>

<h3>Description</h3>

<p>Plot an object  of class <code>"<a href="#topic+poly-class">poly</a>"</code> via the function <code><a href="splancs.html#topic+polymap">polymap</a></code> of the library
<code>splancs</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'poly'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.poly_+3A_x">x</code></td>
<td>
<p> Object of class <code>"<a href="#topic+poly-class">poly</a>"</code>. </p>
</td></tr>
<tr><td><code id="plot.poly_+3A_...">...</code></td>
<td>
<p> Arguments passed as-it to 'polymap'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='poly-class'>Class 'poly'  </h2><span id='topic+poly-class'></span>

<h3>Description</h3>

<p> A class to store the coordinates of a polygons and its methods.</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the functions
<code><a href="#topic+as.poly">as.poly</a></code> and <code><a href="#topic+crpoly">crpoly</a></code> </p>


<h3>Slots</h3>


<dl>
<dt>m</dt><dd><p>Matrix with two columns <code>xcoord</code>
and <code>ycoord</code></p>
</dd>
</dl>



<h3>Methods</h3>

<p><code><a href="#topic+plot.poly">plot.poly</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+listpoly-class">listpoly-class</a></code>
</p>

<hr>
<h2 id='range.listpoly'> Range of the coordinates of an object
of class 'listpoly' </h2><span id='topic+range.listpoly'></span>

<h3>Description</h3>

<p>Return the minimum and maximum coordinates over all the polygones
of an object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'listpoly'
range(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="range.listpoly_+3A_x">x</code></td>
<td>
<p> an object  of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code> </p>
</td></tr>
<tr><td><code id="range.listpoly_+3A_...">...</code></td>
<td>
<p> arguments passed as-it to the R function <code>range</code> </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix ; its two columns are &ldquo;xrange&rdquo; and &ldquo;yrange&rdquo; and
its two lines  are &ldquo;lower&rdquo; and &ldquo;upper&rdquo;.
</p>

<hr>
<h2 id='readpoly1'> Read a  polygons file in format 1</h2><span id='topic+readpoly1'></span>

<h3>Description</h3>

<p>Create an object of  class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code> from the values read on a
polygons file in format 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readpoly1(filename, delim=" ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readpoly1_+3A_filename">filename</code></td>
<td>
<p> Name of the polygons file</p>
</td></tr>
<tr><td><code id="readpoly1_+3A_delim">delim</code></td>
<td>
<p> Separator character on the file. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An  object of  class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>, i.e a list, each component of which is an
object of class <code>"<a href="#topic+poly-class">poly</a>"</code></p>


<h3>See Also</h3>

 <p><a href="#topic+readpoly2">readpoly2</a> </p>

<hr>
<h2 id='readpoly2'> Read a  polygons file in format 2</h2><span id='topic+readpoly2'></span>

<h3>Description</h3>

<p>Create an object of  class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code> from the values read on a
polygons file in format 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readpoly2(filename, delim="\t")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readpoly2_+3A_filename">filename</code></td>
<td>
<p> Name of the polygons file</p>
</td></tr>
<tr><td><code id="readpoly2_+3A_delim">delim</code></td>
<td>
<p> Separator character on the file. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An  object of class <code>"<a href="#topic+listpoly-class">listpoly</a>"</code>, i.e a list, each component of which is an
object of class <code>"<a href="#topic+poly-class">poly</a>"</code></p>


<h3>See Also</h3>

 <p><a href="#topic+readpoly1">readpoly1</a></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
