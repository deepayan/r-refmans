<!DOCTYPE html><html><head><title>Help for package Phase12Compare</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Phase12Compare}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AssignEffTox'><p>Determines the optimal dose to assign the next patient cohort.</p></a></li>
<li><a href='#AssignEffToxUT'><p>Determines the optimal dose to assign the next patient cohort.</p></a></li>
<li><a href='#GETBIN'><p>Generate binary bivariate data.</p></a></li>
<li><a href='#GetDesire'><p>Returns the desireability value of a dose.</p></a></li>
<li><a href='#GetEfftoxContour'><p>Assigns next patient cohort based on the Efftox model with a Desirability based objective function.</p></a></li>
<li><a href='#GetEfftoxUt'><p>Assigns next patient cohort based on the Efftox model with a Utility based objective function.</p></a></li>
<li><a href='#GetPriorsSPSO'><p>Returns prior dose-specific means and prior ESS for the SPSO model.</p></a></li>
<li><a href='#GetSpsoContour'><p>Assigns next patient cohort based on the SPSOP model with a Utility based objective function.</p></a></li>
<li><a href='#GetSpsoUt'><p>Assigns next patient cohort based on the SPSOP model with a Utility based objective function.</p></a></li>
<li><a href='#ReturnOpt'><p>Obtains optimal dose level.</p></a></li>
<li><a href='#RunAdaptiveEffToxTrialCORR'><p>Simulates utility based Efftox trials</p></a></li>
<li><a href='#RunAdaptiveEffToxTrialCORRCONTOUR'><p>Simulates desirability based Efftox trials</p></a></li>
<li><a href='#SimEfftoxContour'><p>Simulates trial replications from the Efftox model with desirability optimality function.</p></a></li>
<li><a href='#SimEfftoxUt'><p>Simulates trial replications from the Efftox model with utility optimality function.</p></a></li>
<li><a href='#SimSpsoContour'><p>Simulates trial replications from the SPSO model with desirability optimality function.</p></a></li>
<li><a href='#SimSpsoUt'><p>Simulates trial replications from the SPSO model with desirability optimality function.</p></a></li>
<li><a href='#UTEFFTOX'><p>Samples from the posterior of the utility based phase12 model.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulates SPSO and Efftox Phase 12 Trials with Correlated
Outcomes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew G Chapple</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew G Chapple &lt;achapp@lsuhsc.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulating and conducting four phase 12 clinical trials with correlated binary bivariate outcomes described. Uses the 'Efftox' (efficacy and toxicity tradeoff, <a href="https://biostatistics.mdanderson.org/SoftwareDownload/SingleSoftware/Index/2">https://biostatistics.mdanderson.org/SoftwareDownload/SingleSoftware/Index/2</a>) and SPSO (Semi-Parametric Stochastic Ordering) models with Utility and Desirability based objective functions for dose finding. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.18), mvtnorm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-31 16:38:52 UTC; achapp</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-31 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AssignEffTox'>Determines the optimal dose to assign the next patient cohort.</h2><span id='topic+AssignEffTox'></span>

<h3>Description</h3>

<p>This function returns the optimal acceptable dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AssignEffTox(
  YE,
  YT,
  Doses,
  Dose,
  DosesTried,
  Hypermeans,
  Hypervars,
  Contour,
  PiLim,
  ProbLim,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AssignEffTox_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_doses">Doses</code></td>
<td>
<p>Vector containing numbered Doses of patients in trial.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_dosestried">DosesTried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour[1] contains a desired toxicity probability given efficacy, Countour[2] contains a desired efficacy probability given toxicity, and (Contour[3],Contour[4]) is an equally desireable pair of efficacy and toxicity probabilities that are non-zero or one.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffTox_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimal dose level to administer the next patient cohort.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Doses, YE,YT
Doses= c(1,1,1,2,2,2,1,1,1,3,3,3,1,1,1,2,2,2)
YE = c(0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0)
YT=c(0,0,0,1,1,0,1,0,0,1,1,1,0,0,0,1,0,0)
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
Dose=(Dose-mean(Dose))/sd(Dose)
##Five doses, but only 3 tried so we have
DosesTried=c(1,1,1,0,0)
## Contour Vector
Contour = c(.35, .75,.7,.4)
##Hypermeans
Hypermeans = c(.022,3.45,0,-4.23,3.1,0)
Hypervars = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
Hypervars=Hypervars^2
##Acceptability Criteria
PiLim = c(.3,.4)
ProbLim=c(.1,.1)
##Number of iterations
B=2000
AssignEffTox(YE,YT, Doses, Dose, DosesTried, Hypermeans,  Hypervars, Contour, PiLim,  ProbLim, B )
</code></pre>

<hr>
<h2 id='AssignEffToxUT'>Determines the optimal dose to assign the next patient cohort.</h2><span id='topic+AssignEffToxUT'></span>

<h3>Description</h3>

<p>This function returns the optimal acceptable dose number to assign the next patient cohort or stops the trial if no dose is deemed acceptable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AssignEffToxUT(
  YE,
  YT,
  Doses,
  Dose,
  DosesTried,
  Hypermeans,
  Hypervars,
  UT,
  PiLim,
  ProbLim,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AssignEffToxUT_+3A_ye">YE</code></td>
<td>
<p>Vector containing observed efficacy indicators.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_yt">YT</code></td>
<td>
<p>Vector containing observed toxicity indicators.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_doses">Doses</code></td>
<td>
<p>Vector containing numbered Doses of patients in trial.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_dose">Dose</code></td>
<td>
<p>Vector containing the standardized doses considered.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_dosestried">DosesTried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>Vector containing prior hypermeans of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_hypervars">Hypervars</code></td>
<td>
<p>Vector containing prior hypervariances of length 6 for Eff-Tox parameters.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_ut">UT</code></td>
<td>
<p>2x2 utility matrix.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_pilim">PiLim</code></td>
<td>
<p>Vector of length two with PiLim[1] containing the acceptable lower limit on efficacy probability and PiLim[2] containing the acceptable upper limit on toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_problim">ProbLim</code></td>
<td>
<p>Vector of length two with ProbLim[1] containing the probability cutoff for acceptable efficacy probability and ProbLim[2] containing the probability cutoff for acceptable toxicity probability.</p>
</td></tr>
<tr><td><code id="AssignEffToxUT_+3A_b">B</code></td>
<td>
<p>Number of iterations to perform in the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The optimal dose level to administer the next patient cohort.
</p>

<hr>
<h2 id='GETBIN'>Generate binary bivariate data.</h2><span id='topic+GETBIN'></span>

<h3>Description</h3>

<p>Generates binary bivariate data from a 2x2 matrix of probabilities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GETBIN(PVEC)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GETBIN_+3A_pvec">PVEC</code></td>
<td>
<p>Contains TRUE pi00,pi10, pi01, pi11 for each dose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Binary bivariate random variate (YE,YT).
</p>

<hr>
<h2 id='GetDesire'>Returns the desireability value of a dose.</h2><span id='topic+GetDesire'></span>

<h3>Description</h3>

<p>Takes estimated posterior mean efficacy and toxicity values and returns the posterior mean desireability score for a given tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetDesire(PE, PT, Contour)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetDesire_+3A_pe">PE</code></td>
<td>
<p>True or estimated probability of efficacy.</p>
</td></tr>
<tr><td><code id="GetDesire_+3A_pt">PT</code></td>
<td>
<p>True of estimated probability of toxicity.</p>
</td></tr>
<tr><td><code id="GetDesire_+3A_contour">Contour</code></td>
<td>
<p>Vector containing 4 entries used to make the desireability function. Contour(1) contains a desired toxicity probability given efficacy, Countour(2) contains a desired efficacy probability given toxicity, and (Contour(3),Contour(4)) is an equally desireable pair of efficacy and toxicity probabilities that are non zero or one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Computes the real-valued desireability for an estimated (PE, PT) pair and elicited co
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PE=.6
PT=.2
##Contour values
Contour=c(.35,.7,.8,.6)
GetDesire(PE,PT,Contour)
</code></pre>

<hr>
<h2 id='GetEfftoxContour'>Assigns next patient cohort based on the Efftox model with a Desirability based objective function.</h2><span id='topic+GetEfftoxContour'></span>

<h3>Description</h3>

<p>Provides the optimal dose level as determined by the Efftox model, posterior mean toxicity probability, efficacy probability, and desirability of each dose level. Doses that are unacceptably toxic or inefficous have a desirability of 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetEfftoxContour(
  YE,
  YT,
  Doses,
  Dose,
  Dosetried,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansEFF,
  HypervarsEFF,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetEfftoxContour_+3A_ye">YE</code></td>
<td>
<p>Length n binary indicator vector of efficacy status.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_yt">YT</code></td>
<td>
<p>Length n binary indicator vector of toxicity status.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_doses">Doses</code></td>
<td>
<p>Length n vector of integer Doses given to patients.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized log-dose levels considered in the trial.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_dosetried">Dosetried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the trial.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_contour">Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_hypermeanseff">HypermeansEFF</code></td>
<td>
<p>Hypermeans for the Efftox model. In order, entries are hypermeans for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_hypervarseff">HypervarsEFF</code></td>
<td>
<p>Hypervariances for the Efftox model. In order, entries are hypervariances for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="GetEfftoxContour_+3A_b">B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal dose level to assign the next patient cohort in the first entry and a matrix in the second entry, with rows corresponding to (1) the dose #, (2) mean posterior toxicity probability at each dose, mean posterior efficacy probability at each dose, and acceptable posterior desirability score of each dose level (0s indicate the dose is not acceptably efficous or toxic).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Get the Data
##True Tox Prob
PT = c(.1,.2,.25,.5,.7)
##True EFF Prob
PE = c(.3,.4,.7,.5,.5)
Doses=c(1,1,1,2,2,2,3,3,3,2,2,2,1,1,1,2,2,2,3,3,3)
YE=Doses
YT=Doses
Dosetried=rep(0,length(PE))
##Generate data
for(k in 1:length(PE)){
if(sum(Doses==k)){
##Dose level has been tried
Dosetried[k]=1
YE[Doses==k]=rbinom(sum(Doses==k),1,PE[k])
YT[Doses==k]=rbinom(sum(Doses==k),1,PT[k])
}
}
##Hypermeans and hypervariances
HypermeansEFF = c(.022,3.45,0,-4.23,3.1,0)
HypervarsEFF = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
HypervarsEFF=HypervarsEFF^2
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
##Dose for Eff-Tox
Dose=log(Dose)-mean(log(Dose))
##Trial parameters
cohort=3
##Contour vector
Contour = c(.35, .75,.7,.4)
CutE=.3 ##Efficacy threshold
CutT=.4 ##Toxicity threshold
AcceptE=.3 ##Eff acceptability threshold
AcceptT= .3 ##Tox acceptability threshold
B=100##Number of iterations
GetEfftoxContour(YE, YT,Doses,Dose, Dosetried,
cohort, Contour,CutE, CutT, AcceptE, AcceptT,
HypermeansEFF, HypervarsEFF,B )
</code></pre>

<hr>
<h2 id='GetEfftoxUt'>Assigns next patient cohort based on the Efftox model with a Utility based objective function.</h2><span id='topic+GetEfftoxUt'></span>

<h3>Description</h3>

<p>Provides the optimal dose level as determined by the Efftox model, posterior mean toxicity probability, efficacy probability, and mean utility of each dose level. Doses that are unacceptably toxic or inefficous have a utility of 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetEfftoxUt(
  YE,
  YT,
  Doses,
  Dose,
  Dosetried,
  cohort,
  UT,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansEFF,
  HypervarsEFF,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetEfftoxUt_+3A_ye">YE</code></td>
<td>
<p>Length n binary indicator vector of efficacy status.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_yt">YT</code></td>
<td>
<p>Length n binary indicator vector of toxicity status.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_doses">Doses</code></td>
<td>
<p>Length n vector of integer Doses given to patients.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_dose">Dose</code></td>
<td>
<p>Vector of standardized log-dose levels considered in the trial.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_dosetried">Dosetried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the trial.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_ut">UT</code></td>
<td>
<p>Utility matrix for the four bivariate (efficacy, toxicity) events.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_hypermeanseff">HypermeansEFF</code></td>
<td>
<p>Hypermeans for the Efftox model. In order, entries are hypermeans for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_hypervarseff">HypervarsEFF</code></td>
<td>
<p>Hypervariances for the Efftox model. In order, entries are hypervariances for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="GetEfftoxUt_+3A_b">B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal dose level to assign the next patient cohort in the first entry and a matrix in the second entry, with rows corresponding to (1) the dose #, (2) mean posterior toxicity probability at each dose, mean posterior efficacy probability at each dose, and acceptable posterior utility score of each dose level (0s indicate the dose is not acceptably efficous or toxic).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Get the Data
##True Tox Prob
PT = c(.1,.2,.25,.5,.7)
##True EFF Prob
PE = c(.3,.4,.7,.5,.5)
Doses=c(1,1,1,2,2,2,3,3,3,2,2,2,1,1,1,2,2,2,3,3,3)
YE=Doses
YT=Doses
Dosetried=rep(0,length(PE))
##Generate data
for(k in 1:length(PE)){
if(sum(Doses==k)){
##Dose level has been tried
Dosetried[k]=1
YE[Doses==k]=rbinom(sum(Doses==k),1,PE[k])
YT[Doses==k]=rbinom(sum(Doses==k),1,PT[k])
}
}
##Hypermeans and hypervariances
HypermeansEFF = c(.022,3.45,0,-4.23,3.1,0)
HypervarsEFF = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
HypervarsEFF=HypervarsEFF^2
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
##Dose for Eff-Tox
Dose=log(Dose)-mean(log(Dose))
##Trial parameters
cohort=3
##Utility Matrix
UT = matrix(c(38.23529,100,0,61.76471),nrow=2,byrow=TRUE)
CutE=.3 ##Efficacy threshold
CutT=.4 ##Toxicity threshold
AcceptE=.3 ##Eff acceptability threshold
AcceptT= .3 ##Tox acceptability threshold
B=100##Number of iterations
GetEfftoxUt(YE, YT,Doses,Dose, Dosetried,
cohort, UT,CutE, CutT, AcceptE, AcceptT,
HypermeansEFF, HypervarsEFF,B )
</code></pre>

<hr>
<h2 id='GetPriorsSPSO'>Returns prior dose-specific means and prior ESS for the SPSO model.</h2><span id='topic+GetPriorsSPSO'></span>

<h3>Description</h3>

<p>Uses elicited efficacy and toxicity dose-specific parameters along withlatent prior variance, dose-specific mean hypervariance, frailty variance, and global probability of monotonicity to determine dose-specific prior means for efficacy and toxicityand prints the prior effective sample size associated with the specified prior parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetPriorsSPSO(PROBST, PROBSE, tau, Var, HypVar, PGLOBAL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetPriorsSPSO_+3A_probst">PROBST</code></td>
<td>
<p>Elicited prior toxicity probability at each dose.</p>
</td></tr>
<tr><td><code id="GetPriorsSPSO_+3A_probse">PROBSE</code></td>
<td>
<p>Elicted prior efficacy probability at each dose.</p>
</td></tr>
<tr><td><code id="GetPriorsSPSO_+3A_tau">tau</code></td>
<td>
<p>Frailty variance parameter.</p>
</td></tr>
<tr><td><code id="GetPriorsSPSO_+3A_var">Var</code></td>
<td>
<p>Latent parameter variance for normal probability of efficacy and toxicity.</p>
</td></tr>
<tr><td><code id="GetPriorsSPSO_+3A_hypvar">HypVar</code></td>
<td>
<p>Hypervariance on dose specific mean efficacy and toxicity parameters.</p>
</td></tr>
<tr><td><code id="GetPriorsSPSO_+3A_pglobal">PGLOBAL</code></td>
<td>
<p>Global monotonicity probability of dose-efficacy curve.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contianing (1) the prior effective sample size, (2) the vector of dose-specific efficacy probability prior mean parameters and, (3) the vector of dose-specific toxicity probability prior mean parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
##Elicited probabilities of toxicity
PROBST=c(.05,.10,.15,.20,.30)
##Elicited probabilities of efficacy
PROBSE=c(.2,.4,.6,.65,.7)
##Sigma_0
Var=1
##Sigma_mu
HypVar=16
##Frailty Variance
tau=1
##Global Monotonicity Probability
PGLOBAL=.1
Z=GetPriorsSPSO(PROBST,PROBSE,tau,Var,HypVar,PGLOBAL)
Z
</code></pre>

<hr>
<h2 id='GetSpsoContour'>Assigns next patient cohort based on the SPSOP model with a Utility based objective function.</h2><span id='topic+GetSpsoContour'></span>

<h3>Description</h3>

<p>Provides the optimal dose level as determined by the SPSO model, posterior mean toxicity probability, efficacy probability, and desirability of each dose level. Doses that are unacceptably toxic or inefficous have a desirability of 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetSpsoContour(
  YE,
  YT,
  Doses,
  Dosetried,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetSpsoContour_+3A_ye">YE</code></td>
<td>
<p>Length n binary indicator vector of efficacy status.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_yt">YT</code></td>
<td>
<p>Length n binary indicator vector of toxicity status.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_doses">Doses</code></td>
<td>
<p>Length n vector of integer Doses given to patients.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_dosetried">Dosetried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the trial.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_contour">Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_hypermeanse">HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_hypermeanst">HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_hypervars">Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td></tr>
<tr><td><code id="GetSpsoContour_+3A_b">B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal dose level to assign the next patient cohort in the first entry and a matrix in the second entry, with rows corresponding to (1) the dose #, (2) mean posterior toxicity probability at each dose, mean posterior efficacy probability at each dose, and acceptable posterior desirability score of each dose level (0s indicate the dose is not acceptably efficous or toxic).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Get the Data
##True Tox Prob
PT = c(.1,.2,.25,.5,.7)
##True EFF Prob
PE = c(.3,.4,.7,.5,.5)
Doses=c(1,1,1,2,2,2,3,3,3,2,2,2,1,1,1,2,2,2,3,3,3)
YE=Doses
YT=Doses
Dosetried=rep(0,length(PE))
##Generate data
for(k in 1:length(PE)){
if(sum(Doses==k)){
##Dose level has been tried
Dosetried[k]=1
YE[Doses==k]=rbinom(sum(Doses==k),1,PE[k])
YT[Doses==k]=rbinom(sum(Doses==k),1,PT[k])
}
}
##Hyperparameters
HypermeansE=c(-1,-.5,0,.5,1,2)
HypermeansT=HypermeansE
Hypervars=c(1,16,1)
##Trial parameters
cohort=3
##Contour vector
Contour = c(.35, .75,.7,.4)
CutE=.3 ##Efficacy threshold
CutT=.4 ##Toxicity threshold
AcceptE=.3 ##Eff acceptability threshold
AcceptT= .3 ##Tox acceptability threshold
B=100##Number of iterations
GetSpsoContour(YE,YT,Doses,Dosetried,cohort,Contour,CutE, CutT, AcceptE, AcceptT,
HypermeansE,  HypermeansT,Hypervars,B )
</code></pre>

<hr>
<h2 id='GetSpsoUt'>Assigns next patient cohort based on the SPSOP model with a Utility based objective function.</h2><span id='topic+GetSpsoUt'></span>

<h3>Description</h3>

<p>Provides the optimal dose level as determined by the SPSO model, posterior mean toxicity probability, efficacy probability, and mean utility of each dose level. Doses that are unacceptably toxic or inefficous have a utility of 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetSpsoUt(
  YE,
  YT,
  Doses,
  Dosetried,
  cohort,
  UT,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars,
  B
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetSpsoUt_+3A_ye">YE</code></td>
<td>
<p>Length n binary indicator vector of efficacy status.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_yt">YT</code></td>
<td>
<p>Length n binary indicator vector of toxicity status.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_doses">Doses</code></td>
<td>
<p>Length n vector of integer Doses given to patients.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_dosetried">Dosetried</code></td>
<td>
<p>Binary vector corresponding to which doses have been tried.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size for the trial.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_ut">UT</code></td>
<td>
<p>Utility matrix for the four bivariate (efficacy, toxicity) events.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_hypermeanse">HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_hypermeanst">HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_hypervars">Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td></tr>
<tr><td><code id="GetSpsoUt_+3A_b">B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the optimal dose level to assign the next patient cohort in the first entry and a matrix in the second entry, with rows corresponding to (1) the dose #, (2) mean posterior toxicity probability at each dose, mean posterior efficacy probability at each dose, and acceptable posterior utility score of each dose level (0s indicate the dose is not acceptably efficous or toxic).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Get the Data
##True Tox Prob
PT = c(.1,.2,.25,.5,.7)
##True EFF Prob
PE = c(.3,.4,.7,.5,.5)
Doses=c(1,1,1,2,2,2,3,3,3,2,2,2,1,1,1,2,2,2,3,3,3)
YE=Doses
YT=Doses
Dosetried=rep(0,length(PE))
##Generate data
for(k in 1:length(PE)){
if(sum(Doses==k)){
##Dose level has been tried
Dosetried[k]=1
YE[Doses==k]=rbinom(sum(Doses==k),1,PE[k])
YT[Doses==k]=rbinom(sum(Doses==k),1,PT[k])
}
}
##Hyperparameters
HypermeansE=c(-1,-.5,0,.5,1,2)
HypermeansT=HypermeansE
Hypervars=c(1,16,1)
##Trial parameters
cohort=3
#'##UTILITY Matrix
UT = matrix(c(38.23529,100,0,61.76471),nrow=2,byrow=TRUE)
CutE=.3 ##Efficacy threshold
CutT=.4 ##Toxicity threshold
AcceptE=.3 ##Eff acceptability threshold
AcceptT= .3 ##Tox acceptability threshold
B=100##Number of iterations
GetSpsoUt(YE,YT,Doses,Dosetried,cohort,UT,CutE, CutT, AcceptE, AcceptT,
HypermeansE,  HypermeansT,Hypervars,B )
</code></pre>

<hr>
<h2 id='ReturnOpt'>Obtains optimal dose level.</h2><span id='topic+ReturnOpt'></span>

<h3>Description</h3>

<p>Gives the optimal dose level to assign the next patient cohort to based on the vector of optimality function values for each dose level (desirability or utility based) and the doses tried throughout the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ReturnOpt(Desire, DoseTried)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ReturnOpt_+3A_desire">Desire</code></td>
<td>
<p>Vector of optimality function values for each dose level.</p>
</td></tr>
<tr><td><code id="ReturnOpt_+3A_dosetried">DoseTried</code></td>
<td>
<p>Binary vector containing 1 for doses that have been tried during the trial and 0 otherwise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Optimal dose level to assign the next patient cohort.
</p>

<hr>
<h2 id='RunAdaptiveEffToxTrialCORR'>Simulates utility based Efftox trials</h2><span id='topic+RunAdaptiveEffToxTrialCORR'></span>

<h3>Description</h3>

<p>Simulates utility based Efftox trials
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RunAdaptiveEffToxTrialCORR(
  DoseStart,
  Dose,
  Hypermeans,
  Hypervars,
  UT,
  PiLim,
  ProbLim,
  cohort,
  NET,
  NF,
  B,
  nSims,
  PMAT
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_dosestart">DoseStart</code></td>
<td>
<p>Dose level to START the EFF-Tox Trial</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_dose">Dose</code></td>
<td>
<p>Vector of Doses considered in the trial</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>6 vector of prior means</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_hypervars">Hypervars</code></td>
<td>
<p>6 vector of prior standard deviations</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_ut">UT</code></td>
<td>
<p>2x2 matrix of utilities corresponding to the four binary bivariate (toxicity, efficacy) events.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_pilim">PiLim</code></td>
<td>
<p>2 vector of acceptable limits</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_problim">ProbLim</code></td>
<td>
<p>2 vector of cutoff for acceptabilities</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_net">NET</code></td>
<td>
<p>Maximum Sample size to run the EFFtox Trial, must be divisible by cohort</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_nf">NF</code></td>
<td>
<p>Minimum sample size to begin adaptive randomization, must be divisible by count</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_b">B</code></td>
<td>
<p>Number of reps to perform in MCMC</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_nsims">nSims</code></td>
<td>
<p>Number of Simulated trials to run.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORR_+3A_pmat">PMAT</code></td>
<td>
<p>Contains TRUE pi00,pi10, pi01, pi11 for each dose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Trial simulation results to be processed for operating characteristics summaries.
</p>

<hr>
<h2 id='RunAdaptiveEffToxTrialCORRCONTOUR'>Simulates desirability based Efftox trials</h2><span id='topic+RunAdaptiveEffToxTrialCORRCONTOUR'></span>

<h3>Description</h3>

<p>Simulates Efftox trials based on the desirability tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RunAdaptiveEffToxTrialCORRCONTOUR(
  DoseStart,
  Dose,
  Hypermeans,
  Hypervars,
  Contour,
  PiLim,
  ProbLim,
  cohort,
  NET,
  NF,
  B,
  nSims,
  PMAT
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_dosestart">DoseStart</code></td>
<td>
<p>Dose level to START the EFF-Tox Trial</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_dose">Dose</code></td>
<td>
<p>Vector of Doses considered in the trial</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_hypermeans">Hypermeans</code></td>
<td>
<p>6 vector of prior means</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_hypervars">Hypervars</code></td>
<td>
<p>6 vector of prior standard deviations</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_contour">Contour</code></td>
<td>
<p>4 vector used to specify the tradeoff contour.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_pilim">PiLim</code></td>
<td>
<p>2 vector of acceptable limits</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_problim">ProbLim</code></td>
<td>
<p>2 vector of cutoff for acceptabilities</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_cohort">cohort</code></td>
<td>
<p>Cohort size</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_net">NET</code></td>
<td>
<p>Maximum Sample size to run the EFFtox Trial, must be divisible by cohort</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_nf">NF</code></td>
<td>
<p>Minimum sample size to begin adaptive randomization, must be divisible by count</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_b">B</code></td>
<td>
<p>Number of reps to perform in MCMC</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_nsims">nSims</code></td>
<td>
<p>Number of Simulated trials to run.</p>
</td></tr>
<tr><td><code id="RunAdaptiveEffToxTrialCORRCONTOUR_+3A_pmat">PMAT</code></td>
<td>
<p>Contains TRUE pi00,pi10, pi01, pi11 for each dose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Trial simulation results to be processed for operating characteristics summaries.
</p>

<hr>
<h2 id='SimEfftoxContour'>Simulates trial replications from the Efftox model with desirability optimality function.</h2><span id='topic+SimEfftoxContour'></span>

<h3>Description</h3>

<p>Simulates replications from a Bayesian adaptive phase 12 clinical trial design using the Efftox model and a optimality function based on the desirability tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimEfftoxContour(
  NSims,
  Dose,
  PE,
  PT,
  corET,
  Nmax,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansEFF,
  HypervarsEFF
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimEfftoxContour_+3A_nsims">NSims</code></td>
<td>
<p>Number of trial simulations to run.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_dose">Dose</code></td>
<td>
<p>Logarithm of raw dose levels - the average logarithm of the raw dose levels.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_pe">PE</code></td>
<td>
<p>True efficacy probability for each dose.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_pt">PT</code></td>
<td>
<p>True toxicity probaiblity for each dose.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_coret">corET</code></td>
<td>
<p>Correlation parameter between efficacy and toxicity probability.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum trial sample size.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_cohort">cohort</code></td>
<td>
<p>Patient cohort size.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_contour">Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_hypermeanseff">HypermeansEFF</code></td>
<td>
<p>Hypermeans for the Efftox model. In order, entries are hypermeans for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="SimEfftoxContour_+3A_hypervarseff">HypervarsEFF</code></td>
<td>
<p>Hypervariances for the Efftox model. In order, entries are hypervariances for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the first entry corresponding to a matrix with: (1) True toxicity probabilities at each dose, (2) True efficacy probabilities at each dose, (3) True Desirability of each dose, (4) Optimal dose selection probability, (5) Average sample size of patients treated at each dose. The second entry of the list contains a vector with rows corresponding to (1) the true binary bivariate correlation between efficacy and toxicity, (2) Stopping probability of the trial, (3) Average number of efficacy events, (4) Average number of toxicity events, and (5) Delta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
##True toxicity probability
PT=c(.05,.10,.15,.20,.30)
##True Efficacy Probability
PE=c(.2,.4,.6,.65,.7)
#True Correlation
corET=.5
##Number of simulations
NSims=1 ##Increase this when using
##Hypermeans and hypervariances
HypermeansEFF = c(.022,3.45,0,-4.23,3.1,0)
HypervarsEFF = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
HypervarsEFF=HypervarsEFF^2
##Trial Parameters
##Cohort Size, N^F and N_ET
cohort=3
##Starting Dose
DoseStart=1
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
##Dose for Eff-Tox
Dose=log(Dose)-mean(log(Dose))
Nmax=30 ##Max Sample Size
#Acceptability Criterion
CutE=.3
CutT=.4
##Limits on acceptability
AcceptE=.1
AcceptT=.1
##Contour vector
Contour = c(.35, .75,.7,.4)
RESULTS=SimEfftoxContour(NSims, Dose,PE,  PT, corET,
Nmax, cohort, Contour, CutE, CutT, AcceptE,AcceptT,  HypermeansEFF, HypervarsEFF)
RESULTS
</code></pre>

<hr>
<h2 id='SimEfftoxUt'>Simulates trial replications from the Efftox model with utility optimality function.</h2><span id='topic+SimEfftoxUt'></span>

<h3>Description</h3>

<p>Simulates replications from a Bayesian adaptive phase 12 clinical trial design using the Efftox model and a optimality function based on mean utility. Does not assign patient cohorts to unacceptably toxic or inefficous dose levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimEfftoxUt(
  NSims,
  Dose,
  PE,
  PT,
  corET,
  Nmax,
  cohort,
  UT,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansEFF,
  HypervarsEFF
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimEfftoxUt_+3A_nsims">NSims</code></td>
<td>
<p>Number of trial simulations to run.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_dose">Dose</code></td>
<td>
<p>Logarithm of raw dose levels - the average logarithm of the raw dose levels.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_pe">PE</code></td>
<td>
<p>True efficacy probability for each dose.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_pt">PT</code></td>
<td>
<p>True toxicity probaiblity for each dose.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_coret">corET</code></td>
<td>
<p>Correlation parameter between efficacy and toxicity probability.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum trial sample size.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_cohort">cohort</code></td>
<td>
<p>Patient cohort size.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_ut">UT</code></td>
<td>
<p>Utility matrix for the four bivariate (efficacy, toxicity) events.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_hypermeanseff">HypermeansEFF</code></td>
<td>
<p>Hypermeans for the Efftox model. In order, entries are hypermeans for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
<tr><td><code id="SimEfftoxUt_+3A_hypervarseff">HypervarsEFF</code></td>
<td>
<p>Hypervariances for the Efftox model. In order, entries are hypervariances for (beta_0,E,beta_1,E,beta_2,E,beta_0,T,beta_1,T,psi).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the first entry corresponding to a matrix with: (1) True toxicity probabilities at each dose, (2) True efficacy probabilities at each dose, (3) True mean utility of each dose, (4) Optimal dose selection probability, (5) Average sample size of patients treated at each dose. The second entry of the list contains a vector with rows corresponding to (1) the true binary bivariate correlation between efficacy and toxicity, (2) Stopping probability of the trial, (3) Average number of efficacy events, (4) Average number of toxicity events, and (5) Delta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
##True toxicity probability
PT=c(.05,.10,.15,.20,.30)
##True Efficacy Probability
PE=c(.2,.4,.6,.65,.7)
#True Correlation
corET=.5
##Number of simulations
NSims=1 ##Increase this when using
##Hypermeans and hypervariances
HypermeansEFF = c(.022,3.45,0,-4.23,3.1,0)
HypervarsEFF = c(2.6761, 2.6852, .2, 3.1304, 3.1165, 1)
HypervarsEFF=HypervarsEFF^2
##Trial Parameters
##Cohort Size, N^F and N_ET
cohort=3
##Starting Dose
DoseStart=1
##Vector of Numerical Doses
Dose = c(1,2,3,3.5,5)
##Dose for Eff-Tox
Dose=log(Dose)-mean(log(Dose))
Nmax=30 ##Max Sample Size
#Acceptability Criterion
CutE=.3
CutT=.4
##Limits on acceptability
AcceptE=.1
AcceptT=.1
##UTILITY Matrix
UT = matrix(c(38.23529,100,0,61.76471),nrow=2,byrow=TRUE)
RESULTS=SimEfftoxUt(NSims, Dose,PE,  PT, corET,
Nmax, cohort, UT, CutE, CutT, AcceptE,AcceptT,  HypermeansEFF, HypervarsEFF)
RESULTS
</code></pre>

<hr>
<h2 id='SimSpsoContour'>Simulates trial replications from the SPSO model with desirability optimality function.</h2><span id='topic+SimSpsoContour'></span>

<h3>Description</h3>

<p>Simulates replications from a Bayesian adaptive phase 12 clinical trial design using the SPSO model and a optimality function based on the desirability tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSpsoContour(
  NSims,
  PE,
  PT,
  corET,
  Nmax,
  cohort,
  Contour,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSpsoContour_+3A_nsims">NSims</code></td>
<td>
<p>Number of trial simulations to run.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_pe">PE</code></td>
<td>
<p>True efficacy probability for each dose.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_pt">PT</code></td>
<td>
<p>True toxicity probaiblity for each dose.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_coret">corET</code></td>
<td>
<p>Correlation parameter between efficacy and toxicity probability.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum trial sample size.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_cohort">cohort</code></td>
<td>
<p>Patient cohort size.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_contour">Contour</code></td>
<td>
<p>Contour vector for desirability function. Contains in order: (pi_1,E,pi_2,T,pi_3,E,pi_4,T).</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_hypermeanse">HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_hypermeanst">HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td></tr>
<tr><td><code id="SimSpsoContour_+3A_hypervars">Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the first entry corresponding to a matrix with: (1) True toxicity probabilities at each dose, (2) True efficacy probabilities at each dose, (3) True Desirability of each dose, (4) Optimal dose selection probability, (5) Average sample size of patients treated at each dose. The second entry of the list contains a vector with rows corresponding to (1) the true binary bivariate correlation between efficacy and toxicity, (2) Stopping probability of the trial, (3) Average number of efficacy events, (4) Average number of toxicity events, and (5) Delta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
##True toxicity probability
PT=c(.05,.10,.15,.20,.30)
##True Efficacy Probability
PE=c(.2,.4,.6,.65,.7)
#True Correlation
corET=.5
##Number of simulations
NSims=1 ##Increase this when using
##Hypermeans and hypervariances
HypermeansE=c(-1.189, -0.357,  0.360,  0.546,  0.743)
HypermeansT=c(-2.325, -1.811, -1.464, -1.189, -0.740)
Hypervars=c(1,16,1)
##Trial Parameters
##Cohort Size, N^F and N_ET
cohort=3
##Starting Dose
DoseStart=1
Nmax=30 ##Max Sample Size
#Acceptability Criterion
CutE=.3
CutT=.4
##Limits on acceptability
AcceptE=.1
AcceptT=.1
##Contour vector
Contour = c(.35, .75,.7,.4)
RESULTS=SimSpsoContour(NSims, PE, PT, corET, Nmax, cohort, Contour,
CutE, CutT, AcceptE, AcceptT,HypermeansE, HypermeansT, Hypervars)
RESULTS
</code></pre>

<hr>
<h2 id='SimSpsoUt'>Simulates trial replications from the SPSO model with desirability optimality function.</h2><span id='topic+SimSpsoUt'></span>

<h3>Description</h3>

<p>Simulates replications from a Bayesian adaptive phase 12 clinical trial design using the SPSO model and a optimality function based on the desirability tradeoff contour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimSpsoUt(
  NSims,
  PE,
  PT,
  corET,
  Nmax,
  cohort,
  UT,
  CutE,
  CutT,
  AcceptE,
  AcceptT,
  HypermeansE,
  HypermeansT,
  Hypervars
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SimSpsoUt_+3A_nsims">NSims</code></td>
<td>
<p>Number of trial simulations to run.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_pe">PE</code></td>
<td>
<p>True efficacy probability for each dose.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_pt">PT</code></td>
<td>
<p>True toxicity probaiblity for each dose.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_coret">corET</code></td>
<td>
<p>Correlation parameter between efficacy and toxicity probability.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_nmax">Nmax</code></td>
<td>
<p>Maximum trial sample size.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_cohort">cohort</code></td>
<td>
<p>Patient cohort size.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_ut">UT</code></td>
<td>
<p>Utility matrix for the four bivariate (efficacy, toxicity) events.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_cute">CutE</code></td>
<td>
<p>Cutoff for efficacy probability acceptability. Dose-efficacy probabilities must be larger than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_cutt">CutT</code></td>
<td>
<p>Cutoff for toxicity probability acceptability. Dose-toxicity probabilities must be smaller than this for patient assignment.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_accepte">AcceptE</code></td>
<td>
<p>Posterior probability threshold for efficacy acceptability.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_acceptt">AcceptT</code></td>
<td>
<p>Posterior probability threshold for toxicity acceptability.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_hypermeanse">HypermeansE</code></td>
<td>
<p>Hypermeans for dose-specific efficacy parameters.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_hypermeanst">HypermeansT</code></td>
<td>
<p>Hypermeans for dose-specific toxcity parameters.</p>
</td></tr>
<tr><td><code id="SimSpsoUt_+3A_hypervars">Hypervars</code></td>
<td>
<p>Hypervariances needed for the SPSO model. Contains, in order (sigma_0^2, sigma_mu^2,tau).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the first entry corresponding to a matrix with: (1) True toxicity probabilities at each dose, (2) True efficacy probabilities at each dose, (3) True mean utility of each dose, (4) Optimal dose selection probability, (5) Average sample size of patients treated at each dose. The second entry of the list contains a vector with rows corresponding to (1) the true binary bivariate correlation between efficacy and toxicity, (2) Stopping probability of the trial, (3) Average number of efficacy events, (4) Average number of toxicity events, and (5) Delta.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(mvtnorm)
##True toxicity probability
PT=c(.05,.10,.15,.20,.30)
##True Efficacy Probability
PE=c(.2,.4,.6,.65,.7)
#True Correlation
corET=.5
##Number of simulations
NSims=1 ##Increase this when using
##Hypermeans and hypervariances
HypermeansE=c(-1.189, -0.357,  0.360,  0.546,  0.743)
HypermeansT=c(-2.325, -1.811, -1.464, -1.189, -0.740)
Hypervars=c(1,16,1)
##Trial Parameters
##Cohort Size, N^F and N_ET
cohort=3
##Starting Dose
DoseStart=1
Nmax=30 ##Max Sample Size
#Acceptability Criterion
CutE=.3
CutT=.4
##Limits on acceptability
AcceptE=.1
AcceptT=.1
##UTILITY Matrix
UT = matrix(c(38.23529,100,0,61.76471),nrow=2,byrow=TRUE)
RESULTS=SimSpsoUt(NSims, PE, PT, corET, Nmax, cohort, UT,
CutE, CutT, AcceptE, AcceptT,HypermeansE, HypermeansT, Hypervars)
RESULTS
</code></pre>

<hr>
<h2 id='UTEFFTOX'>Samples from the posterior of the utility based phase12 model.</h2><span id='topic+UTEFFTOX'></span>

<h3>Description</h3>

<p>Takes arguments of data, hypermens and hypervariance vectors and returns a list of posterior samples from the Utility based phase12 model decribed by Chapple and Thall (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UTEFFTOX(YE, YT, Doses, HypermeansEFF, HypermeansTOX, Hypervars, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UTEFFTOX_+3A_ye">YE</code></td>
<td>
<p>Binary indicator vector of efficacy status.</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_yt">YT</code></td>
<td>
<p>Binary indicator vector of toxicity status.</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_doses">Doses</code></td>
<td>
<p>Vector of integer Doses given to patients.</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_hypermeanseff">HypermeansEFF</code></td>
<td>
<p>Vector of length nDose for dose prior means for efficacy.</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_hypermeanstox">HypermeansTOX</code></td>
<td>
<p>Vector of length nDose for dose prior means for toxicity</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_hypervars">Hypervars</code></td>
<td>
<p>Length 3 vector of hypervariances.Hypervars(1) contains sigma_0^2, Hypervars(2) contains sigma_mu, Hypervars(3) contains tau - the frailty variance.</p>
</td></tr>
<tr><td><code id="UTEFFTOX_+3A_b">B</code></td>
<td>
<p>Number of iterations to run for the MCMC.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of posterior samples after burnin in order: Posterior efficacy dose-vector, Posterior toxicity dose-vector, Posterior correlation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100  #Generate Data
YE=rbinom(n,1,.6)
YT=rbinom(n,1,.2)
nDose=5
Doses=sample(1:nDose,n,replace=TRUE)
##Hyperparameters
HypermeansEFF=c(-1,-.5,0,.5,1,2)
HypermeansTOX=HypermeansEFF
Hypervars=c(1,16,1)
B=100
UTEFFTOX(YE, YT,Doses,HypermeansEFF,HypermeansTOX, Hypervars, B)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
