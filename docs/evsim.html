<!DOCTYPE html><html><head><title>Help for package evsim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {evsim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adapt_charging_features'><p>Adapt charging features</p></a></li>
<li><a href='#add_charging_infrastructure'><p>Assign a charging station to EV charging sessions</p></a></li>
<li><a href='#california_ev_model'><p>EV model example</p></a></li>
<li><a href='#california_ev_sessions'><p>EV charging sessions example</p></a></li>
<li><a href='#california_ev_sessions_profiles'><p>Clustered EV charging sessions example</p></a></li>
<li><a href='#convert_time_num_to_period'><p>Convert numeric time value to a datetime period (hour-based)</p></a></li>
<li><a href='#estimate_connection'><p>Estimate sessions connection values</p></a></li>
<li><a href='#estimate_energy'><p>Estimate sessions energy values</p></a></li>
<li><a href='#estimate_sessions'><p>Estimate sessions parameters of a specific profile</p></a></li>
<li><a href='#expand_session'><p>Expand a session along time slots within its connection time</p></a></li>
<li><a href='#expand_sessions'><p>Expand sessions along time slots</p></a></li>
<li><a href='#get_charging_rates_distribution'><p>Charging rates distribution</p></a></li>
<li><a href='#get_connection_models_from_parameters'><p>Connection GMM</p></a></li>
<li><a href='#get_day_sessions'><p>Get day sessions</p></a></li>
<li><a href='#get_demand'><p>Time-series EV demand</p></a></li>
<li><a href='#get_energy_models_from_parameters'><p>Energy GMM</p></a></li>
<li><a href='#get_estimated_connections'><p>Get estimated profiles</p></a></li>
<li><a href='#get_estimated_energy'><p>Estimate energy given energy models tibble</p></a></li>
<li><a href='#get_ev_model'><p>Create the EV model</p></a></li>
<li><a href='#get_evmodel_parameters'><p>Get <code>evmodel</code> parameters in a list</p></a></li>
<li><a href='#get_evmodel_summary'><p>Get <code>evmodel</code> parameters in a list of summary tables</p></a></li>
<li><a href='#get_occupancy'><p>Time-series EV occupancy</p></a></li>
<li><a href='#get_user_profiles_distribution'><p>User profiles distribution</p></a></li>
<li><a href='#mclapply.windows'><p>Parallel processing for windows</p></a></li>
<li><a href='#plot_occupancy_duration_curve'><p>Plot the occupancy duration curve</p></a></li>
<li><a href='#plot_ts'><p>Interactive plot for time-series tibbles</p></a></li>
<li><a href='#prepare_model'><p>Prepare the models from the <code>evmodel</code> object ready for the simulation</p></a></li>
<li><a href='#print.evmodel'><p><code>print</code> method for <code>evmodel</code> object class</p></a></li>
<li><a href='#read_ev_model'><p>Read EV model</p></a></li>
<li><a href='#round_to_interval'><p>Round a numeric value to interval</p></a></li>
<li><a href='#save_ev_model'><p>Save the EV model</p></a></li>
<li><a href='#sessions_feature_names'><p>Names of standard features of a sessions dataset</p></a></li>
<li><a href='#simulate_sessions'><p>Simulation of EV sessions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Electric Vehicle Charging Sessions Simulation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation of Electric Vehicles charging sessions using 
    Gaussian models, together with time-series power demand calculations. 
    The simulation methodology is published in 
    Cañigueral et al. (2023, ISBN:0957-4174) &lt;<a href="https://doi.org/10.1016%2Fj.eswa.2023.120318">doi:10.1016/j.eswa.2023.120318</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, dplyr, lubridate, purrr, rlang, tidyr, jsonlite,
dygraphs, ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>shiny, shinydashboard, shinyWidgets, spelling, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mcanigueral.github.io/evsim/">https://mcanigueral.github.io/evsim/</a>,
<a href="https://github.com/mcanigueral/evsim/">https://github.com/mcanigueral/evsim/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mcanigueral/evsim/issues">https://github.com/mcanigueral/evsim/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 14:20:46 UTC; mcanigueral</td>
</tr>
<tr>
<td>Author:</td>
<td>Marc Cañigueral <a href="https://orcid.org/0000-0001-9724-5829"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marc Cañigueral &lt;marc.canigueral@udg.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-14 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adapt_charging_features'>Adapt charging features</h2><span id='topic+adapt_charging_features'></span>

<h3>Description</h3>

<p>Calculate connection and charging times according to energy, power and time resolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adapt_charging_features(
  sessions,
  time_resolution = 15,
  power_resolution = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adapt_charging_features_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="adapt_charging_features_+3A_time_resolution">time_resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the sessions' datetime variables</p>
</td></tr>
<tr><td><code id="adapt_charging_features_+3A_power_resolution">power_resolution</code></td>
<td>
<p>numeric, power resolution (in kW) of the sessions' power</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All sessions' <code>Power</code> must be higher than <code>0</code>, to avoid <code>NaN</code> values from dividing
by zero.
The <code>ConnectionStartDateTime</code> is first aligned to the desired time resolution,
and the <code>ConnectionEndDateTime</code> is calculated according to the <code>ConnectionHours</code>.
The <code>ChargingHours</code> is recalculated with the values of <code>Energy</code> and <code>Power</code>,
limited by <code>ConnectionHours</code>. Finally, the charging times are also calculated.
</p>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressMessages(library(dplyr))

sessions &lt;- head(evsim::california_ev_sessions, 10)

sessions %&gt;%
  select(ConnectionStartDateTime, ConnectionEndDateTime, Power)

adapt_charging_features(
  sessions,
  time_resolution = 60,
  power_resolution = 0.01
) %&gt;%
  select(ConnectionStartDateTime, ConnectionEndDateTime, Power)

adapt_charging_features(
  sessions,
  time_resolution = 15,
  power_resolution = 1
) %&gt;%
  select(ConnectionStartDateTime, ConnectionEndDateTime, Power)


</code></pre>

<hr>
<h2 id='add_charging_infrastructure'>Assign a charging station to EV charging sessions</h2><span id='topic+add_charging_infrastructure'></span>

<h3>Description</h3>

<p>Variable <code>ChargingStation</code> and <code>Socket</code>will be assigned to the <code>sessions</code>
tibble with a name pattern being: <code>names_prefix</code> + &quot;CHS&quot; + number
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_charging_infrastructure(
  sessions,
  resolution = 15,
  min_stations = 0,
  names_prefix = NULL,
  duration_th = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_charging_infrastructure_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="add_charging_infrastructure_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution in minutes</p>
</td></tr>
<tr><td><code id="add_charging_infrastructure_+3A_min_stations">min_stations</code></td>
<td>
<p>integer, minimum number of charging stations to consider</p>
</td></tr>
<tr><td><code id="add_charging_infrastructure_+3A_names_prefix">names_prefix</code></td>
<td>
<p>character, prefix of the charging station names (optional)</p>
</td></tr>
<tr><td><code id="add_charging_infrastructure_+3A_duration_th">duration_th</code></td>
<td>
<p>integer between 0 and 100, minimum share of time (in percentage)
of the &quot;occupancy duration curve&quot; (see function <code>plot_occupancy_duration_curve</code>).
This is used to avoid sizing a charging infrastructure to host for example
100 vehicles when only 5% of time there are more than 80 vehicles connected.
Then, setting <code>duration_th = 5</code> will ensure that we don't over-size
the charging infrastructure for the 100 vehicles.
It is recommended to find this value through multiple iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assign a `ChargingStation` to every session according to the occupancy
sessions_infrastructure &lt;- add_charging_infrastructure(
  sessions = head(evsim::california_ev_sessions, 50),
  resolution = 60
)
print(unique(sessions_infrastructure$ChargingStation))

# Now without considering the occupancy values that only represent
# a 10% of the time
sessions_infrastructure &lt;- add_charging_infrastructure(
  sessions = head(evsim::california_ev_sessions, 50),
  resolution = 60, duration_th = 10
)
print(unique(sessions_infrastructure$ChargingStation))


</code></pre>

<hr>
<h2 id='california_ev_model'>EV model example</h2><span id='topic+california_ev_model'></span>

<h3>Description</h3>

<p>Example of an <code>evmodel</code> object created with <code>evprof</code> for testing purposes.
It has been created using an Open source data set of EV charging sessions
provided by <a href="https://acnportal.readthedocs.io/en/latest/">ACN</a>.
More information about the development of the model in the evprof website:
<a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_model
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_model</code></h4>

<p>An <code>evmodel</code> object.
</p>

<dl>
<dt>metadata</dt><dd><p>Information about the characteristics of the model</p>
</dd>
<dt>model</dt><dd><p>Gaussian Mixture Models for connection times and energy</p>
</dd>
</dl>




<h3>Source</h3>

<p><a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>

<hr>
<h2 id='california_ev_sessions'>EV charging sessions example</h2><span id='topic+california_ev_sessions'></span>

<h3>Description</h3>

<p>Example of an charging sessions data set ready to use by <code>evprof</code> functions.
It is the open source data set downloaded from the
<a href="https://ev.caltech.edu/dataset">ACN-Data website</a>, transformed according
to the standard names defined by <code>evprof</code>
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this</a> article).
More information about the analysis of this data set in the evprof website:
<a href="https://mcanigueral.github.io/evprof/articles/california.html">https://mcanigueral.github.io/evprof/articles/california.html</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_sessions
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_sessions</code></h4>

<p>A <code>tibble</code> object with standard variable names defined by <code>evprof</code>
</p>



<h3>Source</h3>

<p><a href="https://ev.caltech.edu/dataset">https://ev.caltech.edu/dataset</a>
</p>

<hr>
<h2 id='california_ev_sessions_profiles'>Clustered EV charging sessions example</h2><span id='topic+california_ev_sessions_profiles'></span>

<h3>Description</h3>

<p>Example of an charging sessions data set that has been clustered by <code>evprof</code> functions.
(see <a href="https://mcanigueral.github.io/evprof/articles/california.html#sessions-classification-into-user-profiles">this article</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>california_ev_sessions_profiles
</code></pre>


<h3>Format</h3>



<h4><code>california_ev_sessions_profiles</code></h4>

<p>A <code>tibble</code> object with standard variable names defined by <code>evprof</code>
</p>



<h3>Source</h3>

<p><a href="https://ev.caltech.edu/dataset">https://ev.caltech.edu/dataset</a>
</p>

<hr>
<h2 id='convert_time_num_to_period'>Convert numeric time value to a datetime period (hour-based)</h2><span id='topic+convert_time_num_to_period'></span>

<h3>Description</h3>

<p>Convert numeric time value to a datetime period (hour-based)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_time_num_to_period(time_num)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert_time_num_to_period_+3A_time_num">time_num</code></td>
<td>
<p>Numeric time value (hour-based)</p>
</td></tr>
</table>

<hr>
<h2 id='estimate_connection'>Estimate sessions connection values</h2><span id='topic+estimate_connection'></span>

<h3>Description</h3>

<p>Estimate sessions connection values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_connection(n, mu, sigma, log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_connection_+3A_n">n</code></td>
<td>
<p>number of sessions</p>
</td></tr>
<tr><td><code id="estimate_connection_+3A_mu">mu</code></td>
<td>
<p>means of bivariate GMM</p>
</td></tr>
<tr><td><code id="estimate_connection_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix of bivariate GMM</p>
</td></tr>
<tr><td><code id="estimate_connection_+3A_log">log</code></td>
<td>
<p>Logical, true if models have logarithmic transformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of numeric values
</p>

<hr>
<h2 id='estimate_energy'>Estimate sessions energy values</h2><span id='topic+estimate_energy'></span>

<h3>Description</h3>

<p>Estimate sessions energy values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_energy(n, mu, sigma, log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_energy_+3A_n">n</code></td>
<td>
<p>number of sessions</p>
</td></tr>
<tr><td><code id="estimate_energy_+3A_mu">mu</code></td>
<td>
<p>means of univariate GMM</p>
</td></tr>
<tr><td><code id="estimate_energy_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix of univariate GMM</p>
</td></tr>
<tr><td><code id="estimate_energy_+3A_log">log</code></td>
<td>
<p>Logical, true if models have logarithmic transformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector
</p>

<hr>
<h2 id='estimate_sessions'>Estimate sessions parameters of a specific profile</h2><span id='topic+estimate_sessions'></span>

<h3>Description</h3>

<p>Estimate sessions parameters of a specific profile
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_sessions(
  profile_name,
  n_sessions,
  power,
  connection_models,
  energy_models,
  connection_log,
  energy_log,
  charging_powers
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_sessions_+3A_profile_name">profile_name</code></td>
<td>
<p>character, profile name</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_n_sessions">n_sessions</code></td>
<td>
<p>integer, total number of sessions per day</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_power">power</code></td>
<td>
<p>numeric, charging power of the session</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_connection_models">connection_models</code></td>
<td>
<p>tibble, bivariate GMM of the profile</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_energy_models">energy_models</code></td>
<td>
<p>tibble, univariate GMM of the profile</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_connection_log">connection_log</code></td>
<td>
<p>logical, true if connection models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_energy_log">energy_log</code></td>
<td>
<p>logical, true if energy models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="estimate_sessions_+3A_charging_powers">charging_powers</code></td>
<td>
<p>tibble with variables <code>power</code> and <code>ratio</code>
The powers must be in kW and the ratios between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='expand_session'>Expand a session along time slots within its connection time</h2><span id='topic+expand_session'></span>

<h3>Description</h3>

<p>The <code>session</code> is divided in multiple time slots
with the corresponding <code>Power</code> consumption, among other variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_session(session, resolution)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_session_+3A_session">session</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>evprof</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="expand_session_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the time slots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='expand_sessions'>Expand sessions along time slots</h2><span id='topic+expand_sessions'></span>

<h3>Description</h3>

<p>Every session in <code>sessions</code> is divided in multiple time slots
with the corresponding <code>Power</code> consumption, among other variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_sessions(sessions, resolution)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expand_sessions_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>evprof</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="expand_sessions_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the time slots</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>Power</code> value is calculated for every time slot according to the original
required energy. The columns <code>NominalPower</code>, <code>RequiredEnergy</code> and
<code>FlexibilityHours</code> correspond to the values of the original session, and not
to the expanded session in every time slot. The column <code>ID</code> shows the number
of the time slot corresponding to the original session.
</p>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

sessions &lt;- head(evsim::california_ev_sessions, 10)
expand_sessions(
  sessions,
  resolution = 60
)

</code></pre>

<hr>
<h2 id='get_charging_rates_distribution'>Charging rates distribution</h2><span id='topic+get_charging_rates_distribution'></span>

<h3>Description</h3>

<p>Get charging rates distribution in percentages from a charging sessions data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_charging_rates_distribution(sessions, unit = "year")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_charging_rates_distribution_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)t</p>
</td></tr>
<tr><td><code id="get_charging_rates_distribution_+3A_unit">unit</code></td>
<td>
<p>character. Valid base units are <code>second</code>, <code>minute</code>, <code>hour</code>, <code>day</code>,
<code>week</code>, <code>month</code>, <code>bimonth</code>, <code>quarter</code>, <code>season</code>, <code>halfyear</code> and <code>year</code>.
It corresponds to <code>unit</code> parameter in <code>lubridate::floor_date</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_charging_rates_distribution(evsim::california_ev_sessions, unit = "year")


</code></pre>

<hr>
<h2 id='get_connection_models_from_parameters'>Connection GMM</h2><span id='topic+get_connection_models_from_parameters'></span>

<h3>Description</h3>

<p>Get connection Gaussian Mixture Models from parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_connection_models_from_parameters(
  time_cycle_parameters,
  connection_log = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_connection_models_from_parameters_+3A_time_cycle_parameters">time_cycle_parameters</code></td>
<td>
<p>tibble with Gaussian Mixture Models parameters.
This tibble must have the following columns: <code>profile</code>,    <code>ratio</code> (in %),    <code>start_mean</code> (in hours),
<code>start_sd</code> (in hours),    <code>duration_mean</code> (in hours),    <code>duration_sd</code> (in hours),    <code>energy_mean</code> (in kWh),    <code>energy_sd</code> (in kWh).</p>
</td></tr>
<tr><td><code id="get_connection_models_from_parameters_+3A_connection_log">connection_log</code></td>
<td>
<p>logical, true if connection models have logarithmic transformations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>connection GMM tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For workdays time cycle
workdays_parameters &lt;- dplyr::tibble(
  profile = c("Worktime", "Visit"),
  ratio = c(80, 20),
  start_mean = c(9, 11),
  start_sd = c(1, 4),
  duration_mean = c(8, 4),
  duration_sd = c(0.5, 2),
  energy_mean = c(15, 6),
  energy_sd = c(4, 3)
)

# For weekends time cycle
weekends_parameters &lt;- dplyr::tibble(
  profile = "Visit",
  ratio = 100,
  start_mean = 12,
  start_sd = 4,
  duration_mean = 3,
  duration_sd = 2,
  energy_mean = 4,
  energy_sd = 4
)

connection_GMM &lt;- purrr::map(
  list(Workdays = workdays_parameters, Weekends = weekends_parameters),
  ~ get_connection_models_from_parameters(.x)
)


</code></pre>

<hr>
<h2 id='get_day_sessions'>Get day sessions</h2><span id='topic+get_day_sessions'></span>

<h3>Description</h3>

<p>Get day sessions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_day_sessions(day, ev_models, connection_log, energy_log, charging_powers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_day_sessions_+3A_day">day</code></td>
<td>
<p>Date to simulate</p>
</td></tr>
<tr><td><code id="get_day_sessions_+3A_ev_models">ev_models</code></td>
<td>
<p>profiles models</p>
</td></tr>
<tr><td><code id="get_day_sessions_+3A_connection_log">connection_log</code></td>
<td>
<p>Logical, true if connection models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_day_sessions_+3A_energy_log">energy_log</code></td>
<td>
<p>Logical, true if energy models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_day_sessions_+3A_charging_powers">charging_powers</code></td>
<td>
<p>tibble with variables <code>power</code> and <code>ratio</code>
The powers must be in kW and the ratios between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='get_demand'>Time-series EV demand</h2><span id='topic+get_demand'></span>

<h3>Description</h3>

<p>Obtain time-series of EV demand from sessions data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_demand(
  sessions,
  dttm_seq = NULL,
  by = "Profile",
  resolution = 15,
  align_time = FALSE,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_demand_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="get_demand_+3A_dttm_seq">dttm_seq</code></td>
<td>
<p>sequence of datetime values that will be the <code>datetime</code>
variable of the returned time-series data frame.</p>
</td></tr>
<tr><td><code id="get_demand_+3A_by">by</code></td>
<td>
<p>character, being 'Profile' or 'Session'. When <code>by='Profile'</code> each column corresponds to an EV user profile.</p>
</td></tr>
<tr><td><code id="get_demand_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the sessions datetime variables.
If <code>dttm_seq</code> is defined this parameter is ignored.</p>
</td></tr>
<tr><td><code id="get_demand_+3A_align_time">align_time</code></td>
<td>
<p>logical, whether to align time variables or sessions with the corresponding time <code>resolution</code></p>
</td></tr>
<tr><td><code id="get_demand_+3A_mc.cores">mc.cores</code></td>
<td>
<p>integer, number of cores to use.
Must be at least one, and parallelization requires at least two cores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the time resolution of variables <code>ConnectionStartDateTime</code> and
<code>ChargingStartDateTime</code> must coincide with
<code>resolution</code> parameter. For example, if a charging session in <code>sessions</code> starts charging
at 15:32 and <code>resolution = 15</code>, the load of this session won't be computed. To solve this,
the parameter <code>align_time = TRUE</code> would align charging sessions' start time according to
<code>resolution</code>, so following the previous example the session would start at 15:30.
</p>


<h3>Value</h3>

<p>time-series tibble with first column of type <code>datetime</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressMessages(library(lubridate))
suppressMessages(library(dplyr))

# Get demand with the complete datetime sequence from the sessions
sessions &lt;- head(evsim::california_ev_sessions, 100)
demand &lt;- get_demand(
  sessions,
  by = "Session",
  resolution = 60,
  align_time = TRUE
)
demand %&gt;% plot_ts(ylab = "EV demand (kW)")

# Get demand with a custom datetime sequence and resolution of 15 minutes
sessions &lt;- head(evsim::california_ev_sessions_profiles, 100)
dttm_seq &lt;- seq.POSIXt(
  as_datetime(dmy(08102018)) %&gt;% force_tz(tz(sessions$ConnectionStartDateTime)),
  as_datetime(dmy(11102018)) %&gt;% force_tz(tz(sessions$ConnectionStartDateTime)),
  by = "15 mins"
)
demand &lt;- get_demand(
  sessions,
  dttm_seq = dttm_seq,
  by = "Profile",
  resolution = 15,
  align_time = TRUE
)
demand %&gt;% plot_ts(ylab = "EV demand (kW)")

</code></pre>

<hr>
<h2 id='get_energy_models_from_parameters'>Energy GMM</h2><span id='topic+get_energy_models_from_parameters'></span>

<h3>Description</h3>

<p>Get energy Gaussian Mixture Models from parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_energy_models_from_parameters(time_cycle_parameters, energy_log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_energy_models_from_parameters_+3A_time_cycle_parameters">time_cycle_parameters</code></td>
<td>
<p>tibble with Gaussian Mixture Models parameters.
This tibble must have the following columns: <code>profile</code>,    <code>ratio</code> (in %),    <code>start_mean</code> (in hours),
<code>start_sd</code> (in hours),    <code>duration_mean</code> (in hours),    <code>duration_sd</code> (in hours),    <code>energy_mean</code> (in kWh),    <code>energy_sd</code> (in kWh).</p>
</td></tr>
<tr><td><code id="get_energy_models_from_parameters_+3A_energy_log">energy_log</code></td>
<td>
<p>logical, true if connection models have logarithmic transformations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>energy GMM tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For workdays time cycle
workdays_parameters &lt;- dplyr::tibble(
  profile = c("Worktime", "Visit"),
  ratio = c(80, 20),
  start_mean = c(9, 11),
  start_sd = c(1, 4),
  duration_mean = c(8, 4),
  duration_sd = c(0.5, 2),
  energy_mean = c(15, 6),
  energy_sd = c(4, 3)
)

# For weekends time cycle
weekends_parameters &lt;- dplyr::tibble(
  profile = "Visit",
  ratio = 100,
  start_mean = 12,
  start_sd = 4,
  duration_mean = 3,
  duration_sd = 2,
  energy_mean = 4,
  energy_sd = 4
)

energy_GMM &lt;- purrr::map(
  list(Workdays = workdays_parameters, Weekends = weekends_parameters),
  ~ get_energy_models_from_parameters(.x)
)

</code></pre>

<hr>
<h2 id='get_estimated_connections'>Get estimated profiles</h2><span id='topic+get_estimated_connections'></span>

<h3>Description</h3>

<p>Get estimated profiles
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_estimated_connections(n, profile_models, log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_estimated_connections_+3A_n">n</code></td>
<td>
<p>number of sessions</p>
</td></tr>
<tr><td><code id="get_estimated_connections_+3A_profile_models">profile_models</code></td>
<td>
<p>models of the profile</p>
</td></tr>
<tr><td><code id="get_estimated_connections_+3A_log">log</code></td>
<td>
<p>Logical, true if models have logarithmic transformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with sessions connection values
</p>

<hr>
<h2 id='get_estimated_energy'>Estimate energy given energy models tibble</h2><span id='topic+get_estimated_energy'></span>

<h3>Description</h3>

<p>Estimate energy given energy models tibble
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_estimated_energy(power_vct, energy_models, energy_log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_estimated_energy_+3A_power_vct">power_vct</code></td>
<td>
<p>numeric vector of power values of simulated sessions</p>
</td></tr>
<tr><td><code id="get_estimated_energy_+3A_energy_models">energy_models</code></td>
<td>
<p>energy models tibble</p>
</td></tr>
<tr><td><code id="get_estimated_energy_+3A_energy_log">energy_log</code></td>
<td>
<p>Logical, true if models have logarithmic transformation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of numeric vectors
</p>

<hr>
<h2 id='get_ev_model'>Create the EV model</h2><span id='topic+get_ev_model'></span>

<h3>Description</h3>

<p>Get the EV model object of class <code>evmodel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ev_model(
  names,
  months_lst = list(1:12, 1:12),
  wdays_lst = list(1:5, 6:7),
  connection_GMM,
  energy_GMM,
  connection_log,
  energy_log,
  data_tz
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ev_model_+3A_names">names</code></td>
<td>
<p>character vector with the given names of each time-cycle model</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_months_lst">months_lst</code></td>
<td>
<p>list of integer vectors with the corresponding months of the year for each time-cycle model</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_wdays_lst">wdays_lst</code></td>
<td>
<p>list of integer vectors with the corresponding days of the week for each model (week start = 1)</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_connection_gmm">connection_GMM</code></td>
<td>
<p>list of different connection bivariate GMM obtained from <code>get_connection_models_from_parameters</code></p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_energy_gmm">energy_GMM</code></td>
<td>
<p>list of different energy univariate GMM obtained from <code>get_energy_models_from_parameters</code></p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_connection_log">connection_log</code></td>
<td>
<p>logical, true if connection models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_energy_log">energy_log</code></td>
<td>
<p>logical, true if energy models have logarithmic transformations</p>
</td></tr>
<tr><td><code id="get_ev_model_+3A_data_tz">data_tz</code></td>
<td>
<p>character, time zone of the original data (necessary to properly simulate new sessions)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>evmodel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# For workdays time cycle
workdays_parameters &lt;- dplyr::tibble(
  profile = c("Worktime", "Visit"),
  ratio = c(80, 20),
  start_mean = c(9, 11),
  start_sd = c(1, 4),
  duration_mean = c(8, 4),
  duration_sd = c(0.5, 2),
  energy_mean = c(15, 6),
  energy_sd = c(4, 3)
)

# For weekends time cycle
weekends_parameters &lt;- dplyr::tibble(
  profile = "Visit",
  ratio = 100,
  start_mean = 12,
  start_sd = 4,
  duration_mean = 3,
  duration_sd = 2,
  energy_mean = 4,
  energy_sd = 4
)

connection_GMM &lt;- purrr::map(
  list(Workdays = workdays_parameters, Weekends = weekends_parameters),
  ~ get_connection_models_from_parameters(.x)
)
energy_GMM &lt;- purrr::map(
  list(Workdays = workdays_parameters, Weekends = weekends_parameters),
  ~ get_energy_models_from_parameters(.x)
)

# Get the whole model
ev_model &lt;- get_ev_model(
  names = c("Workdays", "Weekends"),
  months_lst = list(1:12, 1:12),
  wdays_lst = list(1:5, 6:7),
  connection_GMM = connection_GMM,
  energy_GMM = energy_GMM,
  connection_log = FALSE,
  energy_log = FALSE,
  data_tz = "Europe/Amsterdam"
)


</code></pre>

<hr>
<h2 id='get_evmodel_parameters'>Get <code>evmodel</code> parameters in a list</h2><span id='topic+get_evmodel_parameters'></span>

<h3>Description</h3>

<p>Every time cycle is an element of the returned list, containing a list with
the user profile as elements, each one containing the ratio and the
corresponding tables with the statistic parameters of connection and
energy GMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_evmodel_parameters(evmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_evmodel_parameters_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_evmodel_parameters(evsim::california_ev_model)

</code></pre>

<hr>
<h2 id='get_evmodel_summary'>Get <code>evmodel</code> parameters in a list of summary tables</h2><span id='topic+get_evmodel_summary'></span>

<h3>Description</h3>

<p>Every time cycle is an element of the returned list, containing a table with
a user profile in every row and the mean and standard deviation values of the
GMM variables (connection duration, connection start time and energy).
If the energy models were built by charging rate, the average <code>mean</code> and <code>sd</code>
are provided without taking into account different charging rates (this
information is lost in this summary).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_evmodel_summary(evmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_evmodel_summary_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_evmodel_summary(evsim::california_ev_model)

</code></pre>

<hr>
<h2 id='get_occupancy'>Time-series EV occupancy</h2><span id='topic+get_occupancy'></span>

<h3>Description</h3>

<p>Obtain time-series of simultaneously connected EVs from sessions data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_occupancy(
  sessions,
  dttm_seq = NULL,
  by = "Profile",
  resolution = 15,
  align_time = FALSE,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_occupancy_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="get_occupancy_+3A_dttm_seq">dttm_seq</code></td>
<td>
<p>sequence of datetime values that will be the <code>datetime</code>
variable of the returned time-series data frame.</p>
</td></tr>
<tr><td><code id="get_occupancy_+3A_by">by</code></td>
<td>
<p>character, being 'Profile' or 'Session'. When <code>by='Profile'</code> each column corresponds to an EV user profile.</p>
</td></tr>
<tr><td><code id="get_occupancy_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the sessions datetime variables.
If <code>dttm_seq</code> is defined this parameter is ignored.</p>
</td></tr>
<tr><td><code id="get_occupancy_+3A_align_time">align_time</code></td>
<td>
<p>logical, whether to align time variables or sessions with the corresponding time <code>resolution</code></p>
</td></tr>
<tr><td><code id="get_occupancy_+3A_mc.cores">mc.cores</code></td>
<td>
<p>integer, number of cores to use.
Must be at least one, and parallelization requires at least two cores.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the time resolution of variable <code>ConnectionStartDateTime</code> must coincide with
<code>resolution</code> parameter. For example, if a charging session in <code>sessions</code> starts charging
at 15:32 and <code>resolution = 15</code>, the load of this session won't be computed. To solve this,
the parameter <code>align_time = TRUE</code> would align charging sessions' start time according to
<code>resolution</code>, so following the previous example the session would start at 15:30.
</p>


<h3>Value</h3>

<p>time-series tibble with first column of type <code>datetime</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(lubridate)
library(dplyr)

# Get occupancy with the complete datetime sequence from the sessions
sessions &lt;- head(evsim::california_ev_sessions, 100)
connections &lt;- get_occupancy(
  sessions,
  by = "ChargingStation",
  resolution = 60,
  align_time = TRUE
)
connections %&gt;% plot_ts(ylab = "Vehicles connected")

# Get occupancy with a custom datetime sequence and resolution of 15 minutes
sessions &lt;- head(evsim::california_ev_sessions_profiles, 100)
dttm_seq &lt;- seq.POSIXt(
  as_datetime(dmy(08102018)) %&gt;% force_tz(tz(sessions$ConnectionStartDateTime)),
  as_datetime(dmy(11102018)) %&gt;% force_tz(tz(sessions$ConnectionStartDateTime)),
  by = "15 mins"
)
connections &lt;- get_occupancy(
  sessions,
  dttm_seq = dttm_seq,
  by = "Profile",
  align_time = TRUE
)
connections %&gt;% plot_ts(ylab = "Vehicles connected")

</code></pre>

<hr>
<h2 id='get_user_profiles_distribution'>User profiles distribution</h2><span id='topic+get_user_profiles_distribution'></span>

<h3>Description</h3>

<p>Get the user profiles distribution from the original data set
used to build the model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_user_profiles_distribution(evmodel)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_user_profiles_distribution_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_user_profiles_distribution(evsim::california_ev_model)

</code></pre>

<hr>
<h2 id='mclapply.windows'>Parallel processing for windows</h2><span id='topic+mclapply.windows'></span>

<h3>Description</h3>

<p>mclapply version that works on windows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mclapply.windows(X, FUN, ..., mc.cores)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mclapply.windows_+3A_x">X</code></td>
<td>
<p>a vector (atomic or list) or an expressions vector.
Other objects (including classed objects) will be coerced by as.list.</p>
</td></tr>
<tr><td><code id="mclapply.windows_+3A_fun">FUN</code></td>
<td>
<p>the function to be applied to (mclapply) each element of X.</p>
</td></tr>
<tr><td><code id="mclapply.windows_+3A_...">...</code></td>
<td>
<p>For mclapply, optional named arguments to FUN.</p>
</td></tr>
<tr><td><code id="mclapply.windows_+3A_mc.cores">mc.cores</code></td>
<td>
<p>integer, number of cores to be used.
Could be overruled if number of items in list is lower.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a workaround to allow parallel processing in windows since
<code>parallel</code> package only works with linux distributions.
Source: https://www.r-bloggers.com/2014/07/implementing-mclapply-on-windows-a-primer-on-embarrassingly-parallel-computation-on-multicore-systems-with-r/
</p>


<h3>Value</h3>

<p>list
</p>

<hr>
<h2 id='plot_occupancy_duration_curve'>Plot the occupancy duration curve</h2><span id='topic+plot_occupancy_duration_curve'></span>

<h3>Description</h3>

<p>This term is based on the &quot;load duration curve&quot; and is useful to see the
behavior of occupancy over the time in your charging installation.
The steeper the curve, the shorter the duration that higher number of connections
are sustained. Conversely, the flatter the curve, the longer the duration that
higher number of connections are sustained.
This information is crucial for various purposes, such as infrastructure planning,
capacity sizing, and resource allocation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_occupancy_duration_curve(
  sessions,
  dttm_seq = NULL,
  by = "Profile",
  resolution = 15,
  align_time = FALSE,
  mc.cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_occupancy_duration_curve_+3A_sessions">sessions</code></td>
<td>
<p>tibble, sessions data set in standard format marked by <code>{evprof}</code> package
(see <a href="https://mcanigueral.github.io/evprof/articles/sessions-format.html">this article</a>)</p>
</td></tr>
<tr><td><code id="plot_occupancy_duration_curve_+3A_dttm_seq">dttm_seq</code></td>
<td>
<p>sequence of datetime values that will be the <code>datetime</code>
variable of the returned time-series data frame.</p>
</td></tr>
<tr><td><code id="plot_occupancy_duration_curve_+3A_by">by</code></td>
<td>
<p>character, being 'Profile' or 'Session'. When <code>by='Profile'</code> each column corresponds to an EV user profile.</p>
</td></tr>
<tr><td><code id="plot_occupancy_duration_curve_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the sessions datetime variables.
If <code>dttm_seq</code> is defined this parameter is ignored.</p>
</td></tr>
<tr><td><code id="plot_occupancy_duration_curve_+3A_align_time">align_time</code></td>
<td>
<p>logical, whether to align time variables or sessions with the corresponding time <code>resolution</code></p>
</td></tr>
<tr><td><code id="plot_occupancy_duration_curve_+3A_mc.cores">mc.cores</code></td>
<td>
<p>integer, number of cores to use.
Must be at least one, and parallelization requires at least two cores.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)

sessions &lt;- head(evsim::california_ev_sessions_profiles, 100)
plot_occupancy_duration_curve(
  sessions,
  by = "Profile",
  resolution = 15,
  align_time = TRUE
)

</code></pre>

<hr>
<h2 id='plot_ts'>Interactive plot for time-series tibbles</h2><span id='topic+plot_ts'></span>

<h3>Description</h3>

<p>First column of the <code>df</code> tibble must be a <code>datetime</code> or date variable.
The rest of columns must be numeric of the same units. This functions makes
use of <code>dygraphs</code> package to generate an HTML Dygraphs plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_ts(df, title = NULL, xlab = NULL, ylab = NULL, legend_width = 250, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_ts_+3A_df">df</code></td>
<td>
<p>data.frame or tibble, first column of name <code>datetime</code> being of class datetime and rest of columns being numeric</p>
</td></tr>
<tr><td><code id="plot_ts_+3A_title">title</code></td>
<td>
<p>character, title of the plot (accepts HTML code)</p>
</td></tr>
<tr><td><code id="plot_ts_+3A_xlab">xlab</code></td>
<td>
<p>character, X axis label (accepts HTML code)</p>
</td></tr>
<tr><td><code id="plot_ts_+3A_ylab">ylab</code></td>
<td>
<p>character, Y axis label (accepts HTML code)</p>
</td></tr>
<tr><td><code id="plot_ts_+3A_legend_width">legend_width</code></td>
<td>
<p>integer, width (in pixels) of the div which shows the legend.</p>
</td></tr>
<tr><td><code id="plot_ts_+3A_...">...</code></td>
<td>
<p>extra arguments to pass to <code>dygraphs::dyOptions</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dygraph
</p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressMessages(library(lubridate))
suppressMessages(library(dplyr))

# Get demand with the complete datetime sequence from the sessions
sessions &lt;- head(evsim::california_ev_sessions, 100)
demand &lt;- get_demand(
  sessions,
  by = "Session",
  resolution = 60,
  align_time = TRUE
)
demand %&gt;% plot_ts()

</code></pre>

<hr>
<h2 id='prepare_model'>Prepare the models from the <code>evmodel</code> object ready for the simulation</h2><span id='topic+prepare_model'></span>

<h3>Description</h3>

<p>The ratios and default charging power for every user profile,
and the sessions per day for every time cycle are included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_model(ev_models, sessions_day, user_profiles)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepare_model_+3A_ev_models">ev_models</code></td>
<td>
<p>tibble with models from an <code>evmodel</code> object</p>
</td></tr>
<tr><td><code id="prepare_model_+3A_sessions_day">sessions_day</code></td>
<td>
<p>tibble with variables <code>time_cycle</code> (names corresponding to <code>evmodel$models$time_cycle</code>) and <code>n_sessions</code> (number of daily sessions per day for each time-cycle model)</p>
</td></tr>
<tr><td><code id="prepare_model_+3A_user_profiles">user_profiles</code></td>
<td>
<p>tibble with variables <code>time_cycle</code>, <code>user_profile</code>, <code>ratio</code> and optionally <code>power</code>.
The powers must be in kW and the ratios between 0 and 1.
The user profiles with a value of <code>power</code> will be simulated with this specific charging power.
If <code>power</code> is <code>NA</code> then it is simulated according to the ratios of parameter <code>charging_powers</code> in function. <code>simulate_sessions</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>

<hr>
<h2 id='print.evmodel'><code>print</code> method for <code>evmodel</code> object class</h2><span id='topic+print.evmodel'></span>

<h3>Description</h3>

<p><code>print</code> method for <code>evmodel</code> object class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evmodel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.evmodel_+3A_x">x</code></td>
<td>
<p><code>evmodel</code> object
(see this <a href="https://mcanigueral.github.io/evprof/articles/evmodel.html">link</a> for more information)</p>
</td></tr>
<tr><td><code id="print.evmodel_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing but prints information about the <code>evmodel</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(california_ev_model)


</code></pre>

<hr>
<h2 id='read_ev_model'>Read EV model</h2><span id='topic+read_ev_model'></span>

<h3>Description</h3>

<p>Read an EV model JSON file and convert it to object of class <code>evmodel</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ev_model(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ev_model_+3A_file">file</code></td>
<td>
<p>path to the JSON file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code>evmodel</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ev_model &lt;- california_ev_model # Model of example

save_ev_model(ev_model, file = file.path(tempdir(), "evmodel.json"))

read_ev_model(file = file.path(tempdir(), "evmodel.json"))

</code></pre>

<hr>
<h2 id='round_to_interval'>Round a numeric value to interval</h2><span id='topic+round_to_interval'></span>

<h3>Description</h3>

<p>Round a numeric value to interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_to_interval(dbl, interval)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round_to_interval_+3A_dbl">dbl</code></td>
<td>
<p>numeric value</p>
</td></tr>
<tr><td><code id="round_to_interval_+3A_interval">interval</code></td>
<td>
<p>decimal interval (from 0 to 1)</p>
</td></tr>
</table>

<hr>
<h2 id='save_ev_model'>Save the EV model</h2><span id='topic+save_ev_model'></span>

<h3>Description</h3>

<p>Save the EV model object of class <code>evmodel</code> to a JSON file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_ev_model(evmodel, file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_ev_model_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code>
(see this <a href="https://mcanigueral.github.io/evprof/articles/evmodel.html">link</a> for more information)</p>
</td></tr>
<tr><td><code id="save_ev_model_+3A_file">file</code></td>
<td>
<p>character string with the path or name of the file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing but saves the <code>evmodel</code> object in a JSON file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ev_model &lt;- california_ev_model # Model of example

save_ev_model(ev_model, file = file.path(tempdir(), "evmodel.json"))

</code></pre>

<hr>
<h2 id='sessions_feature_names'>Names of standard features of a sessions dataset</h2><span id='topic+sessions_feature_names'></span>

<h3>Description</h3>

<p>A vector with the standard names of sessions features
for this package functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sessions_feature_names
</code></pre>


<h3>Format</h3>

<p>A vector
</p>

<hr>
<h2 id='simulate_sessions'>Simulation of EV sessions</h2><span id='topic+simulate_sessions'></span>

<h3>Description</h3>

<p>Simulate EV charging sessions given the <code>evmodel</code> object and other contextual parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_sessions(
  evmodel,
  sessions_day,
  user_profiles,
  charging_powers,
  dates,
  resolution
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_sessions_+3A_evmodel">evmodel</code></td>
<td>
<p>object of class <code>evmodel</code> built with <code>{evprof}</code>
(see this <a href="https://mcanigueral.github.io/evprof/articles/evmodel.html">link</a> for more information)</p>
</td></tr>
<tr><td><code id="simulate_sessions_+3A_sessions_day">sessions_day</code></td>
<td>
<p>tibble with variables <code>time_cycle</code> (names corresponding to <code>evmodel$models$time_cycle</code>) and <code>n_sessions</code> (number of daily sessions per day for each time-cycle model)</p>
</td></tr>
<tr><td><code id="simulate_sessions_+3A_user_profiles">user_profiles</code></td>
<td>
<p>tibble with variables <code>time_cycle</code>, <code>profile</code>, <code>ratio</code> and optionally <code>power</code>.
The powers must be in kW and the ratios between 0 and 1.
The user profiles with a value of <code>power</code> will be simulated with this specific charging power.
If <code>power</code> is <code>NA</code> then it is simulated according to the ratios of next parameter <code>charging_powers</code>.</p>
</td></tr>
<tr><td><code id="simulate_sessions_+3A_charging_powers">charging_powers</code></td>
<td>
<p>tibble with variables <code>power</code> and <code>ratio</code>.
The powers must be in kW and the ratios between 0 and 1.
This is used to simulate the charging power of user profiles without a specific charging power in <code>user_profiles</code> parameter.</p>
</td></tr>
<tr><td><code id="simulate_sessions_+3A_dates">dates</code></td>
<td>
<p>date sequence that will set the time frame of the simulated sessions</p>
</td></tr>
<tr><td><code id="simulate_sessions_+3A_resolution">resolution</code></td>
<td>
<p>integer, time resolution (in minutes) of the sessions datetime variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dplyr)
library(lubridate)

# Get the example `evmodel`
ev_model &lt;- evsim::california_ev_model

# Simulate EV charging sessions, considering that the Worktime sessions
# during Workdays have 11 kW, while all Visit sessions charge at 3.7kW or
# 11kW, with a distribution of 30% and 70% respectively.

simulate_sessions(
  ev_model,
  sessions_day = tibble(
    time_cycle = c("Workday", "Weekend"),
    n_sessions = c(15, 10)
  ),
  user_profiles = tibble(
    time_cycle = c("Workday", "Workday", "Weekend"),
    profile = c("Visit", "Worktime", "Visit"),
    ratio = c(0.5, 0.5, 1),
    power = c(NA, 11, NA)
  ),
  charging_powers = tibble(
    power = c(3.7, 11),
    ratio = c(0.3, 0.7)
  ),
  dates = seq.Date(today(), today()+days(4), length.out = 4),
  resolution = 15
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
