<!DOCTYPE html><html lang="en"><head><title>Help for package overlapping</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {overlapping}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot.overlap'>
<p>Nonparametric Bootstrap to estimate the overlapping area</p></a></li>
<li><a href='#final.plot'>
<p>Final plot</p></a></li>
<li><a href='#overlap'>
<p>Estimate the overlapping measure.</p></a></li>
<li><a href='#ovmult'>
<p>Multiple overlapping estimation</p></a></li>
<li><a href='#perm.pairs'>
<p>Paired permutation</p></a></li>
<li><a href='#perm.test'>
<p>Permutation test on the (non-)overlapping area</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Overlapping in Empirical Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-12-31</td>
</tr>
<tr>
<td>Author:</td>
<td>Massimiliano Pastore [aut, cre],
  Pierfrancesco Alaimo Di Loro [ctb],
  Marco Mingione [ctb],
  Antonio Calcagni' [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Massimiliano Pastore &lt;massimiliano.pastore@unipd.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for estimating the overlapping area of two or more kernel density estimations from empirical data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), ggplot2, testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-07 12:02:56 UTC; kolmogorov</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-07 14:40:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot.overlap'>
Nonparametric Bootstrap to estimate the overlapping area
</h2><span id='topic+boot.overlap'></span>

<h3>Description</h3>

<p>Resampling via non-parametric bootstrap to estimate the overlapping area between two or more kernel density estimations from empirical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot.overlap( x, B = 1000, pairsOverlap = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="boot.overlap_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared (each vector is an element of the list).</p>
</td></tr>
<tr><td><code id="boot.overlap_+3A_b">B</code></td>
<td>
<p>integer, number of bootstrap draws.</p>
</td></tr>
<tr><td><code id="boot.overlap_+3A_pairsoverlap">pairsOverlap</code></td>
<td>
<p>logical, if <code>TRUE</code>, available only when the list <code>x</code> contains more than two elements, it returns the overlapped area relative to each pair of distributions. </p>
</td></tr>
<tr><td><code id="boot.overlap_+3A_...">...</code></td>
<td>
<p>options, see function <code><a href="#topic+overlap">overlap</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the list <code>x</code> contains more than two elements (i.e., more than two distributions) it computes the bootstrap overlapping measure between all the <code class="reqn">q</code> paired distributions. For example, if <code>x</code> contains three elements then <code class="reqn">q = 3</code>; if <code>x</code> contains four elements then <code class="reqn">q = 6</code>.
</p>


<h3>Value</h3>

<p>It returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>OVboot_stats</code></td>
<td>
<p>a data frame <code class="reqn">q \times 3</code> where each row contains the following statistics:
<code>estOV</code>, estimated overlapping area, <code class="reqn">\hat{\eta}</code>;
<code>bias</code>,  difference between the expected value over the bootstrap samples and the observed overlapping area: <code class="reqn">E(\hat{\eta}^*)-\hat{\eta}</code>;
<code>se</code>, bootstrap standard error <code class="reqn">\sigma_{\hat{\eta}}</code>.</p>
</td></tr>
<tr><td><code>OVboot_dist</code></td>
<td>
<p>a matrix with <code>B</code> rows (bootstrap replicates) and <code class="reqn">q</code> columns (depending on the number of elements of <code>x</code>); each column is a boostrap distribution of the corresponding overlapping measure. </p>
</td></tr>
</table>


<h3>Note</h3>

<p>Call function <code><a href="#topic+overlap">overlap</a></code>.
</p>
<p>Thanks to Jeremy Vollen for suggestions.
</p>


<h3>Author(s)</h3>

<p>Massimiliano Pastore
</p>


<h3>References</h3>

<p>Pastore, M. (2018). Overlapping: a R package for Estimating Overlapping in Empirical Distributions. The Journal of Open Source Software, 3 (32), 1023. doi: <a href="https://doi.org/10.21105/joss.01023">10.21105/joss.01023</a>
</p>
<p>Pastore, M., Calcagnì, A. (2019). Measuring Distribution Similarities Between Samples: A Distribution-Free Overlapping Index. Frontiers in Psychology, 10:1089. doi: <a href="https://doi.org/10.3389/fpsyg.2019.01089">10.3389/fpsyg.2019.01089</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(100), X2=rt(50,8), X3=rchisq(80,2))

## bootstrapping
out &lt;- boot.overlap( x, B = 10 )
out$OVboot_stats

# bootstrap quantile intervals
apply( out$OVboot_dist, 2, quantile, probs = c(.05, .9) )

# plot of bootstrap distributions
Y &lt;- stack( data.frame( out$OVboot_dist ))
ggplot( Y, aes( values )) + facet_wrap( ~ind ) + geom_density()
</code></pre>

<hr>
<h2 id='final.plot'>
Final plot
</h2><span id='topic+final.plot'></span>

<h3>Description</h3>

<p>Graphical representation of the estimated densities along with the overlapping area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>final.plot( x, pairs = FALSE, boundaries = NULL )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="final.plot_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared; each vector is an element of the list, see <code><a href="#topic+overlap">overlap</a></code>.</p>
</td></tr>
<tr><td><code id="final.plot_+3A_pairs">pairs</code></td>
<td>
<p>logical, if <code>TRUE</code> (and <code>x</code> contains more than two elements) produces pairwise plots.</p>
</td></tr>
<tr><td><code id="final.plot_+3A_boundaries">boundaries</code></td>
<td>
<p>an optional vector indicating the minimum and the maximum over a predefined subset of the support of the empirical densities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It requires the package <code>ggplot2</code>.
</p>


<h3>Note</h3>

<p>The output plot can be customized using the <code>ggplot2</code> rules, see example below.
</p>


<h3>Author(s)</h3>

<p>Massimiliano Pastore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(100),X2=rt(50,8),X3=rchisq(80,2))
final.plot(x)
final.plot(x, pairs = TRUE)

# customizing plot
final.plot(x) + scale_fill_brewer() + scale_color_brewer()
final.plot(x) + theme(text=element_text(size=15)) 
</code></pre>

<hr>
<h2 id='overlap'>
Estimate the overlapping measure. 
</h2><span id='topic+overlap'></span>

<h3>Description</h3>

<p>It returns the overlapped estimated area between two or more kernel density estimations from empirical data. The overlapping measure can be computed either as the integral of the minimum between two densities (<code>type = "1"</code>) or as the proportion of overlapping area between two densities (<code>type = "2"</code>). In the last case, the integral of the minimum between two densities is divided by the integral of the maximum of the two densities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overlap( x, nbins = 1024, type = c( "1", "2" ), 
    pairsOverlap = TRUE, plot = FALSE, boundaries = NULL, 
    get_xpoints = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="overlap_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared (each vector is an element of the list).</p>
</td></tr>
<tr><td><code id="overlap_+3A_nbins">nbins</code></td>
<td>
<p>number of equally spaced points through which the density estimates are compared; see <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="overlap_+3A_type">type</code></td>
<td>
<p>character, type of index. If <code>type = "2"</code> returns the proportion of the overlapped area between two or more densities, see Details.</p>
</td></tr>
<tr><td><code id="overlap_+3A_pairsoverlap">pairsOverlap</code></td>
<td>
<p>logical, if <code>TRUE</code> (default) returns the overlapped area relative to each pair of distributions.</p>
</td></tr>
<tr><td><code id="overlap_+3A_plot">plot</code></td>
<td>
<p>logical, if <code>TRUE</code>, the final plot of estimated densities and overlapped areas is produced.</p>
</td></tr>
<tr><td><code id="overlap_+3A_boundaries">boundaries</code></td>
<td>
<p>an optional vector indicating the minimum and the maximum over a predefined subset of the support of the empirical densities, see Details.</p>
</td></tr>
<tr><td><code id="overlap_+3A_get_xpoints">get_xpoints</code></td>
<td>
<p>logical, if <code>TRUE</code> returns a vector where the abscissas represent the points of intersection among the densities. Note: it works only if <code>pairsOverlap = FALSE</code>. </p>
</td></tr>
<tr><td><code id="overlap_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to the function <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When dealing with two densities: <code>type = "1"</code> corresponds to the integral of the minimum between the two densities; <code>type = "2"</code> corresponds to the proportion of the overlapped area over the total area.
</p>
<p>If the list <code>x</code> contains more than two elements (i.e. more than two distributions) it computes both the multiple and the pairwise overlapping among all distributions. 
</p>
<p>If <code>plot = TRUE</code> all the overlapped areas are plotted.  It requires <code>ggplot2</code>.
</p>
<p>The optional vector <code>boundaries</code> has to contain two numbers for the empirical minimum and maximum of the overlapped area. See examples below. 
</p>


<h3>Value</h3>

<p>It returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>OV</code></td>
<td>
<p>estimate of the overlapped area; if <code>x</code> contains more than two elements then a vector of estimates is returned.</p>
</td></tr>
<tr><td><code>xpoints</code></td>
<td>
<p>a list of intersection points (in abscissa) among the densities (if <code>get_xpoints = TRUE</code>).</p>
</td></tr>
<tr><td><code>OVpairs</code></td>
<td>
<p>the estimates of overlapped areas for each pair of densities (only if <code>x</code> contains more than two elements).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Call function <code><a href="#topic+ovmult">ovmult</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Massimiliano Pastore, Pierfrancesco Alaimo Di Loro, Marco Mingione
</p>


<h3>References</h3>

<p>Pastore, M. (2018). Overlapping: a R package for Estimating Overlapping in Empirical Distributions. The Journal of Open Source Software, 3 (32), 1023. doi: <a href="https://doi.org/10.21105/joss.01023">10.21105/joss.01023</a>
</p>
<p>Pastore, M., Calcagnì, A. (2019). Measuring Distribution Similarities Between Samples: A Distribution-Free Overlapping Index. Frontiers in Psychology, 10:1089. doi: <a href="https://doi.org/10.3389/fpsyg.2019.01089">10.3389/fpsyg.2019.01089</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(100), X2=rt(50,8), X3=rchisq(80,2))
overlap(x, plot=TRUE)

# including boundaries
x &lt;- list(X1=runif(100), X2=runif(100,.5,1))
overlap(x, plot=TRUE, boundaries=c(.5,1))

x &lt;- list(X1=runif(100), X2=runif(50), X3=runif(30))
overlap(x, plot=TRUE, boundaries=c(.1,.9))

# changing kernel
overlap(x, plot=TRUE, kernel="rectangular")

# normalized overlap
N &lt;- 1e5
x &lt;- list(X1=runif(N),X2=runif(N,.5))
overlap(x)
overlap(x, type = "2")


</code></pre>

<hr>
<h2 id='ovmult'>
Multiple overlapping estimation
</h2><span id='topic+ovmult'></span>

<h3>Description</h3>

<p>It gives the overlap area between two or more kernel density estimations from empirical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ovmult( x, nbins = 1024, type = c( "1", "2" ), 
    boundaries = NULL, get_xpoints = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ovmult_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared (each vector is an element of the list).</p>
</td></tr>
<tr><td><code id="ovmult_+3A_nbins">nbins</code></td>
<td>
<p>number of equally spaced points through which the density estimates are compared; see <code><a href="stats.html#topic+density">density</a></code> for details.</p>
</td></tr>
<tr><td><code id="ovmult_+3A_type">type</code></td>
<td>
<p>character, type of index. If <code>type = "2"</code> returns the proportion of the overlapped area between two or more densities, see <code><a href="#topic+overlap">overlap</a></code>.</p>
</td></tr>
<tr><td><code id="ovmult_+3A_boundaries">boundaries</code></td>
<td>
<p>an optional vector indicating the minimum and the maximum over a predefined subset of the support of the empirical densities.</p>
</td></tr>
<tr><td><code id="ovmult_+3A_get_xpoints">get_xpoints</code></td>
<td>
<p>logical, if <code>TRUE</code> returns a vector where the abscissas represent the points of intersection among the densities. Note: it works only if <code>pairsOverlap = FALSE</code>. </p>
</td></tr>
<tr><td><code id="ovmult_+3A_...">...</code></td>
<td>
<p>optional arguments to be passed to the function <code><a href="stats.html#topic+density">density</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the list <code>x</code> contains more than two elements (i.e. more than two distributions) it computes multiple overlap measures. 
</p>
<p>The optional vector <code>boundaries</code> has to contain two numbers for the empirical minimum and maximum of the overlapped area. See examples below.
</p>


<h3>Value</h3>

<p>It returns the value of overlapped area. 
</p>


<h3>Note</h3>

<p>Called from the function <code><a href="#topic+overlap">overlap</a></code>. 
</p>


<h3>Author(s)</h3>

<p>Pierfrancesco Alaimo Di Loro, Marco Mingione, Massimiliano Pastore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(100), X2=rt(50,8), X3=rchisq(80,2))
ovmult(x)
ovmult(x, normalized = TRUE)

# including boundaries
x &lt;- list(X1=runif(100), X2=runif(100,.5,1))
ovmult(x, boundaries=c( 0, .8 ))

x &lt;- list(X1=runif(100), X2=runif(50), X3=runif(30))
ovmult(x, boundaries=c( .2, .8 ))

# changing kernel
ovmult(x, kernel="rectangular")

</code></pre>

<hr>
<h2 id='perm.pairs'>
Paired permutation 
</h2><span id='topic+perm.pairs'></span>

<h3>Description</h3>

<p>Perform a random permutation of the data list. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.pairs( x )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm.pairs_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared (each vector is an element of the list).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a list with paired elements of <code>x</code> randomly permuted.
</p>


<h3>Note</h3>

<p>Internal function called by <code><a href="#topic+perm.test">perm.test</a></code>.
</p>


<h3>Author(s)</h3>

<p>Massimiliano Pastore
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(10), X2=rt(15,8))
perm.pairs( x )

x &lt;- list(X1=rnorm(10), X2=rt(15,8), X3=rchisq(12,3))
perm.pairs( x )

</code></pre>

<hr>
<h2 id='perm.test'>
Permutation test on the (non-)overlapping area
</h2><span id='topic+perm.test'></span>

<h3>Description</h3>

<p>Perform a permutation test on the overlapping index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.test( x, B = 1000, 
          return.distribution = FALSE, ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="perm.test_+3A_x">x</code></td>
<td>
<p>a list of numerical vectors to be compared (each vector is an element of the list).</p>
</td></tr>
<tr><td><code id="perm.test_+3A_b">B</code></td>
<td>
<p>integer, number of permutation replicates.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_return.distribution">return.distribution</code></td>
<td>
<p>logical, if <code>TRUE</code> it returns the distribution of permuted Z statistics.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_...">...</code></td>
<td>
<p>options, see function <code><a href="#topic+overlap">overlap</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It performs a permutation test of the null hypothesis that there is no difference between the two distributions, i.e. the overlapping index (<code class="reqn">\eta</code>) is one, or the non-overlapping index (<code class="reqn">1-\eta = \zeta</code>) is zero. 
</p>


<h3>Value</h3>

<p>It returns a list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>Zobs</code></td>
<td>
<p> the observed values of non-overlapping index, i.e. 1-<code class="reqn">\eta</code>. </p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p> p-values. </p>
</td></tr>
<tr><td><code>Zperm</code></td>
<td>
<p> the permutation distributions.</p>
</td></tr>
</table>


<h3>Warning </h3>

<p>Currently, it only runs the permutation test on two groups at a time. If <code>x</code> contains more than 2 elements, it performs all paired permutation tests.
</p>


<h3>Note</h3>

<p>Call function <code><a href="#topic+overlap">overlap</a></code>.
</p>


<h3>Author(s)</h3>

<p>Massimiliano Pastore
</p>


<h3>References</h3>

<p>Perugini, A., Calignano, G., Nucci, M., Finos, L., &amp; Pastore, M. (2024, December 30). How do my distributions differ? Significance testing for the Overlapping Index using Permutation Test. doi: <a href="https://doi.org/10.31219/osf.io/8h4fe">10.31219/osf.io/8h4fe</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(20150605)
x &lt;- list(X1=rnorm(100), X2=rt(50,8))

## not run: this example take several minutes
## permutation test
# out &lt;- perm.test( x, return.distribution = TRUE )
# out$pval
# plot( density( out$Zperm ) )
# abline( v = out$Zobs ) 

x &lt;- list(X1=rnorm(100), X2=rt(50,8), X3=rchisq(75,3))
# out &lt;- perm.test( x )
# out$pval

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
