<!DOCTYPE html><html><head><title>Help for package FeedbackTS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FeedbackTS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FeedbackTS-package'>
<p>Analysis of Feedback in Time Series</p></a></li>
<li><a href='#after.minus.before'>
<p>Computation of after-before differences around key days</p></a></li>
<li><a href='#feedback.stats'>
<p>Computation of feedback and change-in-feedback statistics</p></a></li>
<li><a href='#feedback.test'><p>Test of feedback and change-in-feedback for a single time series</p></a></li>
<li><a href='#kdd'>
<p>Build a KDD object from values of slots</p></a></li>
<li><a href='#KDD-class'><p>Class <code>"KDD"</code></p></a></li>
<li><a href='#kdd.from.raw.data'>
<p>Build a KDD object from raw data</p></a></li>
<li><a href='#kdd.yearly.average'>
<p>Build a KDD.yearly.average object from a KDD object</p></a></li>
<li><a href='#KDD.yearly.average-class'><p>Class <code>"KDD.yearly.average"</code></p></a></li>
<li><a href='#krige'>
<p>Kriging function</p></a></li>
<li><a href='#krige.test'>
<p>Test of spatial variation in feedback and change-in-feedback</p></a></li>
<li><a href='#KT.output-class'><p>Class <code>"KT.output"</code></p></a></li>
<li><a href='#map.statistic'><p>Mapping of a spatial index</p></a></li>
<li><a href='#rain.feedback.stats'>
<p>Statistics of rain feedback in Australia</p></a></li>
<li><a href='#rain.site.6008'>
<p>Rainfall data at Callagiddy station</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Feedback in Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-01-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Samuel Soubeyrand, Cindy E. Morris, E. Keith Bigg</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Samuel Soubeyrand &lt;samuel.soubeyrand@inrae.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analysis of fragmented time directionality to investigate feedback in time series. Tools provided by the package allow the analysis of feedback for a single time series and the analysis of feedback for a set of time series collected across a spatial domain.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), methods, maps, mapdata, proj4</td>
</tr>
<tr>
<td>Imports:</td>
<td>sp, gstat, automap</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-23 08:29:22 UTC; soubeyra</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-23 13:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='FeedbackTS-package'>
Analysis of Feedback in Time Series
</h2><span id='topic+FeedbackTS-package'></span><span id='topic+FeedbackTS'></span>

<h3>Description</h3>

<p>Analysis of fragmented time directionality to investigate feedbacks in time series. Tools provided by the package allow the analysis of feedback for a single time series and the analysis of feedback for a set of time series collected across a spatial domain.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FeedbackTS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-01-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> methods, maps, mapdata, proj4, sp, gstat, automap, date</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>To analyze feedback in a single time series create a <a href="#topic+KDD+20object">KDD object</a> (Key Day Dataset) with the construction function <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a> and test fragmented time directionality with the function <a href="#topic+feedback.test">feedback.test</a>. 
</p>
<p>To analyze the spatial pattern of feedback from a set of time series collected across a spatial domain, create indices of feedback with the function <a href="#topic+feedback.stats">feedback.stats</a>, map the index with <a href="#topic+map.statistic">map.statistic</a>, krige the index with <a href="#topic+krige">krige</a> and test spatial variation in feedback with <a href="#topic+krige.test">krige.test</a>. 
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand, Cindy E. Morris, E. Keith Bigg
</p>
<p>Maintainer: Samuel Soubeyrand <a href="mailto:samuel.soubeyrand@inrae.fr">samuel.soubeyrand@inrae.fr</a>
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of
fragmented time directionality in time series to elucidate feedbacks in
climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load library
## Not run: library(FeedbackTS)

#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites
coord=rain.feedback.stats[,3:4]


########  ANALYSIS OF FEEDBACK WITH A SINGLE TIME SERIES

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### test feedback and change in feedback with a single data series
## using the thresholded data series
## using difference of means of positive indicator values (i.e. rainfall occurrence)
## computer intensive stage
## Not run: 
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))
feedback.test(object=KDD, test="feedback", operator="dmpiv", nb.rand=10^3, plots=TRUE)
## End(Not run)

########  ANALYSIS OF FEEDBACK WITH A SET OF TIME SERIES COLLECTED ACROSS SPACE

#### map of feedback index computed from the whole data series
par(mfrow=c(1,1), mar=c(0,0,0,0))
stat1=rain.feedback.stats[["Feedback.whole.period"]]
map.statistic(coord,stat1,cex.circles=c(3,0.2),
   region=list(border="Australia",xlim=c(110,155)),
   legend=list(x=c(rep(114,3),rep(123,2)),y=-c(37,39.5,42,37,39.5),
      xtext=c(rep(114,3),rep(123,2))+1,ytext=-c(37,39.5,42,37,39.5),digits=2),
  main="Feedback")

#### variogram analysis and kriging of feedback index
## computer intensive stage
## Not run: 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,2.1))
kr1=krige(coordinates=coord, statistic=stat1,
   grid=list(x=seq(110,155,0.25),y=seq(-45,-11,0.25),border="Australia", 
      proj="+proj=lcc +lat_1=-18 +lat_2=-36 +lat0=-25 +lon_0=140",degrees=TRUE),
   plots=TRUE)

## End(Not run)

#### test spatial variation in feedback index and plot test output
## computer intensive stage
## Not run: 
kt1=krige.test(krige.output=kr1,subregion=list(x=c(138,152,152,138),y=-c(40,40,33,33)),
  alternative="greater", nb.rand=2000)
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))	
plot(kt1,digits=list(predict=3,pvalue=3),breaks=12)

## End(Not run)
</code></pre>

<hr>
<h2 id='after.minus.before'>
Computation of after-before differences around key days
</h2><span id='topic+after.minus.before'></span>

<h3>Description</h3>

<p>Computation of after-before differences around key days using using data <code class="reqn">K</code> days before and after each key day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	after.minus.before(data, operator)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="after.minus.before_+3A_data">data</code></td>
<td>

<p>either a <a href="#topic+KDD+20object">KDD object</a>, a <a href="#topic+KDD.yearly.average+20object">KDD.yearly.average object</a>, or a matrix with an odd number of rows corresponding built as the <code>before.after</code> slot of a <a href="#topic+KDD+20object">KDD object</a> or a <a href="#topic+KDD.yearly.average+20object">KDD.yearly.average object</a>. 
</p>
</td></tr>
<tr><td><code id="after.minus.before_+3A_operator">operator</code></td>
<td>

<p>a character string specifying the transformation of the raw values, must be one of <code>"dmv"</code>, <code>"dmpiv"</code> or <code>"dmgiv"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>operator = "dmv"</code> (difference of mean values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> of the time series are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K y_{i+k}\right) - \left(\frac{1}{K}\sum_{k=1}^K  y_{i-k}\right)=\frac{1}{K}\sum_{k=1}^K (y_{i+k}-y_{i-k}),
	</code>
</p>

<p>where <code class="reqn">i</code> is the date of the key day, <code class="reqn">K</code> is the number of days considered after and before the key day (specified when <code>data</code> is provided).
</p>
<p>If <code>operator = "dmpiv"</code> (difference of means of positive indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K 1(y_{i+k}&gt;0)\right) - \left(\frac{1}{K}\sum_{k=1}^K  1(y_{i-k}&gt;0)\right)=\frac{1}{K}\sum_{k=1}^K \{1(y_{i+k}&gt;0)-1(y_{i-k}&gt;0)\},
	</code>
</p>

<p>where <code class="reqn">1(\cdot)</code> is the indicator function.
</p>
<p>If <code>operator = "dmgiv"</code> (difference of means of greater indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i+k}&gt;y_{i-k})\right) - \left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i-k}&gt;y_{i+k})\right).
      </code>
</p>



<h3>Value</h3>

<p>A numeric vector providing for each key day the value of the after-before difference.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD">KDD</a>, <a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### compute and plot after-before differences of KDD 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,4.1))

## using option dmpiv (difference of means of positive indicator values)
amb1=after.minus.before(KDD,"dmpiv")
plot(KDD["day"],amb1,type="l",xlab="Day",ylab="After-Before")
abline(h=0,lty="dashed",col="grey")
plot(KDD["day"],cumsum(amb1),type="l",xlab="Day",ylab="Cumul After-Before")
abline(h=0,lty="dashed",col="grey")

## using option dmv (difference of means of values)
amb2=after.minus.before(KDD,"dmv")
plot(KDD["day"],amb2,type="l",xlab="Day",ylab="After-Before")
abline(h=0,lty="dashed",col="grey")
plot(KDD["day"],cumsum(amb2),type="l",xlab="Day",ylab="Cumul After-Before")
abline(h=0,lty="dashed",col="grey")
</code></pre>

<hr>
<h2 id='feedback.stats'>
Computation of feedback and change-in-feedback statistics
</h2><span id='topic+feedback.stats'></span>

<h3>Description</h3>

<p>Computation of temporal averages of after-before differences around key days calculated from a time series and computation of the difference in the temporal averages around a turning point in time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feedback.stats(object, operator, turning.year = NULL,
    trend.correction = list( apply = FALSE , object2 = NULL ))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feedback.stats_+3A_object">object</code></td>
<td>

<p>either a <a href="#topic+KDD+20object">KDD object</a> or a <a href="#topic+KDD.yearly.average+20object">KDD.yearly.average object</a>.
</p>
</td></tr>
<tr><td><code id="feedback.stats_+3A_operator">operator</code></td>
<td>

<p>a character string specifying the transformation of the raw values, must be one of <code>"dmv"</code>, <code>"dmpiv"</code> or <code>"dmgiv"</code>.
</p>
</td></tr>
<tr><td><code id="feedback.stats_+3A_turning.year">turning.year</code></td>
<td>

<p>an optional numeric vector of years used to specify turning points in the data series.
</p>
</td></tr>
<tr><td><code id="feedback.stats_+3A_trend.correction">trend.correction</code></td>
<td>

<p>an optional list of two items: the <code>apply</code> item, which is a logical
indicating whether the trend correction should be applied or not
(default to <code>FALSE</code>); the <code>object2</code> item, which is a
<a href="#topic+KDD+20object">KDD object</a> typically built like <code>object</code> except that the
keyday threshold is fixed at zero (see example section below).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the following temporal averages of after-before differences around key days calculated from a time series:
</p>
<p style="text-align: center;"><code class="reqn">\bar D(I)=\frac{1}{n(I)}\sum_{i\in I} D_i</code>
</p>

<p>where <code class="reqn">I</code> is a set of key days, <code class="reqn">n(I)</code> is the number of key days in <code class="reqn">I</code>, and <code class="reqn">D_i</code> is an after-before difference computed for each key day <code class="reqn">i</code> (see below and in <a href="#topic+after.minus.before">after.minus.before</a> function). 
</p>
<p>If <code>operator = "dmv"</code> (difference of mean values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> of the time series are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K y_{i+k}\right) - \left(\frac{1}{K}\sum_{k=1}^K  y_{i-k}\right)=\frac{1}{K}\sum_{k=1}^K (y_{i+k}-y_{i-k}),
	</code>
</p>

<p>where <code class="reqn">i</code> is the date of the key day, <code class="reqn">K</code> is the number of days considered around the key day (specified when <code>data</code> is provided).
</p>
<p>If <code>operator = "dmpiv"</code> (difference of means of positive indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K 1(y_{i+k}&gt;0)\right) - \left(\frac{1}{K}\sum_{k=1}^K  1(y_{i-k}&gt;0)\right)=\frac{1}{K}\sum_{k=1}^K \{1(y_{i+k}&gt;0)-1(y_{i-k}&gt;0)\},
	</code>
</p>

<p>where <code class="reqn">1(\cdot)</code> is the indicator function.
</p>
<p>If <code>operator = "dmgiv"</code> (difference of means of greater indicator values), the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> are used to compute the difference: 
</p>
<p style="text-align: center;"><code class="reqn">
		D_i=\left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i+k}&gt;y_{i-k})\right) - \left(\frac{1}{K}\sum_{k=1}^K
	1(y_{i-k}&gt;y_{i+k})\right).
      </code>
</p>

<p>If <code>turning.year = NULL</code>, the function computes <code class="reqn">\bar D(I)</code>
where <code class="reqn">I</code> is the set of all key days in the whole time series.
</p>
<p>If <code>turning.year</code> is a numeric vector, for each value <code class="reqn">t</code> in
<code>turning.year</code> the function computes <code class="reqn">\bar D(I)</code> with <code class="reqn">I</code>
equal to the set of key days in the whole time series, in the time
series before <code class="reqn">t</code> and in the time series after <code class="reqn">t</code>. The function
also computes, for each value <code class="reqn">t</code>, the difference between the
temporal averages of after-before differences after <code class="reqn">t</code> and before
<code class="reqn">t</code>.
</p>
<p>If <code>trend.correction$apply = TRUE</code>, a trend correction is applied
to take into account, for example, seasonal effect in the time series
(see Morris et al., 2016). 
</p>


<h3>Value</h3>

<p>If <code>turning.year = NULL</code>, a numeric equal to the temporal average of after-before differences around key days calculated from the whole time series.
</p>
<p>If <code>turning.year</code> is a numeric vector, a numeric vector providing: 
</p>

<dl>
<dt>&ndash;</dt><dd><p>the temporal average of after-before differences around key days calculated from the whole time series;</p>
</dd>
<dt>&ndash;</dt><dd><p>for each value <code class="reqn">t</code> in <code>turning.year</code>,
</p>

<dl>
<dt>&ndash;</dt><dd><p>the temporal average <code class="reqn">\bar D_{&lt;t}</code> of after-before differences around key days calculated from the time series right-truncated at time <code class="reqn">t</code>;</p>
</dd>
<dt>&ndash;</dt><dd><p>the temporal average <code class="reqn">\bar D_{\ge t}</code>  of after-before differences around key days calculated from the time series left-truncated at time <code class="reqn">t</code>;</p>
</dd>
<dt>&ndash;</dt><dd><p>the difference <code class="reqn">\bar D_{\ge t}-\bar D_{&lt;t}</code>.</p>
</dd>
</dl>

</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Morris, C.E., Soubeyrand, S.; Bigg, E.K., Creamean, J.M., Sands,
D.C. (2016). Rainfall feedback maps: a tool to depict
the geography of precipitation's sensitivity to
aerosols. INRA Research Report.
</p>
<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD">KDD</a>, <a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+after.minus.before">after.minus.before</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>, <a href="#topic+rain.feedback.stats">rain.feedback.stats</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008, keyday.threshold=25, nb.days=20,
   col.series=5, col.date=c(2,3,4), na.rm=TRUE, filter=NULL)
	
#### main feedback statistic
feedback.stats(KDD, "dmv")

#### main and auxiliary feedback statistics
feedback.stats(KDD, "dmv", turning.year=c(1960,1980))

#### apply a trend correction
## define the KDD object used for trend correction (it is defined as
## KDD above except that the threshold value is equal to 0)
KDD2=kdd.from.raw.data(raw.data=rain.site.6008, keyday.threshold=0, nb.days=20,
   col.series=5, col.date=c(2,3,4), na.rm=TRUE, filter=NULL)
## compute the statistic
feedback.stats(KDD, "dmv", trend.correction=list(apply=TRUE, object2=KDD2))
</code></pre>

<hr>
<h2 id='feedback.test'>Test of feedback and change-in-feedback for a single time series
</h2><span id='topic+feedback.test'></span>

<h3>Description</h3>

<p>Randomization test to investigate the fragmented time directionality in a single time series and the temporal variation in the fragmented time directionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feedback.test(object, test, operator, nb.rand, plots = TRUE, turning.year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feedback.test_+3A_object">object</code></td>
<td>

<p>either a <a href="#topic+KDD+20object">KDD object</a> or a <a href="#topic+KDD.yearly.average+20object">KDD.yearly.average object</a>.
</p>
</td></tr>
<tr><td><code id="feedback.test_+3A_test">test</code></td>
<td>

<p>a character string specifying the type of test, must be one of <code>"feedback"</code> or <code>"change.in.feedback"</code>.
</p>
</td></tr>
<tr><td><code id="feedback.test_+3A_operator">operator</code></td>
<td>

<p>a character string specifying the transformation of the raw values, must be one of <code>"dmv"</code> or <code>"dmpiv"</code> (see section Details in <a href="#topic+after.minus.before">after.minus.before</a>).
</p>
</td></tr>
<tr><td><code id="feedback.test_+3A_nb.rand">nb.rand</code></td>
<td>

<p>a positive integer specifying the number of randomizations.
</p>
</td></tr>
<tr><td><code id="feedback.test_+3A_plots">plots</code></td>
<td>

<p>a logical indicating if plots characterizing the test are produced (if <code>plots = TRUE</code>) or not (if <code>plots = FALSE</code>), default is TRUE. 
</p>
</td></tr>
<tr><td><code id="feedback.test_+3A_turning.year">turning.year</code></td>
<td>

<p>an optional numeric value specifying a temporal turning point in the data series, must be provided if <code>operator = "change.in.feedback"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>plots = TRUE</code>, two plots are produced. The first plot gives the cumulative after-before difference (CABD; red curve) and for each CABD value the quantiles of order 0.025 (bottom dotted curve), 0.25 (bottom dashed curve), 0.5 (solid black curve), 0.75 (top dashed curve) and 0.975 (top dotted curve) under the null hypothesis that is tested (either no feedback or no change-in-feedback). The second plot gives the number of exits of the CABD function from the confidence intervals (red line) and the distribution of the number of exits under the null hypothesis that is tested (histogram).
</p>


<h3>Value</h3>

<p>A numeric value providing the p-value of the test.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD">KDD</a>, <a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+after.minus.before">after.minus.before</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008, keyday.threshold=25, nb.days=20,
   col.series=5, col.date=c(2,3,4), na.rm=TRUE, filter=NULL)

#### test feedback and change in feedback with a single data series
## using the thresholded data series
## using difference of means of positive indicator values (i.e. rainfall occurrence)
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))
feedback.test(object=KDD, test="feedback", operator="dmpiv", nb.rand=10^3, plots=TRUE)
</code></pre>

<hr>
<h2 id='kdd'>
Build a KDD object from values of slots
</h2><span id='topic+kdd'></span>

<h3>Description</h3>

<p>Build a KDD (Key Day Dataset) object directly from values of the slots of the KDD class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdd(before.after, date, year, day, keyday.threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kdd_+3A_before.after">before.after</code></td>
<td>
 
<p>a matrix with <code class="reqn">2\times K+1</code> rows 
and <code class="reqn">n</code> columns: Each column gives the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> of the time series, where <code class="reqn">i</code> is the date of the key day, <code class="reqn">K</code> is the number of days considered after and before the key day, <code class="reqn">n</code> is the number of key days in the data series (depends on <code>keyday.threshold</code>).
</p>
</td></tr>
<tr><td><code id="kdd_+3A_date">date</code></td>
<td>

<p>a character vector providing the dates of the key days in format yyyy.mm.dd.
</p>
</td></tr>
<tr><td><code id="kdd_+3A_year">year</code></td>
<td>

<p>a numeric vector providing the years during which the key days occurred.
</p>
</td></tr>
<tr><td><code id="kdd_+3A_day">day</code></td>
<td>

<p>a numeric vector providing for each key day the number of  days since the beginning of the data series.
</p>
</td></tr>
<tr><td><code id="kdd_+3A_keyday.threshold">keyday.threshold</code></td>
<td>

<p>a numeric value providing the threshold value above which a day is considered as a key day (i.e. if <code class="reqn">y_i\ge </code> <code>keyday.threshold</code>, then day <code class="reqn">i</code> is a key day).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object from the <a href="#topic+KDD+20class">KDD class</a>.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD">KDD</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)
	
#### build a new KDD object by modifying one of the slots of KDD
## (e.g. new starting point of the data series)
KDD2=kdd(before.after=KDD@before.after,date=KDD@date,year=KDD@year,
   day=KDD@day-100,keyday.threshold=KDD@keyday.threshold)

#### simplest alternative
KDD2=KDD
KDD2["day"]=KDD2["day"]-100
</code></pre>

<hr>
<h2 id='KDD-class'>Class <code>"KDD"</code></h2><span id='topic+KDD-class'></span><span id='topic+KDD'></span><span id='topic+KDD+20object'></span><span id='topic+KDD-object'></span><span id='topic+KDD+20class'></span><span id='topic++5B+3C-+2CKDD+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+2CKDD-method'></span><span id='topic+names+2CKDD-method'></span><span id='topic+show+2CKDD-method'></span><span id='topic+summary+2CKDD-method'></span>

<h3>Description</h3>

<p>Class KDD (Key Day Dataset) used as argument in <code>FeedbackTS</code> functions for the analysis of fragmented time directionality and feedback.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("KDD", ...)</code>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>(...) and <a href="#topic+kdd">kdd</a>(...). 
</p>


<h3>Slots</h3>


<dl>
<dt><code>before.after</code>:</dt><dd><p>Object of class <code>"matrix"</code> with <code class="reqn">2\times K+1</code> rows 
and <code class="reqn">n</code> columns: Each column gives the raw values <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> of the time series, where <code class="reqn">i</code> is the date of the key day, <code class="reqn">K</code> is the number of days considered after and before the key day, <code class="reqn">n</code> is the number of key days in the data series (depends on <code>keyday.threshold</code>).</p>
</dd>
<dt><code>date</code>:</dt><dd><p>Object of class <code>"character"</code>, vector of size <code class="reqn">n</code> providing the dates of the key days in format yyyy.mm.dd.</p>
</dd>
<dt><code>year</code>:</dt><dd><p>Object of class <code>"numeric"</code>, vector of size <code class="reqn">n</code> providing the years during which the key days occurred.</p>
</dd>
<dt><code>day</code>:</dt><dd><p>Object of class <code>"numeric"</code>, vector of size <code class="reqn">n</code> providing for each key day the number of days since the beginning of the data series.</p>
</dd>
<dt><code>keyday.threshold</code>:</dt><dd><p>Object of class <code>"numeric"</code> providing the threshold value above which a day is considered as a key day (i.e. if <code class="reqn">y_i\ge </code> <code>keyday.threshold</code>, then day <code class="reqn">i</code> is a key day).</p>
</dd>
</dl>



<h3>Methods</h3>



<dl>
<dt>[&lt;-</dt><dd><p><code>signature(x = "KDD", i = "ANY", j = "ANY", value =
	"ANY")</code>: Change one of the slots.</p>
</dd>
<dt>[</dt><dd><p><code>signature(x = "KDD")</code>: Extract one of the slots.</p>
</dd>
<dt>names</dt><dd><p><code>signature(x = "KDD")</code>: Prints slot names. </p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "KDD")</code>: Prints all slots of
the KDD object.</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "KDD")</code>: Prints summary
characteristics of the KDD object.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+kdd">kdd</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("KDD")

#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build a KDD object from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

## summary of the object
summary(KDD)
## names of the object
names(KDD)
slotNames(KDD)

## show attributes of the object
KDD["before.after"][,1:5]
KDD["date"]
KDD["keyday.threshold"]

## change keyday threshold
KDD["keyday.threshold"]=50
</code></pre>

<hr>
<h2 id='kdd.from.raw.data'>
Build a KDD object from raw data
</h2><span id='topic+kdd.from.raw.data'></span>

<h3>Description</h3>

<p>Build a KDD (Key Day Dataset) object from a matrix or a data frame containing a time series and other attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdd.from.raw.data(raw.data, keyday.threshold, nb.days, col.series, col.date, 
na.rm = TRUE, filter = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kdd.from.raw.data_+3A_raw.data">raw.data</code></td>
<td>

<p>a data frame or a matrix containing raw data.
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_keyday.threshold">keyday.threshold</code></td>
<td>

<p>a numeric providing the threshold value above which a day is considered as a key day (i.e. if the value <code class="reqn">y_i</code> of the times series is greater than or equal to <code>keyday.threshold</code> at day <code class="reqn">i</code>, then day <code class="reqn">i</code> is a key day).
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_nb.days">nb.days</code></td>
<td>

<p>an integer specifying the number of days considered after and before each key day.
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_col.series">col.series</code></td>
<td>

<p>an integer specifying the number of the column containing the time series.
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_col.date">col.date</code></td>
<td>

<p>an integer vector of size three specifying the numbers of the columns containing the vector of years, the vector of months and the vector of days in numeric format.
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_na.rm">na.rm</code></td>
<td>

<p>a logical indicating whether key days <code class="reqn">i</code> with missing values in the sub-series <code class="reqn">y_{i-K},\ldots,y_{i+K}</code> have to be discarded. If <code>na.rm = TRUE</code>, these key days are discarded (default is <code>TRUE</code>). 
</p>
</td></tr>
<tr><td><code id="kdd.from.raw.data_+3A_filter">filter</code></td>
<td>

<p>a list of lists specifying the filters to carry out over the time series (default is <code>NULL</code>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>filter</code> argument is a list of lists, each list having the following arguments:
</p>

<dl>
<dt><code>apply.over</code>:</dt><dd><p>a character string that must be one of &quot;keyday&quot; or &quot;range&quot;, and that indicates whether the filter concerns only  the key days or also the range of days considered around the key days (<code class="reqn">K</code> days before and <code class="reqn">K</code> days after each key day).</p>
</dd>
<dt><code>column</code>:</dt><dd><p>an integer specifying the column of <code>raw.data</code> which the filter is applied to.</p>
</dd>
<dt><code>value</code>:</dt><dd><p>a value that must be taken by the variable determined by the argument <code>column</code>. </p>
</dd>
</dl>
	
<p>Let <code class="reqn">i</code> denote a key day. Let <code class="reqn">z_i</code> denote the value, at day <code class="reqn">i</code>, of the variable determined by the argument <code>column</code>. If <code>apply.over = "keyday"</code> and <code class="reqn">z_i</code> = <code>value</code>, then key day <code class="reqn">i</code> is kept, otherwise it is discarded.  If <code>apply.over = "range"</code> and <code class="reqn">z_j</code> = <code>value</code> for all <code class="reqn">j\in\{i-K,\ldots,i+K\}</code>, then key day <code class="reqn">i</code> is kept, otherwise it is discarded.
</p>


<h3>Value</h3>

<p>an object from the <a href="#topic+KDD+20class">KDD class</a>.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD">KDD</a>, <a href="#topic+kdd">kdd</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)
summary(KDD)

#### build KDD objects from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
## using filters
rain.site.6008b=cbind(rain.site.6008,rain.site.6008[["Year"]]&gt;=1960)
KDD2=kdd.from.raw.data(raw.data=rain.site.6008b,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,
   filter=list(list(apply.over="range",column=6,value=TRUE)))
summary(KDD2)
</code></pre>

<hr>
<h2 id='kdd.yearly.average'>
Build a KDD.yearly.average object from a KDD object
</h2><span id='topic+kdd.yearly.average'></span>

<h3>Description</h3>

<p>Build a KDD.yearly.average (yearly average of a Key Day Dataset) by averaging on a yearly basis a KDD object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kdd.yearly.average(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kdd.yearly.average_+3A_object">object</code></td>
<td>

<p>an object from the <a href="#topic+KDD+20class">KDD class</a>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object from the <a href="#topic+KDD.yearly.average+20class">KDD.yearly.average class</a>.
</p>


<h3>Note</h3>

<p>The <code>before.after</code> matrix of the <a href="#topic+KDD+20object">KDD object</a> is averaged on a yearly basis: every group of columns corresponding to a single year is averaged into a single column.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+KDD">KDD</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build a KDD object from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### build the yearly average of KDD
KDD2=kdd.yearly.average(KDD)

## summary of the object
summary(KDD2)
</code></pre>

<hr>
<h2 id='KDD.yearly.average-class'>Class <code>"KDD.yearly.average"</code></h2><span id='topic+KDD.yearly.average-class'></span><span id='topic+KDD.yearly.average'></span><span id='topic+KDD.yearly.average+20class'></span><span id='topic+KDD.yearly.average+20object'></span><span id='topic+KDD.yearly.average-object'></span><span id='topic++5B+2CKDD.yearly.average-method'></span><span id='topic+show+2CKDD.yearly.average-method'></span><span id='topic+summary+2CKDD.yearly.average-method'></span><span id='topic+names+2CKDD.yearly.average-method'></span>

<h3>Description</h3>

<p>Class KDD.yearly.average (yearly average of a Key Day Dataset) used as argument in <code>FeedbackTS</code> functions for the analysis of fragmented time directionality and feedback.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("KDD.yearly.average", ...)</code> and <a href="#topic+kdd.yearly.average">kdd.yearly.average</a>(...).
</p>


<h3>Slots</h3>


<dl>
<dt><code>before.after</code>:</dt><dd><p>Object of class <code>"matrix"</code>  with <code class="reqn">2\times K+1</code> rows 
and <code class="reqn">n</code> columns: Each column gives the yearly average of the vectors of raw values <code class="reqn">(y_{i-K},\ldots,y_{i+K})</code> of the time series for key days <code class="reqn">i</code> occurring during a single year (<code class="reqn">K</code> is the number of days considered after and before the key day, <code class="reqn">n</code> is the number of years with key days in the data series and depends on <code>keyday.threshold</code>).</p>
</dd>
<dt><code>year</code>:</dt><dd><p>Object of class <code>"numeric"</code>, vector of size <code class="reqn">n</code> providing the years during which the key days occurred.</p>
</dd>
<dt><code>keyday.threshold</code>:</dt><dd><p>Object of class <code>"numeric"</code> providing the threshold value above which a day is considered as a key day (i.e. if <code class="reqn">y_i\ge </code> <code>keyday.threshold</code>, then day <code class="reqn">i</code> is a key day).</p>
</dd>
<dt><code>yearly.nb.keydays</code>:</dt><dd><p>Object of class <code>"numeric"</code>, vector of size <code class="reqn">n</code> providing the number of key days at each year of the slot <code>year</code>.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>[</dt><dd><p><code>signature(x = "KDD.yearly.average")</code>: Extract one of the slots.</p>
</dd>
<dt>names</dt><dd><p><code>signature(x = "KDD.yearly.average")</code>: Prints slot names.</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "KDD.yearly.average")</code>: Prints all slots of the KDD object.</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "KDD.yearly.average")</code>: Prints summary characteristics of the KDD object.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+KDD.yearly.average">KDD.yearly.average</a>, <a href="#topic+KDD">KDD</a>, <a href="#topic+kdd.from.raw.data">kdd.from.raw.data</a>, <a href="#topic+rain.site.6008">rain.site.6008</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("KDD.yearly.average")

#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build a KDD object from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 25
KDD=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=25,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### build the yearly average of KDD
KDD2=kdd.yearly.average(KDD)

## summary of the object
summary(KDD2)
## names of the object
names(KDD2)
slotNames(KDD2)

## show attributes of the object
KDD2["before.after"][,1:5]
KDD2["year"]
KDD2["keyday.threshold"]
</code></pre>

<hr>
<h2 id='krige'>
Kriging function
</h2><span id='topic+krige'></span>

<h3>Description</h3>

<p>Variogram analysis and kriging prediction used to analyze feedback and
change-in-feedback across space. This function is
grounded on the function <code>autoKrige</code> in the <code>automap</code>
package, grounded itself on the <code>gstat</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>krige(coordinates, statistic, grid, krige.param=NULL, plots=TRUE,
    variog.param=list(npoints=50,nsim=99,plot.numbers=0.04))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="krige_+3A_coordinates">coordinates</code></td>
<td>
<p>a 2-column matrix with latitudes and longitudes of observation sites.
</p>
</td></tr>
<tr><td><code id="krige_+3A_statistic">statistic</code></td>
<td>
<p>a numeric vector specifying the values, at observation sites, of the statistic to be predicted.
</p>
</td></tr>
<tr><td><code id="krige_+3A_grid">grid</code></td>
<td>
<p>a list of arguments defining the grid over which the statistic is predicted:
</p>

<dl>
<dt><code>x</code>:</dt><dd><p>a numeric vector of longitudes.</p>
</dd>
<dt><code>y</code>:</dt><dd><p>a numeric vector of latitudes.</p>
</dd>
<dt><code>border</code>:</dt><dd><p>a character string that names the region in the world within which the statistic will be predicted. This is a character string in the database <code>world</code>; see the function <code>map</code> in the <code>maps</code> package.</p>
</dd>
<dt><code>proj</code>:</dt><dd><p>a projection definition; see the function <code>project</code> in the <code>proj4</code> package.</p>
</dd>
<dt><code>degrees</code>:</dt><dd><p>a logical indicating  if  the lat/long coordinates are assumed to be in degrees (if <code>degrees = TRUE</code>), or in radians (if <code>degrees = FALSE</code>).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="krige_+3A_krige.param">krige.param</code></td>
<td>
<p>a character string equal either to &quot;x+y&quot;, &quot;x&quot; or &quot;y&quot;
indicating whether the coordinates (and which coordinates) have to be
accounted for in the trend in universal kriging; default is NULL, indicating that
ordinary kriging without trend is performed.</p>
</td></tr>
<tr><td><code id="krige_+3A_plots">plots</code></td>
<td>

<p>a logical indicating if plots characterizing the variogram analysis and the kriging prediction are produced (if <code>plots = TRUE</code>) or not (if <code>plots = FALSE</code>), default is TRUE.
</p>
</td></tr>
<tr><td><code id="krige_+3A_variog.param">variog.param</code></td>
<td>
<p>a list of arguments used to display the variography,  :
</p>

<dl>
<dt><code>npoints</code>:</dt><dd><p>a numeric value specifying the number of points at
which the variogram model is calculated, default is 50.</p>
</dd>
<dt><code>nsim</code>:</dt><dd><p>a numeric value specifying the number of Monte Carlo
simulations used to compute the envelope, default
is 99.</p>
</dd>
<dt><code>plot.numbers</code>:</dt><dd><p>a numeric value specifyng the relative
distance to be used between circles representing the empirical
semivariogram and texts providing the number of point pairs used for
computing each value of the empirical semivariogram, default is
0.04 (if <code>plot.numbers = 0</code>, these texts are not displayed).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>If <code>plots = TRUE</code>, four plots are produced. Plot 1:
Estimation of the semivariogram of the statistic (dots: sample
semivariogram; solid curve: theoretical semivariogram; dashed
curves: Monte-Carlo envelopes. Plot 2: Boxplots of kriging prediction (left) and kriging standard error (right). Plot 3: Kriging prediction. Plot 4: Kriging standard error.
</p>


<h3>Value</h3>

<p>a list of items characterizing the variogram analysis and the kriging prediction:
</p>
<table>
<tr><td><code>input</code></td>
<td>
<p>the list of arguments in the call of the <code>krige</code> function except the argument <code>plots</code>.
</p>
</td></tr>
<tr><td><code>MAP</code></td>
<td>
<p>a list allowing to draw the border of the study region that can be made of several polygons. This is the output of the function <code>map</code> in the <code>maps</code> package.</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>a 2-column matrix providing the coordinates (in degrees) of the nodes of the prediction locations.</p>
</td></tr>
<tr><td><code>in.region</code></td>
<td>
<p>a logical vector indicating, for each grid node whose coordinates are given in  the 2-column matrix <code>grid</code>, if the node is in the study region or not. The study region is defined by <code>MAP</code>.</p>
</td></tr>
<tr><td><code>krige</code></td>
<td>
<p>a list providing the result the variography and the spatial prediction. This is the output of the function <code>autoKrige</code> in the <code>automap</code> package.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The <code>krige</code> function uses some of the functionalities of
the <code>map</code> function in the <code>maps</code> package, and of a few
functions in the <code>gstat</code> and <code>automap</code> package. To
fully exploit the functionalities of these external functions
(in particular <code>autoKrige</code>), the <code>krige</code> function should be extended.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><code>rain.feedback.stats</code>, <code>map</code> in the <code>maps</code> package, <code>autoKrige</code>  and <code>autofitVariogram</code> in the <code>automap</code> package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites
coord=rain.feedback.stats[,3:4]

#### feedback index
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### variogram analysis and kriging of feedback index
## computer intensive stage
## Not run: 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,4.1))
kr1=krige(coordinates=coord, statistic=stat1,
   grid=list(x=seq(110,155,0.25),y=seq(-45,-11,0.25),border="Australia", 
      proj="+proj=lcc +lat_1=-18 +lat_2=-36 +lat0=-25 +lon_0=140",degrees=TRUE),
   plots=TRUE)

## the plot style from the \code{automap} package can be obtained as follows:
plot(kr1$krige)

## End(Not run)

</code></pre>

<hr>
<h2 id='krige.test'>
Test of spatial variation in feedback and change-in-feedback
</h2><span id='topic+krige.test'></span>

<h3>Description</h3>

<p>Randomization test to investigate spatial variation in a kriged index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>krige.test(krige.output, subregion, alternative, nb.rand, subregion.coverage=0.8)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="krige.test_+3A_krige.output">krige.output</code></td>
<td>

<p>a list of items corresponding to the output of the <a href="#topic+krige">krige</a> function.
</p>
</td></tr>
<tr><td><code id="krige.test_+3A_subregion">subregion</code></td>
<td>

<p>a list of two vectors containing the lat/long coordinates of the vertices of a polygon. The polygon defines a subregion where one supposes variation in the predicted index <code>krige.output$krige$predict</code>.
</p>

<dl>
<dt><code>x</code>:</dt><dd><p>longitudes.</p>
</dd>
<dt><code>y</code>:</dt><dd><p>latitudes.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="krige.test_+3A_alternative">alternative</code></td>
<td>

<p>a character string specifying the alternative hypothesis, must be one of &quot;greater&quot; or &quot;less&quot;. 
</p>
</td></tr>
<tr><td><code id="krige.test_+3A_nb.rand">nb.rand</code></td>
<td>

<p>a positive integer specifying the number of randomizations (here, a randomization is a random translation on a torus).
</p>
</td></tr>
<tr><td><code id="krige.test_+3A_subregion.coverage">subregion.coverage</code></td>
<td>

<p>a numeric value between zero and one specifying a criterion to accept a random translation (see Details).  Default value is 0.8.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The criterion to accept a random translation is a minimum coverage of <code>subregion</code> by the translated grid: the ratio between the number of nodes of the translated grid that are contained in <code>subregion</code> and the number of nodes of the original grid that are contained in <code>subregion</code> must be equal to or greater than <code>subregion.coverage</code>.
</p>


<h3>Value</h3>

<p>an object from the <a href="#topic+KT.output+20class">KT.output class</a>
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p><a href="#topic+krige">krige</a>, <a href="#topic+KT.output-class">KT.output-class</a>, <a href="#topic+rain.feedback.stats">rain.feedback.stats</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites
coord=rain.feedback.stats[,3:4]

#### map of feedback index computed from the whole data series
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### variogram analysis and kriging of feedback index
## computer intensive stage
## Not run: 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,2.1))
kr1=krige(coordinates=coord, statistic=stat1,
   grid=list(x=seq(110,155,0.25),y=seq(-45,-11,0.25),border="Australia", 
      proj="+proj=lcc +lat_1=-18 +lat_2=-36 +lat0=-25 +lon_0=140",degrees=TRUE),
   plots=TRUE)

## End(Not run)
#### test spatial variation in feedback index and plot test output
## computer intensive stage
## Not run: 
kt1=krige.test(krige.output=kr1,subregion=list(x=c(138,152,152,138),y=-c(40,40,33,33)),
   alternative="greater", nb.rand=2000)
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))	
plot(kt1,digits=list(predict=3,pvalue=3),breaks=12)

## End(Not run)
</code></pre>

<hr>
<h2 id='KT.output-class'>Class <code>"KT.output"</code></h2><span id='topic+KT.output-class'></span><span id='topic+KT.output'></span><span id='topic+KT.output+20class'></span><span id='topic+KT.output-object'></span><span id='topic+KT.output+20object'></span><span id='topic++5B+3C-+2CKT.output+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+2CKT.output-method'></span><span id='topic+show+2CKT.output-method'></span><span id='topic+summary+2CKT.output-method'></span><span id='topic+names+2CKT.output-method'></span><span id='topic+plot+2CKT.output+2CANY-method'></span>

<h3>Description</h3>

<p>Output of the <a href="#topic+krige.test">krige.test</a> function.
</p>


<h3>Objects from the Class</h3>

<p>Objects are created by calls of the <a href="#topic+krige.test">krige.test</a> function.
</p>


<h3>Slots</h3>


<dl>
<dt><code>krige.output</code>:</dt><dd><p>Object of class <code>"list"</code>, output of the <a href="#topic+krige">krige</a> function.</p>
</dd>
<dt><code>subregion</code>:</dt><dd><p>Object of class <code>"list"</code>, two vectors <code>x</code> and <code>y</code> containing the latitudes and the longitudes, respectively, of the vertices of a polygon. The polygon defines a subregion where one supposes variation in the predicted index.</p>
</dd>
<dt><code>averageKrigingPrediction.rand</code>:</dt><dd><p>Object of class <code>"numeric"</code> specifying the averages of the kriging predictions in <code>subregion</code> obtained with randomized data (here, a randomization is a random translation on a torus). </p>
</dd>
<dt><code>averageKrigingPrediction.obs</code>:</dt><dd><p>Object of class <code>"numeric"</code> specifying the average of the kriging prediction in <code>subregion</code> obtained with observed data. </p>
</dd>
<dt><code>alternative</code>:</dt><dd><p>Object of class <code>"character"</code>, &quot;greater&quot; or &quot;less&quot;.</p>
</dd>
<dt><code>p.value</code>:</dt><dd><p>Object of class <code>"numeric"</code>, p-value of the test.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>[&lt;-</dt><dd><p><code>signature(x = "KT.output", i = "ANY", j = "ANY", value = "ANY")</code></p>
</dd>


<dt>[</dt><dd><p><code>signature(x = "KT.output")</code>: Extract one of the slots.</p>
</dd>
<dt>names</dt><dd><p><code>signature(x = "KT.output")</code>: Prints slot names.</p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "KT.output")</code>: Prints all slots of
the KDD object.</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "KT.output")</code>: Prints summary
characteristics of the KDD object.</p>
</dd>
<dt>plot</dt><dd><p><code>signature(x = "KT.output"), i="ANY"</code>: Graphically displays contents of the object.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showClass("KT.output")

#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites
coord=rain.feedback.stats[,3:4]

#### map of feedback index computed from the whole data series
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### variogram analysis and kriging of feedback index
## Not run: 
par(mfrow=c(2,2), mar=c(5.1,4.1,4.1,2.1))
kr1=krige(coordinates=coord, statistic=stat1,
    grid=list(x=seq(110,155,0.25),y=seq(-45,-11,0.25),border="Australia",
        proj="+proj=lcc +lat_1=-18 +lat_2=-36 +lat0=-25 +lon_0=140",degrees=TRUE),
    plots=TRUE)

## End(Not run)

#### test spatial variation in feedback index and plot test output
## computer intensive stage
## Not run: 
kt1=krige.test(krige.output=kr1,subregion=list(x=c(138,152,152,138),y=-c(40,40,33,33)),
   alternative="greater", nb.rand=2000)
par(mfrow=c(1,2), mar=c(5.1,4.1,4.1,2.1))	
plot(kt1,digits=list(predict=3,pvalue=3),breaks=12) 
## End(Not run)
</code></pre>

<hr>
<h2 id='map.statistic'>Mapping of a spatial index
</h2><span id='topic+map.statistic'></span>

<h3>Description</h3>

<p>Mapping of a spatial index with circles whose sizes and colors vary with the values of the index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map.statistic(coordinates, statistic, region, cex.circles = c(3, 0.2), legend, 
	main = NULL, add = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map.statistic_+3A_coordinates">coordinates</code></td>
<td>

<p>a 2-column matrix with latitudes and longitudes of observation sites.
</p>
</td></tr>
<tr><td><code id="map.statistic_+3A_statistic">statistic</code></td>
<td>

<p>a numeric vector specifying the values, at observation sites, of the index to be mapped.
</p>
</td></tr>
<tr><td><code id="map.statistic_+3A_region">region</code></td>
<td>

<p>a list of arguments defining the region over which the index is mapped:
</p>

<dl>
<dt><code>border</code>:</dt><dd><p>a character string that names the region in the world within which the statistic will be predicted. This is a character string in the database <code>world</code>; see the function <code>map</code> in the <code>maps</code> package.</p>
</dd>
<dt><code>xlim</code>:</dt><dd><p>a numeric vector of size 2 specifying the limits in longitude of the plot. May not be provided.</p>
</dd>
<dt><code>ylim</code>:</dt><dd><p>a numeric vector of size 2 specifying the limits in latitude of the plot. May not be provided.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="map.statistic_+3A_cex.circles">cex.circles</code></td>
<td>
 
<p>a numeric vector specifying the circle expansion.
</p>
</td></tr>
<tr><td><code id="map.statistic_+3A_legend">legend</code></td>
<td>

<p>a list of arguments defining the location of the legend in the plot:
</p>

<dl>
<dt><code>x</code>:</dt><dd><p>a numeric vector specifying the longitudes where the legend circles are drawn.</p>
</dd>
<dt><code>y</code>:</dt><dd><p>a numeric vector specifying the latitudes where the legend circles are drawn.</p>
</dd>
<dt><code>xtext</code>:</dt><dd><p>a numeric vector specifying the longitudes where the values corresponding to the sizes of the legend circles are drawn.</p>
</dd>
<dt><code>ytext</code>:</dt><dd><p>a numeric vector specifying the latitudes where the values corresponding to the sizes of the legend circles are drawn.</p>
</dd>
<dt><code>digits</code>:</dt><dd><p>integer indicating the number of decimal places to be used.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="map.statistic_+3A_main">main</code></td>
<td>

<p>a character string providing an overall title for the plot.
</p>
</td></tr>
<tr><td><code id="map.statistic_+3A_add">add</code></td>
<td>

<p>a logical indicating whteher the plot must be added to a current plot (if <code>add = TRUE</code>) or not (if <code>add = FALSE</code>), default is FALSE.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot.
</p>


<h3>Author(s)</h3>

<p>Samuel Soubeyrand <a href="mailto:Samuel.Soubeyrand@avignon.inra.fr">Samuel.Soubeyrand@avignon.inra.fr</a>, Cindy E. Morris, E. Keith Bigg.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>See Also</h3>

<p>map.statistic
<a href="#topic+rain.feedback.stats">rain.feedback.stats</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites and corresponding feedback index 
#### computed from the whole data series
coord=rain.feedback.stats[,3:4]
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### map of feedback index 
map.statistic(coord,stat1,cex.circles=c(3,0.2),
   region=list(border="Australia",xlim=c(110,155)),
   legend=list(x=c(rep(114,3),rep(123,2)),y=-c(37,39.5,42,37,39.5),
      xtext=c(rep(114,3),rep(123,2))+1,ytext=-c(37,39.5,42,37,39.5),digits=2),
   main="Feedback")
</code></pre>

<hr>
<h2 id='rain.feedback.stats'>
Statistics of rain feedback in Australia
</h2><span id='topic+rain.feedback.stats'></span>

<h3>Description</h3>

<p>Feedback and change-in-feedback statistics based on 88 rainfall data series colllected in 88 sites across Australia. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rain.feedback.stats)</code></pre>


<h3>Format</h3>

<p>A data frame with 88 observations on the following 8 variables.
</p>

<dl>
<dt><code>Station.number</code>:</dt><dd><p>a numeric vector providing the identifiers of the meteorological stations.</p>
</dd>
<dt><code>Keyday.threshold</code>:</dt><dd><p>a numeric vector providing for each meteorological station the threshold value above which a day is considered as a key day.</p>
</dd>
<dt><code>Longitude</code>:</dt><dd><p>a numeric vector with longitudes of the meteorological stations.</p>
</dd>
<dt><code>Latitude</code>:</dt><dd><p>a numeric vector with latitudes of the meteorological stations.</p>
</dd>
<dt><code>Feedback.whole.period</code>:</dt><dd><p>a numeric vector providing for each meteorological station the temporal average of after-before differences around key days calculated from the whole time series.</p>
</dd>
<dt><code>Feedback.before.1960</code>:</dt><dd><p>a numeric vector providing for each meteorological station the temporal average of after-before differences around key days calculated from the time series right-truncated in 1960 (data from year 1960 were excluded).</p>
</dd>
<dt><code>Feedback.after.or.in.1960</code>:</dt><dd><p>a numeric vector providing for each meteorological station the temporal average of after-before differences around key days calculated from the time series left-truncated in 1960 (data from year 1960 were kept).</p>
</dd>
<dt><code>Change.in.feedback</code>:</dt><dd><p>a numeric vector providing the difference between <code>Feedback.after.or.in.1960</code> and <code>Feedback.before.1960</code>.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The statistics in this data set were computed using the <a href="#topic+feedback.stats">feedback.stats</a> function.
</p>


<h3>Source</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data of feedback and change-in-feedback indices in 88 sites across Australia
data(rain.feedback.stats)

#### spatial coordinates of the 88 sites and corresponding feedback index 
#### computed from the whole data series
coord=rain.feedback.stats[,3:4]
stat1=rain.feedback.stats[["Feedback.whole.period"]]

#### map of feedback index 
map.statistic(coord,stat1,cex.circles=c(3,0.2),
   region=list(border="Australia",xlim=c(110,155)),
   legend=list(x=c(rep(114,3),rep(123,2)),y=-c(37,39.5,42,37,39.5),
      xtext=c(rep(114,3),rep(123,2))+1,ytext=-c(37,39.5,42,37,39.5),digits=2),
   main="Feedback")
</code></pre>

<hr>
<h2 id='rain.site.6008'>
Rainfall data at Callagiddy station
</h2><span id='topic+rain.site.6008'></span>

<h3>Description</h3>

<p>Rainfall data at Callagiddy station in Western Australia
(meteorological station with identifier 6008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rain.site.6008)</code></pre>


<h3>Format</h3>

<p>A data frame with 36615 observations on the following 5 variables.
</p>

<dl>
<dt><code>Station.Number</code></dt><dd><p>a numeric vector providing the identifier of the meteorological station.</p>
</dd>
<dt><code>Year</code></dt><dd><p>a numeric vector specifying the year of each observation.</p>
</dd>
<dt><code>Month</code></dt><dd><p>a numeric vector specifying the month in the year of each observation.</p>
</dd>
<dt><code>Day</code></dt><dd><p>a numeric vector specifying the day in the month of each observation.</p>
</dd>
<dt><code>Precipitation.in.the.24.hours.before.9am..local.time..in.mm</code></dt><dd><p>a numeric vector providing the precipitation level in the 24 hours before 9am, local time, in mm.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>References</h3>

<p>Soubeyrand, S., Morris, C. E. and Bigg, E. K. (2014). Analysis of fragmented time directionality in time series to elucidate feedbacks in climate data. Environmental Modelling and Software 61: 78-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#### load data for site 6008 (Callagiddy station)
data(rain.site.6008)

#### build KDD object from raw data (site 6008: Callagiddy station)
## using a threshold value equal to 0 to keep all days
KDDno=kdd.from.raw.data(raw.data=rain.site.6008,keyday.threshold=0,nb.days=20,
   col.series=5,col.date=c(2,3,4),na.rm=TRUE,filter=NULL)

#### compute after-before differences and plot the whole data series
plot(KDDno["day"],KDDno["before.after"][21,],type="l",xlab="Day",ylab="Daily rainfall")
   axis(3,at=c(1,365*30,365*60,365*90),labels=KDDno["year"][1]+c(0,30,60,90))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
