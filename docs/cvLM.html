<!DOCTYPE html><html lang="en"><head><title>Help for package cvLM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cvLM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cvLM-package'><p>Cross-validation for linear and ridge regression models</p></a></li>
<li><a href='#grid.search'><p>Grid Search for Optimal Lambda in Ridge Regression</p></a></li>
<li><a href='#reg.table'><p>Create Regression Tables in LaTeX or HTML</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cross-Validation for Linear &amp; Ridge Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-07-30</td>
</tr>
<tr>
<td>Description:</td>
<td>Efficient implementations of cross-validation techniques for linear and ridge regression models, leveraging 'C++' code with 'Rcpp', 'RcppParallel', and 'Eigen' libraries. It supports leave-one-out, generalized, and K-fold cross-validation methods, utilizing 'Eigen' matrices for high performance. Methodology references: Hastie, Tibshirani, and Friedman (2009) &lt;<a href="https://doi.org/10.1007%2F978-0-387-84858-7">doi:10.1007/978-0-387-84858-7</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, Rcpp (&ge; 1.0.13), RcppParallel (&ge; 5.1.8)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppParallel, RcppEigen</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-30 19:04:21 UTC; philip</td>
</tr>
<tr>
<td>Author:</td>
<td>Philip Nye [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philip Nye &lt;phipnye@proton.me&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-01 09:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='cvLM-package'>Cross-validation for linear and ridge regression models</h2><span id='topic+cvLM-package'></span><span id='topic+cvLM'></span><span id='topic+cvLM.formula'></span><span id='topic+cvLM.lm'></span><span id='topic+cvLM.glm'></span>

<h3>Description</h3>

<p>This package provides efficient implementations of cross-validation techniques for linear and ridge regression models, leveraging C++ code with <code>Rcpp</code>, <code>RcppParallel</code>, and <code>Eigen</code> libraries. It supports leave-one-out, generalized, and <code>K</code>-fold cross-validation methods, utilizing Eigen matrices for high performance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvLM(object, ...)
## S3 method for class 'formula'
cvLM(object, data, subset, na.action, K.vals = 10L, lambda = 0,
     generalized = FALSE, seed = 1L, n.threads = 1L, ...)
## S3 method for class 'lm'
cvLM(object, data, K.vals = 10L, lambda = 0,
     generalized = FALSE, seed = 1L, n.threads = 1L, ...)
## S3 method for class 'glm'
cvLM(object, data, K.vals = 10L, lambda = 0,
     generalized = FALSE, seed = 1L, n.threads = 1L, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cvLM-package_+3A_object">object</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code>, a linear model (<code><a href="stats.html#topic+lm">lm</a></code>), or a generalized linear model (<code><a href="stats.html#topic+glm">glm</a></code>) object.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_data">data</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables in the model.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process. See <code><a href="stats.html#topic+model.frame">model.frame</a></code> for more details.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates how to handle <code>NA</code> values in the data. See <code><a href="stats.html#topic+model.frame">model.frame</a></code> for more details.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_k.vals">K.vals</code></td>
<td>
<p>an integer vector specifying the number of folds for cross-validation.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_lambda">lambda</code></td>
<td>
<p>a non-negative numeric scalar specifying the regularization parameter for ridge regression.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_generalized">generalized</code></td>
<td>
<p>a logical value indicating whether to compute generalized or ordinary cross-validation. Defaults to <code>FALSE</code> for ordinary cross-validation.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_seed">seed</code></td>
<td>
<p>a single integer value specifying the seed for random number generation.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_n.threads">n.threads</code></td>
<td>
<p>a single positive integer value specifying the number of threads for parallel computation.</p>
</td></tr>
<tr><td><code id="cvLM-package_+3A_...">...</code></td>
<td>
<p>additional arguments. Currently, these do not affect the function's behavior.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>cvLM</code> function is a generic function that dispatches to specific methods based on the class of the <code>object</code> argument.
</p>
<p>The <code>cvLM.formula</code> method performs cross-validation for linear and ridge regression models specified using a formula interface.
</p>
<p>The <code>cvLM.lm</code> method performs cross-validation for linear regression models.
</p>
<p>The <code>cvLM.glm</code> method performs cross-validation for generalized linear models. It currently supports only gaussian family with identity link function.
</p>
<p>The cross-validation process involves splitting the data into <code>K</code> folds, fitting the model on <code>K-1</code> folds, and evaluating its performance on the remaining fold. This process is repeated <code>K</code> times, each time with a different fold held out for testing.
</p>
<p>The <code>cvLM</code> functions use closed-form solutions for leave-one-out and generalized cross-validation and efficiently handle the K-fold cross-validation process, optionally using multithreading for faster computation when working with larger data.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> consisting of columns representing the number of folds, the cross-validation result, and the seed used for the computation.
</p>


<h3>Author(s)</h3>

<p>Philip Nye, <a href="mailto:phipnye@proton.me">phipnye@proton.me</a>
</p>


<h3>References</h3>

<p>Bates D, Eddelbuettel D (2013). &quot;Fast and Elegant Numerical Linear Algebra Using the RcppEigen Package.&quot; Journal of Statistical Software, 52(5), 1-24. <a href="https://doi.org/10.18637/jss.v052.i05">doi:10.18637/jss.v052.i05</a>.
</p>
<p>Aggarwal, C. C. (2020). Linear Algebra and Optimization for Machine Learning: A Textbook. Springer Cham. <a href="https://doi.org/10.1007/978-3-030-40344-7">doi:10.1007/978-3-030-40344-7</a>.
</p>
<p>Hastie, T., Tibshirani, R., &amp; Friedman, J. (2009). The Elements of Statistical Learning: Data Mining, Inference, and Prediction (2nd ed.). Springer New York, NY. <a href="https://doi.org/10.1007/978-0-387-84858-7">doi:10.1007/978-0-387-84858-7</a>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+formula">formula</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)
n &lt;- nrow(mtcars)

# Formula method
cvLM(
  mpg ~ .,
  data = mtcars,
  K.vals = n,    # Leave-one-out CV
  lambda = 10    # Shrinkage parameter of 10
)

# lm method
my.lm &lt;- lm(mpg ~ ., data = mtcars)
cvLM(
  my.lm,
  data = mtcars,
  K.vals = c(5L, 8L), # Perform both 5- and 8-fold CV
  n.threads = 8L,     # Allow up to 8 threads for computation
  seed = 1234L
)

# glm method
my.glm &lt;- glm(mpg ~ ., data = mtcars)
cvLM(
  my.glm,
  data = mtcars,
  K.vals = n, generalized = TRUE # Use generalized CV
)
</code></pre>

<hr>
<h2 id='grid.search'>Grid Search for Optimal Lambda in Ridge Regression</h2><span id='topic+grid.search'></span>

<h3>Description</h3>

<p>Performs a grid search to find the optimal lambda value for ridge regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grid.search(formula, data, subset, na.action, K = 10L, 
            generalized = FALSE, seed = 1L, n.threads = 1L,
            max.lambda = 10000, precision = 0.1, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grid.search_+3A_formula">formula</code></td>
<td>
<p>a <code><a href="stats.html#topic+formula">formula</a></code> specifying the model.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_data">data</code></td>
<td>
<p>a <code><a href="base.html#topic+data.frame">data.frame</a></code> containing the variables in the model.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_subset">subset</code></td>
<td>
<p>an optional vector specifying a subset of observations to be used in the fitting process. See <code><a href="stats.html#topic+model.frame">model.frame</a></code> for more details.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_na.action">na.action</code></td>
<td>
<p>a function that indicates what should happen when the data contain <code>NA</code>s. See <code><a href="stats.html#topic+model.frame">model.frame</a></code> for more details.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_k">K</code></td>
<td>
<p>an integer specifying the number of folds for cross-validation.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_generalized">generalized</code></td>
<td>
<p>a logical indicating whether to compute generalized or ordinary cross-validation.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_seed">seed</code></td>
<td>
<p>an integer specifying the seed for random number generation.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_n.threads">n.threads</code></td>
<td>
<p>an integer specifying the number of threads for parallel computation.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_max.lambda">max.lambda</code></td>
<td>
<p>a numeric specifying the maximum value of lambda to search.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_precision">precision</code></td>
<td>
<p>a numeric specifying the precision of the lambda search.</p>
</td></tr>
<tr><td><code id="grid.search_+3A_verbose">verbose</code></td>
<td>
<p>a logical indicating whether to display a progress bar during the computation process.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function performs a grid search to determine the optimal regularization parameter lambda for ridge regression. It evaluates lambda values starting from 0, incrementing by the specified precision up to the maximum lambda provided. The function utilizes cross-validation to assess the performance of each lambda value and selects the one that minimizes the cross-validation error.
</p>


<h3>Value</h3>

<p>A <code><a href="base.html#topic+list">list</a></code> with the following components:
</p>

<dl>
<dt>CV</dt><dd><p>the minimum cross-validation error.</p>
</dd>
<dt>lambda</dt><dd><p>the corresponding optimal lambda value.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)
grid.search(
  formula = mpg ~ ., 
  data = mtcars,
  K = 5L,           # Use 5-fold CV
  max.lambda = 100, # Search values between 0 and 100
  precision = 0.01, # Increment in steps of 0.01
  verbose = FALSE,  # Disable progress bar
)


set.seed(1L)
n &lt;- 50002L

DF &lt;- data.frame(
  x1 = rnorm(n),
  x2 = runif(n),
  x3 = rlogis(n),
  x4 = rnorm(n),
  x5 = rcauchy(n),
  x6 = rexp(n)
)

DF &lt;- transform(
  DF,
  y = 3.1 * x1 + 1.8 * x2 + 0.9 * x3 + 1.2 * x4 + x5 + 0.6 * x6 + rnorm(n, sd = 10)
)

grid.search(
  formula = y ~ ., 
  data = DF, 
  K = 10L,          # Use 10-fold CV
  max.lambda = 100, # Search values between 0 and 100
  precision = 1,    # Increment in steps of 1
  n.threads = 10L   # Use 10 threads
)

grid.search(
  formula = y ~ ., 
  data = DF, 
  K = n, generalized = TRUE, # Use generalized CV
  max.lambda = 10000,        # Search values between 0 and 10000
  precision = 10,            # Increment in steps of 10
)

</code></pre>

<hr>
<h2 id='reg.table'>Create Regression Tables in LaTeX or HTML</h2><span id='topic+reg.table'></span>

<h3>Description</h3>

<p><code>reg.table</code> generates formatted regression tables in either LaTeX or HTML format for one or more linear regression models. 
The tables include coefficient estimates, standard errors, and various model statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reg.table(models, type = c("latex", "html"), split.size = 4L, n.digits = 3L,
          big.mark = "", caption = "Regression Results", spacing = 5L,
          stats = c("AIC", "BIC", "CV", "r.squared", "adj.r.squared",
                    "fstatistic", "nobs"),
          ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reg.table_+3A_models">models</code></td>
<td>
<p>A list of linear regression models (objects of class <code>lm</code> or <code>glm</code> with gaussian family and identity link function).</p>
</td></tr>
<tr><td><code id="reg.table_+3A_type">type</code></td>
<td>
<p>A string specifying the output format. Must be one of <code>"latex"</code> or <code>"html"</code>.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_split.size">split.size</code></td>
<td>
<p>An integer specifying the number of models per table. Tables with more models than this number will be split.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_n.digits">n.digits</code></td>
<td>
<p>An integer specifying the number of decimal places for numerical values.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_big.mark">big.mark</code></td>
<td>
<p>A string to use for thousands separators in numeric formatting.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_caption">caption</code></td>
<td>
<p>A string for the table caption.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_spacing">spacing</code></td>
<td>
<p>A numeric specifying the spacing between columns in the output table.</p>
</td></tr>
<tr><td><code id="reg.table_+3A_stats">stats</code></td>
<td>
<p>A character vector specifying which model statistics to include in the table. Options include:
</p>

<dl>
<dt><code>AIC</code></dt><dd><p>Akaike Information Criterion</p>
</dd>
<dt><code>BIC</code></dt><dd><p>Bayesian Information Criterion</p>
</dd>
<dt><code>CV</code></dt><dd><p>Cross-validation score</p>
</dd>
<dt><code>r.squared</code></dt><dd><p>R-squared</p>
</dd>
<dt><code>adj.r.squared</code></dt><dd><p>Adjusted R-squared</p>
</dd>
<dt><code>fstatistic</code></dt><dd><p>F-statistic</p>
</dd>
<dt><code>nobs</code></dt><dd><p>Number of observations</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="reg.table_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+cvLM">cvLM</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function generates tables summarizing linear regression models, either in LaTeX or HTML format. The tables include coefficients, standard errors, and optional statistics such as AIC, BIC, cross-validation scores, and more. The output is formatted based on the specified type and options. The names of the models list will be used as column headers if provided.
</p>


<h3>Value</h3>

<p>A character vector of length equal to the number of tables with each element containing the LaTeX or HTML code for a regression table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(mtcars)

# Create a list of 6 different linear regression models with names
# Names get used for column names of the table
models &lt;- list(
  `Model 1` = lm(mpg ~ wt + hp, data = mtcars),
  `Model 2` = lm(mpg ~ wt + qsec, data = mtcars),
  `Model 3` = lm(mpg ~ wt + hp + qsec, data = mtcars),
  `Model 4` = lm(mpg ~ wt + cyl, data = mtcars),
  `Model 5` = lm(mpg ~ wt + hp + cyl, data = mtcars),
  `Model 6` = lm(mpg ~ hp + qsec + drat, data = mtcars)
)

# Example usage for LaTeX
reg.table(
  models,
  "latex",
  split.size = 3L,
  n.digits = 3L,
  big.mark = ",",
  caption = "My regression results",
  spacing = 7.5,
  stats = c("AIC", "BIC", "CV"),
  data = mtcars,
  K.vals = 5L,
  seed = 123L
)

# Example usage for HTML
reg.table(
  models,
  "html",
  split.size = 3L,
  n.digits = 3L,
  big.mark = ",",
  caption = "My regression results",
  spacing = 7.5,
  stats = c("AIC", "BIC", "CV"),
  data = mtcars,
  K.vals = 5L,
  seed = 123L
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
