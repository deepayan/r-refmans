<!DOCTYPE html><html><head><title>Help for package RGENERATEPREC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RGENERATEPREC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CCGamma'><p>This function extends <code>continuity_ratio</code> and adds the corresponding gaussian correlation matrix for no-precipitation occurrence.</p></a></li>
<li><a href='#CCGammaToBlockmatrix'><p>This function returns a <code>blockmatrix</code> object containing the gaussian cross-correlation matrices.</p></a></li>
<li><a href='#dw.spell'><p>It calculates dry/wet spell duration.</p></a></li>
<li><a href='#generate.PrecipitationOccurrenceModel'><p>Stochastic Generation of a  <code>PrecipitationOccurrenceModel</code> or <code>PrecipitationOccurrenceMultiSiteModel</code> model object</p></a></li>
<li><a href='#nwetdays'><p>It calculates the number of wet days for each month and each year</p></a></li>
<li><a href='#omega'><p>This function finds the bivariate joint probability or the binary correlation from the corresponding Gaussian correlation <code>x</code></p></a></li>
<li><a href='#omega_inv'><p>This function is the inverse of <code>omega</code> function</p></a></li>
<li><a href='#omega_root'><p>This is the target function whose zero is searched to crete the inverse function of  <code>omega</code>.</p></a></li>
<li><a href='#PrecipitationAmountModel'><p>Creates a Precipitation Amount Model</p></a></li>
<li><a href='#PrecipitationOccurrenceModel'><p>Precipitation Occurrence Model</p></a></li>
<li><a href='#PrecipitationOccurrenceMultiSiteModel'><p>Precipitation Occurrence Multi-Site Model</p></a></li>
<li><a href='#predict.PrecipitationOccurrenceModel'><p>Prediction of a  <code>PrecipitationOccurrenceModel</code> model object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Maintainer:</td>
<td>Emanuele Cordano &lt;emanuele.cordano@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Generate Daily-Precipitation Time Series</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuele Cordano</td>
</tr>
<tr>
<td>Description:</td>
<td>The method 'generate()' is extended for spatial multi-site
    stochastic generation of daily precipitation. It generates precipitation
    occurrence in several sites using logit regression (Generalized Linear
    Models) and the approach by D.S. Wilks (1998) &lt;<a href="https://doi.org/10.1016%2FS0022-1694%2898%2900186-3">doi:10.1016/S0022-1694(98)00186-3</a>&gt; . </td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.9</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-01-11</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), copula, RGENERATE, blockmatrix, Matrix, stringr</td>
</tr>
<tr>
<td>Imports:</td>
<td>RMAWGEN</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr,rmarkdown,lubridate,mapview,sf,lmom,ggplot2,reshape2,RefManageR</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ecor/RGENERATEPREC">https://github.com/ecor/RGENERATEPREC</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-01-18 09:45:10 UTC; ecor</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-01-20 16:12:49 UTC</td>
</tr>
</table>
<hr>
<h2 id='CCGamma'>This function extends <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code> and adds the corresponding gaussian correlation matrix for no-precipitation occurrence.</h2><span id='topic+CCGamma'></span>

<h3>Description</h3>

<p>This function extends <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code> and adds the corresponding gaussian correlation matrix for no-precipitation occurrence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCGamma(
  data,
  lag = 0,
  p0_v1 = NULL,
  p = NA,
  valmin = 0.5,
  nearPD = (lag &gt;= 0),
  interval = c(-1, 1),
  tolerance = .Machine$double.eps,
  only.matrix = FALSE,
  return.value = NULL,
  null.gcorrelation = 1e-05,
  sample = NULL,
  origin = "1961-1-1",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CCGamma_+3A_data">data</code></td>
<td>
<p>data frame or 'zoo'  R object containing daily precipitation time series for several gauges (one gauge time series per column). See <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_lag">lag</code></td>
<td>
<p>numeric lag (expressed as number of days) used for computation for &quot;cross&quot; continuity ratio and joint probability of prercipitation (no)occurrence. See <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_p0_v1">p0_v1</code></td>
<td>
<p>vector for marginal probablities, see <code><a href="#topic+omega">omega</a></code> and <code><a href="#topic+omega_inv">omega_inv</a></code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_p">p</code></td>
<td>
<p>positive integer parameter. Default is <code>NA</code>, otherwise, <code>lag</code> is calculated as the vector <code>0:p</code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_valmin">valmin</code></td>
<td>
<p>threshold precipitation value [mm] for wet/dry day indicator. 
If precipitation is lower than <code>valmin</code>, day is considered dry. Default is 0.5 mm. See <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_nearpd">nearPD</code></td>
<td>
<p>see <code><a href="#topic+omega_inv">omega_inv</a></code>. Default is <code>(lag==0)</code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_interval">interval</code>, <code id="CCGamma_+3A_tolerance">tolerance</code></td>
<td>
<p>see <code><a href="#topic+omega_inv">omega_inv</a></code></p>
</td></tr>
<tr><td><code id="CCGamma_+3A_only.matrix">only.matrix</code></td>
<td>
<p>logical value. If <code>TRUE</code> the function returns only the gaussian correlaton matrix. Deafaul is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_return.value">return.value</code></td>
<td>
<p>string. If it is not either <code>NULL</code> (Default) and <code>NA</code>, function returns only the argument indicated by this argument.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_null.gcorrelation">null.gcorrelation</code></td>
<td>
<p>numerical value <code>nooccurrence_gcorrelation</code>  under which is considered to be 0.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_sample">sample</code></td>
<td>
<p>character string indicated if function must be calculated differently for subset of the year, e.g. monthly. Admitted values are <code>NULL</code> (Default), <code>"all"</code> or <code>"monthly"</code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_origin">origin</code></td>
<td>
<p>character string (yyyy-dd-mm) indicated the date of the first row of <code>"data"</code>. It is used if <code>data</code> and <code>sample</code> are not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="CCGamma_+3A_...">...</code></td>
<td>
<p>additional agruments of <code><a href="#topic+omega_inv">omega_inv</a></code> or <code><a href="#topic+CCGamma">CCGamma</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object which is a list containing the following fields: 
</p>
<p><code>continuity_ratio</code> : <code>lag</code>-day lagged  continuity ratio, as returned by <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>; 
</p>
<p><code>occurrence</code>  : joint probability of <code>lag</code>-day lagged precipitation occurrence, as returned by <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>; 
</p>
<p><code>nooccurrence</code> : joint probability of <code>lag</code>-day lagged no precipitation occurrence, as returned by <code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>;
</p>
<p><code>lag</code> : number of days lagged between the two compared events (see argument <code>lag</code>);
</p>
<p><code>p0_v1</code> : vector of marginal probability of no precipitation occurrence. If <code>lag</code>
is 0, it corresponds to the diagonal of  <code>nooccurrence</code> matrix (see argument <code>p0_v1</code>);
</p>
<p><code>nooccurrence_gcorrelation</code> corresponding gaussian correlation for no precipitation occurrence obtained by applying <code><a href="#topic+omega_inv">omega_inv</a></code> to <code>nooccurrence</code>,
</p>
<p>If the argument <code>only.matrix</code> is <code>TRUE</code>, only <code>nooccurrence_gcorrelation</code> is returned as a matrix. 
In case the argument <code>lag</code> is a vector wirh length more than one, the function returns a list of the above-cited return object for each value of the vector <code>lag</code>.
</p>


<h3>Note</h3>

<p>This functon is useful to generate the serial cross-correlation matrices for no precipitation occurrence for Yule-Walker Equations. In case <code>lag</code> is a vactor, <code>nearPD</code> must be a vector of the same size, 
default is <code>(lag==0)</code>.
</p>
<p>See the R code for major details
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>References</h3>

<p>D.S. Wilks (1998), Multisite Generalization of a Daily Stochastic Precipitation Generation Model, Journal of Hydrology, Volume 210, Issues 1-4, September 1998, Pages 178-191,
<a href="https://www.sciencedirect.com/science/article/pii/S0022169498001863">https://www.sciencedirect.com/science/article/pii/S0022169498001863</a>
</p>
<p>Muamaraldin Mhanna and Willy Bauwens (2011) A Stochastic Space-Time Model for the Generation of Daily Rainfall in the Gaza Strip, International Journal of Climatology, Volume 32, Issue 7, pages 1098-1112,
doi: <a href="https://doi.org/10.1002/joc.2305">10.1002/joc.2305</a>, <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305</a>
</p>


<h3>See Also</h3>

<p><code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>,<code><a href="#topic+omega_inv">omega_inv</a></code>,<code><a href="#topic+omega">omega</a></code>,<code><a href="#topic+CCGammaToBlockmatrix">CCGammaToBlockmatrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990
origin &lt;- paste(year_min,1,1,sep="-")

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:2]

CCGamma &lt;- CCGamma(data=prec_mes,lag=0,tolerance=0.001,only.matrix=FALSE)

## Not Run in the examples, uncomment to run the following line
 CCGamma &lt;- CCGamma(data=prec_mes,lag=0:2,tolerance=0.001,only.matrix=FALSE)

## Not Run in the examples, uncomment to run the following line
 CCGamma_monthly &lt;- CCGamma(data=prec_mes,lag=0,tolerance=0.001,only.matrix=FALSE,
                     sample="monthly",origin=origin)


</code></pre>

<hr>
<h2 id='CCGammaToBlockmatrix'>This function returns a <code><a href="blockmatrix.html#topic+blockmatrix">blockmatrix</a></code> object containing the gaussian cross-correlation matrices.</h2><span id='topic+CCGammaToBlockmatrix'></span>

<h3>Description</h3>

<p>This function returns a <code><a href="blockmatrix.html#topic+blockmatrix">blockmatrix</a></code> object containing the gaussian cross-correlation matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCGammaToBlockmatrix(data, lag = 0, p = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CCGammaToBlockmatrix_+3A_data">data</code></td>
<td>
<p>data frame or 'zoo' R object containing daily precipitation time series for several gauges (one gauge time series per column). See <code><a href="#topic+CCGamma">CCGamma</a></code>.</p>
</td></tr>
<tr><td><code id="CCGammaToBlockmatrix_+3A_lag">lag</code></td>
<td>
<p>numeric (expressed as number of days) used for the element [1,1] of the returned blockmatrix.</p>
</td></tr>
<tr><td><code id="CCGammaToBlockmatrix_+3A_p">p</code></td>
<td>
<p>numeric order $p$ of the auto-regeression</p>
</td></tr>
<tr><td><code id="CCGammaToBlockmatrix_+3A_...">...</code></td>
<td>
<p>further argments of <code><a href="#topic+CCGamma">CCGamma</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This a wrapper for <code><a href="#topic+CCGamma">CCGamma</a></code> with the option <code>only.matrix=TRUE</code> and the function value is transformed into a <code><a href="blockmatrix.html#topic+blockmatrix">blockmatrix</a></code> object.
</p>


<h3>Value</h3>

<p>A <code><a href="blockmatrix.html#topic+blockmatrix">blockmatrix</a></code> object containing the gaussian cross-correlation matrices.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CCGamma">CCGamma</a></code>,<code><a href="RMAWGEN.html#topic+continuity_ratio">continuity_ratio</a></code>,<code><a href="#topic+omega_inv">omega_inv</a></code>,<code><a href="#topic+omega">omega</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:2]

p &lt;- 1 ## try p &lt;- 2 !!!  
CCGamma &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=0,p=p,tolerance=0.001)

## Not Run in the examples, uncomment to run the following line
 CCGamma_1 &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=1,p=p,tolerance=0.001)


### Alternatively, recommended ..... 
## Not Run in the examples, uncomment to run the following line
 CCGamma &lt;- CCGammaToBlockmatrix(data=prec_mes,lag=0,p=p+1,tolerance=0.001)

 CCGamma0 &lt;- CCGamma[1:p,1:p]
 CCGamma1 &lt;- CCGamma[(1:p),(1:p)+1]

 CCGamma0_inv &lt;- solve(CCGamma0)


## Not Run in the examples, uncomment to run the following line
a1 &lt;- blockmatmult(CCGamma0,CCGamma0_inv)
a2 &lt;- blockmatmult(CCGamma1,CCGamma0_inv)



CCGamma_1t &lt;- t(CCGamma1)
CCGamma_0t &lt;- t(CCGamma0)

 A &lt;- t(solve(CCGamma_0t,CCGamma_1t))



</code></pre>

<hr>
<h2 id='dw.spell'>It calculates dry/wet spell duration.</h2><span id='topic+dw.spell'></span>

<h3>Description</h3>

<p>It calculates dry/wet spell duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dw.spell(
  data,
  valmin = 0.5,
  origin = "1961-1-1",
  extract = NULL,
  month = 1:12,
  melting.df = FALSE,
  from.start = FALSE,
  only.inner = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dw.spell_+3A_data">data</code></td>
<td>
<p>data frame R object containing daily precipitation time series for several gauges (one gauge time series per column).</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_valmin">valmin</code></td>
<td>
<p>threshold precipitation value [mm] for wet/dry day indicator.</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_origin">origin</code></td>
<td>
<p>character string <code>"yyyy-mm-dd"</code> indicated the date of the first row of <code>"data"</code>.</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_extract">extract</code></td>
<td>
<p>string character referred to the state to be extracted, eg. <code>"dry"</code> or <code>"wet"</code></p>
</td></tr>
<tr><td><code id="dw.spell_+3A_month">month</code></td>
<td>
<p>integer vectors containing the considered months. Default is <code>1:12</code> (all the year).</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_melting.df">melting.df</code></td>
<td>
<p>logical value. If it <code>TRUE</code> the output is melted into a data frame. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_from.start">from.start</code></td>
<td>
<p>logical value. If is <code>TRUE</code> the spell is referenced to its first day, if it is <code>FALSE</code> (default) the spell is referenced to its last date.</p>
</td></tr>
<tr><td><code id="dw.spell_+3A_only.inner">only.inner</code></td>
<td>
<p>logical value. It is used in case <code>extract</code> is not <code>NULL</code>, if the value is <code>TRUE</code>, it extracts dry/wet spells completely inside the selected <code>month</code> period. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a list of data frames containing the spell length expressed in days
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 


data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:3]

origin &lt;- paste(year_min,1,1,sep="-")
dw_spell &lt;- dw.spell(prec_mes,origin=origin)
dw_spell_dry &lt;- dw.spell(prec_mes,origin=origin,extract="dry")

hist(dw_spell_dry$T0001$spell_length)


## Single Gauging Station

prec_mes &lt;- prec_mes[,1]

origin &lt;- paste(year_min,1,1,sep="-")
dw_spell &lt;- dw.spell(prec_mes,origin=origin)
dw_spell_dry &lt;- dw.spell(prec_mes,origin=origin,extract="dry")
dw_spell_dry_start &lt;- dw.spell(prec_mes,origin=origin,extract="dry",
	month=5:8,from.start=TRUE) ## dry spell 
	dw_spell_dry_start_2 &lt;- dw.spell(prec_mes,origin=origin,extract="dry",
month=5:8,from.start=TRUE,only.inner=TRUE) ## dry spell 
## is referenced to the first day instead of the latest one as default. 

hist(dw_spell_dry[[1]]$spell_length)


</code></pre>

<hr>
<h2 id='generate.PrecipitationOccurrenceModel'>Stochastic Generation of a  <code>PrecipitationOccurrenceModel</code> or <code>PrecipitationOccurrenceMultiSiteModel</code> model object</h2><span id='topic+generate.PrecipitationOccurrenceModel'></span><span id='topic+generate'></span><span id='topic+generate.CCGammaObjectListPerEachMonth'></span><span id='topic+generate.PrecipitationOccurrenceMultiSiteModel'></span><span id='topic+generate.PrecipitationAmountModel'></span>

<h3>Description</h3>

<p>It is an implentation of <code><a href="#topic+generate">generate</a></code> method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PrecipitationOccurrenceModel'
generate(
  x,
  newdata = NULL,
  previous = NULL,
  n = 30,
  random = runif(n, min = 0, max = 1),
  exogen = NULL,
  monthly.factor = NULL,
  ...
)

## S3 method for class 'CCGammaObjectListPerEachMonth'
generate(x, ...)

## S3 method for class 'PrecipitationOccurrenceMultiSiteModel'
generate(
  x,
  exogen,
  n = 10,
  origin = "1961-1-1",
  end = "1990-1-1",
  previous = NULL,
  monthly.factor = NULL,
  ...
)

## S3 method for class 'PrecipitationAmountModel'
generate(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_x">x</code></td>
<td>
<p>model returned by <code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code> or <code><a href="#topic+PrecipitationOccurrenceMultiSiteModel">PrecipitationOccurrenceMultiSiteModel</a></code></p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_newdata">newdata</code></td>
<td>
<p>predictor or exogenous variables. See <code><a href="#topic+predict.PrecipitationOccurrenceModel">predict.PrecipitationOccurrenceModel</a></code></p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_previous">previous</code></td>
<td>
<p>logical vector containing previously occurred states</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_n">n</code></td>
<td>
<p>number of generations. See <code><a href="#topic+generate">generate</a></code>. Here it is ignored and the number of generations is given by <code>origin</code>,<code>end</code> or <code>monthly.factor</code>.</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_random">random</code></td>
<td>
<p>vector of random or calculated numbers ranging between 0 and 1</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_exogen">exogen</code></td>
<td>
<p>predictor or exogenous variables</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_monthly.factor">monthly.factor</code></td>
<td>
<p>vector of factors indicating the month of the days</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
<tr><td><code id="generate.PrecipitationOccurrenceModel_+3A_origin">origin</code>, <code id="generate.PrecipitationOccurrenceModel_+3A_end">end</code></td>
<td>
<p>character strings (yyyy-dd-mm) indicating the start and/or end date of the daily weather generation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or a data frame reporting generated time series for each station.
</p>


<h3>References</h3>

<p>D.S. Wilks (1998), Multisite Generalization of a Daily Stochastic Precipitation Generation Model, Journal of Hydrology, Volume 210, Issues 1-4, September 1998, Pages 178-191,
<a href="https://www.sciencedirect.com/science/article/pii/S0022169498001863">https://www.sciencedirect.com/science/article/pii/S0022169498001863</a>
</p>
<p>Muamaraldin Mhanna and Willy Bauwens (2011) A Stochastic Space-Time Model for the Generation of Daily Rainfall in the Gaza Strip, International Journal of Climatology, Volume 32, Issue 7, pages 1098-1112,
doi: <a href="https://doi.org/10.1002/joc.2305">10.1002/joc.2305</a>, <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generate">generate</a></code>,<code><a href="stats.html#topic+predict.glm">predict.glm</a></code>,<code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code>,<code><a href="#topic+PrecipitationOccurrenceMultiSiteModel">PrecipitationOccurrenceMultiSiteModel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(RGENERATEPREC)


## A function example can be found in the following script file: 
scriptfile &lt;- system.file("example.generate.R",package="RGENERATEPREC")
## The corrent file path is given by 'scriptfile' variable:
print(scriptfile)
## To run the example file, launch the file with 'source' command (uncomment the following line)
#source(scriptfile)

## ALTERNATIVELY you can run the following lines:



data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

origin &lt;- paste(year_min,1,1,sep="-")
end &lt;- paste(year_max,12,31,sep="-")

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
period_temp &lt;- TEMPERATURE_MAX$year&gt;=year_min &amp; TEMPERATURE_MAX$year&lt;=year_max

prec_mes &lt;- PRECIPITATION[period,]
Tx_mes &lt;- TEMPERATURE_MAX[period_temp,]
Tn_mes &lt;- TEMPERATURE_MIN[period_temp,]
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
	acc &lt;- TRUE
	acc &lt;- (length(which(!is.na(Tx_mes[,it])))==length(Tx_mes[,it]))
	acc &lt;- (length(which(!is.na(Tn_mes[,it])))==length(Tn_mes[,it])) &amp; acc
	accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it])) &amp; acc
	
}

valmin &lt;- 1.0
prec_mes &lt;- prec_mes[,accepted]



Tx_mes &lt;- Tx_mes[,accepted]
Tn_mes &lt;- Tn_mes[,accepted]
prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]
it &lt;- station[2]
vect &lt;- Tx_mes[,it]-Tn_mes[,it]
months &lt;- factor(prec_mes$month)

 

model &lt;- 
PrecipitationOccurrenceModel(x=prec_mes[,it],exogen=vect,
monthly.factor=months,valmin=valmin)

obs &lt;- prec_mes[,it]&gt;=valmin

gen &lt;- generate(model,exogen=vect,monthly.factor=months,n=length(months))


### MultiSite Generation 


station &lt;- station[1:2]
exogen &lt;- Tx_mes[,station]-Tn_mes[,station]

months &lt;- factor(prec_mes$month)



 
model_multisite &lt;- 
PrecipitationOccurrenceMultiSiteModel(x=prec_mes[,station],
exogen=exogen,origin=origin,multisite_type="wilks")


## LOGIT-type Model 
model_multisite_logit &lt;- 
PrecipitationOccurrenceMultiSiteModel(x=prec_mes,exogen=exogen,
origin=origin,multisite_type="logit",station=station)


obs_multisite &lt;- prec_mes[,station]&gt;=valmin

gen_multisite &lt;- generate(model_multisite,exogen=exogen,origin=origin,end=end)

gen_multisite_logit &lt;- generate(model_multisite_logit,exogen=exogen,origin=origin,end=end)

</code></pre>

<hr>
<h2 id='nwetdays'>It calculates the number of wet days for each month and each year</h2><span id='topic+nwetdays'></span>

<h3>Description</h3>

<p>It calculates the number of wet days for each month and each year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nwetdays(data, valmin = 0.5, origin = "1961-1-1", station = names(data))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nwetdays_+3A_data">data</code></td>
<td>
<p>data frame R object containing daily precipitation time series for several gauges (one gauge time series per column).</p>
</td></tr>
<tr><td><code id="nwetdays_+3A_valmin">valmin</code></td>
<td>
<p>threshold precipitation value [mm] for wet/dry day indicator.</p>
</td></tr>
<tr><td><code id="nwetdays_+3A_origin">origin</code></td>
<td>
<p>character string <code>"yyyy-mm-dd"</code> indicated the date of the first row of <code>"data"</code>.</p>
</td></tr>
<tr><td><code id="nwetdays_+3A_station">station</code></td>
<td>
<p>character string indicating the stations. Default is <code>names(data)</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function returns a list of data frames containing the spell length expressed in days
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 


data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
station &lt;- names(PRECIPITATION)[!(names(PRECIPITATION) %in% c("day","month","year"))]
prec_mes &lt;- PRECIPITATION[period,station]  

## removing nonworking stations (e.g. time series with NA)
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
		 accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it]))
}

prec_mes &lt;- prec_mes[,accepted]
## the dateset is reduced!!! 
prec_mes &lt;- prec_mes[,1:3]

origin &lt;- paste(year_min,1,1,sep="-")

nwetdays &lt;- nwetdays(prec_mes,origin)

</code></pre>

<hr>
<h2 id='omega'>This function finds the bivariate joint probability or the binary correlation from the corresponding Gaussian correlation <code>x</code></h2><span id='topic+omega'></span>

<h3>Description</h3>

<p>This function finds the bivariate joint probability or the binary correlation from the corresponding Gaussian correlation <code>x</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega(x = 0.5, p0_v1 = 0.5, p0_v2 = NA, correlation = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omega_+3A_x">x</code></td>
<td>
<p>value of expected correlation between the corresponding Gaussian-distributed variables</p>
</td></tr>
<tr><td><code id="omega_+3A_p0_v1">p0_v1</code>, <code id="omega_+3A_p0_v2">p0_v2</code></td>
<td>
<p>probability of no precipitation occurrences for the v1 and v2 time series respectively. See <code>Notes</code>.</p>
</td></tr>
<tr><td><code id="omega_+3A_correlation">correlation</code></td>
<td>
<p>logical numeric value. Default is <code>FALSE</code>. If <code>TRUE</code> the function returns the binary correlation like eq. 6 of Mhanna, et al.,2011.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>probability of no precipitation occurrence in both v1 and v2 simultaneously. It is a matrix if <code>x</code> is a matrix.
</p>


<h3>Note</h3>

<p>This function makes use of normal copula. A graphical introduction to this function (with its inverse) makes is present in the following URL references:  <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305</a> 
and <a href="https://www.sciencedirect.com/science/article/pii/S0022169498001863">https://www.sciencedirect.com/science/article/pii/S0022169498001863</a> (See fig. 1 and par. 3.2) 
If the argument <code>p0_v2</code>, the two marginal probabily values must be given as a vector through the  argument <code>p0_v1</code>: <code>p0_v1=c(p0_v1,p0_v2)</code> . 
In case <code>x</code> is a correlation/covariance matrix the marginal probabilities are given as a vector through the argument <code>p0_v1</code>.
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>References</h3>

<p>D.S. Wilks (1998), Multisite Generalization of a Daily Stochastic Precipitation Generation Model, Journal of Hydrology, Volume 210, Issues 1-4, September 1998, Pages 178-191,
<a href="https://www.sciencedirect.com/science/article/pii/S0022169498001863">https://www.sciencedirect.com/science/article/pii/S0022169498001863</a>
</p>
<p>Muamaraldin Mhanna and Willy Bauwens (2011) A Stochastic Space-Time Model for the Generation of Daily Rainfall in the Gaza Strip, International Journal of Climatology, Volume 32, Issue 7, pages 1098-1112,
doi: <a href="https://doi.org/10.1002/joc.2305">10.1002/joc.2305</a>, <a href="https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305">https://rmets.onlinelibrary.wiley.com/doi/abs/10.1002/joc.2305</a>
</p>


<h3>See Also</h3>

<p><code><a href="copula.html#topic+normalCopula">normalCopula</a></code>,<code><a href="copula.html#topic+pcopula">pcopula</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- 0.4
p00 &lt;- omega(x=rho,p0_v1=0.5,p0_v2=0.5)
cor00 &lt;- omega(x=rho,p0_v1=0.5,p0_v2=0.5,correlation=TRUE)
</code></pre>

<hr>
<h2 id='omega_inv'>This function is the inverse of <code><a href="#topic+omega">omega</a></code> function</h2><span id='topic+omega_inv'></span>

<h3>Description</h3>

<p>This function is the inverse of <code><a href="#topic+omega">omega</a></code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega_inv(
  p0 = NULL,
  p0_v1 = 0.5,
  p0_v2 = p0_v1,
  p00 = p0_v1 * p0_v2,
  correlation = NA,
  only.value = TRUE,
  interval = c(-1, 1),
  tolerance = 0.001,
  nearPD = TRUE,
  force.independence = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omega_inv_+3A_p0">p0</code></td>
<td>
<p>matrix of joint probabilities. Default is <code>NULL</code>, otherwise functions returns a matrix with values</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_p0_v1">p0_v1</code>, <code id="omega_inv_+3A_p0_v2">p0_v2</code></td>
<td>
<p>probablity of no precipitatin occurrences for the v1 and v2 time series respectively.</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_p00">p00</code></td>
<td>
<p>probability of no precipitation occurrence in both v1 and v2 simultanously returned by <code><a href="#topic+omega">omega</a></code></p>
</td></tr>
<tr><td><code id="omega_inv_+3A_correlation">correlation</code></td>
<td>
<p>numerical value. DEfault is <code>NA</code>.  Binary correlation retured by <code><a href="#topic+omega">omega</a></code>  when the argumet <code>correlation=TRUE</code> (see <code><a href="#topic+omega_root">omega_root</a></code>)</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_only.value">only.value</code></td>
<td>
<p>logical value. If <code>TRUE</code> (Default) the only Gaussian correletion (<code>x</code> input variable of <code><a href="#topic+omega">omega</a></code>) is returned, 
otherwise  the complete output of <code><a href="stats.html#topic+uniroot">uniroot</a></code> is returned.</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_interval">interval</code></td>
<td>
<p>see <code>interval</code> option of <code><a href="stats.html#topic+uniroot">uniroot</a></code>. Default is <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_tolerance">tolerance</code></td>
<td>
<p>tolerance (numeric) parameter used for comparisons with the extreme value of marginal probabilities. Default is 0.001.</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_nearpd">nearPD</code></td>
<td>
<p>logical. If <code>TRUE</code> (Default) a positive-definite correlation matrix is returned by applying <code><a href="Matrix.html#topic+nearPD">nearPD</a></code> in case <code>p0</code> is a matrix and not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_force.independence">force.independence</code></td>
<td>
<p>logical value. Default is <code>TRUE</code>. If it is <code>TRUE</code>, no negative corelation is considered and negative values of correletion are forced to be 0 (independence).</p>
</td></tr>
<tr><td><code id="omega_inv_+3A_...">...</code></td>
<td>
<p>further arguments for <code><a href="stats.html#topic+uniroot">uniroot</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>value of expected correlation between the corresponding Gaussian-distributed variables (see <code>x</code> input argument of <code><a href="#topic+omega">omega</a></code>.
</p>


<h3>Note</h3>

<p>This function finds the zero of the  <code><a href="#topic+omega_root">omega_root</a></code> function by calling <code><a href="stats.html#topic+uniroot">uniroot</a></code>. 
If the argument <code>p0</code> is not <code>NULL</code> and is a matrix of joint probabilities, the function returns a correlation matrix by using the elements of <code>p0</code> ass joint probabilities for each couple and <code>p0_v1</code> as a vector of marginal probability of each occurrence/no-occurrence
(In this case if the length of <code>p0_v1</code> does not correspond to the number of columns of <code>p0</code>, the marginal probabilities are taken from the diagonal of <code>p0</code>).
See the R code for major details.
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>See Also</h3>

<p><code><a href="copula.html#topic+normalCopula">normalCopula</a></code>,<code><a href="copula.html#topic+pcopula">pcopula</a></code>,<code><a href="#topic+omega">omega</a></code>(and reference URLs therein)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- omega_inv(p0_v1=0.5,p0_v2=0.5,p00=1.1*0.5*0.5)
omega(x,p0_v1=0.5,p0_v2=0.5)
</code></pre>

<hr>
<h2 id='omega_root'>This is the target function whose zero is searched to crete the inverse function of  <code><a href="#topic+omega">omega</a></code>.</h2><span id='topic+omega_root'></span>

<h3>Description</h3>

<p>This is the target function whose zero is searched to crete the inverse function of  <code><a href="#topic+omega">omega</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega_root(
  x = 0.5,
  p0_v1 = 0.5,
  p0_v2 = 0.5,
  p00 = p0_v1 * p0_v2,
  correlation = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="omega_root_+3A_x">x</code></td>
<td>
<p>value of expected correlation between the corresponding Gaussian-distributed variables</p>
</td></tr>
<tr><td><code id="omega_root_+3A_p0_v1">p0_v1</code>, <code id="omega_root_+3A_p0_v2">p0_v2</code></td>
<td>
<p>probablity of no precipitatin occurrences for the v1 and v2 time series respectively.</p>
</td></tr>
<tr><td><code id="omega_root_+3A_p00">p00</code></td>
<td>
<p>probability of no precipitation occurrence in both v1 and v2 simultanously returned by <code><a href="#topic+omega">omega</a></code></p>
</td></tr>
<tr><td><code id="omega_root_+3A_correlation">correlation</code></td>
<td>
<p>numerical value. DEfault is <code>NA</code>.  Binary correlation retured by <code><a href="#topic+omega">omega</a></code>  when the argumet <code>correlation=TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value <code>p00-omega(x=x,p0_v1=p0_v1,p0_v2=p0_v2)</code> or <code>correlation-omega(x=x,p0_v1=p0_v1,p0_v2=p0_v2)</code> (if <code>correlation</code> is not <code>NA</code>)
</p>


<h3>Note</h3>

<p>This function makes use of normal copula
</p>


<h3>Author(s)</h3>

<p>Emanuele Cordano
</p>


<h3>See Also</h3>

<p><code><a href="copula.html#topic+normalCopula">normalCopula</a></code>,<code><a href="copula.html#topic+pcopula">pcopula</a></code>,<code><a href="#topic+omega">omega</a></code>,<code><a href="#topic+omega_inv">omega_inv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- 0.4
p00 &lt;- omega(x=rho,p0_v1=0.5,p0_v2=0.5)
omega_root(x=rho,p0_v1=0.5,p0_v2=0.5,p00=p00)
</code></pre>

<hr>
<h2 id='PrecipitationAmountModel'>Creates a Precipitation Amount Model</h2><span id='topic+PrecipitationAmountModel'></span>

<h3>Description</h3>

<p>Creates a Precipitation Amount Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrecipitationAmountModel(
  x,
  valmin = 1,
  station = names(x),
  sample = "monthly",
  origin = "1961-1-1",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrecipitationAmountModel_+3A_x">x</code></td>
<td>
<p>observed precipitation amount time series (data frame)</p>
</td></tr>
<tr><td><code id="PrecipitationAmountModel_+3A_valmin">valmin</code></td>
<td>
<p>maximum admitted value of precipitation depth</p>
</td></tr>
<tr><td><code id="PrecipitationAmountModel_+3A_station">station</code></td>
<td>
<p>string vector containing station identification codes</p>
</td></tr>
<tr><td><code id="PrecipitationAmountModel_+3A_sample">sample</code></td>
<td>
<p>character string. If it is <code>"monthly"</code> (Default), the corralaton matrix is calculeted per each month.</p>
</td></tr>
<tr><td><code id="PrecipitationAmountModel_+3A_origin">origin</code></td>
<td>
<p>date of the day referred by he first row of <code>x</code>.</p>
</td></tr>
<tr><td><code id="PrecipitationAmountModel_+3A_...">...</code></td>
<td>
<p>further agruments for <code><a href="RMAWGEN.html#topic+normalizeGaussian_severalstations">normalizeGaussian_severalstations</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns AN S3 OBJECT ...... the correlation matrix of precipitation amount values (excluding the zeros). 
In case <code>sample=="monthly"</code> the runction return a <code>MonlthyList</code> S3 object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.PrecipitationAmountModel">predict.PrecipitationAmountModel</a></code>,<code><a href="RMAWGEN.html#topic+normalizeGaussian_severalstations">normalizeGaussian_severalstations</a></code>,<code><a href="#topic+generate">generate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

set.seed(1245)

data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

origin &lt;- paste(year_min,1,1,sep="-")
end &lt;- paste(year_max,12,31,sep="-")

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
period_temp &lt;- TEMPERATURE_MAX$year&gt;=year_min &amp; TEMPERATURE_MAX$year&lt;=year_max

prec_mes &lt;- PRECIPITATION[period,]
Tx_mes &lt;- TEMPERATURE_MAX[period_temp,]
Tn_mes &lt;- TEMPERATURE_MIN[period_temp,]
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
	acc &lt;- TRUE
	acc &lt;- (length(which(!is.na(Tx_mes[,it])))==length(Tx_mes[,it]))
	acc &lt;- (length(which(!is.na(Tn_mes[,it])))==length(Tn_mes[,it])) &amp; acc
	accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it])) &amp; acc
	
}

valmin &lt;- 1.0
prec_mes &lt;- prec_mes[,accepted]



Tx_mes &lt;- Tx_mes[,accepted]
Tn_mes &lt;- Tn_mes[,accepted]
prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]

precamount &lt;- PrecipitationAmountModel(prec_mes,station=station,origin=origin)

val &lt;- predict(precamount)

prec_gen &lt;- generate(precamount)  




month &lt;- adddate(as.data.frame(residuals(precamount$T0090)),origin=origin)$month
#####plot(month,residuals(precamount$T0090))
plot(factor(month),residuals(precamount$T0090))

qqplot(prec_mes$T0083,prec_gen$T0083)
abline(0,1)


## SINGLE STATION

station &lt;- "T0083"

precamount_single &lt;- PrecipitationAmountModel(prec_mes,station=station,origin=origin)

val_single &lt;- predict(precamount_single)

prec_gen_single &lt;- generate(precamount_single)  



month &lt;- adddate(as.data.frame(residuals(precamount_single[[station[1]]])),origin=origin)$month
plot(factor(month),residuals(precamount_single[[station[1]]]))


### Comparison (Q-Q plot) between multi and single sites. 

qqplot(prec_mes$T0083,prec_gen$T0083,col=1)
abline(0,1)
points(sort(prec_mes$T0083),sort(prec_gen_single$T0083),pch=2,col=2)
legend("bottomright",pch=c(1,2),col=c(1,2),legend=c("Multi Sites","Single Site"))







abline(0,1)



</code></pre>

<hr>
<h2 id='PrecipitationOccurrenceModel'>Precipitation Occurrence Model</h2><span id='topic+PrecipitationOccurrenceModel'></span>

<h3>Description</h3>

<p>This functions creates a stochastic Occurrence Model for the variable  <code>x</code> (<code>PrecipitationOccurrenceModel</code> S3 object) through a calibration from observed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrecipitationOccurrenceModel(
  x,
  exogen = NULL,
  p = 1,
  monthly.factor = NULL,
  valmin = 0.5,
  id.name = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_x">x</code></td>
<td>
<p>variable utilized for the auto-regression of its occurrence, e.g. daily precipitaton</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_exogen">exogen</code></td>
<td>
<p>exogenous predictors</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_p">p</code></td>
<td>
<p>auto-regression order</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_monthly.factor">monthly.factor</code></td>
<td>
<p>vector of factors indicating the month of the days</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_valmin">valmin</code></td>
<td>
<p>minimum admitted value for daily precipitation amount</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_id.name">id.name</code></td>
<td>
<p>identification name of the station</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceModel_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a <code>PrecipitationOccurrenceModel-class</code> S3 object containing the following elements:
</p>
<p><code>predictor</code> data frame containg the endogenous and exogenous predictors of the logistic regression model;
</p>
<p><code>glm</code> the genaralized liner model using for the logistic regression;
</p>
<p><code>p</code> auto-regression order 
</p>
<p><code>valmin</code> minimum admitted value for daily precipitation amount
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(RGENERATEPREC)

data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
period_temp &lt;- TEMPERATURE_MAX$year&gt;=year_min &amp; TEMPERATURE_MAX$year&lt;=year_max

prec_mes &lt;- PRECIPITATION[period,]
Tx_mes &lt;- TEMPERATURE_MAX[period_temp,]
Tn_mes &lt;- TEMPERATURE_MIN[period_temp,]
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
	acc &lt;- TRUE
	acc &lt;- (length(which(!is.na(Tx_mes[,it])))==length(Tx_mes[,it]))
	acc &lt;- (length(which(!is.na(Tn_mes[,it])))==length(Tn_mes[,it])) &amp; acc
	accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it])) &amp; acc
	
}

valmin &lt;- 1.0
prec_mes &lt;- prec_mes[,accepted]



Tx_mes &lt;- Tx_mes[,accepted]
Tn_mes &lt;- Tn_mes[,accepted]
prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]
it &lt;- station[2]
vect &lt;- Tx_mes[,it]-Tn_mes[,it]
months &lt;- factor(prec_mes$month)
model &lt;- PrecipitationOccurrenceModel(x=prec_mes[,it],exogen=vect,monthly.factor=months)

probs &lt;- predict(model$glm,type="response")





plot(months[-1],probs)

newdata &lt;- model$predictor[2000:2007,]
probs0 &lt;- predict(model,newdata=newdata)



</code></pre>

<hr>
<h2 id='PrecipitationOccurrenceMultiSiteModel'>Precipitation Occurrence Multi-Site Model</h2><span id='topic+PrecipitationOccurrenceMultiSiteModel'></span>

<h3>Description</h3>

<p>This functions creates a stochastic Occurrence Multi-Site Model for the variable  <code>x</code> (<code>PrecipitationOccurrenceMultiSiteModel</code> S3 object) through a calibration from observed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrecipitationOccurrenceMultiSiteModel(
  x,
  exogen = NULL,
  station = names(x),
  origin = origin,
  valmin = 0.5,
  multisite_type = "wilks",
  tolerance_wilks = 0.001,
  p = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_x">x</code></td>
<td>
<p>data frame (each column is a site) of variable utilized for the auto-regression of its occurrence, e.g. daily precipitaton</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_exogen">exogen</code></td>
<td>
<p>exogenous predictors</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_station">station</code></td>
<td>
<p>character string vectors containing the codes of the station used for model calibration</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_origin">origin</code></td>
<td>
<p>character string (yyyy-dd-mm) indicating the date of the first row of <code>"x"</code>.</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_valmin">valmin</code></td>
<td>
<p>minimum admitted value for daily precipitation amount</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_multisite_type">multisite_type</code></td>
<td>
<p>string indicating the utilized approach for spatial multi-site dependence description. Default is <code>"wilks"</code>.</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_tolerance_wilks">tolerance_wilks</code></td>
<td>
<p>see <code>tolerance</code> used by <code><a href="#topic+omega_inv">omega_inv</a></code> through <code><a href="#topic+CCGamma">CCGamma</a></code></p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_p">p</code></td>
<td>
<p>auto-regression order</p>
</td></tr>
<tr><td><code id="PrecipitationOccurrenceMultiSiteModel_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a <code>PrecipitationOccurrenceModel-class</code> S3 object containing the following elements:
</p>
<p>... <code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code> S3 class objects for each analyzed site. The name is the site (or station) code
</p>
<p><code>ccgama</code> <code>CCGammaObjectListPerEachMonth</code> object, i.e. matices of Gaussian Inter-Site  Correlation returned by <code><a href="#topic+CCGamma">CCGamma</a></code>;
</p>
<p><code>type</code> string indicating the utilized approach for spatial multi-site dependence description, only <code>"wilks"</code> type is implemented;
</p>
<p><code>station</code> character string vectors containing the codes of the station used in <code>PrecipitationMultiSiteOccurrenceModel</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code>,<code><a href="#topic+CCGamma">CCGamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(RGENERATEPREC)

data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990
origin &lt;- paste(year_min,1,1,sep="-")

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
period_temp &lt;- TEMPERATURE_MAX$year&gt;=year_min &amp; TEMPERATURE_MAX$year&lt;=year_max

prec_mes &lt;- PRECIPITATION[period,]
Tx_mes &lt;- TEMPERATURE_MAX[period_temp,]
Tn_mes &lt;- TEMPERATURE_MIN[period_temp,]
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
	acc &lt;- TRUE
	acc &lt;- (length(which(!is.na(Tx_mes[,it])))==length(Tx_mes[,it]))
	acc &lt;- (length(which(!is.na(Tn_mes[,it])))==length(Tn_mes[,it])) &amp; acc
	accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it])) &amp; acc
	
}

valmin &lt;- 1.0
prec_mes &lt;- prec_mes[,accepted]



Tx_mes &lt;- Tx_mes[,accepted]
Tn_mes &lt;- Tn_mes[,accepted]
prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]
station &lt;- station[1:2] # to save example elapsed time!!
exogen &lt;- Tx_mes-Tn_mes
months &lt;- factor(prec_mes$month)

#' ### Not Run!! 
# The following lines are commented to save example elapsed time!!
model_multisite &lt;- PrecipitationOccurrenceMultiSiteModel(x=prec_mes,exogen=exogen,
origin=origin,multisite_type="wilks")

### Not Run!! 
#  The following lines are commented to save example elapsed time!!
model_multisite_logit &lt;- PrecipitationOccurrenceMultiSiteModel(x=prec_mes,exogen=exogen,
origin=origin,multisite_type="logit")
 

</code></pre>

<hr>
<h2 id='predict.PrecipitationOccurrenceModel'>Prediction of a  <code>PrecipitationOccurrenceModel</code> model object</h2><span id='topic+predict.PrecipitationOccurrenceModel'></span><span id='topic+predict'></span><span id='topic+predict.PrecipitationOccurrenceMultiSiteModel'></span><span id='topic+predict.PrecipitationAmountModel'></span>

<h3>Description</h3>

<p>It is a wrapper of <code><a href="stats.html#topic+predict.glm">predict.glm</a></code> method for the a <code>PrecipitationOccurrenceModel</code> model object S3 class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PrecipitationOccurrenceModel'
predict(
  object,
  newdata = NULL,
  type = "response",
  previous = NULL,
  endogenous = NULL,
  ...
)

## S3 method for class 'PrecipitationOccurrenceMultiSiteModel'
predict(object, ...)

## S3 method for class 'PrecipitationAmountModel'
predict(
  object,
  newdata = NULL,
  origin_newdata = NA,
  precipitation.value.random.generation = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_object">object</code></td>
<td>
<p>model returned by <code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code></p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_newdata">newdata</code></td>
<td>
<p>predictor or exogenous variables</p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_type">type</code></td>
<td>
<p>see <code><a href="stats.html#topic+predict.glm">predict.glm</a></code>. Default is <code>"response"</code>. See <code><a href="stats.html#topic+predict.glm">predict.glm</a></code>.</p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_previous">previous</code></td>
<td>
<p>logical vector containing previously occurred states.</p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_endogenous">endogenous</code></td>
<td>
<p>String vector containing the name of the endogenous variables. 
It is used if the endogenous variables are more than one, otherwise is set <code>NULL</code>(Default).</p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_...">...</code></td>
<td>
<p>further arguments</p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_origin_newdata">origin_newdata</code></td>
<td>
<p>character string containing the date corresponding the first row of <code>newdata</code></p>
</td></tr>
<tr><td><code id="predict.PrecipitationOccurrenceModel_+3A_precipitation.value.random.generation">precipitation.value.random.generation</code></td>
<td>
<p>logical value. 
If it is <code>FALSE</code> (Default) the method <code>predict.PrecipitationAmountModel</code> returns conditioned random values, 
otherwise these values are converted to precipitation values  through their observed non-parametric distributions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector or a data frame reporting predicted time series for each station.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict.glm">predict.glm</a></code>,<code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code>
</p>
<p><code><a href="stats.html#topic+predict.glm">predict.glm</a></code>,<code><a href="stats.html#topic+predict.glm">predict.glm</a></code>,<code><a href="#topic+PrecipitationOccurrenceModel">PrecipitationOccurrenceModel</a></code>,<code><a href="#topic+PrecipitationAmountModel">PrecipitationAmountModel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(RGENERATEPREC)

data(trentino)

year_min &lt;- 1961
year_max &lt;- 1990

period &lt;- PRECIPITATION$year&gt;=year_min &amp; PRECIPITATION$year&lt;=year_max
period_temp &lt;- TEMPERATURE_MAX$year&gt;=year_min &amp; TEMPERATURE_MAX$year&lt;=year_max

prec_mes &lt;- PRECIPITATION[period,]
Tx_mes &lt;- TEMPERATURE_MAX[period_temp,]
Tn_mes &lt;- TEMPERATURE_MIN[period_temp,]
accepted &lt;- array(TRUE,length(names(prec_mes)))
names(accepted) &lt;- names(prec_mes)
for (it in names(prec_mes)) {
	acc &lt;- TRUE
	acc &lt;- (length(which(!is.na(Tx_mes[,it])))==length(Tx_mes[,it]))
	acc &lt;- (length(which(!is.na(Tn_mes[,it])))==length(Tn_mes[,it])) &amp; acc
	accepted[it]  &lt;- (length(which(!is.na(prec_mes[,it])))==length(prec_mes[,it])) &amp; acc
	
}

valmin &lt;- 1.0
prec_mes &lt;- prec_mes[,accepted]



Tx_mes &lt;- Tx_mes[,accepted]
Tn_mes &lt;- Tn_mes[,accepted]
origin &lt;- paste(year_min,1,1,sep="-")


prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]
it &lt;- station[2]
vect &lt;- Tx_mes[,it]-Tn_mes[,it]
months &lt;- factor(prec_mes$month)
model &lt;- PrecipitationOccurrenceModel(x=prec_mes[,it],exogen=vect,monthly.factor=months)

probs &lt;- predict(model)

nday &lt;- 3.0
vect_new &lt;- array(1.0,nday)
months_new &lt;- array(1,nday)
row_test &lt;- 2000:2007
newdata &lt;- model$predictor[row_test,]
probs2 &lt;- predict(model,newdata=newdata)

probs[row_test]==probs2
###





prec_occurrence_mes &lt;- prec_mes&gt;=valmin

station &lt;- names(prec_mes)[!(names(prec_mes) %in% c("day","month","year"))]

station &lt;- station[1:4] ## reduced the dataset!!! 
Tx_mes &lt;- Tx_mes[,station]
Tn_mes &lt;- Tn_mes[,station]

prec_mes &lt;- prec_mes[,station]
exogen &lt;- Tx_mes-Tn_mes
months &lt;- factor(prec_mes$month)


### Not Run 
### Please uncomment the following lines to run them 


model_multisite &lt;- PrecipitationOccurrenceMultiSiteModel(x=prec_mes,
exogen=exogen,origin=origin,multisite_type="wilks")


model_multisite_logit &lt;- PrecipitationOccurrenceMultiSiteModel(x=prec_mes,
exogen=exogen,origin=origin,multisite_type="logit")


probs_multimodel  &lt;- predict(model_multisite_logit)




</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
