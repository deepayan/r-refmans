<!DOCTYPE html><html lang="en"><head><title>Help for package tvmediation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tvmediation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bootci_coeff_2trt'><p>Bootstrap function for computing CIs for coefficients for a continuous outcome and two</p>
treatment groups</a></li>
<li><a href='#bootci_coeff_3trt'><p>Bootstrap samples to estimate confidence intervals for coefficients for a continuous</p>
outcome and three treatment groups.</a></li>
<li><a href='#bootci_coeff_binary'><p>Bootstrap samples to estimate confidence intervals for binary outcome coefficients.</p></a></li>
<li><a href='#bootci_tvm_3trt'><p>Bootstrap samples to estimate confidence intervals for continuous outcome and three</p>
treatment groups.</a></li>
<li><a href='#bootci_tvmb'><p>Bootstrap samples to estimate confidence intervals for the mediation effect for a binary</p>
outcome.</a></li>
<li><a href='#coeff'><p>Function to estimate coefficients at time t</p></a></li>
<li><a href='#estBootCIs'><p>Bootstrapping samples to estimate mediation effects confidence intervals for continuous</p>
outcome and two treatment (exposure) groups.</a></li>
<li><a href='#estCoeff'><p>Function to estimate coefficients at time t.</p></a></li>
<li><a href='#LongToWide'><p>Function to transpose the data from long to wide format</p></a></li>
<li><a href='#newMediatorOutcome'><p>Function to compute new Mediator and Outcome using time t and t-1 mean centered on the</p>
individual.</a></li>
<li><a href='#smoker'><p>Wisconsin Smokers' Health Study 2</p></a></li>
<li><a href='#smoothest'><p>Function to compute local polynomial estimation using rule of thumb for bandwidth selection</p></a></li>
<li><a href='#tvma'><p>Time Varying Mediation Function: Continuous Outcome and Two Treatment Groups</p></a></li>
<li><a href='#tvma_3trt'><p>Time Varying Mediation Function: Continuous Outcome and Three Treatment Groups</p></a></li>
<li><a href='#tvmb'><p>Time Varying Mediation Function: Binary Outcome and Two Treatment Groups</p></a></li>
<li><a href='#tvmcurve_3trt'><p>Main function for time varying mediation function for continuous outcome and three</p>
treatment arms (i.e., exposure groups).</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-13</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Title:</td>
<td>Time Varying Mediation Analysis</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for estimating mediation effects that vary over 
   time as described in Cai X, Coffman DL, Piper ME, Li R. 
   Estimation and inference for the mediation effect in a time-varying mediation model. 
   BMC Med Res Methodol. 2022;22(1):1-12.</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 4.0.2), dplyr (&ge; 1.0.2), ggplot2 (&ge; 3.3.2), locpol
(&ge; 0.7-0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/dcoffman/tvmediation/wiki">https://github.com/dcoffman/tvmediation/wiki</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dcoffman/tvmediation/issues">https://github.com/dcoffman/tvmediation/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-21 15:38:02 UTC; yajna</td>
</tr>
<tr>
<td>Author:</td>
<td>Donna Coffman <a href="https://orcid.org/0000-0001-6305-6579"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Xizhen Cai <a href="https://orcid.org/0000-0003-2097-1755"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Yajnaseni Chakraborti
    <a href="https://orcid.org/0000-0002-6747-8821"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Harry Zobel [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Donna Coffman &lt;dcoffman@temple.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-25 06:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bootci_coeff_2trt'>Bootstrap function for computing CIs for coefficients for a continuous outcome and two 
treatment groups</h2><span id='topic+bootci_coeff_2trt'></span>

<h3>Description</h3>

<p>Part of the set of internal functions for estimating bootstrapped CIs for the coefficients
of the mediation model for continuous outcome and two treatment groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootci_coeff_2trt(trt, t.seq, M, Y, t.est, deltat, replicates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootci_coeff_2trt_+3A_trt">trt</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points for each observation</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_m">M</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_y">Y</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation. Default = t.seq</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_deltat">deltat</code></td>
<td>
<p>a small constant which controls the time-lag of the effect of the 
mediator on the outcome.</p>
</td></tr>
<tr><td><code id="bootci_coeff_2trt_+3A_replicates">replicates</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals. 
Default = 1000</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>CI.upper.alpha</code></td>
<td>
<p>CI upper limit for coefficient hat.alpha</p>
</td></tr>
<tr><td><code>CI.lower.alpha</code></td>
<td>
<p>CI lower limit for coefficient hat.alpha</p>
</td></tr>
<tr><td><code>CI.upper.gamma</code></td>
<td>
<p>CI upper limit for coefficient hat.gamma</p>
</td></tr>
<tr><td><code>CI.lower.gamma</code></td>
<td>
<p>CI lower limit for coefficient hat.gamma</p>
</td></tr>
<tr><td><code>CI.upper.beta</code></td>
<td>
<p>CI upper limit for coefficient hat.beta</p>
</td></tr>
<tr><td><code>CI.lower.beta</code></td>
<td>
<p>CI lower limit for coefficient hat.beta</p>
</td></tr>
<tr><td><code>CI.upper.tau</code></td>
<td>
<p>CI upper limit for coefficient hat.tau</p>
</td></tr>
<tr><td><code>CI.lower.tau</code></td>
<td>
<p>CI lower limit for coefficient hat.tau</p>
</td></tr>
</table>

<hr>
<h2 id='bootci_coeff_3trt'>Bootstrap samples to estimate confidence intervals for coefficients for a continuous 
outcome and three treatment groups.</h2><span id='topic+bootci_coeff_3trt'></span>

<h3>Description</h3>

<p>Part of the set of internal functions for estimating bootstrapped confidence intervals 
for the coefficients of the mediation model for a continuous outcome and three treatment 
groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootci_coeff_3trt(
  T1,
  T2,
  t.seq,
  mediator,
  outcome,
  t.est,
  original.coeff,
  boot.sample = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootci_coeff_3trt_+3A_t1">T1</code></td>
<td>
<p>a vector indicating assignment to treatment 1</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_t2">T2</code></td>
<td>
<p>a vector indicating assignment to treatment 2</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points for each observation</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_mediator">mediator</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation. Default = t.seq</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_original.coeff">original.coeff</code></td>
<td>
<p>a list of the estimated coefficients.</p>
</td></tr>
<tr><td><code id="bootci_coeff_3trt_+3A_boot.sample">boot.sample</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals. 
Default = 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alw1</code></td>
<td>
<p>CI lower limit for estimated Treatment 1 effect on mediator</p>
</td></tr>
<tr><td><code>aup1</code></td>
<td>
<p>CI upper limit for estimated Treatment 1 effect on mediator</p>
</td></tr>
<tr><td><code>alw2</code></td>
<td>
<p>CI lower limit for estimated Treatment 2 effect on mediator</p>
</td></tr>
<tr><td><code>aup2</code></td>
<td>
<p>CI upper limit for estimated Treatment 2 effect on mediator</p>
</td></tr>
<tr><td><code>glw1</code></td>
<td>
<p>CI lower limit for estimated Treatment 1 direct effect on outcome</p>
</td></tr>
<tr><td><code>gup1</code></td>
<td>
<p>CI upper limit for estimated Treatment 1 direct effect on outcome</p>
</td></tr>
<tr><td><code>glw2</code></td>
<td>
<p>CI lower limit for estimated Treatment 2 direct effect on outcome</p>
</td></tr>
<tr><td><code>gup2</code></td>
<td>
<p>CI upper limit for estimated Treatment 2 direct effect on outcome</p>
</td></tr>
<tr><td><code>tlw1</code></td>
<td>
<p>CI lower limit for estimated Treatment 1 total effect on outcome</p>
</td></tr>
<tr><td><code>tup1</code></td>
<td>
<p>CI upper limit for estimated Treatment 1 total effect on outcome</p>
</td></tr>
<tr><td><code>tlw2</code></td>
<td>
<p>CI lower limit for estimated Treatment 2 total effect on outcome</p>
</td></tr>
<tr><td><code>tup2</code></td>
<td>
<p>CI upper limit for estimated Treatment 2 total effect on outcome</p>
</td></tr>
<tr><td><code>blw</code></td>
<td>
<p>CI lower limit for estimated effect of mediator on outcome</p>
</td></tr>
<tr><td><code>bup</code></td>
<td>
<p>CI upper limit for estimated effect of mediator on outcome</p>
</td></tr>
</table>

<hr>
<h2 id='bootci_coeff_binary'>Bootstrap samples to estimate confidence intervals for binary outcome coefficients.</h2><span id='topic+bootci_coeff_binary'></span>

<h3>Description</h3>

<p>Internal function for estimating bootstrapped confidence intervals for the coefficients 
of the mediation model for a binary outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootci_coeff_binary(
  treatment,
  t.seq,
  m,
  outcome,
  span = 0.75,
  replicates = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootci_coeff_binary_+3A_treatment">treatment</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="bootci_coeff_binary_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of unique time points for each observation</p>
</td></tr>
<tr><td><code id="bootci_coeff_binary_+3A_m">m</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_binary_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="bootci_coeff_binary_+3A_span">span</code></td>
<td>
<p>Numeric value of the span to be used for LOESS regression. Default = 0.75.</p>
</td></tr>
<tr><td><code id="bootci_coeff_binary_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for bootstrapping confidence intervals. 
Default = 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>t.seq</code></td>
<td>
<p>time points of estimation</p>
</td></tr>
<tr><td><code>CI.lower.a</code></td>
<td>
<p>CI lower limit for alpha_hat</p>
</td></tr>
<tr><td><code>CI.upper.a</code></td>
<td>
<p>CI upper limit for alpha_hat</p>
</td></tr>
<tr><td><code>CI.lower.g</code></td>
<td>
<p>CI lower limit for gamma_hat</p>
</td></tr>
<tr><td><code>CI.upper.g</code></td>
<td>
<p>CI upper limit for gamma_hat</p>
</td></tr>
<tr><td><code>CI.lower.b</code></td>
<td>
<p>CI lower limit for beta_hat</p>
</td></tr>
<tr><td><code>CI.upper.b</code></td>
<td>
<p>CI upper limit for beta_hat</p>
</td></tr>
<tr><td><code>CI.lower.t</code></td>
<td>
<p>CI lower limit for tau_hat</p>
</td></tr>
<tr><td><code>CI.upper.t</code></td>
<td>
<p>CI upper limit for tau_hat</p>
</td></tr>
</table>

<hr>
<h2 id='bootci_tvm_3trt'>Bootstrap samples to estimate confidence intervals for continuous outcome and three 
treatment groups.</h2><span id='topic+bootci_tvm_3trt'></span>

<h3>Description</h3>

<p>Internal function for estimating bootstrapped confidence intervals for the mediation 
effect of continuous outcome and three treatment groups when user argument 
<code>CI="boot"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootci_tvm_3trt(boot.sample, orig.data, t.est)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootci_tvm_3trt_+3A_boot.sample">boot.sample</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals. 
Default = 1000.</p>
</td></tr>
<tr><td><code id="bootci_tvm_3trt_+3A_orig.data">orig.data</code></td>
<td>
<p>a list of original data <code>T1</code>, <code>T2</code>, <code>mediator</code>, 
<code>outcome</code> and <code>t.seq</code>.</p>
</td></tr>
<tr><td><code id="bootci_tvm_3trt_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation. Default = t.seq.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>plw1</code></td>
<td>
<p>CI lower limit for estimated mediation effect of T1</p>
</td></tr>
<tr><td><code>pup1</code></td>
<td>
<p>CI upper limit for estimated mediation effect of T1</p>
</td></tr>
<tr><td><code>plw2</code></td>
<td>
<p>CI lower limit for estimated mediation effect of T2</p>
</td></tr>
<tr><td><code>pup2</code></td>
<td>
<p>CI upper limit for estimated mediation effect of T2</p>
</td></tr>
<tr><td><code>orig.se1.all</code></td>
<td>
<p>estimated standard errors for the mediation effect of T1</p>
</td></tr>
<tr><td><code>orig.se2.all</code></td>
<td>
<p>estimated standard errors for the mediation effect of T2</p>
</td></tr>
<tr><td><code>orig.mediation1</code></td>
<td>
<p>time varying mediation effect for T1</p>
</td></tr>
<tr><td><code>orig.mediation2</code></td>
<td>
<p>time varying mediation effect for T2</p>
</td></tr>
</table>

<hr>
<h2 id='bootci_tvmb'>Bootstrap samples to estimate confidence intervals for the mediation effect for a binary 
outcome.</h2><span id='topic+bootci_tvmb'></span>

<h3>Description</h3>

<p>Part of the set of internal functions for estimating bootstrapped confidence intervals 
for the mediation effect for a binary outcome when user argument <code>CI="boot"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootci_tvmb(
  treatment,
  t.seq,
  m,
  outcome,
  coeff_data,
  span = 0.75,
  replicates = 1000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootci_tvmb_+3A_treatment">treatment</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of unique time points for each observation</p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_m">m</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_coeff_data">coeff_data</code></td>
<td>
<p>a merged dataset of indirect and direct effects and CIs estimated 
from <code>bootci_coeff_binary</code></p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_span">span</code></td>
<td>
<p>Numeric value of the span to be used for LOESS regression. Default = 0.75.</p>
</td></tr>
<tr><td><code id="bootci_tvmb_+3A_replicates">replicates</code></td>
<td>
<p>number of replicates for bootstrapping CIs. Default = 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>timeseq</code></td>
<td>
<p>time points of estimation</p>
</td></tr>
<tr><td><code>alpha_hat</code></td>
<td>
<p>time-varying treatment effect on the mediator</p>
</td></tr>
<tr><td><code>CI.lower.a</code></td>
<td>
<p>CI lower limit for estimated coefficient alpha_hat</p>
</td></tr>
<tr><td><code>CI.upper.a</code></td>
<td>
<p>CI upper limit for estimated coefficient alpha_hat</p>
</td></tr>
<tr><td><code>gamma_hat</code></td>
<td>
<p>time-varying treatment effect on the outcome (direct effect)</p>
</td></tr>
<tr><td><code>CI.lower.g</code></td>
<td>
<p>CI lower limit for estimated coefficient gamma_hat</p>
</td></tr>
<tr><td><code>CI.upper.g</code></td>
<td>
<p>CI upper limit for estimated coefficient gamma_hat</p>
</td></tr>
<tr><td><code>beta_hat</code></td>
<td>
<p>time-varying effect of the mediator on the outcome</p>
</td></tr>
<tr><td><code>CI.lower.b</code></td>
<td>
<p>CI lower limit for estimated coefficient beta_hat</p>
</td></tr>
<tr><td><code>CI.upper.b</code></td>
<td>
<p>CI upper limit for estimated coefficient beta_hat</p>
</td></tr>
<tr><td><code>tau_hat</code></td>
<td>
<p>time-varying treatment effect on outcome (total effect)</p>
</td></tr>
<tr><td><code>CI.lower.t</code></td>
<td>
<p>CI lower limit for estimated coefficient tau_hat</p>
</td></tr>
<tr><td><code>CI.upper.t</code></td>
<td>
<p>CI upper limit for estimated coefficient tau_hat</p>
</td></tr>
<tr><td><code>medEffect</code></td>
<td>
<p>time varying mediation effect</p>
</td></tr>
<tr><td><code>CI.lower</code></td>
<td>
<p>CI lower limit for medEffect</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>CI upper limit for medEffect</p>
</td></tr>
</table>

<hr>
<h2 id='coeff'>Function to estimate coefficients at time t</h2><span id='topic+coeff'></span>

<h3>Description</h3>

<p>Part of the set of internal functions called within the <code>tvmcurve_3trt</code> function 
to assist in the estimation of time varying mediation effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coeff(j, T1, T2, x, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coeff_+3A_j">j</code></td>
<td>
<p>a number indicating time point of observation</p>
</td></tr>
<tr><td><code id="coeff_+3A_t1">T1</code></td>
<td>
<p>a vector indicating assignment to treatment 1</p>
</td></tr>
<tr><td><code id="coeff_+3A_t2">T2</code></td>
<td>
<p>a vector indicating assignment to treatment 2</p>
</td></tr>
<tr><td><code id="coeff_+3A_x">x</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="coeff_+3A_y">y</code></td>
<td>
<p>matrix of outcome outcomes in wide format</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coeff.est</code></td>
<td>
<p>estimated coefficients of the mediation model</p>
</td></tr>
<tr><td><code>nomissing.index</code></td>
<td>
<p>index of complete cases</p>
</td></tr>
</table>

<hr>
<h2 id='estBootCIs'>Bootstrapping samples to estimate mediation effects confidence intervals for continuous 
outcome and two treatment (exposure) groups.</h2><span id='topic+estBootCIs'></span>

<h3>Description</h3>

<p>Part of the set of internal functions for estimating bootstrapped confidence intervals 
for continuous outcome and two treatment groups when user argument <code>CI="boot"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estBootCIs(trt, t.seq, M, Y, t.est, deltat, replicates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estBootCIs_+3A_trt">trt</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points at each obs</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_m">M</code></td>
<td>
<p>matrix of mediator values</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_y">Y</code></td>
<td>
<p>matrix of outcome values</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_deltat">deltat</code></td>
<td>
<p>a small constant which controls the time-lag of the effect of the 
mediator on the outcome, half the time between two time points</p>
</td></tr>
<tr><td><code id="estBootCIs_+3A_replicates">replicates</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>boot.sebootstrapped standard error for the estimated mediation effect
</p>
<p>CI.upperpercentile bootstrapped CI upper limit for the estimated mediation effect
</p>
<p>CI.lowerpercentile bootstrapped CI lower limit for the estimated mediation effect
</p>

<hr>
<h2 id='estCoeff'>Function to estimate coefficients at time t.</h2><span id='topic+estCoeff'></span>

<h3>Description</h3>

<p>Part of the set of internal functions called within the <code>tvma</code> function to assist 
in the estimation of the time varying mediation effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estCoeff(newMO.j.est)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estCoeff_+3A_newmo.j.est">newMO.j.est</code></td>
<td>
<p>a list containing mean centered mediators and outcomes</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coeff.est</code></td>
<td>
<p>estimated coefficients of the mediation model</p>
</td></tr>
</table>

<hr>
<h2 id='LongToWide'>Function to transpose the data from long to wide format</h2><span id='topic+LongToWide'></span>

<h3>Description</h3>

<p>Transposing a dataset with repeated measurements/responses for each subject 
from longitudinal to wide format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LongToWide(subject.id, time.sequence, outcome, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LongToWide_+3A_subject.id">subject.id</code></td>
<td>
<p>a column of subject identifiers</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_time.sequence">time.sequence</code></td>
<td>
<p>a column of time points</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_outcome">outcome</code></td>
<td>
<p>a column to be transposed</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE (default = FALSE) prints output to screen 
(OPTIONAL INPUT)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If data is not sorted by subject.id, a warning message will appear. 
The function will then sort the data by subject.id. It is recommended that the 
user sorts the data prior to using this function.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mat.wide</code></td>
<td>
<p>a matrix in wide format, in which each
column is the outcome for each subject and each row is the time sequence</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># CREATING A TRANSPOSED MATRIX FOR MEDIATOR `WantToSmokeLst15min`
data(smoker)
mat.wide &lt;- LongToWide(smoker$SubjectID,
                       smoker$timeseq,
                       smoker$WantToSmokeLst15min)

</code></pre>

<hr>
<h2 id='newMediatorOutcome'>Function to compute new Mediator and Outcome using time t and t-1 mean centered on the 
individual.</h2><span id='topic+newMediatorOutcome'></span>

<h3>Description</h3>

<p>Part of the set of internal functions called within the <code>tvma</code> function to assist 
in the estimation of time varying mediation effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newMediatorOutcome(trt, M, Y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="newMediatorOutcome_+3A_trt">trt</code></td>
<td>
<p>numeric binary treatment group indicator for each individual</p>
</td></tr>
<tr><td><code id="newMediatorOutcome_+3A_m">M</code></td>
<td>
<p>(t.seq x N) matrix where N = number of observations. 
Column 1 is mediator at time t-1. Column 2 is mediator at time t.</p>
</td></tr>
<tr><td><code id="newMediatorOutcome_+3A_y">Y</code></td>
<td>
<p>(Nx1) matrix were N = number of observations. Column 1 is outcome at time t-1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>newMO</code></td>
<td>
<p>list containing new mediators, outcomes, and index of complete cases</p>
</td></tr>
</table>

<hr>
<h2 id='smoker'>Wisconsin Smokers' Health Study 2</h2><span id='topic+smoker'></span>

<h3>Description</h3>

<p>The dataset is <strong>simulated</strong> based on the Wisconsin Smokers' Health Study 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(smoker)</code></pre>


<h3>Format</h3>

<p>A data frame with 40,130 observations on 12 variables.
</p>

<ol>
<li> <p><strong>SubjectID:</strong>	Subject ID
</p>
</li>
<li> <p><strong>treatment:</strong>	Treatment group (2 = patch, 3 = varenicline, 4 = combination nicotine replacement therapy)
</p>
</li>
<li> <p><strong>patch:</strong>	Received patch (0 = No, 1 = Yes)
</p>
</li>
<li> <p><strong>varenicline:</strong>	Received varenicline (0 = No, 1 = Yes)
</p>
</li>
<li> <p><strong>comboNRT:</strong>	Received combination nicotine replacement therapy (0 = No, 1 = Yes)
</p>
</li>
<li> <p><strong>DaysFromTQD:</strong>	Number of days from quit date
</p>
</li>
<li> <p><strong>time.of.day:</strong>	Time of day (0 = am, 1 = pm)
</p>
</li>
<li> <p><strong>timeseq:</strong>	Number of days from quit date (.5 indicates pm)
</p>
</li>
<li> <p><strong>WantToSmokeLst15min:</strong>	How did you feel in the last 15 min: wanting to smoke (1 = not at all, 7 = extremely)
</p>
</li>
<li> <p><strong>NegMoodLst15min:</strong>	How did you feel in the last 15 min: Negative mood (1 = not at all, 7 = extremely)
</p>
</li>
<li> <p><strong>cessFatig:</strong>	Cessation fatigue - I am tired of trying to quit smoking (1 = strongly disagree, 7 = strongly agree)
</p>
</li>
<li> <p><strong>CigCount:</strong>	Cigarettes smoked over entire day
</p>
</li>
<li> <p><strong>smoke_status:</strong> Did you smoke (0 = No, 1 = Yes)
</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+tvmb">tvmb</a></code>, <code><a href="#topic+tvma_3trt">tvma_3trt</a></code> <code><a href="#topic+tvma">tvma</a></code>, <code><a href="#topic+LongToWide">LongToWide</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(smoker)
</code></pre>

<hr>
<h2 id='smoothest'>Function to compute local polynomial estimation using rule of thumb for bandwidth selection</h2><span id='topic+smoothest'></span>

<h3>Description</h3>

<p>Part of the set of internal functions called within the <code>tvma</code> function to assist 
in the estimation of the time varying mediation effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothest(t.seq, t.coeff, t.est, deltat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="smoothest_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points at each observation</p>
</td></tr>
<tr><td><code id="smoothest_+3A_t.coeff">t.coeff</code></td>
<td>
<p>estimated coefficients</p>
</td></tr>
<tr><td><code id="smoothest_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation</p>
</td></tr>
<tr><td><code id="smoothest_+3A_deltat">deltat</code></td>
<td>
<p>a small constant which controls the time-lag of the effect of the 
mediator on the outcome, half the time between two time points</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>bw_alpha</code></td>
<td>
<p>a number computed via Fan and Gijbels' (1996) rule of thumb for 
bandwidth selector for alpha coefficient.</p>
</td></tr>
<tr><td><code>bw_gamma</code></td>
<td>
<p>a number computed via Fan and Gijbels' (1996) rule of thumb for 
bandwidth selector for gamma coefficient.</p>
</td></tr>
<tr><td><code>bw_beta</code></td>
<td>
<p>a number computed via Fan and Gijbels' (1996) rule of thumb for 
bandwidth selector for beta coefficient.</p>
</td></tr>
<tr><td><code>bw_beta</code></td>
<td>
<p>a number computed via Fan and Gijbels' (1996) rule of thumb for 
bandwidth selector for tau coefficient.</p>
</td></tr>
<tr><td><code>hat.alpha</code></td>
<td>
<p>estimated treatment effect on mediator</p>
</td></tr>
<tr><td><code>hat.gamma</code></td>
<td>
<p>estimated treatment effect on outcome, adjusted for mediator</p>
</td></tr>
<tr><td><code>hat.beta</code></td>
<td>
<p>estimated mediator effect on outcome</p>
</td></tr>
<tr><td><code>hat.tau</code></td>
<td>
<p>estimated treatment effect on outcome, not adjusting for mediator</p>
</td></tr>
<tr><td><code>est.M</code></td>
<td>
<p>estimated mediation effect, product of hat.alpha and hat.beta</p>
</td></tr>
</table>

<hr>
<h2 id='tvma'>Time Varying Mediation Function: Continuous Outcome and Two Treatment Groups</h2><span id='topic+tvma'></span>

<h3>Description</h3>

<p>Function to estimate the time-varying mediation effect and bootstrap standard 
errors for two treatment groups and a continuous outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvma(
  treatment,
  t.seq,
  mediator,
  outcome,
  t.est = t.seq,
  plot = FALSE,
  CI = "boot",
  replicates = 1000,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvma_+3A_treatment">treatment</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="tvma_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points for each observation</p>
</td></tr>
<tr><td><code id="tvma_+3A_mediator">mediator</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="tvma_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="tvma_+3A_t.est">t.est</code></td>
<td>
<p>a vector of time points at which to estimate. 
Default = t.seq (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE for producing plots. Default = &quot;FALSE&quot; 
(OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_+3A_ci">CI</code></td>
<td>
<p>&quot;none&quot; or &quot;boot&quot; method of deriving confidence intervals. 
Default = &quot;boot&quot; (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_+3A_replicates">replicates</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals. 
Default = 1000 (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE for printing results to screen. 
Default = &quot;FALSE&quot; (OPTIONAL ARGUMENT)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>hat.alpha</code></td>
<td>
<p>estimated time-varying treatment effect on mediator</p>
</td></tr>
<tr><td><code>CI.lower.alpha</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.alpha</p>
</td></tr>
<tr><td><code>CI.upper.alpha</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.alpha</p>
</td></tr>
<tr><td><code>hat.gamma</code></td>
<td>
<p>estimated time-varying treatment effect on outcome (direct effect)</p>
</td></tr>
<tr><td><code>CI.lower.gamma</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.gamma</p>
</td></tr>
<tr><td><code>CI.upper.gamma</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.gamma</p>
</td></tr>
<tr><td><code>hat.beta</code></td>
<td>
<p>estimated time-varying effect of the mediator on outcome</p>
</td></tr>
<tr><td><code>CI.lower.beta</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.beta</p>
</td></tr>
<tr><td><code>CI.upper.beta</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.beta</p>
</td></tr>
<tr><td><code>hat.tau</code></td>
<td>
<p>estimated time-varying treatment effect on outcome (total effect)</p>
</td></tr>
<tr><td><code>CI.lower.tau</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.tau</p>
</td></tr>
<tr><td><code>CI.upper.tau</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.tau</p>
</td></tr>
<tr><td><code>est.M</code></td>
<td>
<p>time varying mediation effect</p>
</td></tr>
<tr><td><code>boot.se.m</code></td>
<td>
<p>estimated standard error for est.M</p>
</td></tr>
<tr><td><code>CI.lower</code></td>
<td>
<p>CI lower limit for est.M</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>CI upper limit for est.M</p>
</td></tr>
</table>


<h3>Plot Returns</h3>


<ol>
<li><p><code>Alpha_CI </code>plot for hat.alpha with CIs over t.est
</p>
</li>
<li><p><code>Gamma_CI </code>plot for hat.gamma with CIs over t.est
</p>
</li>
<li><p><code>Beta_CI </code>plot for hat.beta with CIs over t.est
</p>
</li>
<li><p><code>Tau_CI </code>plot for hat.tau with CIs over t.est
</p>
</li>
<li><p><code>MedEff </code>plot for est.M over t.est
</p>
</li>
<li><p><code>MedEff_CI </code>plot for est.M with CIs over t.est
</p>
</li></ol>



<h3>Note</h3>


<ol>
<li><p>** IMPORTANT ** An alternate way of formatting the data and calling the 
function is documented in detail in the tutorial for the tvmb() function.
</p>
</li></ol>



<h3>References</h3>


<ol>
<li><p>Fan, J. and Gijbels, I. Local polynomial modelling and its 
applications: Monographs on statistics and applied probability 66. 
CRC Press; 1996.
</p>
</li>
<li><p>Fan J, Zhang W. Statistical Estimation in Varying Coefficient Models. 
The Annals of Statistics. 1999;27(5):1491-1518.
</p>
</li>
<li><p>Fan J, Zhang JT. Two-step estimation of functional linear models with 
applications to longitudinal data. Journal of the Royal Statistical Society: 
Series B (Statistical Methodology). 2000;62(2):303-322.
</p>
</li>
<li><p>Cai X, Coffman DL, Piper ME, Li R. Estimation and inference for the mediation 
effect in a time-varying mediation model. BMC Med Res Methodol. 
2022;22(1):1-12.
</p>
</li>
<li><p>Baker TB, Piper ME, Stein JH, et al. Effects of Nicotine Patch vs Varenicline 
vs Combination Nicotine Replacement Therapy on Smoking Cessation at 26 Weeks: 
A Randomized Clinical Trial. JAMA. 2016;315(4):371.
</p>
</li>
<li><p>B. Efron, R. Tibshirani. Bootstrap Methods for Standard Errors, Confidence 
Intervals, and Other Measures of Statistical Accuracy. Statistical Science. 
1986;1(1):54-75.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(smoker)

# REDUCE DATA SET TO ONLY 2 TREATMENT CONDITIONS (EXCLUDING COMBINATION NRT)
smoker.sub &lt;- smoker[smoker$treatment != 4, ]

# GENERATE WIDE FORMATTED MEDIATORS
mediator &lt;- LongToWide(smoker.sub$SubjectID,
                       smoker.sub$timeseq,
                       smoker.sub$NegMoodLst15min)

# GENERATE WIDE FORMATTED OUTCOMES
outcome &lt;- LongToWide(smoker.sub$SubjectID,
                      smoker.sub$timeseq,
                      smoker.sub$cessFatig)

# GENERATE A BINARY TREATMENT VARIABLE
trt &lt;- as.numeric(unique(smoker.sub[,c("SubjectID","varenicline")])[,2])-1

# GENERATE A VECTOR OF UNIQUE TIME POINTS
t.seq &lt;- sort(unique(smoker.sub$timeseq))

# COMPUTE TIME VARYING MEDIATION ANALYSIS USING BOOTSTRAPPED CONFIDENCE INTERVALS
results &lt;- tvma(trt, t.seq, mediator, outcome)

# COMPUTE TIME VARYING MEDIATION ANALYSIS FOR SPECIFIED POINTS IN TIME USING 250 REPLICATES
results &lt;- tvma(trt, t.seq, mediator, outcome,
                t.est = c(0.2, 0.4, 0.6, 0.8),
                replicates = 250)
## End(Not run)
</code></pre>

<hr>
<h2 id='tvma_3trt'>Time Varying Mediation Function: Continuous Outcome and Three Treatment Groups</h2><span id='topic+tvma_3trt'></span>

<h3>Description</h3>

<p>Function to estimate the time-varying mediation effect and bootstrap standard 
errors for three treatment groups and a continuous outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvma_3trt(
  T1,
  T2,
  t.seq,
  mediator,
  outcome,
  t.est = t.seq,
  plot = FALSE,
  CI = "boot",
  replicates = 1000,
  grpname = "T",
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvma_3trt_+3A_t1">T1</code></td>
<td>
<p>a vector indicating assignment to treatment 1</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_t2">T2</code></td>
<td>
<p>a vector indicating assignment to treatment 2</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points for each observation</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_mediator">mediator</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_t.est">t.est</code></td>
<td>
<p>a vector of time points at which to make the estimation. 
Default = t.seq. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE for plotting mediation effect. 
Default = &quot;FALSE&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_ci">CI</code></td>
<td>
<p>&quot;none&quot; or &quot;boot&quot; method of deriving confidence intervals. 
Default = &quot;boot&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_replicates">replicates</code></td>
<td>
<p>number of replicates for bootstrapping confidence intervals. 
Default = 1000. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_grpname">grpname</code></td>
<td>
<p>name of the treatment arms (exposure groups) to be displayed in
the results. Default = &quot;T&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvma_3trt_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE for printing results to screen. 
Default = &quot;FALSE&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>hat.alpha1</code></td>
<td>
<p>estimated Treatment 1 effect on mediator</p>
</td></tr>
<tr><td><code>CI.lower.alpha1</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.alpha1</p>
</td></tr>
<tr><td><code>CI.upper.alpha1</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.alpha1</p>
</td></tr>
<tr><td><code>hat.alpha2</code></td>
<td>
<p>estimated Treatment 2 effect on mediator</p>
</td></tr>
<tr><td><code>CI.lower.alpha2</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.alpha2</p>
</td></tr>
<tr><td><code>CI.upper.alpha2</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.alpha2</p>
</td></tr>
<tr><td><code>hat.gamma1</code></td>
<td>
<p>estimated Treatment 1 direct effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.gamma1</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.gamma1</p>
</td></tr>
<tr><td><code>CI.upper.gamma1</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.gamma1</p>
</td></tr>
<tr><td><code>hat.gamma2</code></td>
<td>
<p>estimated Treatment 2 direct effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.gamma2</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.gamma2</p>
</td></tr>
<tr><td><code>CI.upper.gamma2</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.gamma2</p>
</td></tr>
<tr><td><code>hat.tau1</code></td>
<td>
<p>estimated Treatment 1 total effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.tau1</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.tau1</p>
</td></tr>
<tr><td><code>CI.upper.tau1</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.tau1</p>
</td></tr>
<tr><td><code>hat.tau2</code></td>
<td>
<p>estimated Treatment 2 total effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.tau2</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.tau2</p>
</td></tr>
<tr><td><code>CI.upper.tau2</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.tau2</p>
</td></tr>
<tr><td><code>hat.beta</code></td>
<td>
<p>estimated mediator effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.beta</code></td>
<td>
<p>CI lower limit for estimated coefficient hat.beta</p>
</td></tr>
<tr><td><code>CI.upper.beta</code></td>
<td>
<p>CI upper limit for estimated coefficient hat.beta</p>
</td></tr>
<tr><td><code>hat.mediation1</code></td>
<td>
<p>time varying mediation effect for Treatment 1 on outcome</p>
</td></tr>
<tr><td><code>SE_MedEff1</code></td>
<td>
<p>estimated standard errors of hat.mediation1</p>
</td></tr>
<tr><td><code>CI.upper.T1</code></td>
<td>
<p>CI upper limit for hat.mediation1</p>
</td></tr>
<tr><td><code>CI.lower.T1</code></td>
<td>
<p>CI lower limit for hat.mediation1</p>
</td></tr>
<tr><td><code>hat.mediation2</code></td>
<td>
<p>time varying mediation effect for Treatment 2 on outcome</p>
</td></tr>
<tr><td><code>SE_MedEff2</code></td>
<td>
<p>estimated standard errors of hat.mediation2</p>
</td></tr>
<tr><td><code>CI.upper.T2</code></td>
<td>
<p>CI upper limit for hat.mediation2</p>
</td></tr>
<tr><td><code>CI.lower.T2</code></td>
<td>
<p>CI lower limit for hat.mediation2</p>
</td></tr>
</table>


<h3>Plot Returns</h3>


<ol>
<li><p><code>plot1_a1 </code>plot for hat.alpha1 with CIs over t.est
</p>
</li>
<li><p><code>plot2_a2 </code>plot for hat.alpha2 with CIs over t.est
</p>
</li>
<li><p><code>plot3_g1 </code>plot for hat.gamma1 with CIs over t.est
</p>
</li>
<li><p><code>plot4_g2 </code>plot for hat.gamma2 with CIs over t.est
</p>
</li>
<li><p><code>plot5_t1 </code>plot for hat.tau1 with CIs over t.est
</p>
</li>
<li><p><code>plot6_t2 </code>plot for hat.tau2 with CIs over t.est
</p>
</li>
<li><p><code>plot7_b </code>plot for hat.beta with CIs over t.est
</p>
</li>
<li><p><code>MedEff_T1 </code>plot for hat.mediation1 over t.est
</p>
</li>
<li><p><code>MedEff_T2 </code>plot for hat.mediation2 over t.est
</p>
</li>
<li><p><code>MedEff_CI_T1 </code>plot for hat.mediation1 with CIs over t.est
</p>
</li>
<li><p><code>MedEff_CI_T2 </code>plot for hat.mediation2 with CIs over t.est
</p>
</li></ol>



<h3>References</h3>


<ol>
<li><p>Fan, J. and Gijbels, I. Local polynomial modelling and its 
applications: Monographs on statistics and applied probability 66. 
CRC Press; 1996.
</p>
</li>
<li><p>Fan J, Zhang W. Statistical Estimation in Varying Coefficient Models. 
The Annals of Statistics. 1999;27(5):1491-1518.
</p>
</li>
<li><p>Fan J, Zhang JT. Two-step estimation of functional linear models with 
applications to longitudinal data. Journal of the Royal Statistical Society: 
Series B (Statistical Methodology). 2000;62(2):303-322.
</p>
</li>
<li><p>Cai X, Coffman DL, Piper ME, Li R. Estimation and inference for the mediation 
effect in a time-varying mediation model. BMC Med Res Methodol. 
2022;22(1):1-12.
</p>
</li>
<li><p>Baker TB, Piper ME, Stein JH, et al. Effects of Nicotine Patch vs Varenicline 
vs Combination Nicotine Replacement Therapy on Smoking Cessation at 26 Weeks: 
A Randomized Clinical Trial. JAMA. 2016;315(4):371.
</p>
</li>
<li><p>B. Efron, R. Tibshirani. Bootstrap Methods for Standard Errors, Confidence 
Intervals, and Other Measures of Statistical Accuracy. Statistical Science. 
1986;1(1):54-75.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(smoker)

# GENERATE WIDE FORMATTED MEDIATORS
mediator &lt;- LongToWide(smoker$SubjectID,
                        smoker$timeseq, 
                        smoker$NegMoodLst15min)

# GENERATE WIDE FORMATTED OUTCOMES
outcome &lt;- LongToWide(smoker$SubjectID,
                      smoker$timeseq,
                      smoker$cessFatig)

# GENERATE TWO BINARY TREATMENT VARIABLES
NRT1 &lt;- as.numeric(unique(smoker[,c("SubjectID","varenicline")])[,2])-1
NRT2 &lt;- as.numeric(unique(smoker[,c("SubjectID","comboNRT")])[,2])-1

# GENERATE A VECTOR OF UNIQUE TIME POINTS
t.seq &lt;- sort(unique(smoker$timeseq))

# COMPUTE TIME VARYING MEDIATION ANALYSIS USING BOOTSTRAPPED CONFIDENCE INTERVALS
results &lt;- tvma_3trt(NRT1, NRT2, t.seq, mediator, outcome)

# COMPUTE TIME VARYING MEDIATION ANALYSIS FOR SPECIFIED POINTS IN TIME USING 250 REPLICATES
results &lt;- tvma_3trt(NRT1, NRT2, t.seq, mediator, outcome,
                     t.est = c(0.2, 0.4, 0.6, 0.8),
                     replicates = 250)
## End(Not run)

</code></pre>

<hr>
<h2 id='tvmb'>Time Varying Mediation Function: Binary Outcome and Two Treatment Groups</h2><span id='topic+tvmb'></span>

<h3>Description</h3>

<p>Function to estimate the time-varying mediation effect and bootstrap standard errors, involving two treatment groups and binary outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvmb(
  treatment,
  t.seq,
  mediator,
  outcome,
  span = 0.75,
  plot = FALSE,
  CI = "boot",
  replicates = 1000,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvmb_+3A_treatment">treatment</code></td>
<td>
<p>a vector indicating treatment group</p>
</td></tr>
<tr><td><code id="tvmb_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of unique time points for each observation</p>
</td></tr>
<tr><td><code id="tvmb_+3A_mediator">mediator</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="tvmb_+3A_outcome">outcome</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="tvmb_+3A_span">span</code></td>
<td>
<p>Numeric value of the span to be used for LOESS regression. Default = 0.75.</p>
</td></tr>
<tr><td><code id="tvmb_+3A_plot">plot</code></td>
<td>
<p>TRUE or FALSE for producing plots. Default = &quot;FALSE&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvmb_+3A_ci">CI</code></td>
<td>
<p>&quot;none&quot; or &quot;boot&quot; method of deriving confidence intervals. Default = &quot;boot&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvmb_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for bootstrapping confidence intervals. Default = 1000. (OPTIONAL ARGUMENT)</p>
</td></tr>
<tr><td><code id="tvmb_+3A_verbose">verbose</code></td>
<td>
<p>TRUE or FALSE for printing results to screen. Default = &quot;FALSE&quot;. (OPTIONAL ARGUMENT)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>timeseq</code></td>
<td>
<p>time points of estimation</p>
</td></tr>
<tr><td><code>alpha_hat</code></td>
<td>
<p>estimated treatment effect on mediator</p>
</td></tr>
<tr><td><code>CI.lower.a</code></td>
<td>
<p>CI lower limit for estimated coefficient alpha_hat</p>
</td></tr>
<tr><td><code>CI.upper.a</code></td>
<td>
<p>CI upper limit for estimated coefficient alpha_hat</p>
</td></tr>
<tr><td><code>gamma_hat</code></td>
<td>
<p>estimated treatment effect on outcome (direct effect)</p>
</td></tr>
<tr><td><code>CI.lower.g</code></td>
<td>
<p>CI lower limit for estimated coefficient gamma_hat</p>
</td></tr>
<tr><td><code>CI.upper.g</code></td>
<td>
<p>CI upper limit for estimated coefficient gamma_hat</p>
</td></tr>
<tr><td><code>beta_hat</code></td>
<td>
<p>estimated mediator effect on outcome</p>
</td></tr>
<tr><td><code>CI.lower.b</code></td>
<td>
<p>CI lower limit for estimated coefficient beta_hat</p>
</td></tr>
<tr><td><code>CI.upper.b</code></td>
<td>
<p>CI upper limit for estimated coefficient beta_hat</p>
</td></tr>
<tr><td><code>tau_hat</code></td>
<td>
<p>estimated treatment effect on outcome (total effect)</p>
</td></tr>
<tr><td><code>CI.lower.t</code></td>
<td>
<p>CI lower limit for estimated coefficient tau_hat</p>
</td></tr>
<tr><td><code>CI.upper.t</code></td>
<td>
<p>CI upper limit for estimated coefficient tau_hat</p>
</td></tr>
<tr><td><code>medEffect</code></td>
<td>
<p>time varying mediation effect</p>
</td></tr>
<tr><td><code>CI.lower</code></td>
<td>
<p>CI lower limit for medEffect</p>
</td></tr>
<tr><td><code>CI.upper</code></td>
<td>
<p>CI upper limit for medEffect</p>
</td></tr>
</table>


<h3>Plot Returns</h3>


<ol>
<li><p><code>plot1_a </code>plot for alpha_hat with CIs over t.seq
</p>
</li>
<li><p><code>plot2_g </code>plot for gamma_hat with CIs over t.seq
</p>
</li>
<li><p><code>plot3_b </code>plot for beta_hat with CIs over t.seq
</p>
</li>
<li><p><code>plot4_t </code>plot for tau_hat with CIs over t.seq
</p>
</li>
<li><p><code>MedEff </code>plot for medEffect over t.seq
</p>
</li>
<li><p><code>MedEff_CI </code>plot for medEffect with CIs over t.seq
</p>
</li>
<li><p><code>bootstrap </code>plot for estimated medEffect from bootstrapped samples over t.seq
</p>
</li></ol>



<h3>Note</h3>


<ol>
<li><p>Currently supports 2 treatment groups
</p>
</li>
<li><p>** IMPORTANT ** An alternate way of formatting the data and calling the function 
is documented in detail in the tutorial for the tvmb() function.
</p>
</li></ol>



<h3>References</h3>


<ol>
<li><p>Fan, J. and Gijbels, I. Local polynomial modelling and its 
applications: Monographs on statistics and applied probability 66. 
CRC Press; 1996.
</p>
</li>
<li><p>Fan J, Zhang W. Statistical Estimation in Varying Coefficient Models. 
The Annals of Statistics. 1999;27(5):1491-1518.
</p>
</li>
<li><p>Fan J, Zhang JT. Two-step estimation of functional linear models with 
applications to longitudinal data. Journal of the Royal Statistical Society: 
Series B (Statistical Methodology). 2000;62(2):303-322.
</p>
</li>
<li><p>Baker TB, Piper ME, Stein JH, et al. Effects of Nicotine Patch vs Varenicline 
vs Combination Nicotine Replacement Therapy on Smoking Cessation at 26 Weeks: 
A Randomized Clinical Trial. JAMA. 2016;315(4):371.
</p>
</li>
<li><p>B. Efron, R. Tibshirani. Bootstrap Methods for Standard Errors, Confidence 
Intervals, and Other Measures of Statistical Accuracy. Statistical Science. 
1986;1(1):54-75.
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: data(smoker)

# REDUCE DATA SET TO ONLY 2 TREATMENT CONDITIONS (EXCLUDE COMBINATION NRT)
smoker.sub &lt;- smoker[smoker$treatment != 4, ]

# GENERATE WIDE FORMATTED MEDIATORS
mediator &lt;- LongToWide(smoker.sub$SubjectID,
                       smoker.sub$timeseq,
                       smoker.sub$NegMoodLst15min)

# GENERATE WIDE FORMATTED OUTCOMES
outcome &lt;- LongToWide(smoker.sub$SubjectID,
                      smoker.sub$timeseq,
                      smoker.sub$smoke_status)

# GENERATE A BINARY TREATMENT VARIABLE
trt &lt;- as.numeric(unique(smoker.sub[, c("SubjectID","varenicline")])[, 2])-1

# GENERATE A VECTOR OF UNIQUE TIME POINTS
t.seq &lt;- sort(unique(smoker.sub$timeseq))

# COMPUTE TIME VARYING MEDIATION ANALYSIS USING BOOTSTRAPPED CONFIDENCE INTERVALS
results &lt;- tvmb(trt, t.seq, mediator, outcome)
## End(Not run)

</code></pre>

<hr>
<h2 id='tvmcurve_3trt'>Main function for time varying mediation function for continuous outcome and three 
treatment arms (i.e., exposure groups).</h2><span id='topic+tvmcurve_3trt'></span>

<h3>Description</h3>

<p>Part of the set of internal functions to estimate the time-varying mediation effect and 
bootstrap standard errors for three treatment groups and continuous outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvmcurve_3trt(T1, T2, t.seq, x, y, t.est)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tvmcurve_3trt_+3A_t1">T1</code></td>
<td>
<p>a vector indicating assignment to treatment 1</p>
</td></tr>
<tr><td><code id="tvmcurve_3trt_+3A_t2">T2</code></td>
<td>
<p>a vector indicating assignment to treatment 2</p>
</td></tr>
<tr><td><code id="tvmcurve_3trt_+3A_t.seq">t.seq</code></td>
<td>
<p>a vector of time points for each observation</p>
</td></tr>
<tr><td><code id="tvmcurve_3trt_+3A_x">x</code></td>
<td>
<p>matrix of mediator values in wide format</p>
</td></tr>
<tr><td><code id="tvmcurve_3trt_+3A_y">y</code></td>
<td>
<p>matrix of outcome values in wide format</p>
</td></tr>
<tr><td><code id="tvmcurve_3trt_+3A_t.est">t.est</code></td>
<td>
<p>time points at which to make the estimation. Default = t.seq</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>hat.alpha1</code></td>
<td>
<p>estimated Treatment 1 effect on mediator</p>
</td></tr>
<tr><td><code>hat.alpha2</code></td>
<td>
<p>estimated Treatment 2 effect on mediator</p>
</td></tr>
<tr><td><code>hat.gamma1</code></td>
<td>
<p>estimated Treatment 1 direct effect on outcome</p>
</td></tr>
<tr><td><code>hat.gamma2</code></td>
<td>
<p>estimated Treatment 2 direct effect on outcome</p>
</td></tr>
<tr><td><code>hat.tau1</code></td>
<td>
<p>estimated Treatment 1 total effect on outcome</p>
</td></tr>
<tr><td><code>hat.tau2</code></td>
<td>
<p>estimated Treatment 2 total effect on outcome</p>
</td></tr>
<tr><td><code>hat.beta</code></td>
<td>
<p>estimated mediator effect on outcome</p>
</td></tr>
<tr><td><code>hat.mediation1</code></td>
<td>
<p>time varying mediation effect for Treatment 1 on outcome</p>
</td></tr>
<tr><td><code>hat.mediation2</code></td>
<td>
<p>time varying mediation effect for Treatment 2 on outcome</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
