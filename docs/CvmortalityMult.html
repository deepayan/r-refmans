<!DOCTYPE html><html><head><title>Help for package CvmortalityMult</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CvmortalityMult}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fit_additive.LC.multi'><p>FUNCTION TO FIT ADDITIVE MULTI-POPULATION MORTALITY MODEL</p></a></li>
<li><a href='#fit_multiplicative.LC.multi'><p>FUNCTION TO FIT MULTIPLICATIVE MULTI-POPULATION MORTALITY MODEL</p></a></li>
<li><a href='#for_additive.LC.multi'><p>FUNCTION TO FORECAST ADDITIVE MULTI-POPULATION MORTALITY MODEL</p></a></li>
<li><a href='#for_multiplicative.LC.multi'><p>FUNCTION TO FORECAST MULTIPLICATIVE MULTI-POPULATION MORTALITY MODEL</p></a></li>
<li><a href='#MAE'><p>MEAN ABSOLUTE ERRORS (MAE)</p></a></li>
<li><a href='#MAPE'><p>MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)</p></a></li>
<li><a href='#MSE'><p>MEAN SQUARED ERRORS (MSE)</p></a></li>
<li><a href='#multipopulation_cv'><p>FUNCTION TO APPLY CROSS-VALIDATION TECHNIQUES FOR TESTING THE FORECASTING ACCURACY</p>
OF MULTI-POPULATION MORTALITY MODELS</a></li>
<li><a href='#multipopulation_loocv'><p>FUNCTION TO APPLY LEAVE-ONE-OUT CROSS-VALIDATION TECHNIQUE FOR TESTING THE FORECASTING ACCURACY</p>
OF MULTI-POPULATION MORTALITY MODELS</a></li>
<li><a href='#plotLC.multi'><p>FUNCTION TO PLOT MULTI-POPULATION MORTALITY MODEL</p></a></li>
<li><a href='#regions'><p>regions</p></a></li>
<li><a href='#SpainMap'><p>Spain National map information</p></a></li>
<li><a href='#SpainNat'><p>Spain National Mortality data</p></a></li>
<li><a href='#SpainRegions'><p>Spain Regions Mortality data</p></a></li>
<li><a href='#SSE'><p>SUM of SQUARED ERRORS (SSE)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cross-Validation for Multi-Population Mortality Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-20</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of cross-validation method for testing the forecasting accuracy of several multi-population mortality models. The family of multi-population includes several multi-population mortality models proposed through the actuarial and demography literature. The package includes functions for fitting and forecast the mortality rates of several populations. Additionally, we include functions for testing the forecasting accuracy of different multi-population models.
  References.
  Atance, D., Debon, A., and Navarro, E. (2020) &lt;<a href="https://doi.org/10.3390%2Fmath8091550">doi:10.3390/math8091550</a>&gt;.
  Bergmeir, C. &amp; Benitez, J.M. (2012) &lt;<a href="https://doi.org/10.1016%2Fj.ins.2011.12.028">doi:10.1016/j.ins.2011.12.028</a>&gt;.
  Debon, A., Montes, F., &amp; Martinez-Ruiz, F. (2011) &lt;<a href="https://doi.org/10.1007%2Fs13385-011-0043-z">doi:10.1007/s13385-011-0043-z</a>&gt;.
  Lee, R.D. &amp; Carter, L.R. (1992) &lt;<a href="https://doi.org/10.1080%2F01621459.1992.10475265">doi:10.1080/01621459.1992.10475265</a>&gt;.
  Russolillo, M., Giordano, G., &amp; Haberman, S. (2011) &lt;<a href="https://doi.org/10.1080%2F03461231003611933">doi:10.1080/03461231003611933</a>&gt;.
  Santolino, M. (2023) &lt;<a href="https://doi.org/10.3390%2Frisks11100170">doi:10.3390/risks11100170</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/davidAtance/CvmortalityMult">https://github.com/davidAtance/CvmortalityMult</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/davidAtance/CvmortalityMult/issues">https://github.com/davidAtance/CvmortalityMult/issues</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.50)</td>
</tr>
<tr>
<td>Imports:</td>
<td>StMoMo, forecast, gnm, tmap, sf</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-26 19:43:40 UTC; david</td>
</tr>
<tr>
<td>Author:</td>
<td>David Atance <a href="https://orcid.org/0000-0001-5860-0584"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Ana Debón <a href="https://orcid.org/0000-0002-5116-289X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Atance &lt;david.atance@uah.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-27 09:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='fit_additive.LC.multi'>FUNCTION TO FIT ADDITIVE MULTI-POPULATION MORTALITY MODEL</h2><span id='topic+fit_additive.LC.multi'></span>

<h3>Description</h3>

<p>R function for fitting additive multi-population mortality model developed by: Debon et al. (2011).
This model follows the structure of the well-known Lee-Carter model (Lee and Carter, 1992) but including an additive parameter to capture the behavior of each population considered.
This parameter seeks to capture the individual behavior of every population considered.
It should be mentioned that in case that this function is developed for fitting several populations.
However, in case you only consider one population, the function will fit the one-population Lee-Carter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_additive.LC.multi(qxt, periods, ages, nPop, lxt = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_additive.LC.multi_+3A_qxt">qxt</code></td>
<td>
<p>mortality rates used to fit the additive multipopulation mortality model. This rates can be provided in matrix or in data.frame.</p>
</td></tr>
<tr><td><code id="fit_additive.LC.multi_+3A_periods">periods</code></td>
<td>
<p>periods considered in the fitting in a vector way c(minyear:maxyear).</p>
</td></tr>
<tr><td><code id="fit_additive.LC.multi_+3A_ages">ages</code></td>
<td>
<p>vector with the ages considered in the fitting. If the mortality rates provide from an abridged life tables, it is necessary to provide a vector with the ages, see the example.</p>
</td></tr>
<tr><td><code id="fit_additive.LC.multi_+3A_npop">nPop</code></td>
<td>
<p>number of population considered for fitting.</p>
</td></tr>
<tr><td><code id="fit_additive.LC.multi_+3A_lxt">lxt</code></td>
<td>
<p>survivor function considered for every population, not necessary to provide.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the fitting process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>kt</code> represent the national tendency of multi-mortality populations during the period.
</p>
</li>
<li> <p><code>Ii</code> gives an idea of the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code> additive multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>data.used</code> mortality rates used to fit the data.
</p>
</li>
<li> <p><code>qxt.real</code> real mortality rates.
</p>
</li>
<li> <p><code>qxt.fitted</code> fitted mortality rates using the additive  multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.fitted</code> fitted mortality rates in logit way.
</p>
</li>
<li> <p><code>Ages</code> provided ages to fit the data.
</p>
</li>
<li> <p><code>Periods</code> provided periods to fit the periods.
</p>
</li>
<li> <p><code>nPop</code> provided number of populations to fit the periods.
</p>
</li></ul>



<h3>References</h3>

<p>Debon, A., Montes, F., and Martinez-Ruiz, F. (2011).
Statistical methods to compare mortality for a group with non-divergent populations: an application to Spanish regions.
European Actuarial Journal, 1, 291-308.
</p>
<p>Lee, R.D. and Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>, <code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>,
<code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>, <code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,
<code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>, <code><a href="#topic+plotLC.multi">plotLC.multi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#The data that we are going to use:
SpainRegions
library(gnm)
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
additive_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)
#Once, we have fit the data, it is possible to see the ax, bx, kt, and Ii
#provided parameters for the fitting.
plotLC.multi(additive_Spainmales)

#As we mentioned in the details of the function, if we only provide the data
#from one-population the function fit_additive.LC.multi()
#will fit the Lee-Carter model for single populations.
LC_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainNat$qx_male,
                              periods = c(1991:2020),
                              ages = ages,
                              nPop = 1)
plotLC.multi(LC_Spainmales)

</code></pre>

<hr>
<h2 id='fit_multiplicative.LC.multi'>FUNCTION TO FIT MULTIPLICATIVE MULTI-POPULATION MORTALITY MODEL</h2><span id='topic+fit_multiplicative.LC.multi'></span>

<h3>Description</h3>

<p>R function for fitting multiplicative multi-population mortality model developed by: Russolillo et al. (2011).
This model follows the structure of the well-known Lee-Carter model (Lee and Carter, 1992) but including a multiplicative parameter to capture the behavior of each population considered.
This parameter seeks to capture the individual behavior of every population considered.
It should be mentioned that in case that this function is developed for fitting several populations.
However, in case you only consider one population, the function will fit the one-population Lee-Carter model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_multiplicative.LC.multi(qxt, periods, ages, nPop, lxt = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_multiplicative.LC.multi_+3A_qxt">qxt</code></td>
<td>
<p>mortality rates used to fit the additive multipopulation mortality model. This rates can be provided in matrix or in data.frame.</p>
</td></tr>
<tr><td><code id="fit_multiplicative.LC.multi_+3A_periods">periods</code></td>
<td>
<p>periods considered in the fitting in a vector way c(minyear:maxyear).</p>
</td></tr>
<tr><td><code id="fit_multiplicative.LC.multi_+3A_ages">ages</code></td>
<td>
<p>vector with the ages considered in the fitting. If the mortality rates provide from an abridged life tables, it is required to provide a vector with the ages, see the example.</p>
</td></tr>
<tr><td><code id="fit_multiplicative.LC.multi_+3A_npop">nPop</code></td>
<td>
<p>number of population considered for fitting.</p>
</td></tr>
<tr><td><code id="fit_multiplicative.LC.multi_+3A_lxt">lxt</code></td>
<td>
<p>survivor function considered for every population, not necessary to provide.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the fitting process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>kt</code> represent the national tendency of multi-mortality populations during the period.
</p>
</li>
<li> <p><code>Ii</code>  gives an idea of the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code>  additive multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>data.used</code>  mortality rates used to fit the data.
</p>
</li>
<li> <p><code>qxt.real</code>  real mortality rates.
</p>
</li>
<li> <p><code>qxt.fitted</code>  fitted mortality rates using the additive  multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.fitted</code>  fitted mortality rates in logit way.
</p>
</li>
<li> <p><code>Ages</code>  provided ages to fit the data.
</p>
</li>
<li> <p><code>Periods</code>  provided periods to fit the periods.
</p>
</li>
<li> <p><code>nPop</code>  provided number of populations to fit the periods.
</p>
</li></ul>



<h3>References</h3>

<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>
<p>Russolillo, M., Giordano, G., &amp; Haberman, S. (2011).
Extending the Lee–Carter model: a three-way decomposition.
Scandinavian Actuarial Journal, 2011(2), 96-117.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>,
<code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>, <code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,
<code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#The data that we are going to use:
SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
library(gnm)
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have fit the data, it is possible to see the ax, bx, kt, and It
#provided parameters for the fitting.
plotLC.multi(multiplicative_Spainmales)

#As we mentioned in the details of the function, if we only provide the data
#from one-population the function fit_multiplicative.LC.multi()
#will fit the Lee-Carter model for single populations.
LC_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainNat$qx_male,
                              periods = c(1991:2020),
                              ages = ages,
                              nPop = 1)
plotLC.multi(LC_Spainmales)


</code></pre>

<hr>
<h2 id='for_additive.LC.multi'>FUNCTION TO FORECAST ADDITIVE MULTI-POPULATION MORTALITY MODEL</h2><span id='topic+for_additive.LC.multi'></span>

<h3>Description</h3>

<p>R function for forecasting additive multi-population mortality model developed by: Debon et al (2011).
This model follows the structure of the well-known Lee-Carter model (Lee and Carter, 1992) but including an additive parameter to capture the behavior of each population considered.
This parameter seeks to capture the individual behavior of every population considered.
It should be mentioned that in case that this function is developed for forecasting several populations.
However, in case you only consider one population, the function will forecast the Lee-Carter model for one population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>for_additive.LC.multi(
  fitted.obj,
  nahead,
  ktmethod = c("Arimapdq", "arima010"),
  kt_include.cte = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="for_additive.LC.multi_+3A_fitted.obj">fitted.obj</code></td>
<td>
<p>object developed using function <code>fit_additive.LC.multi()</code>.</p>
</td></tr>
<tr><td><code id="for_additive.LC.multi_+3A_nahead">nahead</code></td>
<td>
<p>number of periods ahead to forecast.</p>
</td></tr>
<tr><td><code id="for_additive.LC.multi_+3A_ktmethod">ktmethod</code></td>
<td>
<p>method used to forecast the value of <code>kt</code> Arima(p,d,q) or ARIMA(0,1,0); c(&quot;<code>Arimapdq</code>&quot;, &quot;<code>arima010</code>&quot;).</p>
</td></tr>
<tr><td><code id="for_additive.LC.multi_+3A_kt_include.cte">kt_include.cte</code></td>
<td>
<p>if you want that <code>kt</code> include constant in the arima process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the forecasting process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>arimakt</code> the arima selected for the <code>kt</code> time series.
</p>
</li>
<li> <p><code>kt.fitted</code> obtained values for the tendency behavior captured by <code>kt</code>.
</p>
</li>
<li> <p><code>kt.fut</code> projected values of <code>kt</code> for the nahead periods ahead.
</p>
</li>
<li> <p><code>kt.futintervals</code> arima selected and future values of <code>kt</code> with the different intervals, lower and upper, 80\
</p>
</li>
<li> <p><code>Ii</code> parameter that captures the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code> additive multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>qxt.real</code> real mortality rates.
</p>
</li>
<li> <p><code>qxt.fitted</code> fitted mortality rates using the additive multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.fitted</code> fitted mortality rates in logit way estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>qxt.future</code> future mortality rates estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.future</code> future mortality rates in logit way estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>nPop</code> provided number of populations to fit the periods.
</p>
</li></ul>



<h3>References</h3>

<p>Debon, A., Montes, F., &amp; Martinez-Ruiz, F. (2011).
Statistical methods to compare mortality for a group with non-divergent populations: an application to Spanish regions.
European Actuarial Journal, 1, 291-308.
</p>
<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>, <code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#First, we present the data that we are going to use
SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#Before forecast the future value of the mortality rates for different populations
#we need the object the fitted values of the additive multi-population mortality model.
library(gnm)
additive_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainRegions$qx_male,
                                             periods = c(1991:2020),
                                             ages = c(ages),
                                             nPop = 18,
                                             lxt = SpainRegions$lx_male)
#Once, we have fit the data, it is possible to forecast 10 years ahead
#in this case for the additive multi-population mortality model
fut_additive_Spainmales &lt;- for_additive.LC.multi(fitted.obj = additive_Spainmales, nahead = 10,
                                                 ktmethod = "Arimapdq", kt_include.cte = TRUE)

#As we mentioned in the details of the function, if we only provide the data
#from one-population the function fit_additive.LC.multi()
#will fit the Lee-Carter model for single populations.
LC_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainNat$qx_male,
                              periods = c(1991:2020),
                              ages = ages,
                              nPop = 1)
#To forecast future values of the single population using LC
fut_LC_Spainmales &lt;- for_additive.LC.multi(fitted.obj = LC_Spainmales,
                                           nahead = 10, ktmethod = "Arimapdq",
                                           kt_include.cte = TRUE)

</code></pre>

<hr>
<h2 id='for_multiplicative.LC.multi'>FUNCTION TO FORECAST MULTIPLICATIVE MULTI-POPULATION MORTALITY MODEL</h2><span id='topic+for_multiplicative.LC.multi'></span>

<h3>Description</h3>

<p>R function for forecasting multiplicative multi-population mortality model developed by: Russolillo et al (2011).
This model follows the structure of the well-known Lee-Carter model (Lee and Carter, 1992) but including a multiplicative parameter to capture the behavior of each population considered.
This parameter seeks to capture the individual behavior of every population considered.
It should be mentioned that in case that this function is developed for forecasting several populations.
However, in case you only consider one population, the function will forecast the Lee-Carter model for one population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>for_multiplicative.LC.multi(
  fitted.obj,
  nahead,
  ktmethod = c("Arimapdq", "arima010"),
  kt_include.cte = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="for_multiplicative.LC.multi_+3A_fitted.obj">fitted.obj</code></td>
<td>
<p>object developed using function <code>fit_mutliplicative.LC.multi()</code></p>
</td></tr>
<tr><td><code id="for_multiplicative.LC.multi_+3A_nahead">nahead</code></td>
<td>
<p>number of periods ahead to forecast</p>
</td></tr>
<tr><td><code id="for_multiplicative.LC.multi_+3A_ktmethod">ktmethod</code></td>
<td>
<p>method used to forecast the value of kt Arima(p,d,q) or ARIMA(0,1,0); c(&quot;<code>Arimapdq</code>&quot;, &quot;<code>arima010</code>&quot;).</p>
</td></tr>
<tr><td><code id="for_multiplicative.LC.multi_+3A_kt_include.cte">kt_include.cte</code></td>
<td>
<p>if you want that kt include constant in the arima process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the forecasting process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>arimakt</code> the arima selected for the <code>kt</code> time series.
</p>
</li>
<li> <p><code>kt.fitted</code> obtained values for the tendency behavior captured by <code>kt</code>.
</p>
</li>
<li> <p><code>kt.fut</code> projected values of <code>kt</code> for the nahead periods ahead.
</p>
</li>
<li> <p><code>kt.futintervals</code> arima selected and future values of <code>kt</code> with the different intervals, lower and upper, 80\
</p>
</li>
<li> <p><code>Ii</code> gives an idea of the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code> additive multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>qxt.real</code> real mortality rates.
</p>
</li>
<li> <p><code>qxt.fitted</code> fitted mortality rates using the additive multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.fitted</code> fitted mortality rates in logit way estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>qxt.future</code> future mortality rates estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.future</code> future mortality rates in logit way estimated with the additive multi-population mortality model.
</p>
</li>
<li> <p><code>nPop</code> provided number of populations to fit the periods.
</p>
</li></ul>



<h3>References</h3>

<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>
<p>Russolillo, M., Giordano, G., &amp; Haberman, S. (2011).
Extending the Lee–Carter model: a three-way decomposition.
Scandinavian Actuarial Journal, 2011(2), 96-117.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest


#First, we present the data that we are going to use
SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)

#Before forecast the future value of the mortality rates for different populations
#we need the object the fitted values of the multiplicative multi-population mortality model.
library(gnm)
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                                             periods = c(1991:2020),
                                             ages = c(ages),
                                             nPop = 18,
                                             lxt = SpainRegions$lx_male)
#Once, we have fit the data, it is possible to forecast 10 years ahead
#in this case for the multiplicative multi-population mortality model
fut_multiplicative_Spainmales &lt;- for_multiplicative.LC.multi(
                  fitted.obj = multiplicative_Spainmales,
                  nahead = 10,
                  ktmethod = "Arimapdq",
                  kt_include.cte = TRUE)

#As we mentioned in the details of the function, if we only provide the data
#from one-population the function fit_additive.LC.multi()
#will fit the Lee-Carter model for single populations.
LC_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainNat$qx_male,
                              periods = c(1991:2020),
                              ages = ages,
                              nPop = 1)
#To forecast future values of the single population using LC
fut_LC_Spainmales &lt;- for_multiplicative.LC.multi(fitted.obj = LC_Spainmales,
                                           nahead = 10, ktmethod = "Arimapdq",
                                           kt_include.cte = TRUE)

</code></pre>

<hr>
<h2 id='MAE'>MEAN ABSOLUTE ERRORS (MAE)</h2><span id='topic+MAE'></span>

<h3>Description</h3>

<p>R function to estimate the mean absolute errors (MAE) for the mortality rates;
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sum_{x} \sum_{t} \left| qx1 - qxt2 \right|</code>
</p>
<p>.
where qxt1 is the real mortality rates <code>qxt_re</code>, and qxt2 is the adjusted mortality rates <code>qxt_aju</code>.
You only have to provide the real value and the fitted or forecasted value for your mortality rates.
However, the function is constructed to provide the real value and the fitted or forecasted value of your independent variable.
These variables must have the same dimensions to be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAE(qxt_re, qxt_aju, wxt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAE_+3A_qxt_re">qxt_re</code></td>
<td>
<p>real mortality rates used to check the goodness of fit measure.</p>
</td></tr>
<tr><td><code id="MAE_+3A_qxt_aju">qxt_aju</code></td>
<td>
<p>adjusted mortality rates using a specific mode.</p>
</td></tr>
<tr><td><code id="MAE_+3A_wxt">wxt</code></td>
<td>
<p>weights of the mortality rates or data provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of MAE for the data provided.
</p>


<h3>References</h3>

<p>Atance, D., Debón, A., &amp; Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics, 8(9), 1550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+SSE">SSE</a></code>, <code><a href="#topic+MSE">MSE</a></code>, <code><a href="#topic+MAPE">MAPE</a></code>,
<code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>, <code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#To show how the function works, we need to provide fitted or forecasted data and the real data.
#In this case, we employ the following data of the library:
SpainRegions
library(gnm)
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have the fitted data, we will obtain the SSE for the first population.
#We need to obtain wxt (weight of the mortality rates or data provided) using a
library(StMoMo)
wxt_1pob &lt;- genWeightMat(ages = ages, years = c(1991:2020), clip = 0)
MAE(qxt_re = multiplicative_Spainmales$qxt.real$pob1,
    qxt_aju = multiplicative_Spainmales$qxt.fitted$pob1,
    wxt = wxt_1pob)

</code></pre>

<hr>
<h2 id='MAPE'>MEAN ABSOLUTE PERCENTAGE ERROR (MAPE)</h2><span id='topic+MAPE'></span>

<h3>Description</h3>

<p>R function to estimate the mean absolute percentage error (MAPE) for the mortality rates:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sum_{x} \sum_{t}\left| \frac{\left(qxt1 - qxt2\right) }{qxt2} \right|</code>
</p>

<p>where qxt1 is the real mortality rates <code>qxt_re</code>, and qxt2 is the adjusted mortality rates <code>qxt_aju</code>.
You only have to provide the real value and the fitted or forecasted value for your mortality rates.
However, the function is constructed to provide the real value and the fitted or forecasted value of your independent variable.
These variables must have the same dimensions to be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MAPE(qxt_re, qxt_aju, wxt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MAPE_+3A_qxt_re">qxt_re</code></td>
<td>
<p>real mortality rates used to check the goodness of fit measure.</p>
</td></tr>
<tr><td><code id="MAPE_+3A_qxt_aju">qxt_aju</code></td>
<td>
<p>adjusted mortality rates using a specific mode.</p>
</td></tr>
<tr><td><code id="MAPE_+3A_wxt">wxt</code></td>
<td>
<p>weights of the mortality rates or data provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of MAPE for the data provided.
</p>


<h3>References</h3>

<p>Atance, D., Debón, A., &amp; Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics, 8(9), 1550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+MAE">MAE</a></code>, <code><a href="#topic+MSE">MSE</a></code>, <code><a href="#topic+SSE">SSE</a></code>,
<code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,<code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#To show how the function works, we need to provide fitted or forecasted data and the real data.
#In this case, we employ the following data of the library:
SpainRegions
library(gnm)
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have the fitted data, we will obtain the SSE for the first population.
#We need to obtain wxt (weight of the mortality rates or data provided) using a
library(StMoMo)
wxt_1pob &lt;- genWeightMat(ages = ages, years = c(1991:2020), clip = 0)
MAPE(qxt_re = multiplicative_Spainmales$qxt.real$pob1,
     qxt_aju = multiplicative_Spainmales$qxt.fitted$pob1,
     wxt = wxt_1pob)

</code></pre>

<hr>
<h2 id='MSE'>MEAN SQUARED ERRORS (MSE)</h2><span id='topic+MSE'></span>

<h3>Description</h3>

<p>R function to estimate the mean squared errors (MSE) for the mortality rates:
</p>
<p style="text-align: center;"><code class="reqn">\frac{1}{n}\sum_{x} \sum_{t} \left( qxt1 - qxt2 \right)^2 = \frac{1}{n} SSE</code>
</p>

<p>where qxt1 is the real mortality rates <code>qxt_re</code>, and qxt2 is the adjusted mortality rates <code>qxt_aju</code>.
You only have to provide the real value and the fitted or forecasted value for your mortality rates.
However, the function is constructed to provide the real value and the fitted or forecasted value of your independent variable.
These variables must have the same dimensions to be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MSE(qxt_re, qxt_aju, wxt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MSE_+3A_qxt_re">qxt_re</code></td>
<td>
<p>real mortality rates used to check the goodness of fit measure.</p>
</td></tr>
<tr><td><code id="MSE_+3A_qxt_aju">qxt_aju</code></td>
<td>
<p>adjusted mortality rates using a specific mode.</p>
</td></tr>
<tr><td><code id="MSE_+3A_wxt">wxt</code></td>
<td>
<p>weights of the mortality rates or data provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of MSE for the data provided.
</p>


<h3>References</h3>

<p>Atance, D., Debón, A., &amp; Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics, 8(9), 1550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+MAE">MAE</a></code>, <code><a href="#topic+SSE">SSE</a></code>, <code><a href="#topic+MAPE">MAPE</a></code>,
<code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>,  <code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#To show how the function works, we need to provide fitted or forecasted data and the real data.
#In this case, we employ the following data of the library:
SpainRegions
library(gnm)
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have the fitted data, we will obtain the SSE for the first population.
#We need to obtain wxt (weight of the mortality rates or data provided) using a
library(StMoMo)
wxt_1pob &lt;- genWeightMat(ages = ages, years = c(1991:2020), clip = 0)
MSE(qxt_re = multiplicative_Spainmales$qxt.real$pob1,
    qxt_aju = multiplicative_Spainmales$qxt.fitted$pob1,
    wxt = wxt_1pob)

</code></pre>

<hr>
<h2 id='multipopulation_cv'>FUNCTION TO APPLY CROSS-VALIDATION TECHNIQUES FOR TESTING THE FORECASTING ACCURACY
OF MULTI-POPULATION MORTALITY MODELS</h2><span id='topic+multipopulation_cv'></span>

<h3>Description</h3>

<p>R function for testing the accuracy out-of-sample of different multi-population mortality models, Additive (Debon et al., 2011) and Multiplicative (Russolillo et al., 2011).
We provide a R function that employ the cross-validation techniques for data panel-time series (Atance et al. 2020) to test the forecasting accuracy.
These techniques consist on split the database in two parts: training set (to run the model) and test set (to check the forecasting accuracy of the model).
This procedure is repeated several times trying to check the forecasting accuracy in different ways.
With this function, the user can provide its own mortality rates for different populations. The function will split the database chronologically (Bergmeir and Benitez, 2012) based on the nahead which consist on the length of the training set.
We have include the following Figure 1 to understand how the R function works.
<img src="../help/figures/CVtechnique.jpg" width="100%" alt="Figure: mai.png" />
It should be mentioned that this function is developed for cross-validation the forecasting accuracy of several populations.
However, in case you only consider one population, the function will forecast the Lee-Carter model for one population.
To test the forecasting accuracy of the selected model, the function provides five different measures: SSE, MSE, MAE, MAPE or All. Depending on how you want to check the forecasting accuracy of the model you could select one or other.
In this case, the measures will be obtained using the mortality rates in the normal scale as recommended by Santolino (2023) against the log scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multipopulation_cv(
  qxt,
  model = c("additive", "multiplicative"),
  periods,
  ages,
  nPop,
  lxt = NULL,
  nahead,
  ktmethod = c("Arimapdq", "arima010"),
  kt_include.cte = TRUE,
  measures = c("SSE", "MSE", "MAE", "MAPE", "All")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multipopulation_cv_+3A_qxt">qxt</code></td>
<td>
<p>mortality rates used to fit the multi-population mortality models. This rates can be provided in matrix or in data.frame.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_model">model</code></td>
<td>
<p>choose the multi-population mortality model to fit the mortality rates c(&quot;<code>additive</code>&quot;, &quot;<code>multiplicative</code>&quot;)</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_periods">periods</code></td>
<td>
<p>periods considered in the fitting in a vector way c(<code>minyear</code>:<code>maxyear</code>).</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_ages">ages</code></td>
<td>
<p>vector with the ages considered in the fitting. If the mortality rates provide from an abridged life tables, it is necessary to provide a vector with the ages, see the example.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_npop">nPop</code></td>
<td>
<p>number of population considered for fitting.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_lxt">lxt</code></td>
<td>
<p>survivor function considered for every population, not necessary to provide.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_nahead">nahead</code></td>
<td>
<p>is a vector specifying the number of periods to block in the blocked CV. The function operates by using the sum of the periods in nahead and three (the minimum number of years required to construct a time series), as the initial training set. This ensures that the first train set has sufficient observations to forecast the initial test set, which will be of length <code>nahead</code>.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_ktmethod">ktmethod</code></td>
<td>
<p>method used to forecast the value of <code>kt</code> Arima(p,d,q) or ARIMA(0,1,0); c(&quot;<code>Arimapdq</code>&quot;, &quot;<code>arima010</code>&quot;).</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_kt_include.cte">kt_include.cte</code></td>
<td>
<p>if you want that <code>kt</code> include constant in the arima process.</p>
</td></tr>
<tr><td><code id="multipopulation_cv_+3A_measures">measures</code></td>
<td>
<p>choose the non-penalized measure of forecasting accuracy that you want to use; c(&quot;<code>SSE</code>&quot;, &quot;<code>MSE</code>&quot;, &quot;<code>MAE</code>&quot;, &quot;<code>MAPE</code>&quot;, &quot;<code>All</code>&quot;). Check the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the cross-validation process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>kt.fitted</code> obtained values for the tendency behavior captured by <code>kt</code> .
</p>
</li>
<li> <p><code>kt.future</code> future values of <code>kt</code> for every iteration in the cross-validation.
</p>
</li>
<li> <p><code>kt.arima</code>  the arima selected for each <code>kt</code> time series.
</p>
</li>
<li> <p><code>Ii</code> parameter that captures the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code> multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>nPop</code> provided number of populations to fit the periods.
</p>
</li>
<li> <p><code>qxt.real</code> real mortality rates.
</p>
</li>
<li> <p><code>qxt.future</code> future mortality rates estimated with the multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.future</code> future mortality rates in logit way estimated with the multi-population mortality model.
</p>
</li>
<li> <p><code>meas_ages</code> measure of forecasting accuracy through the ages of the study.
</p>
</li>
<li> <p><code>meas_periodsfut</code> measure of forecasting accuracy in every forecasting period(s) of the study.
</p>
</li>
<li> <p><code>meas_pop</code> measure of forecasting accuracy through the populations considered in the study.
</p>
</li>
<li> <p><code>meas_total</code> a global measure of forecasting accuracy through the ages, periods and populations of the study.
</p>
</li></ul>



<h3>References</h3>

<p>Atance, D., Debon, A., and Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics 8(9): 1550.
</p>
<p>Bergmeir, C. &amp; Benitez, J.M. (2012)
On the use of cross-validation for time series predictor evaluation.
Information Sciences, 191, 192–213.
</p>
<p>Debon, A., &amp; Atance, D. (2022).
Two multi-population mortality models: A comparison of the forecasting accuracy with resampling methods.
in Contributions to Risk Analysis: Risk 2022. Fundacion Mapfre
</p>
<p>Debon, A., Montes, F., &amp; Martinez-Ruiz, F. (2011).
Statistical methods to compare mortality for a group with non-divergent populations: an application to Spanish regions.
European Actuarial Journal, 1, 291-308.
</p>
<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>
<p>Russolillo, M., Giordano, G., &amp; Haberman, S. (2011).
Extending the Lee–Carter model: a three-way decomposition.
Scandinavian Actuarial Journal, 96-117.
</p>
<p>Santolino, M. (2023).
Should Selection of the Optimum Stochastic Mortality Model Be Based on the Original or the Logarithmic Scale of the Mortality Rate?.
Risks, 11(10), 170.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>, <code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+plotLC.multi">plotLC.multi</a></code>, <code><a href="#topic+SSE">SSE</a></code>, <code><a href="#topic+MAE">MAE</a></code>, <code><a href="#topic+MAPE">MAPE</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#We present a cross-validation method for spanish male regions

ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40,
         45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
library(gnm)
#Let start with a simple nahead=5 CV method obtaining the SSE forecasting measure of accuracy
cv_Spainmales_addit &lt;- multipopulation_cv(qxt = SpainRegions$qx_male,
                                         model = c("additive"),
                                         periods =  c(1991:2020), ages = c(ages),
                                         nPop = 18, lxt = SpainRegions$lx_male,
                                         nahead = 5,
                                         ktmethod = c("Arimapdq"),
                                         kt_include.cte = TRUE,
                                         measures = c("SSE"))

#Once, we have run the function we can check the result in different ways:
cv_Spainmales_addit$meas_ages
cv_Spainmales_addit$meas_periodsfut
cv_Spainmales_addit$meas_pop
cv_Spainmales_addit$meas_total

</code></pre>

<hr>
<h2 id='multipopulation_loocv'>FUNCTION TO APPLY LEAVE-ONE-OUT CROSS-VALIDATION TECHNIQUE FOR TESTING THE FORECASTING ACCURACY
OF MULTI-POPULATION MORTALITY MODELS</h2><span id='topic+multipopulation_loocv'></span>

<h3>Description</h3>

<p>R function for testing the accuracy out-of-sample of different multi-population mortality models, Additive (Debon et al., 2011) and Multiplicative (Russolillo et al., 2011).
We provide a R function that employ the leave-one-out cross-validation technique for data panel-time series (Atance et al. 2020) to test the forecasting accuracy of one-multipopulation mortality model.
This technique consists on split the database in two parts: training set (to run the model) and test set (to check the forecasting accuracy of the model) with only one data (one period in this case).
This procedure is repeated several times trying to check the forecasting accuracy in different ways enlarging the training set one period-ahead.
With this function, the user can provide its own mortality rates for different populations. The function will split the database chronologically (Bergmeir and Benitez, 2012) based on the trainset1 which consist on the length of the first training set.
We have include the following Figure 2 to understand how the R function works.
<img src="../help/figures/LOOCV.jpg" width="100%" alt="Figure: mai.png" />
It should be mentioned that this function is developed for testing the the forecasting accuracy of several populations using leave-one-out cross-validation .
However, in case you only consider one population, the function will forecast the Lee-Carter model for one population.
To test the forecasting accuracy of the selected model, the function provides five different measures: SSE, MSE, MAE, MAPE or All. Depending on how you want to check the forecasting accuracy of the model you could select one or other.
In this case, the measures will be obtained using the mortality rates in the normal scale as recommended by Santolino (2023) against the log scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multipopulation_loocv(
  qxt,
  model = c("additive", "multiplicative"),
  periods,
  ages,
  nPop,
  lxt = NULL,
  ktmethod = c("Arimapdq", "arima010"),
  kt_include.cte = TRUE,
  measures = c("SSE", "MSE", "MAE", "MAPE", "All"),
  trainset1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multipopulation_loocv_+3A_qxt">qxt</code></td>
<td>
<p>mortality rates used to fit the multi-population mortality models. This rates can be provided in matrix or in data.frame.</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_model">model</code></td>
<td>
<p>choose the multi-population mortality model to fit the mortality rates c(&quot;<code>additive</code>&quot;, &quot;<code>multiplicative</code>&quot;)</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_periods">periods</code></td>
<td>
<p>periods considered in the fitting in a vector way c(minyear:maxyear).</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_ages">ages</code></td>
<td>
<p>vector with the ages considered in the fitting. If the mortality rates provide from an abridged life tables, it is necessary to provide a vector with the ages, see the example.</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_npop">nPop</code></td>
<td>
<p>number of population considered for fitting.</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_lxt">lxt</code></td>
<td>
<p>survivor function considered for every population, not necessary to provide.</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_ktmethod">ktmethod</code></td>
<td>
<p>method used to forecast the value of <code>kt</code> Arima(p,d,q) or ARIMA(0,1,0); c(&quot;<code>Arimapdq</code>&quot;, &quot;<code>arima010</code>&quot;).</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_kt_include.cte">kt_include.cte</code></td>
<td>
<p>if you want that <code>kt</code> include constant in the arima process.</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_measures">measures</code></td>
<td>
<p>choose the non-penalized measure of forecasting accuracy that you want to use; c(&quot;<code>SSE</code>&quot;, &quot;<code>MSE</code>&quot;, &quot;<code>MAE</code>&quot;, &quot;<code>MAPE</code>&quot;, &quot;<code>All</code>&quot;). Check the function</p>
</td></tr>
<tr><td><code id="multipopulation_loocv_+3A_trainset1">trainset1</code></td>
<td>
<p>vector with the periods for the first training set.  This value must be greater than 2 to meet the minimum time series size (Hyndman and Khandakar, 2008).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with different components of the cross-validation process:
</p>

<ul>
<li> <p><code>ax</code> parameter that captures the average shape of the mortality curve in all considered populations.
</p>
</li>
<li> <p><code>bx</code> parameter that explains the age effect x with respect to the general trend <code>kt</code> in the mortality rates of all considered populations.
</p>
</li>
<li> <p><code>kt.fitted</code> obtained values for the tendency behavior captured by <code>kt</code>.
</p>
</li>
<li> <p><code>kt.future</code> future values of <code>kt</code> for every iteration in the cross-validation.
</p>
</li>
<li> <p><code>kt.arima</code>the arima selected for each <code>kt</code> time series.
</p>
</li>
<li> <p><code>Ii</code> parameter that captures the differences in the pattern of mortality in any region i with respect to Region 1.
</p>
</li>
<li> <p><code>formula</code> multi-population mortality formula used to fit the mortality rates.
</p>
</li>
<li> <p><code>nPop</code> provided number of populations to fit the periods.
</p>
</li>
<li> <p><code>qxt.real</code> real mortality rates.
</p>
</li>
<li> <p><code>qxt.future</code> future mortality rates estimated with the multi-population mortality model.
</p>
</li>
<li> <p><code>logit.qxt.future</code> future mortality rates in logit way estimated with the multi-population mortality model.
</p>
</li>
<li> <p><code>meas_ages</code> measure of forecasting accuracy through the ages of the study.
</p>
</li>
<li> <p><code>meas_periodsfut</code> measure of forecasting accuracy in every forecasting period(s) of the study.
</p>
</li>
<li> <p><code>meas_pop</code> measure of forecasting accuracy through the populations considered in the study.
</p>
</li>
<li> <p><code>meas_total</code> a global measure of forecasting accuracy through the ages, periods and populations of the study.
</p>
</li></ul>



<h3>References</h3>

<p>Atance, D., Debon, A., and Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics 8(9): 1550.
</p>
<p>Bergmeir, C. &amp; Benitez, J.M. (2012)
On the use of cross-validation for time series predictor evaluation.
Information Sciences, 191, 192–213.
</p>
<p>Debon, A., &amp; Atance, D. (2022).
Two multi-population mortality models: A comparison of the forecasting accuracy with resampling methods.
in Contributions to Risk Analysis: Risk 2022. Fundacion Mapfre
</p>
<p>Debon, A., Montes, F., &amp; Martinez-Ruiz, F. (2011).
Statistical methods to compare mortality for a group with non-divergent populations: an application to Spanish regions.
European Actuarial Journal, 1, 291-308.
</p>
<p>Hyndman, R.J. &amp; Khandakar, Y. (2008).
Automatic time series forecasting: The forecast package for R.
Journal of Statistical. Software, 26, 1–22.
</p>
<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>
<p>Russolillo, M., Giordano, G., &amp; Haberman, S. (2011).
Extending the Lee–Carter model: a three-way decomposition.
Scandinavian Actuarial Journal, 96-117.
</p>
<p>Santolino, M. (2023).
Should Selection of the Optimum Stochastic Mortality Model Be Based on the Original or the Logarithmic Scale of the Mortality Rate?.
Risks, 11(10), 170.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>, <code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+plotLC.multi">plotLC.multi</a></code>, <code><a href="#topic+SSE">SSE</a></code>, <code><a href="#topic+MAE">MAE</a></code>, <code><a href="#topic+MAPE">MAPE</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#We present the leave-one-out cross-validation (LOOCV) method for spanish male regions
#The idea is to get the same results as in the short paper published in Risk Congress 2023
SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40,
         45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
library(gnm)
#Let start with a simple trainset1 = 10 CV method obtaining the SSE forecasting measure of accuracy
loocv_Spainmales_addit &lt;- multipopulation_loocv(qxt = SpainRegions$qx_male,
                                         model = c("additive"),
                                         periods =  c(1991:2020), ages = c(ages),
                                         nPop = 18, lxt = SpainRegions$lx_male,
                                         ktmethod = c("Arimapdq"),
                                         kt_include.cte = TRUE,
                                         measures = c("SSE"),
                                         trainset1 = 10)

#Once, we have run the function we can check the result in different ways:
loocv_Spainmales_addit$meas_ages
loocv_Spainmales_addit$meas_periodsfut
loocv_Spainmales_addit$meas_pop
loocv_Spainmales_addit$meas_total

</code></pre>

<hr>
<h2 id='plotLC.multi'>FUNCTION TO PLOT MULTI-POPULATION MORTALITY MODEL</h2><span id='topic+plotLC.multi'></span>

<h3>Description</h3>

<p>R function to plot the parameters for the Additive (Debon et al., 2011) and Multiplicative (Russolillo et al., 2011) Multi-Population mortality model.
It should be mentioned that in case that this function is developed for fitting several populations.
However, in case you only consider one population, the function will fit the one-population Lee-Carter model (Lee and Carter, 1992).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLC.multi(fitted.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLC.multi_+3A_fitted.obj">fitted.obj</code></td>
<td>
<p>object developed using function <code>fit.additive.LC.multi()</code> and <code>fit.multiplicative.LC.multi()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot the different parameters for the multi-population mortality models <code>ax</code>, <code>bx</code>, <code>kt</code> and <code>Ii</code>. This function is valid for both approaches Additive and Multiplicative multi-population mortality models.
</p>


<h3>References</h3>

<p>Debon, A., Montes, F., &amp; Martinez-Ruiz, F. (2011).
Statistical methods to compare mortality for a group with non-divergent populations: an application to Spanish regions.
European Actuarial Journal, 1, 291-308.
</p>
<p>Lee, R.D. &amp; Carter, L.R. (1992).
Modeling and forecasting US mortality.
Journal of the American Statistical Association, 87(419), 659–671.
</p>
<p>Multi-population mortality model developed by:
Russolillo, M., Giordano, G., &amp; Haberman, S. (2011).
Extending the Lee–Carter model: a three-way decomposition.
Scandinavian Actuarial Journal, 2011(2), 96-117.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>, <code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
library(gnm)
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have fit the data, it is possible to see the ax, bx, kt, and Ii
#provided parameters for the fitting.
plotLC.multi(multiplicative_Spainmales)

#In case you only provide one population the model will fit
#the single population version of the Lee-Carter model
LC_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainNat$qx_male,
                              periods = c(1991:2020),
                              ages = ages,
                              nPop = 1)
plotLC.multi(LC_Spainmales)

</code></pre>

<hr>
<h2 id='regions'>regions</h2><span id='topic+regions'></span>

<h3>Description</h3>

<p>Data from the Spanish region of Spain which are provided to plot an indicator.
This dataset contains a plot with the information of Spain regions (geometry and name of every region).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regions
</code></pre>


<h3>Format</h3>

<p>A data frame with 600 rows and 9 columns with the following information
</p>

<ul>
<li> <p><code>Codigo</code> a vector containing the code of every region of Spain.
</p>
</li>
<li> <p><code>Texto</code> a vector containing the name of every region of Spain.
</p>
</li>
<li> <p><code>Texto_Alt</code> a vector containing the long name of every region of Spain.
</p>
</li>
<li> <p><code>Ii</code> a vector containing a possible value of one indicator to be shown.
</p>
</li>
<li> <p><code>geometry</code> the dimension of every region of Spain. This vector allows to plot the regions of Spain.
</p>
</li></ul>



<h3>Value</h3>

<p>a plot with the Spain regions colored by the indicator provided.
</p>


<h3>References</h3>

<p>Spanish National Institute of Statistics (INE) (2023). Tablas de mortalidad, metodologia.
Technical report, Instituto Nacional de Estadistica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#In this case, we show the region dataset applying it to a multipopulation model.
#First, we present the dataset
regions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
library(gnm)
#Then, we fit the multiplicative model
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                                                periods = c(1991:2020),
                                                ages = c(ages),
                                                nPop = 18,
                                                lxt = SpainRegions$lx_male)

#To show the values of the population indicator in the Spanish map.
SpainMap(regionvalue = multiplicative_Spainmales$Ii[2:18],
         main = c("Multiplicative for males"),
         name = c("Ii"))

</code></pre>

<hr>
<h2 id='SpainMap'>Spain National map information</h2><span id='topic+SpainMap'></span>

<h3>Description</h3>

<p>This data contains information to plot the percentiles plot in Spanish regions. Therefore, the users only have to provide a specific variable to show in regions of Spain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpainMap(regionvalue, main, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SpainMap_+3A_regionvalue">regionvalue</code></td>
<td>
<p>vector with the values that you want to plot in percentiles in the Spain map.</p>
</td></tr>
<tr><td><code id="SpainMap_+3A_main">main</code></td>
<td>
<p>the specific title of the map plot</p>
</td></tr>
<tr><td><code id="SpainMap_+3A_name">name</code></td>
<td>
<p>the assigned name for the legend in map plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a map from the regions of Spain colored with the variable provided by the user.
</p>


<h3>References</h3>

<p>Spanish National Institute of Statistics (INE) (2023). Tablas de mortalidad, metodologia.
Technical report, Instituto Nacional de Estadistica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>name &lt;- c("Ii")
main &lt;- c("Multiplicative for males")
regionvalue &lt;- c(0.131867619, -0.063994652,  0.088094096,
                 0.019685552,  0.064671498,   0.012212161,
                -0.088864474, -0.146079884, -0.017703536,
                 0.050376721,  0.052476852, -0.022871202,
                -0.093952332,  0.049266816, -0.101224890,
                 0.001481333, -0.078523511)

SpainMap(regionvalue, main, name)

</code></pre>

<hr>
<h2 id='SpainNat'>Spain National Mortality data</h2><span id='topic+SpainNat'></span>

<h3>Description</h3>

<p>Data from the Spanish national of Spain from the Spanish National Institute of Statistics (INE) for both genders years 1991-2020 and abridged ages from 0 to 90.
This dataset contains mortality rates for the total national population of Spain.
Additionally, the dataset includes the number of people alive (lxt) for each age and period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpainNat
</code></pre>


<h3>Format</h3>

<p>A data frame with 600 rows and 9 columns with the following information
</p>

<ul>
<li> <p><code>ccaa</code> a vector containing all the regions of Spain. Indeed, the column takes the following information: Spain.
</p>
</li>
<li> <p><code>years</code> a vector containing the periods of the dataset from 1991 to 2020.
</p>
</li>
<li> <p><code>ages</code> a vector containing the abridged ages considered in the dataset, 0, &lt;1, 1-4, 5-9, 10-14, 15-19, 20-24, 25-29, 30-34, 35-39, 40-44, 45-49, 50-54, 55-59, 60-64, 65-69, 70-74, 75-79, 80-84, 85-89, and 90-94.
</p>
</li>
<li> <p><code>qx_male</code> mortality rates for the males in the Spain Nation.
</p>
</li>
<li> <p><code>qx_female</code> mortality rates for the females in the Spain Nation.
</p>
</li>
<li> <p><code>lx_male</code> survivor function considered for the males of Spain Nation.
</p>
</li>
<li> <p><code>lx_female</code> survivor function considered for the females of Spain Nation.
</p>
</li>
<li> <p><code>series</code> information for the series of data provided.
</p>
</li>
<li> <p><code>label</code> the assigned tag to the data frame.
</p>
</li></ul>



<h3>References</h3>

<p>Spanish National Institute of Statistics (INE) (2023). Tablas de mortalidad, metodologia.
Technical report, Instituto Nacional de Estadistica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#In this case, we show the region dataset applying it to a multipopulation model.
#First, we present the dataset
SpainNat
#An example to how the additive multi-population model fits the data
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
library(gnm)
LC_Spainmales &lt;- fit_additive.LC.multi(qxt = SpainNat$qx_male,
                                       periods = c(1991:2020),
                                       ages = ages,
                                       nPop = 1)

</code></pre>

<hr>
<h2 id='SpainRegions'>Spain Regions Mortality data</h2><span id='topic+SpainRegions'></span>

<h3>Description</h3>

<p>Data from the Spanish region of Spain from the Spanish National Institute of Statistics (INE) for both genders years 1991-2020 and abridged ages from 0 to 90.
This dataset contains mortality rates (qxt) from 18 different regions of Spain.
Additionally, the dataset includes the number of people alive (lxt) for each age and period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SpainRegions
</code></pre>


<h3>Format</h3>

<p>A data frame with 10800 rows and 9 columns with the following information
</p>

<ul>
<li> <p><code>ccaa</code> a vector containing all the regions of Spain. Indeed, the column takes the following information: Spain, Andalucia, Aragon, Asturias, Baleares, Canarias, Cantabria, Castillayla Mancha, CastillayLeon, Cataluna, ComunidadValenciana, Extremadura, Galicia, Madrid, Murcia, Navarra, PaisVasco, and LaRioja.
</p>
</li>
<li> <p><code>years</code> a vector containing the periods of the dataset from 1991 to 2020.
</p>
</li>
<li> <p><code>ages</code> a vector containing the abridged ages considered in the dataset, 0, &lt;1, 1-4, 5-9, 10-14, 15-19, 20-24, 25-29, 30-34, 35-39, 40-44, 45-49, 50-54, 55-59, 60-64, 65-69, 70-74, 75-79, 80-84, 85-89, and 90-94.
</p>
</li>
<li> <p><code>qx_male</code> mortality rates for the males in every region of Spain including Nation data.
</p>
</li>
<li> <p><code>qx_female</code> mortality rates for the females in every region of Spain including Nation data.
</p>
</li>
<li> <p><code>lx_male</code> survivor function considered for the males in every region of Spain including Nation data.
</p>
</li>
<li> <p><code>lx_female</code> survivor function considered for the females in every region of Spain including Nation data.
</p>
</li>
<li> <p><code>series</code> information for the series of data provided.
</p>
</li>
<li> <p><code>label</code> the assigned tag to the data frame.
</p>
</li></ul>



<h3>References</h3>

<p>Spanish National Institute of Statistics (INE) (2023). Tablas de mortalidad, metodologia.
Technical report, Instituto Nacional de Estadistica
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#In this case, we show the region dataset applying it to a multipopulation model.
#First, we present the dataset
SpainRegions
#An example to how the additive multi-population model fits the data
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
library(gnm)
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                                                periods = c(1991:2020),
                                                ages = c(ages),
                                                nPop = 18,
                                                lxt = SpainRegions$lx_male)

</code></pre>

<hr>
<h2 id='SSE'>SUM of SQUARED ERRORS (SSE)</h2><span id='topic+SSE'></span>

<h3>Description</h3>

<p>R function to estimate the sum of squared errors for the mortality rates:
</p>
<p style="text-align: center;"><code class="reqn">\sum_{x}^{} \sum_{t} \left( qxt1 - qxt2 \right)^{2}</code>
</p>

<p>where qxt1 is the real mortality rates <code>qxt_re</code>, and qxt2 is the adjusted mortality rates <code>qxt_aju</code>.
You only have to provide the real value and the fitted or forecasted value for your mortality rates.
However, the function is constructed to provide the real value and the fitted or forecasted value of your independent variable.
These variables must have the same dimensions to be compared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSE(qxt_re, qxt_aju, wxt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSE_+3A_qxt_re">qxt_re</code></td>
<td>
<p>real mortality rates used to check the goodness of fit measure.</p>
</td></tr>
<tr><td><code id="SSE_+3A_qxt_aju">qxt_aju</code></td>
<td>
<p>adjusted mortality rates using a specific mode.</p>
</td></tr>
<tr><td><code id="SSE_+3A_wxt">wxt</code></td>
<td>
<p>weights of the mortality rates or data provided.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of SSE for the data provided.
</p>


<h3>References</h3>

<p>Atance, D., Debón, A., &amp; Navarro, E. (2020).
A comparison of forecasting mortality models using resampling methods.
Mathematics, 8(9), 1550.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fit_additive.LC.multi">fit_additive.LC.multi</a></code>, <code><a href="#topic+fit_multiplicative.LC.multi">fit_multiplicative.LC.multi</a></code>,
<code><a href="#topic+for_additive.LC.multi">for_additive.LC.multi</a></code>, <code><a href="#topic+for_multiplicative.LC.multi">for_multiplicative.LC.multi</a></code>,
<code><a href="#topic+MAE">MAE</a></code>, <code><a href="#topic+MSE">MSE</a></code>, <code><a href="#topic+MAPE">MAPE</a></code>,
<code><a href="#topic+multipopulation_cv">multipopulation_cv</a></code>, <code><a href="#topic+multipopulation_loocv">multipopulation_loocv</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#The example takes more than 5 seconds because it includes
#several fitting and forecasting process and hence all
#the process is included in donttest

#To show how the function works, we need to provide fitted or forecasted data and the real data.
#In this case, we employ the following data of the library:
#First, we present the dataset
#To show how the function works, we need to provide fitted or forecasted data and the real data.
#In this case, we employ the following data of the library:
SpainRegions
ages &lt;- c(0, 1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80, 85, 90)
#In this case, we fit for males providing the lxt
library(gnm)
multiplicative_Spainmales &lt;- fit_multiplicative.LC.multi(qxt = SpainRegions$qx_male,
                              periods = c(1991:2020),
                              ages = c(ages),
                              nPop = 18,
                              lxt = SpainRegions$lx_male)

#Once, we have the fitted data, we will obtain the SSE for the first population.
#We need to obtain wxt (weight of the mortality rates or data provided) using a
library(StMoMo)
wxt_1pob &lt;- genWeightMat(ages = ages, years = c(1991:2020), clip = 0)
SSE(qxt_re = multiplicative_Spainmales$qxt.real$pob1,
    qxt_aju = multiplicative_Spainmales$qxt.fitted$pob1,
    wxt = wxt_1pob)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
