<!DOCTYPE html><html><head><title>Help for package stabiliser</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stabiliser}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot_model'><p>boot_model</p></a></li>
<li><a href='#model_enet'><p>model_enet</p></a></li>
<li><a href='#model_lasso'><p>model_lasso</p></a></li>
<li><a href='#model_mbic'><p>model_mbic</p></a></li>
<li><a href='#model_mcp'><p>model_mcp</p></a></li>
<li><a href='#model_selector'><p>model_selector</p></a></li>
<li><a href='#perm_stab'><p>perm_stab</p></a></li>
<li><a href='#permute'><p>permute</p></a></li>
<li><a href='#rep_selector_boot'><p>rep_selector_boot</p></a></li>
<li><a href='#rep_selector_perm'><p>rep_selector_boot</p></a></li>
<li><a href='#selection_bias_inner'><p>selection_bias_inner</p></a></li>
<li><a href='#simulate_data'><p>simulate_data</p></a></li>
<li><a href='#simulate_data_re'><p>simulate_data_re</p></a></li>
<li><a href='#simulate_selection_bias'><p>simulate_selection_bias</p></a></li>
<li><a href='#stab_plot'><p>stab_plot</p></a></li>
<li><a href='#stabilise'><p>stabilise</p></a></li>
<li><a href='#stabilise_re'><p>stabilise_re</p></a></li>
<li><a href='#stabiliser'><p>stabiliser</p></a></li>
<li><a href='#stabiliser_example'><p>stabiliser_example</p></a></li>
<li><a href='#stabiliser_prep'><p>stabiliser_prep</p></a></li>
<li><a href='#triangulate'><p>triangulate</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Stabilising Variable Selection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Description:</td>
<td>A stable approach to variable selection through stability selection and the use of a permutation-based objective stability threshold. Lima et al (2021) &lt;<a href="https://doi.org/10.1038%2Fs41598-020-79317-8">doi:10.1038/s41598-020-79317-8</a>&gt;, Meinshausen and Buhlmann (2010) &lt;<a href="https://doi.org/10.1111%2Fj.1467-9868.2010.00740.x">doi:10.1111/j.1467-9868.2010.00740.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat (&ge; 3.0.0), markdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet, dplyr, bigstep, rsample, tibble, purrr, tidyr,
stringr, ggplot2, broom, caret, ncvreg, knitr, Hmisc, expss,
lme4, matrixStats, recipes, lmerTest</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-17 09:39:37 UTC; svzrh2</td>
</tr>
<tr>
<td>Author:</td>
<td>Robert Hyde <a href="https://orcid.org/0000-0002-8705-9405"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Martin Green [aut],
  Eliana Lima [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Robert Hyde &lt;robert.hyde4@nottingham.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-17 11:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot_model'>boot_model</h2><span id='topic+boot_model'></span>

<h3>Description</h3>

<p>Function to calculate stability of variables' association with an outcome for a given model over a number of bootstrap repeats
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_model_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted</p>
</td></tr>
<tr><td><code id="boot_model_+3A_outcome">outcome</code></td>
<td>
<p>the outcome as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="boot_model_+3A_boot_reps">boot_reps</code></td>
<td>
<p>the number of bootstrap samples</p>
</td></tr>
<tr><td><code id="boot_model_+3A_model">model</code></td>
<td>
<p>the model to be used (i.e. model_mbic)</p>
</td></tr>
</table>

<hr>
<h2 id='model_enet'>model_enet</h2><span id='topic+model_enet'></span>

<h3>Description</h3>

<p>Function to model elastic net selection process on a given dataframe
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_enet_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted (usually coming from nested bootstrap data)</p>
</td></tr>
<tr><td><code id="model_enet_+3A_outcome">outcome</code></td>
<td>
<p>the outcome as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="model_enet_+3A_type">type</code></td>
<td>
<p>model type, either &quot;linear&quot; or &quot;logistic&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='model_lasso'>model_lasso</h2><span id='topic+model_lasso'></span>

<h3>Description</h3>

<p>Function to model lasso selection process on a given dataframe
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_lasso_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted (usually coming from nested bootstrap data)</p>
</td></tr>
<tr><td><code id="model_lasso_+3A_outcome">outcome</code></td>
<td>
<p>the outcome as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="model_lasso_+3A_type">type</code></td>
<td>
<p>model type, either &quot;linear&quot; or &quot;logistic&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='model_mbic'>model_mbic</h2><span id='topic+model_mbic'></span>

<h3>Description</h3>

<p>Function to model mbic selection process on a given dataframe
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_mbic_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted (usually coming from nested bootstrap data)</p>
</td></tr>
<tr><td><code id="model_mbic_+3A_outcome">outcome</code></td>
<td>
<p>the outcome as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="model_mbic_+3A_type">type</code></td>
<td>
<p>model type, either &quot;linear&quot; or &quot;logistic&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='model_mcp'>model_mcp</h2><span id='topic+model_mcp'></span>

<h3>Description</h3>

<p>Function to model mcp selection process on a given dataframe
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_mcp_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted (usually coming from nested bootstrap data)</p>
</td></tr>
<tr><td><code id="model_mcp_+3A_outcome">outcome</code></td>
<td>
<p>the outcome as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="model_mcp_+3A_type">type</code></td>
<td>
<p>model type, either &quot;linear&quot; or &quot;logistic&quot;</p>
</td></tr>
</table>

<hr>
<h2 id='model_selector'>model_selector</h2><span id='topic+model_selector'></span>

<h3>Description</h3>

<p>Determines which models to call.
</p>

<hr>
<h2 id='perm_stab'>perm_stab</h2><span id='topic+perm_stab'></span>

<h3>Description</h3>

<p>Main function to call both permutation and bootstrapping functions; to be looped over multiple models selected by the user.
</p>

<hr>
<h2 id='permute'>permute</h2><span id='topic+permute'></span>

<h3>Description</h3>

<p>Calculates permutation threshold for null model, where a specified model is run over multiple bootstrap resamples of multiple permuted version of the dataset.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="permute_+3A_data">data</code></td>
<td>
<p>a dataframe containing an outcome variable to be permuted</p>
</td></tr>
<tr><td><code id="permute_+3A_outcome">outcome</code></td>
<td>
<p>the outcome to be permuted as a string (i.e. &quot;y&quot;)</p>
</td></tr>
<tr><td><code id="permute_+3A_permutations">permutations</code></td>
<td>
<p>the number of times to be permuted per repeat</p>
</td></tr>
<tr><td><code id="permute_+3A_perm_boot_reps">perm_boot_reps</code></td>
<td>
<p>the number of times to repeat each set of permutations</p>
</td></tr>
<tr><td><code id="permute_+3A_quantile">quantile</code></td>
<td>
<p>The quantile of null stabilities to use as a threshold.</p>
</td></tr>
</table>

<hr>
<h2 id='rep_selector_boot'>rep_selector_boot</h2><span id='topic+rep_selector_boot'></span>

<h3>Description</h3>

<p>wrapper function to determine the number of bootstrap repeats
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep_selector_boot(data, boot_reps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rep_selector_boot_+3A_data">data</code></td>
<td>
<p>the dataset to analyse.</p>
</td></tr>
<tr><td><code id="rep_selector_boot_+3A_boot_reps">boot_reps</code></td>
<td>
<p>the number of bootstrap samples</p>
</td></tr>
</table>

<hr>
<h2 id='rep_selector_perm'>rep_selector_boot</h2><span id='topic+rep_selector_perm'></span>

<h3>Description</h3>

<p>wrapper function to determine the number of permutations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rep_selector_perm(data, permutations)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rep_selector_perm_+3A_data">data</code></td>
<td>
<p>the dataset to analyse.</p>
</td></tr>
<tr><td><code id="rep_selector_perm_+3A_permutations">permutations</code></td>
<td>
<p>the number of times to be permuted per repeat</p>
</td></tr>
</table>

<hr>
<h2 id='selection_bias_inner'>selection_bias_inner</h2><span id='topic+selection_bias_inner'></span>

<h3>Description</h3>

<p>An function to illustrate the risk of selection bias in
conventional modelling approaches by simulating a dataset with no information and
conducting conventional modelling with prefiltration.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="selection_bias_inner_+3A_nrows">nrows</code></td>
<td>
<p>The number of rows to simulate.</p>
</td></tr>
<tr><td><code id="selection_bias_inner_+3A_ncols">ncols</code></td>
<td>
<p>The number of columns to simulate.</p>
</td></tr>
<tr><td><code id="selection_bias_inner_+3A_p_thresh">p_thresh</code></td>
<td>
<p>The p-value threshold to use in univariate pre-filtration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including a dataframe of results, a dataframe of the median number of variables selected and a plot illustrating false positive selection.
</p>

<hr>
<h2 id='simulate_data'>simulate_data</h2><span id='topic+simulate_data'></span>

<h3>Description</h3>

<p>Simulate a dataset. This can optionally include variables with a given associated with the outcome.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_data(nrows, ncols, n_true = 0, amplitude = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_data_+3A_nrows">nrows</code></td>
<td>
<p>The number of rows to simulate.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_ncols">ncols</code></td>
<td>
<p>The number of columns to simulate.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_n_true">n_true</code></td>
<td>
<p>The number of variables truly associated with the outcome.</p>
</td></tr>
<tr><td><code id="simulate_data_+3A_amplitude">amplitude</code></td>
<td>
<p>The strength of association between true variables and the outcome.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simulated dataset
</p>

<hr>
<h2 id='simulate_data_re'>simulate_data_re</h2><span id='topic+simulate_data_re'></span>

<h3>Description</h3>

<p>Simulate a 500x500 dataset with 8 true fixed effects, 492 junk variables and a clustered outcome suitable for a 2 level random effects analysis. The strength of association between true variables and the outcome is governed by the error added at level 1 (defined by parameter sd_level_1) and level 2 (sd_level_2).
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_data_re_+3A_sd_level_1">sd_level_1</code></td>
<td>
<p>Standard deviation of level 1 variables</p>
</td></tr>
<tr><td><code id="simulate_data_re_+3A_sd_level_2">sd_level_2</code></td>
<td>
<p>Standard deviation of level 2 variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A simulated dataset with a clustered outcome sutable for random effects analysis
</p>

<hr>
<h2 id='simulate_selection_bias'>simulate_selection_bias</h2><span id='topic+simulate_selection_bias'></span>

<h3>Description</h3>

<p>An function to illustrate the risk of selection bias in
conventional modelling approaches by simulating a dataset with no information and
conducting conventional modelling with prefiltration.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_selection_bias_+3A_nrows">nrows</code></td>
<td>
<p>A vector of the number of rows to simulate (i.e., c(100, 200)).</p>
</td></tr>
<tr><td><code id="simulate_selection_bias_+3A_ncols">ncols</code></td>
<td>
<p>A vector of the number of columns to simulate (i.e., c(100, 200)).</p>
</td></tr>
<tr><td><code id="simulate_selection_bias_+3A_p_thresh">p_thresh</code></td>
<td>
<p>A vector of the p-value threshold to use in univariate pre-filtration (i.e., c(0.1, 0.2)).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list including a dataframe of results, a dataframe of the median number of variables selected and a plot illustrating false positive selection.
</p>

<hr>
<h2 id='stab_plot'>stab_plot</h2><span id='topic+stab_plot'></span>

<h3>Description</h3>

<p>Plot from stability object
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="stab_plot_+3A_stabiliser_outcome">stabiliser_outcome</code></td>
<td>
<p>Outcome from stabilise() or triangulate() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object.
</p>

<hr>
<h2 id='stabilise'>stabilise</h2><span id='topic+stabilise'></span>

<h3>Description</h3>

<p>Function to calculate stability of variables' association with an outcome for a given model over a number of bootstrap repeats
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="stabilise_+3A_data">data</code></td>
<td>
<p>A dataframe containing an outcome variable to be permuted.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_outcome">outcome</code></td>
<td>
<p>The outcome as a string (i.e. &quot;y&quot;).</p>
</td></tr>
<tr><td><code id="stabilise_+3A_boot_reps">boot_reps</code></td>
<td>
<p>The number of bootstrap samples. Default is &quot;auto&quot; which selects number based on dataframe size.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_permutations">permutations</code></td>
<td>
<p>The number of times to be permuted per repeat. Default is &quot;auto&quot; which selects number based on dataframe size.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_perm_boot_reps">perm_boot_reps</code></td>
<td>
<p>The number of times to repeat each set of permutations. Default is 20.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_models">models</code></td>
<td>
<p>The models to select for stabilising. Default is elastic net (models = c(&quot;enet&quot;)), other available models include &quot;lasso&quot;, &quot;mbic&quot;, &quot;mcp&quot;.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_type">type</code></td>
<td>
<p>The type of model, either &quot;linear&quot; or &quot;logistic&quot;</p>
</td></tr>
<tr><td><code id="stabilise_+3A_quantile">quantile</code></td>
<td>
<p>The quantile of null stabilities to use as a threshold.</p>
</td></tr>
<tr><td><code id="stabilise_+3A_normalise">normalise</code></td>
<td>
<p>Normalise numeric variables (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabilise_+3A_dummy">dummy</code></td>
<td>
<p>Create dummy variables for factors/characters (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabilise_+3A_impute">impute</code></td>
<td>
<p>Impute missing data (TRUE/FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list for each model selected. Each list contains a dataframe of variable stabilities, a numeric permutation threshold, and a dataframe of coefficients for both bootstrap and permutation.
</p>

<hr>
<h2 id='stabilise_re'>stabilise_re</h2><span id='topic+stabilise_re'></span>

<h3>Description</h3>

<p>Function to calculate stability of variables' association with an outcome for a given model over a number of bootstrap repeats using clustered data.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="stabilise_re_+3A_data">data</code></td>
<td>
<p>A dataframe containing an outcome variable to be permuted.</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_outcome">outcome</code></td>
<td>
<p>The outcome as a string (i.e. &quot;y&quot;).</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_level_2_id">level_2_id</code></td>
<td>
<p>The variable name determining level 2 status as a string (i.e., &quot;level_2_column_name&quot;).</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_n_top_filter">n_top_filter</code></td>
<td>
<p>The number of variables to filter for final model (Default = 50).</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_boot_reps">boot_reps</code></td>
<td>
<p>The number of bootstrap samples. Default is &quot;auto&quot; which selects number based on dataframe size.</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_permutations">permutations</code></td>
<td>
<p>The number of times to be permuted per repeat. Default is &quot;auto&quot; which selects number based on dataframe size.</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_perm_boot_reps">perm_boot_reps</code></td>
<td>
<p>The number of times to repeat each set of permutations. Default is 20.</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_normalise">normalise</code></td>
<td>
<p>Normalise numeric variables (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_dummy">dummy</code></td>
<td>
<p>Create dummy variables for factors/characters (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabilise_re_+3A_impute">impute</code></td>
<td>
<p>Impute missing data (TRUE/FALSE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a table of variable stabilities and a numeric permutation threshold.
</p>

<hr>
<h2 id='stabiliser'>stabiliser</h2><span id='topic+stabiliser'></span><span id='topic+stabiliser-package'></span>

<h3>Description</h3>

<p>This package uses bootstrap resampling and an objective selection stability threshold to provide a robust method of selecting variables truly associated with an outcome.
</p>


<h3>Author(s)</h3>

<p>Robert Hyde <a href="mailto:robert.hyde4@nottingham.ac.uk">robert.hyde4@nottingham.ac.uk</a>
</p>
<p>Martin Green
</p>
<p>Eliana Lima
</p>

<hr>
<h2 id='stabiliser_example'>stabiliser_example</h2><span id='topic+stabiliser_example'></span>

<h3>Description</h3>

<p>A simulated dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stabiliser_example
</code></pre>


<h3>Format</h3>

<p>A data frame with 50 rows and 100 variables.
</p>
<p>The stabiliser_example dataset is a simulated example with the following properties:
1 simulated outcome variable: <code>y</code>
4 variables simulated to be associated with <code>y</code>: <code>causal1</code>, <code>causal2</code>...
95 variables simulated to have no association with <code>y</code>: <code>junk1</code>, <code>junk2</code>...
</p>

<hr>
<h2 id='stabiliser_prep'>stabiliser_prep</h2><span id='topic+stabiliser_prep'></span>

<h3>Description</h3>

<p>Prepares dataset using recipes framework
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="stabiliser_prep_+3A_normalise">normalise</code></td>
<td>
<p>Normalise numeric variables (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabiliser_prep_+3A_dummy">dummy</code></td>
<td>
<p>Create dummy variables for factors/characters (TRUE/FALSE)</p>
</td></tr>
<tr><td><code id="stabiliser_prep_+3A_impute">impute</code></td>
<td>
<p>Impute missing data (TRUE/FALSE)</p>
</td></tr>
</table>

<hr>
<h2 id='triangulate'>triangulate</h2><span id='topic+triangulate'></span>

<h3>Description</h3>

<p>Triangulate multiple models using a stability object
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="triangulate_+3A_object">object</code></td>
<td>
<p>An object generated through the stabilise() function.</p>
</td></tr>
<tr><td><code id="triangulate_+3A_quantile">quantile</code></td>
<td>
<p>The quantile of null stabilities to use as a threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A combined list of model results including a dataframe of stability results for variables and a numeric permutation threshold.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
