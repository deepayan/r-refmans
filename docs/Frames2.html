<!DOCTYPE html><html><head><title>Help for package Frames2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Frames2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BKA'><p>Bankier-Kalton-Anderson estimator</p></a></li>
<li><a href='#CalDF'><p>DF calibration estimator</p></a></li>
<li><a href='#CalSF'><p>SF calibration estimator</p></a></li>
<li><a href='#Compare'><p>Summary of estimators</p></a></li>
<li><a href='#CovHT'><p>Covariance estimator between two Horvitz - Thompson estimators</p></a></li>
<li><a href='#Dat'><p>Joint sample database</p></a></li>
<li><a href='#DatA'><p>Database of household expenses for frame A</p></a></li>
<li><a href='#DatB'><p>Database of household expenses for frame B</p></a></li>
<li><a href='#DatMA'><p>Database of students' program choice for frame A</p></a></li>
<li><a href='#DatMB'><p>Database of students' program choice for frame B</p></a></li>
<li><a href='#DatPopM'><p>Database of auxiliary information for the whole population of students</p></a></li>
<li><a href='#Domains'><p>Domains</p></a></li>
<li><a href='#FB'><p>Fuller-Burmeister estimator</p></a></li>
<li><a href='#Frames-internal'><p>Internal Frame Functions</p></a></li>
<li><a href='#Hartley'><p>Hartley estimator</p></a></li>
<li><a href='#HT'><p>Horvitz - Thompson estimator</p></a></li>
<li><a href='#JackBKA'><p>Confidence intervals for Bankier-Kalton-Anderson estimator based on jackknife method</p></a></li>
<li><a href='#JackCalDF'><p>Confidence intervals for dual frame calibration estimator based on jackknife method</p></a></li>
<li><a href='#JackCalSF'><p>Confidence intervals for SF calibration estimator based on jackknife method</p></a></li>
<li><a href='#JackFB'><p>Confidence intervals for Fuller-Burmeister estimator based on jackknife method</p></a></li>
<li><a href='#JackHartley'><p>Confidence intervals for Hartley estimator based on jackknife method</p></a></li>
<li><a href='#JackMLCDF'><p>Confidence intervals for MLCDF estimator based on jackknife method</p></a></li>
<li><a href='#JackMLCDW'><p>Confidence intervals for MLCDW estimator based on jackknife method</p></a></li>
<li><a href='#JackMLCSW'><p>Confidence intervals for MLCSW estimator based on jackknife method</p></a></li>
<li><a href='#JackMLDF'><p>Confidence intervals for MLDF estimator based on jackknife method</p></a></li>
<li><a href='#JackMLDW'><p>Confidence intervals for MLDW estimator based on jackknife method</p></a></li>
<li><a href='#JackMLSW'><p>Confidence intervals for MLSW estimator based on jackknife method</p></a></li>
<li><a href='#JackPEL'><p>Confidence intervals for the pseudo empirical likelihood estimator based on jackknife method</p></a></li>
<li><a href='#JackPML'><p>Confidence intervals for the pseudo maximum likelihood estimator based on jackknife method</p></a></li>
<li><a href='#JackSFRR'><p>Confidence intervals for raking ratio estimator based on jackknife method</p></a></li>
<li><a href='#MLCDF'><p>Multinomial logistic calibration estimator under dual frame approach with auxiliary information from each frame</p></a></li>
<li><a href='#MLCDW'><p>Multinomial logistic calibration estimator under dual frame approach with auxiliary information from the whole population</p></a></li>
<li><a href='#MLCSW'><p>Multinomial logistic calibration estimator under single frame approach with auxiliary information from the whole population</p></a></li>
<li><a href='#MLDF'><p>Multinomial logistic estimator under dual frame approach with auxiliary information from each frame</p></a></li>
<li><a href='#MLDW'><p>Multinomial logistic estimator under dual frame approach with auxiliary information from the whole population</p></a></li>
<li><a href='#MLSW'><p>Multinomial logistic estimator under single frame approach with auxiliary information from the whole population</p></a></li>
<li><a href='#PEL'><p>Pseudo empirical likelihood estimator</p></a></li>
<li><a href='#PiklA'><p>Matrix of inclusion probabilities for units selected in sample from frame A</p></a></li>
<li><a href='#PiklB'><p>Matrix of inclusion probabilities for units selected in sample from frame B</p></a></li>
<li><a href='#PML'><p>Pseudo Maximum Likelihood estimator</p></a></li>
<li><a href='#SFRR'><p>Raking ratio estimator</p></a></li>
<li><a href='#VarHT'><p>Variance estimator of Horvitz - Thompson estimator</p></a></li>
<li><a href='#WeightsCalDF'><p>g-weights for the dual frame calibration estimator</p></a></li>
<li><a href='#WeightsCalSF'><p>g-weights for the SF calibration estimator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation in Dual Frame Surveys</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-12-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Antonio Arcos &lt;arcos@ugr.es&gt;, Maria del Mar Rueda &lt;mrueda@ugr.es&gt;,
    Maria Giovanna Ranalli &lt;giovanna.ranalli@stat.unipg.it&gt; and David Molina
    &lt;dmolinam@ugr.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Molina &lt;dmolinam@ugr.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Point and interval estimation in dual frame surveys. In contrast
    to classic sampling theory, where only one sampling frame is considered,
    dual frame methodology assumes that there are two frames available for
    sampling and that, overall, they cover the entire target population. Then,
    two probability samples (one from each frame) are drawn and information
    collected is suitably combined to get estimators of the parameter of
    interest.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>sampling, MASS, nnet</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-12-11 23:33:24 UTC; Usuario_2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-12-12 09:49:54</td>
</tr>
</table>
<hr>
<h2 id='BKA'>Bankier-Kalton-Anderson estimator</h2><span id='topic+BKA'></span>

<h3>Description</h3>

<p>Produces estimates for population total and mean using the Bankier-Kalton-Anderson estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BKA(ysA, ysB, pi_A, pi_B, pik_ab_B, pik_ba_A, domains_A, domains_B, 
conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BKA_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="BKA_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="BKA_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="BKA_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>BKA estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{BKA} = \sum_{i \in s_A}\tilde{d}_i^Ay_i + \sum_{i \in s_B}\tilde{d}_i^By_i</code>
</p>

<p>where
<code class="reqn">\tilde{d}_i^A =\left\{\begin{array}{lcc}
 d_i^A &amp; \textrm{if } i \in a\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ab
 \end{array}
 \right.</code>
and
<code class="reqn">\tilde{d}_i^B =\left\{\begin{array}{lcc}
 d_i^B &amp; \textrm{if } i \in b\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ba
 \end{array}
 \right.</code>
being <code class="reqn">d_i^A</code> and <code class="reqn">d_i^B</code> the design weights, obtained as the inverse of the first order inclusion probabilities, that is, <code class="reqn">d_i^A = 1/\pi_i^A</code> and <code class="reqn">d_i^B = 1/\pi_i^B</code>.
</p>
<p>To estimate variance of this estimator, one uses following approach proposed by Rao and Skinner (1996)
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{BKA}) = \hat{V}(\sum_{i \in s_A}\tilde{z}_i^A) + \hat{V}(\sum_{i \in s_B}\tilde{z}_i^B)</code>
</p>

<p>with <code class="reqn">\tilde{z}_i^A = \delta_i(a)y_i + (1 - \delta_i(a))y_i\pi_i^A/(\pi_i^A + \pi_i^B)</code> and <code class="reqn">\tilde{z}_i^B = \delta_i(b)y_i + (1 - \delta_i(b))y_i\pi_i^B/(\pi_i^A + \pi_i^B)</code>,
being <code class="reqn">\delta_i(a)</code> and <code class="reqn">\delta_i(b)</code> the indicator variables for domain <code class="reqn">a</code> and domain <code class="reqn">b</code>, respectively.
If both first and second order probabilities are known, variances and covariances involved in calculation of <code class="reqn">\hat{\beta}</code> and <code class="reqn">\hat{V}(\hat{Y}_{FB})</code> are estimated using functions <code>VarHT</code> and <code>CovHT</code>, respectively. If
only first order probabilities are known, variances are estimated using Deville's method and covariances are estimated using following expression
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Cov}(\hat{X}, \hat{Y}) = \frac{\hat{V}(X + Y) - \hat{V}(X) - \hat{V}(Y)}{2}</code>
</p>



<h3>Value</h3>

<p><code>BKA</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Bankier, M. D. (1986)
<em>Estimators Based on Several Stratified Samples With Applications to Multiple Frame Surveys</em>. 
Journal of the American Statistical Association, Vol. 81, 1074 - 1079.
</p>
<p>Kalton, G. and Anderson, D. W. (1986) 
<em>Sampling Rare Populations</em>. 
Journal of the Royal Statistical Society, Ser. A, Vol. 149, 65 - 82.
</p>
<p>Rao, J. N. K. and Skinner, C. J. (1996)
<em>Estimation in Dual Frame Surveys with Complex Designs</em>.
Proceedings of the Survey Method Section, Statistical Society of Canada, 63 - 68.
</p>
<p>Skinner, C. J. and Rao, J. N. K. (1996) 
<em>Estimation in Dual Frame Surveys with Complex Designs</em>.
Journal of the American Statistical Association, Vol. 91, 433, 349 - 356.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackBKA">JackBKA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate BKA estimator for population total for variable Leisure
BKA(DatA$Lei, DatB$Lei, PiklA, PiklB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain)

#Now, let calculate BKA estimator and a 90% confidence interval for population 
#total for variable Feeding considering only first order inclusion probabilities
BKA(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$ProbB, 
DatB$ProbA, DatA$Domain, DatB$Domain, 0.90)
</code></pre>

<hr>
<h2 id='CalDF'>DF calibration estimator</h2><span id='topic+CalDF'></span>

<h3>Description</h3>

<p>Produces estimates for population totals and means using the DF calibration estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalDF(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
xsT = NULL, XA = NULL, XB = NULL, X = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalDF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of length <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of length <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="CalDF_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>DF calibration estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{CalDF} = \hat{Y}_a + \hat{\eta}\hat{Y}_{ab} + \hat{Y}_b + (1 - \hat{\eta})\hat{Y}_{ba}</code>
</p>

<p>where <code class="reqn">\hat{Y}_a = \sum_{i \in s_a}\tilde{d}_i y_i, \hat{Y}_{ab} = \sum_{i \in s_{ab}}\tilde{d}_i y_i</code>, 
<code class="reqn">\hat{Y}_b = \sum_{i \in s_b}\tilde{d}_i y_i</code> and <code class="reqn">\hat{Y}_{ba} = \sum_{i \in s_{ba}}\tilde{d}_i y_i</code>, with <code class="reqn">\tilde{d}_i</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are all known and no other auxiliary information is available, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i \in s_a}\tilde{d}_i = N_a, \sum_{i \in s_{ab}}\tilde{d}_i = N_{ab}, \sum_{i \in s_{ba}}\tilde{d}_i = N_{ba}, \sum_{i \in s_b}\tilde{d}_i = N_b</code>
</p>

<p>Optimal value for <code class="reqn">\hat{\eta}</code> to minimice variance of the estimator is given by <code class="reqn">\hat{V}(\hat{N}_{ba})/(\hat{V}(\hat{N}_{ab}) + \hat{V}(\hat{N}_{ba}))</code>. If both first and second order probabilities are known, variances are estimated using function <code>VarHT</code>. 
If only first order probabilities are known, variances are estimated using Deville's method.
</p>
<p>Function covers following scenarios:
</p>

<ul>
<li><p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li>
<li><p> At least, information about one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li></ul>

<p>To obtain an estimator of the variance for this estimator, one can use Deville's expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{CalDF}) = \frac{1}{1-\sum_{k\in s} a_k^2}\sum_{k\in s}(1-\pi_k)\left(\frac{e_k}{\pi_k} - \sum_{l\in s} a_{l} \frac{e_l}{\pi_l}\right)^2</code>
</p>

<p>where <code class="reqn">a_k=(1-\pi_k)/\sum_{l\in s} (1-\pi_l)</code> and <code class="reqn">e_k</code> are the residuals of the regression with auxiliary variables as regressors.
</p>


<h3>Value</h3>

<p><code>CalDF</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Ranalli, M. G., Arcos, A., Rueda, M. and Teodoro, A. (2013)
<em>Calibration estimation in dual frame surveys</em>. arXiv:1312.0761 [stat.ME]
</p>
<p>Deville, J. C., Sarndal, C. E. (1992)
<em>Calibration estimators in survey sampling.</em>
Journal of the American Statistical Association, 87, 376 - 382
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackCalDF">JackCalDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate DF calibration estimator for variable Feeding, without
#considering any auxiliary information
CalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate DF calibration estimator for variable Clothing when the frame
#sizes and the overlap domain size are known
CalDF(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate DF calibration estimator and a 90% confidence interval
#for population total for variable Feeding, considering Income as auxiliary variable in 
#frame A and Metres2 as auxiliary variable in frame B and with frame sizes and overlap 
#domain size known.
CalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, xsBFrameA = DatB$Inc, 
xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, XA = 4300260, XB = 176553, 
conf_level = 0.90)
</code></pre>

<hr>
<h2 id='CalSF'>SF calibration estimator</h2><span id='topic+CalSF'></span>

<h3>Description</h3>

<p>Produces estimates for population totals and means using the SF calibration estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalSF(ysA, ysB, pi_A, pi_B, pik_ab_B, pik_ba_A, domains_A, domains_B, N_A = NULL,
N_B = NULL, N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, 
xsBFrameB = NULL, xsT = NULL, XA = NULL, XB = NULL, X = NULL, met = "linear", 
conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalSF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="CalSF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="CalSF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="CalSF_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>SF calibration estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{CalSF} = \hat{Y}_a + \hat{Y}_{ab} + \hat{Y}_b</code>
</p>

<p>where <code class="reqn">\hat{Y}_a = \sum_{i \in s_a}\tilde{d}_i y_i, \hat{Y}_{ab} = \sum_{i \in (s_{ab} \cup s_{ba})}\tilde{d}_i y_i</code> 
and <code class="reqn">\hat{Y}_b = \sum_{i \in s_b} \tilde{d}_i y_i</code>, with <code class="reqn">\tilde{d}_i</code> calibration weights which are calculated
having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are known and no other auxiliary information is available, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{i \in s_a}\tilde{d}_i = N_a, \sum_{i \in s_{ab} \cup s_{ba}}\tilde{d}_i = N_{ab}, \sum_{i \in s_{ba}}\tilde{d}_i = N_{ba}</code>
</p>

<p>Function covers following scenarios:
</p>

<ul>
<li><p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown 
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li>
<li><p> At least, information about one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li></ul>

<p>To obtain an estimator of the variance for this estimator, one can use Deville's expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{CalSF}) = \frac{1}{1-\sum_{k\in s} a_k^2}\sum_{k\in s}(1-\pi_k)\left(\frac{e_k}{\pi_k} - \sum_{l\in s} a_{l} \frac{e_l}{\pi_l}\right)^2</code>
</p>

<p>where <code class="reqn">a_k=(1-\pi_k)/\sum_{l\in s} (1-\pi_l)</code> and <code class="reqn">e_k</code> are the residuals of the regression with auxiliary variables as regressors.
</p>


<h3>Value</h3>

<p><code>CalSF</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Ranalli, M. G., Arcos, A., Rueda, M. and Teodoro, A. (2013)
<em>Calibration estimation in dual frame surveys</em>. arXiv:1312.0761 [stat.ME]
</p>
<p>Deville, J. C., Sarndal, C. E. (1992)
<em>Calibration estimators in survey sampling.</em>
Journal of the American Statistical Association, 87, 376 - 382
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackCalSF">JackCalSF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate SF calibration estimator for variable Clothing, without
#considering any auxiliary information
CalSF(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain)

#Now, let calculate SF calibration estimator for variable Leisure when the frame
#sizes and the overlap domain size are known
CalSF(DatA$Lei, DatB$Lei, PiklA, PiklB, DatA$ProbB, DatB$ProbA, DatA$Domain, 
DatB$Domain, N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate SF calibration estimator and a 90% confidence interval
#for population total for variable Feeding, considering Income and Metres2 as auxiliary 
#variables and with frame sizes and overlap domain size known.
CalSF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$ProbB, DatB$ProbA, DatA$Domain, 
DatB$Domain, N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, 
xsBFrameA = DatB$Inc, xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, 
XA = 4300260, XB = 176553, conf_level = 0.90)
</code></pre>

<hr>
<h2 id='Compare'>Summary of estimators</h2><span id='topic+Compare'></span>

<h3>Description</h3>

<p>Returns all possible estimators that can be computed according to the information provided
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Compare(ysA, ysB, pi_A, pi_B, domains_A, domains_B, pik_ab_B = NULL, pik_ba_A = NULL, 
N_A = NULL, N_B = NULL, N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL,  
xsAFrameB = NULL, xsBFrameB = NULL, XA = NULL, XB = NULL, met = "linear", 
conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Compare_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of length <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="Compare_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of length <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="Compare_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>(Optional) A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>(Optional) A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td></tr>
<tr><td><code id="Compare_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td></tr>
<tr><td><code id="Compare_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="Compare_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="Compare_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="Compare_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

Compare(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)
</code></pre>

<hr>
<h2 id='CovHT'>Covariance estimator between two Horvitz - Thompson estimators</h2><span id='topic+CovHT'></span>

<h3>Description</h3>

<p>Computes the covariance estimator between two Horvitz - Thompson estimators of population total from survey data obtained from a single stage sampling design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CovHT(y, x, pikl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CovHT_+3A_y">y</code></td>
<td>
<p>A numeric vector of size n containing information about first variable of interest in the sample</p>
</td></tr>
<tr><td><code id="CovHT_+3A_x">x</code></td>
<td>
<p>A numeric vector of size n containing information about second variable of interest in the sample</p>
</td></tr>
<tr><td><code id="CovHT_+3A_pikl">pikl</code></td>
<td>
<p>A square numeric matrix of dimension n containing first and second order inclusion probabilities for units included in the sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariance estimator between two Horvitz - Thompson estimators of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Cov}(\hat{Y}_{HT}, \hat{X}_{HT}) = \sum_{k \in s}\sum_{l \in s} \frac{\pi_{kl} - \pi_k \pi_l}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{x_l}{\pi_l}</code>
</p>



<h3>Value</h3>

<p>A numeric value representing covariance estimator between two Horvitz - Thompson estimators for population total for considered values
</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952)
<em>A generalization of sampling without replacement from a finite universe.</em>
Journal of the American Statistical Association, 47, 663 - 685
@references Sarndal, C. E., Swensson, B. and Wretman, J. (1992)
<em>Model Assisted Survey Sampling</em>. Springer-Verlag. New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a></code> <code><a href="#topic+VarHT">VarHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########   Example 1   ##########
Indicators &lt;- c(1, 2, 3, 4, 5)
X &lt;- c(13, 18, 20, 14, 9)
Y &lt;- c(2, 0.5, 1.2, 3.3, 2)
#Let draw two simple random samples without replacement of size 2
s &lt;- sample(Indicators, 2)
sX &lt;- X[s]
sY &lt;- Y[s]
#Now, let calculate the associated probability matrix with first and
#second order inclusion probabilities
Ps &lt;- matrix(c(0.4,0.2, 0.2,0.4), 2, 2)
CovHT(sX, sY, Ps)

##########   Example 2   ##########
data(DatA)
attach(DatA)
data(PiklA)
#Let calculate Horvitz - Thompson estimator for total of variable Clothing in Frame A.
HT(Clo, ProbA)
#Let calculate Horvitz - Thompson estimator for total of variable Feeding in Frame A.
HT(Feed, ProbA)
#And now, let compute the covariance between the previous estimators
CovHT(Clo, Feed, PiklA)
</code></pre>

<hr>
<h2 id='Dat'>Joint sample database</h2><span id='topic+Dat'></span>

<h3>Description</h3>

<p>This dataset contains some variables coming from a real dual frame survey conducted in 2013 in Andalusia (Spain) by a scientific institute specialized in social topics.
With this dataset it is intented to show how to properly split a joint dual frame sample into subsamples, so functions of <code>Frame2</code> can be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dat
</code></pre>


<h3>Format</h3>


<dl>
<dt>Drawnby</dt><dd><p>Indicates whether individual was selected in the landline sample(1) or in the cell phone sample(2).</p>
</dd>
<dt>Stratum</dt><dd><p>Indicates the stratum each individual belongs to. For individuals selected in cell phone sample, value of this variable is <code>NA</code>.</p>
</dd>
<dt>Opinion</dt><dd><p>Response of the individual to the question: Do you think that immigrants currently living in Andalusia are quite a lot? 1 represents &quot;yes&quot; and 0 represents &quot;no&quot;.</p>
</dd>
<dt>Landline</dt><dd><p>Indicates whether individual has a landline (1) or not (0).</p>
</dd>
<dt>Cell</dt><dd><p>Indicates whether individual has a cell phone(1) or not(0).</p>
</dd>
<dt>ProbLandline</dt><dd><p>First order inclusion probability of reaching the individual by landline.</p>
</dd>
<dt>ProbCell</dt><dd><p>First order inclusion probability of reaching the individual by cell phone.</p>
</dd>
<dt>Income</dt><dd><p>Monthly income (in euros) of the individual.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The survey was based on two frames: a landline frame and a cell phone frame. Landline frame was stratified by province and simple random sampling without replacement was considered
in cell phone frame. The size of the whole sample was <code class="reqn">n = 2402</code>. Total of the variable Income in the whole population is <code class="reqn">X_{Income} = 12686232063</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Dat)
attach(Dat)

#We are going to split dataset Dat into two new datasets, each 
#one corresponding to a frame: frame containing individuals
#using landline and frame containing individuals using cell phone.

FrameLandline &lt;- Dat[Landline == 1,]
FrameCell &lt;- Dat[Cell == 1,]

#Equally, we can split the original dataset in three new different 
#datasets, each one corresponding to one domain: first domain containing
#individuals using only landline, second domain containing individuals
#using only cell phone and the third domain containing individuals
#using both landline and cell phone.

DomainLandline &lt;- Dat[Landline == 1 &amp; Cell == 0,]
DomainCell &lt;- Dat[Landline == 0 &amp; Cell == 1,]
DomainBoth &lt;- Dat[Landline == 1 &amp; Cell == 1,]

#From the domain datasets, we can build frame datasets

FrameLandline &lt;- rbind(DomainLandline, DomainBoth)
FrameCell &lt;- rbind(DomainCell, DomainBoth)
</code></pre>

<hr>
<h2 id='DatA'>Database of household expenses for frame A</h2><span id='topic+DatA'></span>

<h3>Description</h3>

<p>This dataset contains some variables regarding household expenses for a sample of 105 households selected from a list of landline phones (let say, frame A) in a particular city in a specific month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatA
</code></pre>


<h3>Format</h3>


<dl>
<dt>Domain</dt><dd><p>A string indicating the domain each household belongs to. Possible values are &quot;a&quot; if household belongs to domain a or &quot;ab&quot; if household belongs to overlap domain.</p>
</dd>
<dt>Feed</dt><dd><p>Feeding expenses (in euros) at the househould</p>
</dd>
<dt>Clo</dt><dd><p>Clothing expenses (in euros) at the household</p>
</dd>
<dt>Lei</dt><dd><p>Leisure expenses (in euros) at the household</p>
</dd>
<dt>Inc</dt><dd><p>Household income (in euros). Values for this variable are only available for households included in frame A. For households included in domain b, value of this variable is set to 0.</p>
</dd>
<dt>Tax</dt><dd><p>Household municipal taxes (in euros) paid. Values for this variable are only available for households included in frame A. For households included in domain b, value of this variable is set to 0.</p>
</dd>
<dt>M2</dt><dd><p>Square meters of the house. Values for this variable are only available for households included in frame B. For households included in domain a, value of this variable is set to 0.</p>
</dd>
<dt>Size</dt><dd><p>Household size. Values for this variable are only available for households included in frame B. For households included in domain a, value of this variable is set to 0.</p>
</dd>
<dt>ProbA</dt><dd><p>First order inclusion probability in frame A. This probability is 0 for households included in domain b.</p>
</dd>
<dt>ProbB</dt><dd><p>First order inclusion probability in frame B. This probability is 0 for households included in domain a.</p>
</dd>
<dt>Stratum</dt><dd><p>A numeric value indicating the stratum each household belongs to.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The sample, of size <code class="reqn">n_A = 105</code>, has been drawn from a population of <code class="reqn">N_A = 1735</code> households with landline phone according to a stratified random sampling. Population units were divided in 6 different strata. 
Population sizes of these strata are <code class="reqn">N_A^h = (727, 375, 113, 186, 115, 219)</code>. <code class="reqn">N_{ab} = 601</code> of the households composing the population have, also, mobile phone. On the other hand, frame totals for auxiliary variables in this frame are <code class="reqn">X_{Income}^A = 4300260</code> and <code class="reqn">X_{Taxes}^A = 215577</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PiklA">PiklA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
attach(DatA)
#Let perform a brief descriptive analysis for the three main variables
param &lt;- data.frame(Feed, Clo, Lei)
summary (param)
hist (Feed)
hist (Clo)
hist (Lei)
</code></pre>

<hr>
<h2 id='DatB'>Database of household expenses for frame B</h2><span id='topic+DatB'></span>

<h3>Description</h3>

<p>This dataset contains some variables regarding household expenses for a sample of 135 households selected from a list of mobile phones (let say, frame B) in a particular city in a specific month.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatB
</code></pre>


<h3>Format</h3>


<dl>
<dt>Domain</dt><dd><p>A string indicating the domain each household belongs to. Possible values are &quot;b&quot; if household belongs to domain b or &quot;ba&quot; if household belongs to overlap domain.</p>
</dd>
<dt>Feed</dt><dd><p>Feeding expenses (in euros) at the househould</p>
</dd>
<dt>Clo</dt><dd><p>Clothing expenses (in euros) at the household</p>
</dd>
<dt>Lei</dt><dd><p>Leisure expenses (in euros) at the household</p>
</dd>
<dt>Inc</dt><dd><p>Household income (in euros). Values for this variable are only available for households included in frame A. For households included in domain b, value of this variable is set to 0.</p>
</dd>
<dt>Tax</dt><dd><p>Household municipal taxes (in euros) paid. Values for this variable are only available for households included in frame A. For households included in domain b, value of this variable is set to 0.</p>
</dd>
<dt>M2</dt><dd><p>Square meters of the house. Values for this variable are only available for households included in frame B. For households included in domain a, value of this variable is set to 0.</p>
</dd>
<dt>Size</dt><dd><p>Household size. Values for this variable are only available for households included in frame B. For households included in domain a, value of this variable is set to 0.</p>
</dd>
<dt>ProbA</dt><dd><p>First order inclusion probability in frame A. This probability is 0 for households included in domain b.</p>
</dd>
<dt>ProbB</dt><dd><p>First order inclusion probability in frame B. This probability is 0 for households included in domain a.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The sample, of size <code class="reqn">n_B = 135</code>, has been drawn from a population of <code class="reqn">N_B = 1191</code> households with mobile phone according to a simple random sampling without replacement design. 
<code class="reqn">N_{ab} = 601</code> of these households have, also, landline phone. On the other hand, frame totals for auxiliary variables in this frame are <code class="reqn">X_{Metres2}^B = 176553</code> and <code class="reqn">X_{Size}^B = 3529</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PiklB">PiklB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatB)
attach(DatB)
#Let perform a brief descriptive analysis for the three main variables
param &lt;- data.frame(Feed, Clo, Lei)
summary (param)
hist (Feed)
hist (Clo)
hist (Lei)
</code></pre>

<hr>
<h2 id='DatMA'>Database of students' program choice for frame A</h2><span id='topic+DatMA'></span>

<h3>Description</h3>

<p>This dataset contains some variables regarding the program choice for a sample of 180 students included in the sampling frame A.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatMA
</code></pre>


<h3>Format</h3>


<dl>
<dt>Id_Pop</dt><dd><p>An integer from 1 to <code class="reqn">N</code>, with <code class="reqn">N</code> the number of students in the whole population, identifying the student within the population.</p>
</dd>
<dt>Id_Frame</dt><dd><p>An integer from 1 to <code class="reqn">N_A</code>, with <code class="reqn">N_A</code> the number of students in the frame, identifying the student within the frame.</p>
</dd>
<dt>Prog</dt><dd><p>A factor with three categories (academic, general and vocation) indicating the program choice of the student.</p>
</dd>
<dt>Ses</dt><dd><p>An ordinal factor with three categories (low, middle and high) indicating the socio-economical status of the student.</p>
</dd>
<dt>Read</dt><dd><p>A number indicating the mark of the student in a reading test.</p>
</dd>
<dt>Write</dt><dd><p>A number indicating the mark of the student in a writing test.</p>
</dd>
<dt>Sch_Size</dt><dd><p>A number indicating the size of the school the students belongs to.</p>
</dd>
<dt>Domain</dt><dd><p>A string indicating the domain each student belongs to. Possible values are &quot;a&quot; if student belongs to domain a or &quot;ab&quot; if student belongs to overlap domain.</p>
</dd>
<dt>ProbA</dt><dd><p>First order inclusion probability in frame A.</p>
</dd>
<dt>ProbB</dt><dd><p>First order inclusion probability in frame B. This probability is 0 for students included in domain a.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The sample, of size <code class="reqn">n_A = 180</code>, has been drawn from a population of <code class="reqn">N_A = 5500</code> students according to a proportional-to-size sampling desing according to the size of the school. So, students
attending bigger schools have a higher probability of being selected in the sample. <code class="reqn">N_{ab} = 2000</code> of the students composing the population belongs also to frame B.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DatPopM">DatPopM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
attach(DatMA)
#Let perform a brief descriptive analysis for the main variable
summary (Prog)
#And let do the same for the numerical auxiliary variables Read and Write
summary(Read)
summary(Write)
</code></pre>

<hr>
<h2 id='DatMB'>Database of students' program choice for frame B</h2><span id='topic+DatMB'></span>

<h3>Description</h3>

<p>This dataset contains some variables regarding the program choice for a sample of 232 students included in the sampling frame B.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatMB
</code></pre>


<h3>Format</h3>


<dl>
<dt>Id_Pop</dt><dd><p>An integer from 1 to <code class="reqn">N</code>, with <code class="reqn">N</code> the number of students in the whole population, identifying the student within the population.</p>
</dd>
<dt>Id_Frame</dt><dd><p>An integer from 1 to <code class="reqn">N_B</code>, with <code class="reqn">N_B</code> the number of students in the frame, identifying the student within the frame.</p>
</dd>
<dt>Prog</dt><dd><p>A factor with three categories (academic, general and vocation) indicating the program choice of the student.</p>
</dd>
<dt>Ses</dt><dd><p>An ordinal factor with three categories (low, middle and high) indicating the socio-economical status of the student.</p>
</dd>
<dt>Read</dt><dd><p>A number indicating the mark of the student in a reading test.</p>
</dd>
<dt>Write</dt><dd><p>A number indicating the mark of the student in a writing test.</p>
</dd>
<dt>Sch_Size</dt><dd><p>A number indicating the size of the school the students belongs to.</p>
</dd>
<dt>Domain</dt><dd><p>A string indicating the domain each student belongs to. Possible values are &quot;b&quot; if student belongs to domain b or &quot;ba&quot; if student belongs to overlap domain.</p>
</dd>
<dt>ProbA</dt><dd><p>First order inclusion probability in frame A. This probability is 0 for students included in domain b.</p>
</dd>
<dt>ProbB</dt><dd><p>First order inclusion probability in frame B.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The sample, of size <code class="reqn">n_B = 232</code>, has been drawn from a population of <code class="reqn">N_B = 6500</code> students according to a simple random sampling design.
<code class="reqn">N_{ab} = 2000</code> of the students composing the population belongs also to frame A.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DatPopM">DatPopM</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMB)
attach(DatMB)
#Let perform a brief descriptive analysis for the main variable
summary (Prog)
#And let do the same for the numerical auxiliary variables Read and Write
summary(Read)
summary(Write)
</code></pre>

<hr>
<h2 id='DatPopM'>Database of auxiliary information for the whole population of students</h2><span id='topic+DatPopM'></span>

<h3>Description</h3>

<p>This dataset contains population information about the auxiliary variables of the population of students
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DatPopM
</code></pre>


<h3>Format</h3>


<dl>
<dt>Ses</dt><dd><p>An ordinal factor with three categories (low, middle and high) indicating the socio-economical status of the student.</p>
</dd>
<dt>Read</dt><dd><p>A number indicating the mark of the student in a reading test.</p>
</dd>
<dt>Write</dt><dd><p>A number indicating the mark of the student in a writing test.</p>
</dd>
<dt>Domain</dt><dd><p>A string indicating the domain each student belongs to. Possible values are &quot;a&quot; if student belongs to domain a, &quot;b&quot; if student belongs to domain b or &quot;ab&quot; if student belongs to overlap domain.</p>
</dd>
</dl>


<h3>Details</h3>

<p>The population size is <code class="reqn">N = 10000</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DatMA">DatMA</a></code> <code><a href="#topic+DatMB">DatMB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatPopM)
attach(DatPopM)
#Let perform a brief descriptive analysis for the three auxiliary variables
summary (Ses)
summary(Read)
summary(Write)
</code></pre>

<hr>
<h2 id='Domains'>Domains</h2><span id='topic+Domains'></span>

<h3>Description</h3>

<p>Given a main vector, an auxiliary one and a value of the latter, identifies positions of the auxiliary vector corresponding
to values other than the given one. Then, turns zero values of the main vector corresponding to these positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Domains (y, domains, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Domains_+3A_y">y</code></td>
<td>
<p>A numeric main vector of size n</p>
</td></tr>
<tr><td><code id="Domains_+3A_domains">domains</code></td>
<td>
<p>A numeric/character/logic auxiliary vector of size n</p>
</td></tr>
<tr><td><code id="Domains_+3A_value">value</code></td>
<td>
<p>A value of the auxiliary vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector, copy of <code>y</code>, with some values turned zero depending on values of <code>domains</code> and <code>value</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########   Example 1   ##########
U &lt;- c(13, 18, 20, 14, 9)
#Let build an auxiliary vector indicating whether values in U are above or below the mean.
aux &lt;- c("Below", "Above", "Above", "Below", "Below")
#Now, only values below the mean remain, the other ones are turned zero.
Domains (U, aux, "Below")

##########   Example 2   ##########
data(DatA)
attach(DatA)
#Let calculate total feeding expenses corresponding to households in domain a.
sum (Domains (Feed, Domain, "a"))
</code></pre>

<hr>
<h2 id='FB'>Fuller-Burmeister estimator</h2><span id='topic+FB'></span>

<h3>Description</h3>

<p>Produces estimates for population totals and means using the Fuller - Burmeister estimator from survey data obtained
from a dual frame sampling desing. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FB(ysA, ysB, pi_A, pi_B, domains_A, domains_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FB_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="FB_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="FB_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="FB_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="FB_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="FB_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="FB_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fuller-Burmeister estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{FB} = \hat{Y}_a^A + \hat{\beta_1}\hat{Y}_{ab}^A + (1 - \hat{\beta_1})\hat{Y}_{ab}^B + \hat{Y}_b^B + \hat{\beta_2}(\hat{N}_{ab}^A - \hat{N}_{ab}^B)</code>
</p>

<p>where optimal values for <code class="reqn">\hat{\beta}</code> to minimize variance of the estimator are:
</p>
<p style="text-align: center;"><code class="reqn">
   \left( \begin{array}{c}
       \hat{\beta}_1\\
       \hat{\beta}_2
   \end{array} \right)
       = -
   \left( \begin{array}{cc}
       \hat{V}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B) &amp; \widehat{Cov}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B)\\
       \widehat{Cov}(\hat{Y}_{ab}^A - \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B) &amp; \hat{V}(\hat{N}_{ab}^A - \hat{N}_{ab}^B)
   \end{array} \right)^{-1}
       \times</code>
</p>

<p style="text-align: center;"><code class="reqn">
   \left( \begin{array}{c}
       \widehat{Cov}(\hat{Y}_a^A + \hat{Y}_b^B + \hat{Y}_{ab}^B, \hat{Y}_{ab}^A - \hat{Y}_{ab}^B)\\
       \widehat{Cov}(\hat{Y}_a^A + \hat{Y}_b^B + \hat{Y}_{ab}^B, \hat{N}_{ab}^A - \hat{N}_{ab}^B)
   \end{array} \right)
   </code>
</p>

<p>Due to Fuller-Burmeister estimator is not defined for estimating population sizes, estimation of the mean is computed as <code class="reqn">\hat{Y}_{FB} / \hat{N}_H</code>, where <code class="reqn">\hat{N}_H</code>
is the estimation of the population size using Hartley estimator.
Estimated variance for the Fuller-Burmeister estimator can be obtained through expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{FB}) = \hat{V}(\hat{Y}_a^A) + \hat{V}(\hat{Y}^B) + 
    \hat{\beta}_1[\widehat{Cov}(\hat{Y}_a^A, \hat{Y}_{ab}^A) - \widehat{Cov}(\hat{Y}^B, \hat{Y}_{ab}^B)]</code>
</p>
 
<p style="text-align: center;"><code class="reqn"> + \hat{\beta}_2[\widehat{Cov}(\hat{Y}_a^A, \hat{N}_{ab}^A) - \widehat{Cov}(\hat{Y}^B, \hat{N}_{ab}^B)]
 </code>
</p>

<p>If both first and second order probabilities are known, variances and covariances involved in calculation of <code class="reqn">\hat{\beta}</code> and <code class="reqn">\hat{V}(\hat{Y}_{FB})</code> are estimated using functions <code>VarHT</code> and <code>CovHT</code>, respectively. If
only first order probabilities are known, variances are estimated using Deville's method and covariances are estimated using following expression
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Cov}(\hat{X}, \hat{Y}) = \frac{\hat{V}(X + Y) - \hat{V}(X) - \hat{V}(Y)}{2}</code>
</p>



<h3>Value</h3>

<p><code>FB</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Fuller, W.A. and Burmeister, L.F. (1972).
<em>Estimation for Samples Selected From Two Overlapping Frames</em> ASA Proceedings of the Social Statistics Sections, 245 - 249.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hartley">Hartley</a></code> <code><a href="#topic+JackFB">JackFB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Fuller-Burmeister estimator for variable Clothing
FB(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate Fuller-Burmeister estimator and a 90% confidence interval
#for variable Leisure, considering only first order inclusion probabilities
FB(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 0.90)
</code></pre>

<hr>
<h2 id='Frames-internal'>Internal Frame Functions</h2><span id='topic+Lag1'></span><span id='topic+Lag2'></span><span id='topic+PELConfInt'></span>

<h3>Description</h3>

<p>Internal Frame functions
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='Hartley'>Hartley estimator</h2><span id='topic+Hartley'></span>

<h3>Description</h3>

<p>Produces estimates for population totals and means using Hartley estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hartley(ysA, ysB, pi_A, pi_B, domains_A, domains_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hartley_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="Hartley_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hartley estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_H = \hat{Y}_a^A + \hat{\theta}\hat{Y}_{ab}^A + (1 - \hat{\theta})\hat{Y}_{ab}^B + \hat{Y}_b^B</code>
</p>

<p>where <code class="reqn">\hat{\theta} \in [0, 1]</code>. Optimum value for <code class="reqn">\hat{\theta}</code> to minimize variance of the estimator is
</p>
<p style="text-align: center;"><code class="reqn">\hat{\theta}_{opt} = \frac{\hat{V}(\hat{Y}_{ab}^B) + \widehat{Cov}(\hat{Y}_b^B, \hat{Y}_{ab}^B) - \widehat{Cov}(\hat{Y}_a^A, \hat{Y}_{ab}^A)}{\hat{V}(\hat{Y}_{ab}^A) + \hat{V}(\hat{Y}_{ab}^B)}</code>
</p>

<p>Taking into account the independence between <code class="reqn">s_A</code> and <code class="reqn">s_B</code>, an estimator for the variance of the Hartley estimator can be obtained as follows:
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_H) = \hat{V}(\hat{Y}_a^A + \hat{\theta}\hat{Y}_{ab}^A) + \hat{V}((1 - \hat{\theta})\hat{Y}_{ab}^B + \hat{Y}_b^B)</code>
</p>

<p>If both first and second order probabilities are known, variances and covariances involved in calculation of <code class="reqn">\hat{\theta}_{opt}</code> and <code class="reqn">\hat{V}(\hat{Y}_H)</code> are estimated using functions <code>VarHT</code> and <code>CovHT</code>, respectively. If
only first order probabilities are known, variances are estimated using Deville's method and covariances are estimated using following expression
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Cov}(\hat{X}, \hat{Y}) = \frac{\hat{V}(X + Y) - \hat{V}(X) - \hat{V}(Y)}{2}</code>
</p>



<h3>Value</h3>

<p><code>Hartley</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Hartley, H. O. (1962)
<em>Multiple Frames Surveys.</em>
Proceedings of the American Statistical Association, Social Statistics Sections, 203 - 206.
</p>
<p>Hartley, H. O. (1974) 
<em>Multiple frame methodology and selected applications.</em>
Sankhya C, Vol. 36, 99 - 118.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackHartley">JackHartley</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Hartley estimator for variable Feeding
Hartley(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate Hartley estimator and a 90% confidence interval
#for variable Leisure, considering only first order inclusion probabilities
Hartley(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 0.90)
</code></pre>

<hr>
<h2 id='HT'>Horvitz - Thompson estimator</h2><span id='topic+HT'></span>

<h3>Description</h3>

<p>Computes the Horvitz - Thompson estimator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HT(y, pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="HT_+3A_y">y</code></td>
<td>
<p>A numeric vector of size n containing information about variable of interest</p>
</td></tr>
<tr><td><code id="HT_+3A_pik">pik</code></td>
<td>
<p>A numeric vector of size n containing first order inclusion probabilities for units included in <code>y</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Horvitz - Thompson estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{HT} = \sum_{k \in s} \frac{y_k}{\pi_k}</code>
</p>



<h3>Value</h3>

<p>A numeric value representing Horvitz - Thompson estimator for population total for considered values
</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952)
<em>A generalization of sampling without replacement from a finite universe.</em>
Journal of the American Statistical Association, 47, 663 - 685
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarHT">VarHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########   Example 1   ##########
U &lt;- c(13, 18, 20, 14, 9)
#A simple random sample of size 2 without replacement is drawn from population
s &lt;- sample(U, 2)
ps &lt;- c(0.4, 0.4)
HT(s, ps)

##########   Example 2   ##########
data(DatA)
attach(DatA)
#Let estimate population total for variable Feeding in frame A
HT(Feed, ProbA)
</code></pre>

<hr>
<h2 id='JackBKA'>Confidence intervals for Bankier-Kalton-Anderson estimator based on jackknife method</h2><span id='topic+JackBKA'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for Bankier-Kalton-Anderson estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackBKA(ysA, ysB, piA, piB, pik_ab_B, pik_ba_A, domainsA, domainsB, 
conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, clusA = NULL,
clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackBKA_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nA</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nB</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackBKA_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BKA">BKA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Clothing,
#supposing a stratified sampling in frame A and a simple random sampling without
#replacement  in frame B with no finite population correction factor in any frame.
JackBKA(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$ProbB,
DatB$ProbA, DatA$Domain, DatB$Domain, 0.95, "str", "srs",
strA = DatA$Stratum)

#Let check how interval estimation varies when a finite 
#population correction factor is considered in both frames.
JackBKA(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$ProbB,
DatB$ProbA, DatA$Domain, DatB$Domain, 0.95, "str", "srs", 
strA = DatA$Stratum, fcpA = TRUE, fcpB = TRUE)
</code></pre>

<hr>
<h2 id='JackCalDF'>Confidence intervals for dual frame calibration estimator based on jackknife method</h2><span id='topic+JackCalDF'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for dual frame calibration estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackCalDF(ysA, ysB, piA, piB, domainsA, domainsB, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, 
xsBFrameB = NULL, xsT = NULL, XA = NULL, XB = NULL, X = NULL, met = "linear", 
conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, clusA = NULL,
clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackCalDF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackCalDF_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_A}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalDF">CalDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Clothing,
#with frame sizes and overlap domain size known, supposing a stratified
#sampling in frame A and a simple random sampling without replacement 
#in frame B with no finite population correction factor in any frame.
JackCalDF(DatA$Clo, DatB$Clo, DatA$ProbA, DatB$ProbB, 
DatA$Domain, DatB$Domain, N_A = 1735, N_B = 1191, N_ab = 601, conf_level = 0.95,
sdA = "str", sdB = "srs", strA = DatA$Stratum)

#Finally, let consider a finite population correction factor in both frames.
JackCalDF(DatA$Clo, DatB$Clo, DatA$ProbA, DatB$ProbB, 
DatA$Domain, DatB$Domain, N_A = 1735, N_B = 1191, N_ab = 601, conf_level = 0.95,
sdA = "str", sdB = "srs", strA = DatA$Stratum, fcpA = TRUE, fcpB = TRUE)
</code></pre>

<hr>
<h2 id='JackCalSF'>Confidence intervals for SF calibration estimator based on jackknife method</h2><span id='topic+JackCalSF'></span>

<h3>Description</h3>

<p>Produces estimates for variance of SF calibration estimator using Jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackCalSF(ysA, ysB, piA, piB, pik_ab_B, pik_ba_A, domainsA, domainsB, 
N_A = NULL, N_B = NULL, N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, 
xsAFrameB = NULL, xsBFrameB = NULL, xsT = NULL, XA = NULL, XB = NULL,  
X = NULL, met = "linear", conf_level, sdA = "srs", sdB = "srs", strA = NULL, 
strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackCalSF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nA</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nB</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackCalSF_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CalSF">CalSF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Clothing,
#with frame sizes and overlap domain size known, supposing a stratified
#sampling in frame A and a simple random sampling without replacement 
#in frame B with no finite population correction factor in any frame
JackCalSF(DatA$Clo, DatB$Clo, DatA$ProbA, DatB$ProbB, 
DatA$ProbB, DatB$ProbA, DatA$Domain, DatB$Domain, N_A = 1735, 
N_B = 1191, N_ab = 601, conf_level = 0.95, sdA = "str", sdB = "srs",
strA = DatA$Stratum)
</code></pre>

<hr>
<h2 id='JackFB'>Confidence intervals for Fuller-Burmeister estimator based on jackknife method</h2><span id='topic+JackFB'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for Fuller-Burmeister estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackFB(ysA, ysB, piA, piB, domainsA, domains_B, conf_level, sdA = "srs", 
sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, 
fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackFB_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackFB_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FB">FB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Clothing,
#supposing a stratified sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction factor
#in any frame.
JackFB(DatA$Clo, DatB$Clo, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 0.95, "str", "srs", strA = DatA$Stratum)

#Let check how interval estimation varies when a finite
#population correction factor is considered in both frames.
JackFB(DatA$Clo, DatB$Clo, DatA$ProbA, DatB$ProbB, DatA$Domain,
DatB$Domain, 0.95, "str", "srs", strA = DatA$Stratum,
fcpA = TRUE, fcpB = TRUE)
</code></pre>

<hr>
<h2 id='JackHartley'>Confidence intervals for Hartley estimator based on jackknife method</h2><span id='topic+JackHartley'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for Hartley estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackHartley(ysA, ysB, piA, piB, domainsA, domainsB, conf_level, sdA = "srs", 
sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, 
fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackHartley_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackHartley_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Hartley">Hartley</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a stratified sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackHartley(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$Domain,
DatB$Domain, 0.95, "str", "srs", strA = DatA$Stratum)

#Let check how interval estimation varies when a finite 
#population correction factor is considered in both frames.
JackHartley(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$Domain,
DatB$Domain, 0.95, "str", "srs", strA = DatA$Stratum, fcpA = TRUE,
fcpB = TRUE)
</code></pre>

<hr>
<h2 id='JackMLCDF'>Confidence intervals for MLCDF estimator based on jackknife method</h2><span id='topic+JackMLCDF'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLCDF estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLCDF (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, xA, xB, ind_samA, 
ind_samB, ind_domA, ind_domB, N, N_ab = NULL, met = "linear", conf_level, sdA = "srs", 
sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, 
fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLCDF_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_xa">xA</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information for the units in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_xb">xB</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information for the units in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_ind_sama">ind_samA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing the identificators of units of the frame A (from 1 to <code class="reqn">N_A</code>) that belongs to <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_ind_samb">ind_samB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing the identificators of units of the frame B (from 1 to <code class="reqn">N_B</code>) that belongs to <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_ind_doma">ind_domA</code></td>
<td>
<p>A character vector of length <code class="reqn">N_A</code> indicating the domain each unit from frame A belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_ind_domb">ind_domB</code></td>
<td>
<p>A character vector of length <code class="reqn">N_B</code> indicating the domain each unit from frame B belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_n">N</code></td>
<td>
<p>A numeric value indicating the size of the population.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLCDF_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLCDF">MLCDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

N &lt;- nrow(DatPopM)
levels(DatPopM$Domain) &lt;- c(levels(DatPopM$Domain), "ba")
DatPopMA &lt;- subset(DatPopM, DatPopM$Domain == "a" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB &lt;- subset(DatPopM, DatPopM$Domain == "b" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB[DatPopMB$Domain == "ab",]$Domain &lt;- "ba"


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLCDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, 
DatMB$Domain, DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, 
DatMA$Id_Frame, DatMB$Id_Frame, DatPopMA$Domain, DatPopMB$Domain, N, 
conf_level = 0.95, sdA = "pps", sdB = "srs")

</code></pre>

<hr>
<h2 id='JackMLCDW'>Confidence intervals for MLCDW estimator based on jackknife method</h2><span id='topic+JackMLCDW'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLCDW estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLCDW (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, x, 
 ind_sam, N_A, N_B, N_ab = NULL, met = "linear", conf_level, sdA = "srs", 
 sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, clusB = NULL, 
 fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLCDW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLCDW_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of an estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLCDW">MLCDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
N_FrameA &lt;- nrow(DatPopM[DatPopM$Domain == "a" | DatPopM$Domain == "ab",])
N_FrameB &lt;- nrow(DatPopM[DatPopM$Domain == "b" | DatPopM$Domain == "ab",])


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, 
DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, 
N_FrameB, conf_level = 0.95, sdA = "pps", sdB = "srs")

</code></pre>

<hr>
<h2 id='JackMLCSW'>Confidence intervals for MLCSW estimator based on jackknife method</h2><span id='topic+JackMLCSW'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLCSW estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLCSW (ysA, ysB, pik_A, pik_B, pik_ab_B, pik_ba_A, domains_A, 
 domains_B, xsA, xsB, x, ind_sam, N_A, N_B, N_ab = NULL, met = "linear", 
 conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, 
 clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLCSW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLCSW_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of an estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLCSW">MLCSW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
N_FrameA &lt;- nrow(DatPopM[DatPopM$Domain == "a" | DatPopM$Domain == "ab",])
N_FrameB &lt;- nrow(DatPopM[DatPopM$Domain == "b" | DatPopM$Domain == "ab",])


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLCSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, 
DatMB$ProbA, DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, 
IndSample, N_FrameA, N_FrameB, conf_level = 0.95, sdA = "pps", sdB = "srs")

</code></pre>

<hr>
<h2 id='JackMLDF'>Confidence intervals for MLDF estimator based on jackknife method</h2><span id='topic+JackMLDF'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLDF estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLDF (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, xA, xB, ind_samA, 
ind_samB, ind_domA, ind_domB, N, conf_level, sdA = "srs", sdB = "srs", strA = NULL, 
strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLDF_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_xa">xA</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information for the units in frame A.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_xb">xB</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information for the units in frame B.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_ind_sama">ind_samA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing the identificators of units of the frame A (from 1 to <code class="reqn">N_A</code>) that belongs to <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_ind_samb">ind_samB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing the identificators of units of the frame B (from 1 to <code class="reqn">N_B</code>) that belongs to <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_ind_doma">ind_domA</code></td>
<td>
<p>A character vector of length <code class="reqn">N_A</code> indicating the domain each unit from frame A belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_ind_domb">ind_domB</code></td>
<td>
<p>A character vector of length <code class="reqn">N_B</code> indicating the domain each unit from frame B belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_n">N</code></td>
<td>
<p>A numeric value indicating the size of the population.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLDF_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLDF">MLDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

N &lt;- nrow(DatPopM)
levels(DatPopM$Domain) &lt;- c(levels(DatPopM$Domain), "ba")
DatPopMA &lt;- subset(DatPopM, DatPopM$Domain == "a" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB &lt;- subset(DatPopM, DatPopM$Domain == "b" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB[DatPopMB$Domain == "ab",]$Domain &lt;- "ba"


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, 
DatMB$Domain, DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, 
DatMA$Id_Frame, DatMB$Id_Frame, DatPopMA$Domain, DatPopMB$Domain, N, 0.95, 
"pps", "srs")

</code></pre>

<hr>
<h2 id='JackMLDW'>Confidence intervals for MLDW estimator based on jackknife method</h2><span id='topic+JackMLDW'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLDW estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLDW (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, x, 
ind_sam, conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, 
clusA = NULL, clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLDW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLDW_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLDW">MLDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, 
DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, 0.95, 
"pps", "srs")

</code></pre>

<hr>
<h2 id='JackMLSW'>Confidence intervals for MLSW estimator based on jackknife method</h2><span id='topic+JackMLSW'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for MLSW estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackMLSW (ysA, ysB, pik_A, pik_B, pik_ab_B, pik_ba_A, domains_A, 
 domains_B, xsA, xsB, x, ind_sam, conf_level, sdA = "srs", sdB = "srs", 
 strA = NULL, strB = NULL, clusA = NULL, clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackMLSW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackMLSW_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MLSW">MLSW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM)

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)


#Let obtain a 95% jackknife confidence interval for variable Feeding,
#supposing a pps sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackMLSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, 
DatMB$ProbA, DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, 
IndSample, 0.95, "pps", "srs")

</code></pre>

<hr>
<h2 id='JackPEL'>Confidence intervals for the pseudo empirical likelihood estimator based on jackknife method</h2><span id='topic+JackPEL'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for pseudo empirical likelihood estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackPEL(ysA, ysB, piA, piB, domainsA, domainsB, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
XA = NULL, XB = NULL, conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, 
clusA = NULL,clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackPEL_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackPEL_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PEL">PEL</a></code>
</p>

<hr>
<h2 id='JackPML'>Confidence intervals for the pseudo maximum likelihood estimator based on jackknife method</h2><span id='topic+JackPML'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for pseudo maximum likelihood estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackPML(ysA, ysB, piA, piB, domainsA, domainsB, N_A, N_B, conf_level, 
sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, clusA = NULL, clusB = NULL,  
fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackPML_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackPML_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackPML_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackPML_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PML">PML</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)

#Let obtain a 95% jackknife confidence interval for variable Leisure,
#supposing a stratified sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction
#factor in any frame.
JackPML(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 1735, 1191, 0.95, "str", "srs", strA = DatA$Stratum)

#Let check how interval estimation varies when a finite 
#population correction factor is considered in both frames.
JackPML(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$Domain, 
DatB$Domain, 1735, 1191, 0.95, "str", "srs", strA = DatA$Stratum,
fcpA = TRUE, fcpB = TRUE)
</code></pre>

<hr>
<h2 id='JackSFRR'>Confidence intervals for raking ratio estimator based on jackknife method</h2><span id='topic+JackSFRR'></span>

<h3>Description</h3>

<p>Calculates confidence intervals for raking ratio estimator using jackknife procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>JackSFRR(ysA, ysB, piA, piB, pik_ab_B, pik_ba_A, domainsA, domainsB, N_A, 
N_B, conf_level, sdA = "srs", sdB = "srs", strA = NULL, strB = NULL, clusA = NULL,   
clusB = NULL, fcpA = FALSE, fcpB = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="JackSFRR_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a numeric matrix or data frame of dimensions <code class="reqn">nA</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a numeric matrix or data frame of dimensions <code class="reqn">nB</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_pia">piA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nA</code> or a square numeric matrix of dimension <code class="reqn">nA</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_pib">piB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">nB</code> or a square numeric matrix of dimension <code class="reqn">nB</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nA</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">nB</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_domainsa">domainsA</code></td>
<td>
<p>A character vector of size <code class="reqn">nA</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_domainsb">domainsB</code></td>
<td>
<p>A character vector of size <code class="reqn">nB</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for the confidence intervals.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_sda">sdA</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame A. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_sdb">sdB</code></td>
<td>
<p>(Optional) A character vector indicating the sampling design considered in frame B. Possible values are &quot;srs&quot; (simple random sampling without replacement), &quot;pps&quot; (probabilities proportional to size sampling), &quot;str&quot; (stratified sampling), &quot;clu&quot; (cluster sampling) and &quot;strclu&quot; (stratified cluster sampling). Default is &quot;srs&quot;.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_stra">strA</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame A belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_strb">strB</code></td>
<td>
<p>(Optional) A numeric vector indicating the stratum each unit in frame B belongs to, if a stratified sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_clusa">clusA</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame A belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame A.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_clusb">clusB</code></td>
<td>
<p>(Optional) A numeric vector indicating the cluster each unit in frame B belongs to, if a cluster sampling or a stratified cluster sampling has been considered in frame B.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_fcpa">fcpA</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame A. Default is FALSE.</p>
</td></tr>
<tr><td><code id="JackSFRR_+3A_fcpb">fcpB</code></td>
<td>
<p>(Optional) A logic value indicating if a finite population correction factor should be considered in frame B. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let suppose a non stratified sampling design in frame A and a stratified sampling design in frame B where frame has been divided into L strata and a sample of size <code class="reqn">n_{Bl}</code> from the <code class="reqn">N_{Bl}</code> composing the l-th stratum is selected
In this context, jackknife variance estimator of a estimator <code class="reqn">\hat{Y}_c</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">v_J(\hat{Y}_c) = \frac{n_{A}-1}{n_{A}}\sum_{i\in s_A} (\hat{Y}_{c}^{A}(i) -\overline{Y}_{c}^{A})^2 + \sum_{l=1}^{L}\frac{n_{Bl}-1}{n_{Bl}}  \sum_{i\in s_{Bl}} (\hat{Y}_{c}^{B}(lj) -\overline{Y}_{c}^{Bl})^2</code>
</p>

<p>with <code class="reqn">\hat{Y}_c^A(i)</code> the value of estimator <code class="reqn">\hat{Y}_c</code> after dropping <code class="reqn">i-th</code> unit from <code>ysA</code> and <code class="reqn">\overline{Y}_{c}^{A}</code> the mean of values <code class="reqn">\hat{Y}_c^A(i)</code>.
Similarly, <code class="reqn">\hat{Y}_c^B(lj)</code> is the value taken by <code class="reqn">\hat{Y}_c</code> after dropping j-th unit of l-th from sample <code>ysB</code> and <code class="reqn">\overline{Y}_{c}^{Bl}</code> is the mean of values <code class="reqn">\hat{Y}_c^B(lj)</code>.
If needed, a finite population correction factor can be included in frames by replacing <code class="reqn">\hat{Y}_{c}^{A}(i)</code> or <code class="reqn">\hat{Y}_{c}^{B}(lj)</code> with <code class="reqn">\hat{Y}_{c}^{A*}(i)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_A} (\hat{Y}_{c}^{A}(i) -\hat{Y}_{c})</code> or
<code class="reqn">\hat{Y}_{c}^{B*}(lj)= \hat{Y}_{c}+\sqrt{1-\overline{\pi}_B} (\hat{Y}_{c}^{B}(lj) -\hat{Y}_{c})</code>, where <code class="reqn">\overline{\pi}_A = \sum_{i \in s_A}\pi_{iA}/nA</code> and <code class="reqn">\overline{\pi}_B = \sum_{j \in s_B}\pi_{jB}/nB</code>
A confidence interval for any parameter of interest, <code class="reqn">Y</code> can be calculated, then, using the pivotal method.
</p>


<h3>Value</h3>

<p>A numeric matrix containing estimations of population total and population mean and their corresponding confidence intervals obtained through jackknife method.
</p>


<h3>References</h3>

<p>Wolter, K. M. (2007)
<em>Introduction to Variance Estimation.</em>
2nd Edition. Springer, Inc., New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SFRR">SFRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB) 

#Let obtain a 95% jackknife confidence interval for variable Leisure,
#supposing a stratified sampling in frame A and a simple random sampling
#without replacement in frame B with no finite population correction 
#factor in any frame.
JackSFRR(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$ProbB, 
DatB$ProbA, DatA$Domain, DatB$Domain, 1735, 1191, 0.95, "str", "srs",
strA = DatA$Stratum)

#Let check how interval estimation varies when a finite 
#population correction factor is considered in both frames.
JackSFRR(DatA$Lei, DatB$Lei, DatA$ProbA, DatB$ProbB, DatA$ProbB, 
DatB$ProbA, DatA$Domain, DatB$Domain, 1735, 1191, 0.95, "str", "srs", 
strA = DatA$Stratum, fcpA = TRUE, fcpB = TRUE)
</code></pre>

<hr>
<h2 id='MLCDF'>Multinomial logistic calibration estimator under dual frame approach with auxiliary information from each frame</h2><span id='topic+MLCDF'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a model calibrated dual frame approach with a possibly different set of auxiliary variables for each frame.
Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLCDF (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, xA, xB, ind_samA, 
 ind_samB, ind_domA, ind_domB, N, N_ab = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLCDF_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_xa">xA</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information for the units in frame A.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_xb">xB</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information for the units in frame B.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_ind_sama">ind_samA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing the identificators of units of the frame A (from 1 to <code class="reqn">N_A</code>) that belongs to <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_ind_samb">ind_samB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing the identificators of units of the frame B (from 1 to <code class="reqn">N_B</code>) that belongs to <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_ind_doma">ind_domA</code></td>
<td>
<p>A character vector of length <code class="reqn">N_A</code> indicating the domain each unit from frame A belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_ind_domb">ind_domB</code></td>
<td>
<p>A character vector of length <code class="reqn">N_B</code> indicating the domain each unit from frame B belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_n">N</code></td>
<td>
<p>A numeric value indicating the size of the population.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="MLCDF_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic calibration estimator in dual frame using auxiliary information from each frame for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLCi}^{DF} = \frac{1}{N} \left(\sum_{k \in s_A \cup s_B} w_k^{\circ} z_{ki}\right), \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
and <code class="reqn">w^{\circ}</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are known, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_a}w_k^{\circ} = N_a, \sum_{k \in s_{ab}}w_k^{\circ} = \eta N_{ab}, \sum_{k \in s_{ba}}w_k^{\circ} = (1 - \eta) N_{ab}\sum_{k \in s_{b}}w_k^{\circ} = N_{b},</code>
</p>
 <p style="text-align: center;"><code class="reqn">\sum_{k \in s_A}w_k^\circ p_{ki}^A = \sum_{k \in U_a} p_{ki}^A + \eta \sum_{k \in U_{ab}} p_{ki}^A</code>
</p>

<p>and </p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_B}w_k^\circ p_{ki}^B = \sum_{k \in U_b} p_{ki}^B + (1 - \eta) \sum_{k \in U_{ba}} p_{ki}^B</code>
</p>

<p>with <code class="reqn">\eta \in (0,1)</code> and </p>
<p style="text-align: center;"><code class="reqn">p_{ki}^A = \frac{exp(x_k^{'}\beta_i^A)}{\sum_{r=1}^m exp(x_k^{'}\beta_r^A)},</code>
</p>

<p>being <code class="reqn">\beta_i^A</code> the maximum likelihood parameters of the multinomial logistic model considering original design weights <code class="reqn">d^A</code>. <code class="reqn">p_{ki}^B</code> can be defined similarly.
</p>


<h3>Value</h3>

<p><code>MLCDF</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLCDF">JackMLCDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

N &lt;- nrow(DatPopM)
levels(DatPopM$Domain) &lt;- c(levels(DatPopM$Domain), "ba")
DatPopMA &lt;- subset(DatPopM, DatPopM$Domain == "a" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB &lt;- subset(DatPopM, DatPopM$Domain == "b" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB[DatPopMB$Domain == "ab",]$Domain &lt;- "ba"

#Let calculate proportions of categories of variable Prog using MLCDF estimator
#using Read as auxiliary variable
MLCDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, DatMA$Id_Frame, DatMB$Id_Frame, 
DatPopMA$Domain, DatPopMB$Domain, N)

#Let obtain 95% confidence intervals together with the estimations
MLCDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, DatMA$Id_Frame, DatMB$Id_Frame, 
DatPopMA$Domain, DatPopMB$Domain, N, conf_level = 0.95)
</code></pre>

<hr>
<h2 id='MLCDW'>Multinomial logistic calibration estimator under dual frame approach with auxiliary information from the whole population</h2><span id='topic+MLCDW'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a model calibrated dual frame approach with auxiliary information from the whole population. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLCDW (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, x, ind_sam, N_A, 
 N_B, N_ab = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLCDW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="MLCDW_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="MLCDW_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic calibration estimator in dual frame using auxiliary information from the whole population for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLCi}^{DW} = \frac{1}{N} \left(\sum_{k \in s_A \cup s_B} w_k^{\circ} z_{ki}\right), \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
and <code class="reqn">w^{\circ}</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are known, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_a}w_k^{\circ} = N_a, \sum_{k \in s_{ab}}w_k^{\circ} = \eta N_{ab}, \sum_{k \in s_{ba}}w_k^{\circ} = (1 - \eta) N_{ab}, \sum_{k \in s_{b}}w_k^{\circ} = N_{b}</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_A \cup s_B}w_k^\circ p_{ki}^{\circ} = \sum_{k \in U} p_{ki}^\circ</code>
</p>

<p>with <code class="reqn">\eta \in (0,1)</code> and </p>
<p style="text-align: center;"><code class="reqn">p_{ki}^{\circ} = \frac{exp(x_k^{'}\beta_i^{\circ})}{\sum_{r=1}^m exp(x_k^{'}\beta_r^{\circ})},</code>
</p>

<p>being <code class="reqn">\beta_i^\circ</code> the maximum likelihood parameters of the multinomial logistic model considering weights <code class="reqn">d_k^{\circ} =\left\{\begin{array}{lcc}
 d_k^A &amp; \textrm{if } k \in a\\
 \eta d_k^A &amp; \textrm{if } k \in ab\\
 (1 - \eta) d_k^B &amp; \textrm{if } k \in ba \\
 d_k^B &amp; \textrm{if } k \in b
 \end{array}
 \right.</code>.
</p>


<h3>Value</h3>

<p><code>MLCDW</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLCDW">JackMLCDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
N_FrameA &lt;- nrow(DatPopM[DatPopM$Domain == "a" | DatPopM$Domain == "ab",])
N_FrameB &lt;- nrow(DatPopM[DatPopM$Domain == "b" | DatPopM$Domain == "ab",])
N_Domainab &lt;- nrow(DatPopM[DatPopM$Domain == "ab",])
#Let calculate proportions of categories of variable Prog using MLCDW estimator
#using Read as auxiliary variable
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB)

#Now, let suppose that the overlap domian size is known
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB, N_Domainab)

#Let obtain 95% confidence intervals together with the estimations
MLCDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, N_FrameB, N_Domainab,
conf_level = 0.95)
</code></pre>

<hr>
<h2 id='MLCSW'>Multinomial logistic calibration estimator under single frame approach with auxiliary information from the whole population</h2><span id='topic+MLCSW'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a model calibrated single frame approach with auxiliary information from the whole population. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLCSW (ysA, ysB, pik_A, pik_B, pik_ab_B, pik_ba_A, domains_A, domains_B, xsA, xsB,
 x, ind_sam, N_A, N_B, N_ab = NULL, met = "linear", conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLCSW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="MLCSW_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
<tr><td><code id="MLCSW_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic calibration estimator in single frame using auxiliary information from the whole population for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLCi}^{SW} = \frac{1}{N} \left(\sum_{k \in s_A \cup s_B} \tilde{w}_k z_{ki}\right) \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
and <code class="reqn">\tilde{w}</code> calibration weights which are calculated having into account a different set of constraints, depending on the case. For instance, if <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> are known, calibration constraints are
</p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_a}\tilde{w}_k = N_a, \sum_{k \in s_{ab} \cup s_{ba}}\tilde{w}_k = N_{ab}, \sum_{k \in s_{ba}}\tilde{w}_k = N_{ba}</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn">\sum_{k \in s_A \cup s_B}\tilde{w}_k \tilde{p}_{ki} = \sum_{k \in U} \tilde{p}_{ki}</code>
</p>

<p>with </p>
<p style="text-align: center;"><code class="reqn">\tilde{p}_{ki} = \frac{exp(x_k^{'}\tilde{\beta_i})}{\sum_{r=1}^m exp(x_k^{'}\tilde{\beta_r})},</code>
</p>

<p>being <code class="reqn">\tilde{\beta_i}</code> the maximum likelihood parameters of the multinomial logistic model considering weights <code class="reqn">\tilde{d}_k =\left\{\begin{array}{lcc}
 d_k^A &amp; \textrm{if } k \in a\\
 (1/d_k^A + 1/d_k^B)^{-1} &amp; \textrm{if } k \in ab \cup ba \\
 d_k^B &amp; \textrm{if } k \in b
 \end{array}
 \right.</code>.
</p>


<h3>Value</h3>

<p><code>MLCSW</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLCSW">JackMLCSW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
N_FrameA &lt;- nrow(DatPopM[DatPopM$Domain == "a" | DatPopM$Domain == "ab",])
N_FrameB &lt;- nrow(DatPopM[DatPopM$Domain == "b" | DatPopM$Domain == "ab",])
N_Domainab &lt;- nrow(DatPopM[DatPopM$Domain == "ab",])
#Let calculate proportions of categories of variable Prog using MLCSW estimator
#using Read as auxiliary variable
MLCSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, DatMB$ProbA,
DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, 
N_FrameB)

#Now, let suppose that the overlap domian size is known
MLCSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, DatMB$ProbA,
DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, 
N_FrameB, N_Domainab)

#Let obtain 95% confidence intervals together with the estimations
MLCSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, DatMB$ProbA,
DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, N_FrameA, 
N_FrameB, N_Domainab, conf_level = 0.95)
</code></pre>

<hr>
<h2 id='MLDF'>Multinomial logistic estimator under dual frame approach with auxiliary information from each frame</h2><span id='topic+MLDF'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a model assisted approach with a possibly different set of auxiliary variables for each frame. Confidence intervals are 
also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLDF (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, xA, xB, ind_samA, 
 ind_samB, ind_domA, ind_domB, N, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLDF_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_xa">xA</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information for the units in frame A.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_xb">xB</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">N_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information for the units in frame B.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_ind_sama">ind_samA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing the identificators of units of the frame A (from 1 to <code class="reqn">N_A</code>) that belongs to <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_ind_samb">ind_samB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing the identificators of units of the frame B (from 1 to <code class="reqn">N_B</code>) that belongs to <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_ind_doma">ind_domA</code></td>
<td>
<p>A character vector of length <code class="reqn">N_A</code> indicating the domain each unit from frame A belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_ind_domb">ind_domB</code></td>
<td>
<p>A character vector of length <code class="reqn">N_B</code> indicating the domain each unit from frame B belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_n">N</code></td>
<td>
<p>A numeric value indicating the size of the population.</p>
</td></tr>
<tr><td><code id="MLDF_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic estimator in dual frame using auxiliary information from each frame for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLi}^{DF} = \frac{1}{N} \left(\sum_{k \in U_a} p_{ki}^A + \eta \sum_{k \in U_{ab}} p_{ki}^A + (1 - \eta) \sum_{k \in U_{ba}} p_{ki}^B + \sum_{k \in U_b} p_{ki}^B \right.</code>
</p>

<p style="text-align: center;"><code class="reqn">+ \sum_{k \in s_a} d_k^A (z_{ki} - p_{ki}^A) + \eta \sum_{k \in s_{ab}} d_k^A (z_{ki} - p_{ki}^A)</code>
</p>

<p style="text-align: center;"><code class="reqn">\left. + (1 - \eta) \sum_{k \in s_{ba}} d_k^B (z_{ki} - p_{ki}^B) + \sum_{k \in s_b} d_k^B (z_{ki} - p_{ki}^B)\right), \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">\eta \in (0,1)</code>, <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
<code class="reqn">d^A</code> and <code class="reqn">d^B</code> the design weights for each frame, defined as the inverse of the first order inclusion probabilities and
</p>
<p style="text-align: center;"><code class="reqn">p_{ki}^A = \frac{exp(x_k^{'}\beta_i^A)}{\sum_{r=1}^m exp(x_k^{'}\beta_r^A)},</code>
</p>

<p>being <code class="reqn">\beta_i^A</code> the maximum likelihood parameters of the multinomial logistic model considering weights <code class="reqn">d^A</code>. <code class="reqn">p_{ki}^B</code> can be defined similarly.
</p>


<h3>Value</h3>

<p><code>MLDF</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Lehtonen, R. and Veijanen, A. (1998) 
<em>On multinomial logistic generalizaed regression estimators</em>
Technical report 22, Department of Statistics, University of Jyvaskyla.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLDF">JackMLDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

N &lt;- nrow(DatPopM)
levels(DatPopM$Domain) &lt;- c(levels(DatPopM$Domain), "ba")
DatPopMA &lt;- subset(DatPopM, DatPopM$Domain == "a" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB &lt;- subset(DatPopM, DatPopM$Domain == "b" | DatPopM$Domain == "ab", stringAsFactors = FALSE)
DatPopMB[DatPopMB$Domain == "ab",]$Domain &lt;- "ba"

#Let calculate proportions of categories of variable Prog using MLDF estimator
#using Read as auxiliary variable
MLDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, DatMA$Id_Frame, DatMB$Id_Frame, 
DatPopMA$Domain, DatPopMB$Domain, N)

#Let obtain 95% confidence intervals together with the estimations
MLDF(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopMA$Read, DatPopMB$Read, DatMA$Id_Frame, DatMB$Id_Frame, 
DatPopMA$Domain, DatPopMB$Domain, N, conf_level = 0.95)
</code></pre>

<hr>
<h2 id='MLDW'>Multinomial logistic estimator under dual frame approach with auxiliary information from the whole population</h2><span id='topic+MLDW'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design using a dual frame model assisted approach. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLDW (ysA, ysB, pik_A, pik_B, domains_A, domains_B, xsA, xsB, x, ind_sam, 
 conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLDW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="MLDW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="MLDW_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic estimator in dual frame using auxiliary information from the whole population for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLi}^{DW} = \frac{1}{N} (\sum_{k \in U} p_{ki}^{\circ} + \sum_{k \in s} {d}_k^{\circ} (z_{ki} - p_{ki}^{\circ})) \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
<code class="reqn">d_k^{\circ} =\left\{\begin{array}{lcc}
 d_k^A &amp; \textrm{if } k \in a\\
 \eta d_k^A &amp; \textrm{if } k \in ab\\
 (1 - \eta) d_k^B &amp; \textrm{if } k \in ba \\
 d_k^B &amp; \textrm{if } k \in b
 \end{array}
 \right.</code>
with <code class="reqn">\eta \in (0,1)</code> and </p>
<p style="text-align: center;"><code class="reqn">p_{ki}^\circ = \frac{exp(x_k^{'}\beta_i^{\circ})}{\sum_{r=1}^m exp(x_k^{'}\beta_r^{\circ})},</code>
</p>

<p>being <code class="reqn">\beta_i^{\circ}</code> the maximum likelihood parameters of the multinomial logistic model considering the weights <code class="reqn">d^{\circ}</code>.
</p>


<h3>Value</h3>

<p><code>MLDW</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Lehtonen, R. and Veijanen, A. (1998) 
<em>On multinomial logistic generalizaed regression estimators</em>
Technical report 22, Department of Statistics, University of Jyvaskyla.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLDW">JackMLDW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
#Let calculate proportions of categories of variable Prog using MLDW estimator
#using Read as auxiliary variable
MLDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample)

#Let obtain 95% confidence intervals together with the estimations
MLDW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$Domain, DatMB$Domain, 
DatMA$Read, DatMB$Read, DatPopM$Read, IndSample, 0.95)
</code></pre>

<hr>
<h2 id='MLSW'>Multinomial logistic estimator under single frame approach with auxiliary information from the whole population</h2><span id='topic+MLSW'></span>

<h3>Description</h3>

<p>Produces estimates for class totals and proportions using multinomial logistic regression from survey data obtained
from a dual frame sampling design with the same set of auxiliary variables for the whole population. Confidence intervals are 
also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLSW (ysA, ysB, pik_A, pik_B, pik_ab_B, pik_ba_A, domains_A, domains_B, xsA, xsB, 
x, ind_sam, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLSW_+3A_ysa">ysA</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_A</code>, collected from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_ysb">ysB</code></td>
<td>
<p>A data frame containing information about one or more factors, each one of dimension <code class="reqn">n_B</code>, collected from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_pik_a">pik_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> containing first order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_pik_b">pik_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> containing first order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling design in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling design in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_xsa">xsA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_xsb">xsB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_x">x</code></td>
<td>
<p>A numeric vector or length <code class="reqn">N</code> or a numeric matrix or data frame of dimensions <code class="reqn">N</code> x <code class="reqn">m</code>, with <code class="reqn">m</code> the number of auxiliary variables, containing auxiliary information for every unit in the population.</p>
</td></tr>
<tr><td><code id="MLSW_+3A_ind_sam">ind_sam</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n = n_A + n_B</code> containing the identificators of units of the population (from 1 to <code class="reqn">N</code>) that belongs to <code class="reqn">s_A</code> or <code class="reqn">s_B</code></p>
</td></tr>
<tr><td><code id="MLSW_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multinomial logistic estimator in single frame using auxiliary information from the whole population for a proportion is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{P}_{MLi}^{SW} = \frac{1}{N} \left(\sum_{k \in U} \tilde{p}_{ki} + \sum_{k \in s} \tilde{d}_k (z_{ki} - \tilde{p}_{ki})\right) \hspace{0.3cm} i = 1,...,m</code>
</p>

<p>with <code class="reqn">m</code> the number of categories of the response variable, <code class="reqn">z_i</code> the indicator variable for the i-th category of the response variable,
<code class="reqn">\tilde{d}_k =\left\{\begin{array}{lcc}
 d_k^A &amp; \textrm{if } k \in a\\
 (1/d_k^A + 1/d_k^B)^{-1} &amp; \textrm{if } k \in ab \cup ba \\
 d_k^B &amp; \textrm{if } k \in b
 \end{array}
 \right.</code> 
and
</p>
<p style="text-align: center;"><code class="reqn">\tilde{p}_{ki} = \frac{exp(x_k^{'}\tilde{\beta_i})}{\sum_{r=1}^m exp(x_k^{'}\tilde{\beta_r})},</code>
</p>

<p>being <code class="reqn">\tilde{\beta_i}</code> the maximum likelihood parameters of the multinomial logistic model considering weights <code class="reqn">\tilde{d}</code>.
</p>


<h3>Value</h3>

<p><code>PMLSW</code> returns an object of class &quot;MultEstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>class frequencies and proportions estimations for main variable(s).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Molina, D., Rueda, M., Arcos, A. and Ranalli, M. G. (2015)
<em>Multinomial logistic estimation in dual frame surveys</em>
Statistics and Operations Research Transactions (SORT). To be printed.
</p>
<p>Lehtonen, R. and Veijanen, A. (1998) 
<em>On multinomial logistic generalizaed regression estimators</em>
Technical report 22, Department of Statistics, University of Jyvaskyla.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackMLSW">JackMLSW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatMA)
data(DatMB)
data(DatPopM) 

IndSample &lt;- c(DatMA$Id_Pop, DatMB$Id_Pop)
#Let calculate proportions of categories of variable Prog using MLSW estimator
#using Read as auxiliary variable
MLSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, DatMB$ProbA,
DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample)

#Let obtain 95% confidence intervals together with the estimations
MLSW(DatMA$Prog, DatMB$Prog, DatMA$ProbA, DatMB$ProbB, DatMA$ProbB, DatMB$ProbA,
DatMA$Domain, DatMB$Domain, DatMA$Read, DatMB$Read, DatPopM$Read, IndSample,
conf_level = 0.95)
</code></pre>

<hr>
<h2 id='PEL'>Pseudo empirical likelihood estimator</h2><span id='topic+PEL'></span>

<h3>Description</h3>

<p>Produces estimates for population totals using the pseudo empirical likelihood estimator from survey data obtained
from a dual frame sampling design. Confidence intervals for the population total are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PEL(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
XA = NULL, XB = NULL, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PEL_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="PEL_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="PEL_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td></tr>
<tr><td><code id="PEL_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td></tr>
<tr><td><code id="PEL_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="PEL_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="PEL_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pseudo empirical likelihood estimator for the population mean is computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{Y}}_{PEL} = \frac{N_a}{N}\hat{\bar{Y}}_a + \frac{\eta N_{ab}}{N}\hat{\bar{Y}}_{ab}^A + \frac{(1 - \eta) N_{ab}}{N}\hat{\bar{Y}}_{ab}^B + \frac{N_b}{N}\hat{\bar{Y}}_b</code>
</p>

<p>where <code class="reqn">\hat{\bar{Y}}_a = \sum_{k \in s_a}\hat{p}_{ak}y_k, \hat{\bar{Y}}_{ab} = \sum_{k \in s_{ab}^A}\hat{p}_{abk}^Ay_k, \hat{\bar{Y}}_{ab}^B = \sum_{k \in s_{ab}^B}\hat{p}_{abk}^By_k</code>
and <code class="reqn">\hat{\bar{Y}}_b = \sum_{k \in s_b}\hat{p}_{bk}y_k</code> with <code class="reqn">\hat{p}_{ak}, \hat{p}_{abk}^A, \hat{p}_{abk}^B</code> and <code class="reqn">\hat{p}_{bk}</code> the weights resulting of applying the pseudo empirical likelihood procedure to a determined function under a determined set of constraints, depending on the case. 
Furthermore, <code class="reqn">\eta \in (0,1)</code>. In this case, <code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> have been supposed known and no additional auxiliary variables have been considered. This is not happening in some cases.
Function covers following scenarios:
</p>

<ul>
<li><p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li>
<li><p> At least, one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li></ul>

<p>Explicit variance of this estimator is not easy to obtain. Instead, confidence intervals can be computed through the bi-section method. This method constructs intervals in the form <code class="reqn">\{\theta|r_{ns}(\theta) &lt; \chi_1^2(\alpha)\}</code>, 
where <code class="reqn">\chi_1^2(\alpha)</code> is the <code class="reqn">1 - \alpha</code> quantile from a <code class="reqn">\chi^2</code> distribution with one degree of freedom and <code class="reqn">r_{ns}(\theta)</code> represents the so called pseudo empirical log likelihood ratio statistic, 
which can be obtained as a difference of two pseudo empirical likelihood functions.
</p>


<h3>Value</h3>

<p><code>PEL</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Rao, J. N. K. and Wu, C. (2010)
<em>Pseudo Empirical Likelihood Inference for Multiple Frame Surveys</em>.
Journal of the American Statistical Association, 105, 1494 - 1503.
</p>
<p>Wu, C. (2005)
<em>Algorithms and R codes for the pseudo empirical likelihood methods in survey sampling</em>.
Survey Methodology, Vol. 31, 2, pp. 239 - 243.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackPEL">JackPEL</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate pseudo empirical likelihood estimator for variable Feeding, without
#considering any auxiliary information
PEL(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate pseudo empirical estimator for variable Clothing when the frame
#sizes and the overlap domain size are known
PEL(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate pseudo empirical likelihood estimator and a 90% confidence interval
#for population total for variable Feeding, considering Income and Metres2 as auxiliary 
#variables and with frame sizes and overlap domain size known.
PEL(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, xsBFrameA = DatB$Inc, 
xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, XA = 4300260, XB = 176553, 
conf_level = 0.90)
</code></pre>

<hr>
<h2 id='PiklA'>Matrix of inclusion probabilities for units selected in sample from frame A</h2><span id='topic+PiklA'></span>

<h3>Description</h3>

<p>This dataset consists of a square matrix of dimension 105 with the first and second order inclusion probabilities
for the units included in sample <code class="reqn">s_A</code>, which has been drawn from a population of size <code class="reqn">N_A = 1735</code> according to a
stratified random sampling with population strata sizes <code class="reqn">N_A^h = (727, 375, 113, 186, 115, 219)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PiklA
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+DatA">DatA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PiklA)
#Let choose the submatrix of inclusion probabilities for the first 5 units sA.
PiklA[1:5, 1:5]
#Now, let select only the first order inclusion probabilities
diag(PiklA)

</code></pre>

<hr>
<h2 id='PiklB'>Matrix of inclusion probabilities for units selected in sample from frame B</h2><span id='topic+PiklB'></span>

<h3>Description</h3>

<p>This dataset consists of a square matrix of dimension 135 with the first and second order inclusion probabilities
for the units included in <code class="reqn">s_B</code>, which has been drawn from a population of size <code class="reqn">N_B = 1191</code> according to a
simple random sampling without replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PiklB
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+DatB">DatB</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PiklB)
#Let choose the submatrix of inclusion probabilities for the first 5 units in sB.
PiklB[1:5, 1:5]
#Now, let select the first order inclusion probabilities
diag(PiklB)

</code></pre>

<hr>
<h2 id='PML'>Pseudo Maximum Likelihood estimator</h2><span id='topic+PML'></span>

<h3>Description</h3>

<p>Produces estimates for population totals and means using PML estimator from survey data obtained
from a dual frame sampling design. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PML(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A, N_B, conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PML_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="PML_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="PML_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="PML_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="PML_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="PML_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="PML_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="PML_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="PML_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Pseudo Maximum Likelihood estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{PML}(\hat{\theta}) = \frac{N_A - \hat{N}_{ab,PML}}{\hat{N}_a}\hat{Y}_a^A + \frac{N_B - \hat{N}_{ab,PML}}{\hat{N}_b}\hat{Y}_b^B + \frac{\hat{N}_{ab,PML}}{\hat{\theta}\hat{N}_{ab}^A + (1 - \hat{\theta})\hat{N}_{ab}^B}[\hat{\theta}\hat{Y}_{ab}^A + (1 - \hat{\theta})\hat{Y}_{ab}^B]</code>
</p>

<p>where <code class="reqn">\hat{\theta} \in [0, 1]</code> and <code class="reqn">\hat{N}_{ab,PML}</code> is the smaller of the roots of the quadratic equation
</p>
<p style="text-align: center;"><code class="reqn">[\hat{\theta}/N_B + (1 - \hat{\theta})/N_A]x^2 - [1 + \hat{\theta}\hat{N}_{ab}^A/N_B + (1 - \hat{\theta})\hat{N}_{ab}^B/N_A]x + \hat{\theta}\hat{N}_{ab}^A + (1 - \hat{\theta})\hat{N}_{ab}^B=0.</code>
</p>
<p> Optimal value for <code class="reqn">\hat{\theta}</code> is <code class="reqn">\frac{\hat{N}_aN_B\hat{V}(\hat{N}_{ab}^B)}{\hat{N}_aN_B\hat{V}(\hat{N}_{ab}^B) + \hat{N}_bN_A\hat{V}(\hat{N}_{ab}^A)}</code>.
Variance is estimated according to following expression
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{PML}(\hat{\theta})) = \hat{V}(\sum_{i \in s_A}\tilde{z}_i^A) + \hat{V}(\sum_{i \in s_B}\tilde{z}_i^B)</code>
</p>

<p>where, <code class="reqn">\tilde{z}_i^A = y_i - \frac{\hat{Y}_a}{\hat{N}_a}</code> if <code class="reqn">i \in a</code> and <code class="reqn">\tilde{z}_i^A = \hat{\gamma}_{opt}(y_i - \frac{\hat{Y}_a}{\hat{N}_a}) + \hat{\lambda} \hat{\phi}</code> if <code class="reqn">i \in ab</code> with
</p>
<p style="text-align: center;"><code class="reqn">\hat{\gamma}_{opt} = \frac{\hat{N}_a N_B \hat{V}(\hat{N}_{ab}^B)}{\hat{N}_a N_B \hat{V}(\hat{N}_{ab}^B) + \hat{N}_b + N_A + \hat{V}(\hat{N}_{ab}^A)}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\lambda} = \frac{n_A/N_A \hat{Y}_{ab}^A + n_B/N_B \hat{Y}_{ab}^B}{n_A/N_A \hat{N}_{ab}^A + n_B/N_B \hat{N}_{ab}^B} - \frac{\hat{Y}_a}{\hat{N}_a} - \frac{\hat{Y}_b}{\hat{N}_b}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\phi} = \frac{n_A \hat{N}_b}{n_A \hat{N}_b + n_B\hat{N}_a}</code>
</p>

<p>Similarly, we define <code class="reqn">\tilde{z}_i^B = y_i - \frac{\hat{Y}_b}{\hat{N}_b}</code> if <code class="reqn">i \in b</code> and <code class="reqn">\tilde{z}_i^B = (1 - \hat{\gamma}_{opt})(y_i - \frac{\hat{Y}_{ba}}{\hat{N}_{ab}}) + \hat{\lambda}(1 - \hat{\phi})</code> if <code class="reqn">i \in ba</code>
</p>


<h3>Value</h3>

<p><code>PML</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Skinner, C. J. and Rao, J. N. K. (1996)
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Journal of the American Statistical Association, Vol. 91, 433, 349 - 356.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate Pseudo Maximum Likelihood estimator for population total for variable Clothing
PML(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191)

#Now, let calculate Pseudo Maximum Likelihood estimator for population total for variable
#Feeding, using first order inclusion probabilities
PML(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191)

#Finally, let calculate Pseudo Maximum Likelihood estimator and a 90% confidence interval for 
#population total for variable Leisure
PML(DatA$Lei, DatB$Lei, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, 0.90)
</code></pre>

<hr>
<h2 id='SFRR'>Raking ratio estimator</h2><span id='topic+SFRR'></span>

<h3>Description</h3>

<p>Produces estimates for population total and mean using the raking ratio estimator from survey data obtained
from a dual frame sampling desing. Confidence intervals are also computed, if required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SFRR(ysA, ysB, pi_A, pi_B, pik_ab_B, pik_ba_A, domains_A, domains_B, N_A, N_B, 
conf_level = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SFRR_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="SFRR_+3A_n_a">N_A</code></td>
<td>
<p>A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="SFRR_+3A_n_b">N_B</code></td>
<td>
<p>A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="SFRR_+3A_conf_level">conf_level</code></td>
<td>
<p>(Optional) A numeric value indicating the confidence level for the confidence intervals, if desired.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Raking ratio estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Y}_{SFRR} = \frac{N_A - \hat{N}_{ab,rake}}{\hat{N}_a^A}\hat{Y}_a^A + \frac{N_B - \hat{N}_{ab,rake}}{\hat{N}_b^B}\hat{Y}_b^B + \frac{\hat{N}_{ab,rake}}{\hat{N}_{abS}}\hat{Y}_{abS}</code>
</p>

<p>where <code class="reqn">\hat{Y}_{abS} = \sum_{i \in s_{ab}^A}\tilde{d}_i^Ay_i + \sum_{i \in s_{ab}^B}\tilde{d}_i^By_i, \hat{N}_{abS} = \sum_{i \in s_{ab}^A}\tilde{d}_i^A + \sum_{i \in s_{ab}^B}\tilde{d}_i^B</code> and
<code class="reqn">\hat{N}_{ab,rake}</code> is the smallest root of the quadratic equation <code class="reqn">\hat{N}_{ab,rake}x^2 - [\hat{N}_{ab,rake}(N_A + N_B) + \hat{N}_{aS}\hat{N}_{bS}]x + \hat{N}_{ab,rake}N_AN_B = 0</code>,
with <code class="reqn">\hat{N}_{aS} = \sum_{s_a^A}\tilde{d}_i^B</code> and <code class="reqn">\hat{N}_{bS} = \sum_{s_b^B}\tilde{d}_i^B</code>. Weights <code class="reqn">\tilde{d}_i^A</code> and <code class="reqn">\tilde{d}_i^B</code> are obtained as follows
<code class="reqn">\tilde{d}_i^A =\left\{\begin{array}{lcc}
 d_i^A &amp; \textrm{if } i \in a\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ab
 \end{array}
 \right.</code>
and
<code class="reqn">\tilde{d}_i^B =\left\{\begin{array}{lcc}
 d_i^B &amp; \textrm{if } i \in b\\
 (1/d_i^A + 1/d_i^B)^{-1} &amp; \textrm{if } i \in ba
 \end{array}
 \right.</code>
being <code class="reqn">d_i^A</code> and <code class="reqn">d_i^B</code> the design weights, obtained as the inverse of the first order inclusion probabilities, that is <code class="reqn">d_i^A = 1/\pi_i^A</code> and <code class="reqn">d_i^B = 1/\pi_i^B</code>.
</p>
<p>To obtain an estimator of the variance for this estimator, one has taken into account that raking ratio estimator coincides with SF calibration estimator when frame sizes are known and &quot;raking&quot;
method is used. So, one can use here Deville's expression to calculate an estimator for the variance of the raking ratio estimator
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{Y}_{SFRR}) = \frac{1}{1-\sum_{k\in s} a_k^2}\sum_{k\in s}(1-\pi_k)\left(\frac{e_k}{\pi_k} - \sum_{l\in s} a_{l} \frac{e_l}{\pi_l}\right)^2</code>
</p>

<p>where <code class="reqn">a_k=(1-\pi_k)/\sum_{l\in s} (1-\pi_l)</code> and <code class="reqn">e_k</code> are the residuals of the regression with auxiliary variables as regressors.
</p>


<h3>Value</h3>

<p><code>SFRR</code> returns an object of class &quot;EstimatorDF&quot; which is a list with, at least, the following components:
</p>
<table>
<tr><td><code>Call</code></td>
<td>
<p>the matched call.</p>
</td></tr>
<tr><td><code>Est</code></td>
<td>
<p>total and mean estimation for main variable(s).</p>
</td></tr>
<tr><td><code>VarEst</code></td>
<td>
<p>variance estimation for main variable(s).</p>
</td></tr>
</table>
<p>If parameter <code>conf_level</code> is different from <code>NULL</code>, object includes component
</p>
<table>
<tr><td><code>ConfInt</code></td>
<td>
<p>total and mean estimation and confidence intervals for main variables(s).</p>
</td></tr>
</table>
<p>In addition, components <code>TotDomEst</code> and <code>MeanDomEst</code> are available when estimator is based on estimators of the domains. Component <code>Param</code> shows value of parameters involded in calculation of the estimator (if any).
By default, only <code>Est</code> component (or <code>ConfInt</code> component, if parameter <code>conf_level</code> is different from <code>NULL</code>) is shown. It is possible to access to all the components of the objects by using function <code>summary</code>.
</p>


<h3>References</h3>

<p>Lohr, S. and Rao, J.N.K. (2000).
<em>Inference in Dual Frame Surveys</em>. Journal of the American Statistical Association, Vol. 95, 271 - 280.
</p>
<p>Rao, J.N.K. and Skinner, C.J. (1996).
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Proceedings of the Survey Method Section, Statistical Society of Canada, 63 - 68.
</p>
<p>Skinner, C.J. and Rao J.N.K. (1996).
<em>Estimation in Dual Frame Surveys with Complex Designs</em>. Journal of the American Statistical Association, Vol. 91, 443, 349 - 356.
</p>
<p>Skinner, C.J. (1991).
<em>On the Efficiency of Raking Ratio Estimation for Multiple Frame Surveys</em>. Journal of the American Statistical Association, Vol. 86, 779 - 784.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+JackSFRR">JackSFRR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate raking ratio estimator for population total for variable Clothing
SFRR(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$ProbB, DatB$ProbA, DatA$Domain, 
DatB$Domain, 1735, 1191)

#Now, let calculate raking ratio estimator and a 90% confidence interval for 
#population total for variable Feeding, considering only first order inclusion probabilities
SFRR(DatA$Feed, DatB$Feed, DatA$ProbA, DatB$ProbB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain, 1735, 1191, 0.90)
</code></pre>

<hr>
<h2 id='VarHT'>Variance estimator of Horvitz - Thompson estimator</h2><span id='topic+VarHT'></span>

<h3>Description</h3>

<p>Computes the variance estimator of Horvitz - Thompson estimator of population total
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarHT(y, pikl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VarHT_+3A_y">y</code></td>
<td>
<p>A numeric vector of size n containing information about variable of interest</p>
</td></tr>
<tr><td><code id="VarHT_+3A_pikl">pikl</code></td>
<td>
<p>A square numeric matrix of dimension n containing first and second order inclusion probabilities for units included in <code>y</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variance estimator of Horvitz - Thompson estimator of population total is given by
</p>
<p style="text-align: center;"><code class="reqn">\hat{Var}(\hat{Y}_{HT}) = \sum_{k \in s}\frac{y_k^2}{\pi_k^2}(1 - \pi_k) + \sum_{k \in s}\sum_{l \in s, l \neq k} \frac{y_k y_l}{\pi_k \pi_l} \frac{\pi_{kl} - \pi_k \pi_l}{\pi_{kl}}</code>
</p>



<h3>Value</h3>

<p>A numeric value representing variance estimator of Horvitz - Thompson estimator for population total for considered values
</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952)
<em>A generalization of sampling without replacement from a finite universe.</em>
Journal of the American Statistical Association, 47, 663 - 685
</p>
<p>Sarndal, C. E., Swensson, B. and Wretman, J. (1992)
<em>Model Assisted Survey Sampling</em>. Springer-Verlag. New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+HT">HT</a></code> <code><a href="#topic+CovHT">CovHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##########   Example 1   ##########
U &lt;- c(13, 18, 20, 14, 9)
#A simple random sample of size 2 without replacement is drawn from population
s &lt;- sample(U, 2)
#Horvitz - Thompson estimator of population total is calculated.
ps &lt;- c(0.4, 0.4)
HT(s, ps)
#Now, we calculate variance estimator of the Horvitz - Thompson estimator.
Ps &lt;- matrix(c(0.4,0.1, 0.1,0.4), 2 ,2)
VarHT(s, Ps)

##########   Example 2   ##########
data(DatA)
attach(DatA)
data(PiklA)

#Let calculate Horvitz - Thompson estimator for total of variable Clothing in Frame A.
HT(Clo, ProbA)
#And now, let compute the variance of the previous estimator
VarHT(Clo, PiklA)

</code></pre>

<hr>
<h2 id='WeightsCalDF'>g-weights for the dual frame calibration estimator</h2><span id='topic+WeightsCalDF'></span>

<h3>Description</h3>

<p>Computes the g-weights for the dual frame calibration estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeightsCalDF(ysA, ysB, pi_A, pi_B, domains_A, domains_B, N_A = NULL, N_B = NULL, 
N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, xsAFrameB = NULL, xsBFrameB = NULL, 
xsT = NULL, XA = NULL, XB = NULL, X = NULL, met = "linear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WeightsCalDF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of length <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of length <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="WeightsCalDF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function provides g-weights in following scenarios:
</p>

<ul>
<li><p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li>
<li><p> At least, one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>A numeric vector containing the g-weights for the dual frame calibration estimator.
</p>


<h3>References</h3>

<p>Ranalli, M. G., Arcos, A., Rueda, M. and Teodoro, A. (2013)
<em>Calibration estimationn in dual frame surveys</em>. arXiv:1312.0761 [stat.ME]
</p>
<p>Deville, J. C., S\&quot;arndal, C. E. (1992)
<em>Calibration estimators in survey sampling.</em>
Journal of the American Statistical Association, 87, 376 - 382
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate g-weights for the dual frame calibration estimator for variable Feeding, 
#without considering any auxiliary information
WeightsCalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain)

#Now, let calculate g-weights for the dual frame calibration estimator for variable Clothing 
#when the frame sizes and the overlap domain size are known
WeightsCalDF(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate g-weights for the dual frame calibration estimator
#for variable Feeding, considering Income as auxiliary variable in frame A
#and Metres2 as auxiliary variable in frame B and with frame sizes and overlap 
#domain size known.
WeightsCalDF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$Domain, DatB$Domain, 
N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, xsBFrameA = DatB$Inc, 
xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, XA = 4300260, XB = 176553)
</code></pre>

<hr>
<h2 id='WeightsCalSF'>g-weights for the SF calibration estimator</h2><span id='topic+WeightsCalSF'></span>

<h3>Description</h3>

<p>Computes the g-weights for the SF calibration estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WeightsCalSF(ysA, ysB, pi_A, pi_B, pik_ab_B, pik_ba_A, domains_A, domains_B, 
N_A = NULL, N_B = NULL, N_ab = NULL, xsAFrameA = NULL, xsBFrameA = NULL, 
xsAFrameB = NULL, xsBFrameB = NULL, xsT = NULL, XA = NULL, XB = NULL, X = NULL, 
met = "linear")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WeightsCalSF_+3A_ysa">ysA</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_ysb">ysB</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">c</code> containing information about variable(s) of interest from <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_pi_a">pi_A</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_A</code> or a square numeric matrix of dimension <code class="reqn">n_A</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_pi_b">pi_B</code></td>
<td>
<p>A numeric vector of length <code class="reqn">n_B</code> or a square numeric matrix of dimension <code class="reqn">n_B</code> containing first order or first and second order inclusion probabilities for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_pik_ab_b">pik_ab_B</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_A</code> containing first order inclusion probabilities according to sampling desing in frame B for units belonging 
to overlap domain that have been selected in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_pik_ba_a">pik_ba_A</code></td>
<td>
<p>A numeric vector of size <code class="reqn">n_B</code> containing first order inclusion probabilities according to sampling desing in frame A for units belonging 
to overlap domain that have been selected in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_domains_a">domains_A</code></td>
<td>
<p>A character vector of size <code class="reqn">n_A</code> indicating the domain each unit from <code class="reqn">s_A</code> belongs to. Possible values are &quot;a&quot; and &quot;ab&quot;.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_domains_b">domains_B</code></td>
<td>
<p>A character vector of size <code class="reqn">n_B</code> indicating the domain each unit from <code class="reqn">s_B</code> belongs to. Possible values are &quot;b&quot; and &quot;ba&quot;.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_n_a">N_A</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame A</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_n_b">N_B</code></td>
<td>
<p>(Optional) A numeric value indicating the size of frame B</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_n_ab">N_ab</code></td>
<td>
<p>(Optional) A numeric value indicating the size of the overlap domain</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xsaframea">xsAFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_A</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xsbframea">xsBFrameA</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, containing auxiliary information in frame A for units included in <code class="reqn">s_B</code>. For units in domain <code class="reqn">b</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xsaframeb">xsAFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_A</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_A</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_A</code>. For units in domain <code class="reqn">a</code>, these values are 0.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xsbframeb">xsBFrameB</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n_B</code> or a numeric matrix or data frame of dimensions <code class="reqn">n_B</code> x <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, containing auxiliary information in frame B for units included in <code class="reqn">s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xst">xsT</code></td>
<td>
<p>(Optional) A numeric vector of length <code class="reqn">n</code> or a numeric matrix or data frame of dimensions <code class="reqn">n</code> x <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, containing auxiliary information for all units in the entire sample <code class="reqn">s = s_A \cup s_B</code>.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xa">XA</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_A</code>, with <code class="reqn">m_A</code> the number of auxiliary variables in frame A, indicating the population totals for the auxiliary variables considered in frame A.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_xb">XB</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_B</code>, with <code class="reqn">m_B</code> the number of auxiliary variables in frame B, indicating the population totals for the auxiliary variables considered in frame B.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_x">X</code></td>
<td>
<p>(Optional) A numeric value or vector of length <code class="reqn">m_T</code>, with <code class="reqn">m_T</code> the number of auxiliary variables in both frames, indicating the population totals for the auxiliary variables considered in both frames.</p>
</td></tr>
<tr><td><code id="WeightsCalSF_+3A_met">met</code></td>
<td>
<p>(Optional) A character vector indicating the distance that must be used in calibration process. Possible values are &quot;linear&quot;, &quot;raking&quot; and &quot;logit&quot;. Default is &quot;linear&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function provides g-weights in following scenarios:
</p>

<ul>
<li><p> There is not any additional auxiliary variable 
</p>

<ul>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li>
<li><p> At least, one additional auxiliary variable is available 
</p>

<ul>
<li> <p><code class="reqn">N_{ab}</code> known and <code class="reqn">N_A</code> and <code class="reqn">N_B</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A</code> and <code class="reqn">N_B</code> known and <code class="reqn">N_{ab}</code> unknown
</p>
</li>
<li> <p><code class="reqn">N_A, N_B</code> and <code class="reqn">N_{ab}</code> known
</p>
</li></ul>

</li></ul>



<h3>Value</h3>

<p>A numeric vector containing the g-weights for the SF calibration estimator.
</p>


<h3>References</h3>

<p>Ranalli, M. G., Arcos, A., Rueda, M. and Teodoro, A. (2013)
<em>Calibration estimationn in dual frame surveys</em>. arXiv:1312.0761 [stat.ME]
</p>
<p>Deville, J. C., S\&quot;arndal, C. E. (1992)
<em>Calibration estimators in survey sampling.</em>
Journal of the American Statistical Association, 87, 376 - 382
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DatA)
data(DatB)
data(PiklA)
data(PiklB)

#Let calculate g-weights for the SF calibration estimator for variable Clothing,
#without considering any auxiliary information
WeightsCalSF(DatA$Clo, DatB$Clo, PiklA, PiklB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain)

#Now, let calculate g-weights for the SF calibration estimator for variable Leisure
#when the frame sizes and the overlap domain size are known
WeightsCalSF(DatA$Lei, DatB$Lei, PiklA, PiklB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain, N_A = 1735, N_B = 1191, N_ab = 601)

#Finally, let calculate g-weights for the SF calibration estimator
#for variable Feeding, considering Income and Metres2 as auxiliary 
#variables and with frame sizes and overlap domain size known.
WeightsCalSF(DatA$Feed, DatB$Feed, PiklA, PiklB, DatA$ProbB, DatB$ProbA, 
DatA$Domain, DatB$Domain, N_A = 1735, N_B =  1191, N_ab = 601, xsAFrameA = DatA$Inc, 
xsBFrameA = DatB$Inc, xsAFrameB = DatA$M2, xsBFrameB = DatB$M2, 
XA = 4300260, XB = 176553)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
