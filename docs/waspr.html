<!DOCTYPE html><html><head><title>Help for package waspr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {waspr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#combine'><p>Combine output of the swapping algorithm</p></a></li>
<li><a href='#hpd_est'><p>Compute the 95 percent Highest Posterior Density interval</p></a></li>
<li><a href='#mode_est'><p>Compute the mode</p></a></li>
<li><a href='#pois_logistic'><p>pois_logistic</p></a></li>
<li><a href='#print.wasp'><p>Print posterior summaries for the Wasserstein barycenter of subset posteriors</p></a></li>
<li><a href='#summary'><p>Posterior summaries for the Wasserstein barycenter of subset posteriors</p></a></li>
<li><a href='#summary.wasp'><p>Posterior summaries for the Wasserstein barycenter of subset posteriors</p></a></li>
<li><a href='#swap_rcpp'><p>The swapping algorithm for computing Wasserstein barycenters</p></a></li>
<li><a href='#wasp'><p>Compute Wasserstein barycenters of subset posteriors</p></a></li>
<li><a href='#waspr-package'><p>waspr: an R package for computing Wasserstein barycenters of subset</p>
posteriors</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Wasserstein Barycenters of Subset Posteriors</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to compute Wasserstein barycenters
    of subset posteriors using the swapping algorithm developed by Puccetti, 
    Rüschendorf and Vanduffel (2020) &lt;<a href="https://doi.org/10.1016%2Fj.jmaa.2017.02.003">doi:10.1016/j.jmaa.2017.02.003</a>&gt;. The 
    Wasserstein barycenter is a geometric approach for combining subset 
    posteriors. It allows for parallel and distributed computation of the 
    posterior in case of complex models and/or big datasets, thereby increasing
    computational speed tremendously.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/joliencremers/waspr">https://github.com/joliencremers/waspr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/joliencremers/waspr/issues">https://github.com/joliencremers/waspr/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.4.6)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp, RcppArmadillo,</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-11 13:09:38 UTC; Jolien</td>
</tr>
<tr>
<td>Author:</td>
<td>Jolien Cremers [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jolien Cremers &lt;joliencremers@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-11 14:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='combine'>Combine output of the swapping algorithm</h2><span id='topic+combine'></span>

<h3>Description</h3>

<p>This (non-exported) function combines the output from the swapping algorithm (Puccetti,
Rüschendorf and Vanduffel, 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combine_+3A_x">x</code></td>
<td>
<p>a three dimensional array (rows = subsets, columns = par, slices
= samples) containing posterior samples for all subsets</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>wasp</code> object, which can be further analyzed using the
associated function <code><a href="#topic+summary.wasp">summary.wasp</a></code>.
</p>


<h3>Source</h3>

<p>Puccetti, G., Rüschendorf, L. &amp; Vanduffel, S. (2020). On the
computation of Wasserstein barycenters, Journal of Multivariate Analysis,
176.
</p>

<hr>
<h2 id='hpd_est'>Compute the 95 percent Highest Posterior Density interval</h2><span id='topic+hpd_est'></span>

<h3>Description</h3>

<p>Compute the 95 percent Highest Posterior Density interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpd_est(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hpd_est_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing the lower and upper bound of the 96
Posterior Density interval of a numeric vector as computed by the methods
from Venter (1967).
</p>


<h3>Source</h3>

<p>Venter, J.H. (1967). On estimation of the mode, Annals of
Mathematical Statistics, 38(5), 1446-1455.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(waspr)
hpd_est(pois_logistic[1,1,])

</code></pre>

<hr>
<h2 id='mode_est'>Compute the mode</h2><span id='topic+mode_est'></span>

<h3>Description</h3>

<p>Compute the mode
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mode_est(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mode_est_+3A_x">x</code></td>
<td>
<p>a numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The mode of a numeric vector as computed by the methods from Venter
(1967).
</p>


<h3>Source</h3>

<p>Venter, J.H. (1967). On estimation of the mode, Annals of
Mathematical Statistics, 38(5), 1446-1455.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(waspr)
mode_est(pois_logistic[1,1,])

</code></pre>

<hr>
<h2 id='pois_logistic'>pois_logistic</h2><span id='topic+pois_logistic'></span>

<h3>Description</h3>

<p>A set of mcmc samples from 8 subposteriors from the analysis of a joint model
with a logistic and poisson outcome variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pois_logistic
</code></pre>


<h3>Format</h3>

<p>An array with 3 dimensions of which the first represents the
subposteriors (size = 8), the second represents the paramters (size = 8) and
the third represents the amount of mcmc samples (size = 450).
</p>

<hr>
<h2 id='print.wasp'>Print posterior summaries for the Wasserstein barycenter of subset posteriors</h2><span id='topic+print.wasp'></span>

<h3>Description</h3>

<p>Prints selected output from a Bayesian circular mixed-effects model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wasp'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.wasp_+3A_x">x</code></td>
<td>
<p>a <code>wasp</code> object obtained from the function <code>wasp()</code>.</p>
</td></tr>
<tr><td><code id="print.wasp_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print of posterior summaries for the Wasserstein barycenter of subset posteriors
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(waspr)
out &lt;- wasp(pois_logistic,
            par.names = c("beta_s", "alpha_l", "beta_l",
                          "baseline_sigma", "baseline_mu",
                          "correlation", "sigma_s", "sigma_l"))
print(out)

</code></pre>

<hr>
<h2 id='summary'>Posterior summaries for the Wasserstein barycenter of subset posteriors</h2><span id='topic+summary'></span>

<h3>Description</h3>

<p><code>summary</code> gives a posterior summary (mean, mode, sd, HPD)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_x">x</code></td>
<td>
<p>a <code>wasp</code> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the method <a href="#topic+summary.wasp">summary.wasp</a> has its own help page.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(waspr)

</code></pre>

<hr>
<h2 id='summary.wasp'>Posterior summaries for the Wasserstein barycenter of subset posteriors</h2><span id='topic+summary.wasp'></span>

<h3>Description</h3>

<p>Outputs and prints posterior summary statistics (mean, mode, sd, 95
Posterior Density interval)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wasp'
summary(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.wasp_+3A_x">x</code></td>
<td>
<p>a <code>wasp</code> object obtained from the function <code>wasp()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Posterior summary statistics (mean, mode, sd, 95
all the Wasserstein barycenter of subset posteriors of all parameters in
the model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(waspr)
out &lt;- wasp(pois_logistic,
            par.names = c("beta_s", "alpha_l", "beta_l",
                          "baseline_sigma", "baseline_mu",
                          "correlation", "sigma_s", "sigma_l"))
summary(out)

</code></pre>

<hr>
<h2 id='swap_rcpp'>The swapping algorithm for computing Wasserstein barycenters</h2><span id='topic+swap_rcpp'></span>

<h3>Description</h3>

<p>The swapping algorithm for computing Wasserstein barycenters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swap_rcpp(samples, acc = 0.001, iter = 10L, out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swap_rcpp_+3A_samples">samples</code></td>
<td>
<p>A cube containing samples for all subset posteriors (rows =
subsets, columns = par, slices = samples)</p>
</td></tr>
<tr><td><code id="swap_rcpp_+3A_acc">acc</code></td>
<td>
<p>accuracy</p>
</td></tr>
<tr><td><code id="swap_rcpp_+3A_iter">iter</code></td>
<td>
<p>maximum number of iterations of the algorithm</p>
</td></tr>
<tr><td><code id="swap_rcpp_+3A_out">out</code></td>
<td>
<p>boolean indicating whether output for each iteration should be displayed (default = false)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a three dimensional array (rows = subsets, columns = par, slices =
samples) containing output from the swapping algorithm.
</p>

<hr>
<h2 id='wasp'>Compute Wasserstein barycenters of subset posteriors</h2><span id='topic+wasp'></span>

<h3>Description</h3>

<p>This function computes Wasserstein Barycenters of subset posteriors and
gives posterior summaries for the full posterior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wasp(mcmc, par.names = NULL, acc = 0.001, iter = 10, out = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wasp_+3A_mcmc">mcmc</code></td>
<td>
<p>a three dimensional array (rows =  number of subset posteriors,
columns = number of parameters of the posterior distribution, slices =
samples number of samples for each subset posterior) containing posterior
samples for all subsets</p>
</td></tr>
<tr><td><code id="wasp_+3A_par.names">par.names</code></td>
<td>
<p>optional character vector with parameter names</p>
</td></tr>
<tr><td><code id="wasp_+3A_acc">acc</code></td>
<td>
<p>accuracy of the swapping algorithm (default = 0.001)</p>
</td></tr>
<tr><td><code id="wasp_+3A_iter">iter</code></td>
<td>
<p>maximum number of iterations of the swapping algorithm (default = 10)</p>
</td></tr>
<tr><td><code id="wasp_+3A_out">out</code></td>
<td>
<p>boolean indicating whether output for each iteration of the swapping algorithm should be displayed (default = false)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The swapping algorithm developed by Puccetti, Rüschendorf and
Vanduffel (2020) is used to compute Wasserstein barycenters of subset
posteriors.
</p>


<h3>Value</h3>

<p>A <code>wasp</code> object, which can be further analyzed using the
associated function <code><a href="#topic+summary.wasp">summary.wasp</a></code>.
</p>
<p>A <code>wasp</code> object contains the following elements (some elements are not
returned if not applicable)
</p>

<dl>
<dt><code>barycenter</code></dt><dd><p>A matrix of posterior samples (rows) for
all parameters (columns) of the full posterior obtained by the swapping algorithm.</p>
</dd>
<dt><code>raw</code></dt><dd><p>An array (<code>dim = c(subsets, parameters, samples)</code>)
containing the raw output from the swapping algorithm.</p>
</dd>
<dt><code>call</code></dt><dd><p>The call to the <code>wasp()</code> function.</p>
</dd>
<dt><code>subsets</code></dt><dd><p>The amount of subset posteriors in mcmc.</p>
</dd>
<dt><code>parameters</code></dt><dd><p>The amount of parameters in mcmc.</p>
</dd>
<dt><code>samples</code></dt><dd><p>The amount of posterior samples for each subset posterior in mcmc.</p>
</dd>
<dt><code>acc</code></dt><dd><p>Accuracy of the swapping algorithm, default = 0.001.</p>
</dd>
<dt><code>iter</code></dt><dd><p>Maximum amount of iterations for the swapping algorithm, default = 10.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Puccetti, G., Rüschendorf, L. &amp; Vanduffel, S. (2020). On the
computation of Wasserstein barycenters, Journal of Multivariate Analysis,
176.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(waspr)
out &lt;- wasp(pois_logistic,
            par.names = c("beta_s", "alpha_l", "beta_l",
                          "baseline_sigma", "baseline_mu",
                          "correlation", "sigma_s", "sigma_l"))
summary(out)

</code></pre>

<hr>
<h2 id='waspr-package'>waspr: an R package for computing Wasserstein barycenters of subset
posteriors</h2><span id='topic+waspr'></span><span id='topic+waspr-package'></span>

<h3>Description</h3>

<p>This package contains functions to compute Wasserstein barycenters of subset
posteriors using the swapping algorithm developed by Puccetti, Rüschendorf
and Vanduffel (2020). The Wasserstein barycenter is a geometric approach for
combining subset posteriors. It allows for parallel and distributed
computation of the posterior in case of complex models and/or big datasets,
thereby increasing computational speed tremendously.
</p>


<h3>Functions</h3>

<p>The main function of the package is:
</p>
<p><code><a href="#topic+wasp">wasp</a></code>, which runs the swapping algorithm developed by
Puccetti, Rüschendorf and Vanduffel (2020), combines the output from the
swapping algorithm and computes the Wasserstein barycenter. It returns an
S3 object of type <code>wasp</code>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jolien Cremers <a href="mailto:joliencremers@gmail.com">joliencremers@gmail.com</a>
</p>


<h3>Source</h3>

<p>Puccetti, G., Rüschendorf, L. &amp; Vanduffel, S. (2020). On the
computation of Wasserstein barycenters, Journal of Multivariate Analysis,
176.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/joliencremers/waspr">https://github.com/joliencremers/waspr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/joliencremers/waspr/issues">https://github.com/joliencremers/waspr/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
