<!DOCTYPE html><html><head><title>Help for package newFocus</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {newFocus}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#newFocus-package'>
<p>True Discovery Guarantee by Combining Partial Closed Testings</p></a></li>
<li><a href='#choosepath'>
<p>A set of focus set index</p></a></li>
<li><a href='#ctbab'>
<p>Closed testing with branch and bound</p></a></li>
<li><a href='#discov'>
<p>True discoveries</p></a></li>
<li><a href='#newFocus'>
<p>The new focus level procedure</p></a></li>
<li><a href='#pick'>
<p>True discoveries for non-focus level node</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>True Discovery Guarantee by Combining Partial Closed Testings</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-06-22</td>
</tr>
<tr>
<td>Author:</td>
<td>Ningning Xu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ningning Xu &lt;n.xu@lumc.nl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Closed testing has been proved powerful for true discovery guarantee. The computation of closed testing is, however, quite burdensome. A general way to reduce computational complexity is to combine partial closed testings for some prespecified feature sets of interest. Partial closed testings are performed at Bonferroni-corrected alpha level to guarantee the lower bounds for the number of true discoveries in prespecified sets are simultaneously valid. For any post hoc chosen sets of interest, coherence property is used to get the lower bound. In this package, we implement closed testing with globaltest to calculate the lower bound for number of true discoveries, see Ningning Xu et.al (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2001.01541">doi:10.48550/arXiv.2001.01541</a>&gt; for detailed description. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>ctgt</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-05 15:18:45 UTC; nxu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-05 15:50:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='newFocus-package'>
True Discovery Guarantee by Combining Partial Closed Testings
</h2><span id='topic+newFocus-package'></span>

<h3>Description</h3>

<p>Closed testing has been proved powerful for true discovery guarantee. The computation of closed testing is, however, quite burdensome. A general way to reduce computational complexity is to combine partial closed testings for some prespecified feature sets of interest. Partial closed testings are performed at Bonferroni-corrected alpha level to guarantee the lower bounds for the number of true discoveries in prespecified sets are simultaneously valid. For any post hoc chosen sets of interest, coherence property is used to get the lower bound. In this package, we implement closed testing with globaltest to calculate the lower bound for number of true discoveries, see Ningning Xu et.al (2021) &lt;arXiv:2001.01541&gt; for detailed description. 
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> newFocus</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> True Discovery Guarantee by Combining Partial Closed Testings</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-06-22</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Ningning Xu</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Ningning Xu &lt;n.xu@lumc.nl&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Closed testing has been proved powerful for true discovery guarantee. The computation of closed testing is, however, quite burdensome. A general way to reduce computational complexity is to combine partial closed testings for some prespecified feature sets of interest. Partial closed testings are performed at Bonferroni-corrected alpha level to guarantee the lower bounds for the number of true discoveries in prespecified sets are simultaneously valid. For any post hoc chosen sets of interest, coherence property is used to get the lower bound. In this package, we implement closed testing with globaltest to calculate the lower bound for number of true discoveries, see Ningning Xu et.al (2021) &lt;arXiv:2001.01541&gt; for detailed description. </td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> ctgt</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> no</td>
</tr>
<tr>
 <td style="text-align: left;">
Packaged: </td><td style="text-align: left;"> 2021-06-22 09:50:32 UTC; nxu</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository: </td><td style="text-align: left;"> CRAN</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
choosepath              A set of focus set index
ctbab                   Closed testing with branch and bound
discov                  True discoveries
newFocus                The new focus level procedure
newFocus-package        True Discovery Guarantee by Combining Partial
                        Closed Testings
pick                    True discoveries for non-focus level node
</pre>
<p>For the GO (Gene Ontology) terms chosen as focus level nodes, <a href="#topic+newFocus">newFocus</a> function will return the minimum number of true discoveries. For GO terms that are non-focus level nodes, we use <a href="#topic+pick">pick</a> to count the number of true discoveries based on the result of <a href="#topic+newFocus">newFocus</a>.   
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>
<p>Maintainer: Ningning Xu &lt;n.xu@lumc.nl&gt;
</p>


<h3>References</h3>

<p>Ningning Xu, Aldo solari, Jelle Goeman, Clsoed testing with global test, with applications on metabolomics data, arXiv:2001.01541, https://arxiv.org/abs/2001.01541
</p>
<p>Jelle J. Goeman, Sara A. van de Geer, Floor de Kort, Hans C. van Houwelingen, A global test for groups of genes: testing association with a clinical outcome, Bioinformatics, Volume 20, Issue 1, 1 January 2004, Pages 93-99, https://doi.org/10.1093/bioinformatics/btg382
</p>

<hr>
<h2 id='choosepath'>
A set of focus set index
</h2><span id='topic+choosepath'></span>

<h3>Description</h3>

<p>The function aims to find out the focus set index for which the true discoveries is the most and all other focus sets that are disjoint with it .
</p>


<h3>Usage</h3>

<pre><code class='language-R'>choosepath(startingindex = 1, fsets, lowdv)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="choosepath_+3A_startingindex">startingindex</code></td>
<td>

<p>The index of focus set that has the first largest number of true discovereis 
</p>
</td></tr>
<tr><td><code id="choosepath_+3A_fsets">fsets</code></td>
<td>

<p>A list of focus level gene sets,or GO (Gene Ontology) terms  
</p>
</td></tr>
<tr><td><code id="choosepath_+3A_lowdv">lowdv</code></td>
<td>

<p>A non-negative integer vector, which are the number of true discovereis, the length of the vector is the same as the list of focus level sets
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function will return an integer or a numeric vector.
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>

<hr>
<h2 id='ctbab'>
Closed testing with branch and bound 
</h2><span id='topic+ctbab'></span>

<h3>Description</h3>

<p>Closed testing with branch and bound algorithm specifically for globaltest
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctbab(y, Cm, Tm, upnode, level, lownode, tmin, ctrue, lf, ls, alpha, count = 0, maxIt = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctbab_+3A_y">y</code></td>
<td>

<p>The response variable
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_cm">Cm</code></td>
<td>

<p>The matrix for calculating critical values of globaltest
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_tm">Tm</code></td>
<td>

<p>The matrix for calculating test statistics of globaltest
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_upnode">upnode</code></td>
<td>

<p>The upper node that is used to bound critical values
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_level">level</code></td>
<td>

<p>The level that the GO term of interest 
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_lownode">lownode</code></td>
<td>

<p>The lower node that is used to bound critical values
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_tmin">tmin</code></td>
<td>

<p>The minimum test statistic 
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_ctrue">ctrue</code></td>
<td>

<p>The true critical value corresponding to the minimum test statistic
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_lf">lf</code></td>
<td>

<p>The lambda vector corresponding to the upper node
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_ls">ls</code></td>
<td>

<p>The lambda vector corresponding to the lower node
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_alpha">alpha</code></td>
<td>

<p>The significance level
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_count">count</code></td>
<td>

<p>An integer stores the repetitions of the branch and bound, i.e. how many time branch and bound is implemented
</p>
</td></tr>
<tr><td><code id="ctbab_+3A_maxit">maxIt</code></td>
<td>

<p>The maximal number of repetitions prespecified by user
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It will retrun the rejection indicator by closed testing with branch and bound algorithm.
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>


<h3>References</h3>

<p>Xu, N., &amp; Goeman, J. (2020). Closed testing with Globaltest with applications on metabolomics data. arXiv preprint arXiv:2001.01541.
</p>

<hr>
<h2 id='discov'>
True discoveries
</h2><span id='topic+discov'></span>

<h3>Description</h3>

<p>True discoveries calculated by the partial closed testing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>discov(response, alternative, null, data, maxit = 0, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="discov_+3A_response">response</code></td>
<td>

<p>The response variable
</p>
</td></tr>
<tr><td><code id="discov_+3A_alternative">alternative</code></td>
<td>

<p>The alternative hypothesis, which is a character vector, i.e. a set of genes
</p>
</td></tr>
<tr><td><code id="discov_+3A_null">null</code></td>
<td>

<p>The null hypothesis
</p>
</td></tr>
<tr><td><code id="discov_+3A_data">data</code></td>
<td>

<p>A data frame with response and all covariates included
</p>
</td></tr>
<tr><td><code id="discov_+3A_maxit">maxit</code></td>
<td>

<p>The maximal number of repetitions prespecified by user
</p>
</td></tr>
<tr><td><code id="discov_+3A_alpha">alpha</code></td>
<td>

<p>The significance level
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It will return a non-negative integer: the lower bound for the number of true discovereis of the alternative gene set.
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>

<hr>
<h2 id='newFocus'>
The new focus level procedure
</h2><span id='topic+newFocus'></span>

<h3>Description</h3>

<p>The new focus level procedure for calculating true discoveries for focus level nodes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newFocus(response, fsets, null, data, maxit = 0, alpha = 0.05, adj = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newFocus_+3A_response">response</code></td>
<td>

<p>The response variable
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_fsets">fsets</code></td>
<td>

<p>A list of focus level sets
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_null">null</code></td>
<td>

<p>The null hypothesis
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_data">data</code></td>
<td>

<p>The data frame with response and all covariates included
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_maxit">maxit</code></td>
<td>

<p>The maximal number of repetitions prespecified by user
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_alpha">alpha</code></td>
<td>

<p>The significance level
</p>
</td></tr>
<tr><td><code id="newFocus_+3A_adj">adj</code></td>
<td>

<p>The number of focus sets that are fully rejected by partial closed testing, which is used to adjust the number of focus sets, The dafault value is 0. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function will return a focus subject with the lower bound for each focus level node.
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>


<h3>References</h3>

<p>Goeman, J. J., &amp; Mansmann, U. (2008). Multiple testing on the directed acyclic graph of gene ontology. Bioinformatics, 24(4), 537-544.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example data set
n= 100
m = 5
X = matrix(0, n, m,byrow = TRUE )
for ( i in 1:n){
  set.seed(1234+i)
  X[i,] =  as.vector(arima.sim(model = list(order = c(1, 0, 0), ar = 0.2), n = m) )
}
y = rbinom(n,1,0.6)
X[which(y==1),1:3] = X[which(y==1),1:3] + 0.8
xs = paste("x",seq(1,m,1),sep="") 
colnames(X) = xs

mydata = as.data.frame(cbind(X,y))

## focus level sets
fl = list(c("x1", "x2"), c("x3", "x4"), "x5")
names(fl) = c("12", "34", "5")

## get td for focus level sets
focus_subject = newFocus(response = y, fsets = fl, data = mydata)

## get td for any set of interest given the focus subject
setofinterest = c("x1", "x2","x3", "x4")
pick(focus_subject, setofinterest)

</code></pre>

<hr>
<h2 id='pick'>
True discoveries for non-focus level node
</h2><span id='topic+pick'></span>

<h3>Description</h3>

<p>The number of true discoveries for the non-focus level GO terms is calculated given the focus subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pick(focus_obj, setofinterest)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pick_+3A_focus_obj">focus_obj</code></td>
<td>

<p>The focus subject from function <a href="#topic+newFocus">newFocus</a>
</p>
</td></tr>
<tr><td><code id="pick_+3A_setofinterest">setofinterest</code></td>
<td>

<p>A gene set or GO term of interest
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It will return an integer: the lower bound for the number of true discoveries in the set of interest
</p>


<h3>Author(s)</h3>

<p>Ningning Xu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example data set
n= 100
m = 5
X = matrix(0, n, m,byrow = TRUE )
for ( i in 1:n){
  set.seed(1234+i)
  X[i,] =  as.vector(arima.sim(model = list(order = c(1, 0, 0), ar = 0.2), n = m) )
}
y = rbinom(n,1,0.6)
X[which(y==1),1:3] = X[which(y==1),1:3] + 0.8
xs = paste("x",seq(1,m,1),sep="") 
colnames(X) = xs

mydata = as.data.frame(cbind(X,y))

## focus level sets
fl = list(c("x1", "x2"), c("x3", "x4"), "x5")
names(fl) = c("12", "34", "5")

## get td for focus level sets
focus_subject = newFocus(response = y, fsets = fl, data = mydata)

## get td for any set of interest given the focus subject
setofinterest = c("x1", "x2","x3", "x4")
pick(focus_subject, setofinterest)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
