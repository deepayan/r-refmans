<!DOCTYPE html><html><head><title>Help for package tdthap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tdthap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get.similarity'>
<p>Interogate similarity function for Geary-Moran TDT tests</p></a></li>
<li><a href='#hap.transmit'>
<p>Build parental haplotypes in nuclear families</p></a></li>
<li><a href='#set.similarity'>
<p>Set similarity function for Geary-Moran type TDT tests</p></a></li>
<li><a href='#tdt.quad'>
<p>TDT tests for extended haplotypes</p></a></li>
<li><a href='#tdt.rr'>
<p>Calculate haplotype relative risks in TDT studies</p></a></li>
<li><a href='#tdt.select'>
<p>Select informative transmissions of sub-haplotypes for the TDT test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-29</td>
</tr>
<tr>
<td>Title:</td>
<td>TDT Tests for Extended Haplotypes</td>
</tr>
<tr>
<td>Author:</td>
<td>David Clayton</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jing Hua Zhao &lt;jinghuazhao@hotmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jinghuazhao/R">https://github.com/jinghuazhao/R</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jinghuazhao/R/issues">https://github.com/jinghuazhao/R/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions and examples are provided for Transmission/disequilibrium tests
             for extended marker haplotypes, as in
             Clayton, D. and Jones, H. (1999) "Transmission/disequilibrium tests
             for extended marker haplotypes". Amer. J. Hum. Genet., 65:1161-1169,
             &lt;<a href="https://doi.org/10.1086%2F302566">doi:10.1086/302566</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-29 22:18:15 UTC; jhz22</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-29 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='get.similarity'>
Interogate similarity function for Geary-Moran TDT tests 
</h2><span id='topic+get.similarity'></span>

<h3>Description</h3>

<p>N/A
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.similarity(nloci=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get.similarity_+3A_nloci">nloci</code></td>
<td>

<p>The number of loci.
</p>
</td></tr></table>


<h3>See Also</h3>

<p><code><a href="#topic+tdt.quad">tdt.quad</a></code>, <code><a href="#topic+set.similarity">set.similarity</a></code>
</p>

<hr>
<h2 id='hap.transmit'>
Build parental haplotypes in nuclear families
</h2><span id='topic+hap.transmit'></span>

<h3>Description</h3>

<p>This version only computes parental haplotypes in so far as they can be 
derived with complete certainty. Any locus with is uncertain in the final 
haplotype is coded as zero.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hap.transmit(pedfile, markers=1:((ncol(pedfile) - 6)/2),
             multiple.cases=0, use.affected=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hap.transmit_+3A_pedfile">pedfile</code></td>
<td>

<p>The input dataframe. The first six columns contain the pedigree id, the member
id, the two parental id's, the sex, and the affectation status. Subsequent 
fields are in pairs and represent alleles at marker loci. All variables must 
take integer values, with zero being taken as &quot;missing&quot;.
</p>
</td></tr>
<tr><td><code id="hap.transmit_+3A_markers">markers</code></td>
<td>

<p>Integer array indicating markers to be used and their order. 
</p>
</td></tr>
<tr><td><code id="hap.transmit_+3A_multiple.cases">multiple.cases</code></td>
<td>

<p>The action to be taken if multiple affected offspring in any pedigree. Options
are (0) include all, (1) include all, but whole family is duplicated and only
one offspring is treated as affected in each repeated family, and (2) use only
first affected offspring.
</p>
</td></tr>
<tr><td><code id="hap.transmit_+3A_use.affected">use.affected</code></td>
<td>

<p>If TRUE, data from affected offspring is used when imputing any missing 
parental data. Otherwise it is ignored.
</p>
</td></tr></table>


<h3>Value</h3>

<p>A dataframe with one row for each affected offspring. The first four columns 
identify the offspring by pedigree id, member id, and parental id's. The next 
block of columns hold the transmitted paternal haplotype. Following blocks 
contain the untransmitted paternal haplotype and maternal transmitted and 
untransmitted haplotypes. 
</p>


<h3>References</h3>

<p>Clayton, D. and Jones, H. (1999) Transmission/disequilibrium tests for extended marker
haplotypes. Am. J. Hum. Gen., 65:1161-1169.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tdt.select">tdt.select</a></code>, <code><a href="#topic+tdt.rr">tdt.rr</a></code>, <code><a href="#topic+tdt.quad">tdt.quad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Read a pedfile (which includes the variable names in the top line) 
# and build haplotypes using the markers which appear third, second, and 
# first in the pedfile. 

  filespec &lt;- system.file("tests/test.ped", package="tdthap")
  ped &lt;- read.table(filespec)

  haps &lt;- hap.transmit(ped, markers=c(3,2,1))


## End(Not run)</code></pre>

<hr>
<h2 id='set.similarity'>
Set similarity function for Geary-Moran type TDT tests
</h2><span id='topic+set.similarity'></span>

<h3>Description</h3>

<p>Haplotypes are only similar if they are IBS at the focal locus. The extent of 
the similar region to each side is determined by stepping outwards until 
the haplotypes are no longer IBS, the region being assumed to end midway 
between the last IBS locus and the first non-IBS locus. If the haplotypes are 
IBS at the last locus, half the &quot;off-end&quot; distance is scored. The similarity
is defined as the total length of this shared region raised to some power. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set.similarity(nloci=1, spacing=rep(1, nloci + 1), focus=1, power=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set.similarity_+3A_nloci">nloci</code></td>
<td>

<p>The number of loci.
</p>
</td></tr>
<tr><td><code id="set.similarity_+3A_spacing">spacing</code></td>
<td>

<p>A numeric array of length (nloci+1) giving marker spacings and &quot;off-end&quot; 
distances.
</p>
</td></tr>
<tr><td><code id="set.similarity_+3A_focus">focus</code></td>
<td>

<p>An integer in the range 1:nloci indicating the &quot;focus&quot; for the similarity 
function.
</p>
</td></tr>
<tr><td><code id="set.similarity_+3A_power">power</code></td>
<td>

<p>The power to which the shared haplotype length is raised.
</p>
</td></tr></table>


<h3>Value</h3>

<p>A list of the values loaded.
</p>


<h3>Side Effects</h3>

<p>Sets constants accessed by tdt.quad() when calculating Geary-Moran type 
statistics.
</p>


<h3>References</h3>

<p>Clayton, D. and Jones, H. (1999) Transmission/disequilibrium tests for extended marker 
haplotypes.  Am.J.Hum.Gen., 65:1161-1169.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tdt.quad">tdt.quad</a></code>, <code><a href="#topic+get.similarity">get.similarity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# To do a Geary_Moran test on a 10 marker haplotype
	gaps &lt;- c(0, 50, 60, 80, 20, 30, 50, 40, 50, 100, 0)
	set.similarity(nloci=10, spacing=gaps, power=0.5)
	test &lt;- tdt.quad(hap.use, funct=T)

## End(Not run)</code></pre>

<hr>
<h2 id='tdt.quad'>
TDT tests for extended haplotypes
</h2><span id='topic+tdt.quad'></span>

<h3>Description</h3>

<p>The function calculates the test statistic and then simulates its distribution
under the null hypothesis by randomly transmitting parental haplotypes with 
probability 0.5. The test statistic is recalculated for each simulated dataset.
For Geary-Moran tests in particular this can be quite slow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdt.quad(hap, nsim=5000, funct=FALSE, keep=TRUE, seeds=c(0, 0, 0))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdt.quad_+3A_hap">hap</code></td>
<td>

<p>A list containing the transmitted and untransmitted haplotypes. This would 
normally be computed using <code><a href="#topic+tdt.select">tdt.select</a></code>.
</p>
</td></tr>
<tr><td><code id="tdt.quad_+3A_nsim">nsim</code></td>
<td>

<p>The number of Monte Carlo simulations from the null hypothesis.
</p>
</td></tr>
<tr><td><code id="tdt.quad_+3A_funct">funct</code></td>
<td>

<p>If T, a similarity function is used and the test is a Geary-Moran test. 
Otherwise, the Pearsonian test, Sum <code class="reqn">(O-E)^2/E</code>, is used.
</p>
</td></tr>
<tr><td><code id="tdt.quad_+3A_keep">keep</code></td>
<td>

<p>If TRUE, all simulated values of the test statistic are kept. Otherwise only 
the realised value of the test statistic and the p-value are returned.
</p>
</td></tr>
<tr><td><code id="tdt.quad_+3A_seeds">seeds</code></td>
<td>

<p>Three numbers to seed the random number generator. The default is to use 
a different three random numbers each time.
</p>
</td></tr></table>


<h3>Value</h3>

<p>A list containing, the number of distinct haplotypes (<code class="reqn">n.hap</code>), the number of 
informative transmissions (<code class="reqn">n.trans</code>), the test statistic (<code class="reqn">test</code>), the p-value
(<code class="reqn">p.value</code>) and, optionally, all the simulated values of the test statistic
under the null hypothesis (<code class="reqn">sim</code>).
</p>


<h3>References</h3>

<p>Clayton, D. and Jones, H. (1999) Transmission/disequilibrium tests for extended marker 
haplotypes.  Am.J.Hum.Gen., 65:1161-1169.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hap.transmit">hap.transmit</a></code>, <code><a href="#topic+tdt.select">tdt.select</a></code>,
<code><a href="#topic+tdt.rr">tdt.rr</a></code>, <code><a href="#topic+set.similarity">set.similarity</a></code>,
<code><a href="#topic+get.similarity">get.similarity</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#  Do a Pearsonian test using 10000 simulations and summarise the distribution
#  of the statistic under the null hypothesis


	test &lt;- tdt.quad(hap.use, nsim=10000, keep=T)
	test
	summary(test$sim)

## End(Not run)</code></pre>

<hr>
<h2 id='tdt.rr'>
Calculate haplotype relative risks in TDT studies
</h2><span id='topic+tdt.rr'></span>

<h3>Description</h3>

<p>The p-value is the conventional &quot;exact&quot; test based on the binomial distribution
of transmissions. The estimated relative risks use a Bayesian method, 
recommended because of the multiplicity problem. the prior is a beta 
distribution of the second kind, defined by two &quot;degrees of freedom&quot; 
parameters. Note that the prior mean is prior.df[1]/prior.df[2] and that  
Bayes estimates based on small numbers of transmissions are pulled in towards 
this. A &quot;realistic&quot; choice of these parameters is recommended, and to aid 
this, the function returns credible intervals using the prior alone as well as
the a posteriori interval for each haplotype. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdt.rr(hap, prior.df=c(0.5, 0.5), prob=c(0.05, 0.95))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdt.rr_+3A_hap">hap</code></td>
<td>

<p>A list containing the transmitted and untransmitted haplotypes. This would 
normally be computed using <code><a href="#topic+tdt.select">tdt.select</a></code>.
</p>
</td></tr>
<tr><td><code id="tdt.rr_+3A_prior.df">prior.df</code></td>
<td>

<p>a vector of length two containing the degree of freedom parameters for the 
prior distribution of the haplotype relative risk - a beta distribution of the
second kind. 
</p>
</td></tr>
<tr><td><code id="tdt.rr_+3A_prob">prob</code></td>
<td>

<p>The probability levels for Bayesian credibility intervals for the haplotype
relative risks.
</p>
</td></tr></table>


<h3>Value</h3>

<p>A matrix containing the numbers of transmitted and untransmitted haplotypes, 
the (binomial) p-values, the Bayes estimates of the haplotype relative risks, 
and the lower and upper bounds of the credible interval. The prior estimate 
and credible interval is also shown.  
</p>


<h3>References</h3>

<p>Spielman R., McGinnis R., and Ewens, W. (1993) Transmission tests for linkage 
disequilibrium. American Journal of Human Genetics, 52, 506-16.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hap.transmit">hap.transmit</a></code>, <code><a href="#topic+tdt.select">tdt.select</a></code>, <code><a href="#topic+tdt.quad">tdt.quad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Select the sub-haplotype made up from the first two markers and 
# print tables of TDT tests and haplotype realtaive risks


	hap.use &lt;- tdt.select(haps, markers=1:2)
	rr &lt;- tdt.rr(hap.use)
	rr

## End(Not run)</code></pre>

<hr>
<h2 id='tdt.select'>
Select informative transmissions of sub-haplotypes for the TDT test
</h2><span id='topic+tdt.select'></span>

<h3>Description</h3>

<p>This function is just a data handling intermediary between
<code><a href="#topic+hap.transmit">hap.transmit</a></code>,  
which computes haplotypes, and <code><a href="#topic+tdt.quad">tdt.quad</a></code> and
<code><a href="#topic+tdt.rr">tdt.rr</a></code> which do TDT tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tdt.select(hap.data, markers=1:((ncol(hap.data) - 4)/4), complete=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tdt.select_+3A_hap.data">hap.data</code></td>
<td>

<p>The input dataframe. This will usually have been created by
<code><a href="#topic+hap.transmit">hap.transmit</a></code>. 
</p>
</td></tr>
<tr><td><code id="tdt.select_+3A_markers">markers</code></td>
<td>

<p>An integer array indicating which loci make up the relevant part of the 
haplotype.
</p>
</td></tr>
<tr><td><code id="tdt.select_+3A_complete">complete</code></td>
<td>

<p>If TRUE, only &quot;complete&quot; haplotypes are used (ie no zero's will be included).
</p>
</td></tr></table>


<h3>Value</h3>

<p>A list of two arrays of class &quot;factor&quot;. The first (trans) contains transmitted
haplotypes and the second (untrans) contains untransmitted haplotypes. 
Rownames identify the transmission in terms of pedigree id, offspring id, 
father's id, mother's id, and whether it is a paternal transmission (&quot;f&quot;) or 
a maternal transmission (&quot;m&quot;). 
</p>


<h3>References</h3>

<p>Clayton, D. and Jones, H. (1999) Transmission/disequilibrium tests for extended marker 
haplotypes.  Am.J.Hum.Gen., 65:1161-1169.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hap.transmit">hap.transmit</a></code>, <code><a href="#topic+tdt.rr">tdt.rr</a></code>, <code><a href="#topic+tdt.quad">tdt.quad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Select the sub-haplotype made up from the first two markers and print 
# tables of frequencies of transmitted and untransmitted haplotypes


	hap.use &lt;- tdt.select(haps, markers=1:2)
	table(hap.use$trans)
	table(hap.use$untrans)

## End(Not run)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
