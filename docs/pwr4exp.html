<!DOCTYPE html><html lang="en"><head><title>Help for package pwr4exp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pwr4exp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#contrast1D'><p>Computes power of t-test for one-dimensional contrast matrices</p></a></li>
<li><a href='#contrastMD'><p>Computes power of F-test for multi-dimensional contrast matrices</p></a></li>
<li><a href='#designCRD'><p>Creation of Standard Experimental Designs</p></a></li>
<li><a href='#df.cod'><p>Create a data frame for Crossover design</p></a></li>
<li><a href='#df.crd'><p>Create a data frame of completely randomized design</p></a></li>
<li><a href='#df.lsd'><p>Create a data frame for Latin square design</p></a></li>
<li><a href='#df.rcbd'><p>Create a data frame of randomized complete block design</p></a></li>
<li><a href='#df.spd'><p>Create data frame for split-plot design</p></a></li>
<li><a href='#expandDoubleVerts'><p>Expand terms with <code>'||'</code> notation into separate <code>'|'</code> terms</p></a></li>
<li><a href='#factorize'><p>Convert variables to factors as necessary</p></a></li>
<li><a href='#findbars'><p>Determine random-effects expressions from a formula</p></a></li>
<li><a href='#milk'><p>An exemplary dataset of a 4x4 crossover design with 2 squares</p></a></li>
<li><a href='#mkdesign'><p>Create a Design Object for Power Calculation</p></a></li>
<li><a href='#mkReTrms'><p>Design Matrices and Variance Components for Random Effects</p></a></li>
<li><a href='#mkRTrms'><p>Residual Variance-Covariance Matrices</p></a></li>
<li><a href='#mkStruct'><p>Building Design Matrices and Covariance Structures for Linear Mixed Models</p></a></li>
<li><a href='#nobars'><p>Omit terms separated by vertical bars in a formula</p></a></li>
<li><a href='#pwr.anova'><p>Power of omnibus tests</p></a></li>
<li><a href='#pwr.contrast'><p>Power of contrasts</p></a></li>
<li><a href='#pwr.summary'><p>Power for model coefficients</p></a></li>
<li><a href='#subbars'><p>Substitute Bars</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Power Analysis for Research Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for calculating statistical power for experiments 
    analyzed using linear mixed models. It supports standard designs, including 
    randomized block, split-plot, and Latin Square designs, while offering flexibility 
    to accommodate a variety of other complex study designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/an-ethz/pwr4exp">https://github.com/an-ethz/pwr4exp</a>,
<a href="https://an-ethz.github.io/pwr4exp/">https://an-ethz.github.io/pwr4exp/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/an-ethz/pwr4exp/issues">https://github.com/an-ethz/pwr4exp/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>agricolae, AlgDesign, crossdes, FrF2, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>emmeans, MASS, Matrix, methods, nlme, numDeriv</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-17 10:24:20 UTC; wangkai</td>
</tr>
<tr>
<td>Author:</td>
<td>Kai Wang <a href="https://orcid.org/0000-0002-6672-1121"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Mutian Niu <a href="https://orcid.org/0000-0003-4484-4611"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kai Wang &lt;kai.wang@usys.ethz.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-17 10:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='contrast1D'>Computes power of t-test for one-dimensional contrast matrices</h2><span id='topic+contrast1D'></span>

<h3>Description</h3>

<p>Computes power of t-test for one-dimensional contrast matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrast1D(
  object,
  L,
  method = c("Satterthwaite"),
  sig.level = 0.05,
  alternative = c("two.sided", "one.sided"),
  strict = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrast1D_+3A_object">object</code></td>
<td>
<p>design object</p>
</td></tr>
<tr><td><code id="contrast1D_+3A_l">L</code></td>
<td>
<p>contrast vector</p>
</td></tr>
<tr><td><code id="contrast1D_+3A_method">method</code></td>
<td>
<p>DF approximation method, only &quot;Satterthwaite&quot; available currently</p>
</td></tr>
<tr><td><code id="contrast1D_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level, default 0.05</p>
</td></tr>
<tr><td><code id="contrast1D_+3A_alternative">alternative</code></td>
<td>
<p>one- or two-sided test</p>
</td></tr>
<tr><td><code id="contrast1D_+3A_strict">strict</code></td>
<td>
<p>whether or not use strict interpretation in two-sided case</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns for effect size, degrees of freedom, significance level, power, and test type.
</p>

<hr>
<h2 id='contrastMD'>Computes power of F-test for multi-dimensional contrast matrices</h2><span id='topic+contrastMD'></span>

<h3>Description</h3>

<p>Computes power of F-test for multi-dimensional contrast matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrastMD(object, L, sig.level = 0.05, eps = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrastMD_+3A_object">object</code></td>
<td>
<p>design object</p>
</td></tr>
<tr><td><code id="contrastMD_+3A_l">L</code></td>
<td>
<p>contrast matrix</p>
</td></tr>
<tr><td><code id="contrastMD_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code id="contrastMD_+3A_eps">eps</code></td>
<td>
<p>numeric tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>

<hr>
<h2 id='designCRD'>Creation of Standard Experimental Designs</h2><span id='topic+designCRD'></span><span id='topic+design.CRD'></span><span id='topic+design.RCBD'></span><span id='topic+design.LSD'></span><span id='topic+design.COD'></span><span id='topic+design.SPD'></span><span id='topic+designRCBD'></span><span id='topic+designLSD'></span><span id='topic+designCOD'></span><span id='topic+designSPD'></span>

<h3>Description</h3>

<p>These functions facilitate the creation of standard experimental designs
commonly used in agricultural studies for power analysis. Unlike <a href="#topic+mkdesign">mkdesign</a>
which requires a pre-existing data frame, these functions allow users to
directly specify key design characteristics to generate experimental layouts.
Quantitative parameters describing fixed and random effects remain consistent
with those in <a href="#topic+mkdesign">mkdesign</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>designCRD(
  treatments,
  label,
  replicates,
  formula,
  beta = NULL,
  means = NULL,
  sigma2,
  template = FALSE,
  REML = TRUE
)

designRCBD(
  treatments,
  label,
  blocks,
  formula,
  beta = NULL,
  means = NULL,
  vcomp,
  sigma2,
  template = FALSE,
  REML = TRUE
)

designLSD(
  treatments,
  label,
  squares = 1,
  reuse = c("row", "col", "both"),
  formula,
  beta = NULL,
  means = NULL,
  vcomp,
  sigma2,
  template = FALSE,
  REML = TRUE
)

designCOD(
  treatments,
  label,
  squares = 1,
  formula,
  beta = NULL,
  means = NULL,
  vcomp,
  sigma2,
  template = FALSE,
  REML = TRUE
)

designSPD(
  trt.main,
  trt.sub,
  label,
  replicates,
  formula,
  beta = NULL,
  means = NULL,
  vcomp,
  sigma2,
  template = FALSE,
  REML = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="designCRD_+3A_treatments">treatments</code></td>
<td>
<p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_replicates">replicates</code></td>
<td>
<p>The number of experimental units per treatment in a completely
randomized design or the number of experimental units (main plots) per treatment
of main plot factors.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_formula">formula</code></td>
<td>
<p>A right-hand-side <a href="stats.html#topic+formula">formula</a> specifying the model for testing treatment effects,
with terms on the right of <a href="base.html#topic+~">~</a> , following <a href="lme4.html#topic+lmer">lme4::lmer</a> syntax for random effects.
If not specified, a default formula with main effects and all interactions is used internally.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_beta">beta</code></td>
<td>
<p>One of the optional inputs for fixed effects.
A vector of model coefficients where factor variable coefficients correspond
to dummy variables created using treatment contrast (<a href="stats.html#topic+contrast">stats::contr.treatment</a>).</p>
</td></tr>
<tr><td><code id="designCRD_+3A_means">means</code></td>
<td>
<p>One of the optional inputs for fixed effects.
A vector of marginal or conditioned means (if factors have interactions).
Regression coefficients are required for numerical variables.
Either <code>beta</code> or <code>means</code> must be provided, and their values must strictly follow a specific order.
A template can be created to indicate the required input values and their order.
See <a href="#topic+mkdesign">mkdesign</a> for more information.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_sigma2">sigma2</code></td>
<td>
<p>error variance.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_template">template</code></td>
<td>
<p>Default is <code>FALSE</code>.
If <code>TRUE</code>, a template for <code>beta</code>, <code>means</code>, and <code>vcomp</code> is generated to indicate the required input order.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_reml">REML</code></td>
<td>
<p>Specifies whether to use REML or ML information matrix. Default is <code>TRUE</code> (REML).</p>
</td></tr>
<tr><td><code id="designCRD_+3A_blocks">blocks</code></td>
<td>
<p>The number of blocks.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_vcomp">vcomp</code></td>
<td>
<p>A vector of variance-covariance components for random effects, if present.
The values must follow a strict order. See <a href="#topic+mkdesign">mkdesign</a>.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_squares">squares</code></td>
<td>
<p>The number of replicated squares. By default, 1, i.e., no
replicated squares.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_reuse">reuse</code></td>
<td>
<p>A character string specifying how to replicate squares when
there are multiple squares. Options are: &quot;row&quot; for reusing row blocks, &quot;col&quot;
for reusing column blocks, or &quot;both&quot; for reusing both row and column blocks
to replicate a single square.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_trt.main">trt.main</code></td>
<td>
<p>An integer-valued vector specifying the treatment structure at
main plot level for a split plot design, similar to <code>treatments</code>.</p>
</td></tr>
<tr><td><code id="designCRD_+3A_trt.sub">trt.sub</code></td>
<td>
<p>An integer-valued vector specifying the treatment structure at
sub plot level for a split plot design, similar to <code>treatments</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each function creates a standard design as described below:
</p>

<dl>
<dt><code>designCRD</code></dt><dd><p>Completely Randomized Design.
By default, the model formula is <code>~ trt</code> for one factor and
<code>~ facA*facB</code> for two factors, unless explicitly specified. If the
<code>label</code> argument is provided, the formula is automatically updated with the
specified treatment factor names.</p>
</dd>
<dt><code>designRCBD</code></dt><dd><p>Randomized Complete Block Design.
Experimental units are grouped into blocks, with each treatment appearing
<strong>exactly</strong> once per block (i.e., no replicates per treatment within a block).
The default model formula is <code>~ trt + (1|block)</code> for one factor and
<code>~ facA*facB + (1|block)</code> for two factors. If <code>label</code> is provided, the
fixed effect parts of the formula are automatically updated with the specified
names. The block factor is named &quot;block&quot; and not changeable.</p>
</dd>
<dt><code>designLSD</code></dt><dd><p>Latin Square Design.
The default formula is <code>~ trt + (1|row) + (1|col)</code> for one factor and
<code>~ facA*facB + (1|row) + (1|col)</code> for two factors. If <code>label</code> is provided,
the fixed effect parts of the formula are automatically updated with the specified
names. The names of row (&quot;row&quot;) and column (&quot;col&quot;) block factors are not changeable.</p>
</dd>
<dt><code>designCOD</code></dt><dd><p>Crossover Design, which is a special case of LSD
with time periods and individuals as blocks. Period blocks are reused when
replicating squares.
The default formula is <code>~ trt + (1|subject) + (1|period)</code> for one factor
and <code>~ facA*facB + (1|subject) + (1|period)</code> for two factors. If <code>label</code>
is provided, the fixed effect parts of the formula are automatically updated
with the specified names. Note that &quot;subject&quot; and &quot;period&quot; are the names for
the two blocking factors and cannot be changed.</p>
</dd>
<dt><code>designSPD</code></dt><dd><p>Split Plot Design.
The default formula includes the main effects of all treatment factors at
both the main and sub-plot levels, their interactions, and the random effects
of main plots: <code>~ . + (1|mainplot)</code>. If <code>label</code> is provided, the fixed
effect parts of the formula are automatically updated with the specified names.
The experimental unit at the main plot level (i.e., the block factor at the
subplot level) is always named as &quot;mainplot&quot;.</p>
</dd></dl>



<h3>Value</h3>

<p>A list object containing all essential components for power calculation.
This includes:
</p>

<ul>
<li><p> Structural components (deStruct): including the data frame, design matrices
for fixed and random effects, variance-covariance matrices for random effects
and residuals, etc.
</p>
</li>
<li><p> Internally calculated higher-level parameters (deParam), including variance-covariance
matrix of beta coefficients (vcov_beta), variance-covariance matrix of variance parameters (vcov_varpar),
gradient matrices (Jac_list), etc.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+mkdesign">mkdesign</a>, <a href="#topic+pwr.anova">pwr.anova</a>, <a href="#topic+pwr.contrast">pwr.contrast</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Evaluate the power of a CRD with one treatment factor
## Create a design object
crd &lt;- designCRD(
  treatments = 4, # 4 levels of one treatment factor
  replicates = 12, # 12 units per level, 48 units totally
  means = c(30, 28, 33, 35), # means of the 4 levels
  sigma2 = 10 # error variance
)

## power of omnibus test
pwr.anova(crd)

## power of contrast
pwr.contrast(crd, which = "trt", contrast = "pairwise") # pairwise comparisons
pwr.contrast(crd, which = "trt", contrast = "poly") # polynomial contrasts

# More examples are available in `vignette("pwr4exp")`
# and on https://an-ethz.github.io/pwr4exp/

</code></pre>

<hr>
<h2 id='df.cod'>Create a data frame for Crossover design</h2><span id='topic+df.cod'></span>

<h3>Description</h3>

<p>Create a data frame for Crossover design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.cod(treatments, label, squares)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.cod_+3A_treatments">treatments</code></td>
<td>
<p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p>
</td></tr>
<tr><td><code id="df.cod_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="df.cod_+3A_squares">squares</code></td>
<td>
<p>The number of replicated squares. By default, 1, i.e., no
replicated squares.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame representing the data structure of the design
</p>

<hr>
<h2 id='df.crd'>Create a data frame of completely randomized design</h2><span id='topic+df.crd'></span>

<h3>Description</h3>

<p>Create a data frame of completely randomized design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.crd(treatments, label, replicates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.crd_+3A_treatments">treatments</code></td>
<td>
<p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p>
</td></tr>
<tr><td><code id="df.crd_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code>
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="df.crd_+3A_replicates">replicates</code></td>
<td>
<p>The number of experimental units per treatment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame representing the data structure of the design
</p>

<hr>
<h2 id='df.lsd'>Create a data frame for Latin square design</h2><span id='topic+df.lsd'></span>

<h3>Description</h3>

<p>Create a data frame for Latin square design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.lsd(treatments, label, squares = 1, reuse = c("row", "col", "both"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.lsd_+3A_treatments">treatments</code></td>
<td>
<p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p>
</td></tr>
<tr><td><code id="df.lsd_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="df.lsd_+3A_squares">squares</code></td>
<td>
<p>the number of replicated squares</p>
</td></tr>
<tr><td><code id="df.lsd_+3A_reuse">reuse</code></td>
<td>
<p>A character string specifying how to replicate squares when
there are multiple squares. Options are: &quot;row&quot; for reusing row blocks, &quot;col&quot;
for reusing column blocks, or &quot;both&quot; for reusing both row and column blocks
to replicate a single square.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame representing the data structure of the design
</p>

<hr>
<h2 id='df.rcbd'>Create a data frame of randomized complete block design</h2><span id='topic+df.rcbd'></span>

<h3>Description</h3>

<p>Create a data frame of randomized complete block design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.rcbd(treatments, label, blocks)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.rcbd_+3A_treatments">treatments</code></td>
<td>
<p>An integer vector where each element represents the number of levels
of the corresponding treatment factor. A single integer (e.g., <code>treatments = n</code>)
specifies one treatment factor with <code>n</code> levels. When multiple factors are provided,
they are arranged in a factorial treatment factor design. For example,
<code>treatments = c(2, 3)</code> creates a 2x3 factorial design with the first factor having 2 levels
and the second factor having 3 levels.</p>
</td></tr>
<tr><td><code id="df.rcbd_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="df.rcbd_+3A_blocks">blocks</code></td>
<td>
<p>the number of blocks</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame representing the data structure of the design
</p>

<hr>
<h2 id='df.spd'>Create data frame for split-plot design</h2><span id='topic+df.spd'></span>

<h3>Description</h3>

<p>Create data frame for split-plot design
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df.spd(trt.main, trt.sub, label, replicates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df.spd_+3A_trt.main">trt.main</code></td>
<td>
<p>an integer-valued vector specifying the treatment structure at
main plot level, similar to <code><a href="#topic+df.crd">df.crd</a></code>.</p>
</td></tr>
<tr><td><code id="df.spd_+3A_trt.sub">trt.sub</code></td>
<td>
<p>an integer-valued vector specifying the treatment structure at
sub plot level, similar to <code>trt.main</code>.</p>
</td></tr>
<tr><td><code id="df.spd_+3A_label">label</code></td>
<td>
<p>Optional. A list of character vectors, each corresponding to a treatment factor.
The name of each vector specifies the factor's name, and its elements provide the labels for that factor's levels.
If no labels are provided, default labels will be used. For a single treatment factor, the default is
<code>list(trt = c("1", "2", ...))</code>, and for two treatment factors, the default is
<code>list(facA = c("1", "2", ...), facB = c("1", "2", ...))</code>.
For split-plot designs, the defaults are similar but include the &quot;.main&quot; and &quot;.sub&quot; suffixes for main plot and subplot factors.
For example:
<code>list(trt.main = c("1", "2", ...), trt.sub = c("1", "2", ...))</code> and
<code>list(facA.main = c("1", "2", ...), facB.main = c("1", "2", ...),
      facA.sub = c("1", "2", ...), facB.sub = c("1", "2", ...))</code>.
Label sets should be arranged so that the main plot factors come first, followed by the subplot factors.</p>
</td></tr>
<tr><td><code id="df.spd_+3A_replicates">replicates</code></td>
<td>
<p>the number of experimental units (main plots) per treatment
of main plot factors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame representing the data structure of the design
</p>

<hr>
<h2 id='expandDoubleVerts'>Expand terms with <code>'||'</code> notation into separate <code>'|'</code> terms</h2><span id='topic+expandDoubleVerts'></span>

<h3>Description</h3>

<p>Expand terms with <code>'||'</code> notation into separate <code>'|'</code> terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expandDoubleVerts(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expandDoubleVerts_+3A_term">term</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the modified term
</p>

<hr>
<h2 id='factorize'>Convert variables to factors as necessary</h2><span id='topic+factorize'></span>

<h3>Description</h3>

<p>Convert variables to factors as necessary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factorize(x, frloc, char.only = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="factorize_+3A_x">x</code></td>
<td>
<p>a formula</p>
</td></tr>
<tr><td><code id="factorize_+3A_frloc">frloc</code></td>
<td>
<p>a data frame</p>
</td></tr>
<tr><td><code id="factorize_+3A_char.only">char.only</code></td>
<td>
<p>(logical) convert only character variables to factors?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a copy of the data frame with factors converted
</p>

<hr>
<h2 id='findbars'>Determine random-effects expressions from a formula</h2><span id='topic+findbars'></span>

<h3>Description</h3>

<p>Determine random-effects expressions from a formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findbars(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="findbars_+3A_term">term</code></td>
<td>
<p>a mixed-model formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pairs of expressions that were separated by vertical bars
</p>


<h3>Note</h3>

<p>This function is called recursively on individual
terms in the model, which is why the argument is called <code>term</code> and not
a name like <code>form</code>, indicating a formula.
</p>

<hr>
<h2 id='milk'>An exemplary dataset of a 4x4 crossover design with 2 squares</h2><span id='topic+milk'></span>

<h3>Description</h3>

<p>Milk yield records from 8 cows over 4 different periods in a 4x4 crossover design.
The design includes 2 Latin squares, each consisting of 4 cows and 4 periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>milk
</code></pre>


<h3>Format</h3>

<p>A data frame with 32 rows and 4 variables:
</p>

<dl>
<dt>Cow</dt><dd><p>Factor: Cow index (8 levels)</p>
</dd>
<dt>Period</dt><dd><p>Factor: Period index (4 levels)</p>
</dd>
<dt>Treatment</dt><dd><p>Factor: Treatment index (4 levels)</p>
</dd>
<dt>MilkYield</dt><dd><p>Numeric: milk yield recordings (in kg)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data for package demonstration purposes.
</p>

<hr>
<h2 id='mkdesign'>Create a Design Object for Power Calculation</h2><span id='topic+mkdesign'></span>

<h3>Description</h3>

<p>Generate a design object for power analysis by specifying a model formula and data frame.
This object is not a true experimental design as created by design generation procedures,
where randomization and unit allocation are performed.
Instead, it serves as an object containing all necessary information for power analysis,
including design matrices, assumed values of model effects, and other internally
calculated parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkdesign(
  formula,
  data,
  beta = NULL,
  means = NULL,
  vcomp = NULL,
  sigma2 = NULL,
  correlation = NULL,
  template = FALSE,
  REML = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkdesign_+3A_formula">formula</code></td>
<td>
<p>A right-hand-side <a href="stats.html#topic+formula">formula</a> specifying the model for testing treatment effects,
with terms on the right of <a href="base.html#topic+~">~</a> , following <a href="lme4.html#topic+lmer">lme4::lmer</a> syntax for random effects.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_data">data</code></td>
<td>
<p>A data frame with all independent variables specified in the model,
matching the design's structure.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_beta">beta</code></td>
<td>
<p>One of the optional inputs for fixed effects.
A vector of model coefficients where factor variable coefficients correspond
to dummy variables created using treatment contrast (<a href="stats.html#topic+contrast">stats::contr.treatment</a>).</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_means">means</code></td>
<td>
<p>One of the optional inputs for fixed effects.
A vector of marginal or conditioned means (if factors have interactions).
Regression coefficients are required for numerical variables.
Either <code>beta</code> or <code>means</code> must be provided, and their values must strictly follow a specific order.
A template can be created to indicate the required input values and their order.
See &quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_vcomp">vcomp</code></td>
<td>
<p>A vector of variance-covariance components for random effects, if present.
The values must follow a strict order. See &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_sigma2">sigma2</code></td>
<td>
<p>error variance.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_correlation">correlation</code></td>
<td>
<p>Specifies residual (R-side) correlation structures using <a href="nlme.html#topic+corClasses">nlme::corClasses</a> functions.
See &quot;Details&quot; for more information.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_template">template</code></td>
<td>
<p>Default is <code>FALSE</code>.
If <code>TRUE</code> or when only the formula and data are provided, a template for <code>beta</code>,
<code>means</code>, and <code>vcomp</code> is generated to indicate the required input order.</p>
</td></tr>
<tr><td><code id="mkdesign_+3A_reml">REML</code></td>
<td>
<p>Specifies whether to use REML or ML information matrix. Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><strong>data</strong>: A long-format data frame is required, as typically used in R for fitting linear models.
This data frame can be created manually or with the help of design creation packages
such as <span class="pkg">agricolae</span>, <span class="pkg">AlgDesign</span>, <span class="pkg">crossdes</span>, or <span class="pkg">FrF2</span>.
It should include all independent variables specified in the model (e.g., treatments, blocks, subjects).
All the irrelevant variables not specified in the model are ignored.
</p>
</li>
<li> <p><strong>template</strong>: Templates are automatically generated when only the formula and data are supplied,
or explicitly if <code>template = TRUE</code>. Templates serve as guides for specifying inputs:
</p>

<ul>
<li> <p><strong>Template for <code>beta</code></strong>: Represents the sequence of model coefficients.
</p>
</li>
<li> <p><strong>Template for <code>means</code></strong>: Specifies the order of means (for categorical variables)
and/or regression coefficients (for continuous variables), depending on the scenario:
</p>

<ul>
<li> <p><em>Categorical variables without interactions</em>: Requires marginal means for each level of the categorical variable(s).
</p>
</li>
<li> <p><em>Interactions among categorical variables</em>: Requires conditional (cell) means for all level combinations.
</p>
</li>
<li> <p><em>Numerical variables without interactions</em>: Requires regression coefficients.
The intercept must also be included if there are no categorical variables in the model.
</p>
</li>
<li> <p><em>Interactions among numerical variables</em>: Requires regression coefficients for both main effects and interaction terms.
The intercept must also be included if there are no categorical variables in the model.
</p>
</li>
<li> <p><em>Categorical-by-numerical interactions</em>: Requires regression coefficients for the numerical variable
at each level of the categorical variable, as well as marginal means for the levels of the categorical variable.
</p>
</li></ul>

<p>Note: For models containing only numerical variables, the inputs for <code>means</code> and <code>beta</code> are identical.
See the &quot;Examples&quot; for illustrative scenarios.
</p>
</li>
<li> <p><strong>Template for <code>vcomp</code></strong>: Represents a variance-covariance matrix, where integers indicate
the order of variance components in the input vector.
</p>
</li></ul>

</li>
<li> <p><strong>correlation</strong>: Various residual correlation structures can be specified following the instructions from <a href="nlme.html#topic+corClasses">nlme::corClasses</a>.
</p>
<p>Note: In <code><a href="nlme.html#topic+corAR1">nlme::corAR1()</a></code> and <code><a href="nlme.html#topic+corARMA">nlme::corARMA()</a></code> when <code>p=1</code> and <code>q=0</code>, the time variable must be an integer.
However, in <code>pwr4exp</code>, this restriction has been released, factor is also supported.
</p>
</li></ul>



<h3>Value</h3>

<p>A list object containing all essential components for power calculation.
This includes:
</p>

<ul>
<li><p> Structural components (deStruct): including design matrices for fixed and random effects,
variance-covariance matrices for random effects and residuals, etc.
</p>
</li>
<li><p> Internally calculated higher-level parameters (deParam), including variance-covariance
matrix of beta coefficients (vcov_beta), variance-covariance matrix of variance parameters (vcov_varpar),
gradient matrices (Jac_list), etc.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Using templates for specifying "means"

# Create an example data frame with four categorical variables (factors)
# and two numerical variables
df1 &lt;- expand.grid(
  fA = factor(1:2),
  fB = factor(1:2),
  fC = factor(1:3),
  fD = factor(1:3),
  subject = factor(1:10)
)
df1$x &lt;- rnorm(nrow(df1))  # Numerical variable x
df1$z &lt;- rnorm(nrow(df1))  # Numerical variable z

## Categorical variables without interactions
# Means of each level of fA and fB are required in sequence.
mkdesign(~ fA + fB, df1)$fixeff$means

## Interactions among categorical variables
# Cell means for all combinations of levels of fA and fB are required.
mkdesign(~ fA * fB, df1)$fixeff$means

## Numerical variables without and with interactions, identical to beta.
# Without interactions: Regression coefficients are required
mkdesign(~ x + z, df1)$fixeff$means

# With interactions: Coefficients for main effects and interaction terms are required.
mkdesign(~ x * z, df1)$fixeff$means

## Categorical-by-numerical interactions
# Marginal means for each level of fA, and regression coefficients for x
# at each level of fA are required.
mkdesign(~ fA * x, df1)$fixeff$means

## Three factors with interactions:
# Cell means for all 12 combinations of the levels of fA, fB, and fC are required.
mkdesign(~ fA * fB * fC, df1)

# A design that mixes the above-mentioned scenarios:
# - Interactions among three categorical variables (fA, fB, fC)
# - A categorical-by-numerical interaction (fD * x)
# - Main effects for another numerical variable (z)
# The required inputs are:
# - Cell means for all combinations of levels of fA, fB, and fC
# - Means for each level of fD
# - Regression coefficients for x at each level of fD
# - Regression coefficients for z
mkdesign(~ fA * fB * fC + fD * x + z, df1)$fixeff$means

# Using templates for specifying "vcomp"

# Assume df1 represents an RCBD with "subject" as a random blocking factor.
## Variance of the random effect "subject" (intercept) is required.
mkdesign(~ fA * fB * fC * fD + (1 | subject), df1)$varcov

# Demonstration of templates for more complex random effects
## Note: This example is a demo and statistically incorrect for this data
## (no replicates under subject*fA). It only illustrates variance-covariance templates.
## Inputs required:
## - Variance of the random intercept (1st)
## - Covariance between the intercept and "fA2" (2nd)
## - Variance of "fA2" (3rd)
mkdesign(~ fA * fB * fC * fD + (1 + fA | subject), df1)$varcov

# Power analysis for repeated measures

## Create a data frame for a CRD with repeated measures
n_subject &lt;- 6
n_trt &lt;- 3
n_hour &lt;- 8
trt &lt;- c("CON", "TRT1", "TRT2")
df2 &lt;- data.frame(
  subject = as.factor(rep(seq_len(n_trt * n_subject), each = n_hour)), # Subject as a factor
  hour = as.factor(rep(seq_len(n_hour), n_subject * n_trt)),           # Hour as a factor
  trt = rep(trt, each = n_subject * n_hour)                           # Treatment as a factor
)

## Templates
temp &lt;- mkdesign(formula = ~ trt * hour, data = df2)
temp$fixeff$means  # Fixed effects means template

## Create a design object
# Assume repeated measures within a subject follow an AR1 process with a correlation of 0.6
design &lt;- mkdesign(
  formula = ~ trt * hour,
  data = df2,
  means = c(1, 2.50, 3.50,
            1, 3.50, 4.54,
            1, 3.98, 5.80,
            1, 4.03, 5.40,
            1, 3.68, 5.49,
            1, 3.35, 4.71,
            1, 3.02, 4.08,
            1, 2.94, 3.78),
  sigma2 = 2,
  correlation = corAR1(value = 0.6, form = ~ hour | subject)
)

pwr.anova(design)  # Perform power analysis

## When time is treated as a numeric variable
# Means of treatments and regression coefficients for hour at each treatment level are required
df2$hour &lt;- as.integer(df2$hour)
mkdesign(formula = ~ trt * hour, data = df2)$fixeff$means

## Polynomial terms of time in the model
mkdesign(formula = ~ trt + hour + I(hour^2) + trt:hour + trt:I(hour^2), data = df2)$fixeff$means
</code></pre>

<hr>
<h2 id='mkReTrms'>Design Matrices and Variance Components for Random Effects</h2><span id='topic+mkReTrms'></span>

<h3>Description</h3>

<p>Adapted from lme4, this function constructs the design matrix (Z),
variance-covariance matrix (G), etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkReTrms(
  bars,
  fr,
  drop.unused.levels = TRUE,
  reorder.terms = FALSE,
  reorder.vars = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkReTrms_+3A_bars">bars</code></td>
<td>
<p>a list of parsed random-effects terms</p>
</td></tr>
<tr><td><code id="mkReTrms_+3A_fr">fr</code></td>
<td>
<p>a model frame in which to evaluate these terms</p>
</td></tr>
<tr><td><code id="mkReTrms_+3A_drop.unused.levels">drop.unused.levels</code></td>
<td>
<p>(logical) drop unused factor levels?</p>
</td></tr>
<tr><td><code id="mkReTrms_+3A_reorder.terms">reorder.terms</code></td>
<td>
<p>arrange random effects terms in decreasing order of number of groups (factor levels)?</p>
</td></tr>
<tr><td><code id="mkReTrms_+3A_reorder.vars">reorder.vars</code></td>
<td>
<p>arrange columns of individual random effects terms in alphabetical order?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p> Zt: Transposed random-effects design matrix.
</p>
</li>
<li><p> G: Variance-covariance matrix for random effects.
</p>
</li>
<li><p> Gind: Index mapping variance-covariance parameters to their positions in G.
</p>
</li>
<li><p> G_temp: List of individual variance component matrices for each random effect.
</p>
</li>
<li><p> flist: List of grouping factors used in random effects.
</p>
</li>
<li><p> cnms: Column names of the random-effects design matrix.
</p>
</li>
<li><p> Ztlist: List of per-term transposed design matrices for random effects.
</p>
</li>
<li><p> nl: Number of levels for each grouping factor.
</p>
</li></ul>


<hr>
<h2 id='mkRTrms'>Residual Variance-Covariance Matrices</h2><span id='topic+mkRTrms'></span>

<h3>Description</h3>

<p>Residual Variance-Covariance Matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkRTrms(data, corcall = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkRTrms_+3A_data">data</code></td>
<td>
<p>a data frame with grouping factors and covariates.</p>
</td></tr>
<tr><td><code id="mkRTrms_+3A_corcall">corcall</code></td>
<td>
<p>a <code>call</code> object specifying the residual correlation structure.
If NULL, an identity matrix is assumed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p> corcall
</p>
</li>
<li><p> corframe: A processed data frame with indexed grouping variables and
ordering for correlation structures.
</p>
</li>
<li><p> R: A block-diagonal residual variance-covariance structure, not yet scaled
by the residual variance
</p>
</li></ul>


<hr>
<h2 id='mkStruct'>Building Design Matrices and Covariance Structures for Linear Mixed Models</h2><span id='topic+mkStruct'></span>

<h3>Description</h3>

<p>Constructs design matrices for fixed and random effects, along with
variance-covariance structures for random effects (G-side) and residuals (R-side).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkStruct(formula, data, corcall)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mkStruct_+3A_formula">formula</code></td>
<td>
<p>a model formula.</p>
</td></tr>
<tr><td><code id="mkStruct_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables used in the model.</p>
</td></tr>
<tr><td><code id="mkStruct_+3A_corcall">corcall</code></td>
<td>
<p>a <code>call</code> object specifying the residual correlation structure.
If NULL, an identity matrix is assumed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>data</code>: Processed data frame with NA values omitted.
</p>
</li>
<li> <p><code>fxTrms</code>: Fixed-effects design structure, including model frame and design matrix.
</p>
</li>
<li> <p><code>reTrms</code>: Random-effects structure (if applicable), including grouping factors,
design matrices, and variance-covariance matrix.
</p>
</li>
<li> <p><code>rTrms</code>: Residual structure (R-side variance-covariance components).
</p>
</li>
<li> <p><code>formula</code>: Expanded model formula.
</p>
</li></ul>


<hr>
<h2 id='nobars'>Omit terms separated by vertical bars in a formula</h2><span id='topic+nobars'></span>

<h3>Description</h3>

<p>Remove the random-effects terms from a mixed-effects formula,
thereby producing the fixed-effects formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nobars(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nobars_+3A_term">term</code></td>
<td>
<p>the right-hand side of a mixed-model formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the fixed-effects part of the formula
</p>


<h3>Note</h3>

<p>This function is called recursively on individual
terms in the model, which is why the argument is called <code>term</code> and not
a name like <code>form</code>, indicating a formula.
</p>

<hr>
<h2 id='pwr.anova'>Power of omnibus tests</h2><span id='topic+pwr.anova'></span>

<h3>Description</h3>

<p>Calculates the statistical power for testing the overall effects of treatment
factors and their interactions, i.e., power of F-test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr.anova(object, sig.level = 0.05, type = c("III", "II", "I", "3", "2", "1"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pwr.anova_+3A_object">object</code></td>
<td>
<p>a design object created in pwr4exp</p>
</td></tr>
<tr><td><code id="pwr.anova_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level, default 0.05</p>
</td></tr>
<tr><td><code id="pwr.anova_+3A_type">type</code></td>
<td>
<p>the type of ANOVA table requested, default Type III</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with numerator degrees of freedom (<code>NumDF</code>), denominator
degrees of freedom (<code>DenDF</code>), type I error rate (<code>sig.level</code>), and <code>power</code>.
</p>


<h3>See Also</h3>

<p><a href="#topic+mkdesign">mkdesign</a>, <a href="#topic+designCRD">designCRD</a>, <a href="#topic+designRCBD">designRCBD</a>, <a href="#topic+designLSD">designLSD</a>, <a href="#topic+designCOD">designCOD</a>, <a href="#topic+designSPD">designSPD</a>, <a href="#topic+pwr.summary">pwr.summary</a> and <a href="#topic+pwr.contrast">pwr.contrast</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate an RCBD
rcbd &lt;- designRCBD(
  treatments = c(2, 2),
  label = list(facA = c("1", "2"), facB = c("1", "2")),
  blocks = 12,
  formula = ~ facA*facB + (1|block),
  means = c(32, 35, 30, 37),
  vcomp = 4,
  sigma2 = 6
)
# power of omnibus test
pwr.anova(rcbd)

</code></pre>

<hr>
<h2 id='pwr.contrast'>Power of contrasts</h2><span id='topic+pwr.contrast'></span>

<h3>Description</h3>

<p>Computes the statistical power of t-tests for comparisons among means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr.contrast(
  object,
  which,
  by = NULL,
  contrast = c("pairwise", "poly", "trt.vs.ctrl"),
  sig.level = 0.05,
  p.adj = FALSE,
  alternative = c("two.sided", "one.sided"),
  strict = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pwr.contrast_+3A_object">object</code></td>
<td>
<p>a design object created in pwr4exp</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_which">which</code></td>
<td>
<p>the factor of interest. Multiple factors can be combined using
<code>:</code> or <code>*</code>, e.g., <code>"facA*facB"</code>, which represents a single factor that combines
the levels of both factors.</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_by">by</code></td>
<td>
<p>the variable to condition on</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_contrast">contrast</code></td>
<td>
<p>A character string specifying the contrast method, one of
&quot;pairwise&quot;, &quot;poly&quot;, or &quot;trt.vs.ctrl&quot;. Alternatively, a numeric vector defining
a single contrast or a (named) list of vectors specifying multiple custom contrasts.
If a list is provided, each element must be a vector whose length matches the
number of levels of the factor in each <code>by</code> group. In multi-factor scenarios,
factor levels are combined and treated as a single factor.</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level, default 0.05</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_p.adj">p.adj</code></td>
<td>
<p>whether the sig.level should be adjusted using the Bonferroni method, default FALSE</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_alternative">alternative</code></td>
<td>
<p>one- or two-sided test. Can be abbreviated.</p>
</td></tr>
<tr><td><code id="pwr.contrast_+3A_strict">strict</code></td>
<td>
<p>use strict interpretation in two-sided case</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For each <code>by</code> condition, returns a data frame containing the contrast value (<code>effect</code>),
degrees of freedom (<code>df</code>), type I error rate (<code>sig.level</code>), <code>power</code>, and the test direction
(by <code>alternative</code>).
When multiple <code>by</code> conditions are present, the results are returned as a list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rcbd &lt;- designRCBD(
  treatments = c(2, 2),
  label = list(facA = c("1", "2"), facB = c("1", "2")),
  blocks = 12,
  formula = ~ facA*facB + (1|block),
  means = c(32, 35, 30, 37),
  vcomp = 4,
  sigma2 = 6
)

# If contrast is not specified, pairwise comparisons are conducted
pwr.contrast(rcbd, which = "facA") # Marginal effect of facA
pwr.contrast(rcbd, which = "facA", by = "facB") # Conditional effect of facA within levels of facB

# Custom contrast vector, identical to pairwise comparison
pwr.contrast(rcbd, which = "facA", contrast = c(1, -1))
pwr.contrast(rcbd, which = "facA", by = "facB", contrast = c(1, -1))

# A single factor combining two factors
pwr.contrast(
  rcbd,
  which = "facA*facB",
  contrast = list(
    A1B1vs.A2B1 = c(1, -1, 0, 0),
    A1B1vs.A2B2 = c(1, 0, 0, -1)
  )
)
</code></pre>

<hr>
<h2 id='pwr.summary'>Power for model coefficients</h2><span id='topic+pwr.summary'></span>

<h3>Description</h3>

<p>Computes the statistical power for testing (t-test) model coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pwr.summary(object, sig.level = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pwr.summary_+3A_object">object</code></td>
<td>
<p>design object</p>
</td></tr>
<tr><td><code id="pwr.summary_+3A_sig.level">sig.level</code></td>
<td>
<p>significance level, default 0.05</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame containing model coefficients, degrees of freedom (<code>df</code>),
type I error rate (<code>sig.level</code>), power, and the test direction (<code>alternative</code>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rcbd &lt;- designRCBD(
  treatments = c(2, 2),
  label = list(facA = c("1", "2"), facB = c("1", "2")),
  blocks = 12,
  formula = ~ facA*facB + (1|block),
  means = c(32, 35, 30, 37),
  vcomp = 4,
  sigma2 = 6
)
pwr.summary(rcbd)
</code></pre>

<hr>
<h2 id='subbars'>Substitute Bars</h2><span id='topic+subbars'></span>

<h3>Description</h3>

<p>Substitute the '+' function for the '|' and '||' function in a mixed-model
formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>subbars(term)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="subbars_+3A_term">term</code></td>
<td>
<p>a mixed-model formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the formula with all |  and || operators replaced by +
</p>


<h3>Note</h3>

<p>This function is called recursively on individual
terms in the model, which is why the argument is called <code>term</code> and not
a name like <code>form</code>, indicating a formula.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
