<!DOCTYPE html><html><head><title>Help for package recapr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {recapr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ciBailey'><p>Confidence Intervals for the Bailey Estimator</p></a></li>
<li><a href='#ciChapman'><p>Confidence Intervals for the Chapman Estimator</p></a></li>
<li><a href='#ciPetersen'><p>Confidence Intervals for the Petersen Estimator</p></a></li>
<li><a href='#cistrat'><p>Confidence Intervals for the Stratified Estimator</p></a></li>
<li><a href='#consistencytest'><p>Consistency Tests for the Abundance Estimator, Partial Stratification</p></a></li>
<li><a href='#n2RR'><p>Mark-Recapture Sample Size, Robson-Regier</p></a></li>
<li><a href='#NBailey'><p>Bailey Estimator</p></a></li>
<li><a href='#NChapman'><p>Chapman Estimator</p></a></li>
<li><a href='#NDarroch'><p>Spatially or Temporally Stratified Abundance Est (Darroch)</p></a></li>
<li><a href='#NPetersen'><p>Petersen Estimator</p></a></li>
<li><a href='#Nstrat'><p>Stratified Abundance Estimator</p></a></li>
<li><a href='#pBailey'><p>Hypothesis Testing Using the Bailey Estimator</p></a></li>
<li><a href='#pChapman'><p>Hypothesis Testing Using the Chapman Estimator</p></a></li>
<li><a href='#plotdiscdensity'><p>Plotting the Density of a Vector of Discrete Values</p></a></li>
<li><a href='#plotn1n2simmatrix'><p>Mark-Recapture Sample Size Via Sim, Both Samples</p></a></li>
<li><a href='#plotn2sim'><p>Mark-Recapture Sample Size Via Simulation</p></a></li>
<li><a href='#powBailey'><p>Power for Hypothesis Testing Using the Bailey Estimator</p></a></li>
<li><a href='#powChapman'><p>Power for Hypothesis Testing Using the Chapman Estimator</p></a></li>
<li><a href='#powconsistencytest'><p>Power of Consistency Tests, Partial Stratification</p></a></li>
<li><a href='#powPetersen'><p>Power for Hypothesis Testing Using the Petersen Estimator</p></a></li>
<li><a href='#powstrattest'><p>Power of Consistency Tests, Complete Stratification</p></a></li>
<li><a href='#pPetersen'><p>Hypothesis Testing Using the Petersen Estimator</p></a></li>
<li><a href='#print.recapr_consistencypow'><p>Print method for consistency test power</p></a></li>
<li><a href='#print.recapr_consistencytest'><p>Print method for consistency test</p></a></li>
<li><a href='#print.recapr_stratpow'><p>Print method for stratification test power</p></a></li>
<li><a href='#print.recapr_strattest'><p>Print method for stratification test</p></a></li>
<li><a href='#rBailey'><p>Random Draws from the Bailey Estimator</p></a></li>
<li><a href='#rChapman'><p>Random Draws from the Chapman Estimator</p></a></li>
<li><a href='#recapr-package'>
<p>Estimating, Testing, and Simulating Abundance in a Mark-Recapture Experiment</p></a></li>
<li><a href='#rPetersen'><p>Random Draws from the Petersen Estimator</p></a></li>
<li><a href='#rstrat'><p>Random Draws from the Stratified Estimator</p></a></li>
<li><a href='#seBailey'><p>Standard Error of the Bailey Estimator</p></a></li>
<li><a href='#seChapman'><p>Standard Error of the Chapman Estimator</p></a></li>
<li><a href='#sePetersen'><p>Standard Error of the Petersen Estimator</p></a></li>
<li><a href='#sestrat'><p>Standard Error of Stratified Abundance Estimator</p></a></li>
<li><a href='#strattest'><p>Consistency Tests for the Abundance Estimator, Complete Stratification</p></a></li>
<li><a href='#vBailey'><p>Estimated Variance of the Bailey Estimator</p></a></li>
<li><a href='#vChapman'><p>Estimated Variance of the Chapman Estimator</p></a></li>
<li><a href='#vPetersen'><p>Estimated Variance of the Petersen Estimator</p></a></li>
<li><a href='#vstrat'><p>Estimated Variance of Stratified Abundance Estimator</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two Event Mark-Recapture Experiment</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-09-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools are provided for estimating, testing, and simulating
    abundance in a two-event (Petersen) mark-recapture experiment. Functions are
    given to calculate the Petersen, Chapman, and Bailey estimators and associated
    variances. However, the principal utility is a set of functions to simulate
    random draws from these estimators, and use these to conduct hypothesis
    tests and power calculations. Additionally, a set of functions are provided
    for generating confidence intervals via bootstrapping. Functions are also
    provided to test abundance estimator consistency under complete or partial
    stratification, and to calculate stratified or partially stratified estimators.
    Functions are also provided to calculate recommended sample sizes.
    Referenced methods can be found in Arnason et al. (1996) &lt;ISSN:0706-6457&gt;, 
    Bailey (1951) &lt;<a href="https://doi.org/10.2307%2F2332575">doi:10.2307/2332575</a>&gt;, 
    Bailey (1952) &lt;<a href="https://doi.org/10.2307%2F1913">doi:10.2307/1913</a>&gt;, 
    Chapman (1951) NAID:20001644490, 
    Cohen (1988) ISBN:0-12-179060-6, 
    Darroch (1961) &lt;<a href="https://doi.org/10.2307%2F2332748">doi:10.2307/2332748</a>&gt;, and
    Robson and Regier (1964) &lt;ISSN:1548-8659&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-07 21:46:27 UTC; mbtyers</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Tyers [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Tyers &lt;matttyersstat@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-08 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='ciBailey'>Confidence Intervals for the Bailey Estimator</h2><span id='topic+ciBailey'></span>

<h3>Description</h3>

<p>Calculates approximate confidence intervals(s) for the Bailey
estimator, using bootstrapping, the Normal approximation, or both.
</p>
<p>The bootstrap interval is created by resampling the data in the second
sampling event, with replacement; that is, drawing bootstrap values of m2
from a binomial distribution with probability parameter m2/n2.  This
technique has been shown to better approximate the distribution of the
abundance estimator.  Resulting CI endpoints both have larger values than
those calculated from a normal distribution, but this better captures the
positive skew of the estimator.  Coverage has been investigated by means of
simulation under numerous scenarios and has consistently outperformed the
normal interval.  The user is welcomed to investigate the coverage under
relevant scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciBailey(n1, n2, m2, conf = 0.95, method = "both", bootreps = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="ciBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="ciBailey_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample</p>
</td></tr>
<tr><td><code id="ciBailey_+3A_conf">conf</code></td>
<td>
<p>The confidence level of the desired intervals.  Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="ciBailey_+3A_method">method</code></td>
<td>
<p>Which method of confidence interval to return.  Allowed values
are <code>"norm"</code>, <code>"boot"</code>, or <code>"both"</code>.  Defaults to
<code>"both"</code>.</p>
</td></tr>
<tr><td><code id="ciBailey_+3A_bootreps">bootreps</code></td>
<td>
<p>Number of bootstrap replicates to use.  Defaults to 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the abundance estimate and confidence interval bounds for
the normal-distribution and/or bootstrap confidence intervals.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+seBailey">seBailey</a>,
<a href="#topic+rBailey">rBailey</a>, <a href="#topic+pBailey">pBailey</a>, <a href="#topic+powBailey">powBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ciBailey(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='ciChapman'>Confidence Intervals for the Chapman Estimator</h2><span id='topic+ciChapman'></span>

<h3>Description</h3>

<p>Calculates approximate confidence intervals(s) for the Chapman
estimator, using bootstrapping, the Normal approximation, or both.
</p>
<p>The bootstrap interval is created by resampling the data in the second
sampling event, with replacement; that is, drawing bootstrap values of m2
from a binomial distribution with probability parameter m2/n2.  This
technique has been shown to better approximate the distribution of the
abundance estimator.  Resulting CI endpoints both have larger values than
those calculated from a normal distribution, but this better captures the
positive skew of the estimator.  Coverage has been investigated by means of
simulation under numerous scenarios and has consistently outperformed the
normal interval.  The user is welcomed to investigate the coverage under
relevant scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciChapman(n1, n2, m2, conf = 0.95, method = "both", bootreps = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="ciChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="ciChapman_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample</p>
</td></tr>
<tr><td><code id="ciChapman_+3A_conf">conf</code></td>
<td>
<p>The confidence level of the desired intervals.  Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="ciChapman_+3A_method">method</code></td>
<td>
<p>Which method of confidence interval to return.  Allowed values
are <code>"norm"</code>, <code>"boot"</code>, or <code>"both"</code>.  Defaults to
<code>"both"</code>.</p>
</td></tr>
<tr><td><code id="ciChapman_+3A_bootreps">bootreps</code></td>
<td>
<p>Number of bootstrap replicates to use.  Defaults to 10000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the abundance estimate and confidence interval bounds for
the normal-distribution and/or bootstrap confidence intervals.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+seChapman">seChapman</a>,
<a href="#topic+rChapman">rChapman</a>, <a href="#topic+pChapman">pChapman</a>, <a href="#topic+powChapman">powChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ciChapman(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='ciPetersen'>Confidence Intervals for the Petersen Estimator</h2><span id='topic+ciPetersen'></span>

<h3>Description</h3>

<p>Calculates approximate confidence intervals(s) for the Petersen
estimator, using bootstrapping, the Normal approximation, or both.
</p>
<p>The bootstrap interval is created by resampling the data in the second
sampling event, with replacement; that is, drawing bootstrap values of m2
from a binomial distribution with probability parameter m2/n2.  This
technique has been shown to better approximate the distribution of the
abundance estimator.  Resulting CI endpoints both have larger values than
those calculated from a normal distribution, but this better captures the
positive skew of the estimator.  Coverage has been investigated by means of
simulation under numerous scenarios and has consistently outperformed the
normal interval.  The user is welcomed to investigate the coverage under
relevant scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciPetersen(
  n1,
  n2,
  m2,
  conf = 0.95,
  method = "both",
  bootreps = 10000,
  useChapvar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_conf">conf</code></td>
<td>
<p>The confidence level of the desired intervals.  Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_method">method</code></td>
<td>
<p>Which method of confidence interval to return.  Allowed values
are <code>"norm"</code>, <code>"boot"</code>, or <code>"both"</code>.  Defaults to
<code>"both"</code>.</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_bootreps">bootreps</code></td>
<td>
<p>Number of bootstrap replicates to use.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="ciPetersen_+3A_usechapvar">useChapvar</code></td>
<td>
<p>Whether to use the Chapman estimator variance instead of
the Petersen estimator variance for the normal-distribution interval.
Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the abundance estimate and confidence interval bounds for
the normal-distribution and/or bootstrap confidence intervals.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>,
<a href="#topic+rPetersen">rPetersen</a>, <a href="#topic+pPetersen">pPetersen</a>, <a href="#topic+powPetersen">powPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ciPetersen(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='cistrat'>Confidence Intervals for the Stratified Estimator</h2><span id='topic+cistrat'></span>

<h3>Description</h3>

<p>Calculates approximate confidence intervals(s) for the
Stratified estimator, using bootstrapping, the Normal approximation, or
both.
</p>
<p>The bootstrap interval is created by resampling the data in the second
sampling event, with replacement for each stratum; that is, drawing
bootstrap values of m2 from a binomial distribution with probability
parameter m2/n2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cistrat(
  n1,
  n2,
  m2,
  conf = 0.95,
  method = "both",
  bootreps = 10000,
  estimator = "Chapman",
  useChapvar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cistrat_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="cistrat_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="cistrat_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample</p>
</td></tr>
<tr><td><code id="cistrat_+3A_conf">conf</code></td>
<td>
<p>The confidence level of the desired intervals.  Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="cistrat_+3A_method">method</code></td>
<td>
<p>Which method of confidence interval to return.  Allowed values
are <code>"norm"</code>, <code>"boot"</code>, or <code>"both"</code>.  Defaults to
<code>"both"</code>.</p>
</td></tr>
<tr><td><code id="cistrat_+3A_bootreps">bootreps</code></td>
<td>
<p>Number of bootstrap replicates to use.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="cistrat_+3A_estimator">estimator</code></td>
<td>
<p>The type of estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>.  Default to
<code>"Chapman"</code>.</p>
</td></tr>
<tr><td><code id="cistrat_+3A_usechapvar">useChapvar</code></td>
<td>
<p>Whether to use the Chapman estimator variance instead of
the Petersen estimator variance for the normal-distribution interval, if
<code>"method"</code> is set to  <code>"Petersen"</code>. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the abundance estimate and confidence interval bounds for
the normal-distribution and/or bootstrap confidence intervals.
</p>


<h3>Note</h3>

<p>Both the bootstrap and the normal approximation intervals make the
naive assumption of independence between strata, which may not be the case.
The user therefore cautioned, and is encouraged to investigate the coverage
under relevant scenarios.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p>\linkstrattest, <a href="#topic+Nstrat">Nstrat</a>, <a href="#topic+rstrat">rstrat</a>,  <a href="#topic+vstrat">vstrat</a>, <a href="#topic+sestrat">sestrat</a>,
<a href="#topic+NChapman">NChapman</a>, <a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cistrat(n1=c(100,200), n2=c(100,500), m2=c(10,10))
</code></pre>

<hr>
<h2 id='consistencytest'>Consistency Tests for the Abundance Estimator, Partial Stratification</h2><span id='topic+consistencytest'></span>

<h3>Description</h3>

<p>Conducts three chi-squared tests for the consistency of the
Petersen-type abundance estimator.  These tests explore evidence
against the second traditional assumption of the Petersen mark-recapture
experiment: that equal capture probabilities exist in either the first or
second sampling event, or that complete mixing occurs between events.
</p>
<p>Typically, if any of these test p-values is greater than the significance
level, use of a Petersen-type estimator is considered justified.  If all
three tests give p-values below the significance level and no movement
occurs between strata (and strata are the same between events), a
stratified estimator may be used. If all three tests give p-values below
the significance level and some movement between strata occurs, a partially
stratified (Darroch-type) estimator must be used, such as <a href="#topic+NDarroch">NDarroch</a>.
</p>
<p>This function assumes stratification in both sampling events, and in
different ways (by time, area, etc.)  If stratification was the same in
both events such that individuals could not move from one strata to another
(such as by size or gender), use of <a href="#topic+strattest">strattest</a> is recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>consistencytest(
  n1,
  n2,
  m2strata1 = NULL,
  m2strata2 = NULL,
  stratamat = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="consistencytest_+3A_n1">n1</code></td>
<td>
<p>A vector of the total sample sizes in the first event, by
strata.  For example, setting <code>n1=c(20,30,40)</code> would imply 20
individuals captured and marked in stratum 1, 30 in stratum 2, and 40 in
stratum 3.</p>
</td></tr>
<tr><td><code id="consistencytest_+3A_n2">n2</code></td>
<td>
<p>A vector of the total sample sizes in the second event, by
strata.</p>
</td></tr>
<tr><td><code id="consistencytest_+3A_m2strata1">m2strata1</code></td>
<td>
<p>A vector of the first-event stratum membership of each
recaptured individual.  Only values <code>1, 2, 3, ...</code> are allowed.  May
be used together with <code>m2strata2</code> instead of <code>stratamat</code>.</p>
</td></tr>
<tr><td><code id="consistencytest_+3A_m2strata2">m2strata2</code></td>
<td>
<p>A vector of the second-event stratum membership of each
recaptured individual.  Only values <code>1, 2, 3, ...</code> are allowed.  May
be used together with <code>m2strata1</code> instead of <code>stratamat</code>.</p>
</td></tr>
<tr><td><code id="consistencytest_+3A_stratamat">stratamat</code></td>
<td>
<p>A matrix specifying the number of recaptures in each
combination of event 1 and event 2 strata, with rows corresponding to event
1 strata and columns corresponding to event 2 strata.  May be used instead
of <code>m2strata1</code> and <code>m2strata2</code>.</p>
</td></tr>
<tr><td><code id="consistencytest_+3A_...">...</code></td>
<td>
<p>Additional arguments for <a href="stats.html#topic+chisq.test">chisq.test</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>"recapr_consistencytest"</code> with the following components:
</p>

<ul>
<li><p><code>test1_tab</code> The contingency table used for the first test
</p>
</li>
<li><p><code>test1_Xsqd</code> The chi-squared test statistic in the first test
</p>
</li>
<li><p><code>test1_df</code> The associated degrees of freedom in the first test
</p>
</li>
<li><p><code>test1_pval</code> The p-value returned from the first test
</p>
</li>
<li><p><code>test2_tab</code> The contingency table used for the second test
</p>
</li>
<li><p><code>test2_Xsqd</code> The chi-squared test statistic in the second test
</p>
</li>
<li><p><code>test2_df</code> The associated degrees of freedom in the second test
</p>
</li>
<li><p><code>test2_pval</code> The p-value returned from the second test
</p>
</li>
<li><p><code>test3_tab</code> The contingency table used for the third test
</p>
</li>
<li><p><code>test3_Xsqd</code> The chi-squared test statistic in the third test
</p>
</li>
<li><p><code>test3_df</code> The associated degrees of freedom in the third test
</p>
</li>
<li><p><code>test3_pval</code> The p-value returned from the third test
</p>
</li></ul>



<h3>Note</h3>

<p>Naming conventions for the second and third tests are taken from SPAS (see reference)
</p>
<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Stratified Population Analysis System (Arnason, A.N., C.W. Kirby, C.J. Schwarz
and J.R. Irvine. 1996. Computer Analysis of Data from Stratified Mark-Recovery Experiments
for Estimation of Salmon Escapements and Other Populations, Canadian Technical Report of
Fisheries and Aquatic Sciences 2106).
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+NDarroch">NDarroch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>consistencytest(n1=c(15,12,6), n2=c(12,9,10,8),
   m2strata1=c(1,1,1,1,1,2,2,2,3,3),
   m2strata2=c(1,1,3,3,4,1,2,4,1,3),
   simulate.p.value=TRUE)

mat &lt;- matrix(c(30,15,1,0,22,15), nrow=2, ncol=3, byrow=TRUE)
consistencytest(n1=c(284,199), n2=c(347,3616,1489), stratamat=mat)
</code></pre>

<hr>
<h2 id='n2RR'>Mark-Recapture Sample Size, Robson-Regier</h2><span id='topic+n2RR'></span>

<h3>Description</h3>

<p>Calculates minimum sample size for one sampling event in a
Petersen mark-recapture experiment, given the sample size in the other
event and an best guess at true abundance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n2RR(
  N,
  n1,
  conf = c(0.99, 0.95, 0.9, 0.85, 0.8, 0.75),
  acc = c(0.5, 0.25, 0.2, 0.15, 0.1, 0.05, 0.01)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="n2RR_+3A_n">N</code></td>
<td>
<p>The best guess at true abundance</p>
</td></tr>
<tr><td><code id="n2RR_+3A_n1">n1</code></td>
<td>
<p>The size of the first (or second) sampling event</p>
</td></tr>
<tr><td><code id="n2RR_+3A_conf">conf</code></td>
<td>
<p>A vector of the desired levels of confidence to investigate.
Allowed values are any of <code>c(0.99,0.95,0.9,0.85,0.8,0.75)</code>.  Defaults to
all of <code>c(0.99,0.95,0.85,0.8,0.75)</code>.</p>
</td></tr>
<tr><td><code id="n2RR_+3A_acc">acc</code></td>
<td>
<p>A vector of the desired levels of relative accuracy to
investigate.  Allowed values are any of
<code>c(0.5,0.25,0.2,0.15,0.1,0.05,0.01)</code>.  Defaults to all of
<code>c(0.5,0.25,0.2,0.15,0.1,0.05,0.01)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of minimum sample sizes.  Each list element corresponds to a
unique level of confidence, and is defined as a data frame with each row
corresponding to a unique value of relative accuracy.  Two minimum sample
sizes are given: one calculated from the sample size provided for the other
event, and the other calculated under n1=n2, the most efficient scenario.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>

<p>It is possible that the sample size - accuracy relationship will be better illustrated using <a href="#topic+plotn2sim">plotn2sim</a>.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Robson, D. S., and H. A. Regier.  1964.  Sample size in Petersen
mark-recapture experiments.  Transactions of the American FisheriesSociety
93:215-226.
</p>


<h3>See Also</h3>

<p><a href="#topic+plotn2sim">plotn2sim</a>, <a href="#topic+plotn1n2simmatrix">plotn1n2simmatrix</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n2RR(N=1000, n1=100)
</code></pre>

<hr>
<h2 id='NBailey'>Bailey Estimator</h2><span id='topic+NBailey'></span>

<h3>Description</h3>

<p>Calculates the value of the Bailey estimator for abundance in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.  The Bailey estimator assumes a binomial probability model in
the second sampling event (i.e. sampling with replacement), rather than the
hypergeometric model assumed by the Petersen and Chapman estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NBailey(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="NBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="NBailey_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the Bailey estimator, calculated as n1*(n2+1)/(m2+1)
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Bailey, N.T.J. (1951). On estimating the size of mobile populations from capture-recapture data.  <em>Biometrika</em> <strong>38</strong>, 293-306.
</p>
<p>Bailey, N.T.J. (1952). Improvements in the interpretation of recapture data.  <em>J. Animal Ecol.</em> <strong>21</strong>, 120-7.
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NChapman">NChapman</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+seBailey">seBailey</a>, <a href="#topic+rBailey">rBailey</a>, <a href="#topic+pBailey">pBailey</a>,
<a href="#topic+powBailey">powBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NBailey(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='NChapman'>Chapman Estimator</h2><span id='topic+NChapman'></span>

<h3>Description</h3>

<p>Calculates the value of the Chapman estimator for abundance in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.  The Chapman estimator (Chapman modification of the Petersen
estimator) typically outperforms the Petersen estimator, even though the
Peterson estimator is the MLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NChapman(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample.
This may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="NChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="NChapman_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the Chapman estimator, calculated as (n1+1)*(n2+1)/(m2+1) - 1
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Chapman, D.G. (1951). Some properties of the hypergeometric distribution with applications to zoological censuses.  <em>Univ. Calif. Public. Stat.</em> <strong>1</strong>, 131-60.
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+seChapman">seChapman</a>, <a href="#topic+rChapman">rChapman</a>, <a href="#topic+pChapman">pChapman</a>,
<a href="#topic+powChapman">powChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NChapman(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='NDarroch'>Spatially or Temporally Stratified Abundance Est (Darroch)</h2><span id='topic+NDarroch'></span>

<h3>Description</h3>

<p>Computes abundance estimates and associated variance in the event of spatial or temporal stratification, or in any stratification in which individuals can move between strata.  Marking (event 1) and recapture (event 2) strata do not need to be the same.
</p>
<p>Inputs are vectors of total event 1 and 2 sample sizes, and either vectors of event 1 and 2 strata corresponding to each recaptured individual, or a matrix of total number of recaptures for each combination of event 1 and event 2 strata.
</p>
<p>Implementation is currently using Darroch's method, and will only accept non-singular input matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NDarroch(
  n1counts,
  n2counts,
  m2strata1 = NULL,
  m2strata2 = NULL,
  stratamat = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NDarroch_+3A_n1counts">n1counts</code></td>
<td>
<p>A vector of the total sample sizes in the first event, by
strata.  For example, setting <code>n1counts=c(20,30,40)</code> would imply 20
individuals captured and marked in stratum 1, 30 in stratum 2, and 40 in
stratum 3.</p>
</td></tr>
<tr><td><code id="NDarroch_+3A_n2counts">n2counts</code></td>
<td>
<p>A vector of the total sample sizes in the second event, by
strata.</p>
</td></tr>
<tr><td><code id="NDarroch_+3A_m2strata1">m2strata1</code></td>
<td>
<p>A vector of the first-event stratum membership of each
recaptured individual.  Only values <code>1, 2, 3, ...</code> are allowed.  May
be used together with <code>m2strata2</code> instead of <code>stratamat</code>.</p>
</td></tr>
<tr><td><code id="NDarroch_+3A_m2strata2">m2strata2</code></td>
<td>
<p>A vector of the second-event stratum membership of each
recaptured individual.  Only values <code>1, 2, 3, ...</code> are allowed.  May
be used together with <code>m2strata1</code> instead of <code>stratamat</code>.</p>
</td></tr>
<tr><td><code id="NDarroch_+3A_stratamat">stratamat</code></td>
<td>
<p>A matrix specifying the number of recaptures in each
combination of event 1 and event 2 strata, with rows corresponding to event
1 strata and columns corresponding to event 2 strata.  May be used instead
of <code>m2strata1</code> and <code>m2strata2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric list, giving the strata matrix if originally given in vector form, abundance estimates and standard errors by event 1 and event 2 strata, and the total abundance estimate and standard error.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Darroch, J.N. (1961). The two-sample capture-recapture census when tagging and sampling are stratified.  <em>Biometrika</em> <strong>48</strong>, 241-60.
</p>


<h3>See Also</h3>

<p><a href="#topic+consistencytest">consistencytest</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat &lt;- matrix(c(59,30,1,45,280,38,0,42,25), nrow=3, ncol=3, byrow=TRUE)

NDarroch(n1counts=c(484,1468,399), n2counts=c(847,6616,2489), stratamat=mat)
</code></pre>

<hr>
<h2 id='NPetersen'>Petersen Estimator</h2><span id='topic+NPetersen'></span>

<h3>Description</h3>

<p>Calculates the value of the Petersen estimator for abundance in
a mark-recapture experiment, with given values of sample sizes and number
of recaptures.  The Petersen estimator is the MLE, but is typically
outperformed by the Chapman estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPetersen(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample.
This may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="NPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="NPetersen_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the Petersen estimator, calculated as n1*n2/m2
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+NBailey">NBailey</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>, <a href="#topic+rPetersen">rPetersen</a>, <a href="#topic+pPetersen">pPetersen</a>,
<a href="#topic+powPetersen">powPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>NPetersen(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='Nstrat'>Stratified Abundance Estimator</h2><span id='topic+Nstrat'></span>

<h3>Description</h3>

<p>Calculates the value of the stratified estimator for abundance
in a mark-recapture experiment, from vectors of sample sizes and number of
recaptures, with each element corresponding to each sampling stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Nstrat(n1, n2, m2, estimator = "Chapman")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Nstrat_+3A_n1">n1</code></td>
<td>
<p>Vector of individuals captured and marked in the first sample, from
each stratum</p>
</td></tr>
<tr><td><code id="Nstrat_+3A_n2">n2</code></td>
<td>
<p>Vector of individuals captured and marked in the second sample,
from each stratum</p>
</td></tr>
<tr><td><code id="Nstrat_+3A_m2">m2</code></td>
<td>
<p>Vector of marked individuals recaptured in the second sample, from
each stratum</p>
</td></tr>
<tr><td><code id="Nstrat_+3A_estimator">estimator</code></td>
<td>
<p>The type of estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>.  Default to
<code>"Chapman"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value of the stratified estimator
</p>


<h3>Note</h3>

<p>It is possible that even the stratified estimate may be biased if
capture probabilities differ greatly between strata.  However, the bias in
the stratified estimator will be much less than an estimator calculated
without stratification.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+rstrat">rstrat</a>, <a href="#topic+vstrat">vstrat</a>,  <a href="#topic+sestrat">sestrat</a>, <a href="#topic+cistrat">cistrat</a>,
<a href="#topic+NChapman">NChapman</a>, <a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Nstrat(n1=c(100,200), n2=c(100,500), m2=c(10,10))
</code></pre>

<hr>
<h2 id='pBailey'>Hypothesis Testing Using the Bailey Estimator</h2><span id='topic+pBailey'></span>

<h3>Description</h3>

<p>Approximates a p-value for a hypothesis test of the Bailey
estimator by means of many simulated draws from the null distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pBailey(
  estN = NULL,
  nullN,
  n1,
  n2,
  m2 = NULL,
  nsim = 1e+05,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pBailey_+3A_estn">estN</code></td>
<td>
<p>The estimated abundance.  Either this or the number of recaptures
(<code>m2</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pBailey_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="pBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="pBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="pBailey_+3A_m2">m2</code></td>
<td>
<p>Number of recaptures.  Either this or the estimated abundance
(<code>estN</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pBailey_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 100000.</p>
</td></tr>
<tr><td><code id="pBailey_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An approximate p-value for the specified hypothesis test.  If
<code>m2</code> is specified rather than <code>estN</code>, output will be returned as
a list with two elements: the estimated abundance and p-value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+seBailey">seBailey</a>, <a href="#topic+rBailey">rBailey</a>,
<a href="#topic+powBailey">powBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>output &lt;- pBailey(nullN=500, n1=100, n2=100, m2=28)
output

plotdiscdensity(rBailey(length=100000, N=500, n1=100, n2=100))
abline(v=output$estN, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)


output &lt;- pBailey(nullN=500, n1=100, n2=100, m2=28, alternative="2-sided")
output

plotdiscdensity(rBailey(length=100000, N=500, n1=100, n2=100))
twosided &lt;- 500 + c(-1,1)*abs(500-output$estN)
abline(v=twosided, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)
</code></pre>

<hr>
<h2 id='pChapman'>Hypothesis Testing Using the Chapman Estimator</h2><span id='topic+pChapman'></span>

<h3>Description</h3>

<p>Approximates a p-value for a hypothesis test of the Chapman
estimator by means of many simulated draws from the null distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pChapman(
  estN = NULL,
  nullN,
  n1,
  n2,
  m2 = NULL,
  nsim = 1e+05,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pChapman_+3A_estn">estN</code></td>
<td>
<p>The estimated abundance.  Either this or the number of recaptures
(<code>m2</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pChapman_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="pChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="pChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="pChapman_+3A_m2">m2</code></td>
<td>
<p>Number of recaptures.  Either this or the estimated abundance
(<code>estN</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pChapman_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 100000.</p>
</td></tr>
<tr><td><code id="pChapman_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An approximate p-value for the specified hypothesis test.  If
<code>m2</code> is specified rather than <code>estN</code>, output will be returned as
a list with two elements: the estimated abundance and p-value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+seChapman">seChapman</a>, <a href="#topic+rChapman">rChapman</a>,
<a href="#topic+powChapman">powChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>output &lt;- pChapman(nullN=500, n1=100, n2=100, m2=28)
output

plotdiscdensity(rChapman(length=100000, N=500, n1=100, n2=100))
abline(v=output$estN, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)


output &lt;- pChapman(nullN=500, n1=100, n2=100, m2=28, alternative="2-sided")
output

plotdiscdensity(rChapman(length=100000, N=500, n1=100, n2=100))
twosided &lt;- 500 + c(-1,1)*abs(500-output$estN)
abline(v=twosided, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)
</code></pre>

<hr>
<h2 id='plotdiscdensity'>Plotting the Density of a Vector of Discrete Values</h2><span id='topic+plotdiscdensity'></span>

<h3>Description</h3>

<p>Plots the empirical density of a vector of discrete values, approximating the probability mass function (pmf).  This can be considered a more appropriate alternative to <code>plot(density(x))</code> in the case of a vector with a discrete (non-continuous) support, such as that calculated by an abundance estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotdiscdensity(x, xlab = "value", ylab = "density", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotdiscdensity_+3A_x">x</code></td>
<td>
<p>The vector of values to plot</p>
</td></tr>
<tr><td><code id="plotdiscdensity_+3A_xlab">xlab</code></td>
<td>
<p>The X-axis label for plotting</p>
</td></tr>
<tr><td><code id="plotdiscdensity_+3A_ylab">ylab</code></td>
<td>
<p>The Y-axis label for plotting</p>
</td></tr>
<tr><td><code id="plotdiscdensity_+3A_...">...</code></td>
<td>
<p>Additional plotting arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- rChapman(length=100000, N=500, n1=100, n2=100)
plotdiscdensity(draws)  #plots the density of a vector of discrete values
</code></pre>

<hr>
<h2 id='plotn1n2simmatrix'>Mark-Recapture Sample Size Via Sim, Both Samples</h2><span id='topic+plotn1n2simmatrix'></span>

<h3>Description</h3>

<p>Produces a plot of the simulated relative accuracy of a
mark-recapture abundance estimator for various sample sizes in both events.  This may be a
useful exploration, but it is possible that <a href="#topic+plotn2sim">plotn2sim</a> may be more informative.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotn1n2simmatrix(
  N,
  conf = 0.95,
  nrange = NULL,
  nstep = NULL,
  estimator = "Chapman",
  nsim = 10000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotn1n2simmatrix_+3A_n">N</code></td>
<td>
<p>The best guess at true abundance</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_conf">conf</code></td>
<td>
<p>The desired level of confidence to investigate.
Defaults to 0.95.</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_nrange">nrange</code></td>
<td>
<p>A two-element vector describing the range of sample sizes to
investigate.  If the default (<code>NULL</code>) is accepted, an appropriate
value will be chosen.</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_nstep">nstep</code></td>
<td>
<p>The step size between sample sizes to investigate.  If the
default (<code>NULL</code>) is accepted, an appropriate value will be chosen.</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_estimator">estimator</code></td>
<td>
<p>The abundance estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>. Defaults to
<code>"Chapman"</code>.</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_nsim">nsim</code></td>
<td>
<p>The number of replicates.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="plotn1n2simmatrix_+3A_...">...</code></td>
<td>
<p>Additional plotting parameters</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+n2RR">n2RR</a>, <a href="#topic+plotn2sim">plotn2sim</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotn1n2simmatrix(N=10000, nsim=2000)
</code></pre>

<hr>
<h2 id='plotn2sim'>Mark-Recapture Sample Size Via Simulation</h2><span id='topic+plotn2sim'></span>

<h3>Description</h3>

<p>Produces a plot of the simulated relative accuracy of a
mark-recapture abundance estimator for various sample sizes.  This may be a
better representation of the sample size - accuracy relationship than that
provided by <a href="#topic+n2RR">n2RR</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotn2sim(
  N,
  n1,
  conf = c(0.99, 0.95, 0.85, 0.8, 0.75),
  n2range = NULL,
  n2step = NULL,
  estimator = "Chapman",
  nsim = 10000,
  accrange = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotn2sim_+3A_n">N</code></td>
<td>
<p>The best guess at true abundance</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_n1">n1</code></td>
<td>
<p>The size of the first (or second) sampling event</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_conf">conf</code></td>
<td>
<p>A vector of the desired levels of confidence to investigate.
Allowed values are any of <code>c(0.99,0.95,0.85,0.8,0.75)</code>.  Defaults to
all of <code>c(0.99,0.95,0.85,0.8,0.75)</code>.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_n2range">n2range</code></td>
<td>
<p>A two-element vector describing the range of sample sizes to
investigate.  If the default (<code>NULL</code>) is accepted, an appropriate
value will be chosen.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_n2step">n2step</code></td>
<td>
<p>The step size between sample sizes to investigate.  If the
default (<code>NULL</code>) is accepted, an appropriate value will be chosen.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_estimator">estimator</code></td>
<td>
<p>The abundance estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>. Defaults to
<code>"Chapman"</code>.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_nsim">nsim</code></td>
<td>
<p>The number of replicates.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_accrange">accrange</code></td>
<td>
<p>The maximum level of relative accuracy for plotting.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="plotn2sim_+3A_...">...</code></td>
<td>
<p>Additional plotting parameters</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+n2RR">n2RR</a>, <a href="#topic+plotn1n2simmatrix">plotn1n2simmatrix</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plotn2sim(N=1000, n1=100)
</code></pre>

<hr>
<h2 id='powBailey'>Power for Hypothesis Testing Using the Bailey Estimator</h2><span id='topic+powBailey'></span>

<h3>Description</h3>

<p>Approximates the power of a hypothesis test of the Bailey
estimator by means of many simulated draws from a specified alternative distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powBailey(
  nullN,
  trueN,
  n1,
  n2,
  alpha = 0.05,
  nsim = 10000,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powBailey_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="powBailey_+3A_truen">trueN</code></td>
<td>
<p>The assumed abundance for the power calculation</p>
</td></tr>
<tr><td><code id="powBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="powBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="powBailey_+3A_alpha">alpha</code></td>
<td>
<p>The alpha level for the test</p>
</td></tr>
<tr><td><code id="powBailey_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="powBailey_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The approximate power of the specified hypothesis test, for the specified alternative value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+seBailey">seBailey</a>, <a href="#topic+rBailey">rBailey</a>,
<a href="#topic+pBailey">pBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powBailey(nullN=500, trueN=400, n1=100, n2=100, nsim=1000)

Ntotry &lt;- seq(from=250, to=450, by=25)
pows &lt;- sapply(Ntotry, function(x)
  powBailey(nullN=500, trueN=x, n1=100, n2=100, nsim=1000))
plot(Ntotry, pows)
</code></pre>

<hr>
<h2 id='powChapman'>Power for Hypothesis Testing Using the Chapman Estimator</h2><span id='topic+powChapman'></span>

<h3>Description</h3>

<p>Approximates the power of a hypothesis test of the Chapman
estimator by means of many simulated draws from a specified alternative distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powChapman(
  nullN,
  trueN,
  n1,
  n2,
  alpha = 0.05,
  nsim = 10000,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powChapman_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="powChapman_+3A_truen">trueN</code></td>
<td>
<p>The assumed abundance for the power calculation</p>
</td></tr>
<tr><td><code id="powChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="powChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="powChapman_+3A_alpha">alpha</code></td>
<td>
<p>The alpha level for the test</p>
</td></tr>
<tr><td><code id="powChapman_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="powChapman_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The approximate power of the specified hypothesis test, for the specified alternative value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+seChapman">seChapman</a>, <a href="#topic+rChapman">rChapman</a>,
<a href="#topic+pChapman">pChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powChapman(nullN=500, trueN=400, n1=100, n2=100, nsim=1000)

Ntotry &lt;- seq(from=250, to=450, by=25)
pows &lt;- sapply(Ntotry, function(x)
  powChapman(nullN=500, trueN=x, n1=100, n2=100, nsim=1000))
plot(Ntotry, pows)
</code></pre>

<hr>
<h2 id='powconsistencytest'>Power of Consistency Tests, Partial Stratification</h2><span id='topic+powconsistencytest'></span>

<h3>Description</h3>

<p>Conducts power calculations of the chi-squared tests for the
consistency of the Petersen-type abundance estimator, in a partial
stratification setting, such as by time or geographic area.  In the case of
partial stratification, individuals may move from one stratum to another
between the first and second sampling events, and strata do not need to be
the same between events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powconsistencytest(n1, n2, pmat, alpha = 0.05, sim = TRUE, nsim = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powconsistencytest_+3A_n1">n1</code></td>
<td>
<p>Vector of anticipated n1 counts (sample size in the first event),
each element corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="powconsistencytest_+3A_n2">n2</code></td>
<td>
<p>Vector of anticipated n2 counts (sample size in the second event),
each element corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="powconsistencytest_+3A_pmat">pmat</code></td>
<td>
<p>Matrix of assumed movement probabilities between strata, with
rows corresponding to first-event strata and columns corresponding to
second-event strata, and an additional column corresponding to the
probability of NOT being recaptured in the second event.  Values will be
standardized by row, that is, by first-event strata.  See note on usage
below.</p>
</td></tr>
<tr><td><code id="powconsistencytest_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for testing.  Defaults to <code>0.05</code></p>
</td></tr>
<tr><td><code id="powconsistencytest_+3A_sim">sim</code></td>
<td>
<p>Whether to conduct power calculation by simulation as well as
Cohen's method.  Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="powconsistencytest_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations if <code>sim</code> is <code>TRUE</code>.  Defaults to
<code>10000</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>"recapr_consistencypow"</code> with the following
components: </p>
 <ul>
<li><p><code>pwr1_c</code> Power of the first test,
according to Cohen's method </p>
</li>
<li><p><code>pwr1_sim</code> Power of the first
test, from simulation </p>
</li>
<li><p><code>ntest1</code> The sample size used for the
first test </p>
</li>
<li><p><code>p0test1</code> The null-hypothesis probabilities for
the first test </p>
</li>
<li><p><code>p1test1</code> The alt-hypothesis probabilities for
the first test </p>
</li>
<li><p><code>pwr2_c</code> Power of the second test, according
to Cohen's method </p>
</li>
<li><p><code>pwr2_sim</code> Power of the second test, from
simulation </p>
</li>
<li><p><code>ntest2</code> The sample size used for the second test
</p>
</li>
<li><p><code>p0test2</code> The null-hypothesis probabilities for the second
test </p>
</li>
<li><p><code>p1test2</code> The alt-hypothesis probabilities for the
second test </p>
</li>
<li><p><code>pwr3_c</code> Power of the third test, according to
Cohen's method </p>
</li>
<li><p><code>pwr3_sim</code> Power of the third test, from
simulation </p>
</li>
<li><p><code>ntest3</code> The sample size used for the third test
</p>
</li>
<li><p><code>p0test3</code> The null-hypothesis probabilities for the third
test </p>
</li>
<li><p><code>p1test3</code> The alt-hypothesis probabilities for the third
test </p>
</li>
<li><p><code>alpha</code> The significance level used </p>
</li></ul>



<h3>Note</h3>

<p>The movement probability matrix specified in <code>pmat</code> is considered
conditional on each row, that is, first-event strata, with columns
corresponding to second-event strata and the final column specifying the
probability of not being recaptured in the second event.  Values do not
need to sum to one for each row, but will be standardized by the function
to sum to one.
</p>
<p>A <code>pmat</code> with a first row equal to <code>(0.05, 0.1, 0.15, 0.7)</code> would
imply a 5 percent chance that individuals captured in the first-event
strata 1 will be recaptured in second-event strata 1, and a 70 percent
chance that individuals captured in the first-event strata 1 will not be
recaptured in event 2.
</p>
<p>Because of the row-wise scaling, specifying a row equal to <code>(0.05,
  0.1, 0.15, 0.7)</code> would be equivalent to that row having values <code>(1, 2, 3, 14)</code>.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Cohen, J. (1988). Statistical power analysis for the behavioral
sciences (2nd ed.). Hillsdale,NJ: Lawrence Erlbaum.
</p>
<p>Code adapted from the 'pwr' package: Stephane Champely (2015). pwr: Basic
Functions for Power Analysis. R package version 1.1-3.
https://CRAN.R-project.org/package=pwr
</p>


<h3>See Also</h3>

<p><a href="#topic+consistencytest">consistencytest</a>, <a href="#topic+NDarroch">NDarroch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mat &lt;- matrix(c(4,3,2,1,10,3,4,3,2,10,2,3,4,3,10,1,2,3,4,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(4,3,2,1,10,4,3,2,1,10,4,3,2,1,10,4,3,2,1,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,10,2,2,2,2,10,3,3,3,3,10,4,4,4,4,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,10,1,1,1,1,10,1,1,1,1,10,1,1,1,1,10),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(20,30,40,50), pmat=mat)

mat &lt;- matrix(c(1,1,1,1,5,1,1,1,1,8,1,1,1,1,10,1,1,1,1,15),
    nrow=4, ncol=5, byrow=TRUE)
powconsistencytest(n1=c(50,50,50,50), n2=c(50,50,50,50), pmat=mat)
</code></pre>

<hr>
<h2 id='powPetersen'>Power for Hypothesis Testing Using the Petersen Estimator</h2><span id='topic+powPetersen'></span>

<h3>Description</h3>

<p>Approximates the power of a hypothesis test of the Petersen
estimator by means of many simulated draws from a specified alternative distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powPetersen(
  nullN,
  trueN,
  n1,
  n2,
  alpha = 0.05,
  nsim = 10000,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powPetersen_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_truen">trueN</code></td>
<td>
<p>The assumed abundance for the power calculation</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_alpha">alpha</code></td>
<td>
<p>The alpha level for the test</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 10000.</p>
</td></tr>
<tr><td><code id="powPetersen_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The approximate power of the specified hypothesis test, for the specified alternative value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>, <a href="#topic+rPetersen">rPetersen</a>,
<a href="#topic+pPetersen">pPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powPetersen(nullN=500, trueN=400, n1=100, n2=100, nsim=1000)

Ntotry &lt;- seq(from=250, to=450, by=25)
pows &lt;- sapply(Ntotry, function(x)
  powPetersen(nullN=500, trueN=x, n1=100, n2=100, nsim=1000))
plot(Ntotry, pows)
</code></pre>

<hr>
<h2 id='powstrattest'>Power of Consistency Tests, Complete Stratification</h2><span id='topic+powstrattest'></span>

<h3>Description</h3>

<p>Conducts power calculations of the chi-squared tests for the
consistency of the Petersen-type abundance estimator, in a complete
stratification setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>powstrattest(N, n1, n2, alpha = 0.05, sim = TRUE, nsim = 1e+05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="powstrattest_+3A_n">N</code></td>
<td>
<p>Vector of total abundance, with each element corresponding to one
stratum.</p>
</td></tr>
<tr><td><code id="powstrattest_+3A_n1">n1</code></td>
<td>
<p>Vector of anticipated n1 counts (sample size in the first event),
each element corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="powstrattest_+3A_n2">n2</code></td>
<td>
<p>Vector of anticipated n2 counts (sample size in the second event),
each element corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="powstrattest_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for testing.  Defaults to <code>0.05</code></p>
</td></tr>
<tr><td><code id="powstrattest_+3A_sim">sim</code></td>
<td>
<p>Whether to conduct power calculation by simulation as well as
Cohen's method.  Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="powstrattest_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulations if <code>sim</code> is <code>TRUE</code>.  Defaults to
<code>100000</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of three elements, each with class <code>"recapr_stratpow"</code>
with the following components: </p>
 <ul>
<li><p><code>prob</code> A vector of
capture probabilities corresponding to the alternative hypothesis
investigated </p>
</li>
<li><p><code>prob_null</code> A vector of capture probabilities
corresponding to the null hypothesis (all probabilities equal)
</p>
</li>
<li><p><code>n</code> The sample size used for the test </p>
</li>
<li><p><code>alpha</code> The significance level used for testing
</p>
</li>
<li><p><code>power</code> The test power, calculated by Cohen's method
</p>
</li>
<li><p><code>power_sim</code> The test power, calculated via simulation </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>References</h3>

<p>Cohen, J. (1988). Statistical power analysis for the behavioral sciences (2nd ed.). Hillsdale,NJ: Lawrence Erlbaum.
</p>
<p>Code adapted from the 'pwr' package:
Stephane Champely (2015). pwr: Basic Functions for Power Analysis. R
package version 1.1-3. https://CRAN.R-project.org/package=pwr
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+Nstrat">Nstrat</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>powstrattest(N=c(10000,20000), n1=c(1000,2000), n2=c(200,200))
</code></pre>

<hr>
<h2 id='pPetersen'>Hypothesis Testing Using the Petersen Estimator</h2><span id='topic+pPetersen'></span>

<h3>Description</h3>

<p>Approximates a p-value for a hypothesis test of the Petersen
estimator by means of many simulated draws from the null distribution, conditioned on sample sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pPetersen(
  estN = NULL,
  nullN,
  n1,
  n2,
  m2 = NULL,
  nsim = 1e+05,
  alternative = "less"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pPetersen_+3A_estn">estN</code></td>
<td>
<p>The estimated abundance.  Either this or the number of recaptures
(<code>m2</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_nulln">nullN</code></td>
<td>
<p>The abundance given by the null hypothesis</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_m2">m2</code></td>
<td>
<p>Number of recaptures.  Either this or the estimated abundance
(<code>estN</code>) must be specified.</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_nsim">nsim</code></td>
<td>
<p>Number of simulated values to draw.  Defaults to 100000.</p>
</td></tr>
<tr><td><code id="pPetersen_+3A_alternative">alternative</code></td>
<td>
<p>Direction of the alternative hypothesis.  Allowed values
are <code>"less"</code>, <code>"greater"</code>, or <code>"2-sided"</code>.  Defaults to <code>"less"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An approximate p-value for the specified hypothesis test.  If
<code>m2</code> is specified rather than <code>estN</code>, output will be returned as
a list with two elements: the estimated abundance and p-value.
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>, <a href="#topic+rPetersen">rPetersen</a>,
<a href="#topic+powPetersen">powPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>output &lt;- pPetersen(nullN=500, n1=100, n2=100, m2=28)
output

plotdiscdensity(rPetersen(length=100000, N=500, n1=100, n2=100))
abline(v=output$estN, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)


output &lt;- pPetersen(nullN=500, n1=100, n2=100, m2=28, alternative="2-sided")
output

plotdiscdensity(rPetersen(length=100000, N=500, n1=100, n2=100))
twosided &lt;- 500 + c(-1,1)*abs(500-output$estN)
abline(v=twosided, lwd=2, col=2)
abline(v=500, lwd=2, lty=2)
</code></pre>

<hr>
<h2 id='print.recapr_consistencypow'>Print method for consistency test power</h2><span id='topic+print.recapr_consistencypow'></span>

<h3>Description</h3>

<p>Print method for consistency test power
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'recapr_consistencypow'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.recapr_consistencypow_+3A_x">x</code></td>
<td>
<p>Output from <code>powconsistencytest()</code></p>
</td></tr>
<tr><td><code id="print.recapr_consistencypow_+3A_...">...</code></td>
<td>
<p>additional print arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>

<hr>
<h2 id='print.recapr_consistencytest'>Print method for consistency test</h2><span id='topic+print.recapr_consistencytest'></span>

<h3>Description</h3>

<p>Print method for consistency test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'recapr_consistencytest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.recapr_consistencytest_+3A_x">x</code></td>
<td>
<p>Output from <code>consistencytest()</code></p>
</td></tr>
<tr><td><code id="print.recapr_consistencytest_+3A_...">...</code></td>
<td>
<p>additional print arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>

<hr>
<h2 id='print.recapr_stratpow'>Print method for stratification test power</h2><span id='topic+print.recapr_stratpow'></span>

<h3>Description</h3>

<p>Print method for stratification test power
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'recapr_stratpow'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.recapr_stratpow_+3A_x">x</code></td>
<td>
<p>Output from <code>powstrattest()</code></p>
</td></tr>
<tr><td><code id="print.recapr_stratpow_+3A_...">...</code></td>
<td>
<p>additional print arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>

<hr>
<h2 id='print.recapr_strattest'>Print method for stratification test</h2><span id='topic+print.recapr_strattest'></span>

<h3>Description</h3>

<p>Print method for stratification test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'recapr_strattest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.recapr_strattest_+3A_x">x</code></td>
<td>
<p>Output from <code>strattest()</code></p>
</td></tr>
<tr><td><code id="print.recapr_strattest_+3A_...">...</code></td>
<td>
<p>additional print arguments</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>

<hr>
<h2 id='rBailey'>Random Draws from the Bailey Estimator</h2><span id='topic+rBailey'></span>

<h3>Description</h3>

<p>Returns a vector of random draws from the Bailey estimator in a
mark-recapture experiment, given values of the true abundance and the
sample size in both events.  The function first simulates a vector of
recaptures (m2) from a binomial distribution, and then uses these to
compute a vector of draws from the estimator.
</p>
<p>If capture probabilities (<code>p1</code> and/or <code>p2</code>) are specified instead of sample size(s), the sample size(s) will first be drawn from a binomial distribution, then the number of recaptures.  If both sample size and capture probability are specified for a given sampling event, only the sample size will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rBailey(length, N, n1 = NULL, n2 = NULL, p1 = NULL, p2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rBailey_+3A_length">length</code></td>
<td>
<p>The length of the random vector to return.</p>
</td></tr>
<tr><td><code id="rBailey_+3A_n">N</code></td>
<td>
<p>The value of the true abundance. This may be a single number or
vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rBailey_+3A_p1">p1</code></td>
<td>
<p>Alternately, probability of capture in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rBailey_+3A_p2">p2</code></td>
<td>
<p>Alternately, probability of capture in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of random draws from the Bailey estimator
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+seBailey">seBailey</a>, <a href="#topic+pBailey">pBailey</a>,
<a href="#topic+powBailey">powBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- rBailey(length=100000, N=500, n1=100, n2=100)
plotdiscdensity(draws)  #plots the density of a vector of discrete values
</code></pre>

<hr>
<h2 id='rChapman'>Random Draws from the Chapman Estimator</h2><span id='topic+rChapman'></span>

<h3>Description</h3>

<p>Returns a vector of random draws from the Chapman estimator in a
mark-recapture experiment, given values of the true abundance and the
sample size in both events.  The function first simulates a vector of
recaptures (m2) from a hypergeometric distribution, and then uses these to
compute a vector of draws from the estimator.
</p>
<p>If capture probabilities (<code>p1</code> and/or <code>p2</code>) are specified instead of sample size(s), the sample size(s) will first be drawn from a binomial distribution, then the number of recaptures.  If both sample size and capture probability are specified for a given sampling event, only the sample size will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rChapman(length, N, n1 = NULL, n2 = NULL, p1 = NULL, p2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rChapman_+3A_length">length</code></td>
<td>
<p>The length of the random vector to return.</p>
</td></tr>
<tr><td><code id="rChapman_+3A_n">N</code></td>
<td>
<p>The value of the true abundance. This may be a single number or
vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rChapman_+3A_p1">p1</code></td>
<td>
<p>Alternately, probability of capture in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rChapman_+3A_p2">p2</code></td>
<td>
<p>Alternately, probability of capture in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of random draws from the Chapman estimator
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+seChapman">seChapman</a>, <a href="#topic+pChapman">pChapman</a>,
<a href="#topic+powChapman">powChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- rChapman(length=100000, N=500, n1=100, n2=100)
plotdiscdensity(draws)  #plots the density of a vector of discrete values
</code></pre>

<hr>
<h2 id='recapr-package'>
Estimating, Testing, and Simulating Abundance in a Mark-Recapture Experiment
</h2><span id='topic+recapr-package'></span><span id='topic+recapr'></span>

<h3>Description</h3>

<p>Tools are provided for estimating, testing, and simulating abundance in a two-event (Petersen) mark-recapture experiment.  Functions are given to calculate the Petersen, Chapman, and Bailey estimators and associated variances.  However, the principal utility is a set of functions to simulate random draws from these estimators, and use these to conduct hypothesis tests and power calculations.  Additionally, a set of functions are provided for generating confidence intervals via bootstrapping.  Functions are also provided to test abundance estimator consistency under complete or partial stratification, and to calculate stratified or Darroch estimators.  Functions are also provided to calculate recommended sample sizes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> recapr</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.4.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-09-02</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>
<p>Maintainer: Matt Tyers &lt;matttyersstat@gmail.com&gt;
</p>

<hr>
<h2 id='rPetersen'>Random Draws from the Petersen Estimator</h2><span id='topic+rPetersen'></span>

<h3>Description</h3>

<p>Returns a vector of random draws from the Petersen estimator in a
mark-recapture experiment, given values of the true abundance and the
sample size in both events.  The function first simulates a vector of
recaptures (m2) from a hypergeometric distribution, and then uses these to
compute a vector of draws from the estimator.
</p>
<p>If capture probabilities (<code>p1</code> and/or <code>p2</code>) are specified instead of sample size(s), the sample size(s) will first be drawn from a binomial distribution, then the number of recaptures.  If both sample size and capture probability are specified for a given sampling event, only the sample size will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rPetersen(length, N, n1 = NULL, n2 = NULL, p1 = NULL, p2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rPetersen_+3A_length">length</code></td>
<td>
<p>The length of the random vector to return.</p>
</td></tr>
<tr><td><code id="rPetersen_+3A_n">N</code></td>
<td>
<p>The value of the true abundance. This may be a single number or
vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rPetersen_+3A_p1">p1</code></td>
<td>
<p>Alternately, probability of capture in the first sample. This
may be a single number or vector of values equal to <code>length</code>.</p>
</td></tr>
<tr><td><code id="rPetersen_+3A_p2">p2</code></td>
<td>
<p>Alternately, probability of capture in the second sample.  This may be a
single number or vector of values equal to <code>length</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of random draws from the Petersen estimator
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>, <a href="#topic+pPetersen">pPetersen</a>,
<a href="#topic+powPetersen">powPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- rPetersen(length=100000, N=500, n1=100, n2=100)
plotdiscdensity(draws)  #plots the density of a vector of discrete values
</code></pre>

<hr>
<h2 id='rstrat'>Random Draws from the Stratified Estimator</h2><span id='topic+rstrat'></span>

<h3>Description</h3>

<p>Returns a vector of random draws from the stratified estimator in a
mark-recapture experiment, given values of the true abundance and the
sample size in both events.  The function first simulates a vector of
recaptures (m2) for each stratum, and then uses these to
compute a vector of draws from the estimator.
</p>
<p>It may prove useful to investigate the behavior of the stratified estimator under relevant scenarios.
</p>
<p>If capture probabilities (<code>p1</code> and/or <code>p2</code>) are specified instead of sample size(s), the sample size(s) will first be drawn from a binomial distribution, then the number of recaptures.  If both sample size and capture probability are specified for a given sampling event, only the sample size will be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rstrat(
  length,
  N,
  n1 = NULL,
  n2 = NULL,
  p1 = NULL,
  p2 = NULL,
  estimator = "Chapman"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rstrat_+3A_length">length</code></td>
<td>
<p>The length of the random vector to return.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_n">N</code></td>
<td>
<p>A vector of values of the true abundance for each stratum.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_n1">n1</code></td>
<td>
<p>A vector of the number of individuals captured and marked in the first sample, for each stratum.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_n2">n2</code></td>
<td>
<p>A vector of the number of individuals captured in the second sample, for each stratum.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_p1">p1</code></td>
<td>
<p>Alternately, a vector of probabilities of capture for the first event, for each stratum.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_p2">p2</code></td>
<td>
<p>Alternately, a vector of probabilities of capture for the second event, for each stratum.</p>
</td></tr>
<tr><td><code id="rstrat_+3A_estimator">estimator</code></td>
<td>
<p>The type of estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>.  Default to
<code>"Chapman"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of random draws from the stratified estimator
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+Nstrat">Nstrat</a>,  <a href="#topic+vstrat">vstrat</a>, <a href="#topic+cistrat">cistrat</a>,<a href="#topic+NChapman">NChapman</a>, <a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>draws &lt;- rstrat(length=100000, N=c(5000,10000), n1=c(500,200), n2=c(500,200))
plotdiscdensity(draws)  #plots the density of a vector of discrete values
mean(draws)
</code></pre>

<hr>
<h2 id='seBailey'>Standard Error of the Bailey Estimator</h2><span id='topic+seBailey'></span>

<h3>Description</h3>

<p>Calculates the standard error of the Bailey estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seBailey(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="seBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="seBailey_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Bailey estimator, calculated as
sqrt((n1^2)*(n2+1)*(n2-m2)/(m2+1)/(m2+1)/(m2+2))
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+vBailey">vBailey</a>, <a href="#topic+rBailey">rBailey</a>, <a href="#topic+pBailey">pBailey</a>,
<a href="#topic+powBailey">powBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seBailey(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='seChapman'>Standard Error of the Chapman Estimator</h2><span id='topic+seChapman'></span>

<h3>Description</h3>

<p>Calculates the standard error of the Chapman estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seChapman(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="seChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="seChapman_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Chapman estimator, calculated as
sqrt((n1+1)*(n2+1)*(n1-m2)*(n2-m2)/((m2+2)*(m2+1)^2))
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+vChapman">vChapman</a>, <a href="#topic+rChapman">rChapman</a>, <a href="#topic+pChapman">pChapman</a>,
<a href="#topic+powChapman">powChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>seChapman(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='sePetersen'>Standard Error of the Petersen Estimator</h2><span id='topic+sePetersen'></span>

<h3>Description</h3>

<p>Calculates the standard error of the Petersen estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sePetersen(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sePetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="sePetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="sePetersen_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Petersen estimator, calculated as
sqrt((n1^2)*n2*(n2-m2)/(m2^3))
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+vPetersen">vPetersen</a>, <a href="#topic+rPetersen">rPetersen</a>, <a href="#topic+pPetersen">pPetersen</a>,
<a href="#topic+powPetersen">powPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sePetersen(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='sestrat'>Standard Error of Stratified Abundance Estimator</h2><span id='topic+sestrat'></span>

<h3>Description</h3>

<p>Calculates the standard error of the stratified estimator for
abundance in a mark-recapture experiment, from vectors of sample sizes and
number of recaptures, with each element corresponding to each sampling
stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sestrat(n1, n2, m2, estimator = "Chapman")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sestrat_+3A_n1">n1</code></td>
<td>
<p>Vector of individuals captured and marked in the first sample, from
each stratum</p>
</td></tr>
<tr><td><code id="sestrat_+3A_n2">n2</code></td>
<td>
<p>Vector of individuals captured and marked in the second sample,
from each stratum</p>
</td></tr>
<tr><td><code id="sestrat_+3A_m2">m2</code></td>
<td>
<p>Vector of marked individuals recaptured in the second sample, from
each stratum</p>
</td></tr>
<tr><td><code id="sestrat_+3A_estimator">estimator</code></td>
<td>
<p>The type of estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>.  Default to
<code>"Chapman"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The standard error of the stratified estimator
</p>


<h3>Note</h3>

<p>It is possible that even the stratified estimate of abundance may be
biased if capture probabilities differ greatly between strata.  However,
the bias in the stratified estimator will be much less than an estimator
calculated without stratification.
</p>
<p>This function makes the naive assumption of independence between
strata.  Caution is therefore recommended.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+Nstrat">Nstrat</a>, <a href="#topic+rstrat">rstrat</a>,  <a href="#topic+vstrat">vstrat</a>, <a href="#topic+cistrat">cistrat</a>,
<a href="#topic+NChapman">NChapman</a>, <a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sestrat(n1=c(100,200), n2=c(100,500), m2=c(10,10))
</code></pre>

<hr>
<h2 id='strattest'>Consistency Tests for the Abundance Estimator, Complete Stratification</h2><span id='topic+strattest'></span>

<h3>Description</h3>

<p>Conducts two chi-squared tests for the consistency of the
Petersen-type abundance estimator.  These tests provide explore evidence
against equal capture probabilities in either the first or second sampling
event.  Also conducts a third chi-squared test of unequal capture
probabilities between sampling events for each stratum, in the case of
small sample sizes (fewer than 100 in either sampling event and fewer than
30 recaptures), which may be used to suggest unequal capture probabilities
in either the first or second event.
</p>
<p>Typically, if either of the first two test p-values is greater than the
significance level, use of a Petersen-type estimator is considered
justified.
</p>
<p>If tests give evidence of unequal capture probabilities between strata, a
stratified estimator should be used, such as <a href="#topic+Nstrat">Nstrat</a>.
</p>
<p>This function assumes stratification in both sampling events, such that
individuals cannot move from one strata to another (such as by size or
gender).  If movement between strata may occur (such as in the case of
stratification by time or area), use of <a href="#topic+consistencytest">consistencytest</a> is
recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strattest(n1, n2, m2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strattest_+3A_n1">n1</code></td>
<td>
<p>Vector of n1 counts (sample size in the first event), each element
corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="strattest_+3A_n2">n2</code></td>
<td>
<p>Vector of n2 counts (sample size in the second event), each element
corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="strattest_+3A_m2">m2</code></td>
<td>
<p>Vector of m2 counts (number of recaptures in the second event),
each element corresponding to one stratum.</p>
</td></tr>
<tr><td><code id="strattest_+3A_...">...</code></td>
<td>
<p>Additional arguments for <a href="stats.html#topic+chisq.test">chisq.test</a></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>"recapr_strattest"</code> with the following
components: </p>
 <ul>
<li><p><code>event1_table</code> The contingency table
used for the first test </p>
</li>
<li><p><code>event1_Xsqd</code> The chi-squared test
statistic in the first test </p>
</li>
<li><p><code>event1_df</code> The associated
degrees of freedom in the first test </p>
</li>
<li><p><code>event1_pval</code> The
p-value returned from the first test </p>
</li>
<li><p><code>event2_table</code> The
contingency table used for the second test </p>
</li>
<li><p><code>event2_Xsqd</code> The
chi-squared test statistic in the second test </p>
</li>
<li><p><code>event2_df</code> The
associated degrees of freedom in the second test </p>
</li>
<li><p><code>event2_pval</code>
The p-value returned from the second test </p>
</li>
<li><p><code>event1v2_table</code>
The contingency table used for the third test </p>
</li>
<li><p><code>event1v2_Xsqd</code>
The chi-squared test statistic in the third test
</p>
</li>
<li><p><code>event1v2_df</code> The associated degrees of freedom in the third
test </p>
</li>
<li><p><code>event1v2_pval</code> The p-value returned from the second
third </p>
</li></ul>



<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+powstrattest">powstrattest</a>, <a href="#topic+Nstrat">Nstrat</a>, <a href="#topic+consistencytest">consistencytest</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strattest(n1=c(100,100), n2=c(50,200), m2=c(20,15))
</code></pre>

<hr>
<h2 id='vBailey'>Estimated Variance of the Bailey Estimator</h2><span id='topic+vBailey'></span>

<h3>Description</h3>

<p>Calculates the estimated variance of the Bailey estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vBailey(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vBailey_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="vBailey_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="vBailey_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Bailey estimator, calculated as
(n1^2)*(n2+1)*(n2-m2)/(m2+1)/(m2+1)/(m2+2)
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NBailey">NBailey</a>, <a href="#topic+seBailey">seBailey</a>, <a href="#topic+rBailey">rBailey</a>, <a href="#topic+pBailey">pBailey</a>,
<a href="#topic+powBailey">powBailey</a>, <a href="#topic+ciBailey">ciBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vBailey(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='vChapman'>Estimated Variance of the Chapman Estimator</h2><span id='topic+vChapman'></span>

<h3>Description</h3>

<p>Calculates the estimated variance of the Chapman estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vChapman(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vChapman_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="vChapman_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="vChapman_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Chapman estimator, calculated as
(n1+1)*(n2+1)*(n1-m2)*(n2-m2)/((m2+2)*(m2+1)^2)
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NChapman">NChapman</a>, <a href="#topic+seChapman">seChapman</a>, <a href="#topic+rChapman">rChapman</a>, <a href="#topic+pChapman">pChapman</a>,
<a href="#topic+powChapman">powChapman</a>, <a href="#topic+ciChapman">ciChapman</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vChapman(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='vPetersen'>Estimated Variance of the Petersen Estimator</h2><span id='topic+vPetersen'></span>

<h3>Description</h3>

<p>Calculates the estimated variance of the Petersen estimator in a
mark-recapture experiment, with given values of sample sizes and number of
recaptures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vPetersen(n1, n2, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vPetersen_+3A_n1">n1</code></td>
<td>
<p>Number of individuals captured and marked in the first sample. This
may be a single number or vector of values.</p>
</td></tr>
<tr><td><code id="vPetersen_+3A_n2">n2</code></td>
<td>
<p>Number of individuals captured in the second sample.  This may be a
single number or vector of values.</p>
</td></tr>
<tr><td><code id="vPetersen_+3A_m2">m2</code></td>
<td>
<p>Number of marked individuals recaptured in the second sample.  This
may be a single number or vector of values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimate variance of the Petersen estimator, calculated as
(n1^2)*n2*(n2-m2)/(m2^3)
</p>


<h3>Note</h3>

<p>Any Petersen-type estimator (such as this) depends on a set of
assumptions: </p>
 <ul>
<li><p>  The population is closed; that is, that there
are no births, deaths, immigration, or emigration between sampling events
</p>
</li>
<li><p> All individuals have the same probability of capture in one of the
two events, or complete mixing occurs between events </p>
</li>
<li><p> Marking in the
first event does not affect probability of recapture in the second event
</p>
</li>
<li><p> Individuals do not lose marks between events </p>
</li>
<li><p> All marks will be
reported in the second event </p>
</li></ul>



<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+sePetersen">sePetersen</a>, <a href="#topic+rPetersen">rPetersen</a>, <a href="#topic+pPetersen">pPetersen</a>,
<a href="#topic+powPetersen">powPetersen</a>, <a href="#topic+ciPetersen">ciPetersen</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vPetersen(n1=100, n2=100, m2=20)
</code></pre>

<hr>
<h2 id='vstrat'>Estimated Variance of Stratified Abundance Estimator</h2><span id='topic+vstrat'></span>

<h3>Description</h3>

<p>Calculates the estimated variance of the stratified estimator
for abundance in a mark-recapture experiment, from vectors of sample sizes
and number of recaptures, with each element corresponding to each sampling
stratum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vstrat(n1, n2, m2, estimator = "Chapman")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vstrat_+3A_n1">n1</code></td>
<td>
<p>Vector of individuals captured and marked in the first sample, from
each stratum</p>
</td></tr>
<tr><td><code id="vstrat_+3A_n2">n2</code></td>
<td>
<p>Vector of individuals captured and marked in the second sample,
from each stratum</p>
</td></tr>
<tr><td><code id="vstrat_+3A_m2">m2</code></td>
<td>
<p>Vector of marked individuals recaptured in the second sample, from
each stratum</p>
</td></tr>
<tr><td><code id="vstrat_+3A_estimator">estimator</code></td>
<td>
<p>The type of estimator to use.  Allowed values are
<code>"Chapman"</code>, <code>"Petersen"</code>, and <code>"Bailey"</code>.  Default to
<code>"Chapman"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated variance of the stratified estimator
</p>


<h3>Note</h3>

<p>It is possible that even the stratified estimate of abundance may be
biased if capture probabilities differ greatly between strata.  However,
the bias in the stratified estimator will be much less than an estimator
calculated without stratification.
</p>
<p>This function makes the naive assumption of independence between
strata.  Caution is therefore recommended.
</p>


<h3>Author(s)</h3>

<p>Matt Tyers
</p>


<h3>See Also</h3>

<p><a href="#topic+strattest">strattest</a>, <a href="#topic+Nstrat">Nstrat</a>, <a href="#topic+rstrat">rstrat</a>,  <a href="#topic+sestrat">sestrat</a>, <a href="#topic+cistrat">cistrat</a>,
<a href="#topic+NChapman">NChapman</a>, <a href="#topic+NPetersen">NPetersen</a>, <a href="#topic+NBailey">NBailey</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vstrat(n1=c(100,200), n2=c(100,500), m2=c(10,10))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
