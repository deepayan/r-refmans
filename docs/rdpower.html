<!DOCTYPE html><html lang="en"><head><title>Help for package rdpower</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rdpower}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rdpower-package'><p>rdpower: Power and Sample Size Calculations for RD Designs</p></a></li>
<li><a href='#rdmde'><p>MDE Calculations for RD Designs</p></a></li>
<li><a href='#rdpower'><p>Power Calculations for RD Designs</p></a></li>
<li><a href='#rdsampsi'><p>Sample Size Calculations for RD Designs</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power Calculations for RD Designs</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Matias D. Cattaneo, Rocio Titiunik, Gonzalo Vazquez-Bare</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gonzalo Vazquez-Bare &lt;gvazquez@econ.ucsb.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The regression discontinuity (RD) design is a popular quasi-experimental design for causal inference and policy evaluation. The 'rdpower' package provides tools to perform power, sample size and MDE calculations in RD designs: rdpower() calculates the power of an RD design, rdsampsi() calculates the required sample size to achieve a desired power and rdmde() calculates minimum detectable effects. See Cattaneo, Titiunik and Vazquez-Bare (2019) <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf</a> for further methodological details.</td>
</tr>
<tr>
<td>Imports:</td>
<td>rdrobust</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-21 00:03:31 UTC; Gonzalo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-21 23:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='rdpower-package'>rdpower: Power and Sample Size Calculations for RD Designs</h2><span id='topic+rdpower-package'></span><span id='topic+_PACKAGE'></span><span id='topic+rdpower_package'></span>

<h3>Description</h3>

<p>The regression discontinuity (RD) design is a popular quasi-experimental design
for causal inference and policy evaluation. The <code>'rdpower'</code> package provides tools
to perform power, sample size and MDE calculations in RD designs: <code><a href="#topic+rdpower">rdpower</a>()</code> calculates
the power of an RD design, <code><a href="#topic+rdsampsi">rdsampsi</a>()</code> calculates the required sample size to achieve
a desired power and <code><a href="#topic+rdmde">rdmde</a>()</code> calculates minimum detectable effects. This package relies on the <code>rdrobust</code> package. See Calonico, Cattaneo and Titiunik (2014, 2015) and
Calonico, Cattaneo, Farrell and Titiunik (2017).
For more details, and related <code>Stata</code> and <code>R</code> packages
useful for analysis of RD designs, visit <a href="https://rdpackages.github.io/">https://rdpackages.github.io/</a>.
</p>


<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Calonico, S., M. D. Cattaneo, M. Farrell and R. Titiunik. (2017).<a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Farrell-Titiunik_2017_Stata.pdf"> <code>rdrobust</code>: Software for Regression Discontinuity Designs</a>. <em>Stata Journal</em> 17(2): 372-404.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. (2014). <a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2014_Stata.pdf">Robust Data-Driven Inference in the Regression-Discontinuity Design</a>. <em>Stata Journal</em> 14(4): 909-946.
</p>
<p>Calonico, S., M. D. Cattaneo, and R. Titiunik. (2015).<a href="https://rdpackages.github.io/references/Calonico-Cattaneo-Titiunik_2015_R.pdf"> <code>rdrobust</code>: An R Package for Robust Nonparametric Inference in Regression-Discontinuity Designs</a>. <em>R Journal</em> 7(1): 38-51.
</p>
<p>Cattaneo, M. D., R. Titiunik and G. Vazquez-Bare. (2019). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">Power Calculations for Regression Discontinuity Designs</a>. <em>Stata Journal</em>, 19(1): 210-245.
</p>

<hr>
<h2 id='rdmde'>MDE Calculations for RD Designs</h2><span id='topic+rdmde'></span>

<h3>Description</h3>

<p><code>rdmde()</code> performs MDE calculations for RD designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdmde(
  data = NULL,
  cutoff = 0,
  alpha = 0.05,
  beta = 0.8,
  nsamples = NULL,
  sampsi = NULL,
  samph = NULL,
  all = FALSE,
  bias = NULL,
  variance = NULL,
  init.cond = NULL,
  covs = NULL,
  covs_drop = TRUE,
  deriv = 0,
  p = 1,
  q = NULL,
  h = NULL,
  b = NULL,
  rho = NULL,
  kernel = "triangular",
  bwselect = "mserd",
  vce = "nn",
  cluster = NULL,
  scalepar = 1,
  scaleregul = 1,
  fuzzy = NULL,
  level = 95,
  weights = NULL,
  masspoints = "adjust",
  bwcheck = NULL,
  bwrestrict = TRUE,
  stdvars = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdmde_+3A_data">data</code></td>
<td>
<p>a matrix (Y,R) containing the outcome variable and the running variable (as column vectors).</p>
</td></tr>
<tr><td><code id="rdmde_+3A_cutoff">cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td></tr>
<tr><td><code id="rdmde_+3A_alpha">alpha</code></td>
<td>
<p>specifies the significance level for the power function. Default is 0.05.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_beta">beta</code></td>
<td>
<p>specifies the desired power. Default is 0.8.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_nsamples">nsamples</code></td>
<td>
<p>sets the total sample size to the left, sample size to the left inside the bandwidth, total sample size to the right and sample size to the right of the cutoff inside the bandwidth to calculate the variance when the running variable is not specified. When not specified, the values are calculated using the running variable.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_sampsi">sampsi</code></td>
<td>
<p>sets the sample size at each side of the cutoff for power calculation. The first number is the sample size to the left of the cutoff and the second number is the sample size to the right. Default values are the sample sizes inside the chosen bandwidth.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_samph">samph</code></td>
<td>
<p>sets the bandwidths at each side of the cutoff for power calculation. The first number is the bandwidth to the left of the cutoff and the second number is the bandwidth to the right.  Default values are the bandwidths used by <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_all">all</code></td>
<td>
<p>displays the power using the conventional variance estimator, in addition to the robust bias corrected one.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_bias">bias</code></td>
<td>
<p>set bias to the left and right of the cutoff. If not specified, the biases are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_variance">variance</code></td>
<td>
<p>set variance to the left and right of the cutoff. If not specified, the variances are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_init.cond">init.cond</code></td>
<td>
<p>sets the initial condition for the Newton-Raphson algorithm that finds the MDE.  Default is 0.2 times the standard deviation of the outcome below the cutoff.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_covs">covs</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies additional covariates to be used for estimation and inference.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_covs_drop">covs_drop</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_deriv">deriv</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the derivative of the regression functions to be estimated.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_p">p</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the point-estimator.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_q">q</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the bias-correction.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_h">h</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the main bandwidth to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_b">b</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the bias bandwidth $b$ to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_rho">rho</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the value of <code>rho</code> so that the bias bandwidth <code>b</code> equals <code>b=h/rho</code>.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_kernel">kernel</code></td>
<td>
<p>option for <code>rdrobust()</code>: kernel function used to construct the local-polynomial estimators.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_bwselect">bwselect</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the bandwidth selection procedure to be used.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_vce">vce</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the procedure used to compute the variance-covariance matrix estimator.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_cluster">cluster</code></td>
<td>
<p>option for <code>rdrobust()</code>: indicates the cluster ID variable used for the cluster-robust variance estimation with degrees-of-freedom weights.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_scalepar">scalepar</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for RD parameter of interest.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_scaleregul">scaleregul</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for the regularization terms of bandwidth selectors.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_fuzzy">fuzzy</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the treatment status variable used to implement fuzzy RD estimation.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_level">level</code></td>
<td>
<p>option for <code>rdrobust()</code>: sets the confidence level for confidence intervals.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_weights">weights</code></td>
<td>
<p>option for <code>rdrobust()</code>: is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_masspoints">masspoints</code></td>
<td>
<p>option for <code>rdrobust()</code>: checks and controls for repeated observations in tue running variable.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_bwcheck">bwcheck</code></td>
<td>
<p>option for <code>rdrobust()</code>: if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_bwrestrict">bwrestrict</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, computed bandwidths are restricted to lie withing the range of <code>x</code>. Default is <code>bwrestrict=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdmde_+3A_stdvars">stdvars</code></td>
<td>
<p>option for <code>rdrobust()</code>: if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths. Default is <code>stdvars=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mde</code></td>
<td>
<p>MDE using robust bias corrected standard error</p>
</td></tr>
<tr><td><code>se.rbc</code></td>
<td>
<p>robust bias corrected standard error</p>
</td></tr>
<tr><td><code>sampsi.r</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff</p>
</td></tr>
<tr><td><code>sampsi.l</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff</p>
</td></tr>
<tr><td><code>samph.r</code></td>
<td>
<p>bandwidth to the right of the cutoff</p>
</td></tr>
<tr><td><code>samph.l</code></td>
<td>
<p>bandwidth to the left of the cutoff</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>significance level used in power function</p>
</td></tr>
<tr><td><code>bias.r</code></td>
<td>
<p>bias to the right of the cutoff</p>
</td></tr>
<tr><td><code>bias.l</code></td>
<td>
<p>bias to the left of the cutoff</p>
</td></tr>
<tr><td><code>Vr.rb</code></td>
<td>
<p>Robust bias corrected variance to the right of the cutoff</p>
</td></tr>
<tr><td><code>Vl.rb</code></td>
<td>
<p>Robust bias corrected variance to the left of the cutoff</p>
</td></tr>
<tr><td><code>N.r</code></td>
<td>
<p>Total sample size to the right of the cutoff</p>
</td></tr>
<tr><td><code>N.l</code></td>
<td>
<p>Total sample size to the left of the cutoff</p>
</td></tr>
<tr><td><code>mde.conv</code></td>
<td>
<p>MDE using conventional inference</p>
</td></tr>
<tr><td><code>se.conv</code></td>
<td>
<p>conventional standard error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M. D., R. Titiunik and G. Vazquez-Bare. (2019). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">Power Calculations for Regression Discontinuity Designs</a>. <em>Stata Journal</em>, 19(1): 210-245.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Toy dataset
X &lt;- array(rnorm(2000),dim=c(1000,2))
R &lt;- X[,1] + X[,2] + rnorm(1000)
Y &lt;- 1 + R -.5*R^2 + .3*R^3 + (R&gt;=0) + rnorm(1000)
# MDE calculation
tmp &lt;- rdmde(data=cbind(Y,R),init.cond=0.5)


</code></pre>

<hr>
<h2 id='rdpower'>Power Calculations for RD Designs</h2><span id='topic+rdpower'></span>

<h3>Description</h3>

<p><code>rdpower()</code> performs power calculations for RD designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdpower(
  data = NULL,
  cutoff = 0,
  tau = NULL,
  alpha = 0.05,
  nsamples = NULL,
  sampsi = NULL,
  samph = NULL,
  all = FALSE,
  bias = NULL,
  variance = NULL,
  plot = FALSE,
  graph.range = NULL,
  covs = NULL,
  covs_drop = TRUE,
  deriv = 0,
  p = 1,
  q = NULL,
  h = NULL,
  b = NULL,
  rho = NULL,
  kernel = "triangular",
  bwselect = "mserd",
  vce = "nn",
  cluster = NULL,
  scalepar = 1,
  scaleregul = 1,
  fuzzy = NULL,
  level = 95,
  weights = NULL,
  masspoints = "adjust",
  bwcheck = NULL,
  bwrestrict = TRUE,
  stdvars = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdpower_+3A_data">data</code></td>
<td>
<p>a matrix (Y,R) containing the outcome variable and the running variable (as column vectors).</p>
</td></tr>
<tr><td><code id="rdpower_+3A_cutoff">cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td></tr>
<tr><td><code id="rdpower_+3A_tau">tau</code></td>
<td>
<p>specifies the treatment effect under the alternative at which the power function is evaluated. The default is half the standard deviation of the outcome for the untreated group.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_alpha">alpha</code></td>
<td>
<p>specifies the significance level for the power function. Default is 0.05.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_nsamples">nsamples</code></td>
<td>
<p>sets the total sample size to the left, sample size to the left inside the bandwidth, total sample size to the right and sample size to the right of the cutoff inside the bandwidth to calculate the variance when the running variable is not specified. When not specified, the values are calculated using the running variable.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_sampsi">sampsi</code></td>
<td>
<p>sets the sample size at each side of the cutoff for power calculation. The first number is the sample size to the left of the cutoff and the second number is the sample size to the right. Default values are the sample sizes inside the chosen bandwidth.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_samph">samph</code></td>
<td>
<p>sets the bandwidths at each side of the cutoff for power calculation. The first number is the bandwidth to the left of the cutoff and the second number is the bandwidth to the right.  Default values are the bandwidths used by <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_all">all</code></td>
<td>
<p>displays the power using the conventional variance estimator, in addition to the robust bias corrected one.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_bias">bias</code></td>
<td>
<p>set bias to the left and right of the cutoff. If not specified, the biases are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_variance">variance</code></td>
<td>
<p>set variance to the left and right of the cutoff. If not specified, the variances are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_plot">plot</code></td>
<td>
<p>plots the power function using the conventional and robust bias corrected standard errors from <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_graph.range">graph.range</code></td>
<td>
<p>range of the plot.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_covs">covs</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies additional covariates to be used for estimation and inference.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_covs_drop">covs_drop</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_deriv">deriv</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the derivative of the regression functions to be estimated.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_p">p</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the point-estimator.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_q">q</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the bias-correction.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_h">h</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the main bandwidth to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_b">b</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the bias bandwidth $b$ to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_rho">rho</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the value of <code>rho</code> so that the bias bandwidth <code>b</code> equals <code>b=h/rho</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_kernel">kernel</code></td>
<td>
<p>option for <code>rdrobust()</code>: kernel function used to construct the local-polynomial estimators.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_bwselect">bwselect</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the bandwidth selection procedure to be used.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_vce">vce</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the procedure used to compute the variance-covariance matrix estimator.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_cluster">cluster</code></td>
<td>
<p>option for <code>rdrobust()</code>: indicates the cluster ID variable used for the cluster-robust variance estimation with degrees-of-freedom weights.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_scalepar">scalepar</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for RD parameter of interest.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_scaleregul">scaleregul</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for the regularization terms of bandwidth selectors.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_fuzzy">fuzzy</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the treatment status variable used to implement fuzzy RD estimation.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_level">level</code></td>
<td>
<p>option for <code>rdrobust()</code>: sets the confidence level for confidence intervals.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_weights">weights</code></td>
<td>
<p>option for <code>rdrobust()</code>: is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_masspoints">masspoints</code></td>
<td>
<p>option for <code>rdrobust()</code>: checks and controls for repeated observations in tue running variable.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_bwcheck">bwcheck</code></td>
<td>
<p>option for <code>rdrobust()</code>: if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_bwrestrict">bwrestrict</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, computed bandwidths are restricted to lie withing the range of <code>x</code>. Default is <code>bwrestrict=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdpower_+3A_stdvars">stdvars</code></td>
<td>
<p>option for <code>rdrobust()</code>: if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths. Default is <code>stdvars=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>power.rbc</code></td>
<td>
<p>power against tau using robust bias corrected standard error</p>
</td></tr>
<tr><td><code>se.rbc</code></td>
<td>
<p>robust bias corrected standard error</p>
</td></tr>
<tr><td><code>sampsi.r</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff</p>
</td></tr>
<tr><td><code>sampsi.l</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff</p>
</td></tr>
<tr><td><code>samph.r</code></td>
<td>
<p>bandwidth to the right of the cutoff</p>
</td></tr>
<tr><td><code>samph.l</code></td>
<td>
<p>bandwidth to the left of the cutoff</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>significance level used in power function</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>treatment effect under alternative hypothesis</p>
</td></tr>
<tr><td><code>bias.r</code></td>
<td>
<p>bias to the right of the cutoff</p>
</td></tr>
<tr><td><code>bias.l</code></td>
<td>
<p>bias to the left of the cutoff</p>
</td></tr>
<tr><td><code>Vr.rb</code></td>
<td>
<p>Robust bias corrected variance to the right of the cutoff</p>
</td></tr>
<tr><td><code>Vl.rb</code></td>
<td>
<p>Robust bias corrected variance to the left of the cutoff</p>
</td></tr>
<tr><td><code>N.r</code></td>
<td>
<p>Total sample size to the right of the cutoff</p>
</td></tr>
<tr><td><code>N.l</code></td>
<td>
<p>Total sample size to the left of the cutoff</p>
</td></tr>
<tr><td><code>power.conv</code></td>
<td>
<p>power against tau using conventional inference</p>
</td></tr>
<tr><td><code>se.conv</code></td>
<td>
<p>conventional standard error</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M. D., R. Titiunik and G. Vazquez-Bare. (2019). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">Power Calculations for Regression Discontinuity Designs</a>. <em>Stata Journal</em>, 19(1): 210-245.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Toy dataset
X &lt;- array(rnorm(2000),dim=c(1000,2))
R &lt;- X[,1] + X[,2] + rnorm(1000)
Y &lt;- 1 + R -.5*R^2 + .3*R^3 + (R&gt;=0) + rnorm(1000)
# Power against tau = 1
tmp &lt;- rdpower(data=cbind(Y,R),tau=1)
# Power against tau = 1 including covariates
tmp &lt;- rdpower(data=cbind(Y,R),tau=1,covs=X)


</code></pre>

<hr>
<h2 id='rdsampsi'>Sample Size Calculations for RD Designs</h2><span id='topic+rdsampsi'></span>

<h3>Description</h3>

<p><code>rdsampsi()</code> performs sample size calculations for RD designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdsampsi(
  data = NULL,
  cutoff = 0,
  tau = NULL,
  alpha = 0.05,
  beta = 0.8,
  samph = NULL,
  nsamples = NULL,
  all = FALSE,
  bias = NULL,
  variance = NULL,
  nratio = NULL,
  init.cond = NULL,
  plot = FALSE,
  graph.range = NULL,
  covs = NULL,
  covs_drop = TRUE,
  deriv = 0,
  p = 1,
  q = NULL,
  h = NULL,
  b = NULL,
  rho = NULL,
  kernel = "triangular",
  bwselect = "mserd",
  vce = "nn",
  cluster = NULL,
  scalepar = 1,
  scaleregul = 1,
  fuzzy = NULL,
  level = 95,
  weights = NULL,
  masspoints = "adjust",
  bwcheck = NULL,
  bwrestrict = TRUE,
  stdvars = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdsampsi_+3A_data">data</code></td>
<td>
<p>a matrix (Y,R) containing the outcome variable and the running variable (as column vectors).</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_cutoff">cutoff</code></td>
<td>
<p>the RD cutoff (default is 0).</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_tau">tau</code></td>
<td>
<p>specifies the treatment effect under the alternative at which the power function is evaluated. The default is half the standard deviation of the outcome for the untreated group.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_alpha">alpha</code></td>
<td>
<p>specifies the significance level for the power function. Default is 0.05.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_beta">beta</code></td>
<td>
<p>specifies the desired power. Default is 0.8.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_samph">samph</code></td>
<td>
<p>sets the bandwidths at each side of the cutoff for power calculation. The first number is the bandwidth to the left of the cutoff and the second number is the bandwidth to the right.  Default values are the bandwidths used by <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_nsamples">nsamples</code></td>
<td>
<p>sets the total sample size to the left, sample size to the left inside the bandwidth, total sample size to the right and sample size to the right of the cutoff inside the bandwidth to calculate the variance when the running variable is not specified. When not specified, the values are calculated using the running variable.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_all">all</code></td>
<td>
<p>displays the power using the conventional variance estimator, in addition to the robust bias corrected one.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_bias">bias</code></td>
<td>
<p>set bias to the left and right of the cutoff. If not specified, the biases are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_variance">variance</code></td>
<td>
<p>set variance to the left and right of the cutoff. If not specified, the variances are estimated using <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_nratio">nratio</code></td>
<td>
<p>specifies the proportion of treated units in the window. Default is the ratio of the standard deviation of the treated to the sum of the standard deviations for treated and controls.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_init.cond">init.cond</code></td>
<td>
<p>sets the initial condition for the Newton-Raphson algorithm that finds the sample size.  Default is the number of observations in the sample with non-missing values of the outcome and running variable.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_plot">plot</code></td>
<td>
<p>plots the power function using the conventional and robust bias corrected standard errors from <code>rdrobust</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_graph.range">graph.range</code></td>
<td>
<p>range of the plot.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_covs">covs</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies additional covariates to be used for estimation and inference.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_covs_drop">covs_drop</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, it checks for collinear additional covariates and drops them. Default is TRUE.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_deriv">deriv</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the derivative of the regression functions to be estimated.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_p">p</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the point-estimator.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_q">q</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the order of the local-polynomial used to construct the bias-correction.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_h">h</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the main bandwidth to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_b">b</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the values of the bias bandwidth $b$ to be used on the left and on the right of the cutoff, respectively.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_rho">rho</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the value of <code>rho</code> so that the bias bandwidth <code>b</code> equals <code>b=h/rho</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_kernel">kernel</code></td>
<td>
<p>option for <code>rdrobust()</code>: kernel function used to construct the local-polynomial estimators.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_bwselect">bwselect</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the bandwidth selection procedure to be used.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_vce">vce</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the procedure used to compute the variance-covariance matrix estimator.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_cluster">cluster</code></td>
<td>
<p>option for <code>rdrobust()</code>: indicates the cluster ID variable used for the cluster-robust variance estimation with degrees-of-freedom weights.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_scalepar">scalepar</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for RD parameter of interest.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_scaleregul">scaleregul</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies scaling factor for the regularization terms of bandwidth selectors.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_fuzzy">fuzzy</code></td>
<td>
<p>option for <code>rdrobust()</code>: specifies the treatment status variable used to implement fuzzy RD estimation.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_level">level</code></td>
<td>
<p>option for <code>rdrobust()</code>: sets the confidence level for confidence intervals.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_weights">weights</code></td>
<td>
<p>option for <code>rdrobust()</code>: is the variable used for optional weighting of the estimation procedure. The unit-specific weights multiply the kernel function.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_masspoints">masspoints</code></td>
<td>
<p>option for <code>rdrobust()</code>: checks and controls for repeated observations in tue running variable.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_bwcheck">bwcheck</code></td>
<td>
<p>option for <code>rdrobust()</code>: if a positive integer is provided, the preliminary bandwidth used in the calculations is enlarged so that at least <code>bwcheck</code> unique observations are used.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_bwrestrict">bwrestrict</code></td>
<td>
<p>option for <code>rdrobust()</code>: if TRUE, computed bandwidths are restricted to lie withing the range of <code>x</code>. Default is <code>bwrestrict=TRUE</code>.</p>
</td></tr>
<tr><td><code id="rdsampsi_+3A_stdvars">stdvars</code></td>
<td>
<p>option for <code>rdrobust()</code>: if <code>TRUE</code>, <code>x</code> and <code>y</code> are standardized before computing the bandwidths. Default is <code>stdvars=TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>alpha</code></td>
<td>
<p>significance level</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>desired power</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>treatment effect under alternative hypothesis</p>
</td></tr>
<tr><td><code>sampsi.h.tot</code></td>
<td>
<p>total number of observations inside the window</p>
</td></tr>
<tr><td><code>sampsi.h.r</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff</p>
</td></tr>
<tr><td><code>sampsi.h.l</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff</p>
</td></tr>
<tr><td><code>N.r</code></td>
<td>
<p>Total sample size to the right of the cutoff</p>
</td></tr>
<tr><td><code>N.l</code></td>
<td>
<p>Total sample size to the left of the cutoff</p>
</td></tr>
<tr><td><code>samph.r</code></td>
<td>
<p>bandwidth to the right of the cutoff</p>
</td></tr>
<tr><td><code>samph.l</code></td>
<td>
<p>bandwidth to the left of the cutoff</p>
</td></tr>
<tr><td><code>var.r</code></td>
<td>
<p>Robust bias corrected variance to the right of the cutoff</p>
</td></tr>
<tr><td><code>Var.l</code></td>
<td>
<p>Robust bias corrected variance to the left of the cutoff</p>
</td></tr>
<tr><td><code>sampsi.h.tot.cl</code></td>
<td>
<p>implied total number of observations inside the window using conventional s.e.</p>
</td></tr>
<tr><td><code>sampsi.h.r.cl</code></td>
<td>
<p>number of observations inside the window to the right of the cutoff using conventional s.e.</p>
</td></tr>
<tr><td><code>sampsi.h.l.cl</code></td>
<td>
<p>number of observations inside the window to the left of the cutoff using conventional s.e.</p>
</td></tr>
<tr><td><code>no.iter</code></td>
<td>
<p>number of iterations until convergence of the Newton-Raphson algorithm</p>
</td></tr>
<tr><td><code>init.cond</code></td>
<td>
<p>initial condition of the Newton-Raphson algorithm</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Matias Cattaneo, Princeton University. <a href="mailto:cattaneo@princeton.edu">cattaneo@princeton.edu</a>
</p>
<p>Rocio Titiunik, Princeton University. <a href="mailto:titiunik@princeton.edu">titiunik@princeton.edu</a>
</p>
<p>Gonzalo Vazquez-Bare, UC Santa Barbara. <a href="mailto:gvazquez@econ.ucsb.edu">gvazquez@econ.ucsb.edu</a>
</p>


<h3>References</h3>

<p>Cattaneo, M. D., R. Titiunik and G. Vazquez-Bare. (2019). <a href="https://rdpackages.github.io/references/Cattaneo-Titiunik-VazquezBare_2019_Stata.pdf">Power Calculations for Regression Discontinuity Designs</a>. <em>Stata Journal</em>, 19(1): 210-245.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Toy dataset
X &lt;- array(rnorm(2000),dim=c(1000,2))
R &lt;- X[,1] + X[,2] + rnorm(1000)
Y &lt;- 1 + R -.5*R^2 + .3*R^3 + (R&gt;=0) + rnorm(1000)
# Sample size to achieve power of 0.8 against tau = 1
tmp &lt;- rdsampsi(data=cbind(Y,R),tau=1)
# Sample size against tau = 1 including covariates
tmp &lt;- rdsampsi(data=cbind(Y,R),tau=1,covs=X)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
