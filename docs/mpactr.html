<!DOCTYPE html><html lang="en"><head><title>Help for package mpactr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mpactr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mpactr-package'><p>mpactr: Correction of Preprocessed MS Data</p></a></li>
<li><a href='#cultures_data'><p>LC-MS/MS sample data</p></a></li>
<li><a href='#example_path'><p>Get file paths for examples</p></a></li>
<li><a href='#filter_cv'><p>Filter Non-reproducible ions</p></a></li>
<li><a href='#filter_group'><p>Filter Ions by Group</p></a></li>
<li><a href='#filter_insource_ions'><p>Filter Insource ions</p></a></li>
<li><a href='#filter_mispicked_ions'><p>Mispicked ions filter</p></a></li>
<li><a href='#filter_summary'><p>Return the summary for a single mpactr filter.</p></a></li>
<li><a href='#get_cv_data'><p>Get CV values.</p></a></li>
<li><a href='#get_group_averages'><p>Get groups averages.</p></a></li>
<li><a href='#get_meta_data'><p>Return the meta_data data.table from the mpactr object.</p></a></li>
<li><a href='#get_peak_table'><p>Return the peak table data.table from the mpactr object.</p></a></li>
<li><a href='#get_raw_data'><p>Return the input peak table from mpactr object.</p></a></li>
<li><a href='#get_similar_ions'><p>Get similar ion groups.</p></a></li>
<li><a href='#import_data'><p>Import data into an mpactr object.</p></a></li>
<li><a href='#plot_qc_tree'><p>Visualize Filtering Summary as Tree Map</p></a></li>
<li><a href='#qc_summary'><p>Summary of Fitering</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Correction of Preprocessed MS Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An 'R' implementation of the 'python' program Metabolomics Peak Analysis Computational Tool ('MPACT') (Robert M. Samples, Sara P. Puckett, and Marcy J. Balunas (2023) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.2c04632">doi:10.1021/acs.analchem.2c04632</a>&gt;). Filters in the package serve to address common errors in tandem mass spectrometry preprocessing, including: (1) isotopic patterns that are incorrectly split during preprocessing, (2) features present in solvent blanks due to carryover between samples, (3) features whose abundance is greater than user-defined abundance threshold in a specific group of samples, for example media blanks, (4) ions that are inconsistent between technical replicates, and (5) in-source fragment ions created during ionization before fragmentation in the tandem mass spectrometry workflow.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), tidyverse, plotly,
Hmisc, corrplot, ggdendro, ggtext</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, data.table, ggplot2, R6, Rcpp, readr, stats, treemapify,
viridis</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.mums2.org/mpactr/">https://www.mums2.org/mpactr/</a>, <a href="https://github.com/mums2/mpactr">https://github.com/mums2/mpactr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mums2/mpactr/issues">https://github.com/mums2/mpactr/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-13 19:21:04 UTC; grejoh</td>
</tr>
<tr>
<td>Author:</td>
<td>Allison Mason <a href="https://orcid.org/0000-0003-1339-1592"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Gregory Johnson <a href="https://orcid.org/0009-0008-3890-0297"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Patrick Schloss <a href="https://orcid.org/0000-0002-6935-4275"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Patrick Schloss &lt;pschloss@umich.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-13 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mpactr-package'>mpactr: Correction of Preprocessed MS Data</h2><span id='topic+mpactr'></span><span id='topic+mpactr-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>An 'R' implementation of the 'python' program Metabolomics Peak Analysis Computational Tool ('MPACT') (Robert M. Samples, Sara P. Puckett, and Marcy J. Balunas (2023) <a href="https://doi.org/10.1021/acs.analchem.2c04632">doi:10.1021/acs.analchem.2c04632</a>). Filters in the package serve to address common errors in tandem mass spectrometry preprocessing, including: (1) isotopic patterns that are incorrectly split during preprocessing, (2) features present in solvent blanks due to carryover between samples, (3) features whose abundance is greater than user-defined abundance threshold in a specific group of samples, for example media blanks, (4) ions that are inconsistent between technical replicates, and (5) in-source fragment ions created during ionization before fragmentation in the tandem mass spectrometry workflow.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Patrick Schloss <a href="mailto:pschloss@umich.edu">pschloss@umich.edu</a> (<a href="https://orcid.org/0000-0002-6935-4275">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Allison Mason <a href="mailto:masonar@umich.edu">masonar@umich.edu</a> (<a href="https://orcid.org/0000-0003-1339-1592">ORCID</a>)
</p>
</li>
<li><p> Gregory Johnson <a href="mailto:grejoh@umich.edu">grejoh@umich.edu</a> (<a href="https://orcid.org/0009-0008-3890-0297">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://www.mums2.org/mpactr/">https://www.mums2.org/mpactr/</a>
</p>
</li>
<li> <p><a href="https://github.com/mums2/mpactr">https://github.com/mums2/mpactr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/mums2/mpactr/issues">https://github.com/mums2/mpactr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='cultures_data'>LC-MS/MS sample data</h2><span id='topic+cultures_data'></span>

<h3>Description</h3>

<p>A <code>mpactr</code> R6 class object of contining a feature table and associated sample
metadata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cultures_data
</code></pre>


<h3>Format</h3>



<h4><code>culture_data</code></h4>

<p>A <code>mpactr</code> with 2 attributes:
</p>

<dl>
<dt>peak_table</dt><dd><p>A feature table of class <code>data.table</code></p>
</dd>
<dt>meta_data</dt><dd><p>A <code>data.table</code> with associated sample metadata</p>
</dd>
</dl>




<h3>Value</h3>

<p>An <code>mpactr</code> R6 class object.
</p>

<hr>
<h2 id='example_path'>Get file paths for examples</h2><span id='topic+example_path'></span>

<h3>Description</h3>

<p>mpactr contains a number of example files in the <code>inst/extdata</code> directory.
This function makes them accessible in documentation that shows how file
paths are used in function examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_path(file = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="example_path_+3A_file">file</code></td>
<td>
<p>Name of a file. If <code>NULL</code>, all examples files will be listed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A file path to example data stored in the <code>inst/extdata</code> directory
of the package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>example_path()

example_path("metadata.csv")
</code></pre>

<hr>
<h2 id='filter_cv'>Filter Non-reproducible ions</h2><span id='topic+filter_cv'></span>

<h3>Description</h3>

<p><code>filter_cv()</code> removes feature ions that are found to be non-reproducible
between technical injection replicates. Reproducibility is assessed via mean
or median coefficient of variation (CV) between technical replicates. As
such, this filter is expecting an input dataset with at least two replicate
injections per sample.
</p>
<p><code>copy_object</code>: mpactr is built on an R6 class-system, meaning it operates on
reference semantics in which data is updated <em>in-place</em>. Compared to a
shallow copy, where only data pointers are copied, or a deep copy, where
the entire data object is copied in memory, any changes to the original
data object, regardless if they are assigned to a new object, result in
changes to the original data object. We recommend using the default
<code>copy_object = FALSE</code> as this makes for an extremely fast and
memory-efficient way to chain mpactr filters together; however, if you
would like to run the filters individually with traditional R style objects,
you can set <code>copy_object</code> to <code>TRUE</code> as shown in the filter examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_cv(mpactr_object, cv_threshold = NULL, cv_param, copy_object = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_cv_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>An <code>mpactr_object</code>. See <code><a href="#topic+import_data">import_data()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_cv_+3A_cv_threshold">cv_threshold</code></td>
<td>
<p>Coefficient of variation threshold.
A lower cv_threshold will result in more stringent filtering and higher
reproducibility. Recommended values between 0.2 - 0.5.</p>
</td></tr>
<tr><td><code id="filter_cv_+3A_cv_param">cv_param</code></td>
<td>
<p>Coefficient of variation (CV) statistic to use for filtering
Options are &quot;mean&quot; or &quot;median&quot;, corresponding to mean and median CV,
respectively.</p>
</td></tr>
<tr><td><code id="filter_cv_+3A_copy_object">copy_object</code></td>
<td>
<p>A <code>boolean</code> parameter that allows users to return a copied
object instead of modifying the object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>mpactr_object</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_cv(data,
  cv_threshold = 0.01,
  cv_param = "mean",
  copy_object = TRUE
)

data_filter &lt;- filter_cv(data,
  cv_threshold = 0.01,
  cv_param = "median",
  copy_object = TRUE
)

</code></pre>

<hr>
<h2 id='filter_group'>Filter Ions by Group</h2><span id='topic+filter_group'></span>

<h3>Description</h3>

<p>Filter Ions by Group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_group(
  mpactr_object,
  group_threshold = 0.01,
  group_to_remove,
  remove_ions = TRUE,
  copy_object = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_group_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>An <code>mpactr_object</code>. See <code><a href="#topic+import_data">import_data()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_group_+3A_group_threshold">group_threshold</code></td>
<td>
<p>Relative abundance threshold at which to remove ions.
Default = 0.01.</p>
</td></tr>
<tr><td><code id="filter_group_+3A_group_to_remove">group_to_remove</code></td>
<td>
<p>Biological group name to remove ions from.</p>
</td></tr>
<tr><td><code id="filter_group_+3A_remove_ions">remove_ions</code></td>
<td>
<p>A <code>boolean</code> parameter. If <code>TRUE</code> failing ions will be
removed from the peak table. Default = TRUE.</p>
</td></tr>
<tr><td><code id="filter_group_+3A_copy_object">copy_object</code></td>
<td>
<p>A <code>boolean</code> parameter that allows users to return a copied
object instead of modifying the object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>filter_group()</code> removes feature ions that are present in a user-defined
group based on a relative abundance threshold. This could be particularly
useful to filter out features found present in solvent blank samples.
Further, this filter can be ultilized to remove features in media blank
sample for experiments on microbial cultures.
The presence or absence of features in a group of samples is determined by
first averaging injection replicates and then averaging biological
replicates within each biological treatment group. A feature is present in
a group if its abundance is greater than the user-defined <code>group_threshold</code>.
The default is 0.01, meaning a feature is removed if its abundance is 1% of
that in the sample group in which it is most abundant. For example, blank
filtering can remove features whose mean abundance in solvent blank
injections is greater than 1% of their maximum mean abundance in experimental
samples.
</p>
<p>If you would like to remove features found in media blank
samples, we recommend testing the <code>group_threshold</code> parameter.
</p>
<p><code>copy_object</code>: mpactr is built on an R6 class-system, meaning it operates on
reference semantics in which data is updated <em>in-place</em>. Compared to a
shallow copy, where only data pointers are copied, or a deep copy, where
the entire data object is copied in memory, any changes to the original
data object, regardless if they are assigned to a new object, result in
changes to the original data object. We recommend using the default
<code>copy_object = FALSE</code> as this makes for an extremely fast and
memory-efficient way to chain mpactr filters together; however, if you
would like to run the filters individually with traditional R style objects,
you can set <code>copy_object</code> to <code>TRUE</code> as shown in the filter examples.
</p>


<h3>Value</h3>

<p>an <code>mpactr_object</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_group(data,
  group_threshold = 0.01,
  group_to_remove = "Blanks",
  remove_ions = TRUE
)

</code></pre>

<hr>
<h2 id='filter_insource_ions'>Filter Insource ions</h2><span id='topic+filter_insource_ions'></span>

<h3>Description</h3>

<p><code>filter_insource_ions()</code> identifies and removes in-source ion clusters based
on a Pearson correlation threshold. Groups of co-eluting features with
identical retention time are identified and used to generate Pearson
correlation matrices. Clusters with self-similarity greater than the
user-defined <code>cluster_threshold</code> within these matrices are identified as
likely belonging to a single precursor ion and is associated insource ion.
Highly correlated ions are identified and removed.
</p>
<p><code>copy_object</code>: mpactr is built on an R6 class-system, meaning it operates on
reference semantics in which data is updated <em>in-place</em>. Compared to a
shallow copy, where only data pointers are copied, or a deep copy, where
the entire data object is copied in memory, any changes to the original
data object, regardless if they are assigned to a new object, result in
changes to the original data object. We recommend using the default
<code>copy_object = FALSE</code> as this makes for an extremely fast and
memory-efficient way to chain mpactr filters together; however, if you
would like to run the filters individually with traditional R style objects,
you can set <code>copy_object</code> to <code>TRUE</code> as shown in the filter examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_insource_ions(
  mpactr_object,
  cluster_threshold = 0.95,
  copy_object = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_insource_ions_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>An <code>mpactr_object</code>. See <code><a href="#topic+import_data">import_data()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_insource_ions_+3A_cluster_threshold">cluster_threshold</code></td>
<td>
<p>Cluster threshold for ion deconvolution.
Default = 0.95.</p>
</td></tr>
<tr><td><code id="filter_insource_ions_+3A_copy_object">copy_object</code></td>
<td>
<p>A <code>boolean</code> parameter that allows users to return
a copied object instead of modifying the object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>mpactr_object</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_insource_ions(data,
  cluster_threshold = 0.95
)

</code></pre>

<hr>
<h2 id='filter_mispicked_ions'>Mispicked ions filter</h2><span id='topic+filter_mispicked_ions'></span>

<h3>Description</h3>

<p><code>filter_mispicked_ions()</code> identifies ions that were incorrectly split into
separate features during preprocessing. This filter checks the feature table
for similar ions in terms of mass and retention time. Peaks found to be
similar are merged into a single feature given <code>merge_peaks</code> is <code>TRUE</code>.
</p>
<p>The parameter <code>ringwin</code> is the detector saturation mass window, specific for
some instruments, such as Waters Synapse G2-Si-Q-ToF, to account for high
concentration samples.
</p>
<p>Parameter <code>isowin</code> is the isotopic mass window, which accounts for isotopic
peaks of the same precussor mass that were incorrectly assigned during
preprocessing.
</p>
<p><code>copy_object</code>: mpactr is built on an R6 class-system, meaning it operates on
reference semantics in which data is updated <em>in-place</em>. Compared to a
shallow copy, where only data pointers are copied, or a deep copy, where
the entire data object is copied in memory, any changes to the original
data object, regardless if they are assigned to a new object, result in
changes to the original data object. We recommend using the default
<code>copy_object = FALSE</code> as this makes for an extremely fast and
memory-efficient way to chain mpactr filters together; however, if you
would like to run the filters individually with traditional R style objects,
you can set <code>copy_object</code> to <code>TRUE</code> as shown in the filter examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_mispicked_ions(
  mpactr_object,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE,
  merge_method = "sum",
  copy_object = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_mispicked_ions_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>An <code>mpactr_object</code>. See <code><a href="#topic+import_data">import_data()</a></code>.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_ringwin">ringwin</code></td>
<td>
<p>Ringing mass window or detector saturation mass window.
Default = 0.5 atomic mass units (AMU).</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_isowin">isowin</code></td>
<td>
<p>Isotopic mass window. Default = 0.01 AMU.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_trwin">trwin</code></td>
<td>
<p>A <code>numeric</code> denoting the retention time threshold for assessing
if ions should be merged. Default = 0.005.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_max_iso_shift">max_iso_shift</code></td>
<td>
<p>A <code>numeric</code>. Default = 3.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_merge_peaks">merge_peaks</code></td>
<td>
<p>A <code>boolean</code> parameter to determine if peaks found to
belong to the same ion should be merged in the feature table.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_merge_method">merge_method</code></td>
<td>
<p>If merge_peaks is TRUE, a method for how similar peaks
should be merged. Can be one of &quot;sum&quot;.</p>
</td></tr>
<tr><td><code id="filter_mispicked_ions_+3A_copy_object">copy_object</code></td>
<td>
<p>A <code>boolean</code> parameter that allows users to return a copied
object instead of modifying the object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>mpactr_object</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE,
  merge_method = "sum"
)

</code></pre>

<hr>
<h2 id='filter_summary'>Return the summary for a single mpactr filter.</h2><span id='topic+filter_summary'></span>

<h3>Description</h3>

<p><code>filter_summary()</code> is a wrapper function to return the summary
from a single filter within the given mpactr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_summary(mpactr_object, filter, group = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_summary_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling
the import_data() function.</p>
</td></tr>
<tr><td><code id="filter_summary_+3A_filter">filter</code></td>
<td>
<p>The name of a filter whose summary is to be extracted.
Must be one of: &quot;mispicked&quot;, &quot;group&quot;, &quot;replicability&quot;, or &quot;insource&quot;.</p>
</td></tr>
<tr><td><code id="filter_summary_+3A_group">group</code></td>
<td>
<p>If filter = &quot;group&quot;, the name of the Biological_Group
used to filter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>list</code> reporting 1) compound ids for compounds which failed
the filter and 2) compound ids for compounds which passed the filter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data)

mispicked_summary &lt;- filter_summary(data_filter, filter = "mispicked")
mispicked_summary

</code></pre>

<hr>
<h2 id='get_cv_data'>Get CV values.</h2><span id='topic+get_cv_data'></span>

<h3>Description</h3>

<p><code>get_cv_data()</code> is a wrapper function to return cv (coefficient of
variation) calculated with <code><a href="#topic+filter_cv">filter_cv()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cv_data(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cv_data_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling
the import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code> reporting the mean and median coefficient
of variation for each input ion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_cv(data,
  cv_threshold = 0.01,
  cv_param = "median"
)

cv &lt;- get_cv_data(data_filter)
head(cv)

</code></pre>

<hr>
<h2 id='get_group_averages'>Get groups averages.</h2><span id='topic+get_group_averages'></span>

<h3>Description</h3>

<p><code>get_group_averages()</code> is a wrapper function to return group averages
for the filtered peak table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_group_averages(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_group_averages_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling the
import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code> reporting the average and relative standard
deviation across biological groups and technical replicates within
each group.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_group(data, group_to_remove = "Blanks")

group_averages &lt;- get_group_averages(data_filter)
head(group_averages)

</code></pre>

<hr>
<h2 id='get_meta_data'>Return the meta_data data.table from the mpactr object.</h2><span id='topic+get_meta_data'></span>

<h3>Description</h3>

<p><code>get_meta_data()</code> a wrapper function to return the meta data object
of the given mpactr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_meta_data(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_meta_data_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling
the import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

meta_data &lt;- get_meta_data(data)

</code></pre>

<hr>
<h2 id='get_peak_table'>Return the peak table data.table from the mpactr object.</h2><span id='topic+get_peak_table'></span>

<h3>Description</h3>

<p><code>get_peak_table()</code> a wrapper function to return the peak table
object of the given mpactr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_peak_table(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_peak_table_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling
the import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

peak_table &lt;- get_peak_table(data)

</code></pre>

<hr>
<h2 id='get_raw_data'>Return the input peak table from mpactr object.</h2><span id='topic+get_raw_data'></span>

<h3>Description</h3>

<p><code>get_raw_data</code> a wrapper function to return the meta data object of the
given mpactr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_raw_data(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_raw_data_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling the
import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

raw_data &lt;- get_raw_data(data)

</code></pre>

<hr>
<h2 id='get_similar_ions'>Get similar ion groups.</h2><span id='topic+get_similar_ions'></span>

<h3>Description</h3>

<p><code>get_similar_ions()</code> is a wrapper function to return similar ion groups
determined with the <code><a href="#topic+filter_mispicked_ions">filter_mispicked_ions()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_similar_ions(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_similar_ions_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>The mpactr object that is created by calling the
import_data() function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code> reporting the main ion and those found to be
similar with <code><a href="#topic+filter_mispicked_ions">filter_mispicked_ions()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data)

mispicked_ion_groups &lt;- get_similar_ions(data_filter)
mispicked_ion_groups

</code></pre>

<hr>
<h2 id='import_data'>Import data into an mpactr object.</h2><span id='topic+import_data'></span>

<h3>Description</h3>

<p><code>import_data()</code> takes two file paths, one for the pre-processed feature
table and one for sample metadata. Both files should be .csv.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_data(peak_table, meta_data, format = "none")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_data_+3A_peak_table">peak_table</code></td>
<td>
<p>The file path or valid <code>https</code> url to your feature table
file.</p>
</td></tr>
<tr><td><code id="import_data_+3A_meta_data">meta_data</code></td>
<td>
<p>The file path to your meta_data file or <code>data.frame</code>.</p>
</td></tr>
<tr><td><code id="import_data_+3A_format">format</code></td>
<td>
<p>The expected exported type of your peak table, can be
one of &quot;Progenesis&quot;, &quot;Metaboscape&quot;, &quot;None&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>mpactr requires a peak table and meta data as input. Files are expected to be
comma separated files (<em>.csv</em>).
</p>

<ol>
<li> <p><code>peak_table</code>: a peak table where rows are expected to be compounds. mpactr
supports import of feature table files from multiple tools through the
<code>format</code> argument. Currently supported value for <code>format</code> are &quot;Progenesis&quot;,
&quot;Metaboscape&quot;, or &quot;None&quot;.
</p>
</li></ol>

<p><code>format</code> = &quot;Progensis&quot; allows users to provide a feature table exported by
Progenesis. To export a compatable peak table in Progenesis, navigate to the
<em>Review Compounds</em> tab then File -&gt; Export Compound Measurements. Select
the following properties: Compound, m/z, Retention time (min), and Raw
abundance and click ok.
</p>
<p><code>format</code> = &quot;Metaboscape&quot; allows users to provide a feature table exported by
Metaboscape with default settings. The import function will save the raw peak
table in the <code>mpactr_object</code> and store a formatted peak table for filtering.
Reformatting includes selecting &quot;FEATURE_ID&quot;, &quot;RT&quot;, &quot;PEPMASS&quot;, and sample
columns. Sample columns are determined from the &quot;Injection&quot; column in
<code>meta_data</code> (see below). &quot;PEPMASS&quot; is converted to m/z using the &quot;ADDUCT&quot;
column and compound metadata columns are renamed for mpactr.
</p>
<p><code>format</code> = &quot;None&quot; allows users to provide a feature table file in the
expected format. This can be useful if you have a file from another tool and
want to manually format it in R. The table rows are expected to be individual
features, while columns are compound metadata and samples. The feature table
must have the compound metadata columns &quot;Compound&quot;, &quot;mz&quot;, and &quot;rt&quot;. Where
&quot;Compound&quot; is the compound id, and can be <code>numeric</code> or <code>character</code>. &quot;mz&quot; is
the compound m/z, and should be <code>numeric</code>. &quot;rt&quot; is the retention time, in
mintues, and should be <code>numeric</code>. The remaining columns should be samples,
and match the names in the &quot;Injection&quot; column of the <code>meta_data</code> file.
2. <code>meta_data</code>: a table with sample information. Either a file path or
<code>data.frame</code> can be supplied. At minimum the following columns are expected:
&quot;Injection&quot;, &quot;Sample_Code&quot;, and &quot;Biological_Group&quot;. &quot;Injection&quot; is the sample
name and is expected to match sample column names in the <code>peak_table</code>.
&quot;Sample_Code&quot; is the id for technical replicate groups. &quot;Biological_Group&quot;
is the id for biological replicate groups. Other sample metadata can be
added, and is encouraged for downstream analysis following filtering with
mpactr.
</p>


<h3>Value</h3>

<p>an <code>mpactr_object</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

meta_data &lt;- read.csv(example_path("metadata.csv"))
data &lt;- import_data(example_path("coculture_peak_table.csv"),
  meta_data,
  format = "Progenesis"
)

</code></pre>

<hr>
<h2 id='plot_qc_tree'>Visualize Filtering Summary as Tree Map</h2><span id='topic+plot_qc_tree'></span>

<h3>Description</h3>

<p><code>plot_qc_tree()</code> visualizes the filtering summary as a treemap. Ion
status (see <code><a href="#topic+qc_summary">qc_summary()</a></code>) is reported here as percentage of all
pre-filtered ions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_qc_tree(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_qc_tree_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>an <code>mpactr_object</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tree map plot of class <code>ggplot</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE
)

plot_qc_tree(data_filter)
</code></pre>

<hr>
<h2 id='qc_summary'>Summary of Fitering</h2><span id='topic+qc_summary'></span>

<h3>Description</h3>

<p>Parses an mpactr object and exracts a summary of all applied filters.
Specifically, the fate of each input ion is reported as ion status. Status
options are: Passed, mispicked, group, replicability, and insouce. A status
of Passed ions is returned for ions that passed all applied filters and
therefore are expected to be high quaility ions. Ions tagged as group,
mispicked, replicability, or ionsource were removed during the correspoding
filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qc_summary(mpactr_object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qc_summary_+3A_mpactr_object">mpactr_object</code></td>
<td>
<p>an <code>mpactr_object</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.table</code> reporting the number of high quality ions
(&quot;Passed&quot;) or the filter in which they were removed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- import_data(
  example_path("coculture_peak_table.csv"),
  example_path("metadata.csv"),
  format = "Progenesis"
)

data_filter &lt;- filter_mispicked_ions(data,
  ringwin = 0.5,
  isowin = 0.01,
  trwin = 0.005,
  max_iso_shift = 3,
  merge_peaks = TRUE
)

summary &lt;- qc_summary(data_filter)
summary
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
