<!DOCTYPE html><html><head><title>Help for package SigTree</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SigTree}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adonis.tree'><p>Function to perform adonis test of independence on p-values from tests of multiple OTUs.</p></a></li>
<li><a href='#export.figtree'>
<p>Function to export a <code>NEXUS</code> file that can be opened in <code>FigTree</code> to produce a plot of the phylogenetic tree with branches colored according to significance of families of p-values</p></a></li>
<li><a href='#export.inherit'>
<p>Function to produce a CSV file with the p-value for each branch as well as a list of all of the tips in each branch's family</p></a></li>
<li><a href='#p2.p1'><p>Function to convert two-tailed p-values to one-tailed, for use by other SigTree functions.</p></a></li>
<li><a href='#plotSigTree'><p>Function to plot the phylogenetic tree in R with branches (tips) colored according to significance of families of p-values (tips' p-values)</p></a></li>
<li><a href='#SigTree-package'>
<p>Determine significantly responsive branches in phylogenetic trees</p></a></li>
<li><a href='#SigTree.other'>
<p>SigTree Other Functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Identify and Visualize Significantly Responsive Branches in a
Phylogenetic Tree</td>
</tr>
<tr>
<td>Version:</td>
<td>1.10.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-09-29</td>
</tr>
<tr>
<td>Author:</td>
<td>John R. Stevens and Todd R. Jones</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John R. Stevens &lt;john.r.stevens@usu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools to identify and visualize branches in a phylogenetic tree that are significantly responsive to some intervention, taking as primary inputs a phylogenetic tree (of class phylo) and a data frame (or matrix) of corresponding tip (OTU) labels and p-values.</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, phylobase, phyext2, RColorBrewer, phyloseq, graphics,
utils, stats, MASS, vegan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-09-29 23:13:58 UTC; John</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-10-02 20:53:17 UTC</td>
</tr>
</table>
<hr>
<h2 id='adonis.tree'>Function to perform adonis test of independence on p-values from tests of multiple OTUs. 
</h2><span id='topic+adonis.tree'></span>

<h3>Description</h3>

<p><code>adonis.tree</code> takes <code>tree</code> and <code>unsorted.pvalues</code> and computes a p-value corresponding to a test for significant differences among the p-values in <code>unsorted.pvalues</code> based on the between-OTU distances in the phylogenetic tree <code>tree</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adonis.tree(tree, unsorted.pvalues, seed=1234, perms=10000, z=TRUE, make2sided=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adonis.tree_+3A_tree">tree</code></td>
<td>
<p>a phylogenetic tree of class <code>phylo</code>.
</p>
</td></tr>
<tr><td><code id="adonis.tree_+3A_unsorted.pvalues">unsorted.pvalues</code></td>
<td>
<p>a data frame (or matrix) with tip labels in column 1 and p-values in column 2.  The tip labels must correspond to the tip labels in <code>tree</code>.
</p>
</td></tr>
<tr><td><code id="adonis.tree_+3A_seed">seed</code></td>
<td>
<p>positive integer seed value, to force reproducibility of permutations.
</p>
</td></tr>
<tr><td><code id="adonis.tree_+3A_perms">perms</code></td>
<td>
<p>number of permutations to employ for adonis test
</p>
</td></tr>
<tr><td><code id="adonis.tree_+3A_z">z</code></td>
<td>
<p>logical argument (TRUE or FALSE) indicating whether or not to convert p-values to corresponding standard normal (Z) variates, on which scale the adonis test would subsequently be performed.
</p>
</td></tr>
<tr><td><code id="adonis.tree_+3A_make2sided">make2sided</code></td>
<td>
<p>logical argument (TRUE or FLASE) indicating whether or not to convert p-values to two-sided; this should be TRUE whenever <code>unsorted.pvalues</code> are one-sided p-values.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>After converting p-values to corresponding standard normal (Z) variates (when <code>make2sided=TRUE</code>), and obtaining the distance matrix of between-OTU distances, this function employs the <code>adonis</code> function of the package <code>vegan</code>.  This effectively results in a test of whether the OTU p-values are independent (the null hypothesis here), or whether differences among the OTU p-values are associated with between-OTU distances.
</p>
<p>The &quot;adonis&quot; method was apparently originally called &quot;anodis&quot;, for &quot;analysis of dissimilarities&quot;.  To more easily distinguish this method from ANOSIM (&quot;analysis of similarities&quot;, which also handles dissimilarities), it was re-named &quot;anodis&quot;.  According to the help file for <code>adonis</code>, &quot;Most anosim models could be analyzed with adonis, which seems to be a more robust alternative&quot; because it is less sensitive to dispersion effects (Warton et al., 2012).
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function returns a single numeric value, corresponding to a p-value of null: &quot;p-values for OTUs are independent&quot; vs. alternative: &quot;OTU p-value differences are associated with pairwise OTU distances&quot;.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>
<p>Anderson, M.J. (2001) &quot;A new method for non-parametric multivariate analysis of variance.&quot; Austral Ecology, 26: 32-46.
</p>
<p>Reiss P.T., Stevens M.H.H., Shehzad Z., Petkova E., and Milham M.P. (2010) &quot;On Distance-Based Permutation Tests for Between-Group Comparisons.&quot; Biometrics 66:636-643.
</p>
<p>Warton, D.I., Wright, T.W., Wang, Y. (2012)  &quot;Distance-based multivariate analyses confound location and dispersion effects.&quot; Methods in Ecology and Evolution, 3, 89-101. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### To access the tutorial document for this package, type in R (not run here): 
# vignette('SigTree')

### Create tree, then data frame, then use plotSigTree to plot the tree
### Code for random tree and data frame
node.size &lt;- 10
seed &lt;- 109
# Create tree
set.seed(seed);
library(ape)
r.tree &lt;- rtree(node.size)
# Create p-values data frame
set.seed(seed)
r.pval &lt;- rbeta(node.size, .1, .1)
# Randomize the order of the tip labels
# (just to emphasize that labels need not be sorted)
set.seed(seed)
r.tip.label &lt;- sample(r.tree$tip.label, size=length(r.tree$tip.label))
r.pvalues &lt;- data.frame(label=r.tip.label, pval=r.pval)

# Check for dependence among p-values; lack of significance here
# indicates default test="Stouffer" would be appropriate in other 
# main SigTree package functions (plotSigTree, export.figtree, 
# and export.inherit); otherwise, test="Hartung" would be more 
# appropriate.
adonis.tree(r.tree,r.pvalues)

</code></pre>

<hr>
<h2 id='export.figtree'>
Function to export a <code>NEXUS</code> file that can be opened in <code>FigTree</code> to produce a plot of the phylogenetic tree with branches colored according to significance of families of p-values
</h2><span id='topic+export.figtree'></span>

<h3>Description</h3>

<p><code>export.figtree</code> takes <code>tree</code> and <code>unsorted.pvalues</code> and produces
a <code>NEXUS</code> file that can <code>FigTree</code> can subsequently open.  The p-values for each branch (family of tips) are
computed and the branches are colored accordingly.  It computes the p-values based on arguments involving p-value adjustment (for multiple hypothesis testing) and either Stouffer's or Fisher's p-value combination method. 
There are arguments that allow for the customization of the p-value cutoff ranges as well as the colors to be used
in the coloring of the branches.  There is also an option to include annotations for each edge that contain the p-value 
for the corresponding branch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export.figtree(tree, unsorted.pvalues, adjust=TRUE, side=1, 
	method="hommel", p.cutoffs=ifelse(rep(side==1, ifelse(side==1, 6, 3)),
	c(.01, .05, .1, .9, .95, .99), c(.01, .05, .1)), file="", 
	pal=ifelse(rep(side==1, ifelse(side==1, 1, length(p.cutoffs)+1)),
	"RdBu", rev(brewer.pal(length(p.cutoffs)+1,"Reds"))),
	test = "Stouffer", edge.label=TRUE, ignore.edge.length=FALSE,
	branch="edge")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export.figtree_+3A_tree">tree</code></td>
<td>

<p>a phylogenetic tree of class <code>phylo</code>.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_unsorted.pvalues">unsorted.pvalues</code></td>
<td>

<p>a data frame (or matrix) with tip labels in column 1 and p-values in column 2.  The tip labels must correspond to the tip labels in <code>tree</code>.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_adjust">adjust</code></td>
<td>

<p>a logical argument that controls whether there is p-value adjustment performed (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_side">side</code></td>
<td>

<p>a numerical argument that takes values <code>1</code> and <code>2</code>, depending on whether the p-values in <code>unsorted.pvalues</code> are 1-sided or 2-sided, respectively.  Only used in p-value adjustment if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_method">method</code></td>
<td>

<p>one of the p-value adjustment methods (used for multiple-hypothesis testing) found in <code>p.adjust.methods</code> (<code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"BH"</code>, <code>"bonferroni"</code>, <code>"BY"</code>, <code>"fdr"</code>, and <code>"none"</code>).  See help for <code>p.adjust</code> for more details on these methods.  <code>method</code> is only used if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_p.cutoffs">p.cutoffs</code></td>
<td>

<p>a vector of increasing p-value cutoffs (excluding 0 and 1) to determine the ranges of p-values used in the coloring of the branches.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_file">file</code></td>
<td>

<p>the file path that the <code>NEXUS</code> file that <code>FigTree</code> can open is written to.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_pal">pal</code></td>
<td>

<p>one of the palettes from the RColorBrewer package (see <code>brewer.pal.info</code> for a list) or a vector of hexadecimal colors.  These are the colors that are used to color the branches.  The first color corresponds to the first range in p.cutoffs and so on.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_test">test</code></td>
<td>

<p>a character string taking on <code>"Hartung"</code>, <code>"Stouffer"</code>, or <code>"Fisher"</code>.  This is the p-value combination method that will be used.  In most cases, &quot;Stouffer&quot; will be most appropriate, unless <code>adonis.tree</code> indicates significant evidence of dependence among p-values, in which case &quot;Hartung&quot; is preferred.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_edge.label">edge.label</code></td>
<td>

<p>a logical argument that, when <code>TRUE</code>, produces edge label annotations in <code>FigTree</code>.  These annotations are the p-values of the edge's parent node when <code>branch="node"</code>.  They are accessible via highlighting an edge, hitting the <code>Annotate</code> button, and selecting <code>P-value</code>.
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_ignore.edge.length">ignore.edge.length</code></td>
<td>

<p>a logical parameter.  When <code>TRUE</code>, the edge lengths from <code>tree</code> are ignored and <code>FigTree</code> creates its own edge lengths.  <code>ignore.edge.length</code> has no effect if the edges in <code>tree</code> have no defined length.  
</p>
</td></tr>
<tr><td><code id="export.figtree_+3A_branch">branch</code></td>
<td>

<p>a character controlling branch definition: <code>"edge"</code> and <code>"node"</code> are the only options.  This does not affect statistical methods, only the colors used in edge coloring. Prior to package version 1.2, only <code>branch="node"</code> was implemented.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tip labels of <code>tree</code> (accessed via <code>tree$tip.label</code>) must have the same names (and the same length) as the tip labels in <code>unsorted.pvalues</code>, but may be in a different order.  The p-values in column 2 of <code>unsorted.pvalues</code> obviously must be in the [0, 1] range.  <code>p.cutoffs</code> takes values in the (0, 1) range.  The default value for <code>p.cutoffs</code> is <code>c(0.01, 0.05, 0.1, 0.9, 0.95, 0.99)</code> if side is <code>1</code> and <code>c(0.01, 0.05, 0.1)</code> if side is <code>2</code>.  Thus, the ranges (when side is <code>1</code>) are: [0, .01], (.01, .05], ..., (.99, 1].  These ranges correspond to the colors specified in <code>pal</code>.  P-values in the [0, .01] range correspond to the left-most color if <code>pal</code> is a palette (view this via <code>display.brewer.pal(x, pal)</code> - where <code>x</code> is the number of colors to be used) or the first value in the vector if <code>pal</code> is a vector of colors.  If <code>pal</code> is a vector of colors, then the length of <code>pal</code> should be one greater than the length of <code>p.cutoffs</code>.  In other words, its length must be the same as the number of p-value ranges.  In addition, each color in this vector of colors needs to be in hexadecimal format, for example, <code>"#B2182B"</code>.  Formats of colors other than hexadecimal will likely give unwanted results in the edges of the tree produced in <em>FigTree</em>, such as all-black edges or the edges being colored in a meaningless way.  This is because the color conversion assumes hexadecimal colors.  The default value of <code>pal</code> is <code>"RdBu"</code> (a divergent palette of reds and blues, with reds corresponding to small p-values) if <code>side</code> is <code>1</code> and the reverse of <code>"Reds"</code> (a sequential palette) if <code>side</code> is 2.   The sequential palettes in <code>RColorBrewer</code> go from light to dark, so <code>"Reds"</code> is reversed so that the dark red corresponds to small p-values.    It probably makes more sense to use a divergent palette when using 1-sided p-values and a sequential palette (reversed) when using 2-sided p-values.  To create a vector of reversed colors from a palette with <code>x</code> number of colors and <code>"PaletteName"</code> as the name of the palette, use <code>rev(brewer.pal(x, "PaletteName"))</code>.  <code>ignore.edge.length</code> may be useful to get a more uniformly-shaped tree. <code>export.figtree</code> assumes that each internal node has exactly two descendants.  It also assumes that each internal node has a lower number than each of its ancestors (excluding tips). 
</p>
<p>The <code>branch</code> argument controls whether edge coloring corresponds to the combined p-value of the tips below the edge (<code>"edge"</code>) or of the tips below the edge's leading (away from the tips) node (<code>"node"</code>).  Note that if <code>branch="node"</code> is used, then both edges leaving a node will necessarily be colored the same.
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function creates a <code>NEXUS</code> file that can be opened by the program <code>FigTree</code>.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>
<p><code>FigTree</code> is available at <code>http://tree.bio.ed.ac.uk/software/figtree/</code>.  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### To access the tutorial document for this package, type in R (not run here): 
# vignette("SigTree")

### Create tree, then data frame, then use plotSigTree to plot the tree
### Code for random tree and data frame
node.size &lt;- 10
seed &lt;- 109
# Create tree
set.seed(seed)
library(ape)
r.tree &lt;- rtree(node.size)
# Create p-values data frame
set.seed(seed)
r.pval &lt;- rbeta(node.size, .1, .1)
# Randomize the order of the tip labels
# (just to emphasize that labels need not be sorted)
set.seed(seed)
r.tip.label &lt;- sample(r.tree$tip.label, size=length(r.tree$tip.label))
r.pvalues &lt;- data.frame(label=r.tip.label, pval=r.pval)

# Check for dependence among p-values; lack of significance here
# indicates default test="Stouffer" is appropriate; 
# otherwise, test="Hartung" would be more appropriate.
adonis.tree(r.tree,r.pvalues)

# Export "ExportFigtree1.tre" file that can be opened in FigTree
library(phyext2)
export.figtree(r.tree, r.pvalues, test="Stouffer", file="ExportFigtree1.tre")

</code></pre>

<hr>
<h2 id='export.inherit'>
Function to produce a CSV file with the p-value for each branch as well as a list of all of the tips in each branch's family
</h2><span id='topic+export.inherit'></span>

<h3>Description</h3>

<p><code>export.inherit</code> takes <code>tree</code> and <code>unsorted.pvalues</code> and produces a <code>CSV</code> file (or data frame) with p-values for each branch (including 
tips) as well as a list of all of the tips that belong to each branch's family (i.e., all of the tips that are descendants of the branch).  The
p-values are computed based on arguments involving p-value adjustment (for multiple hypothesis testing) and either Stouffer's or Fisher's p-value combination method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export.inherit(tree, unsorted.pvalues, adjust = TRUE, side = 1, method = "hommel",
file = "", test = "Stouffer", frame = FALSE, branch="edge")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export.inherit_+3A_tree">tree</code></td>
<td>

<p>a phylogenetic tree of class <code>phylo</code>.
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_unsorted.pvalues">unsorted.pvalues</code></td>
<td>

<p>a data frame (or matrix) with tip labels in column 1 and p-values in column 2.  The tip labels must correspond to the tip labels in <code>tree</code>.
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_adjust">adjust</code></td>
<td>

<p>a logical argument that controls whether there is p-value adjustment performed (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_side">side</code></td>
<td>

<p>a numerical argument that takes values <code>1</code> and <code>2</code>, depending on whether the p-values in <code>unsorted.pvalues</code> are 1-sided or 2-sided, respectively.  Only used in p-value adjustment if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_method">method</code></td>
<td>

<p>one of the p-value adjustment methods (used for multiple-hypothesis testing) found in <code>p.adjust.methods</code> (<code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"BH"</code>, <code>"bonferroni"</code>, <code>"BY"</code>, <code>"fdr"</code>, and <code>"none"</code>).  See help for <code>p.adjust</code> for more details on these methods.  <code>method</code> is only used if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_file">file</code></td>
<td>

<p>the file path for the <code>CSV</code> file to be written to.  If <code>frame=TRUE</code>, no CSV file is created.  If <code>frame=FALSE</code>, a CSV file will only be created if <code>file</code> is specified. 
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_test">test</code></td>
<td>

<p>a character string taking on <code>"Hartung"</code>, <code>"Stouffer"</code>, or <code>"Fisher"</code>.  This is the p-value combination method that will be used.  In most cases, &quot;Stouffer&quot; will be most appropriate, unless <code>adonis.tree</code> indicates significant evidence of dependence among p-values, in which case &quot;Hartung&quot; is preferred.
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_frame">frame</code></td>
<td>

<p>a logical argument that controls whether or not to return (in R) the resulting <code>data.frame</code> object. If FALSE, <code>file</code> must be specified.  
</p>
</td></tr>
<tr><td><code id="export.inherit_+3A_branch">branch</code></td>
<td>

<p>a character controlling branch definition: <code>"edge"</code> and <code>"node"</code> are the only options.  This does not affect statistical methods, only the colors used in edge coloring. Prior to package version 1.2, only <code>branch="node"</code> was implemented.  The edge and node numbering is internal to class <code>phylo</code>, and are not necessarily sequential numbers. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tip labels of <code>tree</code> (accessed via <code>tree$tip.label</code>) must have the same names (and the same length) as the tip labels in <code>unsorted.pvalues</code>, but may be in a different order.  The p-values in column 2 of <code>unsorted.pvalues</code> obviously must be in the [0, 1] range.  <code>export.inherit</code> assumes that each internal node has exactly two descendants.  It also assumes that each internal node has a lower number than each of its ancestors (excluding tips).
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function produces a <code>CSV</code> file; alternatively, if <code>frame=TRUE</code>, this function will return a <code>data.frame</code> object.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### To access the tutorial document for this package, type in R (not run here): 
# vignette("SigTree")

### Create tree, then data frame, then use plotSigTree to plot the tree
### Code for random tree and data frame
node.size &lt;- 10
seed &lt;- 109
# Create tree
set.seed(seed);
library(ape)
r.tree &lt;- rtree(node.size)
# Create p-values data frame
set.seed(seed)
r.pval &lt;- rbeta(node.size, .1, .1)
# Randomize the order of the tip labels
# (just to emphasize that labels need not be sorted)
set.seed(seed)
r.tip.label &lt;- sample(r.tree$tip.label, size=length(r.tree$tip.label))
r.pvalues &lt;- data.frame(label=r.tip.label, pval=r.pval)

# Check for dependence among p-values; lack of significance here
# indicates default test="Stouffer" is appropriate; 
# otherwise, test="Hartung" would be more appropriate.
adonis.tree(r.tree,r.pvalues)

# Create CSV file called "ExportInherit1.csv"
export.inherit(r.tree, r.pvalues, test="Stouffers", file="ExportInherit1.csv")

# Look at resulting file in R -- see package vignette
f &lt;- export.inherit(r.tree, r.pvalues, test="Stouffers", frame=TRUE)
f
</code></pre>

<hr>
<h2 id='p2.p1'>Function to convert two-tailed p-values to one-tailed, for use by other SigTree functions.
</h2><span id='topic+p2.p1'></span>

<h3>Description</h3>

<p><code>p2.p1</code> takes vectors <code>p</code> (representing two-sided p-values of null: Mean2=Mean1) and <code>diff</code> 
(representing Mean2-Mean1) and computes one-tailed p-values.  One-tailed p-values are used by
other SigTree functions, primarily <code>plotSigTree</code>, <code>export.figtree</code>, and <code>export.inherit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p2.p1(p,diff)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p2.p1_+3A_p">p</code></td>
<td>

<p>vector of two-tailed p-values, corresponding to a test of null: Mean2=Mean1.
</p>
</td></tr>
<tr><td><code id="p2.p1_+3A_diff">diff</code></td>
<td>

<p>vector of differences Mean2-Mean1, or a vector of the signs of the Mean2-Mean1 differences.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function has application when multiple tests (as at multiple OTUs) of some intervention have been performed,
such as comparing the mean of a treatment 2 with the mean of a treatment 1.  The resulting two-sided p-values
can be converted to one-sided p-values, so that the tools of the SigTree package are applicable.
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function produces a vector of one-sided p-values, corresponding to a test of null: Mean2=Mean1 vs. alternative: Mean2&gt;Mean1.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### To access the tutorial document for this package, type in R (not run here): 
# vignette('SigTree')

## Assume 10 OTUs are measured in each of
## 20 subjects receiving treatment 2, and
## 15 subjects receiving treatment 1.
## For each OTU, test null: Mean2=Mean1 
## using a Wilcoxon Rank Sum test.
## Simulate data, and obtain p-values and differences
set.seed(1234)
library(MASS)
X2 &lt;- mvrnorm(n=20, mu=runif(10), Sigma=diag(10))
X1 &lt;- mvrnorm(n=15, mu=runif(10), Sigma=diag(10))
p1.orig &lt;- p2 &lt;- diff &lt;- rep(NA,10)
for(i in 1:10)
 {
    p1.orig[i] &lt;- wilcox.test(X1[,i],X2[,i],
       alt='less', exact=FALSE)$p.value
    p2[i] &lt;- wilcox.test(X1[,i],X2[,i],
       exact=FALSE)$p.value
    diff[i] &lt;- mean(X2[,i]) - mean(X1[,i])
  }

## Convert two-sided p-values to one-sided
p1.new &lt;- p2.p1(p2,diff)

## Compare with 'original' one-sided p-values
plot(p1.new,p1.orig); abline(0,1)

</code></pre>

<hr>
<h2 id='plotSigTree'>Function to plot the phylogenetic tree in R with branches (tips) colored according to significance of families of p-values (tips' p-values)
</h2><span id='topic+plotSigTree'></span>

<h3>Description</h3>

<p><code>plotSigTree</code> takes <code>tree</code> and <code>unsorted.pvalues</code> and computes p-values for each branch (family
of tips) and colors the corresponding descendant branches.  It computes the p-values based on arguments 
involving p-value adjustment (for multiple hypothesis testing) and either Hartung's, Stouffer's, or Fisher's 
p-value combination method.  There are arguments that allow for the customization of the p-value cutoff 
ranges as well as the colors to be used in the coloring of the branches.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSigTree(tree, unsorted.pvalues, adjust=TRUE, side=1, 
	method="hommel", p.cutoffs=ifelse(rep(side==1, ifelse(side==1, 6, 3)),
	c(.01, .05, .1, .9, .95, .99), c(.01, .05, .1)),
	pal=ifelse(rep(side==1, ifelse(side==1, 1, length(p.cutoffs)+1)),
	"RdBu", rev(brewer.pal(length(p.cutoffs)+1,"Reds"))),
	test="Stouffer", branch.label=FALSE, tip.color=TRUE, edge.color=TRUE,
	tip.label.size=1, branch.label.size=1,  type="fan",
	use.edge.length=TRUE, edge.width=1, branch="edge", 
	root.edge=ifelse(type=="fan",FALSE,TRUE),
	branch.label.frame="none")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSigTree_+3A_tree">tree</code></td>
<td>

<p>a phylogenetic tree of class <code>phylo</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_unsorted.pvalues">unsorted.pvalues</code></td>
<td>

<p>a data frame (or matrix) with tip labels in column 1 and p-values in column 2.  The tip labels must correspond to the tip labels in <code>tree</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_adjust">adjust</code></td>
<td>

<p>a logical argument that controls whether there is p-value adjustment performed (<code>TRUE</code>) or not (<code>FALSE</code>).
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_side">side</code></td>
<td>

<p>a numerical argument that takes values <code>1</code> and <code>2</code>, depending on whether the p-values in <code>unsorted.pvalues</code> are 1-sided or 2-sided, respectively.  Only used in p-value adjustment if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_method">method</code></td>
<td>

<p>one of the p-value adjustment methods (used for multiple-hypothesis testing) found in <code>p.adjust.methods</code> (<code>"holm"</code>, <code>"hochberg"</code>, <code>"hommel"</code>, <code>"BH"</code>, <code>"bonferroni"</code>, <code>"BY"</code>, <code>"fdr"</code>, and <code>"none"</code>).  See help for <code>p.adjust</code> for more details on these methods.  <code>method</code> is only used if <code>adjust = TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_p.cutoffs">p.cutoffs</code></td>
<td>

<p>a vector of increasing p-value cutoffs (excluding 0 and 1) to determine the ranges of p-values used in the coloring of the branches.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_pal">pal</code></td>
<td>

<p>one of the palettes from the RColorBrewer package (see <code>brewer.pal.info</code> for a list) or a vector of hexadecimal colors (or other valid <code>R</code> colors).  These are the colors that are used to color the branches.  The first color corresponds to the first range in p.cutoffs and so on.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_test">test</code></td>
<td>

<p>a character string taking on <code>"Hartung"</code>, <code>"Stouffer"</code>, or <code>"Fisher"</code>.  This is the p-value combination method that will be used.  In most cases, &quot;Stouffer&quot; will be most appropriate, unless <code>adonis.tree</code> indicates significant evidence of dependence among p-values, in which case &quot;Hartung&quot; is preferred.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_branch.label">branch.label</code></td>
<td>

<p>a logical argument that controls whether the branches are labeled (<code>TRUE</code>) or not (<code>FALSE</code>). This results in either edges or nodes being labeled, depending on the <code>branch</code> argument.  The edge and node labeling is internal to class <code>phylo</code>, and are not necessarily sequential numbers.  When <code>branch="edge"</code> is used, the tip edges are not labeled (to avoid clutter).  Branch labels match those returned by <code>export.inherit</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_tip.color">tip.color</code></td>
<td>

<p>a logical argument that controls whether the tips are colored (<code>TRUE</code>) or not (<code>FALSE</code>). 
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_edge.color">edge.color</code></td>
<td>

<p>a logical argument that controls whether the edges are colored (<code>TRUE</code>) or not (<code>FALSE</code>). 
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_tip.label.size">tip.label.size</code></td>
<td>

<p>a numerical argument that controls the (cex) size of the text of the tip labels.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_branch.label.size">branch.label.size</code></td>
<td>

<p>a numerical argument that controls the (cex) size of the text of the branch labels (see <code>branch.label</code> argument).
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_type">type</code></td>
<td>

<p>a character string that controls which type of plot will be produced.  Possible values are <code>"phylogram"</code>, <code>"cladogram"</code>, <code>"fan"</code>, <code>"unrooted"</code>, and <code>"radial"</code>.  See <code>plot.phylo</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_use.edge.length">use.edge.length</code></td>
<td>

<p>a logical argument that uses the original edge lengths from <code>tree</code> (<code>TRUE</code>) or not (<code>FALSE</code>).  This has no effect if <code>tree</code> does not have edge lengths defined to begin with.  Can be affected by <code>root.edge</code>, depending on <code>type</code> (see <code>root.edge</code> below).
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_edge.width">edge.width</code></td>
<td>

<p>a numeric vector controlling width of plotted edges. This is passed to (<code>plot.phylo</code>).
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_branch">branch</code></td>
<td>

<p>a character controlling branch definition: <code>"edge"</code> and <code>"node"</code> are the only options.  This does not affect statistical methods, only the colors used in edge coloring. Prior to package version 1.2, only <code>branch="node"</code> was implemented.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_root.edge">root.edge</code></td>
<td>

<p>a logical argument that controls whether the root edge is plotted (<code>TRUE</code>) or not (<code>FALSE</code>). Note that <code>root.edge=TRUE</code> forces <code>use.edge.length=FALSE</code> when <code>type</code> is <code>"phylogram"</code>, <code>"cladogram"</code>, <code>"fan"</code>, or <code>"unrooted"</code>.
</p>
</td></tr>
<tr><td><code id="plotSigTree_+3A_branch.label.frame">branch.label.frame</code></td>
<td>

<p>a character controlling the frame around the branch labels (only used when <code>branch.label=TRUE</code>).  Only options <code>"none"</code>, <code>"circ"</code>, and <code>"rect"</code> are supported.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tip labels of <code>tree</code> (accessed via <code>tree$tip.label</code>) must have the same names (and the same length) as the tip labels in <code>unsorted.pvalues</code>, but may be in a different order.  The p-values in column 2 of <code>unsorted.pvalues</code> obviously must be in the [0, 1] range.  <code>p.cutoffs</code> takes values in the (0, 1) range.  The default value for <code>p.cutoffs</code> is <code>c(0.01, 0.05, 0.1, 0.9, 0.95, 0.99)</code> if <code>side</code> is <code>1</code> and <code>c(0.01, 0.05, 0.1)</code> if side is <code>2</code>.  Thus, the ranges (when side is <code>1</code>) are: [0, .01], (.01, .05], ..., (.99, 1].  These ranges correspond to the colors specified in <code>pal</code>.  P-values in the [0, .01] range correspond to the left-most color if <code>pal</code> is a palette (view this via <code>display.brewer.pal(x, pal)</code> - where <code>x</code> is the number of colors to be used) or the first value in the vector if <code>pal</code> is a vector of colors.  If <code>pal</code> is a vector of colors, then the length of <code>pal</code> should be one greater than the length of <code>p.cutoffs</code>.  In other words, its length must be the same as the number of p-value ranges.  An example of a color in hexadecimal format is <code>"#B2182B"</code>. The default value of <code>pal</code> is <code>"RdBu"</code> (a divergent palette of reds and blues, with reds corresponding to small p-values) if <code>side</code> is <code>1</code> and the reverse of <code>"Reds"</code> (a sequential palette) if <code>side</code> is 2.   The sequential palettes in <code>RColorBrewer</code> go from light to dark, so <code>"Reds"</code> is reversed so that the dark red corresponds to small p-values.    It probably makes more sense to use a divergent palette when using 1-sided p-values and a sequential palette (reversed) when using 2-sided p-values.  To create a vector of reversed colors from a palette with <code>x</code> number of colors and <code>"PaletteName"</code> as the name of the palette, use <code>rev(brewer.pal(x, "PaletteName"))</code>.  <code>use.edge.length</code> may be useful to get a more uniformly-shaped tree.  <code>plotSigTree</code> assumes that each internal node has exactly two descendants.  It also assumes that each internal node has a lower number than each of its ancestors (excluding tips).
</p>
<p>The <code>branch</code> argument controls whether edge coloring corresponds to the combined p-value of the tips below the edge (<code>"edge"</code>) or of the tips below the edge's leading (away from the tips) node (<code>"node"</code>).  Note that if <code>branch="node"</code> is used, then both edges leaving a node will necessarily be colored the same.
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Value</h3>

<p>This function produces a phylogenetic tree plot.
</p>


<h3>Note</h3>

<p>Extensive discussion of methods developed for this package are available in Jones (2012).  In that reference, (and prior to package version number 1.1), this <code>plotSigTree</code> function was named <code>plot.color</code>; the name change was made to resolve S3 class issues.
</p>
<p>For purposes of acknowledgments, it is worth noting here that the plotting done by <code>plotSigTree</code> relies internally on tools of the <code>ape</code> package (Paradis et al., 2004 Bioinformatics 20:289-290).  To accomodate edge-specific coloring (as with the <code>branch="edge"</code> option), some of these <code>ape</code> package tools were adapted and re-named in the <code>SigTree</code> package.  Specifically, see <code>?plotphylo2</code> and <code>?circularplot2</code>.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### To access the tutorial document for this package, type in R (not run here): 
# vignette('SigTree')

### Create tree, then data frame, then use plotSigTree to plot the tree
### Code for random tree and data frame
node.size &lt;- 10
seed &lt;- 109
# Create tree
set.seed(seed);
library(ape)
r.tree &lt;- rtree(node.size)
# Create p-values data frame
set.seed(seed)
r.pval &lt;- rbeta(node.size, .1, .1)
# Randomize the order of the tip labels
# (just to emphasize that labels need not be sorted)
set.seed(seed)
r.tip.label &lt;- sample(r.tree$tip.label, size=length(r.tree$tip.label))
r.pvalues &lt;- data.frame(label=r.tip.label, pval=r.pval)

# Check for dependence among p-values; lack of significance here
# indicates default test="Stouffer" is appropriate; 
# otherwise, test="Hartung" would be more appropriate.
adonis.tree(r.tree,r.pvalues)

# Plot tree in default 'fan' type, with branches labeled
plotSigTree(r.tree, r.pvalues, edge.width=4, branch.label=TRUE)

# Plot tree in 'phylogram' type, with branch labels circled
plotSigTree(r.tree, r.pvalues, edge.width=4, branch.label=TRUE,
  type='phylo', branch.label.frame='circ')
  
# Plot tree in 'phylogram' type, with branch labels circled,
# and assuming original p-values were for 2-sided test
plotSigTree(r.tree, r.pvalues, edge.width=4, branch.label=TRUE,
  type='phylo', branch.label.frame='circ', side=2)

# Plot tree in 'phylogram' type, with branch labels boxed;
# also give custom significance thresholds, and use
# a Purple-Orange palette (dark purple for low p-vals
# to dark orange for high p-vals)
plotSigTree(r.tree, r.pvalues, edge.width=4, branch.label=TRUE,
  type='phylo', branch.label.frame='rect',
  p.cutoffs=c(.01,.025,.975,.99), pal='PuOr')
  
</code></pre>

<hr>
<h2 id='SigTree-package'>
Determine significantly responsive branches in phylogenetic trees
</h2><span id='topic+SigTree-package'></span><span id='topic+SigTree'></span>

<h3>Description</h3>

<p><code>SigTree</code> is a package of functions to determine significant response of branches of phylogenetic trees and produce colored plots both in R and (via exported .tre file) FigTree.
<code><a href="#topic+plotSigTree">plotSigTree</a></code> takes a phylogenetic tree (of class phylo) and a data frame (or matrix) of corresponding tip (OTU) labels and p-values and determines the significance of the branches (as families of p-values) and plots the tree with colored branches (corresponding to families) according to the level of significance of the branch.  <code><a href="#topic+export.inherit">export.inherit</a></code> produces a CSV file (or data frame) with the p-values for all branches as well as which tips belong to which branches. <code><a href="#topic+export.figtree">export.figtree</a></code> exports a .tre file that can be opened in FigTree that produces a colored plot (with colors according to the significance of corresponding branches) with p-value annotations.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SigTree</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.10.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2017-09-29</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>For more information, see the documentation for 
<code><a href="#topic+plotSigTree">plotSigTree</a></code>, <code><a href="#topic+export.inherit">export.inherit</a></code>, and <code><a href="#topic+export.figtree">export.figtree</a></code>.
</p>
<p>To access the tutorial document for this package, type in R: <code>vignette("SigTree")</code>
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>
<p>Maintainer:
John R. Stevens &lt;john.r.stevens@usu.edu&gt;
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot; (2012). MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>
<p><code>FigTree</code> is available at <code>http://tree.bio.ed.ac.uk/software/figtree/</code>. 
</p>

<hr>
<h2 id='SigTree.other'>
SigTree Other Functions
</h2><span id='topic+num.edges'></span><span id='topic+num.tips'></span><span id='topic+num.internal.nodes'></span><span id='topic+num.total.nodes'></span><span id='topic+srt.pvalues'></span><span id='topic+stouffers'></span><span id='topic+fishers'></span><span id='topic+index.matrix'></span><span id='topic+p.p2.ADJ.p1'></span><span id='topic+result'></span><span id='topic+tip.colors'></span><span id='topic+edge.colors'></span><span id='topic+plotphylo2'></span><span id='topic+circularplot2'></span><span id='topic+hartung'></span><span id='topic+node_depthSigTree'></span><span id='topic+node_depth_edgelengthSigTree'></span><span id='topic+node_heightSigTree'></span><span id='topic+node_height_cladoSigTree'></span><span id='topic+R_init_SigTree'></span>

<h3>Description</h3>

<p>Internal functions used by the main functions of <code>SigTree</code> (<code>plotSigTree</code>, <code>export.figtree</code>, and <code>export.inherit</code>):
</p>

<table>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>num.edges</code>  </td><td style="text-align: left;"> determine the number of edges in <code>tree</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>num.tips</code>  </td><td style="text-align: left;"> determine the number of tips in <code>tree</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>num.internal.nodes</code>  </td><td style="text-align: left;"> determine the number of nodes in <code>tree</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>num.total.nodes</code>  </td><td style="text-align: left;"> determine the number of total nodes (internal + tips) in <code>tree</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>srt.pvalues</code>  </td><td style="text-align: left;"> sort <code>unsorted.pvalues</code> by tip labels (column 1) to be in same order as tip labels in <code>tree</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>stouffers</code>  </td><td style="text-align: left;"> perform Stouffer's Method on a vector of p-values; return one p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>fishers</code>  </td><td style="text-align: left;"> perform Fisher's Method on a vector of p-values; return one p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>index.matrix</code>  </td><td style="text-align: left;"> create matrix to identify the descendants/tips (rows) belonging to each node/family (column) </td>
</tr>
<tr>
 <td style="text-align: left;"> 
<code>p.p2.ADJ.p1</code>  </td><td style="text-align: left;"> convert 1-sided p-values to 2-sided, perform p-value adjustment (for multiple-hypothesis </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> testing), and convert back to 1-sided </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>result</code>  </td><td style="text-align: left;"> calculate p-values for each node/edge branch </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>tip.colors</code>  </td><td style="text-align: left;"> determine coloring of each tip </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>edge.colors</code>  </td><td style="text-align: left;"> determine coloring of each edge </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>plotphylo2</code>   </td><td style="text-align: left;"> (based on <code>ape</code> package's <code>plot.phylo</code> function); plots <code>tree</code> while allowing for different </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> edge coloring (root edge when <code>type="fan"</code>, and different colors for each half of the </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> "perpendicular-to-the-root" edges). Prior to package version 1.2, <code>plot.phylo</code> was used instead. </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> Beginning in package version 1.3 (to attain CRAN compatibility), includes .C calls to copies of four </td>
</tr>
<tr>
 <td style="text-align: left;">
                    </td><td style="text-align: left;"> <code>ape</code> .C functions (copied with credit under <code>ape</code>'s GPL license).</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>circularplot2</code> </td><td style="text-align: left;"> (based on <code>ape</code> package's <code>circular.plot</code> function) called by <code>phyloplot2</code> when <code>type="fan"</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>hartung</code> </td><td style="text-align: left;"> perform Hartung's Method on a vector of p-values; return one p-value </td>
</tr>
<tr>
 <td style="text-align: left;">
</td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Details</h3>

<p>It is assumed that each internal node has exactly two descendants.  It is also assumed that each internal node has a lower number than each of its ancestors (excluding tips).
</p>
<p>To access the tutorial document for this package (including this function), type in R: <code>vignette("SigTree")</code>
</p>


<h3>Note</h3>

<p>Extensive discussion of methods developed for this package are available in Jones (2012).  
In that reference, (and prior to package version number 1.1), the <code>srt.pvalues</code> function was named <code>sort.pvalues</code> (the name change was made to resolve S3 class issues), and <code>plotphylo2</code> was not available.
</p>


<h3>Author(s)</h3>

<p>John R. Stevens and Todd R. Jones
</p>


<h3>References</h3>

<p>Stevens J.R., Jones T.R., Lefevre M., Ganesan B., and Weimer B.C. (2017) &quot;SigTree: A Microbial Community Analysis Tool to Identify and Visualize Significantly Responsive Branches in a Phylogenetic Tree.&quot;  Computational and Structural Biotechnology Journal 15:372-378.
</p>
<p>Jones T.R. (2012) &quot;SigTree: An Automated Meta-Analytic Approach to Find Significant Branches in a Phylogenetic Tree&quot;  MS Thesis, Utah State University, Department of Mathematics and Statistics.  http://digitalcommons.usu.edu/etd/1314
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
