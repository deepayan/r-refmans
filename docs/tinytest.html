<!DOCTYPE html><html lang="en"><head><title>Help for package tinytest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tinytest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#at_home'><p>Detect not on CRANity</p></a></li>
<li><a href='#build_install_test'><p>build, install and test</p></a></li>
<li><a href='#exit_file'><p>Stop testing (conditionally)</p></a></li>
<li><a href='#expect_equal'><p>Express expectations</p></a></li>
<li><a href='#expect_equal_to_reference'><p>Compare object with object stored in a file</p></a></li>
<li><a href='#expect_length'><p>Check length of an object</p></a></li>
<li><a href='#expect_match'><p>Match strings to a regular expression</p></a></li>
<li><a href='#format.tinytest'><p>Print a tinytest object</p></a></li>
<li><a href='#get_call_wd'><p>Get workding dir from where a test was initiated</p></a></li>
<li><a href='#ignore'><p>Ignore the output of an expectation</p></a></li>
<li><a href='#puppy'><p>The puppy for a pkgKitten</p></a></li>
<li><a href='#register_tinytest_extension'><p>Register or unregister extension functions</p></a></li>
<li><a href='#report_side_effects'><p>Report side effects for expressions in test files</p></a></li>
<li><a href='#run_test_dir'><p>Run all tests in a directory</p></a></li>
<li><a href='#run_test_file'><p>Run an R file containing tests; gather results</p></a></li>
<li><a href='#setup_tinytest'><p>Add tinytest to package source directory</p></a></li>
<li><a href='#summary.tinytests'><p>Tinytests object</p></a></li>
<li><a href='#test_package'><p>Test a package during R CMD check or after installation</p></a></li>
<li><a href='#tinytest'><p>Tinytest constructor</p></a></li>
<li><a href='#using'><p>Use an extension package.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Maintainer:</td>
<td>Mark van der Loo &lt;mark.vanderloo@gmail.com&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Title:</td>
<td>Lightweight and Feature Complete Unit Testing Framework</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a lightweight (zero-dependency) and easy to use 
    unit testing framework. Main features: install tests with 
    the package. Test results are treated as data that can be stored and 
    manipulated. Test files are R scripts interspersed with test commands, that
    can be programmed over. Fully automated build-install-test sequence for 
    packages. Skip tests when not run locally (e.g. on CRAN). Flexible and 
    configurable output printing. Compare computed output with output stored 
    with the package. Run tests in parallel. Extensible by other packages.
    Report side effects.</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/markvanderloo/tinytest">https://github.com/markvanderloo/tinytest</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/markvanderloo/tinytest/issues">https://github.com/markvanderloo/tinytest/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, utils</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-21 13:59:53 UTC; mark</td>
</tr>
<tr>
<td>Author:</td>
<td>Mark van der Loo <a href="https://orcid.org/0000-0002-9807-4686"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-22 00:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='at_home'>Detect not on CRANity</h2><span id='topic+at_home'></span>

<h3>Description</h3>

<p>Detect whether we are running at home (i.e. not on CRAN, BioConductor, ...)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>at_home()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'># test will run locally, but not on CRAN
if ( at_home() ){
  expect_equal(2, 1+1)
}
</code></pre>

<hr>
<h2 id='build_install_test'>build, install and test</h2><span id='topic+build_install_test'></span>

<h3>Description</h3>

<p>Builds and installs the package in <code>pkgdir</code> under a temporary
directory.  Next, loads the package in a fresh R session and runs all the
tests. For this function to work the following system requirements are
necessary.
</p>

<ul>
<li><p><code>R CMD build</code> is available on your system
</p>
</li>
<li><p><code>Rscript</code> is available on your system
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>build_install_test(
  pkgdir = "./",
  testdir = "tinytest",
  pattern = "^test.*\\.[rR]$",
  at_home = TRUE,
  verbose = getOption("tt.verbose", 2),
  color = getOption("tt.pr.color", TRUE),
  ncpu = 1,
  remove_side_effects = TRUE,
  side_effects = FALSE,
  lc_collate = getOption("tt.collate", NA),
  keep_tempdir = FALSE,
  encoding = "unknown"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_install_test_+3A_pkgdir">pkgdir</code></td>
<td>
<p><code>[character]</code> Package directory</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_testdir">testdir</code></td>
<td>
<p><code>[character]</code> Name of directory under <code>pkgdir/inst</code>
containing test files.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_pattern">pattern</code></td>
<td>
<p><code>[character]</code> A regular expression that is used to find
scripts in <code>dir</code> containing tests (by default <code>.R</code> or <code>.r</code>
files starting with <code>test</code>).</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_at_home">at_home</code></td>
<td>
<p><code>[logical]</code> toggle local tests.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_verbose">verbose</code></td>
<td>
<p><code>[logical]</code> toggle verbosity during execution</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_color">color</code></td>
<td>
<p><code>[logical]</code> toggle colorize output</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_ncpu">ncpu</code></td>
<td>
<p><code>[numeric]</code> number of CPUs to use during the testing phase.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_remove_side_effects">remove_side_effects</code></td>
<td>
<p><code>[logical]</code> toggle remove user-defined side
effects? See section on side effects.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_side_effects">side_effects</code></td>
<td>
<p><code>[logical|list]</code> Either a logical,
or a list of arguments to pass to <code><a href="#topic+report_side_effects">report_side_effects</a></code>.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_lc_collate">lc_collate</code></td>
<td>
<p><code>[character]</code> Locale setting used to sort the
test files into the order of execution. The default <code>NA</code> ensures
current locale is used. Set this e.g. to <code>"C"</code> to ensure bytewise
and more platform-independent sorting (see details in <code><a href="#topic+run_test_dir">run_test_dir</a></code>.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_keep_tempdir">keep_tempdir</code></td>
<td>
<p><code>[logical]</code> keep directory where the pkg is
installed and where tests are run? If <code>TRUE</code>, the directory is not
deleted and it's location is printed.</p>
</td></tr>
<tr><td><code id="build_install_test_+3A_encoding">encoding</code></td>
<td>
<p><code>[character]</code> Encoding parameter passed to <code><a href="base.html#topic+parse">parse</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tinytests</code> object.
</p>


<h3>See Also</h3>

<p>Other test-files: 
<code><a href="#topic+exit_file">exit_file</a>()</code>,
<code><a href="#topic+run_test_dir">run_test_dir</a>()</code>,
<code><a href="#topic+run_test_file">run_test_file</a>()</code>,
<code><a href="#topic+summary.tinytests">summary.tinytests</a>()</code>,
<code><a href="#topic+test_package">test_package</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  ## If your package source directory is "./pkg" you can run
  build_install_test("pkg")

## End(Not run)
</code></pre>

<hr>
<h2 id='exit_file'>Stop testing (conditionally)</h2><span id='topic+exit_file'></span><span id='topic+exit_if_not'></span>

<h3>Description</h3>

<p>Use <code>exit_file</code> to exit a file with a custom message, or use
<code>exit_if</code> to exit if one or more conditions are met. <code>exit_if</code>
will create a message akin to messages created by <code><a href="base.html#topic+stopifnot">stopifnot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exit_file(msg = "")

exit_if_not(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exit_file_+3A_msg">msg</code></td>
<td>
<p><code>[character]</code> An optional message to print after exiting.</p>
</td></tr>
<tr><td><code id="exit_file_+3A_...">...</code></td>
<td>
<p>A comma-separated list of conditions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The exit message
</p>


<h3>See Also</h3>

<p>Other test-files: 
<code><a href="#topic+build_install_test">build_install_test</a>()</code>,
<code><a href="#topic+run_test_dir">run_test_dir</a>()</code>,
<code><a href="#topic+run_test_file">run_test_file</a>()</code>,
<code><a href="#topic+summary.tinytests">summary.tinytests</a>()</code>,
<code><a href="#topic+test_package">test_package</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>exit_file("I'm too tired to test")
exit_if_not(packageVersion("tinytest")  &gt;= "1.0.0")
## Not run: 
exit_if_not(requireNamespace("foo",quietly=TRUE))

## End(Not run)
</code></pre>

<hr>
<h2 id='expect_equal'>Express expectations</h2><span id='topic+expect_equal'></span><span id='topic+expect_identical'></span><span id='topic+expect_equivalent'></span><span id='topic+expect_true'></span><span id='topic+expect_false'></span><span id='topic+expect_silent'></span><span id='topic+expect_null'></span><span id='topic+expect_inherits'></span><span id='topic+expect_error'></span><span id='topic+expect_warning'></span><span id='topic+expect_message'></span><span id='topic+expect_stdout'></span>

<h3>Description</h3>

<p>Express expectations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_equal(
  current,
  target,
  tolerance = sqrt(.Machine$double.eps),
  info = NA_character_,
  ...
)

expect_identical(current, target, info = NA_character_)

expect_equivalent(
  current,
  target,
  tolerance = sqrt(.Machine$double.eps),
  info = NA_character_,
  ...
)

expect_true(current, info = NA_character_)

expect_false(current, info = NA_character_)

expect_silent(current, quiet = TRUE, info = NA_character_)

expect_null(current, info = NA_character_)

expect_inherits(current, class, info = NA_character_)

expect_error(
  current,
  pattern = ".*",
  class = "error",
  info = NA_character_,
  ...
)

expect_warning(
  current,
  pattern = ".*",
  class = "warning",
  info = NA_character_,
  strict = FALSE,
  ...
)

expect_message(
  current,
  pattern = ".*",
  class = "message",
  info = NA_character_,
  strict = FALSE,
  ...
)

expect_stdout(current, pattern = ".*", info = NA_character_, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expect_equal_+3A_current">current</code></td>
<td>
<p><code>[R object or expression]</code> Outcome or expression under scrutiny.</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_target">target</code></td>
<td>
<p><code>[R object or expression]</code> Expected outcome</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_tolerance">tolerance</code></td>
<td>
<p><code>[numeric]</code> Test equality to machine rounding. Passed
to <code><a href="base.html#topic+all.equal">all.equal</a> (tolerance)</code></p>
</td></tr>
<tr><td><code id="expect_equal_+3A_info">info</code></td>
<td>
<p><code>[character]</code> scalar. Optional user-defined message. Must
be a single character string. Multiline comments may be separated by
<code>"\n"</code>.</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_...">...</code></td>
<td>
<p>passed on to <code><a href="base.html#topic+grepl">grepl</a></code> (useful for e.g. <code>fixed=TRUE</code>).</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_quiet">quiet</code></td>
<td>
<p><code>[logical]</code> suppress output printed by the <code>current</code> 
expression (see examples)</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_class">class</code></td>
<td>
<p><code>[character]</code> For condition signals (error, warning, message)
the class from which the condition should inherit.</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_pattern">pattern</code></td>
<td>
<p><code>[character]</code> A regular expression to match the message.</p>
</td></tr>
<tr><td><code id="expect_equal_+3A_strict">strict</code></td>
<td>
<p><code>[logical]</code> scalar. If set to <code>TRUE</code>, any exception 
worse than the wanted exception will cause the test to fail.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>expect_equivalent</code> calls <code>expect_equal</code> with the extra
arguments <code>check.attributes=FALSE</code> and <code>use.names=FALSE</code>
</p>
<p><code>expect_silent</code> fails when an error or warning is thrown.
</p>
<p><code>expect_inherits</code> fails when <code><a href="base.html#topic+inherits">inherits</a>(current,class)</code> returns <code>FALSE</code>
</p>
<p><code>expect_stdout</code> Expects that output is written to <code>stdout</code>,
for example using <code>cat</code> or <code>print</code>. Use <code>pattern</code> to
specify a regular expression matching the output.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+tinytest">tinytest</a></code> object. A tinytest object is a
<code>logical</code> with attributes holding information about the
test that was run
</p>


<h3>More information and examples</h3>


<ul>
<li><p>An overview of tinytest can be found in <code>vignette("using_tinytest")</code>.
</p>
</li>
<li><p>Examples of how tinytest is used in practice can be found in
<code>vignette("tinytest_examples")</code>
</p>
</li></ul>



<h3>Note</h3>

<p>Each <code>expect_haha</code> function can also be called as <code>checkHaha</code>.
Although the interface is not entirely the same, it is expected that
this makes migration from the <code>RUnit</code> framework a little easier, for those
who wish to do so.
</p>
<p><code>expect_error</code>, <code>expect_warning</code> and <code>expect_message</code> will
concatenate all messages when multiple exceptions are thrown, before
matching the message to <code>pattern</code>.
</p>
<p>When speccifying regular expression patterns for errors, warnings or messages,
note that <code><a href="base.html#topic+message">message</a></code> adds a LF character by default at the end
of the message string.
</p>


<h3>See Also</h3>

<p>Other test-functions: 
<code><a href="#topic+expect_equal_to_reference">expect_equal_to_reference</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+ignore">ignore</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_equal(1 + 1, 2)       # TRUE
expect_equal(1 - 1, 2)       # FALSE
expect_equivalent(2, c(x=2)) # TRUE
expect_equal(2, c(x=2))      # FALSE


expect_silent(1+1)           # TRUE
expect_silent(1+"a")         # FALSE
expect_silent(print("hihi")) # TRUE, nothing goes to screen
expect_silent(print("hihi"), quiet=FALSE) # TRUE, and printed

</code></pre>

<hr>
<h2 id='expect_equal_to_reference'>Compare object with object stored in a file</h2><span id='topic+expect_equal_to_reference'></span><span id='topic+expect_equivalent_to_reference'></span>

<h3>Description</h3>

<p>Compares the current value with a value stored to file with
<code><a href="base.html#topic+saveRDS">saveRDS</a></code>.  If the  file does not exist, the current value is
stored into file, and the test returns <code>expect_null(NULL)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_equal_to_reference(current, file, ...)

expect_equivalent_to_reference(current, file, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expect_equal_to_reference_+3A_current">current</code></td>
<td>
<p><code>[R object or expression]</code> Outcome or expression under 
scrutiny.</p>
</td></tr>
<tr><td><code id="expect_equal_to_reference_+3A_file">file</code></td>
<td>
<p><code>[character]</code> File where the <code>target</code> is stored. If 
<code>file</code> does not exist, <code>current</code> will be stored there.</p>
</td></tr>
<tr><td><code id="expect_equal_to_reference_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+expect_equal">expect_equal</a></code>, respectively <code><a href="#topic+expect_equivalent">expect_equivalent</a></code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Be aware that on CRAN it is not allowed to write data to user space. So make
sure that the file is either stored with your tests, or generated with
<code><a href="base.html#topic+tempfile">tempfile</a></code>, or the test is skipped on CRAN, using
<code><a href="#topic+at_home">at_home</a></code>.
</p>
<p><code><a href="#topic+build_install_test">build_install_test</a></code> clones the package and
builds and tests it in a separate R session in the background. This means
that if you create a file located at <code>tempfile()</code> during the run, this
file is destroyed when the separate R session is closed.
</p>


<h3>See Also</h3>

<p>Other test-functions: 
<code><a href="#topic+expect_equal">expect_equal</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+ignore">ignore</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filename &lt;- tempfile()
# this gives TRUE: the file does not exist, but is created now.
expect_equal_to_reference(1, file=filename)
# this gives TRUE: the file now exists, and its contents is equal
# to the current value
expect_equal_to_reference(1, file=filename)
# this gives FALSE: the file exists, but is contents is not equal
# to the current value
expect_equal_to_reference(2, file=filename)

</code></pre>

<hr>
<h2 id='expect_length'>Check length of an object</h2><span id='topic+expect_length'></span>

<h3>Description</h3>

<p>Check length of an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_length(current, length, info = NA_character_, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expect_length_+3A_current">current</code></td>
<td>
<p><code>[object]</code> An R object with a length</p>
</td></tr>
<tr><td><code id="expect_length_+3A_length">length</code></td>
<td>
<p><code>[integer]</code> A nonnegative integer</p>
</td></tr>
<tr><td><code id="expect_length_+3A_info">info</code></td>
<td>
<p><code>[character]</code> scalar. Optional user-defined message. Must
be a single character string. Multiline comments may be separated by</p>
</td></tr>
<tr><td><code id="expect_length_+3A_...">...</code></td>
<td>
<p>Currently not used.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other test-functions: 
<code><a href="#topic+expect_equal_to_reference">expect_equal_to_reference</a>()</code>,
<code><a href="#topic+expect_equal">expect_equal</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>,
<code><a href="#topic+ignore">ignore</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_length(3:4, 2) # TRUE
expect_length(2:5, 1) # FALSE

</code></pre>

<hr>
<h2 id='expect_match'>Match strings to a regular expression</h2><span id='topic+expect_match'></span>

<h3>Description</h3>

<p>Results in <code>TRUE</code> only when all elements of current match the regular
expression in <code>pattern</code>. Matching is done by <code><a href="base.html#topic+grepl">grepl</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expect_match(current, pattern, info = NA_character_, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expect_match_+3A_current">current</code></td>
<td>
<p><code>[character]</code> String(s) to check for <code>pattern</code>.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_pattern">pattern</code></td>
<td>
<p><code>[character]</code> A regular expression.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_info">info</code></td>
<td>
<p><code>[character]</code> scalar. Optional user-defined message. Must
be a single character string. Multiline comments may be separated by
<code>"\n"</code>.</p>
</td></tr>
<tr><td><code id="expect_match_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="base.html#topic+grepl">grepl</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other test-functions: 
<code><a href="#topic+expect_equal_to_reference">expect_equal_to_reference</a>()</code>,
<code><a href="#topic+expect_equal">expect_equal</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+ignore">ignore</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>expect_match("hello world", "world")                    # TRUE
expect_match("hello world", "^world$")                  # FALSE
expect_match("HelLO woRlD", "world", ignore.case=TRUE)  # TRUE
expect_match(c("apple","banana"), "a")                  # TRUE
expect_match(c("apple","banana"), "b")                  # FALSE

</code></pre>

<hr>
<h2 id='format.tinytest'>Print a tinytest object</h2><span id='topic+format.tinytest'></span><span id='topic+print.tinytest'></span>

<h3>Description</h3>

<p>Print a tinytest object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tinytest'
format(x, type = c("long", "short"), ...)

## S3 method for class 'tinytest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format.tinytest_+3A_x">x</code></td>
<td>
<p>A <code>tinytest</code> object</p>
</td></tr>
<tr><td><code id="format.tinytest_+3A_type">type</code></td>
<td>
<p><code>[logical]</code> Toggle format type</p>
</td></tr>
<tr><td><code id="format.tinytest_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+format.tinytest">format.tinytest</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tt &lt;- expect_equal(1+1, 3)
format(tt,"long")
format(tt,"short")
print(expect_equal(1+1, 2))
print(expect_equal(1+1, 3), type="long")

</code></pre>

<hr>
<h2 id='get_call_wd'>Get workding dir from where a test was initiated</h2><span id='topic+get_call_wd'></span>

<h3>Description</h3>

<p>A test runner, like <code><a href="#topic+run_test_file">run_test_file</a></code> changes
R's working directory to the location of the test file temporarily 
while the tests run. This function can be used from within the
test file to get R's working directory at the time <code>run_test_file</code> 
(or one of it's siblings)
was called.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_call_wd()
</code></pre>


<h3>Value</h3>

<p><code>[character]</code> A path.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_call_wd()
</code></pre>

<hr>
<h2 id='ignore'>Ignore the output of an expectation</h2><span id='topic+ignore'></span>

<h3>Description</h3>

<p>Ignored expectations are not reported in the test results.
Ignoring is only useful for test files, and not for use directly
at the command-line. See also the package vignette: <code>vignette("using_tinytest")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ignore(fun)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ignore_+3A_fun">fun</code></td>
<td>
<p><code>[function]</code> An <code>expect_</code> function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An ignored <code>function</code>
</p>


<h3>Details</h3>

<p><code>ignore</code> is a higher-order function: a function that returns another function.
In particular, it accepts a function and returns a function that is almost identical
to the input function. The only difference is that the return value of the function
returned by <code>ignore</code> is not caught by <code><a href="#topic+run_test_file">run_test_file</a></code> and friends. 
For example, <code>ignore(expect_true)</code> is a function, and we can use it as 
<code>ignore(expect_true)( 1 == 1)</code>. The return value of <code>ignore(expect_true)(1==1)</code>
is exactly the same as that for <code>expect_true(1==1)</code>.
</p>


<h3>See Also</h3>

<p>Other test-functions: 
<code><a href="#topic+expect_equal_to_reference">expect_equal_to_reference</a>()</code>,
<code><a href="#topic+expect_equal">expect_equal</a>()</code>,
<code><a href="#topic+expect_length">expect_length</a>()</code>,
<code><a href="#topic+expect_match">expect_match</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
   ## The result of 'expect_warning' is not stored in the test result when
   ## this is run from a file.
   expect_true( ignore(expect_warning)(warning("foo!")) )
   ## Note the placement of the brackets in ignore(expect_warning)(...).
 


</code></pre>

<hr>
<h2 id='puppy'>The puppy for a pkgKitten</h2><span id='topic+puppy'></span>

<h3>Description</h3>

<p>Does exactly the same as <code><a href="#topic+setup_tinytest">setup_tinytest</a></code>, but prints 
a loving message aferwards (and who doesn't want that!?). Just
think about those puppies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>puppy(pkgdir, force = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="puppy_+3A_pkgdir">pkgdir</code></td>
<td>
<p><code>[character]</code> Package source directory</p>
</td></tr>
<tr><td><code id="puppy_+3A_force">force</code></td>
<td>
<p><code>[logical]</code> Toggle overwrite existing files? (not folders)</p>
</td></tr>
<tr><td><code id="puppy_+3A_verbose">verbose</code></td>
<td>
<p><code>[logical]</code> Toggle print progress</p>
</td></tr>
</table>

<hr>
<h2 id='register_tinytest_extension'>Register or unregister extension functions</h2><span id='topic+register_tinytest_extension'></span>

<h3>Description</h3>

<p>Functions to use in <code>.onLoad</code> and <code>.onUnload</code> by packages that
extend <span class="pkg">tinytest</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_tinytest_extension(pkg, functions)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="register_tinytest_extension_+3A_pkg">pkg</code></td>
<td>
<p><code>[character]</code> scalar. Name of the package providing extensions.</p>
</td></tr>
<tr><td><code id="register_tinytest_extension_+3A_functions">functions</code></td>
<td>
<p><code>[character]</code> vector. Name of the functions in the package that must be added.</p>
</td></tr>
</table>


<h3>The tinytest API</h3>

<p>Packages can extend <span class="pkg">tinytest</span> with expectation functions <em>if and only
if</em> the following requirements are satisfied.
</p>

<ol>
<li><p>The extending functions return a <code><a href="#topic+tinytest">tinytest</a></code> object.  This 
can be created by calling <code>tinytest()</code> with the arguments (defaults,
if any, are in brackets):
</p>

<ul>
<li><p><code>result</code>: A <code>logical</code> scalar: <code>TRUE</code> or <code>FALSE</code> (not
<code>NA</code>) 
</p>
</li>
<li><p><code>call</code>: The <code>call</code> to the expectation function. Usually the 
result of <code>sys.call(sys.parent(1))</code> 
</p>
</li>
<li><p><code>diff</code> (<code>NA_character_</code>): A <code>character</code> scalar, with a long description of the 
difference. Sentences may be separated by <code>"\n"</code>.
</p>
</li>
<li><p><code>short</code> (<code>NA_character_</code>): Either <code>"data"</code>, if the difference is in the 
data. <code>"attr"</code> when attributes differ or <code>"xcpt"</code> when 
an expectation about an exception is not met. If there are 
differences in data and in attributes, the attributes take 
precedence.
</p>
</li>
<li><p><code>info</code> (<code>NA_character_</code>): A user-defined message.
</p>
</li></ul>

<p>Observe that this requires the extending package to add <span class="pkg">tinytest</span> to 
the <code>Imports</code> field in the package's <code>DESCRIPTION</code> file (this 
also holds for the following requirement). 

</p>
</li>
<li><p>Functions are registered in <code>.onLoad()</code> using 
<code>register_tinytest_extension()</code>. Functions that are already 
registered, including <span class="pkg">tinytest</span> functions will be overwritten.
</p>
</li></ol>

<p>It is <em>recommended</em> to:
</p>

<ol>
<li><p>Follow the syntax conventions of <span class="pkg">tinytest</span> so expectation 
functions start with <code>expect_</code>.
</p>
</li>
<li><p>Explain to users of the extension package how to use the extension 
(see <code><a href="#topic+using">using</a></code>).
</p>
</li>
<li><p>include an <code>info</code> argument to <code>expect_</code> functions that 
is passed to <code>tinytest()</code>.
</p>
</li></ol>



<h3>Minimal example packages</h3>


<ul>
<li><p>Extending <span class="pkg">tinytest</span>:
<a href="https://github.com/markvanderloo/tinytest.extension">tinytest.extension</a>.
</p>
</li>
<li><p>Using a <span class="pkg">tinytest</span> extension:
<a href="https://github.com/markvanderloo/uses.tinytest.extension">using.tinytest.extension</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p>Other extensions: 
<code><a href="#topic+tinytest">tinytest</a>()</code>,
<code><a href="#topic+using">using</a>()</code>
</p>

<hr>
<h2 id='report_side_effects'>Report side effects for expressions in test files</h2><span id='topic+report_side_effects'></span>

<h3>Description</h3>

<p>Call this function from within a test file to report side effects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>report_side_effects(
  report = TRUE,
  envvar = report,
  pwd = report,
  files = report,
  locale = report
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="report_side_effects_+3A_report">report</code></td>
<td>
<p><code>[logical]</code> report all side-effects</p>
</td></tr>
<tr><td><code id="report_side_effects_+3A_envvar">envvar</code></td>
<td>
<p><code>[logical]</code> changes in environment variables</p>
</td></tr>
<tr><td><code id="report_side_effects_+3A_pwd">pwd</code></td>
<td>
<p><code>[logical]</code> changes in working directory</p>
</td></tr>
<tr><td><code id="report_side_effects_+3A_files">files</code></td>
<td>
<p><code>[logical]</code> changes in files in the directory where the
test file lives. Also watches subdirectories.</p>
</td></tr>
<tr><td><code id="report_side_effects_+3A_locale">locale</code></td>
<td>
<p><code>[logical]</code> Changes in locale settings as detected by 
<code>link[base]{Sys.getlocale}</code> are reported.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>logical</code>, indicating which aspects of the environment
are tracked, invisibly.
</p>


<h3>Details</h3>

<p>A side effect causes a change in an external variable outside of the scope
of a function, or test file. This includes environment variables, global
options, global R variables, creating files or directories, and so on.
</p>
<p>If this function is called in a test file, side effects are monitored from
that point in the file and only for that file. The state of the environment
before and after running every expression in the file are compared.
</p>
<p>There is some performance penalty in tracking external variables, especially
for those that require a system call.
</p>


<h3>Note</h3>

<p>There could be side-effects that are untrackable by <span class="pkg">tinytest</span>. This includes
packages that use a global internal state within their namespace or packages
that use a global state within compiled code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># switch on
report_side_effects()
# switch off
report_side_effects(FALSE)

# only report changes in environment variables
report_side_effects(report=FALSE, envvar=TRUE)

</code></pre>

<hr>
<h2 id='run_test_dir'>Run all tests in a directory</h2><span id='topic+run_test_dir'></span><span id='topic+test_all'></span>

<h3>Description</h3>

<p><code>run\_test\_dir</code> runs all test files in a directory.
</p>
<p><code>test_all</code> is a convenience function for package development, that
wraps <code>run_test_dir</code>. By default, it runs all files starting with
<code>test</code> in <code>./inst/tinytest/</code>.  It is assumed that all functions to
be tested are loaded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_test_dir(
  dir = "inst/tinytest",
  pattern = "^test.*\\.[rR]$",
  at_home = TRUE,
  verbose = getOption("tt.verbose", 2),
  color = getOption("tt.pr.color", TRUE),
  remove_side_effects = TRUE,
  cluster = NULL,
  lc_collate = getOption("tt.collate", NA),
  ...
)

test_all(pkgdir = "./", testdir = "inst/tinytest", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_test_dir_+3A_dir">dir</code></td>
<td>
<p><code>[character]</code> path to directory</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_pattern">pattern</code></td>
<td>
<p><code>[character]</code> A regular expression that is used to find
scripts in <code>dir</code> containing tests (by default <code>.R</code> or <code>.r</code>
files starting with <code>test</code>).</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_at_home">at_home</code></td>
<td>
<p><code>[logical]</code> toggle local tests.</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_verbose">verbose</code></td>
<td>
<p><code>[logical]</code> toggle verbosity during execution</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_color">color</code></td>
<td>
<p><code>[logical]</code> toggle colorize output</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_remove_side_effects">remove_side_effects</code></td>
<td>
<p><code>[logical]</code> toggle remove user-defined side 
effects. Environment variables (<code>Sys.setenv()</code>) and options (<code>options()</code>)
defined in a test file are reset before running the next test file (see details).</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_cluster">cluster</code></td>
<td>
<p>A <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> object.</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_lc_collate">lc_collate</code></td>
<td>
<p><code>[character]</code> Locale setting used to sort the
test files into the order of execution. The default <code>NA</code> ensures
current locale is used. Set this e.g. to <code>"C"</code> to ensure bytewise
and more platform-independent sorting (see details).</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code>run_test_file</code></p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_pkgdir">pkgdir</code></td>
<td>
<p><code>[character]</code> scalar. Root directory of the package (i.e.
direcory where <code>DESCRIPTION</code> and <code>NAMESPACE</code> reside).</p>
</td></tr>
<tr><td><code id="run_test_dir_+3A_testdir">testdir</code></td>
<td>
<p><code>[character]</code> scalar. Subdirectory where test files are
stored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tinytests</code> object
</p>


<h3>Details</h3>

<p>We cannot guarantee that files will be run in any particular order accross
all platforms, as it depends on the available collation charts (a chart that
determines how alphabets are sorted).  For this reason it is a good idea to
create test files that run independent of each other so their order of
execution does not matter. In tinytest, test files cannot share variables.
The default behavior of test runners further discourages interdependence by
resetting environment variables and options that are set in a test file
after the file is executed. If an environment variable needs to survive a
single file, use <code>base::Sys.setenv()</code> explicitly.  Similarly, if an
option setting needs to survive, use <code>base::options()</code>
</p>


<h3>Parallel tests</h3>

<p>If <code>inherits(cluster, "cluster")</code> the tests are paralellized over a
cluster of worker nodes. <span class="pkg">tinytest</span> will be loaded onto each cluster
node. All other preparation, including loading code from the tested package,
must be done by the user. It is also up to the user to clean up the cluster
after running tests. See the 'using tinytest' vignette for examples:
<code>vignette("using_tinytest")</code>.
</p>


<h3>See Also</h3>

<p><code><a href="parallel.html#topic+makeCluster">makeCluster</a></code>,
<code><a href="parallel.html#topic+clusterEvalQ">clusterEvalQ</a></code>, <code><a href="parallel.html#topic+clusterExport">clusterExport</a></code>
</p>
<p>Other test-files: 
<code><a href="#topic+build_install_test">build_install_test</a>()</code>,
<code><a href="#topic+exit_file">exit_file</a>()</code>,
<code><a href="#topic+run_test_file">run_test_file</a>()</code>,
<code><a href="#topic+summary.tinytests">summary.tinytests</a>()</code>,
<code><a href="#topic+test_package">test_package</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a test file in tempdir
tests &lt;- "
addOne &lt;- function(x) x + 2

expect_true(addOne(0) &gt; 0)
expect_equal(2, addOne(1))
"
testfile &lt;- tempfile(pattern="test_", fileext=".R")
write(tests, testfile)

# extract testdir
testdir &lt;- dirname(testfile)
# run all files starting with 'test' in testdir
out &lt;- run_test_dir(testdir)
print(out)
dat &lt;- as.data.frame(out)

</code></pre>

<hr>
<h2 id='run_test_file'>Run an R file containing tests; gather results</h2><span id='topic+run_test_file'></span>

<h3>Description</h3>

<p>Run an R file containing tests; gather results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run_test_file(
  file,
  at_home = TRUE,
  verbose = getOption("tt.verbose", 2),
  color = getOption("tt.pr.color", TRUE),
  remove_side_effects = TRUE,
  side_effects = FALSE,
  set_env = list(),
  encoding = "unknown",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run_test_file_+3A_file">file</code></td>
<td>
<p><code>[character]</code> File location of a .R file.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_at_home">at_home</code></td>
<td>
<p><code>[logical]</code> toggle local tests.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_verbose">verbose</code></td>
<td>
<p><code>[integer]</code> verbosity level. 0: be quiet, 1: print
status per file, 2: print status and increase counter after each test expression.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_color">color</code></td>
<td>
<p><code>[logical]</code> toggle colorize counts in verbose mode (see Note)</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_remove_side_effects">remove_side_effects</code></td>
<td>
<p><code>[logical]</code> toggle remove user-defined side
effects? See section on side effects.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_side_effects">side_effects</code></td>
<td>
<p><code>[logical|list]</code> Either a logical,
or a list of arguments to pass to <code><a href="#topic+report_side_effects">report_side_effects</a></code>.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_set_env">set_env</code></td>
<td>
<p><code>[named list]</code>. Key=value pairs of environment variables
that will be set before the test file is run and reset afterwards. These are not
counted as side effects of the code under scrutiny.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_encoding">encoding</code></td>
<td>
<p><code>[character]</code> Define encoding argument passed to <code><a href="base.html#topic+parse">parse</a></code>
when parsing <code>file</code>.</p>
</td></tr>
<tr><td><code id="run_test_file_+3A_...">...</code></td>
<td>
<p>Currently unused</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In <span class="pkg">tinytest</span>, a test file is just an R script where some or all
of the statements express an <code><a href="#topic+expect_equal">expectation</a></code>.
<code>run_test_file</code> runs the file while gathering results of the
expectations in a <code><a href="#topic+tinytests">tinytests</a></code> object.
</p>
<p>The graphics device is set to <code>pdf(file=tempfile())</code> for the run of the
test file.
</p>


<h3>Value</h3>

<p>A <code>list</code> of class <code>tinytests</code>, which is a list of
<code><a href="#topic+tinytest">tinytest</a></code> objects.
</p>


<h3>Side-effects caused by test code</h3>

<p>All calls to <code><a href="base.html#topic+Sys.setenv">Sys.setenv</a></code> and <code><a href="base.html#topic+options">options</a></code>
defined in a test file are captured and undone once the test file has run,
if <code>remove_side_effects</code> is set to <code>TRUE</code>.
</p>


<h3>Tracking side effects</h3>

<p>Certain side effects can be tracked, even when they are not explicitly
evoked in the test file. See <code><a href="#topic+report_side_effects">report_side_effects</a></code> for side
effects tracked by <span class="pkg">tinytest</span>.  Calls to <code>report_side_effects</code>
within the test file overrule settings provided with this function.
</p>


<h3>Note</h3>

<p>Not all terminals support ansi escape characters, so colorized output can be
switched off. This can also be done globally by setting
<code>options(tt.pr.color=FALSE)</code>.  Some terminals that do support ansi
escape characters may contain bugs. An example is the RStudio terminal
(RStudio 1.1) running on Ubuntu 16.04 (and possibly other OSs).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ignore">ignore</a></code>
</p>
<p>Other test-files: 
<code><a href="#topic+build_install_test">build_install_test</a>()</code>,
<code><a href="#topic+exit_file">exit_file</a>()</code>,
<code><a href="#topic+run_test_dir">run_test_dir</a>()</code>,
<code><a href="#topic+summary.tinytests">summary.tinytests</a>()</code>,
<code><a href="#topic+test_package">test_package</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a test file, in temp directory
tests &lt;- "
addOne &lt;- function(x) x + 2

Sys.setenv(lolz=2)

expect_true(addOne(0) &gt; 0)
expect_equal(2, addOne(1))

Sys.unsetenv('lolz')
"
testfile &lt;- tempfile(pattern="test_", fileext=".R")
write(tests, testfile)

# run test file
out &lt;- run_test_file(testfile,color=FALSE)
out
# print everything in short format, include passes in print.
print(out, nlong=0, passes=TRUE)

# run test file, track supported side-effects
run_test_file(testfile, side_effects=TRUE)

# run test file, track only changes in working directory 
run_test_file(testfile, side_effects=list(pwd=TRUE, envvar=FALSE))


</code></pre>

<hr>
<h2 id='setup_tinytest'>Add tinytest to package source directory</h2><span id='topic+setup_tinytest'></span>

<h3>Description</h3>

<p>Creates <code>inst/tinytest</code>, and an example test file in that
directory. Creates <code>tests/tinytest.R</code> so the package is
tested with <code>R CMD check</code>. Adds <code>tinytests</code> as a suggested
package to the <code>DESCRIPTION</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_tinytest(pkgdir, force = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_tinytest_+3A_pkgdir">pkgdir</code></td>
<td>
<p><code>[character]</code> Package source directory</p>
</td></tr>
<tr><td><code id="setup_tinytest_+3A_force">force</code></td>
<td>
<p><code>[logical]</code> Toggle overwrite existing files? (not folders)</p>
</td></tr>
<tr><td><code id="setup_tinytest_+3A_verbose">verbose</code></td>
<td>
<p><code>[logical]</code> Toggle print progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>, invisibly.
</p>


<h3>Note on <code>DESCRIPTION</code></h3>

<p>Fails when it does not exist. It is assumed that the
package is named in the <code>DESCRIPTION</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# an easy way to set up a package 'haha' that passes
# R CMD check
pkgKitten::kitten("haha")
tinytest::setup_tinytest("haha")

## End(Not run)

</code></pre>

<hr>
<h2 id='summary.tinytests'>Tinytests object</h2><span id='topic+summary.tinytests'></span><span id='topic+all_pass'></span><span id='topic+any_pass'></span><span id='topic+all_fail'></span><span id='topic+any_fail'></span><span id='topic++5B.tinytests'></span><span id='topic+tinytests'></span><span id='topic+print.tinytests'></span><span id='topic+as.data.frame.tinytests'></span>

<h3>Description</h3>

<p>An object of class <code>tinytests</code> (note: plural) results
from running multiple tests from script. E.g. by running
<code><a href="#topic+run_test_file">run_test_file</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tinytests'
summary(object, ...)

all_pass(x)

any_pass(x)

all_fail(x)

any_fail(x)

## S3 method for class 'tinytests'
x[i]

## S3 method for class 'tinytests'
print(
  x,
  passes = getOption("tt.pr.passes", FALSE),
  sidefx = getOption("tt.pr.sidefx", TRUE),
  limit = getOption("tt.pr.limit", 7),
  nlong = getOption("tt.pr.nlong", 3),
  ...
)

## S3 method for class 'tinytests'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.tinytests_+3A_object">object</code></td>
<td>
<p>a <code>tinytests</code> object</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+format.tinytest">format.tinytest</a></code></p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_x">x</code></td>
<td>
<p>a <code>tinytests</code> object</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_i">i</code></td>
<td>
<p>an index</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_passes">passes</code></td>
<td>
<p><code>[logical]</code> Toggle: print passing tests?</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_sidefx">sidefx</code></td>
<td>
<p><code>[logical]</code> Toggle: print side effects?</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_limit">limit</code></td>
<td>
<p><code>[numeric]</code> Max number of results to print</p>
</td></tr>
<tr><td><code id="summary.tinytests_+3A_nlong">nlong</code></td>
<td>
<p><code>[numeric]</code> First <code>nlong</code> results are printed in long format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>summary</code> a <code><a href="base.html#topic+table">table</a></code> object
</p>
<p>For <code>all_pass</code>, <code>any_pass</code>, <code>all_fail</code>, <code>any_fail</code>: 
a single <code>logical</code>
</p>
<p>For <code>`[.tinytests`</code> a <code>tinytests</code> object.
</p>
<p>For <code>as.data.frame.</code> a data frame.
</p>


<h3>Details</h3>

<p>By default, the first 3 failing test results are printed in long form,
the next 7 failing test results are printed in short form and all other 
failing tests are not printed. These defaults can be changed by passing options
to  <code>print.tinytest</code>, or by setting one or more of the following global
options:
</p>

<ul>
<li><p><code>tt.pr.passes</code> Set to <code>TRUE</code> to print output of non-failing tests.
</p>
</li>
<li><p><code>tt.pr.limit</code> Max number of results to print (e.g. <code>Inf</code>)
</p>
</li>
<li><p><code>tt.pr.nlong</code> The number of results to print in long format (e.g. <code>Inf</code>).
</p>
</li></ul>

<p>For example, set <code>options(tt.pr.limit=Inf)</code> to print all test results.
Furthermore, there is the option
</p>

<ul>
<li><p><code>tt.pr.color</code>,
</p>
</li></ul>

<p>which determines whether colored output is printed.
If R is running in a dumb terminal (detected by comparing 
environment variable <code>"TERM"</code> to <code>"dumb"</code>), then
this option is set to <code>FALSE</code> when the package is loaded.
</p>


<h3>See Also</h3>

<p>Other test-files: 
<code><a href="#topic+build_install_test">build_install_test</a>()</code>,
<code><a href="#topic+exit_file">exit_file</a>()</code>,
<code><a href="#topic+run_test_dir">run_test_dir</a>()</code>,
<code><a href="#topic+run_test_file">run_test_file</a>()</code>,
<code><a href="#topic+test_package">test_package</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># create a test file in tempdir
tests &lt;- "
addOne &lt;- function(x) x + 2

expect_true(addOne(0) &gt; 0)
expect_equal(2, addOne(1))
"
testfile &lt;- tempfile(pattern="test_", fileext=".R")
write(tests, testfile)

# extract testdir
testdir &lt;- dirname(testfile)
# run all files starting with 'test' in testdir
out &lt;- run_test_dir(testdir)
#
# print results
print(out)
summary(out)
dat &lt;- as.data.frame(out)
out[1]

</code></pre>

<hr>
<h2 id='test_package'>Test a package during R CMD check or after installation</h2><span id='topic+test_package'></span>

<h3>Description</h3>

<p>Run all tests in an installed package. Throw an error and print all failed test
results when one or more tests fail if not in interactive mode (e.g. when
R CMD check tests a package). This function is intended to be
used by <code>R CMD check</code> or by a user that installed a package that
uses the <span class="pkg">tinytest</span> test infrastructure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_package(
  pkgname,
  testdir = "tinytest",
  lib.loc = NULL,
  at_home = FALSE,
  ncpu = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_package_+3A_pkgname">pkgname</code></td>
<td>
<p><code>[character]</code> scalar. Name of the package, as in the <code>DESCRIPTION</code> file.</p>
</td></tr>
<tr><td><code id="test_package_+3A_testdir">testdir</code></td>
<td>
<p><code>[character]</code> scalar. Path to installed directory. By default 
tinytest assumes that test files are in <code>inst/tinytest/</code>, which means
that after installation and thus during <code>R CMD check</code> they are in 
<code>tinytest/</code>. See details for using alternate paths.</p>
</td></tr>
<tr><td><code id="test_package_+3A_lib.loc">lib.loc</code></td>
<td>
<p><code>[character]</code> scalar. location where the package is installed.</p>
</td></tr>
<tr><td><code id="test_package_+3A_at_home">at_home</code></td>
<td>
<p><code>[logical]</code> scalar. Are we at home? (see Details)</p>
</td></tr>
<tr><td><code id="test_package_+3A_ncpu">ncpu</code></td>
<td>
<p>A positive integer, or a <code><a href="parallel.html#topic+makeCluster">makeCluster</a></code> object.</p>
</td></tr>
<tr><td><code id="test_package_+3A_...">...</code></td>
<td>
<p>extra arguments passed to <code><a href="#topic+run_test_dir">run_test_dir</a></code> (e.g. <code>ncpu</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>interactive()</code>, a <code>tinytests</code> object. If not
<code>interactive()</code>, an error is thrown when at least one test fails.
</p>


<h3>Details</h3>

<p>We set <code>at_home=FALSE</code> by default so <code>R CMD check</code> will run the
same as at CRAN. See the package vignette (Section 4) for tips on how to set
up the package structure.
<code>vignette("using_tinytest",package="tinytest")</code>.
</p>
<p>Package authors who want to avoid installing tests with the package can
create a directory under <code>tests</code>. If the test directoy is called
<code>"tests/foo"</code>, use <code>test_package("pkgname", testdir="foo")</code> in
<code>tests/tinytest.R</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setup_tinytest">setup_tinytest</a></code>
</p>
<p>Other test-files: 
<code><a href="#topic+build_install_test">build_install_test</a>()</code>,
<code><a href="#topic+exit_file">exit_file</a>()</code>,
<code><a href="#topic+run_test_dir">run_test_dir</a>()</code>,
<code><a href="#topic+run_test_file">run_test_file</a>()</code>,
<code><a href="#topic+summary.tinytests">summary.tinytests</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Create a file with the following content, to use
# tinytest as your unit testing framework:
  if (requireNamespace("tinytest", quietly=TRUE))
    tinytest::test_package("your package name")

## End(Not run)
</code></pre>

<hr>
<h2 id='tinytest'>Tinytest constructor</h2><span id='topic+tinytest'></span>

<h3>Description</h3>

<p>Each individual test in the package generates a <code>tinytest</code> object.  A
<code>tinytest</code> object is a <code>logical</code> scalar, with metadata
(attributes) about the test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tinytest(
  result,
  call,
  trace = NULL,
  diff = NA_character_,
  short = c(NA_character_, "data", "attr", "xcpt", "envv", "wdir", "file", "lcle"),
  info = NA_character_,
  file = NA_character_,
  fst = NA_integer_,
  lst = NA_integer_,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tinytest_+3A_result">result</code></td>
<td>
<p><code>[logical]</code> scalar.</p>
</td></tr>
<tr><td><code id="tinytest_+3A_call">call</code></td>
<td>
<p><code>[call]</code> The call that created <code>result</code>.</p>
</td></tr>
<tr><td><code id="tinytest_+3A_diff">diff</code></td>
<td>
<p><code>[character]</code> difference between current and target value
(if any).</p>
</td></tr>
<tr><td><code id="tinytest_+3A_short">short</code></td>
<td>
<p><code>[character]</code> short description of the difference</p>
</td></tr>
<tr><td><code id="tinytest_+3A_info">info</code></td>
<td>
<p><code>[character]</code> other information, to be printed in the long message</p>
</td></tr>
<tr><td><code id="tinytest_+3A_file">file</code></td>
<td>
<p><code>[character]</code> File location of the test.</p>
</td></tr>
<tr><td><code id="tinytest_+3A_fst">fst</code></td>
<td>
<p><code>[integer]</code> First line number in the test file.</p>
</td></tr>
<tr><td><code id="tinytest_+3A_lst">lst</code></td>
<td>
<p><code>[integer]</code> Last line number in the test file (differs
from <code>fst</code> if the call spans multiple lines).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tinytest</code> object.
</p>


<h3>Details</h3>

<p>The <span class="pkg">result</span> can take three values.
</p>

<ul>
<li><p><code>TRUE</code>: test was passed.
</p>
</li>
<li><p><code>FALSE</code>: test was failed.
</p>
</li>
<li><p><code>NA</code>: A side effect was detected. 
</p>
</li></ul>

<p>Authors of extension packages should not use <code>NA</code> as a result value as
this part of the interface may change in the future.
</p>


<h3>See Also</h3>

<p>Other extensions: 
<code><a href="#topic+register_tinytest_extension">register_tinytest_extension</a>()</code>,
<code><a href="#topic+using">using</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tt &lt;- expect_equal(1+1, 2)
if (isTRUE(tt)){
  print("w00p w00p!")
} else {
  print("Oh no!")
}



</code></pre>

<hr>
<h2 id='using'>Use an extension package.</h2><span id='topic+using'></span>

<h3>Description</h3>

<p>Loads and attaches a package to the search path, and picks up the
<span class="pkg">tinytest</span> extension functions registered by the package. Package
authors <em>must</em> call this function in <em>every</em> test file where an
extension is used, or otherwise results from the extension package are not
recorded (without a warning). Calling <code>using</code> in every file
where an extension is used also ensures that tests can be run in parallel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>using(package, quietly = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="using_+3A_package">package</code></td>
<td>
<p>the name of the extension package, given as name or character string.</p>
</td></tr>
<tr><td><code id="using_+3A_quietly">quietly</code></td>
<td>
<p>Passed to <code><a href="base.html#topic+require">require</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named <code>list</code>, with the package name and the names of the
functions registered by <code>package</code> to extend <span class="pkg">tinytest</span>. A message
is emitted when the package registers no extension functions.
</p>


<h3>See Also</h3>

<p>Other extensions: 
<code><a href="#topic+register_tinytest_extension">register_tinytest_extension</a>()</code>,
<code><a href="#topic+tinytest">tinytest</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  # In interactive session: see which functions are exported
  # by checkmate.tinytest
  out &lt;- using(checkmate.tinytest)
  print(out)

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
