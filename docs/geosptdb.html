<!DOCTYPE html><html lang="en"><head><title>Help for package geosptdb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geosptdb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#geosptdb-package'><p>Spatio-Temporal Radial Basis Functions with Distance-Based Methods (Optimization, Prediction and Cross Validation)</p></a></li>
<li><a href='#cp.xnews'>
<p>Generate the principal coordinates of a new individual from Gower's distance.</p></a></li>
<li><a href='#criteriaST.cv'>
<p>Cross-validation summaries</p></a></li>
<li><a href='#croatia'>
<p>Map Croatia.</p></a></li>
<li><a href='#croatia.grid7cp'>
<p>Principal coordinates of a pixelated size 4994 in Croatia.</p></a></li>
<li><a href='#croatia.temp'>
<p>Data climatic stations in Croatia.</p></a></li>
<li><a href='#croatia2008'>
<p>Data climatic stations in Croatia.</p></a></li>
<li><a href='#croatiadb'>
<p>principal coordinates associated with data climatic stations in Croatia 2008.</p></a></li>
<li><a href='#dblm'>
<p>Adjusting distance-based linear regression model</p></a></li>
<li><a href='#extractFormula'>
<p>geospt internal function</p></a></li>
<li><a href='#graph.rbfST'>
<p>Graph that describes the behavior of the optimized <em>eta</em> and <em>rho</em> parameters, associated with a spatio-temporal radial basis function.</p></a></li>
<li><a href='#idwST'>
<p>Inverse Distance Weighting (IDW) function for spatio-temporal prediction.</p></a></li>
<li><a href='#idwST.cv'>
<p>IDW spatio-temporal leave-one-out cross validation</p></a></li>
<li><a href='#idwST.cv1'>
<p>Generate a RMSPE value, result of leave-one-out cross validation</p></a></li>
<li><a href='#idwST.tcv'>
<p>table of idw spatio-temporal leave-one-out cross validation</p></a></li>
<li><a href='#rbfST'>
<p>gaussian, exponential, trigonometric, thin plate spline, inverse multiquadratic, and multiquadratic radial basis function for spatio-temporal prediction</p></a></li>
<li><a href='#rbfST.cv'>
<p>Leave-one-out cross validation for spatio-temporal radial basis function</p></a></li>
<li><a href='#rbfST.cv1'>
<p>RMSPE value result of leave-one-out cross validation for <em>rbfST</em></p></a></li>
<li><a href='#rbfST.tcv'>
<p>table of rbf spatio-temporal cross validation, leave-one-out</p></a></li>
<li><a href='#standardize'>
<p>standardize internal function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spatio-Temporal Radial Basis Functions with Distance-Based
Methods (Optimization, Prediction and Cross Validation)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-12</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carlos Melo &lt;cmelo@udistrital.edu.co&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), FD, StatMatch, fields, sp</td>
</tr>
<tr>
<td>Imports:</td>
<td>minqa, limSolve, gsl, geospt, grDevices, methods, stats, utils</td>
</tr>
<tr>
<td>Description:</td>
<td>Spatio-temporal radial basis functions (optimization, prediction and cross-validation), summary statistics from cross-validation, Adjusting distance-based linear regression model and generation of the principal coordinates of a new individual from Gower's distance.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Carlos Melo <a href="https://orcid.org/0000-0002-5598-1913"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Oscar Melo <a href="https://orcid.org/0000-0002-0296-4511"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Sandra Melo [aut]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-12 14:54:20 UTC; ASUS</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-12 21:30:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='geosptdb-package'>Spatio-Temporal Radial Basis Functions with Distance-Based Methods (Optimization, Prediction and Cross Validation)</h2><span id='topic+geosptdb-package'></span><span id='topic+geosptdb'></span>

<h3>Description</h3>

<p>Spatio-temporal: Inverse Distance Weighting (IDW) and radial basis functions; optimization, prediction, summary statistics
from leave-one-out cross-validation, adjusting distance-based linear regression model and generation
of the principal coordinates of a new individual from Gower's distance.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> geosptdb</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-05-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Carlos Melo &lt;cmelo@udistrital.edu.co&gt;, Oscar Melo &lt;oomelom@unal.edu.co&gt;,  Sandra Melo &lt;semelom@unal.edu.co&gt;
</p>
<p>Maintainer: Carlos Melo &lt;cmelo@udistrital.edu.co&gt;
</p>


<h3>References</h3>

<p>Cuadras CM, Arenas C, Fortiana J (1996). <em>Some computational aspects of a distance-based model
for prediction</em>. Communications in Statistics B - Simulation and Computation 25, 593-609.
</p>
<p>Cuadras, CM. and Arenas, C. (1990).<em>A distance-based regression model for prediction with mixed data</em>.
Communications in Statistics A - Theory and Methods 19, 2261-2279
</p>
<p>Gower, J. C. (1971). <em>A general coefficient of similarity and some of its properties</em>. Biometrics 27:857-871.
</p>
<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>
<p>Hengl, T., Heuvelink Gerard, B. M., Percec Tadic, M. &amp; Pebesma, E. J. (2012).
<em>Spatio-temporal prediction of daily temperatures using time-series of
MODIS LST images</em>, Theoretical and Applied Climatology 107, 1-2, 265-277.
</p>
<p>Johnston, K., Ver, J., Krivoruchko, K., Lucas, N. 2001. <em>Using ArcGIS Geostatistical Analysis</em>. ESRI.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbfST">rbfST</a></code>, <code><a href="#topic+graph.rbfST">graph.rbfST</a></code>, <code><a href="#topic+cp.xnews">cp.xnews</a></code>, <code><a href="#topic+croatiadb">croatiadb</a></code>
</p>

<hr>
<h2 id='cp.xnews'>
Generate the principal coordinates of a new individual from Gower's distance.
</h2><span id='topic+cp.xnews'></span>

<h3>Description</h3>

<p>Function for generates a numeric matrix with principal coordinates of a new individual then you could obtain distances from this matrix and you can do a prediction using a Gower's result (1971) and Cuadras &amp; Arenas (1990) which relates the squared distances vector with the principal coordinates vector associated to the new individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp.xnews(newdata,eigenvalues, data,trend, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cp.xnews_+3A_newdata">newdata</code></td>
<td>
<p>data frame values of new individual.</p>
</td></tr>
<tr><td><code id="cp.xnews_+3A_eigenvalues">eigenvalues</code></td>
<td>
<p>the <code class="reqn">n</code> eigenvalues computed during the scaling process (see <code><a href="stats.html#topic+cmdscale">cmdscale</a></code>)</p>
</td></tr>
<tr><td><code id="cp.xnews_+3A_data">data</code></td>
<td>
<p>matrix or data frame containing the explanatory variables. These variables can be numeric, ordered, or factor, the symmetric or asymmetric binary variables should be numeric and only contain 0 and 1 character variables will be converted to factor. NAs are tolerated. With these variables the principal coordinates are built which become the regressors in the linear model.</p>
</td></tr>
<tr><td><code id="cp.xnews_+3A_trend">trend</code></td>
<td>
<p>matrix <code class="reqn">nxk</code> of the <code class="reqn">k</code> most statistically significant principal coordinates (5%) with the response variable, obtained from the matrix or data frame containing explanatory variables.</p>
</td></tr>
<tr><td><code id="cp.xnews_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to the <code><a href="StatMatch.html#topic+gower.dist">gower.dist</a></code> function (see <code><a href="StatMatch.html#topic+gower.dist">gower.dist</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a numeric matrix with principal coordinates of the new individual.
</p>


<h3>References</h3>

<p>Cuadras, CM. and Arenas, C. (1990).<em>A distance-based regression model for prediction with mixed data</em>. 
Communications in Statistics A - Theory and Methods 19, 2261-2279
</p>
<p>Gower, J. C. (1971). <em>A general coefficient of similarity and some of its properties</em>. Biometrics 27:857-871.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dblm">dblm</a></code>,  <code><a href="#topic+rbfST">rbfST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(croatia.temp)
data(croatiadb)
# prediction case: one point
point &lt;- data.frame(670863,5043464,5,170,200,15.7,3)
names(point) &lt;- c("x","y","t","dem","dsea","twi","est")

croatia.temp[,7] &lt;- as.factor(croatia.temp[,7])
dblm1 &lt;- dblm(data=croatia.temp,y=croatiadb$MTEMP)                                 
newdata1 &lt;- t(cp.xnews(newdata=point,eigenvalues=dblm1$ev, data=croatia.temp,
                       trend=dblm1$cp))
colnames(newdata1) &lt;- c("X1","X2","X3","X4","X5","X6","X7","X8","X9","X10")

## End(Not run)
</code></pre>

<hr>
<h2 id='criteriaST.cv'>
Cross-validation summaries
</h2><span id='topic+criteriaST.cv'></span>

<h3>Description</h3>

<p>Generate a data frame of statistical values associated with cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criteriaST.cv(m.cv)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="criteriaST.cv_+3A_m.cv">m.cv</code></td>
<td>

<p>data frame containing: prediction columns, prediction variance of cross-validation
data points, observed values, residuals, zscore (residual divided by kriging
standard error), and fold. If the <code><a href="#topic+rbfST.tcv">rbfST.tcv</a></code> function is used, the
prediction variance, zscore (residual divided by standard error) will have NA's,
coordinates data and time.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing: mean prediction errors (MPE), average kriging
standard error (AKSE), root-mean-square prediction errors (RMSPE),
mean standardized prediction errors (MSPE), root-mean-square standardized
prediction errors (RMSSPE), mean absolute percentage prediction errors (MAPPE), coefficient of correlation of the prediction errors (CCPE), coefficient of determination (R2) and squared coefficient of correlation of the prediction errors (pseudoR2)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># leave-one-out cross validation:
data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y

# inverse multiquadratic function, predefined eta and rho
tempm &lt;- rbfST.tcv(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, croatiadb, eta=0.0108,
                   rho=0.00004, n.neigh=25, func="IM")
criteriaST.cv(tempm)
</code></pre>

<hr>
<h2 id='croatia'>
Map Croatia.
</h2><span id='topic+croatia'></span>

<h3>Description</h3>

<p>Map Croatia. Spatial reference system: UTM 33N
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(croatia)</code></pre>


<h3>Format</h3>

<p>The format is:
Formal class 'SpatialPolygonsDataFrame' [package &quot;sp&quot;] 
</p>


<h3>References</h3>

  
<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatia)
pts &lt;- spsample(croatia, n=25000, type="regular")
plot(pts)
</code></pre>

<hr>
<h2 id='croatia.grid7cp'>
Principal coordinates of a pixelated size 4994 in Croatia.
</h2><span id='topic+croatia.grid7cp'></span>

<h3>Description</h3>

<p>data frame <code class="reqn">4994 \times 13</code> of spatio-temporal coordinates and principal coordinates associated with a pixelated size 4994 in Croatia. Spatial reference system: UTM 33N.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(croatia.grid7cp)</code></pre>


<h3>References</h3>

  
<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>
<p>Hengl, T., Heuvelink Gerard, B. M., Percec Tadic, M. &amp; Pebesma, E. J. (2012).
<em>Spatio-temporal prediction of daily temperatures using time-series of
MODIS LST images</em>, Theoretical and Applied Climatology 107, 1-2, 265-277.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+croatia.temp">croatia.temp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatia.grid7cp)
plot(croatia.grid7cp[,1:2])
</code></pre>

<hr>
<h2 id='croatia.temp'>
Data climatic stations in Croatia.
</h2><span id='topic+croatia.temp'></span>

<h3>Description</h3>

<p>Information of 142 climatic stations in Croatia in 2008, with topographical static predictors (Digital Elevation Model, (DEM, in meters), topographically weighted distances from the coast line (DSEA, in km), topographic wetness index (TWI))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(croatia.temp)</code></pre>


<h3>Format</h3>

<p>A data frame with 1752 observations on the following 7 variables:
</p>

<dl>
<dt><code>x</code></dt><dd><p>a numeric vector; x-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>y</code></dt><dd><p>a numeric vector; y-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>t</code></dt><dd><p>a numeric vector; t-coordinate (1-12 for the months from January to December)</p>
</dd>
<dt><code>dem</code></dt><dd><p>a numeric vector, Digital Elevation Model (DEM, in meters)</p>
</dd>
<dt><code>dsea</code></dt><dd><p>a numeric vector with topographically weighted distances from the coast line (DSEA, in km)</p>
</dd>
<dt><code>twi</code></dt><dd><p>a numeric vector with topographic wetness index</p>
</dd>
<dt><code>est</code></dt><dd><p>a numeric vector with seasons (1 for January, February and March, 2 for April, May and June, 3 for July, August and September and 4 for October, November and December)</p>
</dd>
</dl>



<h3>References</h3>

  
<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>
<p>Hengl, T., Heuvelink Gerard, B. M., Percec Tadic, M. &amp; Pebesma, E. J. (2012).
<em>Spatio-temporal prediction of daily temperatures using time-series of
MODIS LST images</em>, Theoretical and Applied Climatology 107, 1-2, 265-277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatia.temp)
summary(croatia.temp)
</code></pre>

<hr>
<h2 id='croatia2008'>
Data climatic stations in Croatia.
</h2><span id='topic+croatia2008'></span>

<h3>Description</h3>

<p>Information of 154 climatic stations in Croatia in 2008, with topographical static predictors (Digital Elevation Model, (DEM, in meters), topographically weighted distances from the coast line (DSEA, in km), topographic wetness index (TWI), Geographical coordinates: latitude (lat) and longitude (lon), and earth's monthly average temperature (MTEMP))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(croatia.temp)</code></pre>


<h3>Format</h3>

<p>A data frame with 1845 observations on the following 9 variables:
</p>

<dl>
<dt><code>x</code></dt><dd><p>a numeric vector; x-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>y</code></dt><dd><p>a numeric vector; y-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>t</code></dt><dd><p>a numeric vector; t-coordinate (1-12 for the months from January to December)</p>
</dd>
<dt><code>dem</code></dt><dd><p>a numeric vector, Digital Elevation Model (DEM, in meters)</p>
</dd>
<dt><code>dsea</code></dt><dd><p>a numeric vector with topographically weighted distances from the coast line (DSEA, in km)</p>
</dd>
<dt><code>twi</code></dt><dd><p>a numeric vector with topographic wetness index</p>
</dd>
<dt><code>Lat</code></dt><dd><p>a numeric vector; latitude-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>Lon</code></dt><dd><p>a numeric vector; longitude-coordinate; Spatial reference system: UTM 33N</p>
</dd>
<dt><code>MTEMP</code></dt><dd><p>a numeric vector with earth's monthly average temperature</p>
</dd>
</dl>



<h3>References</h3>

<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>
<p>Hengl, T., Heuvelink Gerard, B. M., Percec Tadic, M. &amp; Pebesma, E. J. (2012).
<em>Spatio-temporal prediction of daily temperatures using time-series of
MODIS LST images</em>, Theoretical and Applied Climatology 107, 1-2, 265-277.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatia2008)
summary(croatia2008)
</code></pre>

<hr>
<h2 id='croatiadb'>
principal coordinates associated with data climatic stations in Croatia 2008. 
</h2><span id='topic+croatiadb'></span>

<h3>Description</h3>

<p>data frame <code class="reqn">1752 \times 14</code> of spatio-temporal coordinates, earth's average temperature monthly and 10 principal coordinates associated with data climatic stations in Croatia 2008. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(croatiadb)</code></pre>


<h3>Format</h3>

<p>The format is:
Formal class 'data.frame' [package &quot;base&quot;] 
</p>


<h3>References</h3>

<p>Hengl, T. (2009). <em>A Practical Guide to Geostatistical Mapping</em>, 2nd edn, University of Amsterdam, Amsterdam.
</p>
<p>Hengl, T., Heuvelink Gerard, B. M., Percec Tadic, M. &amp; Pebesma, E. J. (2012).
<em>Spatio-temporal prediction of daily temperatures using time-series of
MODIS LST images</em>, Theoretical and Applied Climatology 107, 1-2, 265-277.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+croatia.grid7cp">croatia.grid7cp</a></code>, <code><a href="#topic+croatia.temp">croatia.temp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatiadb)
str(croatiadb)
names(croatiadb)
</code></pre>

<hr>
<h2 id='dblm'>
Adjusting distance-based linear regression model 
</h2><span id='topic+dblm'></span>

<h3>Description</h3>

<p><code><a href="#topic+dblm">dblm</a></code> is a linear model variety where explanatory information is coded as distances among
individuals so these distances can also be computed from observed explanatory variables (a mix of continuous, qualitative explanatory variables or from more general quantities). The response is a continuous variable as in the classic linear model.
</p>
<p><code><a href="stats.html#topic+lm">lm</a></code> is used internally to adjust a distance-based linear regression model. The method considers the Gower's distance for mixed covariates (numeric, ordered, or factor), for explanation on the meaning of distance-based linear regression model and distance of Gower see the bibliography references below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dblm(data,y,sc,ev.min, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dblm_+3A_data">data</code></td>
<td>
<p>matrix or data frame containing the explanatory variables. These variables can be numeric, ordered, or factor. Symmetric or asymmetric binary variables should be numeric and only contain 0 and 1. character variables will be converted to factor. NAs are tolerated. With these variables are built, the principal coordinates which later become the regressors in the linear model.</p>
</td></tr>
<tr><td><code id="dblm_+3A_y">y</code></td>
<td>
<p>the response variable used to fit the model</p>
</td></tr>
<tr><td><code id="dblm_+3A_sc">sc</code></td>
<td>
<p>the value of the correlation squared to select the principal coordinates more related to the response variable. The default value is 0.003.</p>
</td></tr>
<tr><td><code id="dblm_+3A_ev.min">ev.min</code></td>
<td>
<p>the minimum value to select the eigenvalues. These eigenvalues must be positive, the default value is 0.007</p>
</td></tr>
<tr><td><code id="dblm_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to the <code><a href="FD.html#topic+gowdis">gowdis</a></code> function (see <code><a href="FD.html#topic+gowdis">gowdis</a></code>) of low level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+dblm">dblm</a></code> model builds; principal coordinates matrix, eigenvalues, and a linear regression model. gowdis function used in <code><a href="#topic+dblm">dblm</a></code> compute the Gower (1971) similarity coefficient exactly as described by Podani (1999), then converts it to a dissimilarity coefficient by using <code class="reqn">D = 1 - S</code>. It integrates variable weights as described by Legendre and Legendre (1998).
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>table</code></td>
<td>
<p>table with eigenvalues, correlations squared, and percentages of inertia associated with the most statistically significant principal coordinates (5%) with the response variable.</p>
</td></tr>
<tr><td><code>ev</code></td>
<td>
<p>the <code class="reqn">n</code> eigenvalues computed during the scaling process (see <code><a href="stats.html#topic+cmdscale">cmdscale</a></code>).</p>
</td></tr>
<tr><td><code>cp</code></td>
<td>
<p>the <code class="reqn">k</code> most statistically significant principal coordinates (5%) with the response variable.</p>
</td></tr>
<tr><td><code>dbmodel</code></td>
<td>
<p>returns a list of summary statistics of the fitted linear model.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cuadras, CM., Arenas C. and Fortiana, J. (1996). <em>Some computational aspects of a distance-based model
for prediction</em>. Communications in Statistics B - Simulation and Computation 25, 593-609.
</p>
<p>Cuadras, CM. and Arenas, C. (1990).<em>A distance-based regression model for prediction with mixed data</em>. 
Communications in Statistics A - Theory and Methods 19, 2261-2279
</p>
<p>Gower, J. C. (1971). <em>A general coefficient of similarity and some of its properties</em>. Biometrics 27:857-871.
</p>
<p>Legendre, P. and Legendre, L. (1998). <em>Numerical Ecology</em>. 2nd English edition. Amsterdam: Elsevier.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>
<p>Podani, J. (1999). <em>Extending Gower's general coefficient of similarity to ordinal characters</em>. Taxon 48:331-340. 
</p>


<h3>See Also</h3>

<p>See function <code><a href="FD.html#topic+gowdis">gowdis</a></code> in the <code>FD</code> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># considering 10 principal coordinates (constructed from a distance-based linear 
# regression model)
## Not run: 
data(croatia.temp)
data(croatiadb)
croatia.temp[,7] &lt;- as.factor(croatia.temp[,7])
dblm1 &lt;- dblm(data=croatia.temp,y=croatiadb$MTEMP) 
str(dblm1)

## End(Not run)
</code></pre>

<hr>
<h2 id='extractFormula'>
geospt internal function
</h2><span id='topic+extractFormula'></span>

<h3>Description</h3>

<p>geospt internal function
</p>


<h3>Note</h3>

<p>This function is not meant to be called by users directly
</p>

<hr>
<h2 id='graph.rbfST'>
Graph that describes the behavior of the optimized <em>eta</em> and <em>rho</em> parameters, associated with a spatio-temporal radial basis function.
</h2><span id='topic+graph.rbfST'></span>

<h3>Description</h3>

<p>Function for plotting the RMSPE for several values of the smoothing parameter
<em>eta</em> with the same dataset. A curve is fitted to the points, and
then the optimal <em>eta</em> that provides the smallest RMSPE is determined from the
curve, by the <code><a href="stats.html#topic+optimize">optimize</a></code> function from the <code>stats</code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graph.rbfST(formula, data, eta.opt, rho.opt, n.neigh, func, np, xo, eta.dmax,
rho.dmax, P.T, iter, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="graph.rbfST_+3A_formula">formula</code></td>
<td>
<p>formula that defines the dependent variable as a linear model of independent variables (covariates or the principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code>, for a <em>rbfST</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>, for a <em>rbfST</em> with trend, suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_eta.opt">eta.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>eta</em> should be regarded as fixed (eta.opt = FALSE) or should be estimated (eta.opt = TRUE)</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_rho.opt">rho.opt</code></td>
<td>
<p>logical, indicating whether the parameter <em>rho</em> should be regarded as fixed (rho.opt = FALSE) or should be estimated (rho.opt = TRUE)</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_func">func</code></td>
<td>
<p>function to be optimized. The following radial basis function spatio-temporal model types are currently available: gaussian &quot;GAU&quot;, exponential &quot;EXPON&quot;, trigonometric &quot;TRI&quot;, thin plate spline &quot;TPS&quot;, completely regularized spline &quot;CRS&quot;, spline with tension &quot;ST&quot;, inverse multiquadratic &quot;IM&quot;, and multiquadratic &quot;M&quot;, are currently available</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_np">np</code></td>
<td>
<p>number of points, where the radial basis function spatio-temporal is calculated</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_xo">xo</code></td>
<td>
<p>starting point for searching the optimum. Defaults to c(0.5, 0.5), <em>eta</em> and <em>rho</em> respectively. Use this statement only if <em>eta</em> and <em>rho</em> are equal to TRUE.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_eta.dmax">eta.dmax</code></td>
<td>
<p>maximum value of the range of the <em>eta</em> parameter that will be evaluated by the <code><a href="stats.html#topic+optimize">optimize</a></code> function.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_rho.dmax">rho.dmax</code></td>
<td>
<p>maximum value of the range of the <em>rho</em> parameter that will be evaluated by the <code><a href="stats.html#topic+optimize">optimize</a></code> function.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_p.t">P.T</code></td>
<td>
<p>logical. Print table (TRUE) or not (FALSE). Default P.T=NULL.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_iter">iter</code></td>
<td>
<p>The maximum allowed number of function evaluations.</p>
</td></tr>
<tr><td><code id="graph.rbfST_+3A_...">...</code></td>
<td>
<p>further parameters to be passed to the minimization functions <code><a href="stats.html#topic+optimize">optimize</a></code> or <code><a href="minqa.html#topic+bobyqa">bobyqa</a></code>, typically arguments of the type control() which control the behavior of the minimization algorithm. See documentation about the selected minimization function for further details.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a graph that describes the behavior of the optimized <em>eta</em> or <em>rho</em> parameters and a table of values associated with the graph including optimal smoothing <em>eta</em> or <em>rho</em> parameters. If both <em>eta</em> and <em>rho</em> are FALSE simultaneously then the function returns a list with the best value obtained from the combinations smoothing <em>eta</em> and <em>rho</em> parameters and a lattice plot of class &quot;trellis&quot; with RMSPE pixel values associated with combinations of <em>eta</em> and <em>rho</em> parameters. Finally, if both <em>eta</em> and <em>rho</em> are TRUE, the function will return a list with the best combination of values of the smoothing <em>eta</em> or <em>rho</em> parameters and the RMSPE associated with these.
</p>


<h3>References</h3>

<p>Johnston, K., Ver, J., Krivoruchko, K., Lucas, N. (2001). <em>Using ArcGIS Geostatistical Analysis</em>. ESRI.
</p>
<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbfST">rbfST</a></code>, <code><a href="#topic+rbfST.cv">rbfST.cv</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(croatiadb)
coordinates(croatiadb)&lt;-~x+y
# optimizing eta
graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, eta.opt=TRUE,
             rho.opt=FALSE, n.neigh=30, func="TPS", np=40,  eta.dmax=2, P.T=TRUE)
# optimizing rho
graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, eta.opt=FALSE,
             rho.opt=TRUE, n.neigh=30, func="M", np=20, rho.dmax=2, P.T=TRUE)
# optimizing eta and rho
tps.lo &lt;- graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb,
       eta.opt=TRUE,rho.opt=TRUE, n.neigh=25, func="TPS",  eta.dmax=0.2,
       rho.dmax=0.2, xo=c(0.1,0.1), iter=50)
tps.lo  # best combination of eta and rho obtained
# lattice of RMSPE values associated with a range of eta and rho, without optimization
tps.la &lt;- graph.rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb,
       eta.opt=FALSE, rho.opt=FALSE, n.neigh=30,  func="TPS", np=10,  eta.dmax=0.2,
       rho.dmax=0.2)
tps.l$table  # best combination of eta and rho obtained
tps.l$spplot  # lattice of RMSPE

## End(Not run)
</code></pre>

<hr>
<h2 id='idwST'>
Inverse Distance Weighting (IDW) function for spatio-temporal prediction.
</h2><span id='topic+idwST'></span>

<h3>Description</h3>

<p>This function performs spatio-temporal interpolation. Here <em>idwST</em> is in a local neighborhood. This interpolation method considers the value of a point can be obtained from the weighted sum of values of the regionalized variable of closest neighbors. The general formula for the IDW is given by:
</p>
<p style="text-align: center;"><code class="reqn">
\hat{z}_0(st)=\sum_{i=1}^n \lambda_i z_i(st)
</code>
</p>

<p>The expression for determining the weights is:
</p>
<p style="text-align: center;"><code class="reqn">
\lambda_i = \frac{d_{i0}^{-p}}{\sum_{i=1}^n d_{i0}^{-p}}
</code>
</p>

<p>The weight is controlled by a factor <em>p</em> with each increment of the distance, <code class="reqn">d_{i0}</code> is the distance between the prediction position and each of the measured positions.
</p>
<p>The expression <code class="reqn">d_{i0}</code> can be obtained by:
</p>
<p style="text-align: center;"><code class="reqn">
d_{i0}=\sqrt{(x_{i}-x_{0})^2+(y_{i}-y_{0})^2+C\cdot (t_{i}-t_{0})^2}
</code>
</p>

<p><code class="reqn">x</code>, <code class="reqn">y</code> and <code class="reqn">t</code> correspond to the spatio-temporal coordinates, <em>p</em> (factor.p) and <em>C</em> factors defined below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idwST(formula, data, newdata, n.neigh, C, factor.p, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idwST_+3A_formula">formula</code></td>
<td>
<p>formula that defines a detrended linear model, use <code class="reqn">z_{st}</code><code>~1</code>.</p>
</td></tr>
<tr><td><code id="idwST_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="idwST_+3A_newdata">newdata</code></td>
<td>
<p>data frame or spatial object with prediction/simulation spatio-temporal locations; should contain attribute columns with the independent variables (if present) and (if locations is a formula) the coordinates and time with names, as defined in locations where you want to generate new predictions</p>
</td></tr>
<tr><td><code id="idwST_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>idwST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="idwST_+3A_c">C</code></td>
<td>
<p>numeric; associated to time factor, we recommend using the parameter found by
minimizing the root-mean-square prediction errors using cross-validation. Using <em>idwST.cv</em> and <code><a href="stats.html#topic+optimize">optimize</a></code></p>
</td></tr>
<tr><td><code id="idwST_+3A_factor.p">factor.p</code></td>
<td>
<p>numeric; specify the inverse distance weighting power (<em>p</em> is the exponent that influences the weighting or optimal smoothing parameter)</p>
</td></tr>
<tr><td><code id="idwST_+3A_progress">progress</code></td>
<td>
<p>whether a progress bar shall be printed for spatio-temporal inverse-distance weighted function; default=TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>idwST function generates individual spatio-temporal predictions from IDW spatio-temporal interpolation. IDW is a type of deterministic method for interpolation, the assigned values to unknown points are calculated with a weighted average of the values available at the known points.
</p>


<h3>Value</h3>

<p>Attributes columns contain coordinates, time, predictions, and the variance
column contains NA's
</p>


<h3>References</h3>

<p>Li L, Losser T, Yorke C, Piltner R. (2014). <em>Fast inverse distance weighting-based spatiotemporal interpolation: a web-based application of interpolating daily fine particulate matter PM2:5 in the contiguous U.S. using parallel programming and k-d tree.</em> Int. J. Environ. Res. Public Health, 11: 9101-9141. <a href="https://www.mdpi.com/journal/ijerph">[link]</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Loading Croatia data
data(croatia2008)
coordinates(croatia2008) &lt;- ~x+y

# prediction case: one point
point &lt;- data.frame(670863,5043464,5)
names(point) &lt;- c("x","y","t")

coordinates(point) &lt;- ~x+y
idwST(MTEMP~1, data=croatia2008, newdata=point, n.neigh=60, C=1, factor.p=2)

## Not run: 
# prediction case: a grid of points Croatia (year 2008)
data(croatia)
points &lt;- spsample(croatia, n=5000, type="regular")

data(croatia2008)
coordinates(croatia2008)&lt;-~x+y

GridsT &lt;- vector(mode = "list", length = 12)

for(i in 1:12){
GridsT[[i]] &lt;- data.frame(points@coords,i)
names(GridsT[[i]]) &lt;- c("x","y","t")
}

idw.croatia &lt;- data.frame(matrix(NA, ncol = 14, nrow=nrow(GridsT[[1]])))
pb &lt;- txtProgressBar(min = 0, max = 12, char = "=", style = 3)
for(i in 1:12){
coordinates(GridsT[[i]]) &lt;- c("x", "y")
idw.croatia[,i+2] &lt;- idwST(MTEMP~1, croatia2008, newdata=GridsT[[i]], n.neigh=10, C=1,
                          factor.p=2, progress=FALSE)[,4]
setTxtProgressBar(pb, i)
}
close(pb)

idw.croatia[,1:2] &lt;- GridsT[[1]]@coords
nam &lt;- paste(c("ENE","FEB","MAR","ABR","MAY","JUN","JUL","AGO","SEP","OCT","NOV","DIC"),
             2008,sep="")
names(idw.croatia) &lt;- c("x","y",nam)

coordinates(idw.croatia) &lt;- c("x", "y")
gridded(idw.croatia) &lt;- TRUE

# show prediction map
pal2 &lt;- colorRampPalette(c("blue3", "wheat1", "red3"))

p1 &lt;- spplot(idw.croatia[,1:12], cuts=30, col.regions=pal2(35), colorkey=F,
            scales = list(draw =T,cex=0.6, abbreviate=TRUE,minlength=1), pch=0.3,
            cex.lab=0.3, cex.title=0.3, auto.key = F, main = "Earth's average
            temperature IDW map 2008", key.space=list(space="right", cex=0.8))

split.screen( rbind(c(0, 1,0,1), c(1,1,0,1)))
split.screen(c(1,2), screen=1)-&gt; ind
screen( ind[1])
p1
screen( ind[2])
image.plot(legend.only=TRUE, legend.width=0.5, col=pal2(100),
           smallplot=c(0.7,0.75, 0.3,0.7), zlim=c(min(idw.croatia@data),
           max(idw.croatia@data)), axis.args = list(cex.axis = 0.7))
close.screen( all=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='idwST.cv'>
IDW spatio-temporal leave-one-out cross validation
</h2><span id='topic+idwST.cv'></span>

<h3>Description</h3>

<p>Generate the RMSPE value which is given by Inverse Distance Weighting (IDW) interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idwST.cv(formula, data, n.neigh, C, factor.p, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idwST.cv_+3A_formula">formula</code></td>
<td>
<p>formula that defines a detrended linear model, use <code class="reqn">z_{st}</code><code>~1</code>.</p>
</td></tr>
<tr><td><code id="idwST.cv_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="idwST.cv_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbf.st</em>
prediction, where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="idwST.cv_+3A_c">C</code></td>
<td>
<p>numeric; associated to time factor, we recommend using the parameter found by
minimizing the root-mean-square prediction errors using cross-validation. Using <em>idwST.cv</em> and <code><a href="stats.html#topic+optimize">optimize</a></code></p>
</td></tr>
<tr><td><code id="idwST.cv_+3A_factor.p">factor.p</code></td>
<td>
<p>numeric; specify the inverse distance weighting power (<code>p</code> is the exponent that influences the weighting or optimal smoothing parameter)</p>
</td></tr>
<tr><td><code id="idwST.cv_+3A_progress">progress</code></td>
<td>
<p>whether a progress bar shall be printed for spatio-temporal inverse-distance weighted function; default=TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the RMSPE value
</p>


<h3>References</h3>

<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idwST">idwST</a></code>, <code><a href="#topic+rbfST">rbfST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y
idwST.cv(MTEMP~1, croatiadb[,1:2], n.neigh=10, C=1, factor.p=2)

## End(Not run)
</code></pre>

<hr>
<h2 id='idwST.cv1'>
Generate a RMSPE value, result of leave-one-out cross validation
</h2><span id='topic+idwST.cv1'></span>

<h3>Description</h3>

<p>Generate the RMSPE value which is given by the radial basis function spatio-temporal
with number of nearest observations<em>n.neigh</em> associated to time factor <em>C</em> and optimal smoothing parameter <em>factor.p</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idwST.cv1(param, formula, data, n.neigh, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idwST.cv1_+3A_param">param</code></td>
<td>
<p>vector starting points (<em>C</em> and <em>factor.p</em> respectively) for searching the <em>RMSPE</em> optimum.</p>
</td></tr>
<tr><td><code id="idwST.cv1_+3A_formula">formula</code></td>
<td>
<p>formula that defines a detrended linear model, use <code class="reqn">z_{st}</code><code>~1</code>.</p>
</td></tr>
<tr><td><code id="idwST.cv1_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="idwST.cv1_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbf.st</em>
prediction where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="idwST.cv1_+3A_progress">progress</code></td>
<td>
<p>whether a progress bar shall be printed for spatio-temporal inverse-distance weighted function; default=FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the RMSPE value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idwST">idwST</a></code>, <code><a href="#topic+idwST.cv">idwST.cv</a></code>, <code><a href="#topic+idwST.tcv">idwST.tcv</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(minqa)
data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y

## Not run: 
idwST.opt &lt;- bobyqa(c(1, 2), idwST.cv1, lower=c(0,0.1), upper=c(2,4), formula=MTEMP~1, 
                    data=croatiadb[,1:2], n.neigh=10, progres=F, control=list(maxfun=50))         

# obtained with optimal values previously estimated (33 iterations)
idwST.cv1(c(1.00538675066736,1.95853920335545), MTEMP~1, data=croatiadb[,1:2], n.neigh=10, 
          progress=T)

## End(Not run)
</code></pre>

<hr>
<h2 id='idwST.tcv'>
table of idw spatio-temporal leave-one-out cross validation
</h2><span id='topic+idwST.tcv'></span>

<h3>Description</h3>

<p>Generates a table with the results of inverse distance weighting spatio-temporal interpolation (<em>idwST</em>) from leave-one-out cross validation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idwST.tcv(formula, data, n.neigh, C, factor.p, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idwST.tcv_+3A_formula">formula</code></td>
<td>
<p>formula that defines a detrended linear model, use <code class="reqn">z_{st}</code><code>~1</code>.</p>
</td></tr>
<tr><td><code id="idwST.tcv_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="idwST.tcv_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>idwST</em>
prediction where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="idwST.tcv_+3A_c">C</code></td>
<td>
<p>numeric; associated to time factor, we recommend using the parameter found by
minimizing the root-mean-square prediction errors using cross-validation. Using <em>idwST.cv</em> and <code><a href="stats.html#topic+optimize">optimize</a></code></p>
</td></tr>
<tr><td><code id="idwST.tcv_+3A_factor.p">factor.p</code></td>
<td>
<p>numeric; specify the inverse distance weighting power (<em>p</em> is the exponent that influences the weighting or optimal smoothing parameter)</p>
</td></tr>
<tr><td><code id="idwST.tcv_+3A_progress">progress</code></td>
<td>
<p>whether a progress bar shall be printed for spatio-temporal inverse-distance weighted function; default=TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Leave-one-out cross validation (LOOCV) consists of removing data, one at a time, and then trying to predict it. Next, the predicted value can be compared to the actual (observed) value to assess how well the prediction is working. The observed value is left out because <em>idwST</em> would otherwise predict the value itself.
</p>


<h3>Value</h3>

<p>data frame contain prediction columns, observed values, residuals, the prediction variance, zscore (residual divided by standard error)
which left with NA's, the fold column which is associated to cross-validation count, coordinates data and time. Prediction columns and residuals are obtained from cross-validation data points.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+idwST">idwST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y
idw.t &lt;- idwST.tcv(MTEMP~1, croatiadb, n.neigh=10, C=1.0054, factor.p=1.9585)
criteriaST.cv(idw.t)

## End(Not run)
</code></pre>

<hr>
<h2 id='rbfST'>
gaussian, exponential, trigonometric, thin plate spline, inverse multiquadratic, and multiquadratic radial basis function for spatio-temporal prediction
</h2><span id='topic+rbfST'></span>

<h3>Description</h3>

               
<p>Function for spatio-temporal interpolation from radial basis function (<em>rbfST</em>), where <em>rbfST</em> is in a local neighbourhood.
</p>
<p><em>exponential (EXPON)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">
\phi(\delta)=e^{-\eta \delta},   \eta&gt;0
</code>
</p>

<p><em>gaussiano (GAU)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">
\phi(\delta)=e^{-\eta \delta^{2}},    \eta\neq0
</code>
</p>

<p><em>multiquadratic (M)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">
\phi(\delta)=\sqrt{\eta^2+\delta^2},   \eta\neq0
</code>
</p>

<p><em>inverse multiquadratic (IM)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">
\phi(\delta)=1/\sqrt{\eta^2+\delta^2},   \eta\neq0
</code>
</p>

<p><em>thin plate spline (TPS)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">\phi(\delta)=(\eta\cdot\delta)^{2}log(\eta\cdot\delta), if: \delta&gt;0, \eta&gt;0</code>
</p>

<p style="text-align: center;"><code class="reqn">\phi(\delta) = 0, otherwise</code>
</p>

<p><em>completely regularized spline (CRS)</em><br />
</p>
<p style="text-align: center;"><code class="reqn">\phi(\delta) = \ln(\eta\cdot \delta/2)^{2}+E_{1}(\eta\cdot \delta/2)^{2}+C_{E}, if: \delta&gt;0, \eta&gt;0</code>
</p>

<p style="text-align: center;"><code class="reqn">\phi(\delta) = 0, otherwise</code>
</p>

<p>where <code class="reqn">\ln</code> is natural logarithm, <code class="reqn">E_{1}(x)</code> is the exponential integral function, and <code class="reqn">C_{E}</code> is the Euler constant.
</p>
<p><em>spline with tension (ST)</em>
</p>
<p style="text-align: center;"><code class="reqn">
\phi(\delta)=\ln(\eta\cdot \delta/2)+K_{0}(\eta\cdot \delta)+C_{E}, if: \delta&gt;0
</code>
</p>

<p style="text-align: center;"><code class="reqn">\phi(\delta) = 0, otherwise</code>
</p>

<p>where <code class="reqn">K_{0}(x)</code> is the modified Bessel function and <code class="reqn">C_{E}</code> is the Euler constant.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbfST(formula, data, eta, rho, newdata, n.neigh, func, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbfST_+3A_formula">formula</code></td>
<td>
<p>formula that defines the dependent variable as a linear model of independent variables (covariates or principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code> for a <em>rbfST</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>; for a <em>rbfST</em> with trend suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).</p>
</td></tr>
<tr><td><code id="rbfST_+3A_data">data</code></td>
<td>
<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.</p>
</td></tr>
<tr><td><code id="rbfST_+3A_eta">eta</code></td>
<td>
<p>the optimal smoothing parameter, we recommend using the parameter
found by minimizing the root-mean-square prediction errors using cross-validation</p>
</td></tr>
<tr><td><code id="rbfST_+3A_rho">rho</code></td>
<td>
<p>optimal robustness parameter, we recommend using the value obtained by minimizing the root-mean-square prediction errors with cross-validation. <em>eta</em> and <em>rho</em> parameters can be optimized simultaneously, through the <code><a href="minqa.html#topic+bobyqa">bobyqa</a></code> function from <code>nloptr</code> or  <code>minqa</code> packages</p>
</td></tr>
<tr><td><code id="rbfST_+3A_newdata">newdata</code></td>
<td>
<p>data frame or spatial object with prediction/simulation spatio-temporal locations; should contain attribute columns with the independent variables (if present) and (if locations is a formula) the coordinates and time with names, as defined in locations where you want to generate new predictions</p>
</td></tr>
<tr><td><code id="rbfST_+3A_n.neigh">n.neigh</code></td>
<td>
<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations</p>
</td></tr>
<tr><td><code id="rbfST_+3A_func">func</code></td>
<td>
<p>spatio-temporal radial basis function; model type: &quot;GAU&quot;, &quot;EXPON&quot;, &quot;TRI&quot;, &quot;TPS&quot;, &quot;CRS&quot;, &quot;ST&quot;, &quot;IM&quot; and &quot;M&quot;, are currently available</p>
</td></tr>
<tr><td><code id="rbfST_+3A_progress">progress</code></td>
<td>

<p>whether a progress bar shall be printed for spatio-temporal radial basis functions; default=TRUE
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>rbf.st function generates individual spatio-temporal predictions from gaussian (GAU), exponential (EXPON), trigonometric (TRI) thin plate spline (TPS), completely regularized spline (CRS), spline with tension (ST), 
inverse multiquadratic (IM), and multiquadratic (M) functions
</p>


<h3>Value</h3>

<p>Attributes columns contain coordinates, time, predictions, and the variance
column contains NA's
</p>


<h3>References</h3>

<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# considering 10 principal coordinates (constructed from a distance-based regression model)
data(croatia.temp)
data(croatiadb)

# prediction case: one point
point &lt;- data.frame(670863,5043464,5,170,200,15.7,3)
names(point) &lt;- c("x","y","t","dem","dsea","twi","est")

croatia.temp[,7] &lt;- as.factor(croatia.temp[,7])
dblm1 &lt;- dblm(data=croatia.temp,y=croatiadb$MTEMP)         
newdata1 &lt;- t(cp.xnews(newdata=point,eigenvalues=dblm1$ev, data=croatia.temp,trend=dblm1$cp))
colnames(newdata1) &lt;- c("X1","X2","X3","X4","X5","X6","X7","X8","X9","X10")
newdata1 &lt;- data.frame(point[,1:3],newdata1)

data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y
coordinates(newdata1) &lt;- ~x+y
rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, eta=0.010076, rho=0.00004, 
       newdata=newdata1, n.neigh=60, func="TPS")

# prediction case: a grid of points Croatia (month july)
data(croatia.grid7cp)
coordinates(croatia.grid7cp) &lt;- ~x+y
rbf.t &lt;- rbfST(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, croatiadb, eta=0.01076, rho=0.00004, 
                newdata=croatia.grid7cp, n.neigh=30, func="TPS")                  
coordinates(rbf.t) &lt;- c("x", "y")
gridded(rbf.t) &lt;- TRUE

# show prediction map
spplot(rbf.t["var1.pred"], cuts=30, col.regions=bpy.colors(40), main = "Earth's average 
       temperature TPS map\n (july month)", key.space=list(space="right", cex=0.8))

## End(Not run)
</code></pre>

<hr>
<h2 id='rbfST.cv'>
Leave-one-out cross validation for spatio-temporal radial basis function 
</h2><span id='topic+rbfST.cv'></span>

<h3>Description</h3>

<p>It generates the RMSPE value, which is given by the radial basis function
with smoothing <code>eta</code> and robustness <code>rho</code> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbfST.cv(formula, data, eta, rho, n.neigh, func)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbfST.cv_+3A_formula">formula</code></td>
<td>

<p>formula that defines the dependent variable as a linear model of independent variables (covariates or the principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code>, for a <em>rbfST</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>, for a <em>rbfST</em> with trend, suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).
</p>
</td></tr>
<tr><td><code id="rbfST.cv_+3A_data">data</code></td>
<td>

<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.
</p>
</td></tr>
<tr><td><code id="rbfST.cv_+3A_eta">eta</code></td>
<td>

<p>the optimal smoothing parameter, we recommend using the parameter found by minimizing the root-mean-square prediction errors using cross-validation.
</p>
</td></tr>
<tr><td><code id="rbfST.cv_+3A_rho">rho</code></td>
<td>

<p>optimal robustness parameter, we recommend using the value obtained by minimizing the root-mean-square prediction errors with cross-validation. <em>eta</em> and <em>rho</em> parameters can be optimized simultaneously, through 
the <code><a href="minqa.html#topic+bobyqa">bobyqa</a></code> function from <code>nloptr</code> or  <code>minqa</code> packages.
</p>
</td></tr>
<tr><td><code id="rbfST.cv_+3A_n.neigh">n.neigh</code></td>
<td>

<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations.
</p>
</td></tr>
<tr><td><code id="rbfST.cv_+3A_func">func</code></td>
<td>

<p>spatio-temporal radial basis function; model type: &quot;GAU&quot;, &quot;EXPON&quot;, &quot;TRI&quot;, &quot;TPS&quot;, &quot;CRS&quot;, &quot;ST&quot;, &quot;IM&quot; and &quot;M&quot;, are currently available</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the RMSPE value
</p>


<h3>References</h3>

<p>Melo, C. E. (2012). <em>Analisis geoestadistico espacio tiempo basado en distancias y splines con
aplicaciones</em>. PhD. Thesis. Universitat de Barcelona. 276 p. <a href="http://www.tdx.cat/bitstream/handle/10803/101202/CEMM_TESIS.pdf">[link]</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbfST">rbfST</a></code>, <code><a href="#topic+graph.rbfST">graph.rbfST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y
rbfST.cv(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, croatiadb, eta=0.0108, rho=0.00004, 
          n.neigh=25, func="TPS")
</code></pre>

<hr>
<h2 id='rbfST.cv1'>
RMSPE value result of leave-one-out cross validation for <em>rbfST</em>
</h2><span id='topic+rbfST.cv1'></span>

<h3>Description</h3>

<p>It generates the RMSPE value which is given by the spatio-temporal radial basis function
with smoothing <em>eta</em> and robustness <em>rho</em> parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbfST.cv1(param, formula, data, n.neigh, func)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbfST.cv1_+3A_param">param</code></td>
<td>

<p>vector starting points (<em>eta</em> and <em>rho</em> respectively) for searching the <em>RMSPE</em> optimum.
</p>
</td></tr>
<tr><td><code id="rbfST.cv1_+3A_formula">formula</code></td>
<td>

<p>formula that defines the dependent variable as a linear model of independent variables (covariates or the principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code>, for a <em>rbfST</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>, for a <em>rbfST</em> with trend, suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).
</p>
</td></tr>
<tr><td><code id="rbfST.cv1_+3A_data">data</code></td>
<td>

<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.
</p>
</td></tr>
<tr><td><code id="rbfST.cv1_+3A_n.neigh">n.neigh</code></td>
<td>

<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations.
</p>
</td></tr>
<tr><td><code id="rbfST.cv1_+3A_func">func</code></td>
<td>

<p>spatio-temporal radial basis function; model type: &quot;GAU&quot;, &quot;EXPON&quot;, &quot;TRI&quot;, &quot;TPS&quot;, &quot;CRS&quot;, &quot;ST&quot;, &quot;IM&quot; and &quot;M&quot;, are currently available</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns the RMSPE value
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbfST">rbfST</a></code>, <code><a href="#topic+rbfST.cv">rbfST.cv</a></code>, <code><a href="#topic+graph.rbfST">graph.rbfST</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(minqa)
data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y

## Not run: 
rbf.im &lt;- bobyqa(c(0.5, 0.5), rbfST.cv1, lower=c(1e-05,0), upper=c(2,2), 
              formula=MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, data=croatiadb, n.neigh=25, 
              func="IM", control=list(maxfun=50))         

## End(Not run)

# obtained with the optimal values previously estimated
rbfST.cv1(c(0.847050095690357,0.104157855356128), MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, 
           croatiadb, n.neigh=25, func="IM")
</code></pre>

<hr>
<h2 id='rbfST.tcv'>
table of rbf spatio-temporal cross validation, leave-one-out
</h2><span id='topic+rbfST.tcv'></span>

<h3>Description</h3>

<p>It generates a table with the results of the evaluation of radial basis functions spatio-temporal (<em>rbfST</em>): gaussian (GAU), exponential (EXPON), trigonometric (TRI), thin plate spline (TPS), completely regularized spline (CRS), spline with tension (ST), inverse multiquadratic (IM), and multiquadratic (M) from the leave-one-out cross validation method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rbfST.tcv(formula, data, eta, rho, n.neigh, func, progress)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rbfST.tcv_+3A_formula">formula</code></td>
<td>

<p>formula that defines the dependent variable as a linear model of independent variables (covariates or the principal coordinates); suppose the dependent variable has name <code class="reqn">z_{st}</code>, for a <em>rbf.st</em> detrended use <code class="reqn">z_{st}</code><code>~1</code>, for a <em>rbf.st</em> with trend, suppose <code class="reqn">z_{st}</code> is linearly dependent on <code>x</code> and <code>y</code>, use the formula <code class="reqn">z_{st}</code><code>~x+y</code> (linear trend).
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_data">data</code></td>
<td>

<p>SpatialPointsDataFrame: should contain the spatio-temporal dependent variable, independent variables (statics and/or dynamics), spatial coordinates and the time as an integer or numerical variable.
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_eta">eta</code></td>
<td>

<p>the optimal smoothing parameter; we recommend using the parameter found by minimizing the root-mean-square prediction errors using cross-validation
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_rho">rho</code></td>
<td>

<p>optimal robustness parameter, we recommend using the value obtained by minimizing the root-mean-square prediction errors with cross-validation. <em>eta</em> and <em>rho</em> parameters can be optimized simultaneously, through the <code><a href="minqa.html#topic+bobyqa">bobyqa</a></code> function from <code>nloptr</code> or  <code>minqa</code> packages
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_n.neigh">n.neigh</code></td>
<td>

<p>number of nearest observations that should be used for a <em>rbfST</em>
prediction, where nearest is defined in terms of the spatio-temporal locations.
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_func">func</code></td>
<td>

<p>spatio-temporal radial basis function; model type: &quot;GAU&quot;, &quot;EXPON&quot;, &quot;TRI&quot;, &quot;TPS&quot;, &quot;CRS&quot;, &quot;ST&quot;, &quot;IM&quot; and &quot;M&quot;, are currently available
</p>
</td></tr>
<tr><td><code id="rbfST.tcv_+3A_progress">progress</code></td>
<td>

<p>whether a progress bar shall be printed for spatio-temporal radial basis functions; default=TRUE
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Leave-one-out cross validation (LOOCV) visits a data point, predicts
the value at that location by leaving out the observed value, and
proceeds with the next data point. The observed value is left out
because rbf.st would otherwise predict the value itself.
</p>


<h3>Value</h3>

<p>data frame contain prediction columns, observed values, residuals, 
the prediction variance, zscore (residual divided by standard error) 
which left with NA's, the fold column which is associated to 
cross-validation count, coordinates data and time. Prediction columns and residuals are obtained 
from cross-validation data points.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rbfST">rbfST</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(croatiadb)
coordinates(croatiadb) &lt;- ~x+y
rbfST.tcv(MTEMP~X1+X2+X3+X4+X5+X6+X7+X8+X9+X10, croatiadb, eta=0.0108, rho=0.00004, 
          n.neigh=30, func="TPS")
</code></pre>

<hr>
<h2 id='standardize'>
standardize internal function
</h2><span id='topic+standardize'></span>

<h3>Description</h3>

<p>standardize internal function
</p>


<h3>Note</h3>

<p>This function is not meant to be called by users directly
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
