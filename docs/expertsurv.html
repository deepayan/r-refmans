<!DOCTYPE html><html><head><title>Help for package expertsurv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {expertsurv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cred_int'><p>Credible interval for pooled distribution</p></a></li>
<li><a href='#data'><p>A fictional survival trial taken directly from survHE.</p></a></li>
<li><a href='#elicit_surv'><p>Elicit survival judgements interactively and estimate survival models</p></a></li>
<li><a href='#expertsurv-package'><p>Incorporating Expert Opinion with Parametric Survival Models</p></a></li>
<li><a href='#fit.models.expert'><p>Fitting Parametric Survival models with Expert Opinion</p></a></li>
<li><a href='#make.surv'><p>Engine for Probabilistic Sensitivity Analysis on the survival curves</p></a></li>
<li><a href='#model.fit.plot'><p>Graphical representation of the measures of model fitting based on Information Criteria</p></a></li>
<li><a href='#plot_expert_opinion'><p>Plotting Pooled Expert Opinion</p></a></li>
<li><a href='#plot.expertsurv'><p>Plot survival curves for the models fitted using <code>fit.models</code></p></a></li>
<li><a href='#print.expertsurv'><p>Print a summary of the survival model(s) fitted by <code>fit.models</code></p></a></li>
<li><a href='#psa.plot'><p>Graphical depiction of the probabilistic sensitivity analysis for the</p>
survival curves - ported from <code>survHE</code></a></li>
<li><a href='#summary.expertsurv'><p>Prints a summary table for the distribution the mean survival time for a</p>
given model and data</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Incorporate Expert Opinion with Parametric Survival Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Enables users to incorporate expert opinion with parametric survival analysis using a Bayesian or frequentist approach. Expert Opinion can be provided on the survival probabilities at certain time-point(s) or for the difference in mean survival between two treatment arms.Please reference its use as Cooney, P., White, A. (2023) &lt;<a href="https://doi.org/10.1177%2F0272989X221150212">doi:10.1177/0272989X221150212</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>abind, dplyr, flexsurv (&ge; 2.0), ggplot2, loo, magrittr (&ge;
2.0), methods, Rcpp (&ge; 0.12.0), RcppParallel (&ge; 5.0.1),
Rdpack, rlang, rms, rstan (&ge; 2.26.0), rstantools (&ge; 2.2.0),
scales, SHELF, stats, stringr, tibble, tidyselect, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.66.0), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1), rstan (&ge; 2.26.0), StanHeaders (&ge;
2.26.0)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make, C++17</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, bookdown, knitr, rjags, R2jags, xlsx, shiny,
shinyWidgets, shinycssloaders, shinyjs, shinyMatrix, shinybusy,
ggpubr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-04 14:49:43 UTC; phili</td>
</tr>
<tr>
<td>Author:</td>
<td>Philip Cooney <a href="https://orcid.org/0000-0001-9649-0195"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Arthur White <a href="https://orcid.org/0000-0002-7268-5163"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philip Cooney &lt;phcooney@tcd.ie&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-04 18:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cred_int'>Credible interval for pooled distribution</h2><span id='topic+cred_int'></span>

<h3>Description</h3>

<p>Returns the interval based on defined quantiles.
The approach used only provides an approximate (although quite accurate) integral.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cred_int(plt_obj, val = "linear pool", interval = c(0.025, 0.975))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cred_int_+3A_plt_obj">plt_obj</code></td>
<td>
<p>A plot object from <code>plot_expert_opinion</code>.</p>
</td></tr>
<tr><td><code id="cred_int_+3A_val">val</code></td>
<td>
<p>The name of the opinion for which the interval will be generated.</p>
</td></tr>
<tr><td><code id="cred_int_+3A_interval">interval</code></td>
<td>
<p>A vector of the upper and lower probabilities. Default is the standard 95% interval</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Credible interval based on the pooled distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm","t"),
    wi = c(0.5,0.5), # Ensure Weights sum to 1
    param1 = c(0.1,0.12),
    param2 = c(0.005,0.005),
    param3 = c(NA,3))
plot_opinion1&lt;- plot_expert_opinion(param_expert_example1[[1]], 
              weights = param_expert_example1[[1]]$wi)
cred_int(plot_opinion1,val = "linear pool", interval = c(0.025, 0.975))


</code></pre>

<hr>
<h2 id='data'>A fictional survival trial taken directly from survHE.</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>A dataset containing fictional data from a trial, where
the main outcome is in terms of time-to-event and
censoring indicator and with additional covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data
</code></pre>


<h3>Format</h3>

<p>A data frame with 367 rows and 8 variables:
</p>

<dl>
<dt>ID_patient</dt><dd><p>The individual level identifier</p>
</dd>
<dt>time</dt><dd><p>The observed time at which the event happens</p>
</dd>
<dt>censored</dt><dd><p>An indicator to describe whether the
event is fully observed or censored</p>
</dd>
<dt>arm</dt><dd><p>An indicator for the treatment arm, with
0 = control and 1 = active treatment</p>
</dd>
<dt>sex</dt><dd><p>An indicator for the individual's sex, with
0 = male and 1 = female</p>
</dd>
<dt>age</dt><dd><p>A numeric variable with the individual's age</p>
</dd>
<dt>imd</dt><dd><p>A categorical variable representing a measure
of area-level social deprivation</p>
</dd>
<dt>ethnic</dt><dd><p>A categorical variable representing the
individual's ethnic group, as measured from a Census</p>
</dd>
</dl>



<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>

<hr>
<h2 id='elicit_surv'>Elicit survival judgements interactively and estimate survival models</h2><span id='topic+elicit_surv'></span>

<h3>Description</h3>

<p>Opens up a web browser (using the shiny package), from which you can specify
judgements and fit distributions for multiple timepoints and experts.
Plots of the fitted density functions are provided overlayed on the survival data (where appropriate).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elicit_surv()
</code></pre>


<h3>Details</h3>

<p>Once the elicitation is complete the analysis can be run.
Click &quot;Download R objects&quot; to download the <code>expertsurv</code> object generated from the analysis.
Click &quot;Download report&quot; to generate a report including plots and parameter values for the parametric survival models.
</p>
<p>For detailed instructions use <code>browseVignettes("expertsurv")</code>
</p>


<h3>Author(s)</h3>

<p>Philip Cooney <a href="mailto:phcooney@tcd.ie">phcooney@tcd.ie</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

elicit_surv()


## End(Not run)
</code></pre>

<hr>
<h2 id='expertsurv-package'>Incorporating Expert Opinion with Parametric Survival Models</h2><span id='topic+expertsurv-package'></span><span id='topic+expertsurv'></span>

<h3>Description</h3>

<p>Contains functions to include expert opinion with the parametric models commonly
used in health economic modelling. Theoretical details are described elsewhere (Cooney and White 2023).  Borrows many function from the <code>survHE</code> package (Baio 2020).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> expertsurv </td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
1.3.0</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2023-09-22</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> MIT + file LICENSE </td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;">
yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
<p> Integrate expert opinions on survival and mean differences in survival with common parametric survival models using either a Bayesian or frequentist framework.
</p>


<h3>Author(s)</h3>

<p>Philip Cooney Package Creator, Maintainer
</p>
<p>Arthur White  Thesis Supervisor
</p>


<h3>References</h3>

<p>P Cooney (2023). expertsurv: Incorporating expert opinion into parametric survival models.
</p>
<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>
<p>Cooney P, White A (2023).
&ldquo;Direct Incorporation of Expert Opinion into Parametric Survival Models to Inform Survival Extrapolation.&rdquo;
<em>Medical Decision Making</em>, <b>1</b>(1), 0272989X221150212.
<a href="https://doi.org/10.1177/0272989X221150212">doi:10.1177/0272989X221150212</a>, PMID: 36647200,   https://doi.org/10.1177/0272989X221150212 , <a href="https://doi.org/10.1177/0272989X221150212">https://doi.org/10.1177/0272989X221150212</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define expert opinion
require("dplyr")
param_expert_example1 &lt;- list()
#1 timepoint and 2 experts with equal weight,
#first a normal distribution, second a non-standard t-distribution with
#3 degrees of freedom

param_expert_example1[[1]] &lt;- data.frame(dist = c("norm","t"),
                               wi = c(0.5,0.5), # Ensure Weights sum to 1
                               param1 = c(0.1,0.12),
                               param2 = c(0.05,0.05),
                                param3 = c(NA,3))


timepoint_expert &lt;- 14

data2 &lt;- data %&gt;% rename(status = censored) %&gt;% mutate(time2 = ifelse(time &gt; 10, 10, time),
                  status2 = ifelse(time&gt; 10, 0, status))

example1  &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                              distr=c("wph", "gomp"),
                              method="mle",
                              pool_type = "log pool", 
                              opinion_type = "survival",
                              times_expert = timepoint_expert, 
                              param_expert = param_expert_example1)

 #Visualize the goodness of fit
 model.fit.plot(example1, type = "aic")
 #Visualize the survival curve
 plot(example1, add.km = TRUE, t = 0:30)


</code></pre>

<hr>
<h2 id='fit.models.expert'>Fitting Parametric Survival models with Expert Opinion</h2><span id='topic+fit.models.expert'></span>

<h3>Description</h3>

<p>Implementation of survival models with expert opinion on the survival probabilities or expected difference in survival.
Function is equivalent to the <code>fit.models</code> in <code>survHE</code> except for the inclusion of the &quot;expert_type&quot; and &quot;param_expert&quot; arguments.
Worked examples can be found in the <a href="https://github.com/Philip-Cooney/expertsurv/blob/master/README.md">README</a> file.
Note that the default method is &quot;hmc&quot;, however, the user may use &quot;mle&quot;  (method &quot;inla&quot; is not included).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.models.expert(
  formula = NULL,
  data,
  distr = NULL,
  method = "hmc",
  expert_type = "survival",
  param_expert = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.models.expert_+3A_formula">formula</code></td>
<td>
<p>As per <code>fit.models</code> in <code>survHE</code></p>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_data">data</code></td>
<td>
<p>As per <code>fit.models</code> in <code>survHE</code></p>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_distr">distr</code></td>
<td>
<p>As per <code>fit.models</code> in <code>survHE</code>. Note Generalized F model is not available for method = &quot;hmc&quot; nor Royston-Parmar available with opinion on the mean survival.</p>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_method">method</code></td>
<td>
<p>As per <code>fit.models</code> in <code>survHE</code>. (except for the inla method). It should be noted that a few of the models are fit using JAGS, however, for consistency we still use &quot;hmc&quot;.</p>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_expert_type">expert_type</code></td>
<td>
<p>Either &quot;survival&quot;, which indicates expert opinion on the survival function or &quot;mean&quot; (actually anything that does not contain &quot;survival&quot;) which represents a belief on difference in survival.</p>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_param_expert">param_expert</code></td>
<td>
<p>A list containing a dataframe for each timepoint (if applicable). Each dataframe should have columns with the following names and each row representing an expert:
</p>

<ul>
<li> <p><strong>dist</strong>: Names of the distribution assigned to each expert which may be &quot;norm&quot;, &quot;t&quot;, &quot;lnorm&quot;, &quot;gamma&quot;, &quot;beta&quot;.
</p>
</li>
<li> <p><strong>wi</strong>: Weight of the expert, must sum to 1.
</p>
</li>
<li> <p><strong>param1</strong>: First parameter of the distribution (e.g. mean for norm distribution). Parameters as per <code>SHELF</code> package.
</p>
</li>
<li> <p><strong>param2</strong>: Second parameter of the distribution.
</p>
</li>
<li> <p><strong>param3</strong>: Third parameter of the distribution (NA expect for degrees of freedom for t distribution)
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit.models.expert_+3A_...">...</code></td>
<td>
<p>Other arguments may be required depending on the example. See <a href="https://github.com/Philip-Cooney/expertsurv/blob/master/README.md">README</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>expertsurv</code> which contains the parameters of the models estimated with expert opinion.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("dplyr")
#Expert Opinion as a normal distribution centered on 0.1 with sd 0.005
param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm"),
                                         wi = c(1), # Ensure Weights sum to 1
                                         param1 = c(0.1),
                                         param2 = c(0.05),
                                        param3 = c(NA))
timepoint_expert &lt;- 14 # Expert opinion at t = 14

data2 &lt;- data %&gt;% rename(status = censored) %&gt;% mutate(time2 = ifelse(time &gt; 10, 10, time),
status2 = ifelse(time&gt; 10, 0, status))

example1  &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                              distr=c("wei", "gomp"),
                              method="mle",
                              opinion_type = "survival",
                              times_expert = timepoint_expert, 
                              param_expert = param_expert_example1)
                              
plot(example1, add.km = TRUE, t = seq(0:20)) #Plot Survival
model.fit.plot(example1, type = "aic")  #Plot AIC 

                              
</code></pre>

<hr>
<h2 id='make.surv'>Engine for Probabilistic Sensitivity Analysis on the survival curves</h2><span id='topic+make.surv'></span>

<h3>Description</h3>

<p>Creates the survival curves for the fitted model(s) - Original code from <code>survHE</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.surv(fit, mod = 1, t = NULL, newdata = NULL, nsim = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make.surv_+3A_fit">fit</code></td>
<td>
<p>the result of the call to the <code>fit.models</code> function,
containing the model fitting (and other relevant information)</p>
</td></tr>
<tr><td><code id="make.surv_+3A_mod">mod</code></td>
<td>
<p>the index of the model. Default value is 1, but the user can
choose which model fit to visualise, if the call to fit.models has a vector
argument for distr (so many models are fitted &amp; stored in the same object)</p>
</td></tr>
<tr><td><code id="make.surv_+3A_t">t</code></td>
<td>
<p>the time vector to be used for the estimation of the survival curve</p>
</td></tr>
<tr><td><code id="make.surv_+3A_newdata">newdata</code></td>
<td>
<p>a list (of lists), specifiying the values of the covariates
at which the computation is performed. For example
<code>list(list(arm=0),list(arm=1))</code> will create two survival curves, one
obtained by setting the covariate <code>arm</code> to the value 0 and the other by
setting it to the value 1. In line with <code>flexsurv</code> notation, the user
needs to either specify the value for <em>all</em> the covariates or for none (in
which case, <code>newdata=NULL</code>, which is the default). If some value is
specified and at least one of the covariates is continuous, then a single
survival curve will be computed in correspondence of the average values of
all the covariates (including the factors, which in this case are expanded
into indicators).</p>
</td></tr>
<tr><td><code id="make.surv_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations from the distribution of the survival
curves. Default at <code>nsim=1</code>, in which case uses the point estimate for
the relevant distributional parameters and computes the resulting survival
curve</p>
</td></tr>
<tr><td><code id="make.surv_+3A_...">...</code></td>
<td>
<p>Additional options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with survival times for the fitted models
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>See Also</h3>

<p><code>psa.plot</code> (for example)
</p>

<hr>
<h2 id='model.fit.plot'>Graphical representation of the measures of model fitting based on Information Criteria</h2><span id='topic+model.fit.plot'></span>

<h3>Description</h3>

<p>Plots a summary of the model fit for all the models fitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model.fit.plot(..., type = "dic")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model.fit.plot_+3A_...">...</code></td>
<td>
<p>Optional inputs. Must include an <code>expertsurv</code> object.</p>
</td></tr>
<tr><td><code id="model.fit.plot_+3A_type">type</code></td>
<td>
<p>should the DIC, WAIC, PML be plotted (AIC, BIC also allowed but only valid for frequentist approach).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot with the relevant model fitting statistics plotted in order of fit.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("dplyr")
param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm"),
                                         wi = c(1), # Ensure Weights sum to 1
                                         param1 = c(0.1),
                                         param2 = c(0.05),
                                         param3 = c(NA))
timepoint_expert &lt;- 14 # Expert opinion at t = 14


data2 &lt;- expertsurv::data %&gt;% rename(status = censored) %&gt;% 
mutate(time2 = ifelse(time &gt; 10, 10, time),
status2 = ifelse(time&gt; 10, 0, status))
example1  &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                              distr=c("wei", "gomp"),
                              method="mle",
                              pool_type = "linear pool", 
                              opinion_type = "survival",
                              times_expert = timepoint_expert, 
                              param_expert = param_expert_example1)


model.fit.plot(example1, type = "aic")


</code></pre>

<hr>
<h2 id='plot_expert_opinion'>Plotting Pooled Expert Opinion</h2><span id='topic+plot_expert_opinion'></span>

<h3>Description</h3>

<p>Returns a ggplot with the individual expert opinions along with the pooled distributions (both linear and logarithmic).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_expert_opinion(
  object,
  xl_plt = NULL,
  xu_plt = NULL,
  weights = NULL,
  St_indic = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_expert_opinion_+3A_object">object</code></td>
<td>
<p>Either a object of class elicitation (from <code>SHELF</code>) or a dataframe with parameters of the distribution (see Example below).</p>
</td></tr>
<tr><td><code id="plot_expert_opinion_+3A_xl_plt">xl_plt</code></td>
<td>
<p>Optionally set the lower bound for the plot</p>
</td></tr>
<tr><td><code id="plot_expert_opinion_+3A_xu_plt">xu_plt</code></td>
<td>
<p>Optionally set the upper bound for the plot</p>
</td></tr>
<tr><td><code id="plot_expert_opinion_+3A_weights">weights</code></td>
<td>
<p>A vector with the weight of each expert. If omitted, set to equal weights.</p>
</td></tr>
<tr><td><code id="plot_expert_opinion_+3A_st_indic">St_indic</code></td>
<td>
<p>Set to 1 if you want to truncate the distributions to be between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot with pooled distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> expert_df &lt;- data.frame(dist = c("norm","t"), #Distribution Name
                         wi = c(1/3,2/3), #Expert weights
                         param1 = c(0.3,0.40), #Parameter 1
                         param2 = c(0.05,0.05),# Parameter 2
                         param3 = c(NA,3)) #Parameter 3: Only t-distribution
 plot_expert_opinion(expert_df , weights = expert_df$wi)

                                                        
</code></pre>

<hr>
<h2 id='plot.expertsurv'>Plot survival curves for the models fitted using <code>fit.models</code></h2><span id='topic+plot.expertsurv'></span>

<h3>Description</h3>

<p>Plots the results of model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expertsurv'
plot(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.expertsurv_+3A_...">...</code></td>
<td>
<p>Must include at least one result object saved as
the call to the <code>fit.models</code> function. Nay include other
optional parameters. These include whether the KM curve should be
added <code>add.km</code> and whether the user specifies a profile of covariates
(in the list <code>newdata</code>). Other possibilities are additional
(mainly graphical) options. These are: <code>xlab</code> = a string with the label
for the x-axis (default = &quot;time&quot;) <code>ylab</code> = a string with the label for the
y-axis (default = &quot;Survival&quot;) <code>lab.profile</code> = a (vector of) string(s)
indicating the labels associated with the strata defining the different
survival curves to plot. Default to the value used by the Kaplan Meier
estimate given in <code>fit.models</code>. <code>newdata</code> = a list (of lists)
providing the values for the relevant covariates If NULL, then will use
the mean values for the covariates if at least one is a continuous variable,
or the combination of the categorical covariates. <code>xlim</code> = a vector
determining the limits for the x-axis <code>colors</code> = a vector of characters
defining the colours in which to plot the different survival curves
<code>lab.profile</code> = a vector of characters defining the names of the models fitted
<code>add.km</code> = TRUE (whether to also add the Kaplan Meier estimates of the data)
<code>annotate</code> = FALSE (whether to also add text to highlight the observed vs
extrapolated data)
<code>legend.position</code> = a vector of proportions to place the legend. Default
to 'c(.75,.9)', which means 75% across the x-axis and 90% across the y-axis
<code>legend.title</code> = suitable instructions to format the title of the legend;
defaults to 'element_text(size=15,face=&quot;bold&quot;)' but there may be other
arguments that can be added (using 'ggplot' facilities)
<code>legend.text</code> = suitable instructions to format the text of the legend;
defaults to 'element_text(colour=&quot;black&quot;, size=14, face=&quot;plain&quot;)' but there
may be other arguments that can be added (using 'ggplot' facilities)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 object of the survival curves.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>See Also</h3>

<p><code>fit.models</code>, <code>write.surv</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("dplyr")
param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm","t"),
                                         wi = c(0.5,0.5), # Ensure Weights sum to 1
                                         param1 = c(0.1,0.12),
                                         param2 = c(0.15,0.5),
                                         param3 = c(NA,3))

timepoint_expert &lt;- 14
data2 &lt;- data %&gt;% rename(status = censored) %&gt;% mutate(time2 = ifelse(time &gt; 10, 10, time),
                                                       status2 = ifelse(time&gt; 10, 0, status))
example1_mle &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                                  distr=c("wph", "exp"),
                                  method="mle",
                                  pool_type = "log pool",
                                 opinion_type = "survival",
                                  times_expert = timepoint_expert,
                                  param_expert = param_expert_example1)

#Warning! 50 iterations is far too few, however, it has been done so that the 
#example can be run for CRAN
example1_bayes &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                                    distr=c("wph", "exp"),
                                    method="hmc",
                                    iter = 50,
                                    pool_type = "log pool",
                                    opinion_type = "survival",
                                    times_expert = timepoint_expert,
                                    param_expert = param_expert_example1)

plot(MLE=example1_mle,Bayesian=example1_bayes, add.km = TRUE, t = 0:30)

</code></pre>

<hr>
<h2 id='print.expertsurv'>Print a summary of the survival model(s) fitted by <code>fit.models</code></h2><span id='topic+print.expertsurv'></span>

<h3>Description</h3>

<p>Prints the summary table for the model(s) fitted, with the estimate of the
parameters - ported from <code>survHE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expertsurv'
print(x, mod = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.expertsurv_+3A_x">x</code></td>
<td>
<p>the <code>expertsurv</code> object (the output of the call to
<code>fit.models</code>)</p>
</td></tr>
<tr><td><code id="print.expertsurv_+3A_mod">mod</code></td>
<td>
<p>is the index of the model. Default value is 1, but the user can
choose which model fit to visualise, if the call to fit.models has a vector
argument for distr (so many models are fitted &amp; stored in the same object)</p>
</td></tr>
<tr><td><code id="print.expertsurv_+3A_...">...</code></td>
<td>
<p>additional options, including: <code>digits</code> = number of
significant digits to be shown in the summary table (default = 6)
<code>original</code> = a flag to say whether the <em>original</em> table
from either <code>flexsurv</code> or <code>rstan/JAGS</code> should be printed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Printed message (no object returned) providing estimates of the survival models.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("dplyr")
param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm","t"),
                                         wi = c(0.5,0.5), # Ensure Weights sum to 1
                                       param1 = c(0.1,0.12),
                                      param2 = c(0.15,0.5),
                                       param3 = c(NA,3))
timepoint_expert &lt;- 14
data2 &lt;- data %&gt;% rename(status = censored) %&gt;% mutate(time2 = ifelse(time &gt; 10, 10, time),
                                                       status2 = ifelse(time&gt; 10, 0, status))
mle = example1 &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                   distr=c("wph", "gomp"),
                   method="mle",
                   pool_type = "log pool",
                   opinion_type = "survival",
                   times_expert = timepoint_expert,
                   param_expert = param_expert_example1)
print(mle)
</code></pre>

<hr>
<h2 id='psa.plot'>Graphical depiction of the probabilistic sensitivity analysis for the
survival curves - ported from <code>survHE</code></h2><span id='topic+psa.plot'></span>

<h3>Description</h3>

<p>Plots the survival curves for all the PSA simulations. The function is
actually deprecated - similar graphs can be obtained directly using
the <code>plot</code> method (with options), which allows a finer depiction
of the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psa.plot(psa, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psa.plot_+3A_psa">psa</code></td>
<td>
<p>the result of the call to the function <code>make.surv</code></p>
</td></tr>
<tr><td><code id="psa.plot_+3A_...">...</code></td>
<td>
<p>Optional graphical parameters, such as: <code>xlab</code> = label for
the x-axis <code>ylab</code> = label for the y-axis <code>col</code> = (vector) of
colors for the lines to be plotted <code>alpha</code> = the level of transparency
for the curves (default = 0.2)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object of the survival curve including parameter uncertainty
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require("dplyr")
param_expert_example1 &lt;- list()
param_expert_example1[[1]] &lt;- data.frame(dist = c("norm","t"),
                                        wi = c(0.5,0.5), # Ensure Weights sum to 1
                                        param1 = c(0.1,0.12),
                                        param2 = c(0.15,0.5),
                                        param3 = c(NA,3))

timepoint_expert &lt;- 14
data2 &lt;- data %&gt;% rename(status = censored) %&gt;% mutate(time2 = ifelse(time &gt; 10, 10, time),
                                                      status2 = ifelse(time&gt; 10, 0, status))
example1 &lt;- fit.models.expert(formula=Surv(time2,status2)~1,data=data2,
                             distr=c("wph", "gomp"),
                             method="mle",
                             pool_type = "log pool",
                             opinion_type = "survival",
                             times_expert = timepoint_expert,
                             param_expert = param_expert_example1)

p.mle = make.surv(example1,mod= 2,t = 1:30, nsim=1000) #Plot the Gompertz model
psa.plot(p.mle , name_labs = "PSA", labs = "Gompertz", col ="blue")

</code></pre>

<hr>
<h2 id='summary.expertsurv'>Prints a summary table for the distribution the mean survival time for a
given model and data</h2><span id='topic+summary.expertsurv'></span>

<h3>Description</h3>

<p>Calculates the mean survival time as the area under the survival curve -
ported from <code>survHE</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'expertsurv'
summary(object, mod = 1, t = NULL, nsim = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.expertsurv_+3A_object">object</code></td>
<td>
<p>a <code>survHE</code> object (resulting from the call to
<code>fit.models</code></p>
</td></tr>
<tr><td><code id="summary.expertsurv_+3A_mod">mod</code></td>
<td>
<p>the model to be analysed (default = 1)</p>
</td></tr>
<tr><td><code id="summary.expertsurv_+3A_t">t</code></td>
<td>
<p>the vector of times to be used in the computation. Default = NULL,
which means the observed times will be used. NB: the vector of times should
be: i) long enough so that S(t) goes to 0; and ii) dense enough so that the
approximation to the AUC is sufficiently precise</p>
</td></tr>
<tr><td><code id="summary.expertsurv_+3A_nsim">nsim</code></td>
<td>
<p>the number of simulations from the survival curve distributions
to be used (to compute interval estimates)</p>
</td></tr>
<tr><td><code id="summary.expertsurv_+3A_...">...</code></td>
<td>
<p>Additional options</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A list comprising of the following elements
</p>


<h3>Value</h3>

<table>
<tr><td><code>mean.surv</code></td>
<td>
<p> A matrix with the simulated values for the mean
survival times </p>
</td></tr> <tr><td><code>tab</code></td>
<td>
<p> A summary table </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2020).
&ldquo;survHE: Survival Analysis for Health Economic Evaluation and Cost-Effectiveness Modeling.&rdquo;
<em>Journal of Statistical Software</em>, <b>95</b>(14), 1&ndash;47.
<a href="https://doi.org/10.18637/jss.v095.i14">doi:10.18637/jss.v095.i14</a>.
</p>


<h3>See Also</h3>

<p><code>fit.models.expert</code>, <code>make.surv</code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
