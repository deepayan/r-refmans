<!DOCTYPE html><html lang="en"><head><title>Help for package EpiILM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EpiILM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EpiILM-package'><p><span class="pkg">EpiILM</span>: Spatial and Network Based Individual Level Models for Epidemics</p></a></li>
<li><a href='#as.epidata'>
<p>Discrete Time level information of an Epidemic</p></a></li>
<li><a href='#epiBR0'>
<p>Basic reproduction number (R0)</p></a></li>
<li><a href='#epidata'>
<p>Simulates epidemic for the specified</p>
model type and parameters</a></li>
<li><a href='#epidic'>
<p>Deviance Information Criterion (DIC)</p></a></li>
<li><a href='#epilike'>
<p>Calculates the log likelihood</p></a></li>
<li><a href='#epimcmc'>
<p>Monte Carlo Simulation</p></a></li>
<li><a href='#plot.epidata'><p>S3 method to provide some graphics of epidemic.</p></a></li>
<li><a href='#plot.epimcmc'><p>Plot the output of <code>epimcmc</code> object</p></a></li>
<li><a href='#plot.pred.epi'><p>S3 method to provide plots of posterior predictive check.</p></a></li>
<li><a href='#pred.epi'>
<p>Posterior predictive check.</p></a></li>
<li><a href='#summary.epimcmc'><p>Summary method for <code>epimcmc</code> objects</p></a></li>
<li><a href='#tswv'><p>Tomato Spotted Wilt Virus (TSWV) data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Spatial and Network Based Individual Level Models for Epidemics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-30</td>
</tr>
<tr>
<td>Depends:</td>
<td>coda, adaptMCMC, LaplacesDemon, graphics, stats, utils, R (&ge;
3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Vineetha Warriyar. K. V., Waleed Almutiry, and Rob Deardon</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Waleed Almutiry &lt;wkmtierie@qu.edu.sa&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for simulating from discrete-time individual level models for infectious disease data analysis. This epidemic model class contains spatial and contact-network based models with two disease types: Susceptible-Infectious (SI) and Susceptible-Infectious-Removed (SIR).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/waleedalmutiry/EpiILM">https://github.com/waleedalmutiry/EpiILM</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-30 11:36:11 UTC; ABO-HATIM</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-30 16:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='EpiILM-package'><span class="pkg">EpiILM</span>: Spatial and Network Based Individual Level Models for Epidemics</h2><span id='topic+EpiILM-package'></span><span id='topic+EpiILM'></span>

<h3>Description</h3>

<p>The <span class="rlang"><b>R</b></span> package <span class="pkg">EpiILM</span> is provided for simulating from, and carrying out Bayesian MCMC-based statistical inference for spatial and/or network-based individual-level modelling framework. The package allows for the incorporation of individual-level susceptibility and transmissibility covariates in models, and provides various methods of summarizing epidemic data sets.
</p>


<h3>Details</h3>

<p>The <span class="rlang"><b>R</b></span> package <span class="pkg">EpiILM</span> can be used to carry out simulation of epidemics, estimate the basic reproduction number, plot various epidemic summary graphics, calculate the log-likelihood, carry out Bayesian inference using Metropolis-Hastings MCMC, and implement posterior predictive checks and model selection for a given data set and model. The key functions for this package are detailed in the value section. One of the important functions <code><a href="#topic+epimcmc">epimcmc</a></code> depends heavily on the <code><a href="adaptMCMC.html#topic+MCMC">MCMC</a></code> from the <span class="pkg">adaptMCMC</span> package for performing the MCMC analysis. This function implements the robust adaptive Metropolis sampler of Vihola (2012) for tuning the covariance matrix of the (normal) jump distribution adaptively to achieve the desired acceptance rate. The package has other features for making predictions or forecasting for a specific model via the <code>pred.epi</code> function. The main functions, including for epidemic simulation (<code><a href="#topic+epidata">epidata</a></code>) and likelihood calculation (<code><a href="#topic+epilike">epilike</a></code>) are coded in Fortran in order to achieve the goal of agile implementation.
</p>


<h3>Value</h3>

<p>Key functions for this package:
</p>
<table role = "presentation">
<tr><td><code>\link{epidata}</code></td>
<td>
<p>Simulates epidemics for the specified model type and parameters.</p>
</td></tr>
<tr><td><code>\link{epilike}</code></td>
<td>
<p>Calculates the log-likelihood for the specified model and data set.</p>
</td></tr>
<tr><td><code>\link{epimcmc}</code></td>
<td>
<p>Runs an MCMC algorithm for the estimation of specified model parameters.</p>
</td></tr>
<tr><td><code>\link{pred.epi}</code></td>
<td>
<p>Computes posterior predictions for a specified epidemic model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Vineetha Warriyar. K. V., Waleed Almutiry, and Rob Deardon <br /> Maintainer: Waleed Almutiry &lt;wkmtierie@qu.edu.sa&gt;
</p>


<h3>References</h3>

<p>Deardon, R., Brooks, S. P., Grenfell, B. T., Keeling, M. J., Tildesley, M. J., Savill, N. J., Shaw, D. J., and Woolhouse, M. E. (2010). Inference for individual level models of infectious diseases in large populations. <em>Statistica Sinica</em>, 20, 239-261.
</p>
<p>Vihola, M. (2012) Robust adaptive Metropolis algorithm with coerced acceptance rate. <em>Statistics and Computing</em>, 22(5), 997-1008. doi:10.1007/s11222-011-9269-5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
demo(EpiILM.spatial)
demo(EpiILM.network)

## End(Not run)
</code></pre>

<hr>
<h2 id='as.epidata'>
Discrete Time level information of an Epidemic
</h2><span id='topic+as.epidata'></span>

<h3>Description</h3>

<p>This function allows the user to generate objects of class <code>"epidata"</code>. The output of this function provides information required to be used in the other functions in the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.epidata (type, n, x = NULL, y = NULL, inftime, infperiod = NULL, contact = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.epidata_+3A_type">type</code></td>
<td>

<p>Type of compartment framework, with the choice of &quot;SI&quot; for
Susceptible-Infectious diseases and &quot;SIR&quot; for
Susceptible-Infectious-Removed.
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_n">n</code></td>
<td>

<p>Population size
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_x">x</code></td>
<td>

<p>X coordinates of individuals.
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_y">y</code></td>
<td>

<p>Y coordinates of individuals.
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_inftime">inftime</code></td>
<td>

<p>Times at which individuals are infected to initialize epidemic simulation.
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_infperiod">infperiod</code></td>
<td>

<p>Length of infectious period for each individual.
</p>
</td></tr>
<tr><td><code id="as.epidata_+3A_contact">contact</code></td>
<td>

<p>A contact network matrix or an array of contact network matrices.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>epidata</code> is returned containing the following:
</p>

<dl>
<dt>type</dt><dd><p>Type of compartment framework, with the choice of &quot;SI&quot; for
Susceptible-Infectious diseases and &quot;SIR&quot; for
Susceptible-Infectious-Removed.
</p>
</dd>
<dt>XYcoordinates</dt><dd><p>The XY-coordinates of individuals if distance-based ILM is used, otherwise is NULL.</p>
</dd>
<dt>contact</dt><dd><p>Contact network matrix if network-based ILM is used, otherwise is NULL.</p>
</dd>
<dt>inftime</dt><dd><p>The infection times of individuals.</p>
</dd>
<dt>remtime</dt><dd><p>The removal times of individuals when <code>type</code> = &ldquo;SIR&rdquo;.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+epidata">epidata</a></code>, <code><a href="#topic+plot.epidata">plot.epidata</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate 100 X-Y coordinates for a distance-based ILM

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

# suppose we know the infection times for a spatial SI model based on above X-Y coordinates

inftime  &lt;- rpois(100, 8) 

# Now we can convert above information to an epidata object with

out &lt;- as.epidata(type = "SI", n = 100, x = x, y = y, inftime = inftime ) 
out

</code></pre>

<hr>
<h2 id='epiBR0'>
Basic reproduction number (R0)
</h2><span id='topic+epiBR0'></span>

<h3>Description</h3>

<p>Gives a Monte Carlo estimate of the basic reproduction number for a specified SIR model and data set 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epiBR0 (x = NULL, y = NULL, contact = NULL, sus.par, trans.par = NULL, beta,

        spark = NULL, infperiod, Sformula = NULL, Tformula = NULL, tmax,

        niter)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epiBR0_+3A_x">x</code></td>
<td>

<p>X coordinates of individuals
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_y">y</code></td>
<td>

<p>Y coordinates of individuals
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_contact">contact</code></td>
<td>

<p>Contact network(s)
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_sus.par">sus.par</code></td>
<td>

<p>Susceptibility parameter(&gt;0)
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_trans.par">trans.par</code></td>
<td>

<p>Transmissibility parameter(&gt;0)
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_beta">beta</code></td>
<td>

<p>Spatial parameter(s) (&gt;0) or network parameter (s) (&gt;0) if contact is used
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_spark">spark</code></td>
<td>

<p>Sparks parameter (&gt;=0), representing infections unexplained by other parts
of the model or infections coming in from outside the observed population, default value is zero
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_infperiod">infperiod</code></td>
<td>

<p>Length of infectious period for each individual
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_sformula">Sformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>
</p>
<p>Individual-level covariate information associated with susceptibility can be passed through this argument. An expression of the form <code> ~ model</code> is interpreted as a specification that the susceptibility function, <code class="reqn">\Omega_S(i) </code>  is modelled by a linear predictor specified symbolically by the model term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no susceptibility covariate information, <code>Sformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_tformula">Tformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>
</p>
<p>Individual-level covariate information associated with transmissibility can be passed through this argument. An expression of the form <code> ~ -1+model</code> is interpreted as a specification that the transmissibility function, <code class="reqn">\Omega_T(j) </code>  is modelled by a linear predictor specified symbolically by the model terms without the incorporation of the intercept term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no transmissibility covariate information, <code>Tformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_tmax">tmax</code></td>
<td>

<p>The last time point of simulation
</p>
</td></tr>
<tr><td><code id="epiBR0_+3A_niter">niter</code></td>
<td>

<p>Number of epidemic simulations to calculate basic reproduction number
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list is returned with the following components:
</p>
<table role = "presentation">
<tr><td><code>BasicR0</code></td>
<td>

<p>The basic reproduction number value
</p>
</td></tr>
<tr><td><code>simulated_BR0</code></td>
<td>

<p>Number of infections per simulation
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># generate 100 X-Y coordinates for a distance-based ILM

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

# Suppose we know the length of infectious period for each individual. Also, assume 
# susceptibility parameter = 1.5 and spatial parameter = 5 for this SIR model

infperiod &lt;- rep(3, 100)

# For a 1000 iteration with a last observed time point 15, we can estimate the basic 
# reproduction number using Monte Carlo simulation

out &lt;- epiBR0(x = x, y = y,  sus.par = 1.5,  beta = 5, infperiod= infperiod,  
     
               tmax = 15, niter = 1000)

out$BasicR0


</code></pre>

<hr>
<h2 id='epidata'>
Simulates epidemic for the specified
model type and parameters
</h2><span id='topic+epidata'></span>

<h3>Description</h3>

<p>This function allows the user to simulate epidemics under different models and scenarios
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epidata (type, n, tmin = NULL, tmax, sus.par, trans.par = NULL, beta = NULL, spark = NULL,

          Sformula = NULL, Tformula = NULL, x = NULL, y = NULL,

          inftime = NULL, infperiod = NULL, contact = NULL)

          
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epidata_+3A_type">type</code></td>
<td>

<p>Type of compartment framework, with the choice of &quot;SI&quot; for
Susceptible-Infectious diseases and &quot;SIR&quot; for
Susceptible-Infectious-Removed.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_n">n</code></td>
<td>

<p>Population size
</p>
</td></tr>
<tr><td><code id="epidata_+3A_tmin">tmin</code></td>
<td>

<p>The time point at which simulation begins, default value is one.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_tmax">tmax</code></td>
<td>

<p>The last time point of simulation.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_sus.par">sus.par</code></td>
<td>

<p>Susceptibility parameter (&gt;0).
</p>
</td></tr>
<tr><td><code id="epidata_+3A_trans.par">trans.par</code></td>
<td>

<p>Transmissibility parameter (&gt;0).
</p>
</td></tr>
<tr><td><code id="epidata_+3A_beta">beta</code></td>
<td>

<p>Spatial parameter(s) (&gt;0) or network parameter (s) (&gt;0) if contact network is used.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_spark">spark</code></td>
<td>

<p>Sparks parameter (&gt;=0), representing infections unexplained by other parts
of the model (eg. infections coming in from outside the observed population), default value is zero.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_sformula">Sformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with susceptibility can be passed through this argument. An expression of the form <code> ~ model</code> is interpreted as a specification that the susceptibility function, <code class="reqn">\Omega_S(i) </code>  is modelled by a linear predictor specified symbolically by the model term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no susceptibility covariate information, <code>Sformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_tformula">Tformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with transmissibility can be passed through this argument. An expression of the form <code> ~ -1+model</code> is interpreted as a specification that the transmissibility function, <code class="reqn">\Omega_T(j) </code>  is modelled by a linear predictor specified symbolically by the model terms without the incorporation of the intercept term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no transmissibility covariate information, <code>Tformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_x">x</code></td>
<td>

<p>X coordinates of individuals.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_y">y</code></td>
<td>

<p>Y coordinates of individuals.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_inftime">inftime</code></td>
<td>

<p>Times at which individuals are infected to initialize epidemic simulation.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_infperiod">infperiod</code></td>
<td>

<p>Length of infectious period for each individual.
</p>
</td></tr>
<tr><td><code id="epidata_+3A_contact">contact</code></td>
<td>

<p>A contact network matrix or an array of contact network matrices.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We consider following two individual level models:
</p>
<p><b>Spatial model:</b>
</p>
<p style="text-align: center;"><code class="reqn">P(i,t) =1- \exp\{-\Omega_S(i) \sum_{j \in I(t)}{\Omega_T(j)d_{ij}^{-\beta}- \varepsilon}\}</code>
</p>

<p><b>Network model:</b>
</p>
<p style="text-align: center;"><code class="reqn">P(i,t) =1- \exp\{-\Omega_S(i) \sum_{j \in I(t)}{\Omega_T(j)(\beta_1 C^{(1)}_{ij}} + \dots + \beta_n  C^{(n)}_{ij} )- \varepsilon\}</code>
</p>

<p>where <code class="reqn">P(i,t)</code> is the probability that susceptible individual i is infected at time point t, becoming infectious at time t+1; 
<code class="reqn">\Omega_S(i)</code> is  a susceptibility function which accommodates potential risk factors associated with susceptible individual i contracting the disease; <code class="reqn">\Omega_T(j)</code> is  a transmissibility function which accommodates potential risk factors associated with infectious individual j; <code class="reqn">\varepsilon</code> is a sparks term which represents infections originating from outside the population being observed or some other unobserved infection mechanism. 
</p>
<p>The susceptibility function can incorporate any individual-level covariates  of interest and <code class="reqn">\Omega_S(i)</code> is treated as a linear function of the covariates, i.e., <code class="reqn">\Omega_S(i) = \alpha_0 + \alpha_1 X_1(i) + \alpha_2 X_2 (i) + \dots  + 
\alpha_{n_s} X_{n_s} (i)</code>, where <code class="reqn">X_1(i), \dots, X_{n_s} (i)</code> denote  <code class="reqn">n_s</code>covariates associated with susceptible individual $i$, along with susceptibility parameters <code class="reqn">\alpha_0,\dots,\alpha_{n_s} &gt;0</code>. If the model does not contain any susceptibility covariates then  <code class="reqn">\Omega_S(i) = \alpha_0</code> is used. In a similar way, the transmissibility function can incorporate any individual-level covariates of interest associated with infectious individual. <code class="reqn">\Omega_T(j)</code> is also treated as a linear function of the covariates, but without the intercept term, i.e., <code class="reqn">\Omega_T(j) = \phi_1 X_1(j) + \phi_2 X_2 (j) + \dots  + \phi_{n_t} X_{n_t} (j)</code>, where <code class="reqn">X_1(j), \dots, X_{n_t} (j)</code> denote  the <code class="reqn">n_t</code> covariates associated with  infectious individual j, along with transmissibility parameters <code class="reqn">\phi_1,\dots,\phi_{n_t} &gt;0</code>. If the model does not contain any transmissibility covariates then  <code class="reqn">\Omega_T(j)  = 1</code> is used.
</p>


<h3>Value</h3>

<p>An object of class <code>epidata</code> is returned containing the following:
</p>

<dl>
<dt>type</dt><dd><p>Type of compartment framework, with the choice of &quot;SI&quot; for
Susceptible-Infectious diseases and &quot;SIR&quot; for
Susceptible-Infectious-Removed
</p>
</dd>
<dt>XYcoordinates</dt><dd><p>The XY-coordinates of individuals.</p>
</dd>
<dt>contact</dt><dd><p>Contact network matrix.</p>
</dd>
<dt>inftime</dt><dd><p>The infection times of individuals.</p>
</dd>
<dt>remtime</dt><dd><p>The removal times of individuals when <code>type</code> = &ldquo;SIR&rdquo;.</p>
</dd>
</dl>



<h3>References</h3>

<p>Deardon, R., Brooks, S. P., Grenfell, B. T., Keeling, M. J., Tildesley, M. J., Savill, N. J., Shaw, D. J., and  Woolhouse, M. E. (2010). Inference for individual level models of infectious diseases in large populations. <em>Statistica Sinica</em>, 20, 239-261.
</p>
<p>Deardon, R., Fang, X., and Kwong, G.P.S. (2014). Statistical modelling of spatio-temporal infectious disease transmission in analyzing and modeling Spatial and temporal dynamics of infectious diseases, <em>(Ed: D. Chen, B. Moulin, J. Wu), John Wiley &amp; Sons.</em> Chapter 11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.epidata">plot.epidata</a></code>, <code><a href="#topic+epimcmc">epimcmc</a></code>, <code><a href="#topic+epilike">epilike</a></code>, <code><a href="#topic+pred.epi">pred.epi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example 1:  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI",n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

# Plots of epidemic progression (optional)

plot(out1, plottype = "spatial")
plot(out1, plottype = "curve", curvetype = "newinfect")

## Example 2: spatial SIR model
# generate infectious period(=3) for 100 individuals

lambda &lt;- rep(3, 100)

out2 &lt;- epidata(type = "SIR", n = 100, tmax = 15, sus.par = 0.3, beta = 5.0, infperiod = lambda,
        x = x, y = y)

plot(out2, plottype = "spatial")
plot(out2, plottype = "curve", curvetype = "newinfect")

## Example 3:   SI network model

contact1 &lt;- matrix(rbinom(10000, 1, 0.1), nrow = 100, ncol = 100)

contact2 &lt;- matrix(rbinom(10000, 1, 0.1), nrow = 100, ncol = 100)

diag(contact1[,] ) &lt;- 0

diag(contact2[,] ) &lt;- 0

contact &lt;- array(c(contact1, contact2), dim = c(100, 100, 2))

out3 &lt;- epidata(type = "SI", n = 100, tmax = 15, sus.par = 0.3, beta = c(3.0, 5.0),
        contact = contact)
plot(out3, plottype = "curve", curvetype = "complete")
plot(out3, plottype = "curve", curvetype = "susceptible")
plot(out3, plottype = "curve", curvetype = "newinfect")
plot(out3, plottype = "curve", curvetype = "totalinfect")

</code></pre>

<hr>
<h2 id='epidic'>
Deviance Information Criterion (DIC)
</h2><span id='topic+epidic'></span>

<h3>Description</h3>

<p>Computes the Deviance Information Criterion for individual level models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epidic (burnin, niter, LLchain, LLpostmean)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epidic_+3A_burnin">burnin</code></td>
<td>

<p>Burnin period for MCMC
</p>
</td></tr>
<tr><td><code id="epidic_+3A_niter">niter</code></td>
<td>

<p>Number of MCMC iterations
</p>
</td></tr>
<tr><td><code id="epidic_+3A_llchain">LLchain</code></td>
<td>

<p>Loglikelihood values from the MCMC output 
</p>
</td></tr>
<tr><td><code id="epidic_+3A_llpostmean">LLpostmean</code></td>
<td>

<p>Loglikelihood value of the model with posterior mean of estimates
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Spiegelhalter, D., Best, N., Carlin, B., Van der Linde, A. (2002). Bayesian Measures of Model Complexity and Fit. <em>Journal of the Royal Statistical Society. Series B (Statistical Methodology)</em>, 64(4), 583-639.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1:  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI", n = 100, Sformula = ~covariate, tmax = 15,
              sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

unif_range &lt;- matrix(c(0, 0, 10000, 10000), nrow = 2, ncol = 2)

# estimate parameters
mcmcout &lt;- epimcmc(out1, tmax = 15, niter = 1500,
                    Sformula = ~covariate,   
                    sus.par.ini = c(0.003, 0.01), beta.ini =0.01,
                    pro.sus.var = c(0.1, 0.1),pro.beta.var = 0.5,
                    prior.sus.par = unif_range,
                    prior.sus.dist = c("uniform","uniform"), prior.beta.dist = "uniform",
                    prior.beta.par = c(0, 10000), adapt = TRUE, acc.rate = 0.5 )
# store the estimates
sus.parameters = c(mean(unlist(mcmcout$Estimates[1])), mean(unlist(mcmcout$Estimates[2])))
beta.par = mean(unlist(mcmcout$Estimates[3]))

# likelihood value
loglike &lt;- epilike(out1, tmax = 15, Sformula = ~covariate, sus.par = sus.parameters, 
                   beta = beta.par)

# deviance information criterion calculation for the above epidemic
dic &lt;- epidic(burnin = 500, niter = 1500, LLchain = mcmcout$Loglikelihood,
              LLpostmean = loglike)
dic

</code></pre>

<hr>
<h2 id='epilike'>
Calculates the log likelihood
</h2><span id='topic+epilike'></span>

<h3>Description</h3>

<p>Calculates the log likelihood for the
specified individual level model and data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epilike (object, tmin = NULL, tmax, sus.par, trans.par = NULL,

         beta = NULL, spark = NULL, Sformula = NULL, Tformula = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epilike_+3A_object">object</code></td>
<td>

<p>An object of class <code>epidata</code> that can be the output of <code><a href="#topic+epidata">epidata</a></code> or <code><a href="#topic+as.epidata">as.epidata</a></code>.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_tmin">tmin</code></td>
<td>

<p>The first time point at which data is observed, default value is one.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_tmax">tmax</code></td>
<td>

<p>The last time point at which data is observed.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_sus.par">sus.par</code></td>
<td>

<p>Susceptibility parameter(&gt;0).
</p>
</td></tr>
<tr><td><code id="epilike_+3A_trans.par">trans.par</code></td>
<td>

<p>Transmissibility parameter(&gt;0).
</p>
</td></tr>
<tr><td><code id="epilike_+3A_beta">beta</code></td>
<td>

<p>Spatial parameter(s) (&gt;0) or network parameter (s) (&gt;0) if contact network is used.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_spark">spark</code></td>
<td>

<p>Sparks parameter(&gt;=0), representing infections unexplained by other parts
of the model or infections coming in from outside the observed population, default value is zero.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_sformula">Sformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with susceptibility can be passed through this argument. An expression of the form <code> ~ model</code> is interpreted as a specification that the susceptibility function, <code class="reqn">\Omega_S(i) </code>  is modelled by a linear predictor specified symbolically by the model term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no susceptibility covariate information, <code>Sformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epilike_+3A_tformula">Tformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with transmissibility can be passed through this argument. An expression of the form <code> ~ -1+model</code> is interpreted as a specification that the transmissibility function, <code class="reqn">\Omega_T(j) </code>  is modelled by a linear predictor specified symbolically by the model terms without the incorporation of the intercept term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no transmissibility covariate information, <code>Tformula</code> is null.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the value of the log-likelihood function.
</p>


<h3>References</h3>

<p>Deardon R, Brooks, S. P., Grenfell, B. T., Keeling, M. J., Tildesley, M. J., Savill, N. J., Shaw, D. J.,  Woolhouse, M. E. (2010). Inference for individual level models of infectious diseases in large populations. <em>Statistica Sinica</em>, 20, 239-261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epimcmc">epimcmc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1:  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI", n = 100, Sformula = ~covariate, tmax = 15,
              sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

epilike(out1, tmax = 15,
         sus.par = c(0.1, 0.3), beta = 5, Sformula = ~covariate)

## Example 2: spatial SIR model
# generate infectious period (=3) for 100 individuals

lambda &lt;- rep(3, 100)

out2 &lt;- epidata(type = "SIR", n = 100, tmax = 15, sus.par  =0.3, beta = 5.0,
              infperiod = lambda, x = x, y = y)

epilike(out2,
        tmax = 15, sus.par = 0.3, beta = 5.0)
</code></pre>

<hr>
<h2 id='epimcmc'>
Monte Carlo Simulation
</h2><span id='topic+epimcmc'></span>

<h3>Description</h3>

<p>Runs an MCMC algorithm for the estimation of specified model parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>epimcmc (object, tmin = NULL, tmax,

         niter, sus.par.ini, trans.par.ini = NULL, beta.ini = NULL, spark.ini = NULL,

         Sformula = NULL, Tformula = NULL,

         pro.sus.var, pro.trans.var = NULL, pro.beta.var = NULL, pro.spark.var = NULL,

         prior.sus.dist, prior.trans.dist = NULL, prior.beta.dist = NULL,

         prior.spark.dist = NULL, prior.sus.par, prior.trans.par, prior.beta.par = NULL,

         prior.spark.par = NULL, adapt = FALSE, acc.rate = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="epimcmc_+3A_object">object</code></td>
<td>

<p>An object of class <code>epidata</code> that can be the output of <code><a href="#topic+epidata">epidata</a></code> or <code><a href="#topic+as.epidata">as.epidata</a></code>.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_tmin">tmin</code></td>
<td>

<p>The first time point at which the infection occurs, default value is one.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_tmax">tmax</code></td>
<td>

<p>The last time point at which data is observed.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_niter">niter</code></td>
<td>

<p>Number of MCMC iterations.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_sus.par.ini">sus.par.ini</code></td>
<td>

<p>Initial value(s) of the susceptibility parameter(s) (&gt;0).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_trans.par.ini">trans.par.ini</code></td>
<td>

<p>Initial value(s) of the transmissibility parameter(s) (&gt;0).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_beta.ini">beta.ini</code></td>
<td>

<p>Initial value(s) of the spatial parameter(s) (&gt;0) or the network parameter(s) (&gt;0) if contact network is used.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_spark.ini">spark.ini</code></td>
<td>

<p>Initial value of the spark parameter (&gt;=0).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_sformula">Sformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>
</p>
<p>Individual-level covariate information associated with susceptibility can be passed through this argument. An expression of the form <code> ~ model</code> is interpreted as a specification that the susceptibility function, <code class="reqn">\Omega_S(i) </code>  is modelled by a linear predictor specified symbolically by the model term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no susceptibility covariate information, <code>Sformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_tformula">Tformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>
</p>
<p>Individual-level covariate information associated with transmissibility can be passed through this argument. An expression of the form <code> ~ -1+model</code> is interpreted as a specification that the transmissibility function, <code class="reqn">\Omega_T(j) </code>  is modelled by a linear predictor specified symbolically by the model terms without the incorporation of the intercept term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no transmissibility covariate information, <code>Tformula</code> is null.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_pro.sus.var">pro.sus.var</code></td>
<td>

<p>Proposal density variance(s) for susceptibility parameter(s). If a zero value is assigned to the proposal variance of any parameter, the parameter is considered fixed to its <code>sus.par.ini</code> value.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_pro.trans.var">pro.trans.var</code></td>
<td>

<p>Proposal density variance(s) for transmissibility parameter(s). If a zero value is assigned to the proposal variance of any parameter, the parameter is considered fixed to its <code>sus.par.ini</code> value.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_pro.beta.var">pro.beta.var</code></td>
<td>

<p>Proposal density variance(s) for beta parameter(s). If a zero value is assigned to the proposal variance of any parameter, the parameter is considered fixed to its <code>sus.par.ini</code> value.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_pro.spark.var">pro.spark.var</code></td>
<td>

<p>Proposal density variance for the spark parameter.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.sus.dist">prior.sus.dist</code></td>
<td>

<p>Select the prior distribution(s) for the susceptibility parameter(s) with the choice of &quot;halfnormal&quot; for positive half normal distribution, &quot;gamma&quot;  for gamma distribution and &quot;uniform&quot; for uniform distribution
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.trans.dist">prior.trans.dist</code></td>
<td>

<p>Select the prior distribution(s) for the transmissibility parameter(s) with the choice of &quot;halfnormal&quot; for positive half normal distribution, &quot;gamma&quot;  for gamma distribution and &quot;uniform&quot; for uniform distribution
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.beta.dist">prior.beta.dist</code></td>
<td>

<p>Select the prior distribution(s) for the beta parameter(s) with the choice of &quot;halfnormal&quot; for half normal distribution, &quot;gamma&quot;  for gamma distribution and &quot;uniform&quot; for uniform distribution
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.spark.dist">prior.spark.dist</code></td>
<td>

<p>Select the prior distribution for the spark parameter with the choice of &quot;halfnormal&quot; for half normal distribution, &quot;gamma&quot;  for gamma distribution and &quot;uniform&quot; for uniform distribution
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.sus.par">prior.sus.par</code></td>
<td>

<p>A vector (matrix) of the prior distribution parameters for updating the susceptibility parameter(s).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.trans.par">prior.trans.par</code></td>
<td>

<p>A vector (matrix) of the prior distribution parameters for updating the transmissibility parameter(s).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.beta.par">prior.beta.par</code></td>
<td>

<p>A vector (matrix) of the prior distribution parameters for updating the kernel parameter(s).
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_prior.spark.par">prior.spark.par</code></td>
<td>

<p>A vector of the prior distribution parameters for updating the spark parameter.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_adapt">adapt</code></td>
<td>

<p>To enable the adaptive MCMC method in the <code>MCMC</code> function, default is FALSE.
</p>
</td></tr>
<tr><td><code id="epimcmc_+3A_acc.rate">acc.rate</code></td>
<td>

<p>To set an acceptance rate. This option will be ignored if <code>adapt</code> = FALSE. See <code>MCMC</code> for more details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Independent Gaussian random walks are used as the Metropolis-Hastings MCMC proposal for all parameters. The <code>epimcmc</code> function depends on the <code>MCMC</code> function from the <span class="pkg">adaptMCMC</span> package.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>epimcmc</code> that contains:
</p>

<dl>
<dt>type:</dt><dd><p>the compartmental framework model used in the analysis.</p>
</dd>
<dt>kernel.type:</dt><dd><p>the used <code>kernel.type</code> in the function (distance-based or network-based).</p>
</dd>
<dt>Estimates:</dt><dd><p>the MCMC output of the updated model parameters.</p>
</dd>
<dt>Loglikelihood:</dt><dd><p>the loglikelihood of the updated model parameters.</p>
</dd>
<dt>Fullsamples:</dt><dd><p>the MCMC output of all the model parameters (including fixed parameters).</p>
</dd>
<dt>n.sus.par:</dt><dd><p>the number of parameters in the susceptibility function.</p>
</dd>
<dt>n.trans.par:</dt><dd><p>the number of parameters in the transmissibility function.</p>
</dd>
<dt>n.ker.par:</dt><dd><p>the number of parameters in the kernel function.</p>
</dd>
</dl>



<h3>References</h3>

<p>Rob Deardon, Xuan Fang, and Grace P. S. Kwong (2015). Statistical modelling of spatio-temporal infectious disease tranmission in Analyzing and Modeling Spatial and Temporal Dynamics of Infectious Diseases, <em>(Ed: D. Chen, B. Moulin, J. Wu), John Wiley &amp; Sons.</em>. Chapter 11.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.epimcmc">summary.epimcmc</a></code>, <code><a href="#topic+plot.epimcmc">plot.epimcmc</a></code>, <code><a href="#topic+epidata">epidata</a></code>, <code><a href="#topic+epilike">epilike</a></code>, <code><a href="#topic+pred.epi">pred.epi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example 1:  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI", n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

alphapar1 &lt;- matrix(c(1, 1, 1, 1), ncol = 2, nrow = 2)

betapar1 &lt;- c(10, 2)

epi &lt;- epimcmc(object = out1, tmin = 1, tmax = 15,
               niter = 1000, sus.par.ini = c(1, 1), beta.ini = 1,
               Sformula = ~covariate, pro.sus.var = c(0.5, 0.3), pro.beta.var = 0.1,
               prior.sus.dist = c("gamma", "gamma"), prior.beta.dist = "gamma",
               prior.sus.par = alphapar1, prior.beta.par = betapar1,
               adapt = TRUE, acc.rate = 0.5)
epi

## Example 2:  spatial SIR model

lambda &lt;- rep(3, 100)

out2 &lt;- epidata(type = "SIR", n = 100, tmax = 15, sus.par = 0.3, beta = 5.0, infperiod = lambda,
        x = x, y = y)

alphapar2 &lt;- c(1, 1)
betapar2 &lt;- c(1, 1)

epi2 &lt;- epimcmc(object = out2, tmin = 1, tmax = 15,
               niter = 1000, sus.par.ini = 1, beta.ini = 1,
               Sformula = NULL, pro.sus.var = 0.3, pro.beta.var = 0.1,
               prior.sus.dist = "gamma", prior.beta.dist = "gamma",
               prior.sus.par = alphapar2, prior.beta.par = betapar2,
               adapt = FALSE, acc.rate = NULL)
epi2

</code></pre>

<hr>
<h2 id='plot.epidata'>S3 method to provide some graphics of epidemic.</h2><span id='topic+plot.epidata'></span>

<h3>Description</h3>

<p>Produces various graphs summarizing epidemic of class <code>epidata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epidata'
plot(x, plottype, curvetype = NULL, time_id = NULL, tmin = NULL, timepoints = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.epidata_+3A_x">x</code></td>
<td>

<p>An object of class <code>epidata</code> that can be the output of <code><a href="#topic+epidata">epidata</a></code> or <code><a href="#topic+as.epidata">as.epidata</a></code>
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_plottype">plottype</code></td>
<td>

<p>Provide two types of plots. When <code>plottype</code> = &quot;curve&quot;, graphs of various epidemic curves can be produced, and when <code>plottype</code> = &quot;spatial&quot;, spatial plots of epidemic progression over time is produced.
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_curvetype">curvetype</code></td>
<td>

<p>It has four options: &quot;complete&quot;, &quot;susceptible&quot;, &quot;newinfect&quot;, and &quot;totalinfect&quot;. See details for more information.
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_time_id">time_id</code></td>
<td>

<p>Specify time points at which the spatial square is plotted.
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_tmin">tmin</code></td>
<td>

<p>Initial time point at which infection occurs, default value is one.
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_timepoints">timepoints</code></td>
<td>

<p>Specify time points at which the curve is plotted
</p>
</td></tr>
<tr><td><code id="plot.epidata_+3A_...">...</code></td>
<td>

<p>........
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>plottype</code> has two options. When <code>plottype</code>=&ldquo;spatial&rdquo; spatial plots are produced for the epidemic progression over time, and when <code>plottype</code>=&ldquo;curve&rdquo;, the argument <code>curvetype</code> has to be specified to one of the four available options: &quot;complete&quot; for plotting the number of susceptible, infected and removed individuals at each time point, &quot;susceptible&quot; for  plotting  the number of susceptible individuals at each time point, &quot;newinfect&quot; for plotting  the number of newly infected individuals at each time point, and &quot;totalinfect&quot; for  plotting  the cumulative number of infected individuals at each time point.
</p>


<h3>Value</h3>

<p>plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epidata">epidata</a></code>, <code><a href="#topic+plot.epimcmc">plot.epimcmc</a></code>, <code><a href="#topic+plot.pred.epi">plot.pred.epi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example :  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI",n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

# Plots of epidemic progression 

plot(out1, plottype = "spatial")
plot(out1, plottype = "curve", curvetype = "newinfect")

</code></pre>

<hr>
<h2 id='plot.epimcmc'>Plot the output of <code>epimcmc</code> object</h2><span id='topic+plot.epimcmc'></span>

<h3>Description</h3>

<p><code>plot.epimcmc</code> is an S3 method that plots the output of an S3 object of class <code>epimcmc</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epimcmc'
plot(x, partype, start = 1, end = NULL, thin = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.epimcmc_+3A_x">x</code></td>
<td>
<p>An S3 object of class <code>epimcmc</code> (i.e. the output of the <code>epimcmc</code> function).</p>
</td></tr>
<tr><td><code id="plot.epimcmc_+3A_partype">partype</code></td>
<td>
<p>Determines which of two options to plot the output of the <code>epimcmc</code> function are used: &ldquo;parameter&rdquo; produces trace plots for each of the model parameters, and &ldquo;loglik&rdquo; produces trace plot of the log-likelihood of the MCMC samples.</p>
</td></tr>
<tr><td><code id="plot.epimcmc_+3A_start">start</code>, <code id="plot.epimcmc_+3A_end">end</code>, <code id="plot.epimcmc_+3A_thin">thin</code></td>
<td>
<p>options for creating <code>mcmc</code> object.</p>
</td></tr>
<tr><td><code id="plot.epimcmc_+3A_...">...</code></td>
<td>
<p>additional arguments that are passed to the generic <code>plot</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epimcmc">epimcmc</a></code>, <code><a href="#topic+summary.epimcmc">summary.epimcmc</a></code>, <code>mcmc</code>, <code>plot.mcmc</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example :  spatial SI model
# generate 100 individuals

set.seed(59991)

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI", n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

alphapar1 &lt;- matrix(c(1, 1, 1, 1), ncol = 2, nrow = 2)

betapar1 &lt;- c(10, 2)

epi &lt;- epimcmc(object = out1, tmin = 1, tmax = 15,
               niter = 1000, sus.par.ini = c(0.1, 0.1), beta.ini = 5,
               Sformula = ~covariate, pro.sus.var = c(0.2, 0.3), pro.beta.var = 0.8,
               prior.sus.dist = c("gamma", "gamma"), prior.beta.dist = "gamma",
               prior.sus.par = alphapar1, prior.beta.par = betapar1,
               adapt = TRUE, acc.rate = 0.5)

# plot estimates
plot(epi, partype = "parameter", start = 100)
</code></pre>

<hr>
<h2 id='plot.pred.epi'>S3 method to provide plots of posterior predictive check.</h2><span id='topic+plot.pred.epi'></span>

<h3>Description</h3>

<p>Produces various graphs for the output of the posterior predictive check of class <code>pred.epi</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pred.epi'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.pred.epi_+3A_x">x</code></td>
<td>

<p>An object of class <code>pred.epi</code> which is the output of the <code>pred.epi</code> function.
</p>
</td></tr>
<tr><td><code id="plot.pred.epi_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to <code>plot</code> generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pred.epi">pred.epi</a></code>, <code><a href="#topic+plot.epidata">plot.epidata</a></code>, <code><a href="#topic+plot.epimcmc">plot.epimcmc</a></code>.
</p>

<hr>
<h2 id='pred.epi'>
Posterior predictive check.
</h2><span id='topic+pred.epi'></span>

<h3>Description</h3>

<p>Computing the posterior predictive check based on different summary statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pred.epi (object, xx, criterion , n.samples, burnin = NULL, tmin = NULL,

		  Sformula = NULL, Tformula = NULL, showProgressBar = interactive())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pred.epi_+3A_object">object</code></td>
<td>

<p>An object of class <code>epidata</code> that can be the output of <code><a href="#topic+epidata">epidata</a></code> or <code><a href="#topic+as.epidata">as.epidata</a></code>
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_xx">xx</code></td>
<td>

<p>An object of class <code>epimcmc</code> that is the output of <code><a href="#topic+epimcmc">epimcmc</a></code>.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_criterion">criterion</code></td>
<td>

<p>The (multivariate) statistical criteria used in the posterior predictive check. It has three options: &ldquo;newly infectious&rdquo; which is a multivariate statistics represented by the number of newly infectious individuals over time, &ldquo;epidemic length&rdquo; represents the length of epidemic, and &ldquo;peak time&rdquo; represents the time of the peak of epidemic.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_n.samples">n.samples</code></td>
<td>

<p>The number of epidemics that needs to be simulated in the posterior predictive check procedure.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_burnin">burnin</code></td>
<td>

<p>A scalar value which represents the number of samples needs to be discarded from the MCMC output.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_tmin">tmin</code></td>
<td>

<p>The first time point at which the infection occurs, default value is one.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_sformula">Sformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with susceptibility can be passed through this argument. An expression of the form <code> ~ model</code> is interpreted as a specification that the susceptibility function, <code class="reqn">\Omega_S(i) </code>  is modelled by a linear predictor specified symbolically by the model term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no susceptibility covariate information, <code>Sformula</code> is null.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_tformula">Tformula</code></td>
<td>

<p>An object of class formula. See <a href="stats.html#topic+formula">formula</a>.
</p>
<p>Individual-level covariate information associated with transmissibility can be passed through this argument. An expression of the form <code> ~ -1+model</code> is interpreted as a specification that the transmissibility function, <code class="reqn">\Omega_T(j) </code>  is modelled by a linear predictor specified symbolically by the model terms without the incorporation of the intercept term. Such a model consists of a series of terms separated by <code>+</code> and <code>-</code> operators. If there is no transmissibility covariate information, <code>Tformula</code> is null.
</p>
</td></tr>
<tr><td><code id="pred.epi_+3A_showprogressbar">showProgressBar</code></td>
<td>

<p>logical. If TRUE a progress bar is shown.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>pred.epi</code> that contains the following:
</p>

<dl>
<dt>type:</dt><dd><p>The compartmental framework model used in the analysis.</p>
</dd>
<dt>criterion:</dt><dd><p>The (multivariate) statistical criteria used in the posterior predictive check.</p>
</dd>
<dt>crit.sim:</dt><dd><p>The output of the evaluated <code>criterion</code> on the simulated epidemics.</p>
</dd>
<dt>crit.obs:</dt><dd><p>The output of the evaluated <code>criterion</code> on the observed epidemics.</p>
</dd>
<dt>tmax:</dt><dd><p>The last time point at which data is observed.</p>
</dd>
<dt>n.samples:</dt><dd><p>The number of simulated epidemics used in the posterior predictive check procedure.</p>
</dd>
</dl>



<h3>References</h3>

<p>Deardon R, Brooks, S. P., Grenfell, B. T., Keeling, M. J., Tildesley, M. J., Savill, N. J., Shaw, D. J.,  Woolhouse, M. E. (2010). Inference for individual level models of infectious diseases in large populations. <em>Statistica Sinica</em>, 20, 239-261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+epimcmc">epimcmc</a></code>, <code><a href="#topic+epidata">epidata</a></code>, <code><a href="#topic+epilike">epilike</a></code>, <code><a href="#topic+plot.pred.epi">plot.pred.epi</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1:  spatial SI model
# generate 100 individuals

set.seed(59991)

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- cbind(runif(100, 0, 2), rbinom(100, 1, 0.5))

out &lt;- epidata(type = "SI",n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3, 0.01), beta = 5.0, x = x, y = y)

alphapar2 &lt;- matrix(c(1, 1, 1, 1, 1, 1), ncol = 2, nrow = 3)

betapar2 &lt;- c(1, 1)

epi&lt;-epimcmc(object = out, tmin = 1, tmax = 15,
	       niter = 500, sus.par.ini = c(1, 1, 1), beta.ini = 1,
	       Sformula = ~covariate,
				 pro.sus.var = c(0.5, 0.3, 0.2), pro.beta.var = 0.1,
				 prior.sus.dist = c("gamma", "gamma", "gamma"),
				 prior.beta.dist = "gamma",
				 prior.sus.par = alphapar2, prior.beta.par = betapar2,
	       adapt = TRUE, acc.rate = 0.5)

epipred1 &lt;- pred.epi (object = out, xx = epi,
				criterion = "newly infectious",
			  n.samples = 100, burnin = 200, tmin = 1,
			  Sformula = ~covariate)

plot(epipred1, col = "red", type = "b", lwd = 2)

epipred2 &lt;- pred.epi (object = out, xx = epi,
				criterion = "peak time",
			  n.samples = 100, burnin = 200, tmin = 1,
			  Sformula = ~covariate)

plot(epipred2, col = "dark gray")

</code></pre>

<hr>
<h2 id='summary.epimcmc'>Summary method for <code>epimcmc</code> objects</h2><span id='topic+summary.epimcmc'></span>

<h3>Description</h3>

<p>Summarize a <code><a href="#topic+epimcmc">epimcmc</a></code> object and return an object of class <code>summary.epimcmc</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'epimcmc'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.epimcmc_+3A_object">object</code></td>
<td>
<p>an S3 object of class <code>epimcmc</code> (i.e. the output of the <code>epimcmc</code> function).</p>
</td></tr>
<tr><td><code id="summary.epimcmc_+3A_...">...</code></td>
<td>
<p>potential further arguments (require by generic).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+epimcmc">epimcmc</a></code>, <code><a href="#topic+plot.epimcmc">plot.epimcmc</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example:  spatial SI model
# generate 100 individuals

x &lt;- runif(100, 0, 10)

y &lt;- runif(100, 0, 10)

covariate &lt;- runif(100, 0, 2)

out1 &lt;- epidata(type = "SI", n = 100, Sformula = ~covariate, tmax = 15,
               sus.par = c(0.1, 0.3), beta = 5.0, x = x, y = y)

alphapar1 &lt;- matrix(c(1, 1, 1, 1), ncol = 2, nrow = 2)

betapar1 &lt;- c(1, 1)

epi &lt;- epimcmc(object = out1, tmin = 1, tmax = 15,
               niter = 1000, sus.par.ini = c(1, 1), beta.ini = 1,
               Sformula = ~covariate, pro.sus.var = c(0.5, 0.3), pro.beta.var = 0.1,
               prior.sus.dist = c("gamma", "gamma"), prior.beta.dist = "gamma",
               prior.sus.par = alphapar1, prior.beta.par = betapar1,
               adapt = TRUE, acc.rate = 0.5)

# summary of mcmc output
summary(epi)

</code></pre>

<hr>
<h2 id='tswv'>Tomato Spotted Wilt Virus (TSWV) data</h2><span id='topic+tswv'></span>

<h3>Description</h3>

<p>Data extracted from Hughes et al. (1997). Data obtained from a field experiment as the spatial dynamics of tomato spotted wilt virus (tswv). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(tswv)</code></pre>


<h3>Format</h3>

<p>A data frame with following variables
</p>

<dl>
<dt>x</dt><dd><p> X coordinate</p>
</dd>
<dt>y</dt><dd><p> Y coordinate</p>
</dd>
<dt>inftime</dt><dd><p>Infection times</p>
</dd>
<dt>removaltime</dt><dd><p>Times at which individuals are removed</p>
</dd>
</dl>



<h3>References</h3>

<p>Hughes, G., McRoberts,N., Madden, L.V., Nelson, S. C. (1997). Validating mathematical models of plant disease progress in space and time. <em>IMA Journal of Mathematics Applied in Medicine and Biology</em>, 14, 85-112.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("tswv")

x &lt;- tswv$x 
y &lt;- tswv$y 
inftime &lt;- tswv$inftime 
removaltime &lt;- tswv$removaltime 
infperiod &lt;- rep(3, length(x))  

# change to epilate object
 epidat.tswv &lt;- as.epidata(type = "SIR", n = 520, x = x, y = y, 
                            inftime = inftime, infperiod = infperiod)

# plot
plot(epidat.tswv, plottype = "spatial", tmin = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
