<!DOCTYPE html><html><head><title>Help for package AnthropMMD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {AnthropMMD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#absolute_freqs'>
<p>A toy example dataset for mean measures of divergence, in a table format</p></a></li>
<li><a href='#AnthropMMD-package'>
<p>An R package for the Mean Measure of Divergence (MMD)</p></a></li>
<li><a href='#binary_to_table'>
<p>Converts a data frame of binary (i.e., presence/absence) trait</p>
information into a table of sample sizes and frequencies.</a></li>
<li><a href='#mmd'>
<p>Compute MMD values from a table of sample sizes and relative</p>
frequencies</a></li>
<li><a href='#mmd_boot'>
<p>Implementation of Fidalgo et al.'s (2022) method of bootstrap for the</p>
Mean Measure of Divergence</a></li>
<li><a href='#plot.anthropmmd_boot'>
<p>Display a multidimensional scaling (MDS) plot using Fidalgo et al's</p>
(2022) bootstrap method for MMD</a></li>
<li><a href='#plot.anthropmmd_result'>
<p>Display a multidimensional scaling (MDS) plot with the MMD</p>
dissimilarities as input</a></li>
<li><a href='#select_traits'>
<p>Select a subset of traits meeting certain criteria</p></a></li>
<li><a href='#start_mmd'>
<p>An R-Shiny application for the mean measure of divergence</p></a></li>
<li><a href='#table_relfreq'>
<p>Converts a table of sample sizes and frequencies into a table of</p>
sample sizes and relative frequencies.</a></li>
<li><a href='#toyMMD'>
<p>A toy example dataset for mean measures of divergence, in a binary</p>
format</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An R Package for the Mean Measure of Divergence (MMD)</td>
</tr>
<tr>
<td>Description:</td>
<td>Offers a graphical user interface for the calculation of the mean measure of divergence, with facilities for trait selection and graphical representations &lt;<a href="https://doi.org/10.1002%2Fajpa.23336">doi:10.1002/ajpa.23336</a>&gt;.</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, MASS, plotrix, rlang, scatterplot3d, shiny, smacof</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cluster, covr, knitr, rmarkdown, testthat (&ge; 2.1.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.cecill.info/licences/Licence_CeCILL_V2-en.txt">CeCILL-2</a> | file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gitlab.com/f-santos/anthropmmd/">https://gitlab.com/f-santos/anthropmmd/</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-29 09:28:21 UTC; fsantos</td>
</tr>
<tr>
<td>Author:</td>
<td>Frédéric Santos <a href="https://orcid.org/0000-0003-1445-3871"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frédéric Santos &lt;frederic.santos@u-bordeaux.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-29 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='absolute_freqs'>
A toy example dataset for mean measures of divergence, in a table format
</h2><span id='topic+absolute_freqs'></span>

<h3>Description</h3>

<p>This artifical dataset includes 200 individuals described by 9 binary
traits and splitted into 5 groups. To fit with commonly observed
datasets in past sciences, a substantial amount of missing values have
been added at random on this dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(absolute_freqs)</code></pre>


<h3>Format</h3>

<p>A matrix with 10 rows and 9 columns:
</p>

<dl>
<dt><code>Trait1</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait2</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait3</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait4</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait5</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait6</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait7</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait8</code></dt><dd><p>summary statistics for this trait</p>
</dd>
<dt><code>Trait9</code></dt><dd><p>summary statistics for this trait</p>
</dd>
</dl>


<hr>
<h2 id='AnthropMMD-package'>
An R package for the Mean Measure of Divergence (MMD)
</h2><span id='topic+AnthropMMD-package'></span><span id='topic+AnthropMMD'></span>

<h3>Description</h3>

<p>Offers a graphical user interface for the calculation of the mean
measure of divergence, with facilities for trait selection and
graphical representations.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a>
</p>


<h3>References</h3>

<p>Harris, E. F. and Sjøvold, T. (2004) Calculation of Smith's mean
measure of divergence for intergroup comparisons using nonmetric
data. <em>Dental Anthropology</em>, <b>17</b>(3), 83&ndash;93.
</p>
<p>Irish, J. (2010) The mean measure of divergence: Its utility in
model-free and model-bound analyses relative to the Mahalanobis D2
distance for nonmetric traits. <em>American Journal of Human
Biology</em>, <b>22</b>, 378&ndash;395. doi: 10.1002/ajhb.21010
</p>
<p>Nikita, E. (2015) A critical review of the mean measure of divergence
and Mahalanobis distances using artificial data and new approaches to
the estimation of biodistances employing nonmetric
traits. <em>American Journal of Physical Anthropology</em>, <b>157</b>,
284&ndash;294. doi: 10.1002/ajpa.22708
</p>
<p>Santos, F. (2018) AnthropMMD: an R package with a graphical user
interface for the mean measure of divergence. <em>American Journal
of Physical Anthropology</em>, <b>165</b>(1), 200&ndash;205. doi:
10.1002/ajpa.23336
</p>
<p>Fidalgo, D., Hubbe, M. and Wesolowski, V. (2021) Population History
of Brazilian South and Southeast Shellmound Builders Inferred through
Dental Morphology. <em>American Journal of Physical Anthropology</em>,
<b>176</b>(2), 192&ndash;207. doi: 10.1002/ajpa.24342
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  start_mmd() 
</code></pre>

<hr>
<h2 id='binary_to_table'>
Converts a data frame of binary (i.e., presence/absence) trait
information into a table of sample sizes and frequencies.
</h2><span id='topic+binary_to_table'></span>

<h3>Description</h3>

<p>This function allows to get a summary of sample sizes and frequencies
for each trait in each group. It is also mandatory to apply this
function before using the <code><a href="#topic+mmd">mmd</a></code> function, since the latter
only accepts table of frequencies, and cannot work with raw binary data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_to_table(data, relative = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binary_to_table_+3A_data">data</code></td>
<td>
<p>A binary (0/1 for presence/absence of traits) data frame
with <code class="reqn">n</code> rows (one per individual) and <code class="reqn">p+1</code> columns (one
for each of the <code class="reqn">p</code> traits, plus one column provided as a group
indicator).</p>
</td></tr>
<tr><td><code id="binary_to_table_+3A_relative">relative</code></td>
<td>
<p>Boolean. Indicates if the last rows of
the table must contain frequencies (i.e., number of individuals
having a given trait) or relative frequencies (i.e., proportions).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with <code class="reqn">2*K</code> rows (<code class="reqn">K</code> being the number of groups in
the dataset) and <code class="reqn">p</code> columns (one per trait).
The first <code class="reqn">K</code> rows are the sample sizes, the last <code class="reqn">K</code> rows are
trait frequencies.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>Santos, F. (2018) AnthropMMD: an R package with a graphical user
interface for the mean measure of divergence. <em>American Journal
of Physical Anthropology</em>, <b>165</b>(1), 200&ndash;205. doi:
10.1002/ajpa.23336
</p>


<h3>See Also</h3>

<p><code><a href="#topic+start_mmd">start_mmd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load and visualize a binary dataset:
data(toyMMD)
head(toyMMD)

## Convert this dataframe into a table of sample sizes and relative frequencies:
binary_to_table(toyMMD, relative = TRUE)
</code></pre>

<hr>
<h2 id='mmd'>
Compute MMD values from a table of sample sizes and relative
frequencies
</h2><span id='topic+mmd'></span>

<h3>Description</h3>

<p>Compute various MMD results, typically using a table returned by the
function <code><a href="#topic+binary_to_table">binary_to_table</a></code> with the argument
<code>relative = TRUE</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmd(data, angular = c("Anscombe", "Freeman"), correct = TRUE,
    all.results = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmd_+3A_data">data</code></td>
<td>
<p>A table of sample sizes and frequencies</p>
</td></tr>
<tr><td><code id="mmd_+3A_angular">angular</code></td>
<td>
<p>Choice of a formula for angular transformation: either
Anscombe or Freeman-Tukey transformation.</p>
</td></tr>
<tr><td><code id="mmd_+3A_correct">correct</code></td>
<td>
<p>Boolean; whether to apply the correction for small
sample sizes (should be <code>TRUE</code> for most use cases).</p>
</td></tr>
<tr><td><code id="mmd_+3A_all.results">all.results</code></td>
<td>
<p>Boolean; whether to compute all four matrices
described below as results. If FALSE, only the matrix <code>MMDMatrix</code>
is computed. (This argument should be <code>TRUE</code> for most use cases).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with four components:
</p>
<table>
<tr><td><code>MMDMatrix</code></td>
<td>
<p>Following the presentation adopted in many research
articles, a matrix filled with MMD values above the diagonal, and
standard deviations of MMD below the diagonal.</p>
</td></tr>
<tr><td><code>MMDSym</code></td>
<td>
<p>A symmetrical matrix of MMD values, where negative
values are replaced by zeroes.</p>
</td></tr>
<tr><td><code>MMDSignif</code></td>
<td>
<p>A matrix where any pair of traits having a
significant MMD value is indicated by a star, &lsquo;*&rsquo;.</p>
</td></tr>
<tr><td><code>MMDpval</code></td>
<td>
<p>A matrix filled with MMD values above the diagonal, and
p-values below the diagonal.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>de Souza, P. and Houghton, P. (1977). The mean measure of divergence
and the use of non-metric data in the estimation of biological
distances. <em>Journal of Archaeological Science</em>, <b>4</b>(2),
163&ndash;169. doi: 10.1016/0305-4403(77)90063-2
</p>
<p>Harris, E. F. and Sjøvold, T. (2004) Calculation of Smith's mean
measure of divergence for intergroup comparisons using nonmetric
data. <em>Dental Anthropology</em>, <b>17</b>(3), 83&ndash;93.
</p>
<p>Nikita, E. (2015) A critical review of the mean measure of divergence
and Mahalanobis distances using artificial data and new approaches to
the estimation of biodistances employing nonmetric
traits. <em>American Journal of Physical Anthropology</em>, <b>157</b>,
284&ndash;294. doi: 10.1002/ajpa.22708
</p>


<h3>See Also</h3>

<p><code><a href="#topic+start_mmd">start_mmd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load and visualize a binary dataset:
data(toyMMD)
head(toyMMD)

## Convert this dataframe into a table of sample sizes and relative
## frequencies:
tab &lt;- binary_to_table(toyMMD, relative = TRUE)
tab

## Compute and display a symmetrical matrix of MMD values:
mmd_out &lt;- mmd(tab, angular = "Anscombe")
mmd_out$MMDSym

## Significant MMD values are indicated by a star:
mmd_out$MMDSignif
</code></pre>

<hr>
<h2 id='mmd_boot'>
Implementation of Fidalgo et al.'s (2022) method of bootstrap for the
Mean Measure of Divergence
</h2><span id='topic+mmd_boot'></span>

<h3>Description</h3>

<p>Compute a matrix of MMD dissimilarities among bootstrapped samples of
the original groups. The input data must be a &ldquo;raw binary
dataset&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmd_boot(data, angular = c("Anscombe", "Freeman"), B = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmd_boot_+3A_data">data</code></td>
<td>
<p>A &ldquo;raw binary dataset&rdquo;, as defined in the man page
of <code><a href="#topic+start_mmd">start_mmd</a></code>.</p>
</td></tr>
<tr><td><code id="mmd_boot_+3A_angular">angular</code></td>
<td>
<p>Choice of a formula for angular transformation: either
Anscombe or Freeman-Tukey transformation.</p>
</td></tr>
<tr><td><code id="mmd_boot_+3A_b">B</code></td>
<td>
<p>Numeric value: number of bootstrap samples.</p>
</td></tr>
<tr><td><code id="mmd_boot_+3A_...">...</code></td>
<td>
<p>Arguments for traits selection, passed to
<code><a href="#topic+select_traits">select_traits</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function sticks very close to Fidalgo et al's (2022)
implementation. In particular, no correction for small sample sizes is
applied in the MMD formula; see Fidalgo et al's (2021) for the
rationale.
</p>
<p>Note that <b>only</b> a &ldquo;raw binary dataset&rdquo; is allowed as
input, since the resampling cannot be performed properly from a table
of counts and frequencies.
</p>
<p>To get a MDS plot of the dissimilarity matrix obtained with this
function, see <code><a href="#topic+plot.anthropmmd_boot">plot.anthropmmd_boot</a></code>.
</p>


<h3>Value</h3>

<p>A symmetrical dissimilarity matrix of MMD values among original groups
and bootstrapped samples. This matrix is an R object of class
<code>anthropmmd_boot</code>.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>D. Fidalgo, M. Hubbe and V. Vesolowski (2021). Population history of
Brazilian south and southeast shellmound builders inferred through
dental morphology. <em>American Journal of Physical Anthropology</em>
<b>176</b>(2), 192-207.
</p>
<p>D. Fidalgo, V. Vesolowski and M. Hubbe (2022). Biological affinities
of Brazilian pre-colonial coastal communities explored through
boostrapped biodistances of dental non-metric traits. <em>Journal of
Archaeological Science</em> <b>138</b>, 105545.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.anthropmmd_boot">plot.anthropmmd_boot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load and visualize a raw binary dataset:
data(toyMMD)
head(toyMMD)
## Compute MMD among bootstrapped samples:
resboot &lt;- mmd_boot(
    data = toyMMD,
    B = 50, # number of bootstrap samples
    angular = "Anscombe",
    strategy = "excludeQNPT", # strategy for trait selection
    k = 10 # minimal number of observations required per trait
)
## View part of MMD matrix among bootstrapped samples:
dim(resboot)
print(resboot[1:15, 1:15])

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.anthropmmd_boot'>
Display a multidimensional scaling (MDS) plot using Fidalgo et al's
(2022) bootstrap method for MMD
</h2><span id='topic+plot.anthropmmd_boot'></span>

<h3>Description</h3>

<p>This function plots a 2D MDS to represent the MMD dissimilarities
among the groups compared, after a bootstrap resampling performed with
<code><a href="#topic+mmd_boot">mmd_boot</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anthropmmd_boot'
plot(x, method = c("classical", "interval", "ratio", "ordinal"),
    level = 0.95, pch = 16, gof = FALSE, xlab = NA, ylab = NA,
    main = "MDS plot of original and bootstrapped samples", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.anthropmmd_boot_+3A_x">x</code></td>
<td>
<p>An object of class <code>anthropmmd_boot</code>, produced by the
function <code><a href="#topic+mmd_boot">mmd_boot</a></code>.</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="plot.anthropmmd_boot_+3A_method">method</code></td>
<td>
<p>Algorithm used for MDS computation; see <code><a href="#topic+plot.anthropmmd_result">plot.anthropmmd_result</a></code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_level">level</code></td>
<td>
<p>Numeric value between 0 and 1, confidence level for the
contour lines displayed after the kernel density estimate.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_pch">pch</code></td>
<td>
<p>Passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_gof">gof</code></td>
<td>
<p>Boolean; whether to display goodness of fit statistic on
the plot.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_xlab">xlab</code></td>
<td>
<p>Passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_ylab">ylab</code></td>
<td>
<p>Passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_main">main</code></td>
<td>
<p>Passed to <code>plot</code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_boot_+3A_...">...</code></td>
<td>
<p>Other arguments possibly passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the current implementation, to stick to Fidalgo et al.'s (2022)
protocol, this function does not provide as much freedom as
<code><a href="#topic+plot.anthropmmd_result">plot.anthropmmd_result</a></code> as concenrs MDS parameters and
other analysis options.
</p>


<h3>Value</h3>

<p>This function returns no value by itself, and only plots a MDS in a
new device.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>D. Fidalgo, V. Vesolowski and M. Hubbe (2022). Biological affinities
of Brazilian pre-colonial coastal communities explored through
boostrapped biodistances of dental non-metric traits. <em>Journal of
Archaeological Science</em> <b>138</b>, 105545.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+start_mmd">start_mmd</a></code>, <code>stats::cmdscale</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load and visualize a raw binary dataset:
data(toyMMD)
head(toyMMD)
## Compute MMD among bootstrapped samples:
resboot &lt;- mmd_boot(
    data = toyMMD,
    B = 50, # number of bootstrap samples
    angular = "Anscombe",
    strategy = "excludeQNPT", # strategy for trait selection
    k = 10 # minimal number of observations required per trait
)
## MDS plot for bootstrapped samples:
plot(
    x = resboot,
    method = "interval", # algorithm used for MDS computation
    level = 0.95 # confidence level for the contour lines
)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.anthropmmd_result'>
Display a multidimensional scaling (MDS) plot with the MMD
dissimilarities as input
</h2><span id='topic+plot.anthropmmd_result'></span>

<h3>Description</h3>

<p>This function plots a 2D or 3D MDS to represent the MMD
dissimilarities among the groups compared. Various MDS methods are
proposed, and most of them are based on the R package <code>smacof</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anthropmmd_result'
plot(x, method = c("classical", "interval", "ratio", "ordinal"),
axes = FALSE, gof = FALSE, dim = 2, asp = TRUE, xlim = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.anthropmmd_result_+3A_x">x</code></td>
<td>
<p>An object of class <code>anthropmmd_result</code>, produced by the
function <code><a href="#topic+mmd">mmd</a></code>.</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code id="plot.anthropmmd_result_+3A_method">method</code></td>
<td>
<p>Specification of MDS type. <code>classical</code> uses the
metric MDS implemented in <code>stats::cmdscale</code>; the three other
values are passed to the R function <code>smacof::smacofSym</code> (see
its help page for more details).</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_axes">axes</code></td>
<td>
<p>Boolean: should the axes be displayed on the plot?</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_gof">gof</code></td>
<td>
<p>Boolean: should goodness of fit statistics be displayed on
the topleft corner of the plot? More details below.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_dim">dim</code></td>
<td>
<p>Numeric value, 2 or 3. Indicates the maximal dimension
desired for the MDS plot. It should be noted that, even with
<code>dim = 3</code>, the final solution may include only two axes.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_asp">asp</code></td>
<td>
<p>Boolean. If <code>TRUE</code>, the same scale is used for all
axes. More details below.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_xlim">xlim</code></td>
<td>
<p>Parameter passed to <code>plot</code>, can be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.anthropmmd_result_+3A_...">...</code></td>
<td>
<p>Other arguments possibly passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><b>Axes and scale</b>. Making all axes use the same scale is
strongly recommended in all cases (Borg et al., 2013). For a
3D-plot, since the third axis carries generally only a very small
percentage of the total variability, you might want to uncheck this
option to better visualize the distances along the third axis. In
this case, the axes scales must be displayed on the plot, otherwise
the plot would be misleading.
</p>
</li>
<li> <p><b>Goodness of fit values</b>. (i) For classical metric MDS, a
common statistic is given: the sum of the eigenvalues of the first
two axes, divided by the sum of all eigenvalues. It indicates the
fraction of the total variance of the data represented in the MDS
plot. This statistic comes from the <code>$GOF</code> value returned by
the function <code>stats::cmdscale</code>. (ii) For SMACOF methods, the
statistic given is the <code>$stress</code> value returned by the function
<code>smacof::smacofSym</code> It indicates the final stress-1 value. A
value very close to 0 corresponds to a perfect fit. (iii) For both
approaches, a 'rho' value is also given, which is the Spearman's
correlation coefficient between real dissimilarities (i.e., MMD
values) and distances observed on the MDS plot (Dzemyda et
al.,2013). A value very close to 1 indicates a perfect fit.
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns no value by itself, and only plots a MDS in a
new device.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>G. Dzemyda, O. Kurasova and J. Zilinskas (2013) <em>Multidimensional
Data  Visualization</em>, Springer, chap. 2, p. 39&ndash;40.
</p>
<p>I. Borg, P. Groenen and P. Mair (2013) <em>Applied Multidimensional
Scaling</em>, Springer, chap. 7, p. 79.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+start_mmd">start_mmd</a></code>, <code>stats::cmdscale</code>, <code>smacof::smacofSym</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load and visualize a binary dataset:
data(toyMMD)
head(toyMMD)

## Convert this dataframe into a table of sample sizes and relative
## frequencies:
tab &lt;- binary_to_table(toyMMD, relative = TRUE)
tab

## Compute and display a symmetrical matrix of MMD values:
mmd_out &lt;- mmd(tab, angular = "Freeman")

## Plot a classical metric MDS in two dimensions:
plot(x = mmd_out, method = "classical",
     axes = TRUE, gof = TRUE, dim = 2)
</code></pre>

<hr>
<h2 id='select_traits'>
Select a subset of traits meeting certain criteria
</h2><span id='topic+select_traits'></span>

<h3>Description</h3>

<p>This function provides several strategies to discard some useless
traits (non-polymorphic, non-discriminatory, etc.) upstream the MMD
analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_traits(tab, k = 10, strategy = c("none", "excludeNPT",
"excludeQNPT", "excludeNOMD", "keepFisher"), OMDvalue = NULL, groups,
angular = c("Anscombe", "Freeman"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_traits_+3A_tab">tab</code></td>
<td>
<p>A table of sample sizes and frequencies, typically returned
by the function <code><a href="#topic+binary_to_table">binary_to_table</a></code> with the argument
<code>relative = TRUE</code>.</p>
</td></tr>
<tr><td><code id="select_traits_+3A_k">k</code></td>
<td>
<p>Numeric value: the required minimal number of individuals per
group. Any trait that could be taken on fewer individuals in at
least one group will be removed from the dataset. This allows to
select only the traits with a sufficient amount of information in
each group.</p>
</td></tr>
<tr><td><code id="select_traits_+3A_strategy">strategy</code></td>
<td>
<p>Strategy for trait selection, i.e. for the removal of
non-polymorphic traits. The four options are fully described in
Santos (2018) and in the help page of <code><a href="#topic+StartMMD">StartMMD</a></code>.</p>
</td></tr>
<tr><td><code id="select_traits_+3A_omdvalue">OMDvalue</code></td>
<td>
<p>To be specified if and only if <code>strategy =
    "excludeNOMD"</code>. Set the desired threshold for the &ldquo;overall
measure of divergence&rdquo; that must be reached for a trait to be kept.</p>
</td></tr>
<tr><td><code id="select_traits_+3A_groups">groups</code></td>
<td>
<p>A factor or character vector, indicating the group to be
considered in the analysis. Since some groups can have a very low
sample size, this will allow to discard those groups in order to
facilitate the trait selection via the argument
<code>k</code>. (Otherwise, almost all traits would be removed.)</p>
</td></tr>
<tr><td><code id="select_traits_+3A_angular">angular</code></td>
<td>
<p>Formula for angular transformation, see Harris and
Sjøvold (2004). Useful only for the calculation of overall measure
of divergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components:
</p>
<table>
<tr><td><code>filtered</code></td>
<td>
<p>The dataset filtered according to the user-defined
criteria.</p>
</td></tr>
<tr><td><code>OMD</code></td>
<td>
<p>The &ldquo;overall measure of divergence&rdquo; for
each trait.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>References</h3>

<p>Harris, E. F. and Sjøvold, T. (2004) Calculation of Smith's mean
measure of divergence for intergroup comparisons using nonmetric
data. <em>Dental Anthropology</em>, <b>17</b>(3), 83&ndash;93.
</p>
<p>Santos, F. (2018) AnthropMMD: an R package with a graphical user
interface for the mean measure of divergence. <em>American Journal
of Physical Anthropology</em>, <b>165</b>(1), 200&ndash;205. doi:
10.1002/ajpa.23336
</p>


<h3>See Also</h3>

<p><code><a href="#topic+start_mmd">start_mmd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load and visualize a binary dataset:
data(toyMMD)
head(toyMMD)

## Convert this dataframe into a table of sample sizes and
## relative frequencies:
tab &lt;- binary_to_table(toyMMD, relative = TRUE)
tab

## Filter this dataset to keep only those traits that have at
## least k=10 individuals in each group:
select_traits(tab, k = 10)
## Only Trait1 is excluded.

## Filter this dataset to keep only those traits that have at
## least k=11 individuals in each group, and show significant
## differences at Fisher's exact test:
select_traits(tab, k = 11, strategy = "keepFisher")
## Traits 1, 5 and 8 are excluded.
</code></pre>

<hr>
<h2 id='start_mmd'>
An R-Shiny application for the mean measure of divergence
</h2><span id='topic+start_mmd'></span><span id='topic+StartMMD'></span>

<h3>Description</h3>

<p>Launches a graphical user interface (GUI) for the calculation of the
mean measure of divergence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>start_mmd()
StartMMD()
</code></pre>


<h3>Details</h3>

<p>The GUI of AnthropMMD is completely autonomous: reading the data file
and specifying the parameters of the analysis are done through the
interface. Once the dataset is loaded, the output reacts dynamically to
any change in the analysis settings.
</p>

<ul>
<li><p> AnthropMMD accepts .CSV or .TXT data files, but does not support
.ODS or .XLS(X) files. Two types of data input formats can be used:
</p>

<ul>
<li><p> A &lsquo;Raw binary dataset&rsquo; (one row for each individual,
one column for each variable). The first column must be the group
indicator, and the other columns are binary data for the traits
studied, where 1 indicates the presence of a trait, and 0 its
absence. Row names are optional for this type of file. An example of
valid data file can be found as Supporting Information online in
Santos (2018).
</p>
</li>
<li><p> A &lsquo;Table of n's and absolute frequencies for each
group&rsquo;, i.e. a dataset of sample sizes and absolute
frequencies. This type of dataset has <code class="reqn">2 \times K</code> rows
(<code class="reqn">K</code> being the number of groups compared) and <code class="reqn">p</code>
columns (<code class="reqn">p</code> being the number of traits studied). The first
<code class="reqn">K</code> lines must be the group n's for each trait, and the last
<code class="reqn">K</code> lines are absolute frequencies for each trait (i.e. the
number of times the trait is present). Row names are mandatory for
this type of file. The first <code class="reqn">K</code> rows must be labelled with
names beginning with &lsquo;N_&rsquo;, such as: N_GroupA, N_GroupB, ...,
N_GroupK. The last <code class="reqn">K</code> rows should be labelled with names
beginning with &lsquo;Freq_&rsquo;, such as: Freq_GroupA, ...,
Freq_GroupK. An example of valid data file can be found as
Supporting Information online in Santos (2018).
</p>
</li></ul>

<p>For both data types, column names are strongly recommended for better
interpretability of the results.
</p>
</li>
<li><p> One can choose between Anscombe or Freeman-Tukey formula for
angular transformation (cf. Harris and Sjøvold 2004; Irish 2010).
</p>
</li>
<li> <p>&lsquo;Only retain the traits with this minimal number of
individuals per group&rsquo;: the traits with fewer individuals in at least
one active group will not be considered in the analysis.
</p>
</li>
<li> <p>&lsquo;Exclusion strategy&rsquo;: a careful selection of traits is
crucial when using MMD (cf. Harris and Sjøvold 2004 for a complete
explanation), and the user should probably &ldquo;exclude the traits
that are nondiscriminatory across groups&rdquo; (Irish 2010).
</p>

<ul>
<li> <p>&lsquo;Exclude nonpolymorphic traits&rsquo; removes all the traits
showing no variability at all, i.e. with the same value (&lsquo;0&rsquo;
or &lsquo;1&rsquo;) for all individuals.
</p>
</li>
<li> <p>&lsquo;Exclude quasi-nonpolymorphic traits&rsquo; also removes the
traits whose variability is only due to a single individual: for
example, a trait with only one positive observation in the whole
dataset.
</p>
</li>
<li> <p>&lsquo;Use Fisher's exact test&rsquo; implements the advice given
by Harris and Sjøvold (2004) to select contributory traits, defined
as those &ldquo;showing a statistically significant difference
between at least one pair of the groups being evaluated&rdquo;. Fisher's
exact tests are performed for each pair of groups, and the traits
showing no intergroup difference at all are excluded. Note that if
you have a large number of groups (say, 10 groups), a trait with
strictly equal frequencies for the last 8 groups may be considered
as useful according to this criterion if there is a significant
difference for the first two groups. This criterion will select all
traits that can be useful for a given pair of groups, even if they
are nondiscriminatory for all the other ones.
</p>
</li>
<li> <p>&lsquo;Exclude traits with overall MD&rsquo; lower than a given
threshold: it is a simple way of removing the traits with quite similar
frequencies across groups (the &lsquo;overall MD&rsquo; is defined as the sum
of the variable's measures of divergence over all pairs of groups). This
criterion aims to select the traits whose frequency differs
substantially across most or all groups.
</p>
</li></ul>

<p>These four options are designed to avoid negative MMD values.
</p>
</li>
<li><p> Some groups/populations can be manually excluded from the
analysis. This may be useful if very few individuals belonging to a
given population could be recorded for the variables retained by the
criteria described above.
</p>
</li>
<li><p> A MDS plot and a hierarchical clustering, done using MMD
dissimilarities as inputs, are displayed in the last two tabs. As MMD
can sometimes be negative, those negatives values are replaced by
zeros, so that the MMD matrix can be seen as a symmetrical distance
matrix. Please note that the classical two-dimensional metric MDS plot
cannot be displayed if there is only one positive eigenvalue. Several
MDS options are proposed, cf. the help page of the <code>smacofSym</code>
function from the R package <code>smacof</code> for detailed technical
information.
</p>
</li></ul>



<h3>Value</h3>

<p>The function returns no value by itself, but all results can be
individually downloaded through the graphical interface.
</p>

<ul>
<li><p> The &lsquo;true&rsquo; MMD values (i.e., which can be negative in
the case of small samples with similar traits frequencies, cf. Irish
2010) and their standard deviations are presented in the matrix
labelled &lsquo;MMD values (upper triangular part) and associated
SD values (lower triangular part)&rsquo;.
</p>
</li>
<li><p> A MMD value can be considered as significant if it is greater
than twice its standard deviation. Significance is assessed in
another ad-hoc table of results.
</p>
</li>
<li><p> The negative MMD values, if any, are replaced by zeros in the
&lsquo;Symmetrical matrix of MMD values&rsquo;.
</p>
</li></ul>



<h3>Note</h3>

<p>The R console is not available when the GUI is active. To exit the
GUI, type Echap (on MS Windows systems) or Ctrl+C (on Linux systems)
in the R console.
</p>
<p>On 14-inch (or smaller) screens, for convenience, it may be necessary
to decrease the zoom level of your web browser and/or to turn on
fullscreen mode.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a>
</p>


<h3>References</h3>

<p>Harris, E. F. and Sjøvold, T. (2004) Calculation of Smith's mean
measure of divergence for intergroup comparisons using nonmetric
data. <em>Dental Anthropology</em>, <b>17</b>(3), 83&ndash;93.
</p>
<p>Irish, J. (2010) The mean measure of divergence: Its utility in
model-free and model-bound analyses relative to the Mahalanobis D2
distance for nonmetric traits. <em>American Journal of Human
Biology</em>, <b>22</b>, 378&ndash;395. doi: 10.1002/ajhb.21010
</p>
<p>Nikita, E. (2015) A critical review of the mean measure of divergence
and Mahalanobis distances using artificial data and new approaches to
the estimation of biodistances employing nonmetric
traits. <em>American Journal of Physical Anthropology</em>, <b>157</b>,
284&ndash;294. doi: 10.1002/ajpa.22708
</p>
<p>Santos, F. (2018) AnthropMMD: an R package with a graphical user
interface for the mean measure of divergence. <em>American Journal
of Physical Anthropology</em>, <b>165</b>(1), 200&ndash;205. doi:
10.1002/ajpa.23336
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## An example of valid binary dataset:
data(toyMMD)
head(toyMMD)

## An example of valid table:
data(absolute_freqs)
absolute_freqs

## Launch the GUI:
## Not run:  start_mmd()
</code></pre>

<hr>
<h2 id='table_relfreq'>
Converts a table of sample sizes and frequencies into a table of
sample sizes and relative frequencies.
</h2><span id='topic+table_relfreq'></span>

<h3>Description</h3>

<p>Mostly used as an internal function, but could also be convenient to
transform frequencies (i.e., number of individuals having a given
trait) into relative frequencies (i.e., proportions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table_relfreq(tab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table_relfreq_+3A_tab">tab</code></td>
<td>
<p>A table of sample sizes and frequencies, such as the tables
returned by the function <code><a href="#topic+binary_to_table">binary_to_table</a>.</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The last <code class="reqn">K</code> rows (<code class="reqn">K</code> being the number of groups) of
<code>tab</code> are simply transformed to relative frequencies.
</p>


<h3>Author(s)</h3>

<p>Frédéric Santos, <a href="mailto:frederic.santos@u-bordeaux.fr">frederic.santos@u-bordeaux.fr</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+binary_to_table">binary_to_table</a></code>, <code><a href="#topic+start_mmd">start_mmd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load and visualize a binary dataset:
data(toyMMD)
head(toyMMD)

## Convert this dataframe into a table of sample sizes and frequencies:
tab &lt;- binary_to_table(toyMMD, relative = FALSE)
tab

## Convert this table into relative frequencies:
table_relfreq(tab)
</code></pre>

<hr>
<h2 id='toyMMD'>
A toy example dataset for mean measures of divergence, in a binary
format
</h2><span id='topic+toyMMD'></span>

<h3>Description</h3>

<p>This artifical dataset includes 200 individuals described by 9 binary
traits and splitted into 5 groups. To fit with commonly observed
datasets in past sciences, a substantial amount of missing values have
been added at random on this dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toyMMD)</code></pre>


<h3>Format</h3>

<p>A data frame with 200 observations on the following 10 variables:
</p>

<dl>
<dt><code>Group</code></dt><dd><p>a factor with 5 levels (group indicator)</p>
</dd>
<dt><code>Trait1</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait2</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait3</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait4</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait5</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait6</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait7</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait8</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
<dt><code>Trait9</code></dt><dd><p>a numeric vector of zeroes and ones</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
