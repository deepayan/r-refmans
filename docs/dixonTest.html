<!DOCTYPE html><html><head><title>Help for package dixonTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dixonTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Dixon'><p>Dixon distribution</p></a></li>
<li><a href='#dixonTest'><p>Dixons Outlier Test (Q-Test)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dixon's Ratio Test for Outlier Detection</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-22</td>
</tr>
<tr>
<td>Description:</td>
<td>For outlier detection in small and normally distributed 
    samples the ratio test of Dixon (Q-test) can be used. Density,
    distribution function, quantile function and random generation 
    for Dixon's ratio statistics are provided as wrapper functions.
    The core applies McBane's Fortran functions &lt;<a href="https://doi.org/10.18637%2Fjss.v016.i03">doi:10.18637/jss.v016.i03</a>&gt; 
    that use Gaussian quadrature for a numerical solution.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Classification/MSC-2010:</td>
<td>62F03, 62E17, 62Q05</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-22 19:24:55 UTC; thorsten</td>
</tr>
<tr>
<td>Author:</td>
<td>Thorsten Pohlert <a href="https://orcid.org/0000-0003-3855-3025"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  George C. McBane [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thorsten Pohlert &lt;thorsten.pohlert@gmx.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-22 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Dixon'>Dixon distribution</h2><span id='topic+Dixon'></span><span id='topic+qdixon'></span><span id='topic+pdixon'></span><span id='topic+ddixon'></span><span id='topic+rdixon'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function
and random generation for Dixon's ratio statistics <code class="reqn">r_{j,i-1}</code>
for outlier detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qdixon(p, n, i = 1, j = 1, log.p = FALSE, lower.tail = TRUE)

pdixon(q, n, i = 1, j = 1, lower.tail = TRUE, log.p = FALSE)

ddixon(x, n, i = 1, j = 1, log = FALSE)

rdixon(n, i = 1, j = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dixon_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="Dixon_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>,
the length is taken to be the number required</p>
</td></tr>
<tr><td><code id="Dixon_+3A_i">i</code></td>
<td>
<p>number of observations &lt;= x_i</p>
</td></tr>
<tr><td><code id="Dixon_+3A_j">j</code></td>
<td>
<p>number of observations &gt;= x_j</p>
</td></tr>
<tr><td><code id="Dixon_+3A_log.p">log.p</code></td>
<td>
<p>logical; if <code>TRUE</code> propabilities p are given as log(p)</p>
</td></tr>
<tr><td><code id="Dixon_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), probabilities are P[X &lt;= x] otherwise, P[X &gt; x].</p>
</td></tr>
<tr><td><code id="Dixon_+3A_q">q</code></td>
<td>
<p>vector of quantiles</p>
</td></tr>
<tr><td><code id="Dixon_+3A_x">x</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="Dixon_+3A_log">log</code></td>
<td>
<p>logical; if <code>TRUE</code> (default),
probabilities p are given as log(p).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>According to McBane (2006) the density of the statistics <code class="reqn">r_{j,i-1}</code> of Dixon
can be yield if <code class="reqn">x</code> and <code class="reqn">v</code> are integrated over the range <code class="reqn">(-\infty &lt; x &lt; \infty, 0 \le v &lt; \infty)</code>
</p>
<p style="text-align: center;"><code class="reqn">
\begin{array}{lcl}
f(r) &amp; = &amp; \frac{n!}{\left(i-1\right)! \left(n-j-i-1\right)!\left(j-1\right)!} \\
      &amp; &amp; \times \int_{-\infty}^{\infty} \int_{0}^{\infty} \left[\int_{-\infty}^{x-v} \phi(t)dt\right]^{i-1}
       \left[\int_{x-v}^{x-rv} \phi(t)dt \right]^{n-j-i-1} \\
     &amp; &amp;  \times \left[\int_{x-rv}^x \phi(t)dt \right]^{j-1} \phi(x-v)\phi(x-rv)\phi(x)v ~ dv ~ dx \\
\end{array}</code>
</p>

<p>where <code class="reqn">v</code> is the Jacobian and <code class="reqn">\phi(.)</code> is the density of the standard normal distribution.
McBane (2006) has proposed a numerical solution using Gaussian quadratures
(Gauss-Hermite quadrature and half-range Hermite quadrature) and coded
a library in Fortran. These R functions are wrapper functions to
use the respective Fortran code.
</p>


<h3>Value</h3>

<p><code>ddixon</code> gives the density function,
<code>pdixon</code> gives the distribution function,
<code>qdixon</code> gives the quantile function and
<code>rdixon</code> generates random deviates.
</p>


<h3>Source</h3>

<p>The R code is a wrapper to the Fortran code released
under GPL &gt;=2 in the electronic supplement of McBane (2006).
The original files are &lsquo;<span class="file">rfuncs.f</span>&rsquo;, &lsquo;<span class="file">utility.f</span>&rsquo; and &lsquo;<span class="file">dixonr.fi</span>&rsquo;.
They were slightly modified to comply with current CRAN policy and the R manual
&lsquo;Writing R Extensions&rsquo;.
</p>


<h3>Note</h3>

<p>The file &lsquo;<span class="file">slowTest/d-p-q-r-tests.R.out.save</span>&rsquo; that is included in this package
contains some results for the assessment of the numerical accuracy.
</p>
<p>The slight numerical differences between McBane's original Fortran output
(see files &lsquo;<span class="file">slowTests/test[1,2,4].ref.output.txt</span>&rsquo;) and
this implementation are related to different floating point rounding
algorithms between R (see &lsquo;round to even&rsquo; in <code><a href="base.html#topic+round">round</a></code>)
and Fortran's <code>write(*,'F6.3')</code> statement.
</p>


<h3>References</h3>

<p>Dixon, W. J. (1950) Analysis of extreme values.
<em>Ann. Math. Stat.</em> <b>21</b>, 488&ndash;506.
<a href="https://doi.org/10.1214/aoms/1177729747">doi:10.1214/aoms/1177729747</a>.
</p>
<p>Dean, R. B., Dixon, W. J. (1951) Simplified statistics for small
numbers of observation. <em>Anal. Chem.</em> <b>23</b>, 636&ndash;638.
<a href="https://doi.org/10.1021/ac60052a025">doi:10.1021/ac60052a025</a>.
</p>
<p>McBane, G. C. (2006) Programs to compute distribution functions
and critical values for extreme value ratios for outlier detection.
<em>J. Stat. Soft.</em> <b>16</b>.
<a href="https://doi.org/10.18637/jss.v016.i03">doi:10.18637/jss.v016.i03</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
n &lt;- 20
Rdixon &lt;- rdixon(n, i = 3, j = 2)
Rdixon
pdixon(Rdixon, n = n, i = 3, j = 2)
ddixon(Rdixon, n = n, i = 3, j = 2)

</code></pre>

<hr>
<h2 id='dixonTest'>Dixons Outlier Test (Q-Test)</h2><span id='topic+dixonTest'></span>

<h3>Description</h3>

<p>Performs Dixons single outlier test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dixonTest(x, alternative = c("two.sided", "greater", "less"), refined = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dixonTest_+3A_x">x</code></td>
<td>
<p>a numeric vector of data</p>
</td></tr>
<tr><td><code id="dixonTest_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis.
Defaults to <code>"two.sided"</code></p>
</td></tr>
<tr><td><code id="dixonTest_+3A_refined">refined</code></td>
<td>
<p>logical indicator, whether the refined version
or the Q-test shall be performed. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">X</code> denote an identically and independently distributed
normal variate. Further, let the increasingly ordered realizations
denote <code class="reqn">x_1 \le x_2 \le \ldots \le x_n</code>.
Dixon (1950) proposed the following ratio statistic to detect
an outlier (two sided):
</p>
<p style="text-align: center;"><code class="reqn">
  r_{j,i-1} = \max\left\{\frac{x_n - x_{n-j}}{x_n - x_i},
  \frac{x_{1+j} - x_1}{x_{n-i} - x_1}\right\}</code>
</p>

<p>The null hypothesis, no outlier, is tested against the alternative,
at least one observation is an outlier (two sided). The subscript <code class="reqn">j</code>
on the <code class="reqn">r</code> symbol indicates the number of
outliers that are suspected at the upper end of the data set,
and the subscript <code class="reqn">i</code> indicates the number of outliers suspected
at the lower end. For <code class="reqn">r_{10}</code> it is also common to use the
statistic <code class="reqn">Q</code>.
</p>
<p>The statistic for a single maximum outlier is:
</p>
<p style="text-align: center;"><code class="reqn">
  r_{j,i-1} = \left(x_n - x_{n-j} \right) / \left(x_n - x_i\right)</code>
</p>

<p>The null hypothesis is tested against the alternative,
the maximum observation is an outlier.
</p>
<p>For testing a single minimum outlier, the test statistic is:
</p>
<p style="text-align: center;"><code class="reqn">
   r_{j,i-1} = \left(x_{1+j} - x_1 \right) / \left(x_{n-i} - x_1 \right)</code>
</p>

<p>The null hypothesis is tested against the alternative,
the minimum observation is an outlier.
</p>
<p>Apart from the earlier Dixons Q-test (i.e. <code class="reqn">r_{10}</code>),
a refined version that was later proposed by Dixon can be performed
with this function, where the statistic <code class="reqn">r_{j,i-1}</code> depends on
the sample size as follows:
</p>

<table>
<tr>
 <td style="text-align: right;">
 <code class="reqn">r_{10}</code>: </td><td style="text-align: left;"> <code class="reqn">3 \le n \le 7</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
 <code class="reqn">r_{11}</code>: </td><td style="text-align: left;"> <code class="reqn">8 \le n \le 10</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
 <code class="reqn">r_{21}</code>; </td><td style="text-align: left;"> <code class="reqn">11 \le n \le 13</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
 <code class="reqn">r_{22}</code>: </td><td style="text-align: left;"> <code class="reqn">14 \le n \le 30</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
</td>
</tr>

</table>

<p>The p-value is computed with the function <code><a href="#topic+pdixon">pdixon</a></code>.
</p>


<h3>References</h3>

<p>Dixon, W. J. (1950) Analysis of extreme values.
<em>Ann. Math. Stat.</em> <b>21</b>, 488&ndash;506.
<a href="https://doi.org/10.1214/aoms/1177729747">doi:10.1214/aoms/1177729747</a>.
</p>
<p>Dean, R. B., Dixon, W. J. (1951) Simplified statistics for small
numbers of observation. <em>Anal. Chem.</em> <b>23</b>, 636&ndash;638.
<a href="https://doi.org/10.1021/ac60052a025">doi:10.1021/ac60052a025</a>.
</p>
<p>McBane, G. C. (2006) Programs to compute distribution functions
and critical values for extreme value ratios for outlier detection.
<em>J. Stat. Soft.</em> <b>16</b>.
<a href="https://doi.org/10.18637/jss.v016.i03">doi:10.18637/jss.v016.i03</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example from Dean and Dixon 1951, Anal. Chem., 23, 636-639.
x &lt;- c(40.02, 40.12, 40.16, 40.18, 40.18, 40.20)
dixonTest(x, alternative = "two.sided")

## example from the dataplot manual of NIST
x &lt;- c(568, 570, 570, 570, 572, 578, 584, 596)
dixonTest(x, alternative = "greater", refined = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
