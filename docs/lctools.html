<!DOCTYPE html><html lang="en"><head><title>Help for package lctools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lctools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lctools-package'><p>Local Correlation, Spatial Inequalities, Spatial Regression and Other Tools</p></a></li>
<li><a href='#acc'><p>Spatial Interaction Models: Destination Accessibility</p></a></li>
<li><a href='#FLQ'><p>Focal Location Quotient</p></a></li>
<li><a href='#GR.Municipalities'><p>Municipalities in Greece in 2011</p></a></li>
<li><a href='#gw_variable'><p>Spatial Interaction Models: gw / regional variable</p></a></li>
<li><a href='#gw.glm'><p>Generalised Geographically Weighted Regression (GGWR)</p></a></li>
<li><a href='#gw.glm.bw'><p>Optimal bandwidth estimation for Generalised Geographically Weighted Regression (GGWR)</p></a></li>
<li><a href='#gw.glm.cv'><p>A specific version of the function gw.glm</p></a></li>
<li><a href='#gw.glm.light'><p>A light version of the Generalised Geographically Weighted Regression (GGWR)</p></a></li>
<li><a href='#gw.glm.mc.test'><p>Significance test for the spatial variation of the Generalised Geographically Weighted Regression local parameter estimates</p></a></li>
<li><a href='#gw.zi'><p>Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</p></a></li>
<li><a href='#gw.zi.bw'><p>Optimal bandwidth estimation for Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</p></a></li>
<li><a href='#gw.zi.cv'><p>A specific version of the function gw.zi</p></a></li>
<li><a href='#gw.zi.light'><p>A light version of the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</p></a></li>
<li><a href='#gw.zi.mc.test'><p>Significance test for the spatial variation of the GWZIPR local parameter estimates</p></a></li>
<li><a href='#gwr'><p>Geographically Weighted Regression (GWR)</p></a></li>
<li><a href='#gwr.bw'><p>Optimal bandwidth estimation for Geographically Weighted Regression (GWR)</p></a></li>
<li><a href='#gwr.cv'><p>A specific version of the function gwr</p></a></li>
<li><a href='#l.moransI'><p>Local Moran's I classic statistic for assessing spatial autocorrelation</p></a></li>
<li><a href='#lat2w'><p>Contiguity-based weights matrix for a regular grid</p></a></li>
<li><a href='#lcorrel'><p>Local Pearson and GW Pearson Correlation</p></a></li>
<li><a href='#mc.lcorrel'><p>Monte Carlo simulation for the significance of the local correlation coefficients</p></a></li>
<li><a href='#mc.spGini'><p>Monte Carlo simulation for the significance of the Spatial Gini coefficient</p></a></li>
<li><a href='#moransI'><p>Moran's I classic statistic for assessing spatial autocorrelation</p></a></li>
<li><a href='#moransI.v'><p>Computes a vector of Moran's I statistics.</p></a></li>
<li><a href='#moransI.w'><p>Moran's I classic statistic for assessing spatial autocorrelation using a ready made weights matrix.</p></a></li>
<li><a href='#random.test.data'><p>Radmom data generator</p></a></li>
<li><a href='#spGini'><p>Spatial Gini coefficient</p></a></li>
<li><a href='#spGini.w'><p>Spatial Gini coefficient with a given weights matrix</p></a></li>
<li><a href='#VotesGR'><p>New Democracy and Total Votes in Greece in 2012</p></a></li>
<li><a href='#w.matrix'><p>Weights Matrix based on a number of nearest neighbours or a fixed distance</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.2-10</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-02</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Local Correlation, Spatial Inequalities, Geographically Weighted
Regression and Other Tools</td>
</tr>
<tr>
<td>Author:</td>
<td>Stamatis Kalogirou [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sp, reshape, weights, pscl, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides researchers and educators with easy-to-learn user friendly tools for calculating 
    key spatial statistics and to apply simple as well as advanced methods of spatial analysis in real data. 
    These include: Local Pearson and Geographically Weighted Pearson Correlation Coefficients, 
    Spatial Inequality Measures (Gini, Spatial Gini, LQ, Focal LQ), Spatial Autocorrelation 
    (Global and Local Moran's I), several Geographically Weighted Regression techniques and other 
    Spatial Analysis tools (other geographically weighted statistics). This package also contains functions for 
    measuring the significance of each statistic calculated, mainly based on Monte Carlo simulations.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://stamatisgeoai.eu">https://stamatisgeoai.eu</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-01 22:17:30 UTC; Stamatis</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-01 23:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lctools-package'>Local Correlation, Spatial Inequalities, Spatial Regression and Other Tools</h2><span id='topic+lctools-package'></span><span id='topic+lctools'></span>

<h3>Description</h3>

<p>The main purpose of lctools is to assist spatial analysis researchers and educators to use simple, yet powerful, transparent and user friendly tools for calculating key spatial statistics and fitting spatial models. lctools was originally created to help testing the existence of local multi-collinearity among the explanatory variables of local regression models. The main function (lcorrel) allows for the computation of Local Pearson and Geographically Weighted Pearson Correlation Coefficients and their significance. However, the latter could also be used for examining the existence of local association between pairs of variables. As spatial analysis techniques develop, this package has other spatial statistical tools: the spatial decomposition of the Gini coefficient, the spatial/Focal LQ, global and local Moran's I and tools that help computing variables for Spatial Interaction Models. Since the version 0.2-4, lctools allows for the application of various Geographically Weighted Regression methods including the Geographically Weighted Zero Inflated Poisson Regression recently proposed in the literature (Kalogirou, 2016). This package also contains functions for measuring the significance level for each statistic calculated. The latter mainly refers to Monte Carlo simulations. The package comes with two datasets one of which is a spatial data frame that refers to the Municipalities in Greece.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> lctools</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.2-10</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-01</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)
</td>
</tr>

</table>



<h3>Note</h3>

<p>Acknowledgement: I am grateful to the University of Luxembourg and would like to personally thank Ass. Professor Geoffrey Caruso, Professor Markus Hesse and Professor Christian Schulz for their support during my research visit at the Institute of Geography and Spatial Planning (Sept. 2013 - Feb. 2014) where this package was originally developed.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou
</p>
<p>Maintainer: Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Hope, A.C.A. (1968) A Simplified Monte Carlo Significance Test Procedure, Journal of the Royal Statistical Society. Series B (Methodological), 30 (3), pp. 582 - 598.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2012) Testing local versions of correlation coefficients, Review of Regional Research - Jahrbuch fur Regionalwissenschaft, 32(1), pp. 45-61, doi: 10.1007/s10037-011-0061-y. <a href="https://link.springer.com/article/10.1007/s10037-011-0061-y">https://link.springer.com/article/10.1007/s10037-011-0061-y</a>
</p>
<p>Kalogirou, S. (2013) Testing geographically weighted multicollinearity diagnostics, GISRUK 2013, Department of Geography and Planning, School of Environmental Sciences, University of Liverpool, Liverpool, UK, 3-5 April 2013. 
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>
<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>
<p>Rey, S.J., Smith, R.J. (2013) A spatial decomposition of the Gini coefficient, Letters in Spatial and Resource Sciences, 6 (2), pp. 55-70.</p>

<hr>
<h2 id='acc'>Spatial Interaction Models: Destination Accessibility</h2><span id='topic+acc'></span>

<h3>Description</h3>

<p>Destination accessibility or centrality or competition is a variable that when added to a destination choice model forms the competing destinations choice model. A simple formula for this variable is: </p>
<p style="text-align: center;"><code class="reqn">A_j = \Sigma ( W_m / D_{jm} ) | m&lt;&gt;j </code>
</p>
<p> where <code class="reqn">A_j</code> is the potential accessibility of destination <code class="reqn">j</code> to all other potential destinations <code class="reqn">m</code>, <code class="reqn">W_m</code> is a weight generally measured by population, and <code class="reqn">D_{jm}</code> is the distance between <code class="reqn">j</code> and <code class="reqn">m</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>acc(X, Y, Pop, Power=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="acc_+3A_x">X</code></td>
<td>
<p>a numeric vector of x coordinates</p>
</td></tr>
<tr><td><code id="acc_+3A_y">Y</code></td>
<td>
<p>a numeric vector of y coordinates</p>
</td></tr>
<tr><td><code id="acc_+3A_pop">Pop</code></td>
<td>
<p>a numeric vector of the weights, usually a population variable</p>
</td></tr>
<tr><td><code id="acc_+3A_power">Power</code></td>
<td>
<p>a power of the distance; default is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>AccMeasure</code></td>
<td>
<p>a single column numeric matrix of accessibility scores</p>
</td></tr>
</table>


<h3>Note</h3>

<p>X,Y should be Cartesian coordinates for the distances to be measured in meters. In the sample dataset GR.Municipalities the projection used is the EPSG:2100 (GGRS87 / Greek Grid)</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis@lctools.science&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
attr&lt;-GR.Municipalities@data
aMeasure&lt;-acc(attr$X[1:100], attr$Y[1:100],attr$PopTot01[1:100],1)
</code></pre>

<hr>
<h2 id='FLQ'>Focal Location Quotient</h2><span id='topic+FLQ'></span>

<h3>Description</h3>

<p>This is the implementation of the Focal Location Quotients proposed by Cromley and Hanink (2012). The function calculates the standard LQ and the Focal LQ based on a kernel of nearest neighbours. Two weighted schemes are currently supported: binary and bi-square weights for a fixed number of nearest neighbours set by the user.</p>


<h3>Usage</h3>

<pre><code class='language-R'>FLQ(Coords, Bandwidth, e, E, Denominator, WType = "Bi-square")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FLQ_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or dataframe of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="FLQ_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>a positive value that defines the number of nearest neighbours for the calculation of the weights</p>
</td></tr>
<tr><td><code id="FLQ_+3A_e">e</code></td>
<td>
<p>a numeric vector of a variable e_i as in the nominator of the Equation 1 (Cromley and Hanink, 2012) referring to the employment in a given sector for each location</p>
</td></tr>
<tr><td><code id="FLQ_+3A_e">E</code></td>
<td>
<p>a numeric vector of a variable E_i as in the nominator of the Equation 1 (Cromley and Hanink, 2012) referring to the total employment in a given sector for each location</p>
</td></tr>
<tr><td><code id="FLQ_+3A_denominator">Denominator</code></td>
<td>
<p>a ratio as in the denominator (e/E) of the Equation 1 (Cromley and Hanink, 2012), where e and E are total employment in the given sector and overall employment in
the reference economy, respectively.</p>
</td></tr>
<tr><td><code id="FLQ_+3A_wtype">WType</code></td>
<td>
<p>string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;Binary&quot;, &quot;Bi-square&quot;. Default is &quot;Bi-square&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: weight = (1-(ndist/H)^2)^2 for distances less than or equal to H, 0 otherwise
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>FLQ returns a list of 2 vectors:
</p>
<table role = "presentation">
<tr><td><code>LQ</code></td>
<td>
<p>A numeric vector with the Location Quotient values</p>
</td></tr>
<tr><td><code>FLQ</code></td>
<td>
<p>A numeric vector with the Focal Location Quotient values</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Cromley, R. G. and Hanink, D. M. (2012), Focal Location Quotients: Specification and Application, Geographical Analysis, 44 (4), pp. 398-410. doi: 10.1111/j.1538-4632.2012.00852.x
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(VotesGR)
res&lt;-FLQ(cbind(VotesGR$X, VotesGR$Y),4,VotesGR$NDJune12,VotesGR$AllJune12,0.2966)
boxplot(res)
</code></pre>

<hr>
<h2 id='GR.Municipalities'>Municipalities in Greece in 2011</h2><span id='topic+GR.Municipalities'></span>

<h3>Description</h3>

<p>Municipality boundaries and socioeconomic variables aggregated to the new local authority geography (Programme Kallikratis).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GR.Municipalities)</code></pre>


<h3>Format</h3>

<p>A data frame with 325 observations on the following 14 variables.
</p>

<dl>
<dt><code>OBJECTID</code></dt><dd><p>a numeric vector of area IDs</p>
</dd>
<dt><code>X</code></dt><dd><p>a numeric vector of x coordinates</p>
</dd>
<dt><code>Y</code></dt><dd><p>a numeric vector of y coordinates</p>
</dd>
<dt><code>Name</code></dt><dd><p>a character vector of municipality names (in greeklish)</p>
</dd>
<dt><code>CodeELSTAT</code></dt><dd><p>a character vector of municipality codes to link with data from the Hellenic Statistical Authority (EL.STAT.)</p>
</dd>
<dt><code>PopM01</code></dt><dd><p>a numeric vector of the total population for males in 2001 (Census)</p>
</dd>
<dt><code>PopF01</code></dt><dd><p>a numeric vector of the total population for females in 2001 (Census)</p>
</dd>
<dt><code>PopTot01</code></dt><dd><p>a numeric vector of the total population in 2001 (Census)</p>
</dd>
<dt><code>UnemrM01</code></dt><dd><p>a numeric vector of unemployment rate for males in 2001 (Census)</p>
</dd>
<dt><code>UnemrF01</code></dt><dd><p>a numeric vector of unemployment rate for females in 2001 (Census)</p>
</dd>
<dt><code>UnemrT01</code></dt><dd><p>a numeric vector of total unemployment rate in 2001 (Census)</p>
</dd>
<dt><code>PrSect01</code></dt><dd><p>a numeric vector of the proportion of economically active working in the primary financial sector (mainly agriculture; fishery; and forestry in 2001 (Census))</p>
</dd>
<dt><code>Foreig01</code></dt><dd><p>a numeric vector of proportion of people who do not have the Greek citizenship in 2001 (Census)</p>
</dd>
<dt><code>Income01</code></dt><dd><p>a numeric vector of mean recorded household income (in Euros) earned in 2001 and declared in 2002 tax forms</p>
</dd>
</dl>



<h3>Details</h3>

<p>The X,Y coordinates refer to the geometric centroids of the new 325 Municipalities in Greece (Programme Kallikratis) in 2011. The boundary data of the original shapefile have been simplified to reduce its detail and size. The polygon referring to Mount Athos has been removed as there is no data available for this politically autonomous area of Greece.
</p>


<h3>Source</h3>

<p>The shapefile of the corresponding polygons is available from the Hellenic Statistical Authority (EL.STAT.) at <a href="https://www.statistics.gr/el/digital-cartographical-data">https://www.statistics.gr/el/digital-cartographical-data</a>. The population, employment, citizenship and employment sector data is available from the Hellenic Statistical Authority (EL.STAT.) at <a href="https://www.statistics.gr/en/home">https://www.statistics.gr/en/home</a> but were aggregated to the new municipalities by the author. The income data are available from the General Secretariat of Information Systems in Greece at the postcode level of geography and were aggregated to the new municipalities by the author.
</p>


<h3>References</h3>

<p>Kalogirou, S., and Hatzichristos, T. (2007). A spatial modelling framework for income estimation. Spatial Economic Analysis, 2(3), 297-316. <a href="https://www.tandfonline.com/doi/full/10.1080/17421770701576921">https://www.tandfonline.com/doi/full/10.1080/17421770701576921</a>
</p>
<p>Kalogirou, S. (2010). Spatial inequalities in income and post-graduate educational attainment in Greece. Journal of Maps, 6(1), 393-400.<a href="https://www.tandfonline.com/doi/abs/10.4113/jom.2010.1095">https://www.tandfonline.com/doi/abs/10.4113/jom.2010.1095</a>
</p>
<p>Kalogirou, S. (2013) Testing geographically weighted multicollinearity diagnostics, GISRUK 2013, Department of Geography and Planning, School of Environmental Sciences, University of Liverpool, Liverpool, UK, 3-5 April 2013.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
boxplot(GR.Municipalities@data$Income01)
hist(GR.Municipalities@data$PrSect01)
</code></pre>

<hr>
<h2 id='gw_variable'>Spatial Interaction Models: gw / regional variable</h2><span id='topic+gw_variable'></span>

<h3>Description</h3>

<p>Regional variables are meant to capture the possible pull effects on internal out-migration caused by conditions elsewhere in the country (Fotheringham et al., 2002; 2004). For example (see code below), the regional variable of the total population is calculated as an index that compares the total population in a zone with the total population of the surrounding zones weighted by a second power of distance. It is used to capture a pull effect produced when an origin is surrounded by very populous zones that draw migrants from the origin (Kalogirou, 2013). Nearby locations are weighted more heavily in the calculation than more distant ones, adopting the idea of the Tobler's first law of Geography. Thus, this variable could be referred to as gw (geographically weighted) variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw_variable(Coords, InputVariable)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw_variable_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or dataframe of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="gw_variable_+3A_inputvariable">InputVariable</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Regional</code></td>
<td>
<p>a single column numeric matrix of the regional variable</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This code has been tested with Cartesian coordinates for the distances to be measured in meters. In the sample dataset GR.Municipalities the projection used is the EPSG:2100 (GGRS87 / Greek Grid)</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Fotheringham, A.S., Barmby, T., Brunsdon, C., Champion, T., Charlton, M., Kalogirou, S., Tremayne, A., Rees, P., Eyre, H., Macgill, J., Stillwell, J., Bramley, G., and Hollis, J., 2002, Development of a Migration Model:  Analytical and Practical Enhancements, Office of the Deputy Prime Minister. URL: <a href="https://www.academia.edu/5274441/Development_of_a_Migration_Model_Analytical_and_Practical_Enhancements">https://www.academia.edu/5274441/Development_of_a_Migration_Model_Analytical_and_Practical_Enhancements</a>
</p>
<p>Fotheringham, A.S., Rees, P., Champion, T., Kalogirou, S., and Tremayne, A.R., 2004, The Development of a Migration Model for England and Wales: Overview and Modelling Out-migration, Environment and Planning A, 36, pp. 1633 - 1672. doi:10.1068/a36136
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis And Modelling Of Internal Migration Flows Within England And Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
GrCoords&lt;-cbind(GR.Municipalities@data$X[1:100], GR.Municipalities@data$Y[1:100])
Regional_Population &lt;-gw_variable(GrCoords,GR.Municipalities@data$PopTot01[1:100])
</code></pre>

<hr>
<h2 id='gw.glm'>Generalised Geographically Weighted Regression (GGWR)</h2><span id='topic+gw.glm'></span>

<h3>Description</h3>

<p>This function allows for the calibration of a local model using a Generalised Geographically Weighted Regression (GGWR). At the moment this function has been coded in order to fit a Geographically Weighted Poisson Regression (GWPR) model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.glm(formula, family, dframe, bw, kernel, coords)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.glm_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the glm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+glm">glm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gw.glm_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the local model as in the <code><a href="stats.html#topic+glm">glm</a></code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.glm_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.glm_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.glm.bw</code></p>
</td></tr>
<tr><td><code id="gw.glm_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code class="reqn">(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code class="reqn">H</code>, <code class="reqn">0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.glm_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalised Geographically Weighted Regression is a method recently proposed building on the simple GWR. It allows for the investigation of the existence of spatial non-stationarity in the relationship between a dependent and a set of independent variables in the cases in which the dependent function does not follow a normal distribution. This is possible by fitting a sub-model for each observation is space, taking into account the neighbour observations weighted by distance. A detailed description of the Geographically Weighted Poisson Regression currently supported here along with examples from internal migration modelling can be found in two publication by Kalogirou (2003, 2015). The difference of this functions to existing ones is that each time the sub-dataset is selected and the sub-model is fitted using R's <code><a href="stats.html#topic+glm">glm</a></code> function instead of fitting the complete local model with matrix algebra. The latter approach may be faster but more prone to rounding error and code crashing.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>GGLM_LEst</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula.</p>
</td></tr>
<tr><td><code>GGLM_LPvalues</code></td>
<td>
<p>a numeric data frame with the local p-value for the local intercepts and the local parameter estimates for each independent variable in the model's formula.</p>
</td></tr>
<tr><td><code>GGLM_GofFit</code></td>
<td>
<p>a numeric data frame with residuals and local goodness of fit statistics (AIC, Deviance)</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets may take long to calibrate.</p>


<h3>Note</h3>

<p>This function is under development. There should be improvements in future versions of the package lctools. Any suggestion is welcome!
</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.glm.bw">gw.glm.bw</a></code>
<code><a href="#topic+gw.zi">gw.zi</a></code>
<code><a href="#topic+gwr">gwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(12,12,3,"poisson")
gwpr &lt;- gw.glm(dep ~ X1 + X2, "poisson", RDF, 50, kernel = 'adaptive', cbind(RDF$X,RDF$Y))
</code></pre>

<hr>
<h2 id='gw.glm.bw'>Optimal bandwidth estimation for Generalised Geographically Weighted Regression (GGWR)</h2><span id='topic+gw.glm.bw'></span>

<h3>Description</h3>

<p>This function helps choosing the optimal bandwidth for the Generalised Geographically Weighted Regression (GGWR). At the moment the latter refers to the Geographically Weighted Poisson Regression (GWPR).</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.glm.bw(formula, family, dframe, coords, kernel, algorithm="exhaustive", 
       optim.method="Nelder-Mead", b.min=NULL, b.max=NULL, step=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.glm.bw_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the glm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+glm">glm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the local model as in the <code><a href="stats.html#topic+glm">glm</a></code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_algorithm">algorithm</code></td>
<td>
<p>a character argument that specifies whether the function will use an <code>exhaustive</code> or a  <code>heuristic</code> algorithm. In the first case all possible bandwidths within a range are being tested. In the second case the  <code><a href="stats.html#topic+optim">optim</a></code> function is being used allowing for the choice of various optimisation methods (such as <code>Brent</code> or <code>BFGS</code>) that may find a global or local optimum. The default algorithm is <code>"exhaustive"</code></p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_optim.method">optim.method</code></td>
<td>
<p>the optimisation method to be used. A detailed discussion is available at the 'Details' section of the function <code><a href="stats.html#topic+optim">optim</a> (stats)</code>. Example methods are <code>"Nelder-Mead"</code>, <code>"Brent"</code>, <code>"BFGS"</code>, <code>"CG"</code> and <code>"L-BFGS-B"</code>. The default method is <code>"Nelder-Mead"</code>.</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_b.min">b.min</code></td>
<td>
<p>the minimum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the lower boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm it provides the initial value for the bandwidth to be optimised which is very important. In the latter case b.min and b.max should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_b.max">b.max</code></td>
<td>
<p>the maximum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the upper boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm b.max and b.min should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gw.glm.bw_+3A_step">step</code></td>
<td>
<p>this numeric argument is used only in the case of a <code>fixed</code> kernel indicating the increment of the sequence of bandwidths in between the <code>b.min</code> and the <code>b.max</code>. In the case of the <code>adaptive</code> kernel the increment is 1 neighbour.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please carefully read the function <code><a href="stats.html#topic+optim">optim</a>(stats)</code> when using a <code>heuristic</code> algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>bw</code></td>
<td>
<p>The optimal bandwidth (fixed or adaptive)</p>
</td></tr>
<tr><td><code>CV</code></td>
<td>
<p>The corresponding Cross Validation score for the optimal bandwidth</p>
</td></tr>
<tr><td><code>CVs</code></td>
<td>
<p>Available only in the case of the <code>exhaustive</code> algorithm. This is a numeric matrix in which the first column refers to the bandwidth in test and the second to the corresponding CV score.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets increase the processing time.</p>


<h3>Note</h3>

<p>Please select the optimisation algorithm carefully. This function needs further testing. Please report any bugs!</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gwr">gwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(12,12,3,"poisson")
gwpr.bw &lt;-gw.glm.bw(dep ~ X1 + X2, "poisson", RDF, cbind(RDF$X,RDF$Y), 
                    kernel = 'adaptive', b.min = 48, b.max=50)
</code></pre>

<hr>
<h2 id='gw.glm.cv'>A specific version of the function gw.glm</h2><span id='topic+gw.glm.cv'></span>

<h3>Description</h3>

<p>A specific version of the function <code><a href="#topic+gw.glm">gw.glm</a></code> returning only the leave-one-out Cross Validation (CV) score. <code><a href="#topic+gw.glm.cv">gw.glm.cv</a></code> exludes the observation for which a sub-model fits.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.glm.cv(bw, formula, family, dframe, obs, kernel, dmatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.glm.cv_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian).</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the glm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+glm">glm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the local model as in the <code><a href="stats.html#topic+glm">glm</a></code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_obs">obs</code></td>
<td>
<p>number of observations in the global dataset</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.glm.cv_+3A_dmatrix">dmatrix</code></td>
<td>
<p>eucledian distance matrix between the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only used by gw.glm.bw</p>


<h3>Value</h3>

<p>Leave-one-out Cross Validation (CV) score</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.glm.bw">gw.glm.bw</a></code>
</p>

<hr>
<h2 id='gw.glm.light'>A light version of the Generalised Geographically Weighted Regression (GGWR)</h2><span id='topic+gw.glm.light'></span>

<h3>Description</h3>

<p>This function allows for the calibration of a local model using the Generalised Geographically Weighted Regression (GGWR) but reports and returns fewer results compared to the function <code><a href="#topic+gw.glm">gw.glm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.glm.light(formula, family, dframe, bw, kernel, coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.glm.light_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the glm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+glm">glm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gw.glm.light_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the local model as in the <code><a href="stats.html#topic+glm">glm</a></code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.glm.light_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.glm.light_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.glm.bw</code></p>
</td></tr>
<tr><td><code id="gw.glm.light_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.glm.light_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details look at the function <code><a href="#topic+gw.glm">gw.glm</a></code>. <code><a href="#topic+gw.glm.light">gw.glm.light</a></code> is only used by the function <code><a href="#topic+gw.glm.mc.test">gw.glm.mc.test</a></code> in order to asses if the local parameter estimates of the Generalised Geographically Weighted Regression (GGWR) exhibit a significant spatial variation.</p>


<h3>Value</h3>

<p>A numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.glm">gw.glm</a></code>, 
<code><a href="#topic+gw.glm.mc.test">gw.glm.mc.test</a></code>
</p>

<hr>
<h2 id='gw.glm.mc.test'>Significance test for the spatial variation of the Generalised Geographically Weighted Regression local parameter estimates</h2><span id='topic+gw.glm.mc.test'></span>

<h3>Description</h3>

<p>This function provides one approach for testing the significance of the spatial variation of the local parameter estimates resulted in by fitting a Generalised Geographically Weighted Regression (GGWR) model. The approach consists of a Monte Carlo simulation according to which: a) the data are spatially reallocated in a random way; b) GGWR models fit for the original and simulated spatial data sets; c) the variance of each variable for the original and simulated sets is then calculated; d) a pseudo p-value for each variable <code>V</code> is calculated as <code>p = (1+C)/(1+M)</code> where <code>C</code> is the number of cases in which the simulated data sets generated variances of the local parameter estimates of the variable <code>V</code> that were as extreme as the observed local parameter estimates variance of the variable in question and <code>M</code> is the number of permutations. If <code>p &lt;= 0.05</code> it can be argued that the spatial variation of the local parameters estimates for a variable <code>V</code> is statistically significant. For this approach, a minimum of 19 simulations is required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.glm.mc.test(Nsim = 19, formula, family, dframe, bw, kernel, coords)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.glm.mc.test_+3A_nsim">Nsim</code></td>
<td>
<p>a positive integer that defines the number of the simulation's iterations</p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the glm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+glm">glm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_family">family</code></td>
<td>
<p>a description of the error distribution and link function to be used in the local model as in the <code><a href="stats.html#topic+glm">glm</a></code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.glm.bw</code></p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.glm.mc.test_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 0.05 level of significance in social sciences, a minimum number of 19 simulations (Nsim &gt;= 19) is required. We recommend at least 99 and at best 999 iterations.</p>


<h3>Value</h3>

<p>Returns a list of the simulated values, the observed the pseudo p-value of significance
</p>
<table role = "presentation">
<tr><td><code>var.lpest.obs</code></td>
<td>
<p>a vector with the variances of the observed local parameter estimates for each variable in the model.</p>
</td></tr>
<tr><td><code>var.SIM</code></td>
<td>
<p>a matrix with the variance of the simulated local parameter estimates for each variable in the model</p>
</td></tr>
<tr><td><code>var.SIM.c</code></td>
<td>
<p>a matrix with the number of cases in which the simulated data set generated variances of the local parameter estimates of a variable <code>V</code> that were as extreme as the observed local parameter estimates variance of the variable in question</p>
</td></tr>
<tr><td><code>pseudo.p</code></td>
<td>
<p>a vector of pseudo p-values for all the parameters in the model (constant and variables).</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets may take way too long to perform this test.</p>


<h3>Note</h3>

<p>This function will be developed along with gw.glm.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.glm.bw">gw.glm.bw</a></code>
<code><a href="#topic+gw.glm">gw.glm</a></code>
<code><a href="#topic+gwr">gwr</a></code>
</p>

<hr>
<h2 id='gw.zi'>Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</h2><span id='topic+gw.zi'></span>

<h3>Description</h3>

<p>This function allows for the calibration of a local model using the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR).</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.zi(formula, family, dframe, bw, kernel, coords, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.zi_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the zeroinfl function of the R package <code>pscl</code>. This is a sting (a symbolic description of the model) that is passed to the sub-models' zeroinfl function. For more details look at the details of the <code>zeroinfl</code> function.</p>
</td></tr>
<tr><td><code id="gw.zi_+3A_family">family</code></td>
<td>
<p>a specification of the count model family to be used in the local model as in the <code>zeroinfl</code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.zi_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.zi_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.zi.bw</code></p>
</td></tr>
<tr><td><code id="gw.zi_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.zi_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
<tr><td><code id="gw.zi_+3A_...">...</code></td>
<td>
<p>more arguments for the <code>zeroinfl</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Geographically Weighted Zero Inflated Poisson Regression (GWZIPR) is a method recently proposed by Kalogirou(2015). It can be used with count data that follow a Poisson distribution and contain many zero values. The GWZIPR allows for the investigation of the existence of spatial non-stationarity in the relationship between a dependent and a set of independent variables while accounting for excess zeros. This is possible by fitting two seperate sub-models for each observation is space, taking into account the neighbour observations weighted by distance. The first submodel (count) models the non-zero values of the dependent variable while the second submodel (zero) models the zero values of the dependent variable. A detailed description of the GWZIPR along with examples from internal migration modelling is presented in the paper mentioned above (Kalogirou, 2015).</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ZI_LEst_count</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula for the count part of the Zero Inflated model.</p>
</td></tr>
<tr><td><code>ZI_LEst_zero</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula for the zero part of the Zero Inflated model.</p>
</td></tr>
<tr><td><code>ZI_LPvalues_count</code></td>
<td>
<p>a numeric data frame with the local p-value for the local intercepts and the local parameter estimates for each independent variable in the model's formula for the count part of the Zero Inflated model.</p>
</td></tr>
<tr><td><code>ZI_LPvalues_zero</code></td>
<td>
<p>a numeric data frame with the local p-value for the local intercepts and the local parameter estimates for each independent variable in the model's formula for the zero part of the Zero Inflated model.</p>
</td></tr>
<tr><td><code>ZI_GofFit</code></td>
<td>
<p>a numeric data frame with residuals and local goodness of fit statistics (AIC)</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets may take long to calibrate.</p>


<h3>Note</h3>

<p>This function is under development. There should be improvements in future versions of the package lctools. Any suggestion is welcome!
</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.zi.bw">gw.zi.bw</a></code>
<code><a href="#topic+gw.glm">gw.glm</a></code>
<code><a href="#topic+gwr">gwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(10,10,3,"zip")
gw.zip &lt;- gw.zi(dep ~ X1 + X2, "poisson", RDF, 60, kernel = 'adaptive', cbind(RDF$X,RDF$Y))
</code></pre>

<hr>
<h2 id='gw.zi.bw'>Optimal bandwidth estimation for Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</h2><span id='topic+gw.zi.bw'></span>

<h3>Description</h3>

<p>This function helps choosing the optimal bandwidth for the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR).</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.zi.bw(formula, family, dframe, coords, kernel, algorithm="exhaustive", 
       optim.method="Nelder-Mead", b.min=NULL, b.max=NULL, step=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.zi.bw_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the zeroinfl function of the R package <code>pscl</code>. This is a sting (a symbolic description of the model) that is passed to the sub-models' <code>zeroinfl</code> function. For more details look at the details of the <code>zeroinfl</code> function.</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_family">family</code></td>
<td>
<p>a specification of the count model family to be used in the local model as in the <code>zeroinfl</code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_algorithm">algorithm</code></td>
<td>
<p>a character argument that specifies whether the function will use an <code>exhaustive</code> or a  <code>heuristic</code> algorithm. In the first case all possible bandwidths within a range are being tested. In the second case the  <code><a href="stats.html#topic+optim">optim</a></code> function is being used allowing for the choice of various optimisation methods (such as <code>Brent</code> or <code>BFGS</code>) that may find a global or local optimum. The default algorithm is <code>"exhaustive"</code></p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_optim.method">optim.method</code></td>
<td>
<p>the optimisation method to be used. A detailed discussion is available at the 'Details' section of the function <code><a href="stats.html#topic+optim">optim</a> (stats)</code>. Example methods are <code>"Nelder-Mead"</code>, <code>"Brent"</code>, <code>"BFGS"</code>, <code>"CG"</code> and <code>"L-BFGS-B"</code>. The default method is <code>"Nelder-Mead"</code>.</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_b.min">b.min</code></td>
<td>
<p>the minimum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the lower boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm it provides the initial value for the bandwidth to be optimised which is very important. In the latter case b.min and b.max should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_b.max">b.max</code></td>
<td>
<p>the maximum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the upper boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm b.max and b.min should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gw.zi.bw_+3A_step">step</code></td>
<td>
<p>this numeric argument is used only in the case of a <code>fixed</code> kernel indicating the increment of the sequence of bandwidths in between the <code>b.min</code> and the <code>b.max</code>. In the case of the <code>adaptive</code> kernel the increment is 1 neighbour.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please carefully read the function <code><a href="stats.html#topic+optim">optim</a>(stats)</code> when using a <code>heuristic</code> algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>bw</code></td>
<td>
<p>The optimal bandwidth (fixed or adaptive)</p>
</td></tr>
<tr><td><code>CV</code></td>
<td>
<p>The corresponding Cross Validation score for the optimal bandwidth</p>
</td></tr>
<tr><td><code>CVs</code></td>
<td>
<p>Available only in the case of the <code>exhaustive</code> algorithm. This is a numeric matrix in which the first column refers to the bandwidth in test and the second to the corresponding CV score.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets increase the processing time.</p>


<h3>Note</h3>

<p>Please select the optimisation algorithm carefully. This function needs further testing. Please report any bugs!</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gwr">gwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(9,9,3,"zip")
gw.zip.bw &lt;- gw.zi.bw(dep ~ X1 + X2, "poisson", RDF, cbind(RDF$X,RDF$Y), 
                      kernel = 'adaptive', b.min = 54, b.max=55)
</code></pre>

<hr>
<h2 id='gw.zi.cv'>A specific version of the function gw.zi</h2><span id='topic+gw.zi.cv'></span>

<h3>Description</h3>

<p>A specific version of the function <code><a href="#topic+gw.zi">gw.zi</a></code> returning only the leave-one-out Cross Validation (CV) score. <code><a href="#topic+gw.zi.cv">gw.zi.cv</a></code> exludes the observation for which a sub-model fits.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.zi.cv(bw, formula, family, dframe, obs, kernel, dmatrix, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.zi.cv_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.zi.bw</code></p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the zeroinfl function of the R package <code>pscl</code>. This is a sting (a symbolic description of the model) that is passed to the sub-models' <code>zeroinfl</code> function. For more details look at the details of the <code>zeroinfl</code> function.</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_family">family</code></td>
<td>
<p>a specification of the count model family to be used in the local model as in the <code>zeroinfl</code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_obs">obs</code></td>
<td>
<p>number of observations in the global dataset</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_dmatrix">dmatrix</code></td>
<td>
<p>eucledian distance matrix between the observations</p>
</td></tr>
<tr><td><code id="gw.zi.cv_+3A_...">...</code></td>
<td>
<p>more arguments for the <code>zeroinfl</code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only used by gw.zi.bw</p>


<h3>Value</h3>

<p>Leave-one-out Cross Validation (CV) score</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.zi.bw">gw.zi.bw</a></code>
</p>

<hr>
<h2 id='gw.zi.light'>A light version of the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR)</h2><span id='topic+gw.zi.light'></span>

<h3>Description</h3>

<p>This function allows for the calibration of a local model using the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR) but reports and returns fewer results compared to the function <code><a href="#topic+gw.zi">gw.zi</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.zi.light(formula, family, dframe, bw, kernel, coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.zi.light_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the zeroinfl function of the R package <code>pscl</code>. This is a sting (a symbolic description of the model) that is passed to the sub-models' <code>zeroinfl</code> function. For more details look at the details of the <code>zeroinfl</code> function.</p>
</td></tr>
<tr><td><code id="gw.zi.light_+3A_family">family</code></td>
<td>
<p>a specification of the count model family to be used in the local model as in the <code>zeroinfl</code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.zi.light_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.zi.light_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.zi.bw</code></p>
</td></tr>
<tr><td><code id="gw.zi.light_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr> 
<tr><td><code id="gw.zi.light_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details look at the function <code><a href="#topic+gw.zi">gw.zi</a></code>. <code><a href="#topic+gw.zi.light">gw.zi.light</a></code> is only used by the function <code><a href="#topic+gw.zi.mc.test">gw.zi.mc.test</a></code> in order to asses if the local parameter estimates of the Geographically Weighted Zero Inflated Poisson Regression (GWZIPR) exhibit a significant spatial variation.</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ZI_LEst_count</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula for the count part of the Zero Inflated model.</p>
</td></tr>
<tr><td><code>ZI_LEst_zero</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula for the zero part of the Zero Inflated model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.zi">gw.zi</a></code>
<code><a href="#topic+gw.zi.mc.test">gw.zi.mc.test</a></code>
</p>

<hr>
<h2 id='gw.zi.mc.test'>Significance test for the spatial variation of the GWZIPR local parameter estimates</h2><span id='topic+gw.zi.mc.test'></span>

<h3>Description</h3>

<p>This function provides one approach for testing the significance of the spatial variation of the local parameter estimates resulted in by fitting a Geographically Weighted Zero Inflated Poisson Regression (GWZIPR) model. The approach consists of a Monte Carlo simulation according to which: a) the data are spatially reallocated in a random way; b) GWZIPR models fit for the original and simulated spatial data sets; c) the variance of each variable for the original and simulated sets is then calculated; d) a pseudo p-value for each variable <code>V</code> is calculated as <code>p = (1+C)/(1+M)</code> where <code>C</code> is the number of cases in which the simulated data sets generated variances of the local parameter estimates of the variable <code>V</code> that were as extreme as the observed local parameter estimates variance of the variable in question and <code>M</code> is the number of permutations. If <code>p &lt;= 0.05</code> it can be argued that the spatial variation of the local parameters estimates for a variable <code>V</code> is statistically significant. For this approach, a minimum of 19 simulations is required.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gw.zi.mc.test(Nsim = 19, formula, family, dframe, bw, kernel, coords)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gw.zi.mc.test_+3A_nsim">Nsim</code></td>
<td>
<p>a positive integer that defines the number of the simulation's iterations</p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the zeroinfl function of the R package <code>pscl</code>. This is a sting (a symbolic description of the model) that is passed to the sub-models' <code>zeroinfl</code> function. For more details look at the details of the <code>zeroinfl</code> function.</p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_family">family</code></td>
<td>
<p>a specification of the count model family to be used in the local model as in the <code>zeroinfl</code> function. Currently the only option tested is &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gw.zi.bw</code></p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gw.zi.mc.test_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 0.05 level of significance in social sciences, a minimum number of 19 simulations (Nsim &gt;= 19) is required. We recommend at least 99 and at best 999 iterations.</p>


<h3>Value</h3>

<p>Returns a list of the simulated values, the observed the pseudo p-value of significance
</p>
<table role = "presentation">
<tr><td><code>var.lpest.obs</code></td>
<td>
<p>a vector with the variances of the observed local parameter estimates for each variable in the model.</p>
</td></tr>
<tr><td><code>var.SIM</code></td>
<td>
<p>a matrix with the variance of the simulated local parameter estimates for each variable in the model</p>
</td></tr>
<tr><td><code>var.SIM.c</code></td>
<td>
<p>a matrix with the number of cases in which the simulated data set generated variances of the local parameter estimates of a variable <code>V</code> that were as extreme as the observed local parameter estimates variance of the variable in question</p>
</td></tr>
<tr><td><code>pseudo.p</code></td>
<td>
<p>a vector of pseudo p-values for all the parameters in the model (constant and variables).</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets may take way too long to perform this test.</p>


<h3>Note</h3>

<p>This function will be developed along with gw.zi.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2016) Destination Choice of Athenians: an application of geographically weighted versions of standard and zero inflated Poisson spatial interaction models, Geographical Analysis, 48(2),pp. 191-230. DOI: 10.1111/gean.12092 <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092">https://onlinelibrary.wiley.com/doi/abs/10.1111/gean.12092</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gw.zi.bw">gw.zi.bw</a></code>
<code><a href="#topic+gw.glm">gw.glm</a></code>
<code><a href="#topic+gwr">gwr</a></code>
</p>

<hr>
<h2 id='gwr'>Geographically Weighted Regression (GWR)</h2><span id='topic+gwr'></span>

<h3>Description</h3>

<p>This function allows for the calibration of a local model using a simple Geographically Weighted Regression (GWR)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gwr(formula, dframe, bw, kernel, coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gwr_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the lm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+lm">lm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gwr_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gwr_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gwr.bw</code></p>
</td></tr>
<tr><td><code id="gwr_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gwr_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Geographically Weighted Regression (GWR) is a method of local regression introduced in the late 1990s. It allows for the investigation of the existence of spatial non-stationarity in the relationship between a dependent and a set of independent variables. This is possible by fitting a sub-model for each observation is space, taking into account the neighbour observations weighted by distance. A detailed description of the GWR method along with examples from the real estate market can be found in the book by Fotheringham et al. (2000). An application of GWR in internal migration modelling has been presented by Kalogirou (2003). The difference of this functions to existing ones is that each time the sub-dataset is selected and the sub-model is fitted using R's <code><a href="stats.html#topic+lm">lm</a></code> function instead of fitting the complete GWR model with matrix algebra. The latter approach may be faster but more prone to rounding error and code crashing.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>LM_LEst</code></td>
<td>
<p>a numeric data frame with the local intercepts and the local parameter estimates for each independent variable in the model's formula.</p>
</td></tr>
<tr><td><code>LM_LPvalues</code></td>
<td>
<p>a numeric data frame with the local p-value for the local intercepts and the local parameter estimates for each independent variable in the model's formula.</p>
</td></tr>
<tr><td><code>LM_GofFit</code></td>
<td>
<p>a numeric data frame with residuals and local goodness of fit statistics (AIC, Deviance)</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets may take long to calibrate.</p>


<h3>Note</h3>

<p>This function is under development. There should be improvements in future versions of the package lctools. Any suggestion is welcome!
</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Fotheringham, A.S., Brunsdon, C., Charlton, M. (2000). Geographically Weighted Regression: the analysis of spatially varying relationships. John Wiley and Sons, Chichester.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gwr.bw">gwr.bw</a></code>
<code><a href="#topic+gw.glm">gw.glm</a></code>
<code><a href="#topic+gw.zi">gw.zi</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
Coords&lt;-cbind(GR.Municipalities@data$X, GR.Municipalities@data$Y)
local.model&lt;-gwr(Income01 ~ UnemrT01, GR.Municipalities@data, 50, kernel = 'adaptive', Coords)
</code></pre>

<hr>
<h2 id='gwr.bw'>Optimal bandwidth estimation for Geographically Weighted Regression (GWR)</h2><span id='topic+gwr.bw'></span>

<h3>Description</h3>

<p>This function helps choosing the optimal bandwidth for the simple Geographically Weighted Regression (GWR).</p>


<h3>Usage</h3>

<pre><code class='language-R'>gwr.bw(formula, dframe, coords, kernel, algorithm="exhaustive", 
       optim.method="Nelder-Mead", b.min=NULL, b.max=NULL, step=NULL)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gwr.bw_+3A_formula">formula</code></td>
<td>
<p>the local model formula using the same syntax used in the <code><a href="stats.html#topic+lm">lm</a></code> function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+lm">lm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_coords">coords</code></td>
<td>
<p>a numeric matrix or data frame of two columns giving the X,Y coordinates of the observations</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_algorithm">algorithm</code></td>
<td>
<p>a character argument that specifies whether the function will use an <code>exhaustive</code> or a  <code>heuristic</code> algorithm. In the first case all possible bandwidths within a range are being tested. In the second case the  <code><a href="stats.html#topic+optim">optim</a></code> function is being used allowing for the choice of various optimisation methods (such as <code>Brent</code> or <code>BFGS</code>) that may find a global or local optimum. The default algorithm is <code>"exhaustive"</code></p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_optim.method">optim.method</code></td>
<td>
<p>the optimisation method to be used. A detailed discussion is available at the 'Details' section of the function <code><a href="stats.html#topic+optim">optim</a> (stats)</code>. Example methods are <code>"Nelder-Mead"</code>, <code>"Brent"</code>, <code>"BFGS"</code>, <code>"CG"</code> and <code>"L-BFGS-B"</code>. The default method is <code>"Nelder-Mead"</code>.</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_b.min">b.min</code></td>
<td>
<p>the minimum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the lower boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm it provides the initial value for the bandwidth to be optimised which is very important. In the latter case b.min and b.max should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_b.max">b.max</code></td>
<td>
<p>the maximum bandwidth. This is important for both algorithms. In the case of the <code>exhaustive</code> algorithm it sets the upper boundary for the range in which the function will compute the CV score for each possible bandwidth. In the case of the <code>heuristic</code> algorithm b.max and b.min should be provided if the optimisation method <code>"L-BFGS-B"</code> or <code>"Brent"</code> has been selected.</p>
</td></tr>
<tr><td><code id="gwr.bw_+3A_step">step</code></td>
<td>
<p>this numeric argument is used only in the case of a <code>fixed</code> kernel indicating the increment of the sequence of bandwidths in between the <code>b.min</code> and the <code>b.max</code>. In the case of the <code>adaptive</code> kernel the increment is 1 neighbour.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Please carefully read the <code><a href="stats.html#topic+optim">optim</a> (stats)</code> when using a <code>heuristic</code> algorithm.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>bw</code></td>
<td>
<p>The optimal bandwidth (fixed or adaptive)</p>
</td></tr>
<tr><td><code>CV</code></td>
<td>
<p>The corresponding Cross Validation score for the optimal bandwidth</p>
</td></tr>
<tr><td><code>CVs</code></td>
<td>
<p>Available only in the case of the <code>exhaustive</code> algorithm. This is a numeric matrix in which the first column refers to the bandwidth in test and the second to the corresponding CV score.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>Large datasets increase the processing time.</p>


<h3>Note</h3>

<p>Please select the optimisation algorithm carefully. To be on safe grounds use the <code>"Brent" optim.method</code> with well defined <code>b.min</code> and <code>b.max</code>. This function needs further testing. Please report any bugs!</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis@lctools.science&gt;</p>


<h3>References</h3>

<p>Fotheringham, A.S., Brunsdon, C., Charlton, M. (2000). Geographically Weighted Regression: the analysis of spatially varying relationships. John Wiley and Sons, Chichester.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gwr">gwr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(9,9,3,"normal")
bw &lt;- gwr.bw(dep ~ X1 + X2, RDF, cbind(RDF$X,RDF$Y), kernel = 'adaptive', 
             b.min = 54, b.max=55)
</code></pre>

<hr>
<h2 id='gwr.cv'>A specific version of the function gwr</h2><span id='topic+gwr.cv'></span>

<h3>Description</h3>

<p>A specific version of the function <code><a href="#topic+gwr">gwr</a></code> returning only the leave-one-out Cross Validation (CV) score. <code><a href="#topic+gwr.cv">gwr.cv</a></code> exludes the observation for which a sub-model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gwr.cv(bw, formula, dframe, obs, kernel, dmatrix)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gwr.cv_+3A_bw">bw</code></td>
<td>
<p>a positive number that may be an integer in the case of an &quot;adaptive kernel&quot; or a real in the case of a &quot;fixed kernel&quot;. In the first case the integer denotes the number of nearest neighbours, whereas in the latter case the real number refers to the bandwidth (in meters if the coordinates provided are Cartesian). This argument can be also the result of a bandwidth selection algorithm such as those available in the function <code>gwr.bw</code></p>
</td></tr>
<tr><td><code id="gwr.cv_+3A_formula">formula</code></td>
<td>
<p>the local model to be fitted using the same syntax used in the lm function in R. This is a sting that is passed to the sub-models' <code><a href="stats.html#topic+lm">lm</a></code> function. For more details look at the class <code><a href="stats.html#topic+formula">formula</a></code>.</p>
</td></tr>
<tr><td><code id="gwr.cv_+3A_dframe">dframe</code></td>
<td>
<p>a numeric data frame of at least two suitable variables (one dependent and one independent)</p>
</td></tr>
<tr><td><code id="gwr.cv_+3A_obs">obs</code></td>
<td>
<p>number of observations in the global dataset</p>
</td></tr>
<tr><td><code id="gwr.cv_+3A_kernel">kernel</code></td>
<td>
<p>the kernel to be used in the regression. Options are &quot;adaptive&quot; or &quot;fixed&quot;. The weighting scheme used here is defined by the bi-square function <code>(weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to <code>H</code>, <code>0</code> otherwise)</p>
</td></tr>
<tr><td><code id="gwr.cv_+3A_dmatrix">dmatrix</code></td>
<td>
<p>eucledian distance matrix between the observations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only used by gwr.bw</p>


<h3>Value</h3>

<p>Leave-one-out Cross Validation (CV) score</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Fotheringham, A.S., Brunsdon, C., Charlton, M. (2000). Geographically Weighted Regression: the analysis of spatially varying relationships. John Wiley and Sons, Chichester.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gwr.bw">gwr.bw</a></code>
<code><a href="#topic+gwr">gwr</a></code>
</p>

<hr>
<h2 id='l.moransI'>Local Moran's I classic statistic for assessing spatial autocorrelation</h2><span id='topic+l.moransI'></span>

<h3>Description</h3>

<p>The local Moran's I proposed by Anselin (1995). The formula to calculate the local <code class="reqn">I_i</code> which is now used in most textbooks and software is: </p>
<p style="text-align: center;"><code class="reqn">I_i = ((x_i - mean(x))/m_2)*(\Sigma w_{ij}*z_j)</code>
</p>
<p>  where <code class="reqn">n</code> is number of observations, <code class="reqn">w_{ij}</code> are the weights, <code class="reqn">z_j = x_j - mean(x)</code>, <code class="reqn">x</code> being the value of the variable at location <code class="reqn">i</code> and <code class="reqn">mean(x)</code> being the mean value of the variable in question, and <code class="reqn">m_2 = (\Sigma (x_i - mean(x))^2) / n</code>. This function calculates the local Moran's I values for each observation along with goodness of fit statistics, it classifies the observations into five classes (High-High, Low-Low, Low-High, High-Low, and Not Significant) and optionally plots a Moran's I Scatter Plot.</p>


<h3>Usage</h3>

<pre><code class='language-R'>l.moransI(Coords, Bandwidth, x, WType='Binary', scatter.plot = TRUE, family = "adaptive")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="l.moransI_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="l.moransI_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>a positive integer that defines the number of nearest neighbours for the calculation of the weights</p>
</td></tr>
<tr><td><code id="l.moransI_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="l.moransI_+3A_wtype">WType</code></td>
<td>
<p>string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;Binary&quot; and &quot;Bi-square&quot;. Default is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: <code class="reqn">weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to H, 0 otherwise.</p>
</td></tr>
<tr><td><code id="l.moransI_+3A_scatter.plot">scatter.plot</code></td>
<td>
<p>a logical value that controls if the Moran's I Scatter Plot will be displayed (TRUE) or not. Default is TRUE.</p>
</td></tr>
<tr><td><code id="l.moransI_+3A_family">family</code></td>
<td>
<p>a string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;adaptive&quot; and &quot;fixed&quot;. The default value is &quot;adaptive&quot;.
</p>
<p>adaptive: the number of nearest neighbours (integer). 
</p>
<p>fixed: a fixed distance around each observation's location (in meters).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interpretation of the local <code class="reqn">I_i</code> is similar to that of the global Moran's I.</p>


<h3>Value</h3>

<p>Returns the calculated local Moran's I and a list of statistics for the latter's inference: the expected Ei, the variance Vi, the Xi scores and the p-values for the randomization null hypotheses. It also returns the standardized value and the standardized lagged value of the variable to allow creating the Moran's I scatter plot and the classified values for creating the cluster map similar to those available in GeoDa (Anselin et al., 2006).
</p>
<table role = "presentation">
<tr><td><code>ID</code></td>
<td>
<p>Numeric index from 1 to n</p>
</td></tr>
<tr><td><code>Ii</code></td>
<td>
<p>Classic lobal Moran's I_i statistic</p>
</td></tr>
<tr><td><code>Ei</code></td>
<td>
<p>The expected local Moran's I_i</p>
</td></tr>
<tr><td><code>Vi</code></td>
<td>
<p>The variance of I_i</p>
</td></tr>
<tr><td><code>Zi</code></td>
<td>
<p>The z score calculated for the randomization null hypotheses test</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The p-value (two-tailed) calculated for the randomization null hypotheses test</p>
</td></tr>
<tr><td><code>Xi</code></td>
<td>
<p>The standardised value of the variable x</p>
</td></tr>
<tr><td><code>wXj</code></td>
<td>
<p>The standardised value of the lagged x (weighted some of nearest neighbours)</p>
</td></tr>
<tr><td><code>Cluster</code></td>
<td>
<p>The class each observation belongs based on the sign of Xi and wXj as well as the non-significant local Moran's I values</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Please note that the weights are row standardised.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Anselin, L.,1995, Local Indicators of Spatial Association-LISA. Geographical Analysis, 27, 93-115. 
</p>
<p>Anselin, L., Syabri, I. and Kho., Y., 2006, GeoDa: An Introduction to Spatial Data Analysis. Geographical Analysis 38(1), 5-22.
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
l.moran&lt;-l.moransI(cbind(GR.Municipalities$X, GR.Municipalities$Y),6,GR.Municipalities$Income01)
</code></pre>

<hr>
<h2 id='lat2w'>Contiguity-based weights matrix for a regular grid</h2><span id='topic+lat2w'></span>

<h3>Description</h3>

<p>This function creates a contiguity-based (Rook or Queen) weights matrix for a regular grid with equal number of rows and columns</p>


<h3>Usage</h3>

<pre><code class='language-R'>lat2w(nrows=5, ncols=5, rook=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lat2w_+3A_nrows">nrows</code></td>
<td>
<p>number of rows</p>
</td></tr>
<tr><td><code id="lat2w_+3A_ncols">ncols</code></td>
<td>
<p>number of columns (identical to the number of rows)</p>
</td></tr>
<tr><td><code id="lat2w_+3A_rook">rook</code></td>
<td>
<p>a TRUE/FALSE option. TRUE refers to a rook contiguity and FALSE to queen contiguity</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function may also serve in simulations.
</p>


<h3>Value</h3>

<p>Returns a list of neighbours for each cell of the grid as well as a weights matrix.
</p>
<table role = "presentation">
<tr><td><code>nbs</code></td>
<td>
<p>a list of neighbours for each observation</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>a matrix of weights</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com</p>


<h3>References</h3>

<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+w.matrix">w.matrix</a></code>, <code><a href="#topic+moransI.w">moransI.w</a></code>, <code><a href="#topic+spGini.w">spGini.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#rook weights matrix for a 5 by 5 grid
w.mat &lt;- lat2w(nrows=5, ncols=5)
</code></pre>

<hr>
<h2 id='lcorrel'>Local Pearson and GW Pearson Correlation</h2><span id='topic+lcorrel'></span>

<h3>Description</h3>

<p>This function computes Local Pearson and Geographically Weighted Pearson Correlation Coefficients and tests for their statistical significance. Because the local significant tests are not independent, under the multiple hypotheses testing theory, a Bonferroni correction of the local coefficients takes place. The function results in tables with results for all possible pairs of the input variables.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lcorrel(DFrame, bw, Coords)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lcorrel_+3A_dframe">DFrame</code></td>
<td>
<p>A numeric Data Frame of at least two variables</p>
</td></tr>
<tr><td><code id="lcorrel_+3A_bw">bw</code></td>
<td>
<p>A positive value between 0 and 1 to define the proportion of the total observations for the local sample for which each time the local coefficients are calculated for. This can be also the result of bandwidth selection algorithms of local regression techniques such as the Geographically Weighted Regression (GWR)</p>
</td></tr>
<tr><td><code id="lcorrel_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the observations (data points or geometric centroids)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The degrees of freedom for the local t-student test is Round(bw * Number of Observations) - 2.
</p>


<h3>Value</h3>

<p>lcorrel returns a list of 7 Data Frames
</p>
<table role = "presentation">
<tr><td><code>LPCC</code></td>
<td>
<p>A numeric data frame with the Local Pearson Correlation Coefficients (LPCCs) for each possible pair of the input variables in DFrame</p>
</td></tr>
<tr><td><code>LPCC_t</code></td>
<td>
<p>A numeric data frame with the t-student test statistics for all LPCCs</p>
</td></tr>
<tr><td><code>LPCC_sig</code></td>
<td>
<p>A numeric data frame with level of significance (p-value) for all LPCCs</p>
</td></tr>
<tr><td><code>LPCC_sig_BF</code></td>
<td>
<p>A numeric data frame with level of significance (p-value) for all LPCCs adjusted using the conservative Bonferroni correction to account for false positives under the multiple hypothesis testing theory</p>
</td></tr>
<tr><td><code>GWPCC</code></td>
<td>
<p>A numeric data frame with the Geographically Weighted Pearson Correlation Coefficients (GWPCCs) for each possible pair of the input variables in DFrame</p>
</td></tr>
<tr><td><code>GWPCC_sig</code></td>
<td>
<p>A numeric data frame with level of significance (p-value) for all GWPCCs</p>
</td></tr>
<tr><td><code>GWPCC_sig_BF</code></td>
<td>
<p>A numeric data frame with level of significance (p-value) for all GWPCCs adjusted using the conservative Bonferroni correction to account for false positives under the multiple hypothesis testing theory</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2012) Testing local versions of correlation coefficients, Review of Regional Research - Jahrbuch fur Regionalwissenschaft, 32(1), pp. 45-61, doi: 10.1007/s10037-011-0061-y. <a href="https://link.springer.com/article/10.1007/s10037-011-0061-y">https://link.springer.com/article/10.1007/s10037-011-0061-y</a>
</p>
<p>Kalogirou, S. (2013) Testing geographically weighted multicollinearity diagnostics, GISRUK 2013, Department of Geography and Planning, School of Environmental Sciences, University of Liverpool, Liverpool, UK, 3-5 April 2013. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2015) A spatially varying relationship between the proportion of foreign citizens and income at local authorities in Greece, 10th International Congress of the Hellenic Geographical Society,  Aristotle University of Thessaloniki, Thessaloniki 22-24 October 2014. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(VotesGR)
local.cor&lt;-lcorrel(VotesGR[5:6],0.1,cbind(VotesGR$X, VotesGR$Y))
plot(local.cor$LPCC[,2],local.cor$GWPCC[,2])
</code></pre>

<hr>
<h2 id='mc.lcorrel'>Monte Carlo simulation for the significance of the local correlation coefficients</h2><span id='topic+mc.lcorrel'></span>

<h3>Description</h3>

<p>In order to assess if the spatial variation of the local correlation coefficients is statistically significant this function computes original and simulated statistics. LPCCs and GWPCCs can be calculated for a fixed bandwidth for the original locations of the observations as well as for a user-defined number of geographical reallocations of the observations. The latter is a simple Monte Carlo simulation proposed by Hope (1968) and adopted by Fotheringham et al. (2002) who assess if local parameter estimates in a Geographically Weighted Regression model exhibit spatial non-stationarity. 
First, the variances of LPCCs and GWPCCs, respectively, are computed for observed and simulated local correlation coefficients. Then, a pseudo p-value is calculated as p=(1+C)/(1+M) where C is the number of cases in which the variance of the simulated LPCCs and GWPCCs is equal to or higher than the variance of the observed LPCCs and GWPCCs, respectively of each test, and M is the number of permutations. If p&lt;=0.05 it can be argued that the spatial variation of the local correlation coefficients is statistically significant. For this approach, a minimum of 19 permutations is required.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mc.lcorrel(Nsim=99,bwSIM,CorVars,Coord.X,Coord.Y) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mc.lcorrel_+3A_nsim">Nsim</code></td>
<td>
<p>a positive integer that defines the number of the simulation's iterations</p>
</td></tr>
<tr><td><code id="mc.lcorrel_+3A_bwsim">bwSIM</code></td>
<td>
<p>A positive value between 0 and 1 to define the proportion of the total observations for the local sample for which each time the local correlation coefficients will be calculated for.</p>
</td></tr>
<tr><td><code id="mc.lcorrel_+3A_corvars">CorVars</code></td>
<td>
<p>A data frame of two variables for which observed and simulated local correlation coefficients (LPCCs and GWPCCs) will be calculated for.</p>
</td></tr>
<tr><td><code id="mc.lcorrel_+3A_coord.x">Coord.X</code></td>
<td>
<p>a numeric vector giving the X coordinates of the observations (data points or geometric centroids)</p>
</td></tr>
<tr><td><code id="mc.lcorrel_+3A_coord.y">Coord.Y</code></td>
<td>
<p>a numeric vector giving the Y coordinates of the observations (data points or geometric centroids)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 0.05 level of significance in social sciences, a minimum number of 19 simulations (Nsim&gt;=19) is required. We recommend at least 99 and at best 999 iterations</p>


<h3>Value</h3>

<p>Returns a list of summary statistics for the simulated values of LPCCs and GWPCCs, the observed LPCCs and GWPCCs and the pseudo p-value of significance for the spatial variation of the LPCCs and GWPCCs, respectivelly
</p>
<table role = "presentation">
<tr><td><code>SIM</code></td>
<td>
<p>a dataframe with simulated values: SIM.ID is the simulation ID, SIM.gwGini is the simulated Gini of neighbours, SIM.nsGini is the simulated Gini of non-neighbours, SIM.SG is the simulated share of the overall Gini that is associated with non-neighbour pairs of locations, SIM.Extr = 1 if the simulated SG is greater than or equal to the observed SG</p>
</td></tr>
<tr><td><code>LC.Obs</code></td>
<td>
<p>list of 7 Data Frames as in lcorrel</p>
</td></tr>
<tr><td><code>pseudo.p.lpcc</code></td>
<td>
<p>pseudo p-value for the significance of the spatial variation of the LPCCs: if this is lower than or equal to 0.05 it can be argued that the the spatial variation of the LPCCs is statistically significant.</p>
</td></tr>
<tr><td><code>pseudo.p.gwpcc</code></td>
<td>
<p>pseudo p-value for the significance of the spatial variation of the GWPCCs: if this is lower than or equal to 0.05 it can be argued that the the spatial variation of the GWPCCs is statistically significant.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Hope, A.C.A. (1968) A Simplified Monte Carlo Significance Test Procedure, Journal of the Royal Statistical Society. Series B (Methodological), 30 (3), pp. 582 - 598.
</p>
<p>Fotheringham, A.S, Brunsdon, C., Charlton, M. (2002) Geographically Weighted Regression: the analysis of spatially varying relationships, Chichester: John Wiley and Sons.</p>


<h3>Examples</h3>

<pre><code class='language-R'>X&lt;-rep(11:14, 4)
Y&lt;-rev(rep(1:4, each=4))
var1&lt;-c(1,1,1,1,1,1,2,2,2,2,3,3,3,4,4,5)
var2&lt;-rev(var1)
Nsim= 19
bwSIM&lt;-0.5

SIM20&lt;-mc.lcorrel(Nsim,bwSIM, cbind(var1,var2),X,Y)

SIM20$pseudo.p.lpcc
SIM20$pseudo.p.gwpcc
</code></pre>

<hr>
<h2 id='mc.spGini'>Monte Carlo simulation for the significance of the Spatial Gini coefficient</h2><span id='topic+mc.spGini'></span>

<h3>Description</h3>

<p>This function provides one approach for inference on the spatial Gini inequality measure. This is a small Monte Carlo simulation according to which: a) the data are spatially reallocated in a random way; b) the share of overall inequality that is associated with non-neighbour pairs of locations - SG (Eq. 5 in Rey &amp; Smith, 2013) - is calculated for the original and simulated spatial data sets; c) a pseudo p-value is calculated as p=(1+C)/(1+M) where C is the number of the permutation data sets that generated SG values that were as extreme as the observed SG value for the original data (Eq. 6 in Rey &amp; Smith, 2013). If p&lt;=0.05 it can be argued that the component of the Gini for non-neighbour inequality is statistically significant. For this approach, a minimum of 19 simulations is required.</p>


<h3>Usage</h3>

<pre><code class='language-R'>mc.spGini(Nsim=99,Bandwidth,x,Coord.X,Coord.Y,WType='Binary')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mc.spGini_+3A_nsim">Nsim</code></td>
<td>
<p>a positive integer that defines the number of the simulation's iterations</p>
</td></tr>
<tr><td><code id="mc.spGini_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>a positive integer that defines the number of nearest neighbours for the calculation of the weights</p>
</td></tr>
<tr><td><code id="mc.spGini_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="mc.spGini_+3A_coord.x">Coord.X</code></td>
<td>
<p>a numeric vector giving the X coordinates of the observations (data points or geometric centroids)</p>
</td></tr>
<tr><td><code id="mc.spGini_+3A_coord.y">Coord.Y</code></td>
<td>
<p>a numeric vector giving the Y coordinates of the observations (data points or geometric centroids)</p>
</td></tr>
<tr><td><code id="mc.spGini_+3A_wtype">WType</code></td>
<td>
<p>string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;Binary&quot;, &quot;Bi-square&quot;, &quot;RSBi-square&quot;. Default is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: weight = (1-(ndist/H)^2)^2 for distances less than or equal to H, 0 otherwise;
</p>
<p>RSBi-square: weight = Bi-square weights / sum (Bi-square weights) for each row in the weights matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For 0.05 level of significance in social sciences, a minimum number of 19 simulations (Nsim&gt;=19) is required. We recommend at least 99 and at best 999 iterations</p>


<h3>Value</h3>

<p>Returns a list of the simulated values, the observed Gini and its spatial decomposition, the pseudo p-value of significance
</p>
<table role = "presentation">
<tr><td><code>SIM</code></td>
<td>
<p>a dataframe with simulated values: SIM.ID is the simulation ID, SIM.gwGini is the simulated Gini of neighbours, SIM.nsGini is the simulated Gini of non-neighbours, SIM.SG is the simulated share of the overall Gini that is associated with non-neighbour pairs of locations, SIM.Extr = 1 if the simulated SG is greater than or equal to the observed SG</p>
</td></tr>
<tr><td><code>spGini.Observed</code></td>
<td>
<p>Observed Gini (Gini) and its spatial components (gwGini, nsGini)</p>
</td></tr>
<tr><td><code>pseudo.p</code></td>
<td>
<p>pseudo p-value: if this is lower than or equal to 0.05 it can be argued that the component of the Gini for non-neighbour inequality is statistically significant.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Acknowledgement: I would like to thank LI Zai-jun, PhD student at Nanjing Normal University, China for encouraging me to develop this function and for testing this package.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Rey, S.J., Smith, R. J. (2013) A spatial decomposition of the Gini coefficient, Letters in Spatial and Resource Sciences, 6 (2), pp. 55-70.
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
Nsim=19
Bd1&lt;-4
x1&lt;-GR.Municipalities@data$Income01[1:45]
WType1&lt;-'Binary'

SIM20&lt;-mc.spGini(Nsim,Bd1,x1,GR.Municipalities@data$X[1:45], GR.Municipalities@data$Y[1:45],WType1)
SIM20

hist(SIM20$SIM$SIM.nsGini,col = "lightblue", main = "Observed and simulated nsGini",
xlab = "Simulated nsGini", ylab = "Frequency",xlim = c(min(SIM20$SIM$SIM.nsGini),
SIM20$spGini.Observed[[3]]))
abline(v=SIM20$spGini.Observed[[3]], col = 'red')
</code></pre>

<hr>
<h2 id='moransI'>Moran's I classic statistic for assessing spatial autocorrelation</h2><span id='topic+moransI'></span>

<h3>Description</h3>

<p>Moran's I is one of the oldest statistics used to examine spatial autocorrelation. This global statistic was first proposed by Moran (1948, 1950). Later, Cliff and Ord (1973, 1981) present a comprehensive work on spatial autocorrelation and suggested a formula to calculate the I which is now used in most textbooks and software: </p>
<p style="text-align: center;"><code class="reqn">I = (n/W)*(\Sigma \Sigma w_{ij}*z_i*z_j/ \Sigma z_i^2)</code>
</p>
<p> where <code class="reqn">n</code> is number of observations, <code class="reqn">W</code> is the sum of the weights w_ij for all pairs in the system, <code class="reqn">z_i=x_i - mean(x)</code> where <code class="reqn">x</code> is the value of the variable at location <code class="reqn">i</code> and <code class="reqn">mean(x)</code> the mean value of the variable in question (Eq. 5.2 Kalogirou, 2003).The implementation here allows only nearest neighbour weighting schemes. Resampling and randomization null hypotheses have been tested following the discussion of Goodchild (1986, pp. 24-26).</p>


<h3>Usage</h3>

<pre><code class='language-R'>moransI(Coords, Bandwidth, x, WType = 'Binary')</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moransI_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="moransI_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>a positive integer that defines the number of nearest neighbours for the calculation of the weights</p>
</td></tr>
<tr><td><code id="moransI_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="moransI_+3A_wtype">WType</code></td>
<td>
<p>a string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;Binary&quot; and &quot;Bi-square&quot;. Default is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: <code class="reqn">weight = (1-(ndist/H)^2)^2</code> for distances less than or equal to H, 0 otherwise.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Moran's I statistic ranges from -1 to 1. Values in the interval (-1, 0) indicate negative spatial autocorrelation (low values tend to have neighbours with high values and vice versa), values near 0 indicate no spatial autocorrelation (no spatial pattern - random spatial distribution) and values in the interval (0,1) indicate positive spatial autocorrelation (spatial clusters of similarly low or high values between neighbour municipalities should be expected.)
</p>


<h3>Value</h3>

<p>Returns the weights matrix, the calculated Moran's I and a list of statistics for the latter's inference: the expected I (E[I]), z scores and p values for both resampling and randomization null hypotheses.
</p>
<table role = "presentation">
<tr><td><code>W</code></td>
<td>
<p>Weights Matrix</p>
</td></tr>
<tr><td><code>Morans.I</code></td>
<td>
<p>Classic global Moran's I statistic</p>
</td></tr>
<tr><td><code>Expected.I</code></td>
<td>
<p>The Expected Moran's I <code class="reqn">(E[I]=-1/(n-1))</code></p>
</td></tr>
<tr><td><code>z.resampling</code></td>
<td>
<p>The z score calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>z.randomization</code></td>
<td>
<p>The z score calculated for the randomization null hypotheses test</p>
</td></tr>
<tr><td><code>p.value.resampling</code></td>
<td>
<p>The p-value (two-tailed) calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>p.value.randomization</code></td>
<td>
<p>The p-value (two-tailed) calculated for the randomization null hypotheses test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function has been compared to the function Moran.I within the file MoranI.R of package ape version 3.1-4 (Paradis et al., 2014). This function results in the same Moran's I statistic as the one in package ape. The statistical inference in the latter refers to the randomization null hypotheses test discussed above. It is necessary to acknowledge that the code of this function has been assisted by the one in ape package: this is the calculation of statistics S1 and S2 (lines 67 and 69 of the source code) in this function. Another R package with functions for calculating and testing the Moran's I statistic and its significance is the spdep package (Bivand et al. 2014). The Moran's I statistic calculated using this function is not the same as the one in OpenGeoDa (Anselin et al., 2006). The latter is another very popular software for calculating spatial autocorrelation statistics.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Anselin, L., I. Syabri and Y Kho., 2006, GeoDa: An Introduction to Spatial Data Analysis. Geographical Analysis 38(1), 5-22.
</p>
<p>Bivand et al., 2014, spdep: Spatial dependence: weighting schemes, statistics and models, http://cran.r-project.org/web/packages/spdep/index.html
</p>
<p>Cliff, A.D., and Ord, J.K., 1973, Spatial autocorrelation (London: Pion).
</p>
<p>Cliff, A.D., and Ord, J.K., 1981, Spatial processes: models and applications (London: Pion).
</p>
<p>Goodchild, M. F., 1986, Spatial Autocorrelation. Catmog 47, Geo Books.
</p>
<p>Moran, P.A.P., 1948, The interpretation of statistical maps, Journal of the Royal Statistics Society, Series B (Methodological), 10, 2, pp. 243 - 251.
</p>
<p>Moran, P.A.P., 1950, Notes on continuous stochastic phenomena, Biometrika, 37, pp. 17 - 23.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>
<p>Paradis et al., 2014, ape: Analyses of Phylogenetics and Evolution, <a href="https://CRAN.R-project.org/package=ape">https://CRAN.R-project.org/package=ape</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
attr&lt;-GR.Municipalities@data
m.I&lt;-moransI(cbind(attr$X, attr$Y),6,attr$UnemrT01)

t(as.matrix(m.I[2:7]))

</code></pre>

<hr>
<h2 id='moransI.v'>Computes a vector of Moran's I statistics.</h2><span id='topic+moransI.v'></span>

<h3>Description</h3>

<p>Moran's I is one of the oldest statistics used to examine spatial autocorrelation. This global statistic was first proposed by Moran (1948, 1950). Later, Cliff and Ord (1973, 1981) present a comprehensive work on spatial autocorrelation and suggested a formula to calculate the I which is now used in most textbooks and software: </p>
<p style="text-align: center;"><code class="reqn">I = (n/W)*(\Sigma \Sigma w_{ij}*z_i*z_j/ \Sigma z_i^2)</code>
</p>
<p> where n is number of observations, W is the sum of the weights w_ij for all pairs in the system, <code class="reqn">z_i=x_i - mean(x)</code> where x is the value of the variable at location i and mean(x) the mean value of the variable in question (Eq. 5.2 Kalogirou, 2003).
</p>
<p>This function allows the computation of an number of Moran's I statistics of the same family (fixed or adaptive) with different kernel size. To achieve this it first computes the weights matrix using the w.matrix function and then computes the Moran's I using the moransI.w function for each kernel. The function returns a table with the results and a simple scatter plot with the Moran's I and the kernel size. The latter can be disabled by the user.</p>


<h3>Usage</h3>

<pre><code class='language-R'>moransI.v(Coords, Bandwidths, x, WType='Binary', family='adaptive', plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moransI.v_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="moransI.v_+3A_bandwidths">Bandwidths</code></td>
<td>
<p>a vector of positive integers that defines the number of nearest neighbours for the calculation of the weights or a vector of Bandwidths relevant to the coordinate systems the spatial analysis refers to.</p>
</td></tr>
<tr><td><code id="moransI.v_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="moransI.v_+3A_wtype">WType</code></td>
<td>
<p>a string giving the weighting function used to compute the weights matrix. 
Options are: &quot;Binary&quot;, &quot;Bi-square&quot;, and &quot;RSBi-square&quot;. The default value is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: weight = (1-(ndist/H)^2)^2 for distances less than or equal to H, 0 otherwise;
</p>
<p>RSBi-square: weight = Bi-square weights / sum (Bi-square weights) for each row in the weights matrix
</p>
</td></tr>
<tr><td><code id="moransI.v_+3A_family">family</code></td>
<td>
<p>a string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;adaptive&quot; and &quot;fixed&quot;. The default value is &quot;adaptive&quot;.
</p>
<p>adaptive: the number of nearest neighbours (integer). 
</p>
<p>fixed: a fixed distance around each observation's location (in meters).
</p>
</td></tr>
<tr><td><code id="moransI.v_+3A_plot">plot</code></td>
<td>
<p>a logical value (TRUE/FALSE) denoting whether a scatter plot with the Moran's I and the kernel size will be created (if TRUE) or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Moran's I statistic ranges from -1 to 1. Values in the interval (-1, 0) indicate negative spatial autocorrelation (low values tend to have neighbours with high values and vice versa), values near 0 indicate no spatial autocorrelation (no spatial pattern - random spatial distribution) and values in the interval (0,1) indicate positive spatial autocorrelation (spatial clusters of similarly low or high values between neighbour municipalities should be expected.)
</p>


<h3>Value</h3>

<p>Returns a matrix with 8 columns and plots a scatter plot. These columns present the following statistics for each kernel size:
</p>
<table role = "presentation">
<tr><td><code>ID</code></td>
<td>
<p>an integer in the sequence 1:m, where m is the number of kernel sizes in the vector Bandwidths</p>
</td></tr>
<tr><td><code>k</code></td>
<td>
<p>the kernel size (number of neighbours or distance)</p>
</td></tr>
<tr><td><code>Moran's I</code></td>
<td>
<p>Classic global Moran's I statistic</p>
</td></tr>
<tr><td><code>Expected I</code></td>
<td>
<p>The Expected Moran's I (E[I]=-1/(n-1))</p>
</td></tr>
<tr><td><code>Z resampling</code></td>
<td>
<p>The z score calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>P-value resampling</code></td>
<td>
<p>The p-value (two-tailed) calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>Z randomization</code></td>
<td>
<p>The z score calculated for the randomization null hypotheses test</p>
</td></tr>
<tr><td><code>P-value randomization</code></td>
<td>
<p>The p-value (two-tailed) calculated for the randomization null hypotheses test</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Cliff, A.D., and Ord, J.K., 1973, Spatial autocorrelation (London: Pion).
</p>
<p>Cliff, A.D., and Ord, J.K., 1981, Spatial processes: models and applications (London: Pion).
</p>
<p>Goodchild, M. F., 1986, Spatial Autocorrelation. Catmog 47, Geo Books.
</p>
<p>Moran, P.A.P., 1948, The interpretation of statistical maps, Journal of the Royal Statistics Society, Series B (Methodological), 10, 2, pp. 243 - 251.
</p>
<p>Moran, P.A.P., 1950, Notes on continuous stochastic phenomena, Biometrika, 37, pp. 17 - 23.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moransI.w">moransI.w</a></code>, <code><a href="#topic+w.matrix">w.matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
Coords&lt;-cbind(GR.Municipalities@data$X, GR.Municipalities@data$Y)

#using an adaptive kernel
bws &lt;- c(3, 4, 6, 9, 12, 18, 24)
moransI.v(Coords, bws, GR.Municipalities@data$Income01)
</code></pre>

<hr>
<h2 id='moransI.w'>Moran's I classic statistic for assessing spatial autocorrelation using a ready made weights matrix.</h2><span id='topic+moransI.w'></span>

<h3>Description</h3>

<p>Moran's I is one of the oldest statistics used to examine spatial autocorrelation. This global statistic was first proposed by Moran (1948, 1950). Later, Cliff and Ord (1973, 1981) present a comprehensive work on spatial autocorrelation and suggested a formula to calculate the I which is now used in most textbooks and software: </p>
<p style="text-align: center;"><code class="reqn">I = (n/W)*(\Sigma \Sigma w_{ij}*z_i*z_j/ \Sigma z_i^2)</code>
</p>
<p> where n is number of observations, W is the sum of the weights w_ij for all pairs in the system, <code class="reqn">z_i=x_i - mean(x)</code> where x is the value of the variable at location i and mean(x) the mean value of the variable in question (Eq. 5.2 Kalogirou, 2003).
</p>
<p>The implementation here allows for the use of a weights matrix that could use any weighting scheme created either within lctools (using the w.matrix function) or other R packages. Resampling and randomization null hypotheses have been tested following the discussion of Goodchild (1986, pp. 24-26).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moransI.w(x, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="moransI.w_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="moransI.w_+3A_w">w</code></td>
<td>
<p>Weights Matrix usin w.matrix or other R function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Moran's I statistic ranges from -1 to 1. Values in the interval (-1, 0) indicate negative spatial autocorrelation (low values tend to have neighbours with high values and vice versa), values near 0 indicate no spatial autocorrelation (no spatial pattern - random spatial distribution) and values in the interval (0,1) indicate positive spatial autocorrelation (spatial clusters of similarly low or high values between neighbour municipalities should be expected.)
</p>


<h3>Value</h3>

<p>Returns the calculated Moran's I and a list of statistics for the latter's inference: the expected I (E[I]), z scores and p values for both resampling and randomization null hypotheses.
</p>
<table role = "presentation">
<tr><td><code>Morans.I</code></td>
<td>
<p>Classic global Moran's I statistic</p>
</td></tr>
<tr><td><code>Expected.I</code></td>
<td>
<p>The Expected Moran's I (E[I]=-1/(n-1))</p>
</td></tr>
<tr><td><code>z.resampling</code></td>
<td>
<p>The z score calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>z.randomization</code></td>
<td>
<p>The z score calculated for the randomization null hypotheses test</p>
</td></tr>
<tr><td><code>p.value.resampling</code></td>
<td>
<p>The p-value (two-tailed) calculated for the resampling null hypotheses test</p>
</td></tr>
<tr><td><code>p.value.randomization</code></td>
<td>
<p>The p-value (two-tailed) calculated for the randomization null hypotheses test</p>
</td></tr>
</table>


<h3>Note</h3>

<p>I would like to acknowledge the use of some lines of code from the file MoranI.R of the package ape and I would like to thank Paradis et al. (2016) and all authors involved in the Moran's I function for this.</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Anselin, L., I. Syabri and Y Kho., 2006, GeoDa: An Introduction to Spatial Data Analysis. Geographical Analysis 38(1), 5-22.
</p>
<p>Bivand et al., 2014, spdep: Spatial dependence: weighting schemes, statistics and models, http://cran.r-project.org/web/packages/spdep/index.html
</p>
<p>Cliff, A.D., and Ord, J.K., 1973, Spatial autocorrelation (London: Pion).
</p>
<p>Cliff, A.D., and Ord, J.K., 1981, Spatial processes: models and applications (London: Pion).
</p>
<p>Goodchild, M. F., 1986, Spatial Autocorrelation. Catmog 47, Geo Books.
</p>
<p>Moran, P.A.P., 1948, The interpretation of statistical maps, Journal of the Royal Statistics Society, Series B (Methodological), 10, 2, pp. 243 - 251.
</p>
<p>Moran, P.A.P., 1950, Notes on continuous stochastic phenomena, Biometrika, 37, pp. 17 - 23.
</p>
<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>
<p>Paradis et al., 2016, ape: Analyses of Phylogenetics and Evolution, <a href="https://CRAN.R-project.org/package=ape">https://CRAN.R-project.org/package=ape</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moransI">moransI</a></code>, <code><a href="#topic+w.matrix">w.matrix</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
attr &lt;- GR.Municipalities@data

#using an adaptive kernel
w.ad &lt;- w.matrix(cbind(attr$X, attr$Y),6)
mI.ad &lt;- moransI.w(attr$UnemrT01,w.ad)
as.data.frame(mI.ad)


#using a fixed kernel
w.fixed&lt;-w.matrix(cbind(attr$X, attr$Y), 50000, WType='Binary', family='fixed')
mI.fixed&lt;-moransI.w(attr$UnemrT01,w.fixed)
as.data.frame(mI.fixed)
</code></pre>

<hr>
<h2 id='random.test.data'>Radmom data generator</h2><span id='topic+random.test.data'></span>

<h3>Description</h3>

<p>Generates datasets with random data for modelling including a dependent variable, independent variables and X,Y coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>random.test.data(nrows = 10, ncols = 10, vars.no = 3, dep.var.dis = "normal", 
                xycoords = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="random.test.data_+3A_nrows">nrows</code></td>
<td>
<p>an integer referring to the number of rows for a regular grid</p>
</td></tr>
<tr><td><code id="random.test.data_+3A_ncols">ncols</code></td>
<td>
<p>an integer referring to the number of columns for a regular grid</p>
</td></tr>
<tr><td><code id="random.test.data_+3A_vars.no">vars.no</code></td>
<td>
<p>an integer referring to the number of independent variables</p>
</td></tr>
<tr><td><code id="random.test.data_+3A_dep.var.dis">dep.var.dis</code></td>
<td>
<p>a character referring to the distribution of the dependent variable. Options are &quot;normal&quot; (default), &quot;poisson&quot;, and &quot;zip&quot;</p>
</td></tr>
<tr><td><code id="random.test.data_+3A_xycoords">xycoords</code></td>
<td>
<p>a logical value indicating whether X,Y coordinates will be created (default) or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The creation of a random dataset was necessary here to provide examples to some functions. However, random datasets may be used in simulation studies.</p>


<h3>Value</h3>

<p>a dataframe</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>RDF &lt;- random.test.data(12,12,3,"poisson")
</code></pre>

<hr>
<h2 id='spGini'>Spatial Gini coefficient</h2><span id='topic+spGini'></span>

<h3>Description</h3>

<p>This is the implementation of the spatial decomposition of the Gini coefficient introduced by Rey and Smith (2013). The function calculates the global Gini and the two components of the spatial Gini: the inequality among nearest (geographically) neighbours and the inequality of non-neighbours. Three weighted schemes are currently supported: binary, bi-square and row standardised bi-square.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spGini(Coords, Bandwidth, x, WType = 'Binary')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spGini_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the observations (data points or geometric / population weighted centroids)</p>
</td></tr>
<tr><td><code id="spGini_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>a positive integer that defines the number of nearest neighbours for the calculation of the weights</p>
</td></tr>
<tr><td><code id="spGini_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="spGini_+3A_wtype">WType</code></td>
<td>
<p>a string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;Binary&quot;, &quot;Bi-square&quot;, &quot;RSBi-square&quot;. Default is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: weight = (1-(ndist/H)^2)^2 for distances less than or equal to H, 0 otherwise;
</p>
<p>RSBi-square: weight = Bi-square weights / sum (Bi-square weights) for each row in the weights matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of five values Gini, gwGini, nsGini, gwGini.frac, nsGini.frac
</p>
<table role = "presentation">
<tr><td><code>Gini</code></td>
<td>
<p>Global Gini</p>
</td></tr>
<tr><td><code>gwGini</code></td>
<td>
<p>First component of the spatial Gini: the inequality among nearest (geographically) neighbours</p>
</td></tr>
<tr><td><code>nsGini</code></td>
<td>
<p>Second component of the spatial Gini: the inequality among non-neighbours</p>
</td></tr>
<tr><td><code>gwGini.frac</code></td>
<td>
<p>The fraction of the first component of the spatial Gini</p>
</td></tr>
<tr><td><code>nsGini.frac</code></td>
<td>
<p>The fraction of the second component of the spatial Gini</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Rey, S.J., Smith, R. J. (2013) A spatial decomposition of the Gini coefficient, Letters in Spatial and Resource Sciences, 6 (2), pp. 55-70.
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
Coords1&lt;-cbind(GR.Municipalities@data$X, GR.Municipalities@data$Y)
Bandwidth1&lt;-12
x1&lt;-GR.Municipalities@data$Income01
WType1&lt;-'Binary'
spGini(Coords1,Bandwidth1,x1,WType1)
</code></pre>

<hr>
<h2 id='spGini.w'>Spatial Gini coefficient with a given weights matrix</h2><span id='topic+spGini.w'></span>

<h3>Description</h3>

<p>This is the implementation of the spatial decomposition of the Gini coefficient introduced by Rey and Smith (2013) as in the function spGini. In this function, the calculation of the global Gini and the two components of the spatial Gini is performed using matrix algebra and a ready made weights matrix. Thus, it is possible to use weighting schemes other than those currently supported in spGini.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spGini.w(x, w)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spGini.w_+3A_x">x</code></td>
<td>
<p>a numeric vector of a variable</p>
</td></tr>
<tr><td><code id="spGini.w_+3A_w">w</code></td>
<td>
<p>Weights Matrix usin w.matrix or other R function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list of five values Gini, gwGini, nsGini, gwGini.frac, nsGini.frac
</p>
<table role = "presentation">
<tr><td><code>Gini</code></td>
<td>
<p>Global Gini</p>
</td></tr>
<tr><td><code>gwGini</code></td>
<td>
<p>First component of the spatial Gini: the inequality among nearest (geographically) neighbours</p>
</td></tr>
<tr><td><code>nsGini</code></td>
<td>
<p>Second component of the spatial Gini: the inequality among non-neighbours</p>
</td></tr>
<tr><td><code>gwGini.frac</code></td>
<td>
<p>The fraction of the first component of the spatial Gini</p>
</td></tr>
<tr><td><code>nsGini.frac</code></td>
<td>
<p>The fraction of the second component of the spatial Gini</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Rey, S.J., Smith, R. J. (2013) A spatial decomposition of the Gini coefficient, Letters in Spatial and Resource Sciences, 6 (2), pp. 55-70.
</p>
<p>Kalogirou, S. (2015) Spatial Analysis: Methodology and Applications with R. [ebook] Athens: Hellenic Academic Libraries Link. ISBN: 978-960-603-285-1 (in Greek). <a href="https://repository.kallipos.gr/handle/11419/5029?locale=en">https://repository.kallipos.gr/handle/11419/5029?locale=en</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
w&lt;-w.matrix(cbind(GR.Municipalities@data$X, GR.Municipalities@data$Y),12,WType='Binary')
spGini.w(GR.Municipalities@data$Income01,w)
</code></pre>

<hr>
<h2 id='VotesGR'>New Democracy and Total Votes in Greece in 2012</h2><span id='topic+VotesGR'></span>

<h3>Description</h3>

<p>New Democracy and Total Votes per prefecture in the double parliamentary elections in Greece in May and June 2012, respectively</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(VotesGR)</code></pre>


<h3>Format</h3>

<p>A data frame with 51 observations on the following 8 variables.
</p>

<dl>
<dt><code>MapCode2</code></dt><dd><p>a numeric vector of codes for joining this data to a map</p>
</dd>
<dt><code>NAME_ENG</code></dt><dd><p>a alphanumeric vector of prefecture names in greeklish</p>
</dd>
<dt><code>X</code></dt><dd><p>a numeric vector of x coordinates</p>
</dd>
<dt><code>Y</code></dt><dd><p>a numeric vector of y coordinates</p>
</dd>
<dt><code>NDJune12</code></dt><dd><p>a numeric vector of votes for New Democracy in June 2012 parliamentary elections</p>
</dd>
<dt><code>NDMay12</code></dt><dd><p>a numeric vector of votes for New Democracy in May 2012 parliamentary elections</p>
</dd>    
<dt><code>AllJune12</code></dt><dd><p>a numeric vector of total valid votes in June 2012 parliamentary elections</p>
</dd>
<dt><code>AllMay12</code></dt><dd><p>a numeric vector of total valid votes in May 2012 parliamentary elections</p>
</dd>
</dl>



<h3>Details</h3>

<p>The X,Y coordinates refer to the geometric centroids of the 51 Prefectures in Greece in 2011. All electoral districts in the Attica Region have been merged to one. The two electoral regions in Thessaloniki have also been merged to a single region matching the NUTS II regions geography.</p>


<h3>Source</h3>

<p>The shapefile of the corresponding polygons is available from the Public Open Data of the Greek Government at <a href="https://geodata.gov.gr/en/dataset/oria-nomon-okkhe">https://geodata.gov.gr/en/dataset/oria-nomon-okkhe</a>. The election results are available from the Hellenic Ministry of Interior.</p>


<h3>References</h3>

<p>Georganos, S., Kalogirou, S. (2014) Spatial analysis of voting patterns of national elections in Greece, 10th International Congress of the Hellenic Geographical Society,  Aristotle University of Thessaloniki, Thessaloniki 22-24 October 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(VotesGR)
  plot(VotesGR$NDJune12,VotesGR$NDMay12)
  abline(0,1)
</code></pre>

<hr>
<h2 id='w.matrix'>Weights Matrix based on a number of nearest neighbours or a fixed distance</h2><span id='topic+w.matrix'></span>

<h3>Description</h3>

<p>This function constructs an n by n weights matrix for a geography with n geographical elements (e.g. points or polygons) using a number of nearest neighbours or a fixed distance.</p>


<h3>Usage</h3>

<pre><code class='language-R'>w.matrix(Coords, Bandwidth, WType = "Binary", family = "adaptive")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="w.matrix_+3A_coords">Coords</code></td>
<td>
<p>a numeric matrix or vector or data frame of two columns giving the X,Y coordinates of the geographical elements (data points or geometric / population weighted centroids for polygons)</p>
</td></tr>
<tr><td><code id="w.matrix_+3A_bandwidth">Bandwidth</code></td>
<td>
<p>either a positive integer that defines the number of nearest neighbours for the calculation of the weights of an adaptive kernel (family = 'adaptive') or a fixed distance in meters for a fixed kernel (family = 'fixed').</p>
</td></tr>
<tr><td><code id="w.matrix_+3A_wtype">WType</code></td>
<td>
<p>a string giving the weighting function used to compute the weights matrix. 
Options are: &quot;Binary&quot;, &quot;Bi-square&quot;, and &quot;RSBi-square&quot;. The default value is &quot;Binary&quot;.
</p>
<p>Binary: weight = 1 for distances less than or equal to the distance of the furthest neighbour (H), 0 otherwise;
</p>
<p>Bi-square: weight = (1-(ndist/H)^2)^2 for distances less than or equal to H, 0 otherwise;
</p>
<p>RSBi-square: weight = Bi-square weights / sum (Bi-square weights) for each row in the weights matrix
</p>
</td></tr>
<tr><td><code id="w.matrix_+3A_family">family</code></td>
<td>
<p>a string giving the weighting scheme used to compute the weights matrix. 
Options are: &quot;adaptive&quot; and &quot;fixed&quot;. The default value is &quot;adaptive&quot;.
</p>
<p>adaptive: the number of nearest neighbours (integer). 
</p>
<p>fixed: a fixed distance around each observation's location (in meters).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of weights
</p>


<h3>Author(s)</h3>

<p>Stamatis Kalogirou &lt;stamatis.science@gmail.com&gt;</p>


<h3>References</h3>

<p>Kalogirou, S. (2003) The Statistical Analysis and Modelling of Internal Migration Flows within England and Wales, PhD Thesis, School of Geography, Politics and Sociology, University of Newcastle upon Tyne, UK. <a href="https://theses.ncl.ac.uk/jspui/handle/10443/204">https://theses.ncl.ac.uk/jspui/handle/10443/204</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+moransI.w">moransI.w</a></code>, <code><a href="#topic+spGini.w">spGini.w</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(GR.Municipalities)
attr &lt;- GR.Municipalities@data

#adaptive kernel
w.adapt &lt;- w.matrix(cbind(attr$X, attr$Y),6, WType='Binary', family='adaptive')

#fixed kernel
w.fixed &lt;- w.matrix(cbind(attr$X, attr$Y), 50000, WType='Binary', family='fixed')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
