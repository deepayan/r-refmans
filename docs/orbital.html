<!DOCTYPE html><html lang="en"><head><title>Help for package orbital</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {orbital}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#augment.orbital_class'><p>Augment using orbital objects</p></a></li>
<li><a href='#orbital'><p>Turn tidymodels objects into orbital objects</p></a></li>
<li><a href='#orbital_dt'><p>Convert to data.table code</p></a></li>
<li><a href='#orbital_inline'><p>Convert orbital objects to quosures</p></a></li>
<li><a href='#orbital_json_read'><p>Read orbital json file</p></a></li>
<li><a href='#orbital_json_write'><p>Save orbital object as json file</p></a></li>
<li><a href='#orbital_r_fun'><p>Turn orbital object into a R function</p></a></li>
<li><a href='#orbital_sql'><p>Convert to SQL code</p></a></li>
<li><a href='#predict.orbital_class'><p>Prediction using orbital objects</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Predict with 'tidymodels' Workflows in Databases</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Turn 'tidymodels' workflows into objects containing the
    sufficient sequential equations to perform predictions. These smaller
    objects allow for low dependency prediction locally or directly in
    databases.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/tidymodels/orbital">https://github.com/tidymodels/orbital</a>,
<a href="https://orbital.tidymodels.org">https://orbital.tidymodels.org</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/tidymodels/orbital/issues">https://github.com/tidymodels/orbital/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, dplyr, generics (&ge; 0.1.2), rlang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>arrow, bonsai, DBI, dbplyr, dtplyr, duckdb, embed, glue, gt,
hardhat, jsonlite, kknn, knitr, modeldata, parsnip, partykit,
R6, recipes, rmarkdown, RSQLite, rstanarm, sparklyr, testthat
(&ge; 3.0.0), themis, tibble, tidypredict (&ge; 0.5.1), workflows</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>tidyverse/tidytemplate, rmarkdown, gt</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-22 00:09:30 UTC; emilhvitfeldt</td>
</tr>
<tr>
<td>Author:</td>
<td>Emil Hvitfeldt [aut, cre],
  Posit Software, PBC [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emil Hvitfeldt &lt;emil.hvitfeldt@posit.co&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-22 02:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='augment.orbital_class'>Augment using orbital objects</h2><span id='topic+augment.orbital_class'></span>

<h3>Description</h3>

<p><code><a href="#topic+augment">augment()</a></code> will add column(s) for predictions to the given data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'orbital_class'
augment(x, new_data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="augment.orbital_class_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
<tr><td><code id="augment.orbital_class_+3A_new_data">new_data</code></td>
<td>
<p>A data frame or remote database table.</p>
</td></tr>
<tr><td><code id="augment.orbital_class_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a shorthand for the following code
</p>
<div class="sourceCode r"><pre>dplyr::bind_cols(
  predict(orbital_obj, new_data),
  new_data
)
</pre></div>
<p>Note that <code><a href="#topic+augment">augment()</a></code> works better and safer than above as it also works on
data set in data bases.
</p>
<p>This function is confirmed to not work work in spark data bases or arrow
tables.
</p>


<h3>Value</h3>

<p>A modified data frame or remote database table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

augment(orbital_obj, mtcars)

</code></pre>

<hr>
<h2 id='orbital'>Turn tidymodels objects into orbital objects</h2><span id='topic+orbital'></span>

<h3>Description</h3>

<p>Fitted workflows, parsnip objects, and recipes objects can be turned into an
orbital object that contain all the information needed to perform
predictions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital(x, ..., prefix = ".pred", type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_+3A_x">x</code></td>
<td>
<p>A fitted workflow, parsnip, or recipes object.</p>
</td></tr>
<tr><td><code id="orbital_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
<tr><td><code id="orbital_+3A_prefix">prefix</code></td>
<td>
<p>A single string, specifies the prediction naming scheme.
If <code>x</code> produces a prediction, tidymodels standards dictate that the
predictions will start with <code>.pred</code>. This is not a valid name for
some data bases.</p>
</td></tr>
<tr><td><code id="orbital_+3A_type">type</code></td>
<td>
<p>A vector of strings, specifies the prediction type. Regression
models allow for <code>"numeric"</code> and classification models allow for <code>"class"</code>
and <code>"prob"</code>. Multiple values are allowed to produce hard and soft
predictions for classification models. Defaults to <code>NULL</code> which defaults to
<code>"numeric"</code> for regression models and <code>"class"</code> for classification models.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An orbital object contains all the information that is needed to perform
predictions. This makes the objects substantially smaller than the original
objects. The main downside with this object is that all the input checking
has been removed, and it is thus up to the user to make sure the data is
correct.
</p>
<p>The printing of orbital objects reduce the number of significant digits for
easy viewing, the can be changes by using the <code>digits</code> argument of <code>print()</code>
like so <code>print(orbital_object, digits = 10)</code>. The printing likewise truncates
each equation to fit on one line. This can be turned off using the <code>truncate</code>
argument like so <code>print(orbital_object, truncate = FALSE)</code>.
</p>
<p>Full list of supported models and recipes steps can be found here:
<code>vignette("supported-models")</code>.
</p>
<p>These objects will not be useful by themselves. They can be used to
<a href="#topic+predict.orbital_class">predict()</a> with, or to generate code using functions
such as <code><a href="#topic+orbital_sql">orbital_sql()</a></code> or <code><a href="#topic+orbital_dt">orbital_dt()</a></code>.
</p>


<h3>Value</h3>

<p>An <a href="#topic+orbital">orbital</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital(wf_fit)

# Also works on parsnip object by itself
fit(lm_spec, mpg ~ disp, data = mtcars) %&gt;%
  orbital()

# And prepped recipes
prep(rec_spec) %&gt;%
  orbital()

</code></pre>

<hr>
<h2 id='orbital_dt'>Convert to data.table code</h2><span id='topic+orbital_dt'></span>

<h3>Description</h3>

<p>Returns <a href="https://rdatatable.gitlab.io/data.table/">data.table</a> code that
is equivilant to prediction code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_dt(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_dt_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.
</p>
<p>This function requires <a href="https://dtplyr.tidyverse.org/">dtplyr</a> to be
installed to run. The resulting code will likely need to be adopted to your
use-case. Most likely by removing the initial <code>copy(data-name)</code> at the start.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.table code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

orbital_dt(orbital_obj)

</code></pre>

<hr>
<h2 id='orbital_inline'>Convert orbital objects to quosures</h2><span id='topic+orbital_inline'></span>

<h3>Description</h3>

<p>Use orbital object splicing function to apply orbital prediction in a quosure
aware function such as <code><a href="dplyr.html#topic+mutate">dplyr::mutate()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_inline(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_inline_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is mostly going to be used for
<a href="https://rlang.r-lib.org/reference/topic-inject.html#dots-injection">Dots Injection</a>.
This function is used internally in <a href="#topic+predict.orbital_class">predict()</a>, but
is also exported for user flexibility. Should be used with <code style="white-space: pre;">&#8288;!!!&#8288;</code> as seen in
the examples.
</p>
<p>Note should be taken that using this function modifies existing variables and
creates new variables, unlike <a href="#topic+predict.orbital_class">predict()</a> which only
returns predictions.
</p>


<h3>Value</h3>

<p>a list of <a href="rlang.html#topic+defusing-advanced">quosures</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

orbital_inline(orbital_obj)

library(dplyr)

mtcars %&gt;%
  mutate(!!!orbital_inline(orbital_obj))

</code></pre>

<hr>
<h2 id='orbital_json_read'>Read orbital json file</h2><span id='topic+orbital_json_read'></span>

<h3>Description</h3>

<p>Reading an orbital object from disk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_json_read(path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_json_read_+3A_path">path</code></td>
<td>
<p>file on disk.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is aware of the <code>version</code> field of the orbital object, and will
read it in correctly, according to its specification.
</p>


<h3>Value</h3>

<p>An <a href="#topic+orbital">orbital</a> object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+orbital_json_write">orbital_json_write()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

tmp_file &lt;- tempfile()

orbital_json_write(orbital_obj, tmp_file)

orbital_json_read(tmp_file)

</code></pre>

<hr>
<h2 id='orbital_json_write'>Save orbital object as json file</h2><span id='topic+orbital_json_write'></span>

<h3>Description</h3>

<p>Saving an orbital object to disk in a human and machine readable way.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_json_write(x, path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_json_write_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
<tr><td><code id="orbital_json_write_+3A_path">path</code></td>
<td>
<p>file on disk.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The structure of the resulting JSON file allows for easy reading, both by
orbital itself with <code><a href="#topic+orbital_json_read">orbital_json_read()</a></code>, but potentially by other packages
and langauges. The file is versioned by the <code>version</code> field to allow for
changes why being backwards combatible with older file versions.
</p>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+orbital_json_read">orbital_json_read()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

tmp_file &lt;- tempfile()

orbital_json_write(orbital_obj, tmp_file)

readLines(tmp_file)

</code></pre>

<hr>
<h2 id='orbital_r_fun'>Turn orbital object into a R function</h2><span id='topic+orbital_r_fun'></span>

<h3>Description</h3>

<p>Returns a R file that contains a function that output predictions when
applied to data frames.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_r_fun(x, name = "orbital_predict", file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_r_fun_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
<tr><td><code id="orbital_r_fun_+3A_name">name</code></td>
<td>
<p>Name of created function. Defaults to '&quot;orbital_predict&quot;&ldquo;.</p>
</td></tr>
<tr><td><code id="orbital_r_fun_+3A_file">file</code></td>
<td>
<p>A file name.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated function is only expected to work on data frame objects. The
generated function doesn't require the orbital package to be loaded.
Depending on what models and steps are used, other packages such as dplyr
will need to be loaded as well.
</p>


<h3>Value</h3>

<p>Nothing.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

file_name &lt;- tempfile()

orbital_r_fun(orbital_obj, file = file_name)

readLines(file_name)

</code></pre>

<hr>
<h2 id='orbital_sql'>Convert to SQL code</h2><span id='topic+orbital_sql'></span>

<h3>Description</h3>

<p>Returns SQL code that is equivilant to prediction code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>orbital_sql(x, con)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="orbital_sql_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
<tr><td><code id="orbital_sql_+3A_con">con</code></td>
<td>
<p>A connection object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function requires a database connection object, as the resulting code
SQL code can differ depending on the type of database.
</p>


<h3>Value</h3>

<p>SQL code.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

library(dbplyr)
con &lt;- simulate_dbi()

orbital_sql(orbital_obj, con)

</code></pre>

<hr>
<h2 id='predict.orbital_class'>Prediction using orbital objects</h2><span id='topic+predict.orbital_class'></span>

<h3>Description</h3>

<p>Running prediction on data frame of remote database table, without needing to
load original packages used to fit model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'orbital_class'
predict(object, new_data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.orbital_class_+3A_object">object</code></td>
<td>
<p>An <a href="#topic+orbital">orbital</a> object.</p>
</td></tr>
<tr><td><code id="predict.orbital_class_+3A_new_data">new_data</code></td>
<td>
<p>A data frame or remote database table.</p>
</td></tr>
<tr><td><code id="predict.orbital_class_+3A_...">...</code></td>
<td>
<p>Not currently used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using this function should give identical results to running <code>predict()</code> or
<code>bake()</code> on the orginal object.
</p>
<p>The prediction done will only return prediction colunms, a opposed to
returning all modified functions as done with <code><a href="#topic+orbital_inline">orbital_inline()</a></code>.
</p>


<h3>Value</h3>

<p>A modified data frame or remote database table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(workflows)
library(recipes)
library(parsnip)

rec_spec &lt;- recipe(mpg ~ ., data = mtcars) %&gt;%
  step_normalize(all_numeric_predictors())

lm_spec &lt;- linear_reg()

wf_spec &lt;- workflow(rec_spec, lm_spec)

wf_fit &lt;- fit(wf_spec, mtcars)

orbital_obj &lt;- orbital(wf_fit)

predict(orbital_obj, mtcars)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+augment'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+augment">augment</a></code></p>
</dd>
</dl>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
