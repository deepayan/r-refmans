<!DOCTYPE html><html><head><title>Help for package bdpv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bdpv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bdpv-package'><p>Confidence intervals and experimental design for negative and positive predictive values in binary diagnostic tests.</p></a></li>
<li><a href='#as.data.frame.nPV'>
<p>Coerce results of &quot;nPV&quot; to a data.frame.</p></a></li>
<li><a href='#BDtest'>
<p>Computing confidence intervals for sensitivity, specificity and predictive values assuming a case-control study.</p></a></li>
<li><a href='#CInpvppv'>
<p>Asymptotic confidence intervals for negative and positive predictive values.</p></a></li>
<li><a href='#CIpvBayes'>
<p>Confidence intervals for negative and positive predictive values in a case-control setting by simulation from the posterior distribution.</p></a></li>
<li><a href='#nNPVPPV'><p>Asymptotic experimental design for inference on negative and positive predictive values in case-control studies.</p></a></li>
<li><a href='#nPV'>
<p>Asymptotic sample size calculation for inference on negative and positive predictive values in case-control designs.</p></a></li>
<li><a href='#plotnPV'>
<p>Plot experimental design for different setting in a single figure.</p></a></li>
<li><a href='#plotnPV2'><p>Plot experimental design for different settings in a set of sub figure.</p></a></li>
<li><a href='#print.BDtest'>
<p>Detailed print out for BDtest</p></a></li>
<li><a href='#print.nPV'><p>Detailed print out for nPV</p></a></li>
<li><a href='#simPV'>
<p>Simulate performance of confidence intervals for predictive values in a case-control design</p></a></li>
<li><a href='#simPVmat'><p>Simulate performance of confidence intervals for predictive values in case-control design</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inference and Design for Predictive Values in Diagnostic Tests</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-11</td>
</tr>
<tr>
<td>Author:</td>
<td>Frank Schaarschmidt [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation of asymptotic confidence intervals for negative and positive predictive values in binary diagnostic tests in case-control studies. Experimental design for hypothesis tests on predictive values.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-11 14:54:20 UTC; Schaarschmidt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-11 15:12:40 UTC</td>
</tr>
</table>
<hr>
<h2 id='bdpv-package'>Confidence intervals and experimental design for negative and positive predictive values in binary diagnostic tests.</h2><span id='topic+bdpv-package'></span><span id='topic+bdpv'></span>

<h3>Description</h3>

<p>Computing asymptotic confidence intervals for negative and positive predictive values of binary diagnostic test assuming a case-control design.
Experimental design based on asymptotic formulas and Monte Carlo simulation for hypothesis tests on predictive values, including some plot functions to explore various experimental designs.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> bdpv</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-04-17</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>1) Computing confidence intervals: The function <code><a href="#topic+BDtest">BDtest</a></code> computes the asymptotic confidence intervals for negative and positive predictive value given in Mercaldo et al. (2007),
assuming binomial sampling for obtaining estimates of sensitivity and specificity (leading to a 2x2 table with numbers of diseased and healthy fixed by design) and known prevalence.
Alternatively, the functions <code><a href="#topic+CIpvBI">CIpvBI</a></code> and <code><a href="#topic+CIpvBII">CIpvBII</a></code> allow to simulate Bayesian intervals for negative and positive predictive values in case-control designs (Stamey and Holt, 2010),
where prior knowledge concerning sensitivity, specificity may be included and external data and/or prior knowledge on prevalence may be included. By default, flat, non-informative priors are used,
resulting in intervals with improved frequentist small sample performance (Stamey and Holt, 2010).
</p>
<p>2) The function <code><a href="#topic+nPV">nPV</a></code> uses the asymptotic formulas of Steinberg et al.(2009) to calculate the sample size necessary to reject tests witzh H0: PPV&gt;=PPV0, H0NPV&gt;=PNPV0, with a prespecified power in a case-control setting.
Further necessary input arguments are sensitivity, specificity, prevalence, NPV0, PPV0, the range and number of steps of proportion of true positives in the trial.
The results of this function can be plotted using <code><a href="#topic+plotnPV">plotnPV</a></code>, <code><a href="#topic+plotnPV2">plotnPV2</a></code> and be somewhat edited by <code><a href="#topic+as.data.frame.nPV">as.data.frame.nPV</a></code>. 
</p>
<p>3) Because the results of these functions may be misleading in small sample or extreme proportion situations, the simulation functions <code><a href="#topic+simPV">simPV</a></code> and <code><a href="#topic+simPVmat">simPVmat</a></code> allow to check power and coverage probability for given parameter stettings.  
</p>
<p>The remaining functions are meant for internal use.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt, on behalf of the Institute of Biostatistics, LUH, Hannover, Germany
Maintainer: Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;
</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negative predictive value in diagnostic research using case-control designs. Biostatistics 10,1, 94-105.
</p>
<p><em>Mercaldo ND, Lau KF, Zhou XH (2007).</em> Confidence intervals for predictive values with an emphasis to case-control studies. Statistics in Medicine 26:2170-2183.
</p>
<p><em>Stamey JD and Holt MM (2010).</em> Bayesian interval estimation for predictive values for case-control studies. Communications in Statistics - Simulation and Computation. 39:1, 101-110.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1) Example data: Mercaldo et al.(2007), Table VIII:

Tab8&lt;-matrix(c(240, 178, 87, 288), ncol=2)
colnames(Tab8)&lt;-c("Case","Control")
rownames(Tab8)&lt;-c("ApoEe4plus","ApoEe4minus")
Tab8

# Assuming prevalence=0.03
BDtest(xmat=Tab8, pr=0.03, conf.level = 0.95)

# Assuming prevalence=0.5
BDtest(xmat=Tab8, pr=0.5, conf.level = 0.95)

# 2) Experimental design acc. to Steinberg et al.(2009)

TEST&lt;-nPV(se=c(0.76, 0.78, 0.80, 0.82, 0.84),
 sp=c(0.93, 0.94, 0.95, 0.96, 0.97),
 pr=0.0625, NPV0=0.98, PPV0=0.25, NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.10, 0.9), nsteps = 20, alpha = 0.05)

TEST

plotnPV(TEST, log="y", legpar=list(x=0.6))


# 3) Simulation of power and coverage probability

simPVmat(se=0.8, sp=0.95, pr=0.0625, n1=c(177, 181), 
 n0=c(554, 87), NPV0=0.98, PPV0=c(0.4, 0.25))



</code></pre>

<hr>
<h2 id='as.data.frame.nPV'>
Coerce results of &quot;nPV&quot; to a data.frame.
</h2><span id='topic+as.data.frame.nPV'></span>

<h3>Description</h3>

<p>Coerce the possibly long sample size tables resulting from calling &quot;nPV&quot; to a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nPV'
as.data.frame(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.data.frame.nPV_+3A_x">x</code></td>
<td>
<p> an object of class <code>"nPV"</code></p>
</td></tr>
<tr><td><code id="as.data.frame.nPV_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>as.data.frame</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The lengthy lists in the output <code><a href="#topic+nPV">nPV</a></code>, item <code>nlist</code> are coerced to a data.frame with columns propP, and the different NPV/PPV sample sizes for each of the parameters settings following.
</p>

<hr>
<h2 id='BDtest'>
Computing confidence intervals for sensitivity, specificity and predictive values assuming a case-control study.
</h2><span id='topic+BDtest'></span>

<h3>Description</h3>

<p>This function computes confidence intervals for negative and positive predictive values. Confidence intervals for sensitivity, specificity are computed for completeness.
All methods assume that data are obtained by binomial sampling, with the number of true positives and true negatives in the study fixed by design.
The methods to compute negative and positive predictive values (NPV, PPV) assume that prevalence is a known quantity, based on external knowledge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BDtest(xmat, pr, conf.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BDtest_+3A_xmat">xmat</code></td>
<td>
<p> A 2x2 table with 4 (integer) values, where the first column (<code>xmat[,1]</code>) represents the numbers of positive and negative results in the group of true positives, and the second column (<code>xmat[,2]</code>) contains the numbers of positive and negative results in the group of true negatives, i.e. the first row contains numbers of positive results and the second row the number of negative results.
</p>
</td></tr>
<tr><td><code id="BDtest_+3A_pr">pr</code></td>
<td>

<p>A single numeric value between 0 and 1, specifying the assumed prevalence.
</p>
</td></tr>
<tr><td><code id="BDtest_+3A_conf.level">conf.level</code></td>
<td>

<p>A single numeric value between 0 amd 1, specifying the nominal confidence level. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The exact, conservative Clopper Pearson (1934) method is used to compute intervals for the sensitivty and specificity. The asymptotic standard logit intervals (Mercaldo et al. 2007) are used to compute intervals for the predictive values. In case that the table contains any 0, the adjusted logit intervals (Mercaldo et al. 2007) are returned instead to compute intervals for the predictive values.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table>
<tr><td><code>INDAT</code></td>
<td>
<p>a data.frame containing the input 2x2 table</p>
</td></tr>
<tr><td><code>SESPDAT</code></td>
<td>
<p>a data.frame with four columns containing estimates, lower limit and two.sided interval for the sensitivity and specificity (1. and 2. row)</p>
</td></tr>
<tr><td><code>PPVNPVDAT</code></td>
<td>
<p>a data.frame with four columns containing estimates, lower limit and two.sided interval for the NPV and PPV (1. and 2. row)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Mercaldo ND, Lau KF, Zhou XH (2007).</em> Confidence intervals for predictive values with an emphasis to case-control studies. Statistics in Medicine 26:2170-2183.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CInpvppv">CInpvppv</a></code> for the internally used methods to compute the intervals for predictive values, 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Reproduce the standard logit interval results in 
# Table IX, Mercaldo et al.(2007)

# 1) Example data: Mercaldo et al.(2007), Table VIII:

Tab8&lt;-matrix(c(240, 178, 87, 288), ncol=2)
colnames(Tab8)&lt;-c("Case","Control")
rownames(Tab8)&lt;-c("ApoEe4plus","ApoEe4minus")
Tab8

# Assuming prevalence=0.03
BDtest(xmat=Tab8, pr=0.03, conf.level = 0.95)

# Assuming prevalence=0.5
BDtest(xmat=Tab8, pr=0.5, conf.level = 0.95)

</code></pre>

<hr>
<h2 id='CInpvppv'>
Asymptotic confidence intervals for negative and positive predictive values.
</h2><span id='topic+CInpvppv'></span><span id='topic+CIlnpv'></span><span id='topic+CIlppv'></span><span id='topic+CIlnpvak'></span><span id='topic+CIlppvak'></span><span id='topic+CombCInpv'></span><span id='topic+CombCIppv'></span>

<h3>Description</h3>

<p>Computes asymptotic confidence intervals for negative and positive predictive values under the assumption of binomial sampling and known prevalence, according to Mercaldo et al. (2007). The standard logit intervals and and adjusted version are available, where the standard logit intervals are recommended. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIlnpv(x0, x1, p, conf.level = 0.95, 
alternative = c("two.sided", "less", "greater"))

CIlppv(x0, x1, p, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))

CIlnpvak(x0, x1, p, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))

CIlppvak(x0, x1, p, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))

CombCInpv(x0, x1, p, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))

CombCIppv(x0, x1, p, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CInpvppv_+3A_x0">x0</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x0[1]</code>) and negative (<code>x0[2]</code>) outcomes in the group of true negatives.
</p>
</td></tr>
<tr><td><code id="CInpvppv_+3A_x1">x1</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x1[1]</code>) and negative (<code>x1[2]</code>) outcomes in the group of true positives.
</p>
</td></tr>
<tr><td><code id="CInpvppv_+3A_p">p</code></td>
<td>

<p>The assumed prevalence, a single numeric value between 0 and 1.
</p>
</td></tr>
<tr><td><code id="CInpvppv_+3A_conf.level">conf.level</code></td>
<td>

<p>The confidence level, a single numeric value between 0 and 1, defaults to 0.95
</p>
</td></tr>
<tr><td><code id="CInpvppv_+3A_alternative">alternative</code></td>
<td>

<p>A character string specifying whether two-sided (<code>"two.sided"</code>), only lower bounds (<code>"greater"</code>) or only upper bounds (<code>"less"</code>) shall be calculated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CIlnpv</code> and <code>CIlppv</code> implement the standard logit intervals for NPV and PPV, Section 2.2, Eq.(8)-Eq.(11) in Mercaldo et al. (2007). <code>CIlnpvak</code> and <code>CIlppval</code> implement the logit intervals for NPV and PPV with adjusted estimates according to Table II in Mercaldo et al. (2007). The standard logit intervals have better properties, but are not defined in a number of extreme outcomes. The adjusted logit methods do always produce intervals, but have worse frequentist properties (Mercaldo et al. 2007). The functions <code>CombCInpv</code>, <code>CombCIppv</code> combine both methods by computing the stdnard logit method when possible and computing the adjusted methods in those cases where the standard method is not defined. These functions are meant to facilitate simulation, e.g. in <code><a href="#topic+simPV">simPV</a></code>, <code><a href="#topic+simPVmat">simPVmat</a></code>.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>the confidence bounds</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the point estimate</p>
</td></tr>
</table>


<h3>Note</h3>

<p>These functions are meant for internal use. There is not much checking for the validity of input.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Mercaldo ND, Lau KF, Zhou XH (2007).</em> Confidence intervals for predictive values with an emphasis to case-control studies. Statistics in Medicine 26: 2170-2183.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BDtest">BDtest</a></code> as a user level function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>CIlnpv(x0=c(87,288), x1=c(240,178), p=0.03,
 conf.level = 0.95, alternative = "two.sided")

CIlppv(x0=c(87,288), x1=c(240,178), p=0.03,
 conf.level = 0.95, alternative = "two.sided")

CIlnpvak(x0=c(87,288), x1=c(240,178), p=0.03,
 conf.level = 0.95, alternative = "two.sided")

CIlppvak(x0=c(87,288), x1=c(240,178), p=0.03,
 conf.level = 0.95, alternative = "two.sided")

</code></pre>

<hr>
<h2 id='CIpvBayes'>
Confidence intervals for negative and positive predictive values in a case-control setting by simulation from the posterior distribution.
</h2><span id='topic+CIpvBI'></span><span id='topic+CIpvBII'></span>

<h3>Description</h3>

<p>Computes confidence intervals for negative and positive predictive values by simulation from the posterior beta-distribution (Stamey and Holt, 2010),
assuming a case-control design to estimate sensitivity and specificity, while prevalence estimates of an external study and/or prior knowledge concerning
prevalence may be introduced additionally.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIpvBI(x1, x0, pr, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"),
 B=5000, shapes1=c(1,1), shapes0=c(1,1), ...)

CIpvBII(x1, x0, xpr, conf.level = 0.95,
 alternative = c("two.sided", "less", "greater"),
 B=5000, shapes1=c(1,1), shapes0=c(1,1), shapespr=c(1,1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIpvBayes_+3A_x1">x1</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x1[1]</code>) and negative (<code>x1[2]</code>) test results in the group of true positives.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_x0">x0</code></td>
<td>

<p>A vector of two (integer) values, specifying the observed number of positive (<code>x0[1]</code>) and negative (<code>x0[2]</code>) test results in the group of true negatives.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_pr">pr</code></td>
<td>

<p>A single numeric value between 0 and 1, defining an assumed fixed (known) prevalence (for <code>CIpvBI</code>), where prevalence is the proportion of positives in the population.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_xpr">xpr</code></td>
<td>

<p>An optional vector of two (integer) values, specifying the observed number of positive (<code>xpr[1]</code>) and negative (<code>xpr[2]</code>) outcomes from an external study that allows to estimate the prevalence of positives in the population of interest.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_conf.level">conf.level</code></td>
<td>

<p>The confidence level, a single numeric value between 0 and 1, defaults to 0.95
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_alternative">alternative</code></td>
<td>

<p>A character string specifying whether two-sided (<code>"two.sided"</code>), only lower bounds (<code>"greater"</code>) or only upper bounds (<code>"less"</code>) shall be calculated.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_b">B</code></td>
<td>

<p>A single integer, the number of samples from the posterior to be drawn.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_shapes1">shapes1</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for the sensitivity, by default a flat beta prior (a=1, b=1) is used.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_shapes0">shapes0</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for (1-specificity), by default a flat beta prior (a=1, b=1) is used. Note, that this definition differs from that in Stamey and Holt(2010), where the prior is defined for the specificity directly.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_shapespr">shapespr</code></td>
<td>

<p>Two positive numbers, the shape parameters (a,b) of the beta prior for the prevalence, by default a flat beta prior (a=1, b=1) is used. For <code>CIpvBII</code> only.
</p>
</td></tr>
<tr><td><code id="CIpvBayes_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code>quantile(), other arguments are ignored without warning. </code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>CIpvBI</code> implements the method refered to as Bayes I in Stamey and Holt (2010), <code>CIpvBI</code> implements the method refered to as Bayes II in Stamey and Holt (2010), Equation (2) and following description (p. 103-104).
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>conf.int</code></td>
<td>
<p>the confidence bounds</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>the point estimate</p>
</td></tr>
<tr><td><code>tab</code></td>
<td>
<p>a 2x2 matrix showing how the input data in terms of true positives and true negatives</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Stamey JD and Holt MM (2010).</em> Bayesian interval estimation for predictive values for case-control studies. Communications in Statistics - Simulation and Computation. 39:1, 101-110.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# example data: Stamey and Holt, Table 8 (page 108)
#	Diseased
# Test	D=1	D=0
# T=1	240	87
# T=0	178	288
#n1,n0:	418	375


# reproduce the results for the Bayes I method
# in Stamey and Holt (2010), Table 9, page 108

# assuming known prevalence 0.03 
# ppv 0.0591, 0.0860
# npv 0.9810, 0.9850
CIpvBI( x1=c(240,178), x0=c(87,288), pr=0.03)

# assuming known prevalence 0.04 
# ppv 0.0779, 0.1111
# npv 0.9745, 0.9800
CIpvBI( x1=c(240,178), x0=c(87,288), pr=0.04)

# compare with standard logit intervals
tab &lt;- cbind( x1=c(240,178), x0=c(87,288))
tab
BDtest(tab, pr=0.03)
BDtest(tab, pr=0.04)


# reproduce the results for the Bayes II method 
# in Stamey and Holt (2010), Table 9, page 108

CIpvBII( x1=c(240,178), x0=c(87,288),  shapespr=c(16,486))

CIpvBII( x1=c(240,178), x0=c(87,288), shapespr=c(21,481))

</code></pre>

<hr>
<h2 id='nNPVPPV'>Asymptotic experimental design for inference on negative and positive predictive values in case-control studies.</h2><span id='topic+nNPVPPV'></span><span id='topic+nNPV'></span><span id='topic+nPPV'></span><span id='topic+AOppvnpv'></span>

<h3>Description</h3>

<p>For internal use. Functions to compute sample size (to reach a pre-specified power) and optimal allocation of true positives and true negatives in case-control designs for binary diagnostic tests (Mercaldo et al. 2007).</p>


<h3>Usage</h3>

<pre><code class='language-R'>nNPV(propP, se, sp, prev, NPV0,
 conf.level = 0.95, power = 0.8)

nPPV(propP, se, sp, prev, PPV0,
 conf.level = 0.95, power = 0.8)

AOppvnpv(se, sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nNPVPPV_+3A_se">se</code></td>
<td>
<p>a numeric value, specifying the expected sensitivity</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_sp">sp</code></td>
<td>
<p>a numeric value, specifying the expected specificity</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_propp">propP</code></td>
<td>
<p>a vector of numeric values of proportions of truely positives in the trial (n1/(n1+n0))</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_prev">prev</code></td>
<td>
<p>a numeric value, the prevalence</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_npv0">NPV0</code></td>
<td>
<p>a numeric value, the negative predictive value to be rejected under H0: NPV&gt;=NPV0</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_ppv0">PPV0</code></td>
<td>
<p>a numeric value, the positive predictive value to be rejected under H0: PPV&gt;=PPV0</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_conf.level">conf.level</code></td>
<td>
<p>a single numeric values, the nominal confidence level (1-alpha)</p>
</td></tr>
<tr><td><code id="nNPVPPV_+3A_power">power</code></td>
<td>
<p>a single numeric value, the power that is to be obtained</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions implement the methods described in section 3.2 of Steinberg et al.(2009), nPPV gives the solution to Eq.(3.6) and NA if necesarry conditions mentioned before are not fulfilled, 
nNPV gives the solution to Eq.(3.8) and NA if necesarry conditions mentioned before are not fulfilled, AOppvnpv gives the optimal proportion of true poistives as are solutions to Eq.(3.4) and Eq. (3.6) for PPV and NPV, respectively.
</p>


<h3>Value</h3>

<p>For nNPV and nPPV: a list with first element
</p>
<table>
<tr><td><code>n</code></td>
<td>
<p>the (vector of) sample size (s), or NA if necessary conditions are not met</p>
</td></tr>
</table>
<p>and further elements giving the input arguments
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negative predictive value in diagnostic research using case-control designs. Biostatistics 10,1, 94-105.
</p>


<h3>See Also</h3>

<p>For a combination of PPV and NPV experimental design see <code><a href="#topic+nPV">nPV</a></code> and <code><a href="#topic+plotnPV">plotnPV</a></code>; to validate small sample results of these asymptotic formulas, see <code><a href="#topic+simPVmat">simPVmat</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>
 nPPV(propP=c(0.2,0.4,0.6,0.8), se=0.9, sp=0.9,
 prev=0.1, PPV0=0.4, conf.level=0.95, power=0.8)

 nNPV(propP=c(0.2,0.4,0.6,0.8), se=0.9, sp=0.9,
 prev=0.1, NPV0=0.95, conf.level=0.95, power=0.8)

 AOppvnpv(se=0.9, sp=0.9)
</code></pre>

<hr>
<h2 id='nPV'>
Asymptotic sample size calculation for inference on negative and positive predictive values in case-control designs.
</h2><span id='topic+nPV'></span>

<h3>Description</h3>

<p>Functions to compute sample size (to reach a pre-specified power) and optimal allocation of true positives and true negatives in case-control designs (Steinberg et al., 2008) for binary diagnostic tests (Mercaldo et al. 2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nPV(se, sp, prev, NPV0, PPV0,
 NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.05, 0.95), nsteps = 20,
 alpha = 0.05, setnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nPV_+3A_se">se</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the expected sensitivity</p>
</td></tr>
<tr><td><code id="nPV_+3A_sp">sp</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the expected specificity</p>
</td></tr>
<tr><td><code id="nPV_+3A_prev">prev</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the prevalence</p>
</td></tr>
<tr><td><code id="nPV_+3A_npv0">NPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the negative predictive value to be rejected under H0: NPV&gt;=NPV0</p>
</td></tr>
<tr><td><code id="nPV_+3A_ppv0">PPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the positive predictive value to be rejected under H0: PPV&gt;=PPV0</p>
</td></tr>
<tr><td><code id="nPV_+3A_npvpower">NPVpower</code></td>
<td>
<p>a (vector of) numeric value(s), the power that is to be obtained for the test H0: NPV&gt;=NPV0</p>
</td></tr>
<tr><td><code id="nPV_+3A_ppvpower">PPVpower</code></td>
<td>
<p>a (vector of) numeric value(s), the power that is to be obtained for the test H0: PPV&gt;=PV0</p>
</td></tr>
<tr><td><code id="nPV_+3A_rangep">rangeP</code></td>
<td>
<p> a vector of two numeric values, giving the range of the proportion of truely positives to be considered in experimental design</p>
</td></tr>
<tr><td><code id="nPV_+3A_nsteps">nsteps</code></td>
<td>
<p>a single (integer) value, the number of steps in rangeP to be considered</p>
</td></tr>
<tr><td><code id="nPV_+3A_alpha">alpha</code></td>
<td>
<p>a single numeric value, the type I error of the test (1-confidence level)</p>
</td></tr>
<tr><td><code id="nPV_+3A_setnames">setnames</code></td>
<td>
<p>an optional vector of names for the parameter sets</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses <code><a href="#topic+nNPVPPV">nNPVPPV</a></code> and implement the methods described in section 3.2 of Steinberg et al.(2009).
The results for NPV are the smallest integers fulfilling Eq.(3.6) and NA if necesarry conditions mentioned before are not met, 
the results for PPV are the smallest integers fulfilling Eq.(3.8) and NA if necesarry conditions mentioned before are not met.
</p>
<p>The arguments <code>se</code>, <code>sp</code>, <code>prev</code>, <code>NPV0</code>, <code>PPV0</code>, <code>NPVpower</code>, <code>PPVpower</code> can be given as vectors or single values, where shorter values are recycled to the length of the longest. The proportion of true positives is varied over <code>nstep</code> equidistant values over the range specified in argument <code>rangeP</code>.
On each resulting parameter set, the asymptotic sample size formulas of Steinberg et al.(2009) are applied.
</p>
<p>The result of those calculations may be plot using <code><a href="#topic+plotnPV">plotnPV</a></code> and <code><a href="#topic+plotnPV2">plotnPV2</a></code>.
</p>
<p>Warnings are returned by the internal function nNPV and nPPV if the validity of asymptotic formulas under binomial sampling may be doubtable, namely when the asymptotic formulas return a total sample size n for given propP, se, sp, such that
min(n*propP*se, n*propP*(1-se))&lt;5 or min(n*(1-propP)*sp, n*(1-propP)*(1-sp))&lt;5. That is, a warning is returned if the proposed design of the case-control study (n1, n0) = (n*propP, n*(1-propP)) leads to expected counts &lt; 5 for any cell of the 2x2 table.
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>outDAT</code></td>
<td>
<p>a data.frame showing the parameter settings (in rows) and the input parameters se, sp, prev, NPV0, PPV0, NPVpower, PPVpower, trueNPV, truePPV</p>
</td></tr>
<tr><td><code>nlist</code></td>
<td>
<p> a list with an element for each parameter setting in OUTDAT, listing the results of <code><a href="#topic+nNPV">nNPV</a></code>, and <code><a href="#topic+nPPV">nPPV</a></code></p>
</td></tr>
<tr><td><code>NSETS</code></td>
<td>
<p> a single (integer), the number of parameter sets</p>
</td></tr>
<tr><td><code>nsteps</code></td>
<td>
<p> a single (integer), the number of steps in the range of proportions of true positives</p>
</td></tr>
<tr><td><code>rangeP</code></td>
<td>
<p>the input range of the proportion of true positives</p>
</td></tr>
<tr><td><code>propP</code></td>
<td>
<p>the resulting sequence of proportions of true positives considered</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negative predictive value in diagnostic research using case-control designs. Biostatistics 10,1, 94-105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotnPV">plotnPV</a></code> for showing the results in one graphic, and <code><a href="#topic+plotnPV">plotnPV</a></code> for showing the results in a set of subgraphics,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#Reproducing illustration in Section 3.4 and 4.2 of
#Steinberg et al. (2009)

FIG1&lt;-nPV(se=0.8, sp=0.95, prev=1/16, NPV0=0.98, PPV0=0.4,
 NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.01, 0.99), nsteps = 100, alpha = 0.05)

FIG1

DFIG1&lt;-as.data.frame(FIG1)

plot(x=DFIG1$propP, y=DFIG1[,2], ylim=c(0,2000), lty=1,  type="l",
 ylab="total sample size", xlab="proportion of true positives")
lines(x=DFIG1$propP, y=DFIG1[,3], lty=2 )

</code></pre>

<hr>
<h2 id='plotnPV'>
Plot experimental design for different setting in a single figure.
</h2><span id='topic+plotnPV'></span>

<h3>Description</h3>

<p>The function creates a plot from the results of the function <code>nPV</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotnPV(x, NPVpar = NULL, PPVpar = NULL, legpar = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotnPV_+3A_x">x</code></td>
<td>
<p> an object of class <code>"nPV"</code> as can be obtained by calling function <code><a href="#topic+nPV">nPV</a></code></p>
</td></tr>
<tr><td><code id="plotnPV_+3A_npvpar">NPVpar</code></td>
<td>
<p> a named list which specifies plot parameters for the negative predictive values, possible are <code>lty</code>, <code>lwd</code>, <code>col</code>, <code>pch</code> </p>
</td></tr>
<tr><td><code id="plotnPV_+3A_ppvpar">PPVpar</code></td>
<td>
<p> a named list which specifies plot parameters for the positive predictive values, possible are <code>lty</code>, <code>lwd</code>, <code>col</code>, <code>pch</code> </p>
</td></tr>
<tr><td><code id="plotnPV_+3A_legpar">legpar</code></td>
<td>
<p> a named list to pass arguments to the <code>legend</code>. See <code>?legend</code> for the possible arguments.</p>
</td></tr>
<tr><td><code id="plotnPV_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Required sample sizes for different experimental settings and prevalences, needed to achieve a prespecified power can be calculated in dependence of the proportion of true negative and true positive compounds in the validation set, using function <code><a href="#topic+nPV">nPV</a></code>. This function draws a plot with the proportion of positive on x and the total sample size on y, combining all parameter settings in one plot. Parameter settings my be distinguished by<code>lty</code>, <code>lwd</code>, <code>col</code>, <code>pch</code> in <code>NPVpar</code> and <code>PPVpar</code>. By default a legend is drawn which can be further modified in <code>legpar</code>.
</p>


<h3>Value</h3>

<p>A plot.</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negative predictive value in diagnostic research using case-control designs. Biostatistics 10, 1, 94-105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotnPV2">plotnPV2</a></code> for a plot with separate subplots for each parameter setting
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

TEST&lt;-nPV(se=c(0.9, 0.92, 0.94, 0.96, 0.98), sp=c(0.98, 0.96, 0.94, 0.92, 0.90),
 pr=0.12, NPV0=0.98, PPV0=0.4, NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.05, 0.95), nsteps = 100, alpha = 0.05)

plotnPV(TEST)

# plot parameters maybe introduced via ...
# the legend maybe modified via legpar:

plotnPV(TEST, log="y", legpar=list(x=0.6))

# own colour definitions
plotnPV(TEST, NPVpar=list(col=1:6, lwd=2, lty=1),
 PPVpar=list(col=1:6, lwd=2, lty=3))


</code></pre>

<hr>
<h2 id='plotnPV2'>Plot experimental design for different settings in a set of sub figure.</h2><span id='topic+plotnPV2'></span>

<h3>Description</h3>

<p>The function creates a plot from the results of the function <code><a href="#topic+nPV">nPV</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotnPV2(x, NPVlty = 1, PPVlty = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotnPV2_+3A_x">x</code></td>
<td>
<p> an object of class <code>"nPV"</code> as can be obtained by calling function <code><a href="#topic+nPV">nPV</a></code></p>
</td></tr>
<tr><td><code id="plotnPV2_+3A_npvlty">NPVlty</code></td>
<td>
<p>single integer value, the linetype for NPV sample size, see <code>par</code> for the options</p>
</td></tr>
<tr><td><code id="plotnPV2_+3A_ppvlty">PPVlty</code></td>
<td>
<p>single integer value, the linetype for PPV sample size, see <code>par</code> for the options</p>
</td></tr>
<tr><td><code id="plotnPV2_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code>plot</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Required sample sizes for different experimental settings and prevalences, needed to achieve a prespecified power can be calculated in dependence of the proportion of true negative and true positive compounds in the validation set, using function <code><a href="#topic+nPV">nPV</a></code>. This function draws a plot with the proportion of true positives on x and the total sample size on y, combining all parameter settings in one plot.
</p>
<p>Note that for huge numbers of setting this should not work.
</p>


<h3>Value</h3>

<p>A plot.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>References</h3>

<p><em>Steinberg DM, Fine J, Chappell R (2009).</em> Sample size for positive and negaitive predictiove value in diagnostic research using case-control designs. Biostatoistics 10, 1, 94-105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotnPV">plotnPV</a></code>, for sample sizes for several settings in one figure
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
TEST&lt;-nPV(se=c(0.9, 0.92, 0.94, 0.96, 0.98), sp=c(0.98, 0.96, 0.94, 0.92, 0.90),
 pr=0.12, NPV0=0.98, PPV0=0.4, NPVpower = 0.8, PPVpower = 0.8,
 rangeP = c(0.05, 0.95), nsteps = 20, alpha = 0.05)

plotnPV2(TEST, log="x")
</code></pre>

<hr>
<h2 id='print.BDtest'>
Detailed print out for BDtest
</h2><span id='topic+print.BDtest'></span>

<h3>Description</h3>

<p>Print details of the results of the function BDtest on the screen
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BDtest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BDtest_+3A_x">x</code></td>
<td>
<p> an object of class <code>"BDtest"</code></p>
</td></tr>
<tr><td><code id="print.BDtest_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>print</code> internally</p>
</td></tr>
</table>

<hr>
<h2 id='print.nPV'>Detailed print out for nPV</h2><span id='topic+print.nPV'></span>

<h3>Description</h3>

<p>Print details of the results of the experimental design function nPV on the screen</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nPV'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.nPV_+3A_x">x</code></td>
<td>
<p> an object of class <code>"nPV"</code></p>
</td></tr>
<tr><td><code id="print.nPV_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>print</code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+plotnPV">plotnPV</a></code>, <code><a href="#topic+plotnPV2">plotnPV2</a></code> to plot the results of <code>nPV</code>
</p>

<hr>
<h2 id='simPV'>
Simulate performance of confidence intervals for predictive values in a case-control design
</h2><span id='topic+simPV'></span>

<h3>Description</h3>

<p>The function draws data under the binomial assumption and computes the asymptotic confidence bounds (lower bounds only!) for the positive and negative predictive values.
Output are the power (probability to exclude NPV0/PPV0), the realized coverage probability, 0.1,0.2, and 0.5-quantiles of the realized distribution of confidence bounds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPV(se, sp, pr, n1, n0, NPV0, PPV0,
 conf.level = 0.95, NSIM = 500)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPV_+3A_se">se</code></td>
<td>
<p>a numeric value, specifying sensitivity</p>
</td></tr>
<tr><td><code id="simPV_+3A_sp">sp</code></td>
<td>
<p>a numeric value, specifying specitivity</p>
</td></tr>
<tr><td><code id="simPV_+3A_pr">pr</code></td>
<td>
<p>a numeric value, specifying prevalence</p>
</td></tr>
<tr><td><code id="simPV_+3A_n1">n1</code></td>
<td>
<p>an (integer) value, specifying the number of truely positive compounds in the trial</p>
</td></tr>
<tr><td><code id="simPV_+3A_n0">n0</code></td>
<td>
<p>an (integer) value, specifying the number of truely negative compounds in the trial</p>
</td></tr>
<tr><td><code id="simPV_+3A_npv0">NPV0</code></td>
<td>
<p>a numeric value, specifying the hypothesized negative predictive value (NPV assumed under H0)</p>
</td></tr>
<tr><td><code id="simPV_+3A_ppv0">PPV0</code></td>
<td>
<p>a numeric value, specifying the hypothesized positive predictive value (PPV assumed under H0)</p>
</td></tr>
<tr><td><code id="simPV_+3A_conf.level">conf.level</code></td>
<td>
<p>a numeric value, the confidence level</p>
</td></tr>
<tr><td><code id="simPV_+3A_nsim">NSIM</code></td>
<td>
<p>an (integer) value, the number of simulations to be run</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function draws data under the binomial assumption in a case-control design (Mercaldo et al. 2007), where the binomial doistributions are defined by n1, n0, se, sp. Then, for each drawn data set, the asymptotic lower confidence bounds (with confidence level=1-alpha, i.e. as suitable for a one-sided test at level alpha) for the positive and negative predictive values ar computed. (Note, that the standard logit interval is replaced by the adjusted logit interval of Mercaldo et al. 2007, if the standard logit interval is not defined.)
Output are the etsimated power (observed probability that NPV0/PPV0 are excluded by the lower confidence bound), the realized coverage probability (observed probability that the true NPV/PPV are included in their interval), as well as the 0.1, 0.2, and 0.5-quantiles of the realized distribution of confidence bounds.
</p>


<h3>Value</h3>

<p>A (2x7) matrix with results for NPV and PPV in rows 1,2 respectively, and the columns giving estimates of the power to reject H0: NPV&gt;=NPV0 / PPV&gt;=PPV0 (pow), coverage probability (cov), the values which are excluded with 10, 20 and 50 percent probability (q10, q20, q50), as well as the true predictive values and the marginn of H0 used to calculated power.
</p>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simPVmat">simPVmat</a></code> for the same function, allowing vector input for se, sp, pr, n1, n0, NPV0 and PPV0.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
simPV(se=0.8, sp=0.95, pr=1/16, n1=177, n0=554, NPV0=0.98, PPV0=0.4)

simPV(se=0.8, sp=0.95, pr=1/16, n1=181, n0=87, NPV0=0.98, PPV0=0.25)

</code></pre>

<hr>
<h2 id='simPVmat'>Simulate performance of confidence intervals for predictive values in case-control design</h2><span id='topic+simPVmat'></span>

<h3>Description</h3>

<p>Simulate the power (probability to exclude NPV0/PPV0), the coverage probability, and 0.1, 0.2, and 0.5-quantiles of the distribution of (lower!) asymptotic confidence bounds for predictive values. Different experimental setups may be compared. The function draws data under the binomial assumption and computes the asymptotic confidence bounds (lower bounds only!) for the positive and negative predictive values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPVmat(se, sp, pr, n1, n0, NPV0, PPV0,
 conf.level = 0.95, NSIM = 500, setnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPVmat_+3A_se">se</code></td>
<td>
<p>a (vector of) numeric value(s), specifying sensitivity</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_sp">sp</code></td>
<td>
<p>a (vector of) numeric value(s), specifying specitivity</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_pr">pr</code></td>
<td>
<p>a (vector of) numeric value(s), specifying prevalence</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_n1">n1</code></td>
<td>
<p>a (vector of integer) value(s), specifying the number of truely positive compounds in the trial</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_n0">n0</code></td>
<td>
<p>a (vector of integer) value(s), specifying the number of truely negative compounds in the trial</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_npv0">NPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the hypothesized negative predictive value (NPV assumed under H0)</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_ppv0">PPV0</code></td>
<td>
<p>a (vector of) numeric value(s), specifying the hypothesized positive predictive value (PPV assumed under H0)</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_conf.level">conf.level</code></td>
<td>
<p>a single numeric value, the confidence level</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_nsim">NSIM</code></td>
<td>
<p>a single (integer) value, the number of simulations to be run</p>
</td></tr>
<tr><td><code id="simPVmat_+3A_setnames">setnames</code></td>
<td>
<p>optional character vector to the parameter sets in the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector or single values in se, sp, pr, n1, n0, NPV0, PPV0 are put together (shorter vectors recycled to the length of longest vectors). Then each of the resulting parameter settings is simulated as described in <code><a href="#topic+simPV">simPV</a></code>
</p>


<h3>Value</h3>

<p>A list with elements
</p>
<table>
<tr><td><code>INDAT</code></td>
<td>
<p>a dataframe with rows showing the sets of parameters build from the input values and columns: se, sp, pr, NPV0, PPV0, n1, n0, n (total sample size)</p>
</td></tr>
<tr><td><code>NPV</code></td>
<td>
<p>a matrix with simulation results for the negative predictive value</p>
</td></tr>
<tr><td><code>PPV</code></td>
<td>
<p>a matrix with simulation results for the positive predictive value</p>
</td></tr>
<tr><td><code>NSIM</code></td>
<td>
<p>number of suimulations</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>nominal confidence level</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Schaarschmidt</p>


<h3>See Also</h3>

<p>This function is meantb to check small sample results obtained by the asymptotci formulas for experimental design from <code><a href="#topic+nPV">nPV</a></code>, <code><a href="#topic+nNPV">nNPV</a></code>, <code><a href="#topic+nPPV">nPPV</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
simPVmat(se=0.8, sp=0.95, pr=1/16,
 n1=c(177, 181), n0=c(554, 87), NPV0=0.98, PPV0=c(0.4, 0.25))


simPVmat(se=0.8, sp=0.95, pr=c(0.05,0.0625, 0.075, 0.1),
 n1=177, n0=554, NPV0=0.98, PPV0=0.4)



</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
