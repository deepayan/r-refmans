<!DOCTYPE html><html><head><title>Help for package tidyHeatmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidyHeatmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_annotation'><p>add_annotation</p></a></li>
<li><a href='#add_attr'><p>Add attribute to abject</p></a></li>
<li><a href='#add_bar'><p>Adds a bar annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#add_class'><p>Add class to abject</p></a></li>
<li><a href='#add_line'><p>Adds a line annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#add_point'><p>Adds a point annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#add_tile'><p>Adds a tile annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#annot_to_list'><p>annot_to_list</p></a></li>
<li><a href='#as_ComplexHeatmap'><p>Creates a  'ComplexHeatmap' object for less standard plot manipulation (e.g. changing legend position)</p></a></li>
<li><a href='#as_matrix'><p>Get matrix from tibble</p></a></li>
<li><a href='#check_if_counts_is_na'><p>Check whether there are NA counts</p></a></li>
<li><a href='#check_if_duplicated_genes'><p>Check whether there are duplicated genes/transcripts</p></a></li>
<li><a href='#check_if_wrong_input'><p>Check whether there are NA counts</p></a></li>
<li><a href='#drop_class'><p>Remove class to abject</p></a></li>
<li><a href='#error_if_log_transformed'><p>Check whether a numeric vector has been log transformed</p></a></li>
<li><a href='#get_abundance_norm_if_exists'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_elements'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_elements_features'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_elements_features_abundance'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_sample_counts'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_sample_transcript'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_sample_transcript_counts'><p>Get column names either from user or from attributes</p></a></li>
<li><a href='#get_x_y_annotation_columns'><p>get_x_y_annotation_columns</p></a></li>
<li><a href='#heatmap'><p>Creates a  'InputHeatmap' object from 'tbl_df' on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#ifelse_pipe'><p>This is a generalisation of ifelse that accepts an object and return an objects</p></a></li>
<li><a href='#ifelse2_pipe'><p>This is a generalisation of ifelse that accepts an object and return an objects</p></a></li>
<li><a href='#input_heatmap'><p>input_heatmap</p></a></li>
<li><a href='#layer_arrow_down'><p>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#layer_arrow_up'><p>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#layer_diamond'><p>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#layer_point'><p>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#layer_square'><p>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</p></a></li>
<li><a href='#N52'><p>Example data set N52</p></a></li>
<li><a href='#parse_formula'><p>.formula parser</p></a></li>
<li><a href='#pasilla'><p>Example data set Pasilla</p></a></li>
<li><a href='#prepend'><p>From rlang deprecated</p></a></li>
<li><a href='#quo_names'><p>Convert array of quosure (e.g. c(col_a, col_b)) into character vector</p></a></li>
<li><a href='#save_pdf'><p>Save plot on PDF file</p></a></li>
<li><a href='#save_pdf,Heatmap-method'><p>save_pdf</p></a></li>
<li><a href='#save_pdf,InputHeatmap-method'><p>save_pdf</p></a></li>
<li><a href='#scale_design'><p>Scale design matrix</p></a></li>
<li><a href='#scale_robust'><p>Scale counts in a robust way against sd == 0</p></a></li>
<li><a href='#select_closest_pairs'><p>Sub function of remove_redundancy_elements_though_reduced_dimensions</p></a></li>
<li><a href='#split_rows'><p>Split the heatmap row-wise depending on the biggest branches in the cladogram.</p></a></li>
<li><a href='#wrap_heatmap'><p>Wrap tidyHeatmap (ComplexHeatmap) in a patchwork-compliant patch</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>A Tidy Implementation of Heatmap</td>
</tr>
<tr>
<td>Version:</td>
<td>1.8.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stefano Mangiola &lt;mangiolastefano@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is a tidy implementation for heatmap.  At the
    moment it is based on the (great) package 'ComplexHeatmap'.  The goal
    of this package is to interface a tidy data frame with this powerful
    tool.  Some of the advantages are: Row and/or columns colour
    annotations are easy to integrate just specifying one parameter
    (column names).  Custom grouping of rows is easy to specify providing
    a grouped tbl. For example: df %&gt;% group_by(...).  Labels size
    adjusted by row and column total number.  Default use of Brewer and
    Viridis palettes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>,
<a href="https://github.com/stemangiola/tidyHeatmap">https://github.com/stemangiola/tidyHeatmap</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stemangiola/tidyHeatmap">https://github.com/stemangiola/tidyHeatmap</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, utils, dplyr (&ge; 0.8.5), magrittr (&ge; 1.5),
tidyr (&ge; 1.0.3), rlang (&ge; 0.4.5), purrr (&ge; 0.3.3), tibble,
ComplexHeatmap (&ge; 2.2.0), viridis (&ge; 0.5.1), circlize (&ge;
0.4.8), RColorBrewer (&ge; 1.1), grid, grDevices, lifecycle (&ge;
0.2.0), dendextend, patchwork</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat, vdiffr, BiocManager, knitr, rmarkdown,
qpdf, covr, roxygen2, forcats, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>lifecycle</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>biocViews:</td>
<td>AssayDomain, Infrastructure</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-20 03:14:40 UTC; mangiola.s</td>
</tr>
<tr>
<td>Author:</td>
<td>Stefano Mangiola [aut, cre],
  Anthony Papenfuss [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-20 07:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_annotation'>add_annotation</h2><span id='topic+add_annotation'></span>

<h3>Description</h3>

<p>add_annotation() takes a tbl object and easily produces a ComplexHeatmap plot, with integration with tibble and dplyr frameworks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_annotation(
  my_input_heatmap,
  annotation,
  type = rep("tile", length(quo_names(annotation))),
  palette_discrete = list(),
  palette_continuous = list(),
  size = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_annotation_+3A_my_input_heatmap">my_input_heatmap</code></td>
<td>
<p>A 'InputHeatmap' formatted as | &lt;SAMPLE&gt; | &lt;TRANSCRIPT&gt; | &lt;COUNT&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_annotation">annotation</code></td>
<td>
<p>Vector of quotes</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_type">type</code></td>
<td>
<p>A character vector of the set c(\&quot;tile\&quot;, \&quot;point\&quot;, \&quot;bar\&quot;, \&quot;line\&quot;)</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_palette_discrete">palette_discrete</code></td>
<td>
<p>A list of character vectors. This is the list of palettes that will be used for horizontal and vertical discrete annotations. The discrete classification of annotations depends on the column type of your input tibble (e.g., character and factor).</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_palette_continuous">palette_continuous</code></td>
<td>
<p>A list of character vectors. This is the list of palettes that will be used for horizontal and vertical continuous annotations. The continuous classification of annotations depends on the column type of your input tibble (e.g., integer, numerical, double).</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_size">size</code></td>
<td>
<p>A grid::unit object, e.g. unit(2, &quot;cm&quot;). This is the height or width of the annotation depending on the orientation.</p>
</td></tr>
<tr><td><code id="add_annotation_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to top_annotation or left_annotation of the ComplexHeatmap container</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be added.
</p>


<h3>Value</h3>

<p>A 'ComplexHeatmap' object
</p>

<hr>
<h2 id='add_attr'>Add attribute to abject</h2><span id='topic+add_attr'></span>

<h3>Description</h3>

<p>Add attribute to abject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_attr(var, attribute, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_attr_+3A_var">var</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="add_attr_+3A_attribute">attribute</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="add_attr_+3A_name">name</code></td>
<td>
<p>A character name of the attribute</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with an additional attribute
</p>

<hr>
<h2 id='add_bar'>Adds a bar annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+add_bar'></span><span id='topic+add_bar+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>add_bar() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_bar(.data, .column, palette = NULL, size = NULL, ...)

## S4 method for signature 'InputHeatmap'
add_bar(.data, .column, palette = NULL, size = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_bar_+3A_.data">.data</code></td>
<td>
<p>A 'tbl_df' formatted as | &lt;ELEMENT&gt; | &lt;FEATURE&gt; | &lt;VALUE&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="add_bar_+3A_.column">.column</code></td>
<td>
<p>Vector of quotes</p>
</td></tr>
<tr><td><code id="add_bar_+3A_palette">palette</code></td>
<td>
<p>A character vector of colors, or a function such as colorRamp2 (see examples).</p>
</td></tr>
<tr><td><code id="add_bar_+3A_size">size</code></td>
<td>
<p>A grid::unit object, e.g. unit(2, &quot;cm&quot;). This is the height or width of the annotation depending on the orientation.</p>
</td></tr>
<tr><td><code id="add_bar_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to top_annotation or left_annotation of the ComplexHeatmap container</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% add_bar(inflection)


</code></pre>

<hr>
<h2 id='add_class'>Add class to abject</h2><span id='topic+add_class'></span>

<h3>Description</h3>

<p>Add class to abject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_class(var, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_class_+3A_var">var</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="add_class_+3A_name">name</code></td>
<td>
<p>A character name of the attribute</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with an additional attribute
</p>

<hr>
<h2 id='add_line'>Adds a line annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+add_line'></span><span id='topic+add_line+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>add_line() from a 'InputHeatmap' object, adds a line annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_line(.data, .column, palette = NULL, size = NULL, ...)

## S4 method for signature 'InputHeatmap'
add_line(.data, .column, palette = NULL, size = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_line_+3A_.data">.data</code></td>
<td>
<p>A 'tbl_df' formatted as | &lt;ELEMENT&gt; | &lt;FEATURE&gt; | &lt;VALUE&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="add_line_+3A_.column">.column</code></td>
<td>
<p>Vector of quotes</p>
</td></tr>
<tr><td><code id="add_line_+3A_palette">palette</code></td>
<td>
<p>A character vector of colors, or a function such as colorRamp2 (see examples).</p>
</td></tr>
<tr><td><code id="add_line_+3A_size">size</code></td>
<td>
<p>A grid::unit object, e.g. unit(2, &quot;cm&quot;). This is the height or width of the annotation depending on the orientation.</p>
</td></tr>
<tr><td><code id="add_line_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to top_annotation or left_annotation of the ComplexHeatmap container</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% add_line(inflection)


</code></pre>

<hr>
<h2 id='add_point'>Adds a point annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+add_point'></span><span id='topic+add_point+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>add_point() from a 'InputHeatmap' object, adds a point annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_point(.data, .column, palette = NULL, size = NULL, ...)

## S4 method for signature 'InputHeatmap'
add_point(.data, .column, palette = NULL, size = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_point_+3A_.data">.data</code></td>
<td>
<p>A 'tbl_df' formatted as | &lt;ELEMENT&gt; | &lt;FEATURE&gt; | &lt;VALUE&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="add_point_+3A_.column">.column</code></td>
<td>
<p>Vector of quotes</p>
</td></tr>
<tr><td><code id="add_point_+3A_palette">palette</code></td>
<td>
<p>A character vector of colors, or a function such as colorRamp2 (see examples).</p>
</td></tr>
<tr><td><code id="add_point_+3A_size">size</code></td>
<td>
<p>A grid::unit object, e.g. unit(2, &quot;cm&quot;). This is the height or width of the annotation depending on the orientation.</p>
</td></tr>
<tr><td><code id="add_point_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to top_annotation or left_annotation of the ComplexHeatmap container</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% add_point(inflection)


</code></pre>

<hr>
<h2 id='add_tile'>Adds a tile annotation layer to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+add_tile'></span><span id='topic+add_tile+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>add_tile() from a 'InputHeatmap' object, adds a tile annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_tile(.data, .column, palette = NULL, size = NULL, ...)

## S4 method for signature 'InputHeatmap'
add_tile(.data, .column, palette = NULL, size = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_tile_+3A_.data">.data</code></td>
<td>
<p>A 'tbl_df' formatted as | &lt;ELEMENT&gt; | &lt;FEATURE&gt; | &lt;VALUE&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="add_tile_+3A_.column">.column</code></td>
<td>
<p>Vector of quotes</p>
</td></tr>
<tr><td><code id="add_tile_+3A_palette">palette</code></td>
<td>
<p>A character vector of colors, or a function such as colorRamp2 (see examples).</p>
</td></tr>
<tr><td><code id="add_tile_+3A_size">size</code></td>
<td>
<p>A grid::unit object, e.g. unit(2, &quot;cm&quot;). This is the height or width of the annotation depending on the orientation.</p>
</td></tr>
<tr><td><code id="add_tile_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to top_annotation or left_annotation of the ComplexHeatmap container</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% add_tile(CAPRA_TOTAL)


hm %&gt;% add_tile(inflection, palette = circlize::colorRamp2(c(0, 3,10), c("white", "green", "red")))

</code></pre>

<hr>
<h2 id='annot_to_list'>annot_to_list</h2><span id='topic+annot_to_list'></span>

<h3>Description</h3>

<p>annot_to_list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annot_to_list(.data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annot_to_list_+3A_.data">.data</code></td>
<td>
<p>A data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>

<hr>
<h2 id='as_ComplexHeatmap'>Creates a  'ComplexHeatmap' object for less standard plot manipulation (e.g. changing legend position)</h2><span id='topic+as_ComplexHeatmap'></span><span id='topic+as_ComplexHeatmap+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>as_ComplexHeatmap() takes a 'InputHeatmap' object and produces a 'Heatmap' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_ComplexHeatmap(tidyHeatmap)

## S4 method for signature 'InputHeatmap'
as_ComplexHeatmap(tidyHeatmap)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_ComplexHeatmap_+3A_tidyheatmap">tidyHeatmap</code></td>
<td>
<p>A 'InputHeatmap' object from tidyHeatmap::heatmap() call</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>


<h3>Value</h3>

<p>A 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

tidyHeatmap::N52 |&gt;
tidyHeatmap::heatmap(
 .row = symbol_ct,
 .column = UBR,
 .value = `read count normalised log`,
) |&gt;
as_ComplexHeatmap()

</code></pre>

<hr>
<h2 id='as_matrix'>Get matrix from tibble</h2><span id='topic+as_matrix'></span>

<h3>Description</h3>

<p>Get matrix from tibble
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_matrix(tbl, rownames = NULL, do_check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_matrix_+3A_tbl">tbl</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="as_matrix_+3A_rownames">rownames</code></td>
<td>
<p>A character string of the rownames</p>
</td></tr>
<tr><td><code id="as_matrix_+3A_do_check">do_check</code></td>
<td>
<p>A boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='check_if_counts_is_na'>Check whether there are NA counts</h2><span id='topic+check_if_counts_is_na'></span>

<h3>Description</h3>

<p>Check whether there are NA counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_if_counts_is_na(.data, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_if_counts_is_na_+3A_.data">.data</code></td>
<td>
<p>A tibble of read counts</p>
</td></tr>
<tr><td><code id="check_if_counts_is_na_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the read count column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tbl
</p>

<hr>
<h2 id='check_if_duplicated_genes'>Check whether there are duplicated genes/transcripts</h2><span id='topic+check_if_duplicated_genes'></span>

<h3>Description</h3>

<p>Check whether there are duplicated genes/transcripts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_if_duplicated_genes(.data, .sample, .transcript, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_if_duplicated_genes_+3A_.data">.data</code></td>
<td>
<p>A tibble of read counts</p>
</td></tr>
<tr><td><code id="check_if_duplicated_genes_+3A_.sample">.sample</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="check_if_duplicated_genes_+3A_.transcript">.transcript</code></td>
<td>
<p>A character name of the transcript/gene column</p>
</td></tr>
<tr><td><code id="check_if_duplicated_genes_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the read count column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tbl
</p>

<hr>
<h2 id='check_if_wrong_input'>Check whether there are NA counts</h2><span id='topic+check_if_wrong_input'></span>

<h3>Description</h3>

<p>Check whether there are NA counts
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_if_wrong_input(.data, list_input, expected_type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_if_wrong_input_+3A_.data">.data</code></td>
<td>
<p>A tibble of read counts</p>
</td></tr>
<tr><td><code id="check_if_wrong_input_+3A_list_input">list_input</code></td>
<td>
<p>A list</p>
</td></tr>
<tr><td><code id="check_if_wrong_input_+3A_expected_type">expected_type</code></td>
<td>
<p>A character string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tbl
</p>

<hr>
<h2 id='drop_class'>Remove class to abject</h2><span id='topic+drop_class'></span>

<h3>Description</h3>

<p>Remove class to abject
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop_class(var, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_class_+3A_var">var</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="drop_class_+3A_name">name</code></td>
<td>
<p>A character name of the class</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with an additional attribute
</p>

<hr>
<h2 id='error_if_log_transformed'>Check whether a numeric vector has been log transformed</h2><span id='topic+error_if_log_transformed'></span>

<h3>Description</h3>

<p>Check whether a numeric vector has been log transformed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>error_if_log_transformed(x, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="error_if_log_transformed_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="error_if_log_transformed_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the transcript/gene abundance column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NA
</p>

<hr>
<h2 id='get_abundance_norm_if_exists'>Get column names either from user or from attributes</h2><span id='topic+get_abundance_norm_if_exists'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_abundance_norm_if_exists(.data, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_abundance_norm_if_exists_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_abundance_norm_if_exists_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the abundance column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_elements'>Get column names either from user or from attributes</h2><span id='topic+get_elements'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_elements(.data, .element, of_samples = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_elements_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_elements_+3A_.element">.element</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_elements_+3A_of_samples">of_samples</code></td>
<td>
<p>A boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_elements_features'>Get column names either from user or from attributes</h2><span id='topic+get_elements_features'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_elements_features(.data, .element, .feature, of_samples = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_elements_features_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_elements_features_+3A_.element">.element</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_elements_features_+3A_.feature">.feature</code></td>
<td>
<p>A character name of the transcript/gene column</p>
</td></tr>
<tr><td><code id="get_elements_features_+3A_of_samples">of_samples</code></td>
<td>
<p>A boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_elements_features_abundance'>Get column names either from user or from attributes</h2><span id='topic+get_elements_features_abundance'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_elements_features_abundance(
  .data,
  .element,
  .feature,
  .abundance,
  of_samples = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_elements_features_abundance_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_elements_features_abundance_+3A_.element">.element</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_elements_features_abundance_+3A_.feature">.feature</code></td>
<td>
<p>A character name of the transcript/gene column</p>
</td></tr>
<tr><td><code id="get_elements_features_abundance_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the read count column</p>
</td></tr>
<tr><td><code id="get_elements_features_abundance_+3A_of_samples">of_samples</code></td>
<td>
<p>A boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_sample_counts'>Get column names either from user or from attributes</h2><span id='topic+get_sample_counts'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sample_counts(.data, .sample, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sample_counts_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_sample_counts_+3A_.sample">.sample</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_sample_counts_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the read count column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_sample_transcript'>Get column names either from user or from attributes</h2><span id='topic+get_sample_transcript'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sample_transcript(.data, .sample, .transcript)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sample_transcript_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_sample_transcript_+3A_.sample">.sample</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_sample_transcript_+3A_.transcript">.transcript</code></td>
<td>
<p>A character name of the transcript/gene column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_sample_transcript_counts'>Get column names either from user or from attributes</h2><span id='topic+get_sample_transcript_counts'></span>

<h3>Description</h3>

<p>Get column names either from user or from attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_sample_transcript_counts(.data, .sample, .transcript, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_sample_transcript_counts_+3A_.data">.data</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="get_sample_transcript_counts_+3A_.sample">.sample</code></td>
<td>
<p>A character name of the sample column</p>
</td></tr>
<tr><td><code id="get_sample_transcript_counts_+3A_.transcript">.transcript</code></td>
<td>
<p>A character name of the transcript/gene column</p>
</td></tr>
<tr><td><code id="get_sample_transcript_counts_+3A_.abundance">.abundance</code></td>
<td>
<p>A character name of the read count column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of column enquo or error
</p>

<hr>
<h2 id='get_x_y_annotation_columns'>get_x_y_annotation_columns</h2><span id='topic+get_x_y_annotation_columns'></span>

<h3>Description</h3>

<p>get_x_y_annotation_columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_x_y_annotation_columns(.data, .column, .row, .abundance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_x_y_annotation_columns_+3A_.data">.data</code></td>
<td>
<p>A 'tbl' formatted as | &lt;SAMPLE&gt; | &lt;TRANSCRIPT&gt; | &lt;COUNT&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="get_x_y_annotation_columns_+3A_.column">.column</code></td>
<td>
<p>The name of the column horizontally presented in the heatmap</p>
</td></tr>
<tr><td><code id="get_x_y_annotation_columns_+3A_.row">.row</code></td>
<td>
<p>The name of the column vertically presented in the heatmap</p>
</td></tr>
<tr><td><code id="get_x_y_annotation_columns_+3A_.abundance">.abundance</code></td>
<td>
<p>The name of the transcript/gene abundance column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>

<hr>
<h2 id='heatmap'>Creates a  'InputHeatmap' object from 'tbl_df' on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+heatmap'></span><span id='topic+heatmap_'></span><span id='topic+heatmap+2Ctbl-method'></span><span id='topic+heatmap+2Ctbl_df-method'></span>

<h3>Description</h3>

<p>heatmap() takes a tbl object and easily produces a ComplexHeatmap plot, with integration with tibble and dplyr frameworks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap(
  .data,
  .row,
  .column,
  .value,
  transform = NULL,
  scale = "none",
  palette_value = c("#440154FF", "#21908CFF", "#fefada"),
  palette_grouping = list(),
  .scale = NULL,
  ...
)

heatmap_(
  .data,
  .row,
  .column,
  .value,
  transform = NULL,
  scale = "none",
  palette_value = c("#440154FF", "#21908CFF", "#fefada"),
  palette_grouping = list(),
  .scale = NULL,
  ...
)

## S4 method for signature 'tbl'
heatmap(
  .data,
  .row,
  .column,
  .value,
  transform = NULL,
  scale = "none",
  palette_value = c("#440154FF", "#21908CFF", "#fefada"),
  palette_grouping = list(),
  .scale = NULL,
  ...
)

## S4 method for signature 'tbl_df'
heatmap(
  .data,
  .row,
  .column,
  .value,
  transform = NULL,
  scale = "none",
  palette_value = c("#440154FF", "#21908CFF", "#fefada"),
  palette_grouping = list(),
  .scale = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_+3A_.data">.data</code></td>
<td>
<p>A 'tbl_df' formatted as | &lt;ELEMENT&gt; | &lt;FEATURE&gt; | &lt;VALUE&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="heatmap_+3A_.row">.row</code></td>
<td>
<p>The name of the column vertically presented in the heatmap</p>
</td></tr>
<tr><td><code id="heatmap_+3A_.column">.column</code></td>
<td>
<p>The name of the column horizontally presented in the heatmap</p>
</td></tr>
<tr><td><code id="heatmap_+3A_.value">.value</code></td>
<td>
<p>The name of the column for the value of the element/feature pair</p>
</td></tr>
<tr><td><code id="heatmap_+3A_transform">transform</code></td>
<td>
<p>A function, used to transform .value row-wise (e.g., transform = log1p)</p>
</td></tr>
<tr><td><code id="heatmap_+3A_scale">scale</code></td>
<td>
<p>A character string. Possible values are c(\&quot;none\&quot;, \&quot;row\&quot;, \&quot;column\&quot;, \&quot;both\&quot;)</p>
</td></tr>
<tr><td><code id="heatmap_+3A_palette_value">palette_value</code></td>
<td>
<p>A character vector This is the palette that will be used as gradient for .value. For example c(&quot;red&quot;, &quot;white&quot;, &quot;blue&quot;). For higher flexibility you can use circlize::colorRamp2\(c\(-2, -1, 0, 1, 2\), viridis::magma\(5\)\)</p>
</td></tr>
<tr><td><code id="heatmap_+3A_palette_grouping">palette_grouping</code></td>
<td>
<p>A list of character vectors. This is the list of palettes that will be used for grouping. For example list(RColorBrewer::brewer.pal(8, &quot;Accent&quot;)) or list(c(&quot;#B3E2CD&quot;, &quot;#FDCDAC&quot;, &quot;#CBD5E8&quot;)) or list(c(&quot;black&quot;, &quot;red&quot;))</p>
</td></tr>
<tr><td><code id="heatmap_+3A_.scale">.scale</code></td>
<td>
<p>DEPRECATED. please use scale instead \( with no dot prefix \).</p>
</td></tr>
<tr><td><code id="heatmap_+3A_...">...</code></td>
<td>
<p>The arguments that will be passed to the Heatmap function of ComplexHeatmap backend</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>This function takes a tbl as an input and creates a 'ComplexHeatmap' plot. The information is stored in a 'InputHeatmap' object that is updated along the pipe statement, for example adding annotation layers.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' objects that gets evaluated to a 'ComplexHeatmap' object
</p>
<p>A 'InputHeatmap' object
</p>
<p>A 'InputHeatmap' object
</p>
<p>A 'InputHeatmap' object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

tidyHeatmap::N52 %&gt;%
group_by( `Cell type`) %&gt;%
tidyHeatmap::heatmap(
 .row = symbol_ct,
 .column = UBR,
 .value = `read count normalised log`,
)

</code></pre>

<hr>
<h2 id='ifelse_pipe'>This is a generalisation of ifelse that accepts an object and return an objects</h2><span id='topic+ifelse_pipe'></span>

<h3>Description</h3>

<p>This is a generalisation of ifelse that accepts an object and return an objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifelse_pipe(.x, .p, .f1, .f2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifelse_pipe_+3A_.x">.x</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="ifelse_pipe_+3A_.p">.p</code></td>
<td>
<p>A boolean</p>
</td></tr>
<tr><td><code id="ifelse_pipe_+3A_.f1">.f1</code></td>
<td>
<p>A function</p>
</td></tr>
<tr><td><code id="ifelse_pipe_+3A_.f2">.f2</code></td>
<td>
<p>A function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble
</p>

<hr>
<h2 id='ifelse2_pipe'>This is a generalisation of ifelse that accepts an object and return an objects</h2><span id='topic+ifelse2_pipe'></span>

<h3>Description</h3>

<p>This is a generalisation of ifelse that accepts an object and return an objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ifelse2_pipe(.x, .p1, .p2, .f1, .f2, .f3 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ifelse2_pipe_+3A_.x">.x</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="ifelse2_pipe_+3A_.p1">.p1</code></td>
<td>
<p>A boolean</p>
</td></tr>
<tr><td><code id="ifelse2_pipe_+3A_.p2">.p2</code></td>
<td>
<p>ELSE IF condition</p>
</td></tr>
<tr><td><code id="ifelse2_pipe_+3A_.f1">.f1</code></td>
<td>
<p>A function</p>
</td></tr>
<tr><td><code id="ifelse2_pipe_+3A_.f2">.f2</code></td>
<td>
<p>A function</p>
</td></tr>
<tr><td><code id="ifelse2_pipe_+3A_.f3">.f3</code></td>
<td>
<p>A function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble
</p>

<hr>
<h2 id='input_heatmap'>input_heatmap</h2><span id='topic+input_heatmap'></span>

<h3>Description</h3>

<p>input_heatmap() takes a tbl object and easily produces a ComplexHeatmap plot, with integration with tibble and dplyr frameworks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>input_heatmap(
  .data,
  .horizontal,
  .vertical,
  .abundance,
  transform = NULL,
  scale = "none",
  palette_value = c("#440154FF", "#21908CFF", "#fefada"),
  palette_grouping = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="input_heatmap_+3A_.data">.data</code></td>
<td>
<p>A 'tbl' formatted as | &lt;SAMPLE&gt; | &lt;TRANSCRIPT&gt; | &lt;COUNT&gt; | &lt;...&gt; |</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_.horizontal">.horizontal</code></td>
<td>
<p>The name of the column horizontally presented in the heatmap</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_.vertical">.vertical</code></td>
<td>
<p>The name of the column vertically presented in the heatmap</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_.abundance">.abundance</code></td>
<td>
<p>The name of the transcript/gene abundance column</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_transform">transform</code></td>
<td>
<p>A function, used to transform .value, for example log1p</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_scale">scale</code></td>
<td>
<p>A character string. Possible values are c(\&quot;none\&quot;, \&quot;row\&quot;, \&quot;column\&quot;, \&quot;both\&quot;)</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_palette_value">palette_value</code></td>
<td>
<p>A character vector, or a function for higher customisation (colorRamp2). This is the palette that will be used as gradient for abundance. If palette_value is a vector of hexadecimal colours, it should have 3 values. If you want more customisation, you can pass to palette_value a function, that is derived as for example 'colorRamp2(c(-2, 0, 2), palette_value)'</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_palette_grouping">palette_grouping</code></td>
<td>
<p>A list of character vectors. This is the list of palettes that will be used for grouping</p>
</td></tr>
<tr><td><code id="input_heatmap_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed to ComplexHeatmap::Heatmap</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To be added.
</p>


<h3>Value</h3>

<p>A 'ComplexHeatmap' object
</p>

<hr>
<h2 id='layer_arrow_down'>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+layer_arrow_down'></span><span id='topic+layer_arrow_down+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>layer_arrow_down() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_arrow_down(.data, ...)

## S4 method for signature 'InputHeatmap'
layer_arrow_down(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_arrow_down_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="layer_arrow_down_+3A_...">...</code></td>
<td>
<p>Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% layer_arrow_down()


</code></pre>

<hr>
<h2 id='layer_arrow_up'>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+layer_arrow_up'></span><span id='topic+layer_arrow_up+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>layer_arrow_up() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_arrow_up(.data, ...)

## S4 method for signature 'InputHeatmap'
layer_arrow_up(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_arrow_up_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="layer_arrow_up_+3A_...">...</code></td>
<td>
<p>Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% layer_arrow_up()


</code></pre>

<hr>
<h2 id='layer_diamond'>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+layer_diamond'></span><span id='topic+layer_diamond+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>layer_diamond() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_diamond(.data, ...)

## S4 method for signature 'InputHeatmap'
layer_diamond(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_diamond_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="layer_diamond_+3A_...">...</code></td>
<td>
<p>Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% layer_diamond()


</code></pre>

<hr>
<h2 id='layer_point'>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+layer_point'></span><span id='topic+layer_point+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>layer_point() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_point(.data, ...)

## S4 method for signature 'InputHeatmap'
layer_point(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_point_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="layer_point_+3A_...">...</code></td>
<td>
<p>Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% layer_point()


</code></pre>

<hr>
<h2 id='layer_square'>Adds a layers of symbols above the heatmap tiles to a 'InputHeatmap', that on evaluation creates a 'ComplexHeatmap'</h2><span id='topic+layer_square'></span><span id='topic+layer_square+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>layer_square() from a 'InputHeatmap' object, adds a bar annotation layer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>layer_square(.data, ...)

## S4 method for signature 'InputHeatmap'
layer_square(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="layer_square_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="layer_square_+3A_...">...</code></td>
<td>
<p>Expressions that return a logical value, and are defined in terms of the variables in .data. If multiple expressions are included, they are combined with the &amp; operator. Only rows for which all conditions evaluate to TRUE are kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% layer_square()


</code></pre>

<hr>
<h2 id='N52'>Example data set N52</h2><span id='topic+N52'></span>

<h3>Description</h3>

<p>Example data set N52
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N52
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 520 rows and 15 columns.
</p>

<hr>
<h2 id='parse_formula'>.formula parser</h2><span id='topic+parse_formula'></span>

<h3>Description</h3>

<p>.formula parser
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_formula(fm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_formula_+3A_fm">fm</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector
</p>

<hr>
<h2 id='pasilla'>Example data set Pasilla</h2><span id='topic+pasilla'></span>

<h3>Description</h3>

<p>Example data set Pasilla
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pasilla
</code></pre>


<h3>Format</h3>

<p>An object of class <code>tbl_df</code> (inherits from <code>tbl</code>, <code>data.frame</code>) with 504 rows and 8 columns.
</p>

<hr>
<h2 id='prepend'>From rlang deprecated</h2><span id='topic+prepend'></span>

<h3>Description</h3>

<p>From rlang deprecated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepend(x, values, before = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prepend_+3A_x">x</code></td>
<td>
<p>An array</p>
</td></tr>
<tr><td><code id="prepend_+3A_values">values</code></td>
<td>
<p>An array</p>
</td></tr>
<tr><td><code id="prepend_+3A_before">before</code></td>
<td>
<p>A boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array
</p>

<hr>
<h2 id='quo_names'>Convert array of quosure (e.g. c(col_a, col_b)) into character vector</h2><span id='topic+quo_names'></span>

<h3>Description</h3>

<p>Convert array of quosure (e.g. c(col_a, col_b)) into character vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quo_names(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quo_names_+3A_v">v</code></td>
<td>
<p>A array of quosures (e.g. c(col_a, col_b))</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector
</p>

<hr>
<h2 id='save_pdf'>Save plot on PDF file</h2><span id='topic+save_pdf'></span>

<h3>Description</h3>

<p>save_pdf() takes as input a Heatmap from ComplexHeatmap and save it to PDF file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_pdf(
  .heatmap,
  filename,
  width = NULL,
  height = NULL,
  units = c("in", "cm", "mm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_pdf_+3A_.heatmap">.heatmap</code></td>
<td>
<p>A 'Heatmap'</p>
</td></tr>
<tr><td><code id="save_pdf_+3A_filename">filename</code></td>
<td>
<p>A character string. The name of the output file/path</p>
</td></tr>
<tr><td><code id="save_pdf_+3A_width">width</code></td>
<td>
<p>A 'double'. Plot width</p>
</td></tr>
<tr><td><code id="save_pdf_+3A_height">height</code></td>
<td>
<p>A 'double'. Plot height</p>
</td></tr>
<tr><td><code id="save_pdf_+3A_units">units</code></td>
<td>
<p>A character string. units (&quot;in&quot;, &quot;cm&quot;, or &quot;mm&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It simply save an 'Heatmap' to a PDF file use pdf() function in the back end
</p>


<h3>Value</h3>

<p>NA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(dplyr)
	tidyHeatmap::heatmap(
  dplyr::group_by(tidyHeatmap::pasilla,		location, type),
  .column = sample,
  .row = symbol,
  .value = `count normalised adjusted`,
 ) %&gt;%
 save_pdf(tempfile())


</code></pre>

<hr>
<h2 id='save_pdf+2CHeatmap-method'>save_pdf</h2><span id='topic+save_pdf+2CHeatmap-method'></span>

<h3>Description</h3>

<p>save_pdf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'Heatmap'
save_pdf(
  .heatmap,
  filename,
  width = NULL,
  height = NULL,
  units = c("in", "cm", "mm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_pdf+2B2CHeatmap-method_+3A_.heatmap">.heatmap</code></td>
<td>
<p>A 'Heatmap'</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CHeatmap-method_+3A_filename">filename</code></td>
<td>
<p>A character string. The name of the output file/path</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CHeatmap-method_+3A_width">width</code></td>
<td>
<p>A 'double'. Plot width</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CHeatmap-method_+3A_height">height</code></td>
<td>
<p>A 'double'. Plot height</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CHeatmap-method_+3A_units">units</code></td>
<td>
<p>A character string. units (&quot;in&quot;, &quot;cm&quot;, or &quot;mm&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='save_pdf+2CInputHeatmap-method'>save_pdf</h2><span id='topic+save_pdf+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>save_pdf
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'InputHeatmap'
save_pdf(
  .heatmap,
  filename,
  width = NULL,
  height = NULL,
  units = c("in", "cm", "mm")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_pdf+2B2CInputHeatmap-method_+3A_.heatmap">.heatmap</code></td>
<td>
<p>A 'Heatmap'</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CInputHeatmap-method_+3A_filename">filename</code></td>
<td>
<p>A character string. The name of the output file/path</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CInputHeatmap-method_+3A_width">width</code></td>
<td>
<p>A 'double'. Plot width</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CInputHeatmap-method_+3A_height">height</code></td>
<td>
<p>A 'double'. Plot height</p>
</td></tr>
<tr><td><code id="save_pdf+2B2CInputHeatmap-method_+3A_units">units</code></td>
<td>
<p>A character string. units (&quot;in&quot;, &quot;cm&quot;, or &quot;mm&quot;)</p>
</td></tr>
</table>

<hr>
<h2 id='scale_design'>Scale design matrix</h2><span id='topic+scale_design'></span>

<h3>Description</h3>

<p>Scale design matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_design(df, .formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_design_+3A_df">df</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="scale_design_+3A_.formula">.formula</code></td>
<td>
<p>a formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble
</p>

<hr>
<h2 id='scale_robust'>Scale counts in a robust way against sd == 0</h2><span id='topic+scale_robust'></span>

<h3>Description</h3>

<p>Scale counts in a robust way against sd == 0
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_robust(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_robust_+3A_y">y</code></td>
<td>
<p>A numerical array</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scaled and centred numerical array
</p>

<hr>
<h2 id='select_closest_pairs'>Sub function of remove_redundancy_elements_though_reduced_dimensions</h2><span id='topic+select_closest_pairs'></span>

<h3>Description</h3>

<p>Sub function of remove_redundancy_elements_though_reduced_dimensions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_closest_pairs(df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_closest_pairs_+3A_df">df</code></td>
<td>
<p>A tibble</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with pairs to drop
</p>

<hr>
<h2 id='split_rows'>Split the heatmap row-wise depending on the biggest branches in the cladogram.</h2><span id='topic+split_rows'></span><span id='topic+split_rows+2CInputHeatmap-method'></span><span id='topic+split_columns'></span><span id='topic+split_columns+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>split_rows() from a 'InputHeatmap' object, split the row cladogram.
</p>
<p>split_columns() from a 'InputHeatmap' object, split the column cladogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>split_rows(.data, number_of_groups)

## S4 method for signature 'InputHeatmap'
split_rows(.data, number_of_groups)

split_columns(.data, number_of_groups)

## S4 method for signature 'InputHeatmap'
split_columns(.data, number_of_groups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="split_rows_+3A_.data">.data</code></td>
<td>
<p>A 'InputHeatmap'</p>
</td></tr>
<tr><td><code id="split_rows_+3A_number_of_groups">number_of_groups</code></td>
<td>
<p>An integer. The number of groups to split the cladogram into.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>
<p>It uses 'ComplexHeatmap' as visualisation tool.
</p>


<h3>Value</h3>

<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>
<p>A 'InputHeatmap' object that gets evaluated to a 'ComplexHeatmap'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% split_rows(2)


library(dplyr)

hm = 
  tidyHeatmap::N52 %&gt;%
  tidyHeatmap::heatmap(
    .row = symbol_ct,
    .column = UBR,
    .value = `read count normalised log`
)

hm %&gt;% split_columns(2)

</code></pre>

<hr>
<h2 id='wrap_heatmap'>Wrap tidyHeatmap (ComplexHeatmap) in a patchwork-compliant patch</h2><span id='topic+wrap_heatmap'></span><span id='topic+wrap_heatmap+2CInputHeatmap-method'></span>

<h3>Description</h3>

<p>In order to add tidyHeatmap (ComplexHeatmap) element to a patchwork they can be
converted to a compliant representation using the 'wrap_heatmap()' function.
This allows you to position either grobs, ggplot objects, patchwork
objects, or even base graphics (if passed as a formula) in either the full
area, the full plotting area (anything between and
including the axis label), or the panel area (only the actual area where data
is drawn).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrap_heatmap(
  panel = NULL,
  plot = NULL,
  full = NULL,
  clip = TRUE,
  ignore_tag = FALSE
)

## S4 method for signature 'InputHeatmap'
wrap_heatmap(
  panel = NULL,
  plot = NULL,
  full = NULL,
  clip = TRUE,
  ignore_tag = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wrap_heatmap_+3A_panel">panel</code>, <code id="wrap_heatmap_+3A_plot">plot</code>, <code id="wrap_heatmap_+3A_full">full</code></td>
<td>
<p>A grob, ggplot, patchwork, formula, raster, or
nativeRaster object to add to the respective area.</p>
</td></tr>
<tr><td><code id="wrap_heatmap_+3A_clip">clip</code></td>
<td>
<p>Should the grobs be clipped if expanding outside its area</p>
</td></tr>
<tr><td><code id="wrap_heatmap_+3A_ignore_tag">ignore_tag</code></td>
<td>
<p>Should tags be ignored for this patch. This is relevant
when using automatic tagging of plots and the content of the patch does not
qualify for a tag.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A wrapped_patch object
</p>
<p>A wrapped_patch object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

tidyHeatmap::N52 |&gt;
tidyHeatmap::heatmap(
 .row = symbol_ct,
 .column = UBR,
 .value = `read count normalised log`,
) |&gt; 
wrap_heatmap()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
