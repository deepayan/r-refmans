<!DOCTYPE html><html><head><title>Help for package RolWinMulCor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RolWinMulCor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot_1win'><p>Plot the outputs of <code>rolwincor_1win</code> and <code>rolwinmulcor_1win</code> as a single one window</p></a></li>
<li><a href='#plot_heatmap'><p>Plot the outputs of <code>rolwincor_heatmap</code> and <code>rolwinmulcor_heatmap</code> as a heat map</p></a></li>
<li><a href='#rolwincor_1win'><p>Estimate the Rolling Window Correlation for the bi-variate case to plot its outputs as a single one window</p></a></li>
<li><a href='#rolwincor_heatmap'><p>Estimate the Rolling Window Correlation for the bi-variate case to plot its outputs as a heat map</p></a></li>
<li><a href='#rolwinmulcor_1win'><p>Estimate the Rolling Window Correlation for the multi-variate case to plot its outputs as a single one window</p></a></li>
<li><a href='#rolwinmulcor_heatmap'><p>Estimate the Rolling Window Correlation for the multi-variate case to plot the results as a heat map</p></a></li>
<li><a href='#RolWinMulCor-package'><p>Estimate the Rolling Window Multiple Correlation</p></a></li>
<li><a href='#syntDATA'><p>Synthetic data set to test the functions of <em>RolWinMulCor</em></p></a></li>
<li><a href='#YX_ecological_data'><p>Ecological data set to test the functions of <em>RolWinMulCor</em></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Subroutines to Estimate Rolling Window Multiple Correlation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josue M. Polanco-Martinez &lt;josue.m.polanco@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), stats, gtools, zoo, pracma, colorspace, scales</td>
</tr>
<tr>
<td>Description:</td>
<td>Rolling Window Multiple Correlation ('RolWinMulCor') estimates the rolling (running) window correlation for the bi- and multi-variate cases between regular (sampled on identical time points) time series, with especial emphasis to ecological data although this can be applied to other kinds of data sets. 'RolWinMulCor' is based on the concept of rolling, running or sliding window and is useful to evaluate the evolution of correlation through time and time-scales. 'RolWinMulCor' contains six functions. The first two focus on the bi-variate case: (1) rolwincor_1win() and (2) rolwincor_heatmap(), which estimate the correlation coefficients and the their respective p-values for only one window-length (time-scale) and considering all possible window-lengths or a band of window-lengths, respectively. The second two functions: (3) rolwinmulcor_1win() and (4) rolwinmulcor_heatmap() are designed to analyze the multi-variate case, following the bi-variate case to visually display the results, but these two approaches are methodologically different. That is, the multi-variate case estimates the adjusted coefficients of determination instead of the correlation coefficients. The last two functions: (5) plot_1win() and (6) plot_heatmap() are used to represent graphically the outputs of the four aforementioned functions as simple plots or as heat maps. The functions contained in 'RolWinMulCor' are highly flexible since these contains several parameters to control the estimation of correlation and the features of the plot output, e.g. to remove the (linear) trend contained in the time series under analysis, to choose different p-value correction methods (which are used to address the multiple comparison problem) or to personalise the plot outputs. The 'RolWinMulCor' package also provides examples with synthetic and real-life ecological time series to exemplify its use. Methods derived from H. Abdi. (2007) <a href="https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf">https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf</a>, R. Telford (2013) &lt;https://quantpalaeo.wordpress.com/2013/01/04/, J. M. Polanco-Martinez (2019) &lt;<a href="https://doi.org/10.1007%2Fs11071-019-04974-y">doi:10.1007/s11071-019-04974-y</a>&gt;, and J. M. Polanco-Martinez (2020) &lt;<a href="https://doi.org/10.1016%2Fj.ecoinf.2020.101163">doi:10.1016/j.ecoinf.2020.101163</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-14 14:10:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-14 13:56:28 UTC; jomopo</td>
</tr>
<tr>
<td>Author:</td>
<td>Josue M. Polanco-Martinez
    <a href="https://orcid.org/0000-0001-7164-0185"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cph,
    cre]</td>
</tr>
</table>
<hr>
<h2 id='plot_1win'>Plot the outputs of <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> and <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> as a single one window 
</h2><span id='topic+plot_1win'></span><span id='topic+plot_1win'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_1win">plot_1win</a></code> function plots the time series under study and the correlation coefficients and their respective p-values (corrected or not corrected) as only one selected window-length (time-scale) using the outputs of the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> (bi-variate case) or <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> (multi-variate case). The <code><a href="#topic+plot_1win">plot_1win</a></code> function is highly flexible since this contains several parameters to control the plot output. We would highlight that only the first 11 parameters must be defined by the users, the other parameters are not strictly necessary since these have been defined by default. A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_1win(inputdata, corcoefs, pvalues, left_win, righ_win, widthwin, 
          KCASE="", varX="", varY="", coltsX=c("black"), coltsY="blue", 
          rmltrd=TRUE, Scale=TRUE, HeigWin1=2.05, HeigWin2=2.75, 
          colCOEF="black", colPVAL="gray", CEXLAB=1.15, CEXAXIS=1.05, 
          LWDtsX=c(1), LWDtsY=1, LWDcoef=1, LWDpval=1, NUMLABX=5, 
          parcen=c(0.5,25)) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_1win_+3A_inputdata">inputdata</code></td>
<td>

<p>Input data used in the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code>. 
</p>
</td></tr> 
<tr><td><code id="plot_1win_+3A_corcoefs">corcoefs</code>, <code id="plot_1win_+3A_pvalues">pvalues</code></td>
<td>

<p>Correlation coefficients obtained from the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <br /> 
<code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> (named <em>Correlation_coefficients</em>) and p-values obtained from the aforementioned functions (named <em>P_values_corrected</em> or <br /> 
<em>P_values_not_corrected</em>).
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_left_win">left_win</code>, <code id="plot_1win_+3A_righ_win">righ_win</code></td>
<td>

<p>These parameters are used to accommodate the times in the rolling window correlations and are obtained from the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <br /> 
<code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code>, which have the same names.
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_widthwin">widthwin</code></td>
<td>

<p>Window size to compute the rolling window correlations. This value can be an even or odd number of at least three (the default value), and this parameter is the same as the one used in <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code>.
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_kcase">KCASE</code></td>
<td>

<p>This parameter is used to activate the cases: &ldquo;BIVAR&rdquo; for the bi-variate or &ldquo;MULVAR&rdquo; for the multi-variate, and this must be the same as the one used in <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_varx">varX</code></td>
<td>
 
<p>Name of the  &ldquo;first&rdquo; or independent variable, e.g. &ldquo;X&rdquo; (please note that &ldquo;X&rdquo; is a vector of one element if <code>KCASE</code>=&ldquo;BIVAR&rdquo; and a vector of several elements if <code>KCASE</code>=&ldquo;MULVAR&rdquo;). For the multi-variate case the names for &ldquo;X&rdquo; (the independent variables) will be defined as: <code>varX</code>=paste(&ldquo;X1&rdquo;, &ldquo;X2&rdquo;,..., sep=&rdquo;, &rdquo;). 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_vary">varY</code></td>
<td>

<p>Name of the &ldquo;second&rdquo; or dependent variable, e.g. &ldquo;Y&rdquo;. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_coltsx">coltsX</code>, <code id="plot_1win_+3A_coltsy">coltsY</code></td>
<td>

<p>Colors to be used when the variables are plotted, for the bi-variate case by default are &ldquo;black&rdquo; for &ldquo;X&rdquo; and &ldquo;blue&rdquo; for &ldquo;Y&rdquo;, but other colors can be used. For the multi-variate case, colors for the dependent (&ldquo;Y&rdquo;) and independent variables (&ldquo;X&rdquo;) MUST be provided (e.g. <code>coltsX</code>=c(&quot;red&quot;,&quot;blue&quot;,...), <code>coltsY</code>=&quot;black&quot;).    
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the time series under analysis. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the time series under analysis.
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_heigwin1">HeigWin1</code>, <code id="plot_1win_+3A_heigwin2">HeigWin2</code></td>
<td>

<p>Proportion of window's size to plot the time series under analysis (<code>HeigWin1</code>) and the rolling window correlation coefficients and p-values (<code>HeigWin2</code>) (look at: <span class="rlang"><b>R</b></span>&gt;?layout to get more information about &ldquo;layout&rdquo;). By default <code>HeigWin1</code> and <code>HeigWin2</code> have values of 2.05 and 2.75, but other values can be used. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_colcoef">colCOEF</code>, <code id="plot_1win_+3A_colpval">colPVAL</code></td>
<td>

<p>The colors to be used when the correlation coefficients and their corresponding p-values are plotted, by default the colors are &ldquo;black&rdquo; and &ldquo;gray,&rdquo; but other colors can be used. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_cexlab">CEXLAB</code>, <code id="plot_1win_+3A_cexaxis">CEXAXIS</code></td>
<td>

<p>These parameters are used to plot the sizes of the X-axis and Y-axis labels and X- and Y-axis, by default these parameters have values of 1.15 and 1.05, respectively, but it is possible to use other values. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_lwdtsx">LWDtsX</code>, <code id="plot_1win_+3A_lwdtsy">LWDtsY</code></td>
<td>

<p>Line-widths for the first and the second variable when these are plotted, for the bi-variate case by default these have values of 1, but other values (widths) can be used. For the multi-variate case and for the independent variables the line-widths MUST be provided (e.g. <code>LWDtsX</code> = c(1,2,...)). 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_lwdcoef">LWDcoef</code>, <code id="plot_1win_+3A_lwdpval">LWDpval</code></td>
<td>

<p>The line-widths to be used when the correlation coefficients and their respective p-values are plotted, by default these parameters have a value of 1, but it is possible to use other values.
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_numlabx">NUMLABX</code></td>
<td>

<p>Number of labels for (all) the X's axis, by the default is 5, but it is possible to use other values. 
</p>
</td></tr>
<tr><td><code id="plot_1win_+3A_parcen">parcen</code></td>
<td>

<p>These parameters contain two values: the first one is to control the position of the title, by default it is 0.5, but you should try with other close values to obtain the title centered, e.g. 0.4 or 0.8 (please avoid to use large values); the second value is to define the spaces between the names of variables, by default is 25 spaces, but you could try other values to fit properly the names of variables in the title. We use &ldquo;mtext&rdquo; to produce the title (please loot at <span class="rlang"><b>R</b></span>&gt;?mtext for more information). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_1win">plot_1win</a></code> function plots the correlation coefficients and their respective p-values (corrected or not corrected) as only one selected window-length using the outputs of the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> (bi-variate case) and <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> (multi-variate case).  
</p>


<h3>Value</h3>

<p>Output: a single plot (via screen) of the correlation coefficients and their respective (corrected and not corrected) p-values.  
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Telford, R.: Running correlations &ndash; running into problems (2013). &lt;URL: <br />
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#######################################################################
# Testing the bi-variate case (1 window), synthetic data!
#######################################################################
# Fig. 3 in Polanco-Martínez (2020) 
test_fun1 &lt;- rolwincor_1win(syntDATA, varX="X", varY="Y", 
                            CorMethod="spearman", widthwin=21, 
                            Align="center", pvalcorectmethod="BH")
# Plotting the bi-variate case (1 window)
plot_1win(syntDATA, test_fun1$Correlation_coefficients, 
         test_fun1$P_values_corrected, test_fun1$left_win, 
         test_fun1$righ_win, widthwin=21, KCASE="BIVAR", 
         varX="X", varY="Y")
#######################################################################
# Testing the multi-variate case (1 window), real-life ecological data! 
#######################################################################
# Fig. 6 in Polanco-Martínez (2020)
test_fun2 &lt;- rolwinmulcor_1win(YX_ecological_data, widthwin=61,
                            Align="center", pvalcorectmethod="BH")
# Plotting the bi-variate case (1 window), real-life ecological data 
plot_1win(YX_ecological_data, test_fun2$Correlation_coefficients, 
          test_fun2$P_values_corrected, test_fun2$left_win, 
          test_fun2$righ_win, widthwin=61, KCASE="MULVAR", varY="PC1", 
          varX=paste("SST", "TSI", sep=", "), coltsY="black", 
          coltsX=c("red", "orange"), CEXLAB=1.15, CEXAXIS=1.65, 
          LWDtsX=rep(2,2), LWDtsY=2, parcen=c(0.45,15))
</code></pre>

<hr>
<h2 id='plot_heatmap'>Plot the outputs of <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> and <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> as a heat map
</h2><span id='topic+plot_heatmap'></span><span id='topic+plot_heatmap'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+plot_heatmap">plot_heatmap</a></code> function plots the time series under study and the correlation coefficients and their respective p-values (corrected or not corrected) as a heat map for all possible window-lengths (i.e., from five to the number of elements in the time series under analysis) or for a band of window-lengths using the outputs of the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> (bi-variate case) and <br /> 
<code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> (multi-variate case). The <code><a href="#topic+plot_heatmap">plot_heatmap</a></code> function is highly flexible since this contains several parameters to control the plot output. We would highlight that only the first 12 parameters (and <code>LWDtsX</code> for the multi-variate case) must be defined by the users since the others parameters are defined by default. A list of parameters are described in the following lines.</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heatmap(inputdata, corcoefs, pvalues, left_win, righ_win, Rwidthwin, 
     KCASE="", typewidthwin="", widthwin_1=3, widthwin_N=dim(inputdata)[1], 
     varX="", varY="", rmltrd=TRUE, Scale=TRUE, coltsX=c("black"), coltsY="blue", 
     CEXLAB=1.15, CEXAXIS=1.05, LWDtsX=1, LWDtsY=1, NUMLABX=5, parcen=c(0.5,25))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_heatmap_+3A_inputdata">inputdata</code></td>
<td>

<p>Input data used in the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> or <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code>.   
</p>
</td></tr> 
<tr><td><code id="plot_heatmap_+3A_corcoefs">corcoefs</code>, <code id="plot_heatmap_+3A_pvalues">pvalues</code></td>
<td>

<p>Correlation coefficients obtained from the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> or <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> (named <em>Correlation_coefficients</em>) and p-values obtained from the aforementioned functions (named <em>P_values_corrected</em> <br /> or <em>P_values_not_corrected</em>).
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_left_win">left_win</code>, <code id="plot_heatmap_+3A_righ_win">righ_win</code></td>
<td>

<p>These parameters are used to accommodate the times in the rolling window correlations and are obtained from the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> or <br /> 
<code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code>, which have the same names.
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_rwidthwin">Rwidthwin</code></td>
<td>

<p>Contains the window-sizes where the rolling window correlations are estimated by the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> or <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_kcase">KCASE</code></td>
<td>

<p>This parameter is used to activate the cases: &ldquo;BIVAR&rdquo; for the bi-variate or &ldquo;MULVAR&rdquo; for the multi-variate, and this must be the same label as the one used in <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> or <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code>. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_typewidthwin">typewidthwin</code></td>
<td>
<p>&ldquo;FULL&rdquo; is to estimate the windows from 2, 4, ..., to dim(inputdata)[1]) if <code>Align</code> is equal to &ldquo;left&rdquo; or &ldquo;right&rdquo;, or from 3, 5,..., to dim(inputdata)[1]) if <code>Align</code> is &ldquo;center&rdquo;. The other option is &ldquo;PARTIAL&rdquo;, please you should take into account that <code>widthwin_1</code> and <code>widthwin_1</code> MUST be ODD if the <code>Align</code> option is &ldquo;center&rdquo;. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_widthwin_1">widthwin_1</code></td>
<td>

<p>First value for the size (length) of the windows when the option <code>typewidthwin</code>=<br /> 
&ldquo;PARTIAL&rdquo; is selected, the minimum value is 3 (the default value), but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>). 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_widthwin_n">widthwin_N</code></td>
<td>

<p>Last value for the size (length) of the windows when the option <code>typewidthwin</code>=<br />
&ldquo;PARTIAL&rdquo; is selected, by default is dim(inputdata)[1], but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>).
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_varx">varX</code></td>
<td>
 
<p>Name of the  &ldquo;first&rdquo; or independent variable, e.g. &ldquo;X&rdquo; (please note that &ldquo;X&rdquo; is a vector of one element if <code>KCASE</code>=&ldquo;BIVAR&rdquo; and a vector of several elements if <code>KCASE</code>=&ldquo;MULVAR&rdquo;. For the multi-variate case the names for &ldquo;X&rdquo; (the independent variables) will be defined as: <code>varX</code>=paste(&ldquo;X1&rdquo;, &ldquo;X2&rdquo;,..., sep=&rdquo;, &rdquo;). 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_vary">varY</code></td>
<td>

<p>Name of the &ldquo;second&rdquo; or dependent variable, e.g. &ldquo;Y&rdquo;. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the time series under analysis. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the time series under analysis.
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_coltsx">coltsX</code>, <code id="plot_heatmap_+3A_coltsy">coltsY</code></td>
<td>

<p>Colors to be used when the variables are plotted, for the bi-variate case by default are &ldquo;black&rdquo; for &ldquo;X&rdquo; and &ldquo;blue&rdquo; for &ldquo;Y&rdquo;, but other colors can be used. For the multi-variate case, colors for the dependent (&ldquo;Y&rdquo;) and independent variables (&ldquo;X&rdquo;) MUST be provided (e.g. <code>coltsX</code>=c(&quot;red&quot;,&quot;blue&quot;,...), <code>coltsY</code>=&quot;black&quot;). 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_cexlab">CEXLAB</code>, <code id="plot_heatmap_+3A_cexaxis">CEXAXIS</code></td>
<td>

<p>These parameters are used to plot the sizes of the X-axis and Y-axis labels and X- and Y-axis, by default these parameters have values of 1.15 and 1.05, respectively, but it is possible to use other values. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_lwdtsx">LWDtsX</code>, <code id="plot_heatmap_+3A_lwdtsy">LWDtsY</code></td>
<td>

<p>Line-widths for the first and the second variable when these are plotted, for the bi-variate case by default these have values of 1, but other values (widths) can be used. For the multi-variate case and for the independent variables the line-widths MUST be provided (e.g. <code>LWDtsX</code> = c(1,2,...)). 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_numlabx">NUMLABX</code></td>
<td>

<p>Number of labels for (all) the X's axis, by the default is 5, but it is possible to use other values. 
</p>
</td></tr>
<tr><td><code id="plot_heatmap_+3A_parcen">parcen</code></td>
<td>

<p>These parameters contain two values: the first one is to control the position of the title, by default it is 0.5, but you should try with other close values to obtain the title centered, e.g. 0.4 or 0.8 (please avoid to use large values); the second value is to define the spaces between the names of variables, by default is 25 spaces, but you could try other values to fit properly the names of variables in the title. We use &ldquo;mtext&rdquo; to produce the title (please loot at <span class="rlang"><b>R</b></span>&gt;?mtext for more information). 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+plot_heatmap">plot_heatmap</a></code> function plots the time series under study and the heat map for the correlation coefficients and their respective p-values (corrected or not corrected) for all possible window-lengths (i.e., from five to the number of elements in the time series under analysis) or for a band of window-lengths. <code><a href="#topic+plot_heatmap">plot_heatmap</a></code> uses the outputs of the functions  <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> (bi-variate case) and <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> (multi-variate case). 
</p>


<h3>Value</h3>

<p>Output: a heat map (via screen) of the correlation coefficients and their respective (corrected or not corrected) p-values.</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Telford, R.: Running correlations &ndash; running into problems (2013). &lt;URL: <br />
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
######################################################################
# Testing the bi-variate case (heat map). Example: synthetic data! 
# Fig. 4 in Polanco-Martínez (2020) 
test_fun2 &lt;- rolwincor_heatmap(syntDATA, varX="X", varY="Y",
                       CorMethod="spearman", typewidthwin="PARTIAL",
                       widthwin_1=11, widthwin_N=101, Align="center")
# Plotting the bi-variate case (heat map). Example: synthetic data! 
plot_heatmap(syntDATA, test_fun2$matcor, test_fun2$pvalscor, test_fun2$left_win, 
             test_fun2$righ_win, test_fun2$Windows, KCASE="BIVAR", 
             typewidthwin="PARTIAL", varX="X", varY="Y", widthwin_1=11, 
             widthwin_N=101)
######################################################################
# Testing the bi-variate case (heat map). Example: real-life ecological data
######################################################################
# Fig. 5 (left) in Polanco-Martínez (2020)
SST_PC1 &lt;- rolwincor_heatmap(YX_ecological_data[,c(1,3,2)], varX="SST",
                 varY="PC1", CorMethod="spearman", typewidthwin="FULL", 
                 Align="center", pvalcorectmethod="BH")
# Plotting the bi-variate case (heat map). Example: real-life ecological data 
plot_heatmap(YX_ecological_data[,c(1,3,2)], SST_PC1$matcor, SST_PC1$pvalscor,
     SST_PC1$left_win, SST_PC1$righ_win, SST_PC1$Windows, KCASE="BIVAR",
     typewidthwin="FULL", varX="SST", varY="PC1", coltsX="red", CEXLAB=1.15,
     CEXAXIS=1.65, coltsY="black", LWDtsX=2, LWDtsY=2)
######################################################################
# Testing the multi-variate case (heat map). Example: real-life ecological data
######################################################################
# Fig. 6 in Polanco-Martínez (2020)
SST_TSI_PC1 &lt;- rolwinmulcor_heatmap(YX_ecological_data, typewidthwin="FULL",
                                    Align="center", pvalcorectmethod="BH")
# Plotting the multi-variate case (heat map). Example: real-life ecological data
plot_heatmap(YX_ecological_data, SST_TSI_PC1$matcor, SST_TSI_PC1$pvalscor,
      SST_TSI_PC1$left_win, SST_TSI_PC1$righ_win, Rwidthwin=SST_TSI_PC1$Windows,
      KCASE="MULVAR", typewidthwin="FULL", varY="PC1", varX=c("SST", "TSI"),
      coltsY="black", coltsX=c("red", "orange"), CEXLAB=1.15, CEXAXIS=1.65,
      LWDtsX=rep(2,2), LWDtsY=2, parcen=c(0.45,15))

</code></pre>

<hr>
<h2 id='rolwincor_1win'>Estimate the Rolling Window Correlation for the bi-variate case to plot its outputs as a single one window 
</h2><span id='topic+rolwincor_1win'></span><span id='topic+rolwincor_1win'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> function estimates (correlation coefficients and their respective p-values) the rolling (running) window correlation between TWO time series (bi-variate case) sampled on identical time points for ONLY ONE window-length (time-scale). To carry out the computational implementation we follow to Telford (2013), Polanco-Martínez (2019), and Polanco-Martínez (2020). The <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> function is highly flexible since this contain several parameters to control the estimation of correlation. For example, <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> function contain parameters to remove the (linear) trend contained in the time series under analysis or to choose different p-value correction methods (which are used to address the multiple comparison problem). A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolwincor_1win(inputdata, varX="", varY="", CorMethod="pearson", widthwin=3,
               Align="center", pvalcorectmethod="BH", rmltrd=TRUE, Scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolwincor_1win_+3A_inputdata">inputdata</code></td>
<td>

<p>Matrix of 3 columns: time, first variable (e.g. <code class="reqn">X</code>), and second variable (e.g. <code class="reqn">Y</code>). Please note that time's resolution can be annual, seasonal, monthly, etc, but the format must be in the following form: e.g. for monthly data, year 1 must be repeated 12 times (thus, these times will correspond to 12 rows), year 2 must be also repeated 12 times, and so on. 'Times' must be regular (equally spaced in time and not missing data). 
</p>
</td></tr> 
<tr><td><code id="rolwincor_1win_+3A_varx">varX</code>, <code id="rolwincor_1win_+3A_vary">varY</code></td>
<td>

<p>Names of the first (e.g. <code class="reqn">X</code>) and second (e.g. <code class="reqn">Y</code>) variable. Please note that the names of these variables MUST be defined.
</p>
</td></tr> 
<tr><td><code id="rolwincor_1win_+3A_cormethod">CorMethod</code></td>
<td>

<p>The method used to estimate the correlations, by default is &ldquo;pearson,&rdquo; but other options (&ldquo;spearman&rdquo; and &ldquo;kendall&rdquo;) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?cor.test).
</p>
</td></tr>
<tr><td><code id="rolwincor_1win_+3A_widthwin">widthwin</code></td>
<td>

<p>Window size to compute the rolling window correlations. This value can be an even or odd number of at least three (the default value), and this parameter MUST be provided. 
</p>
</td></tr>
<tr><td><code id="rolwincor_1win_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, RolWinMulCor ONLY uses the &ldquo;center&rdquo; option by default (please look at: <span class="rlang"><b>R</b></span>&gt;?running) to ensure that variations in the correlation are aligned with the variations in the relationship of the time series under study rather than being shifted (Polanco-Martínez 2019, 2020), but the &ldquo;left&rdquo; and &ldquo;right&rdquo; options can be used, but if <code>widthwin</code> is an even number it will not be possible to use the &ldquo;center&rdquo; option (please look at: <span class="rlang"><b>R</b></span>&gt;?running).
</p>
</td></tr>
<tr><td><code id="rolwincor_1win_+3A_pvalcorectmethod">pvalcorectmethod</code></td>
<td>

<p>The p-value correction method to be used, by default the method of Benjamini and Hochberg (BH) (1995) is used since this is less conservative and performs much better than Bonferroni, but other five methods (Holm, Hochberg, Bonferroni, Hommel, and Benjamini and Yekutieli) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?p.adjust). Moreover, <code>pvalcorectmethod</code> admits a pass-through option <br /> 
named &ldquo;none&rdquo; (p-values will not be corrected).
</p>
</td></tr>
<tr><td><code id="rolwincor_1win_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the two time series under analysis. 
</p>
</td></tr>
<tr><td><code id="rolwincor_1win_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the time series under analysis.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> function estimates the rolling window correlation between TWO time series (bi-variate case) sampled on identical time points for ONLY ONE window-length (time-scale) and plots the rolling correlation coefficients and their respective p-values. <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> uses the functions <em>running</em> (package:gtools), the native <span class="rlang"><b>R</b></span> functions <em>cor</em>, <em>cor.test</em>, and <em>p.adjust</em> (package:stats), and some pieces of code written specifically to our <span class="rlang"><b>R</b></span> RolWinMulCor package. 
</p>


<h3>Value</h3>

<p>Outputs:
</p>
<p>Numerical output: a list containing <em>Correlation_coefficients</em>, <em>P_values_corrected</em>, and <br /> <em>P_values_not_corrected</em>, which are self-explanatory, as well as <em>CorMethod</em>, <em>left_win</em>, <em>righ_win</em>, and <em>widthwin</em>, which indicate the method used to estimate the correlations, first and last time element of the rolling correlation matrix, and the window-length (time-scale).
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Telford, R.: Running correlations &ndash; running into problems (2013). &lt;URL: <br />
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. <br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Testing the function rolwincor_1win (bi-variate case)
# Window length = 21 and plot output in screen format 
# Estimation to generate the output for Fig. 3 in Polanco-Martínez (2020). 
test_rolwincor_1win &lt;- rolwincor_1win(syntDATA, varX="X", varY="Y", CorMethod="spearman", 
                                      widthwin=21, Align="center", pvalcorectmethod="BH")
</code></pre>

<hr>
<h2 id='rolwincor_heatmap'>Estimate the Rolling Window Correlation for the bi-variate case to plot its outputs as a heat map 
</h2><span id='topic+rolwincor_heatmap'></span><span id='topic+rolwincor_heatmap'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> function estimates the rolling window correlation coefficients and their respective p-values between TWO time series (bi-variate case) sampled on identical time points for all the possible (i.e. from 3 to the number of elements of the time series under analysis) window-lengths (time-scales) or for a band of window-lengths to be plotted as a heat map. To carry out the computational implementation we extend the works of Telford (2013), Polanco-Martínez (2019), and Polanco-Martínez (2020). The <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> function is highly flexible since this contains several parameters to control the estimation of correlation. A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolwincor_heatmap(inputdata, varX="", varY="", CorMethod="pearson", 
                  typewidthwin="FULL", widthwin_1=3, 
                  widthwin_N=dim(inputdata)[1], Align="center", 
                  pvalcorectmethod="BH", rmltrd=TRUE, Scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolwincor_heatmap_+3A_inputdata">inputdata</code></td>
<td>

<p>Matrix of 3 columns: time, first variable (e.g. <code class="reqn">X</code>), and second variable (e.g. <code class="reqn">Y</code>). Please note that time's resolution can be annual, seasonal, monthly, etc, but the format must be in the following form: e.g. for monthly data, year 1 must be repeated 12 times (thus, these times will correspond to 12 rows), year 2 must be also repeated 12 times, and so on. 'Times' must be regular (equally spaced in time and not missing data).
</p>
</td></tr> 
<tr><td><code id="rolwincor_heatmap_+3A_varx">varX</code>, <code id="rolwincor_heatmap_+3A_vary">varY</code></td>
<td>

<p>Names of the first (e.g. <code class="reqn">X</code>) and second (e.g. <code class="reqn">Y</code>) variable. Please note that the names of these two variables MUST be defined.
</p>
</td></tr> 
<tr><td><code id="rolwincor_heatmap_+3A_cormethod">CorMethod</code></td>
<td>

<p>The method used to estimate the correlations, by default is &ldquo;pearson&rdquo; but other options (&ldquo;spearman&rdquo; and &ldquo;kendall&rdquo;) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?cor.test).
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_typewidthwin">typewidthwin</code></td>
<td>
<p>&ldquo;FULL&rdquo; is to estimate the windows from 2, 4, ..., to dim(inputdata)[1]) if <code>Align</code> is equal to &ldquo;left&rdquo; or &ldquo;right&rdquo;, or from 3, 5,..., to dim(inputdata)[1]) if Align is &ldquo;center&rdquo;. The other option is &ldquo;PARTIAL&rdquo;, please you should take into account that <code>widthwin_1</code> and <code>widthwin_1</code> MUST be ODD if the <code>Align</code> option is &ldquo;center&rdquo;. 
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_widthwin_1">widthwin_1</code></td>
<td>

<p>First value for the size (length) of the windows when the option <code>typewidthwin</code>=<br /> 
&ldquo;PARTIAL&rdquo; is selected, the minimum value is 3 (the default value), but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>). 
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_widthwin_n">widthwin_N</code></td>
<td>

<p>Last value for the size (length) of the windows when the option <code>typewidthwin</code>=<br /> 
&ldquo;PARTIAL&rdquo; is selected, by default is dim(inputdata)[1], but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>).
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, RolWinMulCor uses three options: &ldquo;left&rdquo;, &ldquo;center&rdquo;, and &ldquo;right&rdquo; (please look at: <span class="rlang"><b>R</b></span>&gt;?running). However, there are some restrictions, which have been described lines above. We recommend to use the &ldquo;center&rdquo; option to ensure that variations in the correlations are aligned with the variations in the relationships of the variables under study, rather than being shifted to left or right (Polanco-Martínez 2019, 2020), but this imply that the window-lengths MUST be ODD. 
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_pvalcorectmethod">pvalcorectmethod</code></td>
<td>

<p>The p-value correction method to be used, by default the method of Benjamini and Hochberg (BH) (1995) is used since this is less conservative and performs much better than Bonferroni, but other five methods (Holm, Hochberg, Bonferroni, Hommel, and Benjamini and Yekutieli) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?p.adjust). Moreover, <code>pvalcorectmethod</code> admits a pass-through option <br /> 
named &ldquo;none&rdquo; (p-values will not be corrected).
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the time series under analysis. 
</p>
</td></tr>
<tr><td><code id="rolwincor_heatmap_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo;  otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the time series under analysis.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> function estimates the rolling window correlation between TWO time series (bi-variate case) sampled on identical time points for all the possible (i.e. from 3 to the number of elements of the time series under analysis) window-lengths (time-scales) or for a band of window-lengths to be plotted the rolling correlation coefficients and their respective p-values as a heat map. <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> uses the functions <em>running</em> (package:gtools), the native <span class="rlang"><b>R</b></span> functions <em>cor</em>, <em>cor.test</em>, and <em>p.adjust</em> (package:stats), and some pieces of code written specifically to our <span class="rlang"><b>R</b></span> RolWinMulCor package. 
</p>


<h3>Value</h3>

<p>Outputs:
</p>
<p>Numerical output: three lists <em>matcor</em>, <em>pvalscor</em>, and <em>pvalNOTcor</em> containing the correlation matrix and their corresponding corrected and not corrected p-values, as well as <em>NoWindows</em> and <em>Windows</em> that contains the number of windows and the window-lengths (time-scales), and <em>CorMethod</em>, <em>left_win</em>, and <em>righ_win</em>, which have been previously described.
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Telford, R.: Running correlations &ndash; running into problems (2013). &lt;URL: <br /> 
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing the function rolwincor_heatmap
# typewidthwin="PARTIAL," window lengths from 11 to 101 and plot output in screen format 
# Code used to produce the outputs to generate the Fig. 4 in Polanco-Martínez (2020). 
test_rolwincor_heatmap &lt;- rolwincor_heatmap(syntDATA, varX="X", varY="Y", 
                            CorMethod="spearman", typewidthwin="PARTIAL", widthwin_1=11, 
                            widthwin_N=101, Align="center", pvalcorectmethod="BH", 
                            rmltrd=TRUE, Scale=TRUE)
# This example could takes a long time since typewidthwin="FULL" 
test2_rolwincor_heatmap &lt;- rolwincor_heatmap(syntDATA, varX="X", varY="Y",
                             CorMethod="spearman", typewidthwin="FULL", Align="center", 
                             pvalcorectmethod="BH", rmltrd=TRUE, Scale=TRUE)
 
</code></pre>

<hr>
<h2 id='rolwinmulcor_1win'>Estimate the Rolling Window Correlation for the multi-variate case to plot its outputs as a single one window 
</h2><span id='topic+rolwinmulcor_1win'></span><span id='topic+rolwinmulcor_1win'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> function estimates the rolling window correlation coefficients and their respective p-values among multiple time series (multi-variate case) sampled on identical time points for ONLY ONE window-length (time-scale). The multi-variate case is based on the concept of multiple regression and generalizes the standard coefficient of correlation (the squared multiple correlation coefficient, or more appropriate, the adjusted coefficient of determination, <code class="reqn">R^2</code>). We follow to Abdi (2007) and Polanco-Martínez (2020) to implement computationally this technique. The <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> function is highly flexible since this contains several parameters to control the estimation of correlation. For example, <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> function contains parameters to remove the (linear) trend contained in the time series under analysis, to choose different p-value correction methods (which are used to address the multiple comparison problem). A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolwinmulcor_1win(inputdata, varnametsY="", varnametsX="", widthwin=5, 
                  Align="center", pvalcorectmethod="BH", 
                  rmltrd="TRUE", Scale="TRUE")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolwinmulcor_1win_+3A_inputdata">inputdata</code></td>
<td>

<p>Matrix of P columns: time, dependent variable (<code class="reqn">Y</code>), and independent variables (<code class="reqn">X_1, X_2,..., X_{P-2}</code>). Please note that time's resolution can be annual, seasonal, monthly, etc, but the format must be in the following form: e.g. for monthly data, year 1 must be repeated 12 times (thus, these times will correspond to 12 rows), year 2 must be also repeated 12 times, and so on. 'Times' must be regular (equally spaced in time and not missing data).
</p>
</td></tr> 
<tr><td><code id="rolwinmulcor_1win_+3A_varnametsy">varnametsY</code></td>
<td>

<p>Name of the dependent variable: <code class="reqn">Y</code>. Please note that the name of this variable MUST be defined. 
</p>
</td></tr> 
<tr><td><code id="rolwinmulcor_1win_+3A_varnametsx">varnametsX</code></td>
<td>

<p>Name of the independent variables: <code class="reqn">X_1, X_2,..., X_{p-2}</code>. Please note that the names of these variables MUST defined in this way: <code>varnametsX</code>=paste(&quot;X1&quot;, &quot;X2&quot;,..., sep=&quot;, &quot;).
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_1win_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the time series under analysis. 
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_1win_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo; the time series under analysis.
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_1win_+3A_widthwin">widthwin</code></td>
<td>

<p>Window size to compute the rolling window correlations. This value can be an even or odd number of at least three (the default value), and this parameter MUST be provided. 
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_1win_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, RolWinMulCor ONLY uses the &ldquo;center&rdquo; option by default (please look at: <span class="rlang"><b>R</b></span>&gt;?running) to ensure that variations in the correlation are aligned with the variations in the relationship of the time series under study rather than being shifted (Polanco-Martínez 2019, 2020), but the &ldquo;left&rdquo; and &ldquo;right&rdquo; options can be used, but if <code>widthwin</code> is an even number it will not be possible to use the &ldquo;center&rdquo; option (please look at: <span class="rlang"><b>R</b></span>&gt;?running).
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_1win_+3A_pvalcorectmethod">pvalcorectmethod</code></td>
<td>

<p>The p-value correction method to be used, by default the method of Benjamini and Hochberg (BH) (1995) is used since this is less conservative and performs much better than Bonferroni, but other five methods (Holm, Hochberg, Bonferroni,Hommel, and Benjamini and Yekutieli) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?p.adjust). Moreover, <code>pvalcorectmethod</code> admits a pass-through option <br /> 
named &ldquo;none&rdquo; (p-values will not be corrected).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> function estimates the rolling window correlation coefficients and their respective p-values among multiple time series (multi-variate case) sampled on identical time points for ONLY ONE window-length. <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> uses the functions <em>rollapply</em> (package:zoo) that is able to tackle matrices, the native <span class="rlang"><b>R</b></span> function <em>p.adjust</em> (package:stats), and some pieces of code and an auxiliary function that we have created specifically for our function <br /> 
<code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> and <span class="rlang"><b>R</b></span> RolWinMulCor package. 
</p>


<h3>Value</h3>

<p>Outputs:
</p>
<p>Numerical output: three list containing <em>Correlation_coefficients</em>, <em>P_values_corrected</em>, and <br /> <em>P_values_not_corrected</em>, which are self-explanatory, as well as <em>left_win</em>, <em>righ_win</em>, and <em>widthwin</em>, which indicate the method used to estimate the correlations, first and last time element of the rolling correlation matrix, and the window-length (time-scale).
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>. 
</p>


<h3>References</h3>

<p>Abdi H. Multiple correlation coefficient, in Encyclopedia of Measurement and
Statistics, N. J. Salkind, Ed. Sage, Thousand Oaks, CA, USA, 2007; 648-651. <br />
&lt;URL: <a href="https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf">https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf</a>&gt;. <br />
</p>
<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Testing the function rolwinmulcor_1win (multi-variate case)
 # Estimates the outputs to generate Fig. 6 in Polanco-Martinez (2020). 
 test_rolwinmulcor_1win &lt;- rolwinmulcor_1win(YX_ecological_data, widthwin=61,
                            Align="center", pvalcorectmethod="BH")
</code></pre>

<hr>
<h2 id='rolwinmulcor_heatmap'>Estimate the Rolling Window Correlation for the multi-variate case to plot the results as a heat map 
</h2><span id='topic+rolwinmulcor_heatmap'></span><span id='topic+rolwinmulcor_heatmap'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> function estimates the rolling window correlation coefficients and their respective p-values among several time series (multi-variate case) sampled on identical time points for all the possible (i.e. from 3 to the number of elements of the time series under analysis) window-lengths (time-scales) or for a band of window-lengths, and the outputs are used to produce a heat map. The multivariate case is based on the concept of multiple regression and generalizes the standard coefficient of correlation (the squared multiple correlation coefficient, or more appropriate, the adjusted coefficient of determination, <code class="reqn">R^2</code>). We follow (and extend) the work of Abdi (2007) and Polanco-Martínez (2020) to implement computationally this technique. The <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> function is highly flexible since this contains several parameters to control the estimation of correlation and features of the plot output. A list of parameters are described in the following lines. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rolwinmulcor_heatmap(inputdata, varnametsY="", varnametsX="", 
                     typewidthwin="FULL", widthwin_1=7, 
                     widthwin_N=dim(inputdata)[1], Align="center", 
                     pvalcorectmethod="BH", rmltrd=TRUE, Scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rolwinmulcor_heatmap_+3A_inputdata">inputdata</code></td>
<td>

<p>Matrix of P columns: time, dependent variable (<code class="reqn">Y</code>), and independent variables (<code class="reqn">X_1, X_2,..., X_{P-2}</code>). Please note that time's resolution can be annual, seasonal, monthly, etc, but the format must be in the following form: e.g. for monthly data, year 1 must be repeated 12 times (thus, these times will correspond to 12 rows), year 2 must be also repeated 12 times, and so on. 'Times' must be regular (equally spaced in time and not missing data).
</p>
</td></tr> 
<tr><td><code id="rolwinmulcor_heatmap_+3A_varnametsy">varnametsY</code></td>
<td>

<p>Name of the dependent variable: <code class="reqn">Y</code>. Please note that the name of this variable MUST be defined. 
</p>
</td></tr> 
<tr><td><code id="rolwinmulcor_heatmap_+3A_varnametsx">varnametsX</code></td>
<td>

<p>Name of the independent variables: <code class="reqn">X_1, X_2,..., X_{p-2}</code>. Please note that the names of these variables MUST be defined in this way: <code>varnametsX</code>=c(&quot;X1&quot;, &quot;X2&quot;,..., sep=&quot;, &quot;).
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_rmltrd">rmltrd</code></td>
<td>

<p>Remove (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) the linear trend in the time series under analysis. 
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_scale">Scale</code></td>
<td>

<p>Scale (by default is &ldquo;TRUE&rdquo;; &ldquo;FALSE&rdquo; otherwise) is used to &ldquo;normalize&rdquo; or &ldquo;standardize&rdquo;the time series under analysis.
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_typewidthwin">typewidthwin</code></td>
<td>

<p>'FULL&rdquo; is to estimate the windows from 2, 4, ..., to dim(inputdata)[1]) if <code>Align</code> is equal to &ldquo;left&rdquo; or &ldquo;right&rdquo;, or from 3, 5,..., to dim(inputdata)[1]) if Align is &ldquo;center&rdquo;. The other option is &ldquo;PARTIAL&rdquo;, please you should take into account that <code>widthwin_1</code> and <code>widthwin_1</code> MUST be ODD if the <code>Align</code> option is &ldquo;center&rdquo;.
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_widthwin_1">widthwin_1</code></td>
<td>

<p>First value for the size (length) of the windows when the option <em>typewidthwin</em>=&ldquo;PARTIAL&rdquo; is selected, the minimum value is 3 (the default value), but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>).
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_widthwin_n">widthwin_N</code></td>
<td>

<p>Last value for the size (length) of the windows when the option <em>typewidthwin</em>=&ldquo;PARTIAL&rdquo; is selected, by default is dim(inputdata)[1], but you must define this parameter (please note that <code>widthwin_1</code> &lt; <code>widthwin_N</code>).
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_align">Align</code></td>
<td>

<p>To align the rolling object, RolWinMulCor uses three options: &ldquo;left&rdquo;, &ldquo;center&rdquo;, and &ldquo;right&rdquo; (please look at: <span class="rlang"><b>R</b></span>&gt;?running). However, there are some restrictions, which have been described lines above. We recommend to use the &ldquo;center&rdquo; option to ensure that variations in the correlations are aligned with the variations in the relationships of the variables under study, rather than being shifted to left or right (Polanco-Martínez 2019, 2020), but this imply that the window-lengths (time-scales) MUST be ODD. 
</p>
</td></tr>
<tr><td><code id="rolwinmulcor_heatmap_+3A_pvalcorectmethod">pvalcorectmethod</code></td>
<td>

<p>The p-value correction method to be used, by default the method of Benjamini and Hochberg (BH) (1995) is used since this is less conservative and performs much better than Bonferroni, but other five methods (Holm, Hochberg, Bonferroni,  and Benjamini and Yekutieli) are available (please look at: <span class="rlang"><b>R</b></span>&gt;?p.adjust). Moreover, <code>pvalcorectmethod</code> admits a pass-through option named &ldquo;none&rdquo; (p-values will not be corrected).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> function estimates the rolling window correlation coefficients and their respective p-values between multiple time series (multi-variate case) sampled on identical time points for all the possible window-lengths (time-scales) or for a band of window-lengths. <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> uses the functions <em>rollapply</em> (package:zoo) that is able to tackle matrices, the native <span class="rlang"><b>R</b></span> function <em>p.adjust</em> (package:stats), and some pieces of code and an auxiliary function that we have created specifically for our function <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> and <span class="rlang"><b>R</b></span> RolWinMulCor package. 
</p>


<h3>Value</h3>

<p>Outputs:
</p>
<p>Numerical output: three lists <em>matcor</em>, <em>pvalscor</em>, and <em>pvalNOTcor</em> containing the correlation coefficients and their corresponding corrected and not corrected p-values, as well as <em>NoWindows</em>, <em>Windows</em> that contains the number of windows and the window-lengths (time-scales), and <em>CorMethod</em>, <em>left_win</em>, and <em>righ_win</em> that have been previously described.
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>.
</p>


<h3>References</h3>

<p>Abdi H. Multiple correlation coefficient, in Encyclopedia of Measurement and
Statistics, N. J. Salkind, Ed. Sage, Thousand Oaks, CA, USA, 2007; 648-651. <br />
&lt;URL: <a href="https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf">https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf</a>&gt;. <br />
</p>
<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Testing the function rolwinmulcor_heatmap
test_rolwinmulcor_heatmap &lt;- rolwinmulcor_heatmap(YX_ecological_data, 
                               typewidthwin="PARTIAL", widthwin_1=11, widthwin_N=101, 
                               Align="center", pvalcorectmethod="BH")

</code></pre>

<hr>
<h2 id='RolWinMulCor-package'>Estimate the Rolling Window Multiple Correlation 
</h2><span id='topic+RolWinMulCor-package'></span><span id='topic+RolWinMulCor'></span>

<h3>Description</h3>

<p>'RolWinMulCor' estimates the rolling (running) window correlation for 
the bi- and multi-variate cases between regular (sampled on identical 
time points) time series, with especial emphasis to ecological data 
although this can be applied to other kinds of data sets. 'RolWinMulCor' 
is based on the concept of rolling, running, or sliding window correlation 
and is useful to evaluate the evolution of correlation through time and 
time-scales. 'RolWinMulCor' contains six (four for estimations and two 
for plots) functions. The first two functions focus on the bi-variate 
case: (1) 'rolwincor_1win' and (2) 'rolwincor_heatmap', which estimate the
correlation coefficients and their respective p-values for only one 
window-length (time-scale) and considering all possible window-lengths 
or a band of window-lengths, respectively. The second two functions: (3) 
'rolwinmulcor_1win' and (4) 'rolwinmulcor_heatmap' are designed to analyze 
the multi-variate case, following the bi-variate case to visually display 
the results, but these two approaches are methodologically different. 
That is, the multi-variate case estimate the adjusted coefficients of 
determination instead of the correlation coefficients. The last two 
functions: (5) 'plot_1win' and (6) 'plot_heatmap' are used to plot the 
time series under study and to represent graphically the outputs of the 
four aforementioned functions as simple plots or as heat maps. The six 
functions contained in 'RolWinMulCor' are highly flexible since these 
contain several parameters to control the estimation of correlation and 
the features of the plot output, e.g. to remove the linear trend 
contained in the time series under analysis, to choose different 
p-value correction methods (which are used to address the multiple 
comparison problem) or to personalise the plot output. The 'RolWinMulCor' 
package also provides examples with synthetic and real-life ecological 
time series to exemplify its use. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RolWinMulCor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-04-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>RolWinMulCor package contains six functions: (1) <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> estimates the rolling window correlation coefficients and their respective p-values for the bi-variate case for only one window-length or time-scale for the time series under study; (2) <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> estimates the correlation coefficients and their corresponding p-values taking into account all the possible window-lengths that are determined by the number of elements of the time series under analysis or a band of window-lengths; (3) <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> estimates the rolling window correlation coefficients and their p-values for the multi-variate case for only one window-length or time-scale for the time series under study; (4) <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> estimates the correlation coefficients and their corresponding p-values for the multi-variate case taking into account all the possible window-lengths or a band of window-lengths; (5) <code><a href="#topic+plot_1win">plot_1win</a></code> plots the time times under analysis and the correlation coefficients and their respective p-values (corrected or not corrected) as only one selected window-length using the outputs of the functions <code><a href="#topic+rolwincor_1win">rolwincor_1win</a></code> (bi-variate case) and <code><a href="#topic+rolwinmulcor_1win">rolwinmulcor_1win</a></code> (multi-variate case); and (6) <code><a href="#topic+plot_heatmap">plot_heatmap</a></code> plots the time series under scrutiny and the heat map for the correlation coefficients and their respective p-values (corrected or not corrected) for all possible window-lengths (i.e., from five to the number of elements of the time series under analysis) or for a band of window-lengths using the outputs of the functions <code><a href="#topic+rolwincor_heatmap">rolwincor_heatmap</a></code> (bi-variate case) and <code><a href="#topic+rolwinmulcor_heatmap">rolwinmulcor_heatmap</a></code> (multi-variate case). The bi-variate case follow from a methodological point of view to Telford (2013), Polanco-Martínez (2019), and Polanco-Martínez (2020) whereas the multi-variate case follow to Abdi (2007) and Polanco-Martínez (2020). 
</p>


<h3>Note</h3>

<p>Dependencies: <em>stat</em>, <em>gtools</em>, <em>zoo</em>, <em>pracma</em> and <em>colorspace</em>. 
</p>


<h3>Author(s)</h3>

<p>Josué M. Polanco-Martínez (a.k.a. jomopo).<br />
BC3 - Basque Centre for Climate Change, Bilbao, SPAIN.<br /> 
Web1: <a href="https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en">https://scholar.google.es/citations?user=8djLIhcAAAAJ&amp;hl=en</a>.<br />
Web2: <a href="https://www.researchgate.net/profile/Josue-Polanco-Martinez">https://www.researchgate.net/profile/Josue-Polanco-Martinez</a>.<br />
Email: <a href="mailto:josue.m.polanco@gmail.com">josue.m.polanco@gmail.com</a>, <a href="mailto:josue.polanco@bc3research.org">josue.polanco@bc3research.org</a>. <br /><br />
Acknowledgement:<br /> 
The author acknowledges to the SEPE (Spanish Public Service of Employment) for its funding support. Special thanks to the CRAN team (in particular to Martina Schmirl and Jelena Saf), to Ana-Maria Hereş and Jorge Curie for their helpful comments on the package, and for the three reviewers (this package is described in the paper recently published in <em>Ecological Informatics</em> and that is cited in the References section), in particular Reviewer #2, that provided very useful suggestions to improve RolWinMulCor.  
</p>


<h3>References</h3>

<p>Abdi H. Multiple correlation coefficient, in Encyclopedia of Measurement and
Statistics, N. J. Salkind, Ed. Sage, Thousand Oaks, CA, USA, 2007; 648-651.<br />
&lt;URL: <a href="https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf">https://personal.utdallas.edu/~herve/Abdi-MCC2007-pretty.pdf</a>&gt;. <br />
</p>
<p>Benjamini, Y., and Hochberg, Y. (1995). Controlling the false discovery rate: a practical and powerful approach to multiple testing. Journal of the Royal Statistical Society Series B, 57 (1), 289-300. &lt;URL: doi: <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">10.1111/j.2517-6161.1995.tb02031.x</a>&gt;. <br />
</p>
<p>Polanco-Martínez, J. M. (2019). Dynamic relationship analysis between NAFTA stock markets using nonlinear, nonparametric, non-stationary methods. Nonlinear Dynamics, 97(1), 369-389. &lt;URL: doi: <a href="https://doi.org/10.1007/s11071-019-04974-y">10.1007/s11071-019-04974-y</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M. (2020). RolWinMulCor: an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>
<p>Telford, R.: Running correlations &ndash; running into problems (2013). &lt;URL: <br /> 
<a href="https://quantpalaeo.wordpress.com/2013/01/04/">https://quantpalaeo.wordpress.com/2013/01/04/</a>&gt;. 
</p>

<hr>
<h2 id='syntDATA'>Synthetic data set to test the functions of <em>RolWinMulCor</em>
</h2><span id='topic+syntDATA'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+syntDATA">syntDATA</a></code> contains three columns, the first one is the time and the next three columns are sinusoidal time series that contains two periodical signals (at 11 and 21, with a phase of zero and amplitude of 1 &mdash; please note that these quantities are dimensionless) contaminated by Gaussian noise (with mean of 0 and standard deviation of 0.25) for the intervals 1&ndash;100 (signal at 11) and 200&ndash;400 (signal at 21) and Gaussian noise (with mean of 0 and standard deviation of 1) otherwise (more information about <code><a href="#topic+syntDATA">syntDATA</a></code> in Polanco-Martínez (2020)). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(syntDATA)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format and columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Author's own production (Josué M. Polanco-Martínez). 
</p>


<h3>References</h3>

<p>Polanco-Martínez, J. M. (2020). RolWinMulCor : an R package for estimating rolling window multiple correlation in ecological time series. Ecological Informatics, 60, 101163. &lt;URL: doi: <a href="https://doi.org/10.1016/j.ecoinf.2020.101163">10.1016/j.ecoinf.2020.101163</a>&gt;. <br />
</p>

<hr>
<h2 id='YX_ecological_data'>Ecological data set to test the functions of <em>RolWinMulCor</em> 
</h2><span id='topic+YX_ecological_data'></span>

<h3>Description</h3>

<p>The data set <code><a href="#topic+YX_ecological_data">YX_ecological_data</a></code> contains four columns, the first one (&ldquo;Years&rdquo;) is the time (years from 1700 to 1936), the second is the first component principal (&ldquo;PC1&rdquo;) of the reconstructed Atlantic Bluefin Tuna (BFT) captures (Ganzedo et al., 2016, Polanco-Martínez et al., 2018), the third are reconstructions of sea surface temperature (&ldquo;SST&rdquo;) from the Northern Hemisphere (NH) (Mann et al. 2009), and the fourth column contains reconstructions of total solar irradiance (&ldquo;TSI&rdquo;) (Lean 2000). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(YX_ecological_data)
</code></pre>


<h3>Format</h3>

<p>One file in ASCII format and columns are separated by spaces. 
</p>


<h3>Source</h3>

<p>Ganzedo, U., Polanco-Martínez, J. M., Caballero-Alfonso, A. M., Faria, S. H., Li, J., Castro-Hernández, J. J. (2016). Climate effects on historic bluefin tuna captures in the Gibraltar Strait and Western Mediterranean. Journal of Marine Systems, 158, 84-92. <br /> 
&lt;URL: doi: <a href="https://doi.org/10.1016/j.jmarsys.2016.02.002">10.1016/j.jmarsys.2016.02.002</a>&gt;. <br />
</p>
<p>Lean, J. (2000). Evolution of the Sun's spectral irradiance since the Maunder Minimum. Geophysical Research Letters, 27(16), 2425-2428. &lt;URL: doi: <a href="https://doi.org/10.1029/2000GL000043">10.1029/2000GL000043</a>&gt;. Lean Web TSI data set: &lt;URL: <a href="https://www.ncdc.noaa.gov/paleo-search/study/5788">https://www.ncdc.noaa.gov/paleo-search/study/5788</a>&gt;. <br /> 
</p>
<p>Mann, M.E., Zhang, Z., Rutherford, S., Bradley, R.S., Hughes, M.K., Shindell, Ammann, G., Faluvegi, G., Ni, F. (2009). Global signatures and dynamical origins of the little ice age and medieval climate anomaly. Science 326, 1256-1260. &lt;URL: doi: <a href="https://doi.org/10.1126/science.1177303">10.1126/science.1177303</a>&gt;. Mann et al. Web SST data set: &lt;URL: <a href="http://www.meteo.psu.edu/holocene/public_html/supplements/MultiproxySpatial09/results/nhscr">http://www.meteo.psu.edu/holocene/public_html/supplements/MultiproxySpatial09/results/nhscr</a>&gt;. <br /> 
</p>
<p>Polanco-Martínez, J. M., Caballero-Alfonso, A. M., Ganzedo, U., Castro-Hernández, J. J. (2018). A reconstructed database of historic bluefin tuna captures in the Gibraltar Strait and Western Mediterranean. Data in Brief, 16, 206-210. &lt;URL: doi: <a href="https://doi.org/10.1016/j.dib.2017.11.028">10.1016/j.dib.2017.11.028</a>&gt;. <br /> 
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
