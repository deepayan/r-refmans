<!DOCTYPE html><html lang="en"><head><title>Help for package MRTAnalysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MRTAnalysis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#data_binary'><p>A synthetic data set of an MRT with binary outcome</p></a></li>
<li><a href='#data_mimicHeartSteps'><p>A synthetic data set that mimics the HeartSteps V1 data structure to illustrate</p>
the use of [wcls()] function for continuous outcomes</a></li>
<li><a href='#emee'><p>Estimates the causal excursion effect for binary outcome MRT</p></a></li>
<li><a href='#emee2'><p>Estimates the causal excursion effect for binary outcome MRT</p></a></li>
<li><a href='#summary.emee_fit'><p>Summarize Causal Excursion Effect Fits for MRT with Binary Outcomes</p></a></li>
<li><a href='#summary.wcls_fit'><p>Summarize Causal Excursion Effect Fits for MRT with Continuous Outcomes</p></a></li>
<li><a href='#wcls'><p>Estimates the causal excursion effect for continuous outcome MRT</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Primary and Secondary Analyses for Micro-Randomized Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Estimates marginal causal excursion effects and moderated causal excursion effects for micro-randomized trial (MRT). Applicable to MRT with binary treatment options and continuous or binary outcomes. The method for MRT with continuous outcomes is the weighted centered least squares (WCLS) by Boruvka et al. (2018) &lt;<a href="https://doi.org/10.1080%2F01621459.2017.1305274">doi:10.1080/01621459.2017.1305274</a>&gt;. The method for MRT with binary outcomes is the estimator for marginal excursion effect (EMEE) by Qian et al. (2021) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasaa070">doi:10.1093/biomet/asaa070</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>rootSolve, stats, geepack, sandwich</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-01 20:59:57 UTC; tqian</td>
</tr>
<tr>
<td>Author:</td>
<td>Tianchen Qian <a href="https://orcid.org/0000-0003-4282-7826"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Shaolin Xiang [aut],
  Zhaoxi Cheng [aut],
  Audrey Boruvka [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tianchen Qian &lt;t.qian@uci.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-01 21:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='data_binary'>A synthetic data set of an MRT with binary outcome</h2><span id='topic+data_binary'></span>

<h3>Description</h3>

<p>A synthetic data set of an MRT with binary outcome
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_binary
</code></pre>


<h3>Format</h3>

<p>a data frame with 3000 observations and 10 variables
</p>
<p> This random sample uses the baseline model:
log E(Y_t+1 | A_t = 0, I_t = 1) = alpha_0 + alpha_1 * time / total_T
+ alpha_2 * 1(time &gt; total_T/2),
the treatment effect model:
log relative risk = beta_0 + beta_1 * time / total_T,
the probability of treatment assignment p_t: 0.3, 0.5, 0.7 with repetition,
and exogenous probability of availability: 0.8 at all time points.
</p>
<dl>
<dt>userid</dt><dd><p>individual id number</p>
</dd>
<dt>time</dt><dd><p>decision point index</p>
</dd>
<dt>time_var1</dt><dd><p>time-varying covariate 1, the &quot;standardized time in study&quot;, defined as the current decision point index divided by the total number of decision points</p>
</dd>
<dt>time_var2</dt><dd><p>time-varying covariate 2, indicator of &quot;the second half of the study&quot;, defined as whether the current decision point index is greater than the total number of decision points divided by 2.</p>
</dd>
<dt>Y</dt><dd><p>binary proximal outcome</p>
</dd>
<dt>A</dt><dd><p>treatment assignment, i.e., whether the intervention is randomized to be delivered (=1) or not (=0) at the current decision point</p>
</dd>
<dt>rand_prob</dt><dd><p>the randomization probability P(A=1) for the current decision point</p>
</dd>
<dt>avail</dt><dd><p>whether the individual is available (=1) or not (=0) at the current decision point</p>
</dd>
</dl>


<hr>
<h2 id='data_mimicHeartSteps'>A synthetic data set that mimics the HeartSteps V1 data structure to illustrate
the use of [wcls()] function for continuous outcomes</h2><span id='topic+data_mimicHeartSteps'></span>

<h3>Description</h3>

<p>A synthetic data set that mimics the HeartSteps V1 data structure to illustrate
the use of [wcls()] function for continuous outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_mimicHeartSteps
</code></pre>


<h3>Format</h3>

<p>a data frame with 7770 observations and 9 variables
</p>

<dl>
<dt>userid</dt><dd><p>individual id number</p>
</dd>
<dt>time</dt><dd><p>decision point index</p>
</dd>
<dt>day_in_study</dt><dd><p>day in the study</p>
</dd>
<dt>logstep_30min</dt><dd><p>proximal outcome: the step count in the 30 minutes following the current decision point (log-transformed)</p>
</dd>
<dt>logstep_30min_lag1</dt><dd><p>proximal outcome at the previous decision point (lag-1 outcome): the step count in the 30 minutes following the previous decision point (log-transformed)</p>
</dd>
<dt>logstep_pre30min</dt><dd><p>the step count in the 30 minutes prior to the current decision point (log-transformed); used as a control variable</p>
</dd>
<dt>is_at_home_or_work</dt><dd><p>whether the individual is at home or work (=1) or at other locations (=0) at the current decision point</p>
</dd>
<dt>intervention</dt><dd><p>whether the intervention is randomized to be delivered (=1) or not (=0) at the current decision point</p>
</dd>
<dt>rand_prob</dt><dd><p>the randomization probability P(A=1) for the current decision point</p>
</dd>
<dt>availability</dt><dd><p>whether the individual is available (=1) or not (=0) at the current decision point</p>
</dd>
</dl>


<hr>
<h2 id='emee'>Estimates the causal excursion effect for binary outcome MRT</h2><span id='topic+emee'></span>

<h3>Description</h3>

<p>Returns the estimated causal excursion effect (on log relative risk scale) and the estimated standard error.
Small sample correction using the &quot;Hat&quot; matrix in the variance estimate is implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emee(
  data,
  id,
  outcome,
  treatment,
  rand_prob,
  moderator_formula,
  control_formula,
  availability = NULL,
  numerator_prob = NULL,
  start = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="emee_+3A_data">data</code></td>
<td>
<p>A data set in long format.</p>
</td></tr>
<tr><td><code id="emee_+3A_id">id</code></td>
<td>
<p>The subject id variable.</p>
</td></tr>
<tr><td><code id="emee_+3A_outcome">outcome</code></td>
<td>
<p>The outcome variable.</p>
</td></tr>
<tr><td><code id="emee_+3A_treatment">treatment</code></td>
<td>
<p>The binary treatment assignment variable.</p>
</td></tr>
<tr><td><code id="emee_+3A_rand_prob">rand_prob</code></td>
<td>
<p>The randomization probability variable.</p>
</td></tr>
<tr><td><code id="emee_+3A_moderator_formula">moderator_formula</code></td>
<td>
<p>A formula for the moderator variables. This should
start with ~ followed by the moderator variables. When set to <code>~ 1</code>, a fully
marginal excursion effect (no moderators) is estimated.</p>
</td></tr>
<tr><td><code id="emee_+3A_control_formula">control_formula</code></td>
<td>
<p>A formula for the control variables. This should
start with ~ followed by the control variables. When set to <code>~ 1</code>, only an
intercept is included as the control variable.</p>
</td></tr>
<tr><td><code id="emee_+3A_availability">availability</code></td>
<td>
<p>The availability variable. Use the default value (<code>NULL</code>)
if your MRT doesn't have availability considerations.</p>
</td></tr>
<tr><td><code id="emee_+3A_numerator_prob">numerator_prob</code></td>
<td>
<p>Either a number between 0 and 1, or a variable name for
a column in data. If you are not sure what this is, use the default value (<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="emee_+3A_start">start</code></td>
<td>
<p>A vector of the initial value of the estimators used in the numerical
solver. If using default value (<code>NULL</code>), a vector of 0 will be used internally.
If specifying a non-default value, this needs to be a numeric vector of length
(number of moderator variables including the intercept) +
(number of control variables including the intercept).</p>
</td></tr>
<tr><td><code id="emee_+3A_verbose">verbose</code></td>
<td>
<p>If default ('TRUE'), additional messages will be printed
during data preprocessing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type &quot;emee_fit&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## estimating the fully marginal excursion effect by setting
## moderator_formula = ~ 1
emee(
    data = data_binary,
    id = "userid",
    outcome = "Y",
    treatment = "A",
    rand_prob = "rand_prob",
    moderator_formula = ~1,
    control_formula = ~ time_var1 + time_var2,
    availability = "avail"
)

## estimating the causal excursion effect moderated by time_var1
## by setting moderator_formula = ~ time_var1
emee(
    data = data_binary,
    id = "userid",
    outcome = "Y",
    treatment = "A",
    rand_prob = "rand_prob",
    moderator_formula = ~time_var1,
    control_formula = ~ time_var1 + time_var2,
    availability = "avail"
)
</code></pre>

<hr>
<h2 id='emee2'>Estimates the causal excursion effect for binary outcome MRT</h2><span id='topic+emee2'></span>

<h3>Description</h3>

<p>Returns the estimated causal excursion effect (on log relative risk scale) and the estimated standard error.
Small sample correction using the &quot;Hat&quot; matrix in the variance estimate is implemented.
This is a slightly altered version of <code>emee()</code>, where the treatment
assignment indicator is also centered in the residual term. It would have
similar (but not exactly the same) numerical output as <code>emee()</code>. This
is the estimator based on which the sample size calculator for binary outcome
MRT is developed. (See R package <code>MRTSampleSizeBinary</code>.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emee2(
  data,
  id,
  outcome,
  treatment,
  rand_prob,
  moderator_formula,
  control_formula,
  availability = NULL,
  numerator_prob = NULL,
  start = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="emee2_+3A_data">data</code></td>
<td>
<p>A data set in long format.</p>
</td></tr>
<tr><td><code id="emee2_+3A_id">id</code></td>
<td>
<p>The subject id variable.</p>
</td></tr>
<tr><td><code id="emee2_+3A_outcome">outcome</code></td>
<td>
<p>The outcome variable.</p>
</td></tr>
<tr><td><code id="emee2_+3A_treatment">treatment</code></td>
<td>
<p>The binary treatment assignment variable.</p>
</td></tr>
<tr><td><code id="emee2_+3A_rand_prob">rand_prob</code></td>
<td>
<p>The randomization probability variable.</p>
</td></tr>
<tr><td><code id="emee2_+3A_moderator_formula">moderator_formula</code></td>
<td>
<p>A formula for the moderator variables. This should
start with ~ followed by the moderator variables. When set to <code>~ 1</code>, a fully
marginal excursion effect (no moderators) is estimated.</p>
</td></tr>
<tr><td><code id="emee2_+3A_control_formula">control_formula</code></td>
<td>
<p>A formula for the control variables. This should
start with ~ followed by the control variables. When set to <code>~ 1</code>, only an
intercept is included as the control variable.</p>
</td></tr>
<tr><td><code id="emee2_+3A_availability">availability</code></td>
<td>
<p>The availability variable. Use the default value (<code>NULL</code>)
if your MRT doesn't have availability considerations.</p>
</td></tr>
<tr><td><code id="emee2_+3A_numerator_prob">numerator_prob</code></td>
<td>
<p>Either a number between 0 and 1, or a variable name for
a column in data. If you are not sure what this is, use the default value (<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="emee2_+3A_start">start</code></td>
<td>
<p>A vector of the initial value of the estimators used in the numerical
solver. If using default value (<code>NULL</code>), a vector of 0 will be used internally.
If specifying a non-default value, this needs to be a numeric vector of length
(number of moderator variables including the intercept) +
(number of control variables including the intercept).</p>
</td></tr>
<tr><td><code id="emee2_+3A_verbose">verbose</code></td>
<td>
<p>If default ('TRUE'), additional messages will be printed
during data preprocessing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type &quot;emee_fit&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## estimating the fully marginal excursion effect by setting
## moderator_formula = ~ 1
emee2(
    data = data_binary,
    id = "userid",
    outcome = "Y",
    treatment = "A",
    rand_prob = "rand_prob",
    moderator_formula = ~1,
    control_formula = ~ time_var1 + time_var2,
    availability = "avail"
)

## estimating the causal excursion effect moderated by time_var1
## by setting moderator_formula = ~ time_var1
emee2(
    data = data_binary,
    id = "userid",
    outcome = "Y",
    treatment = "A",
    rand_prob = "rand_prob",
    moderator_formula = ~time_var1,
    control_formula = ~ time_var1 + time_var2,
    availability = "avail"
)
</code></pre>

<hr>
<h2 id='summary.emee_fit'>Summarize Causal Excursion Effect Fits for MRT with Binary Outcomes</h2><span id='topic+summary.emee_fit'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;emee_fit&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'emee_fit'
summary(
  object,
  lincomb = NULL,
  conf_level = 0.95,
  show_control_fit = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.emee_fit_+3A_object">object</code></td>
<td>
<p>An object of class &quot;emee_fit&quot;.</p>
</td></tr>
<tr><td><code id="summary.emee_fit_+3A_lincomb">lincomb</code></td>
<td>
<p>A vector of length p (p is the number of moderators including
intercept) or a matrix with p columns. When not set to 'NULL',
the summary will include the specified linear combinations of the causal excursion
effect coefficients and the corresponding confidence interval, standard error,
and p-value.</p>
</td></tr>
<tr><td><code id="summary.emee_fit_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for
confidence intervals. Default to 0.95.</p>
</td></tr>
<tr><td><code id="summary.emee_fit_+3A_show_control_fit">show_control_fit</code></td>
<td>
<p>A logical value of whether the fitted coefficients
for the control variables will be printed in the summary. Default to FALSE.
(Interpreting the fitted coefficients for control variables is not recommended.)</p>
</td></tr>
<tr><td><code id="summary.emee_fit_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the original function call and the estimated causal excursion effect
coefficients, confidence interval with conf_level, standard error, t-statistic value,
degrees of freedom, and p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- emee(
    data = data_binary,
    id = "userid",
    outcome = "Y",
    treatment = "A",
    rand_prob = "rand_prob",
    moderator_formula = ~time_var1,
    control_formula = ~ time_var1 + time_var2,
    availability = "avail",
    numerator_prob = 0.5,
    start = NULL
)
summary(fit)
</code></pre>

<hr>
<h2 id='summary.wcls_fit'>Summarize Causal Excursion Effect Fits for MRT with Continuous Outcomes</h2><span id='topic+summary.wcls_fit'></span>

<h3>Description</h3>

<p><code>summary</code> method for class &quot;wcls_fit&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wcls_fit'
summary(
  object,
  lincomb = NULL,
  conf_level = 0.95,
  show_control_fit = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.wcls_fit_+3A_object">object</code></td>
<td>
<p>An object of class &quot;wcls_fit&quot;.</p>
</td></tr>
<tr><td><code id="summary.wcls_fit_+3A_lincomb">lincomb</code></td>
<td>
<p>A vector of length p (p is the number of moderators including
intercept) or a matrix with p columns. When not set to 'NULL',
the summary will include the specified linear combinations of the causal excursion
effect coefficients and the corresponding confidence interval, standard error,
and p-value.</p>
</td></tr>
<tr><td><code id="summary.wcls_fit_+3A_conf_level">conf_level</code></td>
<td>
<p>A numeric value indicating the confidence level for
confidence intervals. Default to 0.95.</p>
</td></tr>
<tr><td><code id="summary.wcls_fit_+3A_show_control_fit">show_control_fit</code></td>
<td>
<p>A logical value of whether the fitted coefficients
for the control variables will be printed in the summary. Default to FALSE.
(Interpreting the fitted coefficients for control variables is not recommended.)</p>
</td></tr>
<tr><td><code id="summary.wcls_fit_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the original function call and the estimated causal excursion effect
coefficients, 95
value or Wald-statistic value (depending on whether sample size is &lt; 50),
degrees of freedom, and p-value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- wcls(
    data = data_mimicHeartSteps,
    id = "userid",
    outcome = "logstep_30min",
    treatment = "intervention",
    rand_prob = 0.6,
    moderator_formula = ~1,
    control_formula = ~logstep_pre30min,
    availability = "avail",
    numerator_prob = 0.6
)
summary(fit)
</code></pre>

<hr>
<h2 id='wcls'>Estimates the causal excursion effect for continuous outcome MRT</h2><span id='topic+wcls'></span>

<h3>Description</h3>

<p>Returns the estimated causal excursion effect (on additive scale) and the estimated standard error.
Small sample correction using the &quot;Hat&quot; matrix in the variance estimate is implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wcls(
  data,
  id,
  outcome,
  treatment,
  rand_prob,
  moderator_formula,
  control_formula,
  availability = NULL,
  numerator_prob = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wcls_+3A_data">data</code></td>
<td>
<p>A data set in long format.</p>
</td></tr>
<tr><td><code id="wcls_+3A_id">id</code></td>
<td>
<p>The subject id variable.</p>
</td></tr>
<tr><td><code id="wcls_+3A_outcome">outcome</code></td>
<td>
<p>The outcome variable.</p>
</td></tr>
<tr><td><code id="wcls_+3A_treatment">treatment</code></td>
<td>
<p>The binary treatment assignment variable.</p>
</td></tr>
<tr><td><code id="wcls_+3A_rand_prob">rand_prob</code></td>
<td>
<p>The randomization probability variable.</p>
</td></tr>
<tr><td><code id="wcls_+3A_moderator_formula">moderator_formula</code></td>
<td>
<p>A formula for the moderator variables. This should
start with ~ followed by the moderator variables. When set to <code>~ 1</code>, a fully
marginal excursion effect (no moderators) is estimated.</p>
</td></tr>
<tr><td><code id="wcls_+3A_control_formula">control_formula</code></td>
<td>
<p>A formula for the control variables. This should
start with ~ followed by the control variables. When set to <code>~ 1</code>, only an
intercept is included as the control variable.</p>
</td></tr>
<tr><td><code id="wcls_+3A_availability">availability</code></td>
<td>
<p>The availability variable. Use the default value (<code>NULL</code>)
if your MRT doesn't have availability considerations.</p>
</td></tr>
<tr><td><code id="wcls_+3A_numerator_prob">numerator_prob</code></td>
<td>
<p>Either a number between 0 and 1, or a variable name for
a column in data. If you are not sure what this is, use the default value (<code>NULL</code>).</p>
</td></tr>
<tr><td><code id="wcls_+3A_verbose">verbose</code></td>
<td>
<p>If default ('TRUE'), additional messages will be printed
during data preprocessing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type &quot;wcls_fit&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wcls(
    data = data_mimicHeartSteps,
    id = "userid",
    outcome = "logstep_30min",
    treatment = "intervention",
    rand_prob = 0.6,
    moderator_formula = ~1,
    control_formula = ~logstep_pre30min,
    availability = "avail",
    numerator_prob = 0.6
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
