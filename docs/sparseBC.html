<!DOCTYPE html><html><head><title>Help for package sparseBC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sparseBC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#image.sparseBC'>
<p>Image plot of an object of class <code>sparseBC</code> or <code>matrixBC</code></p></a></li>
<li><a href='#lung'>
<p>Lung cancer gene expression data</p></a></li>
<li><a href='#matrixBC'>
<p>MVN biclustering</p></a></li>
<li><a href='#matrixBC.BIC'>
<p>Do tuning parameter (lambda) selection for MVN biclustering via BIC criterion</p></a></li>
<li><a href='#sparseBC'>
<p>Sparse biclustering</p></a></li>
<li><a href='#sparseBC-package'>
<p>Fit sparse biclustering and matrix-variate normal biclustering</p></a></li>
<li><a href='#sparseBC.BIC'>
<p>Do tuning parameter (lambda) selection for sparse biclustering via BIC criterion</p></a></li>
<li><a href='#sparseBC.choosekr'>
<p>Do tuning parameter K and R selection for sparse biclustering via cross-validation.</p></a></li>
<li><a href='#summary.sparseBC'>
<p>Plot an object of class <code>sparseBC</code> or <code>matrixBC</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sparse Biclustering of Transposable Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Kean Ming Tan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kean Ming Tan &lt;keanming@u.washington.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>glasso</td>
</tr>
<tr>
<td>Imports:</td>
<td>fields</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the sparse biclustering proposal of Tan and Witten (2014), Sparse biclustering of transposable data. Journal of Computational and Graphical Statistics  23(4):985-1008.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-19 02:59:59 UTC; keanmingtan</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-19 05:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='image.sparseBC'>
Image plot of an object of class <code>sparseBC</code> or <code>matrixBC</code>
</h2><span id='topic+image.sparseBC'></span><span id='topic+image.matrixBC'></span>

<h3>Description</h3>

<p>This function plots a <code>sparseBC</code> or <code>matrixBC</code> object &mdash; the estimated bicluster mean matrix for the observations and features
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sparseBC'
image(x, labelx = TRUE, labely = TRUE, arrangex = FALSE, arrangey = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="image.sparseBC_+3A_x">x</code></td>
<td>

<p>an object of class <code>sparseBC</code> or <code>matrixBC</code>
</p>
</td></tr>
<tr><td><code id="image.sparseBC_+3A_labelx">labelx</code></td>
<td>

<p>label the x-axis with the features number.  The default is labelx=TRUE
</p>
</td></tr>
<tr><td><code id="image.sparseBC_+3A_labely">labely</code></td>
<td>

<p>label the y-axis with the observations number.  The default is labely=TRUE
</p>
</td></tr>
<tr><td><code id="image.sparseBC_+3A_arrangex">arrangex</code></td>
<td>

<p>Rearrange the features/columns such that they are grouped into their respective clusters for the image plot.  The default is arrangex=FALSE
</p>
</td></tr>
<tr><td><code id="image.sparseBC_+3A_arrangey">arrangey</code></td>
<td>

<p>Rearrange the observations/rows such that they are grouped into their respective clusters for the image plot.  The default is arrangey=FALSE.
</p>
</td></tr>
<tr><td><code id="image.sparseBC_+3A_...">...</code></td>
<td>

<p>additional parameters to be passed to <code><a href="Matrix.html#topic+image">image</a></code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function plots the estimated mean matrix from  <code><a href="#topic+sparseBC">sparseBC</a></code> or <code><a href="#topic+matrixBC">matrixBC</a></code>.  The columns are the features and the rows are  the observations.
</p>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>#
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+matrixBC">matrixBC</a></code>
<code><a href="#topic+summary.sparseBC">summary.sparseBC</a></code>
<code><a href="#topic+sparseBC.BIC">sparseBC.BIC</a></code>
<code><a href="#topic+sparseBC.choosekr">sparseBC.choosekr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See example in sparseBC
</code></pre>

<hr>
<h2 id='lung'>
Lung cancer gene expression data
</h2><span id='topic+lung'></span>

<h3>Description</h3>

<p>This data set consists of gene expression values of a subset of 5000 genes with the highest variance of the 12 625 genes measured using the Affymetrix 95av2 GeneChip on a set of 56 samples - 20 pulmonary carcinoid samples (Carcinoid), 6 small cell lung carcinoma samples (SmallCell), 13 colon cancer metastasis samples (Colon), and 16 normal lung samples (Normal). This example is used in Lee, Shen, Huang, and Marron (2010).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(lung)</code></pre>


<h3>Format</h3>

<p>The format is an n x p matrix:
(1) the rows are the samples - rownames containing the class labels.
(2) the columns are the genes - colnames containing the affymetrix gene ids. 
</p>


<h3>Source</h3>

<p>This data set was published in the following paper:
</p>
<p>Bhattacharjee, A., Richards, W., Staunton, J., Li, C., Monti, S., Vasa, P., Ladd, C., Beheshti, J., Bueno, R., Gillette, M., and others. (2001)  Classification of human lung carcinomas by mRNA expression profiling reveals distinct adenocarcinoma subclasses.  Proceedings of the National Academy of Sciences of the United States of America, 98(24), 13790&ndash;13795.  
</p>
<p>It is publicly available at http://www.pnas.org/content/98/24/13790/suppl/DC1
</p>


<h3>References</h3>

<p>Bhattacharjee et al. (2001) Classification of human lung carcinomas by mRNA expression profiling reveals distinct adenocarcinoma subclasses.  Proceedings of the National Academy of Sciences of the United States of America, 98(24), 13790&ndash;13795  
</p>
<p>Used as an example in Lee, Shen, Huang, and Marron (2010), 'Biclustering via sparse singular value decomposition', Biometrics 66(4), 1087&ndash;1095.
</p>
<p>Used as an example in KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lung)
</code></pre>

<hr>
<h2 id='matrixBC'>
MVN biclustering
</h2><span id='topic+matrixBC'></span>

<h3>Description</h3>

<p>This function performs MVN biclustering on a n by p matrix.  Details are given in Tan and Witten (2014).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixBC(x, k, r, lambda, alpha, beta, nstart = 20, Cs.init = NULL,
 Ds.init = NULL, max.iter = 50, threshold = 1e-04, Sigma.init = NULL, 
 Delta.init = NULL, center=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrixBC_+3A_x">x</code></td>
<td>

<p>Data matrix; samples are rows and columns are features.  Cannot contain missing values.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_k">k</code></td>
<td>

<p>The number of row clusters, i.e., the number of clusters for the observations.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_r">r</code></td>
<td>

<p>The number of column clusters, i.e., the number of clusters for the features.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_lambda">lambda</code></td>
<td>

<p>Non-negative regularization parameter for lasso on the mean of each bicluster.  lambda=0 means no regularization.    
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_alpha">alpha</code></td>
<td>

<p>Non-negative regularization parameter for the graphical lasso to estimate the covariance matrix of the samples.  alpha=0 means no regularization.  alpha&gt;0 is recommended.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_beta">beta</code></td>
<td>

<p>Non-negative regularization parameter for the graphical lasso to estimate the covariance matrix of the features.  beta=0 means no regularization.  beta&gt;0 is recommended.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_nstart">nstart</code></td>
<td>

<p>The number of random initialization sets used in the kmeans function.  The default is 20.
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_cs.init">Cs.init</code></td>
<td>

<p>Starting values for the row labels.  The default value is NULL &ndash; kmeans clustering is performed to estimate the row labels.  
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_ds.init">Ds.init</code></td>
<td>

<p>Starting values for the column labels.  The default value is NULL &ndash; kmeans clustering is performed to estimate the column labels. 
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_max.iter">max.iter</code></td>
<td>

<p>Maximum number of iterations.  The default value is 50 iterations.  
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_threshold">threshold</code></td>
<td>

<p>Threshold value for convergence.  The default is 1e-4.     
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_sigma.init">Sigma.init</code></td>
<td>

<p>Starting values for the covariance matrix of the observations.  The default value is NULL &ndash; the graphical lasso as described in Friedman, Hastie, and Tibshirani (2008) is performed to estimate the covariance matrix of the observations. 
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_delta.init">Delta.init</code></td>
<td>

<p>Starting values for the covariance matrix of the features.  The default value is NULL &ndash; the graphical lasso as described in  Friedman, Hastie, and Tibshirani (2008) is performed to estimate the covariance matrix of the features. 
</p>
</td></tr>
<tr><td><code id="matrixBC_+3A_center">center</code></td>
<td>

<p>Mean center the data matrix before performing sparse biclustering.  The default is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements MVN biclustering using Algorithm (3) described in Tan and Witten (2014) 'Sparse biclustering of transposable data'.  This approach takes into account the correlation among the features  within the same cluster and also takes into account the correlation among the observations within the same cluster.  The row labels for the observations and column labels for the features are estimated and the mean of each bicluster is encouraged to be sparse using the lasso penalty.  Details are given in Algorithm (3) in Tan and Witten (2014).  
</p>
<p>If Sigma.init and Delta.init are NULL, the graphical lasso in Friedman, Hastie, and Tibshirani (2008) is used to estimated the covariance matrix of the observations and features.  If Sigma.init is provided, then the covariance matrices would not be updated in the algorithm. Note that when Sigma and Delta equal the identity matrix up to a scaling factor, this approach is exactly that of sparse biclustering and the function sparseBC should be used.  
</p>
<p>Note that most of the computation time comes from the graphical lasso algorithm.  We recommend setting the tuning parameters alpha and beta to be large so that the graphical lasso can be implemented efficiently (see the glasso package).  When n &gt; p, alpha=0 will return an error.  Similarly, when p &gt; n, beta=0 will return an error.
</p>
<p>If center=TRUE, the data matrix x is mean centered before performing sparse biclustering.  The reported mean matrix mus is the addition of the substracted mean, mean(x), and the estimated mean matrix from sparse biclustering on the mean centered data.   
</p>


<h3>Value</h3>

<p>an object of class matrixBC.  
</p>
<p>Among some internal variables, this object includes the elements
</p>
<table>
<tr><td><code>Cs</code></td>
<td>
<p>Cs is the output for the row labels.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>Ds is the output for the column labels.</p>
</td></tr>
<tr><td><code>mus</code></td>
<td>
<p>mus is the estimated mean matrix for the entire matrix.</p>
</td></tr>
<tr><td><code>Mus</code></td>
<td>
<p>Mus is the estimated mean matrix for each bicluster.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>Sigma is the estimated covariance matrix of the observations.</p>
</td></tr>
<tr><td><code>Delta</code></td>
<td>
<p>Delta is the estimated covariance matrix of the features.</p>
</td></tr>
<tr><td><code>objs</code></td>
<td>
<p>objs is the maximized objective value of the negative l1 penalized log-likelihood of the matrix-variate normal distribution.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>The number of iterations until convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>
<p>J Friedman, T Hastie, and R Tibshirani (2008). Sparse inverse covariance estimation with the lasso.  <em>Biostatistics</em> 9, 432&ndash;441.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+matrixBC.BIC">matrixBC.BIC</a></code>
<code><a href="#topic+summary.matrixBC">summary.matrixBC</a></code>
<code><a href="#topic+image.matrixBC">image.matrixBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Lung cancer data
# Not run to save time
#data(lung)
#truecluster&lt;-as.numeric(as.factor(rownames(lung)))
#cancersd&lt;-apply(lung,2,sd)
# Pick the top 400 genes that have the largest standard deviation
#lung&lt;-lung[,rank(cancersd)&gt;=length(cancersd)-399]

# Example of MVN Biclustering
#set.seed(5)
#res&lt;-matrixBC(lung,k=4,r=10,lambda=60,alpha=0.4,beta=0.4) 
# one misclassification
#res$Cs

# lambda chosen such that the estimated mean matirx ofsparseBC has a
# similar number of nonzero as matrixBC
#res2&lt;-sparseBC(lung,k=4,r=10,lambda=230)
# a few observations are being misclassified
#res2$Cs

# print information from the object matrixBC
#summary(res)

# Plot the estimated mean matris for the object matrixBC
#image(res)

</code></pre>

<hr>
<h2 id='matrixBC.BIC'>
Do tuning parameter (lambda) selection for MVN biclustering via BIC criterion
</h2><span id='topic+matrixBC.BIC'></span>

<h3>Description</h3>

<p>We assume that both K and R are known.  A range of values of lambda is usually considered - value that results in the lowest BIC is selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrixBC.BIC(x, k, r, lambda, alpha = 0.2, beta = 0.2, nstart = 20, 
Sigma.init = NULL, Delta.init = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrixBC.BIC_+3A_x">x</code></td>
<td>

<p>Data matrix; samples are rows and columns are features.  Cannot contain missing values.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_k">k</code></td>
<td>

<p>The number of row clusters, i.e., the number of clusters for the observations.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_r">r</code></td>
<td>

<p>The number of column clusters, i.e., the number of clusters for the features.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_lambda">lambda</code></td>
<td>

<p>A range of values of tuning parameters to be considered.  All values must be non-negative.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_alpha">alpha</code></td>
<td>

<p>Non-negative regularization parameter for the graphical lasso to estimate the covariance matrix of the samples.  lambda=0 means no regularization.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_beta">beta</code></td>
<td>

<p>Non-negative regularization parameter for the graphical lasso to estimate the covariance matrix of the features.  lambda=0 means no regularization.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_nstart">nstart</code></td>
<td>

<p>The number of random initialization sets used in the kmeans function.  The default is 20.
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_sigma.init">Sigma.init</code></td>
<td>

<p>Starting values for the covariance matrix of the observations.  The default value is NULL &ndash; the graphical lasso as described in  Friedman, Hastie, and Tibshirani (2007) is performed to estimate the covariance matrix of the observations. 
</p>
</td></tr>
<tr><td><code id="matrixBC.BIC_+3A_delta.init">Delta.init</code></td>
<td>

<p>Starting values for the covariance matrix of the features.  The default value is NULL &ndash; the graphical lasso as described in  Friedman, Hastie, and Tibshirani (2007) is performed to estimate the covariance matrix of the features. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements the tuning parameter selection for MVN biclustering using BIC criterion as described in Section 5.2 in Tan and Witten (2014) 'Sparse biclustering of transposable data'.  The BIC criterion is BIC = np x log(RSS) + np log(q) where RSS is the usual residual sum of squares, and q is the number of non-zero bicluster mean in the output of matrixBC.  We select the value of lambda that leads to the smallest BIC.  
</p>
<p>The data is centered to have mean 0 in this function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda that results in lowest BIC.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC values for a range of tuning parameters considered.</p>
</td></tr>
<tr><td><code>nonzeromus</code></td>
<td>
<p>Number of nonzero bicluster means for a range of tuning parameters considered.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matrixBC">matrixBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>########### Create data matrix
#x &lt;- matrix(rnorm(20*30),nrow=20,ncol=30)

########### Perform sparseBC.BIC to select lambda
#lambda&lt;-matrixBC.BIC(x,k=2,r=2,lambda=c(0,10,20,30,40),alpha=0.2,beta=0.2)$lambda
</code></pre>

<hr>
<h2 id='sparseBC'>
Sparse biclustering
</h2><span id='topic+sparseBC'></span>

<h3>Description</h3>

<p>This function performs sparse biclustering on an n by p matrix.  Details are given in Tan and Witten (2014).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparseBC(x, k, r, lambda, nstart = 20, Cs.init = NULL, Ds.init = NULL,
 max.iter = 1000,threshold=1e-10,center=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparseBC_+3A_x">x</code></td>
<td>

<p>Data matrix; samples are rows and columns are features.  Cannot contain missing values.
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_k">k</code></td>
<td>

<p>The number of row clusters, i.e., the number of clusters for the observations.
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_r">r</code></td>
<td>

<p>The number of column clusters, i.e., the number of clusters for the features.
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_lambda">lambda</code></td>
<td>

<p>Non-negative regularization parameter for lasso on the mean of each bicluster.  lambda=0 means no regularization.    
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_nstart">nstart</code></td>
<td>

<p>The number of random initialization sets used in the kmeans function.  The default is 20.
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_cs.init">Cs.init</code></td>
<td>

<p>Starting values for the row labels.  The default value is NULL &ndash; kmeans clustering is performed to estimate the row labels.  
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_ds.init">Ds.init</code></td>
<td>

<p>Starting values for the column labels.  The default value is NULL &ndash; kmeans clustering is performed to estimate the column labels. 
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_max.iter">max.iter</code></td>
<td>

<p>Maximum number of iterations.  The default value is 1000 iterations.  
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_threshold">threshold</code></td>
<td>

<p>Threshold value for convergence.  The default is 1e-10.     
</p>
</td></tr>
<tr><td><code id="sparseBC_+3A_center">center</code></td>
<td>

<p>Mean center the data matrix before performing sparse biclustering.  The default is TRUE.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements sparse biclustering using Algorithm (1) described in Tan and Witten (2014) 'Sparse biclustering of transposable data', which estimates the  row labels for the observations and column labels for the features.  The mean of each bicluster is encouraged to be sparse using the lasso penalty.  Details are given in Algorithm (1) in Tan and Witten (2014). 
</p>
<p>If center=TRUE, the data matrix x is mean centered before performing sparse biclustering.  The reported mean matrix mus is the addition of the substracted mean, mean(x), and the estimated mean matrix from sparse biclustering on the mean centered data. 
</p>
<p>Note that center=TRUE will not give any estimated mean to be zero, unless the data is initially centered to have mean(x)=0. Instead, when center=TRUE, elements of the mean matrix are shrunken towards mean(x). 
</p>


<h3>Value</h3>

<p>an object of class sparseBC.  
</p>
<p>Among some internal variables, this object includes the elements
</p>
<table>
<tr><td><code>Cs</code></td>
<td>
<p>Cs is the output for the row labels.</p>
</td></tr>
<tr><td><code>Ds</code></td>
<td>
<p>Ds is the output for the column labels.</p>
</td></tr>
<tr><td><code>objs</code></td>
<td>
<p>objs is the minimized objective value of the l1 penalized log-likelihood.</p>
</td></tr>
<tr><td><code>mus</code></td>
<td>
<p>mus is the estimated mean matrix for the entire matrix.</p>
</td></tr>
<tr><td><code>Mus</code></td>
<td>
<p>Mus is the estimated mean matrix for each bicluster.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>The number of iterations until convergence.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC.BIC">sparseBC.BIC</a></code>
<code><a href="#topic+sparseBC.choosekr">sparseBC.choosekr</a></code>
<code><a href="#topic+summary.sparseBC">summary.sparseBC</a></code>
<code><a href="#topic+image.sparseBC">image.sparseBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##############################################
# Example from Figure 1 in the manuscript
# A toy example to illustrate the results from k-means and sparse biclustering
##############################################

# Generate the data matrix x
set.seed(1)
n&lt;-100
p&lt;-200
k&lt;-5
r&lt;-5
truthCs&lt;-rep(1:k, each=(n/k))
truthDs&lt;-rep(1:r, each=(p/r))
mus&lt;-runif(k*r,-3,3)
mus&lt;-matrix(c(mus),nrow=k,ncol=r,byrow=FALSE)
x&lt;-matrix(rnorm(n*p,mean=0,sd=5),nrow=n,ncol=p)

# Generate the mean matrix 
musmatrix&lt;-matrix(NA,nrow=n,ncol=p)
for(i in 1:max(truthCs)){
  for(j in 1:max(truthDs)){ 
  x[truthCs==i,truthDs==j]&lt;-x[truthCs==i,truthDs==j]+mus[i,j]
  musmatrix[truthCs==i,truthDs==j]&lt;-mus[i,j]
  } 
}	

# Perform kmeans on the row and columns and calculate its mean
km.Cs&lt;-kmeans(x,k,nstart=20)$cluster
km.Ds&lt;-kmeans(t(x),r,nstart=20)$cluster
km.mus&lt;-matrix(NA,nrow=n,ncol=p)
for(i in 1:n){
  for(j in 1:p){
  km.mus[i,j]&lt;-mean(x[km.Cs==km.Cs[i],km.Ds==km.Ds[j]])		
  }
}

# Perform sparse biclustering with 5 row clusters and 5 column clusters and lambda=0
bicluster&lt;-sparseBC(x,5,5,0)


# Display some information on the object sparseBC
summary(bicluster)


# Image plots to illustrate the estimated mean matrix
par(mfrow=c(2,2))
image(t(x),main="x")
image(t(musmatrix),main="Mean Matrix")
image(t(km.mus),main="Kmeans")
image(t(bicluster$mus),main="sparseBC")

# Built-in image plot for object sparseBC
image(bicluster)
</code></pre>

<hr>
<h2 id='sparseBC-package'>
Fit sparse biclustering and matrix-variate normal biclustering
</h2><span id='topic+sparseBC-package'></span>

<h3>Description</h3>

<p>This package is called sparseBC, for &quot;Sparse biclustering&quot;.  It implements two methods:Sparse biclustering and matrix-variate normal biclustering.  All are described in the paper &quot;Sparse biclustering of tranposable data&quot;, by KM Tan and D Witten (2014), <em>Journal of Computational and Graphical Statistics</em>.
</p>
<p>The main functions are as follows:
(1) sparseBC
(2) matrixBC
</p>
<p>The first function, sparseBC, performs sparse biclustering.  matrixBC performs matrix-variate normal biclustering.  There are also cross-validation functions for tuning parameter that controls the sparsity level of the estimated mean matrix: sparseBC.BIC and matrixBC.BIC.  Function that choose the number of biclusters K and R are also included for sparseBC, called sparseBC.choosekr.   	
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> sparseBC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-02-09</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2.0) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package includes the following functions:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+sparseBC">sparseBC</a></code>: </td><td style="text-align: left;"> Perform sparse biclustering</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+sparseBC.choosekr">sparseBC.choosekr</a></code>: </td><td style="text-align: left;"> Cross-validation to select the number of row and column clusters	</td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+sparseBC.BIC">sparseBC.BIC</a></code>: </td><td style="text-align: left;"> Select sparsity tuning parameter for sparseBC </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+summary.sparseBC">summary.sparseBC</a></code>: </td><td style="text-align: left;"> Display information for the object sparseBC </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+image.sparseBC">image.sparseBC</a></code>: </td><td style="text-align: left;"> Image plot for the estimated bicluster mean matrix </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+matrixBC">matrixBC</a></code>:</td><td style="text-align: left;"> Perform matrix-variate normal biclustering </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+matrixBC.BIC">matrixBC.BIC</a></code>:</td><td style="text-align: left;"> Select sparsity tuning parameter for matrixBC</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Kean Ming Tan
</p>
<p>Maintainer: Kean Ming Tan &lt;keanming@u.washington.edu&gt;
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+matrixBC">matrixBC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># An example that violates the assumption of contiguous biclusters
# Create mean matrix and the data matrix
#set.seed(5)
#u&lt;-c(10,9,8,7,6,5,4,3,rep(2,17),rep(0,75))
#v&lt;-c(10,-10,8,-8,5,-5,rep(3,5),rep(-3,5),rep(0,34))
#u&lt;-u/sqrt(sum(u^2))
#v&lt;-v/sqrt(sum(v^2))
#d&lt;-50
#mus&lt;-d*tcrossprod(u,v)
#binaryX&lt;-(mus!=0)*1
#X&lt;-mus+matrix(rnorm(100*50),100,50)
#X&lt;-X-mean(X)

# The number of biclusters are chosen automatically
# Commented out for short run-time
#KR&lt;-sparseBC.choosekr(X,1:6,1:6,0,0.1,trace=TRUE)
#k&lt;-KR$estimated_kr[1]
#r&lt;-KR$estimated_kr[2]

# The value of lambda is chosen automatically
#lambda&lt;-sparseBC.BIC(X,k,r,c(0,10,20,30,40,50))$lambda

# Perform sparse biclustering using the K, R, and lambda chosen
#biclustering&lt;-sparseBC(X,k,r,lambda)

# Display some information on the object sparseBC
#summary(biclustering)

# Plot the estimated mean matrix from sparseBC
#image(biclustering)
</code></pre>

<hr>
<h2 id='sparseBC.BIC'>
Do tuning parameter (lambda) selection for sparse biclustering via BIC criterion
</h2><span id='topic+sparseBC.BIC'></span>

<h3>Description</h3>

<p>We assume that both K and R are known.  A range of values of lambda is usually considered - value that results in the lowest BIC is selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparseBC.BIC(x, k, r, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparseBC.BIC_+3A_x">x</code></td>
<td>

<p>Data matrix; samples are rows and columns are features.  Cannot contain missing values.
</p>
</td></tr>
<tr><td><code id="sparseBC.BIC_+3A_k">k</code></td>
<td>

<p>The number of row clusters, i.e., the number of clusters for the observations.
</p>
</td></tr>
<tr><td><code id="sparseBC.BIC_+3A_r">r</code></td>
<td>

<p>The number of column clusters, i.e., the number of clusters for the features.
</p>
</td></tr>
<tr><td><code id="sparseBC.BIC_+3A_lambda">lambda</code></td>
<td>

<p>A range of values of tuning parameters to be considered.  All values must be non-negative.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This implements the tuning parameter selection using BIC criterion for sparse biclustering as described in Section 5.2 in Tan and Witten (2014) 'Sparse biclustering of transposable data'.  The BIC criterion is BIC = np x log(RSS) + np log(q) where RSS is the usual residual sum of squares, and q is the number of non-zero bicluster mean in the output of sparseBC.  We select the value of lambda that leads to the smallest BIC.  
</p>
<p>The data is centered to have mean 0 in this function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>lambda</code></td>
<td>
<p>Value of lambda that results in lowest BIC.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>BIC values for a range of tuning parameters considered.</p>
</td></tr>
<tr><td><code>nonzeromus</code></td>
<td>
<p>Number of nonzero bicluster means for a range of tuning parameters considered.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+sparseBC.choosekr">sparseBC.choosekr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>########### Create data matrix
x &lt;- matrix(rnorm(20*30),nrow=20,ncol=30)

########### Perform sparseBC.BIC to select lambda
lambda&lt;-sparseBC.BIC(x,k=2,r=2,lambda=c(0,10,20,30,40))$lambda 
</code></pre>

<hr>
<h2 id='sparseBC.choosekr'>
Do tuning parameter K and R selection for sparse biclustering via cross-validation.
</h2><span id='topic+sparseBC.choosekr'></span>

<h3>Description</h3>

<p>Perform cross-validation to select K (number of row clusters) and R (number of column clusters) for sparse biclustering.  We assume that lambda is known.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sparseBC.choosekr(x, k, r, lambda, percent = 0.1, trace=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sparseBC.choosekr_+3A_x">x</code></td>
<td>

<p>Data matrix; samples are rows and columns are features.  Cannot contain missing values.
</p>
</td></tr>
<tr><td><code id="sparseBC.choosekr_+3A_k">k</code></td>
<td>

<p>A range of values of K to be considered.  Values considered must be an increasing sequence.
</p>
</td></tr>
<tr><td><code id="sparseBC.choosekr_+3A_r">r</code></td>
<td>

<p>A range of values of R to be considered.  Values considered must be an increasing sequence.
</p>
</td></tr>
<tr><td><code id="sparseBC.choosekr_+3A_lambda">lambda</code></td>
<td>

<p>Non-negative regularization parameter for lasso.  lambda=0 means no regularization.    
</p>
</td></tr>
<tr><td><code id="sparseBC.choosekr_+3A_percent">percent</code></td>
<td>

<p>Percentage of elements of x to be left out for cross-validation.  1 must be divisible by the specified percentage.  The default value is 0.1.
</p>
</td></tr>
<tr><td><code id="sparseBC.choosekr_+3A_trace">trace</code></td>
<td>

<p>Print out progress as iterations are performed.  Default is FALSE.
</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>The function performs cross-validation as described in Algorithm (2) in Tan and Witten (2014) 'Sparse biclustering of transposable data'.  Briefly, it works as follows: (1) some percent of the elements of x is removed at random from the data matrix - call those elements missing elements, (2) the missing elements are imputed using the mean of the other elements of the matrix, (3) sparse biclustering is performed with various values of K and R and the mean matrix is estimated, (4) calculate the sum of squared error of the missing values between x and the estimated mean matrix.  This procedure is repeated 1/percent times.  Finally, we select K and R based on the criterion described in Algorithm (2) in Tan and Witten (2014).  A similar procedure is used in Witten et al (2009) 'A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis'.     
</p>
<p>Note that sparseBC is run with center=TRUE in this function.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>estimated_kr</code></td>
<td>
<p>The chosen values of K and R based on cross-validation.</p>
</td></tr>
<tr><td><code>results.mean</code></td>
<td>
<p>Mean squared error for all values of K and R considered.</p>
</td></tr>
<tr><td><code>results.se</code></td>
<td>
<p>Standard error of the sum of squared error for all values of K and R considered.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>KM Tan and D Witten (2014) Sparse biclustering of transposable data.  <em>Journal of Computational and Graphical Statistics</em> 23(4):985-1008.
</p>
<p>D Witten, R Tibshirani, and T Hastie (2009) A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis, <em>Biostatistics</em> 10(3), 515&ndash;534.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+sparseBC.BIC">sparseBC.BIC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
########### Create data matrix with K=2 R=4 row and column clusters 
#k &lt;- 2
#r &lt;- 4
#n &lt;- 200
#p &lt;- 200
#  mus&lt;-runif(k*r,-3,3)
#  mus&lt;-matrix(c(mus),nrow=k,ncol=r,byrow=FALSE)
#  truthCs&lt;-sample(1:k,n,rep=TRUE)
#  truthDs&lt;-sample(1:r,p,rep=TRUE)
#  x&lt;-matrix(rnorm(n*p,mean=0,sd=2),nrow=n,ncol=p)
#  for(i in 1:max(truthCs)){
#     for(j in 1:max(truthDs)){ 
#         x[truthCs==i, truthDs==j] &lt;- x[truthCs==i, truthDs==j] + mus[i,j]
#    }
#  }
#  x&lt;-x-mean(x)

# Example is commented out for short run-time	
############ Perform sparseBC.choosekr to choose the number of row and column clusters
#sparseBC.choosekr(x,1:5,1:5,0,0.2)$estimated_kr

</code></pre>

<hr>
<h2 id='summary.sparseBC'>
Plot an object of class <code>sparseBC</code> or <code>matrixBC</code>
</h2><span id='topic+summary.sparseBC'></span><span id='topic+summary.matrixBC'></span>

<h3>Description</h3>

<p>This function provides some information for an object <code><a href="#topic+sparseBC">sparseBC</a></code> or <code><a href="#topic+matrixBC">matrixBC</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sparseBC'
summary(object, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.sparseBC_+3A_object">object</code></td>
<td>

<p>an object of class <code><a href="#topic+sparseBC">sparseBC</a></code> or <code>link{matrixBC}</code>
</p>
</td></tr>
<tr><td><code id="summary.sparseBC_+3A_...">...</code></td>
<td>

<p>any other arguments passed to <code>print</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some information for an object sparseBC.  (1) Cluster labels for the rows/observations.  (2) Cluster labels for the columns/features.  (3) The estimated bicluster mean for each cluster.</p>


<h3>Author(s)</h3>

<p>Kean Ming Tan and Daniela Witten
</p>


<h3>References</h3>

<p>#
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sparseBC">sparseBC</a></code>
<code><a href="#topic+matrixBC">matrixBC</a></code>
<code><a href="#topic+image.sparseBC">image.sparseBC</a></code>
<code><a href="#topic+sparseBC.BIC">sparseBC.BIC</a></code>
<code><a href="#topic+sparseBC.choosekr">sparseBC.choosekr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See example in sparseBC
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
