<!DOCTYPE html><html><head><title>Help for package IsoSpecR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IsoSpecR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#custom_isotopes_example'><p>An example of how to add your own elements.</p></a></li>
<li><a href='#IsoSpecify'><p>Calculate the isotopic fine structure peaks.</p></a></li>
<li><a href='#isotopicData'><p>Data on isotope masses, abundances and other.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The IsoSpec Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-10-29</td>
</tr>
<tr>
<td>Author:</td>
<td>Mateusz Krzysztof Lacki and Michal Startek</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matteo Lacki &lt;matteo.lacki@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>IsoSpec is a fine structure calculator used for obtaining the most
    probable masses of a chemical compound given the frequencies of the composing
    isotopes and their masses. It finds the smallest set of isotopologues with
    a given probability. The probability is assumed to be that of the product of
    multinomial distributions, each corresponding to one particular element and
    parametrized by the frequencies of finding these elements in nature. These
    numbers are supplied by IUPAC - the International Union of Pure and Applied
    Chemistry. See: Lacki, Valkenborg, Startek (2020) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.0c00959">doi:10.1021/acs.analchem.0c00959</a>&gt;
    and Lacki, Startek, Valkenborg, Gambin (2017) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.6b01459">doi:10.1021/acs.analchem.6b01459</a>&gt;
    for the description of the algorithms used.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENCE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://matteolacki.github.io/IsoSpec/">http://matteolacki.github.io/IsoSpec/</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>LazyData:</td>
<td>no</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++14</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-30 19:22:56 UTC; mist</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-31 00:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='custom_isotopes_example'>An example of how to add your own elements.</h2><span id='topic+custom_isotopes_example'></span>

<h3>Description</h3>

<p>This can be used, for instance, with isotopically labelled molecules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>custom_isotopes_example()
</code></pre>

<hr>
<h2 id='IsoSpecify'>Calculate the isotopic fine structure peaks.</h2><span id='topic+IsoSpecify'></span>

<h3>Description</h3>

<p><code>IsoSpecify</code> is a wrapper around <code>Rinterface</code> that calls the C++ implementation of the IsoSpec algorithm. Given a molecular formula, it will calculate the smallest set of infinitely resolved peaks (isotopologues) that jointly is <code>p</code> probable, where <code>p</code> is provided by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IsoSpecify(molecule, stopCondition, isotopes = NULL,
  showCounts = FALSE, trim = TRUE, algo = 0, step = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IsoSpecify_+3A_molecule">molecule</code></td>
<td>
<p>A named integer vector, e.g. <code>c(C=2,H=6,O=1)</code>, containing the chemical formula of the substance of interest.</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_stopcondition">stopCondition</code></td>
<td>
<p>A numeric value between 0 and 1.</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_isotopes">isotopes</code></td>
<td>
<p>A named list of isotopic information required for IsoSpec. The names must be valid element symbols, see <code>isotopicData</code> for examples. Each enlisted object should be a <code>data.frame</code> containing columns <code>element</code> (specifying the symbol of the element), <code>mass</code> (specifying the mass of the isotope), <code>abundance</code> (specyfying the assumed frequency of finding that isotope).</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_showcounts">showCounts</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then we output matrix contains additionally counts of isotopes for each isotopologue.</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_trim">trim</code></td>
<td>
<p>Logical. If <code>FALSE</code>, then we output matrix contains additionally isotopologues that otherwise would get trimmed in order to find the smalles possible p-set. Therefore, switching to <code>FALSE</code> results in a slightly larger set then the optimal p-set.</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_algo">algo</code></td>
<td>
<p>An integer: 0 - use standard IsoSpec algoritm,
where <code>stopCondition</code> specifies the probability of the optimal p-set,
1 - use a version of algorithm that uses priority queue. Slower than 0, but does not require sorting.
2 - use a threshold version of the algorithm, where <code>stopCondition</code> specifies the height of the pruned peaks.
3 - for the threshold version of IsoSpec with <code>stopCondition</code> being
the percentage of the highest peak below which isotopologues get pruned.</p>
</td></tr>
<tr><td><code id="IsoSpecify_+3A_step">step</code></td>
<td>
<p>The percent of the the percentile of isotopologues in the current isolayer, specyfying the cutoff for the next isolayer. It has been optimised and better not change the default value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix containing the masses, the logarithms of probability, and, optionally, counts of isotopologues. Attention: this matrix does not have to be sorted. Sorting it would also compromise the linear complexity of our algorithm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(IsoSpecR)
res &lt;- IsoSpecify( molecule = c(C=10,H=22,O=1), stopCondition = .9999 )
print(res)
</code></pre>

<hr>
<h2 id='isotopicData'>Data on isotope masses, abundances and other.</h2><span id='topic+isotopicData'></span>

<h3>Description</h3>

<p>A list of data frames or table data frames (dplyr like), containing different information on isotopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotopicData
</code></pre>


<h3>Format</h3>

<p>A list of 6 tbl_df's or data frames, each constaining:
</p>

<dl>
<dt>element</dt><dd><p>The symbol of an element from Mendeleev's periodic table.</p>
</dd>	
<dt>isotope</dt><dd><p>String composed of the nucleon number and the symbol of element.</p>
</dd>
<dt>mass</dt><dd><p>Isotope's Mass in Daltons.</p>
</dd>
<dt>abundance</dt><dd><p>The abundance of the isotopes. In case of enviPat data abundances do not sum to one. In case of all other, they do.</p>
</dd>
<dt>ratioC</dt><dd><p>As in enviPat reference manual: &quot;Maximum number of atoms of an element for one C-atom in a molecule, based on 99.99 % of case molecules&quot;.</p>
</dd>
</dl>


<h3>Source</h3>

<p>R Package enviPat and Commission on Isotopic Abundances and Atomic Weights, CIAAW, <a href="https://www.ciaaw.org/index.htm">https://www.ciaaw.org/index.htm</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
