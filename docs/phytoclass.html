<!DOCTYPE html><html lang="en"><head><title>Help for package phytoclass</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phytoclass}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Bounded_weights'><p>Add weights to the data, bound at a maximum.</p></a></li>
<li><a href='#Cluster'><p>Cluster things</p></a></li>
<li><a href='#Condition_test'><p>Calculate the condition number ...</p></a></li>
<li><a href='#Conduit_1'><p>Conduit between minimise_elements function and Fac_F_R</p>
of steepest descent algorithm.</a></li>
<li><a href='#Conduit_2'><p>Conduit between minimise_elements function and Fac_F_R</p>
of steepest descent algorithm.</a></li>
<li><a href='#Conduit_3'><p>Conduit between minimise_elements function and Fac_F_R</p>
of steepest descent algorithm.</a></li>
<li><a href='#Default_min_max'><p>Sets the default minimum and maximum values for phytoplankton groups</p>
pigment ratios. To use this function, pigment and phytoplankton group
names will need to fit the naming criteria of phytoclass.</a></li>
<li><a href='#Fac_F_RR1'><p>Part of the steepest descent algorithm and work to reduce error given</p>
the S and F matrices.</a></li>
<li><a href='#Fac_F_RR2'><p>Part of the steepest descent algorithm and work to reduce error given</p>
the S and F matrices</a></li>
<li><a href='#Fac_F_RR3'><p>Part of the steepest descent algorithm and work to reduce error given</p>
the S and F matrices</a></li>
<li><a href='#Fm'><p>Fm data</p></a></li>
<li><a href='#Fp'><p>Fp data</p></a></li>
<li><a href='#Matrix_checks'><p>Remove any column values that average 0. Further to this, also remove</p>
phytoplankton groups from the F matrix if their diagnostic pigment
isn’t present.</a></li>
<li><a href='#min_max'><p>min_max data</p></a></li>
<li><a href='#Minimise_elements'><p>Part of the steepest descent algorithm</p></a></li>
<li><a href='#Minimise_elements1'><p>A function that reduces every for every element that didn't reduce in index function</p></a></li>
<li><a href='#Minimise_elements2'><p>A function that reduces every for every element that didn't reduce in index function</p></a></li>
<li><a href='#NNLS_MF'><p>Performs the non-negative matrix factorisation for given phytoplankton</p>
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.</a></li>
<li><a href='#NNLS_MF_Final'><p>Perform matrix factorisation for phytoplankton pigments and pigments ratios</p></a></li>
<li><a href='#Normalise_F'><p>This function normalises each column in F to row sum</p></a></li>
<li><a href='#Normalise_S'><p>This function normalises each column in S to row sum</p></a></li>
<li><a href='#Prochloro_NNLS_MF_Final'><p>Final step for MF with prochlorococcus</p></a></li>
<li><a href='#Prochloro_Normalise_F'><p>Normalise F for prochloro</p></a></li>
<li><a href='#Prochloro_Random_Neighbour'><p>Prochloro random neighbour</p></a></li>
<li><a href='#Prochloro_Random_Neighbour_2'><p>Selects a random neighbour for the simulated annealing algorithm.</p></a></li>
<li><a href='#Prochloro_Wrangling'><p>Prochloro Wrangling</p></a></li>
<li><a href='#Random_neighbour'><p>Select a random neighbour when the previous random neighbour is beyond</p>
the minimum or maximum value.</a></li>
<li><a href='#Random_neighbour2'><p>Selects a random neighbour for the simulated annealing algorithm.</p></a></li>
<li><a href='#Randomise_elements'><p>Randomise individual elements in the F matrix.</p></a></li>
<li><a href='#Replace_Rand'><p>Select the new F matrix element with lowest error in the steepest</p>
descent algorithm.</a></li>
<li><a href='#SAALS'><p>Apply the steepest descent algorithm</p></a></li>
<li><a href='#simulated_annealing'><p>Phytoclass - simualted annealing</p></a></li>
<li><a href='#simulated_annealing_Prochloro'><p>Perform simulated annealing algorithm for S and F matrices</p></a></li>
<li><a href='#Sm'><p>Sm data</p></a></li>
<li><a href='#Sp'><p>Sp data</p></a></li>
<li><a href='#Steepest_Desc'><p>Stand-alone version of steepest descent algorithm. This is similar to the CHEMTAX steepest descent algorithm. It is not required to use this function, and as results are not bound by minimum and maximum, results may be unrealistic.</p></a></li>
<li><a href='#Steepest_Descent'><p>Performs the steepest descent algorithm for a set number of iterations</p></a></li>
<li><a href='#target'><p>Title</p></a></li>
<li><a href='#vectorise'><p>Turn each non-zero element of the F-matrix into a vector</p></a></li>
<li><a href='#Weight_error'><p>Apply weights to F/S matrices</p></a></li>
<li><a href='#Wrangling'><p>Converts data-types and selects data for randomisation in</p>
the simulated annealing algorithm</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimate Chla Concentrations of Phytoplankton Groups</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Determine the chlorophyll a (Chl a) concentrations of different 
    phytoplankton groups based on their pigment biomarkers. The method uses
    non-negative matrix factorisation and simulated annealing to minimise error
    between the observed and estimated values of pigment concentrations
    (Hayward et al. (2023) &lt;<a href="https://doi.org/10.1002%2Flom3.10541">doi:10.1002/lom3.10541</a>&gt;).
    The approach is similar to the widely used 'CHEMTAX' program
    (Mackey et al. 1996) &lt;<a href="https://doi.org/10.3354%2Fmeps144265">doi:10.3354/meps144265</a>&gt;, but is more straightforward,
    accurate, and not reliant on initial guesses for the pigment to Chl a
    ratios for phytoplankton groups.</td>
</tr>
<tr>
<td>Imports:</td>
<td>bestNormalize, dplyr, dynamicTreeCut, ggplot2, Metrics,
RcppML, stats, tidyr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.8)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/phytoclass/phytoclass/">https://github.com/phytoclass/phytoclass/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/phytoclass/phytoclass/issues/">https://github.com/phytoclass/phytoclass/issues/</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-14 08:36:26 UTC; algh</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Hayward [aut, cre, cph],
  Tylar Murray [aut],
  Andy McKenzie [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Hayward &lt;phytoclass@outlook.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-14 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Bounded_weights'>Add weights to the data, bound at a maximum.</h2><span id='topic+Bounded_weights'></span>

<h3>Description</h3>

<p>Add weights to the data, bound at a maximum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bounded_weights(S, weight.upper.bound = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Bounded_weights_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="Bounded_weights_+3A_weight.upper.bound">weight.upper.bound</code></td>
<td>
<p>Upper bound for weights (default is 30)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with upper bounds for weights
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Bounded_weights(Sm, weight.upper.bound = 30)

</code></pre>

<hr>
<h2 id='Cluster'>Cluster things</h2><span id='topic+Cluster'></span>

<h3>Description</h3>

<p>Cluster things
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cluster(Data, min_cluster_size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Cluster_+3A_data">Data</code></td>
<td>
<p>S (sample) matrix</p>
</td></tr>
<tr><td><code id="Cluster_+3A_min_cluster_size">min_cluster_size</code></td>
<td>
<p>the minimum size required for a cluster</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list of length two. The first element &quot;cluster.list&quot;
is a list of clusters, and the second element &quot;cluster.plot&quot; the
cluster analysis object (dendogram) that can be plotted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Cluster.result &lt;- Cluster(Sm, 14)
Cluster.result$cluster.list
plot(Cluster.result$cluster.plot)
</code></pre>

<hr>
<h2 id='Condition_test'>Calculate the condition number ...</h2><span id='topic+Condition_test'></span>

<h3>Description</h3>

<p>Calculate the condition number ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Condition_test(S, Fn, min.val = NULL, max.val = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Condition_test_+3A_s">S</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Condition_test_+3A_fn">Fn</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Condition_test_+3A_min.val">min.val</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Condition_test_+3A_max.val">max.val</code></td>
<td>
<p>XX</p>
</td></tr>
</table>

<hr>
<h2 id='Conduit_1'>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.</h2><span id='topic+Conduit_1'></span>

<h3>Description</h3>

<p>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Conduit_1(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Conduit_1_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_1_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_1_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_1_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Conduit_2'>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.</h2><span id='topic+Conduit_2'></span>

<h3>Description</h3>

<p>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Conduit_2(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Conduit_2_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_2_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_2_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_2_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Conduit_3'>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.</h2><span id='topic+Conduit_3'></span>

<h3>Description</h3>

<p>Conduit between minimise_elements function and Fac_F_R
of steepest descent algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Conduit_3(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Conduit_3_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_3_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_3_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Conduit_3_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Default_min_max'>Sets the default minimum and maximum values for phytoplankton groups
pigment ratios. To use this function, pigment and phytoplankton group
names will need to fit the naming criteria of phytoclass.</h2><span id='topic+Default_min_max'></span>

<h3>Description</h3>

<p>Sets the default minimum and maximum values for phytoplankton groups
pigment ratios. To use this function, pigment and phytoplankton group
names will need to fit the naming criteria of phytoclass.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Default_min_max(min_max, Fmat, place)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Default_min_max_+3A_min_max">min_max</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Default_min_max_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Default_min_max_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Fac_F_RR1'>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices.</h2><span id='topic+Fac_F_RR1'></span>

<h3>Description</h3>

<p>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fac_F_RR1(Fmat, vary, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fac_F_RR1_+3A_fmat">Fmat</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Fac_F_RR1_+3A_vary">vary</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Fac_F_RR1_+3A_s">S</code></td>
<td>
<p>XX</p>
</td></tr>
<tr><td><code id="Fac_F_RR1_+3A_cm">cm</code></td>
<td>
<p>XX</p>
</td></tr>
</table>

<hr>
<h2 id='Fac_F_RR2'>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices</h2><span id='topic+Fac_F_RR2'></span>

<h3>Description</h3>

<p>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fac_F_RR2(Fmat, vary, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fac_F_RR2_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR2_+3A_vary">vary</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR2_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR2_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR2_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Fac_F_RR3'>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices</h2><span id='topic+Fac_F_RR3'></span>

<h3>Description</h3>

<p>Part of the steepest descent algorithm and work to reduce error given
the S and F matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fac_F_RR3(Fmat, vary, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fac_F_RR3_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR3_+3A_vary">vary</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR3_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR3_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Fac_F_RR3_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Fm'>Fm data</h2><span id='topic+Fm'></span>

<h3>Description</h3>

<p>Fm data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fm
</code></pre>


<h3>Format</h3>



<h4><code>Fm</code></h4>

<p>A data frame with 9 rows and 15 columns:
</p>

<dl>
<dt>chl_c1</dt><dd><p>XX</p>
</dd>
<dt>Per</dt><dd><p>XX</p>
</dd>
<dt>X19but</dt><dd><p>XX</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>XX
</p>

<hr>
<h2 id='Fp'>Fp data</h2><span id='topic+Fp'></span>

<h3>Description</h3>

<p>Fp data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fp
</code></pre>


<h3>Format</h3>



<h4><code>Fp</code></h4>

<p>A data frame with 9 rows and 15 columns:
</p>

<dl>
<dt>chl_c1</dt><dd><p>XX</p>
</dd>
<dt>Per</dt><dd><p>XX</p>
</dd>
<dt>X19but</dt><dd><p>XX</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>XX
</p>

<hr>
<h2 id='Matrix_checks'>Remove any column values that average 0. Further to this, also remove
phytoplankton groups from the F matrix if their diagnostic pigment
isn’t present.</h2><span id='topic+Matrix_checks'></span>

<h3>Description</h3>

<p>Remove any column values that average 0. Further to this, also remove
phytoplankton groups from the F matrix if their diagnostic pigment
isn’t present.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Matrix_checks(S, Fmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Matrix_checks_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="Matrix_checks_+3A_fmat">Fmat</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with new S and Fmat matrices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>MC &lt;- Matrix_checks(Sm, Fm)  
Snew &lt;- MC$Snew

</code></pre>

<hr>
<h2 id='min_max'>min_max data</h2><span id='topic+min_max'></span>

<h3>Description</h3>

<p>min_max data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_max
</code></pre>


<h3>Format</h3>



<h4><code>min_max</code></h4>

<p>A data frame with 76 rows and 4 columns:
</p>

<dl>
<dt>class</dt><dd><p>XX</p>
</dd>
<dt>Pig_Abbrev</dt><dd><p>XX</p>
</dd>
<dt>min</dt><dd><p>XX</p>
</dd>
<dt>max</dt><dd><p>max</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>XX
</p>

<hr>
<h2 id='Minimise_elements'>Part of the steepest descent algorithm</h2><span id='topic+Minimise_elements'></span>

<h3>Description</h3>

<p>Part of the steepest descent algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Minimise_elements(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Minimise_elements_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Minimise_elements1'>A function that reduces every for every element that didn't reduce in index function</h2><span id='topic+Minimise_elements1'></span>

<h3>Description</h3>

<p>A function that reduces every for every element that didn't reduce in index function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Minimise_elements1(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Minimise_elements1_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements1_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements1_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements1_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Minimise_elements2'>A function that reduces every for every element that didn't reduce in index function</h2><span id='topic+Minimise_elements2'></span>

<h3>Description</h3>

<p>A function that reduces every for every element that didn't reduce in index function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Minimise_elements2(Fmat, place, S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Minimise_elements2_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements2_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements2_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Minimise_elements2_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='NNLS_MF'>Performs the non-negative matrix factorisation for given phytoplankton
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.</h2><span id='topic+NNLS_MF'></span>

<h3>Description</h3>

<p>Performs the non-negative matrix factorisation for given phytoplankton
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NNLS_MF(Fn, S, cm = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NNLS_MF_+3A_fn">Fn</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td></tr>
<tr><td><code id="NNLS_MF_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="NNLS_MF_+3A_cm">cm</code></td>
<td>
<p>Weights for each column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li><p> The F matrix (pigment: Chl <em>a</em>) ratios
</p>
</li>
<li><p> The root mean square error (RMSE)
</p>
</li>
<li><p> The C matrix (class abundances for each group)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>MC &lt;- Matrix_checks(Sm,Fm)
Snew &lt;- MC$Snew
Fnew &lt;- MC$Fnew
cm &lt;- Bounded_weights(Snew, weight.upper.bound = 30)
NNLS_MF(Fnew, Snew, cm)

</code></pre>

<hr>
<h2 id='NNLS_MF_Final'>Perform matrix factorisation for phytoplankton pigments and pigments ratios</h2><span id='topic+NNLS_MF_Final'></span>

<h3>Description</h3>

<p>Performs the non-negative matrix factorisation for given phytoplankton
pigments and pigment ratios, to attain an estimate of phytoplankton
class abundances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NNLS_MF_Final(Fn, S, S_Chl, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NNLS_MF_Final_+3A_fn">Fn</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="NNLS_MF_Final_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="NNLS_MF_Final_+3A_s_chl">S_Chl</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="NNLS_MF_Final_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Unlike NNLS_ML(), it also removes any weighting and normalisation, and
also multiplies relative abundances by chlorophyll values to determine
the biomass of phytoplankton groups.
</p>

<hr>
<h2 id='Normalise_F'>This function normalises each column in F to row sum</h2><span id='topic+Normalise_F'></span>

<h3>Description</h3>

<p>This function normalises each column in F to row sum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Normalise_F(Fmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Normalise_F_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='Normalise_S'>This function normalises each column in S to row sum</h2><span id='topic+Normalise_S'></span>

<h3>Description</h3>

<p>This function normalises each column in S to row sum
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Normalise_S(S)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Normalise_S_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='Prochloro_NNLS_MF_Final'>Final step for MF with prochlorococcus</h2><span id='topic+Prochloro_NNLS_MF_Final'></span>

<h3>Description</h3>

<p>Final step for MF with prochlorococcus
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prochloro_NNLS_MF_Final(Fn, S, S_Chl, cm, S_dvChl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prochloro_NNLS_MF_Final_+3A_fn">Fn</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_NNLS_MF_Final_+3A_s">S</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_NNLS_MF_Final_+3A_s_chl">S_Chl</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_NNLS_MF_Final_+3A_cm">cm</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='Prochloro_Normalise_F'>Normalise F for prochloro</h2><span id='topic+Prochloro_Normalise_F'></span>

<h3>Description</h3>

<p>Normalise F for prochloro
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prochloro_Normalise_F(Fmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prochloro_Normalise_F_+3A_fmat">Fmat</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='Prochloro_Random_Neighbour'>Prochloro random neighbour</h2><span id='topic+Prochloro_Random_Neighbour'></span>

<h3>Description</h3>

<p>Prochloro random neighbour
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prochloro_Random_Neighbour(
  Fn,
  Temp,
  chlv,
  s_c,
  N,
  place,
  S,
  cm,
  min.val,
  max.val
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prochloro_Random_Neighbour_+3A_fn">Fn</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_temp">Temp</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_chlv">chlv</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_s_c">s_c</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_n">N</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_place">place</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_s">S</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_cm">cm</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_min.val">min.val</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_+3A_max.val">max.val</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='Prochloro_Random_Neighbour_2'>Selects a random neighbour for the simulated annealing algorithm.</h2><span id='topic+Prochloro_Random_Neighbour_2'></span>

<h3>Description</h3>

<p>Selects a random neighbour for the simulated annealing algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prochloro_Random_Neighbour_2(
  Fn,
  Temp,
  chlv,
  s_c,
  place,
  S,
  cm,
  min.val,
  max.val,
  chlvp
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_fn">Fn</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_temp">Temp</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_chlv">chlv</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_s_c">s_c</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_min.val">min.val</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_max.val">max.val</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Prochloro_Random_Neighbour_2_+3A_chlvp">chlvp</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Prochloro_Wrangling'>Prochloro Wrangling</h2><span id='topic+Prochloro_Wrangling'></span>

<h3>Description</h3>

<p>Prochloro Wrangling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prochloro_Wrangling(Fl, min.val, max.val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Prochloro_Wrangling_+3A_fl">Fl</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Wrangling_+3A_min.val">min.val</code></td>
<td>
</td></tr>
<tr><td><code id="Prochloro_Wrangling_+3A_max.val">max.val</code></td>
<td>
</td></tr>
</table>

<hr>
<h2 id='Random_neighbour'>Select a random neighbour when the previous random neighbour is beyond
the minimum or maximum value.</h2><span id='topic+Random_neighbour'></span>

<h3>Description</h3>

<p>Select a random neighbour when the previous random neighbour is beyond
the minimum or maximum value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Random_neighbour(Fn, Temp, chlv, s_c, N, place, S, cm, min.val, max.val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Random_neighbour_+3A_fn">Fn</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_temp">Temp</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_chlv">chlv</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_s_c">s_c</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_n">N</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_min.val">min.val</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour_+3A_max.val">max.val</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Random_neighbour2'>Selects a random neighbour for the simulated annealing algorithm.</h2><span id='topic+Random_neighbour2'></span>

<h3>Description</h3>

<p>Selects a random neighbour for the simulated annealing algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Random_neighbour2(Fn, Temp, chlv, s_c, place, S, cm, min.val, max.val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Random_neighbour2_+3A_fn">Fn</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_temp">Temp</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_chlv">chlv</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_s_c">s_c</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_min.val">min.val</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Random_neighbour2_+3A_max.val">max.val</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Randomise_elements'>Randomise individual elements in the F matrix.</h2><span id='topic+Randomise_elements'></span>

<h3>Description</h3>

<p>Randomise individual elements in the F matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Randomise_elements(x, min.scaler, max.scaler)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Randomise_elements_+3A_x">x</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Randomise_elements_+3A_min.scaler">min.scaler</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Randomise_elements_+3A_max.scaler">max.scaler</code></td>
<td>
<p>xx</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric
</p>

<hr>
<h2 id='Replace_Rand'>Select the new F matrix element with lowest error in the steepest
descent algorithm.</h2><span id='topic+Replace_Rand'></span>

<h3>Description</h3>

<p>Select the new F matrix element with lowest error in the steepest
descent algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Replace_Rand(Fmat, i, S, cm, min.scaler, max.scaler)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Replace_Rand_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Replace_Rand_+3A_i">i</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Replace_Rand_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Replace_Rand_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Replace_Rand_+3A_min.scaler">min.scaler</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Replace_Rand_+3A_max.scaler">max.scaler</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='SAALS'>Apply the steepest descent algorithm</h2><span id='topic+SAALS'></span>

<h3>Description</h3>

<p>Apply the steepest descent algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SAALS(Ft, min.value, max.value, place, S, cm, num.loops)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SAALS_+3A_ft">Ft</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_min.value">min.value</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_max.value">max.value</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="SAALS_+3A_num.loops">num.loops</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='simulated_annealing'>Phytoclass - simualted annealing</h2><span id='topic+simulated_annealing'></span>

<h3>Description</h3>

<p>This is the main phytoclass algorithm. It performs simulated annealing algorithm for S and F matrices. See the examples (Fm, Sm) for how to set up matrices, and the vignette for more detailed instructions. Different pigments and phytoplankton groups may be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_annealing(
  S,
  Fmat = NULL,
  user_defined_min_max = NULL,
  do_matrix_checks = TRUE,
  niter = 500,
  step = 0.009,
  weight.upper.bound = 30,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulated_annealing_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_fmat">Fmat</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_user_defined_min_max">user_defined_min_max</code></td>
<td>
<p>data frame with some format as min_max built-in data</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_do_matrix_checks">do_matrix_checks</code></td>
<td>
<p>This should only be set to TRUE when using the default values. This will remove pigment columns that have column sums of 0. Set to FALSE if using customised names for pigments and phytoplankton groups</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_niter">niter</code></td>
<td>
<p>Number of iterations (default is 500)</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_step">step</code></td>
<td>
<p>Step ratio used (default is 0.009)</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_weight.upper.bound">weight.upper.bound</code></td>
<td>
<p>Upper limit of the weights applied (default value is 30).</p>
</td></tr>
<tr><td><code id="simulated_annealing_+3A_verbose">verbose</code></td>
<td>
<p>Logical value. Output error and temperature at each iteration. Default value of TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li><p> Fmat matrix
</p>
</li>
<li><p> RMSE (Root Mean Square Error)
</p>
</li>
<li><p> condition number
</p>
</li>
<li><p> Class abundances
</p>
</li>
<li><p> Figure (plot of results)
</p>
</li>
<li><p> MAE (Mean Absolute Error)
</p>
</li>
<li><p> Error
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># Using the built-in matrices Sm and Fm
set.seed(5326)
sa.example &lt;- simulated_annealing(Sm, Fm, niter = 5)
sa.example$Figure

#Using non-default data:
# Set up a new F matrix
Fu &lt;- data.frame(
  Per = c(0, 0, 0, 0, 1, 0, 0, 0),
  X19but = c(0, 0, 0, 0, 0, 1, 1, 0),
  Fuco = c(0, 0, 0, 1, 0, 1, 1, 0),
  Pra = c(1, 0, 0, 0, 0, 0, 0, 0),
  X19hex = c(0, 0, 0, 0, 0, 1, 0, 0),
  Allo = c(0, 0, 1, 0, 0, 0, 0, 0),
  Zea = c(1, 1, 0, 0, 0, 0, 0, 1),
  Chl_b = c(1, 1, 0, 0, 0, 0, 0, 0),
  Tchla = c(1, 1, 1, 1, 1, 1, 1, 1)
)

rownames(Fu) &lt;- c(
  "Prasinophytes", "Chlorophytes", "Cryptophytes"
  , "Diatoms-2", "Dinoflagellates-1",
  "Haptophytes", "Pelagophytes", "Syn"
)

#Set up a new Min_max file
Min_max &lt;- data.frame(
  Class = c(
    "Syn", "Chlorophytes", "Chlorophytes", "Prasinophytes", "Prasinophytes",
    "Prasinophytes", "Cryptophytes", "Diatoms-2", "Diatoms-2", "Pelagophytes",
    "Pelagophytes", "Pelagophytes", "Dinoflagellates-1", "Haptophytes",
    "Haptophytes", "Haptophytes", "Haptophytes", "Diatoms-2", "Cryptophytes",
    "Prasinophytes", "Chlorophytes", "Syn", "Dinoflagellates-1", "Pelagophytes"
  ),
  Pig_Abbrev = c(
    "Zea", "Zea", "Chl_b", "Pra", "Zea", "Chl_b", "Allo", "Chl_c3",
    "Fuco", "Chl_c3", "X19but", "Fuco", "Per", "X19but", "X19hex",
    "Fuco", "Tchla", "Tchla", "Tchla", "Tchla", "Tchla", "Tchla", "Tchla",
    "Tchla"
  ),
  min = as.numeric(c(
    0.0800, 0.0063, 0.1666, 0.0642, 0.0151, 0.4993, 0.2118, 0.0189,
    0.3315, 0.1471, 0.2457, 0.3092, 0.3421, 0.0819, 0.2107, 0.0090,
    1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000
  )),
  max = as.numeric(c(
    1.2123, 0.0722, 0.9254, 0.4369, 0.1396, 0.9072, 0.5479, 0.1840,
    0.9332, 0.2967, 1.0339, 1.2366, 0.8650, 0.2872, 1.3766, 0.4689,
    1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000, 1.0000
  ))
)
#Run the new file with your own set up (make sure all names between your data (S),
#F-marix, and min_max are correct)
Results &lt;- simulated_annealing(
  S = Sm, 
  F = Fu,
  user_defined_min_max = Min_max,
  do_matrix_checks = TRUE, 
  #You may want to change this to faults if your naming conventions are different.
  niter = 1,
  step = 0.01,
  weight.upper.bound = 30)


</code></pre>

<hr>
<h2 id='simulated_annealing_Prochloro'>Perform simulated annealing algorithm for S and F matrices</h2><span id='topic+simulated_annealing_Prochloro'></span>

<h3>Description</h3>

<p>Perform simulated annealing algorithm for S and F matrices
</p>
<p>Perform simulated annealing algorithm for samples with divinyl chlorophyll and prochlorococcus. Divinyl chlorophyll must be the final column of both S and F matrices, with chlorophyll a the 2nd to last column. See how the example Sp and Fp matrices are organised.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulated_annealing_Prochloro(
  S,
  Fmat = NULL,
  user_defined_min_max = NULL,
  do_matrix_checks = TRUE,
  niter = 500,
  step = 0.009,
  weight.upper.bound = 30,
  verbose = TRUE
)

simulated_annealing_Prochloro(
  S,
  Fmat = NULL,
  user_defined_min_max = NULL,
  do_matrix_checks = TRUE,
  niter = 500,
  step = 0.009,
  weight.upper.bound = 30,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulated_annealing_Prochloro_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_fmat">Fmat</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_user_defined_min_max">user_defined_min_max</code></td>
<td>
<p>data frame with some format as min_max built-in data</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_do_matrix_checks">do_matrix_checks</code></td>
<td>
<p>This should only be set to TRUE when using the default values. This will remove pigment columns that have column sums of 0. Set to FALSE if using customised names for pigments and phytoplankton groups</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_niter">niter</code></td>
<td>
<p>Number of iterations (default is 500)</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_step">step</code></td>
<td>
<p>Step ratio used (default is 0.009)</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_weight.upper.bound">weight.upper.bound</code></td>
<td>
<p>Upper limit of the weights applied (default value is 30).</p>
</td></tr>
<tr><td><code id="simulated_annealing_Prochloro_+3A_verbose">verbose</code></td>
<td>
<p>Logical value. Output error and temperature at each iteration. Default value of TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li><p> Fmat matrix
</p>
</li>
<li><p> RMSE (Root Mean Square Error)
</p>
</li>
<li><p> condition number
</p>
</li>
<li><p> Class abundances
</p>
</li>
<li><p> Figure (plot of results)
</p>
</li>
<li><p> MAE (Mean Absolute Error)
</p>
</li>
<li><p> Error
</p>
</li></ol>

<p>A list containing
</p>

<ol>
<li><p> Fmat matrix
</p>
</li>
<li><p> RMSE (Root Mean Square Error)
</p>
</li>
<li><p> condition number
</p>
</li>
<li><p> Class abundances
</p>
</li>
<li><p> Figure (plot of results)
</p>
</li>
<li><p> MAE (Mean Absolute Error)
</p>
</li>
<li><p> Error
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'># Using the built-in matrices Sp and Fp
set.seed(5326)
sa.example &lt;- simulated_annealing_Prochloro(Sp, Fp, niter = 5)
sa.example$Figure
# Using the built-in matrices Sp and Fp.
set.seed(5326)
sa.example &lt;- simulated_annealing_Prochloro(Sp, Fp, niter = 1)
sa.example$Figure

# To use with non-defauæy values, see the 'simulated_annealing' example-
</code></pre>

<hr>
<h2 id='Sm'>Sm data</h2><span id='topic+Sm'></span>

<h3>Description</h3>

<p>Sm data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sm
</code></pre>


<h3>Format</h3>



<h4><code>Sm</code></h4>

<p>A data frame with 29 rows and 15 columns:
</p>

<dl>
<dt>chl_c1</dt><dd><p>XX</p>
</dd>
<dt>Per</dt><dd><p>XX</p>
</dd>
<dt>X19but</dt><dd><p>XX</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>XX
</p>

<hr>
<h2 id='Sp'>Sp data</h2><span id='topic+Sp'></span>

<h3>Description</h3>

<p>Sp data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sp
</code></pre>


<h3>Format</h3>



<h4><code>Sp</code></h4>

<p>A data frame with 29 rows and 15 columns:
</p>

<dl>
<dt>chl_c1</dt><dd><p>XX</p>
</dd>
<dt>Per</dt><dd><p>XX</p>
</dd>
<dt>X19but</dt><dd><p>XX</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p>XX
</p>

<hr>
<h2 id='Steepest_Desc'>Stand-alone version of steepest descent algorithm. This is similar to the CHEMTAX steepest descent algorithm. It is not required to use this function, and as results are not bound by minimum and maximum, results may be unrealistic.</h2><span id='topic+Steepest_Desc'></span>

<h3>Description</h3>

<p>Stand-alone version of steepest descent algorithm. This is similar to the CHEMTAX steepest descent algorithm. It is not required to use this function, and as results are not bound by minimum and maximum, results may be unrealistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Steepest_Desc(Fmat, S, num.loops)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Steepest_Desc_+3A_fmat">Fmat</code></td>
<td>
<p>Pigment to Chl a matrix</p>
</td></tr>
<tr><td><code id="Steepest_Desc_+3A_s">S</code></td>
<td>
<p>Sample data matrix – a matrix of pigment samples</p>
</td></tr>
<tr><td><code id="Steepest_Desc_+3A_num.loops">num.loops</code></td>
<td>
<p>Number of loops/iterations to perform (no default)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ol>
<li><p> The F matrix (pigment: Chl <em>a</em>) ratios
</p>
</li>
<li><p> RMSE (Root Mean Square Error)
</p>
</li>
<li><p> Condition number
</p>
</li>
<li><p> class abundances
</p>
</li>
<li><p> Figure (plot of results)
</p>
</li>
<li><p> MAE (Mean Absolute Error)
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>MC &lt;- Matrix_checks(Sm,Fm)
Snew &lt;- MC$Snew
Fnew &lt;- MC$Fnew
SDRes &lt;- Steepest_Desc(Fnew,Snew, num.loops = 20)

</code></pre>

<hr>
<h2 id='Steepest_Descent'>Performs the steepest descent algorithm for a set number of iterations</h2><span id='topic+Steepest_Descent'></span>

<h3>Description</h3>

<p>Performs the steepest descent algorithm for a set number of iterations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Steepest_Descent(Fmat, place, S, cm, num.loops)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Steepest_Descent_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Steepest_Descent_+3A_place">place</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Steepest_Descent_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Steepest_Descent_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Steepest_Descent_+3A_num.loops">num.loops</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='target'>Title</h2><span id='topic+target'></span>

<h3>Description</h3>

<p>Title
</p>


<h3>Usage</h3>

<pre><code class='language-R'>target(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="target_+3A_x">x</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='vectorise'>Turn each non-zero element of the F-matrix into a vector</h2><span id='topic+vectorise'></span>

<h3>Description</h3>

<p>Turn each non-zero element of the F-matrix into a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vectorise(Fmat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vectorise_+3A_fmat">Fmat</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

<hr>
<h2 id='Weight_error'>Apply weights to F/S matrices</h2><span id='topic+Weight_error'></span>

<h3>Description</h3>

<p>Apply weights to F/S matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Weight_error(S, cm)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Weight_error_+3A_s">S</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Weight_error_+3A_cm">cm</code></td>
<td>
<p>xx</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix
</p>

<hr>
<h2 id='Wrangling'>Converts data-types and selects data for randomisation in
the simulated annealing algorithm</h2><span id='topic+Wrangling'></span>

<h3>Description</h3>

<p>Converts data-types and selects data for randomisation in
the simulated annealing algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Wrangling(Fl, min.val, max.val)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Wrangling_+3A_fl">Fl</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Wrangling_+3A_min.val">min.val</code></td>
<td>
<p>xx</p>
</td></tr>
<tr><td><code id="Wrangling_+3A_max.val">max.val</code></td>
<td>
<p>xx</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
