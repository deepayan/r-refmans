<!DOCTYPE html><html><head><title>Help for package R2MLwiN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R2MLwiN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#R2MLwiN-package'><p>Running MLwiN from within R</p></a></li>
<li><a href='#[,mlwinfitIGLS,ANY,ANY,ANY-method'><p>Extract or Replace parts of &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#[,mlwinfitMCMC,ANY,ANY,ANY-method'><p>Extract or Replace parts of &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#alevchem'><p>Chemistry A-level results from one exam board</p></a></li>
<li><a href='#augment.mlwinfitIGLS'><p>Augment data frame with information derived from the model fit (broom package).</p></a></li>
<li><a href='#augment.mlwinfitMCMC'><p>Augment data frame with information derived from the model fit (broom package).</p></a></li>
<li><a href='#bang'><p>Sub-sample from the 1989 Bangladesh Fertility Survey (see Huq &amp; Cleveland,</p>
1990)</a></li>
<li><a href='#bang1'><p>Sub-sample from the 1989 Bangladesh Fertility Survey</p></a></li>
<li><a href='#BD'><p>Calculates Brooks-Draper diagnostic</p></a></li>
<li><a href='#bes83'><p>Subsample from British Election Study, '83.</p></a></li>
<li><a href='#caterpillar'><p>Draws a caterpillar plot (in MLwiN style).</p></a></li>
<li><a href='#caterpillarR'><p>Draws caterpillar plots of the residuals from a mlwinfitIGLS-class or</p>
mlwinfitMCMC-class object, at a chosen level of the multilevel model.</a></li>
<li><a href='#coef,mlwinfitIGLS-method'><p>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#coef,mlwinfitMCMC-method'><p>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#coef.mlwinfitIGLS'><p>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#coef.mlwinfitMCMC'><p>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#cvd'><p>Data from the 1998 Scottish Health Survey on cardiovascular disease status of</p>
8804 respondents</a></li>
<li><a href='#deviance.mlwinfitIGLS'><p>Returns the deviance from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#df.residual.mlwinfitIGLS'><p>Returns the residual degrees-of-freedom extracted from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#df2matrix'><p>Translates a data.frame, formatted for use in multiple membership</p>
modelling in MLwiN, to a matrix.</a></li>
<li><a href='#diag1'><p>Examination dataset</p></a></li>
<li><a href='#double2singlePrecision'><p>Converts numerical values from double precision to single precision.</p></a></li>
<li><a href='#extract,mlwinfitIGLS-method'><p>Extract coefficients and GOF measures from a statistical object (texreg package).</p></a></li>
<li><a href='#extract,mlwinfitMCMC-method'><p>Extract coefficients and GOF measures from a statistical object.</p></a></li>
<li><a href='#fitted.mlwinfitIGLS'><p>Returns the fitted values from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#fitted.mlwinfitMCMC'><p>Returns the fitted values from &quot;mlwinfitMCMC&quot; objects.</p></a></li>
<li><a href='#formula.mlwinfitIGLS'><p>&quot;mlwinfitIGLS&quot; model formula</p></a></li>
<li><a href='#formula.mlwinfitMCMC'><p>&quot;mlwinfitMCMC&quot; model formula</p></a></li>
<li><a href='#Formula.translate'><p>An internal function to translate an R formula into an R list object.</p></a></li>
<li><a href='#Formula.translate.compat'><p>An internal function, allowing back-compatibility, which translates a model</p>
formula from a formula object or character string into an R list object.</a></li>
<li><a href='#fysio'><p>Data on physiotherapy referrals from 100 general practices in the Netherlands,</p>
collected in 1987</a></li>
<li><a href='#gcsecomp1'><p>Pupils' marks from GCSE exams (UK, 1989); complete cases only.</p></a></li>
<li><a href='#gcsemv1'><p>Pupils' marks from GCSE exams (UK, 1989).</p></a></li>
<li><a href='#getSummary.mlwinfitIGLS'><p>Extract coefficients and GOF measures from a statistical object (memisc package).</p></a></li>
<li><a href='#getSummary.mlwinfitMCMC'><p>Extract coefficients and GOF measures from a statistical object (memisc package).</p></a></li>
<li><a href='#glance.mlwinfitIGLS'><p>Extract GOF measures from a statistical object (broom package).</p></a></li>
<li><a href='#glance.mlwinfitMCMC'><p>Extract GOF measures from a statistical object (broom package).</p></a></li>
<li><a href='#height'><p>Height data.</p></a></li>
<li><a href='#hungary1'><p>Hungarian component of 2nd International Science Survey, '84; see Goldstein</p>
2003</a></li>
<li><a href='#jspmix1'><p>Dataset of pupils' test scores, a subset of the Junior School Project.</p></a></li>
<li><a href='#lips1'><p>Lips data</p></a></li>
<li><a href='#lmdp'><p>Details of deaths from all causes in England and Wales 1972-1992, taken from the</p>
local mortality datapack</a></li>
<li><a href='#logLik,mlwinfitIGLS-method'><p>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#logLik.mlwinfitIGLS'><p>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#matrix2df'><p>For multiple membership models, translates matrix into a data.frame formatted for MLwiN</p>
</p>
<p>Translates a <code>matrix</code> into a form usable by MLwiN for multiple membership models,</p>
namely a <code>data.frame</code> with (a) columns containing membership IDs (if first row matrix is
<code>0 1 1 0 1 1</code>, then first row of generated ID vectors would be, say, <code>2, 3, 5, 6</code>)
and (b) columns containing weights (in this example, if <code>standardise = TRUE</code>, then first
row of generated weight vectors would be, say, <code>0.25, 0.25, 0.25, 0.25</code>, otherwise first
row of generated weight vectors would be, say, <code>1, 1, 1, 1</code>).</a></li>
<li><a href='#MCSE'><p>Calculates the estimated Monte Carlo standard error (MCSE)</p></a></li>
<li><a href='#mlwin2bugs'><p>This function captures output files from MLwiN for estimation in</p>
WinBUGS/OpenBUGS.</a></li>
<li><a href='#mlwinfitIGLS-class'><p>An S4 class that stores the outputs of the fitted IGLS model.</p></a></li>
<li><a href='#mlwinfitMCMC-class'><p>An S4 class that stores the outputs of the fitted MCMC model.</p></a></li>
<li><a href='#mmmec'><p>EC data on UV radiation exposure &amp; malignant melanoma.</p></a></li>
<li><a href='#nobs.mlwinfitIGLS'><p>Returns the number of used observations from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#nobs.mlwinfitMCMC'><p>Returns the number of used observations from &quot;mlwinfitMCMC&quot; objects.</p></a></li>
<li><a href='#predCurves'><p>Draws predicted curves (lines) using estimates from the fixed part of a</p>
fitted model.</a></li>
<li><a href='#predict.mlwinfitIGLS'><p>Returns the predicted data from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#predict.mlwinfitMCMC'><p>Returns the predicted data from &quot;mlwinfitMCMC&quot; objects.</p></a></li>
<li><a href='#predLines'><p>Draws predicted lines using a fitted model object</p></a></li>
<li><a href='#print.mlwinfitIGLS'><p>Summarize &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#print.mlwinfitMCMC'><p>Summarize &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#prior2macro'><p>Translates informative prior information into a concise MLwiN macro.</p></a></li>
<li><a href='#rats'><p>Weights of 30 rats, measured weekly over 5 weeks.</p></a></li>
<li><a href='#reading1'><p>Students' reading attainment in inner London infant schools.</p></a></li>
<li><a href='#residuals.mlwinfitIGLS'><p>Returns the residual data from &quot;mlwinfitIGLS&quot; objects.</p></a></li>
<li><a href='#residuals.mlwinfitMCMC'><p>Returns the residual data from &quot;mlwinfitMCMC&quot; objects.</p></a></li>
<li><a href='#runMLwiN'><p>Calls MLwiN from R.</p></a></li>
<li><a href='#show,mlwinfitIGLS-method'><p>Show objects of class &quot;mlwinfitIGLS&quot;</p></a></li>
<li><a href='#show,mlwinfitMCMC-method'><p>Show objects of class &quot;mlwinfitMCMC&quot;</p></a></li>
<li><a href='#show.mlwinfitIGLS'><p>Summarize &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#show.mlwinfitMCMC'><p>Summarize &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#sixway'><p>Draws a sixway plot of MCMC diagnostics.</p></a></li>
<li><a href='#summary,mlwinfitIGLS-method'><p>Summarize &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#summary,mlwinfitMCMC-method'><p>Summarize &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#summary.mlwinfitIGLS'><p>Summarize &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#summary.mlwinfitMCMC'><p>Summarize &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#tidy.mlwinfitIGLS'><p>Summarises information about the components of a model from a statistical object (broom package).</p></a></li>
<li><a href='#tidy.mlwinfitMCMC'><p>Summarises information about the components of a model from a statistical object (broom package).</p></a></li>
<li><a href='#trajectories'><p>Plots MCMC chain trajectories</p></a></li>
<li><a href='#tutorial'><p>Exam results for six inner London Education Authorities</p></a></li>
<li><a href='#Untoggle'><p>Converts a categorical variable into several separate binary variables</p></a></li>
<li><a href='#update,mlwinfitIGLS-method'><p>Update &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#update,mlwinfitMCMC-method'><p>Update &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#update.mlwinfitIGLS'><p>Update &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#update.mlwinfitMCMC'><p>Update &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#vcov,mlwinfitIGLS-method'><p>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#vcov,mlwinfitMCMC-method'><p>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#vcov.mlwinfitIGLS'><p>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects</p></a></li>
<li><a href='#vcov.mlwinfitMCMC'><p>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects</p></a></li>
<li><a href='#wage1'><p>Simulated dataset of office workers' salary and other employment details.</p></a></li>
<li><a href='#write.IGLS'><p>Writes MLwiN macros to fit models using the iterative generalized least</p>
squares (IGLS) algorithm.</a></li>
<li><a href='#write.MCMC'><p>Writes MLwiN macros to fit models using Markov chain Monte Carlo (MCMC)</p>
methods</a></li>
<li><a href='#ws2foreign'><p>Converts data from one format to another within MLwiN</p></a></li>
<li><a href='#xc'><p>Examination scores of 16-year olds in Fife, Scotland.</p></a></li>
<li><a href='#xc1'><p>Examination scores of 16-year olds in Fife, Scotland.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.8-9</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-30</td>
</tr>
<tr>
<td>Title:</td>
<td>Running 'MLwiN' from Within R</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0),</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, stats4, Matrix, foreign (&ge; 0.8-46),
R2WinBUGS, digest (&ge; 0.6.5), texreg, foreach, parallel,
doParallel, coda (&ge; 0.16-1), lattice, memisc, broom, tibble</td>
</tr>
<tr>
<td>Suggests:</td>
<td>doBy, car, lmtest, mitools, reshape</td>
</tr>
<tr>
<td>Description:</td>
<td>An R command interface to the 'MLwiN' multilevel
    modelling software package.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.bristol.ac.uk/cmm/software/r2mlwin/">http://www.bristol.ac.uk/cmm/software/r2mlwin/</a>,<a href="https://r-forge.r-project.org/projects/r2mlwin/">https://r-forge.r-project.org/projects/r2mlwin/</a>,<a href="http://www.bristol.ac.uk/cmm/software/mlwin/">http://www.bristol.ac.uk/cmm/software/mlwin/</a></td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>MLwiN, (OpenBUGS, WinBUGS optional)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-30 02:46:08 UTC; Administrator</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhengzheng Zhang [aut, cre],
  Chris Charlton [aut],
  Richard Parker [aut],
  George Leckie [aut],
  William Browne [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhengzheng Zhang &lt;zhengzheng236@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-30 03:20:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='R2MLwiN-package'>Running MLwiN from within R</h2><span id='topic+R2MLwiN'></span><span id='topic+R2MLwiN-package'></span>

<h3>Description</h3>

<p><span class="pkg">R2MLwiN</span> is an R command interface to the MLwiN multilevel modelling
software package, allowing users to fit multilevel models using
MLwiN (and also WinBUGS / OpenBUGS) from within the R environment.
</p>


<h3>New features in version 0.8-3</h3>

<p>Support for model comparison tables via <code><a href="texreg.html#topic+texreg-package">texreg-package</a></code> and <code>memisc-package</code> have been
added to <span class="pkg">R2MLwiN</span> version 0.8-3. For an example of using <code><a href="texreg.html#topic+texreg-package">texreg-package</a></code> see e.g. <code>demo(MCMCGuide04)</code>.
</p>


<h3>Important differences between version 0.8-0 and earlier versions</h3>

<p>A number of wide-ranging changes, including a new model-fitting syntax more
in keeping with that conventionally used in R, were introduced in
<span class="pkg">R2MLwiN</span> version 0.8-0.
</p>
<p>The demos, which replicate both the User's Guide to MLwiN (Rasbash et al, 2012) and
MCMC Estimation in MLwiN (Browne, 2012) manuals, provide practical demonstrations of many
of these changes. See <code>demo(package = "R2MLwiN")</code> for a list of demo titles; to run one
type e.g. <code>demo(UserGuide03)</code> or view a demo's script via
<code>file.show(system.file("demo", "UserGuide03", package = "R2MLwiN"))</code>.
</p>

<ul>
<li><p>The Formula is now specified via a <code><a href="stats.html#topic+formula">formula</a></code> object (with some differences
in specification: see <code><a href="#topic+runMLwiN">runMLwiN</a></code>). So, for example,
previously a 2-level model random intercept model would be specified by e.g.
<code>normexam ~ (0|cons + standlrt) + (2|cons) + (1|cons), levID = c('school', 'student')</code>,
with <code>normexam</code> the response variable, <code>cons</code> a constant of ones forming the intercept,
which is allowed to vary at level 1 (<code>student</code>) and level 2 (<code>school</code>), and
<code>standlrt</code> included as a predictor in the fixed part of the model. Whilst back-compatibility
is preserved (i.e. this specification will currently still work) the same model can now be more
parsimoniously specified via <code>normexam ~ 1 + standlrt + (1 | school) + (1 | student)</code>.
As well examples in the demos, see <code><a href="#topic+runMLwiN">runMLwiN</a></code> and <code><a href="#topic+Formula.translate">Formula.translate</a></code> for further info.
</p>
</li>
<li><p>As a means of specifying cross-classified, multiple membership or CAR models, <code>xclass</code> is now deprecated.
Instead, cross-classified models are specified via <code>xc = TRUE</code>, multiple
membership models are specified via <code>mm</code>, and CAR models are specified via <code>car</code>,
in the list of <code>estoptions</code>. <code>mm</code> and <code>car</code> can be a list of
variable names, a list of vectors, or a matrix. See <code><a href="#topic+runMLwiN">runMLwiN</a></code> for further details.
</p>
</li>
<li><p>Multiple membership/CAR information can now be specified using matrices.
<code><a href="#topic+df2matrix">df2matrix</a></code> and <code><a href="#topic+matrix2df">matrix2df</a></code> functions have also been added to convert such
information between <code><a href="base.html#topic+data.frame">data.frame</a></code> and <code><a href="base.html#topic+matrix">matrix</a></code> formats.
</p>
</li>
<li><p>As a means of specifying common (i.e. the same for each category) or separate (i.e. one for each
category) coefficients in ordered multinomial
and multivariate response models, <code>c</code> (for common) and <code>s</code> (for separate) have been
replaced by the employment of square brackets after the relevant variable to indicate a common
coefficient is to be fitted (a separate coefficient will be fitted otherwise). Within these square
brackets needs to be placed a numeric identifier indicating the responses for which a common coefficient
is to be added (see <code><a href="#topic+runMLwiN">runMLwiN</a></code> for further details). E.g. what would have been previously
specified, within the <code>Formula</code> object, as <code>... (0s|cons + ravens) + (0c|fluent{1, 0}) ...</code> would now be specified by
<code>... 1 + ravens + fluent[1] ...</code>.
</p>
</li>
<li><p>When added as a predictor, a variable encoded as a <code><a href="base.html#topic+factor">factor</a></code> is automatically
handled as categorical, replacing the previous use of square brackets after the variable name.
</p>
</li>
<li><p>A number of generic s4 methods have been added to improve compatibility with statistical functions
which use them (e.g. see <code><a href="stats4.html#topic+stats4-package">stats4-package</a></code>). So, for example, the addition of 
a <code><a href="stats.html#topic+logLik">logLik</a></code> means a likelihood ratio test can now be conducted
on two <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> objects using the <code>lrtest</code> function,
e.g. <code>lrtest(mymodel1, mymodel2)</code>. See <code>help(package = "R2MLwiN")</code> for
the index listing these various methods.
</p>
</li></ul>



<h3>References</h3>



<h4>R2MLwiN</h4>

<p>Zhang, Z., Parker, R.M.A., Charlton, C.M.J., Leckie, G. and Browne, W.J.
(2016) R2MLwiN: A Package to Run MLwiN from within R.
Journal of Statistical Software, 72(10), 1-43.
doi:10.18637/jss.v072.i10
</p>



<h4>MLwiN software and manuals</h4>

<p>Browne, W.J. (2012) MCMC Estimation in MLwiN, v2.26.
Centre for Multilevel Modelling, University of Bristol.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
MLwiN Version 2.1. Centre for Multilevel Modelling, University of Bristol.
</p>
<p>Rasbash, J., Charlton, C. and Pillinger, R. (2012) Manual Supplement to
MLwiN v2.26. Centre for Multilevel Modelling, University of Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012)
A User's Guide to MLwiN Version 2.26. Centre for Multilevel Modelling,
University of Bristol.
</p>



<h4>OpenBUGS</h4>

<p>Thomas, A., O'Hara, B., Ligges, U. and Sturtz, S. (2006) Making BUGS Open.
R News, 6, 12:17.
</p>



<h4>WinBUGS</h4>

<p>Spiegelhalter, D.J., Thomas, A. and Best, N.G. (1999) WinBUGS Version 1.2
User Manual. MRC Biostatistics Unit.
</p>



<h3>Maintainer</h3>

<p>Zhengzheng Zhang <a href="mailto:zhengzheng236@gmail.com">zhengzheng236@gmail.com</a>
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="http://www.bristol.ac.uk/cmm/software/r2mlwin/">http://www.bristol.ac.uk/cmm/software/r2mlwin/</a>
</p>
</li>
<li> <p><a href="https://r-forge.r-project.org/projects/r2mlwin/">https://r-forge.r-project.org/projects/r2mlwin/</a>
</p>
</li>
<li> <p><a href="http://www.bristol.ac.uk/cmm/software/mlwin/">http://www.bristol.ac.uk/cmm/software/mlwin/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

data(tutorial, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
                     estoptions = list(EstM = 1), data = tutorial))

## The R2MLwiN package includes scripts to replicate all the analyses in
## Rasbash et al (2012) A User's Guide to MLwiN Version 2.26 and
## Browne, W.J. (2012) MCMC estimation in MLwiN Version 2.26.
## The MLwiN manuals are available online, see:
## http://www.bristol.ac.uk/cmm/software/mlwin/download/manuals.html

## For a list of demo titles
demo(package = 'R2MLwiN')

## Take MCMCGuide03 as an example
## To view file
file.show(system.file('demo', 'MCMCGuide03.R', package='R2MLwiN'))

## To run the demo
demo(MCMCGuide03)

## End(Not run)

</code></pre>

<hr>
<h2 id='+5B+2CmlwinfitIGLS+2CANY+2CANY+2CANY-method'>Extract or Replace parts of &quot;mlwinfitIGLS&quot; objects</h2><span id='topic++5B+2CmlwinfitIGLS+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+3C-+2CmlwinfitIGLS+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+5B+2CmlwinfitIGLS-method'></span><span id='topic++5B+5B+3C-+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Extract or Replace parts of &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS,ANY,ANY,ANY'
x[i, j, drop]

## S4 replacement method for signature 'mlwinfitIGLS,ANY,ANY,ANY'
x[i, j] &lt;- value

## S4 method for signature 'mlwinfitIGLS'
x[[i, j, drop]]

## S4 replacement method for signature 'mlwinfitIGLS'
x[[i, j]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B2CmlwinfitIGLS+2B2CANY+2B2CANY+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitIGLS+2B2CANY+2B2CANY+2B2CANY-method_+3A_i">i</code>, <code id="+2B5B+2B2CmlwinfitIGLS+2B2CANY+2B2CANY+2B2CANY-method_+3A_j">j</code></td>
<td>
<p>elements to extract or replace. For <code>[</code> and <code>[[</code>, these are <code>character</code>.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitIGLS+2B2CANY+2B2CANY+2B2CANY-method_+3A_drop">drop</code></td>
<td>
<p>not used.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitIGLS+2B2CANY+2B2CANY+2B2CANY-method_+3A_value">value</code></td>
<td>
<p>a suitable replacement value.</p>
</td></tr>
</table>

<hr>
<h2 id='+5B+2CmlwinfitMCMC+2CANY+2CANY+2CANY-method'>Extract or Replace parts of &quot;mlwinfitMCMC&quot; objects</h2><span id='topic++5B+2CmlwinfitMCMC+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+3C-+2CmlwinfitMCMC+2CANY+2CANY+2CANY-method'></span><span id='topic++5B+5B+2CmlwinfitMCMC-method'></span><span id='topic++5B+5B+3C-+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Extract or Replace parts of &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC,ANY,ANY,ANY'
x[i, j, drop]

## S4 replacement method for signature 'mlwinfitMCMC,ANY,ANY,ANY'
x[i, j] &lt;- value

## S4 method for signature 'mlwinfitMCMC'
x[[i, j, drop]]

## S4 replacement method for signature 'mlwinfitMCMC'
x[[i, j]] &lt;- value
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B5B+2B2CmlwinfitMCMC+2B2CANY+2B2CANY+2B2CANY-method_+3A_x">x</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitMCMC+2B2CANY+2B2CANY+2B2CANY-method_+3A_i">i</code>, <code id="+2B5B+2B2CmlwinfitMCMC+2B2CANY+2B2CANY+2B2CANY-method_+3A_j">j</code></td>
<td>
<p>elements to extract or replace. For <code>[</code> and <code>[[</code>, these are <code>character</code>.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitMCMC+2B2CANY+2B2CANY+2B2CANY-method_+3A_drop">drop</code></td>
<td>
<p>not used.</p>
</td></tr>
<tr><td><code id="+2B5B+2B2CmlwinfitMCMC+2B2CANY+2B2CANY+2B2CANY-method_+3A_value">value</code></td>
<td>
<p>a suitable replacement value.</p>
</td></tr>
</table>

<hr>
<h2 id='alevchem'>Chemistry A-level results from one exam board</h2><span id='topic+alevchem'></span>

<h3>Description</h3>

<p>Chemistry A-level results from one exam board; subset from Yang &amp; Woodhouse,
2001. See also Rasbash et al. (2012) and Browne (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alevchem
</code></pre>


<h3>Format</h3>

<p>A data frame with 2166 observations on the following 8 variables:
</p>

<dl>
<dt>lea</dt><dd><p>Local Education Authority ID.</p>
</dd>
<dt>estab</dt><dd><p>Establishment (institution) ID.</p>
</dd>
<dt>pupil</dt><dd><p>Pupil ID.</p>
</dd>
<dt>a_point</dt><dd><p>A-level point score
(an ordered factor with levels: <code>F</code>, <code>E</code>, <code>D</code>, <code>C</code>,
<code>B</code>, <code>A</code>).</p>
</dd>
<dt>gcse_tot</dt><dd><p>Total GCSE point score.</p>
</dd>
<dt>gcse_no</dt><dd><p>Number of GCSEs taken.</p>
</dd>
<dt>cons</dt><dd><p>Constant of ones</p>
</dd>
<dt>gender</dt><dd><p>Pupil's gender (a factor with levels: <code>male</code>,
<code>female</code>).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>alevchem</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012) <em>A
User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel Modelling,
University of Bristol.
</p>
<p>Yang, M., Woodhouse, G. (2001) Progress from GCSE to A and AS level:
institutional and gender differences, and trends over time. <em>British
Educational Research Journal</em> 27: 245-267.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(alevchem, package = "R2MLwiN")

alevchem$gcseav &lt;- alevchem$gcse_tot/alevchem$gcse_no - 6

# Note: Establishment codes on their own do not uniquely identify schools.
# Schools are instead uniquely identified by LEA code, establishment ID
# combination. Thus, here we generated a unique school ID.

alevchem$school &lt;- as.numeric(factor(paste0(alevchem$lea, alevchem$estab)))

(mymodel &lt;- runMLwiN(logit(a_point, cons, 6) ~ 1 + gcseav[1:5] + I(gcseav^2)[1:5] +
  gender[1:5] + (1[1:5] + gcseav[1:5] | school), 
  D = "Ordered Multinomial", estoptions = list(EstM = 1), data = alevchem))


## End(Not run)

</code></pre>

<hr>
<h2 id='augment.mlwinfitIGLS'>Augment data frame with information derived from the model fit (broom package).</h2><span id='topic+augment.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Augment data frame with information derived from the model fit (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
augment(x, data = x@frame, newdata = NULL, type.predict, type.residuals, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="augment.mlwinfitIGLS_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> model.</p>
</td></tr>
<tr><td><code id="augment.mlwinfitIGLS_+3A_data">data</code></td>
<td>
<p>original data onto which columns should be added</p>
</td></tr>
<tr><td><code id="augment.mlwinfitIGLS_+3A_newdata">newdata</code></td>
<td>
<p>new data to predict on, optional</p>
</td></tr>
<tr><td><code id="augment.mlwinfitIGLS_+3A_type.predict">type.predict</code></td>
<td>
<p>Type of prediction to compute</p>
</td></tr>
<tr><td><code id="augment.mlwinfitIGLS_+3A_type.residuals">type.residuals</code></td>
<td>
<p>Type of residuals to compute</p>
</td></tr>
<tr><td><code id="augment.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+augment">augment</a></code>
</p>

<hr>
<h2 id='augment.mlwinfitMCMC'>Augment data frame with information derived from the model fit (broom package).</h2><span id='topic+augment.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Augment data frame with information derived from the model fit (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
augment(x, data = x@data, newdata = NULL, type.predict, type.residuals, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="augment.mlwinfitMCMC_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> model.</p>
</td></tr>
<tr><td><code id="augment.mlwinfitMCMC_+3A_data">data</code></td>
<td>
<p>original data onto which columns should be added</p>
</td></tr>
<tr><td><code id="augment.mlwinfitMCMC_+3A_newdata">newdata</code></td>
<td>
<p>new data to predict on, optional</p>
</td></tr>
<tr><td><code id="augment.mlwinfitMCMC_+3A_type.predict">type.predict</code></td>
<td>
<p>Type of prediction to compute</p>
</td></tr>
<tr><td><code id="augment.mlwinfitMCMC_+3A_type.residuals">type.residuals</code></td>
<td>
<p>Type of residuals to compute</p>
</td></tr>
<tr><td><code id="augment.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+augment">augment</a></code>
</p>

<hr>
<h2 id='bang'>Sub-sample from the 1989 Bangladesh Fertility Survey (see Huq &amp; Cleveland,
1990)</h2><span id='topic+bang'></span>

<h3>Description</h3>

<p>A subset of data from the 1989 Bangladesh Fertility Survey, consisting of
2867 women across 61 districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bang
</code></pre>


<h3>Format</h3>

<p>A data frame with 2867 observations on the following 12 variables:
</p>

<dl>
<dt>woman</dt><dd><p>Identifying code for each woman (level 1 unit).</p>
</dd>
<dt>district</dt><dd><p>Identifying code for each district (level 2 unit).</p>
</dd>
<dt>use</dt><dd><p>Contraceptive use status at time of survey; a factor with levels
<code>Not_using</code> and <code>Using</code>.</p>
</dd>
<dt>use4</dt><dd><p>Contraceptive use status and method (a factor with levels:
<code>Sterilization</code>, <code>Modern_reversible_method</code>,
<code>Traditional_method</code>, <code>Not_using_contraception</code>).</p>
</dd>
<dt>lc</dt><dd><p>Number of living children at time of survey; a factor with ordered
levels <code>None</code>, <code>One_child</code>, <code>Two_children</code>,
<code>Three_plus</code>.</p>
</dd>
<dt>age</dt><dd><p>Age of woman at time of survey (in years), centred on sample mean
of 30 years.</p>
</dd>
<dt>urban</dt><dd><p>Type of region of residence; levels are <code>Rural</code> and
<code>Urban</code>.</p>
</dd>
<dt>educ</dt><dd><p>Woman's level of education (a factor with ordered levels
<code>None</code>, <code>Lower_primary</code>, <code>Upper_primary</code>,
<code>Secondary_and_above</code>.</p>
</dd>
<dt>hindu</dt><dd><p>Woman's religion; levels are <code>Muslim</code> and <code>Hindu</code>.</p>
</dd>
<dt>d_lit</dt><dd><p>Proportion of women in district who are literate.</p>
</dd>
<dt>d_pray</dt><dd><p>Proportion of Muslim women in district who pray every day (a
measure of religiosity).</p>
</dd>
<dt>cons</dt><dd><p>Constant of ones.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>bang</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and is a
subset of data from the 1989 Bangladesh Fertility Survey (Huq and Cleland,
1990) used by Rasbash et al. (2012) as an example when fitting logistic
models for binary and binomial responses. The full sample was analysed in
Amin et al. (1997).
</p>


<h3>Source</h3>

<p>Amin, S., Diamond, I., Steele, F. (1997) Contraception and
religiosity in Bangladesh. In: G. W. Jones, J. C. Caldwell, R. M. Douglas,
R. M. D'Souza (eds) <em>The Continuing Demographic Transition</em>, 268&ndash;289.
Oxford: Oxford University Press.
</p>
<p>Huq, N. M., Cleland, J. (1990) <em>Bangladesh fertility survey, 1989.</em>
Dhaka: National Institute of Population Research and Training (NIPORT).
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012) <em>A
User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset, with fewer variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(bang, package = "R2MLwiN")

bang$use4 &lt;- relevel(bang$use4, 4)

# Change contrasts if wish to avoid warning indicating that, by default,
# specified contrasts for ordered predictors will be ignored by runMLwiN
# (they will be fitted as "contr.treatment" regardless of this setting). To
# enable specified contrasts, set allowcontrast to TRUE (this will be the
# default in future package releases).
my_contrasts &lt;- options("contrasts")$contrasts
options(contrasts = c(unordered = "contr.treatment",
                      ordered = "contr.treatment"))

# As an alternative to changing contrasts, can instead use C() to specify
# contrasts for ordered predictors in formula object, e.g.:

# F1 &lt;- log(use4, cons) ~ 1 + C(lc, "contr.treatment") + (1 | district)

# (mymodel &lt;- runMLwiN(Formula = F1, 
#                      D = "Unordered Multinomial",
#                      estoptions = list(EstM = 1, nonlinear = c(1, 2)),
#                      data = bang,
#                      allowcontrast = TRUE))

F1 &lt;- log(use4, cons) ~ 1 + lc + (1 | district)

(mymodel &lt;- runMLwiN(Formula = F1, 
                     D = "Unordered Multinomial",
                     estoptions = list(EstM = 1, nonlinear = c(1, 2)),
                     data = bang))

# Change contrasts back to pre-existing:
options(contrasts = my_contrasts)


## End(Not run)

</code></pre>

<hr>
<h2 id='bang1'>Sub-sample from the 1989 Bangladesh Fertility Survey</h2><span id='topic+bang1'></span>

<h3>Description</h3>

<p>A subset of data from the 1989 Bangladesh Fertility Survey, consisting of
1934 women across 60 districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bang1
</code></pre>


<h3>Format</h3>

<p>A data frame with 1934 observations on the following 11 variables:
</p>

<dl>
<dt>woman</dt><dd><p>Identifying code for each woman (level 1 unit).</p>
</dd>
<dt>district</dt><dd><p>Identifying code for each district (level 2 unit).</p>
</dd>
<dt>use</dt><dd><p>Contraceptive use status at time of survey; a factor with levels
<code>Not_using</code> and <code>Using</code>.</p>
</dd>
<dt>lc</dt><dd><p>Number of living children at time of survey; an ordered factor with
levels <code>None</code>, <code>One_child</code>, <code>Two_children</code>,
<code>Three_plus</code>.</p>
</dd>
<dt>age</dt><dd><p>Age of woman at time of survey (in years), centred on sample mean
of 30 years.</p>
</dd>
<dt>urban</dt><dd><p>Type of region of residence; a factor with levels <code>Rural</code>
and <code>Urban</code>.</p>
</dd>
<dt>educ</dt><dd><p>Woman's level of education; an ordered factor with levels
<code>None</code>, <code>Lower_primary</code>, <code>Upper_primary</code>,
<code>Secondary_and_above</code>.</p>
</dd>
<dt>hindu</dt><dd><p>Woman's religion; a factor with levels <code>Muslim</code> and
<code>Hindu</code>.</p>
</dd>
<dt>d_illit</dt><dd><p>Proportion of women in district who are literate.</p>
</dd>
<dt>d_pray</dt><dd><p>Proportion of Muslim women in district who pray every day (a
measure of religiosity).</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>bang1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and is a
subset of data from the 1989 Bangladesh Fertility Survey (Huq and Cleland,
1990) used by Browne (2012) as an example when fitting logistic models for
binary and binomial responses. The full sample was analysed in Amin et al.
(1997).
</p>


<h3>Source</h3>

<p>Amin, S., Diamond, I., Steele, F. (1997) Contraception and
religiosity in Bangladesh. In: G. W. Jones, J. C. Caldwell, R. M. Douglas,
R. M. D'Souza (eds) <em>The Continuing Demographic Transition</em>, 268&ndash;289.
Oxford: Oxford University Press.
</p>
<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Huq, N. M., Cleland, J. (1990) <em>Bangladesh fertility survey, 1989.</em>
Dhaka: National Institute of Population Research and Training (NIPORT).
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset, with fewer variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(bang1, package = "R2MLwiN")

bang1$denomb &lt;- 1

# Change contrasts if wish to avoid warning indicating that, by default,
# specified contrasts for ordered predictors will be ignored by runMLwiN
# (they will be fitted as "contr.treatment" regardless of this setting). To
# enable specified contrasts, set allowcontrast to TRUE (this will be the
# default in future package releases).
my_contrasts &lt;- options("contrasts")$contrasts
options(contrasts = c(unordered = "contr.treatment",
                      ordered = "contr.treatment"))

# As an alternative to changing contrasts, can instead use C() to specify
# contrasts for ordered predictors in formula object, e.g.:

# F1 &lt;- logit(use, denomb) ~ 1 + age + C(lc, "contr.treatment") + urban +
#   (1 + urban | district)

# (mymodel &lt;- runMLwiN(Formula = F1,
#                      D = "Binomial",
#                      estoptions = list(EstM = 1),
#                      data = bang1,
#                      allowcontrast = TRUE))

F1 &lt;- logit(use, denomb) ~ 1 + age + lc + urban + (1 + urban | district)

(mymodel &lt;- runMLwiN(Formula = F1,
                     D = "Binomial",
                     estoptions = list(EstM = 1),
                     data = bang1))

# Change contrasts back to pre-existing:
options(contrasts = my_contrasts)


## End(Not run)

</code></pre>

<hr>
<h2 id='BD'>Calculates Brooks-Draper diagnostic</h2><span id='topic+BD'></span>

<h3>Description</h3>

<p>An internal function, for use in <code><a href="#topic+sixway">sixway</a></code>, which calculates the
Brooks-Draper diagnostic, based on an unpublished paper by David Draper. It
estimates the length of a Markov chain required to produce a mean estimate
to k significant figures with a given accuracy (alpha). See Browne (2012)
for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BD(est, var, rho, k = 2, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BD_+3A_est">est</code></td>
<td>
<p>Numeric scalar for the mean of the distribution</p>
</td></tr>
<tr><td><code id="BD_+3A_var">var</code></td>
<td>
<p>Numeric scalar for the variance of the distribution</p>
</td></tr>
<tr><td><code id="BD_+3A_rho">rho</code></td>
<td>
<p>The first lag (i.e. after zero) of the auto-correlation function (ACF) diagnostic</p>
</td></tr>
<tr><td><code id="BD_+3A_k">k</code></td>
<td>
<p>Integer scalar corresponding to the number of significant figures (defaults to <code>2</code>)</p>
</td></tr>
<tr><td><code id="BD_+3A_alpha">alpha</code></td>
<td>
<p>Numeric scalar indicating the desired accuracy (defaults to <code>0.05</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Brooks-Draper diagnostic statistic is returned.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>References</h3>

<p>Browne, W.J. (2012) MCMC Estimation in MLwiN, v2.26.
Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sixway">sixway</a></code>
</p>

<hr>
<h2 id='bes83'>Subsample from British Election Study, '83.</h2><span id='topic+bes83'></span>

<h3>Description</h3>

<p>Subsample from British Election Study, consisting of 800 voters across 110
areas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bes83
</code></pre>


<h3>Format</h3>

<p>A data frame with 800 observations on the following 10 variables:
</p>

<dl>
<dt>voter</dt><dd><p>Voter identifier.</p>
</dd>
<dt>area</dt><dd><p>Identifier for voters' constituencies.</p>
</dd>
<dt>defence</dt><dd><p>Score on a 21 point scale of attitudes towards nuclear weapons
with low scores indicating disapproval of Britain possessing them.  This
variable is centred about its mean.</p>
</dd>
<dt>unemp</dt><dd><p>Score on a 21 point scale of attitudes towards unemployment with
low scores indicating strong opposition and higher scores indicating a
preference for greater unemployment if it results in lower inflation.  This
variable is centred about its mean.</p>
</dd>
<dt>taxes</dt><dd><p>Score on a 21 point scale of attitudes towards tax cuts with low
scores indicating a preference for higher taxes to pay for more government
spending.  This variable is centred about its mean.</p>
</dd>
<dt>privat</dt><dd><p>Score on a 21 point scale of attitudes towards privatization of
public services with low scores indicating opposition.  This variable is
centred about its mean.</p>
</dd>
<dt>votecons</dt><dd><p>If respondent voted Conservative; a factor with levels
<code>Other</code> and <code>Voted_Conservative</code>.</p>
</dd>
<dt>cons</dt><dd><p>This variable is constant (= 1) for all voters.</p>
</dd>
<dt>denom</dt><dd><p>This variable is constant (= 1) for all voters.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>bes83</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009). See
Heath et al (1996), and also Rasbash et al (2012) and Browne (2012).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Heath, A., Yang, M., Goldstein, H. (1996). Multilevel analysis of the
changing relationship between class and party in Britain 1964-1992.
<em>Quality and Quantity</em>, 30:389-404.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012) <em>A
User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(bes83, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(logit(votecons, cons) ~ 1 + defence + unemp + taxes + privat + (1 | area),
  D = "Binomial", estoptions = list(EstM = 1), data = bes83))


## End(Not run)

</code></pre>

<hr>
<h2 id='caterpillar'>Draws a caterpillar plot (in MLwiN style).</h2><span id='topic+caterpillar'></span>

<h3>Description</h3>

<p>A convenient wrapper for the <code>plot</code> function with the addition
of error bars, e.g. to create caterpillar plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caterpillar(
  y,
  x,
  qtlow,
  qtup,
  xlab = "",
  ylab = "",
  xlim = NULL,
  ylim = NULL,
  main = ""
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caterpillar_+3A_y">y</code></td>
<td>
<p>A numerical vector specifying the <code>y</code> coordinates
(e.g. the means or medians); see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_x">x</code></td>
<td>
<p>A numerical vector specifying the <code>x</code> coordinates; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_qtlow">qtlow</code></td>
<td>
<p>A numerical vector (e.g. of lower-quantiles) to be used to plot lower error
bars.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_qtup">qtup</code></td>
<td>
<p>A numerical vector (e.g. of upper-quantiles) to be used to upper plot error
bars.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_xlab">xlab</code></td>
<td>
<p>A label for the <code>x</code> axis. This is empty by default; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_ylab">ylab</code></td>
<td>
<p>A label for the <code>y</code> axis. This is empty by default; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_xlim">xlim</code></td>
<td>
<p>The <code>x</code> limits <code>(x1, x2)</code> of the plot. Note that
<code>x1 &gt; x2</code> is allowed and leads to a &lsquo;reversed axis&rsquo;. The default value,
<code>NULL</code>, indicates that the range of the finite values to be plotted
should be used; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_ylim">ylim</code></td>
<td>
<p>The y limits of the plot; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
<tr><td><code id="caterpillar_+3A_main">main</code></td>
<td>
<p>A main title for the plot; see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol, U.K.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+caterpillarR">caterpillarR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved where R2MLwiN defaults to:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

# Example using tutorial dataset
data(tutorial, package = 'R2MLwiN')
(mymodel &lt;- runMLwiN(normexam ~ 1 + (1 | school) + (1 | student),
                     estoptions = list(resi.store = TRUE),
                     data = tutorial))

# For each school, calculate the CIs...
residuals &lt;- mymodel@residual$lev_2_resi_est_Intercept
residualsCI &lt;- 1.96 * sqrt(mymodel@residual$lev_2_resi_var_Intercept)
residualsRank &lt;- rank(residuals)
rankno &lt;- order(residualsRank)

caterpillar(y = residuals[rankno], x = 1:65, qtlow = (residuals - residualsCI)[rankno],
           qtup = (residuals + residualsCI)[rankno], xlab = 'Rank', ylab = 'Intercept')

## End(Not run)

</code></pre>

<hr>
<h2 id='caterpillarR'>Draws caterpillar plots of the residuals from a mlwinfitIGLS-class or 
mlwinfitMCMC-class object, at a chosen level of the multilevel model.</h2><span id='topic+caterpillarR'></span>

<h3>Description</h3>

<p>Uses <code><a href="lattice.html#topic+qqmath">qqmath</a></code> in the <span class="pkg">lattice</span> package to draw Quantile-Quantile plots
of the residuals at a chosen level of a multilevel model against a
theoretical distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>caterpillarR(resi, lev = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="caterpillarR_+3A_resi">resi</code></td>
<td>
<p>A <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> or 
<code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object (model must be fitted specifying
<code>resi.store = TRUE</code> and including <code>'variances'</code> or <code>'sampling'</code> in the list of
<code>resioptions</code> (both in <code>estoptions</code>) to not return an error).</p>
</td></tr>
<tr><td><code id="caterpillarR_+3A_lev">lev</code></td>
<td>
<p>An integer scalar specifying the level of a multilevel model
for which to produce a plot for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>See <code><a href="lattice.html#topic+qqmath">qqmath</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+caterpillar">caterpillar</a></code>, <code><a href="lattice.html#topic+qqmath">qqmath</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved where R2MLwiN defaults to:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/') 

# Example using tutorial dataset
data(tutorial, package = 'R2MLwiN')
mymodel &lt;- runMLwiN(normexam ~ 1 + (1 | school) + (1 | student),
                    estoptions = list(resi.store = TRUE),
                    data = tutorial)
# Caterpillar plot
caterpillarR(mymodel['residual'], lev = 2)

## End(Not run)

</code></pre>

<hr>
<h2 id='coef+2CmlwinfitIGLS-method'>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+coef+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="coef+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+coef-methods">coef-methods</a></code>
</p>

<hr>
<h2 id='coef+2CmlwinfitMCMC-method'>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+coef+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef+2B2CmlwinfitMCMC-method_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="coef+2B2CmlwinfitMCMC-method_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+coef-methods">coef-methods</a></code>
</p>

<hr>
<h2 id='coef.mlwinfitIGLS'>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+coef.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Extract the coefficient vector from &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="coef.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+coef">coef</a></code>
</p>

<hr>
<h2 id='coef.mlwinfitMCMC'>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+coef.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Extract the coefficient vector from &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="coef.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+coef">coef</a></code>
</p>

<hr>
<h2 id='cvd'>Data from the 1998 Scottish Health Survey on cardiovascular disease status of
8804 respondents</h2><span id='topic+cvd'></span>

<h3>Description</h3>

<p>Data from the 1998 Scottish Health Survey, with 8804 respondents aged between
18 and 64. The outcome, <code>cvddef</code>, is a self-report of a doctor-diagnosed
cardiovascular disease (CVD) condition (angina, diabetes, hypertension, acute
myocardial infarction, etc.). This is a binary response, whether (1) or not
(0) respondents have CVD condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvd
</code></pre>


<h3>Format</h3>

<p>A data frame with 8804 observations on the following 9 variables:
</p>

<dl>
<dt>age</dt><dd><p>Age.</p>
</dd>
<dt>sex</dt><dd><p>Gender (factor with levels: <code>male</code>, <code>female</code>).</p>
</dd>
<dt>sc</dt><dd><p>Social class (factor with levels: <code>12</code> (social class 1 and 2),
<code>3</code> (social class 3), <code>45</code> (social class 4 and 5)).</p>
</dd>
<dt>cvddef</dt><dd><p>Self-reported cardiovascular disease (<code>0</code> = does not have
condition, <code>1</code> = has condition)</p>
</dd>
<dt>carstair</dt><dd><p>Carstairs score.</p>
</dd>
<dt>smoke</dt><dd><p>Smoking frequency (factor with levels: <code>lite</code> (&lt;10 a day),
<code>mod</code> (10-19 a day), <code>hvy</code> (20+ a day), <code>ex</code> (ex-smoker),
<code>nevr</code> (never smoked)).</p>
</dd>
<dt>id</dt><dd><p>Respondent identifier.</p>
</dd>
<dt>area</dt><dd><p>Postcode sector</p>
</dd> </dl>



<h3>Details</h3>

<p>The <code>cvd</code> dataset is one of the example datasets analysed in
Leyland and Groenewegen (2020), and provided with the
multilevel-modelling software package MLwiN (Charlton et al., 2024), as
<code>cvd_data</code>.
</p>


<h3>Source</h3>

<p>Charlton, C., Rasbash, J., Browne, W.J., Healy, M. and Cameron, B. (2024)
<em>MLwiN Version 3.09</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Leyland A.H. (2005) Socioeconomic gradients in the prevalence of cardiovascular
disease in Scotland: the roles of composition and context. <em>J Epidemiol
Community Health</em> 59:799–803
</p>
<p>Leyland, A.H., Groenewegen, P.P. (2020). Untangling Context and Composition.
In: <em>Multilevel Modelling for Public Health and Health Services Research</em>.
Springer, Cham. <a href="https://doi.org/10.1007/978-3-030-34801-4_13">doi:10.1007/978-3-030-34801-4_13</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(cvd, package = "R2MLwiN")

# Example taken from Leyland and Groenewegen (2020)

F1 &lt;- logit(cvddef) ~ 1 + I(age^3) + I(age^3):I(log(age)) +
  sex + sex:I(age^3) + sex:I(age^3):I(log(age)) +
  (1 | area)

(mod_MQL1 &lt;- runMLwiN(Formula = F1,
                      D = "Binomial",
                      data = cvd))

(mod_PQL2 &lt;- runMLwiN(Formula = F1,
                      D = "Binomial",
                      data = cvd,
                      estoptions = list(
                        nonlinear = c(N = 1, M = 2),
                        startval = list(FP.b = mod_MQL1@FP,
                                        FP.v = mod_MQL1@FP.cov,
                                        RP.b = mod_MQL1@RP,
                                        RP.v = mod_MQL1@RP.cov))))

## End(Not run)
</code></pre>

<hr>
<h2 id='deviance.mlwinfitIGLS'>Returns the deviance from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+deviance.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the deviance from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="deviance.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+deviance">deviance</a></code>
</p>

<hr>
<h2 id='df.residual.mlwinfitIGLS'>Returns the residual degrees-of-freedom extracted from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+df.residual.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the residual degrees-of-freedom extracted from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
df.residual(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df.residual.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="df.residual.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nobs">nobs</a></code>, <code><a href="stats.html#topic+coef">coef</a></code>
</p>

<hr>
<h2 id='df2matrix'>Translates a data.frame, formatted for use in multiple membership
modelling in MLwiN, to a matrix.</h2><span id='topic+df2matrix'></span>

<h3>Description</h3>

<p>Translates a <code><a href="base.html#topic+data.frame">data.frame</a></code>, in a form usable by MLwiN for multiple membership models,
into a <code><a href="base.html#topic+matrix">matrix</a></code>. The data.frame needs to contain (a) columns with membership IDs
(e.g. first row of which might be <code>2, 3, 5, 6, 0, 0</code>) and (b) columns containing weights
(e.g. first row of which might be <code>0.25, 0.25, 0.25, 0.25, 0, 0</code>; in this example the first row of
resulting matrix would be <code>0, 1, 1, 0, 1, 1</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df2matrix(data, idcols, weightcols)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df2matrix_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> object.</p>
</td></tr>
<tr><td><code id="df2matrix_+3A_idcols">idcols</code></td>
<td>
<p>String vector of the identifier column names.</p>
</td></tr>
<tr><td><code id="df2matrix_+3A_weightcols">weightcols</code></td>
<td>
<p>String vector of the weight column names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An adjacency matrix as returned by <code><a href="Matrix.html#topic+sparseMatrix">sparseMatrix</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol, U.K.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+matrix2df">matrix2df</a></code>
</p>

<hr>
<h2 id='diag1'>Examination dataset</h2><span id='topic+diag1'></span>

<h3>Description</h3>

<p>Examination data for 907 students within 18 schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diag1
</code></pre>


<h3>Format</h3>

<p>A data frame with 907 observations on the following 9 variables:
</p>

<dl>
<dt>school</dt><dd><p>School identifier.</p>
</dd>
<dt>sex</dt><dd><p>Pupil gender.</p>
</dd>
<dt>vrq</dt><dd><p>Verbal Reasoning quotient.</p>
</dd>
<dt>ilea</dt><dd><p>O-level/CSE examination results.</p>
</dd>
<dt>type</dt><dd><p>School type: a factor with levels <code>Comprehensive</code> and
<code>Grammar</code>.</p>
</dd>
<dt>pupil</dt><dd><p>Pupil identifier.</p>
</dd>
<dt>cons</dt><dd><p>Constant (=1).</p>
</dd>
<dt>n_ilea</dt><dd><p>O-level/CSE examination results (normal scores).</p>
</dd>
<dt>n_vrq</dt><dd><p>Verbal Reasoning quotient (normal scores).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>diag1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009),
originally analysed in Aitkin &amp; Longford (1986), and described further in
Rasbash et al. (2012).
</p>


<h3>Source</h3>

<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B.
(2009) <em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University
of Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J., Goldstein, H. (2012) <em>A User's
Guide to MLwiN v2.26</em>. University of Bristol: Centre for Multilevel
Modelling.
</p>
<p>Aitkin, M. &amp; Longford, N. (1986). Statistical modelling in school
effectiveness studies (with discussion). Journal of the Royal Statistical
Society, Series A, 149:1-43.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(diag1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(n_ilea ~ 1 + n_vrq + (1 + n_vrq | school) + (1 | pupil),
  estoptions = list(resi.store = TRUE, resioptions = c("standardised",
  "leverage", "influence", "deletion")), data = diag1))


## End(Not run)

</code></pre>

<hr>
<h2 id='double2singlePrecision'>Converts numerical values from double precision to single precision.</h2><span id='topic+double2singlePrecision'></span>

<h3>Description</h3>

<p>This function converts numeric column(s) of a data frame object, matrix or
vector from double precision to single precision, e.g. to avoid a warning
from MLwiN which currently only stores data in single precision.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>double2singlePrecision(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="double2singlePrecision_+3A_x">x</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> object, matrix or vector to be converted. Column(s)
of these objects will be ignored during conversion if they are not
numeric.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of numerical values in single precision will be returned.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>

<hr>
<h2 id='extract+2CmlwinfitIGLS-method'>Extract coefficients and GOF measures from a statistical object (texreg package).</h2><span id='topic+extract+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Extract coefficients and GOF measures from a statistical object (texreg package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
extract(
  model,
  include.nobs = TRUE,
  include.loglik = TRUE,
  include.deviance = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract+2B2CmlwinfitIGLS-method_+3A_model">model</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> model.</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitIGLS-method_+3A_include.nobs">include.nobs</code></td>
<td>
<p>should the number of observations be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitIGLS-method_+3A_include.loglik">include.loglik</code></td>
<td>
<p>should the log-likelihood be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitIGLS-method_+3A_include.deviance">include.deviance</code></td>
<td>
<p>should the deviance be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="texreg.html#topic+extract">extract</a></code>
</p>

<hr>
<h2 id='extract+2CmlwinfitMCMC-method'>Extract coefficients and GOF measures from a statistical object.</h2><span id='topic+extract+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Extract coefficients and GOF measures from a statistical object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
extract(
  model,
  include.nobs = TRUE,
  include.dbar = TRUE,
  include.dthetabar = TRUE,
  include.pd = TRUE,
  include.dic = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_model">model</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> model.</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_include.nobs">include.nobs</code></td>
<td>
<p>should the number of observations be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_include.dbar">include.dbar</code></td>
<td>
<p>should the Dbar be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_include.dthetabar">include.dthetabar</code></td>
<td>
<p>should the D(thetabar) be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_include.pd">include.pd</code></td>
<td>
<p>should the pD be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_include.dic">include.dic</code></td>
<td>
<p>should the DIC be reported?</p>
</td></tr>
<tr><td><code id="extract+2B2CmlwinfitMCMC-method_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="texreg.html#topic+extract">extract</a></code>
</p>

<hr>
<h2 id='fitted.mlwinfitIGLS'>Returns the fitted values from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+fitted.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the fitted values from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="fitted.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fitted.values">fitted.values</a></code>
</p>

<hr>
<h2 id='fitted.mlwinfitMCMC'>Returns the fitted values from &quot;mlwinfitMCMC&quot; objects.</h2><span id='topic+fitted.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Returns the fitted values from &quot;mlwinfitMCMC&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.</p>
</td></tr>
<tr><td><code id="fitted.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+fitted.values">fitted.values</a></code>
</p>

<hr>
<h2 id='formula.mlwinfitIGLS'>&quot;mlwinfitIGLS&quot; model formula</h2><span id='topic+formula.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>&quot;mlwinfitIGLS&quot; model formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
formula(x, env = parent.frame(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.mlwinfitIGLS_+3A_x">x</code></td>
<td>
<p>See <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="formula.mlwinfitIGLS_+3A_env">env</code></td>
<td>
<p>See <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="formula.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments; see <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='formula.mlwinfitMCMC'>&quot;mlwinfitMCMC&quot; model formula</h2><span id='topic+formula.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>&quot;mlwinfitMCMC&quot; model formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
formula(x, env = parent.frame(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.mlwinfitMCMC_+3A_x">x</code></td>
<td>
<p>See <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="formula.mlwinfitMCMC_+3A_env">env</code></td>
<td>
<p>See <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
<tr><td><code id="formula.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments; see <code><a href="stats.html#topic+formula">formula</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='Formula.translate'>An internal function to translate an R formula into an R list object.</h2><span id='topic+Formula.translate'></span>

<h3>Description</h3>

<p>A model formula, as a formula object written in R-type syntax, is translated
into an R list object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Formula.translate(Formula, D = "Normal", indata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Formula.translate_+3A_formula">Formula</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object specifying a multilevel model.
See <code><a href="stats.html#topic+formula">formula</a></code> for notes on general usage, and <code><a href="#topic+runMLwiN">runMLwiN</a></code> for
further details.</p>
</td></tr>
<tr><td><code id="Formula.translate_+3A_d">D</code></td>
<td>
<p>A character string/vector specifying the type of distribution to be modelled, which
can include <code>'Normal'</code> (the default), <code>'Binomial'</code>, <code>'Poisson'</code>,
<code>'Negbinom'</code>, <code>'Unordered Multinomial'</code>, <code>'Ordered Multinomial'</code>,
<code>'Multivariate Normal'</code>, or <code>'Mixed'</code>. In the case of the latter,
<code>'Mixed'</code> precedes the response types which also need to be listed in
<code>D</code>, e.g. <code>c('Mixed', 'Normal', 'Binomial')</code>; these need to be
be listed in the same order to which they are referred to in the
<code>Formula</code> object.</p>
</td></tr>
<tr><td><code id="Formula.translate_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data to be modelled.
Optional (can <code><a href="base.html#topic+attach">attach</a></code> as an alternative) but recommended.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Outputs an R list object, which is then used as the input for
<code><a href="#topic+write.IGLS">write.IGLS</a></code> or <code><a href="#topic+write.MCMC">write.MCMC</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>, <code><a href="#topic+write.IGLS">write.IGLS</a></code>, <code><a href="#topic+write.MCMC">write.MCMC</a></code>; for
function allowing back-compatibility with Formula syntax used in older
versions of <span class="pkg">R2MLwiN</span> (&lt;0.8.0) see <code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# NB: See demo(packge = 'R2MLwiN') for a wider range of examples.
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

# Two-level random intercept model with student (level 1) nested within
# school (level 2) and standlrt added to the fixed part.
# Importantly, the ordering of school and student reflects their hierarchy,
# with the highest level (school) specified first.
# E.g. see demo(UserGuide04)
data(tutorial, package = 'R2MLwiN')
(mymodel1 &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 | school) + (1 | student),
                     data = tutorial))

# Adding a random slope
(mymodel2 &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school)
                     + (1 | student), data = tutorial))

# Exploring complex level 1 variation
# E.g. see demo(UserGuide07)
(mymodel3 &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school)
                      + (1 + standlrt | student), data = tutorial))

# Logit link with cons specified as denominator
# Note level 1 ID not explicitly specified
# E.g. see demo(UserGuide09)
data(bang, package = 'R2MLwiN')
(mymodel4 &lt;- runMLwiN(logit(use, cons) ~ 1 + lc + age + (1 | district),
                      D = 'Binomial', data = bang))

# Mixed response model
# Note using MCMC estimation (EstM = 1)
# Normal (english) and Bernoulli (behaviour) distributed responses
# probit link modelling behaviour with cons as denominator
# E.g. see demo(MCMCGuide19)
data(jspmix1, package = 'R2MLwiN')
(mymodel &lt;- runMLwiN(c(english, probit(behaviour, cons)) ~
                     1 + sex + ravens + fluent[1] + (1 | school) + (1[1] | id),
                     D = c('Mixed', 'Normal', 'Binomial'),
                     estoptions = list(EstM = 1,
                     mcmcMeth = list(fixM = 1, residM = 1, Lev1VarM = 1)),
                     data = jspmix1))

## End(Not run)

</code></pre>

<hr>
<h2 id='Formula.translate.compat'>An internal function, allowing back-compatibility, which translates a model
formula from a formula object or character string into an R list object.</h2><span id='topic+Formula.translate.compat'></span>

<h3>Description</h3>

<p>Supports Formula syntax as used in earlier (&lt;0.8-0) versions of <span class="pkg">R2MLwiN</span>. A model
formula, as a formula object (or a character string) is translated into
an R list object. Called by <code><a href="#topic+runMLwiN">runMLwiN</a></code> if <code>oldsyntax = TRUE</code>
(when user specifies <code>levID</code> not <code>NULL</code> in <code><a href="#topic+runMLwiN">runMLwiN</a></code> function
call). For corresponding function supporting new syntax, see
<code><a href="#topic+Formula.translate">Formula.translate</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Formula.translate.compat(Formula, levID, D = "Normal", indata)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Formula.translate.compat_+3A_formula">Formula</code></td>
<td>
<p>A formula object (or a character string) specifying a
multilevel model. See <code>Value</code> for details.</p>
</td></tr>
<tr><td><code id="Formula.translate.compat_+3A_levid">levID</code></td>
<td>
<p>A character (vector) specifying the level ID(s).</p>
</td></tr>
<tr><td><code id="Formula.translate.compat_+3A_d">D</code></td>
<td>
<p>A character string/vector specifying the distribution to be
modelled, which can include <code>'Normal'</code> (the default), <code>'Binomial'</code>,
<code>'Poisson'</code>, <code>'Negbinom'</code>, <code>'Unordered Multinomial'</code>,
<code>'Ordered Multinomial'</code>, <code>'Multivariate Normal'</code>, or <code>'Mixed'</code>.</p>
</td></tr>
<tr><td><code id="Formula.translate.compat_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data to be modelled.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>Formula</code> is a character string, then the following
syntax applies:
</p>

<ul>
<li> <p><code>~</code> A tilde is used to separate response variable(s) and
explanatory variable(s).
</p>
</li>
<li> <p><code>()</code> Round brackets are used to specify each random
variable in the model together with its fixed/random part information.
</p>
</li>
<li> <p><code>|</code> Separates explanatory variable(s) (placed to the right of
<code>|</code>) from the fixed/random part information (placed to the left of
<code>|</code>) when placed within <code>()</code>.
</p>
</li>
<li> <p><code>[]</code> When placed
immediately after an explanatory variable, indicates that the variable is
categorical. The string in the <code>[]</code> represents the reference category;
if empty, no reference category is used; See note.
</p>
</li>
<li> <p><code>:</code> Indicates an interaction term: i.e. the variables adjacent to <code>:</code>, and
separated by it, are interacted with each other.
</p>
</li>
<li> <p><code>0</code> When placed to the left of <code>|</code> within <code>()</code> indicates that the variables
to the right of <code>|</code> within the same <code>()</code> are to be added to the
fixed part of the model.
</p>
</li>
<li> <p><code>1</code> When placed to the left of
<code>|</code> within <code>()</code> indicates that the coefficients of the variables
placed to the right of <code>|</code> within the same <code>()</code> are to be allowed
to randomly vary at level 1 (and so on for <code>2</code> for level 2, <code>3</code> for level 3, etc.)
</p>
</li>
<li> <p><code>0s/0c</code> When placed to the left of <code>|</code> within <code>()</code>
indicates that separate (hence <code>s</code>) / common (hence <code>c</code>)
coefficients for the variables to the right of <code>|</code> within the same
<code>()</code> are to be added to the fixed part (hence <code>0</code>) of multivariate
normal, multinomial and mixed responses models.
</p>
</li>
<li> <p><code>2s/2c</code> When
placed to the left of <code>|</code> within <code>()</code> indicates that separate
(hence <code>s</code>) / common (hence <code>c</code>) coefficients for the variables to
the right of <code>|</code> within the same <code>()</code> are to be added to the
random part of the model, and allowed to vary at level 2; applies to
multivariate normal, multinomial and mixed responses models only.
</p>
</li>
<li> <p><code>{}</code> gives a vector of binary indicators specifying a
common coefficient. 1 is to include the component at the corresponding
positions; zero otherwise. These digits are separated by commas; applies to
multivariate normal, multinomial and mixed responses models only.
</p>
</li>
<li> <p><code>.</code> Used for adding a separate coefficient for a particular
component at a specific level; applies to multivariate normal, multinomial
and mixed responses models only
</p>
</li></ul>

<p>If <code>Formula</code> is a formula object, <code>0s/0c</code>, <code>2s/2c</code>, .... and
<code>{}</code> have to be replaced by <code>`0s`/`0c`</code>, <code>`2s`/`2c`</code>, ....
and <code>()</code> respectively. Other syntax remains the same.
</p>


<h3>Value</h3>

<p>Outputs an R list object, which is then used as the input for
<code><a href="#topic+write.IGLS">write.IGLS</a></code> and/or <code><a href="#topic+write.MCMC">write.MCMC</a></code>.
</p>


<h3>Note</h3>

<p>Note that some characters listed above have special meanings in the
formula, so avoid using them when you name the random variable. Alphanumeric
characters (i.e. <code>[:alnum:]</code>) are recommended for naming the random
variable. They are also recommended for naming a reference category, inside
<code>[]</code>.  Note: use <code>[]</code> notation only in the fixed part when
there is no categorical variable in the random effects. If there is one in
the random part, the categorical variable has to be converted into a set of
binary variables (e.g., using <code><a href="#topic+Untoggle">Untoggle</a></code>).
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>, <code><a href="#topic+write.IGLS">write.IGLS</a></code>, <code><a href="#topic+write.MCMC">write.MCMC</a></code>, <code><a href="#topic+Formula.translate">Formula.translate</a></code>
</p>

<hr>
<h2 id='fysio'>Data on physiotherapy referrals from 100 general practices in the Netherlands,
collected in 1987</h2><span id='topic+fysio'></span>

<h3>Description</h3>

<p>These data were collected in 1987 as part of a large national survey of general
practice (Van der Velden 1999).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fysio
</code></pre>


<h3>Format</h3>

<p>A data frame with 16700 observations on the following 14 variables:
</p>

<dl>
<dt>gpid</dt><dd><p>GP identifier.</p>
</dd>
<dt>patid</dt><dd><p>Patient identifier.</p>
</dd>
<dt>patage</dt><dd><p>Patient age in years.</p>
</dd>
<dt>pagegrp</dt><dd><p>Patient age group, with ages grouped into 7 categories (ordered factor with levels
<code>page&lt;35</code>, <code>35&lt;=page&lt;45</code>, <code>45&lt;=page&lt;55</code>, <code>55&lt;=page&lt;65</code>, <code>65&lt;=page&lt;75</code>,
<code>75&lt;=page&lt;85</code>, <code>85&lt;=page</code>).</p>
</dd>
<dt>patsex</dt><dd><p>Patient gender (factor with levels <code>female</code>, <code>male</code>).</p>
</dd>
<dt>patinsur</dt><dd><p>Patient insurance indicator (factor with levels
<code>privateins</code> (privately insured), <code>publicins</code> (publically insured)).</p>
</dd>
<dt>patedu</dt><dd><p>Patient education level (ordered factor with levels <code>none</code>
(no formal education), <code>primary</code> (primary education), <code>secondary</code>
(secondary and lower/middle vocational education), <code>higher</code> (higher vocational
and university education)).</p>
</dd>
<dt>diag</dt><dd><p>Primary diagnosis resulting from care episodes
(factor with levels
<code>1</code> (symptoms/complaints neck),
<code>2</code> (symptoms/complaints back),
<code>3</code> (myalgia/fibrositis),
<code>4</code> (symptoms of multiple muscles),
<code>5</code> (disabilities related to the locomotive system),
<code>6</code> (impediments of the cervical spine),
<code>7</code> (arthrosis cervical spine),
<code>8</code> (lumbago),
<code>9</code> (ischialgia),
<code>10</code> (hernia nuclei pulposi),
<code>11</code> (impediments of the shoulder),
<code>12</code> (epicondylitis lateralis),
<code>13</code> (tendinitis/synovitis)).</p>
</dd>
<dt>gpexper</dt><dd><p>GP experience (number of years working as a GP divided by ten).</p>
</dd>
<dt>gpworkload</dt><dd><p>GP workload (number of contacts in the 3-month registration period divided by 1000).</p>
</dd>
<dt>practype</dt><dd><p>Practice type (factor with levels <code>solo</code>,
<code>duo</code>, <code>group</code>, <code>healthcentre</code>).</p>
</dd>
<dt>location</dt><dd><p>Practice location (factor with levels <code>rural</code>,
<code>suburban</code>, <code>urban</code>, <code>bigcity</code>).</p>
</dd>
<dt>gpphysifr</dt><dd><p>Indicator of whether the GP has physiotherapists in their
social network (factor with levels <code>no</code>, <code>yes</code>).</p>
</dd>
<dt>referral</dt><dd><p>Indicator of whether the patient was referred to a
physiotherapist (factor with levels <code>no</code>, <code>yes</code>).</p>
</dd> </dl>



<h3>Details</h3>

<p>The <code>fysio</code> dataset is one of the example datasets analysed in
Leyland and Groenewegen (2020), and provided with the
multilevel-modelling software package MLwiN (Charlton et al., 2024).
</p>


<h3>Source</h3>

<p>Charlton, C., Rasbash, J., Browne, W.J., Healy, M. and Cameron, B. (2024)
<em>MLwiN Version 3.08</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Leyland, A.H., Groenewegen, P.P. (2020). Multilevel Logistic Regression Using
MLwiN: Referrals to Physiotherapy. In: <em>Multilevel Modelling for Public
Health and Health Services Research</em>. Springer, Cham. <a href="https://doi.org/10.1007/978-3-030-34801-4_12">doi:10.1007/978-3-030-34801-4_12</a>
</p>
<p>Van der Velden, K. (1999). <em>General practice at work: its contribution to
epidemiology and health policy</em>. NIVEL, PhD thesis Erasmus University, Utrecht
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(fysio, package = "R2MLwiN")

# Example taken from Leyland and Groenewegen (2020)

# Change contrasts if wish to avoid warning indicating that, by default,
# specified contrasts for ordered predictors will be ignored by runMLwiN
# (they will be fitted as "contr.treatment" regardless of this setting). To
# enable specified contrasts, set allowcontrast to TRUE (this will be the
# default in future package releases).
my_contrasts &lt;- options("contrasts")$contrasts
options(contrasts = c(unordered = "contr.treatment",
                      ordered = "contr.treatment"))

# As an alternative to changing contrasts, can instead use C() to specify
# contrasts for ordered predictors in formula object, e.g.:

# F1 &lt;- logit(referral) ~ 1 + C(pagegrp, "contr.treatment") + patsex + diag +
#   C(patedu, "contr.treatment") + patinsur + gpexper + gpworkload +
#   practype + location + gpphysifr +
#   (1 | gpid)
# 
# (mod_MQL1 &lt;- runMLwiN(Formula = F1,
#                       D = "Binomial",
#                       data = fysio,
#                       allowcontrast = TRUE))

F1 &lt;- logit(referral) ~ 1 + pagegrp + patsex + diag +
  patedu + patinsur + gpexper + gpworkload +
  practype + location + gpphysifr +
  (1 | gpid)

(mod_MQL1 &lt;- runMLwiN(Formula = F1,
                      D = "Binomial",
                      data = fysio))

(mod_PQL2 &lt;- runMLwiN(Formula = F1,
                      estoptions = list(nonlinear = c(N = 1, M = 2),
                                        startval = list(FP.b = mod_MQL1@FP,
                                                        FP.v = mod_MQL1@FP.cov,
                                                        RP.b = mod_MQL1@RP,
                                                        RP.v = mod_MQL1@RP.cov)),
                      D = "Binomial",
                      data = fysio))
                      
# Change contrasts back to pre-existing:
options(contrasts = my_contrasts)

## End(Not run)
</code></pre>

<hr>
<h2 id='gcsecomp1'>Pupils' marks from GCSE exams (UK, 1989); complete cases only.</h2><span id='topic+gcsecomp1'></span>

<h3>Description</h3>

<p>Pupils' marks from GCSE exams, consisting of 1523 pupils across 73 schools.
See Browne (2012) for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcsecomp1
</code></pre>


<h3>Format</h3>

<p>A data frame with 1523 observations on the following 6 variables:
</p>

<dl>
<dt>school</dt><dd><p>Identifying code for each school (level 2 unit).</p>
</dd>
<dt>student</dt><dd><p>Identifying code for each pupil (level 1 unit).</p>
</dd>
<dt>female</dt><dd><p>Gender of pupil: a factor with levels <code>Male</code> and
<code>Female</code>.</p>
</dd>
<dt>written</dt><dd><p>Exam score.</p>
</dd>
<dt>csework</dt><dd><p>Coursework score.</p>
</dd>
<dt>cons</dt><dd><p>Constant (=1).</p>
</dd> </dl>



<h3>Details</h3>

<p>The <code>gcsecomp1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(gcsecomp1, package="R2MLwiN")

(mymodel &lt;- runMLwiN(c(written, csework) ~ 1 + female + (1 | school) + (1 | student), 
  D = "Multivariate Normal", estoptions = list(EstM = 1), data = gcsecomp1))


## End(Not run)

</code></pre>

<hr>
<h2 id='gcsemv1'>Pupils' marks from GCSE exams (UK, 1989).</h2><span id='topic+gcsemv1'></span>

<h3>Description</h3>

<p>GCSE exam results, taken from 73 schools in England, consisting of 1905
pupils.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gcsemv1
</code></pre>


<h3>Format</h3>

<p>A data frame with 1905 observations on the following variables:
</p>

<dl>
<dt>school</dt><dd><p>School identification (level 2 unit).</p>
</dd>
<dt>student</dt><dd><p>Student identification (level 1 unit).</p>
</dd>
<dt>female</dt><dd><p>Gender: a factor with levels <code>Female</code> and <code>Male</code>.</p>
</dd>
<dt>agemths</dt><dd><p>Age in months.</p>
</dd>
<dt>written</dt><dd><p>Score on the written component.</p>
</dd>
<dt>csework</dt><dd><p>Score on the coursework component.</p>
</dd>
<dt>cons</dt><dd><p>Constant (= 1).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>gcsemv1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009); for
further details see Rasbash et al. (2012).
</p>


<h3>Source</h3>

<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B.
(2009) <em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University
of Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012) <em>A
User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset, with fewer variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(gcsemv1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(c(written, csework) ~ 1 + female + (1 | school) + (1 | student), 
  D = "Multivariate Normal", estoptions = list(EstM = 1), data = gcsemv1))


## End(Not run)

</code></pre>

<hr>
<h2 id='getSummary.mlwinfitIGLS'>Extract coefficients and GOF measures from a statistical object (memisc package).</h2><span id='topic+getSummary.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Extract coefficients and GOF measures from a statistical object (memisc package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSummary.mlwinfitIGLS_+3A_obj">obj</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> model.</p>
</td></tr>
<tr><td><code id="getSummary.mlwinfitIGLS_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals; their coverage should be 1-alpha/2</p>
</td></tr>
<tr><td><code id="getSummary.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="memisc.html#topic+getSummary">getSummary</a></code>
</p>

<hr>
<h2 id='getSummary.mlwinfitMCMC'>Extract coefficients and GOF measures from a statistical object (memisc package).</h2><span id='topic+getSummary.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Extract coefficients and GOF measures from a statistical object (memisc package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
getSummary(obj, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getSummary.mlwinfitMCMC_+3A_obj">obj</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> model.</p>
</td></tr>
<tr><td><code id="getSummary.mlwinfitMCMC_+3A_alpha">alpha</code></td>
<td>
<p>level of the confidence intervals; their coverage should be 1-alpha/2</p>
</td></tr>
<tr><td><code id="getSummary.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="memisc.html#topic+getSummary">getSummary</a></code>
</p>

<hr>
<h2 id='glance.mlwinfitIGLS'>Extract GOF measures from a statistical object (broom package).</h2><span id='topic+glance.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Extract GOF measures from a statistical object (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glance.mlwinfitIGLS_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> model.</p>
</td></tr>
<tr><td><code id="glance.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+glance">glance</a></code>
</p>

<hr>
<h2 id='glance.mlwinfitMCMC'>Extract GOF measures from a statistical object (broom package).</h2><span id='topic+glance.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Extract GOF measures from a statistical object (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
glance(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glance.mlwinfitMCMC_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> model.</p>
</td></tr>
<tr><td><code id="glance.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+glance">glance</a></code>
</p>

<hr>
<h2 id='height'>Height data.</h2><span id='topic+height'></span>

<h3>Description</h3>

<p>Height data for 100 adult males.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>height
</code></pre>


<h3>Format</h3>

<p>A data frame with 100 observations on the following variable:
</p>

<dl>
<dt>height</dt><dd><p>Heights of 100 adult males measured in centimetres.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>height</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009); see
Rasbash et al. (2012) for further details.
</p>


<h3>Source</h3>

<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B.
(2009) <em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University
of Bristol. Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012)
<em>A User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel
Modelling, University of Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# from demo(UserGuide16)

data(height, package = "R2MLwiN")
summary(height)

hist(height$height)

1 - pnorm((200 - mean(height$height)) / sd(height$height))

heightsim1 &lt;- function() {
  heightsim &lt;- 175.35 + 10.002 * qnorm(runif(100))
  c(pmean = mean(heightsim), pvar = var(heightsim))
}

set.seed(1)

# Note: To obtain estimates as close as possible to the MLwiN manual,
# increase the number of reps to 10000.

simdata1 &lt;- as.data.frame(t(replicate(1000, heightsim1())))
simdata1$iteration &lt;- 1:nrow(simdata1)

plot(simdata1$iteration, simdata1$pmean, type = "l")

plot(density(simdata1$pmean))

quantile(simdata1$pmean, c(0.025, 0.975))

plot(simdata1$iteration, simdata1$pvar, type = "l")

plot(density(simdata1$pvar))

quantile(simdata1$pvar, c(0.025, 0.975))

heightsim2 &lt;- function(variable) {
  samp &lt;- sample(variable, replace = TRUE)
  c(npmean = mean(samp), npvar = var(samp))
}

simdata2 &lt;- as.data.frame(t(replicate(1000, heightsim2(height$height))))
simdata2$iteration &lt;- 1:nrow(simdata2)

plot(simdata2$iteration, simdata2$npmean, type = "l")

plot(density(simdata2$npmean))

quantile(simdata2$npmean, c(0.025, 0.975))

plot(simdata2$iteration, simdata2$npvar, type = "l")

plot(density(simdata2$npvar))

quantile(simdata2$npvar, c(0.025, 0.975))

## End(Not run)

</code></pre>

<hr>
<h2 id='hungary1'>Hungarian component of 2nd International Science Survey, '84; see Goldstein
2003</h2><span id='topic+hungary1'></span>

<h3>Description</h3>

<p>Hungarian component of 2nd International Science Survey, consisting of 2439
women across 99 districts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hungary1
</code></pre>


<h3>Format</h3>

<p>A data frame with 2439 observations on the following 10 variables:
</p>

<dl>
<dt>school</dt><dd><p>Identifying code for each school (level 2 unit).</p>
</dd>
<dt>female</dt><dd><p>Gender indicator: a factor with levels <code>Male</code> and
<code>Female</code>.</p>
</dd>
<dt>es_core</dt><dd><p>Core Earth Sciences test result.</p>
</dd>
<dt>biol_core</dt><dd><p>Core Biology test result.</p>
</dd>
<dt>biol_r3</dt><dd><p>Optional Biology test result.</p>
</dd>
<dt>biol_r4</dt><dd><p>Optional Biology test result.</p>
</dd>
<dt>phys_core</dt><dd><p>Core Physics test result.</p>
</dd>
<dt>phys_r2</dt><dd><p>Optional Physics test result.</p>
</dd>
<dt>cons</dt><dd><p>Constant(=1).</p>
</dd>
<dt>student</dt><dd><p>Identifying code for each student (level 1 unit).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>hungary1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009).
Originally analysed in Goldstein (2003), further details can also be found
in Browne (2012).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Goldstein, H.. (2003) Multilevel Statistical Models. Third Edition. London,
Edward Arnold.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(hungary1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(c(es_core, biol_core, biol_r3, biol_r4, phys_core, phys_r2) ~ 
  1 + female + (1 | school) + (1 | student),
  D = "Multivariate Normal", estoptions = list(EstM = 1), data = hungary1))


## End(Not run)

</code></pre>

<hr>
<h2 id='jspmix1'>Dataset of pupils' test scores, a subset of the Junior School Project.</h2><span id='topic+jspmix1'></span>

<h3>Description</h3>

<p>An educational dataset of pupils' test scores, a subset of the Junior School
Project (Mortimore et al., 1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jspmix1
</code></pre>


<h3>Format</h3>

<p>A data frame with 1119 observations on the following 8 variables:
</p>

<dl>
<dt>school</dt><dd><p>School identifying code.</p>
</dd>
<dt>id</dt><dd><p>Pupil identifying code.</p>
</dd>
<dt>sex</dt><dd><p>Sex of pupil; a factor with levels <code>female</code> and <code>male</code>.</p>
</dd>
<dt>fluent</dt><dd><p>Fluency in English indicator, where <code>0</code> = beginner,
<code>1</code> = intermediate, <code>2</code> = fully fluent; measured in Year 1.</p>
</dd>
<dt>ravens</dt><dd><p>Test score, out of 40; measured in Year 1.</p>
</dd>
<dt>english</dt><dd><p>Pupils' English test score, out of 100; measured in Year 3.</p>
</dd>
<dt>behaviour</dt><dd><p>Pupils' behaviour score, where <code>lowerquarter</code> = pupil
rated in bottom 25%, and <code>upper</code> otherwise; measured in Year 3.</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
</dl>



<h3>Details</h3>

<p>A subset of the Junior School Project (Mortimore et al., 1988), the
<code>jspmix1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and is
used in Browne (2012) as an example of modelling mixed responses. It
consists of test scores for 1119 pupils across 47 schools. Note that the
<code>behaviour</code> variable originally had three categories, and the middle
50% and top 25% have been combined to produce a binary variable.)
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Mortimore, P., Sammons, P., Stoll, L., Lewis, D., Ecob, R. (1988)
<em>School Matters</em>. Wells: Open Books.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(jspmix1, package = "R2MLwiN")

jspmix1$denomb &lt;- jspmix1$cons

(mymodel &lt;- runMLwiN(c(english, probit(behaviour, denomb)) ~ 
  1 + sex + ravens + fluent[1] + (1 | school) + (1[1] | id), 
  D = c("Mixed", "Normal", "Binomial"), 
  estoptions = list(EstM = 1, mcmcMeth = list(fixM = 1, residM = 1, Lev1VarM = 1)), 
  data = jspmix1))


## End(Not run)

</code></pre>

<hr>
<h2 id='lips1'>Lips data</h2><span id='topic+lips1'></span>

<h3>Description</h3>

<p>Observed counts of male lip cancer for the 56 regions of Scotland over the
period 1975-1980.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lips1
</code></pre>


<h3>Format</h3>

<p>A data frame with 56 observations on the following 41 variables:
</p>

<dl>
<dt>area</dt><dd><p>Region ID.</p>
</dd>
<dt>cons</dt><dd><p>Constant (=1).</p>
</dd>
<dt>obs</dt><dd><p>Observed cases of lip cancer.</p>
</dd>
<dt>exp</dt><dd><p>Expected count.</p>
</dd>
<dt>perc_aff</dt><dd><p>Percentage of the region who work in agriculture, fishing and
forestry.</p>
</dd>
<dt>offs</dt><dd><p>Log of the expected count.</p>
</dd>
<dt>pcons</dt><dd><p>Constant (=1).</p>
</dd>
<dt>denom</dt><dd><p>Constant (=1).</p>
</dd>
<dt>neigh1</dt><dd><p>First neighbours.</p>
</dd>
<dt>neigh2</dt><dd><p>Second neighbours.</p>
</dd>
<dt>neigh3</dt><dd><p>Third neighbours.</p>
</dd>
<dt>neigh4</dt><dd><p>Fourth neighbours.</p>
</dd>
<dt>neigh5</dt><dd><p>Fifth neighbours.</p>
</dd>
<dt>neigh6</dt><dd><p>Sixth neighbours.</p>
</dd>
<dt>neigh7</dt><dd><p>Seventh neighbours.</p>
</dd>
<dt>neigh8</dt><dd><p>Eighth neighbours.</p>
</dd>
<dt>neigh9</dt><dd><p>Ninth neighbours.</p>
</dd>
<dt>neigh10</dt><dd><p>Tenth neightbours.</p>
</dd>
<dt>neigh11</dt><dd><p>Eleventh neightbours.</p>
</dd>
<dt>weight1</dt><dd><p>First neighbours' weights.</p>
</dd>
<dt>weight2</dt><dd><p>Second neighbours' weights.</p>
</dd>
<dt>weight3</dt><dd><p>Third neighbours' weights.</p>
</dd>
<dt>weight4</dt><dd><p>Fourth neighbours' weights.</p>
</dd>
<dt>weight5</dt><dd><p>Fifth neighbours' weights.</p>
</dd>
<dt>weight6</dt><dd><p>Sixth neighbours' weights.</p>
</dd>
<dt>weight7</dt><dd><p>Seventh neighbours' weights.</p>
</dd>
<dt>weight8</dt><dd><p>Eighth neighbours' weights.</p>
</dd>
<dt>weight9</dt><dd><p>Ninth neighbours' weights.</p>
</dd>
<dt>weight10</dt><dd><p>Tenth neightbours' weights.</p>
</dd>
<dt>weight11</dt><dd><p>Eleventh neightbours' weights.</p>
</dd>
<dt>wcar1</dt><dd><p>First neighbours' CAR weights.</p>
</dd>
<dt>wcar2</dt><dd><p>Second neighbours' CAR weights.</p>
</dd>
<dt>wcar3</dt><dd><p>Third neighbours' CAR weights.</p>
</dd>
<dt>wcar4</dt><dd><p>Fourth neighbours' CAR weights.</p>
</dd>
<dt>wcar5</dt><dd><p>Fifth neighbours' CAR weights.</p>
</dd>
<dt>wcar6</dt><dd><p>Sixth neighbours' CAR weights.</p>
</dd>
<dt>wcar7</dt><dd><p>Seventh neighbours' CAR weights.</p>
</dd>
<dt>wcar8</dt><dd><p>Eighth neighbours' CAR weights.</p>
</dd>
<dt>wcar9</dt><dd><p>Ninth neighbours' CAR weights.</p>
</dd>
<dt>wcar10</dt><dd><p>Tenth neightbours' CAR weights.</p>
</dd>
<dt>wcar11</dt><dd><p>Eleventh neightbours' CAR weights.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>lips1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and was
analysed in Clayton &amp; Kaldor (1987); see also Browne (2012) for more
details.
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Clayton, D., Kaldor, J. (1987) Empirical Bayes estimates of age-standardized
relative risks for use in disease mapping. <em>Biometrics</em> 43: 671-681.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(lips1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(log(obs) ~ 1 + perc_aff + offset(offs) + (0 | neigh1) + (1 | area),
 D = "Poisson", estoptions = list(EstM = 1), data = lips1))


## End(Not run)

</code></pre>

<hr>
<h2 id='lmdp'>Details of deaths from all causes in England and Wales 1972-1992, taken from the
local mortality datapack</h2><span id='topic+lmdp'></span>

<h3>Description</h3>

<p>This dataset records the annual number of deaths in a given district in England
and Wales, covering 14 years (1972-1992) across 403 districts. Note that there are
only 5639 observations rather than the 5642 that might be expected (403 districts with
an observation for each of 14 years); 3 data points were removed because
extreme outlying values made them implausible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmdp
</code></pre>


<h3>Format</h3>

<p>A data frame with 5639 observations on the following 8 variables:
</p>

<dl>
<dt>county</dt><dd><p>County (within region) identifier. There are 54 counties, coded
from 1 to 68.</p>
</dd>
<dt>district</dt><dd><p>District (within county) identifier. There are 403 districts,
coded 101 to 6820.</p>
</dd>
<dt>region</dt><dd><p>Region identifier. There are 10 regions, coded 1 to 10.</p>
</dd>
<dt>year</dt><dd><p>Year, 1979 (<code>79</code>) to 1992 (<code>92</code>).</p>
</dd>
<dt>deaths</dt><dd><p>Number of deaths observed</p>
</dd>
<dt>expected</dt><dd><p>Expected number of deaths, based on the 1992 national age- and
sex- specific mortality rates.</p>
</dd>
<dt>smr</dt><dd><p>Standardised mortality ratio (observed deaths / expected deaths * 100).</p>
</dd>
<dt>family</dt><dd><p>District classification into one of 6 groups as defined by the UK's
Office for National Statistics (factor with levels
<code>Inner_London</code> (Inner London),
<code>Rural</code> (Rural areas),
<code>Prospering</code> (Prospering areas)
<code>Maturer</code> (Maturer areas),
<code>Urban</code> (Urban areas),
<code>Mining_industrial</code> (Mining and industrial areas).</p>
</dd> </dl>



<h3>Details</h3>

<p>The <code>lmdp</code> dataset is one of the example datasets analysed in
Leyland and Groenewegen (2020), and provided with the
multilevel-modelling software package MLwiN (Charlton et al., 2024).
</p>


<h3>Source</h3>

<p>Charlton, C., Rasbash, J., Browne, W.J., Healy, M. and Cameron, B. (2024)
<em>MLwiN Version 3.08</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Leyland, A.H., Groenewegen, P.P. (2020). Multilevel Linear Regression Using
MLwiN: Mortality in England and Wales, 1979-1992. In: <em>Multilevel
Modelling for Public Health and Health Services Research</em>. Springer, Cham. <a href="https://doi.org/10.1007/978-3-030-34801-4_11">doi:10.1007/978-3-030-34801-4_11</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(lmdp, package = "R2MLwiN") 

# Example taken from Leyland and Groenewegen (2020)

lmdp$ID &lt;- seq(1:nrow(lmdp))

(mod_1 &lt;- runMLwiN(smr ~ 1 + I(year - 79) +
                      (1 | district) + (1 | ID),
                   data = lmdp))

## End(Not run)
</code></pre>

<hr>
<h2 id='logLik+2CmlwinfitIGLS-method'>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+logLik+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="logLik+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+logLik-methods">logLik-methods</a></code>
</p>

<hr>
<h2 id='logLik.mlwinfitIGLS'>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+logLik.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the log-likelihood from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="logLik.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+logLik">logLik</a></code>
</p>

<hr>
<h2 id='matrix2df'>For multiple membership models, translates matrix into a data.frame formatted for MLwiN
Translates a <code><a href="base.html#topic+matrix">matrix</a></code> into a form usable by MLwiN for multiple membership models,
namely a <code><a href="base.html#topic+data.frame">data.frame</a></code> with (a) columns containing membership IDs (if first row matrix is
<code>0 1 1 0 1 1</code>, then first row of generated ID vectors would be, say, <code>2, 3, 5, 6</code>)
and (b) columns containing weights (in this example, if <code>standardise = TRUE</code>, then first
row of generated weight vectors would be, say, <code>0.25, 0.25, 0.25, 0.25</code>, otherwise first
row of generated weight vectors would be, say, <code>1, 1, 1, 1</code>).</h2><span id='topic+matrix2df'></span>

<h3>Description</h3>

<p>For multiple membership models, translates matrix into a data.frame formatted for MLwiN
</p>
<p>Translates a <code><a href="base.html#topic+matrix">matrix</a></code> into a form usable by MLwiN for multiple membership models,
namely a <code><a href="base.html#topic+data.frame">data.frame</a></code> with (a) columns containing membership IDs (if first row matrix is
<code>0 1 1 0 1 1</code>, then first row of generated ID vectors would be, say, <code>2, 3, 5, 6</code>)
and (b) columns containing weights (in this example, if <code>standardise = TRUE</code>, then first
row of generated weight vectors would be, say, <code>0.25, 0.25, 0.25, 0.25</code>, otherwise first
row of generated weight vectors would be, say, <code>1, 1, 1, 1</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>matrix2df(mat, standardise = FALSE, idstub = "id", weightstub = "weight")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="matrix2df_+3A_mat">mat</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="matrix2df_+3A_standardise">standardise</code></td>
<td>
<p>If <code>TRUE</code>, ensures the row sums to one; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="matrix2df_+3A_idstub">idstub</code></td>
<td>
<p>Prefix for columns containing IDs; defaults to <code>id</code>.</p>
</td></tr>
<tr><td><code id="matrix2df_+3A_weightstub">weightstub</code></td>
<td>
<p>Prefix for columns containing weights; defaults to <code>weight</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol, U.K.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+df2matrix">df2matrix</a></code>
</p>

<hr>
<h2 id='MCSE'>Calculates the estimated Monte Carlo standard error (MCSE)</h2><span id='topic+MCSE'></span>

<h3>Description</h3>

<p>An internal function which calculates the estimated Monte Carlo standard
error (MCSE) for the posterior estimate of the mean, for use in <code><a href="#topic+sixway">sixway</a></code>.
As MCMC is a simulation-based approach this induces (Monte Carlo) uncertainty
due to the random numbers it uses. This uncertainty reduces with more
iterations, and is measured by the MCSE. See Browne (2012) for further details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCSE(chain, rho, ll = 0.5, ul = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCSE_+3A_chain">chain</code></td>
<td>
<p>Vector or <code><a href="coda.html#topic+mcmc">mcmc</a></code> object.</p>
</td></tr>
<tr><td><code id="MCSE_+3A_rho">rho</code></td>
<td>
<p>ACF for first lag.</p>
</td></tr>
<tr><td><code id="MCSE_+3A_ll">ll</code></td>
<td>
<p>Lower limit of x-axis, where value specified is multiplied by the length of the chain. Defaults to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="MCSE_+3A_ul">ul</code></td>
<td>
<p>Upper limit of x-axis, where value specified is multiplied by the length of the chain. Defaults to <code>20</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Monte Carlo standard error (MCSE) for the posterior estimate of the mean is returned.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>References</h3>

<p>Browne, W.J. (2012) MCMC Estimation in MLwiN, v2.26.
Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sixway">sixway</a></code>
</p>

<hr>
<h2 id='mlwin2bugs'>This function captures output files from MLwiN for estimation in
WinBUGS/OpenBUGS.</h2><span id='topic+mlwin2bugs'></span>

<h3>Description</h3>

<p>This function allows R to call WinBUGS using the output files from MLwiN.
This function uses functionalities in the <code><a href="R2WinBUGS.html#topic+R2WinBUGS-package">R2WinBUGS-package</a></code>
package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlwin2bugs(
  D,
  levID,
  datafile,
  initfiles,
  modelfile,
  bugEst,
  fact,
  addmore,
  n.chains,
  n.iter,
  n.burnin,
  n.thin,
  debug = FALSE,
  bugs.directory = bugs.directory,
  bugsWorkingDir = tempdir(),
  OpenBugs = FALSE,
  cleanBugsWorkingDir = FALSE,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mlwin2bugs_+3A_d">D</code></td>
<td>
<p>A vector specifying the type of distribution used in the model.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_levid">levID</code></td>
<td>
<p>A character (vector) specifying the level ID(s).</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_datafile">datafile</code></td>
<td>
<p>A file name where the BUGS data file will be saved in
.txt format.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_initfiles">initfiles</code></td>
<td>
<p>A list of file names where the BUGS initial values will
be saved in .txt format.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_modelfile">modelfile</code></td>
<td>
<p>A file name where the BUGS model will be saved in .txt
format.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_bugest">bugEst</code></td>
<td>
<p>A file name where the estimates from BUGS will be stored in
.txt format.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_fact">fact</code></td>
<td>
<p>A list of objects used to specify factor analysis. See &lsquo;Details&rsquo;
below.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_addmore">addmore</code></td>
<td>
<p>A vector of strings specifying additional coefficients to be
monitored.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_n.chains">n.chains</code></td>
<td>
<p>The number of chains to be monitored.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_n.iter">n.iter</code></td>
<td>
<p>The number of iterations for each chain</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_n.burnin">n.burnin</code></td>
<td>
<p>The length of burn-in for each chain</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_n.thin">n.thin</code></td>
<td>
<p>Thinning rate</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_debug">debug</code></td>
<td>
<p>A logical value indicating whether (<code>TRUE</code>) or not
(<code>FALSE</code>; the default) to close the BUGS window after completion of the
model run</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>The full path of location where WinBUGS is installed 
(ignored if OpenBugs is <code>TRUE</code>).</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_bugsworkingdir">bugsWorkingDir</code></td>
<td>
<p>A directory where all the intermediate files are to be
stored; defaults to <code>tempdir()</code>.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_openbugs">OpenBugs</code></td>
<td>
<p>If <code>TRUE</code>, OpenBUGS is used, if <code>FALSE</code> (the
default) WinBUGS is used.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_cleanbugsworkingdir">cleanBugsWorkingDir</code></td>
<td>
<p>If <code>TRUE</code>, the generated files will be
removed from the <code>bugsWorkingDir</code>; defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mlwin2bugs_+3A_seed">seed</code></td>
<td>
<p>An integer specifying the random seed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A list of objects to specify factor analysis, as used in the
argument <code>fact</code>:
</p>

<ul>
<li> <p><code>nfact</code>: specifies the number of factors;
</p>
</li>
<li> <p><code>lev.fact</code>: Specifies the level/classification for the random part of
the factor for each factor;
</p>
</li>
<li> <p><code>nfactcor</code>: specifies the number of
correlated factors;
</p>
</li>
<li> <p><code>factcor</code>: a vector specifying the correlated
factors: the first element corresponds to the first factor number, the
second to the second factor number, the third element corresponds to the
starting value for the covariance and the fourth element to whether this
covariance is constrained
(<code>1</code>) or not (<code>0</code>). If more than one pair of factors is correlated,
then repeat this sequence for each pair.
</p>
</li>
<li> <p><code>loading</code>: a matrix specifying the
starting values for the factor loadings and the starting value of the factor
variance. Each row corresponds to a factor.
</p>
</li>
<li> <p><code>constr</code>: a matrix
specifying indicators of whether the factor loadings and the factor variance
are constrained (<code>1</code>) or not (<code>0</code>).
</p>
</li></ul>



<h3>Value</h3>

<p>Returns an <code><a href="coda.html#topic+mcmc">mcmc</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>,<code><a href="R2WinBUGS.html#topic+bugs">bugs</a></code>
</p>

<hr>
<h2 id='mlwinfitIGLS-class'>An S4 class that stores the outputs of the fitted IGLS model.</h2><span id='topic+mlwinfitIGLS-class'></span>

<h3>Description</h3>

<p>An MLwiN model run via the IGLS estimation method is represented by an &quot;mlwinfitIGLS&quot; object
</p>


<h3>Slots</h3>


<dl>
<dt><code>Nobs</code></dt><dd><p>Computes the number of complete observations.</p>
</dd>
<dt><code>DataLength</code></dt><dd><p>Total number of cases.</p>
</dd>
<dt><code>Hierarchy</code></dt><dd><p>For each higher level of a multilevel model, returns the number of units at that level, together with the minimum, mean and maximum number of lower-level units nested within units of the current level.</p>
</dd>
<dt><code>D</code></dt><dd><p>A vector specifying the type of distribution to be modelled, which can include <code>'Normal'</code>, <code>'Binomial'</code> <code>'Poisson'</code>, <code>'Multinomial'</code>, <code>'Multivariate Normal'</code>, or <code>'Mixed'</code>.</p>
</dd>
<dt><code>Formula</code></dt><dd><p>A formula object (or a character string) specifying a multilevel model.</p>
</dd>
<dt><code>levID</code></dt><dd><p>A character string (vector) of the specified level ID(s).</p>
</dd>
<dt><code>contrasts</code></dt><dd><p>A list of contrast matrices, one for each factor in the model.</p>
</dd>
<dt><code>xlevels</code></dt><dd><p>A list of levels for the factors in the model.</p>
</dd>
<dt><code>FP</code></dt><dd><p>Displays the fixed part estimates.</p>
</dd>
<dt><code>RP</code></dt><dd><p>Displays the random part estimates.</p>
</dd>
<dt><code>FP.cov</code></dt><dd><p>Displays a covariance matrix of the fixed part estimates.</p>
</dd>
<dt><code>RP.cov</code></dt><dd><p>Displays a covariance matrix of the random part estimates.</p>
</dd>
<dt><code>elapsed.time</code></dt><dd><p>Calculates the CPU time used for fitting the model.</p>
</dd>
<dt><code>call</code></dt><dd><p>The matched call.</p>
</dd>
<dt><code>LIKE</code></dt><dd><p>The deviance statistic (-2*log(like)).</p>
</dd>
<dt><code>Converged</code></dt><dd><p>Boolean indicating whether the model has converged</p>
</dd>
<dt><code>Iterations</code></dt><dd><p>Number of iterations that the model has run for</p>
</dd>
<dt><code>Meth</code></dt><dd><p>If <code>Meth = 0</code> estimation method is set to RIGLS. If <code>Meth = 1</code> estimation method is set to IGLS.</p>
</dd>
<dt><code>residual</code></dt><dd><p>If <code>resi.store</code> is <code>TRUE</code>, then the residual estimates at all levels are returned.</p>
</dd>
<dt><code>data</code></dt><dd><p>The data.frame that was used to fit the model.</p>
</dd>
<dt><code>nonlinear</code></dt><dd><p>A character vector specifying linearisation method used. The first element specifies marginal quasi-likelihood linearization (<code>N = 0</code>) or penalised quasi-likelihood linearization (<code>N = 1</code>); The second element specifies first (<code>M = 1</code>) or second (<code>M = 2</code>) order approximation.</p>
</dd>
<dt><code>version</code></dt><dd><p>The MLwiN version used to fit the model</p>
</dd>
</dl>


<h3>An instance of the Class</h3>

<p>An instance is created by calling function <code><a href="#topic+runMLwiN">runMLwiN</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## Example: tutorial
data(tutorial, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
                     data = tutorial))

##summary method
summary(mymodel)

##logLik method
logLik(mymodel)

## End(Not run)

</code></pre>

<hr>
<h2 id='mlwinfitMCMC-class'>An S4 class that stores the outputs of the fitted MCMC model.</h2><span id='topic+mlwinfitMCMC-class'></span>

<h3>Description</h3>

<p>An MLwiN model run via the MCMC estimation method is represented by an &quot;mlwinfitMCMC&quot; object
</p>


<h3>Slots</h3>


<dl>
<dt><code>Nobs</code></dt><dd><p>Computes the number of complete observations.</p>
</dd>
<dt><code>DataLength</code></dt><dd><p>Total number of cases.</p>
</dd>
<dt><code>Hierarchy</code></dt><dd><p>For each higher level of a multilevel model, returns the number of units at that level, together with the minimum, mean and maximum number of lower-level units nested within units of the current level.</p>
</dd>
<dt><code>burnin</code></dt><dd><p>An integer specifying length of the burn-in.</p>
</dd>
<dt><code>nchains</code></dt><dd><p>An integer specifying number of MCMC chains run.</p>
</dd>
<dt><code>iterations</code></dt><dd><p>An integer specifying the number of iterations after burn-in.</p>
</dd>
<dt><code>D</code></dt><dd><p>A vector specifying the type of distribution to be modelled, which can include <code>'Normal'</code>, <code>'Binomial'</code> <code>'Poisson'</code>, <code>'Multinomial'</code>, <code>'Multivariate Normal'</code>, or <code>'Mixed'</code>.</p>
</dd>
<dt><code>Formula</code></dt><dd><p>A formula object (or a character string) specifying a multilevel model.</p>
</dd>
<dt><code>levID</code></dt><dd><p>A character string (vector) of the specified level ID(s).</p>
</dd>
<dt><code>contrasts</code></dt><dd><p>A list of contrast matrices, one for each factor in the model.</p>
</dd>
<dt><code>xlevels</code></dt><dd><p>A list of levels for the factors in the model.</p>
</dd>
<dt><code>merr</code></dt><dd><p>A vector which sets-up measurement errors on predictor variables.</p>
</dd>
<dt><code>fact</code></dt><dd><p>A list of objects specified for factor analysis, including <code>nfact</code>, <code>lev.fact</code>, <code>nfactor</code>, <code>factor</code>, <code>loading</code> and <code>constr</code>.</p>
</dd>
<dt><code>xc</code></dt><dd><p>A list of objects specified for cross-classified and/or multiple membership models, including <code>class</code>, <code>N1</code>, <code>weight</code>, <code>id</code> and <code>car</code>.</p>
</dd>
<dt><code>FP</code></dt><dd><p>Displays the fixed part estimates.</p>
</dd>
<dt><code>RP</code></dt><dd><p>Displays the random part estimates.</p>
</dd>
<dt><code>FP.cov</code></dt><dd><p>Displays a covariance matrix of the fixed part estimates.</p>
</dd>
<dt><code>RP.cov</code></dt><dd><p>Displays a covariance matrix of the random part estimates.</p>
</dd>
<dt><code>chains</code></dt><dd><p>Captures the MCMC chains from MLwiN for all parameters.</p>
</dd>
<dt><code>elapsed.time</code></dt><dd><p>Calculates the CPU time used for fitting the model.</p>
</dd>
<dt><code>BDIC</code></dt><dd><p>Bayesian Deviance Information Criterion (DIC)</p>
</dd>
<dt><code>call</code></dt><dd><p>The matched call.</p>
</dd>
<dt><code>LIKE</code></dt><dd><p>The deviance statistic (-2*log(like)).</p>
</dd>
<dt><code>fact.loadings</code></dt><dd><p>If <code>fact</code> is not empty, then the factor loadings are returned.</p>
</dd>
<dt><code>fact.loadings.sd</code></dt><dd><p>If <code>fact</code> is not empty, then the factor loading standard deviationss are returned.</p>
</dd>
<dt><code>fact.cov</code></dt><dd><p>If <code>fact</code> is not empty, then factor covariances are returned.</p>
</dd>
<dt><code>fact.cov.sd</code></dt><dd><p>If <code>fact</code> is not empty, then factor covariance standard deviations are returned.</p>
</dd>
<dt><code>fact.chains</code></dt><dd><p>If <code>fact</code> is not empty, then the factor chains are returned.</p>
</dd>
<dt><code>MIdata</code></dt><dd><p>If <code>dami[1]</code> is one then the mean complete response variable <code>y</code> is returned for each chain, if <code>dami[1]</code> is two then the SD is also included.</p>
</dd>
<dt><code>imputations</code></dt><dd><p>If <code>dami[1]</code> is zero, then a list of completed datasets containing complete response variable <code>y</code> is returned.</p>
</dd>
<dt><code>residual</code></dt><dd><p>If <code>resi.store</code> is <code>TRUE</code>, then the residual estimates at all levels are returned.</p>
</dd>
<dt><code>resi.chains</code></dt><dd><p>If <code>resi.store.levs</code> is not empty, then the residual chains at these levels are returned.</p>
</dd>
<dt><code>version</code></dt><dd><p>The MLwiN version used to fit the model</p>
</dd>
<dt><code>data</code></dt><dd><p>The data.frame that was used to fit the model.</p>
</dd>
</dl>


<h3>An instance of the Class</h3>

<p>An instance is created by calling function <code><a href="#topic+runMLwiN">runMLwiN</a></code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')
  
## Example: tutorial
data(tutorial, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
                     estoptions = list(EstM = 1), data = tutorial)) 

##summary method
summary(mymodel)

##BDIC slot
mymodel@BDIC

## End(Not run)

</code></pre>

<hr>
<h2 id='mmmec'>EC data on UV radiation exposure &amp; malignant melanoma.</h2><span id='topic+mmmec'></span>

<h3>Description</h3>

<p>EC data on UV radiation exposure &amp; malignant melanoma, consisting of 354
counties across 79 regions across 9 nations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmmec
</code></pre>


<h3>Format</h3>

<p>A data frame with 354 observations on the following variables:
</p>

<dl>
<dt>nation</dt><dd><p>Nation ID: a factor with levels corresponding to each country.</p>
</dd>
<dt>region</dt><dd><p>Region (within-nation) ID.</p>
</dd>
<dt>county</dt><dd><p>County (within-region) ID.</p>
</dd>
<dt>obs</dt><dd><p>Number of male deaths due to malignant melanoma between 1971 and
1980.</p>
</dd>
<dt>exp</dt><dd><p>Expected number of deaths - proportional to county population.</p>
</dd>
<dt>cons</dt><dd><p>Constant (=1).</p>
</dd>
<dt>uvbi</dt><dd><p>County-level measurement of UV B radiation, centered on the
mean.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>mmmec</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009). Further
information can be found in Langford et al. (1998) and Browne (2012).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Langford, I. H., Bentham, G., McDonald, A-L. (1998) Multi-level modelling of
geographically aggregated health data: a case study on malignant melanoma
mortality and UV exposure in the European Community. <em>Statistics in
Medicine</em> 17: 41-57.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset, with fewer variables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(mmmec, package = "R2MLwiN")

(mymodel3 &lt;- runMLwiN(log(obs) ~ 1 + uvbi + offset(log(exp)) + (1 | nation) + (1 | region), 
 D = "Poisson", estoptions = list(EstM = 1), data = mmmec))


## End(Not run)

</code></pre>

<hr>
<h2 id='nobs.mlwinfitIGLS'>Returns the number of used observations from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+nobs.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the number of used observations from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="nobs.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nobs">nobs</a></code>
</p>

<hr>
<h2 id='nobs.mlwinfitMCMC'>Returns the number of used observations from &quot;mlwinfitMCMC&quot; objects.</h2><span id='topic+nobs.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Returns the number of used observations from &quot;mlwinfitMCMC&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.</p>
</td></tr>
<tr><td><code id="nobs.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+nobs">nobs</a></code>
</p>

<hr>
<h2 id='predCurves'>Draws predicted curves (lines) using estimates from the fixed part of a
fitted model.</h2><span id='topic+predCurves'></span>

<h3>Description</h3>

<p>This function draws predicted curves (lines) against an explanatory variable
for each category of a categorical variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predCurves(
  object,
  indata = NULL,
  xname,
  group = NULL,
  legend = TRUE,
  legend.space = "top",
  legend.ncol = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predCurves_+3A_object">object</code></td>
<td>
<p>Either an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> or <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data. If not specified, data is extracted from
the <code>object</code>.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_xname">xname</code></td>
<td>
<p>The name of variable to be plotted.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_group">group</code></td>
<td>
<p>A character string or a sequence of length equivalent to rows of data to plot.
<code>group = NULL</code> by default.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_legend">legend</code></td>
<td>
<p>A logical value indicating whether a legend for <code>group</code>
is to be added.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_legend.space">legend.space</code></td>
<td>
<p>A character string specifies one of the four sides,
which can be one of <code>'top'</code>, <code>'bottom'</code>, <code>'left'</code> and <code>'right'</code>. Default,
<code>legend.space = 'top'</code>.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_legend.ncol">legend.ncol</code></td>
<td>
<p>An integer specifies a number of columns, possibly
divided into blocks, each containing some rows. Default,
<code>legend.ncol = 2</code>.</p>
</td></tr>
<tr><td><code id="predCurves_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to <code><a href="lattice.html#topic+xyplot">xyplot</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predLines">predLines</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## Read alevchem data
data(alevchem, package = "R2MLwiN")

alevchem$gcseav &lt;- alevchem$gcse_tot/alevchem$gcse_no - 6
# Avoids warning when fitting factor as continuous response:
alevchem$a_point_num &lt;- as.numeric(alevchem$a_point)

## Example: A-level Chemistry
(mymodel &lt;- runMLwiN(a_point_num ~ 1 + gcseav + I(gcseav^2) + I(gcseav^3)
                     + gender + (1 | pupil), estoptions = list(EstM = 1,  resi.store = TRUE),
                     data = alevchem))
                     
predCurves(mymodel, xname = "gcseav", group = "genderfemale")

## End(Not run)

</code></pre>

<hr>
<h2 id='predict.mlwinfitIGLS'>Returns the predicted data from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+predict.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the predicted data from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
predict(
  object,
  newdata = NULL,
  params = NULL,
  type = "link",
  se.fit = FALSE,
  terms = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_newdata">newdata</code></td>
<td>
<p>data frame for which to evaluate predictions</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_params">params</code></td>
<td>
<p>a character vector specifying the parameters to use in evaluating predictions.
If <code>NULL</code>, <code>names(object[["FP"]])</code> is used by default.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_type">type</code></td>
<td>
<p>when this has the value <code>"link"</code> (default) the linear predictor is returned.
When <code>type="terms"</code> each component of the linear predictor is returned seperately. When <code>type="response"</code> predictions on the scale of the response are returned.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_se.fit">se.fit</code></td>
<td>
<p>logical. When this is <code>TRUE</code> (not default) standard error estimates are returned for each prediction.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_terms">terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms (default is all terms), a character vector.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict">predict</a></code>
</p>

<hr>
<h2 id='predict.mlwinfitMCMC'>Returns the predicted data from &quot;mlwinfitMCMC&quot; objects.</h2><span id='topic+predict.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Returns the predicted data from &quot;mlwinfitMCMC&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
predict(
  object,
  newdata = NULL,
  params = NULL,
  type = "link",
  se.fit = FALSE,
  terms = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_newdata">newdata</code></td>
<td>
<p>data frame for which to evaluate predictions</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_params">params</code></td>
<td>
<p>a character vector specifying the parameters to use in evaluating predictions. If <code>NULL</code>, <code>names(object[["FP"]])</code> is used by default.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_type">type</code></td>
<td>
<p>when this has the value <code>"link"</code> (default) the linear predictor is returned. 
When <code>type="terms"</code> each component of the linear predictor is returned seperately. When <code>type="response"</code> predictions on the scale of the response are returned.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_se.fit">se.fit</code></td>
<td>
<p>logical. When this is <code>TRUE</code> (not default) standard error estimates are returned for each prediction.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_terms">terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms (default is all terms), a character vector.</p>
</td></tr>
<tr><td><code id="predict.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict">predict</a></code>
</p>

<hr>
<h2 id='predLines'>Draws predicted lines using a fitted model object</h2><span id='topic+predLines'></span>

<h3>Description</h3>

<p>This function draws predicted lines against an explanatory variable for
selected groups at a higher (&gt;=2) level. Note that it uses a lot of contiguous memory, and so
we recommend running via 64-bit version R to mititage against any potential problems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predLines(
  object,
  indata = NULL,
  xname,
  lev = 2,
  selected = NULL,
  probs = c(0.025, 0.975),
  legend = TRUE,
  legend.space = "top",
  legend.ncol = 4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predLines_+3A_object">object</code></td>
<td>
<p>Either an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> or <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code>
object.</p>
</td></tr>
<tr><td><code id="predLines_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data. If not specified, data is extracted from
the <code>object</code>.</p>
</td></tr>
<tr><td><code id="predLines_+3A_xname">xname</code></td>
<td>
<p>The name of the variable to be plotted.</p>
</td></tr>
<tr><td><code id="predLines_+3A_lev">lev</code></td>
<td>
<p>A digit indicating the level (of the multilevel model) at which
to plot.</p>
</td></tr>
<tr><td><code id="predLines_+3A_selected">selected</code></td>
<td>
<p>A vector specifying groups to selectively plot at the level
specified in <code>lev</code>. If <code>selected = NULL</code>, then all groups at that
level are included.</p>
</td></tr>
<tr><td><code id="predLines_+3A_probs">probs</code></td>
<td>
<p>A numeric vector of probabilities with values in <code>[0, 1]</code>
used to calculate the lower and upper quantiles from which the error bars
are plotted. Currently, this is only available for an <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.</p>
</td></tr>
<tr><td><code id="predLines_+3A_legend">legend</code></td>
<td>
<p>A logical value indicating whether a legend is to be added.</p>
</td></tr>
<tr><td><code id="predLines_+3A_legend.space">legend.space</code></td>
<td>
<p>A character string specifies one of the four sides,
which can be one of <code>'top'</code>, <code>'bottom'</code>, <code>'left'</code> and <code>'right'</code>.  Default,
<code>legend.space = 'top'</code>.</p>
</td></tr>
<tr><td><code id="predLines_+3A_legend.ncol">legend.ncol</code></td>
<td>
<p>An integer specifies a number of columns, possibly
divided into blocks, each containing some rows. Default,
<code>legend.ncol = 2</code>.</p>
</td></tr>
<tr><td><code id="predLines_+3A_...">...</code></td>
<td>
<p>Other arguments to be pased to <code><a href="lattice.html#topic+xyplot">xyplot</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predCurves">predCurves</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## Example: tutorial
data(tutorial, package = "R2MLwiN")
(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
                     estoptions = list(EstM = 1, resi.store.levs = 2), data = tutorial))

predLines(mymodel, xname = "standlrt", lev = 2, selected = c(30, 44, 53, 59),
          probs = c(0.025, 0.975))

## End(Not run)

</code></pre>

<hr>
<h2 id='print.mlwinfitIGLS'>Summarize &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+print.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlwinfitIGLS_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="print.mlwinfitIGLS_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.mlwinfitIGLS_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If TRUE, 'significance stars' are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>
</p>

<hr>
<h2 id='print.mlwinfitMCMC'>Summarize &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+print.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
print(
  x,
  digits = max(3, getOption("digits") - 2),
  signif.stars = getOption("show.signif.stars"),
  z.ratio = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.mlwinfitMCMC_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="print.mlwinfitMCMC_+3A_digits">digits</code></td>
<td>
<p>the number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="print.mlwinfitMCMC_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical. If TRUE, 'significance stars' are printed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.mlwinfitMCMC_+3A_z.ratio">z.ratio</code></td>
<td>
<p>logical. If TRUE, z-ratio values are displayed for each coefficient.</p>
</td></tr>
<tr><td><code id="print.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="base.html#topic+print">print</a></code>
</p>

<hr>
<h2 id='prior2macro'>Translates informative prior information into a concise MLwiN macro.</h2><span id='topic+prior2macro'></span>

<h3>Description</h3>

<p>An internal function which takes an R list object containing informative
prior information for a multilevel model and translates it into a concise
vector object to be used in an MLwiN macro.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior2macro(prior, D, fpart, nrand)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior2macro_+3A_prior">prior</code></td>
<td>
<p>An R list object containing prior information for a multilevel
model. See &lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="prior2macro_+3A_d">D</code></td>
<td>
<p>A character string specifying the type of distribution, which
can be one of <code>'Normal'</code>, <code>'Binomial'</code>, <code>'Poisson'</code>,
<code>'Negbinom'</code>, <code>'Multinomial'</code>, <code>'Multivariate Normal'</code>,
or <code>'Mixed'</code></p>
</td></tr>
<tr><td><code id="prior2macro_+3A_fpart">fpart</code></td>
<td>
<p>An R list containing the list of fixed part parameter labels.</p>
</td></tr>
<tr><td><code id="prior2macro_+3A_nrand">nrand</code></td>
<td>
<p>An R list of lists, containing the number of random parameters
at each level.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>prior</code> list can contain the following:
</p>

<ul>
<li> <p><code>fixe</code>: For the fixed parameters, if proper normal priors are used
for some parameters, a list of vectors of length two is provided, each of which
specifies the mean and the standard deviation. If not given, default ('flat' or 'diffuse')
priors are used for the parameters. The names used in the list should match those in the
model output.
</p>
</li>
<li> <p><code>rp&lt;level number&gt;</code>: A list object specifying the Wishart or gamma prior for the
covariance matrix or scalar variance at the levels specified, e.g. <code>rp1</code> for
level 1, <code>rp2</code> for level 2, etc. Consists of: (1)
<code>estimate</code> &ndash; a prior guess for the true value of the covariance matrix;
(2) <code>size</code> &ndash; sample size for guess.
Note that this is a weakly-informative prior and the default prior
is used if missing.
</p>
</li></ul>



<h3>Value</h3>

<p>A long vector is returned in the format of MLwiN macro language. This
includes all the specified prior parameters.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runMLwiN">runMLwiN</a></code>
</p>

<hr>
<h2 id='rats'>Weights of 30 rats, measured weekly over 5 weeks.</h2><span id='topic+rats'></span>

<h3>Description</h3>

<p>Weights of 30 rats, measured weekly over 5 weeks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rats
</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 7 variables:
</p>

<dl>
<dt>y8</dt><dd><p>Weight on day 8.</p>
</dd>
<dt>y15</dt><dd><p>Weight on day 15.</p>
</dd>
<dt>y22</dt><dd><p>Weight on day 22.</p>
</dd>
<dt>y29</dt><dd><p>Weight on day 29.</p>
</dd>
<dt>y36</dt><dd><p>Weight on day 36.</p>
</dd>
<dt>cons</dt><dd><p>Constant(=1).</p>
</dd>
<dt>rat</dt><dd><p>Rat ID</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>rats</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009); see
Browne (2012) and Gelfand (1990) for further details.
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Gelfand, A. E., Hills, S.E., Racine-Poon, A., Smith, A.F.M. (1990)
Illustration of Bayesian inference in normal data models using Gibbs
sampling. <em>Journal of the American Statistical Association</em> 85:
972-985.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(rats, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(c(y8, y15, y22, y29, y36) ~ 1 + (1 | rat), 
  D = "Multivariate Normal", estoptions = list(EstM = 1),
  data = rats))


## End(Not run)

</code></pre>

<hr>
<h2 id='reading1'>Students' reading attainment in inner London infant schools.</h2><span id='topic+reading1'></span>

<h3>Description</h3>

<p>Reading score data for 407 pupils across 6 occasions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reading1
</code></pre>


<h3>Format</h3>

<p>A data frame with 407 observations on the following 13 variables:
</p>

<dl>
<dt>id</dt><dd><p>Unique pupil identifying code.</p>
</dd>
<dt>age1</dt><dd><p>Age at occasion 1.</p>
</dd>
<dt>read1</dt><dd><p>Reading score at occasion 1.</p>
</dd>
<dt>age2</dt><dd><p>Age at occasion 2.</p>
</dd>
<dt>read2</dt><dd><p>Reading score at occasion 2.</p>
</dd>
<dt>age3</dt><dd><p>Age at occasion 3.</p>
</dd>
<dt>read3</dt><dd><p>Reading score at occasion 3.</p>
</dd>
<dt>age4</dt><dd><p>Age at occasion 4.</p>
</dd>
<dt>read4</dt><dd><p>Reading score at occasion 4.</p>
</dd>
<dt>age5</dt><dd><p>Age at occasion 5.</p>
</dd>
<dt>read5</dt><dd><p>Reading score at occasion 5.</p>
</dd>
<dt>age6</dt><dd><p>Age at occasion 6.</p>
</dd>
<dt>read6</dt><dd><p>Reading score at occasion 6.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>reading1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and was
analysed in Tizard et al. (1988); see also Rasbash et al. (2012) for further
details.
</p>


<h3>Source</h3>

<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B.
(2009) <em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University
of Bristol. Rasbash, J., Steele, F., Browne, W.J., Goldstein, H. (2012)
<em>A User's Guide to MLwiN v2.26</em>. University of Bristol: Centre for
Multilevel Modelling. Tizard, B., Blatchford, P., Burke, J. &amp; Farquhar, C.
(1988). Young children at school in the inner city. Hove, Sussex: Lawrence
Erlbaum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# from demo(UserGuide13)

data(reading1, package = "R2MLwiN")
summary(reading1)

reading1[reading1 == -10] &lt;- NA

summary(reading1)

reading &lt;- reshape(reading1, idvar = "student", timevar = "id",
                   varying = c("read1", "age1", "read2", "age2", "read3", "age3",
                   "read4", "age4", "read5", "age5", "read6", "age6"),
                   sep = "", direction = "long")

reading &lt;- reading[c("student", "id", "age", "read")]
reading &lt;- reading[order(reading$student, reading$id), ]

colnames(reading) &lt;- c("student", "occasion", "age", "reading")
rownames(reading) &lt;- NULL

summary(reading)

head(reading, 5)

tab &lt;- aggregate(reading ~ occasion, reading,
                 function(x) c(N = length(x), mean = mean(x), sd = sd(x)))
tab &lt;- rbind(tab, c(NA, NA))
tab$reading[7, ] &lt;- c(length(na.omit(reading$reading)),
                      mean(na.omit(reading$reading)),
                      sd(na.omit(reading$reading)))
rownames(tab)[7] &lt;- "Total"
tab

tab &lt;- aggregate(age ~ occasion, reading,
                 function(x) c(N = length(x), mean = mean(x), sd = sd(x)))
tab &lt;- rbind(tab, c(NA, NA))
tab$age[7, ] &lt;- c(length(na.omit(reading$age)),
                  mean(na.omit(reading$age)),
                  sd(na.omit(reading$age)))
rownames(tab)[7] &lt;- "Total"
tab

(mymodel1 &lt;- runMLwiN(reading ~ 1 + (1 | student) + (1 | occasion),
                      data = reading))

## End(Not run)

</code></pre>

<hr>
<h2 id='residuals.mlwinfitIGLS'>Returns the residual data from &quot;mlwinfitIGLS&quot; objects.</h2><span id='topic+residuals.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Returns the residual data from &quot;mlwinfitIGLS&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="residuals.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+residuals">residuals</a></code>
</p>

<hr>
<h2 id='residuals.mlwinfitMCMC'>Returns the residual data from &quot;mlwinfitMCMC&quot; objects.</h2><span id='topic+residuals.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Returns the residual data from &quot;mlwinfitMCMC&quot; objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="residuals.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+residuals">residuals</a></code>
</p>

<hr>
<h2 id='runMLwiN'>Calls MLwiN from R.</h2><span id='topic+runMLwiN'></span>

<h3>Description</h3>

<p>This function executes MLwiN and then brings results back to R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runMLwiN(
  Formula,
  levID = NULL,
  D = "Normal",
  data = NULL,
  estoptions = list(EstM = 0),
  BUGO = NULL,
  MLwiNPath = NULL,
  stdout = "",
  stderr = "",
  workdir = tempdir(),
  checkversion = TRUE,
  allowcontrast = FALSE,
  indata = NULL,
  saveworksheet = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runMLwiN_+3A_formula">Formula</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object specifying the model
formula. See <code><a href="#topic+Formula.translate">Formula.translate</a></code> (<code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>
details back-compatible functionality for deprecated syntax used in
versions of <span class="pkg">R2MLwiN</span> prior to 0.8-0) and also &lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_levid">levID</code></td>
<td>
<p>A character vector specifying the level ID(s). Deprecated
syntax: by default this is <code>NULL</code> and level ID(s) are specified
in the <code>Formula</code> object.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_d">D</code></td>
<td>
<p>A character string/vector specifying the type of distribution to be modelled, which
can include <code>'Normal'</code> (the default), <code>'Binomial'</code>, <code>'Poisson'</code>,
<code>'Negbinom'</code>, <code>'Unordered Multinomial'</code>, <code>'Ordered Multinomial'</code>,
<code>'Multivariate Normal'</code>, or <code>'Mixed'</code>. In the case of the latter,
<code>'Mixed'</code> precedes the response types which also need to be listed in
<code>D</code>, e.g. <code>c('Mixed', 'Normal', 'Binomial')</code>; these need to be
be listed in the same order to which they are referred to in the
<code>Formula</code> object (see <code><a href="#topic+Formula.translate">Formula.translate</a></code>,
<code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>). For (R)IGLS estimation (i.e. <code>EstM = 0</code>
in <code>estoptions</code>) <code>'Mixed'</code> combinations can consist of
<code>'Normal'</code> and <code>'Binomial'</code> or <code>'Normal'</code> and <code>'Poisson'</code>;
for MCMC estimation (i.e. <code>EstM = 0</code>), on the other hand, only a combination
of <code>'Normal'</code> and <code>'Binomial'</code> is available.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_data">data</code></td>
<td>
<p>A data.frame object containing the data to be modelled.
Optional (but recommended): if empty, data taken from environment of
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_estoptions">estoptions</code></td>
<td>
<p>A list of options used for estimating the model. See
&lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_bugo">BUGO</code></td>
<td>
<p>A vector specifying BUGS options. If non-null, then
WinBUGS/OpenBUGS, in conjunction with MLwiN, are used for modelling. Non-null
only applicable if <code>EstM = 1</code>. See &lsquo;Details&rsquo;, below.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_mlwinpath">MLwiNPath</code></td>
<td>
<p>A path to the MLwiN folder. By default, <code>MLwiNPath = NULL</code>
and path set by <code>options('MLwiN_path')</code>, the default for which can be
changed via <code>options(MLwiN_path = 'path/to/MLwiN vX.XX/')</code>).</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_stdout">stdout</code></td>
<td>
<p>See <code><a href="base.html#topic+system2">system2</a></code>; <code>''</code> by default (i.e.
output to <code>stdout</code> sent to R console).</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_stderr">stderr</code></td>
<td>
<p>See <code><a href="base.html#topic+system2">system2</a></code>; <code>''</code> by default (i.e.
output to <code>stderr</code> sent to R console).</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_workdir">workdir</code></td>
<td>
<p>A path to the folder where the outputted files are to be saved.
If the folder specified does not exist, a new folder of that name is
created; <code>workdir = tempdir()</code> by default.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_checkversion">checkversion</code></td>
<td>
<p>If <code>TRUE</code> (default), returns version number unless
(a) version detected is unknown or newer than MLwiN version available
when current version of R2MLwiN was released, in which case returns text
to this effect, or (b) version detected &gt; 1 year older than MLwiN version
available when current version of R2MLwiN was released, in which case
function call stopped and user invited to update via usual channels. Can
disable via <code>FALSE</code> e.g. if slowing execution time down (for example
in a simulation).</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_allowcontrast">allowcontrast</code></td>
<td>
<p>If <code>TRUE</code>, factor variables will follow the R
behaviour when creating contrast variables. If <code>FALSE</code> (default) factor
variables will be converted into a series of zero/one dummies.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_indata">indata</code></td>
<td>
<p>A <code>data.frame</code> object containing the data to be modelled.
Deprecated syntax: by default this is <code>NULL</code> and the <code>data.frame</code>
is instead referenced via <code>data</code>.</p>
</td></tr>
<tr><td><code id="runMLwiN_+3A_saveworksheet">saveworksheet</code></td>
<td>
<p>A file name (or list of file names if more than one chain
is specified) used to store the MLwiN worksheet after the model has been estimated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With regard to <code>runMLwiN</code>'s <code>Formula</code> object, see <code><a href="stats.html#topic+formula">formula</a></code>
for notes on general usage, noting the following differences:
</p>

<ul>
<li><p>The intercept is not included by default (this is keeping with the manner
in which models are specified in MLwiN). To include an intercept, then, one
can specify e.g. <code>normexam ~ 1 + standlrt + (1 | student)</code> or, assuming <code>cons</code>
is a constant of ones, <code>normexam ~ cons + standlrt + (cons | student)</code>. (Note also,
as further detailed below, for normal response models the level 1 ID (<code>student</code> in this example)
needs to be explicitly included in the random part of the model formula; this is not the
case for discrete response models.
</p>
</li>
<li><p>The link function and denominator are included in the <code>Formula</code> object, e.g.
fitting a logistic model in which the variable <code>denom</code> is specified as the denominator:
<code>logit(resp, denom) ~ 1 + age + (1 | region)</code>.
</p>
</li></ul>

<p>Further details are as follows.
</p>
<p>The random part of the model is specified in sets of parentheses arranged in
descending order with respect to their hierarchy. E.g. in the case of a 3-level
model, the variable containing the level 3 ID is specified first, then
the variable containing the level 2 ID, etc. Note that the variable containing
the level 1 ID also needs to be explicitly specified unless
it is a discrete response model (in which case you should not specify it).
</p>
<p>The table below summarises the options for the <code>Formula</code> argument in
<span class="pkg">R2MLwiN</span>. They assume an intercept is added (via <code>~ 1</code>; for alternative
specifications see <code><a href="stats.html#topic+formula">formula</a></code>). <code>&lt;link&gt;</code> denotes the link function,
<code>&lt;y1&gt;</code>, <code>&lt;y2&gt;</code>, etc. represent response variables, <code>&lt;denom&gt;</code> denotes
the denominator, <code>&lt;offs&gt;</code> the offset (optional), <code>&lt;L2&gt;</code>, <code>&lt;L1&gt;</code>, etc. the
variables containing the level 2 and level 1 identifying codes, and <code>&lt;ref_cat&gt;</code>
represents the reference category of a categorical response variable (optional:
if unspecified the lowest level of the factor is used as the reference category).
Explanatory variables are specified as e.g. <code>&lt;x1&gt; + &lt;x2&gt;</code>. For <code>'Ordered Multinomial'</code>,
<code>'Multivariate Normal'</code> and <code>'Mixed'</code> responses, <code>[&lt;common&gt;]</code> indicates
a common coefficient (i.e. the same for each category) is to be fitted; here <code>&lt;common&gt;</code>
takes the form of a numeric identifier indicating the responses for which a common
coefficient is to be added (e.g. <code>[1:5]</code> to fit a common coefficient for
categories <code>1</code> to <code>5</code> of a 6-point ordered variable, <code>[1]</code> to fit a common
coefficient for the response variable specified first in the <code>Formula</code> object
for a <code>'Mixed'</code> response model, etc.) Otherwise a separate coefficient
(i.e. one for each category) is added. For <code>'Mixed'</code> response models, the
<code>Formula</code> arguments need to be grouped in the order the distributions
are listed in <code>D</code>.
</p>
<p>* denotes IGLS only in the table below.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>Distribution</strong> </td><td style="text-align: left;"> <strong>Format of <code>Formula</code> object</strong> </td><td style="text-align: left;"> <strong>Where <code>&lt;link&gt;</code> can equal...</strong></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Normal'</code> </td><td style="text-align: left;"> <code>&lt;y1&gt; ~ 1 + &lt;x1&gt; + (1|&lt;L2&gt;) + (1|&lt;L1&gt;) + ...</code> </td><td style="text-align: left;"> (identity link assumed)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Poisson'</code> </td><td style="text-align: left;"> <code>&lt;link&gt;(&lt;y1&gt;) ~ 1 + offset(&lt;offs&gt;) + &lt;x1&gt; + (1|&lt;L2&gt;) + ...</code> </td><td style="text-align: left;"> <code>log</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Negbinom'</code> </td><td style="text-align: left;"> <code>&lt;link&gt;(&lt;y1&gt;) ~ 1 + offset(&lt;offs&gt;) + (1|&lt;L2&gt;) + ...</code> </td><td style="text-align: left;"> <code>log</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Binomial'</code> </td><td style="text-align: left;"> <code>&lt;link&gt;(&lt;y1&gt;, &lt;denom&gt;) ~ 1 + &lt;x1&gt; + (1|&lt;L2&gt;) + ...</code> </td><td style="text-align: left;"> <code>logit</code>,<code>probit</code>,<code>cloglog</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Unordered Multinomial'</code> </td><td style="text-align: left;"> <code>&lt;link&gt;(&lt;y1&gt;, &lt;denom&gt;, &lt;ref_cat&gt;) ~ 1 + &lt;x1&gt; + (1|&lt;L2&gt;) + ...</code> </td><td style="text-align: left;"> <code>logit</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Ordered Multinomial'</code> </td><td style="text-align: left;"> <code>&lt;link&gt;(&lt;y1&gt;, &lt;denom&gt;, &lt;ref_cat&gt;) ~ 1 + &lt;x1&gt; + &lt;x2&gt;[&lt;common&gt;] + (1[&lt;common&gt;]|&lt;L3&gt;) + (1|&lt;L2&gt;) + ...</code> </td><td style="text-align: left;"> <code>logit</code>,<code>probit</code>,<code>cloglog</code></td>
</tr>
<tr>
 <td style="text-align: left;">
<code>'Multivariate Normal'</code> </td><td style="text-align: left;"> <code>c(&lt;y1&gt;, &lt;y2&gt;, ...) ~ 1 + &lt;x1&gt; + &lt;x2&gt;[&lt;common&gt;] + (1[&lt;common&gt;]|&lt;L3&gt;) + (1|&lt;L2&gt;) + (1|&lt;L1&gt;) + ...</code> </td><td style="text-align: left;"> (identity link assumed)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>c('Mixed', 'Normal', 'Binomial')</code> </td><td style="text-align: left;"> <code>c(&lt;y1&gt;, ..., &lt;link&gt; (&lt;y2&gt;, &lt;denom&gt;), ...) ~ 1 + &lt;x1&gt; + &lt;x2&gt;[&lt;common&gt;] + (1[&lt;common&gt;]|&lt;L3&gt;) + (1|&lt;L2&gt;) + (1|&lt;L1&gt;) + ...</code> </td><td style="text-align: left;"> <code>logit</code>*,<code>probit</code>,<code>cloglog</code>*</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>c('Mixed', 'Normal', 'Poisson')</code>* </td><td style="text-align: left;"> <code>c(&lt;y1&gt;, ..., &lt;link&gt;(&lt;y2&gt;, &lt;offset&gt;), ...) ~ 1 + &lt;x1&gt; + &lt;x2&gt;[&lt;common&gt;] + (1[&lt;common&gt;]|&lt;L3&gt;) + (1|&lt;L2&gt;) + (1|&lt;L1&gt;) + ...</code> </td><td style="text-align: left;"> <code>log</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The argument <code>estoptions</code> is a list which can contain the
following options used for estimating the model:
</p>

<ul>
<li> <p><code>EstM</code>: specifies estimation method. When <code>EstM = 0</code> (default), estimation
method is (R)IGLS, otherwise <code>EstM = 1</code> specifies MCMC estimation.
</p>
</li>
<li> <p><code>resi.store</code>: a logical value indicating whether residuals are to be
stored or not. Defaults to <code>FALSE</code>.
</p>
</li>
<li> <p><code>resioptions</code>: a string vector to specify the various residual options.
The <code>'variance'</code> option calculates the posterior variances instead of
the posterior standard errors; the <code>'standardised'</code>, <code>'leverage'</code>, <code>'influence'</code>
and <code>'deletion'</code> options calculate standardised,
leverage, influence and deletion residuals respectively; the
<code>'sampling'</code> option calculates the sampling variance covariance matrix
for the residuals; the <code>'norecode'</code> option prevents residuals with values exceedingly close or
equal to zero from being recoded to missing.
When <code>EstM = 1</code> (i.e. MCMC estimation) <code>'variance'</code>
is default value, and the only other permissible value is <code>'standardised'</code>
(else function call stopped with appropriate error message).
When <code>EstM = 0</code> (i.e. (R)IGLS estimation), <code>'variance'</code>
cannot be specified together with <code>'standardised'</code>, <code>'leverage'</code> or
<code>'deletion'</code> (function call stopped with appropriate error message).
Default is <code>resioptions = c('variance')</code>.
</p>
</li>
<li> <p><code>resi.store.levs</code>: an integer vector indicating the levels at which the
residual chains are to be stored (<code>NULL</code> by default). Non-<code>NULL</code> values
not valid when <code>EstM = 0</code> (i.e. (R)IGLS estimation), else if <code>EstM = 0</code>
and <code>resi.store.levs</code> non-<code>NULL</code>, residual chains at specified levels
are returned.
</p>
</li>
<li> <p><code>debugmode</code>: a logical value determining whether MLwiN is run in the
background or not. The default value is <code>FALSE</code>: i.e. MLwiN is run in
the background. If <code>TRUE</code> the MLwiN GUI is opened, and then pauses after the model
has been set-up, allowing user to check starting values; pressing 'Resume macro'
will then fit the model. Once fit, pressing 'Resume macro' once more will save
the outputs to the <code>workdir</code> ready to be read by <span class="pkg">R2MLwiN</span>. Users can
instead opt to 'Abort macro' in which case the outputs are not saved to the
<code>workdir</code>. This option currently
works for 32 bit version of MLwiN only (automatically switches unless
<code>MLwiNPath</code> or <code>options(MLwiNPath)</code>
has been set directly to the executable).
</p>
</li>
<li> <p><code>x64</code>: a logical value indicating
whether the 64 bit version of MLwiN is used (unless <code>MLwiNPath</code> or <code>options(MLwiNPath)</code>
has been set directly to the executable). The default is determined by the characteristics
of the operating system on which the script is executed. If <code>FALSE</code>,
the 32 bit version is called, if <code>TRUE</code> 64 bit version is called.
</p>
</li>
<li> <p><code>clean.files</code>: specifies whether the generated files are removed from
the <code>workdir</code> (<code>TRUE</code>, the default) or not (<code>FALSE</code>).
</p>
</li>
<li> <p><code>show.file</code>: a logical value indicating whether the output files (e.g.
MLwiN macro file) are shown on the screen. Defaults to <code>FALSE</code>.
</p>
</li>
<li> <p><code>clre</code>: a matrix used to define which elements of the random effects matrix
to remove (i.e. hold constant at zero). Removes
from the random part at level &lt;first row&gt; the covariance matrix element(s)
defined by the pair(s) of rows &lt;second row&gt; &lt;third row&gt;. Each column
corresponds to a removed entry of the covariance matrix. See e.g. <code>demo(UserGuide07)</code>
for an example.
</p>
</li>
<li> <p><code>notation</code>: specifies the model subscript notation
to be used in the MLwiN equations window. <code>'class'</code> means no multiple
subscripts, whereas <code>'level'</code> has multiple subscripts. If
<code>notation = NULL</code>, defaults to <code>'level'</code> if <code>'xc = NULL'</code> else
defaults to <code>'class'</code>.
</p>
</li>
<li> <p><code>mem.init</code>: sets and displays worksheet capacities for
the current MLwiN session. A vector of length 5 corresponding to
the following order: number of levels (defaults to 1 + the number of
levels specified in the function call); worksheet size in thousands of cells
(default is 6000); the number of columns (default is 2500); the number of
explanatory variables (default it 10 + number of explanatory variables
calculated initially); the number of group labels (default is 20).
</p>
</li>
<li> <p><code>optimat</code>: instructs MLwiN to limit the maximum matrix size
that can be allocated by the (R)IGLS algorithm. Specify <code>optimat = TRUE</code>
if MLwiN gives the following error message 'Overflow allocating smatrix'.
This error message arises if one or more higher-level units is/are extremely
large (containing more than 800 lower-level units). In this situation <code>runMLwiN</code>'s
default behaviour is to instruct MLwiN to allocate a larger matrix size to
the (R)IGLS algorithm than is currently possible. Specifying
<code>optimat = TRUE</code> caps the maximum matrix size at 800 lower-level units,
circumventing the MLwiN error message, and allowing most MLwiN
functionality.
</p>
</li>
<li> <p><code>nonlinear</code>: a character vector specifying linearisation method for discrete
response models estimated via IGLS (see Chapter 9 of Rasbash et al 2012,
and Goldstein 2011). <code>N = 0</code> specifies marginal quasi-likelihood
linearization (MQL), whilst <code>N = 1</code> specifies penalised quasi-
likelihood linearization (PQL); <code>M = 1</code> specifies first order
approximation, whilst <code>M = 2</code> specifies second order approximation.
<code>nonlinear = c(N = 0, M = 1)</code> by default. First order marginal
quasi-likelihood (MQL1) only option for single-level discrete response
models. Pertains to discrete response models estimated via IGLS: i.e. when
<code>EstM = 0</code> in <code>estoptions</code>, and for starting values when estimated via IGLS
for MCMC (<code>EstM = 1</code>).
</p>
</li>
<li> <p><code>Meth</code>: specifies which maximum likelihood estimation method is to be
used. If <code>Meth = 0</code> estimation method is set to RIGLS. If <code>Meth = 1</code>
estimation method is set to IGLS (the default setting).  Pertains to models
estimated via (R)IGLS: i.e. when <code>EstM = 0</code> in <code>estoptions</code>, and for starting
values when estimated via (R)IGLS for MCMC (<code>EstM = 1</code>).
</p>
</li>
<li> <p><code>merr</code>: a vector which sets-up measurement errors on predictor
variables. The first element <code>N</code> defines the number of variables that
have measurement errors. Then, for each variable with measurement error, a
pair of inputs are required: the first of these is the explanatory variable
name as a character string, and the second is the variance of
the measurement error for this variable. See <code>demo(MCMCGuide14)</code> for an
example.
</p>
</li>
<li> <p><code>fact</code>: a list of objects specified for factor analysis,
including:
</p>

<ul>
<li> <p><code>nfact</code>: Specifies the number of factors
</p>
</li>
<li> <p><code>lev.fact</code>: Specifies the level/classification for the random part of
the factor for each factor.
</p>
</li>
<li> <p><code>nfactcor</code>: Specifies the number of
correlated factors
</p>
</li>
<li> <p><code>factcor</code>: A vector specifying the correlated
factors: the first element corresponds to the first factor number, the
second to the second factor number, the third element corresponds to the
starting value for the covariance and the fourth element to whether this
covariance is constrained
(<code>1</code>) or not (<code>0</code>). If more than one pair of factors is correlated,
then repeat this sequence for each pair.
</p>
</li>
<li> <p><code>loading</code>: A matrix specifying the
starting values for the factor loadings and the starting value of the factor
variance. Each row corresponds to a factor.
</p>
</li>
<li> <p><code>constr</code>: A matrix
specifying indicators of whether the factor loadings and the factor variance
are constrained (<code>1</code>) or not (<code>0</code>).
</p>
</li></ul>

</li>
<li> <p><code>weighting</code>: a deprecated option for specifying weights in IGLS estimation:
see <code>fpsandwich</code> and <code>rpsandwich</code> for new method of doing so.
<code>weighting</code> is a list of objects including <code>levels</code>, <code>weights</code>,
<code>mode</code>, <code>FSDE</code> and <code>RSDE</code>; see <code><a href="#topic+write.IGLS">write.IGLS</a></code> for details.
</p>
</li>
<li> <p><code>centring</code>: deprecated method (only applicable when using old syntax
pre-<span class="pkg">R2MLwiN</span> v.0.8-0) specifying function by
which explanatory variables are to be centred (users can instead transform
variables prior to <code>runMLwiN</code> call).
If non-<code>NULL</code>, centring is used for the selected explanatory
variables (<code>centring = NULL</code> by default). <code>centring</code> is a list of
objects specifying the methods to be used to centre specific explanatory
variables. E.g. <code>list(age = 1, ...)</code> specifies that the explanatory
variable <code>age</code> is to be centred around its grand mean;
<code>list(age = c(2, 'district'), ...)</code> specifies that <code>age</code> is to be
centred around its group mean, where group defined by the variable <code>district</code>;
and <code>list(age = c(3, 18), ...)</code> specifies that <code>age</code> is to
be centred around the value <code>18</code>.
</p>
</li>
<li> <p><code>xclass</code>: a deprecated option for specifying cross-classified and/or
multiple membership models; see <code>xc</code> and <code>mm</code> for new method of
doing so. <code>xclass</code> is a list of objects including <code>class</code>,
<code>N1</code>, <code>weight</code>, <code>id</code> and <code>car</code>; see <code><a href="#topic+write.MCMC">write.MCMC</a></code> for details.
</p>
</li>
<li> <p><code>mcmcOptions</code>: a list of objects specifying MCMC options, including the
following:
</p>

<ul>
<li> <p><code>orth</code>: If <code>orth = 1</code>, orthogonal fixed effect
vectors are used; zero otherwise.
</p>
</li>
<li> <p><code>hcen</code>: An integer specifying the
level where we use hierarchical centering.
</p>
</li>
<li> <p><code>smcm</code>: If <code>smcm = 1</code>,
structured MCMC is used; zero otherwise.
</p>
</li>
<li> <p><code>smvn</code>: If <code>smvn = 1</code>, the
structured MVN framework is used; zero otherwise.
</p>
</li>
<li> <p><code>paex</code>: A matrix of Nx2; in each row, if the second digit is <code>1</code>, parameter expansion
is used at level &lt;the first digit&gt;.
</p>
</li>
<li> <p><code>mcco</code>: This
command allows the user to have constrained settings for the lowest level
variance matrix in a multivariate Normal model. If value is <code>0</code>,
it estimates distinct variances for each residual error and distinct covariances
for each residual error pair. Four other
settings are currently available:<br />
</p>

<table>
<tr>
 <td style="text-align: left;"><code>1</code> </td><td style="text-align: left;"> fits stuctured errors with a common correlation paramater and a common variance parameter;</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>2</code> </td><td style="text-align: left;"> fits AR1 errors with a common variance parameter;</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>3</code> </td><td style="text-align: left;"> fits structured errors with a common
correlation parameter and independent variance parameters;</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>4</code> </td><td style="text-align: left;"> fits AR1 errors with independent variance
parameters.</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

</li></ul>

</li>
<li> <p><code>drop.data</code>: If <code>TRUE</code> (default) only the data involved in the model
is passed to MLwiN, otherwise the entire dataset in <code>data</code> is passed.
</p>
</li>
<li> <p><code>drop.levels</code>: If <code>TRUE</code> (default) any unused levels are dropped from factors, otherwise the dataset
is left unchanged.
</p>
</li>
<li> <p><code>fpsandwich</code>: specifies standard error type for fixed parameters. If
<code>fpsandwich = TRUE</code>, robust or &lsquo;sandwich&rsquo; standard errors based on raw
residuals are used, if <code>fpsandwich = FALSE</code> (default) then standard,
uncorrected, IGLS or RIGLS computation used.
</p>
</li>
<li> <p><code>rpsandwich</code>: specifies standard error type for random parameters. If
<code>rpsandwich = TRUE</code>, robust or &lsquo;sandwich&rsquo; standard errors based on raw
residuals are used, if <code>rpsandwich = FALSE</code> (default) then standard,
uncorrected, IGLS or RIGLS &lsquo;plug in&rsquo; estimates used.
</p>
</li>
<li> <p><code>smat</code>: a matrix with two rows the levels at which a diagonal
matrix is to be specified. The first row specifies the level.
If the value of the second row is <code>1</code> then the random covariance matrix is
set to be diagonal.
</p>
</li>
<li> <p><code>maxiter</code>: a numeric value specifying the maximum number of iterations, from
the start, before (R)IGLS estimation halts. Pertains to models
estimated via (R)IGLS: i.e. when <code>EstM = 0</code> in <code>estoptions</code>, and for starting
values when estimated via (R)IGLS for MCMC (<code>EstM = 1</code>).
</p>
</li>
<li> <p><code>tol</code>: a numeric value specifying the convergence criterion.
If value is m, estimation will be
deemed to have converged when the relative change in the estimate for all
parameters from one iteration to the next is less than 10(-m). Defaults to
value of <code>2</code> for m if not otherwise specified.  Pertains to models
estimated via (R)IGLS: i.e. when <code>EstM = 0</code> in <code>estoptions</code>, and for starting
values when estimated via (R)IGLS for MCMC (<code>EstM = 1</code>).
</p>
</li>
<li> <p><code>extra</code>: if <code>TRUE</code>, extra binomial, extra negative binomial,
extra Poisson or extra multinomial distributions assumed, else <code>FALSE</code>.
can only be specified for discrete response models (i.e. <code>'Binomial'</code>,
<code>'Negbinom'</code>, <code>'Poisson'</code>, <code>'Multinomial'</code>)
estimated via (R)IGLS (i.e. <code>EstM = 0</code>).
</p>
</li>
<li> <p><code>reset</code>: a vector specifying the action to be
taken, at each level, if a variance parameter is estimated at a particular
iteration to be negative during estimation. Values specified in
ascending order of level hierarchy: if <code>0</code> a negative variance
estimate is reset to zero and so are any associated covariances; if <code>1</code>
a negative variance estimate is reset to zero but not the associated
covariances; if <code>2</code> no resetting takes place. E.g. <code>reset = c(0, 1)</code>
to assign value <code>0</code> to level 1 and value <code>1</code> to level 2 of
two-level model.
</p>
</li>
<li> <p><code>constraints</code>: <code>fixed.ui</code> and <code>fixed.ci</code> are used
to specify constraints on the fixed coefficients, and <code>random.ui</code>
and <code>random.ci</code> to specify constraints on the random parameters. The
syntax for specifying just fixed parameter constraints is
<code>constraints = list(fixed.ui = &lt;fixed matrix&gt;, fixed.ci = &lt;fixed values&gt;)</code>,
where <code>&lt;fixed matrix&gt;</code> is a matrix where each row represents one fixed part
parameter, in the same order that they appear in the results table, each
column represents one constraint, and the values in the matrix are multipliers
for the parameters; and <code>&lt;fixed values&gt;</code> is a vector of values, one per
constraint, to which the parameters multiplied by the multipliers in the
corresponding column of <code>&lt;fixed matrix&gt;</code> should be equal. For example,
if we have a model with formula <code>y ~ 1 + x1 + x2 + x3 + x4 + (1|lev1ID)</code>,
then <code>constraints = list(fixed.ui = matrix(c(0, 1, -1, 0, 0, 0, 0, 0, 1, 2), nrow = 5),
fixed.ci = c(0, 2))</code> specifies the constraints that the coefficient of <code>x1</code>
equals the coefficient of <code>x2</code> and that the coefficient of <code>x3</code> plus
twice the coefficient of <code>x4</code> equals <code>2</code>. Random constraints are
specified similarly, and fixed and random constraints may be applied
simultaneously. Applies to <code>EstM = 0</code> (i.e. estimation via (R)IGLS) only.
</p>
</li>
<li> <p><code>xc</code>: indicates whether model is cross-classified (<code>TRUE</code>) or
nested (<code>FALSE</code>). Ignored if <code>EstM = 0</code>, i.e. only applicable to
models estimated via MCMC. Defaults to <code>xc = FALSE</code>, unless either
<code>mm</code> or <code>car</code> are non-<code>NULL</code>, in which case <code>xc = TRUE</code>. Supersedes
deprecated <code>xclass</code>.
</p>
</li>
<li> <p><code>mm</code>: specifies the structure of a multiple membership model.
Can be a list of variable names, a list of vectors, or a matrix (e.g. see
<code><a href="#topic+df2matrix">df2matrix</a></code>). In the case of the former, each
element of the list corresponds to a level (classification) of the model,
in descending order. If a level is not a multiple membership classification,
then <code>NA</code> is specified. Otherwise, lists need to be assigned to
<code>mmvar</code> and <code>weights</code>, with the former containing columns
specifying the classification units, and the latter containing columns
specifying the weights. Ignored if <code>EstM = 0</code>, i.e. only applicable to models estimated via
MCMC. <code>mm = NULL</code> by default. Supersedes deprecated <code>xclass</code>.
E.g. (from <code>demo(MCMCGuide16)</code>) for
<code>logearn ~ 1 + age_40 + sex + parttime + (1 | company) + (1 | id)</code>, if
<code>company</code> is a multiple membership classification with the variables
indicating the classifications in <code>company</code>, <code>company2</code>,
<code>company3</code>, <code>company4</code> and their weights in <code>weight1</code>, <code>weight2</code>,
<code>weight3</code> and <code>weight4</code> then
<code>mm = list(list(mmvar = list('company', 'company2', 'company3', 'company4'),</code>
<code>weights = list('weight1', 'weight2', 'weight3', 'weight4')), NA)</code>
with the <code>NA</code>, listed last, corresponding to the level 1 identifier (<code>id</code>).
</p>
</li>
<li> <p><code>car</code>: specifies the structure of a conditional autoregressive (CAR)
model. Can be a list of variable names, a list of vectors, or a matrix (e.g. see
<code><a href="#topic+df2matrix">df2matrix</a></code>). In the case of the former, each element of the list
corresponds to a level (classification) of
the model, in descending order. If a level is not a spatial classification,
then <code>NA</code> is specified. Otherwise, lists need to be assigned to
<code>carvar</code> and <code>weights</code>, with the former containing columns
specifying the spatial classification units, and the latter containing
columns specifying the weights. See <code>demo(MCMCGuide17)</code> for examples.
Ignored if <code>EstM = 0</code>, i.e. only applicable
to models estimated via MCMC. <code>car = NULL</code> by default. Supersedes
deprecated <code>xclass</code>. See <code>demo(MCMCGuide17)</code> for examples.
</p>
</li>
<li> <p><code>carcentre</code>: if CAR model (i.e. if <code>car</code> is non-<code>NULL</code>),
<code>carcentre = TRUE</code> mean-centres all random effects at that level.
</p>
</li>
<li> <p><code>startval</code>: a list of numeric vectors specifying the starting values.
If multiple chains requested (via <code>nchains</code>), then can be a list of such lists.
<code>FP.b</code> corresponds to the estimates for the fixed
part; <code>FP.v</code> specifies the variance/covariance estimates for the fixed
part; <code>RP.b</code> specifies the variance estimates for the random part;
<code>RP.v</code> corresponds to the variance/covariance matrix of the variance
estimates for the random part. <code>startval = NULL</code> by default: i.e. when
<code>EstM = 0</code> the OLS estimates are used, else if <code>EstM = 1</code> the
estimates obtained from IGLS are used as the starting values for MCMC.
</p>
</li>
<li> <p><code>sort.force</code>: If <code>TRUE</code> will sort data based on hierarchy as
determined by model formula; defaults to <code>FALSE</code>.
</p>
</li>
<li> <p><code>sort.ignore</code>: If <code>FALSE</code> will check data is sorted in a manner in
keeping with the hierarchy implied by the model formula, and will return a warning
if that is not the case.
</p>
</li>
<li> <p><code>rng.version</code>: An integer value specifing the random number generator
version to be used by MLwiN. If 10 (the default) this will be the Mersenne Twister; 
If 0 this will be the 3-Seed Wichmann-Hill (default in MLwiN prior to version 3).
</p>
</li>
<li> <p><code>mcmcMeth</code>: list of objects specifying MCMC methodology and prior
options, including the following (see <code><a href="#topic+write.MCMC">write.MCMC</a></code> for further details):
</p>

<ul>
<li> <p><code>iterations</code>: Number of main iterations post-burnin (i.e. monitoring chain length), defaults to 5000.
</p>
</li>
<li> <p><code>burnin</code>: Length of burnin, defaults to 500.
</p>
</li>
<li> <p><code>nchains</code>: Number of MCMC chains to run, defaults to 1.
</p>
</li>
<li> <p><code>thinning</code>: Thinning factor, defaults to 1.
</p>
</li>
<li> <p><code>seed</code>: MCMC random number seed, defaults to <code>1</code> when <code>nchains = 1</code>,
and to <code>1:nchains</code> when multiple chains requested.
</p>
</li>
<li> <p><code>priorParam</code>: A list specifying informative priors. This includes:
<code>fixe</code> &ndash; for the fixed
parameters, if proper normal priors are used for some parameters, a list of
vectors of length two is provided, each of which specifies the mean and the
standard deviation. If not given, default ('flat' or 'diffuse') priors are
used for the parameters; <code>fixe.common</code> &ndash; for multivariate normal,
multinomial and mixed response models, if common coefficients are added, use
<code>fixe.common</code> rather than <code>fixe</code>; <code>fixe.sep</code> &ndash; if the common
coefficients are added, use <code>fixe.sep</code> for the separate coefficients;
<code>rp1</code> &ndash; a list object specifying the Wishart or gamma prior for the
covariance matrix or scalar variance at level 1 (this consists of: (1)
<code>estimate</code> &ndash; a prior guess for the true value of the covariance matrix;
(2) <code>size</code> &ndash; sample size for guess.
Note that this is a weakly-informative prior and the default prior
is used if missing); <code>rp2</code> &ndash; a list object specifying the Wishart or
gamma prior for the covariance matrix or scalar variance at level 2 (this
consists of: (1) <code>estimate</code> &ndash; an estimate for the true value of the
inverse of the covariance matrix; (2) <code>size</code> &ndash; the number of rows in
the covariance matrix. Note that this is a weakly-informative prior and the
default prior is used if missing).
</p>
</li>
<li> <p><code>scale</code>: Scale factor for proposal variances: this number will be
multiplied by the estimated parameter variance (from IGLS/RIGLS) to give the
proposal distribution variance. Defaults to 5.8.
</p>
</li>
<li> <p><code>refresh</code>: Number of iterations after which screen (in MLwiN GUI) is
to be refreshed. Defaults to 50.
</p>
</li>
<li> <p><code>fixM</code>: Specifies the estimation method for the fixed effects:
<code>1</code> for Gibbs sampling, <code>2</code> for univariate Metropolis-Hastings (MH)
sampling and <code>3</code> for multivariate MH sampling. Defaults to <code>2</code> if
Poisson, Multinomial, Binomial or Mixed model, else defaults to <code>1</code>.
</p>
</li>
<li> <p><code>residM</code>: Specifies the estimation method for the random effects
(residuals): <code>1</code> for Gibbs sampling, <code>2</code> for univariate
Metropolis-Hastings (MH) sampling and <code>3</code> for multivariate MH sampling.
Defaults to <code>2</code> if Poisson, Multinomial, Binomial or Mixed model,
else defaults to <code>1</code>.
</p>
</li>
<li> <p><code>Lev1VarM</code>: Specifies the estimation method for the level 1 variance:
<code>1</code> for Gibbs sampling, <code>2</code> for univariate
Metropolis-Hastings (MH) sampling and <code>3</code> for multivariate MH sampling.
Defaults to <code>2</code> if Poisson, Multinomial, Binomial or Mixed model,
else defaults to <code>1</code>.
</p>
</li>
<li> <p><code>OtherVarM</code>: Specifies the estimation method for the higher level
variance matrices: <code>1</code> for Gibbs sampling, <code>2</code> for univariate
Metropolis-Hastings (MH) sampling and <code>3</code> for multivariate MH sampling.
Defaults to <code>1</code>.
</p>
</li>
<li> <p><code>adaption</code>: <code>adaption = 1</code> (the default) indicates adaptation is to be used,
<code>adaption = 0</code> indicates it is not.
</p>
</li>
<li> <p><code>tol</code>: An integer specifying tolerance (as a percentage; defaults to 10) when
<code>adaption = 1</code> (ignored if <code>adaption = 0</code>).
</p>
</li>
<li> <p><code>rate</code>: An integer specifying the acceptance rate (as a percentage; defaults
to 50) when <code>adaption = 1</code> (ignored if <code>adaption = 0</code>).
</p>
</li>
<li> <p><code>priorcode</code>: A vector indicating which default priors are to be used
for the variance parameters. It defaults to <code>c(gamma = 1)</code> in which case
Gamma priors are used with MLwiN's defaults of Gamma a value (shape) = 0.001
and Gamma b value (scale) = 0.001, although alternative values for shape and
scale can be specified in subsequent elements of the vector,
e.g. <code>c(gamma = 1, shape = 0.5, scale = 0.2)</code>). Alternatively
<code>c(uniform = 1)</code> specifies Uniform priors on the variance scale. To allow
for back-compatibility with deprecated syntax used in versions of
<span class="pkg">R2MLwiN</span> prior to 0.8-2, if <code>priorcode</code> is instead specified as
an integer, then <code>1</code> indicates that Gamma priors are used, whereas
<code>0</code> indicates that Uniform priors are used. See the section on 'Priors' in the
MLwiN help system for more details on the meaning of these priors.
</p>
</li>
<li> <p><code>startval</code>: Deprecated: starting values are now specified directly
within <code>estoptions</code>.
</p>
</li>
<li> <p><code>lclo</code>: Toggles on/off the possible forms of complex level
1 variation when using MCMC. By default (<code>lclo = 0</code>) the level
1 variation is expressed as a function of the predictors. Else
(<code>lclo = 1</code>) the log of the level 1 precision (1/variance) is expressed as
a function of the predictors. Defaults to <code>lclo = 0</code>.
</p>
</li>
<li> <p><code>dami</code>: Outputs a complete (i.e. including non-missing
responses) response variable y. If <code>dami = c(0, &lt;iter1&gt;, &lt;iter2&gt;, ...)</code> then
the response variables returned will be the value of y at the iterations
quoted (as integers <code>&lt;iter1&gt;, &lt;iter2&gt;</code>, etc.); these can be used for
multiple imputation. If <code>dami = 1</code> the value of y will be the mean
estimate from the iterations produced. <code>dami = 2</code> is as for <code>dami = 1</code>
but with the standard errors of the estimate additionally being stored.
<code>dami = NULL</code> by default.
</p>
</li></ul>

</li></ul>

<p>The argument <code>BUGO</code> is a vector specifying BUGS options as follows:
</p>

<ul>
<li> <p><code>n.chains</code>: specifies the
number of chains used by BUGS.
</p>
</li>
<li> <p><code>debug</code>: determines
whether BUGS stays open following completion of the model run;
<code>debug = FALSE</code> by default.
</p>
</li>
<li> <p><code>seed</code>: sets the random number
generator in BUGS.
</p>
</li>
<li> <p><code>bugs.directory</code>: specifies the path where WinBUGS
has been installed (not required if <code>OpenBugs = TRUE</code>).
</p>
</li>
<li> <p><code>OpenBugs</code>: if <code>OpenBugs = TRUE</code>, OpenBUGS is used.
Otherwise (i.e. <code>OpenBugs = FALSE</code>, the default) WinBUGS is used.
</p>
</li></ul>



<h3>Value</h3>

<p>If <code>BUGO</code> is non-NULL then the output is an <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code>
object.
</p>
<p>If the IGLS algorithm is used (i.e., <code>EstM = 0</code>), then returns <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object;
if MCMC estimation used (i.e., <code>EstM = 1</code>), then returns <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>References</h3>

<p>Goldstein, H. (2011) Multilevel Statistical Models. 4th Edition. London: John Wiley and Sons.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012)
A User's Guide to MLwiN Version 2.26. Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+formula">formula</a></code>, <code><a href="#topic+Formula.translate">Formula.translate</a></code>, <code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>, <code><a href="#topic+write.IGLS">write.IGLS</a></code>, <code><a href="#topic+write.MCMC">write.MCMC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## The R2MLwiN package includes scripts to replicate all the analyses in
## Rasbash et al (2012) A User's Guide to MLwiN Version 2.26 and
## Browne, W.J. (2012) MCMC estimation in MLwiN Version 2.26.
## The MLwiN manuals are available online, see:
## http://www.bristol.ac.uk/cmm/software/mlwin/download/manuals.html

## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## For a list of demo titles
demo(package = 'R2MLwiN')

## Take MCMCGuide03 as an example
## To view file
file.show(system.file('demo', 'MCMCGuide03.R', package='R2MLwiN'))

## To run the demo
demo(MCMCGuide03)

## End(Not run)

</code></pre>

<hr>
<h2 id='show+2CmlwinfitIGLS-method'>Show objects of class &quot;mlwinfitIGLS&quot;</h2><span id='topic+show+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Show objects of class &quot;mlwinfitIGLS&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+show-methods">show-methods</a></code>
</p>

<hr>
<h2 id='show+2CmlwinfitMCMC-method'>Show objects of class &quot;mlwinfitMCMC&quot;</h2><span id='topic+show+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Show objects of class &quot;mlwinfitMCMC&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2CmlwinfitMCMC-method_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+show-methods">show-methods</a></code>
</p>

<hr>
<h2 id='show.mlwinfitIGLS'>Summarize &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+show.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
show(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="show.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="methods.html#topic+show">show</a></code>
</p>

<hr>
<h2 id='show.mlwinfitMCMC'>Summarize &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+show.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
show(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="show.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="methods.html#topic+show">show</a></code>
</p>

<hr>
<h2 id='sixway'>Draws a sixway plot of MCMC diagnostics.</h2><span id='topic+sixway'></span>

<h3>Description</h3>

<p>This function produces a variety of diagnostic plots and statistics for MCMC
chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sixway(chain, name = NULL, acf.maxlag = 100, pacf.maxlag = 10, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sixway_+3A_chain">chain</code></td>
<td>
<p>A numeric vector, <code><a href="coda.html#topic+mcmc">mcmc</a></code> object or <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> object 
(in which case uses its <code>thin</code> argument, otherwise assumes thinning = 1), storing the
MCMC chain for a chosen parameter.</p>
</td></tr>
<tr><td><code id="sixway_+3A_name">name</code></td>
<td>
<p>The parameter name. If <code>name = NULL</code>, the column name of <code>chain</code> will
be used, unless that is also <code>NULL</code> in which case 'x' is used.</p>
</td></tr>
<tr><td><code id="sixway_+3A_acf.maxlag">acf.maxlag</code></td>
<td>
<p>Maximum lag at which to calculate the auto-correlation
function. <code>acf.maxlag = 100</code> by default. See <code><a href="stats.html#topic+acf">acf</a></code>.</p>
</td></tr>
<tr><td><code id="sixway_+3A_pacf.maxlag">pacf.maxlag</code></td>
<td>
<p>Maximum lag at which to calculate the partial
auto-correlation function. <code>pacf.maxlag = 10</code> by default. See <code><a href="stats.html#topic+acf">pacf</a></code>.</p>
</td></tr>
<tr><td><code id="sixway_+3A_...">...</code></td>
<td>
<p>Other graphical parameters (see <code><a href="graphics.html#topic+par">par</a></code> for
details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A variety of plots and statistics are displayed in an R graphic
window, including the following:
</p>

<ul>
<li><p> a trace plot of the plotted trajectory of
an MCMC chain for a model parameter;
</p>
</li>
<li><p> a kernel density plot; kernel density estimates are computed
using <code><a href="stats.html#topic+density">density</a></code>;
</p>
</li>
<li><p> a plotted autocorrelation function (uses <code><a href="stats.html#topic+acf">acf</a></code>);
</p>
</li>
<li><p> a plotted partial autocorrelation function (uses <code><a href="stats.html#topic+acf">pacf</a></code>);
</p>
</li>
<li><p> a plot of the estimated
Monte Carlo standard error (<code><a href="#topic+MCSE">MCSE</a></code>) of the posterior estimate of the
mean against the number of iterations. As MCMC is a
simulation-based approach this induces (Monte Carlo) uncertainty due to the
random numbers it uses. This uncertainty reduces with more
iterations, and is measured by the MCSE, and so this graph details how long
the chain needs to be run to achieve a specific MCSE;
</p>
</li>
<li><p> a box contains two contrasting accuracy diagnostics. The
Raftery-Lewis diagnostic (<code><a href="coda.html#topic+raftery.diag">raftery.diag</a></code>) is a diagnostic
based on a particular quantile of the distribution. The diagnostic Nhat is
used to estimate the length of Markov chain required to estimate a
particular quantile (e.g. the 2.5% and 97.5% quantiles) to a given
accuracy. The Brooks-Draper diagnostic (<code><a href="#topic+BD">BD</a></code>) is a diagnostic based on
the mean of the distribution. It is used to estimate the length of Markov
chain required to produce a mean estimate to k(=2) significant figures with
a given accuracy;
</p>
</li>
<li><p> a box of summary
statistics including the posterior mean, sd, mode, quantiles and the
effective sample size (ESS) of the chain.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BD">BD</a></code>,<code><a href="#topic+MCSE">MCSE</a></code>,<code><a href="stats.html#topic+density">density</a></code>,<code><a href="stats.html#topic+acf">acf</a></code>,<code><a href="stats.html#topic+pacf">pacf</a></code>,<code><a href="coda.html#topic+raftery.diag">raftery.diag</a></code>,<code><a href="coda.html#topic+effectiveSize">effectiveSize</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## Example: tutorial
data(tutorial, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
                     estoptions = list(EstM = 1, resi.store.levs = 2), data = tutorial))

sixway(mymodel@chains[, "FP_standlrt", drop = FALSE], "beta_1")


## End(Not run)

</code></pre>

<hr>
<h2 id='summary+2CmlwinfitIGLS-method'>Summarize &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+summary+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="summary+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+summary-methods">summary-methods</a></code>
</p>

<hr>
<h2 id='summary+2CmlwinfitMCMC-method'>Summarize &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+summary+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary+2B2CmlwinfitMCMC-method_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="summary+2B2CmlwinfitMCMC-method_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+summary-methods">summary-methods</a></code>
</p>

<hr>
<h2 id='summary.mlwinfitIGLS'>Summarize &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+summary.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="summary.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='summary.mlwinfitMCMC'>Summarize &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+summary.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Summarize &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>an <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="summary.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>

<hr>
<h2 id='tidy.mlwinfitIGLS'>Summarises information about the components of a model from a statistical object (broom package).</h2><span id='topic+tidy.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Summarises information about the components of a model from a statistical object (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
tidy(x, conf.int = FALSE, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.mlwinfitIGLS_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> model.</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitIGLS_+3A_conf.int">conf.int</code></td>
<td>
<p>should the confidence interval be included?</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitIGLS_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence interval level</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+tidy">tidy</a></code>
</p>

<hr>
<h2 id='tidy.mlwinfitMCMC'>Summarises information about the components of a model from a statistical object (broom package).</h2><span id='topic+tidy.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Summarises information about the components of a model from a statistical object (broom package).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
tidy(x, conf.int = FALSE, conf.level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.mlwinfitMCMC_+3A_x">x</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> model.</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitMCMC_+3A_conf.int">conf.int</code></td>
<td>
<p>should the confidence interval be included?</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitMCMC_+3A_conf.level">conf.level</code></td>
<td>
<p>confidence interval level</p>
</td></tr>
<tr><td><code id="tidy.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="generics.html#topic+tidy">tidy</a></code>
</p>

<hr>
<h2 id='trajectories'>Plots MCMC chain trajectories</h2><span id='topic+trajectories'></span>

<h3>Description</h3>

<p>This function draws trajectories of MCMC chains.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trajectories(object, Range = c(1, 5000), selected = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trajectories_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code>, <code><a href="coda.html#topic+mcmc">mcmc</a></code> or <code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> object,
or other object that can be converted to an <code><a href="coda.html#topic+mcmc">mcmc</a></code> object.</p>
</td></tr>
<tr><td><code id="trajectories_+3A_range">Range</code></td>
<td>
<p>An integer vector of length two specifying the first and last
iterations of the chains.</p>
</td></tr>
<tr><td><code id="trajectories_+3A_selected">selected</code></td>
<td>
<p>A character vector specifying the selected chains to be
plotted.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sixway">sixway</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

## Example: tutorial
data(tutorial, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | student),
                     estoptions = list(EstM = 1), data = tutorial))

trajectories(mymodel, Range = c(4501, 5000))

## End(Not run)

</code></pre>

<hr>
<h2 id='tutorial'>Exam results for six inner London Education Authorities</h2><span id='topic+tutorial'></span>

<h3>Description</h3>

<p>A subset of data from a much larger dataset of examination results from six
inner London Education Authorities (school boards).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tutorial
</code></pre>


<h3>Format</h3>

<p>A data frame with 4059 observations on the following 10 variables:
</p>

<dl>
<dt>school</dt><dd><p>Numeric school identifier.</p>
</dd>
<dt>student</dt><dd><p>Numeric student identifier.</p>
</dd>
<dt>normexam</dt><dd><p>Students' exam score at age 16, normalised to have
approximately a standard Normal distribution.</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
<dt>standlrt</dt><dd><p>Students' score at age 11 on the London Reading Test
(LRT), standardised using Z-scores.</p>
</dd>
<dt>sex</dt><dd><p>Sex of pupil; a factor with levels <code>boy</code>, <code>girl</code>.</p>
</dd>
<dt>schgend</dt><dd><p>Schools' gender; a factor with levels corresponding to mixed
school (<code>mixedsch</code>), boys' school (<code>boysch</code>), and girls' school
(<code>girlsch</code>).</p>
</dd>
<dt>avslrt</dt><dd><p>Average LRT score in school.</p>
</dd>
<dt>schav</dt><dd><p>Average LRT score in school, coded into 3 categories:
<code>low</code> = bottom 25%, <code>mid</code> = middle 50%, <code>high</code> = top 25%.</p>
</dd>
<dt>vrband</dt><dd><p>Students' score in test of verbal reasoning at age 11,
a factor with 3 levels: <code>vb1</code> = top 25%, <code>vb2</code> = middle 50%,
<code>vb3</code> = bottom 25%.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>tutorial</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), and is a
subset of data from a much larger dataset of examination results from six
inner London Education Authorities (school boards). The original analysis
(Goldstein et al., 1993) sought to establish whether some secondary schools
had better student exam performance at 16 than others, after taking account
of variations in the characteristics of students when they started secondary
school; i.e., the analysis investigated the extent to which schools 'added
value' (with regard to exam performance), and then examined what factors
might be associated with any such differences. See also Rasbash et al.
(2012) and Browne (2012).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Goldstein, H., Rasbash, J., Yang, M., Woodhouse, G., Pan, H., Nuttall, D.,
Thomas, S. (1993) A multilevel analysis of school examination results.
<em>Oxford Review of Education</em>, <b>19</b>, 425&ndash;433.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012) <em>A
User's Guide to MLwiN Version 2.26.</em> Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(tutorial, package = "R2MLwiN")

# Fit 2-level variance components model, using IGLS (default estimation method)
(VarCompModel &lt;- runMLwiN(normexam ~ 1 + (1 | school) + (1 | student), data = tutorial))

# print variance partition coefficient (VPC)
print(VPC &lt;- coef(VarCompModel)[["RP2_var_Intercept"]] /
             (coef(VarCompModel)[["RP1_var_Intercept"]] +
             coef(VarCompModel)[["RP2_var_Intercept"]]))

# Fit same model using MCMC
(VarCompMCMC &lt;- runMLwiN(normexam ~ 1 + (1 | school) + (1 | student),
 estoptions = list(EstM = 1), data = tutorial))

# return diagnostics for VPC
VPC_MCMC &lt;- VarCompMCMC@chains[,"RP2_var_Intercept"] /
            (VarCompMCMC@chains[,"RP1_var_Intercept"] +
            VarCompMCMC@chains[,"RP2_var_Intercept"])
sixway(VPC_MCMC, name = "VPC")

# Adding predictor, allowing its coefficient to vary across groups (i.e. random slopes)
(standlrtRS_MCMC &lt;- runMLwiN(normexam ~ 1 + standlrt + (1 + standlrt | school) + (1 | student),
 estoptions = list(EstM = 1), data = tutorial))

# Example modelling complex level 1 variance
# fit log of precision at level 1 as a function of predictors
(standlrtC1V_MCMC &lt;- runMLwiN(normexam ~ 
  1 + standlrt + (school | 1 + standlrt) + (1 + standlrt | student),
  estoptions = list(EstM = 1, mcmcMeth = list(lclo = 1)),
  data = tutorial))


## End(Not run)

</code></pre>

<hr>
<h2 id='Untoggle'>Converts a categorical variable into several separate binary variables</h2><span id='topic+Untoggle'></span>

<h3>Description</h3>

<p>This function converts a vector (factor) of categorical character strings
(integers) into several separate vectors of binary indicators to enable
back-compatibility with versions of <span class="pkg">R2MLwiN</span> prior to 0.8-0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Untoggle(categrv, name = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Untoggle_+3A_categrv">categrv</code></td>
<td>
<p>A vector (factor) of categorical character strings
(integers).</p>
</td></tr>
<tr><td><code id="Untoggle_+3A_name">name</code></td>
<td>
<p>A character string specifying a name of a prefix to be appended
the categories when generating dummy variables. If <code>NULL</code>, <code>v__</code> is
used as a prefix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the generated dummy variables.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: Assumes MLwiN path is C:/Program Files (x86)/MLwiN v2.30/
# ...so please change relevant line if different
# if using R2MLwiN via WINE, the path may look like 
# options(MLwiN_path='/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN v2.30/') 

# Example: tutorial
data(tutorial)
names(tutorial)
tutorial = cbind(tutorial, Untoggle(tutorial$school, 'school'))
names(tutorial)

## End(Not run)

</code></pre>

<hr>
<h2 id='update+2CmlwinfitIGLS-method'>Update &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+update+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Update &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
update(
  object,
  Formula.,
  levID.,
  estoptions.,
  ...,
  keep.order = TRUE,
  evaluate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>a valid <code>mlwinfitIGLS</code> class object with an R function call component named <code>call</code>, the expression used to create itself.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_formula.">Formula.</code></td>
<td>
<p>changes to the formula. This is a two sided formula where &quot;.&quot; is substituted for existing components in the <code>Formula</code> component of <code>object$call</code>.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_levid.">levID.</code></td>
<td>
<p>changes to the specifications of level ID(s).</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_estoptions.">estoptions.</code></td>
<td>
<p>changes to the specifications of a list of options used for estimating the model.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>additional arguments to the call, or arguments with changed values.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_keep.order">keep.order</code></td>
<td>
<p>a logical value indicating whether the terms should keep their positions.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitIGLS-method_+3A_evaluate">evaluate</code></td>
<td>
<p>if <code>TRUE</code> (the default) the new call is evaluated;
otherwise the call is returned as an unevaluated expression.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a new updated <code>mlwinfitIGLS</code> class object, or else an unevaluated expression for creating such an object.
</p>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+update-methods">update-methods</a></code>
</p>

<hr>
<h2 id='update+2CmlwinfitMCMC-method'>Update &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+update+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Update &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
update(
  object,
  Formula.,
  levID.,
  estoptions.,
  ...,
  keep.order = TRUE,
  evaluate = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_object">object</code></td>
<td>
<p>a valid <code>mlwinfitMCMC</code> class object with an R function call component named <code>call</code>, the expression used to create itself.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_formula.">Formula.</code></td>
<td>
<p>changes to the formula. This is a two sided formula where &quot;.&quot; is substituted for existing components in the <code>Formula</code> component of <code>object$call</code>.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_levid.">levID.</code></td>
<td>
<p>changes to the specifications of level ID(s).</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_estoptions.">estoptions.</code></td>
<td>
<p>changes to the specifications of a list of options used for estimating the model.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_...">...</code></td>
<td>
<p>additional arguments to the call, or arguments with changed values.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_keep.order">keep.order</code></td>
<td>
<p>a logical value indicating whether the terms should keep their positions.</p>
</td></tr>
<tr><td><code id="update+2B2CmlwinfitMCMC-method_+3A_evaluate">evaluate</code></td>
<td>
<p>if <code>TRUE</code> (the default) the new call is evaluated;
otherwise the call is returned as an unevaluated expression.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a new updated <code>mlwinfitMCMC</code> class object, or else an unevaluated expression for creating such an object.
</p>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+update-methods">update-methods</a></code>
</p>

<hr>
<h2 id='update.mlwinfitIGLS'>Update &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+update.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Update &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
update(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>a valid <code>mlwinfitIGLS</code> class object with an R function call component named <code>call</code>, the expression used to create itself.</p>
</td></tr>
<tr><td><code id="update.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>additional arguments to the call, or arguments with changed values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a new updated <code>mlwinfitIGLS</code> class object, or else an unevaluated expression for creating such an object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+update">update</a></code>
</p>

<hr>
<h2 id='update.mlwinfitMCMC'>Update &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+update.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Update &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
update(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>a valid <code>mlwinfitMCMC</code> class object with an R function call component named <code>call</code>, the expression used to create itself.</p>
</td></tr>
<tr><td><code id="update.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>additional arguments to the call, or arguments with changed values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either a new updated <code>mlwinfitMCMC</code> class object, or else an unevaluated expression for creating such an object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+update">update</a></code>
</p>

<hr>
<h2 id='vcov+2CmlwinfitIGLS-method'>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+vcov+2CmlwinfitIGLS-method'></span>

<h3>Description</h3>

<p>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitIGLS'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov+2B2CmlwinfitIGLS-method_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="vcov+2B2CmlwinfitIGLS-method_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+vcov-methods">vcov-methods</a></code>
</p>

<hr>
<h2 id='vcov+2CmlwinfitMCMC-method'>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+vcov+2CmlwinfitMCMC-method'></span>

<h3>Description</h3>

<p>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'mlwinfitMCMC'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov+2B2CmlwinfitMCMC-method_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="vcov+2B2CmlwinfitMCMC-method_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats4.html#topic+vcov-methods">vcov-methods</a></code>
</p>

<hr>
<h2 id='vcov.mlwinfitIGLS'>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects</h2><span id='topic+vcov.mlwinfitIGLS'></span>

<h3>Description</h3>

<p>Extract the approximate variance-covariance matrix from &quot;mlwinfitIGLS&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitIGLS'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mlwinfitIGLS_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitIGLS-class">mlwinfitIGLS-class</a></code> object</p>
</td></tr>
<tr><td><code id="vcov.mlwinfitIGLS_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>
</p>

<hr>
<h2 id='vcov.mlwinfitMCMC'>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects</h2><span id='topic+vcov.mlwinfitMCMC'></span>

<h3>Description</h3>

<p>Extract the approximate variance-covariance matrix from &quot;mlwinfitMCMC&quot; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlwinfitMCMC'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.mlwinfitMCMC_+3A_object">object</code></td>
<td>
<p>An <code><a href="#topic+mlwinfitMCMC-class">mlwinfitMCMC-class</a></code> object</p>
</td></tr>
<tr><td><code id="vcov.mlwinfitMCMC_+3A_...">...</code></td>
<td>
<p>Other arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+vcov">vcov</a></code>
</p>

<hr>
<h2 id='wage1'>Simulated dataset of office workers' salary and other employment details.</h2><span id='topic+wage1'></span>

<h3>Description</h3>

<p>A simulated dataset of office workers' salary (and associated information)
in which workers exhibit multiple membership of companies worked for over
past year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wage1
</code></pre>


<h3>Format</h3>

<p>A data frame with 3022 observations on the following 21 variables:
</p>

<dl>
<dt>id</dt><dd><p>Unique office worker identifying code.</p>
</dd>
<dt>company</dt><dd><p>Identifying code for company worked for over the last
12 months.</p>
</dd>
<dt>company2</dt><dd><p>If worked for &gt;1 company over the last 12 months, identifying
code for second company.</p>
</dd>
<dt>company3</dt><dd><p>If worked for &gt;2 companies over the last 12 months,
identifying code for third company.</p>
</dd>
<dt>company4</dt><dd><p>If worked for &gt;3 companies over the last 12 months,
identifying code for fourth company.</p>
</dd>
<dt>age</dt><dd><p>Age of worker.</p>
</dd>
<dt>parttime</dt><dd><p>Part or full-time, a factor with levels <code>Fulltime</code> and
<code>Parttime</code>.</p>
</dd>
<dt>sex</dt><dd><p>Sex of worker, a factor with levels <code>male</code> and
<code>female</code>.</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
<dt>earnings</dt><dd><p>Workers' earnings over the last financial year.</p>
</dd>
<dt>logearn</dt><dd><p>Workers' (natural) log-transformed earnings over the last
financial year.</p>
</dd>
<dt>numjobs</dt><dd><p>The number of companies worked for over the last 12 months.</p>
</dd>
<dt>weight1</dt><dd><p>Proportion of time worked for employer listed in
<code>company</code>.</p>
</dd>
<dt>weight2</dt><dd><p>Proportion of time worked for employer listed in
<code>company2</code>.</p>
</dd>
<dt>weight3</dt><dd><p>Proportion of time worked for employer listed in
<code>company3</code>.</p>
</dd>
<dt>weight4</dt><dd><p>Proportion of time worked for employer listed in
<code>company4</code>.</p>
</dd>
<dt>ew1</dt><dd><p>Alternative (equal) weighting for <code>company</code>
(1/<code>numjobs</code>).</p>
</dd>
<dt>ew2</dt><dd><p>Alternative (equal) weighting for <code>company2</code> (if numjobs &gt;1
then 1/<code>numjobs</code>, else 0).</p>
</dd>
<dt>ew3</dt><dd><p>Alternative (equal) weighting for <code>company3</code> (if numjobs &gt;2
then 1/<code>numjobs</code>, else 0).</p>
</dd>
<dt>ew4</dt><dd><p>Alternative (equal) weighting for <code>company4</code> (if numjobs &gt;3
then 1/<code>numjobs</code>,
else 0).</p>
</dd>
<dt>age_40</dt><dd><p>Age of worker, centered on 40 years.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The simulated <code>wage1</code> dataset is one of the sample datasets provided
with the multilevel modelling software package MLwiN (Rasbash et al., 2009),
and described in Browne (2012). It consists of salary and associated
information for office workers, and is used by Browne (2012) as an example
of modelling a multiple membership structure. The dataset exhibits multiple
membership in that workers are clustered across the companies employing them
over the past year, but some have worked for more than one company during
that time.)
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(wage1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(logearn ~ 1 + age_40 + numjobs + (1 | company) + (1 | id), 
  estoptions = list(EstM = 1, 
  mm = list(list(mmvar = list("company", "company2", "company3", "company4"),
  weights = list("weight1", "weight2", "weight3", "weight4")), NA)),
  data = wage1))


## End(Not run)

</code></pre>

<hr>
<h2 id='write.IGLS'>Writes MLwiN macros to fit models using the iterative generalized least
squares (IGLS) algorithm.</h2><span id='topic+write.IGLS'></span>

<h3>Description</h3>

<p>write.IGLS is an internal function which creates an MLwiN macro file to
fit a multilevel model using IGLS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.IGLS(
  indata,
  dtafile,
  oldsyntax = FALSE,
  resp,
  levID,
  expl,
  rp,
  D = "Normal",
  nonlinear = c(0, 1),
  categ = NULL,
  notation = NULL,
  nonfp = NA,
  clre = NULL,
  Meth = 1,
  extra = FALSE,
  reset,
  rcon = NULL,
  fcon = NULL,
  maxiter = 20,
  convtol = 2,
  mem.init = "default",
  optimat = FALSE,
  weighting = NULL,
  fpsandwich = FALSE,
  rpsandwich = FALSE,
  macrofile,
  IGLSfile,
  resifile,
  resi.store = FALSE,
  resioptions,
  debugmode = FALSE,
  startval = NULL,
  namemap = sapply(colnames(indata), as.character),
  saveworksheet = NULL,
  rng.version = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.IGLS_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data to be modelled.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_dtafile">dtafile</code></td>
<td>
<p>The name of the temporary file used to send the data to MLwiN, which
is in Stata format (i.e. with extension .dta).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_oldsyntax">oldsyntax</code></td>
<td>
<p>Specified as <code>FALSE</code> if new syntax has been used in
<code>Formula</code> object, else specified as <code>TRUE</code> (to enable
back-compatibility).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_resp">resp</code></td>
<td>
<p>A character string (vector) of the response variable name(s).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_levid">levID</code></td>
<td>
<p>A character string (vector) of the specified level ID name(s). The
ID(s) should be sorted in the descending order of levels (e.g.
<code>levID = c('level2', 'level1')</code> where <code>'level2'</code> is the higher
level).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_expl">expl</code></td>
<td>
<p>A character string (vector) of explanatory (predictor)
variable name(s).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_rp">rp</code></td>
<td>
<p>A character string (vector) of random part of random variable name(s).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_d">D</code></td>
<td>
<p>A character string/vector specifying the type of distribution to be modelled, which
can include <code>'Normal'</code> (the default), <code>'Binomial'</code>, <code>'Poisson'</code>,
<code>'Negbinom'</code>, <code>'Unordered Multinomial'</code>, <code>'Ordered Multinomial'</code>,
<code>'Multivariate Normal'</code>, or <code>'Mixed'</code>. In the case of the latter, 
<code>'Mixed'</code> precedes the response types which also need to be listed in 
<code>D</code>, e.g. <code>c('Mixed', 'Normal', 'Binomial')</code>; these need to be
be listed in the same order to which they are referred to in the
<code>Formula</code> object (see <code><a href="#topic+runMLwiN">runMLwiN</a></code>, <code><a href="#topic+Formula.translate">Formula.translate</a></code>,
<code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>. <code>'Mixed'</code> combinations can consist of
<code>'Normal'</code> and <code>'Binomial'</code> or <code>'Normal'</code> and <code>'Poisson'</code>.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_nonlinear">nonlinear</code></td>
<td>
<p>A character vector specifying linearisation method for discrete
response models (see Chapter 9 of Rasbash et al 2012, and Goldstein 2011).
<code>N = 0</code> specifies marginal quasi-likelihood
linearization (MQL), whilst <code>N = 1</code> specifies penalised quasi-
likelihood linearization (PQL); <code>M = 1</code> specifies first order
approximation, whilst <code>M = 2</code> specifies second order approximation.
<code>nonlinear = c(N = 0, M = 1)</code> by default. First order marginal
quasi-likelihood (MQL1) only option for single-level discrete response
models.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_categ">categ</code></td>
<td>
<p>Specifies categorical variable(s) as a matrix. Each column
corresponds to a categorical variable; the first row specifies the name(s)
of variable(s); the second row specifies the name(s) of reference group(s),
<code>NA</code>(s) if no reference group; the third row states the number of
categories for each variable. Supports back-compatibility with <span class="pkg">R2MLwiN</span>
versions &lt;0.8-0.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_notation">notation</code></td>
<td>
<p>Specifies the model subscript notation to be used in the
MLwiN equations window. <code>'class'</code> means no multiple subscripts, whereas
<code>'level'</code> has multiple subscripts.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_nonfp">nonfp</code></td>
<td>
<p>Removes the fixed part of random variable(s). <code>NA</code> if no
variable to be removed.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_clre">clre</code></td>
<td>
<p>A matrix used to define which elements of the random effects matrix
to remove (i.e. hold constant at zero). Removes
from the random part at level &lt;first row&gt; the covariance matrix element(s)
defined by the pair(s) of rows &lt;second row&gt; &lt;third row&gt;. Each column
corresponds to a removed entry of the covariance matrix. See e.g. <code>demo(UserGuide07)</code>
for an example.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_meth">Meth</code></td>
<td>
<p>Specifies which maximum likelihood estimation method to be used.
If <code>Meth = 0</code> estimation method is set to RIGLS. If <code>Meth = 1</code>
estimation method is set to IGLS (the default setting).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_extra">extra</code></td>
<td>
<p>If <code>TRUE</code>, extra binomial, extra negative binomial,
extra Poisson or extra multinomial distributions assumed, else <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_reset">reset</code></td>
<td>
<p>A vector of <code>length(levID)</code> specifying the action to be
taken, at each level, if a variance parameter is estimated at a particular
iteration to be negative during estimation. Values specified in
ascending order of level hierarchy: if <code>0</code> a negative variance
estimate is reset to zero and so are any associated covariances; if <code>1</code>
a negative variance estimate is reset to zero but not the associated
covariances; if <code>2</code> no resetting takes place. E.g. <code>reset = c(0, 1)</code>
to assign value <code>0</code> to level 1 and value <code>1</code> to level 2 of
two-level model.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_rcon">rcon</code></td>
<td>
<p>Matrix specifying constraints on the random parameters as
specified in <code>random.ui</code> and <code>random.ci</code> in the <code>constraints</code>
option within <code>estoptions</code> (see <code><a href="#topic+runMLwiN">runMLwiN</a></code>). <code>random.ci</code>
is appended to the bottom row of <code>random.ui</code>.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_fcon">fcon</code></td>
<td>
<p>Matrix specifying constraints on the fixed coefficients as
specified in <code>fixed.ui</code> and <code>fixed.ci</code> in the <code>constraints</code>
option within <code>estoptions</code> (see <code><a href="#topic+runMLwiN">runMLwiN</a></code>). <code>fixed.ci</code>
is appended to the bottom row of <code>fixed.ui</code>.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_maxiter">maxiter</code></td>
<td>
<p>Numeric value specifying the maximum number of iterations, from
the start, before estimation halts.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_convtol">convtol</code></td>
<td>
<p>Numeric value specifying the convergence criterion, as
specified in the <code>tol</code> option within <code>estoptions</code> (see
<code><a href="#topic+runMLwiN">runMLwiN</a></code>). If value of <code>convtol</code> is m, estimation will be
deemed to have converged when the relative change in the estimate for all
parameters from one iteration to the next is less than 10(-m). Defaults to
value of <code>2</code> for m if not otherwise specified.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_mem.init">mem.init</code></td>
<td>
<p>If calling write.IGLS directly, if wish to use defaults, value needs to be
specified as <code>'default'</code>, else specify a vector of length 5 corresponding
to the following order: number of levels; worksheet size in thousands of cells;
the number of columns; the number of explanatory variables; the number of group
labels.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_optimat">optimat</code></td>
<td>
<p>This option instructs MLwiN to limit the maximum matrix size
that can be allocated by the (R)IGLS algorithm. Specify <code>optimat = TRUE</code>
if MLwiN gives the following error message 'Overflow allocating smatrix'.
This error message arises if one more higher-level units is extremely large
(contains more than 800 lower-level units). In this situation <span class="pkg">R2MLwiN</span>'s
default behaviour is to instruct MLwiN to allocate a larger matrix size to
the (R)IGLS algorithm than is currently possible. Specifying
<code>optimat = TRUE</code> caps the maximum matrix size at 800 lower-level units,
circumventing the MLwiN error message, and allowing most MLwiN
functionality.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_weighting">weighting</code></td>
<td>
<p>A list of two items, one of which is a list called <code>weightvar</code>
the length of which corresponds
to the number of levels in the model, in descending order from highest level first.
The other is an option <code>standardised</code> which is <code>TRUE</code> or <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_fpsandwich">fpsandwich</code></td>
<td>
<p>Specifies standard error type for fixed parameters. If
<code>fpsandwich = TRUE</code>, robust or &lsquo;sandwich&rsquo; standard errors based on raw
residuals are used, if <code>fpsandwich = FALSE</code> (default) then standard,
uncorrected, IGLS or RIGLS computation used.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_rpsandwich">rpsandwich</code></td>
<td>
<p>Specifies standard error type for random parameters. If
<code>rpsandwich = TRUE</code>, robust or &lsquo;sandwich&rsquo; standard errors based on raw
residuals are used, if <code>rpsandwich = FALSE</code> (default) then standard,
uncorrected, IGLS or RIGLS &lsquo;plug in&rsquo; estimates used.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_macrofile">macrofile</code></td>
<td>
<p>A file name where the MLwiN macro file will be saved. The
default location is in the temporary folder.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_iglsfile">IGLSfile</code></td>
<td>
<p>A file name where the parameter estimates will be saved. The
default location is in the temporary folder.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_resifile">resifile</code></td>
<td>
<p>A file name where the residuals will be saved. The default
location is in the temporary folder.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_resi.store">resi.store</code></td>
<td>
<p>A logical value to indicate if the residuals are to be
stored (<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_resioptions">resioptions</code></td>
<td>
<p>A string vector to specify the various residual options.
The <code>'variances'</code> option calculates the posterior variances instead of
the posterior standard errors; the <code>'standardised'</code>, <code>'leverage'</code>,
<code>'influence'</code> and <code>'deletion'</code> options calculate standardised,
leverage, influence and deletion residuals respectively; the
<code>'sampling'</code> option calculates the sampling variance covariance matrix
for the residuals; the <code>'norecode'</code> option prevents residuals with
values exceedingly close or equal to zero from being recoded to missing; the
reflate option returns unshrunken residuals. Note that the default option is
<code>resioptions = c('variance')</code>; <code>'variance'</code> cannot be used together
with the other options to calculate standardised, leverage, influence and
deletion residuals.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_debugmode">debugmode</code></td>
<td>
<p>A logical value determining whether MLwiN is run in the
background or not. The default value is <code>FALSE</code>: i.e. MLwiN is run in
the background. If <code>TRUE</code> the MLwiN GUI is opened, and then pauses after the model
has been set-up, allowing user to check starting values; pressing 'Resume macro'
will then fit the model. Once fit, pressing 'Resume macro' once more will save
the outputs to the <code>workdir</code> ready to be read by <span class="pkg">R2MLwiN</span>. Users can
instead opt to 'Abort macro' in which case the outputs are not saved to the
<code>workdir</code>. This option currently
works for 32 bit version of MLwiN only (automatically switches unless
<code>MLwiNPath</code> or <code>options(MLwiNPath)</code>
has been set directly to the executable).</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_startval">startval</code></td>
<td>
<p>A list of numeric vectors specifying the starting values.
<code>FP.b</code> corresponds to the estimates for the fixed
part; <code>FP.v</code> specifies the variance/covariance estimates for the fixed
part; <code>RP.b</code> specifies the variance estimates for the random part;
<code>RP.v</code> corresponds to the variance/covariance matrix of the variance
estimates for the random part.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_namemap">namemap</code></td>
<td>
<p>A mapping of column names to DTA friendly shorter names</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_saveworksheet">saveworksheet</code></td>
<td>
<p>A file name used to store the MLwiN worksheet after the
model has been estimated.</p>
</td></tr>
<tr><td><code id="write.IGLS_+3A_rng.version">rng.version</code></td>
<td>
<p>An integer indicating which random number generator should
be used by MLwiN.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Outputs a modified version of namemap containing newly generated
short names.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>References</h3>

<p>Goldstein, H. (2011) Multilevel Statistical Models. 4th Edition. London: John Wiley and Sons.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012)
A User's Guide to MLwiN Version 2.26. Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.MCMC">write.MCMC</a></code>
</p>

<hr>
<h2 id='write.MCMC'>Writes MLwiN macros to fit models using Markov chain Monte Carlo (MCMC)
methods</h2><span id='topic+write.MCMC'></span>

<h3>Description</h3>

<p>write.MCMC is an internal function which creates an MLwiN macro file to
fit models using MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.MCMC(
  indata,
  dtafile,
  oldsyntax = FALSE,
  resp,
  levID,
  expl,
  rp,
  D = "Normal",
  nonlinear = c(0, 1),
  categ = NULL,
  notation = NULL,
  nonfp = NULL,
  clre = NULL,
  Meth = 1,
  merr = NULL,
  carcentre = FALSE,
  maxiter = 20,
  convtol = 2,
  seed = 1,
  iterations = 5000,
  burnin = 500,
  scale = 5.8,
  thinning = 1,
  priorParam = "default",
  refresh = 50,
  fixM = 1,
  residM = 1,
  Lev1VarM = 1,
  OtherVarM = 1,
  adaption = 1,
  priorcode = c(gamma = 1),
  rate = 50,
  tol = 10,
  lclo = 0,
  mcmcOptions,
  fact = NULL,
  xc = NULL,
  mm = NULL,
  car = NULL,
  BUGO = NULL,
  mem.init = "default",
  optimat = FALSE,
  modelfile,
  initfile,
  datafile,
  macrofile,
  IGLSfile,
  MCMCfile,
  chainfile,
  MIfile,
  resifile,
  resi.store = FALSE,
  resioptions,
  resichains,
  FACTchainfile,
  resi.store.levs = NULL,
  debugmode = FALSE,
  startval = NULL,
  dami = NULL,
  namemap = sapply(colnames(indata), as.character),
  saveworksheet = NULL,
  rng.version = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.MCMC_+3A_indata">indata</code></td>
<td>
<p>A data.frame object containing the data to be modelled.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_dtafile">dtafile</code></td>
<td>
<p>The file name of the dataset to be imported into MLwiN, which
is in Stata format (i.e. with extension .dta).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_oldsyntax">oldsyntax</code></td>
<td>
<p>Specified as <code>FALSE</code> if new syntax has been used in
<code>Formula</code> object, else specified as <code>TRUE</code> (to enable
backcompatibility).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resp">resp</code></td>
<td>
<p>A character string (vector) of response variable(s).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_levid">levID</code></td>
<td>
<p>A character string (vector) of the specified level ID(s). The
ID(s) should be sorted in the descending order of levels (e.g.
<code>levID = c('level2', 'level1')</code> where <code>'level2'</code> is the higher
level).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_expl">expl</code></td>
<td>
<p>A character string (vector) of explanatory (predictor)
variable(s).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_rp">rp</code></td>
<td>
<p>A character string (vector) of random part of random variable(s).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_d">D</code></td>
<td>
<p>A character string/vector specifying the type of distribution to be modelled, which
can include <code>'Normal'</code> (the default), <code>'Binomial'</code>, <code>'Poisson'</code>,
<code>'Unordered Multinomial'</code>, <code>'Ordered Multinomial'</code>,
<code>'Multivariate Normal'</code>, or <code>'Mixed'</code>. In the case of the latter,
<code>'Mixed'</code> precedes the response types which also need to be listed in
<code>D</code>, e.g. <code>c('Mixed', 'Normal', 'Binomial')</code>; these need to be
be listed in the same order to which they are referred to in the
<code>Formula</code> object (see <code><a href="#topic+runMLwiN">runMLwiN</a></code>, <code><a href="#topic+Formula.translate">Formula.translate</a></code>,
<code><a href="#topic+Formula.translate.compat">Formula.translate.compat</a></code>. <code>'Mixed'</code> combinations can only consist of
<code>'Normal'</code> and <code>'Binomial'</code> for MCMC estimation.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_nonlinear">nonlinear</code></td>
<td>
<p>A character vector specifying linearisation method for IGLS
starting values for discrete
response models (see Chapter 9 of Rasbash et al 2012, and Goldstein 2011).
<code>N = 0</code> specifies marginal quasi-likelihood
linearization (MQL), whilst <code>N = 1</code> specifies penalised quasi-
likelihood linearization (PQL); <code>M = 1</code> specifies first order
approximation, whilst <code>M = 2</code> specifies second order approximation.
<code>nonlinear = c(N = 0, M = 1)</code> by default. First order marginal
quasi-likelihood (MQL1) only option for single-level discrete response
models.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_categ">categ</code></td>
<td>
<p>Specifies categorical variable(s) as a matrix. Each column
corresponds to a categorical variable; the first row specifies the name(s)
of variable(s); the second row specifies the name(s) of reference group(s),
<code>NA</code>(s) if no reference group; the third row states the number of
categories for each variable.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_notation">notation</code></td>
<td>
<p>Specifies the model subscript notation to be used in the
MLwiN equations window. <code>'class'</code> means no multiple subscripts, whereas
<code>'level'</code> has multiple subscripts.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_nonfp">nonfp</code></td>
<td>
<p>Removes the fixed part of random variable(s). <code>NA</code> if no
variable is removed.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_clre">clre</code></td>
<td>
<p>A matrix used to estimate some, but not all, of the variances
and covariances for a set of coefficients at a particular level. Remove from
the random part at level &lt;first row&gt; the covariance matrix element(s)
defined by the pair(s) of rows &lt;second row&gt; &lt;third row&gt;. Each row
corresponds to a removed entry of the covariance matrix.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_meth">Meth</code></td>
<td>
<p>Specifies the maximum likelihood estimation method to be used
when generating starting values via (R)IGLS.
If <code>Meth = 0</code> estimation method is set to RIGLS. If <code>Meth = 1</code>
estimation method is set to IGLS (the default setting). If <code>Meth</code> is
absent, alternate between IGLS and RIGLS.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_merr">merr</code></td>
<td>
<p>A vector which sets-up measurement errors on predictor
variables. The first element <code>N</code> defines the number of variables that
have measurement errors. Then, for each variable with measurement error, a
pair of inputs is required: the first of which is the explanatory variable
name as a character string, and the second of which is the variance of
the measurement error for this variable. See <code>demo(MCMCGuide14)</code> for an
example.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_carcentre">carcentre</code></td>
<td>
<p>If CAR model (i.e. if <code>car</code> is non-<code>NULL</code>),
<code>carcentre = TRUE</code> mean-centres all random effects at that level.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_maxiter">maxiter</code></td>
<td>
<p>When generating starting values via (R)IGLS, a numeric
value specifying the total number of iterations, from
the start, before IGLS estimation halts (if <code>startval = NULL</code>).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_convtol">convtol</code></td>
<td>
<p>When generating starting values via (R)IGLS, a numeric
value specifying the IGLS convergence criterion, as
specified in the <code>tol</code> option within <code>estoptions</code>, where
<code>startval = NULL</code>) (see <code><a href="#topic+runMLwiN">runMLwiN</a></code>). If value of
<code>convtol</code> is m, estimation will be deemed to have converged when the
relative change in the estimate for any parameter from one iteration to the
next is less than 10(-m). Defaults to value of <code>2</code> for m if not
otherwise specified.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_seed">seed</code></td>
<td>
<p>An integer specifying the random seed in MLwiN.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_iterations">iterations</code></td>
<td>
<p>An integer specifying the number of iterations after
burn-in.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_burnin">burnin</code></td>
<td>
<p>An integer specifying length of the burn-in.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_scale">scale</code></td>
<td>
<p>An integer specifying the scale factor of proposed variances;
this number will be multiplied by the estimated
parameter variance (from IGLS/RIGLS) to give the proposal distribution variance.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_thinning">thinning</code></td>
<td>
<p>An integer specifying the frequency with which successive
values in the Markov chain are stored. By default <code>thinning = 1</code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_priorparam">priorParam</code></td>
<td>
<p>A vector specifying the informative priors used, as output
from <code><a href="#topic+prior2macro">prior2macro</a></code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_refresh">refresh</code></td>
<td>
<p>An integer specifying how frequently the parameter estimates
are refreshed on the screen during iterations; only applies if
<code>debugmode = TRUE</code> in <code>estoptions</code>:
see <code><a href="#topic+runMLwiN">runMLwiN</a></code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_fixm">fixM</code></td>
<td>
<p>Specifies the fixed effect method: <code>1</code> for Gibbs Sampling,
<code>2</code> for univariate MH Sampling and <code>3</code> for multivariate MH
Sampling.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_residm">residM</code></td>
<td>
<p>Specifies the residual method: <code>1</code> for Gibbs Sampling,
<code>2</code> for univariate MH Sampling and <code>3</code> for multivariate MH
Sampling.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_lev1varm">Lev1VarM</code></td>
<td>
<p>Specifies the level 1 variance method: <code>1</code> for Gibbs
Sampling, <code>2</code> for univariate MH Sampling and <code>3</code> for multivariate
MH Sampling.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_othervarm">OtherVarM</code></td>
<td>
<p>Specifies the variance method for other levels: <code>1</code>
for Gibbs Sampling, <code>2</code> for univariate MH Sampling and <code>3</code> for
multivariate MH Sampling.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_adaption">adaption</code></td>
<td>
<p><code>adaption = 1</code> indicates adaptation is to be used;
<code>0</code> otherwise.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_priorcode">priorcode</code></td>
<td>
<p>A vector indicating which default priors are to be used
for the variance parameters. It defaults to <code>c(gamma = 1)</code> in which case
Gamma priors are used with MLwiN's defaults of Gamma a value (shape) = 0.001
and Gamma b value (scale) = 0.001, although alternative values for shape and
scale can be specified in subsequent elements of the vector,
e.g. <code>c(gamma = 1, shape = 0.5, scale = 0.2)</code>). Alternatively
<code>c(uniform = 1)</code> specifies Uniform priors on the variance scale. To allow
for back-compatibility with deprecated syntax used in versions of
<span class="pkg">R2MLwiN</span> prior to 0.8-2, if <code>priorcode</code> is instead specified as
an integer, then <code>1</code> indicates that Gamma priors are used, whereas
<code>0</code> indicates that Uniform priors are used. See the section on 'Priors' in the
MLwiN help system for more details on the meaning of these priors.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_rate">rate</code></td>
<td>
<p>An integer specifying the acceptance rate (as a percentage);
this command is ignored if <code>adaption = 0</code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_tol">tol</code></td>
<td>
<p>An integer specifying tolerance (as a percentage) for the acceptance rate.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_lclo">lclo</code></td>
<td>
<p>This command toggles on/off the possible forms of complex level
1 variation when using MCMC. <code>lclo = 0</code> expresses the level
1 variation as a function of the predictors, whereas <code>lclo = 1</code> expresses the
log of the level 1 precision (1/variance) as a function of the predictors.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_mcmcoptions">mcmcOptions</code></td>
<td>
<p>A list of other MCMC options used. See &lsquo;Details&rsquo; below.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_fact">fact</code></td>
<td>
<p>A list of objects specified for factor analysis. See &lsquo;Details&rsquo;
below.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_xc">xc</code></td>
<td>
<p>Indicates whether model is cross-classified (<code>TRUE</code>) or
nested (<code>FALSE</code>). <code>xc = NULL</code> by default (corresponding to
<code>FALSE</code>), unless either <code>mm</code> or <code>car</code> are not null, in
which case <code>xc = TRUE</code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_mm">mm</code></td>
<td>
<p>Specifies the structure of a multiple membership model.
Can be a list of variable names, a list of vectors, or a matrix (e.g. see
<code><a href="#topic+df2matrix">df2matrix</a></code>). In the case of the former, each
element of the list corresponds to a level (classification) of the model,
in descending order. If a level is not a multiple membership classification,
then <code>NA</code> is specified. Otherwise, lists need to be assigned to
<code>mmvar</code> and <code>weights</code>, with the former containing columns
specifying the classification units, and the latter containing columns
specifying the weights. Ignored if <code>EstM = 0</code>, i.e. only applicable to models estimated via
MCMC. <code>mm = NULL</code> by default. Supersedes deprecated <code>xclass</code>.
E.g. (from <code>demo(MCMCGuide16)</code>) for
<code>logearn ~ 1 + age_40 + sex + parttime + (company|1) + (id|1)</code>, if
<code>company</code> is a multiple membership classification with the variables
indicating the classifications in <code>company</code>, <code>company2</code>,
<code>company3</code>, <code>company4</code> and their weights in <code>weight1</code>, <code>weight2</code>,
<code>weight3</code> and <code>weight4</code> then
<code>mm = list(list(mmvar = list('company', 'company2', 'company3', 'company4'),</code>
<code>weights = list('weight1', 'weight2', 'weight3', 'weight4')), NA)</code>
with the <code>NA</code>, listed last, corresponding to the level 1 identifier (<code>id</code>).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_car">car</code></td>
<td>
<p>A list specifying structure of a conditional autoregressive (CAR)
model. Each element of the list corresponds to a level (classification) of
the model, in descending order. If a level is not a spatial classification,
then <code>NA</code> is specified. Otherwise, lists need to be assigned to
<code>carvar</code> and <code>weights</code>, with the former containing columns
specifying the spatial classification units, and the latter containing
columns specifying the weights. See <code>demo(MCMCGuide17)</code> for examples.
<code>car = NULL</code> by default.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_bugo">BUGO</code></td>
<td>
<p>If non-<code>NULL</code> uses BUGS for MCMC estimation using files
specified in <code>modelfile</code>, <code>initfile</code> and <code>datafile</code>.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_mem.init">mem.init</code></td>
<td>
<p>A vector which sets and displays worksheet capacities for
the current MLwiN session according to the value(s) specified. By default,
the number of levels is <code>nlev</code>+1; worksheet size in thousands of cells
is 6000; the number of columns is 2500; the number of explanatory variables
is <code>num_vars</code>+10; the number of group labels is 20. <code>nlev</code> is the
number of levels specified by <code>levID</code>, and <code>num_vars</code> is
approximately the number of explanatory variables calculated initially.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_optimat">optimat</code></td>
<td>
<p>This option instructs MLwiN to limit the maximum matrix size
that can be allocated by the (R)IGLS algorithm. Specify <code>optimat = TRUE</code>
if MLwiN gives the following error message 'Overflow allocating smatrix'.
This error message arises if one more higher-level units is extremely large
(contains more than 800 lower-level units).  In this situation runmlwin's
default behaviour is to instruct MLwiN to allocate a larger matrix size to
the (R)IGLS algorithm than is currently possible. Specifying
<code>optimat = TRUE</code> caps the maximum matrix size at 800 lower-level units,
circumventing the MLwiN error message, and allowing most MLwiN
functionality.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_modelfile">modelfile</code></td>
<td>
<p>A file name where the BUGS model will be saved in .txt
format.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_initfile">initfile</code></td>
<td>
<p>A file name where the BUGS initial values will be saved
in .txt format.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_datafile">datafile</code></td>
<td>
<p>A file name where the BUGS data will be saved in .txt
format.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_macrofile">macrofile</code></td>
<td>
<p>A file name where the MLwiN macro file will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_iglsfile">IGLSfile</code></td>
<td>
<p>A file name where the IGLS estimates will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_mcmcfile">MCMCfile</code></td>
<td>
<p>A file name where the MCMC estimates will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_chainfile">chainfile</code></td>
<td>
<p>A file name where the MCMC chains will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_mifile">MIfile</code></td>
<td>
<p>A file name where the missing values will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resifile">resifile</code></td>
<td>
<p>A file name where the residual estimates will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resi.store">resi.store</code></td>
<td>
<p>A logical value to indicate if residuals are to be stored
(<code>TRUE</code>) or not (<code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resioptions">resioptions</code></td>
<td>
<p>A string vector to specify the various residual options.
The <code>'variance'</code> option calculates the posterior variances instead of
the posterior standard errors; the <code>'standardised'</code> option calculates standardised
residuals.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resichains">resichains</code></td>
<td>
<p>A file name where the residual chains will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_factchainfile">FACTchainfile</code></td>
<td>
<p>A file name where the factor chains will be saved.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_resi.store.levs">resi.store.levs</code></td>
<td>
<p>An integer vector indicating the levels at which the
residual chains are to be stored.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_debugmode">debugmode</code></td>
<td>
<p>A logical value determining whether MLwiN is run in the
background or not. The default value is <code>FALSE</code>: i.e. MLwiN is run in
the background. If <code>TRUE</code> the MLwiN GUI is opened, and then pauses after the model
has been set-up, allowing user to check starting values; pressing 'Resume macro'
will then fit the model. Once fit, pressing 'Resume macro' once more will save
the outputs to the <code>workdir</code> ready to be read by <span class="pkg">R2MLwiN</span>. Users can
instead opt to 'Abort macro' in which case the outputs are not saved to the
<code>workdir</code>. This option currently
works for 32 bit version of MLwiN only (automatically switches unless
<code>MLwiNPath</code> or <code>options(MLwiNPath)</code>
has been set directly to the executable).</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_startval">startval</code></td>
<td>
<p>A list of numeric vectors specifying the starting values
when using MCMC. <code>FP.b</code> corresponds to the estimates for the fixed
part; <code>FP.v</code> specifies the variance/covariance estimates for the fixed
part; <code>RP.b</code> specifies the variance estimates for the random part;
<code>RP.v</code> corresponds to the variance/covariance matrix of the variance
estimates for the random part.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_dami">dami</code></td>
<td>
<p>This command outputs a complete (i.e. including non-missing
responses) response variable y. If <code>dami = c(0, &lt;iter1&gt;, &lt;iter2&gt;,...)</code> then
the response variables returned will be the value of y at the iterations
quoted (as integers <code>&lt;iter1&gt;, &lt;iter2&gt;</code>, etc.); these can be used for
multiple imputation. If <code>dami = 1</code> the value of y will be the mean
estimate from the iterations produced. <code>dami = 2</code> is as for <code>dami = 1</code>
but with the standard errors of the estimate additionally being stored.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_namemap">namemap</code></td>
<td>
<p>A mapping of column names to DTA friendly shorter names</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_saveworksheet">saveworksheet</code></td>
<td>
<p>A list of file names (one for each chain) used to store the
MLwiN worksheet after the model has been estimated.</p>
</td></tr>
<tr><td><code id="write.MCMC_+3A_rng.version">rng.version</code></td>
<td>
<p>An integer indicating which random number generator should
be used by MLwiN.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A list of other MCMC options as used in the argument
<code>mcmcOptions</code>:
</p>

<ul>
<li> <p><code>orth</code>: If <code>orth = 1</code>, orthogonal fixed effect
vectors are used; zero otherwise.
</p>
</li>
<li> <p><code>hcen</code>: An integer specifying the
level where we use hierarchical centering.
</p>
</li>
<li> <p><code>smcm</code>: If <code>smcm = 1</code>,
structured MCMC is used; zero otherwise.
</p>
</li>
<li> <p><code>smvn</code>: If <code>smvn = 1</code>, the
structured MVN framework is used; zero otherwise.
</p>
</li>
<li> <p><code>paex</code>: A matrix of Nx2; in each row, if the second digit is <code>1</code>, parameter expansion
is used at level &lt;the first digit&gt;.
</p>
</li>
<li> <p><code>mcco</code>: This
command allows the user to have constrained settings for the lowest level
variance matrix in a multivariate Normal model. If value is <code>0</code>,
it estimates distinct variances for each residual error and distinct covariances
for each residual error pair. Four other
settings are currently available:<br />
</p>

<table>
<tr>
 <td style="text-align: left;"><code>1</code> </td><td style="text-align: left;"> fits stuctured errors with a common correlation paramater and a common variance parameter;</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>2</code> </td><td style="text-align: left;"> fits AR1 errors with a common variance parameter;</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>3</code> </td><td style="text-align: left;"> fits structured errors with a common
correlation parameter and independent variance parameters;</td>
</tr>
<tr>
 <td style="text-align: left;"> <code>4</code> </td><td style="text-align: left;"> fits AR1 errors with independent variance
parameters.</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

</li></ul>

<p>A list of objects specified for cross-classified and/or multiple membership
models, as used in the argument <code>xclass</code>:
</p>

<ul>
<li> <p><code>class</code>: An integer
(vector) of the specified class(es).
</p>
</li>
<li> <p><code>N1</code>: This defines a multiple
membership across <code>N1</code> units at level <code>class</code>. <code>N1</code>&gt;1 if
there is multiple membership.
</p>
</li>
<li> <p><code>weight</code>: If there is multiple
membership then the column number <code>weight</code>, which is the length of the
dataset, will contain the first set of weights for the multiple membership.
Note that there should be <code>N1</code> weight columns and they should be
sequential in the worksheet starting from <code>weight</code>.
</p>
</li>
<li> <p><code>id</code>: If the
response is multivariate then the column number <code>id</code> must be input and
this contains the first set of identifiers for the classification. Note that
for a p-variate model each lowest level unit contains p records and the
identifiers (sequence numbers) for each response variate need to be
extracted into <code>id</code> and following columns. There should be <code>N1</code> of
these identifier columns and they should be sequential starting from
<code>id</code> in the multivariate case.
</p>
</li>
<li> <p><code>car</code>: <code>car = TRUE</code> indicates
the spatial CAR model; <code>FALSE</code> otherwise. <code>car = FALSE</code> if ignored.
</p>
</li></ul>

<p>A list of objects specified for factor analysis, as used in the argument
<code>fact</code>:
</p>

<ul>
<li> <p><code>nfact</code>: Specifies the number of factors
</p>
</li>
<li> <p><code>lev.fact</code>: Specifies the level/classification for the random part of
the factor for each factor.
</p>
</li>
<li> <p><code>nfactcor</code>: Specifies the number of
correlated factors
</p>
</li>
<li> <p><code>factcor</code>: a vector specifying the correlated
factors: the first element corresponds to the first factor number, the
second to the second factor number, the third element corresponds to the
starting value for the covariance and the fourth element to whether this
covariance is constrained
(<code>1</code>) or not (<code>0</code>). If more than one pair of factors is correlated,
then repeat this sequence for each pair.
</p>
</li>
<li> <p><code>loading</code>: A matrix specifying the
starting values for the factor loadings and the starting value of the factor
variance. Each row corresponds to a factor.
</p>
</li>
<li> <p><code>constr</code>: A matrix
specifying indicators of whether the factor loadings and the factor variance
are constrained (<code>1</code>) or not (<code>0</code>).
</p>
</li></ul>



<h3>Value</h3>

<p>Outputs a modified version of namemap containing newly generated
short names.
</p>


<h3>Note</h3>

<p>Note that for <code>FixM</code>, <code>residM</code>, <code>Lev1VarM</code> and
</p>
<p><code>OtherVarM</code>, not all combinations of methods are available for all sets
of parameters and all models.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>References</h3>

<p>Goldstein, H. (2011) Multilevel Statistical Models. 4th Edition. London: John Wiley and Sons.
</p>
<p>Rasbash, J., Steele, F., Browne, W.J. and Goldstein, H. (2012)
A User's Guide to MLwiN Version 2.26. Centre for Multilevel Modelling,
University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.IGLS">write.IGLS</a></code>
</p>

<hr>
<h2 id='ws2foreign'>Converts data from one format to another within MLwiN</h2><span id='topic+ws2foreign'></span>

<h3>Description</h3>

<p>This function converts data from one format to another within MLwiN, via
MLwiN macro language. The <code>foreign</code> package allows R to read data files
for most of these formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ws2foreign(wsfile, foreignfile, MLwiNPath = NULL, x64 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ws2foreign_+3A_wsfile">wsfile</code></td>
<td>
<p>A file name specifying the data file (with a specific
extension) to be converted.</p>
</td></tr>
<tr><td><code id="ws2foreign_+3A_foreignfile">foreignfile</code></td>
<td>
<p>A file name specifying the data file (with a specific
extension) after conversion.</p>
</td></tr>
<tr><td><code id="ws2foreign_+3A_mlwinpath">MLwiNPath</code></td>
<td>
<p>A path to the MLwiN folder. By default, <code>MLwiNPath = NULL</code>
and path set by <code>options('MLwiN_path')</code>, the default for which can be
changed via <code>options(MLwiN_path = 'path/to/MLwiN vX.XX/')</code>).</p>
</td></tr>
<tr><td><code id="ws2foreign_+3A_x64">x64</code></td>
<td>
<p>A logical value indicating whether the 64 bit version of MLwiN is
used, the default for this is determined by the version of R used. If
<code>FALSE</code>, the 32 bit version is called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>MLwiN supports conversion between MLwiN (*.wsz, *.ws), Minitab (*.mtw), SAS
(*.xpt), SPSS (*.sav), and Stata (*.dta) files.
</p>
<p>The converted data file (with a specific extension) will be saved to the file
specified by <code>foreignfile</code>.
</p>


<h3>Author(s)</h3>

<p>Zhang, Z., Charlton, C.M.J., Parker, R.M.A., Leckie, G., and Browne,
W.J. (2016) Centre for Multilevel Modelling, University of Bristol.
</p>


<h3>See Also</h3>

<p><code><a href="foreign.html#topic+read.dta">read.dta</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
library(R2MLwiN)
# NOTE: if MLwiN not saved in location R2MLwiN defaults to, specify path via:
# options(MLwiN_path = 'path/to/MLwiN vX.XX/')
# If using R2MLwiN via WINE, the path may look like this:
# options(MLwiN_path = '/home/USERNAME/.wine/drive_c/Program Files (x86)/MLwiN vX.XX/')

wsfile = normalizePath(file.path(getOption("MLwiN_path"), "samples/tutorial.ws"), winslash = "/")
## the tutorial.dta file will be saved in the temporary folder
inputfile = normalizePath(file.path(tempdir(), "tutorial.dta"), winslash = "/", mustWork = FALSE)
ws2foreign(wsfile, foreignfile = inputfile)
library(foreign)
indata = read.dta(inputfile)
str(indata)
unlink(inputfile)

## End(Not run)

</code></pre>

<hr>
<h2 id='xc'>Examination scores of 16-year olds in Fife, Scotland.</h2><span id='topic+xc'></span>

<h3>Description</h3>

<p>A dataset of examination scores of 16-year olds in Fife, Scotland, in which
the secondary school the pupil attended is cross-classified by the primary
school the pupil attended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xc
</code></pre>


<h3>Format</h3>

<p>A data frame with 3435 observations on the following 11 variables:
</p>

<dl>
<dt>vrq</dt><dd><p>A verbal reasoning score resulting from tests pupils took when
they entered secondary school.</p>
</dd>
<dt>attain</dt><dd><p>Attainment score of pupils at age sixteen.</p>
</dd>
<dt>pid</dt><dd><p>Primary school identifying code.</p>
</dd>
<dt>sex</dt><dd><p>Pupils' gender: a factor with levels <code>Male</code> and
<code>Female</code>.</p>
</dd>
<dt>sc</dt><dd><p>Pupils' social class (scaled from low to high).</p>
</dd>
<dt>sid</dt><dd><p>Secondary school identifying code.</p>
</dd>
<dt>fed</dt><dd><p>Fathers' education.</p>
</dd>
<dt>choice</dt><dd><p>Choice number of secondary school attended (where 1 is first
choice, etc.)</p>
</dd>
<dt>med</dt><dd><p>Mothers' education.</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
<dt>pupil</dt><dd><p>Pupil identifying code.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>xc</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), analysed
by Paterson (1991). The data are cross-classified in that not all children
who attended the same primary school subsequently entered the same secondary
school. See also Rasbash et al. (2012).
</p>


<h3>Source</h3>

<p>Paterson, L. (1991) Socio economic status and educational
attainment: a multidimensional and multilevel study. <em>Evaluation and
Research in Education</em>, 5, 97-121. Rasbash, J., Charlton, C., Browne, W.J.,
Healy, M. and Cameron, B. (2009) <em>MLwiN Version 2.1.</em> Centre for
Multilevel Modelling, University of Bristol. Rasbash, J., Steele, F.,
Browne, W.J., Goldstein, H. (2012) <em>A User's Guide to MLwiN v2.26</em>.
University of Bristol: Centre for Multilevel Modelling.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(xc, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(attain ~ 1 + (1 | sid) + (1 | pid) + (1 | pupil),
 estoptions = list(xc = TRUE, EstM = 1), data = xc))


## End(Not run)

</code></pre>

<hr>
<h2 id='xc1'>Examination scores of 16-year olds in Fife, Scotland.</h2><span id='topic+xc1'></span>

<h3>Description</h3>

<p>A dataset of examination scores of 16-year olds in Fife, Scotland, in which
the secondary school the pupil attended is cross-classified by the primary
school the pupil attended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xc1
</code></pre>


<h3>Format</h3>

<p>A data frame with 3435 observations on the following 11 variables:
</p>

<dl>
<dt>vrq</dt><dd><p>A verbal reasoning score resulting from tests pupils took when
they entered secondary school.</p>
</dd>
<dt>attain</dt><dd><p>Attainment score of pupils at age sixteen.</p>
</dd>
<dt>pid</dt><dd><p>Primary school identifying code.</p>
</dd>
<dt>sex</dt><dd><p>Pupils' gender: a factor with levels <code>Male</code> and
<code>Female</code>.</p>
</dd>
<dt>sc</dt><dd><p>Pupils' social class (scaled from low to high).</p>
</dd>
<dt>sid</dt><dd><p>Secondary school identifying code.</p>
</dd>
<dt>fed</dt><dd><p>Fathers' education.</p>
</dd>
<dt>choice</dt><dd><p>Choice number of secondary school attended (where 1 is first
choice, etc.)</p>
</dd>
<dt>med</dt><dd><p>Mothers' education.</p>
</dd>
<dt>cons</dt><dd><p>A column of ones. If included as an explanatory variable in a
regression model (e.g. in MLwiN), its coefficient is the intercept.</p>
</dd>
<dt>pupil</dt><dd><p>Pupil identifying code.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The <code>xc1</code> dataset is one of the sample datasets provided with the
multilevel-modelling software package MLwiN (Rasbash et al., 2009), analysed
by Paterson (1991). The data are cross-classified in that not all children
who attended the same primary school subsequently entered the same secondary
school. See also Browne (2012).
</p>


<h3>Source</h3>

<p>Browne, W. J. (2012) <em>MCMC Estimation in MLwiN Version 2.26.</em>
University of Bristol: Centre for Multilevel Modelling.
</p>
<p>Paterson, L. (1991) Socio economic status and educational attainment: a
multidimensional and multilevel study. <em>Evaluation and Research in
Education</em>, 5, 97-121.
</p>
<p>Rasbash, J., Charlton, C., Browne, W.J., Healy, M. and Cameron, B. (2009)
<em>MLwiN Version 2.1.</em> Centre for Multilevel Modelling, University of
Bristol.
</p>


<h3>See Also</h3>

<p>See <code>mlmRev</code> package for an alternative format of the same
dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

data(xc1, package = "R2MLwiN")

(mymodel &lt;- runMLwiN(attain ~ 1 + (1 | sid) + (1 | pid) + (1 | pupil),
 estoptions = list(xc = TRUE, EstM = 1), data = xc1))


## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
