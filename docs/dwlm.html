<!DOCTYPE html><html lang="en"><head><title>Help for package dwlm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {dwlm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dwlm'>
<p>Solves the doubly weighted simple linear model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Doubly Weighted Linear Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-09-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Hugo Gasca-Aragon [aut,cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hugo Gasca-Aragon &lt;hugo_gasca_aragon@hotmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This linear model solution is useful when both predictor and response have associated uncertainty. The doubly weights linear model solution is invariant on which quantity is used as predictor or response. Based on the results by Reed(1989) &lt;<a href="https://doi.org/10.1119%2F1.15963">doi:10.1119/1.15963</a>&gt; and Ripley &amp; Thompson(1987) &lt;<a href="https://doi.org/10.1039%2FAN9871200377">doi:10.1039/AN9871200377</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>stats (&ge; 3.4.0), R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-09-06 11:18:30 UTC; hugo_</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-09-09 10:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dwlm'>
Solves the doubly weighted simple linear model
</h2><span id='topic+dwlm'></span>

<h3>Description</h3>

<p>Fits the simple linear model using weights on both the predictor and the response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dwlm(x, y, weights.x = rep(1, length(x)), 
	weights.y = rep(1, length(y)), subset = rep(TRUE, length(x)), 
	sigma2.x = rep(0, length(x[subset])), 
	from = min((y[subset] - mean(y[subset]))/(x[subset] - mean(x[subset]))), 
	to = max((y[subset] - mean(y[subset]))/(x[subset] - mean(x[subset]))), 
	n = 1000, max.iter = 100, tol = .Machine$double.eps^0.25, 
	method = c("MLE", "SSE", "R"), trace = FALSE, coef.H0 = c(0,1), alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dwlm_+3A_x">x</code></td>
<td>

<p>the predictor values
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_y">y</code></td>
<td>

<p>the response values
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_weights.x">weights.x</code></td>
<td>

<p>the weight attached to the predictor values
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_weights.y">weights.y</code></td>
<td>

<p>the weight attached to the response values
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_subset">subset</code></td>
<td>

<p>a logical vector or a numeric vector with the positions to be considered
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_sigma2.x">sigma2.x</code></td>
<td>

<p>numeric, the variance due to heterogeneity in the predictor value
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_from">from</code></td>
<td>

<p>numeric, the lowest value of the slope to search for a solution
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_to">to</code></td>
<td>

<p>numeric, the highest value of the slope to search for a solution
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_n">n</code></td>
<td>

<p>integer, the number of slices the search interval (from, to) is divided in
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_max.iter">max.iter</code></td>
<td>

<p>integer, the maximum number of allowed iterations
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_tol">tol</code></td>
<td>

<p>numeric, the maximum allowed error tolerance
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_method">method</code></td>
<td>

<p>string, the selected method (MSE, SSE, R) as described in the references.
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_trace">trace</code></td>
<td>

<p>logical, flag to keep track of the solution
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_coef.h0">coef.H0</code></td>
<td>

<p>numeric vector, the coeffients to test against to for significant difference
</p>
</td></tr>
<tr><td><code id="dwlm_+3A_alpha">alpha</code></td>
<td>

<p>numeric, the significance level for estimating the Degrees of Equivalence (DoE)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>original pedictor values</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>original response values</p>
</td></tr>
<tr><td><code>weights.x</code></td>
<td>
<p>original predictor weigths</p>
</td></tr>
<tr><td><code>weights.y</code></td>
<td>
<p>original response weights</p>
</td></tr>
<tr><td><code>subset</code></td>
<td>
<p>original subset parameter</p>
</td></tr>
<tr><td><code>coef.H0</code></td>
<td>
<p>original parameter value for hypothesis testing against to</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>estimated parameters for the linear model solution</p>
</td></tr>
<tr><td><code>cov.mle</code></td>
<td>
<p>Maximum Likelihood Estimafor for the covariance matrix</p>
</td></tr>
<tr><td><code>cov.lse</code></td>
<td>
<p>Least Squares Estiimator for the  covariance matrix</p>
</td></tr>
<tr><td><code>x.hat</code></td>
<td>
<p>fitted true predictor value, this is a latent (unobserved) variable</p>
</td></tr>
<tr><td><code>y.hat</code></td>
<td>
<p>fitted true response value, this is a latent (unobserved) variable</p>
</td></tr>
<tr><td><code>df.residuals</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code>MSE</code></td>
<td>
<p>mean square error of the solution</p>
</td></tr>
<tr><td><code>DoE</code></td>
<td>
<p>pointwise degrees of equivalente between the observed and the latent variables</p>
</td></tr>
<tr><td><code>u.DoE.mle</code></td>
<td>
<p>uncerainty of the pointwise degrees of equivalence using maximum likelihood solution</p>
</td></tr>
<tr><td><code>u.DoE.lse</code></td>
<td>
<p>uncertainty of the pointwise degrees of equivalence using least squares solution</p>
</td></tr>
<tr><td><code>dm.dXj</code></td>
<td>
<p>partial gradient of the slope with respect to the jth predictor variable</p>
</td></tr>
<tr><td><code>dm.dYj</code></td>
<td>
<p>partial gradient of the slope with respect to the jth response variable</p>
</td></tr>
<tr><td><code>dc.dXj</code></td>
<td>
<p>partial gradient of the intercept with respect to the jth predictor variable</p>
</td></tr>
<tr><td><code>dc.dYj</code></td>
<td>
<p>partial gradient of the intercept with respect to the jth response variable</p>
</td></tr>
<tr><td><code>curr.iter</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code>curr.tol</code></td>
<td>
<p>reached tolerance</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hugo Gasca-Aragon
</p>
<p>Maintainer: Hugo Gasca-Aragon &lt;hugo_gasca_aragon@hotmail.com&gt;
</p>


<h3>References</h3>

<p>Reed, B.C. (1989) &quot;Linear least-squares fits with errors in both coordinates&quot;, American Journal of Physics, 57, 642. <a href="https://doi.org/10.1119/1.15963">https://doi.org/10.1119/1.15963</a> 
</p>
<p>Reed, B.C. (1992) &quot;Linear least-squares fits with errors in both coordinates. II: Comments on parameter variances&quot;, American Journal of Physics, 60, 59. <a href="https://doi.org/10.1119/1.17044">https://doi.org/10.1119/1.17044</a>
</p>
<p>Ripley and Thompson (1987) &quot;Regression techniques for the detection of analytical bias&quot;, Analysts, 4. <a href="https://doi.org/10.1039/AN9871200377">https://doi.org/10.1039/AN9871200377</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example ISO 28037 Section 7
X.i&lt;- c(1.2, 1.9, 2.9, 4.0, 4.7, 5.9)
Y.i&lt;- c(3.4, 4.4, 7.2, 8.5, 10.8, 13.5)
sd.X.i&lt;- c(0.2, 0.2, 0.2, 0.2, 0.2, 0.2)
sd.Y.i&lt;- c(0.2, 0.2, 0.2, 0.4, 0.4, 0.4)

# values obtained on sep-26, 2016
dwlm.res &lt;- dwlm(X.i, Y.i, 1/sd.X.i^2, 1/sd.Y.i^2, 
	from = 0, to=3, coef.H0=c(0, 2), tol = 1e-10)
dwlm.res$coefficients
dwlm.res$cov.mle[1, 2]
dwlm.res$curr.tol
dwlm.res$curr.iter
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
