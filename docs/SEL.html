<!DOCTYPE html><html><head><title>Help for package SEL</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SEL}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#comparePlot'><p> Compare different elicitated densities.</p></a></li>
<li><a href='#fit.SEL'><p> Fit an SEL object</p></a></li>
<li><a href='#getbinPost'><p> Calculate posterior distribution for binomial model</p></a></li>
<li><a href='#knotave'><p> Calculate the knot averages of a B-spline basis.</p></a></li>
<li><a href='#min_abs'><p> Find gamma given Delta</p></a></li>
<li><a href='#plot.SEL'><p> Plotting an SEL object</p></a></li>
<li><a href='#predict.SEL'><p> Evaluate the expert's density (or cdf)</p></a></li>
<li><a href='#quantSEL'><p> Calculate quantiles of an SEL object.</p></a></li>
<li><a href='#rvSEL'><p> Simulate from the expert's distribution</p></a></li>
<li><a href='#SEL'><p> Semiparametric Elicitation of a bounded parameter</p></a></li>
<li><a href='#SEL-internal'><p>SEL internal functions</p></a></li>
<li><a href='#SEL-package'>
<p>Semiparametric Elicitation of a bounded parameter.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Semiparametric Elicitation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-25</td>
</tr>
<tr>
<td>Depends:</td>
<td>splines, quadprog, lattice</td>
</tr>
<tr>
<td>Author:</td>
<td>Bjoern Bornkamp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bjoern Bornkamp &lt;bbnkmp@mail.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements a method for fitting a bounded probability
        distribution to quantiles (for example stated by an expert),
        see Bornkamp and Ickstadt (2009) for details.  For this
        purpose B-splines are used, and the density is obtained by
        penalized least squares based on a Brier entropy penalty.  The
        package provides methods for fitting the distribution as well
        as methods for evaluating the underlying density and cdf. In
        addition methods for plotting the distribution, drawing random
        numbers and calculating quantiles of the obtained distribution
        are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-25 15:24:52 UTC; bjoern</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-25 15:50:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
</table>
<hr>
<h2 id='comparePlot'> Compare different elicitated densities. </h2><span id='topic+comparePlot'></span>

<h3>Description</h3>

<p>Compare different elicitated distributions in a trellis display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparePlot(..., type = c("density", "cdf"), deriv,
            points = TRUE, superpose = FALSE, n = 101,
            xlab= "", ylab, addArgs = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparePlot_+3A_...">...</code></td>
<td>
<p> Fitted SEL objects separated by a comma. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_type">type</code></td>
<td>
<p> Determines whether to plot densities or cdfs (ignored if <code>deriv</code>
is not missing). </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_deriv">deriv</code></td>
<td>
<p> Specify derivative of the expert's density to be
plotted. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_points">points</code></td>
<td>
<p> Logical indicating whether elicited quantiles
should be displayed, when displaying the cdf. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_superpose">superpose</code></td>
<td>
<p> Logical indicate if plots should be superposed. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_n">n</code></td>
<td>
<p> Integer, number of points used for plotting. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_xlab">xlab</code>, <code id="comparePlot_+3A_ylab">ylab</code></td>
<td>
<p> Labels for x-axis and y-axis. If <code>ylab</code>
is missing the value of <code>type</code> is used. </p>
</td></tr>
<tr><td><code id="comparePlot_+3A_addargs">addArgs</code></td>
<td>
<p>List specifying additional arguments for
<code>xyplot</code> function, list elements should match the
corresponding arguments of the <code>xyplot</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code>, <code><a href="#topic+plot.SEL">plot.SEL</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># example from O'Hagan et al. (2006)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)

default   &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
bernst    &lt;- SEL(x, y, d = 10, N = 0, Delta = 0.05, bounds = c(165, 250))
unifknots &lt;- SEL(x, y, d = 3, N = 5, Delta = 0.05, bounds = c(165, 250))
lin       &lt;- SEL(x, y, d = 1, inknts = x, Delta = 0.05, bounds = c(165, 250))
comparePlot(default, bernst, unifknots, lin, type = "cdf")
comparePlot(default, bernst, unifknots, lin, type = "density")
</code></pre>

<hr>
<h2 id='fit.SEL'> Fit an SEL object </h2><span id='topic+fit.SEL'></span>

<h3>Description</h3>

<p>Function that performs the actual fitting of the expert's distribution
via quadratic programming (using the <code><a href="quadprog.html#topic+solve.QP">solve.QP</a></code> function
from the <code>quadprog</code> package). This function is mainly for
internal use.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.SEL(N, alpha, P, A, b, gamma, dplus = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.SEL_+3A_n">N</code></td>
<td>
<p> Matrix containing the B-spline basis functions evaluated at
the elicited quantiles. </p>
</td></tr>
<tr><td><code id="fit.SEL_+3A_alpha">alpha</code></td>
<td>
<p> Vector giving the levels of the elicited quantiles. </p>
</td></tr>
<tr><td><code id="fit.SEL_+3A_p">P</code></td>
<td>
<p> Penalty matrix (called Omega in the reference below). </p>
</td></tr>
<tr><td><code id="fit.SEL_+3A_a">A</code>, <code id="fit.SEL_+3A_b">b</code></td>
<td>
<p> Matrix and vector containing the specifying the constraints A'b &gt;= 0. </p>
</td></tr>
<tr><td><code id="fit.SEL_+3A_gamma">gamma</code></td>
<td>
<p> Gamma parameter trading of goodness of fit and
Brier entropy/Brier divergence. </p>
</td></tr>
<tr><td><code id="fit.SEL_+3A_dplus">dplus</code></td>
<td>
<p> Additional offset for dvec in <code>solve.QP</code>. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns solution of the quadratic programming problem.
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>,
<b>63</b>, 373&ndash;377
</p>
<p>Goldfarb, D., and Idnani, A. (1982), Dual
and Primal-Dual Methods for Solving Strictly Convex Quadratic
Programs, in <em> Numerical Analysis</em>, (eds.) J. Hennart,
Springer Verlag, Berlin, pp. 226&ndash;239.
</p>
<p>Goldfarb, D., and Idnani, A. (1983), A
Numerically Stable Dual Method for Solving Strictly Convex Quadratic
Programs&rdquo;, <em>Mathematical Programming</em>, 27, 1&ndash;33.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code>, <code><a href="quadprog.html#topic+solve.QP">solve.QP</a></code> </p>

<hr>
<h2 id='getbinPost'> Calculate posterior distribution for binomial model </h2><span id='topic+getbinPost'></span>

<h3>Description</h3>

<p>Calculate posterior distribution for the simple beta-binomial model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  getbinPost(x, object, k, n, type = c("density", "cdf"),
             rel.tol = .Machine$double.eps^0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getbinPost_+3A_x">x</code></td>
<td>
<p> Vector specifying, where posterior distribution should be evaluated. </p>
</td></tr>
<tr><td><code id="getbinPost_+3A_object">object</code></td>
<td>
<p> An SEL object. </p>
</td></tr>
<tr><td><code id="getbinPost_+3A_k">k</code></td>
<td>
<p> Number of observed successes in the binomial model. </p>
</td></tr>
<tr><td><code id="getbinPost_+3A_n">n</code></td>
<td>
<p> Number of total trials. </p>
</td></tr>
<tr><td><code id="getbinPost_+3A_type">type</code></td>
<td>
<p> Character specifying, whether posterior density or cdf
should be evaluated. </p>
</td></tr>
<tr><td><code id="getbinPost_+3A_rel.tol">rel.tol</code></td>
<td>
 <p><code>rel.tol</code> argument of the integrate subroutine,
which numerically calculates the normalization constant, when a
non-conjugate prior is used (ie a B-spline basis not leading to a
Bernstein mixture).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric containing the function values corresponding to x values
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>,
<b>63</b>, 373&ndash;377
</p>
<p>Diaconis, P., and Ylvisaker, D. (1985),
Quantifying Prior Opinion, <em>Bayesian Statistics 2</em>,
(eds.) J.M. Bernardo, M.H. DeGroot, D.V. Lindley and A.F.M. Smith,
Elsevier Science Publishers B.V., Amsterdam, pp. 133&ndash;156.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Diaconis, Ylvisaker spun coin example (see references)
## simulate elicitations
x &lt;- seq(0, 1, length=9)[2:8]
ymu &lt;- 0.5*pbeta(x, 10, 20)+0.5*pbeta(x, 20, 10)
sig &lt;- 0.05
set.seed(4)
y &lt;- ymu+rnorm(7, 0, sqrt(ymu*(1-ymu))*sig)

## perform fitting with different selections
A &lt;- SEL(x, y, d = 1, Delta = 0.001, inknts = x)
foo1 &lt;- function(x) dbeta(x, 0.5, 0.5)
B &lt;- SEL(x, y, d = 19, N=0, Delta = 0.02, pistar = foo1)
C &lt;- SEL(x, y, d = 19, N=0, Delta = 0.05, pistar = foo1)
comparePlot(A, B, C, addArgs = list(layout = c(3,1)))

## posterior
sq &lt;- seq(0,1,length=201)
res1 &lt;- getbinPost(sq, A, 3, 10, type = "density")
res2 &lt;- getbinPost(sq, B, 3, 10, type = "density")
res3 &lt;- getbinPost(sq, C, 3, 10, type = "density")

## parametric posterior (corresponding to B(0.5,0.5) prior)
plot(sq, dbeta(sq, 3.5, 7.5), type="l", xlab = "",
     ylab = "Posterior density", lty = 4,
     ylim=c(0,max(c(res1, res2, res3))))
## "semiparametric" posteriors
lines(sq, res1, lty = 1)
lines(sq, res2, lty = 2)
lines(sq, res3, lty = 3)
legend(0.65,4, legend=c("Scenario A", "Scenario B", "Scenario C",
       "B(0.5,0.5) prior"), lty = 1:4)
</code></pre>

<hr>
<h2 id='knotave'> Calculate the knot averages of a B-spline basis. </h2><span id='topic+knotave'></span>

<h3>Description</h3>

<p>Calculates the knot averages of a B-spline basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  knotave(knots, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knotave_+3A_knots">knots</code></td>
<td>
<p> Knot Vector (with d+1 coincident knots on the boundaries). </p>
</td></tr>
<tr><td><code id="knotave_+3A_d">d</code></td>
<td>
<p> Degree of the B-spline basis. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric containing knot averages
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>,
<b>63</b>, 373&ndash;377
</p>
<p>Dierckx, P. (1993), <em>Curve and Surface
Fitting with Splines</em>, Clarendon Press
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example for calculation of a control polygon
knts &lt;- c(rep(0, 4), rep(1, 4))
cf &lt;- c(-1, -1, 1/2, 0)
sq &lt;- seq(0, 1, length = 101)
N &lt;- splineDesign(sq, knots = knts, ord = 4)
res &lt;- colSums(t(N)*cf)
plot(sq, res, type = "l", ylim = c(-1, 0.6))
kntAv &lt;- knotave(knts, 3)
lines(kntAv, cf, col = "red") # add control polygon
</code></pre>

<hr>
<h2 id='min_abs'> Find gamma given Delta </h2><span id='topic+min_abs'></span>

<h3>Description</h3>

<p>Find gamma so that squareroot of average squared distance of fitted
distribution and statements is equal to <code>Delta</code> (using the
<code>uniroot</code> function). This function is
not meant to be called by the user, unless one is familiar with the
source code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  min_abs(Delta, N, alpha, P, A, b, lb, ub, dplus = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min_abs_+3A_delta">Delta</code></td>
<td>
<p> Average root of squared error to be achieved with fitted distribution. </p>
</td></tr>
<tr><td><code id="min_abs_+3A_n">N</code></td>
<td>
<p> Matrix containing the B-spline basis functions evaluated at
the elicited quantiles. </p>
</td></tr>
<tr><td><code id="min_abs_+3A_alpha">alpha</code></td>
<td>
<p> Vector giving the levels of the elicited quantiles. </p>
</td></tr>
<tr><td><code id="min_abs_+3A_p">P</code></td>
<td>
<p> Penalty matrix (called Omega in reference below). </p>
</td></tr>
<tr><td><code id="min_abs_+3A_a">A</code>, <code id="min_abs_+3A_b">b</code></td>
<td>
<p> Matrix and vector containing the specifying the constraints A'b &gt;= 0. </p>
</td></tr>
<tr><td><code id="min_abs_+3A_lb">lb</code>, <code id="min_abs_+3A_ub">ub</code></td>
<td>
<p> lower and upper bound to search for gamma. </p>
</td></tr>
<tr><td><code id="min_abs_+3A_dplus">dplus</code></td>
<td>
<p>offset integral needed when divergence instead of entropy
is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns gamma
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="stats.html#topic+uniroot">uniroot</a></code>, <code><a href="quadprog.html#topic+solve.QP">solve.QP</a></code> </p>

<hr>
<h2 id='plot.SEL'> Plotting an SEL object </h2><span id='topic+plot.SEL'></span>

<h3>Description</h3>

<p>This function displays a fitted SEL object and displays the
expert's cdf or pdf (depending on the <code>deriv</code> argument)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SEL'
plot(x, ..., type = c("density", "cdf"), deriv,
      points = TRUE, n = 101, xlab="", ylab="", ylim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SEL_+3A_x">x</code></td>
<td>
<p> An SEL object. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_...">...</code></td>
<td>
<p> Additional arguments to plot function. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_type">type</code></td>
<td>
<p> Determines whether to plot the expert's density or cdf
(only if <code>deriv</code> is missing). </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_deriv">deriv</code></td>
<td>
<p> Determines which derivative of the expert's
distribution should be plotted. If specified
the <code>type</code> argument is ignored. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_points">points</code></td>
<td>
<p> Logical indicating whether elicited quantiles
should be displayed, when displaying the cdf. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_n">n</code></td>
<td>
<p> Integer, number of points used for plotting. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_xlab">xlab</code>, <code id="plot.SEL_+3A_ylab">ylab</code></td>
<td>
<p> Label of x-axis and y-axis. </p>
</td></tr>
<tr><td><code id="plot.SEL_+3A_ylim">ylim</code></td>
<td>
<p> Limits of y axis. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+comparePlot">comparePlot</a></code>, <code><a href="#topic+SEL">SEL</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># example from O'Hagan et al. (2006)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)

fit &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
plot(fit)
plot(fit, type = "cdf")
plot(fit, deriv = 1)
</code></pre>

<hr>
<h2 id='predict.SEL'> Evaluate the expert's density (or cdf) </h2><span id='topic+predict.SEL'></span>

<h3>Description</h3>

<p>Evaluate the density or cdf of an SEL object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SEL'
predict(object, newdata = seq(object$bounds[1],
      object$bounds[2], length = 101), type = c("density", "cdf"), deriv, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.SEL_+3A_object">object</code></td>
<td>
<p> An SEL object. </p>
</td></tr>
<tr><td><code id="predict.SEL_+3A_newdata">newdata</code></td>
<td>
<p> Where to evaluate the distribution. </p>
</td></tr>
<tr><td><code id="predict.SEL_+3A_type">type</code></td>
<td>
<p> Determines whether to evaluate the expert's density or cdf
(only if <code>deriv</code> is missing). </p>
</td></tr>
<tr><td><code id="predict.SEL_+3A_deriv">deriv</code></td>
<td>
<p> Determines which derivative of the expert's
distribution should be evaluated. </p>
</td></tr>
<tr><td><code id="predict.SEL_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># example from O'Hagan et al. (2006)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)

default   &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
predict(default, newdata = c(200, 205))
</code></pre>

<hr>
<h2 id='quantSEL'> Calculate quantiles of an SEL object. </h2><span id='topic+quantSEL'></span>

<h3>Description</h3>

<p>Returns the quantiles of the fitted distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantSEL(q, object, nPoints = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantSEL_+3A_q">q</code></td>
<td>
<p> A vector of quantiles. </p>
</td></tr>
<tr><td><code id="quantSEL_+3A_object">object</code></td>
<td>
<p> An SEL object. </p>
</td></tr>
<tr><td><code id="quantSEL_+3A_npoints">nPoints</code></td>
<td>
<p> Number of evaluations for the brute
force inversion of the expert cdf (see details). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inverse of the distribution function is formed by evaluating
the distribution function at nPoints points and interchanging the
role of dependent and independent variable when building a function
interpolating the data (using <code>splinefun</code> with <code>"monoH.FC"</code>
option). Note that there are also direct ways of inverting a B-spline
function, which however turned out to be less efficient for our purposes.
</p>


<h3>Value</h3>

<p>A vector of quantiles.
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code>, <code><a href="stats.html#topic+splinefun">splinefun</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## example from O'Hagan et al. (2006)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)

default   &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
bernst    &lt;- SEL(x, y, d = 10, N = 0, Delta = 0.05, bounds = c(165, 250))
unifknots &lt;- SEL(x, y, d = 3, N = 5, Delta = 0.05, bounds = c(165, 250))
lin       &lt;- SEL(x, y, d = 1, inknts = x, Delta = 0.05, bounds = c(165,250))
quantSEL(c(0.25, 0.5, 0.75), default)
quantSEL(c(0.25, 0.5, 0.75), bernst)
quantSEL(c(0.25, 0.5, 0.75), unifknots)
quantSEL(c(0.25, 0.5, 0.75), lin)
</code></pre>

<hr>
<h2 id='rvSEL'> Simulate from the expert's distribution </h2><span id='topic+rvSEL'></span>

<h3>Description</h3>

<p>Simulate random variables from an SEL object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rvSEL(n, object, nPoints = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rvSEL_+3A_n">n</code></td>
<td>
<p> Number of simulated values. </p>
</td></tr>
<tr><td><code id="rvSEL_+3A_object">object</code></td>
<td>
<p> An SEL object. </p>
</td></tr>
<tr><td><code id="rvSEL_+3A_npoints">nPoints</code></td>
<td>
<p> Number of evaluations for the brute
force inversion of the expert cdf. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The inverse of the distribution function is formed by evaluating
the distribution function at nPoints points and interchanging the
role of dependent and independent variable when building an function
interpolating the data (using <code>splinefun</code> with <code>"monoH.FC"</code>
option). Note that there are also direct ways of inverting a B-spline
function, which however turned out to be less efficient for our purposes.
</p>


<h3>Value</h3>

<p>A numeric vector containing pseudo-random variates from the
expert's density. 
</p>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>, <b>63</b>, 373&ndash;377
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+SEL">SEL</a></code>, <code><a href="stats.html#topic+splinefun">splinefun</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>## bimodal example 
x2 &lt;- c(0.1, 0.2, 0.5, 0.8, 0.9)
y2 &lt;- c(0.2, 0.4, 0.45, 0.85, 0.99)

fit1 &lt;- SEL(x2, y2, Delta=0.05, d = 4, inknts = x2)
fit2 &lt;- SEL(x2, y2, Delta=0.05, d = 15, N = 0)
comparePlot(fit1, fit2, superpose = TRUE)

## sample from SEL object
xxx &lt;- rvSEL(50000, fit1)
hist(xxx, breaks=100, freq=FALSE)
curve(predict(fit1, newdata=x), add=TRUE)
</code></pre>

<hr>
<h2 id='SEL'> Semiparametric Elicitation of a bounded parameter </h2><span id='topic+SEL'></span>

<h3>Description</h3>

<p>Fits a distribution to quantiles (stated for example by an expert)
using B-splines with a Brier entropy penalty.
</p>
<p>There exists a <code>print</code> and a <code>summary</code> method to display
details of the fitted SEL object. The fitted density (or cdf) can be
displayed with the <code><a href="#topic+plot.SEL">plot</a></code> method.  Different
SEL objects can be displayed in one plot with the
<code><a href="#topic+comparePlot">comparePlot</a></code> function. The fitted density (or cdf) can be
evaluated with the <code><a href="#topic+predict.SEL">predict</a></code> method. The
<code>coef</code> method extracts the coefficients of the fitted B-spline
basis. The <code><a href="#topic+quantSEL">quantSEL</a></code> function calculates quantiles of the
fitted distribution and the <code><a href="#topic+rvSEL">rvSEL</a></code> function generates
random variables from a fitted SEL object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SEL(x, alpha, bounds = c(0, 1), d = 4, inknts = x, N, gamma, Delta,
      fitbnds = c(1e-8, 10)*diff(bounds), pistar = NULL,
      constr = c("none", "unimodal", "decreasing", "increasing"),
      mode)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SEL_+3A_x">x</code></td>
<td>
<p> Numeric vector of quantiles. </p>
</td></tr>
<tr><td><code id="SEL_+3A_alpha">alpha</code></td>
<td>
<p> Numeric vector determining the levels of the quantiles
specified in <code>x</code>.</p>
</td></tr>
<tr><td><code id="SEL_+3A_bounds">bounds</code></td>
<td>
<p> Vector containing the bounds for the expert's density. </p>
</td></tr>
<tr><td><code id="SEL_+3A_n">N</code></td>
<td>
<p> Number of equally spaced inner knots (ignored if
<code>inknts</code> is specified). </p>
</td></tr>
<tr><td><code id="SEL_+3A_d">d</code></td>
<td>
<p> Degree of the spline (the order of the spline is d+1),
values larger than 20 are to be avoided; they can
lead to numerical instabilities. </p>
</td></tr>
<tr><td><code id="SEL_+3A_inknts">inknts</code></td>
<td>
<p> Vector specifying the inner knots. If equal to
<code>NULL</code>, the B-spline basis reduces to the Bernstein polynomial
basis. Per default the inner knots are located on the values
specified via <code>x</code>.
</p>
</td></tr>
<tr><td><code id="SEL_+3A_gamma">gamma</code></td>
<td>
<p> Parameter controlling the weight of the negative
entropy in the objective function to be optimized (see Bornkamp and
Ickstadt (2009)). </p>
</td></tr>
<tr><td><code id="SEL_+3A_delta">Delta</code></td>
<td>
<p> The code calculates the <code>gamma</code> parameter achieving a
certain overall L2 distance between the specified quantiles and the fitted
distribution function (only if <code>gamma</code> is not specified). </p>
</td></tr>
<tr><td><code id="SEL_+3A_fitbnds">fitbnds</code></td>
<td>
<p> Numeric of length 2 for the bisection search algorithm
searching for gamma giving the error Delta (only relevant if gamma is
missing).</p>
</td></tr>
<tr><td><code id="SEL_+3A_pistar">pistar</code></td>
<td>
<p> Prior density function used in Brier
divergence (see Bornkamp and
Ickstadt (2009). If <code>NULL</code> Brier entropy is used. </p>
</td></tr>
<tr><td><code id="SEL_+3A_constr">constr</code></td>
<td>
<p> Character vector specifying, which shape constraint should
be used, should be one of &quot;none&quot;, &quot;unimodal&quot;, &quot;decreasing&quot;,
&quot;increasing&quot;.</p>
</td></tr>
<tr><td><code id="SEL_+3A_mode">mode</code></td>
<td>
<p> Numerical value needed when <code>constraint =
       "unimodal"</code>. The code selects the knot average closest
to <code>mode</code> as the location of the mode for the finite
dimensional constraints on the coefficients of the B-spline
in the optimization (note that the final
density will only have a mode close to the value specified via <code>mode</code>). </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An SEL object containing the following entries
</p>
<table>
<tr><td><code>constr</code></td>
<td>
<p>Character determining the shape constraint used.</p>
</td></tr>
<tr><td><code>inknts</code></td>
<td>
<p>Inner knots.</p>
</td></tr>
<tr><td><code>nord</code></td>
<td>
<p>Order of the spline.</p>
</td></tr>
<tr><td><code>bounds</code></td>
<td>
<p>Bounds for the elicited quantity.</p>
</td></tr>
<tr><td><code>xalpha</code></td>
<td>
<p>List containing the specified quantiles.</p>
</td></tr>
<tr><td><code>Omega</code></td>
<td>
<p>Penalty matrix used for calculating Brier entropy.</p>
</td></tr>
<tr><td><code>coefs</code></td>
<td>
<p>Fitted coefficients of the B-spline basis.</p>
</td></tr>
<tr><td><code>pistar</code></td>
<td>
<p>Function handed over to <code>SEL</code> via the
<code>pistar</code> argument (if any).</p>
</td></tr>
<tr><td><code>dplus</code></td>
<td>
<p>The d vector, only necessary when pistar is specified
(see Bornkamp and Ickstadt (2009).)
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Bjoern Bornkamp </p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>,
<b>63</b>, 373&ndash;377
</p>
<p>O'Hagan A., Buck C. E., Daneshkhah, A., Eiser, R., Garthwaite,
P., Jenkinson, D., Oakley, J. and Rakow, T. (2006), <em>Uncertain
Judgements: Eliciting Expert Probabilities</em>, John Wiley and Sons Inc.
</p>
<p>Dierckx, P. (1993), <em>Curve and Surface
Fitting with Splines</em>, Clarendon Press
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+plot.SEL">plot.SEL</a></code>, <code><a href="#topic+comparePlot">comparePlot</a></code>, <code><a href="#topic+quantSEL">quantSEL</a></code>, <code><a href="#topic+rvSEL">rvSEL</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>### example from O'Hagan et al. (2006)
### 1st example in Bornkamp and Ickstadt (2009)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)
I &lt;- SEL(x, y, d = 1, Delta = 0.015, bounds = c(165, 250), inknts = x)
II &lt;- SEL(x, y, d = 14, N = 0, Delta = 0.015, bounds = c(165, 250))
III &lt;- SEL(x, y, d = 4, Delta = 0.015, bounds = c(165, 250), inknts = x)
IV &lt;- SEL(x, y, d = 4, Delta = 0.015, bounds = c(165, 250), inknts = x,
      constr = "u", mode = 185)
comparePlot(I, II, III, IV, type = "cdf")
comparePlot(I, II, III, IV, type = "density")



### bimodal example 
x2 &lt;- c(0.1, 0.2, 0.5, 0.8, 0.9)
y2 &lt;- c(0.2, 0.4, 0.45, 0.85, 0.99)
fit1 &lt;- SEL(x2, y2, Delta=0.05, d = 4, inknts = x2)
fit2 &lt;- SEL(x2, y2, Delta=0.05, d = 15, N = 0)
comparePlot(fit1, fit2, superpose = TRUE)



### sample from SEL object and evaluate density
xxx &lt;- rvSEL(50000, fit1)
hist(xxx, breaks=100, freq=FALSE)
curve(predict(fit1, newdata=x), add=TRUE)



### illustrate shrinkage against uniform dist.
gma01 &lt;- SEL(x2, y2, gamma = 0.1)
gma02 &lt;- SEL(x2, y2, gamma = 0.2)
gma04 &lt;- SEL(x2, y2, gamma = 0.4)
gma10 &lt;- SEL(x2, y2, gamma = 1.0)
comparePlot(gma01, gma02, gma04, gma10, superpose = TRUE)



### including shape constraints
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)
unconstr1 &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
unconstr2 &lt;- SEL(x, y, d = 10, N = 0, Delta = 0.05, bounds = c(165,250))
unimod1 &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250),
            constr = "unimodal", mode = 185)
unimod2 &lt;- SEL(x, y, d = 10, N = 0, Delta = 0.05, bounds = c(165, 250),
           constr =  "unimodal", mode = 185)
comparePlot(unconstr1, unconstr2, unimod1, unimod2)



### shrinkage against another distribution
pr &lt;- function(x) dbeta(x, 2, 2)
pr01  &lt;- SEL(x2, y2, gamma = 0.1, d = 3, pistar = pr)
pr03  &lt;- SEL(x2, y2, gamma = 0.3, d = 3, pistar = pr)
pr12 &lt;- SEL(x2, y2, gamma = 1.2, pistar = pr)
comparePlot(pr01, pr03, pr12, superpose = TRUE)



### 2nd example from Bornkamp and Ickstadt (2009)
# theta
# "true" density
pmixbeta &lt;- function(x, a1, b1, a2, b2){
  0.3*pbeta(x/20,a1,b1)+0.7*pbeta(x/20,a2,b2)
}
dmixbeta &lt;- function(x, a1, b1, a2, b2){
  out &lt;- 0.3*dbeta(x/20,a1,b1)+0.7*dbeta(x/20,a2,b2)
  out/20
}
x &lt;- c(2,10,15)
a1 &lt;- 1;a2 &lt;- 10;b1 &lt;- 15;b2 &lt;- 5
mu &lt;- pmixbeta(x, a1, b1, a2, b2)
set.seed(1) # simulate experts statements
y &lt;- rnorm(length(mu), mu, sqrt(mu*(1-mu)*0.05^2))
thet &lt;- SEL(x, y, d = 4, Delta = 0.03, bounds = c(0, 20), inknts = x)
plot(thet, ylim = c(0,0.25))
curve(dmixbeta(x, a1, b1, a2, b2), add=TRUE, col="red")
abline(h=0.05, lty = 2)
legend("topright", c("true density", "elicited density", "uniform density"), 
       col=c(2,1,1), lty=c(1,1,2))

# sigma
# "true" density
dtriang &lt;- function(x,m,a,b){
  inds &lt;- x &lt; m;res &lt;- numeric(length(x))
  res[inds] &lt;- 2*(x[inds]-a)/((b-a)*(m-a))
  res[!inds] &lt;- 2*(b-x[!inds])/((b-a)*(b-m))
  res
}
ptriang &lt;- function(x,m,a,b){
  inds &lt;- x &lt; m;res &lt;- numeric(length(x))
  res[inds] &lt;- (x[inds]-a)^2/((b-a)*(m-a))
  res[!inds] &lt;- 1-(b-x[!inds])^2/((b-a)*(b-m))
  res
}
x &lt;- c(1,2,4)
mu &lt;- ptriang(x, 1, 0, 5)
set.seed(1) # simulate experts statements
y &lt;- rnorm(length(mu), mu, sqrt(mu*(1-mu)*0.05^2))
sig &lt;- SEL(x, y, d = 4, Delta = 0.03, bounds = c(0, 5),
       inknts = x, mode = 1, constr="unimodal")
plot(sig, ylim=c(0,0.4))
curve(dtriang(x, 1, 0, 5), add=TRUE, col="red")
abline(h=0.2, lty = 2)
legend("topright", c("true density", "elicited density", "uniform density"), 
       col=c(2,1,1), lty=c(1,1,2))


## Not run: 
### generate some random elicitations
numb &lt;- max(rnbinom(1, mu = 4, size = 1), 1)
x0 &lt;- runif(1, -1000, 1000)
x1 &lt;- x0+runif(1, 0, 1000)
xs &lt;- sort(runif(numb, x0, x1))
y &lt;- runif(numb+1)
ys &lt;- (cumsum(y)/sum(y))[1:numb]
fit1 &lt;- SEL(xs, ys, bounds = c(x0, x1))
fit2 &lt;- SEL(xs, ys, d = 1, inknts = xs, bounds = c(x0, x1))
fit3 &lt;- SEL(xs, ys, d = 15, N = 0, bounds = c(x0, x1))
comparePlot(fit1, fit2, fit3, type="cdf")

## End(Not run)
</code></pre>

<hr>
<h2 id='SEL-internal'>SEL internal functions</h2><span id='topic+get.Ab'></span><span id='topic+get.PmatBern'></span><span id='topic+get.PmatBS'></span><span id='topic+int.funct'></span><span id='topic+itgrl'></span><span id='topic+prod.Bspline'></span><span id='topic+zero'></span><span id='topic+print.SEL'></span><span id='topic+print.summary.SEL'></span><span id='topic+summary.SEL'></span><span id='topic+coef.SEL'></span>

<h3>Description</h3>

<p>These functions are not meant to be called by the user.
</p>

<hr>
<h2 id='SEL-package'>
Semiparametric Elicitation of a bounded parameter.
</h2><span id='topic+SEL-package'></span>

<h3>Description</h3>

<p>This package implements a novel method for fitting a bounded probability
distribution to quantiles stated for example by an expert (see Bornkamp
and Ickstadt (2009)).  For this purpose B-splines are used, and the
density is obtained by penalized least squares based on a Brier entropy
penalty.  The package provides methods for fitting the distribution as
well as methods for evaluating the underlying density and cdf. In
addition methods for plotting the distribution, drawing random numbers
and calculating quantiles of the obtained distribution are provided.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> SEL</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2010-05-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Bjoern Bornkamp
</p>
<p>Maintainer: Bjoern Bornkamp &lt;bornkamp@statistik.tu-dortmund.de&gt;
</p>


<h3>References</h3>

 
<p>Bornkamp, B. and Ickstadt, K. (2009). A Note on B-Splines for
Semiparametric Elicitation. <em>The American Statistician</em>,
<b>63</b>, 373&ndash;377
</p>
<p>O'Hagan A., Buck C. E., Daneshkhah, A., Eiser, R., Garthwaite,
P., Jenkinson, D., Oakley, J. and Rakow, T. (2006), <em>Uncertain
Judgements: Eliciting Expert Probabilities</em>, John Wiley and Sons Inc.
</p>
<p>Garthwaite, P., Kadane, J. O'Hagan, A. (2005), Statistical
Methods for Eliciting Probability Distributions,
<em>Journal of the American Statistical Association</em>,
<b>100</b>, 680&ndash;701
</p>
<p>Dierckx, P. (1993), <em>Curve and Surface
Fitting with Splines</em>, Clarendon Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## example from O'Hagan et al. (2006)
x &lt;- c(177.5, 183.75, 190, 205, 220)
y &lt;- c(0.175, 0.33, 0.5, 0.75, 0.95)

default   &lt;- SEL(x, y, Delta = 0.05, bounds = c(165, 250))
bernst    &lt;- SEL(x, y, d = 10, N = 0, Delta = 0.05, bounds = c(165, 250))
unifknots &lt;- SEL(x, y, d = 3, N = 5, Delta = 0.05, bounds = c(165, 250))
lin       &lt;- SEL(x, y, d = 1, inknts = x, Delta = 0.05, bounds = c(165, 250))
comparePlot(default, bernst, unifknots, lin, type = "cdf")
comparePlot(default, bernst, unifknots, lin, type = "density")

## compare summaries
summary(default)
summary(bernst)
summary(unifknots)
summary(lin)

## sample from SEL object and evaluate density
xxx &lt;- rvSEL(50000, bernst)
hist(xxx, breaks=100, freq=FALSE)
curve(predict(bernst, newdata=x), add=TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
