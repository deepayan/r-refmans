<!DOCTYPE html><html><head><title>Help for package LRcontrast</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LRcontrast}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#LRcontrast-package'>
<p>Dose Response Signal Detection under Model Uncertainty</p></a></li>
<li><a href='#pLRcontrast'>
<p>Simulate p-values for LR contrast tests in regression models with a lack of identifiability.</p></a></li>
<li><a href='#qLRcontrast'>
<p>Simulate quantiles of LR contrast tests in regression models with a lack of identifiability.</p></a></li>
<li><a href='#sLRcontrast'>
<p>Calculate LR test statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dose Response Signal Detection under Model Uncertainty</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-11-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Kevin Kokot</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>DoseFinding</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kevin Kokot &lt;kevin.kokot@ruhr-uni-bochum.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for calculating test statistics, simulating quantiles 
	and simulating p-values of likelihood ratio contrast tests in regression models 
	with a lack of identifiability.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-11-06 17:11:35 UTC; Kevin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-11-07 00:19:46</td>
</tr>
</table>
<hr>
<h2 id='LRcontrast-package'>
Dose Response Signal Detection under Model Uncertainty
</h2><span id='topic+LRcontrast-package'></span><span id='topic+LRcontrast'></span>

<h3>Description</h3>

<p>Provides functions for calculating test statistics, simulating quantiles 
and simulating p-values of likelihood ratio contrast tests in regression 
models with a lack of identifiability.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> LRcontrast</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-06-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The main functions are: <br />
<b>qLRcontrast</b>: Simulates quantiles of likelihood ratio contrast tests <br />
<b>sLRcontrast</b>: Calculates test statistics of likelihood ratio contrast tests <br />
<b>pLRcontrast</b>: Simulates p-values of likelihood ratio contrast tests
</p>


<h3>Author(s)</h3>

<p>Kevin Kokot
</p>
<p>Maintainer: Kevin Kokot &lt;kevin.kokot@ruhr-uni-bochum.de&gt;
</p>


<h3>References</h3>

<p>Dette, H., Titoff, S., Volgushev, S. and Bretz, F. (2015), Dose
response signal detection under model uncertainty. Biometrics. doi:
10.1111/biom.12357
</p>


<h3>See Also</h3>

<p><code><a href="DoseFinding.html#topic+DoseFinding-package">DoseFinding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate the 90%, 95% and 99% quantiles of the LR contrast tests where the specified 
# models are competing against each other.
# The size of each dose group is equal in this case.

qLRcontrast(dose = c(0, 0.05, 0.2, 0.6, 1), probs = c(0.9, 0.95, 0.99), weight 
            = c(0.2, 0.2, 0.2, 0.2, 0.2), models = c("linear", "emax", 
            "exponential", "linlog"), nsim = 10)

# Calculate the LR test statistics with the same underlying models.
# In this case the data is generated by the constant model, i.e. the 
# null hypothesis of no dose response is true.

resp &lt;- rnorm(n = 50, mean = 0.2)
dose &lt;- c(rep(0, 10), rep(0.05, 10), rep(0.2, 10), rep(0.6, 10), rep(1, 10))

sLRcontrast(dose = dose, resp = resp, models = c("linear", "emax", "exponential", "linlog"))
			 
# Calculate the p-values in this scenario
			 
pLRcontrast(dose = dose, resp = resp, models = c("linear", "emax", "exponential", "linlog"), 
            nsim = 10)
</code></pre>

<hr>
<h2 id='pLRcontrast'>
Simulate p-values for LR contrast tests in regression models with a lack of identifiability.
</h2><span id='topic+pLRcontrast'></span>

<h3>Description</h3>

<p>The function simulates p-values for LR contrast tests. The competing models can be specified by the argument 'models' 
(see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>) and by 'nsim' you can specify how many simulations should be done. It is 
recommended to do about 10000 but notice that the simulation can take some time. If the parameter 'info' is set 
'TRUE', information of the progress will be shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pLRcontrast(dose, resp, models, off = 0.01 * max(dose), scal = 1.2 * max(dose), 
            nsim = 1000, info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pLRcontrast_+3A_dose">dose</code>, <code id="pLRcontrast_+3A_resp">resp</code></td>
<td>

<p>Vectors of equal length specifying dose and response values.
</p>
</td></tr>
<tr><td><code id="pLRcontrast_+3A_models">models</code></td>
<td>

<p>A subvector of c(&quot;linear&quot;, &quot;emax&quot;, &quot;exponential&quot;, &quot;linlog&quot;, &quot;sigEmax&quot;, &quot;quadratic&quot;, &quot;betaMod&quot;, &quot;logistic&quot;) (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>)
which specifies the competing models.
</p>
</td></tr>
<tr><td><code id="pLRcontrast_+3A_off">off</code></td>
<td>

<p>Positive and fixed offset parameter in the 'linlog' model (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
<tr><td><code id="pLRcontrast_+3A_scal">scal</code></td>
<td>

<p>Positive and fixed dose scaling parameter in the 'betaMod' with '<code class="reqn">scal\ge</code> max(dose)' (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
<tr><td><code id="pLRcontrast_+3A_nsim">nsim</code></td>
<td>

<p>A positive integer which specifies the number of simulations that should be done.
</p>
</td></tr>
<tr><td><code id="pLRcontrast_+3A_info">info</code></td>
<td>

<p>Logical value which indicates whether progress information should be shown.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the unadjusted and adjusted p-value for one model in each row.
</p>


<h3>Author(s)</h3>

<p>Kevin Kokot
</p>


<h3>References</h3>

<p>Dette, H., Titoff, S., Volgushev, S. and Bretz, F. (2015), Dose
response signal detection under model uncertainty. Biometrics. doi:
10.1111/biom.12357
</p>


<h3>See Also</h3>

<p><code><a href="DoseFinding.html#topic+DoseFinding-package">DoseFinding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In this case the data is generated by the constant model, i.e. the 
# null hypothesis of no dose response is true.

resp &lt;- rnorm(n = 50, mean = 0.2)
dose &lt;- c(rep(0, 10), rep(0.05, 10), rep(0.2, 10), rep(0.6, 10), rep(1, 10))

# Calculate the p-values in this scenario
			 
pLRcontrast(dose = dose, resp = resp, models = c("linear", "emax", 
            "exponential", "linlog"), nsim = 10)
</code></pre>

<hr>
<h2 id='qLRcontrast'>
Simulate quantiles of LR contrast tests in regression models with a lack of identifiability.
</h2><span id='topic+qLRcontrast'></span>

<h3>Description</h3>

<p>The function simulates the desired quantiles of the distribution of LR contrast tests. The competing models can be specified 
by the argument 'models' (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>). The argument 'dose' is the vector of the different unique 
dose-levels and 'weight' specifies the weight proportion of each dose group. By 'nsim' you can specify how many simulation should 
be done. It is recommended to do about 10000 but notice that the simulation can take some time. If the parameter 'info' is set 
'TRUE', information of the progress will be shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qLRcontrast(dose, probs, models, weight = rep(1/length(dose), length(dose)), 
            off = 0.01 * max(dose), scal = 1.2 * max(dose), nsim = 10000, info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qLRcontrast_+3A_dose">dose</code></td>
<td>

<p>A vector which contains the unique dose-levels.
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_probs">probs</code></td>
<td>

<p>A vector of probabilities with values in <code class="reqn">[0,1]</code> specifying which quantiles should be calculated.
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_models">models</code></td>
<td>

<p>A subvector of c(&quot;linear&quot;, &quot;emax&quot;, &quot;exponential&quot;, &quot;linlog&quot;, &quot;sigEmax&quot;, &quot;quadratic&quot;, &quot;betaMod&quot;, &quot;logistic&quot;) (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>)
which specifies the competing models.
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_weight">weight</code></td>
<td>

<p>A vector with values in <code class="reqn">[0,1]</code> with 'sum(weight) = 1'. The i-th entry specifies the weight proportion of the i-th dose group.
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_off">off</code></td>
<td>

<p>Positive and fixed offset parameter in the 'linlog' model (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_scal">scal</code></td>
<td>

<p>Positive and fixed dose scaling parameter in the 'betaMod' with '<code class="reqn">scal\ge</code> max(dose)' (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_nsim">nsim</code></td>
<td>

<p>A positive integer which specifies the number of simulations that should be done.
</p>
</td></tr>
<tr><td><code id="qLRcontrast_+3A_info">info</code></td>
<td>

<p>Logical value which indicates whether progress information should be shown.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the different quantiles for one model in each row. The last row contains the quantiles of the maximum statistic.
</p>


<h3>Author(s)</h3>

<p>Kevin Kokot
</p>


<h3>References</h3>

<p>Dette, H., Titoff, S., Volgushev, S. and Bretz, F. (2015), Dose
response signal detection under model uncertainty. Biometrics. doi:
10.1111/biom.12357
</p>


<h3>See Also</h3>

<p><code><a href="DoseFinding.html#topic+DoseFinding-package">DoseFinding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate the 90%, 95% and 99% quantiles of the LR contrast tests where the specified 
# models are competing against each other.
# The size of each dose group is equal in this case. 

qLRcontrast(dose = c(0, 0.05, 0.2, 0.6, 1), probs = c(0.9, 0.95, 0.99), 
            weight = c(0.2, 0.2, 0.2, 0.2, 0.2), models = c("linear", "emax", 
            "exponential", "linlog"), nsim = 10)
</code></pre>

<hr>
<h2 id='sLRcontrast'>
Calculate LR test statistics
</h2><span id='topic+sLRcontrast'></span>

<h3>Description</h3>

<p>The function calculates LR test statistics for the competing models which are defined by the argument 'models' 
(see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sLRcontrast(dose, resp, models, off = 0.01 * max(dose), scal = 1.2 * max(dose))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sLRcontrast_+3A_dose">dose</code>, <code id="sLRcontrast_+3A_resp">resp</code></td>
<td>

<p>Vectors of equal length specifying dose and response values.
</p>
</td></tr>
<tr><td><code id="sLRcontrast_+3A_models">models</code></td>
<td>

<p>A subvector of c(&quot;linear&quot;, &quot;emax&quot;, &quot;exponential&quot;, &quot;linlog&quot;, &quot;sigEmax&quot;, &quot;quadratic&quot;, &quot;betaMod&quot;, &quot;logistic&quot;) (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>)
which specifies the competing models.
</p>
</td></tr>
<tr><td><code id="sLRcontrast_+3A_off">off</code></td>
<td>

<p>Positive and fixed offset parameter in the 'linlog' model (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
<tr><td><code id="sLRcontrast_+3A_scal">scal</code></td>
<td>

<p>Positive and fixed dose scaling parameter in the 'betaMod' with '<code class="reqn">scal\ge</code> max(dose)' (see <code><a href="DoseFinding.html#topic+drmodels">drmodels</a></code>).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing the LR test statistic for one model in each row. The last row contains the value of the maximum statistic.
</p>


<h3>Author(s)</h3>

<p>Kevin Kokot
</p>


<h3>References</h3>

<p>Dette, H., Titoff, S., Volgushev, S. and Bretz, F. (2015), Dose
response signal detection under model uncertainty. Biometrics. doi:
10.1111/biom.12357
</p>


<h3>See Also</h3>

<p><code><a href="DoseFinding.html#topic+DoseFinding-package">DoseFinding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Simulate the power of the LR contrast test

# five dose levels will be used
doselvl &lt;- c(0, 0.05, 0.2, 0.6, 1)
dose &lt;- c(rep(0, 10), rep(0.05, 10), rep(0.2, 10), rep(0.6, 10), rep(1, 10))

# each row of 'resp' will contain one sample of size 50
resp &lt;- matrix(nrow=100, ncol=50)

# the linear model will serve as the data generating model
linear &lt;- function(dose, e0, delta){e0 + delta * dose} 

# now 'resp' is generated:
for (i in 1:100)
     {for(j in 1:5)
        {resp[i,(j*10-9):(10*j)]&lt;-rnorm(10, mean=linear(doselvl[j], 0.2, 0.6), sd=1.478)}}  

# the simulated 95% quantile in this case:
quantile &lt;- 4.349362

# now the power is simulated
count &lt;- 0
for (i in 1:100)
     {if(sLRcontrast(dose = dose, resp = resp[i,], models = c("linear", "emax", 
                     "exponential", "linlog"))[5] &gt; quantile)
         {count &lt;- count + 1}}

#power:
count/100
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
