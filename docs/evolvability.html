<!DOCTYPE html><html lang="en"><head><title>Help for package evolvability</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {evolvability}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#evolvability-package'>
<p>Calculation of Evolvability Parameters</p></a></li>
<li><a href='#Almer'><p>Linear mixed model with correlated random effects structure</p></a></li>
<li><a href='#Almer_boot'><p>Parametric bootstrap on <code>Almer</code> model fit</p></a></li>
<li><a href='#Almer_SE'><p>Linear mixed model for response variables with uncertainty</p></a></li>
<li><a href='#Almer_sim'><p>Simulate responses from <code>Almer</code> fit</p></a></li>
<li><a href='#conditionalG'><p>Computing a conditional sub-matrix of G</p></a></li>
<li><a href='#evolvabilityBeta'><p>Calculate evolvability parameters along a set of selection gradients</p></a></li>
<li><a href='#evolvabilityBetaMCMC'><p>Calculate posterior distribution of evolvability parameters from a set of</p>
selection gradients</a></li>
<li><a href='#evolvabilityBetaMCMC2'><p>Calculate posterior distribution of evolvability parameters from a selection</p>
gradient estimated with uncertainty</a></li>
<li><a href='#evolvabilityMeans'><p>Calculate average evolvability parameters of a G-matrix</p></a></li>
<li><a href='#evolvabilityMeansMCMC'><p>Calculate posterior distribution of average evolvability parameters of a</p>
G-matrix</a></li>
<li><a href='#GLS'><p>Generalized least square</p></a></li>
<li><a href='#macro_pred'><p>Macroevolutionary predictions</p></a></li>
<li><a href='#meanStdG'><p>Mean standardize a variance matrix</p></a></li>
<li><a href='#meanStdGMCMC'><p>Mean standardize the posterior distribution of a G-matrix</p></a></li>
<li><a href='#phylH'><p>Phylogenetic heritability</p></a></li>
<li><a href='#plot.rate_gls'><p>Plot of rate_gls object</p></a></li>
<li><a href='#plot.simulate_rate'><p>Plot of simulate_rate object</p></a></li>
<li><a href='#randomBeta'><p>Generating selection gradients/vectors in random directions.</p></a></li>
<li><a href='#rate_gls'><p>Generalized least squares rate model</p></a></li>
<li><a href='#rate_gls_boot'><p>Bootstrap of the <code>rate_gls</code> model fit</p></a></li>
<li><a href='#rate_gls_sim'><p>Simulate responses from <code>rate_gls</code> fit</p></a></li>
<li><a href='#round_and_format'><p>Rounds and formats in the same function</p></a></li>
<li><a href='#simulate_rate'><p>Simulating evolutionary rate model</p></a></li>
<li><a href='#summary.evolvabilityBeta'><p>Summarizing evolvability parameters over a set of selection gradients</p></a></li>
<li><a href='#summary.evolvabilityBetaMCMC'><p>Summarizing posterior distribution of evolvability parameters over a set of</p>
selection gradients</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculation of Evolvability Parameters</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides tools for calculating evolvability parameters from estimated G-matrices as defined 
    in Hansen and Houle (2008) &lt;<a href="https://doi.org/10.1111%2Fj.1420-9101.2008.01573.x">doi:10.1111/j.1420-9101.2008.01573.x</a>&gt; and fits phylogenetic 
    comparative models that link the rate of evolution of a trait to the state of another evolving 
    trait (see Hansen et al. 2021 Systematic Biology &lt;<a href="https://doi.org/10.1093%2Fsysbio%2Fsyab079">doi:10.1093/sysbio/syab079</a>&gt;). The package was 
    released with Bolstad et al. (2014) &lt;<a href="https://doi.org/10.1098%2Frstb.2013.0255">doi:10.1098/rstb.2013.0255</a>&gt;, which contains some examples of use.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, Matrix, ape, lme4, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-08 18:11:30 UTC; geir.bolstad</td>
</tr>
<tr>
<td>Author:</td>
<td>Geir H. Bolstad [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Geir H. Bolstad &lt;geir.bolstad@nina.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-08 23:00:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='evolvability-package'>
Calculation of Evolvability Parameters
</h2><span id='topic+evolvability-package'></span><span id='topic+evolvability'></span>

<h3>Description</h3>

<p>This package calculates evolvability parameters from estimated G-matrices as defined in Hansen and Houle (2008) &lt;doi:10.1111/j.1420-9101.2008.01573.x&gt;. It can use both point estimates and posterior/bootstrap distributions of the G-matrices. This package was released with Bolstad et al. (2014) &lt;doi:10.1098/rstb.2013.0255&gt;, which contains some examples of use.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> evolvability</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-04-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad <a href="mailto:geir.bolstad@nina.no">geir.bolstad@nina.no</a></p>


<h3>References</h3>

<p>Bolstad G. H., Hansen T. F., Pelabon C. Falahati-Anabaran M., Perez-Barrales R. &amp; Armbruster W. S. 2014. Genetic constraints predict evolutionary divergence in Dalechampia blossoms. Phil. Trans. R. Soc. B. 369:20130255. doi:10.1098/rstb.2013.0255
</p>
<p>Hansen T. F. &amp; Houle D. (2008) Measuring and comparing evolvability and constraint in multivariate characters. J. Evol. Biol. 21:1201-1219. doi:10.1111/j.1420-9101.2008.01573.x
</p>

<hr>
<h2 id='Almer'>Linear mixed model with correlated random effects structure</h2><span id='topic+Almer'></span>

<h3>Description</h3>

<p><code>Almer</code> fits a univariate linear mixed model incorporating a correlated
random effects structure. Can be used to fit phylogenetic mixed models and
animal models. The function is based on the <code>lme4</code> package and is
very similar to <code>lmer</code>, apart from the A argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Almer(
  formula,
  data = NULL,
  A = list(),
  REML = TRUE,
  control = lme4::lmerControl(check.nobs.vs.nlev = "ignore", check.nobs.vs.rankZ =
    "ignore", check.nobs.vs.nRE = "ignore"),
  start = NULL,
  verbose = 0L,
  weights = NULL,
  na.action = "na.omit",
  offset = NULL,
  contrasts = NULL,
  devFunOnly = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Almer_+3A_formula">formula</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_data">data</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_a">A</code></td>
<td>
<p>an optional named list of sparse matrices. The names must correspond
to the names of the random effects in the formula argument. All levels of
the random effect should appear as row and column names for the matrices.</p>
</td></tr>
<tr><td><code id="Almer_+3A_reml">REML</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_control">control</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_start">start</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_verbose">verbose</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_weights">weights</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_na.action">na.action</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_offset">offset</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_contrasts">contrasts</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_devfunonly">devFunOnly</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_+3A_...">...</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Almer</code> an object of class <code>merMod</code>.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Phylogenetic mixed model'.
</code></pre>

<hr>
<h2 id='Almer_boot'>Parametric bootstrap on <code><a href="#topic+Almer">Almer</a></code> model fit</h2><span id='topic+Almer_boot'></span>

<h3>Description</h3>

<p><code>Almer_boot</code> performs a parametric bootstrap from an <code><a href="#topic+Almer">Almer</a></code>
model fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Almer_boot(mod, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Almer_boot_+3A_mod">mod</code></td>
<td>
<p>A fitted object from <code><a href="#topic+Almer">Almer</a></code></p>
</td></tr>
<tr><td><code id="Almer_boot_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Almer_boot</code> a list with entries fixef, vcov, fixef_distribution
and vcov_distribution, where the two first entries includes the means,
standard deviations, and quantiles of the fixed effects means and
(co)variances, respectively, and the two latter includes the complete
bootstrap distribution.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Phylogenetic mixed model'.
</code></pre>

<hr>
<h2 id='Almer_SE'>Linear mixed model for response variables with uncertainty</h2><span id='topic+Almer_SE'></span>

<h3>Description</h3>

<p><code>Almer_SE</code> Linear mixed model for response variables with uncertainty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Almer_SE(
  formula,
  SE = NULL,
  maxiter = 100,
  control = lme4::lmerControl(check.nobs.vs.nlev = "ignore", check.nobs.vs.rankZ =
    "ignore", check.nobs.vs.nRE = "ignore"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Almer_SE_+3A_formula">formula</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_SE_+3A_se">SE</code></td>
<td>
<p>A vector of standard errors associated with the response variable. NB! Must have column name &quot;SE&quot; in the data.</p>
</td></tr>
<tr><td><code id="Almer_SE_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
<tr><td><code id="Almer_SE_+3A_control">control</code></td>
<td>
<p>as in <code>lmer</code>.</p>
</td></tr>
<tr><td><code id="Almer_SE_+3A_...">...</code></td>
<td>
<p>Further optional arguments, see <code><a href="#topic+Almer">Almer</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Almer_SE</code> returns an object of class <code>merMod</code>.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Phylogenetic mixed model'.
</code></pre>

<hr>
<h2 id='Almer_sim'>Simulate responses from <code><a href="#topic+Almer">Almer</a></code> fit</h2><span id='topic+Almer_sim'></span>

<h3>Description</h3>

<p><code>Almer_sim</code> Simulate responses from an <code><a href="#topic+Almer">Almer</a></code> model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Almer_sim(mod, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Almer_sim_+3A_mod">mod</code></td>
<td>
<p>A fitted object from <code><a href="#topic+Almer">Almer</a></code></p>
</td></tr>
<tr><td><code id="Almer_sim_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is only included as the <code>simulate.merMod</code>
function did not seem to work properly when the number of random effect
levels equal the number of observations.
</p>


<h3>Value</h3>

<p><code>Almer_sim</code> a matrix of simulated responses, columns correspond
to each simulations.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Phylogenetic mixed model'.
</code></pre>

<hr>
<h2 id='conditionalG'>Computing a conditional sub-matrix of G</h2><span id='topic+conditionalG'></span>

<h3>Description</h3>

<p><code>conditinoalG</code> calculates a conditional variance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditionalG(G, condition_on = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="conditionalG_+3A_g">G</code></td>
<td>
<p>A variance matrix (must be symmetric and positive definite).</p>
</td></tr>
<tr><td><code id="conditionalG_+3A_condition_on">condition_on</code></td>
<td>
<p>Either an integer with the column number indicating which
trait to condition on or a vector with several column numbers (integers).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates a sub-matrix of <code>G</code> conditional on the
traits defined by the the <code>condition_on</code> vector. The function is based
on equation 3 in Hansen et al. (2003).
</p>


<h3>Value</h3>

<p>A matrix that is a sub-matrix of the input matrix conditional on the
non-included traits.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen TF, Armbruster WS, Carlsson ML &amp; PÃ©labon C. 2003.
Evolvability and genetic constraint in Dalechampia blossoms: genetic
correlations and conditional evolvability. J. Exp. Zool. 296B:23-39.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Constructing a G-matrix:
G &lt;- matrix(c(
  1, 1, 0, 1,
  1, 2, 1, 1,
  0, 1, 2, 1,
  1, 1, 1, 3
), ncol = 4)

# Computing a conditional 2x2 sub-matrix by conditioning on
# trait 3 and 4:
G_sub_conditional &lt;- conditionalG(G, condition_on = c(3, 4))
G_sub_conditional

# The average evolvabilities of this matrix can then be
# compared can than be compared to the average evolvabilities
# of the corresponding unconditional sub-matrix of G:
evolvabilityMeans(G_sub_conditional)
evolvabilityMeans(G[-c(3, 4), -c(3, 4)])
</code></pre>

<hr>
<h2 id='evolvabilityBeta'>Calculate evolvability parameters along a set of selection gradients</h2><span id='topic+evolvabilityBeta'></span>

<h3>Description</h3>

<p><code>G</code> needs to be symmetric and positive definite.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolvabilityBeta(G, Beta, means = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolvabilityBeta_+3A_g">G</code></td>
<td>
<p>A variance matrix.</p>
</td></tr>
<tr><td><code id="evolvabilityBeta_+3A_beta">Beta</code></td>
<td>
<p>Either a vector or a matrix of unit length selection gradients
stacked column wise.</p>
</td></tr>
<tr><td><code id="evolvabilityBeta_+3A_means">means</code></td>
<td>
<p>An optional vector of trait means (for internal mean
standardization).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>evolvabilityBeta</code> calculates (unconditional) evolvability (e),
respondability (r), conditional evolvability (c), autonomy (a) and
integration (i) along selection gradients given an additive-genetic variance
matrix as described in Hansen and Houle (2008).
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'evolvabilityBeta'</code>, which is a list
with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Beta</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The matrix of selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>e</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The evolvability of each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>r</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The respondability of each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>c</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The conditional evolvability of each selection
gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>a</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The autonomy of each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>i</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The integration of each selection gradient.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen, T. F. &amp; Houle, D. (2008) Measuring and comparing
evolvability and constraint in multivariate characters. J. Evol. Biol.
21:1201-1219.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>G &lt;- matrix(c(1, 1, 0, 1, 2, 2, 0, 2, 3), ncol = 3) / 10
Beta &lt;- randomBeta(5, 3)
X &lt;- evolvabilityBeta(G, Beta)
summary(X)
</code></pre>

<hr>
<h2 id='evolvabilityBetaMCMC'>Calculate posterior distribution of evolvability parameters from a set of
selection gradients</h2><span id='topic+evolvabilityBetaMCMC'></span>

<h3>Description</h3>

<p><code>evolvabilityBetaMCMC</code> calculates (unconditional) evolvability (e),
respondability (r), conditional evolvability (c), autonomy (a) and
integration (i) from selection gradients given the posterior distribution of
an additive-genetic variance matrix. These measures and their meanings are
described in Hansen and Houle (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolvabilityBetaMCMC(G_mcmc, Beta, post.dist = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolvabilityBetaMCMC_+3A_g_mcmc">G_mcmc</code></td>
<td>
<p>posterior distribution of a variance matrix in the form of a
table. Each row in the table must be one iteration of the posterior
distribution (or bootstrap distribution). Each iteration of the matrix must
be on the form as given by <code>c(x)</code>, where <code>x</code> is a matrix. A
posterior distribution of a matrix in the slot <code>VCV</code> of a object of
class <code>MCMCglmm</code> is by default on this form.</p>
</td></tr>
<tr><td><code id="evolvabilityBetaMCMC_+3A_beta">Beta</code></td>
<td>
<p>either a vector or a matrix of unit length selection gradients
stacked column wise.</p>
</td></tr>
<tr><td><code id="evolvabilityBetaMCMC_+3A_post.dist">post.dist</code></td>
<td>
<p>logical: should the posterior distribution of the
evolvability parameters be saved.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'evolvabilityBetaMCMC'</code>, which is a
list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>eB</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior density
 interval of evolvability for each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>rB</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior density
 interval of respondability for each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>cB</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior density
 interval of conditional evolvability for each selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>aB</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior density
 interval of autonomy for each selection gradient.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>iB</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior density
 interval of integration for each selection gradient.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Beta</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The matrix of selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>summary</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The means of evolvability parameters across
 all selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>post.dist</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The full posterior distribution.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen, T. F. &amp; Houle, D. (2008) Measuring and comparing
evolvability and constraint in multivariate characters. J. Evol. Biol.
21:1201-1219.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulating a posterior distribution
# (or bootstrap distribution) of a G-matrix:
G &lt;- matrix(c(1, 1, 0, 1, 4, 1, 0, 1, 2), ncol = 3)
G_mcmc &lt;- sapply(c(G), function(x) rnorm(10, x, 0.01))
G_mcmc &lt;- t(apply(G_mcmc, 1, function(x) {
  G &lt;- matrix(x, ncol = sqrt(length(x)))
  G[lower.tri(G)] &lt;- t(G)[lower.tri(G)]
  c(G)
}))

# Simulating a posterior distribution
# (or bootstrap distribution) of trait means:
means &lt;- c(1, 1.4, 2.1)
means_mcmc &lt;- sapply(means, function(x) rnorm(10, x, 0.01))

# Mean standardizing the G-matrix:
G_mcmc &lt;- meanStdGMCMC(G_mcmc, means_mcmc)

# Generating selection gradients in five random directions:
Beta &lt;- randomBeta(5, 3)

# Calculating evolvability parameters:
x &lt;- evolvabilityBetaMCMC(G_mcmc, Beta, post.dist = TRUE)
summary(x)
</code></pre>

<hr>
<h2 id='evolvabilityBetaMCMC2'>Calculate posterior distribution of evolvability parameters from a selection
gradient estimated with uncertainty</h2><span id='topic+evolvabilityBetaMCMC2'></span>

<h3>Description</h3>

<p><code>evolvabilityBetaMCMC2</code> calculates (unconditional) evolvability (e),
respondability (r), conditional evolvability (c), autonomy (a) and
integration (i) along a selection gradient estimate with uncertainty.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolvabilityBetaMCMC2(G_mcmc, Beta_mcmc, post.dist = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolvabilityBetaMCMC2_+3A_g_mcmc">G_mcmc</code></td>
<td>
<p>A posterior distribution of a variance matrix in the form of a
table. Each row in the table must be one iteration of the posterior
distribution (or bootstrap distribution). Each iteration of the matrix must
be on the form as given by <code>c(x)</code>, where <code>x</code> is a matrix. A
posterior distribution of a matrix in the slot <code>VCV</code> of a object of
class <code>MCMCglmm</code> is by default on this form.</p>
</td></tr>
<tr><td><code id="evolvabilityBetaMCMC2_+3A_beta_mcmc">Beta_mcmc</code></td>
<td>
<p>A posterior distribution of a unit length selection gradient
where iterations are given row wise.</p>
</td></tr>
<tr><td><code id="evolvabilityBetaMCMC2_+3A_post.dist">post.dist</code></td>
<td>
<p>logical: should the posterior distribution of the evolvability
parameters be saved.
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Beta.median</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> posterior median and highest posterior
 density interval of the selection gradient. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>summary</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior median and highest posterior
 density interval of evolvability parameters. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>post.dist</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The full posterior distributions of the
 evolvability parameters.
</td>
</tr>

</table>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen, T. F. &amp; Houle, D. (2008) Measuring and comparing
evolvability and constraint in multivariate characters. J. Evol. Biol.
21:1201-1219.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>{
  # Simulating a posterior distribution
  # (or bootstrap distribution) of a G-matrix:
  G &lt;- matrix(c(1, 1, 0, 1, 4, 1, 0, 1, 2), ncol = 3)
  G_mcmc &lt;- sapply(c(G), function(x) rnorm(10, x, 0.01))
  G_mcmc &lt;- t(apply(G_mcmc, 1, function(x) {
    G &lt;- matrix(x, ncol = sqrt(length(x)))
    G[lower.tri(G)] &lt;- t(G)[lower.tri(G)]
    c(G)
  }))

  # Simulating a posterior distribution
  # (or bootstrap distribution) of trait means:
  means &lt;- c(1, 1.4, 2.1)
  means_mcmc &lt;- sapply(means, function(x) rnorm(10, x, 0.01))

  # Mean standardizing the G-matrix:
  G_mcmc &lt;- meanStdGMCMC(G_mcmc, means_mcmc)

  # Simulating a posterior distribution (or bootstrap distribution)
  # of a unit length selection gradient:
  Beta &lt;- randomBeta(1, 3)
  Beta.mcmc &lt;- sapply(c(Beta), function(x) rnorm(10, x, 0.01))
  Beta.mcmc &lt;- t(apply(Beta.mcmc, 1, function(x) x / sqrt(sum(x^2))))

  # Running the model:
  evolvabilityBetaMCMC2(G_mcmc, Beta_mcmc = Beta.mcmc, post.dist = TRUE)
}
</code></pre>

<hr>
<h2 id='evolvabilityMeans'>Calculate average evolvability parameters of a G-matrix</h2><span id='topic+evolvabilityMeans'></span>

<h3>Description</h3>

<p><code>evolvabilityMeans</code> calculates the average (unconditional) evolvability
(e), respondability (r), conditional evolvability (c), autonomy (a) and
integration (i) of a additive-genetic variance matrix using the approximation
formulas described in Hansen and Houle (2008, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolvabilityMeans(G, means = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolvabilityMeans_+3A_g">G</code></td>
<td>
<p>A variance matrix (must be symmetric and positive definite).</p>
</td></tr>
<tr><td><code id="evolvabilityMeans_+3A_means">means</code></td>
<td>
<p>An optional vector of trait means, for mean standardization.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The equations for calculating the evolvability parameters are
approximations, except for the minimum, maximum and unconditional
evolvability which are exact. The bias of the approximations depends on the
dimensionality of the G-matrix, with higher bias for few dimensions (see
Hansen and Houle 2008). For low dimensional G-matrices, we recommend
estimating the averages of the evolvability parameters using
<code>evolavbilityBetaMCMC</code> over many random selection gradients (
<code>randomBeta</code>). The maximum and minimum evolvability, which
are also the maximum and minimum respondability and conditional
evolvability, equals the largest and smallest eigenvalue of the G-matrix,
respectively.
</p>


<h3>Value</h3>

<p>A vector with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>e_mean</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The average (unconditional) evolvability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>e_min</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The minimum evolvability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>e_max</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The maximum evolvability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>r_mean</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The average respondability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>c_mean</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The average conditional evolvability. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>a_mean</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The average autonomy. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>i_mean</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The average integration.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen, T. F. &amp; Houle, D. (2008) Measuring and comparing evolvability and
constraint in multivariate characters. J. Evol. Biol. 21:1201-1219. <br />
Hansen, T. F. &amp; Houle, D. (2009) Corrigendum. J. Evol. Biol. 22:913-915.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>G &lt;- matrix(c(1, 1, 0, 1, 2, 1, 0, 1, 2), ncol = 3)
evolvabilityMeans(G)
</code></pre>

<hr>
<h2 id='evolvabilityMeansMCMC'>Calculate posterior distribution of average evolvability parameters of a
G-matrix</h2><span id='topic+evolvabilityMeansMCMC'></span>

<h3>Description</h3>

<p><code>evolvabilityMeans</code> calculates the average (unconditional) evolvability
(e), respondability (r), conditional evolvability (c), autonomy (a) and
integration (i) given the posterior distribution of a additive-genetic
variance matrix using the approximation formulas described in Hansen and
Houle (2008, 2009).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evolvabilityMeansMCMC(G_mcmc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evolvabilityMeansMCMC_+3A_g_mcmc">G_mcmc</code></td>
<td>
<p>the posterior distribution of a variance matrix in the form of
a table. Each row in the table must be one iteration of the posterior
distribution (or bootstrap distribution). Each iteration of the matrix must
be on the form as given by <code>c(x)</code>, where <code>x</code> is a matrix. A
posterior distribution of a matrix in the slot <code>VCV</code> of a object of
class <code>MCMCglmm</code> is by default on this form.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The equations for calculating the evolvability parameters are
approximations, except for the minimum, maximum and unconditional
evolvability which are exact. The bias of the approximations depends on the
dimensionality of the G-matrix, with higher bias for few dimensions (see
Hansen and Houle 2008). For low dimensional G-matrices, we recommend
estimating the averages of the evolvability parameters using
<code>evolavbilityBetaMCMC</code> over many random selection gradients (
<code>randomBeta</code>). The maximum and minimum evolvability, which
are also the maximum and minimum respondability and conditional
evolvability, equals the largest and smallest eigenvalue of the G-matrix,
respectively.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'evolvabilityMeansMCMC'</code>, which is a
list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>post.dist</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior distribution of the average
evolvability parameters. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>post.medians</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The posterior medians and HPD interval
of the average evolvability parameters.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen, T. F. &amp; Houle, D. (2008) Measuring and comparing evolvability and
constraint in multivariate characters. J. Evol. Biol. 21:1201-1219. <br />
Hansen, T. F. &amp; Houle, D. (2009) Corrigendum. J. Evol. Biol. 22:913-915.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulating a posterior distribution
# (or bootstrap distribution) of a G-matrix:
G &lt;- matrix(c(1, 1, 0, 1, 4, 1, 0, 1, 2), ncol = 3)
G_mcmc &lt;- sapply(c(G), function(x) rnorm(10, x, 0.01))
G_mcmc &lt;- t(apply(G_mcmc, 1, function(x) {
  G &lt;- matrix(x, ncol = sqrt(length(x)))
  G[lower.tri(G)] &lt;- t(G)[lower.tri(G)]
  c(G)
}))

# Simulating a posterior distribution
# (or bootstrap distribution) of trait means:
means &lt;- c(1, 1.4, 2.1)
means_mcmc &lt;- sapply(means, function(x) rnorm(10, x, 0.01))

# Mean standardizing the G-matrix:
G_mcmc &lt;- meanStdGMCMC(G_mcmc, means_mcmc)

# Estimating average evolvability paramters:
evolvabilityMeansMCMC(G_mcmc)
</code></pre>

<hr>
<h2 id='GLS'>Generalized least square</h2><span id='topic+GLS'></span>

<h3>Description</h3>

<p><code>GLS</code> utilizes <code>lm.fit</code> and Cholesky decomposition to fit a
generalized least squares regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GLS(y, X, R = NULL, L = NULL, coef_only = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GLS_+3A_y">y</code></td>
<td>
<p>response variable</p>
</td></tr>
<tr><td><code id="GLS_+3A_x">X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code id="GLS_+3A_r">R</code></td>
<td>
<p>residual covariance or correlation matrix (can be sparse), ignored
if <code>L</code> is provided.</p>
</td></tr>
<tr><td><code id="GLS_+3A_l">L</code></td>
<td>
<p>lower triangular matrix of the Cholesky decomposition of <code>R</code>
(optional).</p>
</td></tr>
<tr><td><code id="GLS_+3A_coef_only">coef_only</code></td>
<td>
<p>reduces the output of the model to the estimated
coefficients (and the generalized residual sums of squares) only.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the size of <code>R</code> does not matter (i.e. if <code>R</code> is
multiplied by a scalar, the results don't change). Note also that the
R-squared is estimated as 1-GSSE/GSST, where GSSE is the generalized
residual sum of squares (i.e. the objective function score of the model)
and GSST is the generalized total sum of squares (i.e. the objective
function score of the model when only the intercept is included in the
model)
</p>


<h3>Value</h3>

<p><code>GLS</code> a <code><a href="base.html#topic+list">list</a></code> of
</p>

<ul>
<li><p><code>coef</code>: a table of estimates and standard errors
</p>
</li>
<li><p><code>R2</code>: the R-squared of the model fit
</p>
</li>
<li><p><code>sigma2</code>: the residual variance
</p>
</li>
<li><p><code>GSSE</code>: the generalized residual sum of squares (objective function
score)
</p>
</li>
<li><p><code>coef_vcov</code>: the error variance matrix of the estimates
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>

<hr>
<h2 id='macro_pred'>Macroevolutionary predictions</h2><span id='topic+macro_pred'></span>

<h3>Description</h3>

<p><code>macro_pred</code> Macroevolutionary predictions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>macro_pred(y, V, useLFO = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="macro_pred_+3A_y">y</code></td>
<td>
<p>vector of species means</p>
</td></tr>
<tr><td><code id="macro_pred_+3A_v">V</code></td>
<td>
<p>phylogenetic variance matrix, must have same order as <code>y</code></p>
</td></tr>
<tr><td><code id="macro_pred_+3A_uselfo">useLFO</code></td>
<td>
<p>excludes the focal species when calculating the corresponding
species' mean. The correct way is to use TRUE, but in practice it has
little effect and FALSE will speed up the model fit.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>macro_pred</code> Gives a vector of macroevolutionary predictions for each
species based on the other species given the phylogeny and a phylogenetic
variance matrix.
</p>


<h3>Value</h3>

<p><code>macro_pred</code> returns a of macroevolutionary predictions at the
tips.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Trait values
y &lt;- rnorm(3)

# A variance matrix (the diagonal must be the same order as y).
V &lt;- matrix(c(1.0, 0.5, 0.2, 0.5, 1.0, 0.4, 0.2, 0.4, 1.0), ncol = 3)

# Macroevolutionary predictions (output in the same order as y).
macro_pred(y, V)
</code></pre>

<hr>
<h2 id='meanStdG'>Mean standardize a variance matrix</h2><span id='topic+meanStdG'></span>

<h3>Description</h3>

<p><code>meanStdG</code> mean standardizes a variance matrix (e.g. a G-matrix).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanStdG(G, means)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meanStdG_+3A_g">G</code></td>
<td>
<p>A variance matrix.</p>
</td></tr>
<tr><td><code id="meanStdG_+3A_means">means</code></td>
<td>
<p>A vector of trait means.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A mean standardized variance matrix.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'>G &lt;- matrix(c(1, 1, 0, 1, 4, 1, 0, 1, 2), ncol = 3)
means &lt;- c(1, 1.4, 2.1)
meanStdG(G, means)
</code></pre>

<hr>
<h2 id='meanStdGMCMC'>Mean standardize the posterior distribution of a G-matrix</h2><span id='topic+meanStdGMCMC'></span>

<h3>Description</h3>

<p><code>meanStdGMCMC</code> mean standardizes the posterior distribution of a
variance matrix (e.g. a G-matrix)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanStdGMCMC(G_mcmc, means_mcmc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meanStdGMCMC_+3A_g_mcmc">G_mcmc</code></td>
<td>
<p>A posterior distribution of a variance matrix in the form of a
table. Each row in the table must be one iteration of the posterior
distribution (or bootstrap distribution). Each iteration of the matrix must
be on the form as given by <code>c(x)</code>, where <code>x</code> is a matrix. A
posterior distribution of a matrix in the slot <code>VCV</code> of a object of
class <code>MCMCglmm</code> is by default on this form.</p>
</td></tr>
<tr><td><code id="meanStdGMCMC_+3A_means_mcmc">means_mcmc</code></td>
<td>
<p>A posterior distribution of a vector of means in the form
of a table. Each row in the table must be one iteration of the posterior
distribution (or bootstrap distribution). A posterior distribution of a
mean vector in the slot <code>Sol</code> of an object of class <code>MCMCglmm</code> is
by default on this form.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior distribution of a mean standardized variance matrix.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulating a posterior distribution
# (or bootstrap distribution) of a G-matrix:
G &lt;- matrix(c(1, 1, 0, 1, 4, 1, 0, 1, 2), ncol = 3)
G_mcmc &lt;- sapply(c(G), function(x) rnorm(10, x, 0.01))
G_mcmc &lt;- t(apply(G_mcmc, 1, function(x) {
  G &lt;- matrix(x, ncol = sqrt(length(x)))
  G[lower.tri(G)] &lt;- t(G)[lower.tri(G)]
  c(G)
}))

# Simulating a posterior distribution
# (or bootstrap distribution) of trait means:
means &lt;- c(1, 1.4, 2.1)
means_mcmc &lt;- sapply(means, function(x) rnorm(10, x, 0.01))

# Mean standardizing the G-matrix:
meanStdGMCMC(G_mcmc, means_mcmc)
</code></pre>

<hr>
<h2 id='phylH'>Phylogenetic heritability</h2><span id='topic+phylH'></span>

<h3>Description</h3>

<p><code>phylH</code> calculates the phylogenetic heritability from an <code>Almer</code>
model fit and provides associated uncertainty using parametric
bootstrapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phylH(mod, numerator, residual = "Residual", nsim = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylH_+3A_mod">mod</code></td>
<td>
<p>An object of class <code>'merMod'</code></p>
</td></tr>
<tr><td><code id="phylH_+3A_numerator">numerator</code></td>
<td>
<p>The name of phylogenetic effect level</p>
</td></tr>
<tr><td><code id="phylH_+3A_residual">residual</code></td>
<td>
<p>name of the residual effect level</p>
</td></tr>
<tr><td><code id="phylH_+3A_nsim">nsim</code></td>
<td>
<p>number of bootstraps</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>phylH</code> returns a list with the REML estimate, the 95%
confidence interval from the parametric bootstrap, and the bootstrap
samples.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Phylogenetic mixed model'.
</code></pre>

<hr>
<h2 id='plot.rate_gls'>Plot of rate_gls object</h2><span id='topic+plot.rate_gls'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>'rate_gls'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rate_gls'
plot(
  x,
  scale = "SD",
  print_param = TRUE,
  digits_param = 2,
  digits_rsquared = 1,
  main = "GLS regression",
  xlab = "x",
  ylab = "Response",
  col = "grey",
  cex.legend = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rate_gls_+3A_x">x</code></td>
<td>
<p>An object of class <code>'rate_gls'</code>.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_scale">scale</code></td>
<td>
<p>The scale of the y-axis, either the variance scale ('VAR'), that
is y^2, or the standard deviation scale ('SD'), that is abs(y).</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_print_param">print_param</code></td>
<td>
<p>logical: if parameter estimates should be printed in the
plot or not.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_digits_param">digits_param</code></td>
<td>
<p>The number of significant digits displayed for the
parameters in the plots.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_digits_rsquared">digits_rsquared</code></td>
<td>
<p>The number of decimal places displayed for the
r-squared.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_main">main</code></td>
<td>
<p>as in <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_xlab">xlab</code></td>
<td>
<p>as in <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_ylab">ylab</code></td>
<td>
<p>as in <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_col">col</code></td>
<td>
<p>as in <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_cex.legend">cex.legend</code></td>
<td>
<p>A character expansion factor relative to current par(&quot;cex&quot;)
for the printed parameters.</p>
</td></tr>
<tr><td><code id="plot.rate_gls_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the gls rate regression fitted by the <code><a href="#topic+rate_gls">rate_gls</a></code>
function. The regression line gives the expected variance or standard
deviation (depending on scale). The regression is linear on the variance
scale.
</p>


<h3>Value</h3>

<p><code>plot</code> returns a plot of the gls rate regression
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Analyzing rates of evolution'.
</code></pre>

<hr>
<h2 id='plot.simulate_rate'>Plot of simulate_rate object</h2><span id='topic+plot.simulate_rate'></span>

<h3>Description</h3>

<p><code>plot</code> method for class <code>'simulate_rate'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simulate_rate'
plot(
  x,
  response = "rate_y",
  xlab = "Simulation timesteps",
  ylab = "Evolutionary rate of y",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.simulate_rate_+3A_x">x</code></td>
<td>
<p>An object of class <code>'simulate_rate'</code>.</p>
</td></tr>
<tr><td><code id="plot.simulate_rate_+3A_response">response</code></td>
<td>
<p>The variable for the y-axis of the plot, can be 'rate_y',
'y', or 'x'.</p>
</td></tr>
<tr><td><code id="plot.simulate_rate_+3A_xlab">xlab</code></td>
<td>
<p>A label for the x axis.</p>
</td></tr>
<tr><td><code id="plot.simulate_rate_+3A_ylab">ylab</code></td>
<td>
<p>A label for the y axis.</p>
</td></tr>
<tr><td><code id="plot.simulate_rate_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="base.html#topic+plot">plot</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>No plot is returned if model = 'recent_evol'.
</p>


<h3>Value</h3>

<p><code>plot</code> A plot of the evolution of the traits x or y, or the
evolution of the evolutionary rate of y (i.e. <code class="reqn">\sqrt{a + bx}</code>) in the
simulation.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Analyzing rates of evolution'.
</code></pre>

<hr>
<h2 id='randomBeta'>Generating selection gradients/vectors in random directions.</h2><span id='topic+randomBeta'></span>

<h3>Description</h3>

<p><code>randomBeta</code> generates unit length vectors (selection gradients)
uniformly distributed in a k-dimensional hypersphere.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomBeta(n = 1, k = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="randomBeta_+3A_n">n</code></td>
<td>
<p>Number of selection gradients/vectors.</p>
</td></tr>
<tr><td><code id="randomBeta_+3A_k">k</code></td>
<td>
<p>Number of dimensions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>randomBeta</code> exploits the spherical symmetry of a multidimensional
Gaussian density function. Each element of each vector is randomly sampled
from a univariate Gaussian distribution with zero mean and unit variance. The
vector is then divided by its norm to standardize it to unit length.
</p>


<h3>Value</h3>

<p><code>randomBeta</code> returns a matrix where the vectors are stacked column
wise.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Two vectors of dimension 3:
randomBeta(n = 2, k = 3)
</code></pre>

<hr>
<h2 id='rate_gls'>Generalized least squares rate model</h2><span id='topic+rate_gls'></span>

<h3>Description</h3>

<p><code>rate_gls</code> fits a generalized least squares model to estimate parameters
of an evolutionary model of two traits x and y, where the evolutionary rate
of y depends on the value of x. Three models are implemented. In the two
first, 'predictor_BM' and 'predictor_gBM', the evolution of y follows a
Brownian motion with variance linear in x, while the evolution of x either
follows a Brownian motion or a geometric Brownian motion, respectively. In
the third model, 'recent_evol', the residuals of the macroevolutionary
predictions of y have variance linear in x. It is highly recommended  to read
Hansen et al. (in review) and <code>vignette("Analyzing_rates_of_evolution")</code>
before fitting these models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate_gls(
  x,
  y,
  species,
  tree,
  model = "predictor_BM",
  startv = list(a = NULL, b = NULL),
  maxiter = 100,
  silent = FALSE,
  useLFO = TRUE,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rate_gls_+3A_x">x</code></td>
<td>
<p>The explanatory variable, which must be equal to the length of
<code>y</code> and tips on the tree.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_y">y</code></td>
<td>
<p>The trait values of response variable. Note that the algorithm mean
centers y.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_species">species</code></td>
<td>
<p>A vector with the names of the species, must be equal in
length and in the same order as <code>x</code> and <code>y</code>.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_tree">tree</code></td>
<td>
<p>An object of class <code>phylo</code>, needs to be ultrametric
and with total length of unit, tips must have the same names as in
<code>species</code>.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_model">model</code></td>
<td>
<p>The acronym of the evolutionary model to be fitted. There are
three options: 'predictor_BM', 'predictor_gBM' or 'recent_evol' (see
details).</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_startv">startv</code></td>
<td>
<p>A vector of optional starting values for the a and b
parameters.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for updating the GLS.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_silent">silent</code></td>
<td>
<p>logical: if the function should not print the generalized sum
of squares for each iteration.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_uselfo">useLFO</code></td>
<td>
<p>logical: whether the focal species should be left out when
calculating the corresponding species' means. Note that this is only
relevant for the 'recent_evol' model. The most correct is to use
<code>TRUE</code>, but in practice it has little effect and <code>FALSE</code> will
speed up the model fit (particularly useful when bootstrapping). LFO is an
acronym for 'Leave the Focal species Out'.</p>
</td></tr>
<tr><td><code id="rate_gls_+3A_tol">tol</code></td>
<td>
<p>tolerance for convergence. If the change in 'a' and 'b' is below
this limit between the two last iteration, convergence is reached. The
change is measured in proportion to the standard deviation of the response
for 'a' and the ratio of the standard deviation of the response to the
standard deviation of the predictor for 'b'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rate_gls</code> is an iterative generalized least squares (GLS)
model fitting a regression where the response variable is a vector of
squared mean-centered <code>y</code>-values for the 'predictor_BM' and
'predictor_gBM' models and squared deviation from the evolutionary
predictions (see <code><a href="#topic+macro_pred">macro_pred</a></code>) for the 'recent_evol' model.
Note that the algorithm mean centers <code>x</code> in the 'predictor_BM' and
'recent_evol' analyses, while it mean standardized <code>x</code> (i.e. divided
<code>x</code> by its mean) in the 'predictor_gBM'. The evolutionary parameters a
and b are inferred from the intercept and the slope of the GLS fit. Again,
it is highly recommended to read Hansen et al. (in review) and
<code>vignette("Analyzing_rates_of_evolution")</code> before fitting these
models. In Hansen et al. (2021) the three models 'predictor_BM',
'predictor_gBM' and 'recent_evol' are referred to as 'Model 1', 'Model 2'
and 'Model 3', respectively.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'rate_gls'</code>, which is a list with the
following components: </p>

<table>
<tr>
 <td style="text-align: left;">
  <code>model</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The name of the model ('predictor_BM',
  'predictor_gBM' or 'recent_evolution').
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>param</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The focal parameter estimates and their
  standard errors, where 'a' and 'b' are parameters of the evolutionary
  models, and 'sigma(x)^2' is the BM-rate parameter of x for the
  'predictor_BM' model, the BM-rate parameter for log x for the
  'predictor_gBM' model, and the variance of x for the 'recent_evolution'
  model.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Rsquared</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The generalized R squared of the GLS
  model fit.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>a_all_iterations</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The values for the parameter a
  in all iterations.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>b_all_iterations</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The values for the parameter b
  in all iterations.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>R</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The residual variance matrix.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Beta</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The intercept and slope of GLS regression
  (response is y2 and explanatory variable is x).
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>Beta_vcov</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The error variance matrix of
  <code>Beta</code>.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>tree</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The phylogenetic tree.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>data</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The data used in the GLS regression.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>convergence</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> Whether the algorithm converged or
  not.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>additional_param</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> Some additional parameter
  estimates.
  </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>call</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The function call.
  </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>References</h3>

<p>Hansen TF, Bolstad GH, Tsuboi M. 2021. Analyzing disparity and rates 
of morphological evolution with model-based phylogenetic comparative methods. 
*Systematic Biology*. syab079. doi:10.1093/sysbio/syab079
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Also see vignette("Analyzing_rates_of_evolution").
## Not run: 
# Generating a tree with 500 species
set.seed(102)
tree &lt;- ape::rtree(n = 500)
tree &lt;- ape::chronopl(tree, lambda = 1, age.min = 1)

### model = 'predictor_BM' ###
sim_data &lt;- simulate_rate(tree,
  startv_x = 0, sigma_x = 0.25, a = 1, b = 1, model =
    "predictor_BM"
)
head(sim_data$tips)
gls_mod &lt;- rate_gls(
  x = sim_data$tips$x, y = sim_data$tips$y,
  species = sim_data$tips$species, tree, model = "predictor_BM"
)
gls_mod$param
par(mfrow = c(1, 2))
# Response shown on the standard deviation scale (default):
plot(gls_mod, scale = "SD", cex.legend = 0.8)
# Response shown on the variance scale, where the regression is linear:
plot(gls_mod, scale = "VAR", cex.legend = 0.8)
par(mfrow = c(1, 1))
# Parametric bootstrapping to get the uncertainty of the parameter estimates
# taking the complete process into account.
# (this takes some minutes)
gls_mod_boot &lt;- rate_gls_boot(gls_mod, n = 1000)
gls_mod_boot$summary

### model = 'predictor_gBM' ###
sim_data &lt;- simulate_rate(tree,
  startv_x = 1, sigma_x = 1, a = 1, b = 1,
  model = "predictor_gBM"
)
head(sim_data$tips)
gls_mod &lt;- rate_gls(
  x = sim_data$tips$x, y = sim_data$tips$y, species = sim_data$tips$species,
  tree, model = "predictor_gBM"
)
gls_mod$param
plot(gls_mod)
par(mfrow = c(1, 2))
# Response shown on the standard deviation scale (default):
plot(gls_mod, scale = "SD", cex.legend = 0.8)
# Response shown on the variance scale, where the regression is linear:
plot(gls_mod, scale = "VAR", cex.legend = 0.8)
# is linear.
par(mfrow = c(1, 1))

# Parametric bootstrapping to get the uncertainty of the parameter estimates
# taking the complete process into account. (This takes some minutes.)
gls_mod_boot &lt;- rate_gls_boot(gls_mod, n = 1000)
gls_mod_boot$summary

### model = 'recent_evol' ###
sim_data &lt;- simulate_rate(tree,
  startv_x = 0, sigma_x = 1, a = 1, b = 1, sigma_y = 1,
  model = "recent_evol"
)
head(sim_data$tips)
gls_mod &lt;- rate_gls(
  x = sim_data$tips$x, y = sim_data$tips$y, species = sim_data$tips$species,
  tree, model = "recent_evol", useLFO = FALSE
)
# useLFO = TRUE is somewhat slower, and although more correct it should give
# very similar estimates in most situations.
gls_mod$param
par(mfrow = c(1, 2))
# Response shown on the standard deviation scale (default):
plot(gls_mod, scale = "SD", cex.legend = 0.8)
# Response shown on the variance scale, where the regression is linear:
plot(gls_mod, scale = "VAR", cex.legend = 0.8)
# linear.
par(mfrow = c(1, 1))

# Parametric bootstrapping to get the uncertainty of the parameter estimates
# taking the complete process into account. Note that x is considered as
# fixed effect. (This takes a long time.)
gls_mod_boot &lt;- rate_gls_boot(gls_mod, n = 1000, useLFO = FALSE)
gls_mod_boot$summary

## End(Not run)
</code></pre>

<hr>
<h2 id='rate_gls_boot'>Bootstrap of the <code><a href="#topic+rate_gls">rate_gls</a></code> model fit</h2><span id='topic+rate_gls_boot'></span>

<h3>Description</h3>

<p><code>rate_gls_boot</code> performs  a parametric bootstrap of a
<code><a href="#topic+rate_gls">rate_gls</a></code> model fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate_gls_boot(
  object,
  n = 10,
  useLFO = TRUE,
  silent = FALSE,
  maxiter = 100,
  tol = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rate_gls_boot_+3A_object">object</code></td>
<td>
<p>The output from <code><a href="#topic+rate_gls">rate_gls</a></code>.</p>
</td></tr>
<tr><td><code id="rate_gls_boot_+3A_n">n</code></td>
<td>
<p>The number of bootstrap samples</p>
</td></tr>
<tr><td><code id="rate_gls_boot_+3A_uselfo">useLFO</code></td>
<td>
<p>logical: when calculating the mean vector of the traits in the
'recent_evol' analysis, should the focal species be left out when
calculating the corresponding species' mean. The correct way is to use
TRUE, but in practice it has little effect and FALSE will speed up the
model fit (particularly useful when bootstrapping).</p>
</td></tr>
<tr><td><code id="rate_gls_boot_+3A_silent">silent</code></td>
<td>
<p>logical: whether or not the bootstrap iterations should be
printed.</p>
</td></tr>
<tr><td><code id="rate_gls_boot_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations for updating the GLS.</p>
</td></tr>
<tr><td><code id="rate_gls_boot_+3A_tol">tol</code></td>
<td>
<p>tolerance for convergence. If the change in 'a' and 'b' is below
this limit between the two last iteration, convergence is reached. The
change is measured in proportion to the standard deviation of the response
for 'a' and the ratio of the standard deviation of the response to the
standard deviation of the predictor for 'b'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list where the first slot is a table with the original estimates
and SE from the GLS fit in the two first columns followed by the bootstrap
estimate of the SE and the 2.5%, 50% and 97.5% quantiles of the
bootstrap distribution. The second slot contains the complete distribution.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Analyzing rates of evolution' and in the help 
# page of rate_gls.
</code></pre>

<hr>
<h2 id='rate_gls_sim'>Simulate responses from <code><a href="#topic+rate_gls">rate_gls</a></code> fit</h2><span id='topic+rate_gls_sim'></span>

<h3>Description</h3>

<p><code>rate_gls_sim</code> responses from the models defined by an object of class
<code>'rate_gls'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rate_gls_sim(object, nsim = 10)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rate_gls_sim_+3A_object">object</code></td>
<td>
<p>The fitted object from <code><a href="#topic+rate_gls">rate_gls</a></code></p>
</td></tr>
<tr><td><code id="rate_gls_sim_+3A_nsim">nsim</code></td>
<td>
<p>The number of simulations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rate_gls_sim</code> simply passes the estimates in an object of
class <code>'rate_gls'</code> to the function <code><a href="#topic+simulate_rate">simulate_rate</a></code> for
simulating responses of the evolutionary process. It is mainly intended for
internal use in <code><a href="#topic+rate_gls_boot">rate_gls_boot</a></code>.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'simulate_rate'</code>, which is a list
with the following components: </p>

<table>
<tr>
 <td style="text-align: left;"> <code>tips</code>
  </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> A data frame of x and y values for the tips. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>percent_negative_roots</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The percent of iterations
  with negative roots in the rates of y (not given for model =
  'recent_evol'). </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>compl_dynamics</code>  </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> A list with the
  output of the complete dynamics (not given for model = 'recent_evol'). </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See the vignette 'Analyzing rates of evolution'.
</code></pre>

<hr>
<h2 id='round_and_format'>Rounds and formats in the same function</h2><span id='topic+round_and_format'></span>

<h3>Description</h3>

<p><code>round_and_format</code> rounds and formats a numeric vector. This is useful for
providing output for tables or plots in a standardized format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_and_format(
  x,
  digits = 2,
  sign_digits = NULL,
  scientific = FALSE,
  trim = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="round_and_format_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="round_and_format_+3A_digits">digits</code></td>
<td>
<p>Number of decimal places.</p>
</td></tr>
<tr><td><code id="round_and_format_+3A_sign_digits">sign_digits</code></td>
<td>
<p>Number of significant digits (if given this overrides
<code>digits</code>).</p>
</td></tr>
<tr><td><code id="round_and_format_+3A_scientific">scientific</code></td>
<td>
<p>logical: whether encoding should be in scientific notation or
not.</p>
</td></tr>
<tr><td><code id="round_and_format_+3A_trim">trim</code></td>
<td>
<p>logical: if leading blanks for justification to common width should
be excluded or not.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Rounded and formatted values as characters.
</p>


<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>

<hr>
<h2 id='simulate_rate'>Simulating evolutionary rate model</h2><span id='topic+simulate_rate'></span>

<h3>Description</h3>

<p><code>simulate_rate</code> Simulates three different evolutionary rates models. In
the two first, 'predictor_BM' and 'predictor_gBM', the evolution of y follows
a Brownian motion with variance linear in x, while the evolution of x either
follows a Brownian motion or a geometric Brownian motion, respectively. In
the third model, 'recent_evol', the residuals of the macroevolutionary
predictions of y have variance linear in x.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_rate(
  tree,
  startv_x = NULL,
  sigma_x = NULL,
  a,
  b,
  sigma_y = NULL,
  x = NULL,
  model = "predictor_BM"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_rate_+3A_tree">tree</code></td>
<td>
<p>A <code>phylo</code> object. Must be ultrametric and scaled to
unit length.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_startv_x">startv_x</code></td>
<td>
<p>The starting value for x (usually 0 for 'predictor_BM' and
'recent_evol', and 1 for 'predictor_gBM').</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_sigma_x">sigma_x</code></td>
<td>
<p>The evolutionary rate of x.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_a">a</code></td>
<td>
<p>A parameter of the evolutionary rate of y.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_b">b</code></td>
<td>
<p>A parameter of the evolutionary rate of y.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_sigma_y">sigma_y</code></td>
<td>
<p>The evolutionary rate for the macroevolution of y (Brownian
motion process) used in the 'recent_evolution' model.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_x">x</code></td>
<td>
<p>Optional fixed values of x (only for the 'recent_evol' model), must
equal number of tips in the phylogeny, must correspond to the order of the
tip labels.</p>
</td></tr>
<tr><td><code id="simulate_rate_+3A_model">model</code></td>
<td>
<p>Either a Brownian motion model of x 'predictor_BM', geometric
Brownian motion model of x 'predictor_gBM', or 'recent_evol'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the vignette 'Analyzing rates of evolution' for an explanation
of the evolutionary models. The data of the tips can be analyzed with the
function <code><a href="#topic+rate_gls">rate_gls</a></code>. Note that a large part of parameter space
will cause negative roots in the rates of y (i.e. negative a+bx). In these
cases the rates are set to 0. A warning message is given if the number of
such instances is larger than 0.1%. For model 1 and 2, it is possible to
set &lsquo;a=&rsquo;scaleme'', if this chosen then 'a' will be given the lowest
possible value constrained by a+bx&gt;0.
</p>


<h3>Value</h3>

<p>An object of <code>class</code> <code>'simulate_rate'</code>, which is a list
with the following components: </p>

<table>
<tr>
 <td style="text-align: left;"> <code>tips</code>
  </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> A data frame of x and y values for the tips. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>percent_negative_roots</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The percent of iterations
  with negative roots in the rates of y (not given for model =
  'recent_evol'). </td>
</tr>
<tr>
 <td style="text-align: left;"> <code>compl_dynamics</code>  </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> A list with the
  output of the complete dynamics (not given for model = 'recent_evol'). </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Also see the vignette 'Analyzing rates of evolution'.
## Not run: 
# Generating a tree with 50 species
set.seed(102)
tree &lt;- ape::rtree(n = 50)
tree &lt;- ape::chronopl(tree, lambda = 1, age.min = 1)

### model = 'predictor_BM' ###
sim_data &lt;- simulate_rate(tree, startv_x = 0, sigma_x = 0.25, a = 1, b = 1, 
model = "predictor_BM")
head(sim_data$tips)
par(mfrow = c(1, 3))
plot(sim_data)
plot(sim_data, response = "y")
plot(sim_data, response = "x")
par(mfrow = c(1, 1))

### model = 'predictor_gBM' ###
sim_data &lt;- simulate_rate(tree, startv_x = 1, sigma_x = 1, a = 1, b = 0.1, 
model = "predictor_gBM")
head(sim_data$tips)
par(mfrow = c(1, 3))
plot(sim_data)
plot(sim_data, response = "y")
plot(sim_data, response = "x")
par(mfrow = c(1, 1))

### model = 'recent_evol' ###
sim_data &lt;- simulate_rate(tree,
  startv_x = 0, sigma_x = 1, a = 1, b = 1, sigma_y = 1,
  model = "recent_evol"
)
head(sim_data$tips)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.evolvabilityBeta'>Summarizing evolvability parameters over a set of selection gradients</h2><span id='topic+summary.evolvabilityBeta'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>'evolvabilityBeta'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evolvabilityBeta'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.evolvabilityBeta_+3A_object">object</code></td>
<td>
<p>An object of class <code>'evolvabilityBeta'</code>.</p>
</td></tr>
<tr><td><code id="summary.evolvabilityBeta_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>Averages</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The averages of the evolvability parameters 
over all selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Minimum</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The minimum of the evolvability parameters 
over all selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>Maximum</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The maximum of the evolvability parameters 
over all selection gradients.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evolvabilityBeta">evolvabilityBeta</a></code>
</p>

<hr>
<h2 id='summary.evolvabilityBetaMCMC'>Summarizing posterior distribution of evolvability parameters over a set of
selection gradients</h2><span id='topic+summary.evolvabilityBetaMCMC'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>'evolvabilityBetaMCMC'</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evolvabilityBetaMCMC'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.evolvabilityBetaMCMC_+3A_object">object</code></td>
<td>
<p>an object of class <code>'evolvabilityBetaMCMC'</code>.</p>
</td></tr>
<tr><td><code id="summary.evolvabilityBetaMCMC_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<table>
<tr>
 <td style="text-align: left;">
  <code>Averages</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The averages of the evolvability parameters
   over all selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>Minimum</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The minimum (given by the posterior median)
   of the evolvability parameters over all selection gradients. </td>
</tr>
<tr>
 <td style="text-align: left;">
  <code>Maximum</code> </td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"></td><td style="text-align: left;"> The maximum (given by the posterior median)
   of the evolvability parameters over all selection gradients.
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Geir H. Bolstad
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evolvabilityBetaMCMC">evolvabilityBetaMCMC</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
