<!DOCTYPE html><html><head><title>Help for package r2mlm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {r2mlm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#r2mlm'><p>Compute R-squared values for multilevel models, automatically inputting</p>
parameter estimates.</a></li>
<li><a href='#r2mlm_ci'><p>Compute confidence intervals for R-squared in multilevel models.</p></a></li>
<li><a href='#r2mlm_comp'><p>Compute R-squared differences between two multilevel models, automatically</p>
inputting parameter estimates.</a></li>
<li><a href='#r2mlm_comp_manual'><p>Compute R-squared differences between two multilevel models, manually</p>
inputting parameter estimates.</a></li>
<li><a href='#r2mlm_long_manual'><p>Compute R-squared values for longitudinal multilevel models, manually</p>
inputting parameter estimates.</a></li>
<li><a href='#r2mlm_manual'><p>Compute R-squared values for multilevel models, manually inputting parameter</p>
estimates.</a></li>
<li><a href='#r2mlm3_manual'><p>Compute R-squared values for three-level multilevel models, manually</p>
inputting parameter estimates.</a></li>
<li><a href='#teachsat'><p>Teacher job satisfaction.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R-Squared Measures for Multilevel Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.7</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Mairead Shaw &lt;mairead.shaw@mail.mcgill.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates both total- and level-specific R-squared measures from
    Rights and Sterba’s (2019) &lt;<a href="https://doi.org/10.1037%2Fmet0000184">doi:10.1037/met0000184</a>&gt; framework of R-squared measures for multilevel
    models with random intercepts and/or slopes, which is based on a complete
    decomposition of variance. Additionally generates graphical 
    representations of these R-squared measures to allow visualizing and 
    interpreting all measures in the framework together as an integrated set.
    This framework subsumes 10 previously-developed R-squared measures for 
    multilevel models as special cases of 5 measures from the framework, and it
    also includes several newly-developed measures. Measures in the framework 
    can be used to compute R-squared differences when comparing multilevel 
    models (following procedures in Rights &amp; Sterba (2020) &lt;<a href="https://doi.org/10.1080%2F00273171.2019.1660605">doi:10.1080/00273171.2019.1660605</a>&gt;).
    Bootstrapped confidence intervals can also be calculated. To use the 
    confidence interval functionality, download bootmlm from <a href="https://github.com/marklhc/bootmlm">https://github.com/marklhc/bootmlm</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr (&ge; 0.8.5), magrittr (&ge; 1.5), methods (&ge; 3.6.3), rlang
(&ge; 0.4.6), rockchalk (&ge; 1.8.157), stringr (&ge; 1.4.0),
tidyselect (&ge; 1.0.0)</td>
</tr>
<tr>
<td>Depends:</td>
<td>lme4 (&ge; 1.1.23), nlme (&ge; 3.1.14), R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bootmlm, testthat, Matrix</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mkshaw/r2mlm">https://github.com/mkshaw/r2mlm</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mkshaw/r2mlm/issues">https://github.com/mkshaw/r2mlm/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 15:29:38 UTC; maireadshaw</td>
</tr>
<tr>
<td>Author:</td>
<td>Mairead Shaw [aut, cre],
  Jason Rights [aut],
  Sonya Sterba [aut],
  Jessica Flake [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 15:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='r2mlm'>Compute R-squared values for multilevel models, automatically inputting
parameter estimates.</h2><span id='topic+r2mlm'></span>

<h3>Description</h3>

<p><code>r2mlm</code> reads in a multilevel model (MLM) object generated using
<code><a href="lme4.html#topic+lmer">lmer</a></code> or <code><a href="nlme.html#topic+nlme">nlme</a></code>, and outputs all
relevant R-squared measures from the Rights and Sterba (2019) framework of
multilevel model R-squared measures, which can be visualized together as a
set using the outputted bar chart decompositions of outcome variance. That is,
when predictors are cluster-mean-centered, all R-squared measures from Rights
&amp; Sterba (2019) Table 1 and decompositions from Rights &amp; Sterba (2019) Figure
1 are outputted. When predictors are not cluster-mean-centered, the total
R-squared measures from Rights &amp; Sterba (2019) Table 5, as well as bar chart
decompositions are outputted. Any number of level-1 and/or level-2 predictors
is supported. Any of the level-1 predictors can have random slopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm(model, bargraph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_+3A_model">model</code></td>
<td>
<p>A model generated using <code><a href="lme4.html#topic+lmer">lmer</a></code> or
<code><a href="nlme.html#topic+nlme">nlme</a></code>. Note that models using <code>lmer</code> must specify
random effects at the end of the model, like so: <code>outcome ~ 1 +
fixed_effects + (random_effects | cluster_variable)</code>. Anything else (e.g.,
<code>outcome ~ 1 + (random_effects | cluster_variable) + fixed_effects</code>)
will not work.</p>
</td></tr>
<tr><td><code id="r2mlm_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>r2mlm</code> first determines whether a given model was generated using
<code><a href="lme4.html#topic+lmer">lmer</a></code> or <code><a href="nlme.html#topic+nlme">nlme</a></code>, then passes the model
to helper functions that pull the raw data and parameter estimates from the
model, and pass that information to <code><a href="#topic+r2mlm_manual">r2mlm_manual</a></code>.
</p>
<p>Previous MLM literature has offered two perspectives on how to treat variance
attributable to random intercepts and slopes, called the “marginal” and
“conditional” approaches (e.g., Edwards et al., 2008; Orelien &amp; Edwards,
2008; Vonesh &amp; Chinchilli, 1997; Wang &amp; Schaalje, 2009; Xu, 2003). In the
marginal approach, all variance attributable to predictors via random slope
variation and attributable to cluster means via random intercept variation
(i.e., sources “v” and “m”) is treated as unexplained. In the conditional
approach, variance attributable to predictors via random slope variation
and/or attributable to cluster mean variation is treated as explained. This
package offers researchers access to both the marginal and conditional
approaches. There are 5 marginal measures: f1_total, f2_total, f_total,
f1_within, and f2_between. The other 7 measures are conditional: v_total,
m_total, fv_total, fvm_total, v_within, f1v_within, and m_between.
</p>


<h3>Value</h3>

<p>If the input is a valid model, then the output will be a list and
associated graphical representation of R-squared decompositions. If the
model is not valid, it will return an error prompting the user to input a
valid model.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained
variance in multilevel models: An integrative framework for defining
R-squared measures. Psychological Methods, 24(3), 309–338.
&lt;doi:10.1037/met0000184&gt;
</p>
<p>Other r2mlm single model functions: 
<code><a href="#topic+r2mlm3_manual">r2mlm3_manual</a>()</code>,
<code><a href="#topic+r2mlm_ci">r2mlm_ci</a>()</code>,
<code><a href="#topic+r2mlm_long_manual">r2mlm_long_manual</a>()</code>,
<code><a href="#topic+r2mlm_manual">r2mlm_manual</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using lme4 for your model

# The "bobyqa" optimizer is required for this particular model to converge

model_lme4 &lt;- lmer(satisfaction ~ 1 + salary_c + control_c + salary_m + control_m +
s_t_ratio + (1 + salary_c + control_c| schoolID), data = teachsat, REML =
TRUE, control = lmerControl(optimizer = "bobyqa"))

r2mlm(model_lme4)

# Using nlme for your model

model_nlme &lt;- lme(satisfaction ~ 1 + salary_c + control_c + salary_m +
                  control_m + s_t_ratio,
                  random = ~ 1 + salary_c + control_c | schoolID,
                  data = teachsat,
                  method = "REML",
                  control = lmeControl(opt = "optim"))

r2mlm(model_nlme)

</code></pre>

<hr>
<h2 id='r2mlm_ci'>Compute confidence intervals for R-squared in multilevel models.</h2><span id='topic+r2mlm_ci'></span>

<h3>Description</h3>

<p><code>r2mlm_ci</code> reads in a multilevel model (MLM) object generated using
<code><a href="lme4.html#topic+lmer">lmer</a></code> or <code><a href="nlme.html#topic+nlme">nlme</a></code> along with bootstrap
specifications and returns the upper and lower bounds of confidence intervals
for all R-squared measures available in the <code>r2mlm</code> framework.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm_ci(model, nsim, boottype, confinttype, level = 0.95, progress = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_ci_+3A_model">model</code></td>
<td>
<p>A model generated using <code><a href="lme4.html#topic+lmer">lmer</a></code> or
<code><a href="nlme.html#topic+nlme">nlme</a></code>. Note that models using <code>lmer</code> must specify
random effects at the end of the model, like so: <code>outcome ~ 1 +
fixed_effects + (random_effects | cluster_variable)</code>. Anything else (e.g.,
<code>outcome ~ 1 + (random_effects | cluster_variable) + fixed_effects</code>)
will not work.</p>
</td></tr>
<tr><td><code id="r2mlm_ci_+3A_nsim">nsim</code></td>
<td>
<p>The number of bootstrapping iterations to use for the
bootstrapped sampling distribution. Common values are 500 and 1000.</p>
</td></tr>
<tr><td><code id="r2mlm_ci_+3A_boottype">boottype</code></td>
<td>
<p>A character vector for the type of bootstrapping to perform.
Options are parametric and residual. Parametric bootstrapping assumes
normally distributed residuals, whereas residual does not.</p>
</td></tr>
<tr><td><code id="r2mlm_ci_+3A_confinttype">confinttype</code></td>
<td>
<p>A character vector for the type of confidence interval to
calculate. Options are norm (for normal), basic, and perc (for percentile).</p>
</td></tr>
<tr><td><code id="r2mlm_ci_+3A_level">level</code></td>
<td>
<p>The desired confidence level, defaults to 0.95, yielding a 95
confidence interval.</p>
</td></tr>
<tr><td><code id="r2mlm_ci_+3A_progress">progress</code></td>
<td>
<p>TRUE/FALSE for printing progress bar or not, defaults to
TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that bootstrapping confidence intervals for many R-squared values at
once is computationally intensive, and as a result runs somewhat slowly. For
this reason, the progress bar displays by default.
</p>


<h3>Value</h3>

<p>If the input is a valid model, then the output will be a list of
R-squared confidence intervals for all 12 measures estimated by the r2mlm
function.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained
variance in multilevel models: An integrative framework for defining
R-squared measures. Psychological Methods, 24(3), 309–338.
&lt;doi:10.1037/met0000184&gt;
</p>
<p>Other r2mlm single model functions: 
<code><a href="#topic+r2mlm3_manual">r2mlm3_manual</a>()</code>,
<code><a href="#topic+r2mlm_long_manual">r2mlm_long_manual</a>()</code>,
<code><a href="#topic+r2mlm_manual">r2mlm_manual</a>()</code>,
<code><a href="#topic+r2mlm">r2mlm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# The "bobyqa" optimizer is required for this particular model to converge

model_lme4 &lt;- lmer(satisfaction ~ 1 + salary_c + control_c + salary_m + control_m +
s_t_ratio + (1 + salary_c + control_c| schoolID), data = teachsat, REML =
TRUE, control = lmerControl(optimizer = "bobyqa"))

r2mlm_ci(model = model_lme4,
         nsim = 100,
         boottype = c("residual"),
         confinttype = c("perc"),
         level = 0.95,
         progress = TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='r2mlm_comp'>Compute R-squared differences between two multilevel models, automatically
inputting parameter estimates.</h2><span id='topic+r2mlm_comp'></span>

<h3>Description</h3>

<p><code>r2mlm_comp</code> reads in two multilevel models (MLMs) (generated using
<code><a href="lme4.html#topic+lmer">lmer</a></code> or <code><a href="nlme.html#topic+nlme">nlme</a></code>) under comparison
(designated Model A and Model B), and outputs all R-squared measures in the
Rights and Sterba (2019) framework for both models, as well as R-squared
differences between the two models. Definitions of these R-squared difference
measures are provided in Rights &amp; Sterba (2020) Table 1; importantly, to
detect the impact of a specific kind of term (e.g., the kind of term added to
Model A to form Model B), a particular target single-source R-squared
difference measure from this framework is used. For instructions on how to
identify which target single-source R-squared difference measure to interpret
to detect the impact of which kind of term that distinguishes Model A from B,
see Rights and Sterba (2020) Table 2. Additionally, this function produces
side-by-side graphical comparisons of the R-squared measures for Model A vs.
Model B that can be used to visualize changes in each measure across models.
This function assumes all level-1 predictors are cluster-mean-centered, for
reasons described in Rights &amp; Sterba (2020). Any number of level-1 and/or
level-2 predictors is supported and any of the level-1 predictors can have
random slopes. This function can be used with either the hierarchical or the
simultaneous model-building approach described in Rights and Sterba (2020).
This function can be used with either nested or non-nested model comparisons
(in which R-squared estimates for Model A are subtracted from those for Model
B).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm_comp(modelA, modelB, data = NULL, bargraph = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_comp_+3A_modela">modelA</code>, <code id="r2mlm_comp_+3A_modelb">modelB</code></td>
<td>
<p>Models generated using <code><a href="lme4.html#topic+lmer">lmer</a></code> or
<code><a href="nlme.html#topic+nlme">nlme</a></code>. Note that models using <code>lmer</code> must specify
random effects at the end of the model, like so: <code>outcome ~ 1 +
fixed_effects + (random_effects | cluster_variable)</code>. Anything else (e.g.,
<code>outcome ~ 1 + (random_effects | cluster_variable) + fixed_effects</code>)
will not work.</p>
</td></tr>
<tr><td><code id="r2mlm_comp_+3A_data">data</code></td>
<td>
<p>Optional argument, only needed if models are not hierarchical.
Dataset with rows denoting observations and columns denoting variables.</p>
</td></tr>
<tr><td><code id="r2mlm_comp_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Assumes that both models are fit with lmer or both models are fit with nlme.
</p>


<h3>Value</h3>

<p>If the inputs are valid models, then the output will be a list and
associated graphical representation of R-squared decompositions. If the
models are not valid, the function will return an error prompting the user
to input valid models.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained
variance in multilevel models: An integrative framework for defining
R-squared measures. Psychological Methods, 24(3), 309–338.
&lt;doi:10.1037/met0000184&gt;
</p>
<p>Rights, J. D., &amp; Sterba, S. K. (2020). New recommendations on the
use of R-squared differences in multilevel model comparisons. Multivariate
Behavioral Research. &lt;doi:10.1080/00273171.2019.1660605&gt;
</p>
<p>Other r2mlm model comparison functions: 
<code><a href="#topic+r2mlm_comp_manual">r2mlm_comp_manual</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Using lme4 for your model
# The "bobyqa" optimizer is required for these particular models to converge

## Not run:  # Model A, no "salary" components included

modelA_lme4 &lt;- lmer(satisfaction ~ 1 + control_c + control_m + s_t_ratio + (1
+ control_c | schoolID), data = teachsat, REML = TRUE, control =
lmerControl(optimizer = "bobyqa"))

# Model B, full model with "salary" components included

modelB_lme4 &lt;- lmer(satisfaction ~ 1 + salary_c + control_c + salary_m +
control_m + s_t_ratio + (1 + salary_c + control_c | schoolID), data =
teachsat, REML = TRUE, control = lmerControl(optimizer = "bobyqa"))

# Compare models
r2mlm_comp(modelA_lme4, modelB_lme4)

# Compare models, optional data argument specified
r2mlm_comp(modelA_lme4, modelB_lme4, teachsat)

# Using nlme for your model

# Model A, no "salary" components included

modelA_nlme &lt;- lme(satisfaction ~ 1 + control_c + control_m + s_t_ratio,
                  random = ~ 1 + control_c | schoolID,
                  data = teachsat,
                  method = "REML",
                  control = lmeControl(opt = "optim"))

# Model B, full model with "salary" components included

modelB_nlme &lt;- lme(satisfaction ~ 1 + salary_c + control_c + salary_m +
                  control_m + s_t_ratio,
                  random = ~ 1 + salary_c + control_c | schoolID,
                  data = teachsat,
                  method = "REML",
                  control = lmeControl(opt = "optim"))

# Compare models
r2mlm_comp(modelA_nlme, modelB_nlme)

# Compare models, optional data argument specified
r2mlm_comp(modelA_nlme, modelB_nlme, teachsat)

## End(Not run)

</code></pre>

<hr>
<h2 id='r2mlm_comp_manual'>Compute R-squared differences between two multilevel models, manually
inputting parameter estimates.</h2><span id='topic+r2mlm_comp_manual'></span>

<h3>Description</h3>

<p><code>r2mlm_comp_manual</code> reads in raw data and multilevel model (MLM)
parameter estimates from two separate models under comparison (designated
Model A and Model B), and outputs all R-squared measures in the Rights and
Sterba (2019) framework for both models, as well as R-squared differences
between the two models. Definitions of these R-squared difference measures
are provided in Rights &amp; Sterba (2020) Table 1; importantly, to detect the
impact of a specific kind of term (e.g., the kind of term added to Model A to
form Model B), a particular target single-source R-squared difference measure
from this framework is used. For instructions on how to identify which target
single-source R-squared difference measure to interpret to detect the impact
of which kind of term that distinguishes Model A from B, see Rights and
Sterba (2020) Table 2. Additionally, this function produces side-by-side
graphical comparisons of the R-squared measures for Model A vs. Model B that
can be used to visualize changes in each measure across models. This function
assumes all level-1 predictors are cluster-mean-centered for reasons
described in Rights &amp; Sterba (2020). Any number of level-1 and/or level-2
predictors is supported and any of the level-1 predictors can have random
slopes. This function can be used with either the hierarchical or the
simultaneous model-building approach described in Rights and Sterba (2020).
This function can also be used with either nested or non-nested model
comparisons (in which R-squared estimates for Model A are subtracted from
those for Model B).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm_comp_manual(
  data,
  within_covs_modA,
  between_covs_modA,
  random_covs_modA,
  gamma_w_modA,
  gamma_b_modA,
  Tau_modA,
  sigma2_modA,
  within_covs_modB,
  between_covs_modB,
  random_covs_modB,
  gamma_w_modB,
  gamma_b_modB,
  Tau_modB,
  sigma2_modB,
  bargraph = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_comp_manual_+3A_data">data</code></td>
<td>
<p>Dataset with rows denoting observations and columns denoting
variables.</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_within_covs_moda">within_covs_modA</code>, <code id="r2mlm_comp_manual_+3A_within_covs_modb">within_covs_modB</code></td>
<td>
<p>List of numbers corresponding to the
columns in the dataset of the level-1 predictors used in the MLM (if none
used, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_between_covs_moda">between_covs_modA</code>, <code id="r2mlm_comp_manual_+3A_between_covs_modb">between_covs_modB</code></td>
<td>
<p>List of numbers corresponding to
the columns in the dataset of the level-2 predictors used in the MLM (if
none used, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_random_covs_moda">random_covs_modA</code>, <code id="r2mlm_comp_manual_+3A_random_covs_modb">random_covs_modB</code></td>
<td>
<p>List of numbers corresponding to the
columns in the dataset of the level-1 predictors that have random slopes in
the MLM (if no random slopes, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_gamma_w_moda">gamma_w_modA</code>, <code id="r2mlm_comp_manual_+3A_gamma_w_modb">gamma_w_modB</code></td>
<td>
<p>Vector of fixed slope estimates for all
level-1 predictors, to be entered in the order of the predictors listed by
within_covs (if none, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_gamma_b_moda">gamma_b_modA</code>, <code id="r2mlm_comp_manual_+3A_gamma_b_modb">gamma_b_modB</code></td>
<td>
<p>Vector of fixed intercept estimate (if
applicable; see has_intercept below) and fixed slope estimates for all
level-2 predictors, to be entered intercept first (if applicable) followed
by level-2 slopes in the order listed by between_covs (if none, set to
NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_tau_moda">Tau_modA</code>, <code id="r2mlm_comp_manual_+3A_tau_modb">Tau_modB</code></td>
<td>
<p>Random effect covariance matrix; note that the first
row/column denotes the intercept variance and covariances (if intercept is
fixed, set all to 0) and each subsequent row/column denotes a given random
slope’s variance and covariances (to be entered in the order listed by
random_covs).</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_sigma2_moda">sigma2_modA</code>, <code id="r2mlm_comp_manual_+3A_sigma2_modb">sigma2_modB</code></td>
<td>
<p>Level-1 residual variance.</p>
</td></tr>
<tr><td><code id="r2mlm_comp_manual_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the inputs are valid models, then the output will be a list and
associated graphical representation of R-squared decompositions.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained
variance in multilevel models: An integrative framework for defining
R-squared measures. Psychological Methods, 24(3), 309–338.
&lt;doi:10.1037/met0000184&gt;
</p>
<p>Rights, J. D., &amp; Sterba, S. K. (2020). New recommendations on the
use of R-squared differences in multilevel model comparisons. Multivariate
Behavioral Research. &lt;doi:10.1080/00273171.2019.1660605&gt;
</p>
<p>Other r2mlm model comparison functions: 
<code><a href="#topic+r2mlm_comp">r2mlm_comp</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Model A: no "salary" components included

modelA &lt;- lmer(satisfaction ~ 1 + control_c + control_m + s_t_ratio + (1 +
control_c | schoolID), data = teachsat, REML = TRUE, control =
lmerControl(optimizer = "bobyqa"))

# Model B: full model with "salary" components included

modelB &lt;- lmer(satisfaction ~ 1 + salary_c + control_c + salary_m + control_m
+ s_t_ratio + (1 + salary_c + control_c | schoolID), data = teachsat, REML =
TRUE, control = lmerControl(optimizer = "bobyqa"))

r2mlm_comp_manual(data = teachsat,
                  within_covs_modA = c(4),
                  between_covs_modA = c(6, 8),
                  random_covs_modA = c(4),
                  gamma_w_modA = c(0.314410),
                  gamma_b_modA = c(6.892046, 0.059464, -0.037376),
                  Tau_modA = matrix(c(0.559, 0.0105, 0.0105, 0.0273),
                                    2, 2),
                  sigma2_modA = 1.19295,
                  within_covs_modB = c(5, 4),
                  between_covs_modB = c(7, 6, 8),
                  random_covs_modB = c(5, 4),
                  gamma_w_modB = c(0.074485, 0.310800),
                  gamma_b_modB = c(4.352652, 0.036759, 0.027532, -0.035250),
                  Tau_modB = matrix(c(0.387, 0.0000646, 0.00625,
                                      0.0000646, 0.00277, -0.000333,
                                      0.00625, -0.000333, 0.0285), 3, 3),
                 sigma2_modB = 0.550311)

</code></pre>

<hr>
<h2 id='r2mlm_long_manual'>Compute R-squared values for longitudinal multilevel models, manually
inputting parameter estimates.</h2><span id='topic+r2mlm_long_manual'></span>

<h3>Description</h3>

<p><code>r2mlm_long_manual</code> takes as input raw data and  multilevel model (MLM)
parameter estimates and outputs all relevant R-squared measures as well as an
accompanying bar chart. This function extends the <code>r2mlm_manual</code>
function by allowing researchers to input heteroscedastic variance estimates,
and by providing level-specific measures for non-cluster-mean-centered
models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm_long_manual(
  data,
  covs,
  random_covs,
  clusterID,
  gammas,
  Tau,
  sigma2,
  bargraph = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_long_manual_+3A_data">data</code></td>
<td>
<p>Dataset with rows denoting observations and columns denoting
variables</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_covs">covs</code></td>
<td>
<p>list of predictors in the dataset that have fixed components of
slopes included in the model (if none, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_random_covs">random_covs</code></td>
<td>
<p>list of predictors in the dataset that have random
components of slopes included in the model (if none, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_clusterid">clusterID</code></td>
<td>
<p>variable name in dataset corresponding to cluster (e.g.,
person) identification</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_gammas">gammas</code></td>
<td>
<p>vector containing estimated fixed components of all slopes,
listed in the order specified in covs (if none, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_tau">Tau</code></td>
<td>
<p>random effect covariance matrix; the first row and the first
column denote the intercept variance and covariances and each subsequent
row/column denotes a given random slope’s variance and covariances (to be
entered in the order listed by random_covs)</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_sigma2">sigma2</code></td>
<td>
<p>level-1 residual variance; can be entered as a single number,
or as a set of numbers, for example corresponding to different residual
variances at individual timepoints; if entered as a set of numbers,
function will assume equal weights and take the raw average of these to
estimate the expectation of the error variance</p>
</td></tr>
<tr><td><code id="r2mlm_long_manual_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reads in raw data as well as parameter estimates from the
researcher’s previously fit longitudinal growth model (hence, any software
program can have been used to fit the researcher’s longitudinal growth model
prior to the use of this R function, so long as parameter estimates from the
fitted model are recorded; note that this function accommodates
non-longitudinal models as well). This function then outputs R-squared
measures as well as variance decompositions and associated bar charts
outlined in Rights &amp; Sterba (2021). This function allows researchers to input
heteroscedastic residual variance by including multiple estimates, for
example, corresponding to individual timepoints. Users need not specify if
predictors are person-mean-centered or not—the function will automatically
output total, within-person, and between-person variance attributable to each
potential source of explained variance (f1, f2, v1, v2, and m). Note,
however, that the interpretations of these sources differ for
person-mean-centered versus non-person-mean-centered models and that variance
attributable to v2 will necessarily be 0 for person-mean-centered models.
</p>


<h3>Value</h3>

<p>If the input is valid, then the output will be a list and associated
graphical representation of R-squared decompositions. If the input is not
valid, it will return an error.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2021). Effect size measures for
longitudinal growth analyses: Extending a framework of multilevel model
R-squareds to accommodate heteroscedasticity, autocorrelation,
nonlinearity, and alternative centering strategies. New Directions for
Child and Adolescent Development, 2021, 65– 110. &lt;doi:10.1002/cad.20387&gt;
</p>
<p>Other r2mlm single model functions: 
<code><a href="#topic+r2mlm3_manual">r2mlm3_manual</a>()</code>,
<code><a href="#topic+r2mlm_ci">r2mlm_ci</a>()</code>,
<code><a href="#topic+r2mlm_manual">r2mlm_manual</a>()</code>,
<code><a href="#topic+r2mlm">r2mlm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Removing cluster-mean-centering from the teachsat dataset, for
# demonstration purposes

teachsat$salary &lt;- teachsat$salary_c + 2
uncentered_model &lt;- lmer(satisfaction ~ salary + (1 | schoolID), data = teachsat)

r2mlm_long_manual(data = teachsat,
                  covs = c("salary"),
                  random_covs = NULL,
                  clusterID = "schoolID",
                  gammas = c(0.07430),
                  Tau = as.matrix(Matrix::bdiag(VarCorr(uncentered_model))),
                  sigma2 = getME(uncentered_model, "sigma")^2,
                  bargraph = TRUE)

</code></pre>

<hr>
<h2 id='r2mlm_manual'>Compute R-squared values for multilevel models, manually inputting parameter
estimates.</h2><span id='topic+r2mlm_manual'></span>

<h3>Description</h3>

<p><code>r2mlm_manual</code> takes as input raw data and parameter estimates from a
multilevel model, and outputs all relevant R-squared measures from the Rights
and Sterba (2019) framework of R-squared measures for multilevel models,
which can be visualized together as a set using the outputted bar chart
decompositions of outcome variance. That is, when predictors are
cluster-mean-centered, all R-squared measures from Rights &amp; Sterba (2019)
Table 1 and decompositions from Rights &amp; Sterba (2019) Figure 1 are
outputted. When predictors are not cluster-mean-centered, the total
R-squareds from Rights &amp; Sterba (2019) Table 5, as well as bar chart
decompositions are outputted. Any number of level-1 and/or level-2 predictors
is supported. Any of the level-1 predictors can have random slopes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm_manual(
  data,
  within_covs,
  between_covs,
  random_covs,
  gamma_w,
  gamma_b,
  Tau,
  sigma2,
  has_intercept = TRUE,
  clustermeancentered = TRUE,
  bargraph = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm_manual_+3A_data">data</code></td>
<td>
<p>Dataset with rows denoting observations and columns denoting
variables.</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_within_covs">within_covs</code></td>
<td>
<p>List of numbers corresponding to the columns in the
dataset of the level-1 predictors used in the MLM (if none used, set to
NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_between_covs">between_covs</code></td>
<td>
<p>List of numbers corresponding to the columns in the
dataset of the level-2 predictors used in the MLM (if none used, set to
NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_random_covs">random_covs</code></td>
<td>
<p>List of numbers corresponding to the columns in the
dataset of the level-1 predictors that have random slopes in the MLM (if no
random slopes, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_gamma_w">gamma_w</code></td>
<td>
<p>Vector of fixed slope estimates for all level-1 predictors, to
be entered in the order of the predictors listed by within_covs (if none,
set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_gamma_b">gamma_b</code></td>
<td>
<p>Vector of fixed intercept estimate (if applicable; see
has_intercept below) and fixed slope estimates for all level-2 predictors,
to be entered intercept first (if applicable) followed by level-2 slopes in
the order listed by between_covs (if none, set to NULL).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_tau">Tau</code></td>
<td>
<p>Random effect covariance matrix; note that the first row/column
denotes the intercept variance and covariances (if intercept is fixed, set
all to 0) and each subsequent row/column denotes a given random slope’s
variance and covariances (to be entered in the order listed by
random_covs).</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_sigma2">sigma2</code></td>
<td>
<p>Level-1 residual variance.</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_has_intercept">has_intercept</code></td>
<td>
<p>If set to TRUE, the first element of gamma_b is assumed
to be the fixed intercept estimate; if set to FALSE, the first element of
gamma_b is assumed to be the first fixed level- 2 predictor slope; set to
TRUE by default.</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_clustermeancentered">clustermeancentered</code></td>
<td>
<p>If set to TRUE, all level-1 predictors (indicated
by the within_covs list) are assumed to be cluster-mean-centered and
function will output all decompositions; if set to FALSE, function will
output only total decompositions (see Description above); set to TRUE by
default.</p>
</td></tr>
<tr><td><code id="r2mlm_manual_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the input is valid, then the output will be a list and associated
graphical representation of R-squared decompositions. If the input is not
valid, it will return an error.
</p>


<h3>See Also</h3>

<p>Rights, J. D., &amp; Sterba, S. K. (2019). Quantifying explained
variance in multilevel models: An integrative framework for defining
R-squared measures. Psychological Methods, 24(3), 309–338.
&lt;doi:10.1080/00273171.2019.1660605&gt;
</p>
<p>Other r2mlm single model functions: 
<code><a href="#topic+r2mlm3_manual">r2mlm3_manual</a>()</code>,
<code><a href="#topic+r2mlm_ci">r2mlm_ci</a>()</code>,
<code><a href="#topic+r2mlm_long_manual">r2mlm_long_manual</a>()</code>,
<code><a href="#topic+r2mlm">r2mlm</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The bobyqa optimizer is required for this model to converge in lme4

model &lt;- lmer(satisfaction ~ 1 + salary_c + control_c + salary_m + control_m
+ s_t_ratio + (1 + salary_c + control_c | schoolID), data = teachsat, REML =
TRUE, control = lmerControl(optimizer = "bobyqa"))

r2mlm_manual(data = teachsat,
             within_covs = c(5, 4),
             between_covs = c(7, 6, 8),
             random_covs =  c(5, 4),
             gamma_w = c(0.074485, 0.310800),
             gamma_b = c(4.352652, 0.036759, 0.027532, -0.035250),
             Tau = matrix(c(0.387, 0.0000646,0.00625,
                            0.0000646, 0.00277, -0.000333,
                            0.00625, -0.000333, 0.0285), 3, 3),
             sigma2 = 0.55031,
             has_intercept = TRUE,
             clustermeancentered = TRUE)

</code></pre>

<hr>
<h2 id='r2mlm3_manual'>Compute R-squared values for three-level multilevel models, manually
inputting parameter estimates.</h2><span id='topic+r2mlm3_manual'></span>

<h3>Description</h3>

<p><code>r2mlm3_manual</code> takes as input raw data and three-level multilevel model
(MLM) parameter estimates and outputs all relevant R-squared measures as well
as an accompanying bar chart.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>r2mlm3_manual(
  data,
  l1_covs,
  l2_covs,
  l3_covs,
  random_covs12,
  random_covs13,
  random_covs23,
  gamma_1,
  gamma_2,
  gamma_3,
  Tau12,
  Tau13,
  Tau23,
  sigma2,
  clustermeancentered = TRUE,
  Tau2_noncmc = NULL,
  Tau3_noncmc = NULL,
  l2clusterID_noncmc = NULL,
  l3clusterID_noncmc = NULL,
  bargraph = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="r2mlm3_manual_+3A_data">data</code></td>
<td>
<p>Dataset with rows denoting observations and columns denoting
variables</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_l1_covs">l1_covs</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to the
columns in the dataset of the level-1 predictors used in the MLM (if none
used, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_l2_covs">l2_covs</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to the
columns in the dataset of the level-2 predictors used in the MLM (if none
used, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_l3_covs">l3_covs</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to the
columns in the dataset of the level-3 predictors used in the MLM (if none
used, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_random_covs12">random_covs12</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to
the columns in the dataset of the level-1 predictors that have random
slopes across level-2 units in the MLM (if no such random slopes, set to
NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_random_covs13">random_covs13</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to
the columns in the dataset of the level-1 predictors that have random
slopes across level-3 units in the MLM (if no such random slopes, set to
NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_random_covs23">random_covs23</code></td>
<td>
<p>Vector of numbers (or variable names) corresponding to
the columns in the dataset of the level-2 predictors that have random
slopes across level-3 units in the MLM (if no such random slopes, set to
NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_gamma_1">gamma_1</code></td>
<td>
<p>Vector of fixed slope estimates for all level-1 predictors, to
be entered in the order of the predictors listed by l1_covs (if none, set
to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_gamma_2">gamma_2</code></td>
<td>
<p>Vector of fixed slope estimates for all level-2 predictors, to
be entered in the order of the predictors listed by l2_covs (if none, set
to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_gamma_3">gamma_3</code></td>
<td>
<p>Vector of fixed slope estimates for all level-3 predictors, to
be entered in the order of the predictors listed by l3_covs (if none, set
to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_tau12">Tau12</code></td>
<td>
<p>For cluster-mean-centered model results (set to NULL if entering
non-cluster-mean-centered model results), this is the random effect
covariance matrix with the first row/column denoting the intercept variance
and covariances across level-2 units and each subsequent row/column denotes
a given level-1 predictor’s random slope variance and covariances across
level-2 units (to be entered in the order listed by random_covs12; if none,
set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_tau13">Tau13</code></td>
<td>
<p>For cluster-mean-centered model results (set to NULL if entering
non-cluster-mean-centered model results), this is the random effect
covariance matrix with the first row/column denoting the intercept variance
and covariances across level-3 units and each subsequent row/column denotes
a given level-1 predictor’s random slope variance and covariances across
level-3 units (to be entered in the order listed by random_covs13; if none,
set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_tau23">Tau23</code></td>
<td>
<p>For cluster-mean-centered model results (set to NULL if entering
non-cluster-mean-centered model results), this is the random effect
covariance matrix with each row/column denoting a given level-2 predictor’s
random slope variance and covariances across level-3 units (to be entered
in the order listed by random_covs23; if none, set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_sigma2">sigma2</code></td>
<td>
<p>Level-1 residual variance</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_clustermeancentered">clustermeancentered</code></td>
<td>
<p>By default, this argument is set to TRUE,
indicating that cluster-mean-centered model results are being inputted.
When instead entering non-cluster-mean-centered model results, set this
argument to FALSE. Additionally, for non-cluster-mean-centered model
results, random effect variances/covariances are to be entered in arguments
Tau2_noncmc and Tau3_noncmc (defined below), rather than in the Tau12,
Tau13, and Tau23 arguments used for cluster-mean-centered model results.
Additionally, when entering non-cluster-mean-centered model results, user
must specify l2clusterID_noncmc and l3clusterID_noncmc (neither of which
are necessary for cluster-mean-centered model results). Function input is
otherwise the same for cluster-mean-centered and non-cluster-mean-centered
model results.</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_tau2_noncmc">Tau2_noncmc</code></td>
<td>
<p>For non-cluster-mean-centered model results, this is the
level-2 random effect covariance matrix; the first row/column denotes the
intercept variance and covariances across level-2 units and each subsequent
row/column denotes a given predictor’s random slope variance and
covariances across level-2 units (to be entered in the order listed by
randomcovsl2_noncmc; by default, this argument is set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_tau3_noncmc">Tau3_noncmc</code></td>
<td>
<p>For non-cluster-mean-centered model results, this is the
level-3 random effect covariance matrix; the first row/column denotes the
intercept variance and covariances across level-3 units and each subsequent
row/column denotes a given predictor’s random slope variance and
covariances across level-3 units (to be entered in the order listed by
randomcovsl2_noncmc; by default, this argument is set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_l2clusterid_noncmc">l2clusterID_noncmc</code></td>
<td>
<p>For non-cluster-mean-centered model results, this
is the number (or variable name) corresponding to the column in the dataset
containing the level-2 cluster identification (function assumes that each
level-2 cluster ID is unique; by default, this argument is set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_l3clusterid_noncmc">l3clusterID_noncmc</code></td>
<td>
<p>For non-cluster-mean-centered model results, this
is the number (or variable name) corresponding to the column in the dataset
containing the level-3 cluster identification (function assumes that each
level-3 cluster ID is unique; by default, this argument is set to NULL)</p>
</td></tr>
<tr><td><code id="r2mlm3_manual_+3A_bargraph">bargraph</code></td>
<td>
<p>Optional bar graph output, default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can also accommodate two-level models. To input results
for two-level models, set the following arguments equal to NULL: l3_covs,
random_covs13, random_covs23, gamma_3, Tau13, Tau23.
</p>


<h3>Value</h3>

<p>If the input is valid, then the output will be a list and associated
graphical representation of R-squared decompositions. If the input is not
valid, it will return an error.
</p>


<h3>See Also</h3>

<p>Other r2mlm single model functions: 
<code><a href="#topic+r2mlm_ci">r2mlm_ci</a>()</code>,
<code><a href="#topic+r2mlm_long_manual">r2mlm_long_manual</a>()</code>,
<code><a href="#topic+r2mlm_manual">r2mlm_manual</a>()</code>,
<code><a href="#topic+r2mlm">r2mlm</a>()</code>
</p>

<hr>
<h2 id='teachsat'>Teacher job satisfaction.</h2><span id='topic+teachsat'></span>

<h3>Description</h3>

<p>A simulated dataset containing information about teacher job satisfaction.
Teachers clustered within schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>teachsat
</code></pre>


<h3>Format</h3>

<p>A data frame with 9000 rows and 8 columns:
</p>

<dl>
<dt>schoolID</dt><dd><p>school identification number</p>
</dd>
<dt>teacherID</dt><dd><p>teacher identification number</p>
</dd>
<dt>satisfaction</dt><dd><p>teacher job satisfaction, 1-10 scale</p>
</dd>
<dt>control_c</dt><dd><p>school-mean-centered rating of teacher's reported control over curriculum</p>
</dd>
<dt>salary_c</dt><dd><p>school-mean-centered teacher's salary (in thousands of dollars)</p>
</dd>
<dt>control_m</dt><dd><p>school mean rating of teacher's reported control over curriculum</p>
</dd>
<dt>salary_m</dt><dd><p>school mean teacher's salary (in thousands of dollars)</p>
</dd>
<dt>s_t_ratio</dt><dd><p>student to teacher ratio for the school (number of students per teacher)</p>
</dd>
</dl>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
