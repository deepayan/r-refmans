<!DOCTYPE html><html><head><title>Help for package multiwave</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {multiwave}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#brainHCP'><p>Time series obtained by an fMRI experiment on the brain</p></a></li>
<li><a href='#compute_nj'>
<p>Wavelets coefficients utilities</p></a></li>
<li><a href='#DWTexact'>
<p>Exact discrete wavelet decomposition</p></a></li>
<li><a href='#fivarma'>
<p>simulation of FIVARMA process</p></a></li>
<li><a href='#K_eval'>
<p>Evaluation of function <code class="reqn">K</code></p></a></li>
<li><a href='#mfw'>
<p>multivariate Fourier Whittle estimators</p></a></li>
<li><a href='#mfw_cov_eval'>
<p>multivariate Fourier Whittle estimators</p></a></li>
<li><a href='#mfw_eval'>
<p>evaluation of multivariate Fourier Whittle estimator</p></a></li>
<li><a href='#multiwave-package'>
<p>Estimation of multivariate long-memory models parameters: memory parameters and long-run covariance matrix (also called fractal connectivity).</p></a></li>
<li><a href='#mww'>
<p>multivariate wavelet Whittle estimation</p></a></li>
<li><a href='#mww_cov_eval'>
<p>multivariate wavelet Whittle estimation of the long-run covariance matrix</p></a></li>
<li><a href='#mww_eval'>
<p>evaluation of multivariate wavelet Whittle estimation</p></a></li>
<li><a href='#mww_wav'>
<p>multivariate wavelet Whittle estimation for data as wavelet coefficients</p></a></li>
<li><a href='#mww_wav_cov_eval'>
<p>multivariate wavelet Whittle estimation of the long-run covariance matrix</p></a></li>
<li><a href='#mww_wav_eval'>
<p>multivariate wavelet Whittle estimation for data as wavelet coefficients</p></a></li>
<li><a href='#psi_hat_exact'>
<p>discrete Fourier transform of the wavelet</p></a></li>
<li><a href='#scaling_filter'>
<p>wavelet scaling filter coefficients</p></a></li>
<li><a href='#scaling_function'>
<p>scaling function and the wavelet function</p></a></li>
<li><a href='#toeplitz_nonsym'>
<p>Transform a vector in a non symmetric Toeplitz matrix</p></a></li>
<li><a href='#varma'>
<p>simulation of multivariate ARMA process</p></a></li>
<li><a href='#vfracdiff'>
<p>simulation of vector fractional differencing process</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Multivariate Long-Memory Models Parameters</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sophie Achard &lt;sophie.achard@gipsa-lab.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computation of an estimation of the long-memory parameters and
     the long-run covariance matrix using a multivariate model
	 (Lobato (1999) &lt;<a href="https://doi.org/10.1016%2FS0304-4076%2898%2900038-4">doi:10.1016/S0304-4076(98)00038-4</a>&gt;; Shimotsu (2007) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2006.01.003">doi:10.1016/j.jeconom.2006.01.003</a>&gt;). Two semi-parametric methods are
	 implemented: a Fourier based approach (Shimotsu (2007) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2006.01.003">doi:10.1016/j.jeconom.2006.01.003</a>&gt;) and a wavelet based
	 approach (Achard and Gannaz (2016) &lt;<a href="https://doi.org/10.1111%2Fjtsa.12170">doi:10.1111/jtsa.12170</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-06 06:41:53 UTC; achards</td>
</tr>
<tr>
<td>Author:</td>
<td>Sophie Achard [aut, cre],
  Irene Gannaz [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-06 07:20:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='brainHCP'>Time series obtained by an fMRI experiment on the brain</h2><span id='topic+brainHCP'></span>

<h3>Description</h3>

<p>Time series for each region of interest in the brain. These series are obtained by SPM preprocessing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(brainHCP)</code></pre>


<h3>Format</h3>

<p>A data frame with 1200 observations on the following 89 variables.
</p>


<h3>Source</h3>

<p>contact S. Achard (sophie.achard@gipsa-lab.fr)
</p>


<h3>References</h3>

<p>M. Termenon, A. Jaillard, C. Delon-Martin, S. Achard (2016)
Reliability of graph analysis of resting state fMRI using test-retest dataset from the Human Connectome Project, <em>Neuroimage</em>, Vol 142, pages 172-187. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(brainHCP)
## maybe str(brainHCP) ; plot(brainHCP) ...
</code></pre>

<hr>
<h2 id='compute_nj'>
Wavelets coefficients utilities
</h2><span id='topic+compute_nj'></span>

<h3>Description</h3>

<p>Computes the number of wavelet coefficients at each scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_nj(n, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_nj_+3A_n">n</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code id="compute_nj_+3A_n">N</code></td>
<td>
<p>filter length.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>nj</code></td>
<td>
<p>number of coefficients at each scale.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>Number of scales.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>G. Fay, E. Moulines, F. Roueff, M. S. Taqqu (2009) 
Estimators of long-memory: Fourier versus wavelets. <em>Journal of Econometrics</em>, vol. 151, N. 2, pages 159-177.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DWTexact">DWTexact</a></code>, <code><a href="#topic+scaling_filter">scaling_filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
n &lt;- 5^10
N &lt;- length(filter)
compute_nj(n,N)
</code></pre>

<hr>
<h2 id='DWTexact'>
Exact discrete wavelet decomposition 
</h2><span id='topic+DWTexact'></span>

<h3>Description</h3>

<p>Computes the discrete wavelet transform of the data using the pyramidal algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DWTexact(x, filter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DWTexact_+3A_x">x</code></td>
<td>

<p>vector of raw data
</p>
</td></tr>
<tr><td><code id="DWTexact_+3A_filter">filter</code></td>
<td>
<p>Quadrature mirror filter (also called scaling filter, as returned by the <code>scaling_filter</code> function)
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>dwt</code></td>
<td>
<p>computable Wavelet coefficients without taking into account the border effect.</p>
</td></tr>
<tr><td><code>indmaxband</code></td>
<td>
<p>vector containing the largest index of each
band, i.e. for <code class="reqn">j &gt; 1</code> the wavelet coefficients of scale <code class="reqn">j</code> are <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [\code{indmaxband}(j-1)+1,\code{indmaxband}(j)]</code> and for  <code class="reqn">j=1</code>,  <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [1,\code{indmaxband}(1)]</code>.</p>
</td></tr>
<tr><td><code>Jmax</code></td>
<td>
<p>largest available scale index (=length of <code>indmaxband</code>).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function was rewritten from an original matlab version by Fay et al. (2009)</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>G. Fay, E. Moulines, F. Roueff, M. S. Taqqu (2009) 
Estimators of long-memory: Fourier versus wavelets. <em>Journal of Econometrics</em>, vol. 151, N. 2, pages 159-177.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scaling_filter">scaling_filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
u &lt;- rnorm(2^10,0,1)
x &lt;- vfracdiff(u,d=0.2)

	resw &lt;- DWTexact(x,filter)
		xwav &lt;- resw$dwt
		index &lt;- resw$indmaxband
		Jmax &lt;- resw$Jmax

## Wavelet scale 1
ws_1 &lt;- xwav[1:index[1]]
## Wavelet scale 2
ws_2 &lt;- xwav[(index[1]+1):index[2]]
## Wavelet scale 3
ws_3 &lt;- xwav[(index[2]+1):index[3]]
### upto Jmax



</code></pre>

<hr>
<h2 id='fivarma'>
simulation of FIVARMA process
</h2><span id='topic+fivarma'></span>

<h3>Description</h3>

<p>Generates N observations of a realisation of a multivariate FIVARMA process X.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fivarma(N, d = 0, cov_matrix = diag(length(d)), VAR = NULL,
            VMA = NULL,skip = 2000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fivarma_+3A_n">N</code></td>
<td>

<p>number of time points.
</p>
</td></tr>
<tr><td><code id="fivarma_+3A_d">d</code></td>
<td>

<p>vector of parameters of long-memory.
</p>
</td></tr>
<tr><td><code id="fivarma_+3A_cov_matrix">cov_matrix</code></td>
<td>

<p>matrix of correlation between the innovations (optional, default is identity).
</p>
</td></tr>
<tr><td><code id="fivarma_+3A_var">VAR</code></td>
<td>

<p>array of VAR coefficient matrices (optional).
</p>
</td></tr>
<tr><td><code id="fivarma_+3A_vma">VMA</code></td>
<td>

<p>array of VMA coefficient matrices (optional).
</p>
</td></tr>
<tr><td><code id="fivarma_+3A_skip">skip</code></td>
<td>

<p>number of initial observations omitted, after applying the ARMA operator and the fractional integration (optional, the default is 2000).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">(e(t))_t</code> be a multivariate gaussian process with a covariance matrix cov_matrix.
The values of the process X are given by the equations:
</p>
<p style="text-align: center;"><code class="reqn">VAR(L)U(t) = VMA(L)e(t),</code>
</p>
<p> and 
</p>
<p style="text-align: center;"><code class="reqn">diag((1-L)^d)X(t) = U(t)</code>
</p>

<p>where <code>L</code> is the lag-operator.
</p>


<h3>Value</h3>

<table>
<tr><td><code>x</code></td>
<td>
<p>vector containing the N observations of the vector ARFIMA(arlags, d, malags) process.</p>
</td></tr>
<tr><td><code>long_run_cov</code></td>
<td>
<p>matrix of covariance of the spectral density of x around the zero frequency.</p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>vector of parameters of long-range dependence, modified in case of cointegration.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>R. J. Sela and C. M. Hurvich (2009) Computationaly efficient methods for two multivariate fractionnaly integrated models. <em>Journal of Time Series Analysis</em>, Vol 30, N. 6, pages 631-651.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varma">varma</a></code>, <code><a href="#topic+vfracdiff">vfracdiff</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rho1 &lt;- 0.3
rho2 &lt;- 0.8
cov &lt;- matrix(c(1,rho1,rho2,rho1,1,rho1,rho2,rho1,1),3,3)
d &lt;- c(0.2,0.3,0.4)

J &lt;- 9
N &lt;- 2^J
VMA &lt;- diag(c(0.4,0.1,0))
### or another example VAR &lt;- array(c(0.8,0,0,0,0.6,0,0,0,0.2,0,0,0,0,0.4,0,0,0,0.5),dim=c(3,3,2))
VAR &lt;- diag(c(0.8,0.6,0))
resp &lt;- fivarma(N, d, cov_matrix=cov, VAR=VAR, VMA=VMA)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov
d &lt;- resp$d



</code></pre>

<hr>
<h2 id='K_eval'>
Evaluation of function <code class="reqn">K</code>
</h2><span id='topic+K_eval'></span>

<h3>Description</h3>

<p>Computes the function <code class="reqn">K</code> as defined in (Achard and Gannaz 2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>K_eval(psi_hat,u,d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="K_eval_+3A_psi_hat">psi_hat</code></td>
<td>
<p> Fourier transform of the wavelet mother at values <code>u</code></p>
</td></tr>
<tr><td><code id="K_eval_+3A_u">u</code></td>
<td>
<p>grid for the approximation of the integral	</p>
</td></tr>
<tr><td><code id="K_eval_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>K_eval</code> computes the matrix <code class="reqn">K</code> with elements
</p>
<p style="text-align: center;"><code class="reqn">K(d_l,d_m)=\int u^{(d_l+d_m)} |\code{psi}\_\code{hat}(u)|^2 du </code>
</p>



<h3>Value</h3>

<p>value of function K as a matrix. 
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+psi_hat_exact">psi_hat_exact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha
res_psi &lt;- psi_hat_exact(filter,J=10)
K_eval(res_psi$psih,res_psi$grid,d=c(0.2,0.2))
</code></pre>

<hr>
<h2 id='mfw'>
multivariate Fourier Whittle estimators
</h2><span id='topic+mfw'></span>

<h3>Description</h3>

<p>Computes the multivariate Fourier Whittle estimators of the long-memory parameters and the long-run covariance matrix also called fractal connectivity. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mfw(x, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mfw_+3A_x">x</code></td>
<td>
<p>data (matrix with time in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mfw_+3A_m">m</code></td>
<td>

<p>truncation number used for the estimation of the periodogram.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice of m determines the range of frequencies used in the computation of
the periodogram, <code class="reqn">\lambda_j = 2\pi j/N</code>, <code class="reqn">j</code> = 1,... , <code>m</code>. The optimal value depends on the spectral properties of the time series such as the presence of short range dependence. In Shimotsu (2007), <code>m</code> is chosen to be equal to <code class="reqn">N^{0.65}</code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>d</code></td>
<td>
<p>estimation of the vector of long-memory parameters.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>estimation of the long-run covariance matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>K. Shimotsu (2007) Gaussian semiparametric estimation of multivariate fractionally integrated processes <em>Journal of Econometrics</em> Vol. 137, N. 2, pages 277-310.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mfw_eval">mfw_eval</a></code>, <code><a href="#topic+mfw_cov_eval">mfw_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

m &lt;- 57 ## default value of Shimotsu 2007
res_mfw &lt;- mfw(x,m)
</code></pre>

<hr>
<h2 id='mfw_cov_eval'>
multivariate Fourier Whittle estimators
</h2><span id='topic+mfw_cov_eval'></span>

<h3>Description</h3>

<p>Computes the multivariate Fourier Whittle estimator of the long-run covariance matrix (also called fractal connectivity) for a given value of long-memory parameters <code>d</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mfw_cov_eval(d, x, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mfw_cov_eval_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters (dimension should match dimension of x)
</p>
</td></tr>
<tr><td><code id="mfw_cov_eval_+3A_x">x</code></td>
<td>
<p>data  (matrix with time in rows and variables in columns)
</p>
</td></tr>
<tr><td><code id="mfw_cov_eval_+3A_m">m</code></td>
<td>

<p>truncation number used for the estimation of the periodogram
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice of m determines the range of frequencies used in the computation of
the periodogram, <code class="reqn">\lambda_j = 2\pi j/N</code>, <code class="reqn">j</code> = 1,... , <code>m</code>. The optimal value depends on the spectral properties of the time series such as the presence of short range dependence. In Shimotsu (2007), <code>m</code> is chosen to be equal to <code class="reqn">N^{0.65}</code>.
</p>


<h3>Value</h3>

<p>long-run covariance matrix estimation.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>K. Shimotsu (2007) Gaussian semiparametric estimation of multivariate fractionally integrated processes <em>Journal of Econometrics</em> Vol. 137, N. 2, pages 277-310.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mfw_eval">mfw_eval</a></code>, <code><a href="#topic+mfw">mfw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,\code{d},0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

m &lt;- 57 ## default value of Shimotsu
G &lt;- mfw_cov_eval(d,x,m) # estimation of the covariance matrix when d is known
</code></pre>

<hr>
<h2 id='mfw_eval'>
evaluation of multivariate Fourier Whittle estimator
</h2><span id='topic+mfw_eval'></span>

<h3>Description</h3>

<p>Evaluates the multivariate Fourier Whittle criterion at a given long-memory parameter value <code>d</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mfw_eval(d, x, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mfw_eval_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters (dimension should match dimension of x).
</p>
</td></tr>
<tr><td><code id="mfw_eval_+3A_x">x</code></td>
<td>
<p>data  (matrix with time in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mfw_eval_+3A_m">m</code></td>
<td>

<p>truncation number used for the estimation of the periodogram.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choice of m determines the range of frequencies used in the computation of
the periodogram, <code class="reqn">\lambda_j = 2\pi j/N</code>, <code class="reqn">j</code> = 1,... , <code>m</code>. The optimal value depends on the spectral properties of the time series such as the presence of short range dependence. In Shimotsu (2007), <code>m</code> is chosen to be equal to <code class="reqn">N^{0.65}</code>.
</p>


<h3>Value</h3>

<p>multivariate Fourier Whittle estimator computed at point <code>d</code>. 
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>K. Shimotsu (2007) Gaussian semiparametric estimation of multivariate fractionally integrated processes <em>Journal of Econometrics</em> Vol. 137, N. 2, pages 277-310.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mfw_cov_eval">mfw_cov_eval</a></code>, <code><a href="#topic+mfw">mfw</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

m &lt;- 57 ## default value of Shimotsu
res_mfw &lt;- mfw(x,m)
d &lt;- res_mfw$d
G &lt;- mfw_eval(d,x,m)
k &lt;- length(d)
res_d &lt;- optim(rep(0,k),mfw_eval,x=x,m=m,method='Nelder-Mead',lower=-Inf,upper=Inf)$par

</code></pre>

<hr>
<h2 id='multiwave-package'>
Estimation of multivariate long-memory models parameters: memory parameters and long-run covariance matrix (also called fractal connectivity).
</h2><span id='topic+multiwave-package'></span><span id='topic+multiwave'></span>

<h3>Description</h3>

<p>This package computes an estimation of the long-memory parameters and the long-run covariance matrix using a multivariate model (Lobato, 1999; Shimotsu 2007). Two semi-parametric methods are implemented: a Fourier based approach (Shimotsu 2007) and a wavelet based approach (Achard and Gannaz 2014).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> multiwave</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-09-17</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Sophie Achard and Irene Gannaz
</p>
<p>Maintainer: Sophie Achard &lt;sophie.achard@gipsa-lab.fr&gt;, Irene Gannaz &lt;irene.gannaz@insa-lyon.fr&gt;
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rho&lt;-0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d&lt;-c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)

x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

#### Compute wavelets this is also included in the functions without _wav
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha

LU &lt;- c(1,11)

if(is.matrix(x)){
    N &lt;- dim(x)[1]
    k &lt;- dim(x)[2]
}else{
    N &lt;- length(x)
    k &lt;- 1
}
mat_x &lt;- as.matrix(x,dim=c(N,k))

## Wavelet decomposition
xwav &lt;- matrix(0,N,k)
    for(j in 1:k){
        xx &lt;- mat_x[,j]   
        resw &lt;- DWTexact(xx,filter)
        xwav_temp &lt;- resw$dwt
        index &lt;- resw$indmaxband
        Jmax &lt;- resw$Jmax
        xwav[1:index[Jmax],j] &lt;- xwav_temp;
    }
## we free some memory
new_xwav &lt;- matrix(0,min(index[Jmax],N),k)
    if(index[Jmax]&lt;N){
        new_xwav[(1:(index[Jmax])),] &lt;- xwav[(1:(index[Jmax])),]
    }
    xwav &lt;- new_xwav
    index &lt;- c(0,index)


##### Compute the wavelet functions 
res_psi &lt;- psi_hat_exact(filter,J)
psih&lt;-res_psi$psih
grid&lt;-res_psi$grid


##### Estimate using Fourier #############

m &lt;- floor(N^{0.65}) ## default value of Shimotsu
res_mfw &lt;- mfw(x,m)
res_d_mfw&lt;-res_mfw$d
res_rho_mfw&lt;-res_mfw$cov[1,2]

### Eval MFW

res_mfw_eval &lt;- mfw_eval(d,x,m)
res_mfw_cov_eval &lt;- mfw_cov_eval(d,x,m)

###### Estimate using Wavelets #############

## Using xwav 

if(dim(xwav)[2]==1) xwav&lt;-as.vector(xwav)
res_mww_wav &lt;- mww_wav(xwav,index,psih,grid,LU)

### Eval MWW_wav

res_mww_wav_eval &lt;- mww_wav_eval(d,xwav,index,LU)
res_mww_wav_cov_eval &lt;- mww_wav_cov_eval(d,xwav,index,psih,grid,LU)

## Using directly the time series

res_mww &lt;- mww(x,filter,LU)
res_d_mww&lt;-res_mww$d
res_rho_mww&lt;-res_mww$cov[1,2]

### Eval MWW_wav

res_mww_eval &lt;- mww_eval(d,x,filter,LU)
res_mww_cov_eval &lt;- mww_cov_eval(d,x,filter,LU)

</code></pre>

<hr>
<h2 id='mww'>
multivariate wavelet Whittle estimation
</h2><span id='topic+mww'></span>

<h3>Description</h3>

<p>Computes the multivariate wavelet Whittle estimation for the long-memory parameter  vector <code>d</code> and the long-run covariance matrix, using <code>DWTexact</code> for the wavelet decomposition. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww(x, filter, LU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_+3A_x">x</code></td>
<td>

<p>data (matrix with time in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_+3A_filter">filter</code></td>
<td>

<p>wavelet filter as obtain with <code>scaling_filter</code>.
</p>
</td></tr>
<tr><td><code id="mww_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition. (Default values are set to <code>L</code>=1, and <code>U=Jmax</code>.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>d</code></td>
<td>
<p>estimation of vector of long-memory parameters.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>estimation of long-run covariance matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww_eval">mww_eval</a></code>, <code><a href="#topic+mww_cov_eval">mww_cov_eval</a></code>,<code><a href="#topic+mww_wav">mww_wav</a></code>,<code><a href="#topic+mww_wav_eval">mww_wav_eval</a></code>,<code><a href="#topic+mww_wav_cov_eval">mww_wav_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha

LU &lt;- c(2,11)

res_mww &lt;- mww(x,filter,LU)

</code></pre>

<hr>
<h2 id='mww_cov_eval'>
multivariate wavelet Whittle estimation of the long-run covariance matrix
</h2><span id='topic+mww_cov_eval'></span>

<h3>Description</h3>

<p>Computes the multivariate wavelet Whittle estimation of the long-run covariance matrix given the long-memory parameter  vector <code>d</code>, using <code>DWTexact</code> for the wavelet decomposition. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww_cov_eval(d, x, filter, LU)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_cov_eval_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters (dimension should match dimension of x).
</p>
</td></tr>
<tr><td><code id="mww_cov_eval_+3A_x">x</code></td>
<td>

<p>data  (matrix with time in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_cov_eval_+3A_filter">filter</code></td>
<td>

<p>wavelet filter as obtain with <code>scaling_filter</code>.
</p>
</td></tr>
<tr><td><code id="mww_cov_eval_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<p>long-run covariance matrix estimation.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww">mww</a></code>, <code><a href="#topic+mww_eval">mww_eval</a></code>,<code><a href="#topic+mww_wav">mww_wav</a></code>,<code><a href="#topic+mww_wav_eval">mww_wav_eval</a></code>,<code><a href="#topic+mww_wav_cov_eval">mww_wav_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha

LU &lt;- c(2,11)

res_mww &lt;- mww_cov_eval(d,x,filter,LU)

</code></pre>

<hr>
<h2 id='mww_eval'>
evaluation of multivariate wavelet Whittle estimation
</h2><span id='topic+mww_eval'></span>

<h3>Description</h3>

<p>Evaluates the multivariate wavelet Whittle criterion at a given long-memory parameter vector <code>d</code> using <code>DWTexact</code> for the wavelet decomposition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww_eval(d, x, filter, LU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_eval_+3A_d">d</code></td>
<td>
<p>vector of long-memory parameters (dimension should match dimension of x).
</p>
</td></tr>
<tr><td><code id="mww_eval_+3A_x">x</code></td>
<td>

<p>data (matrix with time in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_eval_+3A_filter">filter</code></td>
<td>

<p>wavelet filter as obtain with <code>scaling_filter</code>.
</p>
</td></tr>
<tr><td><code id="mww_eval_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition.
(Default values are set to <code>L</code>=1, and <code>U=Jmax</code>.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<p>multivariate wavelet Whittle criterion. 
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>E. Moulines, F. Roueff, M. S. Taqqu (2009) A wavelet whittle estimator of the memory parameter of a nonstationary Gaussian time series. <em>Annals of statistics</em>, vol. 36, N. 4, pages 1925-1956
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww">mww</a></code>, <code><a href="#topic+mww_cov_eval">mww_cov_eval</a></code>,<code><a href="#topic+mww_wav">mww_wav</a></code>,<code><a href="#topic+mww_wav_eval">mww_wav_eval</a></code>,<code><a href="#topic+mww_wav_cov_eval">mww_wav_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha

LU &lt;- c(2,11)

res_mww &lt;- mww_eval(d,x,filter,LU)
k &lt;- length(d)
res_d &lt;- optim(rep(0,k),mww_eval,x=x,filter=filter,
	  	        LU=LU,method='Nelder-Mead',lower=-Inf,upper=Inf)$par

</code></pre>

<hr>
<h2 id='mww_wav'>
multivariate wavelet Whittle estimation for data as wavelet coefficients
</h2><span id='topic+mww_wav'></span>

<h3>Description</h3>

<p>Computes the multivariate wavelet Whittle estimation of the long-memory parameter  vector <code>d</code> and the long-run covariance matrix for the already wavelet decomposed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww_wav(xwav, index, psih, grid_K, LU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_wav_+3A_xwav">xwav</code></td>
<td>

<p>wavelet coefficients matrix (with scales in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_wav_+3A_index">index</code></td>
<td>

<p>vector containing the largest index of each
band, i.e. for <code class="reqn">j&gt;1</code> the wavelet coefficients of scale <code class="reqn">j</code> are <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [\code{indmaxband}(j-1)+1,\code{indmaxband}(j)]</code> and for  <code class="reqn">j=1</code>,  <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [1,\code{indmaxband}(1)]</code>.
</p>
</td></tr>
<tr><td><code id="mww_wav_+3A_psih">psih</code></td>
<td>
<p>the Fourier transform of the wavelet mother at values <code>grid_K</code>.</p>
</td></tr>
<tr><td><code id="mww_wav_+3A_grid_k">grid_K</code></td>
<td>
<p>the grid for the approximation of the integral in K.</p>
</td></tr>
<tr><td><code id="mww_wav_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition. (Default values are set to <code>L</code>=1, and <code>U=Jmax</code>.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>d</code></td>
<td>
<p>estimation of the vector of long-memory parameters.</p>
</td></tr>
<tr><td><code>cov</code></td>
<td>
<p>estimation of the long-run covariance matrix.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww_eval">mww_eval</a></code>, <code><a href="#topic+mww_cov_eval">mww_cov_eval</a></code>,<code><a href="#topic+mww">mww</a></code>,<code><a href="#topic+mww_wav_eval">mww_wav_eval</a></code>,<code><a href="#topic+mww_wav_cov_eval">mww_wav_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h

LU &lt;- c(2,11)

### wavelet decomposition

if(is.matrix(x)){
     N &lt;- dim(x)[1]
     k &lt;- dim(x)[2]
}else{
     N &lt;- length(x)
     k &lt;- 1
}
x &lt;- as.matrix(x,dim=c(N,k))

     ## Wavelet decomposition
     xwav &lt;- matrix(0,N,k)
     for(j in 1:k){
          xx &lt;- x[,j]
             
          resw &lt;- DWTexact(xx,filter)
          xwav_temp &lt;- resw$dwt
          index &lt;- resw$indmaxband
          Jmax &lt;- resw$Jmax
          xwav[1:index[Jmax],j] &lt;- xwav_temp;
     }
     ## we free some memory
     new_xwav &lt;- matrix(0,min(index[Jmax],N),k)
     if(index[Jmax]&lt;N){
          new_xwav[(1:(index[Jmax])),] &lt;- xwav[(1:(index[Jmax])),]
     }
     xwav &lt;- new_xwav
     index &lt;- c(0,index)

##### Compute the wavelet functions 
res_psi &lt;- psi_hat_exact(filter,10)
psih &lt;- res_psi$psih
grid &lt;- res_psi$grid

res_mww &lt;- mww_wav(xwav,index, psih, grid,LU)


</code></pre>

<hr>
<h2 id='mww_wav_cov_eval'>
multivariate wavelet Whittle estimation of the long-run covariance matrix
</h2><span id='topic+mww_wav_cov_eval'></span>

<h3>Description</h3>

<p>Computes the multivariate wavelet Whittle estimation of the long-run covariance matrix given the long-memory parameter  vector <code>d</code> for the already wavelet decomposed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww_wav_cov_eval(d, xwav, index,psih,grid_K, LU)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_wav_cov_eval_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters (dimension should match dimension of xwav).
</p>
</td></tr>
<tr><td><code id="mww_wav_cov_eval_+3A_xwav">xwav</code></td>
<td>

<p>wavelet coefficients matrix (with scales in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_wav_cov_eval_+3A_index">index</code></td>
<td>

<p>vector containing the largest index of each
band, i.e. for <code class="reqn">j&gt;1</code> the wavelet coefficients of scale <code class="reqn">j</code> are <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [\code{indmaxband}(j-1)+1,\code{indmaxband}(j)]</code> and for  <code class="reqn">j=1</code>,  <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [1,\code{indmaxband}(1)]</code>.
</p>
</td></tr>
<tr><td><code id="mww_wav_cov_eval_+3A_psih">psih</code></td>
<td>
<p>the Fourier transform of the wavelet mother at values <code>grid_K</code></p>
</td></tr>
<tr><td><code id="mww_wav_cov_eval_+3A_grid_k">grid_K</code></td>
<td>
<p>the grid for the approximation of the integral in K</p>
</td></tr>
<tr><td><code id="mww_wav_cov_eval_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<p>Long-run covariance matrix estimation.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww">mww</a></code>, <code><a href="#topic+mww_eval">mww_eval</a></code>,<code><a href="#topic+mww_wav">mww_wav</a></code>,<code><a href="#topic+mww_wav_eval">mww_wav_eval</a></code>,<code><a href="#topic+mww_cov_eval">mww_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho&lt;-0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d&lt;-c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha

LU &lt;- c(2,11)

### wavelet decomposition

if(is.matrix(x)){
     N &lt;- dim(x)[1]
     k &lt;- dim(x)[2]
}else{
     N &lt;- length(x)
     k &lt;- 1
}
x &lt;- as.matrix(x,dim=c(N,k))

     ## Wavelet decomposition
     xwav &lt;- matrix(0,N,k)
     for(j in 1:k){
          xx &lt;- x[,j]
             
          resw &lt;- DWTexact(xx,filter)
          xwav_temp &lt;- resw$dwt
          index &lt;- resw$indmaxband
          Jmax &lt;- resw$Jmax
          xwav[1:index[Jmax],j] &lt;- xwav_temp;
     }
     ## we free some memory
     new_xwav &lt;- matrix(0,min(index[Jmax],N),k)
     if(index[Jmax]&lt;N){
          new_xwav[(1:(index[Jmax])),] &lt;- xwav[(1:(index[Jmax])),]
     }
     xwav &lt;- new_xwav
     index &lt;- c(0,index)

##### Compute the wavelet functions 
res_psi &lt;- psi_hat_exact(filter,10)
psih&lt;-res_psi$psih
grid&lt;-res_psi$grid

res_mww &lt;- mww_wav_cov_eval(d,xwav,index, psih, grid,LU)

</code></pre>

<hr>
<h2 id='mww_wav_eval'>
multivariate wavelet Whittle estimation for data as wavelet coefficients
</h2><span id='topic+mww_wav_eval'></span>

<h3>Description</h3>

<p>Evaluates the multivariate wavelet Whittle criterion at a given long-memory parameter vector <code>d</code> for the already wavelet decomposed data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mww_wav_eval(d, xwav, index, LU = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mww_wav_eval_+3A_d">d</code></td>
<td>
<p>vector of long-memory parameters (dimension should match dimension of x).
</p>
</td></tr>
<tr><td><code id="mww_wav_eval_+3A_xwav">xwav</code></td>
<td>

<p>wavelet coefficients matrix (with scales in rows and variables in columns).
</p>
</td></tr>
<tr><td><code id="mww_wav_eval_+3A_index">index</code></td>
<td>

<p>vector containing the largest index of each
band, i.e. for <code class="reqn">j&gt;1</code> the wavelet coefficients of scale <code class="reqn">j</code> are <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [\code{indmaxband}(j-1)+1,\code{indmaxband}(j)]</code> and for  <code class="reqn">j=1</code>,  <code class="reqn">\code{dwt}(k)</code> for <code class="reqn">k \in [1,\code{indmaxband}(1)]</code>.
</p>
</td></tr>
<tr><td><code id="mww_wav_eval_+3A_lu">LU</code></td>
<td>

<p>bivariate vector (optional) containing 
<code>L</code>, the lowest resolution in wavelet decomposition
<code>U</code>, the maximal resolution in wavelet decomposition.
(Default values are set to <code>L</code>=1, and <code>U=Jmax</code>.)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>L</code> is fixing the lower limit of wavelet scales. <code>L</code> can be increased to avoid finest frequencies that can be corrupted by the presence of high frequency phenomena.
</p>
<p><code>U</code> is fixing the upper limit of wavelet scales. <code>U</code> can be decreased when highest frequencies have to be discarded. 
</p>


<h3>Value</h3>

<p>multivariate wavelet Whittle criterion.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>E. Moulines, F. Roueff, M. S. Taqqu (2009) A wavelet whittle estimator of the memory parameter of a nonstationary Gaussian time series. <em>Annals of statistics</em>, vol. 36, N. 4, pages 1925-1956
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mww">mww</a></code>, <code><a href="#topic+mww_cov_eval">mww_cov_eval</a></code>,<code><a href="#topic+mww_wav">mww_wav</a></code>,<code><a href="#topic+mww_eval">mww_eval</a></code>,<code><a href="#topic+mww_wav_cov_eval">mww_wav_cov_eval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulation of ARFIMA(0,d,0)
rho &lt;- 0.4
cov &lt;- matrix(c(1,rho,rho,1),2,2)
d &lt;- c(0.4,0.2)
J &lt;- 9
N &lt;- 2^J

resp &lt;- fivarma(N, d, cov_matrix=cov)
x &lt;- resp$x
long_run_cov &lt;- resp$long_run_cov

## wavelet coefficients definition
res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h

LU &lt;- c(2,11)

### wavelet decomposition

if(is.matrix(x)){
     N &lt;- dim(x)[1]
     k &lt;- dim(x)[2]
}else{
     N &lt;- length(x)
     k &lt;- 1
}
x &lt;- as.matrix(x,dim=c(N,k))

     ## Wavelet decomposition
     xwav &lt;- matrix(0,N,k)
     for(j in 1:k){
          xx &lt;- x[,j]
             
          resw &lt;- DWTexact(xx,filter)
          xwav_temp &lt;- resw$dwt
          index &lt;- resw$indmaxband
          Jmax &lt;- resw$Jmax
          xwav[1:index[Jmax],j] &lt;- xwav_temp;
     }
     ## we free some memory
     new_xwav &lt;- matrix(0,min(index[Jmax],N),k)
     if(index[Jmax]&lt;N){
          new_xwav[(1:(index[Jmax])),] &lt;- xwav[(1:(index[Jmax])),]
     }
     xwav &lt;- new_xwav
     index &lt;- c(0,index)

res_mww &lt;- mww_wav_eval(d,xwav,index,LU)
res_d &lt;- optim(rep(0,k),mww_wav_eval,xwav=xwav,index=index,LU=LU,
          method='Nelder-Mead',lower=-Inf,upper=Inf)$par
</code></pre>

<hr>
<h2 id='psi_hat_exact'>
discrete Fourier transform of the wavelet
</h2><span id='topic+psi_hat_exact'></span>

<h3>Description</h3>

<p>Computes the discrete Fourier transform of the wavelet associated to the given filter using <code>scaling_function</code>. The length of the Fourier transform is equal to the length of the grid where the wavelet is evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psi_hat_exact(filter,J=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="psi_hat_exact_+3A_filter">filter</code></td>
<td>
<p>wavelet filter as obtained with <code>scaling_filter</code>.</p>
</td></tr>
<tr><td><code id="psi_hat_exact_+3A_j">J</code></td>
<td>
<p> 2^J corresponds to the size of the grid for the discretisation of the wavelet. The default value is set to 10.	</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>psih</code></td>
<td>
<p>Values of the discrete Fourier transform of the wavelet.</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>Frequencies where the Fourier transform is evaluated.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>G. Fay, E. Moulines, F. Roueff, M. S. Taqqu (2009) 
Estimators of long-memory: Fourier versus wavelets. <em>Journal of Econometrics</em>, vol. 151, N. 2, pages 159-177.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DWTexact">DWTexact</a></code>, <code><a href="#topic+scaling_filter">scaling_filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
psi_hat_exact(filter,J=6)
</code></pre>

<hr>
<h2 id='scaling_filter'>
wavelet scaling filter coefficients
</h2><span id='topic+scaling_filter'></span>

<h3>Description</h3>

<p>Computes the filter coefficients of the Haar or Daubechies wavelet family with a specific order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaling_filter(family, parameter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaling_filter_+3A_family">family</code></td>
<td>
<p>Wavelet family, <code>'Haar'</code> or <code>'Daubechies'</code>
</p>
</td></tr>
<tr><td><code id="scaling_filter_+3A_parameter">parameter</code></td>
<td>
<p>	Order of the Daubechies wavelet (equal to twice the number of vanishing moments). The value of <code>parameter</code> can be 2,4,8,10,12,14 and 16.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>h</code></td>
<td>
<p>Vector of scaling filter coefficients.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>Number of vanishing moments.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Fourier decay exponent.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>G. Fay, E. Moulines, F. Roueff, M. S. Taqqu (2009) 
Estimators of long-memory: Fourier versus wavelets. <em>Journal of Econometrics</em>, vol. 151, N. 2, pages 159-177.
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DWTexact">DWTexact</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
M &lt;- res_filter$M
alpha &lt;- res_filter$alpha
</code></pre>

<hr>
<h2 id='scaling_function'>
scaling function and the wavelet function
</h2><span id='topic+scaling_function'></span>

<h3>Description</h3>

<p>Computes the scaling function and the wavelet function (for compactly supported wavelet) using the cascade algorithm on the grid of dyadic integer <code class="reqn">2^{-J}</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaling_function(filter,J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scaling_function_+3A_filter">filter</code></td>
<td>
<p>wavelet filter as obtained with <code>scaling_filter</code>.</p>
</td></tr>
<tr><td><code id="scaling_function_+3A_j">J</code></td>
<td>
<p>value of the largest scale.	</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>phi</code></td>
<td>
<p>Scaling function.</p>
</td></tr>
<tr><td><code>psi</code></td>
<td>
<p>Wavelet function.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function was rewritten from an original matlab version by Fay et al. (2009)
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>G. Fay, E. Moulines, F. Roueff, M. S. Taqqu (2009) 
Estimators of long-memory: Fourier versus wavelets. <em>Journal of Econometrics</em>, vol. 151, N. 2, pages 159-177. 
</p>
<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DWTexact">DWTexact</a></code>, <code><a href="#topic+scaling_filter">scaling_filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
scaling_function(filter,J=6)
</code></pre>

<hr>
<h2 id='toeplitz_nonsym'>
Transform a vector in a non symmetric Toeplitz matrix
</h2><span id='topic+toeplitz_nonsym'></span>

<h3>Description</h3>

<p>Transform a vector in a non symmetric Toeplitz matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toeplitz_nonsym(vec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toeplitz_nonsym_+3A_vec">vec</code></td>
<td>
<p>input vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the corresponding matrix.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scaling_function">scaling_function</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>res_filter &lt;- scaling_filter('Daubechies',8);
filter &lt;- res_filter$h
Htmp &lt;- toeplitz_nonsym(filter)
</code></pre>

<hr>
<h2 id='varma'>
simulation of multivariate ARMA process
</h2><span id='topic+varma'></span>

<h3>Description</h3>

<p>generates N observations of a k-vector ARMA process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>varma(N, k = 1, VAR = NULL, VMA = NULL, cov_matrix = diag(k), innov=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="varma_+3A_n">N</code></td>
<td>

<p>number of time points.
</p>
</td></tr>
<tr><td><code id="varma_+3A_k">k</code></td>
<td>

<p>dimension of the vector ARMA (optional, default is univariate)
</p>
</td></tr>
<tr><td><code id="varma_+3A_var">VAR</code></td>
<td>

<p>array of VAR coefficient matrices (optional).
</p>
</td></tr>
<tr><td><code id="varma_+3A_vma">VMA</code></td>
<td>

<p>array of VMA coefficient matrices (optional).
</p>
</td></tr>
<tr><td><code id="varma_+3A_cov_matrix">cov_matrix</code></td>
<td>

<p>matrix of correlation between the innovations (optional, default is identity).
</p>
</td></tr>
<tr><td><code id="varma_+3A_innov">innov</code></td>
<td>

<p>matrix of the innovations (optional, default is a gaussian process).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector containing the N observations of the k-vector ARMA process.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fivarma">fivarma</a></code>, <code><a href="#topic+vfracdiff">vfracdiff</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rho1 &lt;- 0.3
rho2 &lt;- 0.8
cov &lt;- matrix(c(1,rho1,rho2,rho1,1,rho1,rho2,rho1,1),3,3)

J &lt;- 9
N &lt;- 2^J
VMA &lt;- diag(c(0.4,0.1,0))
### or another example VAR &lt;- array(c(0.8,0,0,0,0.6,0,0,0,0.2,0,0,0,0,0.4,0,0,0,0.5),dim=c(3,3,2))
VAR &lt;- diag(c(0.8,0.6,0))
x &lt;- varma(N, k=3, cov_matrix=cov, VAR=VAR, VMA=VMA)

</code></pre>

<hr>
<h2 id='vfracdiff'>
simulation of vector fractional differencing process
</h2><span id='topic+vfracdiff'></span>

<h3>Description</h3>

<p>Given a vector process <code>x</code> and a vector of long memory parameters <code>d</code>, this function is producing the corresponding fractional differencing process. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vfracdiff(x, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vfracdiff_+3A_x">x</code></td>
<td>

<p>initial process.
</p>
</td></tr>
<tr><td><code id="vfracdiff_+3A_d">d</code></td>
<td>

<p>vector of long-memory parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a process <code>x</code>, this function applied a fractional difference procedure using the formula: 
</p>
<p style="text-align: center;"><code class="reqn">	diag((1-L)^d) x,</code>
</p>

<p>where <code>L</code> is the lag operator.
</p>


<h3>Value</h3>

<p>vector fractional differencing of <code>x</code>.
</p>


<h3>Author(s)</h3>

<p>S. Achard and I. Gannaz
</p>


<h3>References</h3>

<p>S. Achard, I. Gannaz (2016)
Multivariate wavelet Whittle estimation in long-range dependence. <em>Journal of Time Series Analysis</em>, Vol 37, N. 4, pages 476-512.  <code>http://arxiv.org/abs/1412.0391</code>.
</p>
<p>K. Shimotsu (2007) Gaussian semiparametric estimation of multivariate fractionally integrated processes <em>Journal of Econometrics</em> Vol. 137, N. 2, pages 277-310.
</p>
<p>S. Achard, I Gannaz (2019)
Wavelet-Based and Fourier-Based Multivariate Whittle Estimation: multiwave. <em>Journal of Statistical Software</em>, Vol 89, N. 6, pages 1-31. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+varma">varma</a></code>, <code><a href="#topic+fivarma">fivarma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rho1 &lt;- 0.3
rho2 &lt;- 0.8
cov &lt;- matrix(c(1,rho1,rho2,rho1,1,rho1,rho2,rho1,1),3,3)
d &lt;- c(0.2,0.3,0.4)


J &lt;- 9
N &lt;- 2^J
VMA &lt;- diag(c(0.4,0.1,0))
### or another example VAR &lt;- array(c(0.8,0,0,0,0.6,0,0,0,0.2,0,0,0,0,0.4,0,0,0,0.5),dim=c(3,3,2))
VAR &lt;- diag(c(0.8,0.6,0))
x &lt;- varma(N, k=3, cov_matrix=cov, VAR=VAR, VMA=VMA)
vx&lt;-vfracdiff(x,d)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
