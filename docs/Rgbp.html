<!DOCTYPE html><html lang="en"><head><title>Help for package Rgbp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rgbp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Rgbp'><p>Hierarchical Modeling and Frequency Method Checking on Overdispersed Gaussian, Poisson, and Binomial Data</p></a></li>
<li><a href='#baseball'>
<p>Baseball Data</p></a></li>
<li><a href='#coverage'><p>Estimating Coverage Probability</p></a></li>
<li><a href='#coverage.plot'><p>Drawing the coverage plot</p></a></li>
<li><a href='#gbp'><p>Fitting Gaussian, Poisson, and Binomial Hierarchical Models</p></a></li>
<li><a href='#gbp-internal'><p>Internal <code>gbp</code> functions</p></a></li>
<li><a href='#hospital'>
<p>Thirty-one Hospital Data</p></a></li>
<li><a href='#plot.gbp'><p>Drawing Shrinkage and Posterior Interval Plots</p></a></li>
<li><a href='#print.gbp'><p>Displaying 'gbp' Class</p></a></li>
<li><a href='#print.summary.gbp'><p>Displaying 'summary.gbp' Class</p></a></li>
<li><a href='#schools'>
<p>Eight Schools Data</p></a></li>
<li><a href='#summary.gbp'><p>Summarizing Estimation Result</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.1.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-12-16</td>
</tr>
<tr>
<td>Title:</td>
<td>Hierarchical Modeling and Frequency Method Checking on
Overdispersed Gaussian, Poisson, and Binomial Data</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Kelly, Hyungsuk Tak, and Carl Morris</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Kelly &lt;josephkelly@post.harvard.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sn, mnormt</td>
</tr>
<tr>
<td>Description:</td>
<td>We utilize  approximate Bayesian machinery to fit two-level conjugate hierarchical models on overdispersed Gaussian, Poisson, and Binomial data and evaluates whether the resulting approximate Bayesian interval estimates for random effects meet the nominal confidence levels via frequency coverage evaluation. The data that Rgbp assumes comprise observed sufficient statistic for each random effect, such as an average or a proportion of each group, without population-level data.  The approximate Bayesian tool equipped with the adjustment for density maximization produces approximate point and interval estimates for model parameters including second-level variance component, regression coefficients, and random effect. For the Binomial data, the package provides an option to produce  posterior samples of all the model parameters via the acceptance-rejection method. The package provides a quick way to evaluate coverage rates of the resultant Bayesian interval estimates for random effects via a parametric bootstrapping, which we call frequency method checking.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jyklly/Rgbp/issues">https://github.com/jyklly/Rgbp/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-16 23:55:32 UTC; joey</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-17 06:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='Rgbp'>Hierarchical Modeling and Frequency Method Checking on Overdispersed Gaussian, Poisson, and Binomial Data</h2><span id='topic+Rgbp-package'></span><span id='topic+Rgbp'></span>

<h3>Description</h3>

<p>Bayesian-frequentist reconciliation via approximate Bayesian hierarchical modeling and frequency method checking for over-dispersed Gaussian, Binomial, and Poisson data.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> Rgbp</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 1.1.3</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2018-05-16</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
    Main functions: </td><td style="text-align: left;"> <code><a href="#topic+gbp">gbp</a></code>, <code><a href="#topic+coverage">coverage</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p><code>Rgbp</code> is an R package that utilizes approximate Bayesian machinery to provide a method of estimating two-level hierarchical models for Gaussian, Poisson, and Binomial data in a fast and computationally efficient manner. The main products of this package are point and interval estimates for the true parameters, whose good frequency properties can be validated via its repeated sampling procedure called frequency method checking.  It is found that such Bayesian-frequentist reconciliation allows <code>Rgbp</code> to have attributes desirable from both perspectives, working well in small samples and yielding good coverage probabilities for its interval estimates.
</p>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris
</p>
<p>Maintainer: Joseph Kelly &lt;josephkelly@google.com&gt;
</p>


<h3>References</h3>

<p>Tak, H., Kelly, J., and Morris, C. (2017) Rgbp: An R Package for Gaussian, Poisson, and Binomial Random Effects Models with Frequency Coverage Evaluations. <em>Journal of Statistical Software</em>. <b>78</b>, 5, 1&ndash;33.
</p>
<p>Morris, C. and Lysy, M. (2012). Shrinkage Estimation in Multilevel Normal Models. <em>Statistical Science</em>. <b>27</b>, 1, 115&ndash;134.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Loading datasets
  data(schools)
  y &lt;- schools$y
  se &lt;- schools$se

  # Arbitrary covariate for schools data
  x2 &lt;- rep(c(-1, 0, 1, 2), 2)
  
  # baseball data where z is Hits and n is AtBats
  z &lt;- c(18, 17, 16, 15, 14, 14, 13, 12, 11, 11, 10, 10, 10, 10, 10,  9,  8,  7)
  n &lt;- c(45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45)

  # One covariate: 1 if a player is an outfielder and 0 otherwise
  x1 &lt;- c(1,  1,  1,  1,  1,  0,  0,  0,  0,  1,  0,  0,  0,  1,  1,  0,  0,  0)

  ################################################################
  # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
  ################################################################

    ####################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution #
    ####################################################################################

    g &lt;- gbp(y, se, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### gcv &lt;- coverage(g, nsim = 10)  
    ### more details in ?coverage

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    g &lt;- gbp(y, se, x2, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### gcv &lt;- coverage(g, nsim = 10)  
    ### more details in ?coverage 

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    g &lt;- gbp(y, se, mean.PriorDist = 8, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### gcv &lt;- coverage(g, nsim = 10)  
    ### more details in ?coverage 

  ###############################################################
  # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
  ###############################################################

    ####################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution #
    ####################################################################################

    b &lt;- gbp(z, n, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### bcv &lt;- coverage(b, nsim = 10)  
    ### more details in ?coverage 

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    b &lt;- gbp(z, n, x1, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### bcv &lt;- coverage(b, nsim = 10)  
    ### more details in ?coverage 

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    b &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### bcv &lt;- coverage(b, nsim = 10)  
    ### more details in ?coverage 

  ##############################################################
  # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
  ##############################################################

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "poisson")
    p
    print(p, sort = FALSE)
    summary(p)
    plot(p)
    plot(p, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    ### pcv &lt;- coverage(p, nsim = 10)  
    ### more details in ?coverage 

</code></pre>

<hr>
<h2 id='baseball'>
Baseball Data
</h2><span id='topic+baseball'></span>

<h3>Description</h3>

<p>Batting averages of 18 major league players through their first 45 official at bats of the 1970 season. These batting averages were published weekly in the New York Times, and by April 26, 1970.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(baseball)</code></pre>


<h3>Format</h3>

<p>A data set of 18 players with 12 covariates:
</p>

<dl>
<dt><code>FirstName</code></dt><dd><p>each player's first name</p>
</dd>
<dt><code>LastName</code></dt><dd><p>each player's last name</p>
</dd>
<dt><code>At.Bats</code></dt><dd><p>number of times batted</p>
</dd>
<dt><code>Hits</code></dt><dd><p>each player's number of hits among 45 at bats</p>
</dd>
<dt><code>BattingAverage</code></dt><dd><p>batting averages among 45 at bats</p>
</dd>
<dt><code>RemainingAt.Bats</code></dt><dd><p>number of times batted after 45 at bats until the end of season</p>
</dd>
<dt><code>RemainingAverage</code></dt><dd><p>batting averages after 45 at bats until the end of season</p>
</dd>
<dt><code>SeasonAt.Bats</code></dt><dd><p>number of times batted over the whole season</p>
</dd>
<dt><code>SeasonHits</code></dt><dd><p>each player's number of hits over the whole season</p>
</dd>
<dt><code>SeasonAverage</code></dt><dd><p>batting averages over the whole season</p>
</dd>
<dt><code>League</code></dt><dd><p>1 if a player is in the National league</p>
</dd>
<dt><code>Position</code></dt><dd><p>each player's position</p>
</dd>
</dl>



<h3>Source</h3>

<p>Efron, B. and Morris, C. (1975). Data Analysis Using Stein's Estimator and its Generalizations. <em>Journal of the American Statistical Association</em>. <b>70</b>. 311-319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(baseball)
</code></pre>

<hr>
<h2 id='coverage'>Estimating Coverage Probability</h2><span id='topic+coverage'></span>

<h3>Description</h3>

<p><code>coverage</code> estimates Rao-Blackwellized and simple unbiased coverage probabilities.</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage(gbp.object, A.or.r, reg.coef, mean.PriorDist, nsim = 100)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverage_+3A_gbp.object">gbp.object</code></td>
<td>

<p>a resultant object of <code>gbp</code> function. 
</p>
</td></tr>
<tr><td><code id="coverage_+3A_a.or.r">A.or.r</code></td>
<td>

<p>(optional) a given true numeric value of <em>A</em> for Gaussian data or of <em>r</em> for Binomial and Poisson data. If not designated, the estimated value in the <code>gbp.object</code> object will be considered as a true value.
</p>
</td></tr>
<tr><td><code id="coverage_+3A_reg.coef">reg.coef</code></td>
<td>

<p>(optional) a given true (<em>m</em> by 1) vector for regression coefficients, <code class="reqn">\beta</code>, where <em>m</em> is the number of regression coefficients including an intercept. If not designated, the estimated value in the <code>gbp.object</code> object will be considered as a true value.
</p>
</td></tr>
<tr><td><code id="coverage_+3A_mean.priordist">mean.PriorDist</code></td>
<td>

<p>(optional) a given true numeric value for the mean of (second-level) prior distribution. If not designated, the previously known value in the <code>gbp.object</code> object will be considered as a known prior mean.
</p>
</td></tr>
<tr><td><code id="coverage_+3A_nsim">nsim</code></td>
<td>

<p>number of datasets to be generated. Default is 100.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As for the argument <code>gbp.object</code>, if the result of <code>gbp</code> is designated to 
<code>b</code>, for example <br /> &quot;<code>b &lt;- gbp(z, n, model = "binomial")</code>&quot;, the argument <code>gbp.object</code> indicates this <code>b</code>.
</p>
<p>Data generating process is based on a second-level hierarchical model. The first-level hierarchy is 
a distribution of observed data and the second-level is a conjugate prior distribution 
on the first-level parameter.
</p>
<p>To be specific, for Normal data, <code>gbp</code> constructs a two-level Normal-Normal 2-level model. <code class="reqn">\sigma^{2}_{j}</code> below is assumed to be known or to be accurately estimated (<code class="reqn">s^{2}_{j}</code>) and subscript <em>j</em> indicates <em>j</em>-th group in a dataset.
</p>
<p style="text-align: center;"><code class="reqn">(y_{j} | \theta_{j}) \stackrel{ind}{\sim} N(\theta_{j}, \sigma^{2}_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} |\mu_{0j} , A) \stackrel{ind}{\sim} N(\mu_{0j}, A)</code>
</p>

<p style="text-align: center;"><code class="reqn">\mu_{0j} = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>For Poisson data, <code>gbp</code> builds a two-level Poisson-Gamma multi-level model. A square bracket below indicates [mean, variance] of distribution and a constant multiplied to the notation representing Gamma distribution (Gam) is a scale. Also, for consistent notation, <code class="reqn">y_{j}=\frac{z_{j}}{n_{j}}</code> and <code class="reqn">n_{j}</code> can be interpreted as <em>j</em>-th group's exposure only in this Poisson-Gamma hierarchical model.
</p>
<p style="text-align: center;"><code class="reqn">(z_{j} | \theta_{j}) \stackrel{ind}{\sim} Pois(n_{j}\theta_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} | r, \mu_{0j}) \stackrel{ind}{\sim} \frac{1}{r}Gam(r\mu_{0j})\stackrel{ind}{\sim}Gam[\mu_{0j}, \mu_{0j} / r] </code>
</p>

<p style="text-align: center;"><code class="reqn">log(\mu_{0j}) = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>For Binomial data, <code>gbp</code> sets a two-level Binomial-Beta multi-level model. For reference, a square bracket below indicates [mean, variance] of distribution and <code class="reqn">y_{j} = \frac{z_{j}}{n_{j}}</code>.
</p>
<p style="text-align: center;"><code class="reqn">(z_{j} | \theta_{j}) \stackrel{ind}{\sim} Bin(n_{j}, \theta_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} | r, \mu_{0j}) \stackrel{ind}{\sim} Beta(r\mu_{0j}, r(1-\mu_{0j})) \stackrel{ind}{\sim} Beta[\mu_{0j}, \mu_{0j}(1 - \mu_{0j}) / (r + 1)]</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(\mu_{0j}) = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>From now on, the subscript <em>(i)</em> means <em>i</em>-th simulation and the subscript <em>j</em> indicates <em>j</em>-th group. So, notations with a subscript <em>(i)</em> are (<em>k</em> by 1) vectors, for example <code class="reqn">\theta_{(i)}' = (\theta_{(i)1}, \theta_{(i)2}, \ldots, \theta_{(i)k})</code>.
</p>
<p>Pseudo-data generating process starts from the second-level hierarchy to the first-level. <code>coverage</code> first generates true parameters (<code class="reqn">\theta_{(i)}</code>) for <em>k</em> groups at the second-level and then moves onto the first-level to simulate pseudo-data sets, <code class="reqn">y_{(i)}</code> for Gaussian or <code class="reqn">z_{(i)}</code> for Binomial and Poisson data, given previously generated true parameters (<code class="reqn">\theta_{(i)}</code>). 
</p>
<p>So, in order to generate pseudo-datasets, <code>coverage</code> needs parameters of prior distribution,  
(<em>A</em> (or <em>r</em>) and <code class="reqn">\beta</code> (<code>reg.coef</code>)) 
or (<em>A</em> (or <em>r</em>) and <code class="reqn">\mu_{0}</code>). From here, we have four options to run <code>coverage</code>.
</p>
<p>First, if any values related to the prior distribution are not designated like 
<code>coverage(b, nsim = 10)</code>, then <code>coverage</code> will regard estimated values (or known prior mean, <code class="reqn">\mu_{0}</code>) in <code>b</code> (<code>gbp.object</code>) as given true values when it generates lots of pseudo-datasets. After sampling <code class="reqn">\theta_{(i)}</code> from the prior distribution determined by these estimated values (or known prior mean) in <code>b</code> (<code>gbp.object</code>), <code>coverage</code> creates an <em>i</em>-th pseudo-dataset based on <code class="reqn">\theta_{(i)}</code> just sampled.
</p>
<p>Second, <code>coverage</code> allows us to try different true values in generating datasets. Suppose <code>gbp.object</code> is based on the model with a known prior mean, <code class="reqn">\mu_{0}</code>. Then, we can try either different <code>A.or.r</code> or <code>mean.PriorDist</code>. For example, <code>coverage(b, A.or.r = 20, nsim = 10)</code>, <br />
<code>coverage(b, mean.PriorDist = 0.5, nsim = 10)</code>, or <br />
<code>coverage(b, A.or.r = 20, mean.PriorDist = 0.5, nsim = 10)</code>. Note that we cannot set <code>reg.coef</code> because the second-level mean (prior mean) is known in <code>gbp.object</code> to begin with.
</p>
<p>Suppose <code>gbp.object</code> is based on the model with an unknown prior mean. In this case, <code>gbp.object</code> has the estimation result of regression model, linear regression for Normal-Normal, log-linear regression for Poisson-Gamma, or logistic regression for Binomial-Beta, (only intercept term if there is no covariate) to estimate the unknown prior mean. Then, we can try some options: one or two of (<code>A.or.r</code>, <code>mean.PriorDist</code>, <code>reg.coef</code>). For example, <code>coverage(b, A.or.r = 20, nsim = 10)</code>,  <code>coverage(b, mean.PriorDist = 0.5, nsim = 10)</code>, or <br /> <code>coverage(b, reg.coef = 0.1, nsim = 10)</code> with no covariate where <code>reg.coef</code> is a designated intercept term. Estimates in <code>gbp.object</code> will be used for undesignated values. Also, we can try appropriate combinations of two arguments. For example, <br /> <code>coverage(b, A.or.r = 20, mean.PriorDist = 0.5, nsim = 10)</code> and <br />
<code>coverage(b, A.or.r = 20, reg.coef = 0.1, nsim = 10)</code>. If we have one covariate, a 2 by 1 vector should be designated for <code>reg.coef</code>, one for an intercept term and the other for a regression coefficient of the covariate. Note that the two arguments, <code>mean.PriorDist</code> and <code>reg.coef</code>, cannot be assigned together because we do not need <code>reg.coef</code> given <code>mean.PriorDist</code>. 
</p>
<p>The simple unbiased estimator of coverage probability in <em>j</em>-th group is a sample mean of indicators over all simulated datasets. The <em>j</em>-th indicator in <em>i</em>-th simulation is 1 if the estimated interval of the <em>j</em>-th group on <em>i</em>-th simulated dataset contains a true parameter 
<code class="reqn">\theta_{(i)j}</code> that generated the observed value of the <em>j</em>-th group in the 
<em>i</em>-th dataset.
</p>
<p>Rao-Blackwellized unbiased estimator for group <em>j</em> is a conditional expectation of the simple unbiased estimator given a sufficient statistic, <code class="reqn">y_{j}</code> for Gaussian or <code class="reqn">z_{j}</code> for Binomial and Poisson data.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>coverageRB</code></td>
<td>

<p>Rao-Blackwellized unbiased coverage estimate for each group averaged over all simulations.
</p>
</td></tr>
<tr><td><code>coverageS</code></td>
<td>

<p>Simple unbiased coverage estimate for each group averaged over all simulations.
</p>
</td></tr>
<tr><td><code>average.coverageRB</code></td>
<td>

<p>Overall Rao-Blackwellized unbiased coverage estimate across all the groups and simulations.
</p>
</td></tr>
<tr><td><code>overall.coverageRB</code></td>
<td>

<p>Overall Rao-Blackwellized unbiased coverage estimate across all the groups and simulations.
</p>
</td></tr>
<tr><td><code>average.coverageS</code></td>
<td>

<p>Overall simple unbiased coverage estimate across all the groups and simulations.
</p>
</td></tr>
<tr><td><code>se.coverageRB</code></td>
<td>

<p>Standard error of Rao-Blackwellized unbiased coverage estimate for each group.
</p>
</td></tr>
<tr><td><code>se.overall.coverageRB</code></td>
<td>

<p>Standard error of the overall Rao-Blackwellized unbiased coverage estimate.
</p>
</td></tr>
<tr><td><code>se.coverageS</code></td>
<td>

<p>Standard error of simple unbiased coverage estimate for each group.
</p>
</td></tr>
<tr><td><code>raw.resultRB</code></td>
<td>

<p>All the Rao-Blackwellized unbiased coverage estimates for every group and for every simulation.
</p>
</td></tr>
<tr><td><code>raw.resultS</code></td>
<td>

<p>All the simple unbiased coverage estimates for every group and for every simulation.
</p>
</td></tr>
<tr><td><code>confidence.lvl</code></td>
<td>

<p>Nominal confidence level 
</p>
</td></tr>
<tr><td><code>effective.n</code></td>
<td>

<p>The number of simulated data sets used to calculate the coverage estimates. The data sets may cause some errors in fitting models. For example, the data set may be against the conditions for the posteiror propriety in Binomial data.
</p>
</td></tr>
<tr><td><code>model</code></td>
<td>

<p>The model being used, &quot;br&quot;, &quot;pr&quot;, or &quot;gr&quot;.
</p>
</td></tr>
<tr><td><code>case</code></td>
<td>

<p>One of the cases used to re-draw the coverage plot by <code>coverage.plot</code>.
</p>
</td></tr>
<tr><td><code>betas</code></td>
<td>

<p>The regression coefficient used to generate simulated data sets.
</p>
</td></tr>
<tr><td><code>A.r</code></td>
<td>

<p>The hyper-parameter value (A for Gaussian model, and r for both Binomial and Poisson models) used to generate simulated data sets.
</p>
</td></tr>
<tr><td><code>priormeanused</code></td>
<td>

<p>The value of the prior mean(s) used to generate simulated data sets.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris</p>


<h3>References</h3>

<p>Tak, H., Kelly, J., and Morris, C. (2017) Rgbp: An R Package for Gaussian, Poisson, and Binomial Random Effects Models with Frequency Coverage Evaluations. <em>Journal of Statistical Software</em>. <b>78</b>, 5, 1&ndash;33.
</p>
<p>Christiansen, C. and Morris, C. (1997). Hierarchical Poisson Regression Modeling. <em>Journal of the American Statistical Association</em>. <b>92</b>, 438, 618&ndash;632.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Loading datasets
  data(schools)
  y &lt;- schools$y
  se &lt;- schools$se

  # Arbitrary covariate for schools data
  x2 &lt;- rep(c(-1, 0, 1, 2), 2)

  # baseball data where z is Hits and n is AtBats
  z &lt;- c(18, 17, 16, 15, 14, 14, 13, 12, 11, 11, 10, 10, 10, 10, 10,  9,  8,  7)
  n &lt;- c(45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45)

  # One covariate: 1 if a player is an outfielder and 0 otherwise
  x1 &lt;- c(1,  1,  1,  1,  1,  0,  0,  0,  0,  1,  0,  0,  0,  1,  1,  0,  0,  0)
  
  #################################################################
  # Gaussian Regression Interactive Multi-level Modeling (GRIMM) #
  #################################################################

    ####################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution #
    ####################################################################################

    g &lt;- gbp(y, se, model = "gaussian")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  

    ### gcv$coverageRB, gcv$coverageS, gcv$average.coverageRB, gcv$average.coverageS,
    ### gcv$minimum.coverageRB, gcv$raw.resultRB, gcv$raw.resultS

    ### gcv &lt;- coverage(g, mean.PriorDist = 3, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 150, nsim = 100)
    ### gcv &lt;- coverage(g, reg.coef = 10, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 150, mean.PriorDist = 3, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 150, reg.coef = 10, nsim = 100)

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    g &lt;- gbp(y, se, x2, model = "gaussian")
 
    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  
 
    ### gcv$coverageRB, gcv$coverageS, gcv$average.coverageRB, gcv$average.coverageS,
    ### gcv$minimum.coverageRB, gcv$raw.resultRB, gcv$raw.resultS

    ### gcv &lt;- coverage(g, mean.PriorDist = 3, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 200, nsim = 100)
    ### gcv &lt;- coverage(g, reg.coef = c(10, 2), nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 200, mean.PriorDist = 3, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 200, reg.coef = c(10, 2), nsim = 100)

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    g &lt;- gbp(y, se, mean.PriorDist = 8, model = "gaussian")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  

    ### gcv$coverageRB, gcv$coverageS, gcv$average.coverageRB, gcv$average.coverageS,
    ### gcv$minimum.coverageRB, gcv$raw.resultRB, gcv$raw.resultS

    ### gcv &lt;- coverage(g, mean.PriorDist = 3, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 150, nsim = 100)
    ### gcv &lt;- coverage(g, A.or.r = 150, mean.PriorDist = 3, nsim = 100)

  ################################################################
  # Binomial Regression Interactive Multi-level Modeling (BRIMM) #
  ################################################################

    ####################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution #
    ####################################################################################

    b &lt;- gbp(z, n, model = "binomial")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverageS, bcv$average.coverageRB, bcv$average.coverageS,
    ### bcv$minimum.coverageRB, bcv$raw.resultRB, bcv$raw.resultS

    ### bcv &lt;- coverage(b, mean.PriorDist = 0.2, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 50, nsim = 100)
    ### bcv &lt;- coverage(b, reg.coef = -1.5, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 50, mean.PriorDist = 0.2, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 50, reg.coef = -1.5, nsim = 100)

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    b &lt;- gbp(z, n, x1, model = "binomial")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverageS, bcv$average.coverageRB, bcv$average.coverageS,
    ### bcv$minimum.coverageRB, bcv$raw.resultRB, bcv$raw.resultS

    ### bcv &lt;- coverage(b, mean.PriorDist = 0.2, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 50, nsim = 100)
    ### bcv &lt;- coverage(b, reg.coef = c(-1.5, 0), nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 40, mean.PriorDist = 0.2, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 40, reg.coef = c(-1.5, 0), nsim = 100)

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    b &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "binomial")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverageS, bcv$average.coverageRB, bcv$average.coverageS,
    ### bcv$minimum.coverageRB, bcv$raw.resultRB, bcv$raw.resultS

    ### bcv &lt;- coverage(b, mean.PriorDist = 0.2, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 50, nsim = 100)
    ### bcv &lt;- coverage(b, A.or.r = 40, mean.PriorDist = 0.2, nsim = 100)

  ###############################################################
  # Poisson Regression Interactive Multi-level Modeling (PRIMM) #
  ###############################################################

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "poisson")

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    pcv &lt;- coverage(p, nsim = 10)  

    ### pcv$coverageRB, pcv$coverageS, pcv$average.coverageRB, pcv$average.coverageS,
    ### pcv$minimum.coverageRB, pcv$raw.resultRB, pcv$raw.resultS

    ### pcv &lt;- coverage(p, mean.PriorDist = 0.265, nsim = 100)
    ### pcv &lt;- coverage(p, A.or.r = 150, nsim = 100)
    ### pcv &lt;- coverage(p, A.or.r = 150, mean.PriorDist = 0.265, nsim = 100)

</code></pre>

<hr>
<h2 id='coverage.plot'>Drawing the coverage plot</h2><span id='topic+coverage.plot'></span>

<h3>Description</h3>

<p>In a case where users closed the default coverage plot that the <code>coverage</code> function generated, the function <code>coverage.plot</code> redraws the coverage plot using the coverage object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage.plot(cov)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverage.plot_+3A_cov">cov</code></td>
<td>

<p>Any saved result of the <code>coverage</code> function. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is possible that a user want to redraw the coverage plot for any reasons. If the result of the <code>coverage</code> function was saved into a variable, this <code>coverage.plot</code> redraw the coverage plot using the saved result.
</p>


<h3>Value</h3>

<p>The coverage plot will be displayed again.</p>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # baseball data where z is Hits and n is AtBats
  z &lt;- c(18, 17, 16, 15, 14, 14, 13, 12, 11, 11, 10, 10, 10, 10, 10,  9,  8,  7)
  n &lt;- c(45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45)

  b &lt;- gbp(z, n, model = "binomial")
  cov &lt;- coverage(b, nsim = 10)  
  coverage.plot(cov)

</code></pre>

<hr>
<h2 id='gbp'>Fitting Gaussian, Poisson, and Binomial Hierarchical Models</h2><span id='topic+gbp'></span>

<h3>Description</h3>

<p><code>gbp</code> fits Bayesian hierarchical models using the Uniform distribution on the second level variance component (variance of the prior distribution), which enables good frequentist repeated sampling properties. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gbp(y, se.or.n, covariates, mean.PriorDist, model, intercept, 
           confidence.lvl, n.AR, n.AR.factor, trial.scale, save.result,
           normal.CI, t, u)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gbp_+3A_y">y</code></td>
<td>

<p>a (<em>k</em> by 1) vector of <em>k</em> groups' sample means for Gaussian or of each group's number of successful trials for Binomial and Poisson data, where <em>k</em> is the number of groups (or units) in a dataset.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_se.or.n">se.or.n</code></td>
<td>

<p>a (<em>k</em> by 1) vector composed of the standard errors of all groups for Gaussian or 
of each group's total number of trials for Binomial and Poisson data.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_covariates">covariates</code></td>
<td>

<p>(optional) a matrix of covariate(s) each column of which corresponds to one covariate.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_mean.priordist">mean.PriorDist</code></td>
<td>

<p>(optional) a numeric value for the second-level mean parameter, <em>i.e.</em> the mean of prior
distribution, if you know this value a priori.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_model">model</code></td>
<td>

<p>a character string indicating which hierarchical model to fit. &quot;gaussian&quot; for Gaussian data, 
&quot;poisson&quot; for Poisson, and &quot;binomial&quot; for Binomial. Default is &quot;gaussian&quot;
</p>
</td></tr>
<tr><td><code id="gbp_+3A_intercept">intercept</code></td>
<td>

<p><code>TRUE</code> or <code>FALSE</code> flag indicating whether an intercept should be
included in the regression. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_confidence.lvl">confidence.lvl</code></td>
<td>

<p>a <code>float</code> between 0 and 1 to estimate 100*confidence.lvl% intervals. Default is 0.95.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_n.ar">n.AR</code></td>
<td>

<p>Only for Binomial model. If <code>n.AR = 1000</code>, all the results will be based on 1000 posterior samples using the acceptance-rejection sampling. Default is 0.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_n.ar.factor">n.AR.factor</code></td>
<td>

<p>Only for Binomial model. If <code>n.AR = 1000</code> and <code>n.AR.factor = 4</code>, then the acceptance-rejection method will sample 4 * 1000 trial samples, and accept or reject them until the method gets n.AR posterior samples. Default is 4.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_trial.scale">trial.scale</code></td>
<td>

<p>A scale used in the trial distribution of <code class="reqn">\alpha</code>. If resultant weight has too mamy 0's, scale should be smaller than before. If resultant weight has too few 0's, scale should be larger than before. If there are relatively huge weights, scale should be larger than before. Default is 1.3.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_save.result">save.result</code></td>
<td>

<p>Only for Binomial model with the acceptance-rejection sampling. <br /> If <code>save.result</code> is TRUE, all the results of weights and posterior samples will be saved in the gbp object. Default is TRUE.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_normal.ci">normal.CI</code></td>
<td>

<p>Only applicable for Gaussian data. If <code>TRUE</code> then a Normal
approximation is used to construct intervals for the level 1 group
means. If <code>FALSE</code> (default) then a Skew-Normal distribution is
used. Setting the value to <code>TRUE</code> may result in speed
improvements but may lead to intervals that under cover. 
</p>
</td></tr>
<tr><td><code id="gbp_+3A_t">t</code></td>
<td>

<p>Non-negative constant to determine the hyper-prior distribution of r for the Binomial model with the acceptance-rejection method. If t is positive, then the hyper-prior distribution of r is proper, otherwise improper. <code class="reqn">dr/(t + r)^{u+1}</code>.
</p>
</td></tr>
<tr><td><code id="gbp_+3A_u">u</code></td>
<td>

<p>A positive constant to determine the hyper-prior distribution of r for the Binomial model with the acceptance-rejection method. <code class="reqn">dr/(t + r)^{u+1}</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>gbp</code> fits a hierarchical model whose first-level hierarchy is a distribution of observed data and second-level is a conjugate prior distribution on the first-level parameter. To be specific, for Normal data, <code>gbp</code> constructs a two-level Normal-Normal multilevel model. <code class="reqn">V_{j}</code> (=<code class="reqn">\sigma^{2}/n_{j}</code>) is assumed to be known or to be accurately estimated, and subscript <em>j</em> indicates <em>j</em>-th group 
(or unit) in a dataset.
</p>
<p style="text-align: center;"><code class="reqn">(y_{j} | \theta_{j}) \stackrel{ind}{\sim} N(\theta_{j}, \sigma^{2}_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} |\mu_{0j} , A) \stackrel{ind}{\sim} N(\mu_{0j}, A)</code>
</p>

<p style="text-align: center;"><code class="reqn">\mu_{0j} = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>For Poisson data, <code>gbp</code> builds a two-level Poisson-Gamma multilevel model. A square bracket below indicates [mean, variance] of distribution, a constant multiplied to the notation representing Gamma distribution (Gam) is a scale, and <code class="reqn">y_{j}=\frac{z_{j}}{n_{j}}</code>.
</p>
<p style="text-align: center;"><code class="reqn">(z_{j} | \theta_{j}) \stackrel{ind}{\sim} Pois(n_{j}\theta_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} | r, \mu_{0j}) \stackrel{ind}{\sim} \frac{1}{r}Gam(r\mu_{0j})\stackrel{ind}{\sim}Gam[\mu_{0j}, \mu_{0j} / r] </code>
</p>

<p style="text-align: center;"><code class="reqn">log(\mu_{0j}) = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>For Binomial data, <code>gbp</code> sets a two-level Binomial-Beta multilevel model. A square bracket below indicates [mean, variance] of distribution and <code class="reqn">y_{j} = \frac{z_{j}}{n_{j}}</code>.
</p>
<p style="text-align: center;"><code class="reqn">(z_{j} | \theta_{j}) \stackrel{ind}{\sim} Bin(n_{j}, \theta_{j})</code>
</p>

<p style="text-align: center;"><code class="reqn">(\theta_{j} | r, \mu_{0j}) \stackrel{ind}{\sim} Beta(r\mu_{0j}, r(1-\mu_{0j})) \stackrel{ind}{\sim} Beta[\mu_{0j}, \mu_{0j}(1 - \mu_{0j}) / (r + 1)]</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(\mu_{0j}) = x_{j}'\beta</code>
</p>

<p>for <code class="reqn">j = 1, \ldots, k</code>, where <em>k</em> is the number of groups (units) in a dataset.
</p>
<p>For reference, based on the above notations, the Uniform prior distribution on the second level variance component (variance of the prior distribution) is <em>dA</em> for Gaussian and <code class="reqn">d(\frac{1}{r})</code> 
(= <code class="reqn">\frac{dr}{r^{2}}</code>) for Binomial and Poisson data. The second level variance component can be interpreted as variation among the first-level parameters (<code class="reqn">\theta_{j}</code>) or variance of ensemble information.
</p>
<p>Under this setting, the argument <code>y</code> in <code>gbp</code> is a (<em>k</em> by 1) vector of <em>k</em> groups' sample means (<code class="reqn">y_{j}'s</code> in the description of Normal-Normal model above) for Gaussian or of each group's number of successful trials (<code class="reqn">z_{j}'s</code>) for Binomial and Poisson data, where <em>k</em> is the number of groups (or units) in a dataset.
</p>
<p>The argument <code>se.or.n</code> is a (<em>k</em> by 1) vector composed of the standard errors (<code class="reqn">V_{j}'s</code>) of all groups for Gaussian or of each group's total number of trials (<code class="reqn">n_{j}'s</code>) for Binomial and Poisson data.
</p>
<p>As for two optional arguments, <code>covariates</code> and <code>mean.PriorDist</code>, there are three feasible 
combinations of them to run <code>gbp</code>. The first situation is when we do not have any covariate and do not 
know a mean of the prior distribution (<code class="reqn">\mu_{0}</code>) a priori. In this case, assigning none of two
optional arguments, such as &quot;<code>gbp(z, n, model = "binomial")</code>&quot;, will lead to a correct model. <code>gbp</code> 
will automatically fit a regression with only an intercept term to estimate a common mean of the prior
distribution (exchangeability).
</p>
<p>The second situation is when we have covariate(s) and do not know a mean of the prior distribution (<code class="reqn">\mu_{0}</code>) a priori. In this case, assigning a matrix, <em>X</em>, each column of which corresponds to one covariate, such as &quot;<code>gbp(z, n, X, model = "poisson")</code>&quot;, will lead to a correct model. Default of <code>gbp</code> is to fit a regression including an intercept term to estimate a mean of the prior distribution. Double exchangeability will hold in this case.
</p>
<p>The last case is when we know a mean of the prior distribution (<code class="reqn">\mu_{0}</code>) a priori. Now, we do
not need to estimate regression coefficients at all because we know a true value of <code class="reqn">\mu_{0}</code> (strong assumption).
Designating this value into the argument of <code>gbp</code> like 
&quot;<code>gbp(y, se, mean.PriorDist = 3)</code>&quot; is enough to account for it. For reference, 
<code>mean.PriorDist</code> has a stronger priority than <code>covariates</code>, which means that when both
arguments are designated, <code>gbp</code> will fit a hierarchical model using the known mean of prior distribution, <code>mean.PriorDist</code>.
</p>
<p><code>gbp</code> returns an object of class &quot;<code>gbp</code>&quot; which provides three relevant functions <code>plot</code>, <code>print</code>, and <code>summary</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>gbp</code> comprises of:
</p>
<table role = "presentation">
<tr><td><code>sample.mean</code></td>
<td>
<p>sample mean of each group (or unit)</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>if Gaussian data, standard error of sample mean in each group (or unit)</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>if Binomial and Poisson data, total number of trials of each group (or unit)</p>
</td></tr>
<tr><td><code>prior.mean</code></td>
<td>
<p>numeric if entered, NA if not entered</p>
</td></tr>
<tr><td><code>prior.mean.hat</code></td>
<td>
<p>estimate of prior mean by a regression if prior mean is not assigned a priori</p>
</td></tr>
<tr><td><code>shrinkage</code></td>
<td>
<p>shrinkage estimate of each group (adjusted posterior mean)</p>
</td></tr>
<tr><td><code>sd.shrinkage</code></td>
<td>
<p>posterior standard deviation of shrinkage</p>
</td></tr>
<tr><td><code>post.mean</code></td>
<td>
<p>posterior mean of each group</p>
</td></tr>
<tr><td><code>post.sd</code></td>
<td>
<p>posterior standard deviation of each group</p>
</td></tr>
<tr><td><code>post.intv.low</code></td>
<td>
<p>lower bound of 100*confidence.lvl% posterior interval (quantile of posterior distribution)</p>
</td></tr>
<tr><td><code>post.intv.upp</code></td>
<td>
<p>upper bound of 100*confidence.lvl% posterior interval (quantile of posterior distribution)</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>&quot;gaussian&quot; for Gaussian, &quot;poisson&quot; for Poisson, and &quot;binomial&quot; for Binomial data</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>a covariate vector or matrix if designated. NA if not</p>
</td></tr>
<tr><td><code>beta.new</code></td>
<td>
<p>regression coefficient estimates</p>
</td></tr>
<tr><td><code>beta.var</code></td>
<td>
<p>estimated variance matrix of regression coefficient</p>
</td></tr>
<tr><td><code>intercept</code></td>
<td>
<p>whether TRUE or FALSE</p>
</td></tr>
<tr><td><code>a.new</code></td>
<td>
<p>a posterior mode of <code class="reqn">\alpha</code> defined as log(<em>A</em>) for Gaussian or log(<code class="reqn">\frac{1}{r}</code>) for Binomial and Poisson data. Practical meaning (variation of ensemble information) of estimating <code class="reqn">\alpha</code> will appear in <code>summary(gbp.object)</code>.</p>
</td></tr>
<tr><td><code>a.var</code></td>
<td>
<p>posterior variance of <code class="reqn">\alpha</code></p>
</td></tr>
<tr><td><code>confidence.lvl</code></td>
<td>
<p>confidence level based on which confidence interval is constructed </p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>(only for Binomial model) weights for acceptance-rejection method</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>(only for Binomial model) posterior samples of p based on the acceptance-rejection method, if this method was used. This is a (k by nsim) matrix. Each row contains posteiror samples of each random effect.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>(only for Binomial model) posterior samples of alpha based on the acceptance-rejection method, if this method was used</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>(only for Binomial model) posterior samples of beta based on the acceptance-rejection method, if this method was used</p>
</td></tr>
<tr><td><code>accept.rate</code></td>
<td>
<p>(only for Binomial model) the acceptance rate of the acceptance-rejection method, if this method was used</p>
</td></tr>
<tr><td><code>n.AR</code></td>
<td>
<p>(Only for Binomial model) If <code>n.AR = 1000</code>, all the results will be based on 1000 posterior samples using the acceptance-rejection sampling. Default is 0.
</p>
</td></tr>
<tr><td><code>n.AR.factor</code></td>
<td>
<p>(only for Binomial model) If <code>n.AR = 1000</code> and <code>n.AR.factor = 4</code>, then the acceptance-rejection method will sample 4 * 1000 trial posteior samples, and accept or reject them. Default is 4.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris
</p>


<h3>References</h3>

<p>Tak, H., Kelly, J., and Morris, C. (2017) Rgbp: An R Package for Gaussian, Poisson, and Binomial Random Effects Models with Frequency Coverage Evaluations. <em>Journal of Statistical Software</em>. <b>78</b>, 5, 1&ndash;33.
</p>
<p>Morris, C. and Lysy, M. (2012). Shrinkage Estimation in Multilevel Normal Models. 
<em>Statistical Science</em>. <b>27</b>, 1, 115&ndash;134.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  # Loading datasets
  data(schools)
  y &lt;- schools$y
  se &lt;- schools$se

  # Arbitrary covariate for schools data
  x2 &lt;- rep(c(-1, 0, 1, 2), 2)
  
  # baseball data where z is Hits and n is AtBats
  z &lt;- c(18, 17, 16, 15, 14, 14, 13, 12, 11, 11, 10, 10, 10, 10, 10,  9,  8,  7)
  n &lt;- c(45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45)

  # One covariate: 1 if a player is an outfielder and 0 otherwise
  x1 &lt;- c(1,  1,  1,  1,  1,  0,  0,  0,  0,  1,  0,  0,  0,  1,  1,  0,  0,  0)

  ################################################################
  # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
  ################################################################

    ###################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution#
    ###################################################################################

    g &lt;- gbp(y, se, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  

    ### gcv$coverageRB, gcv$coverage10, gcv$average.coverageRB, gcv$average.coverage10,
    ### gcv$minimum.coverageRB, gcv$minimum.coverage10, gcv$raw.resultRB, 
    ### gcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of A
    ### and a regression coefficient (intercept), 
    ### not using estimated values as true ones.
    gcv &lt;- coverage(g, A.or.r = 9, reg.coef = 10, nsim = 10)  

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    g &lt;- gbp(y, se, x2, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  
 
    ### gcv$coverageRB, gcv$coverage10, gcv$average.coverageRB, gcv$average.coverage10,
    ### gcv$minimum.coverageRB, gcv$minimum.coverage10, gcv$raw.resultRB, 
    ### gcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of A
    ### and regression coefficients, not using estimated values 
    ### as true ones. Two values of reg.coef are for beta0 and beta1
    gcv &lt;- coverage(g, A.or.r = 9, reg.coef = c(10, 1), nsim = 10)  

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    g &lt;- gbp(y, se, mean.PriorDist = 8, model = "gaussian")
    g
    print(g, sort = FALSE)
    summary(g)
    plot(g)
    plot(g, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    gcv &lt;- coverage(g, nsim = 10)  

    ### gcv$coverageRB, gcv$coverage10, gcv$average.coverageRB, gcv$average.coverage10,
    ### gcv$minimum.coverageRB, gcv$minimum.coverage10, gcv$raw.resultRB, 
    ### gcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of A and
    ### 2nd level mean as true ones, not using estimated values as true ones.
    coverage(g, A.or.r = 9, mean.PriorDist = 5, nsim = 10)  

  ###############################################################
  # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
  ###############################################################

    ###################################################################################
    # If we do not have any covariate and do not know a mean of the prior distribution#
    ###################################################################################

    b &lt;- gbp(z, n, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverage10, bcv$average.coverageRB, bcv$average.coverage10,
    ### bcv$minimum.coverageRB, bcv$minimum.coverage10, bcv$raw.resultRB, 
    ### bcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of r
    ### and a regression coefficient (intercept), 
    ### not using estimated values as true ones.
    bcv &lt;- coverage(b, A.or.r = 60, reg.coef = -1, nsim = 10)  

    ##################################################################################
    # If we have one covariate and do not know a mean of the prior distribution yet, #
    ##################################################################################

    b &lt;- gbp(z, n, x1, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverage10, bcv$average.coverageRB, bcv$average.coverage10,
    ### bcv$minimum.coverageRB, bcv$minimum.coverage10, bcv$raw.resultRB, 
    ### bcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of r
    ### and regression coefficients, not using estimated values 
    ### as true ones. Two values of reg.coef are for beta0 and beta1
    bcv &lt;- coverage(b, A.or.r = 60, reg.coef = c(-1, 0), nsim = 10)  

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    b &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "binomial")
    b
    print(b, sort = FALSE)
    summary(b)
    plot(b)
    plot(b, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    bcv &lt;- coverage(b, nsim = 10)  

    ### bcv$coverageRB, bcv$coverage10, bcv$average.coverageRB, bcv$average.coverage10,
    ### bcv$minimum.coverageRB, bcv$minimum.coverage10, bcv$raw.resultRB, 
    ### bcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of r and
    ### 2nd level mean as true ones, not using estimated values as true ones.
    bcv &lt;- coverage(b, A.or.r = 60, mean.PriorDist = 0.3, nsim = 10)  

  ##############################################################
  # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
  ##############################################################

    ################################################
    # If we know a mean of the prior distribution, #
    ################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.265, model = "poisson")
    p
    print(p, sort = FALSE)
    summary(p)
    plot(p)
    plot(p, sort = FALSE)

    ### when we want to simulate pseudo datasets considering the estimated values 
    ### as true ones.
    pcv &lt;- coverage(p, nsim = 10)  

    ### pcv$coverageRB, pcv$coverage10, pcv$average.coverageRB, pcv$average.coverage10,
    ### pcv$minimum.coverageRB, pcv$minimum.coverage10, pcv$raw.resultRB, 
    ### pcv$raw.result10.

    ### when we want to simulate pseudo datasets based on different values of r and
    ### 2nd level mean as true ones, not using estimated values as true ones.
    pcv &lt;- coverage(p, A.or.r = 60, mean.PriorDist = 0.3, nsim = 10)  

</code></pre>

<hr>
<h2 id='gbp-internal'>Internal <code>gbp</code> functions</h2><span id='topic+BRInitialValue2ndLevelMeanKnown'></span><span id='topic+BRInitialValue2ndLevelMeanUnknown'></span><span id='topic+BRAlphaEst2ndLevelMeanKnown'></span><span id='topic+BRAlphaBetaEst2ndLevelMeanUnknown'></span><span id='topic+BRShrinkageEst'></span><span id='topic+BRPosteriorEst2ndLevelMeanKnown'></span><span id='topic+BRPosteriorEst2ndLevelMeanUnknown'></span><span id='topic+BRAR'></span><span id='topic+BRAR2ndLevelMeanKnown'></span><span id='topic+br'></span><span id='topic+PRInitialValue2ndLevelMeanKnown'></span><span id='topic+PRInitialValue2ndLevelMeanUnknown'></span><span id='topic+PRAlphaEst2ndLevelMeanKnown'></span><span id='topic+PRAlphaBetaEst2ndLevelMeanUnknown'></span><span id='topic+PRShrinkageEst'></span><span id='topic+PRPosteriorEst2ndLevelMeanKnown'></span><span id='topic+PRPosteriorEst2ndLevelMeanUnknown'></span><span id='topic+pr'></span><span id='topic+gr.ll.muknown'></span><span id='topic+gr.ll.muunknown'></span><span id='topic+gr.cp.to.dp'></span><span id='topic+derval'></span><span id='topic+tr'></span><span id='topic+gr'></span>

<h3>Description</h3>

<p>Internal <code>gbp</code> functions</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='hospital'>
Thirty-one Hospital Data
</h2><span id='topic+hospital'></span>

<h3>Description</h3>

<p>Medical profiling evaluation of 31 New York hospitals in 1992. We are to consider these as Normally-distributed indices of successful outcome rates for patients at these 31 hospitals following Coronary Artery Bypass Graft (CABG) surgeries. The indices are centered so that the New York statewide average outcome over all hospitals lies near 0. Larger estimates of <code>y</code> indicate hospitals that performed better for these surgeries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hospital)</code></pre>


<h3>Format</h3>

<p>A dataset of 31 hospitals comprises of:
</p>

<dl>
<dt><code>y</code></dt><dd><p>values obtained through a variance stabilizing transformation of the unbiased death rate estimates, <code>d</code> / <code>n</code>, assuming Binomial data. Details in the reference.</p>
</dd>
<dt><code>se</code></dt><dd><p>approximated standard error of y.</p>
</dd>
<dt><code>d</code></dt><dd><p>the number of deaths within a month of CABG surgeries in each hospital</p>
</dd>
<dt><code>n</code></dt><dd><p>total number of patients receiving CABG surgeries (case load) in each hospital</p>
</dd>
</dl>



<h3>Source</h3>

<p>Morris, C. and Lysy, M. (2012). Shrinkage Estimation in Multilevel Normal Models. <em>Statistical Science</em>. <b>27</b>. 115-134.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(hospital)
</code></pre>

<hr>
<h2 id='plot.gbp'>Drawing Shrinkage and Posterior Interval Plots</h2><span id='topic+plot.gbp'></span>

<h3>Description</h3>

<p><code>plot(gbp.object)</code> draws shrinkage and posterior interval plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gbp'
plot(x, sort = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gbp_+3A_x">x</code></td>
<td>

<p>a resultant object of <code>gbp</code> function. 
</p>
</td></tr>
<tr><td><code id="plot.gbp_+3A_sort">sort</code></td>
<td>

<p><code>TRUE</code> or <code>FALSE</code> flag. If <code>TRUE</code>, the interval plot (second plot) will be drawn by the order of <code>se</code> for Gaussian, or of <code>n</code> for Binomial and Poisson data. If <code>FALSE</code>, it will be by the order of data input. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="plot.gbp_+3A_...">...</code></td>
<td>

<p>further arguments passed to other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As for the argument <code>x</code>, if the result of <code>gbp</code> is designated to 
<code>b</code> like <br /> &quot;<code>b &lt;- gbp(z, n, model = "binomial")</code>&quot;, the argument <code>x</code> is supposed to be <code>b</code>.
</p>
<p>This function produces two plots containing information about the prior, sample, and posterior means.
</p>
<p>The first plot is a shrinkage plot representing sample means (black circle) on the
upper horizontal line and prior (blue line) and posterior means (red
circle) on the lower horizontal line. The aim of this plot is to get a sense of the
magnitude of the shrinkage and to observe if any change in ordering of the
groups has occurred. Crossovers (changes of order) are noted by a
black square as indicated in the legend. If the points plotted have
the same value then a sunflower plot is produced where each petal
(line protruding from the point) represent the count of points with
that value. The plot also aims to incorporate the uncertainty and the lengths of the violet and green lines are
proportional to the standard error and the posterior standard
deviation respectively.
</p>
<p>The final plot shows interval estimates of all the groups (units) in a dataset. Two short horizontal ticks at both ends of each black vertical line indicate 97.5% and 2.5% quantiles of a posterior distribution for each group (Normal for Gaussian, Beta for Binomial, and Gamma for Poisson). Red dots (posterior mean) are between black circles (sample mean) and blue line(s) (prior mean) as a result of shrinkage (regression toward the mean).
</p>
<p>If we want to see the interval plot (the second plot) NOT sorted by the order of <code>se</code> for Gaussian, or of <code>n</code> for Binomial and Poisson data, <code>plot(b, sort = FALSE)</code> will show this plot by the order of data input.
</p>


<h3>Value</h3>

<p>Two plots described in <em>details</em> will be displayed.</p>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(hospital)

  z &lt;- hospital$d
  n &lt;- hospital$n
  y &lt;- hospital$y
  se &lt;- hospital$se
  
  
  ###################################################################################
  # We do not have any covariates and do not know a mean of the prior distribution. #
  ###################################################################################

    ###############################################################
    # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
    ###############################################################

    g &lt;- gbp(y, se, model = "gaussian")
    plot(g)
    plot(g, sort = FALSE)

    ###############################################################
    # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
    ###############################################################

    b &lt;- gbp(z, n, model = "binomial")
    plot(b)
    plot(b, sort = FALSE)

    ##############################################################
    # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
    ##############################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.03, model = "poisson")
    plot(p)
    plot(p, sort = FALSE)

</code></pre>

<hr>
<h2 id='print.gbp'>Displaying 'gbp' Class</h2><span id='topic+print.gbp'></span>

<h3>Description</h3>

<p><code>print.gbp</code> enables users to see a compact group-level (unit-level) estimation result of <code>gbp</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gbp'
print(x, sort = TRUE, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gbp_+3A_x">x</code></td>
<td>

<p>a resultant object of <code>gbp</code> function. 
</p>
</td></tr>
<tr><td><code id="print.gbp_+3A_sort">sort</code></td>
<td>

<p><code>TRUE</code> or <code>FALSE</code> flag. If <code>TRUE</code>, the result will appear by the order of <code>se</code> for Gaussian, or of <code>n</code> for Binomial and Poisson data. If <code>FALSE</code>, it will do by the order of data input. Default is <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="print.gbp_+3A_...">...</code></td>
<td>

<p>further arguments passed to other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As for the argument <code>x</code>, if the result of <code>gbp</code> is designated to 
<code>b</code> like <br /> &quot;<code>b &lt;- gbp(z, n, model = "binomial")</code>&quot;, the argument <code>x</code> is supposed to be <code>b</code>.
</p>
<p>We do not need to type &quot;<code>print(b, sort = TRUE)</code>&quot; but &quot;<code>b</code>&quot; itself is enough to call <br /> <code>print(b, sort = TRUE)</code>. But if we want to see the result NOT sorted by the order of <code>se</code> for Gaussian, or of <code>n</code> for Binomial and Poisson data, <code>print(b, sort = FALSE)</code> will show the result by the order of data input.
</p>


<h3>Value</h3>

<p><code>print(gbp.object)</code> will display:
</p>
<table role = "presentation">
<tr><td><code>obs.mean</code></td>
<td>
<p>sample mean of each group</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>if Gaussian data, standard error of each group</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>if Binomial or Poisson data, total number of trials of each group</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>a covariate vector or matrix if designated. NA if not</p>
</td></tr>
<tr><td><code>prior.mean</code></td>
<td>
<p>numeric if entered, NA if not entered</p>
</td></tr>
<tr><td><code>prior.mean.hat</code></td>
<td>
<p>estimate of prior mean by a regression if prior mean is not assigned a priori. The variable name on the display will be &quot;prior.mean&quot;</p>
</td></tr>
<tr><td><code>prior.mean.AR</code></td>
<td>
<p>the posterior mean(s) of the expected random effects, if the acceptance-rejection method is used for the binomial model. The variable name on the display will be &quot;prior.mean&quot;.</p>
</td></tr>
<tr><td><code>shrinkage</code></td>
<td>
<p>shrinkage estimate of each group (adjusted posterior mean)</p>
</td></tr>
<tr><td><code>shrinkage.AR</code></td>
<td>
<p>the posterior mean of the shrinkage factor, if the acceptance-rejection method is used for the binomial model. The variable name on the display will be &quot;shrinkage&quot;.</p>
</td></tr>
<tr><td><code>low.intv</code></td>
<td>
<p>lower bound of 100*confidence.lvl% posterior interval</p>
</td></tr>
<tr><td><code>post.mean</code></td>
<td>
<p>posterior mean of each group</p>
</td></tr>
<tr><td><code>upp.intv</code></td>
<td>
<p>upper bound of 100*confidence.lvl% posterior interval</p>
</td></tr>
<tr><td><code>post.sd</code></td>
<td>
<p>posterior standard deviation of each group</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(hospital)

  z &lt;- hospital$d
  n &lt;- hospital$n
  y &lt;- hospital$y
  se &lt;- hospital$se
  
  ###################################################################################
  # We do not have any covariates and do not know a mean of the prior distribution. #
  ###################################################################################

    ###############################################################
    # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
    ###############################################################

    g &lt;- gbp(y, se, model = "gaussian")
    g
    print(g, sort = FALSE)

    ###############################################################
    # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
    ###############################################################

    b &lt;- gbp(z, n, model = "binomial")
    b
    print(b, sort = FALSE)

    ##############################################################
    # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
    ##############################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.03, model = "poisson")
    p
    print(p, sort = FALSE)

</code></pre>

<hr>
<h2 id='print.summary.gbp'>Displaying 'summary.gbp' Class</h2><span id='topic+print.summary.gbp'></span>

<h3>Description</h3>

<p><code>summary(gbp.object)</code> enables users to see a compact summary of estimation result.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.gbp'
print(x, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.gbp_+3A_x">x</code></td>
<td>

<p>a resultant object of <code>gbp</code> function. 
</p>
</td></tr>
<tr><td><code id="print.summary.gbp_+3A_...">...</code></td>
<td>

<p>further arguments passed to other methods.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary has three parts depending on the model fitted by <code>gbp</code>; <code>Main Summary</code>, <br /><code>Second-level Variance Component Estimation Summary</code>, and <code>Regression Summary</code> (if fitted).
</p>
<p>A display of <code>Main Summary</code> changes depending on whether all the groups (units) has the same standard error for Gaussian data (or the same total number of trials for Binomial and Poisson data). If they are not the same, 
<code>Main Summary</code> lists groups (units) with minimum, median, and maximum values of the standard error for Gaussian data (or of the total number of trials for Binomial and Poisson data). And the last row of <code>Main Summary</code> is about the overall average for all the groups (units) within each column. Note that this last row is not an average over displayed groups (units) above.
</p>
<p>If groups (units) have the same standard error for Gaussian (or the same total number of trials for Binomial and Poisson), <code>Main Summary</code> lists groups (units) with minimum, median, and maximum values of the sample mean. 
</p>
<p>For reference, if there are several units with the same median value, they will show up with numbering.
</p>
<p>The second part is about the <code>Second-level Variance Component Estimation Summary</code>. For reference, the second level variance component can be interpreted as variation among the first-level parameters (<code class="reqn">\theta_{j}</code>) or variance in ensemble information. It is <em>A</em> for Gaussian, <code class="reqn">\frac{\mu_{0j}}{r}</code> for Poisson, and <code class="reqn">\frac{\mu_{0j}(1 - \mu_{0j})}{r}</code> for Binomial data. To be specific, this part shows estimate of <code class="reqn">\alpha</code> (a posterior mode) defined as log(<em>A</em>) for Gaussian or log(<code class="reqn">\frac{1}{r}</code>) for Binomial and Poisson data, and its standard error. 
</p>
<p>The last part depends on whether <code>gbp</code> fitted a regression or not. For reference, <code>gbp</code> fits a regression if the second-level mean (<code>mean.PriorDist</code>) was not designated. In this case, <code>summary(gbp.object)</code> will display the result of regression fit.
</p>


<h3>Value</h3>

<p><code>summary(gbp.object)</code> shows a compact summary of estimation result such as:
</p>
<table role = "presentation">
<tr><td><code>Main summary</code></td>
<td>


<dl>
<dt>Unit w/ min(se or n)</dt><dd><p>an estimation result of a group (unit) with the minimum standard error for Gaussian or the minimum total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Unit w/ min(sample.mean)</dt><dd><p>appears instead of <code>Group w/ min(se or n)</code> when all the groups (units) have the same standard error for Gaussian or the same total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Unit w/ median(se or n)</dt><dd><p>an estimation result of group(s) (unit(s)) with the median standard error for Gaussian or the median total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Unit w/ median(sample.mean)</dt><dd><p>appears instead of <br /> <code>Group w/ median(se or n)</code> when all the groups (units) have the same standard error for Gaussian or the same total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Unit w/ max(se or n)</dt><dd><p>an estimation result of a group (unit) with the maximum standard error for Gaussian or the maximum total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Unit w/ max(sample.mean)</dt><dd><p>appears instead of <code>Group w/ max(se or n)</code> when all the groups (units) have the same standard error for Gaussian or the same total number of trials for Binomial and Poisson data.</p>
</dd>
<dt>Overall Means</dt><dd><p>the overall average for all the groups (units) within each column.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>Second-level Variance Component Estimation Summary</code></td>
<td>


<dl>
<dt>post.mode.alpha</dt><dd><p>a posterior mode of <code class="reqn">\alpha</code> defined as log(<em>A</em>) for Gaussian or log(<code class="reqn">\frac{1}{r}</code>) for Binomial and Poisson data.</p>
</dd>
<dt>post.sd.alpha</dt><dd><p>standard deviation of the posterior distribution of alpha</p>
</dd>
<dt>post.mode.r</dt><dd><p>posterior mode of either <code class="reqn">r</code> for Bianomial and Poisson models or <code class="reqn">A</code> for Gaussian model.</p>
</dd>
<dt>post.median.alpha</dt><dd><p>posterior median of <code class="reqn">\alpha</code> for Bianomial model, if the accept-reject method is used.</p>
</dd>
<dt>post.median.r</dt><dd><p>posterior median of <code class="reqn">r</code> for Bianomial model, if the accept-reject method is used.</p>
</dd>
</dl>

</td></tr>
<tr><td><code>Regression Summary (if fitted)</code></td>
<td>


<dl>
<dt>estimate</dt><dd><p>regression coefficient estimates.</p>
</dd>
<dt>se</dt><dd><p>estimated standard error of regression coefficients.</p>
</dd>
<dt>z.val</dt><dd><p>estimate / se.</p>
</dd>
<dt>p.val</dt><dd><p>two-sided p-values.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(hospital)

  z &lt;- hospital$d
  n &lt;- hospital$n
  y &lt;- hospital$y
  se &lt;- hospital$se
  
  ###################################################################################
  # We do not have any covariates and do not know a mean of the prior distribution. #
  ###################################################################################

    ###############################################################
    # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
    ###############################################################

    g &lt;- gbp(y, se, model = "gaussian")
    summary(g)

    ###############################################################
    # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
    ###############################################################

    b &lt;- gbp(z, n, model = "binomial")
    summary(b)

    ##############################################################
    # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
    ##############################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.03, model = "poisson")
    summary(p)

</code></pre>

<hr>
<h2 id='schools'>
Eight Schools Data
</h2><span id='topic+schools'></span>

<h3>Description</h3>

<p>Dataset as seen in Rubin (1981) which was an analysis of coaching
effects on SAT scores from eight schools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schools)</code></pre>


<h3>Format</h3>

<p>A dataset of 8 schools containing
</p>

<dl>
<dt><code>y</code></dt><dd><p>The observed coaching effect of each school</p>
</dd>
<dt><code>se</code></dt><dd><p>The standard error of the coaching effect of each school.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rubin, D. B. (1981). <em>Estimation in parallel randomized
experiments.</em> Journal of Educational Statistics, 6:377-401.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(schools)
</code></pre>

<hr>
<h2 id='summary.gbp'>Summarizing Estimation Result</h2><span id='topic+summary.gbp'></span>

<h3>Description</h3>

<p><code>summary.gbp</code> prepares a summary of estimation result saved in the object defined as &quot;gbp&quot; class creating &quot;summary.gbp&quot; class</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gbp'
summary(object, ...)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.gbp_+3A_object">object</code></td>
<td>

<p>a resultant object of <code>gbp</code> function. 
</p>
</td></tr>
<tr><td><code id="summary.gbp_+3A_...">...</code></td>
<td>

<p>further arguments passed to other methods.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>summary.gbp</code> prepares below contents:
</p>
<table role = "presentation">
<tr><td><code>main</code></td>
<td>

<p>a table to be displayed by <code>summary(gbp.object)</code>. <code><a href="#topic+print.summary.gbp">print.summary.gbp</a></code>.
</p>
</td></tr>
<tr><td><code>sec.var</code></td>
<td>

<p>a vector containing an estimation result of the second-level variance component. <code><a href="#topic+print.summary.gbp">print.summary.gbp</a></code>.
</p>
</td></tr>
<tr><td><code>reg</code></td>
<td>

<p>a vector composed of a summary of regression fit (if fitted). <br /> <code><a href="#topic+print.summary.gbp">print.summary.gbp</a></code>.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyungsuk Tak, Joseph Kelly, and Carl Morris</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(hospital)

  z &lt;- hospital$d
  n &lt;- hospital$n
  y &lt;- hospital$y
  se &lt;- hospital$se
  
  ###################################################################################
  # We do not have any covariates and do not know a mean of the prior distribution. #
  ###################################################################################

    ###############################################################
    # Gaussian Regression Interactive Multilevel Modeling (GRIMM) #
    ###############################################################

    g &lt;- gbp(y, se, model = "gaussian")
    summary(g)

    ###############################################################
    # Binomial Regression Interactive Multilevel Modeling (BRIMM) #
    ###############################################################

    b &lt;- gbp(z, n, model = "binomial")
    summary(b)

    ##############################################################
    # Poisson Regression Interactive Multilevel Modeling (PRIMM) #
    ##############################################################

    p &lt;- gbp(z, n, mean.PriorDist = 0.03, model = "poisson")
    summary(p)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
