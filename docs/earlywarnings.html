<!DOCTYPE html><html><head><title>Help for package earlywarnings</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {earlywarnings}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bdstest_ews'><p>BDS test Early Warning Signals</p></a></li>
<li><a href='#ch_ews'><p>Conditional Heteroskedasticity</p></a></li>
<li><a href='#circulation'><p>circulation data set</p></a></li>
<li><a href='#ddjnonparam_ews'><p>Drift Diffusion Jump Nonparametrics Early Warning Signals</p></a></li>
<li><a href='#find.optima'><p>find.optima</p></a></li>
<li><a href='#foldbif'><p>foldbif data set</p></a></li>
<li><a href='#generic_ews'><p>Generic Early Warning Signals</p></a></li>
<li><a href='#livpotential_ews'><p>Potential Analysis for univariate data</p></a></li>
<li><a href='#movpotential_ews'><p>Moving Average Potential</p></a></li>
<li><a href='#PlotPotential'><p>Plot Potential</p></a></li>
<li><a href='#qda_ews'><p>Quick Detection Analysis for Generic Early Warning Signals</p></a></li>
<li><a href='#sensitivity_ews'><p>Sensitivity Early Warning Signals</p></a></li>
<li><a href='#surrogates_ews'><p>Surrogates Early Warning Signals</p></a></li>
<li><a href='#UnivariateGrouping'><p>Get group assigment indices for univariate data points, given cluster break points</p></a></li>
<li><a href='#YD2PB_grayscale'><p>YD2PB_grayscale data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Early Warning Signals for Critical Transitions in Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.29</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-10-10</td>
</tr>
<tr>
<td>Description:</td>
<td>The Early-Warning-Signals Toolbox provides methods for estimating
    statistical changes in time series that can be used for identifying nearby
    critical transitions. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), ggplot2, moments, tgp, tseries</td>
</tr>
<tr>
<td>Imports:</td>
<td>fields, nortest, graphics, grDevices, quadprog, Kendall,
KernSmooth, methods, lmtest, som, spam, stats, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.early-warning-signals.org">http://www.early-warning-signals.org</a>, <a href="http://www.vasilisdakos.info">http://www.vasilisdakos.info</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-10-10 14:11:45 UTC; dakos</td>
</tr>
<tr>
<td>Author:</td>
<td>Vasilis Dakos [aut, cre],
  Leo Lahti <a href="https://orcid.org/0000-0001-5537-637X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vasilis Dakos &lt;vasilis.dakos@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-10-10 18:50:15 UTC</td>
</tr>
</table>
<hr>
<h2 id='bdstest_ews'>BDS test Early Warning Signals</h2><span id='topic+bdstest_ews'></span>

<h3>Description</h3>

<p><code><a href="#topic+bdstest_ews">bdstest_ews</a></code> is used to estimate the BDS statistic to detect nonlinearity in the residuals of a timeseries after first-difference detrending, fitting an ARMA(p,q) model, and fitting a GARCH(0,1) model. The function is making use of <code>bds.test</code> from the tseries package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bdstest_ews(
  timeseries,
  ARMAoptim = TRUE,
  ARMAorder = c(1, 0),
  GARCHorder = c(0, 1),
  embdim = 3,
  epsilon = c(0.5, 0.75, 1),
  boots = 1000,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bdstest_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_armaoptim">ARMAoptim</code></td>
<td>
<p>is the order of the <code>ARMA(p,q)</code> model to be fitted on the original timeseries. If TRUE the best ARMA model based on AIC is applied. If FALSE the <code>ARMAorder</code> is used.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_armaorder">ARMAorder</code></td>
<td>
<p>is the order of the <code>AR(p)</code> and <code>MA(q)</code> process to be fitted on the original timeseries. Default is <code>p=1</code> <code>q=0</code>.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_garchorder">GARCHorder</code></td>
<td>
<p>fits a GARCH model on the original timeseries where <code>GARCHorder[1]</code> is the GARCH part and <code>GARCHorder[2]</code> is the ARCH part.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_embdim">embdim</code></td>
<td>
<p>is the embedding dimension (2, 3,... <code>embdim</code>) up to which the BDS test will be estimated (must be numeric). Default value is 3.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_epsilon">epsilon</code></td>
<td>
<p>is a numeric vector that is used to scale the standard deviation of the timeseries. The BDS test is computed for each element of epsilon. Default is 0.5, 0.75 and 1.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_boots">boots</code></td>
<td>
<p>is the number of bootstraps performed to estimate significance p values for the BDS test. Default is 1000.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="bdstest_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function requires the installation of packages tseries and quadprog that are not available under Linux and need to be manually installed under Windows.
</p>


<h3>Value</h3>

<p><code><a href="#topic+bdstest_ews">bdstest_ews</a></code> returns output on the R console that summarizes the BDS test statistic for all embedding dimensions and  <code>epsilon</code> values used, and for first-differenced data, ARMA(p.q) residuals, and GARCH(0,1) residuals). Also the significance p values are returned estimated both by comparing to a standard normal distribution and by bootstrapping.
</p>
<p>In addition, <code><a href="#topic+bdstest_ews">bdstest_ews</a></code> returns a plot with the original timeseries, the residuals after first-differencing, and fitting the ARMA(p,q) and GARCH(0,1) models. Also the autocorrelation <code><a href="stats.html#topic+acf">acf</a></code> and partial autocorrelation <code><a href="stats.html#topic+pacf">pacf</a></code> functions are estimated serving as guides for the choice of lags of the linear models fitted to the data.
</p>


<h3>Author(s)</h3>

<p>S. R. Carpenter, modified by V. Dakos
</p>


<h3>References</h3>

<p>J. B. Cromwell, W. C. Labys and M. Terraza (1994): Univariate Tests for Time Series Models, Sage, Thousand Oaks, CA, pages 32-36.
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code>; 
<code><a href="#topic+ddjnonparam_ews">ddjnonparam_ews</a></code>; 
<code><a href="#topic+bdstest_ews">bdstest_ews</a></code>; 
<code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code>; 
<code><a href="#topic+surrogates_ews">surrogates_ews</a></code>; 
<code><a href="#topic+ch_ews">ch_ews</a></code>; 
<code><a href="#topic+movpotential_ews">movpotential_ews</a></code>; 
<code><a href="#topic+livpotential_ews">livpotential_ews</a></code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
bdstest_ews(foldbif, ARMAoptim=FALSE, ARMAorder=c(1,0), 
  	       embdim=3, epsilon=0.5, boots=200, 
       logtransform=FALSE, interpolate=FALSE)
</code></pre>

<hr>
<h2 id='ch_ews'>Conditional Heteroskedasticity</h2><span id='topic+ch_ews'></span>

<h3>Description</h3>

<p><code><a href="#topic+ch_ews">ch_ews</a></code> is used to estimate changes in conditional heteroskedasticity within rolling windows along a timeseries
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch_ews(
  timeseries,
  winsize = 10,
  alpha = 0.1,
  optim = TRUE,
  lags = 4,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_winsize">winsize</code></td>
<td>
<p>is length of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 10%.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_alpha">alpha</code></td>
<td>
<p>is the significance threshold (must be numeric). Default is 0.1.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_optim">optim</code></td>
<td>
<p>logical. If TRUE an autoregressive model is fit to the data within the rolling window using AIC optimization. Otherwise an autoregressive model of specific order <code>lags</code> is selected.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_lags">lags</code></td>
<td>
<p>is a parameter that determines the specific order of an autoregressive model to fit the data. Default is 4.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="ch_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+ch_ews">ch_ews</a></code> returns a matrix that contains:
time the time index.
r.squared the R2 values of the regressed residuals.
critical.value the chi-square critical value based on the desired <code>alpha</code> level for 1 degree of freedom divided by the number of residuals used in the regression.
test.result logical. It indicates whether conditional heteroskedasticity was significant.
ar.fit.order the order of the specified autoregressive model- only informative if <code>optim</code> FALSE was selected.
</p>
<p>In addition, <code><a href="#topic+ch_ews">ch_ews</a></code> plots the original timeseries and the R2 where the level of significance is also indicated.
</p>


<h3>Author(s)</h3>

<p>T. Cline, modified by V. Dakos
</p>


<h3>References</h3>

<p>Seekell, D. A., et al (2011). 'Conditional heteroscedasticity as a leading indicator of ecological regime shifts.' <em>American Naturalist</em> 178(4): 442-451
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code>; <code><a href="#topic+ddjnonparam_ews">ddjnonparam_ews</a></code>; <code><a href="#topic+bdstest_ews">bdstest_ews</a></code>; <code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code>; <code><a href="#topic+surrogates_ews">surrogates_ews</a></code>; <code><a href="#topic+ch_ews">ch_ews</a></code>; <code>movpotential_ews</code>; <code>livpotential_ews</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
out=ch_ews(foldbif, winsize=50, alpha=0.05, optim=TRUE, lags)
</code></pre>

<hr>
<h2 id='circulation'>circulation data set</h2><span id='topic+circulation'></span>

<h3>Description</h3>

<p>circulation data set
</p>


<h3>Format</h3>

<p>TBA
</p>


<h3>Source</h3>

<p>TBA
</p>


<h3>References</h3>

<p>See citation('earlywarnings')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
</code></pre>

<hr>
<h2 id='ddjnonparam_ews'>Drift Diffusion Jump Nonparametrics Early Warning Signals</h2><span id='topic+ddjnonparam_ews'></span>

<h3>Description</h3>

<p><code>ddjnonparam_ews</code> is used to compute nonparametrically conditional variance, drift, diffusion and jump intensity in a timeseries and it also interpolates to obtain the evolution of the nonparametric statistics in time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ddjnonparam_ews(
  timeseries,
  bandwidth = 0.6,
  na = 500,
  logtransform = TRUE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ddjnonparam_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="ddjnonparam_ews_+3A_bandwidth">bandwidth</code></td>
<td>
<p>is the bandwidht of the kernel regressor (must be numeric). Default is 0.6.</p>
</td></tr>
<tr><td><code id="ddjnonparam_ews_+3A_na">na</code></td>
<td>
<p>is the number of points for computing the kernel (must be numeric). Default is 500.</p>
</td></tr>
<tr><td><code id="ddjnonparam_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="ddjnonparam_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approach is based on estimating terms of a drift-diffusion-jump model as a surrogate for the unknown true data generating process: <code class="reqn">dx = f(x,\theta)dt + g(x,\theta)dW + dJ</code>. Here x is the state variable, f() and g() are nonlinear functions, dW is a Wiener process and dJ is a jump process. Jumps are large, one-step, positive or negative shocks that are uncorrelated in time. In addition, <code>ddjnonparam_ews</code> returns a first plot with the original timeseries and the residuals after first-differencing. A second plot shows the nonparametric conditional variance, total variance, diffusion and jump intensity over the data, and a third plot the same nonparametric statistics over time.
</p>


<h3>Value</h3>

<p><code>ddjnonparam_ews</code> returns an object with elements:
avec is the mesh for which values of the nonparametric statistics are estimated.
S2.vec is the conditional variance of the timeseries <code>x</code> over <code>avec</code>.
TotVar.dx.vec is the total variance of <code>dx</code> over <code>avec</code>.
Diff2.vec is the diffusion estimated as <code>total variance - jumping intensity</code> vs <code>avec</code>.
LamdaZ.vec is the jump intensity over <code>avec</code>.
Tvec1 is the timeindex.
S2.t is the conditional variance of the timeseries <code>x</code> data over <code>Tvec1</code>.
TotVar.t is the total variance of <code>dx</code> over <code>Tvec1</code>.
Diff2.t is the diffusion over <code>Tvec1</code>.
Lamda.t is the jump intensity over <code>Tvec1</code>.
</p>


<h3>Author(s)</h3>

<p>S. R. Carpenter, modified by V. Dakos and L. Lahti
</p>


<h3>References</h3>

<p>Carpenter, S. R. and W. A. Brock (2011). 'Early warnings of unknown nonlinear shifts: a nonparametric approach.' <em>Ecology</em> 92(12): 2196-2201
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code>; <code><a href="#topic+ddjnonparam_ews">ddjnonparam_ews</a></code>; <code><a href="#topic+bdstest_ews">bdstest_ews</a></code>; <code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code>;<code><a href="#topic+surrogates_ews">surrogates_ews</a></code>; <code><a href="#topic+ch_ews">ch_ews</a></code>; <code><a href="#topic+movpotential_ews">movpotential_ews</a></code>; <code><a href="#topic+livpotential_ews">livpotential_ews</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
output&lt;-ddjnonparam_ews(foldbif,bandwidth=0.6,na=500,
logtransform=TRUE,interpolate=FALSE)
</code></pre>

<hr>
<h2 id='find.optima'>find.optima</h2><span id='topic+find.optima'></span>

<h3>Description</h3>

<p>Detect optima, excluding very local optima below detection.threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.optima(f, detection.threshold = 0, bw, detection.limit = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.optima_+3A_f">f</code></td>
<td>
<p>density</p>
</td></tr>
<tr><td><code id="find.optima_+3A_detection.threshold">detection.threshold</code></td>
<td>
<p>detection threshold for peaks</p>
</td></tr>
<tr><td><code id="find.optima_+3A_bw">bw</code></td>
<td>
<p>bandwidth</p>
</td></tr>
<tr><td><code id="find.optima_+3A_detection.limit">detection.limit</code></td>
<td>
<p>Minimun accepted density for a maximum; 
as a multiple of kernel height</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
min minima
max maxima
detection.density Minimum detection density
</p>


<h3>Author(s)</h3>

<p>Leo Lahti <a href="mailto:leo.lahti@iki.fi">leo.lahti@iki.fi</a>
</p>

<hr>
<h2 id='foldbif'>foldbif data set</h2><span id='topic+foldbif'></span>

<h3>Description</h3>

<p>foldbif data set
</p>


<h3>Format</h3>

<p>TBA
</p>


<h3>Source</h3>

<p>TBA
</p>


<h3>References</h3>

<p>See citation('earlywarnings')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
</code></pre>

<hr>
<h2 id='generic_ews'>Generic Early Warning Signals</h2><span id='topic+generic_ews'></span>

<h3>Description</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code> is used to estimate statistical moments within rolling windows along a timeseries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generic_ews(
  timeseries,
  winsize = 50,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidth = NULL,
  span = NULL,
  degree = NULL,
  logtransform = FALSE,
  interpolate = FALSE,
  AR_n = FALSE,
  powerspectrum = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generic_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings. If the powerspectrum is to be plotted as well, the timeseries lenght should be even number.</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_winsize">winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 50%.</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_detrending">detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are four options: gaussian filtering, loess fitting, linear detrending and first-differencing. Default is no detrending.</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_bandwidth">bandwidth</code></td>
<td>
<p>for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector bw.nrd0 (Default).</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_span">span</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100, Default 25).</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_degree">degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default).</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_ar_n">AR_n</code></td>
<td>
<p>logical. If TRUE the best fitted AR(n) model is fitted to the data. Default is FALSE.</p>
</td></tr>
<tr><td><code id="generic_ews_+3A_powerspectrum">powerspectrum</code></td>
<td>
<p>logical. If TRUE the power spectrum within each rolling window is plotted. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition, <code><a href="#topic+generic_ews">generic_ews</a></code> returns three plots. The first plot contains the original data, the detrending/filtering applied and the residuals (if selected), and all the moment statistics. For each statistic trends are estimated by the nonparametric Kendall tau correlation. The second plot, if asked, quantifies resilience indicators fitting AR(n) selected by the Akaike Information Criterion. The third plot, if asked, is the power spectrum estimated by spec.ar for all frequencies within each rolling window.
</p>


<h3>Value</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code> returns a matrix that contains:
tim the time index.
ar1 the autoregressive coefficient ar(1) of a first order AR model fitted on the data within the rolling window.
sd the standard deviation of the data estimated within each rolling window.
sk the skewness of the data estimated within each rolling window.
kurt the kurtosis of the data estimated within each rolling window.
cv the coefficient of variation of the data estimated within each rolling window.
returnrate the return rate of the data estimated as 1-ar(1) cofficient within each rolling window.
densratio the density ratio of the power spectrum of the data estimated as the ratio of low frequencies over high frequencies within each rolling window; acf1 the autocorrelation at first lag of the data estimated within each rolling window.
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Ives, A. R. (1995). 'Measuring resilience in stochastic systems.' <em>Ecological Monographs</em> 65: 217-233
</p>
<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
out=generic_ews(foldbif,winsize=50,detrending='gaussian',
bandwidth=5,logtransform=FALSE,interpolate=FALSE)
</code></pre>

<hr>
<h2 id='livpotential_ews'>Potential Analysis for univariate data</h2><span id='topic+livpotential_ews'></span>

<h3>Description</h3>

<p><code>livpotential_ews</code> performs one-dimensional potential estimation derived from a uni-variate timeseries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>livpotential_ews(
  x,
  std = 1,
  bw = "nrd",
  weights = c(),
  grid.size = NULL,
  detection.threshold = 1,
  bw.adjust = 1,
  density.smoothing = 0,
  detection.limit = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="livpotential_ews_+3A_x">x</code></td>
<td>
<p>Univariate data (vector) for which the potentials shall be estimated</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_std">std</code></td>
<td>
<p>Standard deviation of the noise (defaults to 1; this will set scaled potentials)</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_bw">bw</code></td>
<td>
<p>kernel bandwidth estimation method</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_weights">weights</code></td>
<td>
<p>optional weights in ksdensity (used by movpotentials).</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_grid.size">grid.size</code></td>
<td>
<p>Grid size for potential estimation.</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_detection.threshold">detection.threshold</code></td>
<td>
<p>maximum detection threshold as fraction of density kernel height dnorm(0, sd = bandwidth)/N</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_bw.adjust">bw.adjust</code></td>
<td>
<p>The real bandwidth will be bw.adjust*bw; defaults to 1</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_density.smoothing">density.smoothing</code></td>
<td>
<p>Add a small constant density across the whole observation range to regularize density estimation (and to avoid zero probabilities within the observation range). This parameter adds uniform density across the observation range, scaled by density.smoothing.</p>
</td></tr>
<tr><td><code id="livpotential_ews_+3A_detection.limit">detection.limit</code></td>
<td>
<p>minimum accepted density for a maximum; as a multiple of kernel height
</p>
<p>return <code>livpotential</code> returns a list with the following elements:
xi the grid of points on which the potential is estimated
pot The estimated potential: -log(f)*std^2/2, where f is the density.
density Density estimate corresponding to the potential.
min.inds indices of the grid points at which the density has minimum values; (-potentials; neglecting local optima)
max.inds indices the grid points at which the density has maximum values; (-potentials; neglecting local optima)
bw bandwidth of kernel used
min.points grid point values at which the density has minimum values; (-potentials; neglecting local optima)
max.points grid point values at which the density has maximum values; (-potentials; neglecting local optima)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Based on Matlab code from Egbert van Nes modified by Leo Lahti. Implemented in early warnings package by V. Dakos.
</p>


<h3>References</h3>

<p>Livina, VN, F Kwasniok, and TM Lenton, 2010. Potential analysis reveals changing number of climate states during the last 60 kyr . <em>Climate of the Past</em>, 6, 77-82.
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
res &lt;- livpotential_ews(foldbif[,1])
</code></pre>

<hr>
<h2 id='movpotential_ews'>Moving Average Potential</h2><span id='topic+movpotential_ews'></span>

<h3>Description</h3>

<p>This function reconstructs a potential derived from data along a gradient of a given parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movpotential_ews(
  X,
  param = NULL,
  bw = "nrd",
  bw.adjust = 1,
  detection.threshold = 0.1,
  std = 1,
  grid.size = 50,
  plot.cutoff = 0.5,
  plot.contours = TRUE,
  binwidth = 0.2,
  bins = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movpotential_ews_+3A_x">X</code></td>
<td>
<p>a vector of the X observations of the state variable of interest</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_param">param</code></td>
<td>
<p>parameter values corresponding to the observations in X</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_bw">bw</code></td>
<td>
<p>Bandwidth for smoothing kernels. Automatically determined by default.</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_bw.adjust">bw.adjust</code></td>
<td>
<p>Bandwidth adjustment constant</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_detection.threshold">detection.threshold</code></td>
<td>
<p>Threshold for local optima to be discarded.</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_std">std</code></td>
<td>
<p>Standard deviation.</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_grid.size">grid.size</code></td>
<td>
<p>number of evaluation points; number of steps between min and max potential; also used as kernel window size</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_plot.cutoff">plot.cutoff</code></td>
<td>
<p>cuttoff for potential minima and maxima in visualization</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_plot.contours">plot.contours</code></td>
<td>
<p>Plot contours on the landscape visualization</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_binwidth">binwidth</code></td>
<td>
<p>binwidth for contour plot</p>
</td></tr>
<tr><td><code id="movpotential_ews_+3A_bins">bins</code></td>
<td>
<p>bins for contour plot. Overrides binwidth if given</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:
pars values of the covariate parameter as matrix;
xis values of the x as matrix;
pots smoothed potentials;
mins minima in the densities (-potentials; neglecting local optima);
maxs maxima in densities (-potentials; neglecting local optima);
plot an object that displays the potential estimated in 2D
</p>


<h3>Author(s)</h3>

<p>L. Lahti, E. van Nes, V. Dakos.
</p>


<h3>References</h3>

<p>Hirota, M., Holmgren, M., van Nes, E.H. &amp; Scheffer, M. (2011). Global resilience of tropical forest and savanna to critical transitions. <em>Science</em>, 334, 232-235.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- c(rnorm(1000, mean = 0), rnorm(1000, mean = -2), rnorm(1000, mean = 2));
param &lt;- seq(0,5,length=3000); 
res &lt;- movpotential_ews(X, param)
</code></pre>

<hr>
<h2 id='PlotPotential'>Plot Potential</h2><span id='topic+PlotPotential'></span>

<h3>Description</h3>

<p>Visualization of the potential function from the movpotential function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotPotential(
  res,
  title = "",
  xlab.text,
  ylab.text,
  cutoff = 0.5,
  plot.contours = TRUE,
  binwidth = 0.2,
  bins = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotPotential_+3A_res">res</code></td>
<td>
<p>output from movpotential function</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_title">title</code></td>
<td>
<p>title text</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_xlab.text">xlab.text</code></td>
<td>
<p>xlab text</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_ylab.text">ylab.text</code></td>
<td>
<p>ylab text</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_cutoff">cutoff</code></td>
<td>
<p>parameter determining the upper limit of potential for visualizations</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_plot.contours">plot.contours</code></td>
<td>
<p>Plot contour lines.</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_binwidth">binwidth</code></td>
<td>
<p>binwidth for contour plot</p>
</td></tr>
<tr><td><code id="PlotPotential_+3A_bins">bins</code></td>
<td>
<p>bins for contour plot. Overrides binwidth if given</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 potential plot
</p>


<h3>Author(s)</h3>

<p>Leo Lahti <a href="mailto:leo.lahti@iki.fi">leo.lahti@iki.fi</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  X = c(rnorm(1000, mean = 0), rnorm(1000, mean = -2), 
  	             rnorm(1000, mean = 2))
       param = seq(0,5,length=3000); 
       res &lt;- movpotential_ews(X, param); 
       PlotPotential(res$res, title = '', 
       	             xlab.text = '', ylab.text = '', 
		     cutoff = 0.5, 
		     plot.contours = TRUE, binwidth = 0.2)
</code></pre>

<hr>
<h2 id='qda_ews'>Quick Detection Analysis for Generic Early Warning Signals</h2><span id='topic+qda_ews'></span>

<h3>Description</h3>

<p>Estimate autocorrelation, variance within rolling windows along a timeseries, test the significance of their trends, and reconstruct the potential landscape of the timeseries.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qda_ews(
  timeseries,
  param = NULL,
  winsize = 50,
  detrending = c("no", "gaussian", "linear", "first-diff"),
  bandwidth = NULL,
  boots = 100,
  s_level = 0.05,
  cutoff = 0.05,
  detection.threshold = 0.002,
  grid.size = 50,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qda_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_param">param</code></td>
<td>
<p>values corresponding to observations in timeseries</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_winsize">winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 50%.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_detrending">detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are four options: <code>gaussian</code> filtering, <code>linear</code> detrending and <code>first-differencing</code>. Default is <code>no</code> detrending.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_bandwidth">bandwidth</code></td>
<td>
<p>is the bandwidth used for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector <code><a href="stats.html#topic+bw.nrd0">bw.nrd0</a></code> (Default).</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_boots">boots</code></td>
<td>
<p>the number of surrogate data to generate from fitting an ARMA(p,q) model. Default is 100.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_s_level">s_level</code></td>
<td>
<p>significance level. Default is 0.05.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_cutoff">cutoff</code></td>
<td>
<p>the cutoff value to visualize the potential landscape</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_detection.threshold">detection.threshold</code></td>
<td>
<p>detection threshold for potential minima</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_grid.size">grid.size</code></td>
<td>
<p>grid size (for potential analysis)</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="qda_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>qda_ews produces three plots. The first plot contains the original data, the detrending/filtering applied and the residuals (if selected), autocorrelation and variance. For each statistic trends are estimated by the nonparametric Kendall tau correlation.  The second plot, returns a histogram of the distributions of the Kendall trend statistic for autocorrelation and variance estimated on the surrogated data. Vertical lines represent the level of significance, whereas the black dots the actual trend found in the time series. The third plot is the reconstructed potential landscape in 2D. In addition, the function returns a list containing the output from the respective functions generic_RShiny (indicators); surrogates_RShiny (trends); movpotential_ews (potential analysis)
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos, Leo Lahti, March 1, 2013 <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>See Also</h3>

<p><code><a href="#topic+generic_ews">generic_ews</a></code>; <code><a href="#topic+ddjnonparam_ews">ddjnonparam_ews</a></code>; <code><a href="#topic+bdstest_ews">bdstest_ews</a></code>; <code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code>; <code><a href="#topic+surrogates_ews">surrogates_ews</a></code>; <code><a href="#topic+ch_ews">ch_ews</a></code>; <code><a href="#topic+movpotential_ews">movpotential_ews</a></code>; <code><a href="#topic+livpotential_ews">livpotential_ews</a></code>;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
out &lt;- qda_ews(foldbif, param = NULL, winsize = 50, 
      	          detrending='gaussian', bandwidth=NULL, 
	  boots = 10, s_level = 0.05, cutoff=0.05, 
	  detection.threshold = 0.002, grid.size = 50, 
	  logtransform=FALSE, interpolate=FALSE)
</code></pre>

<hr>
<h2 id='sensitivity_ews'>Sensitivity Early Warning Signals</h2><span id='topic+sensitivity_ews'></span>

<h3>Description</h3>

<p><code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code> is used to estimate trends in statistical moments for different sizes of rolling windows along a timeseries and the trends are estimated by the nonparametric Kendall tau correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_ews(
  timeseries,
  indicator = c("ar1", "sd", "acf1", "sk", "kurt", "cv", "returnrate", "densratio"),
  winsizerange = c(25, 75),
  incrwinsize = 25,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidthrange = c(5, 100),
  spanrange = c(5, 100),
  degree = NULL,
  incrbandwidth = 20,
  incrspanrange = 10,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_indicator">indicator</code></td>
<td>
<p>is the statistic (leading indicator) selected for which the sensitivity analysis is perfomed. Currently, the indicators supported are: ar1 autoregressive coefficient of a first order AR model, sd, standard deviation, acf1 autocorrelation at first lag, sk skewness, kurt kurtosis, cv coeffcient of variation, returnrate, and densratio density ratio of the power spectrum at low frequencies over high frequencies.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_winsizerange">winsizerange</code></td>
<td>
<p>is the range of the rolling window sizes expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 25% - 75%.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_incrwinsize">incrwinsize</code></td>
<td>
<p>increments the rolling window size (must be numeric between 0 and 100). Default is 25.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_detrending">detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered. There are three options: gaussian filtering, loess fitting, linear detrending and first-differencing. Default is no detrending.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_bandwidthrange">bandwidthrange</code></td>
<td>
<p>is the range of the bandwidth used for the Gaussian kernel when gaussian filtering is selected. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 5% - 100%.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_spanrange">spanrange</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100). Default is 5% - 100%.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_degree">degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default).</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_incrbandwidth">incrbandwidth</code></td>
<td>
<p>is the size to increment the bandwidth used for the Gaussian kernel when gaussian filtering is applied. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default is 20.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_incrspanrange">incrspanrange</code></td>
<td>
<p>Span range</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="sensitivity_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition, <code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code> returns a plot with the Kendall tau estimates and their p-values for the range of rolling window sizes used, together with a histogram of the distributions of the statistic and its significance. When gaussian filtering is chosen, a contour plot is produced for the Kendall tau estimates and their p-values for the range of both rolling window sizes and bandwidth used. A reverse triangle indicates the combination of the two parameters for which the Kendall tau was the highest
</p>


<h3>Value</h3>

<p><code><a href="#topic+sensitivity_ews">sensitivity_ews</a></code> returns a matrix that contains the Kendall tau rank correlation estimates for the rolling window sizes (rows) and bandwidths (columns), if gaussian filtering is selected.
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif)
output=sensitivity_ews(foldbif,indicator='sd',detrending='gaussian',
incrwinsize=25,incrbandwidth=20)
</code></pre>

<hr>
<h2 id='surrogates_ews'>Surrogates Early Warning Signals</h2><span id='topic+surrogates_ews'></span>

<h3>Description</h3>

<p><code><a href="#topic+surrogates_ews">surrogates_ews</a></code> is used to estimate distributions of trends in statistical moments from different surrogate timeseries generated after fitting an ARMA(p,q) model on the data. The trends are estimated by the nonparametric Kendall tau correlation coefficient and can be compared to the trends estimated in the original timeseries to produce probabilities of false positives.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surrogates_ews(
  timeseries,
  indicator = c("ar1", "sd", "acf1", "sk", "kurt", "cv", "returnrate", "densratio"),
  winsize = 50,
  detrending = c("no", "gaussian", "loess", "linear", "first-diff"),
  bandwidth = NULL,
  span = NULL,
  degree = NULL,
  boots = 100,
  logtransform = FALSE,
  interpolate = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surrogates_ews_+3A_timeseries">timeseries</code></td>
<td>
<p>a numeric vector of the observed univariate timeseries values or a numeric matrix where the first column represents the time index and the second the observed timeseries values. Use vectors/matrices with headings.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_indicator">indicator</code></td>
<td>
<p>is the statistic (leading indicator) selected for which the surrogate timeseries are produced. Currently, the indicators supported are: <code>ar1</code> autoregressive coefficient of a first order AR model, <code>sd</code> standard deviation, <code>acf1</code> autocorrelation at first lag, <code>sk</code> skewness, <code>kurt</code> kurtosis, <code>cv</code> coeffcient of variation, <code>returnrate</code>, and <code>densratio</code> density ratio of the power spectrum at low frequencies over high frequencies.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_winsize">winsize</code></td>
<td>
<p>is the size of the rolling window expressed as percentage of the timeseries length (must be numeric between 0 and 100). Default valuise 50%.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_detrending">detrending</code></td>
<td>
<p>the timeseries can be detrended/filtered prior to analysis. There are three options: <code>gaussian</code> filtering, <code>loess</code> fitting, <code>linear</code> detrending and <code>first-diff</code>erencing. Default is <code>no</code> detrending.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_bandwidth">bandwidth</code></td>
<td>
<p>is the bandwidth used for the Gaussian kernel when gaussian filtering is selected. It is expressed as percentage of the timeseries length (must be numeric between 0 and 100). Alternatively it can be given by the bandwidth selector <code><a href="stats.html#topic+bw.nrd0">bw.nrd0</a></code> (Default).</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_span">span</code></td>
<td>
<p>parameter that controls the degree of smoothing (numeric between 0 and 100, Default 25). see more on loessstats</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_degree">degree</code></td>
<td>
<p>the degree of polynomial to be used for when loess fitting is applied, normally 1 or 2 (Default). see more on loessstats</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_boots">boots</code></td>
<td>
<p>the number of surrogate data. Default is 100.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_logtransform">logtransform</code></td>
<td>
<p>logical. If TRUE data are logtransformed prior to analysis as log(X+1). Default is FALSE.</p>
</td></tr>
<tr><td><code id="surrogates_ews_+3A_interpolate">interpolate</code></td>
<td>
<p>logical. If TRUE linear interpolation is applied to produce a timeseries of equal length as the original. Default is FALSE (assumes there are no gaps in the timeseries).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition, <code>surrogates_ews</code> returns a plot with the distribution of the surrogate Kendall tau estimates and the Kendall tau estimate of the original series. Vertical lines indicate the 5% and 95% significance levels.
</p>


<h3>Value</h3>

<p><code>surrogates_ews</code> returns a matrix that contains:
Kendall tau estimate original the trends of the original timeseries;
Kendall tau p-value original the p-values of the trends of the original timeseries;
Kendall tau estimate surrogates the trends of the surrogate timeseries;
Kendall tau p-value surrogates the associated p-values of the trends of the surrogate timeseries;
significance p the p-value for the original Kendall tau rank correlation estimate compared to the surrogates;
</p>


<h3>Author(s)</h3>

<p>Vasilis Dakos <a href="mailto:vasilis.dakos@gmail.com">vasilis.dakos@gmail.com</a>
</p>


<h3>References</h3>

<p>Dakos, V., et al (2008). 'Slowing down as an early warning signal for abrupt climate change.' <em>Proceedings of the National Academy of Sciences</em> 105(38): 14308-14312 
</p>
<p>Dakos, V., et al (2012).'Methods for Detecting Early Warnings of Critical Transitions in Time Series Illustrated Using Simulated Ecological Data.' <em>PLoS ONE</em> 7(7): e41010. doi:10.1371/journal.pone.0041010
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(foldbif) 
output &lt;- surrogates_ews(foldbif,indicator='sd',winsize=50,detrending='gaussian', bandwidth=10,
             boots=200, logtransform=FALSE,interpolate=FALSE)
</code></pre>

<hr>
<h2 id='UnivariateGrouping'>Get group assigment indices for univariate data points, given cluster break points</h2><span id='topic+UnivariateGrouping'></span>

<h3>Description</h3>

<p>Get group assigment indices for univariate data points, given cluster break points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UnivariateGrouping(x, breakpoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UnivariateGrouping_+3A_x">x</code></td>
<td>
<p>Univariate data vector</p>
</td></tr>
<tr><td><code id="UnivariateGrouping_+3A_breakpoints">breakpoints</code></td>
<td>
<p>Cluster breakpoints</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of cluster indices
</p>


<h3>Author(s)</h3>

<p>Leo Lahti <a href="mailto:leo.lahti@iki.fi">leo.lahti@iki.fi</a>
</p>

<hr>
<h2 id='YD2PB_grayscale'>YD2PB_grayscale data set</h2><span id='topic+YD2PB_grayscale'></span>

<h3>Description</h3>

<p>YD2PB_grayscale data set
</p>


<h3>Format</h3>

<p>TBA
</p>


<h3>Source</h3>

<p>TBA
</p>


<h3>References</h3>

<p>See citation('earlywarnings')
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
