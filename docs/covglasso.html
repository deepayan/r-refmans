<!DOCTYPE html><html><head><title>Help for package covglasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {covglasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#control'><p>Set control parameters</p></a></li>
<li><a href='#covglasso'><p>Sparse covariance matrix estimation</p></a></li>
<li><a href='#covglasso-package'><p>Sparse covariance matrix estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Sparse Covariance Matrix Estimation</td>
</tr>
<tr>
<td>Description:</td>
<td>Direct sparse covariance matrix estimation via the covariance graphical lasso by Bien, Tibshirani (2011) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasr054">doi:10.1093/biomet/asr054</a>&gt; using the fast coordinate descent algorithm of Wang (2014) &lt;<a href="https://doi.org/10.1007%2Fs11222-013-9385-5">doi:10.1007/s11222-013-9385-5</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Fop &lt;michael.fop@ucd.ie&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-14 13:51:28 UTC; michael</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Fop <a href="https://orcid.org/0000-0003-3936-2757"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Hao Wang [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-14 15:10:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='control'>Set control parameters</h2><span id='topic+control'></span>

<h3>Description</h3>

<p>Set control parameters of the coordinate descent algorithm for the graphical lasso for sparse covariance matrix estimation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>control(iter.out = 1e04, iter.in = 1e03, tol.out = 1e-04, tol.in = 1e-03)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="control_+3A_iter.out">iter.out</code></td>
<td>
<p>Maximum number of iterations in the in the outer loop of the coordinate descent algorithm.</p>
</td></tr>
<tr><td><code id="control_+3A_iter.in">iter.in</code></td>
<td>
<p>Maximum number of iterations in the in the inner loop of the coordinate descent algorithm.</p>
</td></tr>
<tr><td><code id="control_+3A_tol.out">tol.out</code></td>
<td>
<p>Tolerance value for judging when convergence has been reached. Used in the outer loop of the coordinate descent algorithm.</p>
</td></tr>
<tr><td><code id="control_+3A_tol.in">tol.in</code></td>
<td>
<p>Tolerance value for judging when convergence has been reached. Used in the inner loop of the coordinate descent algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>control</code> is used to set control parameters of the coordinate descent algorithm employed for solving the covariance graphical lasso.
</p>


<h3>Value</h3>

<p>A list of parameters values.
</p>


<h3>References</h3>

<p>Wang, H. (2014). Coordinate descent algorithm for covariance graphical lasso. <em>Statistics and Computing</em>, 24:521.
</p>

<hr>
<h2 id='covglasso'>Sparse covariance matrix estimation</h2><span id='topic+covglasso'></span>

<h3>Description</h3>

<p>Direct estimation of a sparse covariance matrix using the covariance graphical lasso.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covglasso(data = NULL,
          S = NULL, n = NULL,
          lambda = NULL,
          rho = NULL,
          duplicated = TRUE,
          L = 10,
          crit = c("bic", "ebic"),
          gamma = 0.5,
          penalize.diag = FALSE,
          start = NULL,
          ctrl = control(),
          path = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covglasso_+3A_data">data</code></td>
<td>
<p>A numerical dataframe or matrix, where rows correspond to observations and columns to variables. If <code>data = NULL</code>, the sample covariance <code>S</code> must be provided in input.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_s">S</code></td>
<td>
<p>The sample covariance matrix of the data. If <code>S = NULL</code>, the maximum likelihood estimate of the covariance matrix is used in the estimation of the sparse covariance matrix.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_n">n</code></td>
<td>
<p>The number of observations. If <code>data = NULL</code> and <code>S</code> is provided in input, <code>n</code> must be provided in input as well.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_lambda">lambda</code></td>
<td>
<p>A vector or array of non-negative lasso regularization parameters. Penalization is applied elementwise to all entries of the covariance matrix. If an array, each entry must be a matrix with same dimensions of the sample covariance matrix. Values should be increasing from the smallest to the largest. If <code>lambda = NULL</code>, an alternative penalization based on thresholding of the empirical correlation matrix is used; see &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_rho">rho</code></td>
<td>
<p>A vector of correlation values used to define the penalization in terms of the thresholded sample correlation matrix. See &quot;Details&quot;. Note that this penalization is used by default.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_duplicated">duplicated</code></td>
<td>
<p>Remove duplicated penalty matrices when the default penalty term based on the thresholded correlation matrix is used. Suggest to leave this argument to <code>TRUE</code> all the time as several redundant matrices giving the same penalty term are discarded.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_l">L</code></td>
<td>
<p>The number of <code>rho</code> values. Only used when <code>lambda</code> and <code>rho</code> are NULL. Default is <code>L = 10</code>.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_crit">crit</code></td>
<td>
<p>The model selection criterion employed to select the optimal covariance graph model. Can be <code>"bic"</code> or <code>"ebic"</code>; see &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_gamma">gamma</code></td>
<td>
<p>A penalty parameter used when <code>crit = "ebic"</code> and EBIC is used to select the optimal graph covariance model. The value of <code>gamma</code> must be in the range <code>[0,1]</code>. Default is <code>gamma = 0.5</code>, which encourages sparser models.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_penalize.diag">penalize.diag</code></td>
<td>
<p>A logical argument indicating if the diagonal of the covariance matrix should be penalized. Default to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_start">start</code></td>
<td>
<p>A starting matrix for the estimation algorithm. If <code>NULL</code>, the starting value is the diagonal sample covariance matrix.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_ctrl">ctrl</code></td>
<td>
<p>A list of control parameters for the coordinate descent algorithm employed for estimation. See also <code><a href="#topic+control">control</a></code>.</p>
</td></tr>
<tr><td><code id="covglasso_+3A_path">path</code></td>
<td>
<p>A logical argument controlling whether all the estimated covariance matrices along the path defined by <code>lambda</code> or <code>rho</code> should be included in the output.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function estimates a sparse covariance matrix using a fast coordinate descent algorithm to solve the covariance graphical lasso. The estimated sparse covariance matrix is obtained by optimizing the following penalized log-likelihood:
</p>
<p style="text-align: center;"><code class="reqn">-\frac{n}{2}\{ \mathrm{logdet}(\Sigma) + \mathrm{trace}(S\Sigma^{-1})  \} - ||\Lambda * \Sigma||_1</code>
</p>

<p>subject to <code class="reqn">\Sigma</code> being positive definite. In the penalty term, the <code class="reqn">L_1</code> norm and the matrix multiplication between <code class="reqn">\Lambda</code> and <code class="reqn">\Sigma</code> is elementwise.
</p>
<p>By default (when <code>lambda = NULL</code>), the penalization matrix <code class="reqn">\Lambda</code> is defined in terms of a sequential thresholding of the sample correlation matrix. Given <code class="reqn">\rho_l</code> a threshold value and <code class="reqn">R</code> the sample correlation matrix, the penalty term matrix <code class="reqn">\Lambda</code> is defined by the values <code class="reqn">(1/s_{ij})I(r_{ij} &lt; \rho_l)</code>, that is:
</p>
<p style="text-align: center;"><code class="reqn">\Lambda = \frac{1}{S}I(R &lt; \rho_l)</code>
</p>

<p>where the inequality is taken elementwise. Such choice of penalty matrix provides a framework related to the adaptive lasso of Fan et al. (2009) and the method of Chaudhuri et al. (2007).
If the vector <code>rho</code> is not given in input, the sequence of threshold values is defined as the <code>L</code> quantiles of the absolute values of the sample correlations in <code class="reqn">R</code>. If <code>lambda</code> is provided in input, the penalization corresponds to the standard covariance graphical lasso of Bien, Tibshirani (2011).
</p>
<p>The sparse covariance matrix corresponds to a Gaussian covariance graphical model of marginal independence, where in the sparse covariance matrix a zero entry corresponds to two variables being marginally independent. Different penalizations <code>lambda</code> imply different models, and selection of the optimal graphical model is performed using <code>"bic"</code> (default) or <code>"ebic"</code>. In the latter case, the argument <code>gamma</code> controls the additional penalty term in the model selection criterion; see Foygel, Drton, (2010).
</p>


<h3>Value</h3>

<p>A list containing the following elements.
</p>
<table>
<tr><td><code>sigma</code></td>
<td>
<p>The estimated covariance matrix.</p>
</td></tr>
<tr><td><code>omega</code></td>
<td>
<p>The estimated concentration (inverse covariance) matrix.</p>
</td></tr>
<tr><td><code>graph</code></td>
<td>
<p>The adjacency matrix given in input corresponding to the marginal or conditional independence graph.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Value of the maximized log-likelihood.</p>
</td></tr>
<tr><td><code>npar</code></td>
<td>
<p>Number of estimated non-zero parameters.</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>Value of the penalty term.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>Optimal BIC or EBIC value.</p>
</td></tr>
<tr><td><code>BIC</code></td>
<td>
<p>All BIC or EBIC values along the path defined by <code>lambda</code> or <code>rho</code>.</p>
</td></tr>
<tr><td><code>path</code></td>
<td>
<p>A list containing all the estimated sparse covariance models. Provided in output only when <code>path = TRUE</code>.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>The values of <code>rho</code> thresholds used to define the penalization based on the thresholded sample correlation matrix.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The values of <code>lambda</code> penalty parameters for the penalization.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bien, J., Tibshirani, R.J. (2011). Sparse estimation of a covariance matrix. <em>Biometrika</em>, 98(4), 807–820.
</p>
<p>Chaudhuri, S., Drton M., Richardson, T. S. (2007). Estimation of a covariance matrix with zeros. <em>Biometrika</em>, 94(1), 199-216.
</p>
<p>Fan, J., Feng, Y., Wu, Y. (2009). Network exploration via the adaptive lasso and scad penalties. <em>The Annals of Applied Statistics</em>, 3(2), 521.
</p>
<p>Foygel, R., Drton, M. (2010). Extended Bayesian information criteria for Gaussian graphical models. In <em>Advances in neural information processing systems</em>, pages 604–612.
</p>
<p>Wang, H. (2014). Coordinate descent algorithm for covariance graphical lasso. <em>Statistics and Computing</em>, 24:521.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+control">control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># a simple example with a 3-block diagonal matrix
library(MASS)
p &lt;- 3
n &lt;- 300
sig &lt;- matrix(0.8, p,p)
diag(sig) &lt;- 1
set.seed(190188)
tmp &lt;- replicate( 3, mvrnorm(n, rep(0,p), sig) )
x &lt;- matrix(c(tmp), n, p*3)

fit1 &lt;- covglasso(x)
plot(fit1$rho, fit1$BIC)
image(fit1$sigma != 0)

# refine search
fit2 &lt;- covglasso(x, rho = seq(0.1, 0.4, length = 50))
image(fit2$sigma != 0)

fit1$bic
fit2$bic


# Cars93 data in MASS package
data("Cars93", package = "MASS")
dat &lt;- na.omit( Cars93[,c(4:8,12:15,17,19:25)] )

fit1 &lt;- covglasso(dat, L = 50)

# more sparse
fit2 &lt;- covglasso(dat, L = 50,
                    crit = "ebic", gamma = 1)

oldpar &lt;- par(no.readonly = TRUE)
par(mfrow = c(1,2))
plot(fit1$rho, fit1$BIC, main = "BIC")
plot(fit2$rho, fit2$BIC, main = "EBIC")
image(fit1$sigma != 0, col = c("white", "black"), main = "BIC")
image(fit2$sigma != 0, col = c("white", "black"), main = "EBIC")
par(oldpar)  # reset par
</code></pre>

<hr>
<h2 id='covglasso-package'>Sparse covariance matrix estimation</h2><span id='topic+covglasso-package'></span>

<h3>Description</h3>

<p>Fast and direct estimation of a sparse covariance matrix via covariance graphical lasso and coordinate descent algorithm.</p>


<h3>Details</h3>

<p>A package implementing direct estimation of a sparse covariance matrix corresponding to a Gaussian covariance graphical model. Estimation is performed by solving the covariance graphical lasso using a fast coordinate descent algorithm.</p>


<h3>How to cite this package</h3>

<p>To cite <span class="pkg">covglasso</span> in publications use:
</p>
<pre>
Fop, M. (2021). covglasso: Sparse Covariance Matrix Estimation, R package version 1.0.3,
https://CRAN.R-project.org/package=covglasso
</pre>

<h3>Author(s)</h3>

<p>Michael Fop.
</p>
<p>Maintainer: Michael Fop <a href="mailto:michael.fop@ucd.ie">michael.fop@ucd.ie</a>
</p>


<h3>References</h3>

<p>Bien, J., Tibshirani, R.J. (2011). Sparse estimation of a covariance matrix. <em>Biometrika</em>, 98(4), 807–820.
</p>
<p>Wang, H. (2014). Coordinate descent algorithm for covariance graphical lasso. <em>Statistics and Computing</em>, 24:521.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
