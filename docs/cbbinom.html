<!DOCTYPE html><html lang="en"><head><title>Help for package cbbinom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cbbinom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cbbinom-package'><p>cbbinom: Continuous Analog of a Beta-Binomial Distribution</p></a></li>
<li><a href='#cbbinom'><p>The Continuous Beta-Binomial Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Continuous Analog of a Beta-Binomial Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the d/p/q/r family of functions for a continuous analog to the standard discrete beta-binomial with continuous size parameter and continuous support with x in [0, size + 1].</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>extraDistr, ggplot2, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, hypergeo2, Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>hypergeo2 (&ge; 0.2.0), Rcpp</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/zhuxr11/cbbinom">https://github.com/zhuxr11/cbbinom</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/zhuxr11/cbbinom/issues">https://github.com/zhuxr11/cbbinom/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-17 15:28:24 UTC; Admin</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiurui Zhu [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xiurui Zhu &lt;zxr6@163.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-17 15:50:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='cbbinom-package'>cbbinom: Continuous Analog of a Beta-Binomial Distribution</h2><span id='topic+cbbinom-package'></span>

<h3>Description</h3>

<p>Implementation of the d/p/q/r family of functions for a continuous analog to the standard discrete beta-binomial with continuous size parameter and continuous support with x in [0, size + 1].
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Xiurui Zhu <a href="mailto:zxr6@163.com">zxr6@163.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/zhuxr11/cbbinom">https://github.com/zhuxr11/cbbinom</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/zhuxr11/cbbinom/issues">https://github.com/zhuxr11/cbbinom/issues</a>
</p>
</li></ul>


<hr>
<h2 id='cbbinom'>The Continuous Beta-Binomial Distribution</h2><span id='topic+cbbinom'></span><span id='topic+dcbbinom'></span><span id='topic+pcbbinom'></span><span id='topic+qcbbinom'></span><span id='topic+rcbbinom'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for
a continuous analog to the beta-binomial distribution with parameters <code>size</code>,
<code>alpha</code> and <code>beta</code>. The usage and help pages are modeled
on the d-p-q-r families of functions for the commonly-used distributions
in the <code>stats</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcbbinom(x, size, alpha = 1, beta = 1, ncp = 0, log = FALSE, prec = NULL)

pcbbinom(
  q,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  lower.tail = TRUE,
  log.p = FALSE,
  prec = NULL
)

qcbbinom(
  p,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  lower.tail = TRUE,
  log.p = FALSE,
  prec = NULL,
  tol = 1e-06,
  max_iter = 10000L
)

rcbbinom(
  n,
  size,
  alpha = 1,
  beta = 1,
  ncp = 0,
  prec = NULL,
  tol = 1e-06,
  max_iter = 10000L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cbbinom_+3A_x">x</code>, <code id="cbbinom_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_size">size</code></td>
<td>
<p>number of trials (zero or more).</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_alpha">alpha</code>, <code id="cbbinom_+3A_beta">beta</code></td>
<td>
<p>non-negative parameters of the Beta distribution.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_ncp">ncp</code></td>
<td>
<p>non-centrality parameter.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_log">log</code>, <code id="cbbinom_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_prec">prec</code></td>
<td>
<p>arguments passed on to <code><a href="hypergeo2.html#topic+genhypergeo">genhypergeo</a></code>,
vectorized and recycled along with distribution parameters.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code>, otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_tol">tol</code>, <code id="cbbinom_+3A_max_iter">max_iter</code></td>
<td>
<p>arguments passed on to <code><a href="stats.html#topic+uniroot">uniroot</a></code>,
vectorized and recycled along with distribution parameters.</p>
</td></tr>
<tr><td><code id="cbbinom_+3A_n">n</code></td>
<td>
<p>number of observations. If <code>length(n) &gt; 1</code>, the length
is taken to be the number required.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Derived from the continuous binomial distribution (Ilienko 2013), the continuous beta-binomial
distribution is defined as:
</p>
<p style="text-align: center;"><code class="reqn">P(x|n,\alpha,\beta)=\int_0^1\frac{B_{1-p}(n+1-x,x)}{B(n+1-x,x)}\frac{p^{\alpha-1}(1-p)^{\beta-1}}{B(\alpha,\beta)}dp,</code>
</p>

<p>where <code class="reqn">x</code> is the quantile, <code class="reqn">n</code> is the size, <code class="reqn">B_p(a,b)=\int_0^p{u^{a-1}(1-u)^{b-1}du}</code>
is the incomplete beta function.
</p>
<p>When simplified, the distribution becomes:
</p>
<p style="text-align: center;"><code class="reqn">P(x|n,\alpha,\beta)=\frac{\Gamma(n+1)B(n+1-x+\beta,\alpha)}{\Gamma(x)\Gamma(n+2-x)B(\alpha,\beta)}{}_3F_2(a;b;z),</code>
</p>

<p>where <code class="reqn">{}_3F_2(a;b;z)</code> is <a href="hypergeo2.html#topic+genhypergeo">generalized hypergeometric function</a>, <code class="reqn">a=\{1-x,n+1-x,n+1-x+\beta\}</code>,
<code class="reqn">b=\{n+2-x,n+1-x+\alpha+\beta\}</code>, <code class="reqn">z=1</code>.
</p>
<p>Heuristically speaking, this distribution spreads the standard probability mass
at integer <code>x</code> to the interval <code>[x, x + 1]</code> in a continuous manner.
As a result, the distribution looks like a smoothed version of the standard,
discrete beta-binomial but shifted slightly to the right. The support of the continuous
beta-binomial is <code>[0, size + 1]</code>, and the mean is approximately
<code>size * alpha / (alpha + beta) + 1/2</code>.
</p>
<p>Supplying <code>ncp != 0</code> moves the support of beta-binomial to <code>[ncp, size + 1 + ncp]</code>. For example,
to build a continuous beta-binomial with approximately non-shifted mean, use <code>ncp = -0.5</code>.
</p>
<p>These functions are also available in <code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code>
as <code>cbbinom::cpp_[d/p/q/r]cbbinom()</code>, and their non-vectorized versions
in <code><a href="Rcpp.html#topic+Rcpp-package">Rcpp</a></code> as <code>cbbinom::[d/p/q/r]cbbinom_()</code>.
To use them, please use <code>[[Rcpp::depends(cbbinom)]]</code> and <code>#include &lt;cbbinom.h&gt;</code>.
</p>


<h3>Value</h3>

<p><code>dcbbinom</code> gives the density, <code>pcbbinom</code> the distribution function,
<code>qcbbinom</code> the quantile function, and <code>rcbbinom</code> generates random deviates.
</p>
<p>Invalid arguments will result in return value <code>NaN</code>, with a warning.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rcbbinom</code>,
and is the maximum of the lengths of the numerical arguments for the other functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the result.
Only the first elements of the logical arguments are used.
</p>


<h3>Note</h3>

<p>Change log:
</p>

<ul>
<li><p>0.1.0 Xiurui Zhu - Initiate the function.
</p>
</li>
<li><p>0.2.0 Xiurui Zhu - Re-implement distribution function with <code><a href="BH.html#topic+BH-package">BH</a></code> package,
add <code>NULL</code> default tolerance, and add precision parameters.
</p>
</li></ul>



<h3>References</h3>

<p>Ilienko, Andreii (2013). Continuous counterparts of Poisson and binomial
distributions and their properties. Annales Univ. Sci. Budapest., Sect. Comp.
39: 137-147. <a href="http://ac.inf.elte.hu/Vol_039_2013/137_39.pdf">http://ac.inf.elte.hu/Vol_039_2013/137_39.pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Density function
dcbbinom(x = 5, size = 10, alpha = 2, beta = 4)
# Distribution function
(test_val &lt;- pcbbinom(q = 5, size = 10, alpha = 2, beta = 4))
# Quantile function
qcbbinom(p = test_val, size = 10, alpha = 2, beta = 4)
# Random generation
set.seed(1111L)
rcbbinom(n = 10L, size = 10, alpha = 2, beta = 4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
