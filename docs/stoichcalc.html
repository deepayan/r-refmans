<!DOCTYPE html><html><head><title>Help for package stoichcalc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stoichcalc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.comp.matrix'><p>Construct Composition Matrix</p></a></li>
<li><a href='#calc.stoich.basis'><p>Calculate Basis of Stoichiometric Space</p></a></li>
<li><a href='#calc.stoich.coef'><p>Calculate Stoichiometric Coefficients</p></a></li>
<li><a href='#stoichcalc-package'>
<p>R-Functions for Solving Stoichiometric Equations</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-5</td>
</tr>
<tr>
<td>Title:</td>
<td>R Functions for Solving Stoichiometric Equations</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Peter Reichert</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Given a list of substance compositions, a list of substances 
  involved in a process, and a list of constraints in addition to mass 
  conservation of elementary constituents, the package contains functions 
  to build the substance composition matrix, to analyze the uniqueness of 
  process stoichiometry, and to calculate stoichiometric coefficients if 
  process stoichiometry is unique. 
  (See Reichert, P. and Schuwirth, N., A generic framework for deriving 
  process stoichiometry in enviromental models, Environmental Modelling 
  and Software 25, 1241-1251, 2010 for more details.)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-28 09:07:45 UTC; peter</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-28 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc.comp.matrix'>Construct Composition Matrix</h2><span id='topic+calc.comp.matrix'></span>

<h3>Description</h3>

<p>Construct substance composition matrix 
from list of substance composition vectors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.comp.matrix(subst.comp,verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.comp.matrix_+3A_subst.comp">subst.comp</code></td>
<td>

<p>Named list of named composition vectors.  
The list must contain entries labelled by the substance names
containing vectors of the mass fractions of elementary 
constituents (typically chemical elements, charge or COD resp.
ThOD) that characterize the composition of the substance. 
Each element of these vectors must be labelled by the name of  
the corresponding elementary constituent.
</p>
</td></tr>
<tr><td><code id="calc.comp.matrix_+3A_verbose">verbose</code></td>
<td>

<p>indicator for whether or not to write basic information to the console.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function compiles the substance composition matrix used in the other
functions of the <span class="pkg">stoichcalc</span> package. 
It can alternatively be composed manually or by a user-defined function. 
The main advantage of the use of this function is that substance compositions 
can be maintained in lists.
This makes it much easier to remove and add substances and elementary
constituents.
</p>


<h3>Value</h3>

<p>Composition matrix of all substances (labelled columns) and mass fractions
of elementary constituents (labelled rows).
</p>


<h3>Author(s)</h3>

<p>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;
</p>


<h3>References</h3>

<p>Reichert, P. and Schuwirth, N.,
A generic framework for deriving process stoichiometry in environmental models,
Environmental Modelling and Software 25, 1241-1251, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.stoich.basis">calc.stoich.basis</a></code>, <code><a href="#topic+calc.stoich.coef">calc.stoich.coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subst.comp &lt;- 
  list(NH4  = c(H      = 4*1/14,  # gH/gNH4-N
                N      = 1,       # gN/gNH4-N
                charge = 1/14),   # chu/gNH4-N
       NO3  = c(O      = 3*16/14, # gO/gNO3-N
                N      = 1,       # gN/gNO3-N
                charge = -1/14),  # chu/gNO3-N
       HPO4 = c(O      = 4*16/31, # gO/gHPO4-P
                H      = 1*1/31,  # gH/gHPO4-P
                P      = 1,       # gP/gHPO4-P
                charge = -2/31),  # chu/gHPO4-P
       HCO3 = c(C      = 1,       # gC/gHCO3-C
                O      = 3*16/12, # gO/gHCO3-C
                H      = 1*1/12,  # gH/gHCO3-C
                charge = -1/12),  # chu/gHCO3-C
       O2   = c(O      = 1),      # gO/gO2-O
       H    = c(H      = 1,       # gH/molH
                charge = 1),      # chu/molH
       H2O  = c(O      = 1*12,    # gO/molH2O
                H      = 2*1),    # gH/molH2O
       ALG  = c(N      = 0.06,    # gN/gALG
                P      = 0.005,   # gP/gALG
                O      = 0.50,    # gO/gALG
                H      = 0.07,    # gH/gALG
                C      = 0.365),  # gC/gALG
       ZOO  = c(N      = 0.06,    # gN/gZOO
                P      = 0.01,    # gP/gZOO
                O      = 0.50,    # gO/gZOO
                H      = 0.07,    # gH/gZOO
                C      = 0.36),   # gC/gZOO
       POM  = c(N      = 0.04,    # gN/gPOM
                P      = 0.007,   # gP/gPOM
                O      = 0.40,    # gO/gPOM
                H      = 0.07,    # gH/gPOM
                C      = 0.483),  # gC/gPOM
       DOM  = c(N      = 0.04,    # gN/gDOM
                P      = 0.007,   # gP/gDOM
                O      = 0.40,    # gO/gDOM
                H      = 0.07,    # gH/gDOM
                C      = 0.483))  # gC/gDOM
                
alpha &lt;- calc.comp.matrix(subst.comp)

print(alpha)
</code></pre>

<hr>
<h2 id='calc.stoich.basis'>Calculate Basis of Stoichiometric Space</h2><span id='topic+calc.stoich.basis'></span>

<h3>Description</h3>

<p>Calculate the basis of the stoichiometry space that is compatible 
with mass balances of elementary constituents and additional constraints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.stoich.basis(alpha, subst = NA, constraints = list(), eps = 1e-5, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.stoich.basis_+3A_alpha">alpha</code></td>
<td>

<p>Substance composition matrix of all substances (labelled columns) 
and mass fractions of elementary constituents (labelled rows). 
Typically calculated by the function <code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code>.
</p>
</td></tr>
<tr><td><code id="calc.stoich.basis_+3A_subst">subst</code></td>
<td>

<p>Character vector of names of substances to be used for analysis
(this must be a subset of the column names of alpha).
</p>
</td></tr>
<tr><td><code id="calc.stoich.basis_+3A_constraints">constraints</code></td>
<td>

<p>list of stoichiometric constraints in addition to mass conservation of
elementary constituents. 
Each stoichiometric constraint must be stored as a vector containing the 
coefficients of the linear equation in elementary constituents that defines
the constraint. 
The elements of this vector must be labelled by the names of the corresponding
elementary constituents.
</p>
</td></tr>
<tr><td><code id="calc.stoich.basis_+3A_eps">eps</code></td>
<td>

<p>relative tolerance for checking ratios of stoichiometric coefficients 
(only used for informing user about substance pairs with fixed stoichiometric ratio)
</p>
</td></tr>
<tr><td><code id="calc.stoich.basis_+3A_verbose">verbose</code></td>
<td>

<p>indicator for whether or not to write basic information to the console.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is primarily used in the function <code><a href="#topic+calc.stoich.coef">calc.stoich.coef</a></code>.
However, it can also be used to check the number of required stoichiometric
constraints in addition to mass conservation of elementary constituents
for a given process. 
In this case the composition matrix should only contain the substances 
relevant for this process. 
The number of required constraints is then equal to the row dimension of the 
output matrix minus 1.
</p>


<h3>Value</h3>

<p>Matrix of basis vectors (in rows) that span the compatible stoichiometric 
space.
</p>


<h3>Author(s)</h3>

<p>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;
</p>


<h3>References</h3>

<p>Reichert, P. and Schuwirth, N.,
A generic framework for deriving process stoichiometry in environmental models,
Environmental Modelling and Software 25, 1241-1251, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code>, <code><a href="#topic+calc.stoich.coef">calc.stoich.coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subst.comp &lt;- 
  list(NH4  = c(H      = 4*1/14,  # gH/gNH4-N
                N      = 1,       # gN/gNH4-N
                charge = 1/14),   # chu/gNH4-N
       NO3  = c(O      = 3*16/14, # gO/gNO3-N
                N      = 1,       # gN/gNO3-N
                charge = -1/14),  # chu/gNO3-N
       HPO4 = c(O      = 4*16/31, # gO/gHPO4-P
                H      = 1*1/31,  # gH/gHPO4-P
                P      = 1,       # gP/gHPO4-P
                charge = -2/31),  # chu/gHPO4-P
       HCO3 = c(C      = 1,       # gC/gHCO3-C
                O      = 3*16/12, # gO/gHCO3-C
                H      = 1*1/12,  # gH/gHCO3-C
                charge = -1/12),  # chu/gHCO3-C
       O2   = c(O      = 1),      # gO/gO2-O
       H    = c(H      = 1,       # gH/molH
                charge = 1),      # chu/molH
       H2O  = c(O      = 1*12,    # gO/molH2O
                H      = 2*1),    # gH/molH2O
       ALG  = c(N      = 0.06,    # gN/gALG
                P      = 0.005,   # gP/gALG
                O      = 0.50,    # gO/gALG
                H      = 0.07,    # gH/gALG
                C      = 0.365),  # gC/gALG
       ZOO  = c(N      = 0.06,    # gN/gZOO
                P      = 0.01,    # gP/gZOO
                O      = 0.50,    # gO/gZOO
                H      = 0.07,    # gH/gZOO
                C      = 0.36),   # gC/gZOO
       POM  = c(N      = 0.04,    # gN/gPOM
                P      = 0.007,   # gP/gPOM
                O      = 0.40,    # gO/gPOM
                H      = 0.07,    # gH/gPOM
                C      = 0.483),  # gC/gPOM
       DOM  = c(N      = 0.04,    # gN/gDOM
                P      = 0.007,   # gP/gDOM
                O      = 0.40,    # gO/gDOM
                H      = 0.07,    # gH/gDOM
                C      = 0.483))  # gC/gDOM
                
Y.ZOO &lt;- 0.2; f.POM &lt;- 0.2; f.DOM &lt;- 0.1

alpha &lt;- calc.comp.matrix(subst.comp)

subst.gro.ALG.NO3 &lt;- c("NO3","HPO4","HCO3",
                       "O2","H","H2O","ALG")

basis.gro.ALG.NO3 &lt;- 
  calc.stoich.basis(alpha,subst.gro.ALG.NO3)

subst.gro.ZOO &lt;- c("NH4","HPO4","HCO3","O2","H",
                   "H2O","ALG","ZOO","POM","DOM")

basis.gro.ZOO &lt;- 
  calc.stoich.basis(alpha,subst.gro.ZOO)

const.gro.ZOO &lt;- list(c("ZOO" = 1,"ALG" = Y.ZOO),
                      c("POM" = 1,"ALG" = f.POM),
                      c("DOM" = 1,"ALG" = f.DOM)) 

basis.gro.ZOO &lt;- 
  calc.stoich.basis(alpha,subst.gro.ZOO,const.gro.ZOO)
</code></pre>

<hr>
<h2 id='calc.stoich.coef'>Calculate Stoichiometric Coefficients</h2><span id='topic+calc.stoich.coef'></span>

<h3>Description</h3>

<p>Calculate stoichiometric coefficients of a process from involved substances, 
their composition and constraints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.stoich.coef(alpha, name, subst, subst.norm, nu.norm = 1, constraints = list(), 
                 eps = 1e-5, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calc.stoich.coef_+3A_alpha">alpha</code></td>
<td>

<p>Substance composition matrix of all substances (labelled columns) 
and mass fractions of elementary constituents (labelled rows). 
Typically calculated by the function <code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code>.</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_name">name</code></td>
<td>

<p>Name of the process
</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_subst">subst</code></td>
<td>

<p>Character vector of names of substances affected by the process
(this must be a subset of the column names of alpha)
</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_subst.norm">subst.norm</code></td>
<td>

<p>Name of the substance that should have a normalized (given)
stoichiometric coefficient
</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_nu.norm">nu.norm</code></td>
<td>

<p>Stoichiometric coefficient of the substance the name of which
is specified in the argument subst.norm
</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_constraints">constraints</code></td>
<td>

<p>List of stoichiometric constraints in addition to mass conservation of 
elementary constituents. 
Each stoichiometric constraint must be stored as a vector containing the 
coefficients of the linear equation in elementary constituents that defines
the constraint.
The elements of this vector must be labelled by the names of the corresponding
elementary constituents.</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_eps">eps</code></td>
<td>

<p>relative tolerance for checking ratios of stoichiometric coefficients 
(only used for informing user about substance pairs with fixed stoichiometric ratio)
</p>
</td></tr>
<tr><td><code id="calc.stoich.coef_+3A_verbose">verbose</code></td>
<td>

<p>indicator for whether or not to write basic information to the console.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is the key function of the package for the calculation of stoichiometric
coefficients of individual processes. 
The results for different processes can easily be bound to the comprehensive 
stoichiometric matrix of all processes by using rbind.
</p>


<h3>Value</h3>

<p>Matrix consisting of one row of stoichiometric coefficients of the process
or an error message if the process stoichiometry is not uniquely defined.
The row name of the matrix is equal to the process name specified as an
argument (to allow binding the stoichiometries of several processes to a
comprehensive stoichiometric matrix), the column names are equal to the
substance names provided by the substance composition matrix alpha.
</p>


<h3>Author(s)</h3>

<p>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;
</p>


<h3>References</h3>

<p>Reichert, P. and Schuwirth, N.,
A generic framework for deriving process stoichiometry in environmental models,
Environmental Modelling and Software 25, 1241-1251, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code>, <code><a href="#topic+calc.stoich.basis">calc.stoich.basis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subst.comp &lt;- 
  list(NH4  = c(H      = 4*1/14,  # gH/gNH4-N
                N      = 1,       # gN/gNH4-N
                charge = 1/14),   # chu/gNH4-N
       NO3  = c(O      = 3*16/14, # gO/gNO3-N
                N      = 1,       # gN/gNO3-N
                charge = -1/14),  # chu/gNO3-N
       HPO4 = c(O      = 4*16/31, # gO/gHPO4-P
                H      = 1*1/31,  # gH/gHPO4-P
                P      = 1,       # gP/gHPO4-P
                charge = -2/31),  # chu/gHPO4-P
       HCO3 = c(C      = 1,       # gC/gHCO3-C
                O      = 3*16/12, # gO/gHCO3-C
                H      = 1*1/12,  # gH/gHCO3-C
                charge = -1/12),  # chu/gHCO3-C
       O2   = c(O      = 1),      # gO/gO2-O
       H    = c(H      = 1,       # gH/molH
                charge = 1),      # chu/molH
       H2O  = c(O      = 1*12,    # gO/molH2O
                H      = 2*1),    # gH/molH2O
       ALG  = c(N      = 0.06,    # gN/gALG
                P      = 0.005,   # gP/gALG
                O      = 0.50,    # gO/gALG
                H      = 0.07,    # gH/gALG
                C      = 0.365),  # gC/gALG
       ZOO  = c(N      = 0.06,    # gN/gZOO
                P      = 0.01,    # gP/gZOO
                O      = 0.50,    # gO/gZOO
                H      = 0.07,    # gH/gZOO
                C      = 0.36),   # gC/gZOO
       POM  = c(N      = 0.04,    # gN/gPOM
                P      = 0.007,   # gP/gPOM
                O      = 0.40,    # gO/gPOM
                H      = 0.07,    # gH/gPOM
                C      = 0.483),  # gC/gPOM
       DOM  = c(N      = 0.04,    # gN/gDOM
                P      = 0.007,   # gP/gDOM
                O      = 0.40,    # gO/gDOM
                H      = 0.07,    # gH/gDOM
                C      = 0.483))  # gC/gDOM
                
Y.ZOO &lt;- 0.2; f.POM &lt;- 0.2; f.DOM &lt;- 0.1

alpha &lt;- calc.comp.matrix(subst.comp)

subst.gro.ALG.NO3 &lt;- c("NO3","HPO4","HCO3",
                       "O2","H","H2O","ALG")

basis.gro.ALG.NO3 &lt;- 
  calc.stoich.basis(alpha,subst.gro.ALG.NO3)

nu.gro.ALG.NO3    &lt;- 
  calc.stoich.coef(alpha       = alpha,
                   name        = "gro.ALG.NO3",
                   subst       = subst.gro.ALG.NO3,
                   subst.norm  = "ALG",
                   nu.norm     = 1)

subst.gro.ZOO &lt;- c("NH4","HPO4","HCO3","O2","H",
                   "H2O","ALG","ZOO","POM","DOM")

basis.gro.ZOO &lt;- 
  calc.stoich.basis(alpha,subst.gro.ZOO)

const.gro.ZOO &lt;- list(c("ZOO" = 1,"ALG" = Y.ZOO),
                      c("POM" = 1,"ALG" = f.POM),
                      c("DOM" = 1,"ALG" = f.DOM)) 

nu.gro.ZOO    &lt;- 
  calc.stoich.coef(alpha       = alpha,
                   name        = "gro.ZOO",
                   subst       = subst.gro.ZOO,
                   subst.norm  = "ZOO",
                   nu.norm     = 1,
                   constraints = const.gro.ZOO)

nu &lt;- rbind(nu.gro.ALG.NO3,
            nu.gro.ZOO)

print(nu,digits=2)
</code></pre>

<hr>
<h2 id='stoichcalc-package'>
R-Functions for Solving Stoichiometric Equations
</h2><span id='topic+stoichcalc-package'></span><span id='topic+stoichcalc'></span>

<h3>Description</h3>

<p>Given a list of substance compositions, a list of substances
involved in a process, and a list of constraints in addition to mass 
conservation of elementary constituents, the package contains functions 
to build the substance composition matrix, to analyze the uniqueness 
of process stoichiometry, and to calculate stoichiometric coefficients 
if process stoichiometry is unique 
(see reference given below for more details).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> stoichcalc</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1-5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-08-28</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL &gt;= 2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The package contains the following three functions:<br />
<code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code> 
constructs the substance composition matrix 
froma a list of substance composition vectors,<br />
<code><a href="#topic+calc.stoich.basis">calc.stoich.basis</a></code> calculates the basis of the stoichiometry space 
that is compatible with mass balances of elementary constituents 
and additional constraints,
<code><a href="#topic+calc.stoich.coef">calc.stoich.coef</a></code> calculates the stoichiometric coefficients
of a process from involved substances, their composition and constraints.
</p>


<h3>Author(s)</h3>

<p>Peter Reichert &lt;peter.reichert@emeriti.eawag.ch&gt;
</p>


<h3>References</h3>

<p>Reichert, P. and Schuwirth, N., 
A generic framework for deriving process stoichiometry in environmental models,
Environmental Modelling and Software 25, 1241-1251, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calc.comp.matrix">calc.comp.matrix</a></code>,
<code><a href="#topic+calc.stoich.basis">calc.stoich.basis</a></code>,
<code><a href="#topic+calc.stoich.coef">calc.stoich.coef</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subst.comp &lt;- 
  list(NH4  = c(H      = 4*1/14,  # gH/gNH4-N
                N      = 1,       # gN/gNH4-N
                charge = 1/14),   # chu/gNH4-N
       NO3  = c(O      = 3*16/14, # gO/gNO3-N
                N      = 1,       # gN/gNO3-N
                charge = -1/14),  # chu/gNO3-N
       HPO4 = c(O      = 4*16/31, # gO/gHPO4-P
                H      = 1*1/31,  # gH/gHPO4-P
                P      = 1,       # gP/gHPO4-P
                charge = -2/31),  # chu/gHPO4-P
       HCO3 = c(C      = 1,       # gC/gHCO3-C
                O      = 3*16/12, # gO/gHCO3-C
                H      = 1*1/12,  # gH/gHCO3-C
                charge = -1/12),  # chu/gHCO3-C
       O2   = c(O      = 1),      # gO/gO2-O
       H    = c(H      = 1,       # gH/molH
                charge = 1),      # chu/molH
       H2O  = c(O      = 1*12,    # gO/molH2O
                H      = 2*1),    # gH/molH2O
       ALG  = c(N      = 0.06,    # gN/gALG
                P      = 0.005,   # gP/gALG
                O      = 0.50,    # gO/gALG
                H      = 0.07,    # gH/gALG
                C      = 0.365),  # gC/gALG
       ZOO  = c(N      = 0.06,    # gN/gZOO
                P      = 0.01,    # gP/gZOO
                O      = 0.50,    # gO/gZOO
                H      = 0.07,    # gH/gZOO
                C      = 0.36),   # gC/gZOO
       POM  = c(N      = 0.04,    # gN/gPOM
                P      = 0.007,   # gP/gPOM
                O      = 0.40,    # gO/gPOM
                H      = 0.07,    # gH/gPOM
                C      = 0.483),  # gC/gPOM
       DOM  = c(N      = 0.04,    # gN/gDOM
                P      = 0.007,   # gP/gDOM
                O      = 0.40,    # gO/gDOM
                H      = 0.07,    # gH/gDOM
                C      = 0.483))  # gC/gDOM
                
Y.ZOO &lt;- 0.2; f.POM &lt;- 0.2; f.DOM &lt;- 0.1

alpha &lt;- calc.comp.matrix(subst.comp)

subst.gro.ALG.NO3 &lt;- c("NO3","HPO4","HCO3",
                       "O2","H","H2O","ALG")

basis.gro.ALG.NO3 &lt;- 
  calc.stoich.basis(alpha,subst.gro.ALG.NO3)

nu.gro.ALG.NO3    &lt;- 
  calc.stoich.coef(alpha       = alpha,
                   name        = "gro.ALG.NO3",
                   subst       = subst.gro.ALG.NO3,
                   subst.norm  = "ALG",
                   nu.norm     = 1)

subst.gro.ZOO &lt;- c("NH4","HPO4","HCO3","O2","H",
                   "H2O","ALG","ZOO","POM","DOM")

basis.gro.ZOO &lt;- 
  calc.stoich.basis(alpha,subst.gro.ZOO)

const.gro.ZOO &lt;- list(c("ZOO" = 1,"ALG" = Y.ZOO),
                      c("POM" = 1,"ALG" = f.POM),
                      c("DOM" = 1,"ALG" = f.DOM)) 

nu.gro.ZOO    &lt;- 
  calc.stoich.coef(alpha       = alpha,
                   name        = "gro.ZOO",
                   subst       = subst.gro.ZOO,
                   subst.norm  = "ZOO",
                   nu.norm     = 1,
                   constraints = const.gro.ZOO)

nu &lt;- rbind(nu.gro.ALG.NO3,
            nu.gro.ZOO)

print(nu,digits=2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
