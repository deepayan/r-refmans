<!DOCTYPE html><html><head><title>Help for package BsMD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BsMD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BM86.data'><p>Data sets in Box and Meyer (1986)</p></a></li>
<li><a href='#BM93.e1.data'><p>Example 1 data in Box and Meyer (1993)</p></a></li>
<li><a href='#BM93.e2.data'><p>Example 2 data in Box and Meyer (1993)</p></a></li>
<li><a href='#BM93.e3.data'><p>Example 3 data in Box and Meyer (1993)</p></a></li>
<li><a href='#BsMD-internal'><p>Internal BsMD objects</p></a></li>
<li><a href='#BsMD-package'>
<p>Bayes screening and model discrimination follow-up designs</p></a></li>
<li><a href='#BsProb'><p>Posterior Probabilities from Bayesian Screening Experiments</p></a></li>
<li><a href='#DanielPlot'><p>Normal Plot of Effects</p></a></li>
<li><a href='#LenthPlot'><p>Lenth's Plot of Effects</p></a></li>
<li><a href='#MD'><p>Best Model Discrimination (MD) Follow-Up Experiments</p></a></li>
<li><a href='#PB12Des'><p> 12-run Plackett-Burman Design Matrix</p></a></li>
<li><a href='#plot.BsProb'><p>Plotting of Posterior Probabilities from Bayesian Screening</p></a></li>
<li><a href='#print.BsProb'><p>Printing Posterior Probabilities from Bayesian Screening</p></a></li>
<li><a href='#print.MD'><p>Print Best MD Follow-Up Experiments</p></a></li>
<li><a href='#Reactor.data'><p>Reactor Experiment Data</p></a></li>
<li><a href='#summary.BsProb'><p>Summary of Posterior Probabilities from Bayesian Screening</p></a></li>
<li><a href='#summary.MD'><p>Summary of Best MD Follow-Up Experiments</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>2023.920</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayes Screening and Model Discrimination</td>
</tr>
<tr>
<td>Author:</td>
<td>Ernesto Barrios based on Daniel Meyer's code.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ernesto Barrios &lt;ebarrios@itam.mx&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayes screening and model discrimination follow-up designs.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-14 05:56:45 UTC; ebarrios</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-19 09:00:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='BM86.data'>Data sets in Box and Meyer (1986)</h2><span id='topic+BM86.data'></span>

<h3>Description</h3>

<p> Design factors and responses used in the examples of Box and
Meyer (1986) </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BM86.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 16 observations on the following 19 variables.
</p>

<dl>
<dt>X1</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X2</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X3</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X4</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X5</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X6</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X7</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X8</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X9</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X10</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X11</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X12</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X13</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X14</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>X15</dt><dd><p>numeric vector. Contrast factor.</p>
</dd>
<dt>y1</dt><dd><p>numeric vector. Log drill advance response.</p>
</dd>
<dt>y2</dt><dd><p>numeric vector. Tensile strength response.</p>
</dd>
<dt>y3</dt><dd><p>numeric vector. Shrinkage response.</p>
</dd>
<dt>y4</dt><dd><p>numeric vector.  Yield of isatin response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box, G. E. P and R. D. Meyer (1986). &quot;An Analysis of Unreplicated
Fractional Factorials&quot;. <em>Technometrics.</em> Vol. 28. No. 1. pp. 11&ndash;18.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM86.data,package="BsMD")
print(BM86.data)
</code></pre>

<hr>
<h2 id='BM93.e1.data'>Example 1 data in Box and Meyer (1993)</h2><span id='topic+BM93.e1.data'></span>

<h3>Description</h3>

<p>12-run Plackett-Burman design from the $2^5$ reactor
example from Box, Hunter and Hunter (1977).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BM93.e1.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 7 variables.
</p>

<dl>
<dt>Run</dt><dd><p>a numeric vector. Run number from a $2^5$ factorial design in standard order.</p>
</dd>
<dt>A</dt><dd><p>a numeric vector. Feed rate factor.</p>
</dd>
<dt>B</dt><dd><p>a numeric vector. Catalyst factor.</p>
</dd>
<dt>C</dt><dd><p>a numeric vector. Agitation factor.</p>
</dd>
<dt>D</dt><dd><p>a numeric vector. Temperature factor.</p>
</dd>
<dt>E</dt><dd><p>a numeric vector. Concentration factor.</p>
</dd>
<dt>y</dt><dd><p>a numeric vector. Percent reacted response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. Wiley.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM93.e1.data,package="BsMD")
print(BM93.e1.data)
</code></pre>

<hr>
<h2 id='BM93.e2.data'>Example 2 data in Box and Meyer (1993)</h2><span id='topic+BM93.e2.data'></span>

<h3>Description</h3>

<p>12-run Plackett-Burman design for the study of fatigue
life of weld repaired castings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BM93.e2.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 8 variables.
</p>

<dl>
<dt>A</dt><dd><p>a numeric vector. Initial structure factor.</p>
</dd>
<dt>B</dt><dd><p>a numeric vector. Bead size factor.</p>
</dd>
<dt>C</dt><dd><p>a numeric vector. Pressure treat factor.</p>
</dd>
<dt>D</dt><dd><p>a numeric vector. Heat treat factor.</p>
</dd>
<dt>E</dt><dd><p>a numeric vector. Cooling rate factor.</p>
</dd>
<dt>F</dt><dd><p>a numeric vector. Polish factor.</p>
</dd>
<dt>G</dt><dd><p>a numeric vector. Final treat factor.</p>
</dd>
<dt>y</dt><dd><p>a numeric vector. Natural log of fatigue life response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Hunter, G. B., Hodi, F. S., and Eager, T. W. (1982). &quot;High-Cycle Fatigue
of Weld Repaired Cast Ti-6A1-4V&quot;. <em>Metallurgical Transactions</em> 13A,
pp. 1589&ndash;1594.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM93.e2.data,package="BsMD")
print(BM93.e2.data)
</code></pre>

<hr>
<h2 id='BM93.e3.data'>Example 3 data in Box and Meyer (1993)</h2><span id='topic+BM93.e3.data'></span>

<h3>Description</h3>

<p><code class="reqn">2^{8-4}</code> Fractional factorial design in the injection molding example from
Box, Hunter and Hunter (1978).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BM93.e3.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 10 variables.
</p>

<dl>
<dt>blk</dt><dd><p>a numeric vector</p>
</dd>
<dt>A</dt><dd><p>a numeric vector. Mold temperature factor.</p>
</dd>
<dt>B</dt><dd><p>a numeric vector. Moisture content factor.</p>
</dd>
<dt>C</dt><dd><p>a numeric vector. Holding Pressure factor.</p>
</dd>
<dt>D</dt><dd><p>a numeric vector. Cavity thickness factor.</p>
</dd>
<dt>E</dt><dd><p>a numeric vector. Booster pressure factor.</p>
</dd>
<dt>F</dt><dd><p>a numeric vector. Cycle time factor.</p>
</dd>
<dt>G</dt><dd><p>a numeric vector. Gate size factor.</p>
</dd>
<dt>H</dt><dd><p>a numeric vector. Screw speed factor.</p>
</dd>
<dt>y</dt><dd><p>a numeric vector. Shrinkage response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. Wiley.
</p>
<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (2004).
<em>Statistics for Experimenters II</em>. Wiley.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM93.e3.data,package="BsMD")
print(BM93.e3.data)
</code></pre>

<hr>
<h2 id='BsMD-internal'>Internal BsMD objects</h2><span id='topic+.First.lib'></span>

<h3>Description</h3>

<p>Internal BsMD objects.</p>


<h3>Details</h3>

<p>These are not to be called by the user.</p>

<hr>
<h2 id='BsMD-package'>
Bayes screening and model discrimination follow-up designs
</h2><span id='topic+BsMD-package'></span><span id='topic+BsMD'></span>

<h3>Description</h3>

<p>Bayes screening and model discrimination follow-up designs
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> BsMD</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2023.920</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-09-14</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL version 2 or later</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The packages allows you to perform the calculations and analyses described
in Mayer, Stainberg and Box paper in Technometrics, 1996.
</p>


<h3>Author(s)</h3>

<p>Author: Ernesto Barrios based on Daniel Meyer's code.
Maintainer: Ernesto Barrios &lt;ebarrios@itam.mx&gt;
</p>


<h3>References</h3>

<p>Box and Mayer, 1986; Box and Mayer, 1993; Mayer, Steinberg and Box, 1996.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(BM86.data)
</code></pre>

<hr>
<h2 id='BsProb'>Posterior Probabilities from Bayesian Screening Experiments</h2><span id='topic+BsProb'></span>

<h3>Description</h3>

<p>Marginal factor posterior probabilities and model posterior probabilities
from designed screening experiments are calculated according to Box and Meyer's
Bayesian procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    BsProb(X, y, blk, mFac, mInt = 2, p = 0.25, g = 2, ng = 1, nMod = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BsProb_+3A_x">X</code></td>
<td>
<p>Matrix. The design matrix.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_y">y</code></td>
<td>
<p>vector. The response vector.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_blk">blk</code></td>
<td>
<p>integer. Number of blocking factors (&gt;=0). These factors are
accommodated in the first columns of matrix <code>X</code>. There are
<code>ncol(X)-blk</code> design factors.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_mfac">mFac</code></td>
<td>
<p>integer. Maximum number of factors included in the models.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_mint">mInt</code></td>
<td>
<p>integer &lt;= 3. Maximum order of interactions considered in the models.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_p">p</code></td>
<td>
<p>numeric. Prior probability assigned to active factors.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_g">g</code></td>
<td>
<p>vector. Variance inflation factor(s) <code class="reqn">\gamma</code>associated to active and interaction factors.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_ng">ng</code></td>
<td>
<p>integer &lt;=20. Number of different variance inflation factors (<code>g</code>) used in calculations.</p>
</td></tr>
<tr><td><code id="BsProb_+3A_nmod">nMod</code></td>
<td>
<p>integer &lt;=100. Number of models to keep with the highest posterior probability.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Factor and model posterior probabilities are computed by Box and Meyer's Bayesian
procedure. The design factors are accommodated in the matrix <code>X</code> after
<code>blk</code> columns of the blocking factors. So, <code>ncol(X)-blk</code> design factors
are considered. If <code>g</code>, the variance inflation factor (VIF) <code class="reqn">\gamma</code>,
is a vector of length 1, the same VIF is used for factor main effects and interactions.
If the length of <code>g</code> is 2 and <code>ng</code> is 1, <code>g[1]</code> is used for factor
main effects and <code>g[2]</code> for the interaction effects. If <code>ng</code> greater than 1,
then <code>ng</code> values of VIFs between <code>g[1]</code> and <code>g[2]</code> are used for
calculations with the same <code class="reqn">gamma</code> value for main effects and interactions.
The function calls the <abbr><span class="acronym">FORTRAN</span></abbr> subroutine &lsquo;<span class="file">bm</span>&rsquo; and captures summary results.
The complete output of the <abbr><span class="acronym">FORTRAN</span></abbr> code is save in the &lsquo;<span class="file">BsPrint.out</span>&rsquo;
file in the working directory. The output is a list of class <code>BsProb</code> for which
<code>print</code>, <code>plot</code> and <code>summary</code> methods are available.
</p>


<h3>Value</h3>

<p>A list with all output parameters of the <abbr><span class="acronym">FORTRAN</span></abbr> subroutine &lsquo;<span class="file">bm</span>&rsquo;.
The names of the list components are such that they match the original <abbr><span class="acronym">FORTRAN</span></abbr>
code. Small letters used for capturing program's output.
</p>
<table>
<tr><td><code>X</code></td>
<td>
<p>matrix. The design matrix.</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>vector. The response vector.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>integer. The number of runs.</p>
</td></tr>
<tr><td><code>COLS</code></td>
<td>
<p>integer. The number of design factors.</p>
</td></tr>
<tr><td><code>BLKS</code></td>
<td>
<p>integer. The number of blocking factors accommodated in the first
columns of matrix <code>X</code>.</p>
</td></tr>
<tr><td><code>MXFAC</code></td>
<td>
<p>integer. Maximum number of factors considered in the models.</p>
</td></tr>
<tr><td><code>MXINT</code></td>
<td>
<p>integer. Maximum interaction order considered in the models.</p>
</td></tr>
<tr><td><code>PI</code></td>
<td>
<p>numeric. Prior probability assigned to the active factors.</p>
</td></tr>
<tr><td><code>INDGAM</code></td>
<td>
<p>integer. If 0, the same variance inflation factor (<code>GAMMA</code>)
is used for main and interactions effects.
If <code>INDGAM ==1</code>, then <code>NGAM</code> different values
of <code>GAMMA</code> were used.</p>
</td></tr>
<tr><td><code>INDG2</code></td>
<td>
<p>integer. If 1, the variance inflation factor <code>GAM2</code> was used for
the interaction effects.</p>
</td></tr>
<tr><td><code>NGAM</code></td>
<td>
<p>integer. Number of different VIFs used for computations.</p>
</td></tr>
<tr><td><code>GAMMA</code></td>
<td>
<p>vector. Vector of variance inflation factors of length 1 or 2.</p>
</td></tr>
<tr><td><code>NTOP</code></td>
<td>
<p>integer. Number of models with the highest posterior probability</p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>mdcnt</code></td>
<td>
<p>integer. Total number of models evaluated.</p>
</td></tr>
<tr><td><code>ptop</code></td>
<td>
<p>vector. Vector of probabilities of the top <code>ntop</code> models.</p>
</td></tr>
<tr><td><code>sigtop</code></td>
<td>
<p>vector.  Vector of sigma-squared of the top <code>ntop</code> models.</p>
</td></tr>
<tr><td><code>nftop</code></td>
<td>
<p>integer.  Number of factors in each of the <code>ntop</code> models.</p>
</td></tr>
<tr><td><code>jtop</code></td>
<td>
<p>matrix. Matrix of the number of factors and their labels
of the top <code>ntop</code> models.</p>
</td></tr>
<tr><td><code>del</code></td>
<td>
<p>numeric. Interval width of the <code>GAMMA</code> partition.</p>
</td></tr>
<tr><td><code>sprob</code></td>
<td>
<p>vector. Vector of posterior probabilities. If <code>ng&gt;1</code> the
probabilities are weighted averaged over <code>GAMMA</code>.</p>
</td></tr>
<tr><td><code>pgam</code></td>
<td>
<p>vector. Vector of values of the unscaled posterior density of <code>GAMMA</code>.</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>matrix. Matrix of marginal factor posterior probabilities for each of
the different values of <code>GAMMA</code>.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>integer. Indicator variable. <code>ind</code> is 1 if the &lsquo;<span class="file">bm</span>&rsquo;
subroutine exited properly. Any other number correspond to
the format label number in the <abbr><span class="acronym">FORTRAN</span></abbr> subroutine script.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function is a wrapper to call the <abbr><span class="acronym">FORTRAN</span></abbr> subroutine &lsquo;<span class="file">bm</span>&rsquo;,
modification of Daniel Meyer's original program, &lsquo;<span class="file">mbcqp5.f</span>&rsquo;, for the
application of Bayesian design and analysis of fractional factorial experiments,
part of the <span class="pkg">mdopt</span> bundle, available at <em>StatLib</em>.
</p>


<h3>Author(s)</h3>

<p>R. Daniel Meyer. Adapted for <span class="rlang"><b>R</b></span> by Ernesto Barrios.</p>


<h3>References</h3>

<p>Box, G. E. P and R. D. Meyer (1986).
&quot;An Analysis for Unreplicated Fractional Factorials&quot;.
<em>Technometrics.</em> Vol. 28. No. 1. pp. 11&ndash;18.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.BsProb">print.BsProb</a></code>, <code><a href="#topic+print.BsProb">print.BsProb</a></code>, <code><a href="#topic+summary.BsProb">summary.BsProb</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM86.data,package="BsMD")
X &lt;- as.matrix(BM86.data[,1:15])
y &lt;- BM86.data["y1"]
# Using prior probability of p = 0.20, and k = 10 (gamma = 2.49)
drillAdvance.BsProb &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.20, g = 2.49, ng = 1, nMod = 10)
plot(drillAdvance.BsProb)
summary(drillAdvance.BsProb)

# Using prior probability of p = 0.20, and a 5 &lt;= k &lt;= 15 (1.22 &lt;= gamma &lt;= 3.74)
drillAdvance.BsProbG &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.25, g = c(1.22, 3.74), ng = 3, nMod = 10)
plot(drillAdvance.BsProbG, code = FALSE, prt = TRUE)
</code></pre>

<hr>
<h2 id='DanielPlot'>Normal Plot of Effects</h2><span id='topic+DanielPlot'></span>

<h3>Description</h3>

<p>Normal plot of effects from a two level factorial experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DanielPlot(fit, code = FALSE, faclab = NULL, block = FALSE,
    datax = TRUE, half = FALSE, pch = "*", cex.fac = par("cex.lab"), 
    cex.lab = par("cex.lab"), cex.pch = par("cex.axis"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DanielPlot_+3A_fit">fit</code></td>
<td>
<p>object of class <code>lm</code>. Fitted model from <code>lm</code> or <code>aov</code>.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_code">code</code></td>
<td>
<p>logical. If <code>TRUE</code> labels &quot;A&quot;,&quot;B&quot;, etc are used instead of the
names of the coefficients (factors).</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_faclab">faclab</code></td>
<td>
<p>list. If <code>NULL</code> points are labelled accordingly to <code>code</code>,
otherwise <code>faclab</code> should be a list with <code>idx</code> (integer vector) and <code>lab</code>
(character vector) components. See Details.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_block">block</code></td>
<td>
<p>logical. If <code>TRUE</code>, the first factor is labelled as &quot;BK&quot; (block).</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_datax">datax</code></td>
<td>
<p>logical. If <code>TRUE</code>, the x-axis is used for the factor effects the
the y-axis for the normal scores. The opposite otherwise.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_half">half</code></td>
<td>
<p>logical. If <code>TRUE</code>, half-normal plot of effects is display.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_pch">pch</code></td>
<td>
<p>numeric or character. Points character.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_cex.fac">cex.fac</code></td>
<td>
<p>numeric. Factors' labels character size.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_cex.lab">cex.lab</code></td>
<td>
<p>numeric. Labels character size.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_cex.pch">cex.pch</code></td>
<td>
<p>numeric. Points character size.</p>
</td></tr>
<tr><td><code id="DanielPlot_+3A_...">...</code></td>
<td>
<p>graphical parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The two levels design are assumed -1 and 1. Factor effects assumed <code>2*coef(obj)</code>
((Intercept) removed) are displayed in a <code>qqnorm</code> plot with the effects in
the x-axis by default. If <code>half=TRUE</code> the half-normal plots of effects is
plotted as the normal quantiles of <code>0.5*(rank(abs(effects))-0.5)/length(effects)+1</code>
versus <code>abs(effects)</code>.
</p>


<h3>Value</h3>

<p>The function returns invisible data frame with columns: <code>x</code>, <code>y</code>
and <code>no</code>, for the coordinates and the enumeration of plotted points.
Names of the factor effects (coefficients) are the row names of the data frame.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p>C. Daniel (1976).
<em>Application of Statistics to Industrial Experimentation.</em>
Wiley.
</p>
<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>.
Wiley.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqnorm">qqnorm</a></code>, <code><a href="#topic+LenthPlot">LenthPlot</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### Injection Molding Experiment. Box et al. 1978.
library(BsMD)
# Data
data(BM86.data,package="BsMD")     # Design matrix and response
print(BM86.data)    # from Box and Meyer (1986)

# Model Fitting. Box and Meyer (1986) example 3.
injectionMolding.lm &lt;- lm(y3 ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 +
                    X10 + X11 + X12 + X13 + X14 + X15, data = BM86.data)
print(coef(injectionMolding.lm)) # Model coefficients

# Daniel Plots
par(mfrow=c(1,3),oma=c(0,0,1,0),pty="s")
DanielPlot(injectionMolding.lm, half = TRUE, main = "Half-Normal Plot")
DanielPlot(injectionMolding.lm, main = "Normal Plot of Effects")
DanielPlot(injectionMolding.lm,
        faclab = list(idx = c(12,4,13), lab = c(" -H"," VG"," -B")),
        main = "Active Contrasts")
</code></pre>

<hr>
<h2 id='LenthPlot'>Lenth's Plot of Effects</h2><span id='topic+LenthPlot'></span>

<h3>Description</h3>

<p>Plot of the factor effects with significance levels based on robust
estimation of contrast standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LenthPlot(obj, alpha = 0.05, plt = TRUE, limits = TRUE,
    xlab = "factors", ylab = "effects", faclab = NULL, cex.fac = par("cex.lab"),
    cex.axis=par("cex.axis"), adj = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LenthPlot_+3A_obj">obj</code></td>
<td>
<p>object of class <code>lm</code> or vector with the factor effects.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_alpha">alpha</code></td>
<td>
<p>numeric. Significance level used for the <em>margin of error</em> (ME)
and <em>simultaneous margin of error</em> (SME). See Lenth(1989).</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_plt">plt</code></td>
<td>
<p>logical. If <code>TRUE</code>, a spikes plot with the factor effects is displayed.
Otherwise, no plot is produced.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_limits">limits</code></td>
<td>
<p>logical. If <code>TRUE</code> ME and SME limits are displayed and labeled.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_xlab">xlab</code></td>
<td>
<p>character string. Used to label the x-axis. &quot;factors&quot; as default.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_ylab">ylab</code></td>
<td>
<p>character string. Used to label the y-axis. &quot;effects&quot; as default.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_faclab">faclab</code></td>
<td>
<p>list with components <code>idx</code> (numeric vector)
and <code>lab</code> (character vector). The <code>idx</code> entries of
effects vector (taken from <code>obj</code>) are labelled as <code>lab</code>.
The rest of the effect names are blanked. If <code>NULL</code> all factors
are labelled using the coefficients' name.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_cex.fac">cex.fac</code></td>
<td>
<p>numeric. Character size used for the factor labels.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_cex.axis">cex.axis</code></td>
<td>
<p>numeric. Character size used for the axis.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_adj">adj</code></td>
<td>
<p>numeric between 0 and 1. Determines where to place the
&quot;ME&quot; (margin of error) and the &quot;SME&quot; (simultaneous margin of error) labels
(character size of 0.9*<code>cex.axis</code>).
0 for extreme left hand side, 1 for extreme right hand side.</p>
</td></tr>
<tr><td><code id="LenthPlot_+3A_...">...</code></td>
<td>
<p>extra parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>obj</code> is of class <code>lm</code>, <code>2*coef(obj)</code> is used as factor
effect with the intercept term removed. Otherwise, <code>obj</code> should be a
vector with the factor effects. Robust estimate of the contrasts standard
error is used to calculate <em>marginal</em> (ME) and <em>simultaneous margin
of error</em> (SME) for the provided significance (<code>1 - alpha</code>) level.
See Lenth(1989).  Spikes are used to display the factor effects.
If <code>faclab</code> is <code>NULL</code>, factors are labelled with the effects or
coefficient names. Otherwise, those <code>faclab\$idx</code> factors are labelled
as <code>faclab\$lab</code>. The rest of the factors are blanked.
</p>


<h3>Value</h3>

<p>The function is called mainly for its side effect. It returns a vector with
the value of alpha used, the estimated PSE, ME and SME.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios. Extension provided by Kjetil Kjernsmo (2013).</p>


<h3>References</h3>

<p>Lenth, R. V. (1989).
&quot;Quick and Easy Analysis of Unreplicated Factorials&quot;.
<em>Technometrics</em> Vol. 31, No. 4. pp. 469&ndash;473.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DanielPlot">DanielPlot</a></code>, <code><a href="#topic+BsProb">BsProb</a></code> and <code><a href="#topic+plot.BsProb">plot.BsProb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### Tensile Strength Experiment. Taguchi and Wu. 1980
library(BsMD)
# Data
data(BM86.data,package="BsMD")     # Design matrix and responses
print(BM86.data)    # from Box and Meyer (1986)

# Model Fitting. Box and Meyer (1986) example 2.
tensileStrength.lm &lt;- lm(y2 ~ X1 + X2 + X3 + X4 + X5 + X6 + X7 + X8 + X9 +
                    X10 + X11 + X12 + X13 + X14 + X15, data = BM86.data)
print(coef(tensileStrength.lm)) # Model coefficients

par(mfrow=c(1,2),pty="s")
DanielPlot(tensileStrength.lm, main = "Daniel Plot")
LenthPlot(tensileStrength.lm, main = "Lenth's Plot")
</code></pre>

<hr>
<h2 id='MD'>Best Model Discrimination (MD) Follow-Up Experiments</h2><span id='topic+MD'></span>

<h3>Description</h3>

<p>Best follow-up experiments based on the MD criterion
are suggested to discriminate between competing models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MD(X, y, nFac, nBlk = 0, mInt = 3, g = 2,  nMod, p, s2, nf, facs, nFDes = 4,
Xcand, mIter = 20, nStart = 5, startDes = NULL, top = 20, eps = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MD_+3A_x">X</code></td>
<td>
<p>matrix. Design matrix of the initial experiment.</p>
</td></tr>
<tr><td><code id="MD_+3A_y">y</code></td>
<td>
<p>vector. Response vector of the initial experiment.</p>
</td></tr>
<tr><td><code id="MD_+3A_nfac">nFac</code></td>
<td>
<p>integer. Number of factors in the initial experiment.</p>
</td></tr>
<tr><td><code id="MD_+3A_nblk">nBlk</code></td>
<td>
<p>integer &gt;=1. The number of blocking factors in the initial experiment.
They are accommodated in the first columns of matrix <code>X</code>.</p>
</td></tr>
<tr><td><code id="MD_+3A_mint">mInt</code></td>
<td>
<p>integer. Maximum order of the interactions in the models.</p>
</td></tr>
<tr><td><code id="MD_+3A_g">g</code></td>
<td>
<p>vector. Variance inflation factor for main effects (<code>g[1]</code>)
and interactions effects (<code>g[2]</code>). If vector length
is 1 the same inflation factor is used for main and
interactions effects.</p>
</td></tr>
<tr><td><code id="MD_+3A_nmod">nMod</code></td>
<td>
<p>integer. Number of competing models.</p>
</td></tr>
<tr><td><code id="MD_+3A_p">p</code></td>
<td>
<p>vector. Posterior probabilities of the competing models.</p>
</td></tr>
<tr><td><code id="MD_+3A_s2">s2</code></td>
<td>
<p>vector. Competing model variances.</p>
</td></tr>
<tr><td><code id="MD_+3A_nf">nf</code></td>
<td>
<p>vector. Factors considered in each of the models.</p>
</td></tr>
<tr><td><code id="MD_+3A_facs">facs</code></td>
<td>
<p>matrix. Matrix [<code>nMod x max(nf)</code>] of factor numbers in the design matrix.</p>
</td></tr>
<tr><td><code id="MD_+3A_nfdes">nFDes</code></td>
<td>
<p>integer. Number of runs to consider in the follow-up experiment.</p>
</td></tr>
<tr><td><code id="MD_+3A_xcand">Xcand</code></td>
<td>
<p>matrix. Candidate runs to be chosen for the follow-up design.</p>
</td></tr>
<tr><td><code id="MD_+3A_miter">mIter</code></td>
<td>
<p>integer. If 0, then user-entered designs <code>startDes</code> are
evaluated, otherwise the maximum number of iterations for each Wynn search.</p>
</td></tr>
<tr><td><code id="MD_+3A_nstart">nStart</code></td>
<td>
<p>integer. Number of starting designs.</p>
</td></tr>
<tr><td><code id="MD_+3A_startdes">startDes</code></td>
<td>
<p>matrix. Matrix <code>[nStart x nFDes]</code>. Each row has the row numbers
of the user-supplied starting design.</p>
</td></tr>
<tr><td><code id="MD_+3A_top">top</code></td>
<td>
<p>integer. Highest MD follow-up designs recorded.</p>
</td></tr>
<tr><td><code id="MD_+3A_eps">eps</code></td>
<td>
<p>numeric. A small number (1e-5 by default) used for computations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MD criterion, proposed by Meyer, Steinberg and Box is used to discriminate
among competing models. Random starting runs chosen from <code>Xcand</code> are used
for the Wynn search of best MD follow-up designs. <code>nStart</code> starting points are
tried in the search limited to <code>mIter</code> iterations. If <code>mIter=0</code> then
<code>startDes</code> user-provided designs are used. Posterior probabilities and
variances of the competing models are obtained from <code><a href="#topic+BsProb">BsProb</a></code>.
The function calls the <abbr><span class="acronym">FORTRAN</span></abbr> subroutine &lsquo;<span class="file">md</span>&rsquo; and captures
summary results. The complete output of the <abbr><span class="acronym">FORTRAN</span></abbr> code is save in
the &lsquo;<span class="file">MDPrint.out</span>&rsquo; file in the working directory.
</p>


<h3>Value</h3>

<p>A list with all input and output parameters of the <abbr><span class="acronym">FORTRAN</span></abbr>
subroutine <code>MD</code>. Most of the variable names kept to match <abbr><span class="acronym">FORTRAN</span></abbr> code.
</p>
<table>
<tr><td><code>NSTART</code></td>
<td>
<p>Number of starting designs.</p>
</td></tr>
<tr><td><code>NRUNS</code></td>
<td>
<p>Number of runs used in follow-up designs.</p>
</td></tr>
<tr><td><code>ITMAX</code></td>
<td>
<p>Maximum number of iterations for each Wynn search.</p>
</td></tr>
<tr><td><code>INITDES</code></td>
<td>
<p>Number of starting points.</p>
</td></tr>
<tr><td><code>NO</code></td>
<td>
<p>Numbers of runs already completed before follow-up.</p>
</td></tr>
<tr><td><code>IND</code></td>
<td>
<p>Indicator; 0 indicates the user supplied starting designs.</p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>Matrix for initial data (<code>nrow(X)=N0</code>; <code>ncol(X)=COLS+BL</code>).</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>Response values from initial experiment (<code>length(Y)=N0</code>).</p>
</td></tr>
<tr><td><code>GAMMA</code></td>
<td>
<p>Variance inflation factor.</p>
</td></tr>
<tr><td><code>GAM2</code></td>
<td>
<p>If <code>IND=1</code>, <code>GAM2</code> was used for interaction factors.</p>
</td></tr>
<tr><td><code>BL</code></td>
<td>
<p>Number of blocks (&gt;=1) accommodated in first columns of <code>X</code> and <code>Xcand</code></p>
</td></tr></table>
<p>.
</p>
<table>
<tr><td><code>COLS</code></td>
<td>
<p>Number of factors.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of candidate runs.</p>
</td></tr>
<tr><td><code>Xcand</code></td>
<td>
<p>Matrix of candidate runs. (<code>nrow(Xcand)=N</code>, <code>ncol(Xcand)=ncol(X)</code>).</p>
</td></tr>
<tr><td><code>NM</code></td>
<td>
<p>Number of models considered.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Models posterior probability.</p>
</td></tr>
<tr><td><code>SIGMA2</code></td>
<td>
<p>Models variances.</p>
</td></tr>
<tr><td><code>NF</code></td>
<td>
<p>Number of factors per model.</p>
</td></tr>
<tr><td><code>MNF</code></td>
<td>
<p>Maximum number of factor in models. (<code>MNF=max(NF)</code>).</p>
</td></tr>
<tr><td><code>JFAC</code></td>
<td>
<p>Matrix with the factor numbers for each of the models.</p>
</td></tr>
<tr><td><code>CUT</code></td>
<td>
<p>Maximum interaction order considered.</p>
</td></tr>
<tr><td><code>MBEST</code></td>
<td>
<p>If <code>INITDES=0</code>, the first row of the <code>MBEST[1,]</code> matrix
has the first user-supplied starting design. The last row the
<code>NSTART</code>-th user-supplied starting design.</p>
</td></tr>
<tr><td><code>NTOP</code></td>
<td>
<p>Number of the top best designs.</p>
</td></tr>
<tr><td><code>TOPD</code></td>
<td>
<p>The D value for the best <code>NTOP</code> designs.</p>
</td></tr>
<tr><td><code>TOPDES</code></td>
<td>
<p>Top <code>NTOP</code> design factors.</p>
</td></tr>
<tr><td><code>ESP</code></td>
<td>
<p>&quot;Small number&quot; provided to the &lsquo;<span class="file">md</span>&rsquo; <abbr><span class="acronym">FORTRAN</span></abbr>
subroutine. 1e-5 by default.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>Indicator = 1, if the &lsquo;<span class="file">md</span>&rsquo; subroutine finished properly,
-1 otherwise.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function is a wrapper to call the <abbr><span class="acronym">FORTAN</span></abbr> subroutine &lsquo;<span class="file">md</span>&rsquo;,
modification of Daniel Meyer's original program, &lsquo;<span class="file">MD.f</span>&rsquo;, part of the
<span class="pkg">mdopt</span> bundle for Bayesian model discrimination of multifactor
experiments.
</p>


<h3>Author(s)</h3>

<p>R. Daniel Meyer. Adapted for <span class="rlang"><b>R</b></span> by Ernesto Barrios.</p>


<h3>References</h3>

<p>Meyer, R. D., Steinberg, D. M. and Box, G. E. P. (1996). &quot;Follow-Up Designs
to Resolve Confounding in Multifactor Experiments (with discussion)&quot;.
<em>Technometrics</em>, Vol. 38, No. 4, pp. 303&ndash;332.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.MD">print.MD</a></code>, <code><a href="#topic+BsProb">BsProb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Injection Molding Experiment. Meyer et al. 1996, example 2.
library(BsMD)
data(BM93.e3.data,package="BsMD")
X &lt;- as.matrix(BM93.e3.data[1:16,c(1,2,4,6,9)])
y &lt;- BM93.e3.data[1:16,10]
p &lt;- c(0.2356,0.2356,0.2356,0.2356,0.0566)
s2 &lt;- c(0.5815,0.5815,0.5815,0.5815,0.4412)
nf &lt;- c(3,3,3,3,4)
facs &lt;- matrix(c(2,1,1,1,1,3,3,2,2,2,4,4,3,4,3,0,0,0,0,4),nrow=5,
    dimnames=list(1:5,c("f1","f2","f3","f4")))
nFDes &lt;- 4
Xcand &lt;- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                    -1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,
                    -1,-1,1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,1,
                    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
                    -1,1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,1,-1),
                    nrow=16,dimnames=list(1:16,c("blk","f1","f2","f3","f4"))
                )
injectionMolding.MD &lt;- MD(X = X, y = y, nFac = 4, nBlk = 1, mInt = 3,
            g = 2, nMod = 5, p = p, s2 = s2, nf = nf, facs = facs,
            nFDes = 4, Xcand = Xcand, mIter = 20, nStart = 25, top = 10)
summary(injectionMolding.MD)



### Reactor Experiment. Meyer et al. 1996, example 3.
par(mfrow=c(1,2),pty="s")
data(Reactor.data,package="BsMD")

# Posterior probabilities based on first 8 runs
X &lt;- as.matrix(cbind(blk = rep(-1,8), Reactor.data[c(25,2,19,12,13,22,7,32), 1:5]))
y &lt;- Reactor.data[c(25,2,19,12,13,22,7,32), 6]
reactor8.BsProb &lt;- BsProb(X = X, y = y, blk = 1, mFac = 5, mInt = 3,
        p =0.25, g =0.40, ng = 1, nMod = 32)
plot(reactor8.BsProb,prt=TRUE,,main="(8 runs)")

# MD optimal 4-run design
p &lt;- reactor8.BsProb$ptop
s2 &lt;- reactor8.BsProb$sigtop
nf &lt;- reactor8.BsProb$nftop
facs &lt;- reactor8.BsProb$jtop
nFDes &lt;- 4
Xcand &lt;- as.matrix(cbind(blk = rep(+1,32), Reactor.data[,1:5]))
reactor.MD &lt;- MD(X = X, y = y, nFac = 5, nBlk = 1, mInt = 3, g =0.40, nMod = 32,
        p = p,s2 = s2, nf = nf, facs = facs, nFDes = 4, Xcand = Xcand,
        mIter = 20, nStart = 25, top = 5)
summary(reactor.MD)

# Posterior probabilities based on all 12 runs
X &lt;- rbind(X, Xcand[c(4,10,11,26), ])
y &lt;- c(y, Reactor.data[c(4,10,11,26),6])
reactor12.BsProb &lt;- BsProb(X = X, y = y, blk = 1, mFac = 5, mInt = 3,
        p = 0.25, g =1.20,ng = 1, nMod = 5)
plot(reactor12.BsProb,prt=TRUE,main="(12 runs)")
</code></pre>

<hr>
<h2 id='PB12Des'> 12-run Plackett-Burman Design Matrix</h2><span id='topic+PB12Des'></span>

<h3>Description</h3>

<p>12-run Plackett-Burman design matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PB12Des)</code></pre>


<h3>Format</h3>

<p>A data frame with 12 observations on the following 11 variables.
</p>

<dl>
<dt>x1</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x2</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x3</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x4</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x5</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x6</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x7</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x8</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x9</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x10</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
<dt>x11</dt><dd><p>numeric vectors. Contrast factor.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (2004).
<em>Statistics for Experimenters II</em>. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(PB12Des,package="BsMD")
str(PB12Des)
X &lt;- as.matrix(PB12Des)
print(t(X)%*%X)
</code></pre>

<hr>
<h2 id='plot.BsProb'>Plotting of Posterior Probabilities from Bayesian Screening</h2><span id='topic+plot.BsProb'></span>

<h3>Description</h3>

<p>Method function for plotting marginal factor posterior probabilities for Bayesian screening.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'BsProb'
plot(x, code = TRUE, prt = FALSE, cex.axis=par("cex.axis"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BsProb_+3A_x">x</code></td>
<td>
<p>list. List of class <code>BsProb</code> output from the
<code><a href="#topic+BsProb">BsProb</a></code> function.</p>
</td></tr>
<tr><td><code id="plot.BsProb_+3A_code">code</code></td>
<td>
<p>logical. If <code>TRUE</code> coded factor names are used.</p>
</td></tr>
<tr><td><code id="plot.BsProb_+3A_prt">prt</code></td>
<td>
<p>logical. If <code>TRUE</code>, summary of the posterior probabilities
calculation is printed.</p>
</td></tr>
<tr><td><code id="plot.BsProb_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Magnification used for the axis annotation.
See  <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
<tr><td><code id="plot.BsProb_+3A_...">...</code></td>
<td>
<p>additional graphical parameters passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A spike plot, similar to barplots, is produced with a spike for each factor.
Marginal posterior probabilities are used for the vertical axis.
If <code>code=TRUE</code>, <code>X1</code>, <code>X2</code>, ... are used to label the factors
otherwise the original factor names are used.
If <code>prt=TRUE</code>, the <code><a href="#topic+print.BsProb">print.BsProb</a></code> function is called
and the posterior probabilities are displayed.
When <code><a href="#topic+BsProb">BsProb</a></code> is called for more than one value of gamma (<code>g</code>),
the spikes for each factor probability are overlapped to show the
resulting range of each marginal probability.
</p>


<h3>Value</h3>

<p>The function is called for its side effects. It returns an invisible
<code>NULL</code>.
</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p>Box, G. E. P and R. D. Meyer (1986).
&quot;An Analysis for Unreplicated Fractional Factorials&quot;.
<em>Technometrics.</em> Vol. 28. No. 1. pp. 11&ndash;18.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BsProb">BsProb</a></code>, <code><a href="#topic+print.BsProb">print.BsProb</a></code>, <code><a href="#topic+summary.BsProb">summary.BsProb</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM86.data,package="BsMD")
X &lt;- as.matrix(BM86.data[,1:15])
y &lt;- BM86.data["y1"]
# Using prior probability of p = 0.20, and k = 10 (gamma = 2.49)
drillAdvance.BsProb &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.20, g = 2.49, ng = 1, nMod = 10)
plot(drillAdvance.BsProb)
summary(drillAdvance.BsProb)

# Using prior probability of p = 0.20, and a 5 &lt;= k &lt;= 15 (1.22 &lt;= gamma &lt;= 3.74)
drillAdvance.BsProbG &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.25, g = c(1.22, 3.74), ng = 3, nMod = 10)
plot(drillAdvance.BsProbG, code = FALSE, prt = TRUE)
</code></pre>

<hr>
<h2 id='print.BsProb'>Printing Posterior Probabilities from Bayesian Screening</h2><span id='topic+print.BsProb'></span>

<h3>Description</h3>

<p>Printing method for  lists of class <code>BsProb</code>. Prints the posterior
probabilities of factors and models from the Bayesian screening procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'BsProb'
print(x, X = TRUE, resp = TRUE, factors = TRUE, models = TRUE,
            nMod = 10, digits = 3, plt = FALSE, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BsProb_+3A_x">x</code></td>
<td>
<p>list. Object of <code>BsProb</code> class, output from the <code><a href="#topic+BsProb">BsProb</a></code> function.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_x">X</code></td>
<td>
<p>logical. If <code>TRUE</code>, the design matrix is printed.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_resp">resp</code></td>
<td>
<p>logical. If <code>TRUE</code>, the response vector is printed.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_factors">factors</code></td>
<td>
<p>logical. Marginal posterior probabilities are printed if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_models">models</code></td>
<td>
<p>logical. If <code>TRUE</code> models posterior probabilities are printed.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_nmod">nMod</code></td>
<td>
<p>integer. Number of the top ranked models to print.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_digits">digits</code></td>
<td>
<p>integer. Significant digits to use for printing.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_plt">plt</code></td>
<td>
<p>logical. Factor marginal probabilities are plotted if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, the <code>unclass</code>-ed list <code>x</code> is displayed.</p>
</td></tr>
<tr><td><code id="print.BsProb_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>print</code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function prints out marginal factors and models posterior probabilities.
Returns invisible list with the components:
</p>
<table>
<tr><td><code>calc</code></td>
<td>
<p>numeric vector with general calculation information.</p>
</td></tr>
<tr><td><code>probabilities</code></td>
<td>
<p>Data frame with the marginal posterior factor probabilities.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>Data frame with model the posterior probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p> Box, G. E. P and R. D. Meyer (1986). &quot;An Analysis for
Unreplicated Fractional Factorials&quot;. <em>Technometrics.</em> Vol. 28. No. 1.
pp. 11&ndash;18.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BsProb">BsProb</a></code>, <code><a href="#topic+summary.BsProb">summary.BsProb</a></code>, <code><a href="#topic+plot.BsProb">plot.BsProb</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM86.data,package="BsMD")
X &lt;- as.matrix(BM86.data[,1:15])
y &lt;- BM86.data["y1"]
# Using prior probability of p = 0.20, and k = 10 (gamma = 2.49)
drillAdvance.BsProb &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.20, g = 2.49, ng = 1, nMod = 10)
print(drillAdvance.BsProb)
plot(drillAdvance.BsProb)

# Using prior probability of p = 0.20, and a 5 &lt;= k &lt;= 15 (1.22 &lt;= gamma &lt;= 3.74)
drillAdvance.BsProbG &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.25, g = c(1.22, 3.74), ng = 3, nMod = 10)
print(drillAdvance.BsProbG, X = FALSE, resp = FALSE)
plot(drillAdvance.BsProbG)
</code></pre>

<hr>
<h2 id='print.MD'>Print Best MD Follow-Up Experiments</h2><span id='topic+print.MD'></span>

<h3>Description</h3>

<p>Printing method for  lists of class <code>MD</code>. Displays the
best MD criterion set of runs and their MD for follow-up experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'MD'
print(x, X = FALSE, resp = FALSE, Xcand = TRUE, models = TRUE, nMod = x$nMod,
            digits = 3, verbose=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.MD_+3A_x">x</code></td>
<td>
<p>list of class <code>MD</code>. Output list of the <code><a href="#topic+MD">MD</a></code> function.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_x">X</code></td>
<td>
<p>logical. If <code>TRUE</code>, the initial design matrix is printed.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_resp">resp</code></td>
<td>
<p>logical If <code>TRUE</code>, the response vector of initial design is printed.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_xcand">Xcand</code></td>
<td>
<p>logical. Prints the candidate runs if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_models">models</code></td>
<td>
<p>logical. Competing models are printed if <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_nmod">nMod</code></td>
<td>
<p>integer. Top models to print.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_digits">digits</code></td>
<td>
<p>integer. Significant digits to use in the print out.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, the <code>unclass</code>-ed <code>x</code> is displayed.</p>
</td></tr>
<tr><td><code id="print.MD_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>print</code> generic function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function is mainly called for its side effects. Prints out the selected
components of the class <code>MD</code> objects, output of the <code>MD</code> function.
For example the marginal factors and models posterior probabilities and
the top MD follow-up experiments with their corresponding MD statistic.
It returns invisible list with the components:
</p>
<table>
<tr><td><code>calc</code></td>
<td>
<p>Numeric vector with basic calculation information.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>Data frame with the competing models posterior probabilities.</p>
</td></tr>
<tr><td><code>follow-up</code></td>
<td>
<p>Data frame with the runs for follow-up experiments and
their corresponding MD statistic.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p>Meyer, R. D., Steinberg, D. M. and Box, G. E. P. (1996). &quot;Follow-Up Designs
to Resolve Confounding in Multifactor Experiments (with discussion)&quot;.
<em>Technometrics</em>, Vol. 38, No. 4, pp. 303&ndash;332.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MD">MD</a></code>, <code><a href="#topic+BsProb">BsProb</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Injection Molding Experiment. Meyer et al. 1996. Example 2.
# MD for one extra experiment.
library(BsMD)
data(BM93.e3.data,package="BsMD")
X &lt;- as.matrix(BM93.e3.data[1:16,c(1,2,4,6,9)])
y &lt;- BM93.e3.data[1:16,10]
nBlk &lt;- 1
nFac &lt;- 4
mInt &lt;- 3
g &lt;- 2
nMod &lt;- 5
p &lt;- c(0.2356,0.2356,0.2356,0.2356,0.0566)
s2 &lt;- c(0.5815,0.5815,0.5815,0.5815,0.4412)
nf &lt;- c(3,3,3,3,4)
facs &lt;- matrix(c(2,1,1,1,1,3,3,2,2,2,4,4,3,4,3,0,0,0,0,4),nrow=5,
    dimnames=list(1:5,c("f1","f2","f3","f4")))
nFDes &lt;- 1
Xcand &lt;- matrix(c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,
                    -1,-1,-1,-1,1,1,1,1,-1,-1,-1,-1,1,1,1,1,
                    -1,-1,1,1,-1,-1,1,1,-1,-1,1,1,-1,-1,1,1,
                    -1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,
                    -1,1,1,-1,1,-1,-1,1,1,-1,-1,1,-1,1,1,-1),
                    nrow=16,dimnames=list(1:16,c("blk","f1","f2","f3","f4"))
                )
mIter &lt;- 0
startDes &lt;- matrix(c(9,11,12,15),nrow=4)
top &lt;- 10
injectionMolding.MD &lt;- MD(X=X,y=y,nFac=nFac,nBlk=nBlk,mInt=mInt,g=g,
            nMod=nMod,p=p,s2=s2,nf=nf,facs=facs,
            nFDes=nFDes,Xcand=Xcand,mIter=mIter,startDes=startDes,top=top)

print(injectionMolding.MD)
summary(injectionMolding.MD)

</code></pre>

<hr>
<h2 id='Reactor.data'>Reactor Experiment Data</h2><span id='topic+Reactor.data'></span>

<h3>Description</h3>

<p>Data of the Reactor Experiment from Box, Hunter and Hunter (1978).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Reactor.data)</code></pre>


<h3>Format</h3>

<p>A data frame with 32 observations on the following 6 variables.
</p>

<dl>
<dt>A</dt><dd><p>numeric vector. Feed rate factor.</p>
</dd>
<dt>B</dt><dd><p>numeric vector. Catalyst factor.</p>
</dd>
<dt>C</dt><dd><p>numeric vector. Agitation rate factor.</p>
</dd>
<dt>D</dt><dd><p>numeric vector. Temperature factor.</p>
</dd>
<dt>E</dt><dd><p>numeric vector. Concentration factor.</p>
</dd>
<dt>y</dt><dd><p>numeric vector. Percentage reacted response.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (2004).
<em>Statistics for Experimenters II</em>. Wiley.
</p>
<p>Box G. E. P, Hunter, W. C. and Hunter, J. S. (1978).
<em>Statistics for Experimenters</em>. Wiley.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(Reactor.data,package="BsMD")
print(Reactor.data)
</code></pre>

<hr>
<h2 id='summary.BsProb'>Summary of Posterior Probabilities from Bayesian Screening</h2><span id='topic+summary.BsProb'></span>

<h3>Description</h3>

<p>Reduced printing method for class <code>BsProb</code> lists. Prints
posterior probabilities of factors and models from Bayesian screening
procedure.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'BsProb'
summary(object, nMod = 10, digits = 3, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BsProb_+3A_object">object</code></td>
<td>
<p>list. <code>BsProb</code> class list. Output list of <code><a href="#topic+BsProb">BsProb</a></code> function.</p>
</td></tr>
<tr><td><code id="summary.BsProb_+3A_nmod">nMod</code></td>
<td>
<p>integer. Number of the top ranked models to print.</p>
</td></tr>
<tr><td><code id="summary.BsProb_+3A_digits">digits</code></td>
<td>
<p>integer. Significant digits to use.</p>
</td></tr>
<tr><td><code id="summary.BsProb_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>summary</code> generic function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function prints out the marginal factors and models posterior
probabilities. Returns invisible list with the components:
</p>
<table>
<tr><td><code>calc</code></td>
<td>
<p>Numeric vector with basic calculation information.</p>
</td></tr>
<tr><td><code>probabilities</code></td>
<td>
<p>Data frame with the marginal posterior factor probabilities.</p>
</td></tr>
<tr><td><code>models</code></td>
<td>
<p>Data frame with the models posterior probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p> Box, G. E. P and R. D. Meyer (1986). &quot;An Analysis for
Unreplicated Fractional Factorials&quot;. <em>Technometrics.</em> Vol. 28. No. 1.
pp. 11&ndash;18.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BsProb">BsProb</a></code>, <code><a href="#topic+print.BsProb">print.BsProb</a></code>, <code><a href="#topic+plot.BsProb">plot.BsProb</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(BsMD)
data(BM86.data,package="BsMD")
X &lt;- as.matrix(BM86.data[,1:15])
y &lt;- BM86.data["y1"]
# Using prior probability of p = 0.20, and k = 10 (gamma = 2.49)
drillAdvance.BsProb &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.20, g = 2.49, ng = 1, nMod = 10)
plot(drillAdvance.BsProb)
summary(drillAdvance.BsProb)

# Using prior probability of p = 0.20, and a 5 &lt;= k &lt;= 15 (1.22 &lt;= gamma &lt;= 3.74)
drillAdvance.BsProbG &lt;- BsProb(X = X, y = y, blk = 0, mFac = 15, mInt = 1,
            p = 0.25, g = c(1.22, 3.74), ng = 3, nMod = 10)
plot(drillAdvance.BsProbG)
summary(drillAdvance.BsProbG)
</code></pre>

<hr>
<h2 id='summary.MD'>Summary of Best MD Follow-Up Experiments</h2><span id='topic+summary.MD'></span>

<h3>Description</h3>

<p>Reduced printing method for lists of class <code>MD</code>. Displays the
best MD criterion set of runs and their MD for follow-up experiments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>    ## S3 method for class 'MD'
summary(object, digits = 3, verbose=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.MD_+3A_object">object</code></td>
<td>
<p>list of <code>MD</code> class. Output list of <code><a href="#topic+MD">MD</a></code> function.</p>
</td></tr>
<tr><td><code id="summary.MD_+3A_digits">digits</code></td>
<td>
<p>integer. Significant digits to use in the print out.</p>
</td></tr>
<tr><td><code id="summary.MD_+3A_verbose">verbose</code></td>
<td>
<p>logical. If <code>TRUE</code>, the <code>unclass</code>-ed <code>object</code> is displayed.</p>
</td></tr>
<tr><td><code id="summary.MD_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>summary</code> generic function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It prints out the marginal factors and models posterior probabilities and
the top MD follow-up experiments with their corresponding MD statistic.</p>


<h3>Author(s)</h3>

<p>Ernesto Barrios.</p>


<h3>References</h3>

<p>Meyer, R. D., Steinberg, D. M. and Box, G. E. P. (1996). &quot;Follow-Up Designs
to Resolve Confounding in Multifactor Experiments (with discussion)&quot;.
<em>Technometrics</em>, Vol. 38, No. 4, pp. 303&ndash;332.
</p>
<p>Box, G. E. P and R. D. Meyer (1993). &quot;Finding the Active Factors
in Fractionated Screening Experiments&quot;.
<em>Journal of Quality Technology.</em> Vol. 25. No. 2. pp. 94&ndash;105.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.MD">print.MD</a></code> and <code><a href="#topic+MD">MD</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>### Reactor Experiment. Meyer et al. 1996, example 3.
library(BsMD)
data(Reactor.data,package="BsMD")

# Posterior probabilities based on first 8 runs
X &lt;- as.matrix(cbind(blk = rep(-1,8), Reactor.data[c(25,2,19,12,13,22,7,32), 1:5]))
y &lt;- Reactor.data[c(25,2,19,12,13,22,7,32), 6]
reactor.BsProb &lt;- BsProb(X = X, y = y, blk = 1, mFac = 5, mInt = 3,
        p =0.25, g =0.40, ng = 1, nMod = 32)

# MD optimal 4-run design
p &lt;- reactor.BsProb$ptop
s2 &lt;- reactor.BsProb$sigtop
nf &lt;- reactor.BsProb$nftop
facs &lt;- reactor.BsProb$jtop
nFDes &lt;- 4
Xcand &lt;- as.matrix(cbind(blk = rep(+1,32), Reactor.data[,1:5]))
reactor.MD &lt;- MD(X = X, y = y, nFac = 5, nBlk = 1, mInt = 3, g =0.40, nMod = 32,
        p = p,s2 = s2, nf = nf, facs = facs, nFDes = 4, Xcand = Xcand,
        mIter = 20, nStart = 25, top = 5)
print(reactor.MD)
summary(reactor.MD)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
