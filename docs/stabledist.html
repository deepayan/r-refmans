<!DOCTYPE html><html lang="en"><head><title>Help for package stabledist</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stabledist}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#StableDistribution'><p>Stable Distribution Function</p></a></li>
<li><a href='#StableMode'><p>Mode of the Stable Distribution Function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.7-2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-08-14</td>
</tr>
<tr>
<td>Title:</td>
<td>Stable Distribution Functions</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Maechler &lt;maechler@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>Matrix, fBasics, FMStable, RUnit, Rmpfr, sfsmisc ,
libstable4u</td>
</tr>
<tr>
<td>SuggestsNote:</td>
<td>'libstable4u', based on 'libstableR', is said to be
uniformly better both accuracy and speed wise, at least in
parts.</td>
</tr>
<tr>
<td>Description:</td>
<td>Density, Probability and Quantile functions, and random number
  generation for (skew) stable distributions, using the parametrizations of
  Nolan.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/scm/viewvc.php/pkg/stabledist/?root=rmetrics">https://r-forge.r-project.org/scm/viewvc.php/pkg/stabledist/?root=rmetrics</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-14 08:50:37 UTC; maechler</td>
</tr>
<tr>
<td>Author:</td>
<td>Diethelm Wuertz [aut] (original code),
  Martin Maechler <a href="https://orcid.org/0000-0002-8685-9910"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre] (checks/tests; fixes, ..),
  Yohan Chalabi [ctb] (namespace; admin)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-17 04:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='StableDistribution'>Stable Distribution Function</h2><span id='topic+StableDistribution'></span><span id='topic+dstable'></span><span id='topic+pstable'></span><span id='topic+qstable'></span><span id='topic+rstable'></span>

<h3>Description</h3>

<p>Compute density, distribution and quantile function and
to generate random variates of the stable distribution.
</p>
<p>The four functions are:
</p>

<table>
<tr>
 <td style="text-align: left;">
    <code>[dpqr]stable</code> </td><td style="text-align: left;"> the (skewed) stable distribution.
  </td>
</tr>

</table>

<p>Three parametrizations via <code>pm = 0, 1,</code>  or <code>2</code> <em>differ</em> in their
meaning of <code>delta</code> and <code>gamma</code>, see &lsquo;Details&rsquo; below.
Notably the special cases of the Gaussian / normal distribution for <code>alpha = 2</code>
and Cauchy distribution for <code>alpha = 1</code> and <code>beta = 0</code> are
easily matched for <code>pm = 2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dstable(x, alpha, beta, gamma = 1, delta = 0, pm = 0,
        log = FALSE,
        tol = 64*.Machine$double.eps, zeta.tol = NULL,
        subdivisions = 1000)
pstable(q, alpha, beta, gamma = 1, delta = 0, pm = 0,
        lower.tail = TRUE, log.p = FALSE, silent = FALSE,
        tol = 64*.Machine$double.eps, subdivisions = 1000)
qstable(p, alpha, beta, gamma = 1, delta = 0, pm = 0,
        lower.tail = TRUE, log.p = FALSE,
        tol = .Machine$double.eps^0.25, maxiter = 1000, trace = 0,
        integ.tol = 1e-7, subdivisions = 200)
rstable(n, alpha, beta, gamma = 1, delta = 0, pm = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StableDistribution_+3A_alpha">alpha</code>, <code id="StableDistribution_+3A_beta">beta</code>, <code id="StableDistribution_+3A_gamma">gamma</code>, <code id="StableDistribution_+3A_delta">delta</code></td>
<td>

<p>value of the index parameter <code>alpha</code> in the interval= <code class="reqn">(0, 2]</code>;
skewness parameter <code>beta</code>, in the range <code class="reqn">[-1, 1]</code>;
scale parameter <code>gamma</code>; and location (or &lsquo;shift&rsquo;)
parameter <code>delta</code>.
</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_n">n</code></td>
<td>
<p>sample size (integer).</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_p">p</code></td>
<td>
<p>numeric vector of probabilities.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_pm">pm</code></td>
<td>

<p>parameterization, an integer in <code>0, 1, 2</code>; by default <code>pm=0</code>,
the &lsquo;S0&rsquo; parameterization.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_x">x</code>, <code id="StableDistribution_+3A_q">q</code></td>
<td>
<p>numeric vector of quantiles.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_log">log</code>, <code id="StableDistribution_+3A_log.p">log.p</code></td>
<td>
<p>logical; if TRUE, probabilities p are given as log(p).</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE (default), probabilities are
<code class="reqn">P[X \le x]</code> otherwise, <code class="reqn">P[X &gt; x]</code>.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_silent">silent</code></td>
<td>
<p>logical indicating that e.g., warnings should be
suppressed when <code>NaN</code> is produced (because of numerical problems).</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_integ.tol">integ.tol</code></td>
<td>
<p>positive number, the tolerance used for numerical
integration, see <code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_tol">tol</code></td>
<td>
<p>numerical tolerance,
</p>

<dl>
<dt>dstable(), pstable():</dt><dd><p>used for numerical integration, see
<code>integ.tol</code> above.  Note that earlier versions had tighter
tolerances &ndash; which seem too tight as default values.</p>
</dd>
<dt>qstable():</dt><dd><p>used for rootfinding, see <code><a href="stats.html#topic+uniroot">uniroot</a></code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="StableDistribution_+3A_zeta.tol">zeta.tol</code></td>
<td>
<p>(<code>dstable</code>) numerical tolerance for checking if
<code>x</code> is close to <code class="reqn">\zeta(\alpha,\beta)</code>.  The default,
<code>NULL</code> depends itself on <code class="reqn">(\alpha,\beta)</code>.
<br />
As it is <em>experimental</em> and not guaranteed to remain in the
future, its use is not recommended in production code.  Rather e-mail the
package maintainer about it.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_subdivisions">subdivisions</code></td>
<td>
<p>maximal number of intervals for integration, see
<code><a href="stats.html#topic+integrate">integrate</a></code>.</p>
</td></tr>
<tr><td><code id="StableDistribution_+3A_maxiter">maxiter</code>, <code id="StableDistribution_+3A_trace">trace</code></td>
<td>
<p>maximal number of iterations and verboseness in
<code><a href="stats.html#topic+uniroot">uniroot</a></code>, see there.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>Skew Stable Distribution:</b>
<br /><br />
The function uses the approach of J.P. Nolan for general stable
distributions.  Nolan (1997) derived expressions in form of integrals
based on the characteristic function for standardized stable random
variables.  For <code>dstable</code> and <code>pstable</code>, these integrals
are numerically evaluated using <span class="rlang"><b>R</b></span>'s <code><a href="stats.html#topic+integrate">integrate</a>()</code>
function.
<br />
&ldquo;S0&rdquo; parameterization [pm=0]: based on the (M) representation
of Zolotarev for an alpha stable distribution with skewness
beta.  Unlike the Zolotarev (M) parameterization, gamma and
delta are straightforward scale and shift parameters.  This
representation is continuous in all 4 parameters, and gives
an intuitive meaning to gamma and delta that is lacking in
other parameterizations.
<br />
Switching the sign of <code>beta</code> <em>mirrors</em> the distribution at
the vertical axis <code class="reqn">x = \delta</code>, i.e.,
</p>
<p style="text-align: center;"><code class="reqn">f(x, \alpha, -\beta, \gamma, \delta, 0) =
      f(2\delta-x, \alpha, +\beta, \gamma, \delta, 0),</code>
</p>

<p>see the graphical example below.
</p>
<p>&ldquo;S&rdquo; or &ldquo;S1&rdquo; parameterization [pm=1]: the parameterization used
by Samorodnitsky and Taqqu in the book Stable Non-Gaussian
Random Processes.  It is a slight modification of Zolotarev's
(A) parameterization.
<br />
&ldquo;S*&rdquo; or &ldquo;S2&rdquo; parameterization [pm=2]: a modification of the S0
parameterization which is defined so that (i) the scale gamma
agrees with the Gaussian scale (standard dev.) when alpha=2
and the Cauchy scale when alpha=1, (ii) the mode is exactly at
delta.  For this parametrization,
<code><a href="#topic+stableMode">stableMode</a>(alpha,beta)</code> is needed.
<br />
&ldquo;S3&rdquo; parameterization [pm=3]: an internal parameterization,
currently not available for these functions.  The scale is the same
as the &ldquo;S2&rdquo; parameterization, the shift is
<code class="reqn">-\beta*g(\alpha)</code>, where <code class="reqn">g(\alpha)</code> is defined in Nolan(1999).
</p>


<h3>Value</h3>

<p>All values for the <code>*stable</code> functions
are numeric vectors:
<code>d*</code> returns the density,
<code>p*</code> returns the distribution function,
<code>q*</code> returns the quantile function, and
<code>r*</code> generates random deviates.
</p>


<h3>Tail Behavior</h3>

<p>The asymptotic behavior for large <code class="reqn">x</code>, aka &ldquo;tail behavior&rdquo;
for the cumulative <code class="reqn">F(x) = P(X \le x)</code>
is (for <code class="reqn">x\to\infty</code>)
</p>
<p style="text-align: center;"><code class="reqn">1 - F(x) \sim (1+\beta) C_\alpha x^{-\alpha},</code>
</p>

<p>where <code class="reqn">C_\alpha = \Gamma(\alpha)/\pi \sin(\alpha\pi/2)
           </code>; hence also
</p>
<p style="text-align: center;"><code class="reqn">F(-x) \sim (1-\beta) C_\alpha x^{-\alpha}.</code>
</p>

<p>Differentiating <code class="reqn">F()</code> above gives
</p>
<p style="text-align: center;"><code class="reqn">f(x) \sim \alpha(1+\beta) C_\alpha x^{-(1+\alpha)}.</code>
</p>



<h3>Note</h3>

<p>In the case <code class="reqn">\beta = 1</code>, the distributions are &ldquo;maximally
skewed to the right&rdquo; or simply &ldquo;<em>extremal</em> stable&rdquo;
(Zolotarev).  In that case, the package <span class="pkg">FMStable</span> provides
<code>dpq*</code> functions which are faster and more accurate than ours (if
accuracy higher than about 6 digits is needed), see,
<code><a href="FMStable.html#topic+pEstable">pEstable</a></code>.
</p>
<p>When <code>alpha</code> is close to 1 or close to 0 (&ldquo;close&rdquo;,
e.g., meaning distance <code class="reqn">d &lt; 0.01</code>), the computations typically are
numerically considerably more challenging, and the results may not be
accurate.
<br />
As we 
plan to improve on this, <em>and</em>
as it is unknown when exactly the numerical difficulties arise, we
mainly only warn here in the documentation, and only in some cases,
e.g. when the root finding with <code><a href="stats.html#topic+uniroot">uniroot</a></code> fails,
signal explicit <code><a href="base.html#topic+warning">warning</a>()</code>s and may return <code>NaN</code> then.
</p>


<h3>Author(s)</h3>

<p>Diethelm Wuertz for the original Rmetrics <span class="rlang"><b>R</b></span>-port.
Many numerical improvements by Martin Maechler.
</p>


<h3>References</h3>

<p>Chambers J.M., Mallows, C.L. and Stuck, B.W. (1976)
<em>A Method for Simulating Stable Random Variables</em>,
J. Amer. Statist. Assoc. <b>71</b>, 340&ndash;344.
</p>
<p>John P. Nolan (2020)
<em>Univariate Stable Distributions - Models for Heavy Tailed Data</em>
Springer Series in Operations Research and Financial Engineering;
<a href="https://doi.org/10.1007/978-3-030-52915-4">doi:10.1007/978-3-030-52915-4</a>
Much earlier version of chapter 1 available at
<a href="https://edspace.american.edu/jpnolan/stable/">https://edspace.american.edu/jpnolan/stable/</a>,
see  &ldquo;Introduction to Stable Distributions&rdquo;
</p>
<p>Nolan J.P. (1997)
Numerical calculation of stable densities and distribution functions.
<em>Stochastic Models</em> <b>13</b>(4), 759&ndash;774.
<br />
Also available as &lsquo;<span class="file">density.ps</span>&rsquo; from Nolan's web page.
</p>
<p>Samoridnitsky G., Taqqu M.S. (1994);
<em>Stable Non-Gaussian Random Processes, Stochastic Models
with Infinite Variance</em>,
Chapman and Hall, New York, 632 pages.
</p>
<p>Weron, A., Weron R. (1999);
<em>Computer Simulation of Levy alpha-Stable Variables and
Processes</em>,
Preprint Technical University of Wroclaw, 13 pages.
</p>
<p>Royuela-del-Val, J., Simmross-Wattenberg, F., and Alberola-López, C. (2017)
libstable: Fast, Parallel, and High-Precision Computation of <code class="reqn">\alpha</code>-Stable
Distributions in R, C/C++, and MATLAB.
<em>Journal of Statistical Software</em> <b>78</b>(1), 1&ndash;25.
<a href="https://doi.org/10.18637/jss.v078.i01">doi:10.18637/jss.v078.i01</a>
</p>


<h3>See Also</h3>

<p>the <code><a href="fBasics.html#topic+stableSlider">stableSlider</a>()</code> function from package
<span class="pkg">fBasics</span> for displaying densities and probabilities of these
distributions, for educational purposes.
</p>
<p>Royuela del Val et al. (2017) partly show to be uniformly
better both accuracy and speed wise than our computations;
While their package <span class="pkg">libstableR</span> is no longer on CRAN, there is
<a href="https://CRAN.R-project.org/package=libstable4u"><span class="pkg">libstable4u</span></a> derived from their implementation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## stable -

## Plot stable random number series
   set.seed(1953)
   r &lt;- rstable(n = 1000, alpha = 1.9, beta = 0.3)
   plot(r, type = "l", main = "stable: alpha=1.9 beta=0.3",
        col = "steelblue")
   grid()

## Plot empirical density and compare with true density:
   hist(r, n = 25, probability = TRUE, border = "white",
        col = "steelblue")
   x &lt;- seq(-5, 5, by=1/16)
   lines(x, dstable(x, alpha = 1.9, beta = 0.3, tol= 1e-3), lwd = 2)

## Plot df and compare with true df:
   plot(ecdf(r), do.points=TRUE, col = "steelblue",
        main = "Probabilities:  ecdf(rstable(1000,..)) and true  cdf F()")
   rug(r)
   lines(x, pstable(q = x, alpha = 1.9, beta = 0.3),
         col="#0000FF88", lwd= 2.5)

## Switching  sign(beta)  &lt;==&gt; Mirror the distribution around  x == delta:
curve(dstable(x, alpha=1.2, beta =  .8, gamma = 3, delta = 2), -10, 10)
curve(dstable(x, alpha=1.2, beta = -.8, gamma = 3, delta = 2),
      add=TRUE, col=2)
## or the same
curve(dstable(2*2-x, alpha=1.2, beta = +.8, gamma = 3, delta = 2),
      add=TRUE, col=adjustcolor("gray",0.2), lwd=5)
abline(v = 2, col = "gray", lty=2, lwd=2)
axis(1, at = 2, label = expression(delta == 2))

## Compute quantiles:
   x. &lt;- -4:4
   px &lt;- pstable(x., alpha = 1.9, beta = 0.3)
  (qs &lt;- qstable(px, alpha = 1.9, beta = 0.3))
stopifnot(all.equal(as.vector(qs), x., tol = 1e-5))

## Special cases: --- 1. Gaussian  alpha = 2 -----------
x. &lt;- seq(-5,5, by=1/16)
stopifnot(
    all.equal(
        pnorm  (x.,     m=pi,    sd=1/8),
        pstable(x., delta=pi, gamma=1/8, alpha = 2, beta = 0, pm = 2) )
   ,
##                --- 2. Cauchy  alpha = 1 -----------
    all.equal(
        pcauchy(x.),
        pstable(x., delta=0, gamma=1, alpha = 1, beta = 0, pm = 2) )
)
</code></pre>

<hr>
<h2 id='StableMode'>Mode of the Stable Distribution Function</h2><span id='topic+stableMode'></span>

<h3>Description</h3>

<p>Computes the mode of the stable distribution, i.e., the maximum of its
density function in the &quot;0&quot; parametrization, i.e., the maximum <code class="reqn">x_0</code> of
<code><a href="#topic+dstable">dstable</a>(x, alpha, beta, gamma = 1, delta = 0, pm = 0)</code>.
</p>
<p>Finds the maximum of <code><a href="#topic+dstable">dstable</a></code> numerically, using
<code><a href="stats.html#topic+optimize">optimize</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stableMode(alpha, beta,
           beta.max = 1 - 1e-11,
           tol = .Machine$double.eps^0.25)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StableMode_+3A_alpha">alpha</code>, <code id="StableMode_+3A_beta">beta</code></td>
<td>
<p>numeric parameters:
value of the index parameter <code>alpha</code> in the range <code class="reqn">(0,2]</code>,
and the skewness parameter <code>beta</code>, in the range <code class="reqn">[-1, 1]</code>.</p>
</td></tr>
<tr><td><code id="StableMode_+3A_beta.max">beta.max</code></td>
<td>
<p>for numerical purposes, values of beta too close to 1,
are set to <code>beta.max</code>.  Do not modify unless you know what
you're doing.</p>
</td></tr>
<tr><td><code id="StableMode_+3A_tol">tol</code></td>
<td>
<p>numerical tolerance for <code><a href="stats.html#topic+optimize">optimize</a>()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns a numeric value, the location of the stable mode.
</p>


<h3>Author(s)</h3>

<p>Diethelm Wuertz for the Rmetrics <span class="rlang"><b>R</b></span>-port;
minor cleanup by Martin Maechler.
</p>


<h3>See Also</h3>

<p>For definition and the &ldquo;dpqr&rdquo;-functions,
<code><a href="#topic+StableDistribution">StableDistribution</a></code>,
also for the references.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## beta = 0  &lt;==&gt;  symmetric  &lt;==&gt;  mode = 0
all.equal(stableMode(alpha=1, beta=0), 0)
al.s &lt;- c(1e-100, seq(0,2, by = 1/32)[-1])
stopifnot(vapply(al.s, function(alp)
                 stableMode(alpha=alp, beta=0), 1.) == 0)

## more interesting: asymmetric (beta != 0):
stableMode(alpha=1.2, beta=0.1)

if(stabledist:::doExtras()) { # takes 2.5 seconds
 sm0.5 &lt;- vapply(al.s, function(AA)
                 stableMode(alpha=AA, beta= 0.5), 1.)
 plot(al.s, sm0.5, type = "o", col=2, xlab = quote(alpha), ylab="mode",
      main = quote("Mode of stable"*{}(alpha, beta == 0.5, pm==0)))
}
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
