<!DOCTYPE html><html><head><title>Help for package gmwmx</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gmwmx}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cola'><p>GNSS time series for PBO station COLA</p></a></li>
<li><a href='#compare_fits'><p>Compare graphically two <code>gnsstsmodel</code> objects.</p></a></li>
<li><a href='#create_A_matrix'><p>Define matrix A of the functional model</p></a></li>
<li><a href='#create.gnssts'><p>Create a gnssts object</p></a></li>
<li><a href='#estimate_gmwmx'><p>Estimate a stochastic model in a two-steps procedure using the GMWMX estimator.</p></a></li>
<li><a href='#estimate_hector'><p>Estimate a stochastic model based on the MLE and the Hector implementation.</p></a></li>
<li><a href='#PBO_get_offsets'><p>Extract offsets for a PBO station</p></a></li>
<li><a href='#PBO_get_station'><p>Load station data from PBO</p></a></li>
<li><a href='#plot.gnsstsmodel'><p>Plotting method for a <code>gnsstsmodel</code> object.</p></a></li>
<li><a href='#print.gnsstsmodel'><p>Print method for a <code>gnsstsmodel</code> object.</p></a></li>
<li><a href='#read.gnssts'><p>Read a gnssts object</p></a></li>
<li><a href='#remove_outliers_hector'><p>Remove outliers from a gnssts object using Hector</p></a></li>
<li><a href='#write.gnssts'><p>Write a gnssts object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimate Functional and Stochastic Parameters of Linear Models
with Correlated Residuals</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the Generalized Method of Wavelet Moments with Exogenous Inputs estimator (GMWMX) presented in Cucci, D. A., Voirol, L., Kermarrec, G., Montillet, J. P., and Guerrier, S. (2023) &lt;<a href="https://doi.org/10.1007%2Fs00190-023-01702-8">doi:10.1007/s00190-023-01702-8</a>&gt;.
             The GMWMX estimator allows to estimate functional and stochastic parameters of linear models with correlated residuals. 
             The 'gmwmx' package provides functions to estimate, compare and analyze models, utilities to load and work with Global Navigation Satellite System (GNSS) data as well as methods to compare results with the Maximum Likelihood Estimator (MLE) implemented in Hector.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, simts</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, fs, stringi, wv, Matrix, longmemo, rjson, ltsa</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-03-20 15:03:26 UTC; lionel</td>
</tr>
<tr>
<td>Author:</td>
<td>Davide Antonio Cucci [aut],
  Lionel Voirol [aut, cre],
  Stéphane Guerrier [aut],
  Jean-Philippe Montillet [ctb],
  Gaël Kermarrec [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lionel Voirol &lt;lionelvoirol@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-03-20 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cola'>GNSS time series for PBO station COLA</h2><span id='topic+cola'></span>

<h3>Description</h3>

<p>Data from station COLA of the Plate Boundary Observatory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cola
</code></pre>


<h3>Format</h3>

<p>A <code>gnssts</code> object of the East position (dE) of the COLA station
</p>


<h3>Source</h3>

<p><a href="https://data.unavco.org/archive/gnss/products/position/COLA/COLA.pbo.igs14.pos">https://data.unavco.org/archive/gnss/products/position/COLA/COLA.pbo.igs14.pos</a>
</p>

<hr>
<h2 id='compare_fits'>Compare graphically two <code>gnsstsmodel</code> objects.</h2><span id='topic+compare_fits'></span>

<h3>Description</h3>

<p>Compare graphically two <code>gnsstsmodel</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_fits(fit_1, fit_2, main = NULL, y_unit = "mm", x_unit = "days")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_fits_+3A_fit_1">fit_1</code></td>
<td>
<p>A <code>gnsstsmodel</code> object.</p>
</td></tr>
<tr><td><code id="compare_fits_+3A_fit_2">fit_2</code></td>
<td>
<p>A <code>gnsstsmodel</code> object.</p>
</td></tr>
<tr><td><code id="compare_fits_+3A_main">main</code></td>
<td>
<p>A <code>string</code> specifying the plot title.</p>
</td></tr>
<tr><td><code id="compare_fits_+3A_y_unit">y_unit</code></td>
<td>
<p>A <code>string</code> specifying the y axis label.</p>
</td></tr>
<tr><td><code id="compare_fits_+3A_x_unit">x_unit</code></td>
<td>
<p>A <code>string</code> specifying the x axis label.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Produce a plot comparing two estimated models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(cola)
fit_gmwmx_1 = estimate_gmwmx(x = cola,
                             theta_0 = c(0.1,0.1,0.1,0.1), 
                             n_seasonal = 1, 
                             model_string = "wn+matern")
fit_gmwmx_2 = estimate_gmwmx(x = cola,
                             theta_0 = c(0.1,0.1,0.1), 
                             n_seasonal = 1, 
                             model_string = "wn+powerlaw")
compare_fits(fit_gmwmx_1, fit_gmwmx_2)

## End(Not run)
</code></pre>

<hr>
<h2 id='create_A_matrix'>Define matrix A of the functional model</h2><span id='topic+create_A_matrix'></span>

<h3>Description</h3>

<p>Define matrix A of the functional model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_A_matrix(t_nogap, jumps, n_seasonal)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_A_matrix_+3A_t_nogap">t_nogap</code></td>
<td>
<p>A <code>vector</code> specifying the index of the time series.</p>
</td></tr>
<tr><td><code id="create_A_matrix_+3A_jumps">jumps</code></td>
<td>
<p>A <code>vector</code> specifying the time at which there is a mean shift of the time series. Should be specified to <code>NULL</code> if there is not presence of offsets in the signal.</p>
</td></tr>
<tr><td><code id="create_A_matrix_+3A_n_seasonal">n_seasonal</code></td>
<td>
<p>An <code>integer</code> specifying the number of sinusoidal signals in the time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix A in order to compute the functional component of the model in a linear fashion
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n= 10*365
jump_vec &lt;- c(200, 300, 500)
nbr_sin = 2
A &lt;- create_A_matrix(1:n, jump_vec, n_seasonal = nbr_sin)
head(A)
A &lt;- create_A_matrix(1:n, jumps = NULL, n_seasonal = nbr_sin)
head(A)
</code></pre>

<hr>
<h2 id='create.gnssts'>Create a gnssts object</h2><span id='topic+create.gnssts'></span>

<h3>Description</h3>

<p>Create a gnssts object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create.gnssts(t, y, jumps = NULL, sampling_period = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create.gnssts_+3A_t">t</code></td>
<td>
<p>A <code>vector</code> specifying the time of each observation of the time series.</p>
</td></tr>
<tr><td><code id="create.gnssts_+3A_y">y</code></td>
<td>
<p>A <code>vector</code> specifying the values of each observation of the time series.</p>
</td></tr>
<tr><td><code id="create.gnssts_+3A_jumps">jumps</code></td>
<td>
<p>A <code>vector</code> specifying the time values for which there is a jump.</p>
</td></tr>
<tr><td><code id="create.gnssts_+3A_sampling_period">sampling_period</code></td>
<td>
<p>An <code>integer</code> specifying the sampling period.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gnssts</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phase &lt;- 0.45
amplitude &lt;- 2.5
sigma2_wn &lt;- 15
bias &lt;- 0
trend &lt;- 5 / 365.25
cosU &lt;- amplitude * cos(phase)
sinU &lt;- amplitude * sin(phase)
year &lt;- 5
n &lt;- year * 365
jump_vec &lt;- c(200, 300, 500)
jump_height &lt;- c(10, 15, 20)
nbr_sin &lt;- 1 
A &lt;- create_A_matrix(1:n, jump_vec, n_seasonal = nbr_sin)
x_0 &lt;- c(bias, trend, cosU, sinU, jump_height)
eps &lt;- rnorm(n = n, sd = sqrt(sigma2_wn))
yy &lt;- A %*% x_0 + eps
gnssts_obj &lt;- create.gnssts(t = 1:length(yy), y = yy, jumps = jump_vec)
str(gnssts_obj)

</code></pre>

<hr>
<h2 id='estimate_gmwmx'>Estimate a stochastic model in a two-steps procedure using the GMWMX estimator.</h2><span id='topic+estimate_gmwmx'></span>

<h3>Description</h3>

<p>Estimate a stochastic model in a two-steps procedure using the GMWMX estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_gmwmx(
  x,
  theta_0,
  n_seasonal = 1,
  model_string,
  method = "L-BFGS-B",
  maxit = 1e+06,
  ci = FALSE,
  k_iter = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_gmwmx_+3A_x">x</code></td>
<td>
<p>A <code>gnssts</code> object</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_theta_0">theta_0</code></td>
<td>
<p>A <code>vector</code> specifying the initial values for the vector of parameter of the stochastic model considered.</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_n_seasonal">n_seasonal</code></td>
<td>
<p>An <code>integer</code> specifying the number of seasonal component in the time series.</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_model_string">model_string</code></td>
<td>
<p>A <code>string</code> specifying the model to be estimated.</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_method">method</code></td>
<td>
<p>A <code>string</code> specifying the numerical optimization method that should be supplied to <code>optim()</code></p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_maxit">maxit</code></td>
<td>
<p>An <code>integer</code> specifying the maximum number of iterations for the numerical optimization procedure.</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_ci">ci</code></td>
<td>
<p>A <code>boolean</code> specifying if confidence intervals for the estimated parameters should be computed.</p>
</td></tr>
<tr><td><code id="estimate_gmwmx_+3A_k_iter">k_iter</code></td>
<td>
<p>An <code>integer</code> specifying the number of time the two steps GMWMX procedure should be run.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gnsstsmodel</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(cola)
fit_gmwmx = estimate_gmwmx(x = cola,
                           theta_0 = c(0.1,0.1,0.1,0.1), 
                           n_seasonal = 1, 
                           model_string = "wn+matern")

## End(Not run)

</code></pre>

<hr>
<h2 id='estimate_hector'>Estimate a stochastic model based on the MLE and the Hector implementation.</h2><span id='topic+estimate_hector'></span>

<h3>Description</h3>

<p>Estimate a stochastic model based on the MLE and the Hector implementation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_hector(
  x,
  n_seasonal = 1,
  model_string,
  likelihood_method = "AmmarGrag",
  cleanup = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_hector_+3A_x">x</code></td>
<td>
<p>A <code>gnssts</code> object</p>
</td></tr>
<tr><td><code id="estimate_hector_+3A_n_seasonal">n_seasonal</code></td>
<td>
<p>An <code>integer</code> specifying the number of seasonal component in the time series.</p>
</td></tr>
<tr><td><code id="estimate_hector_+3A_model_string">model_string</code></td>
<td>
<p>A <code>string</code> specifying the model to be estimated.</p>
</td></tr>
<tr><td><code id="estimate_hector_+3A_likelihood_method">likelihood_method</code></td>
<td>
<p>A <code>string</code> taking either value &quot;FullCov&quot; or &quot;AmmarGrag&quot; that specify the method for the Likelihood computation.</p>
</td></tr>
<tr><td><code id="estimate_hector_+3A_cleanup">cleanup</code></td>
<td>
<p>A <code>boolean</code> specifying if the files created by the estimation procedure should be cleaned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gnsstsmodel</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
cola = PBO_get_station(station_name = "COLA", column = "dE", time_range = c(51130, 52000))
fit_mle = estimate_hector(x = cola,
                          n_seasonal = 1, 
                          model_string = "wn+matern")


## End(Not run)

</code></pre>

<hr>
<h2 id='PBO_get_offsets'>Extract offsets for a PBO station</h2><span id='topic+PBO_get_offsets'></span>

<h3>Description</h3>

<p>Extract offsets for a PBO station
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PBO_get_offsets(station_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PBO_get_offsets_+3A_station_name">station_name</code></td>
<td>
<p>A <code>string</code> specifying the PBO station name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>vector</code> specifying the offsets of a PBO station.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pbo_cola_offsets = PBO_get_offsets(station_name = "COLA")
pbo_cola_offsets

## End(Not run)
</code></pre>

<hr>
<h2 id='PBO_get_station'>Load station data from PBO</h2><span id='topic+PBO_get_station'></span>

<h3>Description</h3>

<p>Load station data from PBO
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PBO_get_station(station_name, column, time_range = c(-Inf, Inf), scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PBO_get_station_+3A_station_name">station_name</code></td>
<td>
<p>A <code>string</code> specifying the PBO station name.</p>
</td></tr>
<tr><td><code id="PBO_get_station_+3A_column">column</code></td>
<td>
<p>A <code>string</code> specifying the name of the column to extract.</p>
</td></tr>
<tr><td><code id="PBO_get_station_+3A_time_range">time_range</code></td>
<td>
<p>A <code>vector</code> of 2 specifying the time range of data to extract.</p>
</td></tr>
<tr><td><code id="PBO_get_station_+3A_scale">scale</code></td>
<td>
<p>A <code>scalar</code> specifying an optional scaling parameter applied to the extracted data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gnssts</code> object that contains the data associated with the specified PBO station.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pbo_cola_data = PBO_get_station("COLA", column="dE")
str(pbo_cola_data)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.gnsstsmodel'>Plotting method for a <code>gnsstsmodel</code> object.</h2><span id='topic+plot.gnsstsmodel'></span>

<h3>Description</h3>

<p>Plotting method for a <code>gnsstsmodel</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnsstsmodel'
plot(
  x,
  main = NULL,
  y_unit = "mm",
  x_unit = "days",
  legend_position = "bottomright",
  legend_position_wv = "bottomleft",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.gnsstsmodel_+3A_x">x</code></td>
<td>
<p>A <code>gnsstsmodel</code> object.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_main">main</code></td>
<td>
<p>A <code>string</code> specifying the title of the plot.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_y_unit">y_unit</code></td>
<td>
<p>A <code>string</code> specifying the y axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_x_unit">x_unit</code></td>
<td>
<p>A <code>string</code> specifying the x axis label of the plot.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_legend_position">legend_position</code></td>
<td>
<p>A <code>string</code> specifying the legend position of the plot.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_legend_position_wv">legend_position_wv</code></td>
<td>
<p>A <code>string</code> specifying the legend position for the wv plot.</p>
</td></tr>
<tr><td><code id="plot.gnsstsmodel_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Plot a <code>gnsstsmodel</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(cola)
fit_gmwmx = estimate_gmwmx(x = cola,
                           theta_0 = c(0.1,0.1,0.1,0.1), 
                           n_seasonal = 1, 
                           model_string = "wn+matern")
plot(fit_gmwmx)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.gnsstsmodel'>Print method for a <code>gnsstsmodel</code> object.</h2><span id='topic+print.gnsstsmodel'></span>

<h3>Description</h3>

<p>Print method for a <code>gnsstsmodel</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnsstsmodel'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.gnsstsmodel_+3A_x">x</code></td>
<td>
<p>A <code>gnsstsmodel</code> object.</p>
</td></tr>
<tr><td><code id="print.gnsstsmodel_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Print a <code>gnsstsmodel</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(cola)
fit_gmwmx = estimate_gmwmx(x = cola,
                           theta_0 = c(0.1,0.1,0.1,0.1), 
                           n_seasonal = 1, 
                           model_string = "wn+matern")
                           
print(fit_gmwmx)

## End(Not run)

</code></pre>

<hr>
<h2 id='read.gnssts'>Read a gnssts object</h2><span id='topic+read.gnssts'></span>

<h3>Description</h3>

<p>Read a gnssts object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.gnssts(filename, format = "mom")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.gnssts_+3A_filename">filename</code></td>
<td>
<p>A <code>string</code> specifying the name of the file to read.</p>
</td></tr>
<tr><td><code id="read.gnssts_+3A_format">format</code></td>
<td>
<p>A <code>string</code> specifying the format of the file to read.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a <code>gnssts</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phase &lt;- 0.45
amplitude &lt;- 2.5
sigma2_wn &lt;- 15
bias &lt;- 0
trend &lt;- 5 / 365.25
cosU &lt;- amplitude * cos(phase)
sinU &lt;- amplitude * sin(phase)
year &lt;- 5
n &lt;- year * 365
jump_vec &lt;- c(200, 300, 500)
jump_height &lt;- c(10, 15, 20)
nbr_sin &lt;- 1
A &lt;- create_A_matrix(1:n, jump_vec, n_seasonal = nbr_sin)
x_0 &lt;- c(bias, trend, cosU, sinU, jump_height)
eps &lt;- rnorm(n = n, sd = sqrt(sigma2_wn))
yy &lt;- A %*% x_0 + eps
gnssts_obj &lt;- create.gnssts(t = 1:length(yy), y = yy, jumps = jump_vec)
str(gnssts_obj)
## Not run: 
write.gnssts(x = gnssts_obj, filename = "test.mom")
gnssts_obj &lt;-read.gnssts(filename = "test.mom", format = "mom")

## End(Not run)
</code></pre>

<hr>
<h2 id='remove_outliers_hector'>Remove outliers from a gnssts object using Hector</h2><span id='topic+remove_outliers_hector'></span>

<h3>Description</h3>

<p>Remove outliers from a gnssts object using Hector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_outliers_hector(x, n_seasonal, IQ_factor = 3, cleanup = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_outliers_hector_+3A_x">x</code></td>
<td>
<p>A <code>gnssts</code> object</p>
</td></tr>
<tr><td><code id="remove_outliers_hector_+3A_n_seasonal">n_seasonal</code></td>
<td>
<p>An <code>integer</code> specifying the number of seasonal component in the time series.</p>
</td></tr>
<tr><td><code id="remove_outliers_hector_+3A_iq_factor">IQ_factor</code></td>
<td>
<p>A <code>double</code> specifying the number used to scale the interquartile range and corresponding to the argument <code>IQ_factor</code> in Hector removeoutliers.ctl</p>
</td></tr>
<tr><td><code id="remove_outliers_hector_+3A_cleanup">cleanup</code></td>
<td>
<p>An <code>boolean</code> specifying if temporary files should be cleaned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>gnssts</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phase =     0.45
amplitude = 2.5
sigma2_wn =       15
bias =            0
trend =           5/365.25
cosU =            amplitude*cos(phase)
sinU =            amplitude*sin(phase)
n= 2*365
# define time at which there are jumps
jump_vec =  c(100, 200)
jump_height = c(10, 20)
# generate residuals
eps = rnorm(n = n, sd = sqrt(sigma2_wn))
# add trend, gaps and sin
A = create_A_matrix(1:length(eps), jump_vec, n_seasonal =  1)
# define beta
x_0 = c(bias, trend, jump_height,  cosU,  sinU)
# create time series
yy = A %*% x_0 + eps
plot(yy, type="l")
n_outliers = 30
set.seed(123)
id_outliers=sample(150:350, size = n_outliers)
val_outliers = rnorm(n = n_outliers, mean = max(yy)+10, sd = 5)
yy[id_outliers] = val_outliers
plot(yy, type="l")
# save signal in temp
gnssts_obj = create.gnssts(t = 1:length(yy), y = yy, jumps = jump_vec)
## Not run: 
clean_yy = remove_outliers_hector(x=gnssts_obj, n_seasonal = 1)
plot(clean_yy$t, clean_yy$y, type="l")

## End(Not run)
</code></pre>

<hr>
<h2 id='write.gnssts'>Write a gnssts object</h2><span id='topic+write.gnssts'></span>

<h3>Description</h3>

<p>Write a gnssts object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.gnssts(x, filename, format = "mom")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.gnssts_+3A_x">x</code></td>
<td>
<p>A <code>R</code> object to save as a <code>gnssts</code> object.</p>
</td></tr>
<tr><td><code id="write.gnssts_+3A_filename">filename</code></td>
<td>
<p>A <code>string</code> specifying the name of the file to write.</p>
</td></tr>
<tr><td><code id="write.gnssts_+3A_format">format</code></td>
<td>
<p>A <code>string</code> specifying the format of the file to write.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. Write a <code>gnssts</code> object in a .mom file by default.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phase &lt;- 0.45
amplitude &lt;- 2.5
sigma2_wn &lt;- 15
bias &lt;- 0
trend &lt;- 5 / 365.25
cosU &lt;- amplitude * cos(phase)
sinU &lt;- amplitude * sin(phase)
year &lt;- 5
n &lt;- year * 365
jump_vec &lt;- c(200, 300, 500)
jump_height &lt;- c(10, 15, 20)
nbr_sin &lt;- 1
A &lt;- create_A_matrix(1:n, jump_vec, n_seasonal = nbr_sin)
x_0 &lt;- c(bias, trend, cosU, sinU, jump_height)
eps &lt;- rnorm(n = n, sd = sqrt(sigma2_wn))
yy &lt;- A %*% x_0 + eps
gnssts_obj &lt;- create.gnssts(t = 1:length(yy), y = yy, jumps = jump_vec)
str(gnssts_obj)
## Not run: 
write.gnssts(x = gnssts_obj, filename = "test.mom")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
