<!DOCTYPE html><html lang="en"><head><title>Help for package stable</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {stable}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#dstable'><p>Stable Distribution</p></a></li>
<li><a href='#Links'><p>Links</p></a></li>
<li><a href='#Parameter_Conversion'><p>Easy conversion of parameters between stabledist (Nolan 1-parameterization) and stable (Lambert and Lindsey 1999)</p></a></li>
<li><a href='#Parameter_Conversion_Nolan_pm1_pm0'><p>Easy conversion of parameters between stabledist Nolan 1-parameterization and 0-parameterization</p></a></li>
<li><a href='#stable.mode'><p>Mode of a Stable Distribution</p></a></li>
<li><a href='#stablereg'><p>Stable Generalized Regression Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.1.6</td>
</tr>
<tr>
<td>Title:</td>
<td>Probability Functions and Generalized Regression Models for
Stable Distributions</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 1.4), rmutil</td>
</tr>
<tr>
<td>Description:</td>
<td>Density, distribution, quantile and hazard functions of a
    stable variate; generalized regression models for the parameters
    of a stable distribution. See the README for how to make equivalent calls
    to those of 'stabledist' (i.e., Nolan's 0-parameterization and 
    1-parameterization as detailed in Nolan (2020)). 
    See github for Lambert and Lindsey 1999 JRSS-C journal article, 
    which details the parameterization of the Buck (1995) stable.   
    See the Details section of the '?dstable' help file for context and 
    references.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.commanster.eu/rcode.html">https://www.commanster.eu/rcode.html</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/swihart/stable/issues">https://github.com/swihart/stable/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-03-01 18:54:52 UTC; swihartbj</td>
</tr>
<tr>
<td>Author:</td>
<td>Bruce Swihart [cre, aut],
  Jim Lindsey [aut] (Jim created this package, Bruce is maintaining the
    CRAN version),
  Philippe Lambert [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Bruce Swihart &lt;bruce.swihart@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-03-02 00:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='dstable'>Stable Distribution</h2><span id='topic+dstable'></span><span id='topic+pstable'></span><span id='topic+qstable'></span><span id='topic+rstable'></span><span id='topic+hstable'></span>

<h3>Description</h3>

<p>These functions provide information about the stable distribution
with the location, the dispersion, the skewness and the tail thickness
respectively modelled by the parameters <code>loc</code>, <code>disp</code>,
<code>skew</code> and  <code>tail</code>. These differ from those of 'stabledist' (i.e., Nolan's 0-parameterization and 
1-parameterization as detailed in Nolan (2020)). See the README for how to make equivalent calls
to those of 'stabledist' (i.e., Nolan's 0-parameterization and 
1-parameterization as detailed in Nolan (2020)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dstable(
  x,
  loc = 0,
  disp = 1/sqrt(2),
  skew = 0,
  tail = 2,
  npt = 501,
  up = 10,
  eps = 1e-06,
  integration = "Romberg"
)

pstable(q, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

qstable(p, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

rstable(n = 1, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)

hstable(x, loc = 0, disp = 1/sqrt(2), skew = 0, tail = 2, eps = 1e-06)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dstable_+3A_x">x</code>, <code id="dstable_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dstable_+3A_loc">loc</code></td>
<td>
<p>vector of (real) location parameters.</p>
</td></tr>
<tr><td><code id="dstable_+3A_disp">disp</code></td>
<td>
<p>vector of (positive) dispersion parameters.</p>
</td></tr>
<tr><td><code id="dstable_+3A_skew">skew</code></td>
<td>
<p>vector of skewness parameters (in [-1,1]).</p>
</td></tr>
<tr><td><code id="dstable_+3A_tail">tail</code></td>
<td>
<p>vector of parameters (in [0,2]) related to the tail thickness.</p>
</td></tr>
<tr><td><code id="dstable_+3A_npt">npt</code>, <code id="dstable_+3A_up">up</code>, <code id="dstable_+3A_integration">integration</code></td>
<td>
<p>As detailed herein &ndash; only available when using <code>dstable</code>.</p>
</td></tr>
<tr><td><code id="dstable_+3A_eps">eps</code></td>
<td>
<p>scalar giving the required precision in computation.</p>
</td></tr>
<tr><td><code id="dstable_+3A_p">p</code></td>
<td>
<p>vector of probabilites.</p>
</td></tr>
<tr><td><code id="dstable_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dstable</code>, <code>pstable</code>, <code>qstable</code> and <code>hstable</code>
compute the density, the distribution, the quantile and the hazard functions
of a stable variate. <code>rstable</code> generates random deviates with
the prescribed stable distribution.
</p>
<p><code>loc</code> is a location parameter in the same way as the mean
in the normal distribution: it can take any real value.
</p>
<p><code>disp</code> is a dispersion parameter in the same way as the standard
deviation in the normal distribution: it can take any positive value.
</p>
<p><code>skew</code> is a skewness parameter: it can take any value in <code class="reqn">(-1,1)</code>.
The distribution is right-skewed, symmetric and left-skewed
when <code>skew</code> is negative, null or positive respectively.
</p>
<p><code>tail</code> is a tail parameter (often named the characteristic exponent):
it can take any value in <code class="reqn">(0,2)</code> (with <code>tail=1</code> and <code>tail=2</code>
yielding the Cauchy and the normal distributions respectively
when symmetry holds).
</p>
<p>If <code>loc</code>, <code>disp</code>, <code>skew</code>, or <code>tail</code> are not
specified they assume the default values of <code class="reqn">0</code>, <code class="reqn">1/sqrt(2)</code>,
<code class="reqn">0</code> and <code class="reqn">2</code> respectively. This corresponds to a normal
variate with mean<code class="reqn">=0</code> and variance<code class="reqn">=1/2 disp^2</code>.
</p>
<p>The stable characteristic function is given by
</p>
<p style="text-align: center;"><code class="reqn">greekphi(t) = i loca t - disp {|t|}^{tail}  [1+i skew sign(t) greekomega(t,tail)]</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">greekomega(t,tail) = \frac{2}{\pi} LOG(ABS(t))</code>
</p>

<p>when <code>tail=1</code>, and
</p>
<p style="text-align: center;"><code class="reqn">greekomega(t,tail) = tan(\frac{\pi tail}{2})</code>
</p>

<p>otherwise.
</p>
<p>The characteristic function is inverted using Fourier's transform
to obtain the corresponding stable density. This inversion requires the
numerical evaluation of an integral from <code class="reqn">0</code> to <code class="reqn">\infty</code>.
Two algorithms
are proposed for this. The default is Romberg's method
(<code>integration</code>=&quot;Romberg&quot;) which is used to evaluate the integral
with an error bounded by <code>eps</code>.
The alternative method is Simpson's integration
(<code>integration</code>=&quot;Simpson&quot;): it approximates the
integral from <code class="reqn">0</code> to <code class="reqn">\infty</code> by an integral
from <code class="reqn">0</code> to <code>up</code>
with <code>npt</code> points subdividing <code class="reqn">(O, up)</code>.
These three extra arguments &ndash; <code>integration</code>, <code>up</code> and
<code>npt</code> &ndash; are only available when using <code>dstable</code>.
The other functions are all based on Romberg's algorithm.
</p>
<p>[Swihart 2022 update:] 
</p>
<p>See the README for how to make equivalent calls
to those of 'stabledist' (i.e., Nolan's 0-parameterization and 1-parameterization 
as detailed in Nolan (2020)). 
See github for Lambert and Lindsey 1999 JRSS-C journal article, 
which details the parameterization of the Buck (1995) stable distribution which allowed
a Fourier inversion to arrive at a form similar to but not exactly the $g_d$ 
function as detailed in Nolan (2020),
Abdul-Hamid and Nolan (1998) and Nolan (1997).  
The Nolan (2020) reference is a textbook that provides
an accessible and comprehensive summary of stable distributions in the 25 years or so
since the core of this R package was made and put on CRAN.  
The Buck (1995) parameterization most closely resembles the Zolotarev B parameterization
outlined in Definition 3.6 on page 93 of Nolan (2020) &ndash; except that Buck (1995) did
not allow the scale parameter to multiply with the location parameter.  
This explains why the 'Zolotarev B' entry in Table 3.1 on page 97 of Nolan (2020) has
the location parameter being multiplied by the scale parameter whereas in converting the Lindsey and Lambert (1999)
to Nolan 1-parameterization the location parameter stays the same.  
</p>
<p>To be clear, <code>stable::dstable</code> and <code>stable::pstable</code> are evaluated 
by numerically integrating the inverse Fourier transform.  The code works 
reasonably for small and moderate values of x, but will have numerical issues 
in some cases (such as values from <code>stable::pstable</code> being greater than 
1 or or not being monotonic).  The arguments <code>npt</code>, <code>up</code>, 
<code>integration</code>, and <code>eps</code> can be adjusted 
to improve accuracy at the cost of speed, but will still have limitations.
Functions that better handle these problems are available in other packages
(such as <code>stabledist</code> and <code>stable</code>) that use an alternative method
(as detailed in Nolan 1997)  
distinct from directly numerically integrating the Fourier inverse transform. 
See last example in the README.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dstable</code>: density
</p>
</li>
<li> <p><code>pstable</code>: cdf
</p>
</li>
<li> <p><code>qstable</code>: quantiles
</p>
</li>
<li> <p><code>rstable</code>: random deviates
</p>
</li>
<li> <p><code>hstable</code>: hazard
</p>
</li></ul>


<h3>Author(s)</h3>

<p>Philippe Lambert (Catholic University of Louvain, Belgium, <a href="mailto:phlambert@stat.ucl.ac.be">phlambert@stat.ucl.ac.be</a>)
</p>
<p>Jim Lindsey
</p>


<h3>References</h3>

<p>Lambert, P. and Lindsey, J.K. (1999) Analysing financial returns using
regression models based on non-symmetric stable distributions. Applied
Statistics, 48, 409-424.
</p>
<p>Nolan, John P. Univariate stable distributions. Berlin/Heidelberg, Germany: Springer, 2020.
</p>
<p>Nolan, John P. &quot;Numerical calculation of stable densities and distribution functions.&quot; Communications in statistics. Stochastic models 13.4 (1997): 759-774.
</p>
<p>Abdul-Hamid, Husein, and John P. Nolan. &quot;Multivariate stable densities as functions of one dimensional projections.&quot; Journal of multivariate analysis 67.1 (1998): 80-89.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+stablereg">stablereg</a></code> to fit generalized nonlinear regression models
for the stable distribution parameters. 
R packages <code>stabledist</code> and <code>libstableR</code> provide [dpqr] functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow=c(2,2))
x &lt;- seq(-5,5,by=0.1)

# Influence of loc (location)
plot(x,dstable(x,loc=-2,disp=1/sqrt(2),skew=-0.8,tail=1.5),
  type="l",ylab="",main="Varying LOCation")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=-0.8,tail=1.5))
lines(x,dstable(x,loc=2,disp=1/sqrt(2),skew=-0.8,tail=1.5))

# Influence of disp (dispersion)
plot(x,dstable(x,loc=0,disp=0.5,skew=0,tail=1.5),
  type="l",ylab="",main="Varying DISPersion")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=0.9,skew=0,tail=1.5))

# Influence of skew (skewness)
plot(x,dstable(x,loc=0,disp=1/sqrt(2),skew=-0.8,tail=1.5),
  type="l",ylab="",main="Varying SKEWness")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0.8,tail=1.5))

# Influence of tail (tail)
plot(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=0.8),
  type="l",ylab="",main="Varying TAIL thickness")
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=1.5))
lines(x,dstable(x,loc=0,disp=1/sqrt(2),skew=0,tail=2))

</code></pre>

<hr>
<h2 id='Links'>Links</h2><span id='topic+Links'></span><span id='topic+loc_g'></span><span id='topic+loc_h'></span><span id='topic+disp_g'></span><span id='topic+disp_h'></span><span id='topic+skew_g'></span><span id='topic+skew_h'></span><span id='topic+tail_g'></span><span id='topic+tail_h'></span>

<h3>Description</h3>

<p>Link and inverse functions for use in stablereg
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loc_g(x)

loc_h(x)

disp_g(x)

disp_h(x)

skew_g(x)

skew_h(x)

tail_g(x)

tail_h(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Links_+3A_x">x</code></td>
<td>
<p>the function argument</p>
</td></tr>
</table>

<hr>
<h2 id='Parameter_Conversion'>Easy conversion of parameters between stabledist (Nolan 1-parameterization) and stable (Lambert and Lindsey 1999)</h2><span id='topic+Parameter_Conversion'></span><span id='topic+sd2s'></span><span id='topic+s2sd'></span>

<h3>Description</h3>

<p><code>sd2s</code> has stabledist parameter (Nolan 1-parameterization) inputs and returns stable parameters as put forth in Lambert and Lindsey (1999) and used in this package.
<code>s2sd</code> has stable     parameter (Lambert and Lindsey (1999)) inputs and returns stabledist parameters (Nolan 1-parameterization).
See examples and the readme.  There's also more context and references in '?stable::dstable'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sd2s(alpha, beta, gamma, delta, pm = 1)

s2sd(tail, skew, disp, loc, pm = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Parameter_Conversion_+3A_alpha">alpha</code></td>
<td>
<p>the stabledist 'alpha'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_beta">beta</code></td>
<td>
<p>the stabledist 'beta'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_gamma">gamma</code></td>
<td>
<p>the stabledist 'gamma'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_delta">delta</code></td>
<td>
<p>the stabledist 'delta'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_pm">pm</code></td>
<td>
<p>default 1; currently only value supported. the stabledist parameterization 'pm'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_tail">tail</code></td>
<td>
<p>the stable 'tail' analogous to 'alpha'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_skew">skew</code></td>
<td>
<p>the stable 'skew' analogous to 'beta'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_disp">disp</code></td>
<td>
<p>the stable 'disp' analogous to 'gamma'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_+3A_loc">loc</code></td>
<td>
<p>the stable 'loc' analogous to 'delta'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>[Swihart 2022 update:] See the examples and README for how to make equivalent calls
to those of 'stabledist' (i.e., Nolan's 1-parameterization 
as detailed in Nolan (2020)) using these functions and this package. 
See github for Lambert and Lindsey 1999 JRSS-C journal article, 
which details the parameterization of the Buck (1995) stable distribution which allowed
a Fourier inversion to arrive at a form of the $g_d$ function as detailed in Nolan (2020),
The Buck (1995) parameterization most closely resembles the Zolotarev B parameterization
outlined in Definition 3.6 on page 93 of Nolan (2020) &ndash; except that Buck (1995) did
not allow the scale parameter to multiply with the location parameter.  
This explains why the 'Zolotarev B' entry in Table 3.1 on page 97 of Nolan (2020) has
the location parameter being multiplied by the scale parameter whereas in converting the Lindsey and Lambert (1999)
to Nolan 1-parameterization the location parameter stays the same.
</p>


<h3>Value</h3>

<p><code>sd2s</code> returns stable parameters as put forth in Lambert and Lindsey (1999) and used in this package.
<code>s2sd</code> returns stabledist parameters (Nolan 1-parameterization).
</p>


<h3>References</h3>

<p>Lambert, P. and Lindsey, J.K. (1999) Analysing financial returns using
regression models based on non-symmetric stable distributions. Applied
Statistics, 48, 409-424.
</p>
<p>Nolan, John P. Univariate stable distributions. Berlin/Heidelberg, Germany: Springer, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
q &lt;- -1
# nolan pm=1 parameters:
a &lt;-  1.3
b &lt;-  -0.4
c &lt;-  2
d &lt;-  0.75
s &lt;- sd2s(alpha=a, beta=b, gamma=c, delta=d)
stable::pstable(q, tail = s$tail, skew=s$skew, disp = s$disp, loc  = s$loc)
stabledist::pstable(q, alpha=a, beta=b , gamma=c , delta=d, pm=1)
sd &lt;- s2sd(tail = s$tail, skew=s$skew, disp = s$disp, loc  = s$loc)
stabledist::pstable(q, alpha=sd$alpha, beta=sd$beta , gamma=sd$gamma , delta=sd$delta, pm=1)
## End(Not run)
</code></pre>

<hr>
<h2 id='Parameter_Conversion_Nolan_pm1_pm0'>Easy conversion of parameters between stabledist Nolan 1-parameterization and 0-parameterization</h2><span id='topic+Parameter_Conversion_Nolan_pm1_pm0'></span><span id='topic+pm0_to_pm1'></span><span id='topic+pm1_to_pm0'></span>

<h3>Description</h3>

<p><code>pm0_to_pm1</code> has stabledist parameter inputs for pm=0 and returns pm=1 equivalent parameterization.
<code>pm1_to_pm0</code> has stabledist parameter inputs for pm=1 and returns pm=0 equivalent parameterization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pm0_to_pm1(a0, b0, c0, d0)

pm1_to_pm0(a1, b1, c1, d1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_a0">a0</code></td>
<td>
<p>the stabledist 'alpha' for pm=0 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_b0">b0</code></td>
<td>
<p>the stabledist 'beta' for pm=0 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_c0">c0</code></td>
<td>
<p>the stabledist 'gamma' for pm=0 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_d0">d0</code></td>
<td>
<p>the stabledist 'delta' for pm=0 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_a1">a1</code></td>
<td>
<p>the stabledist 'alpha' for pm=1 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_b1">b1</code></td>
<td>
<p>the stabledist 'beta' for pm=1 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_c1">c1</code></td>
<td>
<p>the stabledist 'gamma' for pm=1 in 'stabledist'</p>
</td></tr>
<tr><td><code id="Parameter_Conversion_Nolan_pm1_pm0_+3A_d1">d1</code></td>
<td>
<p>the stabledist 'delta' for pm=1 in 'stabledist'</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See table Table 3.1 on page 97 of Nolan (2020).
</p>


<h3>Value</h3>

<p><code>pm0_to_pm1</code> has stabledist parameter inputs for pm=0 and returns pm=1 equivalent parameterization.
<code>pm1_to_pm0</code> has stabledist parameter inputs for pm=1 and returns pm=0 equivalent parameterization.
</p>


<h3>References</h3>

<p>Nolan, John P. Univariate stable distributions. Berlin/Heidelberg, Germany: Springer, 2020.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: q &lt;- -1
# nolan pm=1 parameters:
a1 &lt;-  1.3
b1 &lt;-  -0.4
c1 &lt;-  2
d1 &lt;-  0.75
# Convert to nolan pm=0 parameters:
pm0 &lt;- pm1_to_pm0(a1,b1,c1,d1)
a0 &lt;- pm0$a0
b0 &lt;- pm0$b0
c0 &lt;- pm0$c0
d0 &lt;- pm0$d0
# check:
stabledist::pstable(q, alpha=a1, beta=b1 , gamma=c1 , delta=d1, pm=1)
#&gt; [1] 0.1965513
# only change delta=d0 for pm=0
stabledist::pstable(q, alpha=a1, beta=b1 , gamma=c1 , delta=d0, pm=0)
stabledist::pstable(q, alpha=a0, beta=b0 , gamma=c0 , delta=d0, pm=0)
#&gt; [1] 0.1965513
stabledist::dstable(q, alpha=a1, beta=b1 , gamma=c1 , delta=d1, pm=1)
#&gt; [1] 0.0572133
# only change delta=d0 for pm=0
stabledist::dstable(q, alpha=a1, beta=b1 , gamma=c1 , delta=d0, pm=0)
stabledist::dstable(q, alpha=a0, beta=b0 , gamma=c0 , delta=d0, pm=0)
#&gt; [1] 0.0572133
## End(Not run)
</code></pre>

<hr>
<h2 id='stable.mode'>Mode of a Stable Distribution</h2><span id='topic+stable.mode'></span>

<h3>Description</h3>

<p>This function gives a reliable approximation to the mode of a stable
distribution with location, dispersion, skewness and tail thickness
specified by the parameters <code>loc</code>, <code>disp</code>, <code>skew</code> and
<code>tail</code>. <code>tail</code> must be in (1,2).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stable.mode(loc, disp, skew, tail)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stable.mode_+3A_loc">loc</code></td>
<td>
<p>vector of (real) location parameters.</p>
</td></tr>
<tr><td><code id="stable.mode_+3A_disp">disp</code></td>
<td>
<p>vector of (positive) dispersion parameters.</p>
</td></tr>
<tr><td><code id="stable.mode_+3A_skew">skew</code></td>
<td>
<p>vector of skewness parameters (in [-1,1]).</p>
</td></tr>
<tr><td><code id="stable.mode_+3A_tail">tail</code></td>
<td>
<p>vector of parameters (in [1,2]) related to the tail thickness.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>loc</code> is a location parameter in the same way as the mean in the normal
distribution: it can take any real value.
</p>
<p><code>disp</code> is a dispersion parameter in the same way as the standard
deviation in the normal distribution: it can take any positive value.
</p>
<p><code>skew</code> is a skewness parameter: it can take any value in <code class="reqn">(-1,1)</code>.
The distribution is right-skewed, symmetric and left-skewed when <code>skew</code>
is negative, null or positive respectively.
</p>
<p><code>tail</code> is a tail parameter (often named the characteristic exponent):
it can take any value in <code class="reqn">(0,2)</code> (with <code>tail=1</code> and <code>tail=2</code>
yielding the Cauchy and the normal distributions respectively when symmetry
holds).
</p>
<p>The simplest empirical formula found to give a satisfactory approximation to
the mode for values of <code>tail</code> in <code class="reqn">(1,2)</code> is </p>
<p style="text-align: center;"><code class="reqn">
loc+disp*a*skew*exp(-b*abs(skew))</code>
</p>
<p> with </p>
<p style="text-align: center;"><code class="reqn"> a =
1.7665114+1.8417675*tail-2.2954390*tail^2+0.4666749*tail^3</code>
</p>
<p> and </p>
<p style="text-align: center;"><code class="reqn"> b =
-0.003142967+632.4715*tail*exp(-7.106035*tail)</code>
</p>
<p>.
</p>


<h3>Value</h3>

<p>A list of size 3 giving the mode, <code class="reqn">a</code> and <code class="reqn">b</code>.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert (Catholic University of Louvain, Belgium,
<a href="mailto:phlambert@stat.ucl.ac.be">phlambert@stat.ucl.ac.be</a>) and Jim Lindsey.
</p>


<h3>References</h3>

<p>Lambert, P. and Lindsey, J.K. (1999) Analysing financial returns
using regression models based on non-symmetric stable distributions. Applied
Statistics, 48, 409-424.
</p>


<h3>See Also</h3>

<p><code>stable</code> for more details on the stable
distribution.
</p>
<p><code>stablereg</code> to fit generalized linear models for the
stable distribution parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- seq(-5,5,by=0.1)
plot(x,dstable(x,loc=0,disp=1,skew=-1,tail=1.5),type="l",ylab="f(x)")
xhat &lt;- stable.mode(loc=0,disp=1,skew=-1,tail=1.5)$ytilde
fxhat &lt;- dstable(xhat,loc=0,disp=1,skew=-1,tail=1.5)
lines(c(xhat,xhat),c(0,fxhat),lty="dotted")

</code></pre>

<hr>
<h2 id='stablereg'>Stable Generalized Regression Models</h2><span id='topic+stablereg'></span><span id='topic+fitted.stable'></span><span id='topic+df.residual.stable'></span><span id='topic+deviance.stable'></span><span id='topic+aic.stable'></span>

<h3>Description</h3>

<p><code>stablereg</code> fits user specified generalized linear and nonlinear
regression models based on the stable distribution to (uncensored, right
and/or left censored) data. This allows the location, the dispersion, the
skewness and the tails of the fitted stable distribution to vary with
explanatory variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stablereg(
  y = NULL,
  loc = 0,
  disp = 1,
  skew = 0,
  tail = 1.5,
  oloc = TRUE,
  odisp = TRUE,
  oskew = TRUE,
  otail = TRUE,
  noopt = FALSE,
  iloc = NULL,
  idisp = NULL,
  iskew = NULL,
  itail = NULL,
  loc_h = NULL,
  disp_h = NULL,
  skew_h = NULL,
  tail_h = NULL,
  weights = 1,
  exact = FALSE,
  delta = 1,
  envir = parent.frame(),
  integration = "Romberg",
  eps = 1e-06,
  up = 10,
  npoint = 501,
  hessian = TRUE,
  llik.output = FALSE,
  print.level = 0,
  ndigit = 10,
  steptol = 1e-05,
  gradtol = 1e-05,
  fscale = 1,
  typsize = abs(p0),
  stepmax = sqrt(p0 %*% p0),
  iterlim = 100
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stablereg_+3A_y">y</code></td>
<td>
<p>The response vector or a <code>repeated</code> data object. If the
<code>repeated</code> data object contains more than one response variable, give
that object in <code>envir</code> and give the name of the response variable to be
used here.
</p>
<p>For censored data, two columns with the second being the censoring indicator
(1: uncensored, 0: right censored, -1: left censored.)</p>
</td></tr>
<tr><td><code id="stablereg_+3A_loc">loc</code>, <code id="stablereg_+3A_loc_h">loc_h</code>, <code id="stablereg_+3A_oloc">oloc</code>, <code id="stablereg_+3A_iloc">iloc</code></td>
<td>
<p>Describe the regression model fitted for the
location parameter of the stable distribution, perhaps after transformation
by the link function <code>loc_g</code> (set to the identity by default. The
inverse link function is denoted by <code>loc_h</code>. Note that these functions
cannot contain unknown parameters).
</p>
<p>Two specifications are possible:
</p>
<p>(1) <code>loc</code> is a linear or nonlinear language expression beginning with ~
or an R function, describing the regression function for the location
parameter (after transformation by <code>loc_g</code>, the link function).
</p>
<p><code>iloc</code> is a vector of initial conditions for the parameters in the
regression for this parameter.
</p>
<p><code>oloc</code> is a boolean indicating if an optimization of the likelihood has
to be carried out on these parameters. If <code>oloc</code> is set to TRUE, a
default zero value is considered for the starting values <code>iloc</code>. But if
no optimization is desired on the location parameters, i.e. when the
likelihood has to be evaluated or optimized at a fixed location, then
<code>iloc</code> has to be explicitely specified.
</p>
<p>(2) <code>loc</code> is a numeric expression (i.e. a scalar or a vector of the
same size as the data vector <code>y</code>, or <code>y[,1]</code> when censoring is
considered).
</p>
<p>If <code>oloc</code> is set to TRUE, i.e. when an optimization of the likelihood
has to be carried out on the location parameter, then the location parameter
(after transformation by the link function loc_g) is set to an unknown
parameter with initial value equal to <code>iloc[1]</code> or <code>loc[1]</code> when
<code>iloc</code> is not specified.
</p>
<p>But when <code>oloc</code> is set to FALSE, i.e. when the likelihood has to be
evaluated or optimized at a fixed location, then the transformed location is
assumed to be equal to <code>loc</code> when it is of the same length as the data
vector <code>y</code> (or <code>y[,1]</code> when censoring is considered), and to
<code>loc[1]</code> otherwise.
</p>
<p>Specification (1) is especially useful in ANOVA-like situations where the
location is assumed to change with the levels of some factor variable.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_disp">disp</code>, <code id="stablereg_+3A_disp_h">disp_h</code>, <code id="stablereg_+3A_odisp">odisp</code>, <code id="stablereg_+3A_idisp">idisp</code></td>
<td>
<p>describe the regression model for the
dispersion parameter of the fitted stable distribution, after transformation
by the link function <code>disp_g</code> (set to the <code>log</code> function by
default). The inverse link function is denoted by <code>disp_h</code>. Again these
functions cannot contain unknown parameters. The same rules as above apply
when specifying the generalized regression model for the dispersion
parameter.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_skew">skew</code>, <code id="stablereg_+3A_skew_h">skew_h</code>, <code id="stablereg_+3A_oskew">oskew</code>, <code id="stablereg_+3A_iskew">iskew</code></td>
<td>
<p>describe the regression model for the
skewness parameter of the fitted stable distribution, after transformation
by the link function <code>skew_g</code> (set to <code>log{(1 + [.])/(1 - [.])}</code>
by default). The inverse link function is denoted by <code>skew_h</code>. Again
these functions cannot contain unknown parameters. The same rules as above
apply when specifying the generalized regression model for the skewness
parameter.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_tail">tail</code>, <code id="stablereg_+3A_tail_h">tail_h</code>, <code id="stablereg_+3A_otail">otail</code>, <code id="stablereg_+3A_itail">itail</code></td>
<td>
<p>describe the regression model considered
for the tail parameter of the fitted stable distribution, after
transformation by the link function <code>tail_g</code> (set to <code>log{([.] -
1)/(2 - [.])}</code> by default. The inverse link function is denoted by
<code>tail_h</code>. Again these functions cannot contain unknown parameters). The
same rules as above apply when specifying the generalized regression model
for the tail parameter.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_noopt">noopt</code></td>
<td>
<p>When set to TRUE, it forces <code>oloc</code>, <code>odisp</code>,
<code>oskew</code> and <code>otail</code> to FALSE, whatever the user choice for these
last three arguments. It is especially useful when looking for appropriate
initial values for the regression model parameters, before undertaking the
optimization of the likelihood.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_weights">weights</code></td>
<td>
<p>Weight vector.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_exact">exact</code></td>
<td>
<p>If TRUE, fits the exact likelihood function for continuous data
by integration over intervals of observation, i.e. interval censoring.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_delta">delta</code></td>
<td>
<p>Scalar or vector giving the unit of measurement for each
response value, set to unity by default. For example, if a response is
measured to two decimals, <code>delta=0.01</code>. If the response is transformed,
this must be multiplied by the Jacobian.  For example, with a log
transformation, <code>delta=1/y</code>. (The <code>delta</code> values for the censored
response are ignored.) The transformation cannot contain unknown parameters.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_envir">envir</code></td>
<td>
<p>Environment in which model formulae are to be interpreted or a
data object of class, <code>repeated</code>, <code>tccov</code>, or <code>tvcov</code>; the
name of the response variable should be given in <code>y</code>. If <code>y</code> has
class <code>repeated</code>, it is used as the environment.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_integration">integration</code>, <code id="stablereg_+3A_eps">eps</code>, <code id="stablereg_+3A_up">up</code>, <code id="stablereg_+3A_npoint">npoint</code></td>
<td>
<p><code>integration</code> indicates which
algorithm must be used to evaluate the stable density when the likelihood is
computed with <code>exact</code> set to FALSE. See the man page on
<code>stable</code> for extra information.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_hessian">hessian</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_llik.output">llik.output</code></td>
<td>
<p>is TRUE when the likelihood has to be displayed at each
iteration of the optimization.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_print.level">print.level</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_ndigit">ndigit</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_steptol">steptol</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_gradtol">gradtol</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_fscale">fscale</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_typsize">typsize</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_stepmax">stepmax</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
<tr><td><code id="stablereg_+3A_iterlim">iterlim</code></td>
<td>
<p>Arguments controlling the optimization procedure <code><a href="stats.html#topic+nlm">nlm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>stable</code> is returned. The printed output
includes the -log-likelihood, the corresponding AIC, the maximum likelihood
estimates, standard errors, and correlations. It also include all the
relevant information calculated, including error codes.
</p>


<h3>Warning</h3>

<p>Because of the numerical integrations involved,
convergence can be very sensitive to the initial parameter values supplied
and to the settings of the arguments controlling <code><a href="stats.html#topic+nlm">nlm</a></code>. If nlm
feeds extreme parameter values in the tails of the distribution to the
likelihood function, the integration may hang for a long time.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert (Catholic University of Louvain, Belgium,
<a href="mailto:phlambert@stat.ucl.ac.be">phlambert@stat.ucl.ac.be</a>) and Jim Lindsey.
</p>


<h3>References</h3>

<p>Lambert, P. and Lindsey, J.K. (1999) Analysing financial returns
using regression models based on non-symmetric stable distributions. Applied
Statistics 48, 409-424.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+glm">glm</a></code>, <code>stable</code>
and <code>stable.mode</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Share return over a 50 day period (see reference above)
# shares
y &lt;- c(296,296,300,302,300,304,303,299,293,294,294,293,295,287,288,297,
305,307,307,304,303,304,304,309,309,309,307,306,304,300,296,301,298,
295,295,293,292,297,294,293,306,303,301,303,308,305,302,301,297,299)

# returns
ret &lt;- (y[2:50]-y[1:49])/y[1:49]
# hist(ret, breaks=seq(-0.035,0.045,0.01))

day &lt;- seq(0,0.48,by=0.01) # time measured in days/100
x &lt;- seq(1,length(ret))-1

# Classic stationary normal model tail=2
print(z1 &lt;- stablereg(y = ret, delta = 1/y[1:49],
	loc = ~1, disp= ~1, skew = ~1, tail = tail_g(1.9999999),
	iloc = 0, idisp = -3, iskew = 0, oskew = FALSE, otail = FALSE))

# Normal model (tail=2) with dispersion=disp_h(b0+b1*day)
print(z2 &lt;- stablereg(y = ret, delta = 1/y[1:49], loc = ~day,
	disp = ~1, skew = ~1, tail = tail_g(1.999999), iloc = c(0.003,0),
	idisp = -4.5, iskew = 0, oskew = FALSE, otail = FALSE))

# Stable model with loc(ation)=loc_h(b0+b1*day)
print(z3 &lt;- stablereg(y = ret, delta = 1/y[1:49],
	loc = ~day, disp = ~1, skew = ~1, tail = ~1,
	iloc = c(0.001,-0.004), idisp = -4.8, iskew = 0, itail = 0.6))

# Stable model with disp(ersion)=disp_h(b0+b1*day)
print(z4 &lt;- stablereg(y = ret, delta = 1/y[1:49],
	loc = ~1, disp = ~day, skew = ~1, tail = ~1,
	iloc = 0.003, idisp = c(-4.8,0), iskew = -0.03, itail = 1.6))

# Stable model with skew(ness)=skew_h(b0+b1*day)
# Evaluation at fixed parameter values (because noopt is set to TRUE)
print(z5 &lt;- stablereg(y = ret, delta = 1/y[1:49],
	loc = ~1, disp = ~1, skew = ~day, tail = ~1,
	iloc = 5.557e-04, idisp = -4.957, iskew = c(2.811,-2.158),
	itail = 1.57, noopt=TRUE))

# Stable model with tail=tail_h(b0+b1*day)
print(z6 &lt;- stablereg(y = ret, delta = 1/y[1:49], loc = ret ~ 1,
	disp = ~1, skew = ~1, tail = ~day, iloc = 0.002,
	idisp = -4.8, iskew = -2, itail = c(2.4,-4), hessian=FALSE))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
