<!DOCTYPE html><html lang="en"><head><title>Help for package Equalden.HD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Equalden.HD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Equalden.HD-package'><p>Package Equalden.HD</p></a></li>
<li><a href='#Equalden.test.HD'><p>A test for the equality of a high dimensional set of densities</p></a></li>
<li><a href='#Hedenfalk'><p>Hedenfalk data</p></a></li>
<li><a href='#Rat'><p>Rat data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Testing the Equality of a High Dimensional Set of Densities</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marta Cousido Rocha &lt;martacousido@uvigo.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The equality of a large number k of densities is tested by measuring the L2 distance between the corresponding kernel density estimators and the one based on the pooled sample. The test even works for sample sizes as small as 2.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-19 16:19:38 UTC; mcousido</td>
</tr>
<tr>
<td>Author:</td>
<td>Marta Cousido Rocha [aut, cre],
  José Carlos Soage González [ctr],
  Jacobo de Uña Álvarez [aut, ths],
  Jeffrey D. Hart [aut],
  Ivan Kojadinovic [cph],
  A. Patton [cph],
  C. Parmeter [cph],
  J. Racine [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-19 18:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Equalden.HD-package'>Package Equalden.HD</h2><span id='topic+Equalden.HD'></span><span id='topic+Equalden.HD-package'></span>

<h3>Description</h3>

<p>This package implements three different methods to test the null hypothesis that a large number k of
samples have a common density. The sample size can be as small as 2. These methods are particularly
well suited to the low sample size, high dimensional setting (n &lt;&lt; k). The first method, proposed by
Zhan and Hart (2012), was developed to test the null hypothesis when the samples are independent of
each other. The other tests, proposed by Cousido-Rocha et al. (2018), are adaptations of the test in Zhan
and Hart (2012) for the setting in which the samples are weakly dependent. The standarized version of
each test statistic and its p-value are computed among other things.
</p>


<h3>Details</h3>


<ul>
<li><p>Package: Equalden.HD
</p>
</li>
<li><p>Version: 1.2
</p>
</li>
<li><p>Maintainer: Marta Cousido Rocha <a href="mailto:martacousido@uvigo.es">martacousido@uvigo.es</a>
</p>
</li>
<li><p>License: GPL-2
</p>
</li></ul>



<h3>Value</h3>


<ul>
<li><p><a href="#topic+Equalden.test.HD">Equalden.test.HD</a>: Performs the k-sample test proposed in Zhan and Hart (2012) for the setting of low sample size, large
dimension and independent samples, and its adaptions to dependent samples proposed in Cousido-Rocha
et. al (2018).
</p>
</li></ul>



<h3>Acknowledgements</h3>

<p>This work has received financial support of the Call 2015 Grants for
PhD contracts for training of doctors of the Ministry of Economy and Competitiveness,
co-financed by the European Social Fund (Ref. BES-2015-074958).
The authors acknowledge support from  MTM2014-55966-P project, Ministry of Economy and
Competitiveness, and MTM2017-89422-P project, Ministry of Economy, Industry
and Competitiveness, State Research Agency, and Regional Development Fund, UE.
The authors also acknowledge the financial support provided by the SiDOR research group
through the grant Competitive Reference Group, 2016-2019 (ED431C 2016/040),
funded by the &ldquo;Consellería de Cultura, Educación e Ordenación Universitaria.
Xunta de Galicia&rdquo;. José Carlos Soage was supported by Red Tecnológica de
Matemática Industrial (Red TMATI), Cons. de Cultura, Educación e OU, Xunta de Galicia
(ED341D R2016/051) and by Grupos de Referencia Competitiva, Consolidación y
Estructuración de Unidades de Investigación Competitivas del SUG, Cons. de Cultura,
Educación e OU, Xunta de Galicia (GRC ED431C 2016/040).
</p>


<h3>Author(s)</h3>


<ul>
<li><p>Cousido Rocha, Marta.
</p>
</li>
<li><p>Soage González, José Carlos.
</p>
</li>
<li><p>de Uña-Álvarez, Jacobo.
</p>
</li>
<li><p>D. Hart, Jeffrey.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p>Cousido-Rocha, M., de Uña-Álvarez, J., and Hart, J.(2018). Testing equality of a large number of densities under mixing conditions. Preprint.
</p>
</li>
<li><p>Zhan, D., Hart, J. (2012). Testing equality of a large number of densities. Biometrika, 99, 1-17.
</p>
</li></ul>


<hr>
<h2 id='Equalden.test.HD'>A test for the equality of a high dimensional set of densities</h2><span id='topic+Equalden.test.HD'></span>

<h3>Description</h3>

<p>Performs the k-sample test proposed by Zhan and Hart (2012) for the low sample size, high dimensional
setting with independent samples, and its extensions for dependent samples proposed by Cousido-Rocha
et al. (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Equalden.test.HD(X, method = c("indep", "dep.boot", "dep.spect"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Equalden.test.HD_+3A_x">X</code></td>
<td>
<p>A matrix where each row is one of the k-samples.</p>
</td></tr>
<tr><td><code id="Equalden.test.HD_+3A_method">method</code></td>
<td>
<p>the k-sample test. By default the &quot;dep.spect&quot; method is computed. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function implements the k-sample test proposed by Zhan and Hart (2012), method=&quot;indep&quot;, and
its extensions for dependent data proposed by Cousido-Rocha et al. (2018), method=&quot;dep.boot&quot; and
&quot;dep.spect&quot;. The method proposed by Zhan and Hart (2012) serves to test the null hypothesis that the
k-samples have a common distribution. It is suitable when the k samples are independent and the number
of samples k is large, and it works for sample sizes as small as 2. The statistic in Zhan and Hart (2012)
is based on a comparison between the k sample-specific kernel density estimates and the kernel density
estimate computed from the pooled sample. An alternative expression of this statistic shows that it can
be interpreted as a difference between the intra-samples variability and the inter-samples variability.
This statistic is standardized using a variance estimator which is valid for independent samples. The asymptotic
normality (when k tends to infinity) of the standardized version of the statistic is used to compute the
corresponding p-value. Cousido-Rocha et al. (2018) proposed two corrections of the test of Zhan and
Hart (2012) for dependent samples. These tests standardize the statistic proposed in Zhan and Hart (2012)
by using variance estimators which are suitable when the samples are weakly dependent. The method
&quot;dep.boot&quot; implements the dependent multiplier bootstrap to estimate the variance, whereas the method
&quot;dep.spect&quot; uses a variance estimator based on the spectral analysis theory. Both tests perform similarly,
but the &quot;dep.spect&quot; test tends to be computationally more efficient than the &quot;dep.boot&quot; test. Cousido-
Rocha et al. (2018) showed through simulations that, for independent samples, the tests &quot;dep.boot&quot; and
&quot;dep.spect&quot; may be more powerful than the test in Zhan and Hart (2012) despite of being protected
against possible dependences.
On the other hand, the statistic can be written as a sum of k individual statistics, each of them
measures the difference between the intra-sample variability of the corresponding variable and the inter-
samples variability. Whether the null hypothesis is rejected, an exploratory analysis of such individual
statistics can help to guess which genes are not equally distributed.
</p>


<h3>Value</h3>

<p>A list containing the following components:
</p>
<table role = "presentation">
<tr><td><code>standardized statistic:</code></td>
<td>
<p>the value of the standardized statistic.</p>
</td></tr>
<tr><td><code>p.value:</code></td>
<td>
<p>the p-value for the test.</p>
</td></tr>
<tr><td><code>statistic:</code></td>
<td>
<p>the value of the statistic.</p>
</td></tr>
<tr><td><code>variance:</code></td>
<td>
<p>the value of the variance estimator.</p>
</td></tr>
<tr><td><code>m:</code></td>
<td>
<p>number of significant lags for the variance estimator if the method is &quot;dep.spect&quot; or &quot;dep.boot&quot;. Null if the method is &quot;indep&quot; since no correction for dependence is required in this case.</p>
</td></tr>
<tr><td><code>k:</code></td>
<td>
<p>number of samples or populations.</p>
</td></tr>
<tr><td><code>n:</code></td>
<td>
<p>sample size.</p>
</td></tr>
<tr><td><code>method:</code></td>
<td>
<p>a character string indicating what k-test was performed.</p>
</td></tr>
<tr><td><code>I.statistics:</code></td>
<td>
<p>the k individual statistics.</p>
</td></tr>
<tr><td><code>data.name:</code></td>
<td>
<p>a character string giving the name of the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<ul>
<li><p>Marta Cousido-Rocha
</p>
</li>
<li><p>José Carlos Soage González
</p>
</li>
<li><p>Jacobo de Uña-Álvarez
</p>
</li>
<li><p>D. Hart, Jeffrey.
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p>Cousido-Rocha, M., de Uña-Álvarez, J., and Hart, J.(2018). Testing equality of a large number of densities under mixing conditions. Preprint.
</p>
</li>
<li><p>Zhan, D., Hart, J. (2012). Testing equality of a large number of densities. Biometrika, 99, 1-17.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

n &lt;- 2
k &lt;- 100
set.seed(1234)
X &lt;- matrix(rnorm(n * k), ncol = 2)
res &lt;- Equalden.test.HD(X,  method = "indep")

res
### The statistic and the variance estimator
res$statistic
res$variance
### The number of samples and sample size
res$k
res$n

### Real data analysis. We test the null hypothesis that 1000 randomly selected genes
### measured in patients with BRCA2 mutations have a common distribution. We use the test
### proposed in Cousido-Rocha et al. (2018) since correlation among expression levels of
### different genes on the same individual is expected.
data(Hedenfalk)
X &lt;- Hedenfalk
k &lt;- dim(X)[1]
### We eliminate the additive patients effects by substracting to each column its sample mean.
BRCA2 &lt;- sweep(X[, 8:15], 2, apply(X[, 8:15], 2, mean))
set.seed (1234)
se&lt;-1000
ind &lt;- sample(1:k, se)
res1 &lt;- Equalden.test.HD(BRCA2[ind, ], method = "dep.boot")
res1
res2 &lt;- Equalden.test.HD(BRCA2[ind, ], method = "dep.spect")
res2
### The null hypothesis is rejected using both methods. Then we plot the individual statistics
### and highlight the 100 most extreme values.
cu &lt;- 100
I.statistics.sorted &lt;- sort(res1$I.statistics)
cv &lt;- I.statistics.sorted[se-cu+1]
ind2 &lt;- which(res1$I.statistics &gt;= cv)
plot(1:se, res1$I.statistics, xlim = c(0, se), ylim = c(min(res1$I.statistics),
                                                        max(res1$I.statistics)),
     xlab = "Genes", ylab = "statistic", main = "Individual statistics")
points(ind2, res1$I.statistics[ind2], col = "red")
### We zoom the plot in the following way since some individual statistics report extreme
### negative values in this data.
plot(1:se, res1$I.statistics, xlim = c(0, se), ylim = c(0, max(res1$I.statistics)),
     xlab = "Genes", ylab = "statistic", main = "Individual statistics")
points(ind2, res1$I.statistics[ind2], col = "red")

</code></pre>

<hr>
<h2 id='Hedenfalk'>Hedenfalk data</h2><span id='topic+Hedenfalk'></span>

<h3>Description</h3>

<p>These data come from the breast cancer gene expression study of Hedenfalk et al. (2001). The data set
consists on 3226 gene expression levels measured on 7 patients with breast tumors having BRCA1
mutations (columns 1-7) and on 8 patients with breast tumors having BRCA2 mutations (columns 8-15).
The rows correspond to the genes and the columns refer to the patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Hedenfalk)
</code></pre>


<h3>Format</h3>

<p>A matrix with 3226 rows corresponding to the measured genes and 15 columns corresponding to the
patients. The first 7 columns contain the measures for the patients with BRCA1 mutations and the
patients with BRCA2 mutations are located in the last 8 columns.
</p>


<h3>References</h3>

<p>Hedenfalk, I., Duggan, D., Chen, Y., Radmacher, M, Bitter, M., Simon, R., Meltzer, P., Guterson, B., Esteller, M., Kallioniemi, O., Wilfond, B., Borg, A., Trent, J., Raffeld, M., Yakhini, Z., BenDor, A., Dougherty, E., Kononen, J., Buberdorf, L., Fehrle, W., Pittaluga, S., Gruvberger, G., Loman, N., Johannsson, O., Olsson, H., and Sauter, G.(2001), Gene-Expression Profiles in Hereditary Breast Cancer. New England Journal of Medicine 344 (8), 539-548.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


data(Hedenfalk)
X &lt;- Hedenfalk
k &lt;- dim(X)[1]
### Estimated densities of logged gene expression levels for patients with BRCA1 mutations.
s &lt;- apply(X[, 1:7], 1, density)
### Plot of estimated densities of 6 randomly selected genes.
set.seed(375)
rs &lt;- sample(1:k, 6)
plot(s[[rs[1]]], main = "Kernel estimates for 6 randomly selected genes",
 xlab = "x", ylab = "density", xlim = c(-1, 4.3), ylim = c(0, 2))
for (i in 2:6){
  lines(s[[rs[i]]], col = i)
}

</code></pre>

<hr>
<h2 id='Rat'>Rat data</h2><span id='topic+Rat'></span>

<h3>Description</h3>

<p>A microarray data set with 8038 logged gene expression levels measured on 5 rats. All rats were
subjected to the same treatment. The rows correspond to the genes and the columns refer to the rats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Rat)
</code></pre>


<h3>Format</h3>

<p>A matrix with 8038 rows corresponding to the measured genes and 5 columns corresponding to the rats.
</p>


<h3>References</h3>

<p>Davidson, L.A., Nguyen, D.V., Hokanson, R.M., Callaway, E.S., Isett, R.B., Turner, N.D., Dougherty, E.R., Wang, N., Lupton, J.R., Carroll, R.J., and Chapkin, R.S. (2004). Chemopreventive n-3
polyunsaturated fatty acids reprogram genetic signatures during colon cancer initiation and progression in the rat. Cancer Research, 64, 6797-6804.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data(Rat)
X &lt;- Rat
k &lt;- dim(X)[1]
### Estimated densities of logged gene expression levels.
s &lt;- apply(X, 1, density)
### Plot of estimated densities of 6 randomly selected genes.
set.seed(375)
rs &lt;- sample(1:k, 6)
plot(s[[rs[1]]], main = "Kernel estimates for 6 randomly selected genes",
 xlab = "x", ylab = "density", xlim = c(-4, 2), ylim = c(0, 6))
for (i in 2:6){
  lines(s[[rs[i]]], col = i)
}

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
