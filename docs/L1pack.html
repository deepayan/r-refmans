<!DOCTYPE html><html><head><title>Help for package L1pack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {L1pack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confint.lad'><p>Confidence intervals from <code>lad</code> models</p></a></li>
<li><a href='#ereturns'><p>Excess returns for Martin Marietta and American Can companies</p></a></li>
<li><a href='#l1fit'><p>Minimum absolute residual (L1) regression</p></a></li>
<li><a href='#lad'><p>Least absolute deviations regression</p></a></li>
<li><a href='#lad.fit'><p>Fitter functions for least absolute deviation (LAD) regression</p></a></li>
<li><a href='#lad.fit-methods'><p>Fit a least absolute deviation (LAD) regression model</p></a></li>
<li><a href='#Laplace'><p>The symmetric Laplace distribution</p></a></li>
<li><a href='#LaplaceFit'><p>Estimation of mean and covariance using the multivariate Laplace distribution</p></a></li>
<li><a href='#mLaplace'><p>Multivariate Laplace distribution</p></a></li>
<li><a href='#simulate.lad'><p>Simulate responses from <code>lad</code> models</p></a></li>
<li><a href='#vcov.lad'><p>Calculate variance-covariance matrix from <code>lad</code> models</p></a></li>
<li><a href='#WH.Laplace'><p>Wilson-Hilferty transformation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Routines for L1 Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.41-245</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-23</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Felipe Osorio &lt;felipe.osorios@usm.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>L1 estimation for linear regression using Barrodale and Roberts' method
    &lt;<a href="https://doi.org/10.1145%2F355616.361024">doi:10.1145/355616.361024</a>&gt; and the EM algorithm &lt;<a href="https://doi.org/10.1023%2FA%3A1020759012226">doi:10.1023/A:1020759012226</a>&gt;.
    Estimation of mean and covariance matrix using the multivariate Laplace distribution,
    density, distribution function, quantile function and random number generation
    for univariate and multivariate Laplace distribution &lt;<a href="https://doi.org/10.1080%2F03610929808832115">doi:10.1080/03610929808832115</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0), fastmatrix</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>fastmatrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, grDevices, graphics</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://l1pack.mat.utfsm.cl/">http://l1pack.mat.utfsm.cl/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-23 15:34:23 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Felipe Osorio <a href="https://orcid.org/0000-0002-4675-5201"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Tymoteusz Wolodzko [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-23 16:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='confint.lad'>Confidence intervals from <code>lad</code> models</h2><span id='topic+confint.lad'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a fitted
model associated to a <code>lad</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lad'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.lad_+3A_object">object</code></td>
<td>
<p> a fitted model object.</p>
</td></tr>
<tr><td><code id="confint.lad_+3A_parm">parm</code></td>
<td>
<p> a specification of which parameters are to be given confidence intervals,
either a vector of numbers or a vector of names. If missing, all parameters are
considered.</p>
</td></tr>
<tr><td><code id="confint.lad_+3A_level">level</code></td>
<td>
<p> the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.lad_+3A_...">...</code></td>
<td>
<p> additional argument(s) for related methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>confint</code> is a generic function. Confidence intervals associated to <code>lad</code>
objects are asymptotic, and needs suitable <code><a href="stats.html#topic+coef">coef</a></code> and <code><a href="stats.html#topic+vcov">vcov</a></code>
methods to be available.
</p>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence limits for
each parameter. These will be labelled as <code>(1-level)/2</code> and <code>1 - (1-level)/2</code>
in % (by default 2.5% and 97.5%).
</p>


<h3>See Also</h3>

<p><code><a href="MASS.html#topic+confint">confint.glm</a></code> and
<code><a href="MASS.html#topic+confint">confint.nls</a></code> in package <a href="https://CRAN.R-project.org/package=MASS"><span class="pkg">MASS</span></a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm &lt;- lad(stack.loss ~ ., data = stackloss, method = "BR")
confint(fm) # based on asymptotic normality
</code></pre>

<hr>
<h2 id='ereturns'>Excess returns for Martin Marietta and American Can companies</h2><span id='topic+ereturns'></span>

<h3>Description</h3>

<p>Data from the Martin Marietta and American Can companies collected over a period 
of 5 years on a monthly basis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ereturns)</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 4 variables.
</p>

<dl>
<dt>Date</dt><dd><p> the month in which the observations were collected.</p>
</dd>
<dt>am.can</dt><dd><p> excess returns from the American Can company.</p>
</dd>
<dt>m.marietta</dt><dd><p> excess returns from the Martin Marietta company.</p>
</dd>
<dt>CRSP</dt><dd><p> an index for the excess rate returns for the New York stock exchange.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Butler, R.J., McDonald, J.B., Nelson, R.D., and White, S.B. (1990).
Robust and partially adaptive estimation of regression models.
<em>The Review of Economics and Statistics</em> <b>72</b>, 321-327.  
</p>

<hr>
<h2 id='l1fit'>Minimum absolute residual (L1) regression</h2><span id='topic+l1fit'></span>

<h3>Description</h3>

<p>Performs an L1 regression on a matrix of explanatory variables and a vector of responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l1fit(x, y, intercept = TRUE, tolerance = 1e-07, print.it = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l1fit_+3A_x">x</code></td>
<td>
<p> vector or matrix of explanatory variables. Each row corresponds to an
observation and each column to a variable. The number of rows of <code>x</code> should
equal the number of data values in <code>y</code>, and there should be fewer columns
than rows. Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="l1fit_+3A_y">y</code></td>
<td>
<p> numeric vector containing the response. Missing values are not allowed.</p>
</td></tr>
<tr><td><code id="l1fit_+3A_intercept">intercept</code></td>
<td>
<p> logical flag. If <code>TRUE</code>, an intercept term is included in
the regression model.</p>
</td></tr>
<tr><td><code id="l1fit_+3A_tolerance">tolerance</code></td>
<td>
<p> numerical value used to test for singularity in the regression.</p>
</td></tr>
<tr><td><code id="l1fit_+3A_print.it">print.it</code></td>
<td>
<p> logical flag. If <code>TRUE</code>, then warnings about non-unique solutions
and rank deficiency are given.</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The Barrodale-Roberts algorithm, which is a specialized linear programming
algorithm, is used.
</p>


<h3>Value</h3>

<p>list defining the regression (compare with function <code><a href="stats.html#topic+lsfit">lsfit</a></code>).
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> vector of coefficients.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> residuals from the fit.</p>
</td></tr>
<tr><td><code>message</code></td>
<td>
<p> character strings stating whether a non-unique solution is possible, 
or if the <code>x</code> matrix was found to be rank deficient.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Barrodale, I., Roberts, F.D.K. (1973).
An improved algorithm for discrete L1 linear approximations.
<em>SIAM Journal of Numerical Analysis</em> <b>10</b>, 839-848.
</p>
<p>Barrodale, I., Roberts, F.D.K. (1974).
Solution of an overdetermined system of equations in the L1 norm.
<em>Communications of the ACM</em> <b>17</b>, 319-320.
</p>
<p>Bloomfield, P., Steiger, W.L. (1983).
<em>Least Absolute Deviations: Theory, Applications, and Algorithms.</em>
Birkhauser, Boston, Mass.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l1fit(stack.x, stack.loss)
</code></pre>

<hr>
<h2 id='lad'>Least absolute deviations regression</h2><span id='topic+lad'></span>

<h3>Description</h3>

<p>This function is used to fit linear models considering Laplace errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lad(formula, data, subset, na.action, method = "BR", tol = 1e-7, maxiter = 200,
  x = FALSE, y = FALSE, contrasts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lad_+3A_formula">formula</code></td>
<td>
<p> an object of class <code>"formula"</code>: a symbolic description of
the model to be fitted.</p>
</td></tr>
<tr><td><code id="lad_+3A_data">data</code></td>
<td>
<p> an optional data frame containing the variables in the model. If
not found in <code>data</code>, the variables are taken from <code>environment(formula)</code>,
typically the environment from which <code>lad</code> is called.</p>
</td></tr>
<tr><td><code id="lad_+3A_subset">subset</code></td>
<td>
<p> an optional expression indicating the subset of the rows of
data that should be used in the fit.</p>
</td></tr>
<tr><td><code id="lad_+3A_na.action">na.action</code></td>
<td>
<p> a function that indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="lad_+3A_method">method</code></td>
<td>
<p> character string specifying the fitting method to be used; the options
are <code>"BR"</code> Barrodale and Roberts' method (the default) and <code>"EM"</code> for an EM
algorithm using IRLS.</p>
</td></tr>
<tr><td><code id="lad_+3A_tol">tol</code></td>
<td>
<p> the relative tolerance for the iterative algorithm. Default is <code>tol = 1e-7</code>.</p>
</td></tr>
<tr><td><code id="lad_+3A_maxiter">maxiter</code></td>
<td>
<p> The maximum number of iterations for the <code>EM</code> method. Default to 200.</p>
</td></tr>
<tr><td><code id="lad_+3A_x">x</code>, <code id="lad_+3A_y">y</code></td>
<td>
<p> logicals. If <code>TRUE</code> the corresponding components of the fit (the model matrix, 
the response) are returned.</p>
</td></tr>
<tr><td><code id="lad_+3A_contrasts">contrasts</code></td>
<td>
<p> an optional list. See the <code>contrasts.arg</code> of <code>model.matrix.default</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>lad</code> representing the linear model fit. Generic
function <code>print</code>, show the results of the fit.
</p>
<p>The functions <code>print</code> and <code>summary</code> are used to obtain and print a summary
of the results. The generic accessor functions <code>coefficients</code>, <code>fitted.values</code>
and <code>residuals</code> extract various useful features of the value returned by <code>lad</code>.
</p>


<h3>Author(s)</h3>

<p>The design was inspired by the R function <code><a href="stats.html#topic+lm">lm</a></code>.</p>


<h3>References</h3>

<p>Barrodale, I., Roberts, F.D.K. (1974).
Solution of an overdetermined system of equations in the L1 norm.
<em>Communications of the ACM</em> <b>17</b>, 319-320.
</p>
<p>Phillips, R.F. (2002).
Least absolute deviations estimation via the EM algorithm.
<em>Statistics and Computing</em> <b>12</b>, 281-285.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm &lt;- lad(stack.loss ~ ., data = stackloss, method = "BR")
summary(fm)
</code></pre>

<hr>
<h2 id='lad.fit'>Fitter functions for least absolute deviation (LAD) regression</h2><span id='topic+lad.fit'></span>

<h3>Description</h3>

<p>This function is a <em>switcher</em> among various numerical fitting functions
(<code><a href="#topic+lad.fit.BR">lad.fit.BR</a></code>, and <code><a href="#topic+lad.fit.EM">lad.fit.EM</a></code>). The argument <code>method</code>
does the switching: <code>"BR"</code> for <code><a href="#topic+lad.fit.BR">lad.fit.BR</a></code>, etc. This should
usually <em>not</em> be used directly unless by experienced users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lad.fit(x, y, method = "BR", tol = 1e-7, maxiter = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lad.fit_+3A_x">x</code></td>
<td>
<p> design matrix of dimension <code class="reqn">n\times p</code>.</p>
</td></tr>
<tr><td><code id="lad.fit_+3A_y">y</code></td>
<td>
<p> vector of observations of length <code class="reqn">n</code>.</p>
</td></tr>
<tr><td><code id="lad.fit_+3A_method">method</code></td>
<td>
<p> currently, methods <code>"BR"</code> (default), and <code>"EM"</code> are supported.</p>
</td></tr>
<tr><td><code id="lad.fit_+3A_tol">tol</code></td>
<td>
<p> the relative tolerance for the iterative algorithm. Default is <code>tol = 1e-7</code>.</p>
</td></tr>
<tr><td><code id="lad.fit_+3A_maxiter">maxiter</code></td>
<td>
<p> The maximum number of iterations for the <code>EM</code> method. Default to 200.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code><a href="base.html#topic+list">list</a></code> with components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a named vector of coefficients.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>
<p> final scale estimate of the random error.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p> the residuals, that is response minus fitted values.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p> the fitted values.</p>
</td></tr>
<tr><td><code>SAD</code></td>
<td>
<p> the sum of absolute deviations.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p> estimated <code>EM</code> weights.</p>
</td></tr>
<tr><td><code>basic</code></td>
<td>
<p> basic observations, that is observations with zero residuals.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p> the log-likelihood at convergence.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+lad.fit.BR">lad.fit.BR</a></code>, <code><a href="#topic+lad.fit.EM">lad.fit.EM</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(1, stack.x)
fm &lt;- lad.fit(x, stack.loss, method = "BR")
fm
</code></pre>

<hr>
<h2 id='lad.fit-methods'>Fit a least absolute deviation (LAD) regression model</h2><span id='topic+lad.fit.BR'></span><span id='topic+lad.fit.EM'></span>

<h3>Description</h3>

<p>Fits a linear model using LAD methods, returning the bare minimum computations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lad.fit.BR(x, y, tol = 1e-7)
lad.fit.EM(x, y, tol = 1e-7, maxiter = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lad.fit-methods_+3A_x">x</code>, <code id="lad.fit-methods_+3A_y">y</code></td>
<td>
<p> numeric vectors or matrices for the predictors and the response in
a linear model. Typically, but not necessarily, <code>x</code> will be constructed by
one of the fitting functions.</p>
</td></tr>
<tr><td><code id="lad.fit-methods_+3A_tol">tol</code></td>
<td>
<p> the relative tolerance for the iterative algorithm. Default is <code>tol = 1e-7</code>.</p>
</td></tr>
<tr><td><code id="lad.fit-methods_+3A_maxiter">maxiter</code></td>
<td>
<p> The maximum number of iterations for the <code>EM</code> method. Default to 200.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The bare bones of a <code>lad</code> object: the coefficients, residuals, fitted values,
and some information used by <code>summary.lad</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lad">lad</a></code>, <code><a href="#topic+lad.fit">lad.fit</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- cbind(1, stack.x)
z &lt;- lad.fit.BR(x, stack.loss)
z
</code></pre>

<hr>
<h2 id='Laplace'>The symmetric Laplace distribution</h2><span id='topic+Laplace'></span><span id='topic+dlaplace'></span><span id='topic+plaplace'></span><span id='topic+qlaplace'></span><span id='topic+rlaplace'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation for the
Laplace distribution with location parameter <code>location</code> and scale parameter
<code>scale</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlaplace(x, location = 0, scale = 1, log = FALSE)
plaplace(q, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)
qlaplace(p, location = 0, scale = 1, lower.tail = TRUE, log.p = FALSE)
rlaplace(n, location = 0, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Laplace_+3A_x">x</code>, <code id="Laplace_+3A_q">q</code></td>
<td>
<p> vector of quantiles.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_p">p</code></td>
<td>
<p> vector of probabilities.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_n">n</code></td>
<td>
<p> number of observations.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_location">location</code></td>
<td>
<p> location parameter <code class="reqn">\mu</code>, which is the mean.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_scale">scale</code></td>
<td>
<p> scale parameter <code class="reqn">\phi</code>. Scale must be positive.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_log">log</code>, <code id="Laplace_+3A_log.p">log.p</code></td>
<td>
<p> logical; if TRUE, probabilities <code class="reqn">p</code> are given as <code class="reqn">\log(p)</code>.</p>
</td></tr>
<tr><td><code id="Laplace_+3A_lower.tail">lower.tail</code></td>
<td>
<p> logical; if TRUE (default), probabilities are <code class="reqn">P(X \le x)</code>,
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>location</code> or <code>scale</code> are not specified, they assume the default
values of <code>0</code> and <code>1</code> respectively.
</p>
<p>The Laplace distribution with location <code class="reqn">\mu</code> and scale <code class="reqn">\phi</code> has density
</p>
<p style="text-align: center;"><code class="reqn">
    f(x) =
    \frac{1}{\sqrt{2}\phi} \exp(-\sqrt{2}|x-\mu|/\phi),</code>
</p>

<p>where <code class="reqn">-\infty &lt; y &lt; \infty</code>, <code class="reqn">-\infty &lt; \mu &lt; \infty</code> and <code class="reqn">\phi &gt; 0</code>. 
The mean is <code class="reqn">\mu</code> and the variance is <code class="reqn">\phi^2</code>.
</p>
<p>The cumulative distribution function, assumes the form
</p>
<p style="text-align: center;"><code class="reqn"> 
    F(x) = 
    \left\{\begin{array}{ll}
    \frac{1}{2} \exp(\sqrt{2}(x - \mu)/\phi) &amp; x &lt; \mu, \\
    1 - \frac{1}{2} \exp(-\sqrt{2}(x - \mu)/\phi) &amp; x \geq \mu.
    \end{array}\right.</code>
</p>

<p>The quantile function, is given by 
</p>
<p style="text-align: center;"><code class="reqn"> 
    F^{-1}(p) = \left\{\begin{array}{ll}
    \mu + \frac{\phi}{\sqrt{2}} \log(2p) &amp; p &lt; 0.5, \\
    \mu - \frac{\phi}{\sqrt{2}} \log(2(1-p)) &amp; p \geq 0.5.
    \end{array}\right.</code>
</p>



<h3>Value</h3>

<p><code>dlaplace</code>, <code>plaplace</code>, and <code>qlaplace</code> are respectively the density,
distribution function and quantile function of the Laplace distribution. <code>rlaplace</code>
generates random deviates drawn from the Laplace distribution, the length of the result 
is determined by <code>n</code>.
</p>


<h3>Author(s)</h3>

<p>Felipe Osorio and Tymoteusz Wolodzko</p>


<h3>References</h3>

<p>Kotz, S., Kozubowski, T.J., Podgorski, K. (2001).
<em>The Laplace Distributions and Generalizations</em>.
Birkhauser, Boston.
</p>
<p>Krishnamoorthy, K. (2006). 
<em>Handbook of Statistical Distributions with Applications</em>, 2nd Ed. 
Chapman &amp; Hall, Boca Raton.
</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions and <code><a href="#topic+rmLaplace">rmLaplace</a></code>
for the random generation from the multivariate Laplace distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rlaplace(1000)
## QQ-plot for Laplace data against true theoretical distribution:
qqplot(qlaplace(ppoints(1000)), x, main = "Laplace QQ-plot",
  xlab = "Theoretical quantiles", ylab = "Sample quantiles")
abline(c(0,1), col = "red", lwd = 2)
</code></pre>

<hr>
<h2 id='LaplaceFit'>Estimation of mean and covariance using the multivariate Laplace distribution</h2><span id='topic+LaplaceFit'></span>

<h3>Description</h3>

<p>Estimates the mean vector and covariance matrix assuming the data came from a multivariate
Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LaplaceFit(x, data, subset, na.action, tol = 1e-6, maxiter = 200)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LaplaceFit_+3A_x">x</code></td>
<td>
<p>  a formula or a numeric matrix or an object that can be coerced to a numeric matrix.</p>
</td></tr>
<tr><td><code id="LaplaceFit_+3A_data">data</code></td>
<td>
<p>  an optional data frame (or similar: see <code><a href="stats.html#topic+model.frame">model.frame</a></code>), used only if
<code>x</code> is a formula. By default the variables are taken from <code>environment(formula)</code>.</p>
</td></tr>
<tr><td><code id="LaplaceFit_+3A_subset">subset</code></td>
<td>
<p> an optional expression indicating the subset of the rows of
data that should be used in the fitting process.</p>
</td></tr>
<tr><td><code id="LaplaceFit_+3A_na.action">na.action</code></td>
<td>
<p> a function that indicates what should happen when the data contain NAs.</p>
</td></tr>
<tr><td><code id="LaplaceFit_+3A_tol">tol</code></td>
<td>
<p> the relative tolerance in the iterative algorithm.</p>
</td></tr>
<tr><td><code id="LaplaceFit_+3A_maxiter">maxiter</code></td>
<td>
<p> maximum number of iterations. The default is 200.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with class <code>'LaplaceFit'</code> containing the following components:
</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>  a list containing an image of the <code>LaplaceFit</code> call that produced the object.</p>
</td></tr>
<tr><td><code>center</code></td>
<td>
<p>  final estimate of the location vector.</p>
</td></tr>
<tr><td><code>Scatter</code></td>
<td>
<p>  final estimate of the scale matrix.</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>  the log-likelihood at convergence.</p>
</td></tr>
<tr><td><code>numIter</code></td>
<td>
<p>  the number of iterations used in the iterative algorithm.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>  estimated weights corresponding to the Laplace distribution.</p>
</td></tr>
<tr><td><code>distances</code></td>
<td>
<p>  estimated squared Mahalanobis distances.</p>
</td></tr>
</table>
<p>Generic function <code>print</code> show the results of the fit.
</p>


<h3>References</h3>

<p>Yavuz, F.G., Arslan, O. (2018).
Linear mixed model with Laplace distribution (LLMM).
<em>Statistical Papers</em> <b>59</b>, 271-289.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cov">cov</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- LaplaceFit(stack.x)
fit

# covariance matrix
p &lt;- fit$dims[2]
Sigma &lt;- (4 * (p + 1)) * fit$Scatter
Sigma
</code></pre>

<hr>
<h2 id='mLaplace'>Multivariate Laplace distribution</h2><span id='topic+mLaplace'></span><span id='topic+dmLaplace'></span><span id='topic+rmLaplace'></span>

<h3>Description</h3>

<p>These functions provide the density and random number generation from the multivariate 
Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmLaplace(x, center = rep(0, nrow(Scatter)), Scatter = diag(length(center)), log = FALSE)
rmLaplace(n = 1, center = rep(0, nrow(Scatter)), Scatter = diag(length(center)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mLaplace_+3A_x">x</code></td>
<td>
<p> vector or matrix of data. </p>
</td></tr>
<tr><td><code id="mLaplace_+3A_n">n</code></td>
<td>
<p> the number of samples requested.</p>
</td></tr>
<tr><td><code id="mLaplace_+3A_center">center</code></td>
<td>
<p> a <code class="reqn">k\times 1</code> vector giving the locations.</p>
</td></tr>
<tr><td><code id="mLaplace_+3A_scatter">Scatter</code></td>
<td>
<p> a <code class="reqn">k \times k</code> positive-definite dispersion matrix.</p>
</td></tr>
<tr><td><code id="mLaplace_+3A_log">log</code></td>
<td>
<p> logical; if TRUE, the logarithm of the density function is returned.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate Laplace distribution is a multidimensional extension of the univariate 
symmetric Laplace distribution. There are multiple forms of the multivariate Laplace 
distribution. Here, a particular case of the multivarite power exponential distribution 
introduced by Gomez et al. (1998) is considered.
</p>
<p>The multivariate Laplace distribution with location <code class="reqn">\bold{\mu}</code> = <code>center</code> 
and <code class="reqn">\bold{\Sigma}</code> = <code>Scatter</code> has density
</p>
<p style="text-align: center;"><code class="reqn">
    f(\bold{x}) =
    \frac{\Gamma(k/2)}{\pi^{k/2}\Gamma(k)2^{k+1}}|\bold{\Sigma}|^{-1/2}
    \exp\left\{-\frac{1}{2}[(\bold{x} - \bold{\mu})^T \bold{\Sigma}^{-1} (\bold{x} 
    - \bold{\mu})]^{1/2}\right\}.
  </code>
</p>

<p>The function <code>rmLaplace</code> is an interface to C routines, which make calls to
subroutines from LAPACK. The matrix decomposition is internally done using
the Cholesky decomposition. If <code>Scatter</code> is not non-negative definite then
there will be a warning message.
</p>


<h3>Value</h3>

<p>If <code>x</code> is a matrix with <code class="reqn">n</code> rows, then <code>dmLaplace</code> returns a 
<code class="reqn">n\times 1</code> vector considering each row of <code>x</code> as a copy from 
the multivariate Laplace.
</p>
<p>If <code>n = 1</code>, then <code>rmLaplace</code> returns a vector of the same length as 
<code>center</code>, otherwise a matrix of <code>n</code> rows of random vectors.
</p>


<h3>References</h3>

<p>Fang, K.T., Kotz, S., Ng, K.W. (1990).
<em>Symmetric Multivariate and Related Distributions</em>.
Chapman &amp; Hall, London.
</p>
<p>Gomez, E., Gomez-Villegas, M.A., Marin, J.M. (1998).
A multivariate generalization of the power exponential family of distributions.
<em>Communications in Statistics - Theory and Methods</em> <b>27</b>, 589-600.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># dispersion parameters
Scatter &lt;- matrix(c(1,.5,.5,1), ncol = 2)
Scatter

# generate the sample
y &lt;- rmLaplace(n = 2000, Scatter = Scatter)

# scatterplot of a random bivariate Laplace sample with center
# vector zero and scale matrix 'Scatter'
par(pty = "s")
plot(y, xlab = "", ylab = "")
title("bivariate Laplace sample", font.main = 1)
</code></pre>

<hr>
<h2 id='simulate.lad'>Simulate responses from <code>lad</code> models</h2><span id='topic+simulate.lad'></span>

<h3>Description</h3>

<p>Simulate one or more responses from the distribution corresponding to a
fitted <code>lad</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lad'
simulate(object, nsim = 1, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.lad_+3A_object">object</code></td>
<td>
<p> an object representing a fitted model.</p>
</td></tr>
<tr><td><code id="simulate.lad_+3A_nsim">nsim</code></td>
<td>
<p> number of response vectors to simulate. Defaults to 1.</p>
</td></tr>
<tr><td><code id="simulate.lad_+3A_seed">seed</code></td>
<td>
<p> an object specifying if and how the random number generator should
be initialized (&lsquo;seeded&rsquo;). For the &quot;lad&quot; method, either <code>NULL</code>
or an integer that will be used in a call to <code>set.seed</code> before simulating
the response vectors. If set, the value is saved as the <code>"seed"</code> attribute
of the returned value. The default, <code>NULL</code> will not change the random
generator state, and return <code><a href="base.html#topic+.Random.seed">.Random.seed</a></code> as the <code>"seed"</code>
attribute, see &lsquo;Value&rsquo;.
</p>
</td></tr>
<tr><td><code id="simulate.lad_+3A_...">...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For the <code>"lad"</code> method, the result is a data frame with an attribute
<code>"seed"</code>. If argument <code>seed</code> is <code>NULL</code>, the attribute is the
value of <code><a href="base.html#topic+.Random.seed">.Random.seed</a></code> before the simulation was started.
</p>


<h3>Author(s)</h3>

<p>Tymoteusz Wolodzko and Felipe Osorio</p>


<h3>Examples</h3>

<pre><code class='language-R'>fm &lt;- lad(stack.loss ~ ., data = stackloss)
sm &lt;- simulate(fm, nsim = 4)
</code></pre>

<hr>
<h2 id='vcov.lad'>Calculate variance-covariance matrix from <code>lad</code> models</h2><span id='topic+vcov.lad'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of a fitted model
for <code>lad</code> objects. The &ldquo;main&rdquo; parameters of model correspond to those
returned by <code><a href="stats.html#topic+coef">coef</a></code>, and typically do not contain the nuisance scale
parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lad'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.lad_+3A_object">object</code></td>
<td>
<p> an object representing a fitted model.</p>
</td></tr>
<tr><td><code id="vcov.lad_+3A_...">...</code></td>
<td>
<p> additional arguments for method functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter estimates in the
linear regression model. This should have row and column names corresponding
to the parameter names given by the <code><a href="stats.html#topic+coef">coef</a></code> method.
</p>

<hr>
<h2 id='WH.Laplace'>Wilson-Hilferty transformation</h2><span id='topic+WH.Laplace'></span>

<h3>Description</h3>

<p>Returns the Wilson-Hilferty transformation for multivariate Laplace deviates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WH.Laplace(x, center, Scatter)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WH.Laplace_+3A_x">x</code></td>
<td>
<p> object of class <code>'LaplaceFit'</code> from which is extracted the estimated Mahalanobis distances of the fitted model.
Also <code>x</code> can be a vector or matrix of data with, say, <code class="reqn">p</code> columns.</p>
</td></tr>
<tr><td><code id="WH.Laplace_+3A_center">center</code></td>
<td>
<p> mean vector of the distribution or data vector of length <code class="reqn">p</code>. Not required if <code>x</code> have class <code>'LaplaceFit'</code>.</p>
</td></tr>
<tr><td><code id="WH.Laplace_+3A_scatter">Scatter</code></td>
<td>
<p> Scatter matrix (<code class="reqn">p</code> by <code class="reqn">p</code>) of the distribution. Not required if <code>x</code> have class <code>'LaplaceFit'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">T = D/(2p)</code> be a Gamma distributed random variable, where <code class="reqn">D^2</code> 
denotes the squared Mahalanobis distance defined as
</p>
<p style="text-align: center;"><code class="reqn">D^2 = (\bold{x} - \bold{\mu})^T \bold{\Sigma}^{-1} (\bold{x} - \bold{\mu}).</code>
</p>

<p>Thus, the Wilson-Hilferty transformation is given by
</p>
<p style="text-align: center;"><code class="reqn">z = \frac{T^{1/3} - (1 - \frac{1}{9p})}{(\frac{1}{9p})^{1/2}}%
  </code>
</p>

<p>and <code class="reqn">z</code> is approximately distributed as a standard normal distribution. This is useful, 
for instance, in the construction of QQ-plots.
</p>


<h3>References</h3>

<p>Osorio, F., Galea, M., Henriquez, C., Arellano-Valle, R. (2023).
Addressing non-normality in multivariate analysis using the <em>t</em>-distribution. 
<em>AStA Advances in Statistical Analysis</em> <b>107</b>, 785-813.
</p>
<p>Terrell, G.R. (2003).
The Wilson-Hilferty transformation is locally saddlepoint.
<em>Biometrika</em> <b>90</b>, 445-453.
</p>
<p>Wilson, E.B., Hilferty, M.M. (1931).
The distribution of chi-square.
<em>Proceedings of the National Academy of Sciences of the United States of America</em> <b>17</b>, 684-688.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Scatter &lt;- matrix(c(1,.5,.5,1), ncol = 2)
Scatter

# generate the sample
y &lt;- rmLaplace(n = 500, Scatter = Scatter)
fit &lt;- LaplaceFit(y)
z &lt;- WH.Laplace(fit)
par(pty = "s")
qqnorm(z, main = "Transformed distances QQ-plot")
abline(c(0,1), col = "red", lwd = 2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
