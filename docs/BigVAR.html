<!DOCTYPE html><html lang="en"><head><title>Help for package BigVAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BigVAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#A'><p>Generator for Simulated Multivariate Time Series</p></a></li>
<li><a href='#BigVAR'><p>Dimension Reduction Methods for Multivariate Time Series.</p></a></li>
<li><a href='#BigVAR-class'><p>BigVAR Object Class</p></a></li>
<li><a href='#BigVAR.est'><p>BigVAR Estimation</p></a></li>
<li><a href='#BigVAR.fit'><p>Simple function to fit BigVAR model with fixed penalty parameter</p></a></li>
<li><a href='#BigVAR.intermediate'><p>BigVAR.intermediate</p>
This class contains the in-sample results for cv.BigVAR</a></li>
<li><a href='#BigVAR.results'><p>BigVAR.results</p>
This class contains the results from cv.BigVAR.</a></li>
<li><a href='#coef'><p>Default coef method BigVAR-results, returns the last coefficient matrix from the evaluation period</p></a></li>
<li><a href='#constructModel'><p>Construct an object of class BigVAR</p></a></li>
<li><a href='#cv.BigVAR'><p>Cross Validation for BigVAR</p></a></li>
<li><a href='#MultVarSim'><p>Simulate a VAR</p></a></li>
<li><a href='#plot'><p>Plot an object of class BigVAR.results</p></a></li>
<li><a href='#plot.BigVAR'><p>Plot a BigVAR object</p></a></li>
<li><a href='#predict'><p>Forecast using a BigVAR.results object</p></a></li>
<li><a href='#PredictVARX'><p>One-step ahead predictions for VARX models</p></a></li>
<li><a href='#show'><p>Default show method for an object of class BigVAR.results</p></a></li>
<li><a href='#show.BigVAR'><p>Default show method for an object of class BigVAR</p></a></li>
<li><a href='#SparsityPlot.BigVAR.results'><p>Sparsity Plot of a BigVAR.results object</p></a></li>
<li><a href='#VarptoVar1MC'><p>Converts a VAR coefficient matrix of order p to multiple companion form</p></a></li>
<li><a href='#VARXFit'><p>Fit a VAR or VARX model by least squares</p></a></li>
<li><a href='#VARXForecastEval'><p>Evaluate forecasts from a VAR or VARX with lag orders selected by AIC/BIC</p></a></li>
<li><a href='#VARXLagCons'><p>Construct a VAR or VARX lag matrix</p></a></li>
<li><a href='#Y'><p>Simulated Multivariate Time Series</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Dimension Reduction Methods for Multivariate Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Will Nicholson &lt;wbn8@cornell.edu&gt;</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-09</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates VAR and VARX models with Structured Penalties using the methods developed by Nicholson et al (2017)&lt;<a href="https://doi.org/10.1016%2Fj.ijforecast.2017.01.003">doi:10.1016/j.ijforecast.2017.01.003</a>&gt; and Nicholson et al (2020) &lt;<a href="https://doi.org/10.48550%2FarXiv.1412.5250">doi:10.48550/arXiv.1412.5250</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), methods, lattice</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, zoo, Rcpp, stats, utils, grDevices, graphics, abind</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppEigen</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wbnicholson/BigVAR">https://github.com/wbnicholson/BigVAR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wbnicholson/BigVAR/issues">https://github.com/wbnicholson/BigVAR/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, gridExtra, expm, MCS, quantmod, codetools</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-09 13:00:27 UTC; will</td>
</tr>
<tr>
<td>Author:</td>
<td>Will Nicholson [cre, aut],
  David Matteson [aut],
  Jacob Bien [aut],
  Ines Wilms [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-09 14:43:19 UTC</td>
</tr>
</table>
<hr>
<h2 id='A'>Generator for Simulated Multivariate Time Series</h2><span id='topic+A'></span>

<h3>Description</h3>

<p>Coefficient matrix for a stationary simulated multivariate time series
</p>


<h3>Details</h3>

<p>Example generator matrix adapted from Table 3.2 of Gredenhoff and Karlsson (1997)
</p>


<h3>Author(s)</h3>

<p>Will Nicholson
</p>


<h3>References</h3>

<p>Gredenhoff, Mikael, and Sune Karlsson. &quot;Lag-length selection in VAR-models using equal and unequal lag-length procedures.&quot; Computational Statistics 14.2 (1999): 171-187.
</p>

<hr>
<h2 id='BigVAR'>Dimension Reduction Methods for Multivariate Time Series.</h2><span id='topic+BigVAR'></span>

<h3>Description</h3>

<p>BigVAR implements the HLAG and VARX-L frameworks which allow for the estimation of vector autoregressions and vector autoregressions with exogenous variables using structured convex penalties.  This package originated as a 2014 Google &quot;Summer of Code&quot; Project.  The development version of this package is hosted on github: <a href="https://github.com/wbnicholson/BigVAR">https://github.com/wbnicholson/BigVAR</a>.
</p>


<h3>Details</h3>

<p>To use the facilities of this package, starting with an <code class="reqn">T \times k+m</code> multivariate time series (in which T denotes the length of the series, k the number of endogenous or &quot;model&quot;) and run <code><a href="#topic+constructModel">constructModel</a></code> to create an object of class <code><a href="#topic+BigVAR">BigVAR</a></code>.  <code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code> creates an object of class <code><a href="#topic+BigVAR.results">BigVAR.results</a></code>, which chooses an optimal penalty parameter based on minimizing h-step ahead forecasts on a specified cross-validation period over a grid of values as well as comparisons against AIC, BIC, unconditional mean, and a random walk.  There are plot functions for both BigVAR (<code><a href="#topic+plot.BigVAR">plot.BigVAR</a></code>) and BigVAR.results (<code><a href="#topic+plot">plot</a></code>) as well as a predict function for BigVAR.results (<code><a href="#topic+predict">predict</a></code>).
</p>


<h3>Author(s)</h3>

<p>Will Nicholson <a href="mailto:wbn8@cornell.edu">wbn8@cornell.edu</a>,
</p>


<h3>References</h3>

<p>Lutkepohl &quot;New Introduction to Multivariate Time Series&quot;,
Banbura, Marta, Domenico Giannone, and Lucrezia Reichlin. 'Large Bayesian vector auto regressions.' Journal of Applied Econometrics 25.1 (2010): 71-92.
Breheny P, Huang J (2011). “Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection.” Annals of Applied Statistics, 5(1), 232–253.
Nicholson, William, I. Wilms, J. Bien, and D. S. Matteson. High dimensional forecasting via interpretable vector autoregression. Journal of Machine Learning Research, 21(166):1–52, 2020.
William B. Nicholson, David S. Matteson, Jacob Bien,VARX-L: Structured regularization for large vector autoregressions with exogenous variables, International Journal of Forecasting, Volume 33, Issue 3, 2017, Pages 627-651,
William B Nicholson, David S. Matteson, and Jacob Bien (2016), 'BigVAR: Tools for Modeling Sparse High-Dimensional Multivariate Time Series' arxiv:1702.07094
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>, <code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>, <code><a href="#topic+BigVAR.results">BigVAR.results</a></code>, <code><a href="#topic+plot">plot</a></code>, <code><a href="#topic+predict">predict</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit a Basic VAR-L(3,4) on simulated data
data(Y)
T1=floor(nrow(Y)/3)
T2=floor(2*nrow(Y)/3)
m1=constructModel(Y,p=4,struct="Basic",gran=c(50,10),verbose=FALSE,T1=T1,T2=T2,IC=FALSE)
plot(m1)
results=cv.BigVAR(m1)
plot(results)
predict(results,n.ahead=1)
</code></pre>

<hr>
<h2 id='BigVAR-class'>BigVAR Object Class</h2><span id='topic+BigVAR-class'></span>

<h3>Description</h3>

<p>An object class to be used with cv.BigVAR
</p>


<h3>Details</h3>

<p>To construct an object of class BigVAR, use the function <code><a href="#topic+constructModel">constructModel</a></code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>Data</code></dt><dd><p>a <code class="reqn">T \times k</code> multivariate time series</p>
</dd>
<dt><code>model_data</code></dt><dd><p>processed time series and lag matrix</p>
</dd>
<dt><code>lagmax</code></dt><dd><p>Maximal lag order for modeled series</p>
</dd>
<dt><code>intercept</code></dt><dd><p>Indicator as to whether an intercept should be included</p>
</dd>
<dt><code>Structure</code></dt><dd><p>Penalty Structure</p>
</dd>
<dt><code>Relaxed</code></dt><dd><p>Indicator for relaxed VAR</p>
</dd>
<dt><code>Granularity</code></dt><dd><p>Granularity of penalty grid</p>
</dd>
<dt><code>horizon</code></dt><dd><p>Desired Forecast Horizon</p>
</dd>
<dt><code>crossval</code></dt><dd><p>Cross-Validation Procedure</p>
</dd>
<dt><code>Minnesota</code></dt><dd><p>Minnesota Prior Indicator</p>
</dd>
<dt><code>verbose</code></dt><dd><p>Indicator for Verbose output</p>
</dd>
<dt><code>dates</code></dt><dd><p>dates extracted from an xts object</p>
</dd>
<dt><code>ic</code></dt><dd><p>Indicator for including AIC and BIC benchmarks</p>
</dd>
<dt><code>VARX</code></dt><dd><p>VARX Model Specifications</p>
</dd>
<dt><code>VARXI</code></dt><dd><p>VARX Indicator</p>
</dd>
<dt><code>T1</code></dt><dd><p>Index of time series in which to start cross validation</p>
</dd>
<dt><code>T2</code></dt><dd><p>Index of times series in which to start forecast evaluation</p>
</dd>
<dt><code>ONESE</code></dt><dd><p>Indicator for 'One Standard Error Heuristic'</p>
</dd>
<dt><code>ownlambdas</code></dt><dd><p>Indicator for user-supplied lambdas</p>
</dd>
<dt><code>tf</code></dt><dd><p>Indicator for transfer function</p>
</dd>
<dt><code>alpha</code></dt><dd><p>Grid of candidate alpha values (applies only to Sparse VARX-L and Elastic Net models)</p>
</dd>
<dt><code>recursive</code></dt><dd><p>Indicator as to whether recursive multi-step forecasts are used (applies only to multiple horizon VAR models)</p>
</dd>
<dt><code>constvec</code></dt><dd><p>vector indicating variables to shrink toward a random walk instead of toward zero (valid only if Minnesota is <code>TRUE</code>)</p>
</dd>
<dt><code>tol</code></dt><dd><p>optimization tolerance</p>
</dd>
<dt><code>window.size</code></dt><dd><p>size of rolling window.  If set to NULL an expanding window will be used.</p>
</dd>
<dt><code>separate_lambdas</code></dt><dd><p>indicator to use separate penalty parameter for each time series (default <code>FALSE</code>)</p>
</dd>
<dt><code>loss</code></dt><dd><p>Loss function to select penalty parameter (one of 'L1','L2','Huber').</p>
</dd>
<dt><code>delta</code></dt><dd><p>delta parameter for Huber loss (default 2.5)</p>
</dd>
<dt><code>gamma</code></dt><dd><p>gamma parameter for SCAD or MCP penalty (default 3)</p>
</dd>
<dt><code>rolling_oos</code></dt><dd><p>True or False: indicator to update the penalty parameter over the evaluation period (default <code>False</code>)</p>
</dd>
<dt><code>linear</code></dt><dd><p>indicator for linearly decrementing penalty grid (FALSE is log-linear).</p>
</dd>
<dt><code>refit_fraction</code></dt><dd><p>fraction of least squares refit to incorporate (default is 1).</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>
</p>

<hr>
<h2 id='BigVAR.est'>BigVAR Estimation</h2><span id='topic+BigVAR.est'></span><span id='topic+BigVAR.est+2CBigVAR-method'></span>

<h3>Description</h3>

<p>Fit a BigVAR object with a structured penalty (VARX-L or HLAG).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BigVAR.est(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BigVAR.est_+3A_object">object</code></td>
<td>
<p>BigVAR object created from <code>ConstructModel</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits HLAG or VARX-L model on a BigVAR object.  Does not perform cross-validation.  This method allows the user to construct their own penalty parameter selection procedure.
</p>


<h3>Value</h3>

<p>An array of <code class="reqn">k \times kp \times n</code> or <code class="reqn">k\times kp+ms \times n</code> coefficient matrices; one for each of the n values of lambda.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>, <code><a href="#topic+BigVAR.results">BigVAR.results</a></code>,<code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
Y=Y[1:100,]
#construct a Basic VAR-L
Model1=constructModel(Y,p=4,struct='Basic',gran=c(50,10))
BigVAR.est(Model1)
</code></pre>

<hr>
<h2 id='BigVAR.fit'>Simple function to fit BigVAR model with fixed penalty parameter</h2><span id='topic+BigVAR.fit'></span>

<h3>Description</h3>

<p>Simple function to fit BigVAR model with fixed penalty parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BigVAR.fit(
  Y,
  p,
  struct,
  lambda,
  alpha = NULL,
  VARX = list(),
  separate_lambdas = F,
  MN = F,
  C = as.double(NULL),
  intercept = TRUE,
  tf = F,
  tol = 1e-04,
  RVAR = F,
  refit_fraction = 1,
  beta = NULL,
  gamma = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BigVAR.fit_+3A_y">Y</code></td>
<td>
<p><code class="reqn">T \times k</code> multivariate time series or Y <code class="reqn">T \times (k+m)</code> endogenous and exogenous series, respectively</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_p">p</code></td>
<td>
<p>Predetermined maximal lag order (for modeled series)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_struct">struct</code></td>
<td>
<p>The choice of penalty structure (see details).</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_lambda">lambda</code></td>
<td>
<p>vector or matrix of penalty parameters.</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_alpha">alpha</code></td>
<td>
<p>grid of candidate parameters for the alpha in the Sparse Lag and Sparse Own/Other VARX-L</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_varx">VARX</code></td>
<td>
<p>List containing VARX model specifications.</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_separate_lambdas">separate_lambdas</code></td>
<td>
<p>indicator for separate penalty parameters for each time series (default <code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_mn">MN</code></td>
<td>
<p>Minnesota Prior Indicator</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_c">C</code></td>
<td>
<p>vector of coefficients to shrink toward a random walk (if <code>MN</code> is <code>TRUE</code>)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_intercept">intercept</code></td>
<td>
<p>True or False: option to fit an intercept</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_tf">tf</code></td>
<td>
<p>transfer function indicator (i.e. VARX in which p=0 &amp; s&gt;0) (default false)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_tol">tol</code></td>
<td>
<p>optimization tolerance (default 1e-4)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_rvar">RVAR</code></td>
<td>
<p>True or False: option to refit based upon the support selected using the Relaxed-VAR procedure</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_refit_fraction">refit_fraction</code></td>
<td>
<p>fraction of least squares refit to incorporate (default 1)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_beta">beta</code></td>
<td>
<p>optional <code class="reqn">k\times (k\times p + m\times s +1)</code> coefficient matrix to use as a 'warm start' (default <code>NULL</code>)</p>
</td></tr>
<tr><td><code id="BigVAR.fit_+3A_gamma">gamma</code></td>
<td>
<p>additional parameter for SCAD/MCP penalty (default 3)
</p>
<p>@details The choices for 'struct' are as follows
</p>

<ul>
<li><p>  'Basic' (Basic VARX-L)
</p>
</li>
<li><p>  'BasicEN' (Basic Elastic Net VARX-L)
</p>
</li>
<li><p>  'Lag' (Lag Group VARX-L) 
</p>
</li>
<li><p>  'SparseLag' (Lag Sparse Group VARX-L) 
</p>
</li>
<li><p>  'OwnOther' (Own/Other Group VARX-L) 
</p>
</li>
<li><p>  'SparseOO' (Own/Other Sparse Group VARX-L) 
</p>
</li>
<li><p>  'EFX' (Endogenous First VARX-L)
</p>
</li>
<li><p>  'HLAGC' (Componentwise HLAG) 
</p>
</li>
<li><p>  'HLAGOO' (Own/Other HLAG) 
</p>
</li>
<li><p>  'HLAGELEM' (Elementwise HLAG)
</p>
</li>
<li><p>  'Tapered' (Lag weighted Lasso VAR)
</p>
</li>
<li><p>  'BGR' (Bayesian Ridge Regression (cf. Banbura et al))
</p>
</li>
<li><p>  'MCP' (Minimax Concave Penalty (cf. Breheny and Huang))
</p>
</li>
<li><p>  'SCAD' (Smoothly Clipped Absolute Deviation (cf. Breheny and Huang))
</p>
</li></ul>

<p>VARX specifications consist of a list with entry k denoting the series that are to be modeled and entry s to denote the maximal lag order for exogenous series.
</p>
<p>The argument alpha is ignored unless the structure choice is 'SparseLag' or 'Lag.'  By default 'alpha' is set to <code>NULL</code> and will be initialized as 1/(k+1) in <code>cv.BigVAR</code> and <code>BigVAR.est</code>.  Any user supplied values must be between 0 and 1.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The specifications 'Basic', 'Lag,' 'SparseLag,' 'SparseOO,' and 'OwnOther' can accommodate both VAR and VARX models.  EFX only applies to VARX models.  'HLAGC,' 'HLAGOO,' 'HLAGELEM,' and 'Tapered' can only be used with VAR models.  Our implementation of the SCAD and MCP penalties is heavily influenced by the implementation in <code>ncvreg</code>.
</p>


<h3>References</h3>

<p>Banbura, Marta, Domenico Giannone, and Lucrezia Reichlin. 'Large Bayesian vector auto regressions.' Journal of Applied Econometrics 25.1 (2010): 71-92.
Breheny P, Huang J (2011). “Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection.” Annals of Applied Statistics, 5(1), 232–253.
William B Nicholson, Jacob Bien, and David S Matteson. 'High Dimensional Forecasting via Interpretable Vector Autoregression.' arXiv preprint arXiv:1412.5250, 2016.
William B. Nicholson, David S. Matteson, Jacob Bien,VARX-L: Structured regularization for large vector autoregressions with exogenous variables, International Journal of Forecasting, Volume 33, Issue 3, 2017, Pages 627-651,
William B Nicholson, David S. Matteson, and Jacob Bien (2016), 'BigVAR: Tools for Modeling Sparse High-Dimensional Multivariate Time Series' arxiv:1702.07094
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>,<code><a href="#topic+BigVAR.est">BigVAR.est</a></code>,<code><a href="#topic+constructModel">constructModel</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># VARX Example
# Fit a Basic VARX-L with k=2, m=1, s=2, p=4, lambda=1e-2
VARX=list()
VARX$k=2 # indicates that the first two series are modeled
VARX$s=2 # sets 2 as the maximal lag order for exogenous series
data(Y)
BigVAR.fit(Y,p=4,'Basic',lambda=1e-2,VARX=VARX)
</code></pre>

<hr>
<h2 id='BigVAR.intermediate'>BigVAR.intermediate
This class contains the in-sample results for cv.BigVAR</h2><span id='topic+BigVAR.intermediate'></span><span id='topic+BigVAR.intermediate-class'></span>

<h3>Description</h3>

<p>It inherits the class BigVAR, and contains the results from rolling validation
</p>


<h3>Fields</h3>


<dl>
<dt><code>ZFull</code></dt><dd><p>List containing full lag matrix and time series</p>
</dd>
<dt><code>InSampMSFE</code></dt><dd><p>In-sample MSFE from optimal value of lambda</p>
</dd>
<dt><code>LambdaGrid</code></dt><dd><p>Grid of candidate lambda values</p>
</dd>
<dt><code>index</code></dt><dd><p>Index order of optimal lambda value</p>
</dd>
<dt><code>OptimalLambda</code></dt><dd><p>Value of lambda that minimizes MSFE</p>
</dd>
<dt><code>Data</code></dt><dd><p>a <code class="reqn">T \times k</code> or <code class="reqn">T\times k + m</code> multivariate time Series</p>
</dd>
<dt><code>lagmax</code></dt><dd><p>Maximal lag order</p>
</dd>
<dt><code>Structure</code></dt><dd><p>Penalty structure</p>
</dd>
<dt><code>Relaxed</code></dt><dd><p>Indicator for relaxed VAR</p>
</dd>
<dt><code>Granularity</code></dt><dd><p>Granularity of penalty grid</p>
</dd>
<dt><code>horizon</code></dt><dd><p>Desired forecast horizon</p>
</dd>
<dt><code>crossval</code></dt><dd><p>Cross-Validation procedure</p>
</dd>
<dt><code>alpha</code></dt><dd><p>additional penalty parameter for Sparse Lag Group or Sparse Own/Other methods. Will contain either the heuristic choice of <code class="reqn">1/(k+1)</code> or the value selected by cross validation if the argument <code>dual</code> is set to <code>TRUE</code></p>
</dd>
<dt><code>Minnesota</code></dt><dd><p>Minnesota Prior Indicator</p>
</dd>
<dt><code>verbose</code></dt><dd><p>verbose indicator</p>
</dd>
<dt><code>dual</code></dt><dd><p>indicator as to whether dual cross validation was conducted</p>
</dd>
<dt><code>contemp</code></dt><dd><p>indicator if contemporaneous exogenous predictors are used</p>
</dd>
</dl>


<h3>Note</h3>

<p>One can also access any object of class BigVAR from BigVAR.intermediate
</p>


<h3>Author(s)</h3>

<p>Will Nicholson
</p>

<hr>
<h2 id='BigVAR.results'>BigVAR.results
This class contains the results from cv.BigVAR.</h2><span id='topic+BigVAR.results'></span><span id='topic+BigVAR.results-class'></span>

<h3>Description</h3>

<p>It inherits the class BigVAR, but contains substantially more information.
</p>


<h3>Fields</h3>


<dl>
<dt><code>InSampMSFE</code></dt><dd><p>In-sample MSFE from optimal value of lambda</p>
</dd>
<dt><code>LambdaGrid</code></dt><dd><p>Grid of candidate lambda values</p>
</dd>
<dt><code>index</code></dt><dd><p>Rank of optimal lambda value</p>
</dd>
<dt><code>OptimalLambda</code></dt><dd><p>Value of lambda that minimizes MSFE</p>
</dd>
<dt><code>OOSMSFE</code></dt><dd><p>Average Out of sample MSFE of BigVAR model with optimal lambda</p>
</dd>
<dt><code>seoosfmsfe</code></dt><dd><p>Standard error of out of sample MSFE of BigVAR model with optimal lambda</p>
</dd>
<dt><code>MeanMSFE</code></dt><dd><p>Average out of sample MSFE of unconditional mean forecast</p>
</dd>
<dt><code>MeanSD</code></dt><dd><p>Standard error of out of sample MSFE of unconditional mean forecast</p>
</dd>
<dt><code>MeanPreds</code></dt><dd><p>predictions from conditional mean model</p>
</dd>
<dt><code>RWMSFE</code></dt><dd><p>Average out of sample MSFE of random walk forecast</p>
</dd>
<dt><code>RWPreds</code></dt><dd><p>Predictions from random walk model</p>
</dd>
<dt><code>RWSD</code></dt><dd><p>Standard error of out of sample MSFE of random walk forecast</p>
</dd>
<dt><code>AICMSFE</code></dt><dd><p>Average out of sample MSFE of AIC forecast</p>
</dd>
<dt><code>AICSD</code></dt><dd><p>Standard error of out of sample MSFE of AIC forecast</p>
</dd>
<dt><code>AICPreds</code></dt><dd><p>Predictions from AIC VAR/VARX model</p>
</dd>
<dt><code>AICpvec</code></dt><dd><p>Lag orders selected from AIC VAR model</p>
</dd>
<dt><code>AICpvec</code></dt><dd><p>Lag orders selected from AIC VARX model</p>
</dd>
<dt><code>BICMSFE</code></dt><dd><p>Average out of sample MSFE of BIC forecast</p>
</dd>
<dt><code>BICSD</code></dt><dd><p>Standard error of out of sample MSFE of BIC forecast</p>
</dd>
<dt><code>BICPreds</code></dt><dd><p>Predictions from BIC VAR/VARX model</p>
</dd>
<dt><code>BICpvec</code></dt><dd><p>Lag orders selected from BIC VAR model</p>
</dd>
<dt><code>BICpvec</code></dt><dd><p>Lag orders selected from BIC VARX model</p>
</dd>
<dt><code>betaPred</code></dt><dd><p>The final estimated <code class="reqn">k\times kp+ms+1</code> coefficient matrix, to be used for prediction</p>
</dd>
<dt><code>Zvals</code></dt><dd><p>The final lagged values of <code>Y</code>, to be used for prediction</p>
</dd>
<dt><code>fitted</code></dt><dd><p>fitted values obtained from betaPred</p>
</dd>
<dt><code>resids</code></dt><dd><p>residuals obtained from betaPred</p>
</dd>
<dt><code>Data</code></dt><dd><p>a <code class="reqn">T \times k</code> or <code class="reqn">T\times k + m</code> multivariate time Series</p>
</dd>
<dt><code>lagmax</code></dt><dd><p>Maximal lag order</p>
</dd>
<dt><code>Structure</code></dt><dd><p>Penalty structure</p>
</dd>
<dt><code>Relaxed</code></dt><dd><p>Indicator for relaxed VAR</p>
</dd>
<dt><code>Granularity</code></dt><dd><p>Granularity of penalty grid</p>
</dd>
<dt><code>horizon</code></dt><dd><p>Desired forecast horizon</p>
</dd>
<dt><code>crossval</code></dt><dd><p>Cross-Validation procedure</p>
</dd>
<dt><code>alpha</code></dt><dd><p>additional penalty parameter for Sparse Lag Group or Sparse Own/Other methods. Will contain either the heuristic choice of <code class="reqn">1/(k+1)</code> or the value selected by cross validation if the argument <code>dual</code> is set to <code>TRUE</code></p>
</dd>
<dt><code>VARXI</code></dt><dd><p>VARX Indicator</p>
</dd>
<dt><code>Minnesota</code></dt><dd><p>Minnesota Prior Indicator</p>
</dd>
<dt><code>verbose</code></dt><dd><p>verbose indicator</p>
</dd>
<dt><code>dual</code></dt><dd><p>indicator as to whether dual cross validation was conducted</p>
</dd>
<dt><code>contemp</code></dt><dd><p>indicator if contemporaneous exogenous predictors are used</p>
</dd>
<dt><code>lagmatrix</code></dt><dd><p>matrix of lagged values used to compute residuals (of which Zvals is the final column)</p>
</dd>
<dt><code>betaArray</code></dt><dd><p>array of VAR/VARX coefficients from out of sample forecasts</p>
</dd>
<dt><code>sparse_count</code></dt><dd><p>average fraction of active coefficients in validation period</p>
</dd>
<dt><code>lambda_evolve_path</code></dt><dd><p>evolution of lambda over evaluation period</p>
</dd>
</dl>


<h3>Note</h3>

<p>One can also access any object of class BigVAR from BigVAR.results
</p>


<h3>Author(s)</h3>

<p>Will Nicholson
</p>

<hr>
<h2 id='coef'>Default coef method BigVAR-results, returns the last coefficient matrix from the evaluation period</h2><span id='topic+coef'></span><span id='topic+coef+2CBigVAR.results-method'></span><span id='topic+coef-methods'></span>

<h3>Description</h3>

<p>Default coef method BigVAR-results, returns the last coefficient matrix from the evaluation period
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BigVAR.results'
coef(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_+3A_object">object</code></td>
<td>
<p>BigVAR.results object created from <code>cv.BigVAR</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>displays formatted coefficient matrix
</p>

<hr>
<h2 id='constructModel'>Construct an object of class BigVAR</h2><span id='topic+constructModel'></span>

<h3>Description</h3>

<p>Construct an object of class BigVAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>constructModel(
  Y,
  p,
  struct,
  gran,
  h = 1,
  cv = "Rolling",
  verbose = TRUE,
  IC = TRUE,
  VARX = list(),
  T1 = floor(nrow(Y)/3),
  T2 = floor(2 * nrow(Y)/3),
  ONESE = FALSE,
  ownlambdas = FALSE,
  recursive = FALSE,
  dates = as.character(NULL),
  window.size = 0,
  separate_lambdas = FALSE,
  linear = FALSE,
  loss = "L2",
  rolling_oos = FALSE,
  model.controls = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="constructModel_+3A_y">Y</code></td>
<td>
<p><code class="reqn">T \times k</code> multivariate time series or Y <code class="reqn">T \times (k+m)</code> endogenous and exogenous series, respectively.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_p">p</code></td>
<td>
<p>Predetermined maximal lag order (for modeled series).</p>
</td></tr>
<tr><td><code id="constructModel_+3A_struct">struct</code></td>
<td>
<p>The choice of penalty structure (see details).</p>
</td></tr>
<tr><td><code id="constructModel_+3A_gran">gran</code></td>
<td>
<p>vector of penalty parameter specifications.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_h">h</code></td>
<td>
<p>Desired forecast horizon.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_cv">cv</code></td>
<td>
<p>Cross-validation approach, either 'Rolling' for rolling cross-validation or 'LOO' for leave-one-out cross-validation. 'None' for use with BigVAR.fit.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_verbose">verbose</code></td>
<td>
<p>Verbose output while estimating.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_ic">IC</code></td>
<td>
<p>True or False: whether to include AIC and BIC benchmarks.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_varx">VARX</code></td>
<td>
<p>List containing VARX model specifications.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_t1">T1</code></td>
<td>
<p>Index of time series in which to start cross validation.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_t2">T2</code></td>
<td>
<p>Index of times series in which to start forecast evaluation.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_onese">ONESE</code></td>
<td>
<p>True or False: whether to use the 'One Standard Error Heuristic.'</p>
</td></tr>
<tr><td><code id="constructModel_+3A_ownlambdas">ownlambdas</code></td>
<td>
<p>True or False: Indicator for user-supplied penalty parameters.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_recursive">recursive</code></td>
<td>
<p>True or False: Indicator as to whether iterative multi-step predictions are desired in the VAR context if the forecast horizon is greater than 1.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_dates">dates</code></td>
<td>
<p>optional vector of dates corresponding to <code class="reqn">Y</code>.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_window.size">window.size</code></td>
<td>
<p>size of rolling window.  If set to 0 an expanding window will be used.</p>
</td></tr>
<tr><td><code id="constructModel_+3A_separate_lambdas">separate_lambdas</code></td>
<td>
<p>indicator for separate penalty parameters for each time series (default <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="constructModel_+3A_linear">linear</code></td>
<td>
<p>indicator for linearly decrementing penalty grid (FALSE is log-linear; default <code>FALSE</code>).</p>
</td></tr>
<tr><td><code id="constructModel_+3A_loss">loss</code></td>
<td>
<p>Loss function to select penalty parameter (one of 'L1','L2','Huber')</p>
</td></tr>
<tr><td><code id="constructModel_+3A_rolling_oos">rolling_oos</code></td>
<td>
<p>True or False: indicator to update the penalty parameter over the evaluation period (default <code>False</code>)</p>
</td></tr>
<tr><td><code id="constructModel_+3A_model.controls">model.controls</code></td>
<td>
<p>named list of control parameters for BigVAR model estimation (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The choices for 'struct' are as follows
</p>

<ul>
<li><p>  'Basic' (Basic VARX-L)
</p>
</li>
<li><p>  'BasicEN' (Elastic Net VARX-L)
</p>
</li>
<li><p>  'Lag' (Lag Group VARX-L) 
</p>
</li>
<li><p>  'SparseLag' (Lag Sparse Group VARX-L) 
</p>
</li>
<li><p>  'OwnOther' (Own/Other Group VARX-L) 
</p>
</li>
<li><p>  'SparseOO' (Own/Other Sparse Group VARX-L) 
</p>
</li>
<li><p>  'EFX' (Endogenous First VARX-L)
</p>
</li>
<li><p>  'HLAGC' (Componentwise HLAG) 
</p>
</li>
<li><p>  'HLAGOO' (Own/Other HLAG) 
</p>
</li>
<li><p>  'HLAGELEM' (Elementwise HLAG)
</p>
</li>
<li><p>  'Tapered' (Lag weighted Lasso VAR)
</p>
</li>
<li><p>  'BGR' (Bayesian Ridge Regression (cf. Banbura et al))
</p>
</li>
<li><p>  'MCP' (Minimax Concave Penalty  (cf. Breheny and Huang))
</p>
</li>
<li><p>  'SCAD' (Smoothly Clipped Absolute Deviation Penalty (cf. Breheny and Huang))
</p>
</li></ul>

<p>The first number in the vector 'gran' specifies how deep to construct the penalty grid and the second specifies how many penalty parameters to use  If ownlambas is set to TRUE, gran should contain the user-supplied penalty parameters.
</p>
<p>VARX specifications consist of a named list with entry k denoting the series that are to be modeled and entry s to denote the maximal lag order for exogenous series.
</p>
<p>As the capabilities of BigVAR have expanded, we have decided to consolidate parameters in the list model.controls.  These parameters include: 
</p>

<ul>
<li><p> 'alpha:' grid of candidate parameters for the alpha in the Basic Elastic Net, Sparse Lag, Sparse Own/Other VARX-L.
</p>
</li>
<li><p> 'C:' vector of coefficients to shrink toward a random walk (if <code>MN</code> is <code>TRUE</code>).
</p>
</li>
<li><p> 'delta:' parameter for Huber loss (default 2.5) 
</p>
</li>
<li><p> 'intercept:' option to fit an intercept, default <code>TRUE</code>
</p>
</li>
<li><p> 'loss:' Loss function to select penalty parameter (one of 'L1','L2','Huber')
</p>
</li>
<li><p> 'MN:' Minnesota Prior Indicator, default <code>FALSE</code>
</p>
</li>
<li><p> 'RVAR:'  option to refit based upon the support selected using the Relaxed-VAR procedure (default FALSE).
</p>
</li>
<li><p> 'refit_fraction:'  If RVAR is <code>TRUE</code>, proportional tradeoff between least squares fit and penalized fit (default 1).
</p>
</li>
<li><p> 'tol:' optimization tolerance (default 1e-4)
</p>
</li></ul>

<p>The argument alpha is ignored unless the structure choice is 'SparseLag' or 'Lag.'  By default 'alpha' is set to <code>NULL</code> and will be initialized as 1/(k+1) in <code>cv.BigVAR</code> and <code>BigVAR.est</code>.  Any user supplied values must be between 0 and 1.
</p>


<h3>Note</h3>

<p>The specifications 'Basic','BasicEN', 'Lag,' 'SparseLag,' 'SparseOO','OwnOther', 'MCP', and 'SCAD.' can accommodate both VAR and VARX models.  EFX only applies to VARX models.  'HLAGC,' 'HLAGOO,' 'HLAGELEM,' and 'Tapered' can only be used with VAR models.  Our implementation of the SCAD and MCP penalties is heavily influenced by the package <code>ncvreg</code>.
</p>


<h3>References</h3>

<p>Banbura, Marta, Domenico Giannone, and Lucrezia Reichlin. 'Large Bayesian vector auto regressions.' Journal of Applied Econometrics 25.1 (2010): 71-92.
Breheny P, Huang J (2011). “Coordinate descent algorithms for nonconvex penalized regression, with applications to biological feature selection.” Annals of Applied Statistics, 5(1), 232–253.
Nicholson, William, I. Wilms, J. Bien, and D. S. Matteson. High dimensional forecasting via interpretable vector autoregression. Journal of Machine Learning Research, 21(166):1–52, 2020.
William B. Nicholson, David S. Matteson, Jacob Bien,VARX-L: Structured regularization for large vector autoregressions with exogenous variables, International Journal of Forecasting, Volume 33, Issue 3, 2017, Pages 627-651,
William B Nicholson, David S. Matteson, and Jacob Bien (2016), 'BigVAR: Tools for Modeling Sparse High-Dimensional Multivariate Time Series' arxiv:1702.07094
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>,<code><a href="#topic+BigVAR.est">BigVAR.est</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># VARX Example
# Create a Basic VARX-L with k=2, m=1, s=2, p=4
VARX=list()
VARX$k=2 # indicates that the first two series are modeled
VARX$s=2 # sets 2 as the maximal lag order for exogenous series
data(Y)
T1=floor(nrow(Y)/3)
T2=floor(2*nrow(Y)/3)
Model1=constructModel(Y,p=4,struct='Basic',gran=c(50,10),verbose=FALSE,VARX=VARX,T1=T1,T2=T2)
</code></pre>

<hr>
<h2 id='cv.BigVAR'>Cross Validation for BigVAR</h2><span id='topic+cv.BigVAR'></span><span id='topic+cv.BigVAR+2CBigVAR-method'></span>

<h3>Description</h3>

<p>Cross Validation for BigVAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.BigVAR(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.BigVAR_+3A_object">object</code></td>
<td>
<p>BigVAR object created from <code>ConstructModel</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main function of the BigVAR package. Performs cross validation to select penalty parameters over a training sample (as the minimizer of in-sample MSFE), then evaluates them over a test set.  Compares against sample mean, random walk, AIC, and BIC benchmarks.  Creates an object of class <code>BigVAR.results</code>
</p>


<h3>Value</h3>

<p>An object of class <code>BigVAR.results</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>, <code><a href="#topic+BigVAR.results">BigVAR.results</a></code>,<code><a href="#topic+BigVAR.est">BigVAR.est</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
# Fit a Basic VARX-L with rolling cross validation 
Model1=constructModel(Y,p=4,struct='Basic',gran=c(50,10), verbose=FALSE)
results=cv.BigVAR(Model1)
</code></pre>

<hr>
<h2 id='MultVarSim'>Simulate a VAR</h2><span id='topic+MultVarSim'></span>

<h3>Description</h3>

<p>Simulate a VAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultVarSim(k, A1, p, Sigma, T)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MultVarSim_+3A_k">k</code></td>
<td>
<p>Number of Series</p>
</td></tr>
<tr><td><code id="MultVarSim_+3A_a1">A1</code></td>
<td>
<p>Either a <code class="reqn">k \times k</code> coefficient matrix or a <code class="reqn">kp \times kp</code> matrix created using <code><a href="#topic+VarptoVar1MC">VarptoVar1MC</a></code>.</p>
</td></tr>
<tr><td><code id="MultVarSim_+3A_p">p</code></td>
<td>
<p>Maximum Lag Order</p>
</td></tr>
<tr><td><code id="MultVarSim_+3A_sigma">Sigma</code></td>
<td>
<p>Residual Covariance Matrix of dimension <code class="reqn">k\times k</code></p>
</td></tr>
<tr><td><code id="MultVarSim_+3A_t">T</code></td>
<td>
<p>Number of simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code class="reqn">T \times k</code> of realizations from a VAR.
</p>


<h3>References</h3>

<p>Lutkepohl, 'A New Introduction to Multiple Time Series Analysis'
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VarptoVar1MC">VarptoVar1MC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k=3;p=6
B=matrix(0,nrow=k,ncol=p*k)
A1&lt;- matrix(c(.4,-.02,.01,-.02,.3,.02,.01,.04,.3),ncol=3,nrow=3)
A2 &lt;- matrix(c(.2,0,0,0,.3,0,0,0,.13),ncol=3,nrow=3)
B[,1:k]=A1
B[,(4*k+1):(5*k)]=A2
A &lt;- VarptoVar1MC(B,p,k)
Y &lt;-MultVarSim(k,A,p,.1*diag(k),100)
</code></pre>

<hr>
<h2 id='plot'>Plot an object of class BigVAR.results</h2><span id='topic+plot'></span><span id='topic+plot+2CBigVAR.results-method'></span><span id='topic+plot-methods'></span>

<h3>Description</h3>

<p>Plot an object of class BigVAR.results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BigVAR.results'
plot(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>BigVAR.results object created from <code>cv.BigVAR</code></p>
</td></tr>
<tr><td><code id="plot_+3A_y">y</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the in sample MSFE of all values of lambda with the optimal value highlighted.
</p>

<hr>
<h2 id='plot.BigVAR'>Plot a BigVAR object</h2><span id='topic+plot.BigVAR'></span><span id='topic+plot+2CBigVAR-method'></span>

<h3>Description</h3>

<p>Plot a BigVAR object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BigVAR'
plot(x, y = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.BigVAR_+3A_x">x</code></td>
<td>
<p>BigVAR object created from <code>ConstructModel</code></p>
</td></tr>
<tr><td><code id="plot.BigVAR_+3A_y">y</code></td>
<td>
<p>NULL</p>
</td></tr>
<tr><td><code id="plot.BigVAR_+3A_...">...</code></td>
<td>
<p>additional plot arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses plot.zoo to plot each indivdual series of <code>Y</code> on a single plot
</p>


<h3>Value</h3>

<p>NA, side effect is graph
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>
</p>

<hr>
<h2 id='predict'>Forecast using a BigVAR.results object</h2><span id='topic+predict'></span><span id='topic+predict+2CBigVAR.results-method'></span>

<h3>Description</h3>

<p>Forecast using a BigVAR.results object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_+3A_object">object</code></td>
<td>
<p>BigVAR.results object from <code>cv.BigVAR</code></p>
</td></tr>
<tr><td><code id="predict_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the predictions produced (e.g. <code>n.ahead</code>, <code>confint</code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Provides <code>n.ahead</code> step forecasts using the model produced by cv.BigVAR.  If <code>confint</code> is set to <code>TRUE</code>, a 95 percent confidence interval will also be returned.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
Y=Y[1:100,]
Model1=constructModel(Y,p=4,struct='Basic',gran=c(50,10),verbose=FALSE)
results=cv.BigVAR(Model1)
predict(results,n.ahead=1)
</code></pre>

<hr>
<h2 id='PredictVARX'>One-step ahead predictions for VARX models</h2><span id='topic+PredictVARX'></span>

<h3>Description</h3>

<p>One-step ahead predictions for VARX models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredictVARX(VARXRes)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PredictVARX_+3A_varxres">VARXRes</code></td>
<td>
<p>the results from <code><a href="#topic+VARXFit">VARXFit</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector consisting of the out-of-sample forecasts for the provided <code><a href="#topic+VARXFit">VARXFit</a></code> model.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VARXFit">VARXFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
# fit a VAR_3(3)
mod &lt;- VARXFit(Y,3,NULL,NULL)
pred &lt;-PredictVARX(mod)

</code></pre>

<hr>
<h2 id='show'>Default show method for an object of class BigVAR.results</h2><span id='topic+show'></span><span id='topic+show+2CBigVAR.results-method'></span>

<h3>Description</h3>

<p>Default show method for an object of class BigVAR.results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BigVAR.results'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show_+3A_object">object</code></td>
<td>
<p>BigVAR.results object created from <code>cv.BigVAR</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>prints forecast results and additional diagnostic information as well as comparisons with mean, random walk, and AIC, and BIC benchmarks
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>,<code><a href="#topic+BigVAR.results">BigVAR.results</a></code>
</p>

<hr>
<h2 id='show.BigVAR'>Default show method for an object of class BigVAR</h2><span id='topic+show.BigVAR'></span><span id='topic+show+2CBigVAR-method'></span>

<h3>Description</h3>

<p>Default show method for an object of class BigVAR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BigVAR'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="show.BigVAR_+3A_object">object</code></td>
<td>
<p><code>BigVAR</code> object created from <code>ConstructModel</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Displays the following information about the BigVAR object:
</p>

<ul>
<li><p>Prints the first 5 rows of <code>Y</code>
</p>
</li>
<li><p> Penalty Structure
</p>
</li>
<li><p> Relaxed Least Squares Indicator
</p>
</li>
<li><p>Maximum lag order 
</p>
</li>
<li><p> VARX Specifications (if applicable)
</p>
</li>
<li><p>Start, end of cross validation period
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>
</p>

<hr>
<h2 id='SparsityPlot.BigVAR.results'>Sparsity Plot of a BigVAR.results object</h2><span id='topic+SparsityPlot.BigVAR.results'></span><span id='topic+SparsityPlot.BigVAR.results+2CBigVAR.results-method'></span>

<h3>Description</h3>

<p>Sparsity Plot of a BigVAR.results object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SparsityPlot.BigVAR.results(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SparsityPlot.BigVAR.results_+3A_object">object</code></td>
<td>
<p>BigVAR.results object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code>levelplot</code> from the <code>lattice</code> package to plot the magnitude of each coefficient in the last coefficient estimated by <code>cv.BigVAR</code>.
</p>


<h3>Value</h3>

<p>NA, side effect is graph
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>, <code><a href="#topic+BigVAR.results">BigVAR.results</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
Y &lt;- Y[1:100,]
Model1 &lt;- constructModel(Y,p=4,struct='Basic',gran=c(50,10),verbose=FALSE)
SparsityPlot.BigVAR.results(cv.BigVAR(Model1))
</code></pre>

<hr>
<h2 id='VarptoVar1MC'>Converts a VAR coefficient matrix of order p to multiple companion form</h2><span id='topic+VarptoVar1MC'></span>

<h3>Description</h3>

<p>Converts a VAR coefficient matrix of order p to multiple companion form
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VarptoVar1MC(B, p, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VarptoVar1MC_+3A_b">B</code></td>
<td>
<p>a <code class="reqn">k \times kp</code> coefficient matrix</p>
</td></tr>
<tr><td><code id="VarptoVar1MC_+3A_p">p</code></td>
<td>
<p>Lag order</p>
</td></tr>
<tr><td><code id="VarptoVar1MC_+3A_k">k</code></td>
<td>
<p>Number of Series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a <code class="reqn">kp \times kp</code> coefficient matrix representing all coefficient matrices contained in Ai as a VAR(1).
</p>


<h3>References</h3>

<p>See page 15 of Lutkepohl, 'A New Introduction to Multiple Time Series Analysis'
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultVarSim">MultVarSim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>k=3;p=6
B=matrix(0,nrow=k,ncol=p*k)
A1&lt;- matrix(c(.4,-.02,.01,-.02,.3,.02,.01,.04,.3),ncol=3,nrow=3)
A2 &lt;- matrix(c(.2,0,0,0,.3,0,0,0,.13),ncol=3,nrow=3)
B[,1:k]=A1
B[,(4*k+1):(5*k)]=A2
A &lt;- VarptoVar1MC(B,p,k)
</code></pre>

<hr>
<h2 id='VARXFit'>Fit a VAR or VARX model by least squares</h2><span id='topic+VARXFit'></span>

<h3>Description</h3>

<p>Fit a VAR or VARX model by least squares
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VARXFit(Y, p, IC, VARX = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VARXFit_+3A_y">Y</code></td>
<td>
<p>a <code class="reqn">t \times k</code> multivariate time series</p>
</td></tr>
<tr><td><code id="VARXFit_+3A_p">p</code></td>
<td>
<p>maximum lag order</p>
</td></tr>
<tr><td><code id="VARXFit_+3A_ic">IC</code></td>
<td>
<p>Information criterion indicator, if set to <code>NULL</code>, it will fit a least squares VAR(X) of orders p and s.  Otherwise, if set to 'AIC' or 'BIC' it return the model with lag orders that minimize the given IC.</p>
</td></tr>
<tr><td><code id="VARXFit_+3A_varx">VARX</code></td>
<td>
<p>a list of VARX specifications (as in <code><a href="#topic+constructModel">constructModel</a></code> (or NULL )</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a modified form of the least squares technique proposed by Neumaier and Schneider (2001).  It fits a least squares VAR or VARX via a QR decomposition that does not require explicit matrix inversion.  This results in improved computational performance as well as numerical stability over the conventional least squares approach.
</p>


<h3>Value</h3>

<p>Returns a list with four entries:
</p>

<ul>
<li><p>'Bhat'Estimated <code class="reqn">k\times kp+ms</code> coefficient matrix
</p>
</li>
<li><p>'SigmaUEstimated <code class="reqn">k\times k</code> residual covariance matrix
</p>
</li>
<li><p>'phat'Selected lag order for VAR component
</p>
</li>
<li><p>'shat'Selected lag order for VARX component
</p>
</li>
<li><p>'Y'multivariate time series retained for prediction purposes
</p>
</li>
<li><p>'Y'number of endogenous (modeled) time series
</p>
</li></ul>



<h3>References</h3>

<p>Neumaier, Arnold, and Tapio Schneider. 'Estimation of parameters and eigenmodes of multivariate autoregressive models.' ACM Transactions on Mathematical Software (TOMS) 27.1 (2001): 27-57.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+constructModel">constructModel</a></code>, <code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>,<code><a href="#topic+BigVAR.fit">BigVAR.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
# fit a VAR_3(3)
mod &lt;- VARXFit(Y,3,NULL,NULL)
# fit a VAR_3 with p= 6 and lag selected according to AIC
modAIC &lt;- VARXFit(Y,6,'AIC',NULL)
# Fit a VARX_{2,1} with p=6, s=4 and lags selected by BIC
modXBIC &lt;- VARXFit(Y,6,'BIC',list(k=1,s=4))

</code></pre>

<hr>
<h2 id='VARXForecastEval'>Evaluate forecasts from a VAR or VARX with lag orders selected by AIC/BIC</h2><span id='topic+VARXForecastEval'></span>

<h3>Description</h3>

<p>Evaluate forecasts from a VAR or VARX with lag orders selected by AIC/BIC
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VARXForecastEval(
  Y,
  X,
  p,
  s,
  T1,
  T2,
  IC,
  h,
  iterated = FALSE,
  loss = "L2",
  delta = 2.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VARXForecastEval_+3A_y">Y</code></td>
<td>
<p>a <code class="reqn">T \times k</code> multivariate time series</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_x">X</code></td>
<td>
<p>a <code class="reqn">T \times m</code> multivariate time series of unmodeled exogenous variables</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_p">p</code></td>
<td>
<p>maximum lag order for endogenous series</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_s">s</code></td>
<td>
<p>maximum lag order for exogenous series</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_t1">T1</code></td>
<td>
<p>start of forecast evaluation period.</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_t2">T2</code></td>
<td>
<p>end of forecast evaluation period</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_ic">IC</code></td>
<td>
<p>specifies whether to select lag order according to 'AIC' or 'BIC'</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_h">h</code></td>
<td>
<p>desired forecast horizon</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_iterated">iterated</code></td>
<td>
<p>indicator as to whether to use iterated or direct multistep forecasts (if applicable, VAR context only)</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_loss">loss</code></td>
<td>
<p>loss function (default 'L2', one of 'L1','L2','Huber')</p>
</td></tr>
<tr><td><code id="VARXForecastEval_+3A_delta">delta</code></td>
<td>
<p>delta for Huber loss function (default 2.5)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function evaluates the one-step ahead forecasts of a VAR or VARX fit by least squares over an evaluation period.  At every point in time, lag orders for the endogenous and exogenous series are selected according to AIC or BIC.  This function is run automatically when <code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code> is called unless <code>ic</code> is set to <code>FALSE</code> in <code><a href="#topic+constructModel">constructModel</a></code>.
</p>


<h3>Value</h3>

<p>Returns the one-step ahead MSFE as well as the forecasts over the evaluation period and lag order selected.
</p>


<h3>References</h3>

<p>Neumaier, Arnold, and Tapio Schneider. 'Estimation of parameters and eigenmodes of multivariate autoregressive models.' ACM Transactions on Mathematical Software (TOMS) 27.1 (2001): 27-57.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VARXFit">VARXFit</a></code>,<code><a href="#topic+constructModel">constructModel</a></code>, <code><a href="#topic+cv.BigVAR">cv.BigVAR</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)

# Evaluate the performance of a VAR with lags selected by BIC.
p &lt;- 4
T1 &lt;- floor(nrow(Y))/3
T2 &lt;- floor(2*nrow(Y))/3
# Matrix of zeros for X
X &lt;- matrix(0,nrow=nrow(Y),ncol=ncol(Y))
BICMSFE &lt;- VARXForecastEval(Y,X,p,0,T1,T2,'BIC',1)

</code></pre>

<hr>
<h2 id='VARXLagCons'>Construct a VAR or VARX lag matrix</h2><span id='topic+VARXLagCons'></span>

<h3>Description</h3>

<p>Construct a VAR or VARX lag matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VARXLagCons(Y, X = NULL, p, s = 0, oos = FALSE, contemp = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VARXLagCons_+3A_y">Y</code></td>
<td>
<p>a <code class="reqn">T \times k</code> matrix of endogenous (modeled) series</p>
</td></tr>
<tr><td><code id="VARXLagCons_+3A_x">X</code></td>
<td>
<p>a <code class="reqn">T \times m</code> matrix of exogenous (unmodeled) series (default NULL)</p>
</td></tr>
<tr><td><code id="VARXLagCons_+3A_p">p</code></td>
<td>
<p>Endogenous Lag order</p>
</td></tr>
<tr><td><code id="VARXLagCons_+3A_s">s</code></td>
<td>
<p>exogenous lag order (default zero)</p>
</td></tr>
<tr><td><code id="VARXLagCons_+3A_oos">oos</code></td>
<td>
<p>indicator as to whether the data should be constructed for out of sample prediction (i.e. last available entries of Y as final lags default FALSE)</p>
</td></tr>
<tr><td><code id="VARXLagCons_+3A_contemp">contemp</code></td>
<td>
<p>indicator as to whether to use contemporaneous exogenous predictors (for example, if exogenous series become available before exogenous default FALSE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is not required unless you which to design your own cross validation routine.
</p>


<h3>Value</h3>

<p>list with two entries:
</p>

<ul>
<li><p>'Z'<code class="reqn">kp+ms+1\times T-max(p,s)</code> VARX lag matrix
</p>
</li>
<li><p>'Y'adjusted <code class="reqn">k\times T-max(p,s)</code> endogenous series
</p>
</li></ul>



<h3>References</h3>

<p>See page 15 of Lutkepohl, 'A New Introduction to Multiple Time Series Analysis
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MultVarSim">MultVarSim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Y)
# construct VAR lag matrix with p=4
ZZ&lt;-VARXLagCons(Y,X=NULL,p=4,s=0)
</code></pre>

<hr>
<h2 id='Y'>Simulated Multivariate Time Series</h2><span id='topic+Y'></span>

<h3>Description</h3>

<p>Realization of a simulated multivariate time series
</p>


<h3>Details</h3>

<p><code class="reqn">100 \times 3</code> multivariate time series distributed according to the generator matrix <a href="#topic+A">A</a>.
</p>


<h3>Author(s)</h3>

<p>Will Nicholson
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
