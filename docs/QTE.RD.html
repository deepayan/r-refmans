<!DOCTYPE html><html lang="en-US"><head><title>Help for package QTE.RD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {QTE.RD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#QTE.RD-package'><p>QTE.RD: Quantile Treatment Effects under the Regression Discontinuity Design</p></a></li>
<li><a href='#cv.bandwidth'><p>Cross-validation bandwidth</p></a></li>
<li><a href='#depa'><p>Epanechnikov kernel</p></a></li>
<li><a href='#make.band'><p>Uniform confidence bands for QTE</p></a></li>
<li><a href='#make.band.cq'><p>Uniform confidence bands for conditional quantile processes</p></a></li>
<li><a href='#plot.qte'><p>QTE plots</p></a></li>
<li><a href='#print.band.qte'><p>Print a band.qte object</p></a></li>
<li><a href='#print.bw.qte'><p>Print a bw.qte object</p></a></li>
<li><a href='#print.qte'><p>Print a qte object.</p></a></li>
<li><a href='#print.summary.qte'><p>Print a summary.qte object</p></a></li>
<li><a href='#print.test.qte'><p>Print a test.qte object</p></a></li>
<li><a href='#rd.qte'><p>QTE and its uniform confidence band.</p></a></li>
<li><a href='#rdq'><p>Estimate the QTE under the RDD</p></a></li>
<li><a href='#rdq.band'><p>Uniform confidence bands for QTE</p></a></li>
<li><a href='#rdq.bandwidth'><p>Bandwidth estimation</p></a></li>
<li><a href='#rdq.bias'><p>Bias estimation</p></a></li>
<li><a href='#rdq.condf'><p>Conditional density estimation</p></a></li>
<li><a href='#rdq.sim'><p>Simulation the asymptotic distributions</p></a></li>
<li><a href='#rdq.test'><p>tests for QTE</p></a></li>
<li><a href='#run.test'><p>Run tests</p></a></li>
<li><a href='#summary.qte'><p>Uniform confidence band for QTE.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Quantile Treatment Effects under the Regression Discontinuity
Design</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhongjun Qu [aut, cph],
  Jungmo Yoon [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jungmo Yoon &lt;jmyoon@hanyang.ac.kr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides comprehensive methods for testing, estimating, and conducting uniform inference on quantile treatment effects (QTEs) in sharp regression discontinuity (RD) designs, incorporating covariates and implementing robust bias correction methods of Qu, Yoon, Perron (2024) &lt;<a href="https://doi.org/10.1162%2Frest_a_01168">doi:10.1162/rest_a_01168</a>&gt;.</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>quantreg, plotrix, stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-29 02:29:38 UTC; jyoon</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-29 05:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='QTE.RD-package'>QTE.RD: Quantile Treatment Effects under the Regression Discontinuity Design</h2><span id='topic+QTE.RD'></span><span id='topic+QTE.RD-package'></span>

<h3>Description</h3>

<p>Provides comprehensive methods for testing, estimating, and conducting uniform inference on quantile treatment effects (QTEs) in sharp regression discontinuity (RD) designs, incorporating covariates and implementing robust bias correction methods of Qu, Yoon, Perron (2024) <a href="https://doi.org/10.1162/rest_a_01168">doi:10.1162/rest_a_01168</a>.
</p>


<h3>Details</h3>

<p>The package <code>QTE.RD</code> includes four main functions:
</p>

<ul>
<li> <p><code>rd.qte</code> estimates QTEs and provides uniform confidence bands, with or without covariates,
and with or without robust bias correction.
</p>
</li>
<li> <p><code>rdq.test</code> conducts tests for three hypotheses, related to the significance of
treatment effects, homogeneous treatment effects, and uniformly positive or negative treatment effects.
</p>
</li>
<li> <p><code>rdq.bandwidth</code> implements two bandwidth selection rules:
the cross-validation bandwidth and the MSE optimal bandwidth.
</p>
</li>
<li> <p><code>plot.qte</code> generates figures summarizing the treatment effects along with their confidence bands.
</p>
</li></ul>



<h3>Author(s)</h3>


<ul>
<li><p> Zhongjun Qu <a href="mailto:qu@bu.edu">qu@bu.edu</a>
</p>
</li>
<li><p> Jungmo Yoon <a href="mailto:jmyoon@hanyang.ac.kr">jmyoon@hanyang.ac.kr</a>
</p>
</li></ul>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>

<hr>
<h2 id='cv.bandwidth'>Cross-validation bandwidth</h2><span id='topic+cv.bandwidth'></span>

<h3>Description</h3>

<p><code>cv.bandwidth</code> implements the cross-validation bandwidth selection rule. The function <code>rdq.bandwidth</code> calls this function to obtain the CV bandwidth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.bandwidth(y, x, z, dz, x0, val, xl, order, bdy)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.bandwidth_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_x">x</code></td>
<td>
<p>the running variable.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_z">z</code></td>
<td>
<p>additional covariates.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_dz">dz</code></td>
<td>
<p>the number of covariates z.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_val">val</code></td>
<td>
<p>a set of candidate values for the CV bandwidth.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_xl">xl</code></td>
<td>
<p>if <em>xl=0.5</em>, the CV bandwidth is computed using the 50% of observations closest to <code class="reqn">x_0</code>.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_order">order</code></td>
<td>
<p>either 1 or 2. When <em>order=1</em>, a local linear regression is used, and
when <em>order=2</em>, a local quadratic regression is used.</p>
</td></tr>
<tr><td><code id="cv.bandwidth_+3A_bdy">bdy</code></td>
<td>
<p>either 0 or 1. When <em>bdy=1</em>, the CV bandwidth is computed by
treating x as a boundary point. Otherwise, x is treated as an interior point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>h.cv</dt><dd><p>the selected CV bandwidth values at the median.</p>
</dd>
<dt>cand</dt><dd><p>values of the criterion function evaluated at each of candidate value.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>


<h3>See Also</h3>

<p><a href="#topic+rdq.bandwidth">rdq.bandwidth</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
cv.bandwidth(y=y, x=x, z=NULL, dz=0, x0=0, val=c(1,2,3,4), xl=0.5, order=2, bdy=1)
cv.bandwidth(y=y, x=x, z=NULL, dz=0, x0=0, val=c(1,2,3,4), xl=0.5, order=1, bdy=1)

</code></pre>

<hr>
<h2 id='depa'>Epanechnikov kernel</h2><span id='topic+depa'></span>

<h3>Description</h3>

<p>Epanechnikov kernel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depa(xx, loc = 0, scale = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="depa_+3A_xx">xx</code></td>
<td>
<p>the evaluation points.</p>
</td></tr>
<tr><td><code id="depa_+3A_loc">loc</code></td>
<td>
<p>the location parameter (normalized to be 0).</p>
</td></tr>
<tr><td><code id="depa_+3A_scale">scale</code></td>
<td>
<p>the scale parameter (normalized to be 1).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>depa(0)
depa(seq(-1,1,by=0.05))

</code></pre>

<hr>
<h2 id='make.band'>Uniform confidence bands for QTE</h2><span id='topic+make.band'></span>

<h3>Description</h3>

<p><code>make.band</code> constructs uniform confidence bands using the output of <code>rdq.sim</code>.
The function <code>rdq.band</code> calls this function to generates uniform bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.band(n.sam,Dc.p,Dc.m,Dr.p,Dr.m,dz,cov,taus,hh,Qy.p,Qy.m,
     bias.p,bias.m,alpha,n.sim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.band_+3A_n.sam">n.sam</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="make.band_+3A_dc.p">Dc.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_dc.m">Dc.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_dr.p">Dr.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau) - D_{2,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_dr.m">Dr.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau) - D_{2,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_dz">dz</code></td>
<td>
<p>the number of covariates</p>
</td></tr>
<tr><td><code id="make.band_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_taus">taus</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="make.band_+3A_hh">hh</code></td>
<td>
<p>the bandwidth values.</p>
</td></tr>
<tr><td><code id="make.band_+3A_qy.p">Qy.p</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_qy.m">Qy.m</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_bias.p">bias.p</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_bias.m">bias.m</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level.</p>
</td></tr>
<tr><td><code id="make.band_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulation repetitions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>qte</dt><dd><p>QTE estimates without bias correction.</p>
</dd>
<dt>qte.r</dt><dd><p>QTE estimates with bias correction.</p>
</dd>
<dt>uband</dt><dd><p>uniform confidence band for QTE without bias correction.</p>
</dd>
<dt>uband.r</dt><dd><p>uniform confidence band for QTE with robust bias correction.</p>
</dd>
<dt>sig</dt><dd><p>standard errors for the bias-uncorrected QTE estimates.</p>
</dd>
<dt>sig.r</dt><dd><p>standard errors for the bias-corrected QTE estimates. The values reflect
the impact of the bias correction on the estimation precision.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="#topic+rdq.band">rdq.band</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
tlevel2 = c(0.05,tlevel,0.95)
hh = rep(2,length(tlevel))
hh2 = rep(2,length(tlevel2))
sel = tlevel2 %in% tlevel

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel2,h.tau=hh2,cov=0)
delta = c(0.05,0.09,0.14,0.17,0.19,0.17,0.14,0.09,0.05)
fp = rdq.condf(x=x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=tlevel,taul=tlevel2,delta=delta,cov=0)
fm = rdq.condf(x=x,Q=ab$qm.est,bcoe=ab$bcoe.m,taus=tlevel,taul=tlevel2,delta=delta,cov=0)
bp = rdq.bias(y[d==1],x[d==1],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fp$ff[(d==1),],cov=0)
bm = rdq.bias(y[d==0],x[d==0],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fm$ff[(d==0),],cov=0)

sa = rdq.sim(x=x,d=d,x0=0,z0=NULL,dz=0,cov=0,tt=tlevel,hh,hh,fxp=fp$ff,fxm=fm$ff,n.sim=200)
ba = make.band(n,Dc.p=sa$dcp,Dc.m=sa$dcm,Dr.p=sa$drp,Dr.m=sa$drm,dz=0,cov=0,
taus=tlevel,hh,Qy.p=as.matrix(ab$qp.est[sel,]),Qy.m=as.matrix(ab$qm.est[sel,]),
bias.p=bp$bias,bias.m=bm$bias,alpha=0.1,n.sim=200)

</code></pre>

<hr>
<h2 id='make.band.cq'>Uniform confidence bands for conditional quantile processes</h2><span id='topic+make.band.cq'></span>

<h3>Description</h3>

<p><code>make.band.cq</code> constructs uniform confidence bands for conditional quantile processes as functions of tau for each side of the cutoff.
See <code>make.band</code> as well. The function <code>rdq.band</code> calls this function to generates uniform bands for conditional quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.band.cq(n.sam,Dc.p,Dc.m,Dr.p,Dr.m,dz,cov,taus,hh,Qy.p,Qy.m,
     bias.p,bias.m,alpha,n.sim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.band.cq_+3A_n.sam">n.sam</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_dc.p">Dc.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_dc.m">Dc.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_dr.p">Dr.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau) - D_{2,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_dr.m">Dr.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau) - D_{2,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_dz">dz</code></td>
<td>
<p>the number of covariates.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_taus">taus</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_hh">hh</code></td>
<td>
<p>the bandwidth values.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_qy.p">Qy.p</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_qy.m">Qy.m</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_bias.p">bias.p</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_bias.m">bias.m</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level.</p>
</td></tr>
<tr><td><code id="make.band.cq_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulation repetitions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>qp</dt><dd><p>conditional quantile estimates at <code class="reqn">x_{0}^{+}</code> (i.e., above the cutoff) without bias correction.</p>
</dd>
<dt>qp.r</dt><dd><p>bias corrected conditional quantile estimates at <code class="reqn">x_{0}^{+}</code>.</p>
</dd>
<dt>qm</dt><dd><p>conditional quantile estimates at <code class="reqn">x_{0}^{-}</code> (i.e., below the cutoff) without bias correction.</p>
</dd>
<dt>qm.r</dt><dd><p>bias corrected conditional quantile estimates at <code class="reqn">x_{0}^{-}</code>.</p>
</dd>
<dt>ubandp</dt><dd><p>uniform confidence band for conditional quantiles at <code class="reqn">x_{0}^{+}</code>
without bias correction.</p>
</dd>
<dt>ubandp.r</dt><dd><p>uniform confidence band for conditional quantiles at <code class="reqn">x_{0}^{+}</code>
with robust bias correction.</p>
</dd>
<dt>ubandm</dt><dd><p>uniform confidence band for conditional quantiles at <code class="reqn">x_{0}^{-}</code>
without bias correction.</p>
</dd>
<dt>ubandm.r</dt><dd><p>uniform confidence band for conditional quantiles at <code class="reqn">x_{0}^{-}</code>
with robust bias correction.</p>
</dd>
<dt>sp</dt><dd><p>standard errors of the conditional quantile estimates without bias correction
at <code class="reqn">x_{0}^{+}</code>.</p>
</dd>
<dt>sp.r</dt><dd><p>standard errors of the conditional quantile estimates with robust
bias correction at <code class="reqn">x_{0}^{+}</code>.</p>
</dd>
<dt>sm</dt><dd><p>standard errors of the conditional quantile estimates without bias correction
at <code class="reqn">x_{0}^{-}</code>.</p>
</dd>
<dt>sm.r</dt><dd><p>standard errors of the conditional quantile estimates with robust
bias correction at <code class="reqn">x_{0}^{-}</code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="#topic+make.band">make.band</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
tlevel2 = c(0.05,tlevel,0.95)
hh = rep(2,length(tlevel))
hh2 = rep(2,length(tlevel2))
sel = tlevel2 %in% tlevel

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel2,h.tau=hh2,cov=0)
delta = c(0.05,0.09,0.14,0.17,0.19,0.17,0.14,0.09,0.05)
fp = rdq.condf(x=x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=tlevel,taul=tlevel2,delta,cov=0)
fm = rdq.condf(x=x,Q=ab$qm.est,bcoe=ab$bcoe.m,taus=tlevel,taul=tlevel2,delta,cov=0)
bp = rdq.bias(y[d==1],x[d==1],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fp$ff[(d==1),],cov=0)
bm = rdq.bias(y[d==0],x[d==0],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fm$ff[(d==0),],cov=0)

sa = rdq.sim(x=x,d=d,x0=0,z0=NULL,dz=0,cov=0,tt=tlevel,hh,hh,fxp=fp$ff,fxm=fm$ff,n.sim=200)
ba.cq = make.band.cq(n,Dc.p=sa$dcp,Dc.m=sa$dcm,Dr.p=sa$drp,Dr.m=sa$drm,dz=0,cov=0,
taus=tlevel,hh,Qy.p=as.matrix(ab$qp.est[sel,]),Qy.m=as.matrix(ab$qm.est[sel,]),
bias.p=bp$bias,bias.m=bm$bias,alpha=0.1,n.sim=200)

</code></pre>

<hr>
<h2 id='plot.qte'>QTE plots</h2><span id='topic+plot.qte'></span>

<h3>Description</h3>

<p><code>plot.qte</code> generates plots summarizing the QTE estimates and their uniform confidence bands, helping users visualize the results.
It also makes plots for conditional quantile processes for each side of the cutoff.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qte'
plot(x, ptype = 1, ytext = NULL, mtext = NULL, subtext = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.qte_+3A_x">x</code></td>
<td>
<p>an object of class &quot;qte&quot; or &quot;summary.qte&quot; produce by <code>rd.qte</code>.</p>
</td></tr>
<tr><td><code id="plot.qte_+3A_ptype">ptype</code></td>
<td>
<p>either 1 or 2. Set <em>ptype=1</em> for the QTE plots, and
<em>ptype=2</em> for the conditional quantile plots. The default value is 1.</p>
</td></tr>
<tr><td><code id="plot.qte_+3A_ytext">ytext</code></td>
<td>
<p>the y-axis label.</p>
</td></tr>
<tr><td><code id="plot.qte_+3A_mtext">mtext</code></td>
<td>
<p>the title of the plot.</p>
</td></tr>
<tr><td><code id="plot.qte_+3A_subtext">subtext</code></td>
<td>
<p>the subtitles (used for the conditional quantile plots only).</p>
</td></tr>
<tr><td><code id="plot.qte_+3A_...">...</code></td>
<td>
<p>optional arguments to plot</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot(s) of the QTE estimates and uniform confidence bands.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
A &lt;- rd.qte(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,bias=1)
plot(A)

y.text = "test scores"
m.text = "QTE and Uniform band"
plot(A,ytext=y.text,mtext=m.text)

A2 &lt;- summary(A,alpha=0.1)
plot(A2)

z = sample(c(0,1),n,replace=TRUE)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
A &lt;- rd.qte(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,bdw=2,cov=1,bias=1)
A2 &lt;- summary(A,alpha=0.1)

y.text = "test scores"
m.text = c("D=0","D=1")
plot(A2,ytext=y.text,mtext=m.text)

# conditional quantile plots
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
A &lt;- rd.qte(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,bias=1)
A2 &lt;- summary(A,alpha=0.1)

y.text = "test scores"
m.text = "Conditional quantile functions"
sub.text = c("D=0 group","D=1 group")
plot(A2,ptype=2,ytext=y.text,mtext=m.text,subtext=sub.text)


</code></pre>

<hr>
<h2 id='print.band.qte'>Print a band.qte object</h2><span id='topic+print.band.qte'></span>

<h3>Description</h3>

<p>Print a band.qte object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'band.qte'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.band.qte_+3A_x">x</code></td>
<td>
<p>object returned from <code>band.qte</code>.</p>
</td></tr>
<tr><td><code id="print.band.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.bw.qte'>Print a bw.qte object</h2><span id='topic+print.bw.qte'></span>

<h3>Description</h3>

<p>Print a bw.qte object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bw.qte'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bw.qte_+3A_x">x</code></td>
<td>
<p>object returned from <code>bandwidth.qte</code>.</p>
</td></tr>
<tr><td><code id="print.bw.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.qte'>Print a qte object.</h2><span id='topic+print.qte'></span>

<h3>Description</h3>

<p>Print a qte object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qte'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.qte_+3A_x">x</code></td>
<td>
<p>object returned from <code>rd.qte</code>.</p>
</td></tr>
<tr><td><code id="print.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.qte'>Print a summary.qte object</h2><span id='topic+print.summary.qte'></span>

<h3>Description</h3>

<p>Print a summary.qte object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.qte'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.qte_+3A_x">x</code></td>
<td>
<p>object returned from <code>summary.qte</code>.</p>
</td></tr>
<tr><td><code id="print.summary.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='print.test.qte'>Print a test.qte object</h2><span id='topic+print.test.qte'></span>

<h3>Description</h3>

<p>Print a test.qte object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'test.qte'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.test.qte_+3A_x">x</code></td>
<td>
<p>object returned from <code>test.qte</code>.</p>
</td></tr>
<tr><td><code id="print.test.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>

<hr>
<h2 id='rd.qte'>QTE and its uniform confidence band.</h2><span id='topic+rd.qte'></span>

<h3>Description</h3>

<p><code>rd.qte</code> is the main function of the QTE.RD package. If <em>cov=1</em>, it estimates QTE for each subgroup defined by covariates.
If <em>cov=0</em>, it estimate QTE without covariates. If <em>bias=1</em>, it corrects the bias in QTE estimates and obtains the robust
confidence band and if <em>bias=0</em>, no bias correction is implemented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rd.qte(y, x, d, x0, z0=NULL, tau, bdw, cov, bias)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rd.qte_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.
For example, if a female dummy z is included, z0 = 1 may indicate the female subgroup.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_tau">tau</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_bdw">bdw</code></td>
<td>
<p>the bandwidth value(s). If 'bdw' is a scalar, it is interpreted as the
bandwidth for the median. See the function <code>rdq.bandwidth</code> for how to select this bandwidth.
The bandwidths for the rest of the quantiles are computed automatically using the formula of Yu and Jones (1998).
If it is a vector with the same dimension as 'tau',
the function will use these values for the respective quantiles accordingly.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set cov=1 when covariates are present in the model;
otherwise set cov=0.</p>
</td></tr>
<tr><td><code id="rd.qte_+3A_bias">bias</code></td>
<td>
<p>either 0 or 1. If bias=1, the QTE estimate is bias corrected and
the robust confidence band in Qu, Yoon, and Perron (2024) is produced.
If bias=0, no bias correction is implemented.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>qte</dt><dd><p>QTE estimates.</p>
</dd>
<dt>uband</dt><dd><p>uniform confidence band for QTE. If <em>bias=1</em>, the band is robust
capturing the effect of the bias correction. If <em>bias=0</em>, no bias correction is implemented.</p>
</dd>
<dt>sigma</dt><dd><p>standard errors for each quantile level. If <em>bias=1</em>, its value
captures the effect of the bias correction. If <em>bias=0</em>, no bias correction is implemented.</p>
</dd>
<dt>qp.est</dt><dd><p>conditional quantile estimates on the right side of <code class="reqn">x_{0}</code> (or for the <code class="reqn">D=1</code> group).</p>
</dd>
<dt>qm.est</dt><dd><p>conditional quantile estimates on the left side of <code class="reqn">x_{0}</code> (or for the <code class="reqn">D=0</code> group).</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>
<p>Keming Yu and M. C. Jones (1998), “Local Linear Quantile Regression,”
Journal of the American Statistical Association, 93(441), 228–237; https://doi.org/10.2307/2669619
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n &lt;- 500
x &lt;- runif(n,min=-4,max=4)
d &lt;- (x &gt; 0)
y &lt;- x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel &lt;- seq(0.1,0.9,by=0.1)
A &lt;- rd.qte(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,bias=1)

# (continued) With covariates
z &lt;- sample(c(0,1),n,replace=TRUE)
y &lt;- x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
A &lt;- rd.qte(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,bdw=2,cov=1,bias=1)

</code></pre>

<hr>
<h2 id='rdq'>Estimate the QTE under the RDD</h2><span id='topic+rdq'></span>

<h3>Description</h3>

<p><code>rdq</code> estimates QTE under the RDD with or without covariates. This function is used by <code>rd.qte</code> to generate QTE estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq(y, x, d, x0, z0 = NULL, tau, h.tau, cov)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rdq_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rdq_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rdq_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.
For example, if a female dummy is included, z0 = 1 may indicate the female subgroup.</p>
</td></tr>
<tr><td><code id="rdq_+3A_tau">tau</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rdq_+3A_h.tau">h.tau</code></td>
<td>
<p>the bandwidth values (specified for each quantile level).</p>
</td></tr>
<tr><td><code id="rdq_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>qte</dt><dd><p>QTE estimates.</p>
</dd>
<dt>qp.est</dt><dd><p>conditional quantile estimates on the right side of <code class="reqn">x_{0}</code> (or for the D=1 group).</p>
</dd>
<dt>qm.est</dt><dd><p>conditional quantile estimates on the left side of <code class="reqn">x_{0}</code> (or for the D=0 group).</p>
</dd>
<dt>bcoe.p</dt><dd><p>quantile regression coefficients on the right side of <code class="reqn">x_{0}</code>.</p>
</dd>
<dt>bcoe.m</dt><dd><p>quantile regression coefficients on the left side of <code class="reqn">x_{0}</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
hh = rep(2,length(tlevel))
rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,h.tau=hh,cov=0)

# (continued) With covariates
z = sample(c(0,1),n,replace=TRUE)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
rdq(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,h.tau=hh,cov=1)

</code></pre>

<hr>
<h2 id='rdq.band'>Uniform confidence bands for QTE</h2><span id='topic+rdq.band'></span>

<h3>Description</h3>

<p><code>rdq.band</code> produces uniform confidence bands for QTEs with and without bias correction. This function is used by <code>rd.qte</code> to generate uniform bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.band(y, x, d, x0, z0 = NULL, tau, bdw, cov, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.band_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.
For example, if a female dummy is included, z0 = 1 may indicate the female subgroup.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_tau">tau</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_bdw">bdw</code></td>
<td>
<p>the bandwidth value(s). If 'bdw' is a scalar, it is interpreted as the
bandwidth for the median. The bandwidths for the rest of the quantiles are
computed automatically using the formula in Yu and Jones (1998).
If it is a vector with the same dimension as 'tau',
the function will use these values for the respective quantiles accordingly.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set cov=1 when covariates are present in the model;
otherwise set cov=0.</p>
</td></tr>
<tr><td><code id="rdq.band_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level.</p>
</td></tr>
</table>


<h3>Value</h3>


<dl>
<dt>qte</dt><dd><p>QTE estimates without bias correction.</p>
</dd>
<dt>qte.cor</dt><dd><p>bias corrected QTE estimates.</p>
</dd>
<dt>uband</dt><dd><p>uniform confidence band for QTE without bias correction.</p>
</dd>
<dt>uband.robust</dt><dd><p>uniform confidence band for QTE with robust bias correction.</p>
</dd>
<dt>sig</dt><dd><p>standard errors for each quantile level for estimates without bias correction.</p>
</dd>
<dt>sig.r</dt><dd><p>standard errors for each quantile level for estimates with robust bias correction.</p>
</dd>
<dt>uband.p</dt><dd><p>uniform confidence band for the conditional quantile estimates on the right side of the cutoff, without bias correction.</p>
</dd>
<dt>uband.robust.p</dt><dd><p>uniform confidence band for the conditional quantile estimates on the right side of the cutoff, robust to the bias correction.</p>
</dd>
<dt>uband.m</dt><dd><p>uniform confidence band for the conditional quantile estimates on the left side of the cutoff, without bias correction.</p>
</dd>
<dt>uband.robust.m</dt><dd><p>uniform confidence band for the conditional quantile estimates on the left side of the cutoff, robust to the bias correction.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>
<p>Keming Yu and M. C. Jones (1998), “Local Linear Quantile Regression,”
Journal of the American Statistical Association, 93(441), 228–237; https://doi.org/10.2307/2669619
</p>


<h3>See Also</h3>

<p><a href="#topic+rd.qte">rd.qte</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
D = rdq.band(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,alpha=0.1)

# (continued) With covariates
z = sample(c(0,1),n,replace=TRUE)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
D = rdq.band(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,bdw=2,cov=1,alpha=0.1)

</code></pre>

<hr>
<h2 id='rdq.bandwidth'>Bandwidth estimation</h2><span id='topic+rdq.bandwidth'></span>

<h3>Description</h3>

<p><code>rdq.bandwidth</code> implements two bandwidth selection rules and obtains the cross-validation (CV) bandwidth and the MSE optimal bandwidth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.bandwidth(y, x, d, x0, z0=NULL, cov, cv, val,hp=NULL,pm.each=1,
     bdy=1,p.order=1,xl=0.5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.bandwidth_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> when covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_cv">cv</code></td>
<td>
<p>either 0 or 1. When <em>cv=1</em>, both the CV and MSE optimal bandwidths
are produced. When <em>cv=0</em>, the MSE optimal bandwidth is produced.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_val">val</code></td>
<td>
<p>a set of candidate values for the CV bandwidth.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_hp">hp</code></td>
<td>
<p>a pilot bandwidth to estimate nuisance parameters for the MSE optimal bandwidth.
It will be used only if <em>cv=0</em>. If <em>cv=1</em>, the CV bandwidth will be used
as the pilot bandwidth to compute the MSE optimal bandwidth.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_pm.each">pm.each</code></td>
<td>
<p>either 0 or 1. When <em>pm.each=1</em>, the CV bandwidths for each side of the cutoff will be obtained separately.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_bdy">bdy</code></td>
<td>
<p>either 0 or 1. When <em>bdy=1</em>, the CV bandwidth uses the boundary point procdure.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_p.order">p.order</code></td>
<td>
<p>either 1 or 2. When <em>p.order=1</em>, a local linear regression is used, and
when <em>p.order=2</em>, a local quadratic regression is used.</p>
</td></tr>
<tr><td><code id="rdq.bandwidth_+3A_xl">xl</code></td>
<td>
<p>if <em>xl=0.5</em>, the CV bandwidth use the 50% of observations closest to <code class="reqn">x_0</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>cv</dt><dd><p>the selected CV bandwidth at the median.</p>
</dd>
<dt>opt.p</dt><dd><p>the MSE optimal bandwidth at the median from the right side of <code class="reqn">x_0</code>.</p>
</dd>
<dt>opt.m</dt><dd><p>the MSE optimal bandwidth at the median from the left side of <code class="reqn">x_0</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
rdq.bandwidth(y=y,x=x,d=d,x0=0,z0=NULL,cov=0,cv=1,val=(1:4))
rdq.bandwidth(y=y,x=x,d=d,x0=0,z0=NULL,cov=0,cv=0,val=(1:4),hp=2)

# (continued) With covariates
z = sample(c(0,1),n,replace=TRUE)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
rdq.bandwidth(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),cov=1,cv=1,val=(1:4),bdy=1,p.order=1)

</code></pre>

<hr>
<h2 id='rdq.bias'>Bias estimation</h2><span id='topic+rdq.bias'></span>

<h3>Description</h3>

<p><code>rdq.bias</code> estimates the bias terms using the local quadratic quantile regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.bias(y, x, dz, x0, z0, taus, h.tau, h.tau2, fx, cov)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.bias_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_dz">dz</code></td>
<td>
<p>the number of covariates.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_taus">taus</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_h.tau">h.tau</code></td>
<td>
<p>the bandwidth values (specified for each quantile level), for estimating conditional quantiles.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_h.tau2">h.tau2</code></td>
<td>
<p>the bandwidth values for the local quadratic quantile regression, for estimating the bias terms.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_fx">fx</code></td>
<td>
<p>conditional density estimates.</p>
</td></tr>
<tr><td><code id="rdq.bias_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>bias</dt><dd><p>the bias estimates.</p>
</dd>
<dt>b.hat</dt><dd><p>the estimate of the <code class="reqn">B_{v}(x,z,\tau)</code> term. See Qu, Yoon, and Perron (2024).</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
tlevel2 = c(0.05,tlevel,0.95)
hh = rep(2,length(tlevel))
hh2 = rep(2,length(tlevel2))

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel2,h.tau=hh2,cov=0)
delta = c(0.05,0.09,0.14,0.17,0.19,0.17,0.14,0.09,0.05)
hh = rep(2,length(tlevel))
fe = rdq.condf(x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=tlevel,taul=tlevel2,delta=delta,cov=0)
be = rdq.bias(y[d==1],x[d==1],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fe$ff[(d==1),],cov=0)


</code></pre>

<hr>
<h2 id='rdq.condf'>Conditional density estimation</h2><span id='topic+rdq.condf'></span>

<h3>Description</h3>

<p><code>rdq.condf</code> estimates conditional density functions by using the differencing method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.condf(x, Q, bcoe, taus, taul, delta, cov)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.condf_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_q">Q</code></td>
<td>
<p>a vector of estimated conditional quantiles.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_bcoe">bcoe</code></td>
<td>
<p>quantile regression coefficient estimates.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_taus">taus</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_taul">taul</code></td>
<td>
<p>a vector of quantiles used for the conditional density estimation.
It is needed to estimate the tail parts of conditional density functions more precisely.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_delta">delta</code></td>
<td>
<p>bandwidths for estimating the conditional density.</p>
</td></tr>
<tr><td><code id="rdq.condf_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>conditional density function estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
hh = rep(2,length(tlevel))

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,h.tau=hh,cov=0)
delta = 0.186
fe = rdq.condf(x=x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=0.5,taul=tlevel,delta=delta,cov=0)


</code></pre>

<hr>
<h2 id='rdq.sim'>Simulation the asymptotic distributions</h2><span id='topic+rdq.sim'></span>

<h3>Description</h3>

<p><code>rdq.sim</code> produces iid draws from the asymptotic distribution of the conditional quantile process estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.sim(x, d, x0, z0, dz, cov, tt, hh, hh2, fxp, fxm, n.sim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.sim_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_dz">dz</code></td>
<td>
<p>the number of covariates.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_tt">tt</code></td>
<td>
<p>a vector of quantiles.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_hh">hh</code></td>
<td>
<p>the bandwidth values (specified for each quantile level).</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_hh2">hh2</code></td>
<td>
<p>the bandwidth values for the local quadratic quantile regression.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_fxp">fxp</code></td>
<td>
<p>conditional density estimates on the right side of <code class="reqn">x_0</code>.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_fxm">fxm</code></td>
<td>
<p>conditional density estimates on the left side of <code class="reqn">x_0</code>.</p>
</td></tr>
<tr><td><code id="rdq.sim_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulation repetitions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>dcp</dt><dd><p>realizations from the asymptotic distribution of the conditional quantile process, from the right side of <code class="reqn">x_0</code>.</p>
</dd>
<dt>dcm</dt><dd><p>realizations from the asymptotic distribution of the conditional quantile process, from the left side of <code class="reqn">x_0</code>.</p>
</dd>
<dt>drp</dt><dd><p>realizations from the asymptotic distribution of the bias corrected conditional quantile process, from the right side of <code class="reqn">x_0</code>.</p>
</dd>
<dt>drm</dt><dd><p>realizations from the asymptotic distribution of the bias corrected conditional quantile process, from the left side of <code class="reqn">x_0</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
tlevel2 = c(0.05,tlevel,0.95)
hh = rep(2,length(tlevel))
hh2 = rep(2,length(tlevel2))

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel2,h.tau=hh2,cov=0)
delta = c(0.05,0.09,0.14,0.17,0.19,0.17,0.14,0.09,0.05)
fp = rdq.condf(x=x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=tlevel,taul=tlevel2,delta,cov=0)
fm = rdq.condf(x=x,Q=ab$qm.est,bcoe=ab$bcoe.m,taus=tlevel,taul=tlevel2,delta,cov=0)
sa = rdq.sim(x=x,d=d,x0=0,z0=NULL,dz=0,cov=0,tt=tlevel,hh,hh,fxp=fp$ff,fxm=fm$ff,n.sim=200)

</code></pre>

<hr>
<h2 id='rdq.test'>tests for QTE</h2><span id='topic+rdq.test'></span>

<h3>Description</h3>

<p><code>rdq.test</code> provides testing results for hypotheses on the treatment effects concerning (i) treatment significance, (ii) homogeneity of effects over quantiles,
and (iii) positive or negative dominance hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rdq.test(y,x,d,x0,z0=NULL,tau,bdw,cov,bias,alpha,type,std.opt=1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rdq.test_+3A_y">y</code></td>
<td>
<p>a numeric vector, the outcome variable.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_x">x</code></td>
<td>
<p>a vector (or a matrix) of covariates, the first column is the running variable.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_d">d</code></td>
<td>
<p>a numeric vector, the treatment status.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_x0">x0</code></td>
<td>
<p>the cutoff point.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_z0">z0</code></td>
<td>
<p>the value of the covariates at which to evaluate the effects.
For example, if a female dummy is included, z0 = 1 indicates the female subgroup.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_tau">tau</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_bdw">bdw</code></td>
<td>
<p>the bandwidth value(s). If 'bdw' is a scalar, it is interpreted as the
bandwidth for the median. The bandwidths for the rest of the quantiles are
computed automatically using the formula in Yu and Jones (1998).
If it is a vector with the same dimension as 'tau',
the function will use these values for the respective quantiles accordingly.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set cov=1 when covariates are present in the model;
otherwise set cov=0.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_bias">bias</code></td>
<td>
<p>either 0 or 1. If bias=1, the QTE estimate is bias corrected and
the robust confidence band in Qu, Yoon, and Perron (2024) is produced.
If bias=0, no bias correction is implemented.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level.
When alpha=0.1, one will get a 90% uniform band.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_type">type</code></td>
<td>
<p>a value in 1&ndash;4. Set <em>type</em> to 1 to test the null hypothesis of a zero
treatment effect against the alternative hypothesis of significant treatment effects;
set <em>type</em> to 2 to test the null hypothesis of homogeneous treatment against heterogeneous treatment effects;
set <em>type</em> to 3 to test the null hypothesis of uniformly non-negative treatment effects against the presence of negative effects;
and set <em>type</em> to 4 to test the null hypothesis of uniformly non-positive treatment effects against the presence of positive effects at some quantiles.</p>
</td></tr>
<tr><td><code id="rdq.test_+3A_std.opt">std.opt</code></td>
<td>
<p>either 0 or 1. If <em>std.opt=1</em>, the test statistic is standardized so that
the variance is equalized across quantiles; if <em>std.opt=0</em>, the test is not standardized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>statistic</dt><dd><p>test statistics.</p>
</dd>
<dt>cr.va</dt><dd><p>critical values.</p>
</dd>
<dt>p.value</dt><dd><p>p values.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
B = rdq.test(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,bias=1,alpha=c(0.1,0.05),type=c(1,2,3))

# (continued) With covariates
z = sample(c(0,1),n,replace=TRUE)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
B = rdq.test(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,bdw=2,cov=1,bias=1,
alpha=c(0.1,0.05),type=c(3,4))


</code></pre>

<hr>
<h2 id='run.test'>Run tests</h2><span id='topic+run.test'></span>

<h3>Description</h3>

<p><code>run.test</code> performs hypothesis testing. The function <code>rdq.test</code> calls this function to run tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.test(n.sam,dz,taus,hh,Dc.p,Dc.m,Dr.p,Dr.m,Qy.p,Qy.m,bias.p,bias.m,
     cov,bias,alpha,n.sim,test.type,std.opt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run.test_+3A_n.sam">n.sam</code></td>
<td>
<p>the sample size.</p>
</td></tr>
<tr><td><code id="run.test_+3A_dz">dz</code></td>
<td>
<p>the number of covariates.</p>
</td></tr>
<tr><td><code id="run.test_+3A_taus">taus</code></td>
<td>
<p>a vector of quantiles of interest.</p>
</td></tr>
<tr><td><code id="run.test_+3A_hh">hh</code></td>
<td>
<p>the bandwidth values.</p>
</td></tr>
<tr><td><code id="run.test_+3A_dc.p">Dc.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_dc.m">Dc.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_dr.p">Dr.p</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{+},z,\tau) - D_{2,v}(x_{0}^{+},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_dr.m">Dr.m</code></td>
<td>
<p>simulated values from <code class="reqn">D_{1,v}(x_{0}^{-},z,\tau) - D_{2,v}(x_{0}^{-},z,\tau)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_qy.p">Qy.p</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_qy.m">Qy.m</code></td>
<td>
<p>estimated conditional quantiles at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_bias.p">bias.p</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{+},z)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_bias.m">bias.m</code></td>
<td>
<p>estimated bias terms at <code class="reqn">(x_{0}^{-},z)</code>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_cov">cov</code></td>
<td>
<p>either 0 or 1. Set <em>cov=1</em> if covariates are present in the model;
otherwise set <em>cov=0</em>.</p>
</td></tr>
<tr><td><code id="run.test_+3A_bias">bias</code></td>
<td>
<p>either 0 or 1. If <em>bias=1</em>, the QTE estimate is bias corrected and
the robust confidence band in Qu, Yoon, and Perron (2024) is produced.
If <em>bias=0</em>, no bias correction is implemented.</p>
</td></tr>
<tr><td><code id="run.test_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level.</p>
</td></tr>
<tr><td><code id="run.test_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulation repetitions.</p>
</td></tr>
<tr><td><code id="run.test_+3A_test.type">test.type</code></td>
<td>
<p>a value in 1&ndash;4. Set <em>type</em> to 1 to test the null hypothesis of a zero
treatment effect against the alternative hypothesis of significant treatment effects;
set <em>type</em> to 2 to test the null hypothesis of homogeneous treatment against heterogeneous treatment effects;
set <em>type</em> to 3 to test the null hypothesis of uniformly non-negative treatment effects against the presence of negative effects;
and set <em>type</em> to 4 to test the null hypothesis of uniformly non-positive treatment effects against the presence of positive effects at some quantiles.</p>
</td></tr>
<tr><td><code id="run.test_+3A_std.opt">std.opt</code></td>
<td>
<p>either 0 or 1. If <em>std.opt=1</em>, the test statistic is standardized so that
the variance is equalized across quantiles; if <em>std.opt=0</em>, the test is not standardized.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>test.stat</dt><dd><p>test statistics.</p>
</dd>
<dt>cr.value</dt><dd><p>critical values.</p>
</dd>
<dt>p.val</dt><dd><p>p values.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>


<h3>See Also</h3>

<p><a href="#topic+rdq.test">rdq.test</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 500
x = runif(n,min=-4,max=4)
d = (x &gt; 0)
y = x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
tlevel2 = c(0.05,tlevel,0.95)
hh = rep(2,length(tlevel))
hh2 = rep(2,length(tlevel2))
sel = tlevel2 %in% tlevel

ab = rdq(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel2,h.tau=hh2,cov=0)
delta = c(0.05,0.09,0.14,0.17,0.19,0.17,0.14,0.09,0.05)
fp = rdq.condf(x=x,Q=ab$qp.est,bcoe=ab$bcoe.p,taus=tlevel,taul=tlevel2,delta,cov=0)
fm = rdq.condf(x=x,Q=ab$qm.est,bcoe=ab$bcoe.m,taus=tlevel,taul=tlevel2,delta,cov=0)
bp = rdq.bias(y[d==1],x[d==1],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fp$ff[(d==1),],cov=0)
bm = rdq.bias(y[d==0],x[d==0],dz=0,x0=0,z0=NULL,taus=tlevel,hh,hh,fx=fm$ff[(d==0),],cov=0)

sa = rdq.sim(x=x,d=d,x0=0,z0=NULL,dz=0,cov=0,tt=tlevel,hh,hh,fxp=fp$ff,fxm=fm$ff,n.sim=200)
bt &lt;- run.test(n,dz=0,taus=tlevel,hh,Dc.p=sa$dcp,Dc.m=sa$dcm,Dr.p=sa$drp,Dr.m=sa$drm,
Qy.p=as.matrix(ab$qp.est[sel,]),Qy.m=as.matrix(ab$qm.est[sel,]),bias.p=bp$bias,bias.m=bm$bias,
cov=0,bias=1,alpha=0.1,n.sim=200,test.type=1,std.opt=1)

</code></pre>

<hr>
<h2 id='summary.qte'>Uniform confidence band for QTE.</h2><span id='topic+summary.qte'></span>

<h3>Description</h3>

<p><code>summary.qte</code> returns uniform confidence bands and standard errors for QTE estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qte'
summary(object, alpha, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.qte_+3A_object">object</code></td>
<td>
<p>It is an object of class &quot;qte&quot; produced by <code>rd.qte</code>.</p>
</td></tr>
<tr><td><code id="summary.qte_+3A_alpha">alpha</code></td>
<td>
<p>a number between 0 and 1, the desired significance level. For example,
when alpha=0.1, one will get a 90% uniform band.</p>
</td></tr>
<tr><td><code id="summary.qte_+3A_...">...</code></td>
<td>
<p>optional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements:
</p>

<dl>
<dt>qte</dt><dd><p>QTE estimates.</p>
</dd>
<dt>uband</dt><dd><p>uniform confidence band for QTE. If <em>bias=1</em>, the band is robust
capturing the effect of the bias correction. If <em>bias=0</em>, no bias correction is implemented.</p>
</dd>
<dt>sigma</dt><dd><p>standard errors for each quantile level. If <em>bias=1</em>, its value
captures the effect of the bias correction. If <em>bias=0</em>, no bias correction is implemented.</p>
</dd>
<dt>qp.est</dt><dd><p>conditional quantile estimates on the right side of <code class="reqn">x_{0}</code> (or for the <code class="reqn">D=1</code> group).</p>
</dd>
<dt>qm.est</dt><dd><p>conditional quantile estimates on the left side of <code class="reqn">x_{0}</code> (or for the <code class="reqn">D=0</code> group).</p>
</dd>
<dt>uband.p</dt><dd><p>uniform confidence band for conditional quantiles on the right side of <code class="reqn">x_{0}</code>.</p>
</dd>
<dt>uband.m</dt><dd><p>uniform confidence band for conditional quantiles on the left side of <code class="reqn">x_{0}</code>.</p>
</dd>
</dl>



<h3>References</h3>

<p>Zhongjun Qu, Jungmo Yoon, Pierre Perron (2024), &quot;Inference on Conditional Quantile
Processes in Partially Linear Models with Applications to the Impact of Unemployment Benefits,&quot;
The Review of Economics and Statistics; https://doi.org/10.1162/rest_a_01168
</p>
<p>Zhongjun Qu and Jungmo Yoon (2019), &quot;Uniform Inference on Quantile Effects
under Sharp Regression Discontinuity Designs,&quot; Journal of Business and Economic Statistics,
37(4), 625–647; https://doi.org/10.1080/07350015.2017.1407323
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Without covariate
n &lt;- 500
x &lt;- runif(n,min=-4,max=4)
d &lt;- (x &gt; 0)
y &lt;- x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + rnorm(n)
tlevel = seq(0.1,0.9,by=0.1)
A &lt;- rd.qte(y=y,x=x,d=d,x0=0,z0=NULL,tau=tlevel,bdw=2,cov=0,bias=1)
A2 &lt;- summary(A,alpha=0.1)

# (continued) With covariates
z &lt;- sample(c(0,1),n,replace=TRUE)
y &lt;- x + 0.3*(x^2) - 0.1*(x^3) + 1.5*d + d*z + rnorm(n)
A &lt;- rd.qte(y=y,x=cbind(x,z),d=d,x0=0,z0=c(0,1),tau=tlevel,bdw=2,cov=1,bias=1)
A2 &lt;- summary(A,alpha=0.1)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
