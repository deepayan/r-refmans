<!DOCTYPE html><html lang="en"><head><title>Help for package api2lm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {api2lm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#arg_check_cooks_test'><p>Check arguments of <code>cooks_test</code></p></a></li>
<li><a href='#arg_check_dfbeta_plot'><p>Check arguments of dfbeta_plot</p></a></li>
<li><a href='#arg_check_dfbetas_plot'><p>Check arguments of dfbetas_plot</p></a></li>
<li><a href='#arg_check_dffits_test'><p>Check arguments of <code>dffits_test</code></p></a></li>
<li><a href='#arg_check_index_plot_lm'><p>Check arguments of residual_plot.lm</p></a></li>
<li><a href='#arg_check_influence_plot'><p>Check arguments of dfbetas_plot</p></a></li>
<li><a href='#arg_check_leverage_test'><p>Check arguments of <code>leverage_test</code></p></a></li>
<li><a href='#arg_check_outlier_test'><p>Check arguments of <code>outlier_test</code></p></a></li>
<li><a href='#arg_check_residual_plot_lm'><p>Check arguments of residual_plot.lm</p></a></li>
<li><a href='#auto_mfrow'><p>Automatically determine 'mfrow'</p></a></li>
<li><a href='#autoplot.confint_adjust'><p>Plot <code>confint_adjust</code> object</p></a></li>
<li><a href='#coef_compare'><p>Compare coefficients of 2 models</p></a></li>
<li><a href='#coef_matrix'><p>Return coefficient matrix</p></a></li>
<li><a href='#combine_coefs'><p>Combine coefficients</p></a></li>
<li><a href='#confint_adjust'><p>Adjust confidence intervals for multiple comparisons</p></a></li>
<li><a href='#cooks_plot'><p>Index plot of Cook's distances for <code>lm</code> object</p></a></li>
<li><a href='#cooks_stats'><p>Cook's statistics</p></a></li>
<li><a href='#cooks_test'><p>Identify influential observations</p></a></li>
<li><a href='#crime2009'><p>2009 Crime Data</p></a></li>
<li><a href='#dfbeta_plot'><p>dfbeta index plots</p></a></li>
<li><a href='#dfbetas_plot'><p>dfbetas index plots</p></a></li>
<li><a href='#dffits_plot'><p>Index plot of DFFITS values for <code>lm</code> object</p></a></li>
<li><a href='#dffits_stats'><p>DFFITS statistics</p></a></li>
<li><a href='#dffits_test'><p>Identify influential observations</p></a></li>
<li><a href='#dwaine'><p>Dwaine Studios data</p></a></li>
<li><a href='#format_perc_api2lm'><p>Format percentages</p></a></li>
<li><a href='#get_residuals'><p>Extract residuals from a model</p></a></li>
<li><a href='#home_sales'><p>Home sale prices in King County, WA</p></a></li>
<li><a href='#index_plot_dfbetas_elements'><p>Get elements for dfbetas index plot</p></a></li>
<li><a href='#index_plot_lm'><p>Index plot of statistics from of an <code>lm</code> object</p></a></li>
<li><a href='#index_plot_lm_elements'><p>Create plot elements for index_plot_lm</p></a></li>
<li><a href='#index_plot_raw'><p>Index plot helper function</p></a></li>
<li><a href='#influence_plot'><p>Influence plots</p></a></li>
<li><a href='#influence_stats'><p>Influence statistics</p></a></li>
<li><a href='#leverage_plot'><p>Index plot of leverage values for <code>lm</code> object</p></a></li>
<li><a href='#leverage_stats'><p>Leverage statistics</p></a></li>
<li><a href='#leverage_test'><p>Identify leverage points</p></a></li>
<li><a href='#outlier_plot'><p>Index plot of studentized residuals for <code>lm</code> object</p></a></li>
<li><a href='#outlier_stats'><p>Outlier statistics</p></a></li>
<li><a href='#outlier_test'><p>Identify outliers</p></a></li>
<li><a href='#plot.confint_adjust'><p>Plot <code>confint_adjust</code> x</p></a></li>
<li><a href='#predict_adjust'><p>Adjust prediction intervals for multiple comparisons</p></a></li>
<li><a href='#print.coef_matrix'><p>Print an object of class <code>coef_matrix</code> produced</p>
by the <code>coef_matrix</code> function.</a></li>
<li><a href='#print.confint_adjust'><p>Print <code>confint_adjust</code> object</p></a></li>
<li><a href='#print.predict_adjust'><p>Print <code>predict_adjust</code> object</p></a></li>
<li><a href='#residual_plot'><p>Plot residuals of a fitted model</p></a></li>
<li><a href='#residual_plot.lm'><p>Plot residuals of a fitted <code>lm</code> object</p></a></li>
<li><a href='#rloo'><p>Compute leave-one-out residuals</p></a></li>
<li><a href='#rloo.lm'><p>Compute leave-one-out residuals for 'lm' objects.</p></a></li>
<li><a href='#rplot_raw'><p>Helper function for residuals_plot.lm</p></a></li>
<li><a href='#set_abline_arglist'><p>Set default values of abline_arglist</p></a></li>
<li><a href='#set_lines_arglist'><p>Set default values of lines_arglist</p></a></li>
<li><a href='#set_text_arglist'><p>Set the default values of text_arglist if not</p>
specified by the user.</a></li>
<li><a href='#sl_plot'><p>Spread-level plot of a fitted model</p></a></li>
<li><a href='#sl_plot.lm'><p>Spread-level plot for <code>lm</code> object</p></a></li>
<li><a href='#toluca'><p>Toluca Company data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions and Data Sets for the Book "A Progressive Introduction
to Linear Models"</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Joshua P. French</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joshua P. French &lt;joshua.french@ucdenver.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simplifies aspects of linear regression analysis, particularly simultaneous inference. Additionally, supports "A Progressive Introduction to Linear Models" by Joshua French (<a href="https://jfrench.github.io/LinearRegression/">https://jfrench.github.io/LinearRegression/</a>).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), ggplot2, knitr, rmarkdown, vdiffr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-08 21:57:22 UTC; frencjos</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-08 22:32:54 UTC</td>
</tr>
</table>
<hr>
<h2 id='arg_check_cooks_test'>Check arguments of <code>cooks_test</code></h2><span id='topic+arg_check_cooks_test'></span>

<h3>Description</h3>

<p>Check arguments of <code>cooks_test</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_cooks_test(model, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_cooks_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_cooks_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all influential observations.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_dfbeta_plot'>Check arguments of dfbeta_plot</h2><span id='topic+arg_check_dfbeta_plot'></span>

<h3>Description</h3>

<p>Check arguments of dfbeta_plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_dfbeta_plot(
  model,
  id_n,
  regressors,
  add_reference,
  text_arglist,
  abline_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_dfbeta_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_dfbeta_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="arg_check_dfbeta_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_dfbeta_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="arg_check_dfbeta_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="arg_check_dfbeta_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_dfbetas_plot'>Check arguments of dfbetas_plot</h2><span id='topic+arg_check_dfbetas_plot'></span>

<h3>Description</h3>

<p>Check arguments of dfbetas_plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_dfbetas_plot(
  model,
  id_n,
  regressors,
  add_reference,
  text_arglist,
  abline_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_dfbetas_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_dfbetas_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="arg_check_dfbetas_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_dfbetas_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="arg_check_dfbetas_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="arg_check_dfbetas_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_dffits_test'>Check arguments of <code>dffits_test</code></h2><span id='topic+arg_check_dffits_test'></span>

<h3>Description</h3>

<p>Check arguments of <code>dffits_test</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_dffits_test(model, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_dffits_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_dffits_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all influential observations.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_index_plot_lm'>Check arguments of residual_plot.lm</h2><span id='topic+arg_check_index_plot_lm'></span>

<h3>Description</h3>

<p>Check arguments of residual_plot.lm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_index_plot_lm(
  model,
  stat,
  id_n,
  add_reference,
  text_arglist,
  abline_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_index_plot_lm_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_stat">stat</code></td>
<td>
<p>A function that can be applied to an <code>lm</code>
object and returns a vector of observations for each
observation used to fit the model.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="arg_check_index_plot_lm_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_influence_plot'>Check arguments of dfbetas_plot</h2><span id='topic+arg_check_influence_plot'></span>

<h3>Description</h3>

<p>Check arguments of dfbetas_plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_influence_plot(
  model,
  id_n,
  add_reference,
  alpha,
  size,
  text_arglist,
  abline_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_influence_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels
with respect to largest absolute criterion. The default
is <code>3</code> labels.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_alpha">alpha</code></td>
<td>
<p>The default quantile used for the horizontal
reference lines. The default is 0.05. See Details.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_size">size</code></td>
<td>
<p>A numeric vector of length 2 that provides
guidelines for the size of the points.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="arg_check_influence_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_leverage_test'>Check arguments of <code>leverage_test</code></h2><span id='topic+arg_check_leverage_test'></span>

<h3>Description</h3>

<p>Check arguments of <code>leverage_test</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_leverage_test(model, n, ttype, threshold)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_leverage_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_leverage_test_+3A_n">n</code></td>
<td>
<p>The number of leverage points to return. The
default is all leverage points.</p>
</td></tr>
<tr><td><code id="arg_check_leverage_test_+3A_ttype">ttype</code></td>
<td>
<p>Threshold type. The default is
<code>"half"</code>. The other options are <code>"2mean"</code> and
<code>"custom"</code>. See Details.</p>
</td></tr>
<tr><td><code id="arg_check_leverage_test_+3A_threshold">threshold</code></td>
<td>
<p>A number between 0 and 1. Any
observation with a leverage value above this number is
declared a leverage point. This is automatically
determined unless <code>ttype = "custom"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of statistics
</p>

<hr>
<h2 id='arg_check_outlier_test'>Check arguments of <code>outlier_test</code></h2><span id='topic+arg_check_outlier_test'></span>

<h3>Description</h3>

<p>Check arguments of <code>outlier_test</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_outlier_test(model, n, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_outlier_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="arg_check_outlier_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all outliers.</p>
</td></tr>
<tr><td><code id="arg_check_outlier_test_+3A_alpha">alpha</code></td>
<td>
<p>The Bonferroni-adjusted threshold at which
an outlier is identified. The default is <code>0.05</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='arg_check_residual_plot_lm'>Check arguments of residual_plot.lm</h2><span id='topic+arg_check_residual_plot_lm'></span>

<h3>Description</h3>

<p>Check arguments of residual_plot.lm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arg_check_residual_plot_lm(
  rtype,
  xaxis,
  id_n,
  smooth,
  add_reference,
  add_smooth,
  text_arglist,
  abline_arglist,
  smooth_arglist,
  lines_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="arg_check_residual_plot_lm_+3A_rtype">rtype</code></td>
<td>
<p>The residual type to plot. The default is
<code>"ordinary"</code>. The other options are
<code>"standardized"</code>, <code>"studentized"</code>,
<code>"loo"</code>, <code>"jackknife"</code>, <code>"deleted"</code>,
<code>"internally studentized"</code>, <code>"externally
studentized"</code>.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_xaxis">xaxis</code></td>
<td>
<p>The variable to use on the x-axis of the
plot(s). The default is <code>"fitted"</code> to use fitted
values. The other option is <code>"predictors"</code>.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_smooth">smooth</code></td>
<td>
<p>A function with a
<code><a href="stats.html#topic+formula">formula</a></code> argument to smooth the
desired plot. The default function is
<code><a href="stats.html#topic+loess">loess</a>.</code></p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_add_smooth">add_smooth</code></td>
<td>
<p>A logical value indicating whether a
smooth should be added to each plot produced. The
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_smooth_arglist">smooth_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the function provided in the
<code>smooth</code> argument.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_lines_arglist">lines_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+lines">lines</a></code>
function for plotting the result of applying the
<code>smooth</code> function.</p>
</td></tr>
<tr><td><code id="arg_check_residual_plot_lm_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='auto_mfrow'>Automatically determine 'mfrow'</h2><span id='topic+auto_mfrow'></span>

<h3>Description</h3>

<p>Automatically determine a reasonable choice for
for 'mfrow' in the <code><a href="graphics.html#topic+par">par</a></code>
function based on the number of plots 'n'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>auto_mfrow(n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="auto_mfrow_+3A_n">n</code></td>
<td>
<p>The number of plots.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'numeric' vector of length 2.
</p>

<hr>
<h2 id='autoplot.confint_adjust'>Plot <code>confint_adjust</code> object</h2><span id='topic+autoplot.confint_adjust'></span>

<h3>Description</h3>

<p>Plot a <code>confint_adjust</code> object produced by the
<code><a href="#topic+confint_adjust">confint_adjust</a></code> function. The plotting
function internally calls the
<code><a href="ggplot2.html#topic+autoplot">autoplot</a></code> function. Note: the
<code>ggplot2</code> package must be loaded (i.e.,
<code>library(ggplot2)</code> or <code>ggplot2::autoplot</code>
must be specifically called for this function to work.
See Examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>autoplot.confint_adjust(object, parm, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.confint_adjust_+3A_object">object</code></td>
<td>
<p>An <code>confint_adjust</code> object produced by the
<code><a href="#topic+confint_adjust">confint_adjust</a></code> function.</p>
</td></tr>
<tr><td><code id="autoplot.confint_adjust_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector of
names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="autoplot.confint_adjust_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
# standard intervals
cia &lt;- confint_adjust(fit)
# if ggplot2 package is available
if (require(ggplot2)) {
autoplot(cia)
# select subset of plots
autoplot(cia, parm = c("hp", "disp"))
}
</code></pre>

<hr>
<h2 id='coef_compare'>Compare coefficients of 2 models</h2><span id='topic+coef_compare'></span>

<h3>Description</h3>

<p>Compare the coefficients to two fitted models. The models
must have the same coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef_compare(model1, model2, digits = 3, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_compare_+3A_model1">model1</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="coef_compare_+3A_model2">model2</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="coef_compare_+3A_digits">digits</code></td>
<td>
<p>A positive integer indicating how many
significant digits are to be used for numeric and
complex numbers. This argument is passed to
<code><a href="base.html#topic+format">format</a></code>.</p>
</td></tr>
<tr><td><code id="coef_compare_+3A_verbose">verbose</code></td>
<td>
<p>A logical value indicating whether the
matrix should be printed. The default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit model
lmod1 &lt;- lm(murder ~ hs_grad + urban + poverty + single,
           data = crime2009)
#fit without DC
lmod2 &lt;- lm(murder ~ hs_grad + urban + poverty + single,
            data = crime2009[-9, ])
#compare coefficients of models
coef_compare(lmod1, lmod2)
</code></pre>

<hr>
<h2 id='coef_matrix'>Return coefficient matrix</h2><span id='topic+coef_matrix'></span>

<h3>Description</h3>

<p><code>coef_matrix</code> returns the <code>coefficients</code>
element of the <code>summary</code> function, which is a
matrix with columns for the estimated coefficients, their
standard error, t-statistic and corresponding (two-sided)
p-values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef_matrix(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_matrix_+3A_object">object</code></td>
<td>
<p>an object of class <code>"lm"</code>, usually, a result of a
call to <code><a href="stats.html#topic+lm">lm</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">p \times 4</code> matrix with columns for the
estimated coefficient, its standard error, t-statistic
and corresponding (two-sided) p-value. Aliased
coefficients are omitted. The additional class
<code>coef_matrix</code> is added for custom printing.
</p>


<h3>Author(s)</h3>

<p>Joshua P. French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a fitted model
fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
coef_matrix(fit)
print(coef_matrix(fit), digits = 3)
</code></pre>

<hr>
<h2 id='combine_coefs'>Combine coefficients</h2><span id='topic+combine_coefs'></span>

<h3>Description</h3>

<p>Combine coefficients and standard errors from two
fitted models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_coefs(i, a, b, digits = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine_coefs_+3A_i">i</code></td>
<td>
<p>Index of coefficients</p>
</td></tr>
<tr><td><code id="combine_coefs_+3A_a">a</code></td>
<td>
<p>Coefficients and standard errors from Model 1</p>
</td></tr>
<tr><td><code id="combine_coefs_+3A_b">b</code></td>
<td>
<p>Coefficients and standard errors from Model 2</p>
</td></tr>
<tr><td><code id="combine_coefs_+3A_digits">digits</code></td>
<td>
<p>A positive integer indicating how many
significant digits are to be used for numeric and
complex numbers. This argument is passed to
<code><a href="base.html#topic+format">format</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character matrix
</p>

<hr>
<h2 id='confint_adjust'>Adjust confidence intervals for multiple comparisons</h2><span id='topic+confint_adjust'></span>

<h3>Description</h3>

<p>A function to produce adjusted confidence intervals with a family-wise
confidence level of at least <code>level</code> for
<code>lm</code> objects (not applicable if no adjustment is used).
Internally, the function is a slight revision of the code
used in the <code><a href="stats.html#topic+confint.lm">confint.lm</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>confint_adjust(object, parm, level = 0.95, method = "none")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="confint_adjust_+3A_object">object</code></td>
<td>
<p>a fitted model object.</p>
</td></tr>
<tr><td><code id="confint_adjust_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector of
names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint_adjust_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint_adjust_+3A_method">method</code></td>
<td>
<p>A character string indicating the type of
adjustment to make. The default choice is
<code>"none"</code>. The other option is
<code>"bonferroni"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code>a = 1 - level</code>. Let <code>p</code> be the number of
estimated coefficients in the fitted model. All intervals are computed
using the formula <code>estimate +/- m * ese</code>, where
<code>m</code> is a multiplier and <code>ese</code> is the estimated
standard error of the <code>estimate</code>.
</p>
<p><code>method = "none"</code> (no correction) produces the
standard t-based confidence intervals with multiplier
<code>qt(1 - a/2, df = object$df.residual)</code>.
</p>
<p><code>method = "bonferroni"</code> produces Bonferroni-adjusted
intervals that use the multiplier <code>m = qt(1 - a/(2 *
k), df = object$df.residual)</code>, where <code>k</code> is the
number of intervals being produced.
</p>
<p><code>method = "wh"</code> produces Working-Hotelling-adjusted
intervals that are valid for all linear combinations of
the regression coefficients, which uses the multiplier
<code>m = sqrt(p * qf(level, df1 = p, df2 =
object$df.residual))</code>.
</p>


<h3>Value</h3>

<p>A <code>confint_adjust</code> object, which is simply a
a <code>data.frame</code> with columns <code>term</code>,
<code>lwr</code> (the lower confidence limit), and <code>upr</code>
(the upper confidence limit).
</p>


<h3>References</h3>

<p>Bonferroni, C. (1936). Teoria statistica
delle classi e calcolo delle probabilita. Pubblicazioni
del R Istituto Superiore di Scienze Economiche e
Commericiali di Firenze, 8, 3-62.
</p>
<p>Working, H., &amp; Hotelling, H. (1929). Applications of the
theory of error to the interpretation of trends. Journal
of the American Statistical Association, 24(165A), 73-85.
doi:10.1080/01621459.1929.10506274
</p>
<p>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W.
(2004). Applied Linear Statistical Models, 5th edition.
New York: McGraw-Hill/Irwin. (p. 230)
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+confint.lm">confint.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## an extension of the documentation for confint.lm
fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
# standard intervals
confint_adjust(fit)
# bonferroni-adjusted intervals
(cib &lt;- confint_adjust(fit, method = "b"))
# plot results
plot(cib)
plot(cib, parm = c("hp", "disp"))
if (require(ggplot2)) {
  autoplot(cib)
  autoplot(cib, parm = c("hp", "disp"))
}
#' working-hotelling-adjusted intervals
(ciwh &lt;- confint_adjust(fit, method = "wh"))
</code></pre>

<hr>
<h2 id='cooks_plot'>Index plot of Cook's distances for <code>lm</code> object</h2><span id='topic+cooks_plot'></span>

<h3>Description</h3>

<p><code>cooks_plot</code> plots the Cook's distances from
the <code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code> function of a fitted
<code>lm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cooks_plot(
  model,
  id_n = 3,
  add_reference = TRUE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cooks_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. See details.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="cooks_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, a reference line is plotted at the <code>0.5</code>
quantile of a <code class="reqn">F_{p, n-p}</code> distribution
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n - p = </code><code>stats::df.residual(model)</code>.
</p>
<p>The vertical position of the reference line can be customized
by setting the <code>h</code> argument of <code>abline_arglist</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
cooks_plot(lmod, id_n = 1)
</code></pre>

<hr>
<h2 id='cooks_stats'>Cook's statistics</h2><span id='topic+cooks_stats'></span>

<h3>Description</h3>

<p><code>cooks_stats</code> returns the ordered Cook's statistics
(distances) decreasing in value of <code>model</code> to identify the
most influential observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cooks_stats(model, n = 6L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cooks_stats_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="cooks_stats_+3A_n">n</code></td>
<td>
<p>an integer vector of length up to <code>dim(x)</code> (or 1,
for non-dimensioned objects). Values specify the indices to be
selected in the corresponding dimension (or along the length) of the
object. A positive value of <code>n[i]</code> includes the first/last
<code>n[i]</code> indices in that dimension, while a negative value
excludes the last/first <code>abs(n[i])</code>, including all remaining
indices. <code>NA</code> or non-specified values (when <code>length(n) &lt;
      length(dim(x))</code>) select all indices in that dimension. Must
contain at least one non-missing value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of statistics
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
cooks_stats(lmod, n = 5)
</code></pre>

<hr>
<h2 id='cooks_test'>Identify influential observations</h2><span id='topic+cooks_test'></span>

<h3>Description</h3>

<p><code>cooks_test</code> returns the observations identified
as influential based on the cooks statistics being
larger than a threshold. <br /><br /> The threshold for this
test is the <code>0.5</code>
quantile of a <code class="reqn">F_{p, n-p}</code> distribution
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n - p = </code><code>stats::df.residual(model)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cooks_test(model, n = stats::nobs(model))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cooks_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="cooks_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all influential observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of influential observations.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
cooks_test(lmod)
</code></pre>

<hr>
<h2 id='crime2009'>2009 Crime Data</h2><span id='topic+crime2009'></span>

<h3>Description</h3>

<p>Data related to crime for the 50 U.S. states
plus the District of Columbia. The data are taken from
the <code>crime_data</code> data set available in the
<code>statsmodels</code> package in Python. As stated in its
documentation, &quot;All data is for 2009 and was obtained
from the American Statistical Abstracts except as
indicated ....&quot; The original documentation is available
at
<a href="https://www.statsmodels.org/dev/datasets/generated/statecrime.html">https://www.statsmodels.org/dev/datasets/generated/statecrime.html</a>.
</p>
<p>The <code>violent</code> variable includes murder, forcible
rape, robbery, and aggravated assault. Numbers for
Illinois and Minnesota do not include forcible rapes.
Footnote included with the American Statistical
Abstract table reads: &quot;The data collection methodology
for the offense of forcible rape used by the Illinois
and the Minnesota state Uniform Crime Reporting (UCR)
Programs (with the exception of Rockford, Illinois, and
Minneapolis and St. Paul, Minnesota) does not comply
with national UCR guidelines. Consequently, their state
figures for forcible rape and violent crime (of which
forcible rape is a part) are not published in this
table.&quot;
</p>
<p>The <code>single</code> variable is calculated from 2009
1-year American Community Survey obtained obtained from
Census. Variable is Male householder, no wife present,
family household combined with Female householder, no
husband present, family household, divided by the total
number of Family households.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(crime2009)
</code></pre>


<h3>Format</h3>

<p>A data frame with 51 observations and 7 variables:
</p>

<dl>
<dt><code>violent</code></dt><dd><p>Rate of violent crimes per 100,000 persons in the population.</p>
</dd>
<dt><code>murder</code></dt><dd><p>Rate of murders per 100,000 persons in the population.</p>
</dd>
<dt><code>hs_grad</code></dt><dd><p>Percentage of the population having graduated from high school or higher.</p>
</dd>
<dt><code>poverty</code></dt><dd><p>Percentage of individuals with income below the poverty line.</p>
</dd>
<dt><code>white</code></dt><dd><p>Percentage of the population that is only considered &quot;white&quot; for race based on the 2009 American Community Survey.</p>
</dd>
<dt><code>single</code></dt><dd><p>Percentage of families made up of single individuals.</p>
</dd>
<dt><code>urban</code></dt><dd><p>Percentage of the population living in Urbanized Areas as of 2010 Census, where Urbanized Areas are areas of 50,000 or more people.</p>
</dd>
</dl>



<h3>Source</h3>

<p>A public domain data set available in the
<code>statsmodels</code> python package. All data is for 2009
and was obtained from the American Statistical
Abstracts except as indicated.
<a href="https://www.statsmodels.org/dev/datasets/generated/statecrime.html">https://www.statsmodels.org/dev/datasets/generated/statecrime.html</a>.
</p>

<hr>
<h2 id='dfbeta_plot'>dfbeta index plots</h2><span id='topic+dfbeta_plot'></span>

<h3>Description</h3>

<p><code>dfbeta_plot</code> creates an index plot of the
<code>dfbeta</code> statistics for each regressor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfbeta_plot(
  model,
  id_n = 3,
  regressors = ~.,
  add_reference = TRUE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfbeta_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_regressors">regressors</code></td>
<td>
<p>A formula describing the regressors for
which to plot the <code>dfbetas</code> statistics. The
default is all available regressors.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="dfbeta_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A horizontal reference line is added at +/- the
estimated standard error of each coefficient by
default if <code>add_reference</code> is <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>
<code><a href="stats.html#topic+dfbeta">dfbeta</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(murder ~ hs_grad + urban + poverty + single,
           data = crime2009)
dfbeta_plot(lmod)
dfbeta_plot(lmod, regressors = ~ hs_grad + poverty,
            id_n = 1)
</code></pre>

<hr>
<h2 id='dfbetas_plot'>dfbetas index plots</h2><span id='topic+dfbetas_plot'></span>

<h3>Description</h3>

<p><code>dfbetas_plot</code> creates index plot of the
<code>dfbetas</code> statistics for each regressor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dfbetas_plot(
  model,
  id_n = 3,
  regressors = ~.,
  add_reference = TRUE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dfbetas_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_regressors">regressors</code></td>
<td>
<p>A formula describing the regressors for
which to plot the <code>dfbetas</code> statistics. The
default is all available regressors.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="dfbetas_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A horizontal reference line is added at -1 and +1 by
default if <code>add_reference</code> is <code>TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>
<code><a href="stats.html#topic+dfbetas">dfbetas</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(murder ~ hs_grad + urban + poverty + single,
           data = crime2009)
dfbetas_plot(lmod)
dfbetas_plot(lmod, regressors = ~ hs_grad, id_n = 4)
</code></pre>

<hr>
<h2 id='dffits_plot'>Index plot of DFFITS values for <code>lm</code> object</h2><span id='topic+dffits_plot'></span>

<h3>Description</h3>

<p><code>dffits_plot</code> plots the DFFITS values from
the <code><a href="stats.html#topic+dffits">dffits</a></code> function of a fitted
<code>lm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dffits_plot(
  model,
  id_n = 3,
  add_reference = TRUE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dffits_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>. See Details.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="dffits_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, a reference line is plotted at <code class="reqn">\pm 2\sqrt{p/n}</code>,
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n = </code><code>stats::nobs(model)</code>. This can be customized
by setting the <code>h</code> argument of <code>abline_arglist</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="stats.html#topic+dffits">dffits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
dffits_plot(lmod, id_n = 6)
# customized plot
dffits_plot(lmod, id_n = 1,
            text_arglist = list(col = "blue", cex = 2),
            abline_arglist = list(col = "red", lwd = 2))
</code></pre>

<hr>
<h2 id='dffits_stats'>DFFITS statistics</h2><span id='topic+dffits_stats'></span>

<h3>Description</h3>

<p><code>dffits_stats</code> returns the ordered DFFITS values
(decreasing in magnitude) of <code>model</code> to identify the
observations with the highest DFFITS values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dffits_stats(model, n = 6L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dffits_stats_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="dffits_stats_+3A_n">n</code></td>
<td>
<p>an integer vector of length up to <code>dim(x)</code> (or 1,
for non-dimensioned objects). Values specify the indices to be
selected in the corresponding dimension (or along the length) of the
object. A positive value of <code>n[i]</code> includes the first/last
<code>n[i]</code> indices in that dimension, while a negative value
excludes the last/first <code>abs(n[i])</code>, including all remaining
indices. <code>NA</code> or non-specified values (when <code>length(n) &lt;
      length(dim(x))</code>) select all indices in that dimension. Must
contain at least one non-missing value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of statistics
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dffits">dffits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
dffits_stats(lmod, n = 5)
</code></pre>

<hr>
<h2 id='dffits_test'>Identify influential observations</h2><span id='topic+dffits_test'></span>

<h3>Description</h3>

<p><code>dffits_test</code> returns the observations identified
as influential based on the absolute value of the DFFITS statistics being
larger than a threshold. <br /><br /> The threshold used is <code class="reqn">2\sqrt{p/n}</code>,
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n = </code><code>stats::nobs(model)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dffits_test(model, n = stats::nobs(model))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dffits_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="dffits_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all influential observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of influential observations.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+dffits">dffits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
dffits_test(lmod)
</code></pre>

<hr>
<h2 id='dwaine'>Dwaine Studios data</h2><span id='topic+dwaine'></span>

<h3>Description</h3>

<p>Data from the Dwaine Studios data in Applied
Linear Statistical Models, 5th edition, p. 237. From
the book:
</p>
<p>Dwaine Studios, Inc., operates portrait studios in 21
cities of medium size. These studios specialize in
portraits of children. The company is considering an
expansion into other cities of medium size and wishes
to investigates where sales (<code>sales</code>) in a
community can be predicted from the number of persons
aged 16 or younger in the community (<code>targetpop</code>)
and the per capita disposable personal income in the
community (<code>dpi</code>). Data on these variables for the
most recent year for the 21 cities in which Dwaine
Studios is now operating are included in the data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dwaine)
</code></pre>


<h3>Format</h3>

<p>A data frame with 21 observations and 3 variables:
</p>

<dl>
<dt><code>targetpop</code></dt><dd><p>The number of persons aged 16 or younger in thousands of persons.</p>
</dd>
<dt><code>dpi</code></dt><dd><p>Per capita disposable personal income in thousands of dollars.</p>
</dd>
<dt><code>sales</code></dt><dd><p>Sales in thousands of dollars</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Joshua P. French
</p>


<h3>References</h3>

<p>Kutner, M. H., Nachtsheim, C. J., Neter, J.,
&amp; Li, W. (2004). Applied Linear Statistical Models, 5th
edition. New York: McGraw-Hill/Irwin.
</p>

<hr>
<h2 id='format_perc_api2lm'>Format percentages</h2><span id='topic+format_perc_api2lm'></span>

<h3>Description</h3>

<p>A recreation of the <code>stats:::format.prec</code> function that is only available internally to the <code>stats</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_perc_api2lm(probs, digits)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_perc_api2lm_+3A_probs">probs</code></td>
<td>
<p>A vector of probabilities.</p>
</td></tr>
<tr><td><code id="format_perc_api2lm_+3A_digits">digits</code></td>
<td>
<p>a positive integer indicating how many significant digits
are to be used for
numeric and complex <code>x</code>.  The default, <code>NULL</code>, uses
<code><a href="base.html#topic+getOption">getOption</a>("digits")</code>.  This is a suggestion: enough decimal
places will be used so that the smallest (in magnitude) number has
this many significant digits, and also to satisfy <code>nsmall</code>.
(For more, notably the interpretation for complex numbers see
<code><a href="base.html#topic+signif">signif</a></code>.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of percentages
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+format">format</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>format_perc_api2lm(c(0.523423, 0.9098192, 0.951289), digits = 1)
format_perc_api2lm(c(0.523423, 0.9098192, 0.951289), digits = 3)
</code></pre>

<hr>
<h2 id='get_residuals'>Extract residuals from a model</h2><span id='topic+get_residuals'></span>

<h3>Description</h3>

<p>Extracts different types of residuals from a fitted model.
The types of residuals are discussed in Details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_residuals(
  x,
  rtype = c("ordinary", "standardized", "studentized", "jackknife", "loo", "deleted",
    "internally studentized", "externally studentized")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_residuals_+3A_x">x</code></td>
<td>
<p>An <code>lm</code> object</p>
</td></tr>
<tr><td><code id="get_residuals_+3A_rtype">rtype</code></td>
<td>
<p>The desired residual type. The options are
<code>"ordinary"</code>, <code>"standardized"</code>, <code>"studentized"</code>,
<code>"jackknife"</code>, <code>"loo"</code>, <code>"deleted"</code>, <code>"internally
studentized"</code>, and <code>"externally studentized"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For observations <code class="reqn">1, 2, \ldots, n</code>, let:
</p>

<ol>
<li> <p><code class="reqn">Y_i</code> denote the response value for the <code class="reqn">i</code>th observation.
</p>
</li>
<li> <p><code class="reqn">\hat{Y}_i</code> denote the fitted value for the
<code class="reqn">i</code>th observation.
</p>
</li>
<li> <p><code class="reqn">h_i</code> denote the leverage value for the <code class="reqn">i</code>th observation.
</p>
</li></ol>

<p>We assume that <code class="reqn">\mathrm{sd}(Y_i) = \sigma</code> for
<code class="reqn">i \in \{1, 2, \ldots, n\}</code> and that <code class="reqn">\hat{\sigma}</code>
is the estimate produced by <code>sigma(x)</code>, where <code>x</code>
is the fitted model object.
</p>
<p>The ordinary residual for the <code class="reqn">i</code>th
observation is computed as
</p>
<p style="text-align: center;"><code class="reqn">\hat{\epsilon}_i = Y_i - \hat{Y}_i.</code>
</p>

<p>The variance of the <code>i</code>th ordinary residual under standard
assumptions is <code class="reqn">\sigma^2(1-h_i)</code>.
</p>
<p>The standardized residual for the <code class="reqn">i</code>th observation
is computed as
</p>
<p style="text-align: center;"><code class="reqn">r_i = \frac{\hat{\epsilon}_i}{\hat{\sigma}\sqrt{1-h_i}}.</code>
</p>

<p>The standardized residual is also known as the internally
studentized residual.
</p>
<p>Let <code class="reqn">\hat{Y}_{i(i)}</code> denote the predicted value of
<code class="reqn">Y_i</code> for the model fit with all <code class="reqn">n</code> observations
except observation <code class="reqn">i</code>. The leave-one-out (LOO) residual for observation <code class="reqn">i</code> is
computed as
</p>
<p style="text-align: center;"><code class="reqn">l_i = Y_i - \hat{Y}_{i(i)} = \frac{\hat{\epsilon}_i}{1-h_i}.</code>
</p>

<p>The LOO residual is also known as the deleted or jackknife
residual.
</p>
<p>The studentized residual for the <code class="reqn">i</code>th observation
is computed as
</p>
<p style="text-align: center;"><code class="reqn">t_i = \frac{l_i}{\hat{\sigma}_{(i)}\sqrt{1-h_i}},</code>
</p>

<p>where <code class="reqn">\hat{\sigma}_{(i)}</code> is the leave-one-out estimate
of <code class="reqn">\sigma</code>.
</p>
<p>The studentized residual is also known as the externally
studentized residual.
</p>


<h3>Value</h3>

<p>A vector of residals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Girth ~ Height, data = trees)
# ordinary residuals
rord &lt;- get_residuals(lmod)
all.equal(rord, residuals(lmod))
# standardized residuals
rstand &lt;- get_residuals(lmod, "standardized")
all.equal(rstand, rstandard(lmod))
# studentized residuals
rstud &lt;- get_residuals(lmod, "studentized")
all.equal(rstud, rstudent(lmod))
# loo residuals
rl &lt;- get_residuals(lmod, "loo")
all.equal(rl, rloo(lmod))
</code></pre>

<hr>
<h2 id='home_sales'>Home sale prices in King County, WA</h2><span id='topic+home_sales'></span>

<h3>Description</h3>

<p>The <code>home_sales</code> data set is a data frame consisting of
216 rows and 8 columns. The data are a subset of home
sales in King County, WA made between 2014-05-02 to
2015-05-27. The variables in the data set are:
</p>

<ul>
<li> <p><code>price</code>: sale price (in log10 US dollars).
</p>
</li>
<li> <p><code>bedrooms</code>: number of bedrooms.
</p>
</li>
<li> <p><code>bathrooms</code>: number of bathrooms.
</p>
</li>
<li> <p><code>sqft_living</code>: size of living space in square feet.
</p>
</li>
<li> <p><code>sqft_lot</code>: lot size in square feet.
</p>
</li>
<li> <p><code>floors</code>: number of floors in home.
</p>
</li>
<li> <p><code>waterfront</code>: a <code>factor</code> variable with levels <code>no</code> and 'yes'
that indicate whether the home has a waterfront view.
</p>
</li>
<li> <p><code>condition</code>: a <code>factor</code> variable indicating the condition of the house with levels
ranging from <code>poor</code> to <code>very good</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>data.frame</code>.
</p>


<h3>Source</h3>

<p>The Center for Spatial Data Science, University
of Chicago.
<a href="https://geodacenter.github.io/data-and-lab//KingCounty-HouseSales2015/">https://geodacenter.github.io/data-and-lab//KingCounty-HouseSales2015/</a>
</p>
<p>These data were created by selectively choosing a subset
of observations from the <code>home_prices</code> data set in the
**KingCountyHomes** package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(home_sales)
summary(home_sales)
</code></pre>

<hr>
<h2 id='index_plot_dfbetas_elements'>Get elements for dfbetas index plot</h2><span id='topic+index_plot_dfbetas_elements'></span>

<h3>Description</h3>

<p>Get elements for dfbetas index plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_plot_dfbetas_elements(model, returned_stats)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="index_plot_dfbetas_elements_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="index_plot_dfbetas_elements_+3A_returned_stats">returned_stats</code></td>
<td>
<p>A vector of dfbetas statistics</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements <code>x</code>, <code>y</code>,
and <code>z</code>.
</p>

<hr>
<h2 id='index_plot_lm'>Index plot of statistics from of an <code>lm</code> object</h2><span id='topic+index_plot_lm'></span>

<h3>Description</h3>

<p><code>index_plot_lm</code> creates an index plot of statistcs
from an <code>lm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_plot_lm(
  model,
  stat,
  id_n = 3,
  add_reference = FALSE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="index_plot_lm_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_stat">stat</code></td>
<td>
<p>A function that can be applied to an <code>lm</code>
object and returns a vector of observations for each
observation used to fit the model.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="index_plot_lm_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="stats.html#topic+lm">lm</a></code>,
<code><a href="stats.html#topic+rstudent">rstudent</a></code>,
<code><a href="stats.html#topic+hatvalues">hatvalues</a></code>,
<code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Petal.Length ~ Sepal.Length + Species,
           data = iris)
# outlier plot
# number of observations
n &lt;- stats::nobs(lmod)
# loo residual degrees of freedom
rdf &lt;- stats::df.residual(lmod) - 1

h &lt;- c(-1, 1) * stats::qt(0.05/(2 * n), df = rdf)
index_plot_lm(lmod, stat = stats::rstudent,
              abline_arglist = list(h = h))

# leverage plot
index_plot_lm(lmod, stat = stats::hatvalues, id_n = 1)
# Cook's distance
index_plot_lm(lmod, stat = stats::cooks.distance,
              id_n = 3)
</code></pre>

<hr>
<h2 id='index_plot_lm_elements'>Create plot elements for index_plot_lm</h2><span id='topic+index_plot_lm_elements'></span>

<h3>Description</h3>

<p>Create plot elements for index_plot_lm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_plot_lm_elements(model, stat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="index_plot_lm_elements_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="index_plot_lm_elements_+3A_stat">stat</code></td>
<td>
<p>A function that can be applied to an <code>lm</code>
object and returns a vector of observations for each
observation used to fit the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with elements <code>x</code>, <code>y</code>,
and <code>z</code>.
</p>

<hr>
<h2 id='index_plot_raw'>Index plot helper function</h2><span id='topic+index_plot_raw'></span>

<h3>Description</h3>

<p>Index plot helper function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>index_plot_raw(
  x,
  y,
  idd,
  labels,
  add_reference,
  arglist,
  text_arglist,
  abline_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="index_plot_raw_+3A_x">x</code></td>
<td>
<p>x-values to plot</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_y">y</code></td>
<td>
<p>y-values to plot</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_idd">idd</code></td>
<td>
<p>Identified observations</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_labels">labels</code></td>
<td>
<p>The labels to use for the identified points.</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_add_reference">add_reference</code></td>
<td>
<p>Logical value</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_arglist">arglist</code></td>
<td>
<p>Named list for plot</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Named list for text</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>Named list for abline</p>
</td></tr>
<tr><td><code id="index_plot_raw_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='influence_plot'>Influence plots</h2><span id='topic+influence_plot'></span>

<h3>Description</h3>

<p><code>influence_plot</code> creates an influence plot for a
fitted <code>lm</code> object. The y-axis is either the
studentized (the default) or standardized residuals
versus the leverage values for each observation. The size
of the point associated with each observation is
proportional to the value of the Cook's distance (the
default) or the DFFITS statistic for the observation.
<br /><br /> Details about the different types of residuals are
discussed in the <code><a href="#topic+get_residuals">get_residuals</a></code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>influence_plot(
  model,
  rtype = c("studentized", "standardized"),
  criterion = c("cooks", "dffits"),
  id_n = 3,
  add_reference = TRUE,
  alpha = 0.05,
  size = c(1, 4.8),
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_rtype">rtype</code></td>
<td>
<p>The residual type to plot on the y-axis. The
default is <code>"studentized"</code>. The other option is
<code>"standardized"</code>.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_criterion">criterion</code></td>
<td>
<p>The criterion that decides the size of
the points. The default is <code>"cooks"</code>. The other
option is <code>"dffits"</code>.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels
with respect to largest absolute criterion. The default
is <code>3</code> labels.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_alpha">alpha</code></td>
<td>
<p>The default quantile used for the horizontal
reference lines. The default is 0.05. See Details.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_size">size</code></td>
<td>
<p>A numeric vector of length 2 that provides
guidelines for the size of the points.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="influence_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The range of the <code>criterion</code> statistic is mapped to
<code>cex_pt = size[2]^2 - size[1]^2</code> and then the size
of the points is <code>sqrt(cex_pt)</code>.
</p>
<p>If <code>add_reference</code> is <code>TRUE</code>, then horizontal
reference lines are added at the <code class="reqn">\alpha/2</code> and
<code class="reqn">1-\alpha/2</code> quantiles of a t distribution with
degrees of freedom given by
<code>stats::df.residual(model)</code>.
</p>
<p>If <code>add_reference</code> is <code>TRUE</code>, then vertical
reference lines are added at <code class="reqn">2p/n</code> and <code class="reqn">0.5</code>
where <code class="reqn">p=</code><code>length(stats::coef(model))</code> and
<code class="reqn">n=</code><code>stats::nobs(model)</code>.
</p>
<p>The vertical position of the reference lines can be
customized by setting the <code>h</code> argument of
<code>abline_arglist</code>. The horizontal position of the
reference lines can be customized by setting the <code>v</code>
argument of <code>abline_arglist</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="stats.html#topic+rstandard">rstandard</a></code>,
<code><a href="stats.html#topic+rstudent">rstudent</a></code>,
<code><a href="stats.html#topic+hatvalues">hatvalues</a></code>
<code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>,
<code><a href="stats.html#topic+dffits">dffits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(murder ~ hs_grad + urban + poverty + single,
           data = crime2009)
# studentized residuals vs leverage
influence_plot(lmod, id_n = 3)
# standardized residuals vs leverage
influence_plot(lmod, rtype = "stan")
# similar plot from plot.lm
plot(lmod, which = 5)
</code></pre>

<hr>
<h2 id='influence_stats'>Influence statistics</h2><span id='topic+influence_stats'></span>

<h3>Description</h3>

<p><code>influence_stats</code> returns a data frame with
influence-related statistics ordered from the largest
to smallest magnitude of the <code>criterion</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>influence_stats(
  model,
  n = 6L,
  rtype = c("studentized", "standardized"),
  criterion = c("cooks", "dffits")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="influence_stats_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="influence_stats_+3A_n">n</code></td>
<td>
<p>an integer vector of length up to <code>dim(x)</code> (or 1,
for non-dimensioned objects). Values specify the indices to be
selected in the corresponding dimension (or along the length) of the
object. A positive value of <code>n[i]</code> includes the first/last
<code>n[i]</code> indices in that dimension, while a negative value
excludes the last/first <code>abs(n[i])</code>, including all remaining
indices. <code>NA</code> or non-specified values (when <code>length(n) &lt;
      length(dim(x))</code>) select all indices in that dimension. Must
contain at least one non-missing value.</p>
</td></tr>
<tr><td><code id="influence_stats_+3A_rtype">rtype</code></td>
<td>
<p>The residual type to plot on the y-axis. The
default is <code>"studentized"</code>. The other option is
<code>"standardized"</code>.</p>
</td></tr>
<tr><td><code id="influence_stats_+3A_criterion">criterion</code></td>
<td>
<p>The criterion that decides the size of
the points. The default is <code>"cooks"</code>. The other
option is <code>"dffits"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of influence-related statistics.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rstandard">rstandard</a></code>,
<code><a href="stats.html#topic+rstudent">rstudent</a></code>,
<code><a href="stats.html#topic+hatvalues">hatvalues</a></code>
<code><a href="stats.html#topic+cooks.distance">cooks.distance</a></code>,
<code><a href="stats.html#topic+dffits">dffits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(murder ~ hs_grad + urban + poverty + single,
           data = crime2009)
influence_stats(lmod, n = 3)
influence_stats(lmod, rtype = "stan", crit = "df")
</code></pre>

<hr>
<h2 id='leverage_plot'>Index plot of leverage values for <code>lm</code> object</h2><span id='topic+leverage_plot'></span>

<h3>Description</h3>

<p><code>leverage_plot</code> plots the leverage (hat) values from
the <code><a href="stats.html#topic+hatvalues">hatvalues</a></code> function of a fitted
<code>lm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage_plot(
  model,
  id_n = 3,
  add_reference = TRUE,
  ttype = "half",
  threshold = NULL,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leverage_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_ttype">ttype</code></td>
<td>
<p>Threshold type. The default is
<code>"half"</code>. The other options are <code>"2mean"</code> and
<code>"custom"</code>. See Details.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_threshold">threshold</code></td>
<td>
<p>A number between 0 and 1. Any
observation with a leverage value above this number is
declared a leverage point. This is automatically
determined unless <code>ttype = "custom"</code>.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="leverage_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>ttype = "half"</code>, the threshold is <code>0.5</code>.
</p>
<p>If <code>ttype = "2mean"</code>, the threshold is <code class="reqn">2p/n</code>,
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n = </code><code>stats::nobs(model)</code>, which is double the
mean leverage value.
</p>
<p>If <code>ttype = "custom"</code> then the user must manually
specify <code>threshold</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="stats.html#topic+rstudent">rstudent</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
# reference line not visible on plot because all
# leverage values are less than 0.5
leverage_plot(lmod, id_n = 2)
# different reference line
leverage_plot(lmod, id_n = 6, ttype = "2mean")
# custom reference line
leverage_plot(lmod, id_n = 2, ttype = "custom",
              threshold = 0.15)
</code></pre>

<hr>
<h2 id='leverage_stats'>Leverage statistics</h2><span id='topic+leverage_stats'></span>

<h3>Description</h3>

<p><code>leverage_stats</code> returns the ordered
leverage values (decreasing) of
<code>model</code> to
identify the highest leverage observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage_stats(model, n = 6L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leverage_stats_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="leverage_stats_+3A_n">n</code></td>
<td>
<p>an integer vector of length up to <code>dim(x)</code> (or 1,
for non-dimensioned objects). Values specify the indices to be
selected in the corresponding dimension (or along the length) of the
object. A positive value of <code>n[i]</code> includes the first/last
<code>n[i]</code> indices in that dimension, while a negative value
excludes the last/first <code>abs(n[i])</code>, including all remaining
indices. <code>NA</code> or non-specified values (when <code>length(n) &lt;
      length(dim(x))</code>) select all indices in that dimension. Must
contain at least one non-missing value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of statistics
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
leverage_stats(lmod, n = 4)
</code></pre>

<hr>
<h2 id='leverage_test'>Identify leverage points</h2><span id='topic+leverage_test'></span>

<h3>Description</h3>

<p><code>leverage_test</code> returns the observations identified
as a leverage point based on a threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage_test(model, n = stats::nobs(model), ttype = "half", threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leverage_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="leverage_test_+3A_n">n</code></td>
<td>
<p>The number of leverage points to return. The
default is all leverage points.</p>
</td></tr>
<tr><td><code id="leverage_test_+3A_ttype">ttype</code></td>
<td>
<p>Threshold type. The default is
<code>"half"</code>. The other options are <code>"2mean"</code> and
<code>"custom"</code>. See Details.</p>
</td></tr>
<tr><td><code id="leverage_test_+3A_threshold">threshold</code></td>
<td>
<p>A number between 0 and 1. Any
observation with a leverage value above this number is
declared a leverage point. This is automatically
determined unless <code>ttype = "custom"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>ttype = "half"</code>, the threshold is <code>0.5</code>.
</p>
<p>If <code>ttype = "2mean"</code>, the threshold is <code class="reqn">2p/n</code>,
where <code class="reqn">p = </code><code>length(stats::coef(model))</code> and
<code class="reqn">n = </code><code>stats::nobs(model)</code>, which is double the
mean leverage value.
</p>
<p>If <code>ttype = "custom"</code> then the user must manually
specify <code>threshold</code>.
</p>


<h3>Value</h3>

<p>A vector of statistics
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+hatvalues">hatvalues</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
# comparison of results using different threshold types
leverage_test(lmod)
leverage_test(lmod, ttype = "2mean", n = 7)
leverage_test(lmod, ttype = "custom", threshold = 0.1)
</code></pre>

<hr>
<h2 id='outlier_plot'>Index plot of studentized residuals for <code>lm</code> object</h2><span id='topic+outlier_plot'></span>

<h3>Description</h3>

<p><code>outlier_plot</code> plots the studentized residuals (from
the <code><a href="stats.html#topic+rstudent">rstudent</a></code> function) of a fitted
<code>lm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlier_plot(
  model,
  id_n = 3,
  add_reference = TRUE,
  alpha = 0.05,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outlier_plot_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>. See Details.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_alpha">alpha</code></td>
<td>
<p>The default lower quantile used for the
reference line prior to the Bonferroni adjustment. The
default is 0.05.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="outlier_plot_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>add_reference = TRUE</code>, then reference lines are
provided for the <code class="reqn">\alpha/(2n</code> and <code class="reqn">1-\alpha/(2n)</code>
quantiles of a Student's <code class="reqn">t</code> distribution with
(<code>df.residual(lmod) - 1</code>) degrees of freedom, which
are the standard quantiles used to identify outliers for
a fitted model.
</p>
<p>The vertical position of the reference line can be
customized by setting the <code>h</code> argument of
<code>abline_arglist</code>.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="stats.html#topic+rstudent">rstudent</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
outlier_plot(lmod, id_n = 1)
</code></pre>

<hr>
<h2 id='outlier_stats'>Outlier statistics</h2><span id='topic+outlier_stats'></span>

<h3>Description</h3>

<p><code>outlier_stats</code> returns the ordered
studentized residuals (decreasing based on magnitude) of
<code>model</code> to
Identify the most unusual observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlier_stats(model, n = 6L)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outlier_stats_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="outlier_stats_+3A_n">n</code></td>
<td>
<p>an integer vector of length up to <code>dim(x)</code> (or 1,
for non-dimensioned objects). Values specify the indices to be
selected in the corresponding dimension (or along the length) of the
object. A positive value of <code>n[i]</code> includes the first/last
<code>n[i]</code> indices in that dimension, while a negative value
excludes the last/first <code>abs(n[i])</code>, including all remaining
indices. <code>NA</code> or non-specified values (when <code>length(n) &lt;
      length(dim(x))</code>) select all indices in that dimension. Must
contain at least one non-missing value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
outlier_stats(lmod, n = 3)
</code></pre>

<hr>
<h2 id='outlier_test'>Identify outliers</h2><span id='topic+outlier_test'></span>

<h3>Description</h3>

<p><code>outlier_test</code> returns the observations identified
as an outlier based on the Bonferroni correction for a
studentized residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outlier_test(model, n = stats::nobs(model), alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="outlier_test_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="outlier_test_+3A_n">n</code></td>
<td>
<p>The number of outliers to return. The default is
all outliers.</p>
</td></tr>
<tr><td><code id="outlier_test_+3A_alpha">alpha</code></td>
<td>
<p>The Bonferroni-adjusted threshold at which
an outlier is identified. The default is <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the outliers.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+rstudent">rstudent</a></code>,
<code><a href="stats.html#topic+p.adjust">p.adjust</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(price ~ sqft_living, data = home_sales)
outlier_test(lmod)
outlier_test(lmod, alpha = 1, n = 7)
lmod2 &lt;- lm(Petal.Length ~ Sepal.Length + Species, iris)
outlier_test(lmod2)
</code></pre>

<hr>
<h2 id='plot.confint_adjust'>Plot <code>confint_adjust</code> x</h2><span id='topic+plot.confint_adjust'></span>

<h3>Description</h3>

<p>Plot a <code>confint_adjust</code> x produced by the
<code><a href="#topic+confint_adjust">confint_adjust</a></code> function. See
Examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confint_adjust'
plot(x, parm, mar = c(5.1, 7.1, 4.1, 2.1), line = mar[2] - 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.confint_adjust_+3A_x">x</code></td>
<td>
<p>An <code>confint_adjust</code> x produced by the
<code><a href="#topic+confint_adjust">confint_adjust</a></code> function.</p>
</td></tr>
<tr><td><code id="plot.confint_adjust_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given
confidence intervals, either a vector of numbers or a vector of
names.  If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="plot.confint_adjust_+3A_mar">mar</code></td>
<td>
<p>A numerical vector of the form c(bottom, left,
top, right) which gives the number of lines of margin
to be specified on the four sides of the plot. The
default is c(5, 7, 4, 2) + 0.1.</p>
</td></tr>
<tr><td><code id="plot.confint_adjust_+3A_line">line</code></td>
<td>
<p>The MARgin line, starting at 0 counting
outwards, to draw the y-axis label. The default is 1
unit less than <code>mar[2]</code>.</p>
</td></tr>
<tr><td><code id="plot.confint_adjust_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>plot</code> function doesn't automatically adjust the
margins to account for the label names. If you need more
space for your labels, then increase the second element
of <code>mar</code> from 7.1 upward and line upward.
Alternatively, if you need less space, then you can
decrease both of these values. Or you could use the
<code>autoplot</code> function that automatically controls the
spacing.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Author(s)</h3>

<p>Joshua P. French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
# standard intervals
cia &lt;- confint_adjust(fit)
plot(cia)
# plot subset of intervals
plot(cia, parm = c("hp", "disp"))
# adjust margin and line for better formatting
plot(cia, parm = 2:3, mar = c(5.1, 4.1, 4.1, 2.1))
</code></pre>

<hr>
<h2 id='predict_adjust'>Adjust prediction intervals for multiple comparisons</h2><span id='topic+predict_adjust'></span>

<h3>Description</h3>

<p>A function to produce adjusted confidence/prediction
intervals for predicted mean/new responses with a
family-wise confidence level of at least <code>level</code> for
<code>lm</code> objects (not applicable if no adjustment is
used). Internally, the function is a slight revision of
the code used in the <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>
function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_adjust(
  object,
  newdata,
  se.fit = FALSE,
  scale = NULL,
  df = Inf,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  type = c("response", "terms"),
  method = "none",
  terms = NULL,
  na.action = stats::na.pass,
  pred.var = res.var/weights,
  weights = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_adjust_+3A_object">object</code></td>
<td>
<p>Object of class inheriting from <code>"lm"</code></p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_newdata">newdata</code></td>
<td>
<p>An optional data frame in which to look for variables with
which to predict.  If omitted, the fitted values are used.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_se.fit">se.fit</code></td>
<td>
<p>A switch indicating if standard errors are required.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_scale">scale</code></td>
<td>
<p>Scale parameter for std.err. calculation.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for scale.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_interval">interval</code></td>
<td>
<p>Type of interval calculation.  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_level">level</code></td>
<td>
<p>Tolerance/confidence level.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_type">type</code></td>
<td>
<p>Type of prediction (response or model term).  Can be abbreviated.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_method">method</code></td>
<td>
<p>A character string indicating the type of
adjustment to make. The default choice is
<code>"none"</code>. The other available options are
<code>"bonferroni"</code>, <code>"wh"</code> (Working-Hotelling),
and <code>"scheffe"</code>.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_terms">terms</code></td>
<td>
<p>If <code>type = "terms"</code>, which terms (default is all
terms), a <code><a href="base.html#topic+character">character</a></code> vector.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_na.action">na.action</code></td>
<td>
<p>function determining what should be done with missing
values in <code>newdata</code>.  The default is to predict <code>NA</code>.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_pred.var">pred.var</code></td>
<td>
<p>the variance(s) for future observations to be assumed
for prediction intervals.  See &lsquo;Details&rsquo;.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_weights">weights</code></td>
<td>
<p>variance weights for prediction.  This can be a numeric
vector or a one-sided model formula.  In the latter case, it is
interpreted as an expression evaluated in <code>newdata</code>.</p>
</td></tr>
<tr><td><code id="predict_adjust_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code>a = 1 - level</code>. All intervals are computed
using the formula <code>prediction +/- m * epesd</code>, where
<code>m</code> is a multiplier and <code>epesd</code> is the
estimated standard deviation of the prediction error of
the <code>estimate</code>.
</p>
<p><code>method = "none"</code> (no correction) produces the
standard t-based confidence intervals with multiplier
<code>stats::qt(1 - a/2, df = object$df.residual)</code>.
</p>
<p><code>method = "bonferroni"</code> produces Bonferroni-adjusted
intervals that use the multiplier <code>m = stats::qt(1 -
a/(2 * k), df = object$df.residual)</code>, where <code>k</code> is
the number of intervals being produced.
</p>
<p>The Working-Hotelling and Scheffe adjustments are distinct;
the Working-Hotelling typically is related to a multiple comparisons adjustment
for confidence intervals of the response mean while the Scheffe adjustment is typically
related to a multiple comparisons adjustment for prediction intervals
for a new response. However, references often uses these names
interchangeably, so we use them equivalently in this function.
</p>
<p><code>method = "wh"</code> (Working-Hotelling) or
<code>method = "scheffe"</code> and <code>interval =
"confidence"</code> produces Working-Hotelling-adjusted intervals that
use the multiplier <code>m = sqrt(p * stats::qf(level,
df1 = p, df2 = object$df.residual))</code>, where <code>p</code> is
the number of estimated coefficients in the model.
</p>
<p><code>method = "wh"</code> (Working-Hotelling) or
<code>method = "scheffe"</code> and <code>interval =
"prediction"</code> produces Scheffe-adjusted intervals that
use the multiplier <code>m = sqrt(k * stats::qf(level,
df1 = k, df2 = object$df.residual))</code>, where <code>k</code> is
the number of intervals being produced.
</p>


<h3>Value</h3>

<p><code>predict_adjust</code> produces:
</p>
<p>A vector of predictions if <code>interval = "none"</code>.
</p>
<p>A matrix of predictions and bounds with
column names <code>fit</code>, <code>lwr</code>, and <code>upr</code> if
<code>interval</code> is set. For <code>type = "terms"</code> this is
a matrix with a column per term and may have an attribute
<code>"constant"</code>.
</p>
<p>If <code>se.fit</code> is <code>TRUE</code>, a
list with the following components is returned:
</p>

<ul>
<li><p><code>fit</code>: vector or matrix as above
</p>
</li>
<li><p><code>se.fit</code>: standard error of predicted means
</p>
</li>
<li><p><code>residual.scale</code>: residual standard deviations
</p>
</li>
<li><p><code>df</code>: degrees of freedom for residual
</p>
</li></ul>



<h3>References</h3>

<p>Bonferroni, C. (1936). Teoria statistica delle classi e
calcolo delle probabilita. Pubblicazioni del R Istituto
Superiore di Scienze Economiche e Commericiali di
Firenze, 8, 3-62.
</p>
<p>Working, H., &amp; Hotelling, H. (1929). Applications of the
theory of error to the interpretation of trends. Journal
of the American Statistical Association, 24(165A), 73-85.
doi:10.1080/01621459.1929.10506274
</p>
<p>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W.
(2004). Applied Linear Statistical Models, 5th edition.
New York: McGraw-Hill/Irwin.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict.lm">predict.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
newdata &lt;- as.data.frame(rbind(
               apply(mtcars, 2, mean),
               apply(mtcars, 2, median)))
predict_adjust(fit, newdata = newdata,
               interval = "confidence",
               method = "none")
predict_adjust(fit, newdata = newdata,
               interval = "confidence",
               method = "bonferroni")
predict_adjust(fit, newdata = newdata,
               interval = "confidence",
               method = "wh")
predict_adjust(fit, newdata = newdata,
               interval = "prediction",
               method = "scheffe")
</code></pre>

<hr>
<h2 id='print.coef_matrix'>Print an object of class <code>coef_matrix</code> produced
by the <code><a href="#topic+coef_matrix">coef_matrix</a></code> function.</h2><span id='topic+print.coef_matrix'></span>

<h3>Description</h3>

<p>Print an object of class <code>coef_matrix</code> produced
by the <code><a href="#topic+coef_matrix">coef_matrix</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coef_matrix'
print(x, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.coef_matrix_+3A_x">x</code></td>
<td>
<p>An <code>coef_matrix</code> object produced by the
<code><a href="#topic+coef_matrix">coef_matrix</a></code> function.</p>
</td></tr>
<tr><td><code id="print.coef_matrix_+3A_digits">digits</code></td>
<td>
<p>the minimum number of significant digits to be used: see
<code><a href="base.html#topic+print.default">print.default</a></code>.</p>
</td></tr>
<tr><td><code id="print.coef_matrix_+3A_...">...</code></td>
<td>
<p>Additional arguments to the
<code><a href="base.html#topic+print.data.frame">print.data.frame</a></code> function, such as
<code>digits</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">p \times 4</code> matrix with columns for the
estimated coefficient, its standard error, t-statistic
and corresponding (two-sided) p-value.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
(coefm &lt;- coef_matrix(fit))
# print more digits
print(coefm, digits = 8)
</code></pre>

<hr>
<h2 id='print.confint_adjust'>Print <code>confint_adjust</code> object</h2><span id='topic+print.confint_adjust'></span>

<h3>Description</h3>

<p>Print an object of class <code>confint_adjust</code> produced
by the <code><a href="#topic+confint_adjust">confint_adjust</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'confint_adjust'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.confint_adjust_+3A_x">x</code></td>
<td>
<p>An <code>confint_adjust</code> object produced by the
<code><a href="#topic+confint_adjust">confint_adjust</a></code> function.</p>
</td></tr>
<tr><td><code id="print.confint_adjust_+3A_...">...</code></td>
<td>
<p>Additional arguments to the
<code><a href="base.html#topic+print.data.frame">print.data.frame</a></code> function, such as
<code>digits</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with columns <code>term</code>,
<code>lwr</code>, and <code>upr</code>, which are the coefficients
for which inference is being made, and the lower and
upper bounds of the confidence intervals for each
coefficient, respectively.
</p>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
(cia &lt;- confint_adjust(fit))
print(cia, digits = 3)
</code></pre>

<hr>
<h2 id='print.predict_adjust'>Print <code>predict_adjust</code> object</h2><span id='topic+print.predict_adjust'></span>

<h3>Description</h3>

<p>Print an object of class <code>predict_adjust</code> produced
by the <code><a href="#topic+predict_adjust">predict_adjust</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict_adjust'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.predict_adjust_+3A_x">x</code></td>
<td>
<p>An <code>predict_adjust</code> object produced by the
<code><a href="#topic+predict_adjust">predict_adjust</a></code> function.</p>
</td></tr>
<tr><td><code id="print.predict_adjust_+3A_...">...</code></td>
<td>
<p>Additional arguments to the
<code><a href="base.html#topic+print.default">print.default</a></code> function, such as
<code>digits</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Depending on the <code>interval</code> argument of
<code><a href="#topic+predict_adjust">predict_adjust</a></code>:
</p>
<p>A vector of predictions if <code>interval = "none"</code>.
</p>
<p>A matrix of predictions and bounds with column names
<code>fit</code>, <code>lwr</code>, and <code>upr</code> if
<code>interval</code> is set. For <code>type = "terms"</code> this
is a matrix with a column per term and may have an
attribute <code>"constant"</code>.
</p>
<p>If <code>se.fit</code> is <code>TRUE</code>, a
list with the following components is returned:
</p>

<ul>
<li><p><code>fit</code>: vector or matrix as above
</p>
</li>
<li><p><code>se.fit</code>: standard error of predicted means
</p>
</li>
<li><p><code>residual.scale</code>: residual standard deviations
</p>
</li>
<li><p><code>df</code>: degrees of freedom for residual
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- lm(100/mpg ~ disp + hp + wt + am, data = mtcars)
(cia &lt;- predict_adjust(fit))
print(cia, digits = 3)
</code></pre>

<hr>
<h2 id='residual_plot'>Plot residuals of a fitted model</h2><span id='topic+residual_plot'></span>

<h3>Description</h3>

<p><code>residual_plot</code> plots the residuals of a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>residual_plot(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residual_plot_+3A_model">model</code></td>
<td>
<p>A fitted model.</p>
</td></tr>
<tr><td><code id="residual_plot_+3A_...">...</code></td>
<td>
<p>Currently unimplemented.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Girth ~ Height, data = trees)
residual_plot(lmod)
</code></pre>

<hr>
<h2 id='residual_plot.lm'>Plot residuals of a fitted <code>lm</code> object</h2><span id='topic+residual_plot.lm'></span>

<h3>Description</h3>

<p><code>residual_plot.lm</code> plots the residuals of a fitted
<code>lm</code> object. In general, it is intended to provide
similar functionality to <code><a href="stats.html#topic+plot.lm">plot.lm</a></code>
when <code>which = 1</code>, but can be used for different
types of residuals and can also plot first-order
predictor variables along the x-axis instead of only the
fitted values.<br /><br /> Details about the different types of
residuals are discussed in the
<code><a href="#topic+get_residuals">get_residuals</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
residual_plot(
  model,
  rtype = c("ordinary", "standardized", "studentized", "loo", "jackknife", "deleted",
    "internally studentized", "externally studentized"),
  xaxis = "fitted",
  id_n = 3,
  predictors = ~.,
  smooth = stats::loess,
  add_reference = TRUE,
  add_smooth = TRUE,
  ...,
  text_arglist = list(),
  abline_arglist = list(),
  smooth_arglist = list(),
  lines_arglist = list(),
  extendrange_f = 0.08
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residual_plot.lm_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_rtype">rtype</code></td>
<td>
<p>The residual type to plot. The default is
<code>"ordinary"</code>. The other options are
<code>"standardized"</code>, <code>"studentized"</code>,
<code>"loo"</code>, <code>"jackknife"</code>, <code>"deleted"</code>,
<code>"internally studentized"</code>, <code>"externally
studentized"</code>.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_xaxis">xaxis</code></td>
<td>
<p>The variable to use on the x-axis of the
plot(s). The default is <code>"fitted"</code> to use fitted
values. The other option is <code>"predictors"</code>.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_predictors">predictors</code></td>
<td>
<p>A formula describing the first-order
predictors to plot the residuals against. The default
is all available first-order predictors.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_smooth">smooth</code></td>
<td>
<p>A function with a
<code><a href="stats.html#topic+formula">formula</a></code> argument to smooth the
desired plot. The default function is
<code><a href="stats.html#topic+loess">loess</a>.</code></p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_add_reference">add_reference</code></td>
<td>
<p>A logical value indicating whether a
reference line should be added. The default is
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_add_smooth">add_smooth</code></td>
<td>
<p>A logical value indicating whether a
smooth should be added to each plot produced. The
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+abline">abline</a></code>
function for the horizontal reference line added to the
plot.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_smooth_arglist">smooth_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the function provided in the
<code>smooth</code> argument.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_lines_arglist">lines_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+lines">lines</a></code>
function for plotting the result of applying the
<code>smooth</code> function.</p>
</td></tr>
<tr><td><code id="residual_plot.lm_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+abline">abline</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code>
<code><a href="stats.html#topic+loess">loess</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Petal.Length ~ Sepal.Length + Species,
           data = iris)
# similarity with built-in plot.lm functionality
residual_plot(lmod)
plot(lmod, which = 1)
# residual plot for other residual types
residual_plot(lmod, rtype = "standardized", id_n = 0)
# another residual plot with several customizations
residual_plot(lmod,
              text_arglist = list(col = "blue", cex = 2),
              abline_arglist = list(lwd = 2, lty = 2,
                                    col = "brown"),
              lines_arglist = list(col = "purple"),
              )
# residual plot for predictors
residual_plot(lmod, xaxis = "pred", id_n = 2)
# residual plot for individual predictors
residual_plot(lmod, xaxis = "pred",
              predictors = ~ Sepal.Length, id_n = 2)
residual_plot(lmod, xaxis = "pred",
              predictors = ~ Species,)
</code></pre>

<hr>
<h2 id='rloo'>Compute leave-one-out residuals</h2><span id='topic+rloo'></span><span id='topic+rdeleted'></span><span id='topic+rjackknife'></span>

<h3>Description</h3>

<p><code>rloo</code> computes the leave-one-out residuals of
<code>model</code>. <br /><br />
<code>rjacknife</code> and <code>rdeleted</code> are
aliases for <code>rloo</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rloo(model, ...)

rdeleted(model, ...)

rjackknife(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rloo_+3A_model">model</code></td>
<td>
<p>a fitted model object from the <code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="rloo_+3A_...">...</code></td>
<td>
<p>Currently unimplemented</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rloo.lm">rloo.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Girth ~ Height, data = trees)
rloo(lmod)
</code></pre>

<hr>
<h2 id='rloo.lm'>Compute leave-one-out residuals for 'lm' objects.</h2><span id='topic+rloo.lm'></span><span id='topic+rdeleted.lm'></span><span id='topic+rjackknife.lm'></span>

<h3>Description</h3>

<p><code>rloo.lm</code> computes the leave-one-out residuals of
the <code>lm</code> object stored in <code>model</code>. <br /><br />
<code>rjackknife.lm</code> and <code>rdeleted.lm</code> are aliases
for <code>rloo.lm</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
rloo(
  model,
  infl = stats::lm.influence(model, do.coef = FALSE),
  res = infl$wt.res,
  ...
)

## S3 method for class 'lm'
rdeleted(
  model,
  infl = stats::lm.influence(model, do.coef = FALSE),
  res = infl$wt.res,
  ...
)

## S3 method for class 'lm'
rjackknife(
  model,
  infl = stats::lm.influence(model, do.coef = FALSE),
  res = infl$wt.res,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rloo.lm_+3A_model">model</code></td>
<td>
<p>a fitted model object from the <code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="rloo.lm_+3A_infl">infl</code></td>
<td>
<p>influence structure as returned by <code><a href="stats.html#topic+lm.influence">lm.influence</a></code>.</p>
</td></tr>
<tr><td><code id="rloo.lm_+3A_res">res</code></td>
<td>
<p>(possibly weighted) residuals, with proper default.</p>
</td></tr>
<tr><td><code id="rloo.lm_+3A_...">...</code></td>
<td>
<p>Currently unimplemented</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\hat{\epsilon}_i</code> denote the residual of the
<code class="reqn">i</code>th observation and <code class="reqn">h_i</code> denote the leverage
value of the <code class="reqn">i</code>th observation The leave-one-out residual for observation <code class="reqn">i</code> is
computed as
</p>
<p style="text-align: center;"><code class="reqn">l_i = \frac{\hat{\epsilon}_i}{1-h_i}.</code>
</p>



<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Girth ~ Height, data = trees)
rloo(lmod)
</code></pre>

<hr>
<h2 id='rplot_raw'>Helper function for residuals_plot.lm</h2><span id='topic+rplot_raw'></span>

<h3>Description</h3>

<p>Helper function for residuals_plot.lm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rplot_raw(
  x,
  y,
  idd,
  labels,
  xlab,
  smooth,
  add_reference,
  add_smooth,
  arglist,
  text_arglist,
  abline_arglist,
  smooth_arglist,
  lines_arglist,
  extendrange_f
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rplot_raw_+3A_x">x</code></td>
<td>
<p>x-values to plot</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_y">y</code></td>
<td>
<p>y-values to plot</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_idd">idd</code></td>
<td>
<p>Identified observations</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_labels">labels</code></td>
<td>
<p>The labels to use for the identified points.</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_smooth">smooth</code></td>
<td>
<p>The function for smoothing. Needs a 'formula' argument.</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_add_reference">add_reference</code></td>
<td>
<p>Logical value</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_add_smooth">add_smooth</code></td>
<td>
<p>Logical value</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_arglist">arglist</code></td>
<td>
<p>Named list for plot</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Named list for text</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>Named list for abline</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_smooth_arglist">smooth_arglist</code></td>
<td>
<p>Named list for smooth</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_lines_arglist">lines_arglist</code></td>
<td>
<p>Named list for lines of smooth</p>
</td></tr>
<tr><td><code id="rplot_raw_+3A_extendrange_f">extendrange_f</code></td>
<td>
<p>Positive number(s) specifying the
fraction by which the range of the residuals should be
extended using the <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>
function. If longer than one, <code>f[1]</code> is used on
the left and <code>f[2]</code> on the right.</p>
</td></tr>
</table>

<hr>
<h2 id='set_abline_arglist'>Set default values of abline_arglist</h2><span id='topic+set_abline_arglist'></span>

<h3>Description</h3>

<p>Set the default values of abline_arglist if not
specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_abline_arglist(abline_arglist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_abline_arglist_+3A_abline_arglist">abline_arglist</code></td>
<td>
<p>A named list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list.
</p>

<hr>
<h2 id='set_lines_arglist'>Set default values of lines_arglist</h2><span id='topic+set_lines_arglist'></span>

<h3>Description</h3>

<p>Set the default values of lines_arglist if not
specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_lines_arglist(lines_arglist)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_lines_arglist_+3A_lines_arglist">lines_arglist</code></td>
<td>
<p>A named list.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list.
</p>

<hr>
<h2 id='set_text_arglist'>Set the default values of text_arglist if not
specified by the user.</h2><span id='topic+set_text_arglist'></span>

<h3>Description</h3>

<p>Set the default values of text_arglist if not
specified by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_text_arglist(text_arglist, x, y, labels, idd)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_text_arglist_+3A_text_arglist">text_arglist</code></td>
<td>
<p>A named list.</p>
</td></tr>
<tr><td><code id="set_text_arglist_+3A_x">x</code></td>
<td>
<p>The x-values of the labels.</p>
</td></tr>
<tr><td><code id="set_text_arglist_+3A_y">y</code></td>
<td>
<p>The y-values of the labels.</p>
</td></tr>
<tr><td><code id="set_text_arglist_+3A_labels">labels</code></td>
<td>
<p>The labels to plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list.
</p>

<hr>
<h2 id='sl_plot'>Spread-level plot of a fitted model</h2><span id='topic+sl_plot'></span>

<h3>Description</h3>

<p><code>sl_plot</code> creates a spread-level plot
for a fitted model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sl_plot(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sl_plot_+3A_model">model</code></td>
<td>
<p>A fitted model.</p>
</td></tr>
<tr><td><code id="sl_plot_+3A_...">...</code></td>
<td>
<p>Currently unimplemented.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Girth ~ Height, data = trees)
sl_plot(lmod)
</code></pre>

<hr>
<h2 id='sl_plot.lm'>Spread-level plot for <code>lm</code> object</h2><span id='topic+sl_plot.lm'></span>

<h3>Description</h3>

<p><code>sl_plot.lm</code> plots a spread-level plot of a fitted
<code>lm</code> object. In general, it is intended to provide
similar functionality to <code><a href="stats.html#topic+plot.lm">plot.lm</a></code>
when <code>which = 3</code>, but can be used for different
types of residuals and can also plot first-order
predictor variables along the x-axis instead of only the
fitted values.<br /><br /> Details about the different types of
residuals are discussed in the
<code><a href="#topic+get_residuals">get_residuals</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
sl_plot(
  model,
  rtype = c("standardized", "studentized", "internally studentized",
    "externally studentized"),
  xaxis = "fitted",
  id_n = 3,
  predictors = ~.,
  smooth = stats::loess,
  add_smooth = TRUE,
  ...,
  text_arglist = list(),
  smooth_arglist = list(),
  lines_arglist = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sl_plot.lm_+3A_model">model</code></td>
<td>
<p>A fitted model object from the
<code><a href="stats.html#topic+lm">lm</a></code> function.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_rtype">rtype</code></td>
<td>
<p>The residual type to plot. The default is
<code>"ordinary"</code>. The other options are
<code>"standardized"</code>, <code>"studentized"</code>,
<code>"loo"</code>, <code>"jackknife"</code>, <code>"deleted"</code>,
<code>"internally studentized"</code>, <code>"externally
studentized"</code>.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_xaxis">xaxis</code></td>
<td>
<p>The variable to use on the x-axis of the
plot(s). The default is <code>"fitted"</code> to use fitted
values. The other option is <code>"predictors"</code>.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_id_n">id_n</code></td>
<td>
<p>The number of points to identify with labels.
The default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_predictors">predictors</code></td>
<td>
<p>A formula describing the first-order
predictors to plot the residuals against. The default
is all available first-order predictors.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_smooth">smooth</code></td>
<td>
<p>A function with a
<code><a href="stats.html#topic+formula">formula</a></code> argument to smooth the
desired plot. The default function is
<code><a href="stats.html#topic+loess">loess</a>.</code></p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_add_smooth">add_smooth</code></td>
<td>
<p>A logical value indicating whether a
smooth should be added to each plot produced. The
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+plot">plot</a></code> function.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_text_arglist">text_arglist</code></td>
<td>
<p>Additional arguments passed to the
<code><a href="graphics.html#topic+text">text</a></code> function, which is used to
display the points that are identified.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_smooth_arglist">smooth_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the function provided in the
<code>smooth</code> argument.</p>
</td></tr>
<tr><td><code id="sl_plot.lm_+3A_lines_arglist">lines_arglist</code></td>
<td>
<p>A named list specifying additional
arguments passed to the <code><a href="graphics.html#topic+lines">lines</a></code>
function for plotting the result of applying the
<code>smooth</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Joshua French
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+text">text</a></code>,
<code><a href="graphics.html#topic+lines">lines</a></code>
<code><a href="stats.html#topic+loess">loess</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmod &lt;- lm(Petal.Length ~ Sepal.Length + Species,
           data = iris)
# similarity with built-in plot.lm functionality
sl_plot(lmod)
plot(lmod, which = 3)
# spread-level plot for other residual types
sl_plot(lmod, rtype = "studentized", id_n = 0)
# spread-level plot for predictors
sl_plot(lmod, xaxis = "pred", id_n = 2)
# spread-level plot for individual predictors
sl_plot(lmod, xaxis = "pred",
        predictors = ~ Sepal.Length,
        id_n = 2)
</code></pre>

<hr>
<h2 id='toluca'>Toluca Company data</h2><span id='topic+toluca'></span>

<h3>Description</h3>

<p>Toluca Company data in Applied Linear
Statistical Models, 5th edition, p. 19. From the book:
</p>
<p>The Toluca Company manufactures refrigeration equipment
as well as many replacement parts. In the past, one of
the replacement parts has been produced periodically in
lots of varying sizes. When a cost improvement program
was undertaken, company officials wished to determine
the optimum lot size for producing this part. The
production of this part involves setting up the
production process (which must be done no matter what
is the lot size) and machining and assembly operations.
One key input for the model to ascertain the optimum
lot size was the relationship between lot size  and
labor hours  required to produce the lot. To determine
this relationship, data on lot size (<code>lot_size</code>)
and work hours (<code>work_hours</code>) for 25 recent
production runs were utilized.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toluca)
</code></pre>


<h3>Format</h3>

<p>A data frame with 25 observations and 2 variables:
</p>

<dl>
<dt><code>lot_size</code></dt><dd><p>Number of replacement parts produced in the lot.</p>
</dd>
<dt><code>work_hours</code></dt><dd><p>Number of hours of work required to produce the lot.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Joshua P. French
</p>


<h3>References</h3>

<p>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W. (2004). Applied Linear Statistical Models, 5th edition. New York: McGraw-Hill/Irwin.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
