<!DOCTYPE html><html><head><title>Help for package naivereg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {naivereg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DSIV'><p>Double-Selection Plus Instrumental Variable Estimator</p></a></li>
<li><a href='#DSIVdata'><p>The data generating for the DSIV</p></a></li>
<li><a href='#DSLIVE'><p>DS-LIVE</p></a></li>
<li><a href='#DSLIVEdata'><p>The data generating for the DSLIVE</p></a></li>
<li><a href='#IVselect'><p>Selecting instrument variables using group lasso and B-splines in naivereg</p></a></li>
<li><a href='#LIVE'><p>Logistic-regression Instrumental Variables Estimator</p></a></li>
<li><a href='#LIVEdata'><p>The data generating for the LIVE</p></a></li>
<li><a href='#naive.gel'><p>Estimete the parameters with gel after IV selecting</p></a></li>
<li><a href='#naive.gmm'><p>Estimete the parameters with gmm after IV selecting</p></a></li>
<li><a href='#naivedata'><p>The data generating for the naivereg</p></a></li>
<li><a href='#naivereg'><p>Nonparametric additive instrumental variable estimator</p></a></li>
<li><a href='#TradeAndGrowthData'><p>Trade and growth data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Nonparametric Additive Instrumental Variable Estimator and
Related IV Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.5</td>
</tr>
<tr>
<td>Author:</td>
<td>Qingliang Fan, KongYu He, Wei Zhong</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Qingliang Fan &lt;michaelqfan@xmu.edu.cn&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>In empirical studies, instrumental variable (IV) regression is the signature method to solve the endogeneity problem. If we enforce the exogeneity condition of the IV, it is likely that we end up with a large set of IVs without knowing which ones are good. Also, one could face the model uncertainty for structural equation, as large micro dataset is commonly available nowadays. This package uses adaptive group lasso and B-spline methods to select the nonparametric components of the IV function, with the linear function being a special case (naivereg). The package also incorporates two stage least squares estimator (2SLS), generalized method of moment (GMM), generalized empirical likelihood (GEL) methods post instrument selection, logistic-regression instrumental variables estimator (LIVE, for dummy endogenous variable problem), double-selection plus instrumental variable estimator (DS-IV) and double selection plus logistic regression instrumental variable estimator (DS-LIVE), where the double selection methods are useful for high-dimensional structural equation models. The naivereg is nonparametric version of 'ivregress' in 'Stata' with IV selection and high dimensional features. The package is based on the paper by Q. Fan and W. Zhong, "Nonparametric Additive Instrumental Variable Estimator: A Group Shrinkage Estimation Perspective" (2018), Journal of Business &amp; Economic Statistics &lt;<a href="https://doi.org/10.1080%2F07350015.2016.1180991">doi:10.1080/07350015.2016.1180991</a>&gt; as well as a series of working papers led by the same authors. </td>
</tr>
<tr>
<td>Imports:</td>
<td>grpreg,splines,gmm,stats,ncvreg,glmnet</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-18 15:10:44 UTC; 56973</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-18 15:40:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='DSIV'>Double-Selection Plus Instrumental Variable Estimator</h2><span id='topic+DSIV'></span>

<h3>Description</h3>

<p>A three-step approach to estimate the endogenous treatment effect using high-dimensional instruments and double selection. It is applicable in the following scenarios: first, there is a known endogeneity problem for the treatment variable. Second, the treatment effect model has a large number of control variables, such as the large micro survey data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DSIV(
  y,
  x,
  z,
  D,
  family = c("gaussian", "binomial", "poisson", "multinomial", "cox", "mgaussian"),
  criterion = c("BIC", "EBIC"),
  alpha = 1,
  nlambda = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DSIV_+3A_y">y</code></td>
<td>
<p>Response variable, an N x 1 vector.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_x">x</code></td>
<td>
<p>Control variables, an N x p1 matrix.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_z">z</code></td>
<td>
<p>Instrumental variables, an N x p2 matrix.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_d">D</code></td>
<td>
<p>Endogenous treatment variable.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_family">family</code></td>
<td>
<p>Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be either a factor with two levels, or a two-column matrix of counts or proportions (the second column is treated as the target class; for a factor, the last level in alphabetical order is the target class). For family=&quot;multinomial&quot;, can be a nc&gt;=2 level factor, or a matrix with nc columns of counts or proportions. For either &quot;binomial&quot; or &quot;multinomial&quot;, if y is presented as a vector, it will be coerced into a factor. For family=&quot;cox&quot;, y should be a two-column matrix with columns named 'time' and 'status'. The latter is a binary variable, with '1' indicating death, and '0' indicating right censored. The function Surv() in package survival produces such a matrix. For family=&quot;mgaussian&quot;, y is a matrix of quantitative responses.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;BIC&quot;, &quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_alpha">alpha</code></td>
<td>
<p>The elasticnet mixing parameter, with 0&lt;=alpha&lt;= 1. alpha=1 is the lasso penalty, and alpha=0 the ridge penalty.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_nlambda">nlambda</code></td>
<td>
<p>The number of lambda values, default is 100.</p>
</td></tr>
<tr><td><code id="DSIV_+3A_...">...</code></td>
<td>
<p>other arguments, see help(glmnet).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The DS-IV algorithm consists of the following three steps: In the first step,
regress the outcome variable y on control variables x using the
regularization method, estimate the coefficients beta and select the important control
variables set denoted by c1. In the second step, regress the treatment variable
d on instrumental variables w and control variables x, estimate the
optimal instrument d and obtain the second important control variables set
denoted by cx. In the third step, obtain the DS-IV estimator of the endogenous
of the endogenous treatment effect based on the estimated optimal instrument d
and the union (c3) of the selected control variables.
</p>


<h3>Value</h3>

<p>An object of type <code>DSIV</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>yhat</code></td>
<td>
<p>The estimated value of y.</p>
</td></tr>
<tr><td><code>betaD</code></td>
<td>
<p>The coefficient of endogenous variable D.</p>
</td></tr>
<tr><td><code>betaX</code></td>
<td>
<p>The coefficient of control variables x.</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>Variable indication of the selected in the first step (control variables x).</p>
</td></tr>
<tr><td><code>cx</code></td>
<td>
<p>Variable indication of selected control variables in the second step.</p>
</td></tr>
<tr><td><code>cz</code></td>
<td>
<p>Variable indication of selected instrumental variables in the second step.</p>
</td></tr>
<tr><td><code>c2</code></td>
<td>
<p>Variable indication of the selected in the second step. The number less than or equal to p1 is an indication of control variables, the number greater than p1 and less than or equal to (p1 + p2) is an indication of instrument variables.</p>
</td></tr>
<tr><td><code>c3</code></td>
<td>
<p>Union of c1 and cx on control variables.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Same as above.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>Same as above.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Wei Zhong, Yang Gao, Wei Zhou and Qingliang Fan (2020), “Endogenous Treatment Effect Estimation Using High-Dimensional Instruments and Double Selection”, working paper
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(naivereg)
data("DSIVdata")
y=DSIVdata[,1]
x=DSIVdata[,2:51]
z=DSIVdata[,52:71]
D=DSIVdata[,72]
res = DSIV(y,x,z,D,family='gaussian', criterion='EBIC')
res$c1 #Variable indication of the selected in the first step (control variables x).
res$cx #Variable indication of selected control variables in the second step.
res$cz #Variable indication of selected instrumental variables in the second step.
res$c3 #Union of c1 and cx on control variables
</code></pre>

<hr>
<h2 id='DSIVdata'>The data generating for the DSIV</h2><span id='topic+DSIVdata'></span>

<h3>Description</h3>

<p>##The data generation process is as follows
</p>
<p>library(MASS)
</p>
<p>n=100
</p>
<p>mu&lt;-rep(0,50)
</p>
<p>var&lt;-matrix(,50,50)
</p>
<p>for(i in 1:50)
</p>
<p>for(j in 1:50)
</p>
<p>var[i,j] &lt;-0.5^(abs(i-j))
</p>


<p>x&lt;-mvrnorm(n,mu,var)#generate x
</p>
<p>mu&lt;-rep(0,20)
</p>
<p>varz&lt;-matrix(,20,20)
</p>
<p>for(i in 1:20)
</p>
<p>for(j in 1:20)
</p>
<p>varz[i,j] &lt;-0.5^(abs(i-j))
</p>


<p>z&lt;-mvrnorm(n,mu,varz)#generate iv
</p>
<p>mu1&lt;-c(0,0)
</p>
<p>v&lt;-c(1,0.9,0.9,1)
</p>
<p>var1&lt;-matrix(v,2,2)
</p>
<p>epsilon&lt;-mvrnorm(n,mu1,var1)#generate error term
</p>
<p>D=1.9*x[,2]+2.5*x[,3]+1.4*x[,5]+x[,6]+x[,1]+1.6*z[,1]+1.9*z[,3]+1.7*z[,2]+epsilon[
,2]
</p>
<p>y=0.75*D+1*x[,1]+2*x[,6]+.11*x[,2]+.18*x[,3]+.12*x[,5]+epsilon[,1]
</p>

<ul>
<li><p> Columns 1: Response variable y, an Nx1 vector.
</p>
</li>
<li><p> Columns 2-51: control variables x, an Nxp1 matrix.
</p>
</li>
<li><p> Columns 52-71: Instrumental variables,an Nxp2 matrix.
</p>
</li>
<li><p> Columns 72: Endogenous treatment variable.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(DSIVdata)</code></pre>

<hr>
<h2 id='DSLIVE'>DS-LIVE</h2><span id='topic+DSLIVE'></span>

<h3>Description</h3>

<p>Double selection plus logistic regression instrumental variable estimator (DS-LIVE). A three-step approach to estimate the dummy endogenous treatment effect using high-dimensional instruments in a penalized logistic regression model and double selection. This method accommodates the binary endogenous variable as well as the high-dimensionality for both the reduced form and structural equation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DSLIVE(
  y,
  x,
  z,
  D,
  criterion = c("BIC", "CV"),
  penalty = c("SCAD", "MCP", "lasso"),
  family = c("gaussian", "binomial", "poisson", "multinomial", "cox", "mgaussian"),
  alpha = 1,
  gamma = 3.7,
  nfolds = 10,
  nlambda = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DSLIVE_+3A_y">y</code></td>
<td>
<p>Response variable, an N x 1 vector.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_x">x</code></td>
<td>
<p>Control variables, an N x p1 matrix.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_z">z</code></td>
<td>
<p>Instrumental variables, an N x p2 matrix.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_d">D</code></td>
<td>
<p>Endogenous treatment variable, the value of endogenous variable is 0 or 1 (binary).</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;BIC&quot;, &quot;CV&quot;, CV means cross-validation, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_penalty">penalty</code></td>
<td>
<p>This parameter takes effect when the creterion is CV. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be either a factor with two levels, or a two-column matrix of counts or proportions (the second column is treated as the target class; for a factor, the last level in alphabetical order is the target class). For family=&quot;multinomial&quot;, can be a nc&gt;=2 level factor, or a matrix with nc columns of counts or proportions. For either &quot;binomial&quot; or &quot;multinomial&quot;, if y is presented as a vector, it will be coerced into a factor. For family=&quot;cox&quot;, y should be a two-column matrix with columns named 'time' and 'status'. The latter is a binary variable, with '1' indicating death, and '0' indicating right censored. The function Surv() in package survival produces such a matrix. For family=&quot;mgaussian&quot;, y is a matrix of quantitative responses.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_family">family</code></td>
<td>
<p>Only applied to the first step in the algorithm, the regression of y on x. Quantitative for family=&quot;gaussian&quot;, or family=&quot;poisson&quot; (non-negative counts). For family=&quot;binomial&quot; should be either a factor with two levels, or a two-column matrix of counts or proportions (the second column is treated as the target class; for a factor, the last level in alphabetical order is the target class). For family=&quot;multinomial&quot;, can be a nc&gt;=2 level factor, or a matrix with nc columns of counts or proportions. For either &quot;binomial&quot; or &quot;multinomial&quot;, if y is presented as a vector, it will be coerced into a factor. For family=&quot;cox&quot;, y should be a two-column matrix with columns named 'time' and 'status'. The latter is a binary variable, with '1' indicating death, and '0' indicating right censored. The function Surv() in package survival produces such a matrix. For family=&quot;mgaussian&quot;, y is a matrix of quantitative responses.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions from the MCP/SCAD penalty and the ridge, or L2 penalty. alpha=1 is equivalent to MCP/SCAD penalty, while alpha=0 would be equivalent to ridge regression. However, alpha=0 is not supported; alpha may be arbitrarily small, but not exactly 0.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_gamma">gamma</code></td>
<td>
<p>The tuning parameter of the MCP/SCAD penalty. Default is 3.7.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_nfolds">nfolds</code></td>
<td>
<p>This parameter takes effect when the creterion is CV. The response number of folds - default is 10. Although nfolds can be as large as the sample size (leave-one-out CV), it is not recommended for large datasets. Smallest value allowable is nfolds=3.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_nlambda">nlambda</code></td>
<td>
<p>The number of lambda values, default is 100.</p>
</td></tr>
<tr><td><code id="DSLIVE_+3A_...">...</code></td>
<td>
<p>other arguments, see help(glmnet) or help(cv.ncvreg).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The DS-IV algorithm consists of the following three steps: In the first step, it estimates the coefficients (betaX) and select the important control variables set (denoted by c1) which are helpful to predict the outcome variable y using regularization methods for the data (y; x). In the second step, using a penalized logistic regression model, it selects both important control variables x (the selected control variables set is denoted by cx) and instrumental variables z for the endogenous treatment D. This step is crucial in the algorithm. Because it can estimate the optimal instrument using high-dimensional IVs as well as select additional important control variables which might be missed in the first step but are nonetheless important to the treatment variable. In the third step, it computes the post-double-selection LIVE estimator for the dummy endogenous treatment effect based on the predicted treatment variable D and the union of selected control variables in the first two variable selection steps denoted by c3 = (c1 union cx).
</p>


<h3>Value</h3>

<p>An object of type <code>DSLIVE</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>betaD</code></td>
<td>
<p>The coefficient of endogenous variable D.</p>
</td></tr>
<tr><td><code>betaX</code></td>
<td>
<p>The coefficient of control variables x.</p>
</td></tr>
<tr><td><code>c1</code></td>
<td>
<p>Variable indication of the selected in the first step (control variables x).</p>
</td></tr>
<tr><td><code>cx</code></td>
<td>
<p>Variable indication of selected control variables in the second step.</p>
</td></tr>
<tr><td><code>cz</code></td>
<td>
<p>Variable indication of selected instrumental variables in the second step.</p>
</td></tr>
<tr><td><code>c2</code></td>
<td>
<p>Variable indication of the selected in the second step. The number less than or equal to p1 is an indication of control variables, the number greater than p1 and less than or equal to (p1 + p2) is an indication of instrument variables.</p>
</td></tr>
<tr><td><code>c3</code></td>
<td>
<p>Union of c1 and cx on control variables.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>Same as above.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>Same as above.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Wei Zhong, Wei Zhou, Qingliang Fan and Yang Gao (2020), “Dummy Endogenous Treatment Effect Estimation Using High-Dimensional Instrumental Variables”, working paper.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(naivereg)
data("DSLIVEdata")
y=DSLIVEdata[,1]
x=DSLIVEdata[,2:201]
z=DSLIVEdata[,202:221]
D=DSLIVEdata[,222]
res = DSLIVE(y,x,z,D,family='gaussian', criterion='BIC')
res$c1 # Variable indication of the selected in the first step (control variables x).
res$cx # Variable indication of selected control variables in the second step.
res$cz # Variable indication of selected instrumental variables in the second step.
res$c3 # Union of c1 and cx on control variables.
</code></pre>

<hr>
<h2 id='DSLIVEdata'>The data generating for the DSLIVE</h2><span id='topic+DSLIVEdata'></span>

<h3>Description</h3>

<p>##The data generation process is as follows
mu&lt;-rep(0,200)
</p>
<p>var&lt;-matrix(,200,200)
</p>
<p>for(i in 1:200)
</p>
<p>for(j in 1:200)
</p>
<p>var[i,j] &lt;-0.5^(abs(i-j))
</p>


<p>x&lt;-mvrnorm(100,mu,var)
</p>
<p>mu&lt;-rep(0,20)
</p>
<p>varz&lt;-matrix(,20,20)
</p>
<p>for(i in 1:20)
</p>
<p>for(j in 1:20)
</p>
<p>varz[i,j] &lt;-0.5^(abs(i-j))
</p>


<p>z&lt;-mvrnorm(100,mu,varz)
</p>
<p>mu1&lt;-c(0,0)
</p>
<p>v&lt;-c(1,0.9,0.9,1)
</p>
<p>var1&lt;-matrix(v,2,2)
</p>
<p>epsilon&lt;-mvrnorm(100,mu1,var1)
</p>
<p>D=rep(0,nrow(x))
</p>
<p>p=.9*x[,4]+.8*x[,1]+1.96*x[,2]+1.85*x[,3]+.7*x[,5]+1.16*z[,1]+.95*z[,3]+1.7*z[,2]+epsilon[,2]
</p>
<p>for(kk in 1:length(p))
</p>
<p>D[kk]&lt;-rbinom(n=1,size =  1,prob =  exp(p[kk])/(1+exp(p[kk])))
</p>

<p>y=0.75*D+3*x[,1]+2*x[,5]+1.5*x[,4]+0*3*x[,7]+0*1.5*x[,8]+.15*x[,2]+.18*x[,3]+epsilon[,1]
</p>

<ul>
<li><p> Columns 1: Response variable y, an Nx1 vector.
</p>
</li>
<li><p> Columns 2-201: control variables x, an Nxp1 matrix.
</p>
</li>
<li><p> Columns 202-221: Instrumental variables,an Nxp2 matrix.
</p>
</li>
<li><p> Columns 222: Endogenous treatment variable,the value of endogenous variable is 0 or 1 (binary).
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(DSLIVEdata)</code></pre>

<hr>
<h2 id='IVselect'>Selecting instrument variables using group lasso and B-splines in naivereg</h2><span id='topic+IVselect'></span>

<h3>Description</h3>

<p>This shows which IVs are selected in the naivereg function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IVselect(
  z,
  x,
  max.degree = 10,
  criterion = c("BIC", "AIC", "GCV", "AICc", "EBIC"),
  df.method = c("default", "active"),
  penalty = c("grLasso", "grMCP", "grSCAD", "gel", "cMCP"),
  endogenous.index = c(),
  IV.intercept = FALSE,
  family = c("gaussian", "binomial", "poisson")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IVselect_+3A_z">z</code></td>
<td>
<p>The instrument variables matrix.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_x">x</code></td>
<td>
<p>The design matrix.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_max.degree">max.degree</code></td>
<td>
<p>The upper limit value of degree of B-splines when using BIC/AIC to choose the tuning parameters, default is BIC.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_df.method">df.method</code></td>
<td>
<p>How should effective model parameters be calculated? One of: &quot;active&quot;, which counts the number of nonzero coefficients; or &quot;default&quot;, which uses the calculated df returned by grpreg, default is &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied to the model. For group selection, one of grLasso, grMCP, or grSCAD. For bi-level selection, one of gel or cMCP. Default is &quot; grLasso&quot;.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_endogenous.index">endogenous.index</code></td>
<td>
<p>Specify which variables in design matrix are endogenous variables, the variable corresponds to the value 1 is endogenous variables, the variable corresponds to the value 0 is exogenous variable, default is all endogenous variables.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_iv.intercept">IV.intercept</code></td>
<td>
<p>Intercept of instrument variables, default is “FALSE”.</p>
</td></tr>
<tr><td><code id="IVselect_+3A_family">family</code></td>
<td>
<p>Either &quot;gaussian&quot; or &quot;binomial&quot;, depending on the response, default is &quot;gaussian&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See naivereg.
</p>


<h3>Value</h3>

<p>An object of type <code>IVselect</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>degree</code></td>
<td>
<p>Degree of B-splines.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;, &quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The index of selected instrument variables.</p>
</td></tr>
<tr><td><code>ind.b</code></td>
<td>
<p>The index of selected instrument variables after B-splines.</p>
</td></tr>
<tr><td><code>IVselect</code></td>
<td>
<p>The instrument variables after B-splines.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Q. Fan and W. Zhong (2018), “Nonparametric Additive Instrumental Variable Estimator: A Group Shrinkage Estimation Perspective,” Journal of Business &amp; Economic Statistics, doi: 10.1080/07350015.2016.1180991.
</p>
<p>Caner, M. and Q. Fan (2015), Hybrid GEL Estimators: Instrument Selection with Adaptive Lasso, Journal of Econometrics, 187, 256–274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#IV selecting with group Lasso an B-splines
library(naivereg)
data("naivedata")
x=naivedata[,1]
y=naivedata[,2]
z=naivedata[,3:22]
IV = IVselect(z,x)
IV$IVselect	#show the IV selected after B-splines
</code></pre>

<hr>
<h2 id='LIVE'>Logistic-regression Instrumental Variables Estimator</h2><span id='topic+LIVE'></span>

<h3>Description</h3>

<p>Binary endogenous variables are commonly encountered in program evaluations using observational data. This is a two-stage approach to estimate the dummy endogenous treatment effect using high-dimensional instrumental variables (IV). In the first stage, we use a penalized logistic reduced form model to accommodate both the binary nature of the endogenous treatment and the high-dimensionality of instrumental variables. In the second stage, we replace the original treatment variable by its estimated propensity score and run a least squares regression to obtain a penalized Logistic-regression Instrumental Variables Estimator (LIVE). If the structural equation model is also high-dimensional, one could use DS-LIVE in this package for selecting both the control variables and IVs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LIVE(
  y,
  x,
  z,
  penalty = c("SCAD", "MCP", "lasso"),
  nfolds = 5,
  endogenous.index = c(),
  gamma = 3.7,
  alpha = 1,
  lambda.min = 0.05,
  nlambda = 100,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LIVE_+3A_y">y</code></td>
<td>
<p>Response variable, an N x 1 vector.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_x">x</code></td>
<td>
<p>The design matrix, including endogenous variable, the value of endogenous variable is 0 or 1 (binary).</p>
</td></tr>
<tr><td><code id="LIVE_+3A_z">z</code></td>
<td>
<p>The instrumental variables matrix.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied to the model. Either &quot;SCAD&quot; (the default), &quot;MCP&quot;, or &quot;lasso&quot;.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_nfolds">nfolds</code></td>
<td>
<p>The response number of folds - default is 5. Although nfolds can be as large as the sample size (leave-one-out CV), it is not recommended for large datasets. Smallest value allowable is nfolds=3.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_endogenous.index">endogenous.index</code></td>
<td>
<p>Specify which variables in design matrix are endogenous variables, the variable corresponds to the value 1 is endogenous variables,  the  variable corresponds to the value 0 is exogenous variable, the default is all endogenous variables.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_gamma">gamma</code></td>
<td>
<p>The tuning parameter of the MCP/SCAD penalty. Default is 3.7.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter for the Mnet estimator which controls the relative contributions from the MCP/SCAD penalty and the ridge, or L2 penalty. alpha=1 is equivalent to MCP/SCAD penalty, while alpha=0 would be equivalent to ridge regression. However, alpha=0 is not supported; alpha may be arbitrarily small, but not exactly 0.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_lambda.min">lambda.min</code></td>
<td>
<p>The smallest value for lambda, as a fraction of lambda.max, default is 0.05.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_nlambda">nlambda</code></td>
<td>
<p>The number of lambda values, default is 100.</p>
</td></tr>
<tr><td><code id="LIVE_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a two stage estimation. In the first stage, a high-dimensional logistic reduced form model with penalty (such as SCAD, lasso, etc.) is used to approximate the optimal instrument. In the second stage, we replace the original treatment variable by its estimated propensity score and run a least squares regression to obtain the penalized Logistic-regression Instrumental Variables Estimator (LIVE). The large dimensional IV could be the original variables or the functional transformations such as series, B-spline functions, etc.
</p>


<h3>Value</h3>

<p>An object of type <code>LIVE</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>The coefficients of x.</p>
</td></tr>
<tr><td><code>lambda.min</code></td>
<td>
<p>The value of lambda that gives minimum cvm.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The selected variables of z.</p>
</td></tr>
<tr><td><code>Xhat</code></td>
<td>
<p>The xhat estimated by z.</p>
</td></tr>
<tr><td><code>IVnum</code></td>
<td>
<p>The number of instrumented variables after filtering.</p>
</td></tr>
<tr><td><code>penalty</code></td>
<td>
<p>Same as above.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Same as above.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Wei Zhong, Wei Zhou, Qingliang Fan and Yang Gao (2020), “Dummy Endogenous Treatment Effect Estimation Using High-Dimensional Instrumental Variables”, working paper.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Logistic-regression Instrumental Variables Estimator
data("LIVEdata")
y=LIVEdata[,1]
x=LIVEdata[,2]
z=LIVEdata[,3:52]
res = LIVE(y,x,z,penalty='SCAD',gamma = 3.7,alpha = 1,lambda.min = 0.05)
</code></pre>

<hr>
<h2 id='LIVEdata'>The data generating for the LIVE</h2><span id='topic+LIVEdata'></span><span id='topic+livedata'></span>

<h3>Description</h3>

<p>The data generating for the LIVE.
</p>

<ul>
<li><p> Columns 1: The response variable y.
</p>
</li>
<li><p> Columns 2: The design matrix x.
</p>
</li>
<li><p> Columns 3-52: TheThe instrumental variables matrix z.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(LIVEdata)</code></pre>

<hr>
<h2 id='naive.gel'>Estimete the parameters with gel after IV selecting</h2><span id='topic+naive.gel'></span>

<h3>Description</h3>

<p>Hybrid gel estimator after selecting IVs in the reduced form equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive.gel(
  g,
  x,
  z,
  max.degree = 10,
  criterion = c("BIC", "AIC", "GCV", "AICc", "EBIC"),
  df.method = c("default", "active"),
  penalty = c("grLasso", "grMCP", "grSCAD", "gel", "cMCP"),
  endogenous.index = c(),
  IV.intercept = FALSE,
  family = c("gaussian", "binomial", "poisson"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive.gel_+3A_g">g</code></td>
<td>
<p>A function of the form <code class="reqn">g(\theta,x)</code> and which returns a <code class="reqn">n \times q</code> matrix with typical element <code class="reqn">g_i(\theta,x_t)</code> for <code class="reqn">i=1,...q</code> and <code class="reqn">t=1,...,n</code>. This matrix is then used to build the q sample moment conditions. It can also be a formula if the model is linear  (see details gel).</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_x">x</code></td>
<td>
<p>The design matrix, without an intercept.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_z">z</code></td>
<td>
<p>The instrument variables matrix.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_max.degree">max.degree</code></td>
<td>
<p>The upper limit value of degree of B-splines when using BIC/AIC to choose the tuning parameters, default is BIC.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;,&quot;EBIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;; default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_df.method">df.method</code></td>
<td>
<p>How should effective model parameters be calculated? One of: &quot;active&quot;, which counts the number of nonzero coefficients; or &quot;default&quot;, which uses the calculated df returned by grpreg. default is &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied to the model. For group selection, one of grLasso, grMCP, or grSCAD. For bi-level selection, one of gel or cMCP. Default is &quot; grLasso&quot;.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_endogenous.index">endogenous.index</code></td>
<td>
<p>Specify which variables in design matrix are endogenous variables, the  variable corresponds to the value 1 is endogenous variables, the variable corresponds to the value 0  is exogenous variable, the default is all endogenous variables.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_iv.intercept">IV.intercept</code></td>
<td>
<p>Intercept of instrument variables, default is “FALSE”.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_family">family</code></td>
<td>
<p>Either &quot;gaussian&quot; or &quot;binomial&quot;, depending on the response, default is &quot;gaussian&quot;.</p>
</td></tr>
<tr><td><code id="naive.gel_+3A_...">...</code></td>
<td>
<p>Arguments passed to gel (such as type,kernel...,detail see gel).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See naivereg and gel
</p>


<h3>Value</h3>

<p>An object of type <code>naive.gel</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>degree</code></td>
<td>
<p>Degree of B-splines.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;; default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The index of selected instrument variables.</p>
</td></tr>
<tr><td><code>ind.b</code></td>
<td>
<p>The index of selected instrument variables after B-splines.</p>
</td></tr>
<tr><td><code>gel</code></td>
<td>
<p>Gel object, detail see gel.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Q. Fan and W. Zhong (2018), “Nonparametric Additive Instrumental Variable Estimator: A Group Shrinkage Estimation Perspective,” Journal of Business &amp; Economic Statistics, doi: 10.1080/07350015.2016.1180991.
</p>
<p>Caner, M. and Fan, Q. (2015), Hybrid GEL Estimators: Instrument Selection with Adaptive Lasso, Journal of Econometrics, Volume 187, 256–274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># gel estimation after IV selection
n = 200
phi&lt;-c(.2,.7)
thet &lt;- 0.2
sd &lt;- .2
set.seed(123)
x &lt;- matrix(arima.sim(n = n, list(order = c(2,0,1), ar = phi, ma = thet, sd = sd)), ncol = 1)
y &lt;- x[7:n]
ym1 &lt;- x[6:(n-1)]
ym2 &lt;- x[5:(n-2)]
H &lt;- cbind(x[4:(n-3)], x[3:(n-4)], x[2:(n-5)], x[1:(n-6)])
g &lt;- y ~ ym1 + ym2
x &lt;- H
naive.gel(g, cbind(ym1,ym2),x, tet0 =c(0,.3,.6))
</code></pre>

<hr>
<h2 id='naive.gmm'>Estimete the parameters with gmm after IV selecting</h2><span id='topic+naive.gmm'></span>

<h3>Description</h3>

<p>Hybrid gmm estimator after selecting IVs in the reduced form equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naive.gmm(
  g,
  x,
  z,
  max.degree = 10,
  criterion = c("BIC", "AIC", "GCV", "AICc", "EBIC"),
  df.method = c("default", "active"),
  penalty = c("grLasso", "grMCP", "grSCAD", "gel", "cMCP"),
  endogenous.index = c(),
  IV.intercept = FALSE,
  family = c("gaussian", "binomial", "poisson"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naive.gmm_+3A_g">g</code></td>
<td>
<p>A function of the form <code class="reqn">g(\theta,x)</code> and which returns a <code class="reqn">n \times q</code> matrix with typical element <code class="reqn">g_i(\theta,x_t)</code> for <code class="reqn">i=1,...q</code> and <code class="reqn">t=1,...,n</code>. This matrix is then used to build the q sample moment conditions. It can also be a formula if the model is linear  (see details gmm).</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_x">x</code></td>
<td>
<p>The design matrix, without an intercept.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_z">z</code></td>
<td>
<p>The instrument variables matrix.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_max.degree">max.degree</code></td>
<td>
<p>The upper limit value of degree of B-splines when using BIC/AIC to choose the tuning parameters, default is BIC.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_df.method">df.method</code></td>
<td>
<p>How should effective model parameters be calculated? One of: &quot;active&quot;, which counts the number of nonzero coefficients; or &quot;default&quot;, which uses the calculated df returned by grpreg, default is &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied to the model. For group selection, one of grLasso, grMCP, or grSCAD. For bi-level selection, one of gel or cMCP, default is &quot; grLasso&quot;.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_endogenous.index">endogenous.index</code></td>
<td>
<p>Specify which variables in design matrix are endogenous variables, the variable corresponds to the value 1 is endogenous variables,  the  variable corresponds to the value 0 is exogenous variable, the default is all endogenous variables.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_iv.intercept">IV.intercept</code></td>
<td>
<p>Intercept of instrument variables, default is “FALSE”.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_family">family</code></td>
<td>
<p>Either &quot;gaussian&quot; or &quot;binomial&quot;, depending on the response.default is &quot; gaussian &quot;.</p>
</td></tr>
<tr><td><code id="naive.gmm_+3A_...">...</code></td>
<td>
<p>Arguments passed to gmm (such as type,kernel...,detail see gmm).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See naivereg and gmm.
</p>


<h3>Value</h3>

<p>An object of type <code>naive.gmm</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>degree</code></td>
<td>
<p>Degree of B-splines.</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The index of selected instrument variables.</p>
</td></tr>
<tr><td><code>ind.b</code></td>
<td>
<p>The index of selected instrument variables after B-splines.</p>
</td></tr>
<tr><td><code>gmm</code></td>
<td>
<p>Gmm object, detail see gmm.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Q. Fan and W. Zhong (2018), “Nonparametric Additive Instrumental Variable Estimator: A Group Shrinkage Estimation Perspective,” Journal of Business &amp; Economic Statistics, doi: 10.1080/07350015.2016.1180991.
</p>
<p>Caner, M. and Fan, Q. (2015), Hybrid GEL Estimators: Instrument Selection with Adaptive Lasso, Journal of Econometrics, Volume 187, 256–274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># gmm estimation after IV selection
data("naivedata")
x=naivedata[,1]
y=naivedata[,2]
z=naivedata[,3:22]
naive.gmm(y~x+x^2,cbind(x,x^2),z)
</code></pre>

<hr>
<h2 id='naivedata'>The data generating for the naivereg</h2><span id='topic+naivedata'></span>

<h3>Description</h3>

<p>The z and residuals are both generated from a normal distribution.
</p>
<p>x = sin(z1)+exp(z5)+z4^2+z15+log(z19+8)+e1.
</p>
<p>y = 0.5*x+e2.
</p>

<ul>
<li><p> Columns 1: The design matrix x.
</p>
</li>
<li><p> Columns 2: The response variable y.
</p>
</li>
<li><p> Columns 3-22: TheThe instrumental variables matrix z.
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(naivedata)</code></pre>

<hr>
<h2 id='naivereg'>Nonparametric additive instrumental variable estimator</h2><span id='topic+naivereg'></span>

<h3>Description</h3>

<p>NAIVE is the nonparametric additive instrumental variable estimator with the adaptive group Lasso. It uses group lasso and B-splines to obtain the valid instrument variables where BIC are applied to choose the tuning parameters. Then we get the two-stage least squares (2SLS) estimator with selected IV.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>naivereg(
  y,
  x,
  z,
  max.degree = 10,
  intercept = TRUE,
  criterion = c("BIC", "AIC", "GCV", "AICc", "EBIC"),
  df.method = c("default", "active"),
  penalty = c("grLasso", "grMCP", "grSCAD", "gel", "cMCP"),
  endogenous.index = c(),
  IV.intercept = FALSE,
  family = c("gaussian", "binomial", "poisson")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="naivereg_+3A_y">y</code></td>
<td>
<p>Response variable, a matrix N x 1.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_x">x</code></td>
<td>
<p>The design matrix, without an intercept.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_z">z</code></td>
<td>
<p>The instrument variables matrix.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_max.degree">max.degree</code></td>
<td>
<p>The upper limit value of degree of B-splines when using BIC/AIC to choose the tuning parameters, default is BIC.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_intercept">intercept</code></td>
<td>
<p>Estimate with intercept or not, default is &quot;TRUE&quot;.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_criterion">criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;, default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_df.method">df.method</code></td>
<td>
<p>How should effective model parameters be calculated? One of: &quot;active&quot;, which counts the number of nonzero coefficients; or &quot;default&quot;, which uses the calculated df returned by grpreg, default is &quot;default&quot;.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_penalty">penalty</code></td>
<td>
<p>The penalty to be applied to the model. For group selection, one of grLasso, grMCP, or grSCAD. For bi-level selection, one of gel or cMCP, default is &quot; grLasso&quot;.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_endogenous.index">endogenous.index</code></td>
<td>
<p>Specify which variables in design matrix are endogenous variables, the  variable corresponds to the value 1 is endogenous variables, thevariable corresponds to the value 0 is exogenous variable, the default is all endogenous variables.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_iv.intercept">IV.intercept</code></td>
<td>
<p>Intercept of instrument variables, default is “FALSE”.</p>
</td></tr>
<tr><td><code id="naivereg_+3A_family">family</code></td>
<td>
<p>Either &quot;gaussian&quot; or &quot;binomial&quot;, depending on the response.default is &quot; gaussian &quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider the following structural equation with endogenous regressors<code class="reqn">Y_{i}= x_{u}^{T}\beta+ \epsilon_{i}</code>
</p>
<p>To solve the endogeneity problem, instrumental variables are employed to obtain a consistent estimator of the population regression coefficient <code class="reqn">\beta</code>. In practice, many potential instruments, including their series terms, may be recruited to approximate the optimal instrument and improve the precision of IV estimators. On the other hand, if many irrelevant instruments are contained in the reduced form equation, the approximation of the optimal instrument is generally unsatisfactory and the IV estimator is less efficient. In some cases where the dimensionality of <code class="reqn">z_{i}</code>is even higher than the sample size, the linear IV method fails. To address these issues, the model sparsity is usually assumed and the penalized approaches can be applied to improve the efficiency of IV estimators. In this paper we propose the first-stage parsimonious predictive models and estimate optimal instruments in IV models with potentially more instruments than the sample size n.
</p>
<p>The performance of the linear IV estimator in the finite sample is largely dependent on the validity of linearity assumption. This phenomenon motivated us to consider a more general nonlinear reduced form equation to capture as much information of <code class="reqn">x_{i}</code>as possible using instruments <code class="reqn">z_{i}</code> under the high-dimensional model settings. This nonparametric idea for the reduced form model is consistent with Newey (1990). We consider the following nonparametric additive reduced form model with a large number of possible instruments.
</p>
<p><code class="reqn">x_{il} = \mu_l+\sum_{j=1}^p f_{ij}z_{ij}+\xi_{il}</code>
</p>
<p>To estimate the nonparametric components above, we use B-spline basis functions by following the idea of Huang, Horowitz, and Wei (2010). Let <code class="reqn">S_{n}</code>be the space of polynomial splines of degrees L&gt;1 and let <code class="reqn">\phi_{k},k=1,2,…,m_{n}</code>be normalized B-spline basis functions for <code class="reqn">S_{n}</code>, where  <code class="reqn">m_{n}</code> is the sum of the polynomial degree L and the number of knots. Let be the <code class="reqn">\psi_{k}(z_{ij})=\phi_{k}(z_{ij})-n^{-1}\sum_{i=1}^n \phi_{k}(z_{ij})</code>centered B-spline basis functions for the  th instrument. The model can then be rewritten using an approximate linear reduced form:
</p>
<p><code class="reqn">x_{il} = \mu_{l}+\sum_{j=1}^pf_{ij} \sum_{k=1}^{m_{n}} (\gamma_{ij})\psi(z_{ij})+\xi_{il}</code>
</p>
<p>To select the significant instruments and estimate the component functions simultaneously, we consider the following penalized objective function with an adaptive group Lasso penalty (Huang, Horowitz, and Wei 2010) for each <code class="reqn">l</code> th endogenous variable
</p>
<p><code class="reqn">L_{n}(\gamma_{l};\lambda_{n})=||X_{l}-U\lambda_{l}||_{2}^{2}+\lambda_{n}\sum_{j=1}^{p} \omega_{njl} ||\gamma_{jl}||_{2}</code>,where <code class="reqn">\omega_{jnl}=||\gamma_{jl}||_{2}^{-1}</code>,if <code class="reqn">||\gamma_{jl}||_{2}&gt;0</code>,<code class="reqn">\omega_{jnl}=infty</code>,if <code class="reqn">||\gamma_{jl}||_{2}=0</code>
</p>
<p>By minimizing the penalized objective function with a group Lasso penalty we by minimizing the penalized objective function with a group Lasso penalty. And then we use the selected IV for <code class="reqn">\beta</code> in the model with two-stage least squares (2SLS).
</p>


<h3>Value</h3>

<p>An object of type <code>naivereg</code> which is a list with the following
components:
</p>
<table>
<tr><td><code>beta.endogenous</code></td>
<td>
<p>The coefficient of endogenous variable.</p>
</td></tr>
<tr><td><code>beta.exogenous</code></td>
<td>
<p>The coefficient of exogenous variable.</p>
</td></tr>
<tr><td><code>std.endogenous</code></td>
<td>
<p>The standard deviation of the endogenous variables' coefficients.</p>
</td></tr>
<tr><td><code>std.exogenous</code></td>
<td>
<p>The standard deviation of the exogenous variables' coefficients.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>Number of samples.</p>
</td></tr>
<tr><td><code>degree</code></td>
<td>
<p>Degree of B-splines. </p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>The criterion by which to select the regularization parameter. One of &quot;AIC&quot;, &quot;BIC&quot;, &quot;GCV&quot;, &quot;AICc&quot;,&quot;EBIC&quot;; default is &quot;BIC&quot;.</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p>The index of selected instrument variables. Each row represents the instrumental variable selected for the corresponding endogenous variable. The order of the endogenous variables is from left to right in x.</p>
</td></tr>
<tr><td><code>ind.b</code></td>
<td>
<p>The index of selected instrument variables after B-splines. Each row represents the instrumental variable selected for the corresponding endogenous variable. The order of the endogenous variables is from left to right in x.</p>
</td></tr>
<tr><td><code>res</code></td>
<td>
<p>The difference between the predicted y and the actual y.</p>
</td></tr>
<tr><td><code>t.endogenous</code></td>
<td>
<p>The t-value of the endogenous variables' coefficients.</p>
</td></tr>
<tr><td><code>t.exogenous</code></td>
<td>
<p>The t-value of the exogenous variables' coefficients.</p>
</td></tr>
<tr><td><code>endogenous.conf.interval.lower</code></td>
<td>
<p>The lower bound of 95 percent confidence interval for endogenous variables.</p>
</td></tr>
<tr><td><code>endogenous.conf.interval.upper</code></td>
<td>
<p>The upper bound of 95 percent confidence interval for endogenous variables.</p>
</td></tr>
<tr><td><code>exogenous.conf.interval.lower</code></td>
<td>
<p>The lower bound of 95 percent confidence interval for exogenous variables.</p>
</td></tr>
<tr><td><code>exogenous.conf.interval.upper</code></td>
<td>
<p>The upper bound of 95 percent confidence interval for exogenous variables.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Qingliang Fan, KongYu He, Wei Zhong
</p>


<h3>References</h3>

<p>Q. Fan and W. Zhong (2018), “Nonparametric Additive Instrumental Variable Estimator: A Group Shrinkage Estimation Perspective,” Journal of Business &amp; Economic Statistics, doi: 10.1080/07350015.2016.1180991.
</p>
<p>Caner, M. and Fan, Q. (2015), Hybrid GEL Estimators: Instrument Selection with Adaptive Lasso, Journal of Econometrics, Volume 187, 256–274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#naive regression
library(naivereg)
data("naivedata")
x=naivedata[,1]
y=naivedata[,2]
z=naivedata[,3:22]
#estimate with intercept
naive_intercept= naivereg(y,x,z)
#estimate without intercept,criterion:AIC
naive_without_intercept = naivereg(y,x,z,intercept=FALSE,criterion='AIC')
</code></pre>

<hr>
<h2 id='TradeAndGrowthData'>Trade and growth data</h2><span id='topic+TradeAndGrowthData'></span>

<h3>Description</h3>

<p>This is a revisit of the seminal work of Frankel and Romer (1999, AER) &rdquo;Does trade cause growth?&quot; using new 2017 data.  NAIVE method is detailed in Fan and Zhong (2018, JBES), &quot;Nonparametric additive instrumental variable estimator: a group shrinkage estimation perspective&quot;. We found that trade still has significant effect on growth, but compared to the original studies, the effect of trade seems to be smaller in magnitude and NAIVE is able to select the important IVs which yield unbiased estimation. See details of the study including the invalid IV discussion in Fan and Wu (2020).
</p>

<ul>
<li><p> N: log(economically active population in millions).
</p>
</li>
<li><p> A: log(land area).
</p>
</li>
<li><p> water: water area.
</p>
</li>
<li><p> coast: coastline.
</p>
</li>
<li><p> arable: arable percentage.
</p>
</li>
<li><p> border: land border.
</p>
</li>
<li><p> forest: forest percentage.
</p>
</li>
<li><p> lang: number of official languages.
</p>
</li>
<li><p> pm25: PM2.5.
</p>
</li>
<li><p> ww: waterways.
</p>
</li>
<li><p> rw: railway.
</p>
</li>
<li><p> in_water=T_hat*water.
</p>
</li>
<li><p> in_coast=T_hat*coast.
</p>
</li>
<li><p> in_arable=T_hat*arable.
</p>
</li>
<li><p> in_border=T_hat*border.
</p>
</li>
<li><p> in_forest=T_hat*forest.
</p>
</li>
<li><p> in_lang=T_hat*lang.
</p>
</li>
<li><p> ...
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>data(TradeAndGrowthData)</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
