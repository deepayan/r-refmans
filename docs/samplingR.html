<!DOCTYPE html><html lang="en"><head><title>Help for package samplingR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samplingR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cluster.estimator'><p>Parameter estimation for cluster samples</p></a></li>
<li><a href='#cluster.sample'><p>Cluster sample for non-grouped data.</p></a></li>
<li><a href='#cluster.samplesize'><p>Sample size estimation on cluster sampling</p></a></li>
<li><a href='#srs.domainestimator'><p>Simple Random Sample parameter estimation of domains.</p></a></li>
<li><a href='#srs.estimator'><p>Simple Ramdom Sampling parameter estimation.</p></a></li>
<li><a href='#srs.sample'><p>Simple Random Sample</p></a></li>
<li><a href='#srs.samplesize'><p>Simple Random Sample size.</p></a></li>
<li><a href='#strata.allocation'><p>Strata allocation given a sample size</p></a></li>
<li><a href='#strata.estimator'><p>Parameter estimation of stratified data</p></a></li>
<li><a href='#strata.sample'><p>Stratified sample</p></a></li>
<li><a href='#strata.samplesize'><p>Sample size estimation on stratified sampling</p></a></li>
<li><a href='#strata.samplesize.cost'><p>Strata sample size by costs function</p></a></li>
<li><a href='#syst.all.samples'><p>Systematic samples</p></a></li>
<li><a href='#syst.anova'><p>Analysis of variance of population data</p></a></li>
<li><a href='#syst.estimator'><p>Parameter estimation on a systematic sample</p></a></li>
<li><a href='#syst.intercorr'><p>Stratified correlation coefficient</p></a></li>
<li><a href='#syst.intracorr'><p>Intraclass correlation coefficient</p></a></li>
<li><a href='#syst.sample'><p>Systematic sampling sample</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sampling and Estimation Methods</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-06-25</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Javier Estévez &lt;javier.estase@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to take samples of data, sample size estimation and getting useful estimators such as total, mean, proportion about its population using simple random, stratified, systematic and cluster sampling. </td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, methods</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-06-25 19:53:00 UTC; javie</td>
</tr>
<tr>
<td>Author:</td>
<td>Javier Estévez [aut, cre, cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-06-26 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cluster.estimator'>Parameter estimation for cluster samples</h2><span id='topic+cluster.estimator'></span>

<h3>Description</h3>

<p>Estimates parameters with optional confidence interval for clustered data
of similar cluster size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster.estimator(
  N,
  data,
  estimator = c("total", "mean", "proportion", "class total"),
  replace = FALSE,
  alpha
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster.estimator_+3A_n">N</code></td>
<td>
<p>Number of clusters for the population</p>
</td></tr>
<tr><td><code id="cluster.estimator_+3A_data">data</code></td>
<td>
<p>Cluster sample</p>
</td></tr>
<tr><td><code id="cluster.estimator_+3A_estimator">estimator</code></td>
<td>
<p>Estimator to compute. Can be one of &quot;total&quot;, &quot;mean&quot;, &quot;proportion&quot;, &quot;class total&quot;. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="cluster.estimator_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="cluster.estimator_+3A_alpha">alpha</code></td>
<td>
<p>Optional value to calculate estimation error and build 1-alpha</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function admits both grouped and non-grouped by cluster data.<br />
Non-grouped data must have interest variable data in the first column and cluster
name each individual belongs to in the last column.<br />
Grouped by cluster data must have interest variable data in the first column,
cluster size in the second and the cluster name in the last column. Interest
values of grouped data must reflect the total value of each cluster.
</p>


<h3>Value</h3>

<p>A list containing different interest values:
</p>

<ul>
<li><p> estimator
</p>
</li>
<li><p> variance
</p>
</li>
<li><p> sampling.error
</p>
</li>
<li><p> estimation.error
</p>
</li>
<li><p> confint
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>d&lt;-cbind(rnorm(500, 50, 20), rep(c(1:50),10)) #Non-grouped data
sample&lt;-cluster.sample(d, n=10) #Non-grouped sample
sampleg&lt;-aggregate(sample[,1], by=list(Category=sample[,2]), FUN=sum)
sampleg&lt;-cbind(sampleg[,2], rep(10,10), sampleg[,1]) #Same sample but with grouped data
sum(d[,1])
cluster.estimator(N=50, data=sample, estimator="total", alpha=0.05)
cluster.estimator(N=50, data=sampleg, estimator="total", alpha=0.05)
</code></pre>

<hr>
<h2 id='cluster.sample'>Cluster sample for non-grouped data.</h2><span id='topic+cluster.sample'></span>

<h3>Description</h3>

<p>Retrieves a sample of clusters for data which interest variable values
are not grouped by cluster.<br />
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster.sample(data, n, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster.sample_+3A_data">data</code></td>
<td>
<p>Matrix or data.frame containing the population data in first column and the cluster it belongs to in the last column.</p>
</td></tr>
<tr><td><code id="cluster.sample_+3A_n">n</code></td>
<td>
<p>Number of clusters of the returning sample.</p>
</td></tr>
<tr><td><code id="cluster.sample_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated clusters or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>#' If your data is grouped by cluster use <code><a href="#topic+srs.sample">srs.sample</a></code> function to retrieve
your sample. Remember grouped by cluster data must have interest variable data in the first column,
cluster size in the second and the cluster name in the last column. Interest
values of grouped data must reflect the total value of each cluster.
</p>


<h3>Value</h3>

<p>Data frame of a clustered sample
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-cbind(rnorm(500, 50, 20), rep(c(1:50),10))
sample&lt;-cluster.sample(data, 10);sample

</code></pre>

<hr>
<h2 id='cluster.samplesize'>Sample size estimation on cluster sampling</h2><span id='topic+cluster.samplesize'></span>

<h3>Description</h3>

<p>Calculates the required sample size in order to achieve an
absolute sampling error  less or equal to the specified for an specific
estimator and an optional confidence interval in cluster sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster.samplesize(
  N,
  data,
  error,
  alpha,
  estimator = c("total", "mean", "proportion", "class total"),
  replace = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cluster.samplesize_+3A_n">N</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="cluster.samplesize_+3A_data">data</code></td>
<td>
<p>Dataset.</p>
</td></tr>
<tr><td><code id="cluster.samplesize_+3A_error">error</code></td>
<td>
<p>Sampling error.</p>
</td></tr>
<tr><td><code id="cluster.samplesize_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to obtain confidence intervals.</p>
</td></tr>
<tr><td><code id="cluster.samplesize_+3A_estimator">estimator</code></td>
<td>
<p>The estimator to be estimated. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="cluster.samplesize_+3A_replace">replace</code></td>
<td>
<p>Whether the samples to be taken can have repeated instances or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function admits both grouped and non-grouped by cluster data.<br />
Non-grouped data must have interest variable data in the first column and cluster
name each individual belongs to in the last column.<br />
Grouped by cluster data must have interest variable data in the first column,
cluster size in the second and the cluster name in the last column. Interest
values of grouped data must reflect the total value of each cluster.
</p>


<h3>Value</h3>

<p>Number of clusters to be taken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d&lt;-cbind(rnorm(500, 50, 20), rep(c(1:50),10)) #Non-grouped data
sample&lt;-cluster.sample(d, n=10) #Non-grouped sample
sampleg&lt;-aggregate(sample[,1], by=list(Category=sample[,2]), FUN=sum)
sampleg&lt;-cbind(sampleg[,2], rep(10,10), sampleg[,1]) #Sample sample with grouped data

#Cluster size to be taken for estimation
cluster.samplesize(N=50, data=sample, error=500, estimator="total", replace=TRUE)

newsample&lt;-cluster.sample(d, n=26) #New sample for estimation
sum(d[,1])
cluster.estimator(N=50, data=newsample, estimator="total", alpha=0.05, replace=TRUE)
cluster.estimator(N=50, data=sampleg, estimator="total", alpha=0.05)
</code></pre>

<hr>
<h2 id='srs.domainestimator'>Simple Random Sample parameter estimation of domains.</h2><span id='topic+srs.domainestimator'></span>

<h3>Description</h3>

<p>Function to make estimations of diferent parameters on a given domain
based on a Simple Random Sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs.domainestimator(
  Nh,
  data,
  estimator = c("total", "mean", "proportion", "class total"),
  domain,
  replace = FALSE,
  alpha
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs.domainestimator_+3A_nh">Nh</code></td>
<td>
<p>Number of instances of the data set domain.</p>
</td></tr>
<tr><td><code id="srs.domainestimator_+3A_data">data</code></td>
<td>
<p>Sample of the data. It must constain a column with the data to estimate
and a second column with the domain of each instance.</p>
</td></tr>
<tr><td><code id="srs.domainestimator_+3A_estimator">estimator</code></td>
<td>
<p>One of &quot;total&quot;, &quot;mean&quot;. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="srs.domainestimator_+3A_domain">domain</code></td>
<td>
<p>Domain of the sample from which parameter estimation will be done.</p>
</td></tr>
<tr><td><code id="srs.domainestimator_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="srs.domainestimator_+3A_alpha">alpha</code></td>
<td>
<p>Optional value to calculate estimation error and build 1-alpha
confidence interval.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data columns must be arranged with interest values on the first column
and domain values on the last column.<br />
Domain parameter can be either numeric or character
and must be equal to one of the values of the domain column of data.
</p>


<h3>Value</h3>

<p>A list containing different interest values:
</p>

<ul>
<li><p> estimator
</p>
</li>
<li><p> variance
</p>
</li>
<li><p> sampling.error
</p>
</li>
<li><p> estimation.error
</p>
</li>
<li><p> confint
</p>
</li></ul>



<h3>References</h3>

<p>Pérez, C. (1999) Técnicas de muestreo estadístico. Teoría, práctica y aplicaciones informáticas. 193-195
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-cbind(rnorm(500, 50, 20), rep(c(1:2),250))
sample&lt;-data[srs.sample(500, 100),]
sum(data[which(data[,-1]==1),1])
srs.domainestimator(Nh = 250, data = sample, estimator="total", domain=1)

</code></pre>

<hr>
<h2 id='srs.estimator'>Simple Ramdom Sampling parameter estimation.</h2><span id='topic+srs.estimator'></span>

<h3>Description</h3>

<p>Function to make estimations of diferent parameters based on
a Simple Random Sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs.estimator(
  N,
  data,
  estimator = c("total", "mean", "proportion", "class total"),
  replace = FALSE,
  alpha
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs.estimator_+3A_n">N</code></td>
<td>
<p>Number of instances of the data set.</p>
</td></tr>
<tr><td><code id="srs.estimator_+3A_data">data</code></td>
<td>
<p>Sample of the data. It must only contain a single column of the
data to estimate.</p>
</td></tr>
<tr><td><code id="srs.estimator_+3A_estimator">estimator</code></td>
<td>
<p>Estimator to compute. Can be one of &quot;total&quot;, &quot;mean&quot;, &quot;proportion&quot;, &quot;class total&quot;. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="srs.estimator_+3A_replace">replace</code></td>
<td>
<p>Whether the sample has been taken with replacement or not.</p>
</td></tr>
<tr><td><code id="srs.estimator_+3A_alpha">alpha</code></td>
<td>
<p>Optional value to calculate estimation error and build 1-alpha
confidence interval.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing different interest values:
</p>

<ul>
<li><p> estimator
</p>
</li>
<li><p> variance
</p>
</li>
<li><p> sampling.error
</p>
</li>
<li><p> estimation.error
</p>
</li>
<li><p> confint
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-rnorm(200, 100, 20)
sample&lt;-data[srs.sample(200, 50)]
tau&lt;-sum(data);tau
srs.estimator(200, sample, "total", alpha=0.05)


mu&lt;-mean(data);mu
srs.estimator(200, sample, "mean", alpha=0.05)
</code></pre>

<hr>
<h2 id='srs.sample'>Simple Random Sample</h2><span id='topic+srs.sample'></span>

<h3>Description</h3>

<p>With this function you receive a simple random sample consisting
on a list of the instances index
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs.sample(N, n, replace = FALSE, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs.sample_+3A_n">N</code></td>
<td>
<p>Number of instances of the data set.</p>
</td></tr>
<tr><td><code id="srs.sample_+3A_n">n</code></td>
<td>
<p>Number of instances of the returning sample.</p>
</td></tr>
<tr><td><code id="srs.sample_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="srs.sample_+3A_data">data</code></td>
<td>
<p>Optional matrix or data.frame containing the population data.
If specified an object of same class as data will be returned with sample instances.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of size n with numbers from 1 to N indicating the index of the
data set's instances to be taken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>srs.sample(10,3)


data&lt;-matrix(data=c(1:24), nrow=8)
N&lt;-dim(data)[1]
sample&lt;-srs.sample(N, 3, data = data)
sample

</code></pre>

<hr>
<h2 id='srs.samplesize'>Simple Random Sample size.</h2><span id='topic+srs.samplesize'></span>

<h3>Description</h3>

<p>Calculates the required sample size in order to achieve a relative
or absolute sampling error  less or equal to the specified for an specific
estimator and an optional confidence interval in simple random sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs.samplesize(
  N,
  var,
  error,
  alpha,
  estimator = c("total", "mean", "proportion", "class total"),
  p,
  mean,
  replace = FALSE,
  relative = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs.samplesize_+3A_n">N</code></td>
<td>
<p>Number of instances of the data set.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_var">var</code></td>
<td>
<p>Estimated quasivariance.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_error">error</code></td>
<td>
<p>Sampling error</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to obtain confidence intervals.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_estimator">estimator</code></td>
<td>
<p>One of &quot;total&quot;, &quot;proportion&quot;, &quot;mean&quot;, &quot;class total&quot;. Default is &quot;total&quot;</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_p">p</code></td>
<td>
<p>Estimated proportion. If estimator is not &quot;proportion&quot; or &quot;class total&quot; it will be ignored.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_mean">mean</code></td>
<td>
<p>Estimated mean. If relative=FALSE it will be ignored.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="srs.samplesize_+3A_relative">relative</code></td>
<td>
<p>Whether the specified error is relative or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the sample size result is not a whole number the number returned is
the next whole number so srs.samplesize&gt;=n is satisfied.<br />
To estimate sample size of estimators &quot;total&quot; and &quot;mean&quot; estimated quasivariance
must be provided. If the error is relative then estimated mean must also be provided.<br />
To estimate sample size of estimator &quot;proportion&quot; and &quot;class total&quot; estimated
proportion must be provided. If p is not specified sample size will be estimated
based on worst-case scenario of p=0.5.<br />
N must be always be provided for calculations.
</p>


<h3>Value</h3>

<p>Number of instances of the sample to be taken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-rnorm(200, 100, 20)
n&lt;-srs.samplesize(200, var(data), estimator="total", error=400, alpha=0.05);n
sample&lt;-data[srs.sample(200, n)]
srs.estimator(200, sample, "total", alpha=0.05)$sampling.error


</code></pre>

<hr>
<h2 id='strata.allocation'>Strata allocation given a sample size</h2><span id='topic+strata.allocation'></span>

<h3>Description</h3>

<p>Function to allocate the number of samples to be taken for each
strata given the total sample size and the strata.allocation method. The number of allocations
returned will be equal to the length of the parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strata.allocation(
  Nh,
  n,
  var,
  alloc = c("unif", "prop", "min", "optim"),
  C,
  cini,
  ch
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strata.allocation_+3A_nh">Nh</code></td>
<td>
<p>Vector of population strata sizes.</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_var">var</code></td>
<td>
<p>Vector of strata variances.</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_alloc">alloc</code></td>
<td>
<p>The allocation method to be used. Default is &quot;unif&quot;.</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_c">C</code></td>
<td>
<p>Total study cost.</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_cini">cini</code></td>
<td>
<p>Overhead study cost.</p>
</td></tr>
<tr><td><code id="strata.allocation_+3A_ch">ch</code></td>
<td>
<p>Vector of costs to take an individual from a strata for the sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>alloc=&quot;optim&quot; is the only that requires cost function data.
Total study and overhead study costs are optional. If given allocation will be done
so total study cost is not surpassed.s
</p>


<h3>Value</h3>

<p>Vector of strata sample sizes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strata.allocation(Nh=rep(125,4), n=100, alloc="unif") #25, 25, 25, 25
strata.allocation(Nh=c(100, 50, 25), n=100, alloc="prop")
</code></pre>

<hr>
<h2 id='strata.estimator'>Parameter estimation of stratified data</h2><span id='topic+strata.estimator'></span>

<h3>Description</h3>

<p>Function to make estimations of diferent parameters based on
a stratified sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strata.estimator(
  N,
  Nh,
  data,
  estimator = c("total", "mean", "proportion", "class total"),
  replace = FALSE,
  alpha
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strata.estimator_+3A_n">N</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="strata.estimator_+3A_nh">Nh</code></td>
<td>
<p>Size of each population strata.</p>
</td></tr>
<tr><td><code id="strata.estimator_+3A_data">data</code></td>
<td>
<p>Stratified sample.</p>
</td></tr>
<tr><td><code id="strata.estimator_+3A_estimator">estimator</code></td>
<td>
<p>Estimator to compute. Can be one of &quot;total&quot;, &quot;mean&quot;, &quot;proportion&quot;, &quot;class total&quot;. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="strata.estimator_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="strata.estimator_+3A_alpha">alpha</code></td>
<td>
<p>Optional value to calculate estimation error and build 1-alpha</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nh length must be equal to number of strata in data.<br />
data is meant to be a returned object of <code><a href="#topic+strata.sample">strata.sample</a></code> function.
</p>


<h3>Value</h3>

<p>A list containing different interest values:
</p>

<ul>
<li><p> estimator
</p>
</li>
<li><p> variance
</p>
</li>
<li><p> sampling.error
</p>
</li>
<li><p> estimation.error
</p>
</li>
<li><p> confint
</p>
</li></ul>


<hr>
<h2 id='strata.sample'>Stratified sample</h2><span id='topic+strata.sample'></span>

<h3>Description</h3>

<p>With this function you receive a sample of each strata within your
data with specified size for each strata.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strata.sample(data, n, replace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strata.sample_+3A_data">data</code></td>
<td>
<p>Population data consisting of a number of columns of data and a last
column specifying the strata each instance belongs to.</p>
</td></tr>
<tr><td><code id="strata.sample_+3A_n">n</code></td>
<td>
<p>Numeric array of sample sizes for each strata to be taken.</p>
</td></tr>
<tr><td><code id="strata.sample_+3A_replace">replace</code></td>
<td>
<p>Whether the sample to be taken can have repeated instances or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>n length must be equal to number of strata in data.<br />
On return list each strata sample can be accessed calling object$strataname where
strataname are values of the last column of the original data.
</p>


<h3>Value</h3>

<p>A list containing one strata sample per index.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-cbind(rnorm(500, 50, 20), rep(c("clase 1", "clase 2","clase 3","clase4"),125))
strata.sample(data=data, n=c(10,20,30,40))
</code></pre>

<hr>
<h2 id='strata.samplesize'>Sample size estimation on stratified sampling</h2><span id='topic+strata.samplesize'></span>

<h3>Description</h3>

<p>Calculates the required sample size in order to achieve an
absolute or relative sampling error  less or equal to the specified for an specific
estimator and an optional confidence interval in stratified sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strata.samplesize(
  Nh,
  var,
  error,
  alpha,
  estimator = c("total", "mean", "proportion", "class total"),
  alloc = c("prop", "min", "optim"),
  ch,
  p,
  mean,
  replace = FALSE,
  relative = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strata.samplesize_+3A_nh">Nh</code></td>
<td>
<p>Vector of population strata sizes.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_var">var</code></td>
<td>
<p>Vector of estimated strata variances.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_error">error</code></td>
<td>
<p>Sampling error.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_alpha">alpha</code></td>
<td>
<p>Significance level to obtain confidence intervals.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_estimator">estimator</code></td>
<td>
<p>The estimator to be estimated. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_alloc">alloc</code></td>
<td>
<p>The allocation to be used when taking samples. Default is &quot;prop&quot;.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_ch">ch</code></td>
<td>
<p>Vector of cost per strata to select an individual for the sample.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_p">p</code></td>
<td>
<p>Estimated population proportion. If estimator is not &quot;proportion&quot; or &quot;class total&quot; it will be ignored.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_mean">mean</code></td>
<td>
<p>Estimated population mean. If relative=FALSE it will be ignored.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_replace">replace</code></td>
<td>
<p>Whether the samples to be taken can have repeated instances or not.</p>
</td></tr>
<tr><td><code id="strata.samplesize_+3A_relative">relative</code></td>
<td>
<p>Whether the specified error is relative or not.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With &quot;proportion&quot; and &quot;class total&quot; estimators variance vector must
contain <code><a href="stats.html#topic+var">var</a></code> return values equal to <code class="reqn">\frac{Nh}{(Nh-1)}p*(1-p)</code> values.
</p>


<h3>Value</h3>

<p>Number of instances of the sample to be taken.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strata.samplesize(c(120,100,110,50), c(458, 313,407,364), error=5, alpha=0.05, "mean", "prop")

</code></pre>

<hr>
<h2 id='strata.samplesize.cost'>Strata sample size by costs function</h2><span id='topic+strata.samplesize.cost'></span>

<h3>Description</h3>

<p>This function returns the total sample size given a costs function
consisting on the fixed total study cost, overhead study cost and a vector of costs by strata.
can be given so the allocation is calculated to not exceed the total study cost.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strata.samplesize.cost(
  Nh,
  var,
  C,
  cini,
  ch,
  alloc = c("unif", "prop", "optim")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strata.samplesize.cost_+3A_nh">Nh</code></td>
<td>
<p>Vector of population strata sizes.</p>
</td></tr>
<tr><td><code id="strata.samplesize.cost_+3A_var">var</code></td>
<td>
<p>Vector of strata variance values.</p>
</td></tr>
<tr><td><code id="strata.samplesize.cost_+3A_c">C</code></td>
<td>
<p>Total study cost.</p>
</td></tr>
<tr><td><code id="strata.samplesize.cost_+3A_cini">cini</code></td>
<td>
<p>Overhead study cost.</p>
</td></tr>
<tr><td><code id="strata.samplesize.cost_+3A_ch">ch</code></td>
<td>
<p>Vector of costs to take an individual from a strata for the sample.</p>
</td></tr>
<tr><td><code id="strata.samplesize.cost_+3A_alloc">alloc</code></td>
<td>
<p>The allocation method to be used. Default is &quot;unif&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Strata variance values are only necessary for optim allocation.
</p>


<h3>Value</h3>

<p>Sample size.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>strata.samplesize.cost(Nh=c(100,500,200), C=1000, cini=70, ch=c(9,5,12), alloc="prop")
</code></pre>

<hr>
<h2 id='syst.all.samples'>Systematic samples</h2><span id='topic+syst.all.samples'></span>

<h3>Description</h3>

<p>Returns all possible systematic samples of size n
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.all.samples(data, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.all.samples_+3A_data">data</code></td>
<td>
<p>Population data</p>
</td></tr>
<tr><td><code id="syst.all.samples_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with a sample per entrance
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-c(1,3,5,2,4,6,2,7,3)
syst.all.samples(data, 3)
</code></pre>

<hr>
<h2 id='syst.anova'>Analysis of variance of population data</h2><span id='topic+syst.anova'></span>

<h3>Description</h3>

<p>Analysis of variance of population data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.anova(data, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.anova_+3A_data">data</code></td>
<td>
<p>Population data</p>
</td></tr>
<tr><td><code id="syst.anova_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-c(1,3,5,2,4,6,2,7,3)
syst.anova(data,3)
</code></pre>

<hr>
<h2 id='syst.estimator'>Parameter estimation on a systematic sample</h2><span id='topic+syst.estimator'></span>

<h3>Description</h3>

<p>Parameter estimation on a systematic sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.estimator(
  N,
  sample,
  estimator = c("total", "mean", "proportion", "class total"),
  method = c("srs", "strata", "syst"),
  alpha,
  data,
  t
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.estimator_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_sample">sample</code></td>
<td>
<p>Vector containing the systematic sample</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_estimator">estimator</code></td>
<td>
<p>Estimator to compute. Can be one of &quot;total&quot;, &quot;mean&quot;, &quot;proportion&quot;, &quot;class total&quot;. Default is &quot;total&quot;.</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_method">method</code></td>
<td>
<p>Method of variance estimation. Can be one of &quot;srs&quot;, &quot;strata&quot;, &quot;syst&quot;.</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_alpha">alpha</code></td>
<td>
<p>Optional value to calculate estimation error and build 1-alpha confidence interval.</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_data">data</code></td>
<td>
<p>Population data.</p>
</td></tr>
<tr><td><code id="syst.estimator_+3A_t">t</code></td>
<td>
<p>Number of systematic samples to take with interpenetrating samples method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Variance estimation has no direct formula in systematic sampling, thus estimation method must be done. Refer to <code><a href="#topic+syst.intracorr">syst.intracorr</a></code>
and <code><a href="#topic+syst.intercorr">syst.intercorr</a></code> functions details for more information. <br />
&quot;syst&quot; method uses interpenetrating samples method in which t systematic samples of size=<code class="reqn">\frac{n}{t}</code> are taken to estimate. <code class="reqn">\frac{n}{t}</code> must be even.<br />
By choosing the start at random for all the samples they can be considered random taken. With this method population data and t must be given.
</p>


<h3>Value</h3>

<p>A list containing different interest values:
</p>

<ul>
<li><p> estimator
</p>
</li>
<li><p> variance
</p>
</li>
<li><p> sampling.error
</p>
</li>
<li><p> estimation.error
</p>
</li>
<li><p> confint
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-c(1,3,5,2,4,6,2,7,3)
sample&lt;-syst.sample(9, 3, data)
syst.estimator(N=9, sample, "mean", "srs", 0.05)
</code></pre>

<hr>
<h2 id='syst.intercorr'>Stratified correlation coefficient</h2><span id='topic+syst.intercorr'></span>

<h3>Description</h3>

<p>Stratified correlation coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.intercorr(N, n, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.intercorr_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="syst.intercorr_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="syst.intercorr_+3A_data">data</code></td>
<td>
<p>Population data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This value serves as a comparison between systematic and stratified sampling precision.<br />
At value=1 the systematic precision is minimum. At value=0 both sampling methods precision
are equal. At value= <code class="reqn">\frac{-1}{n-1}</code> systematic precision is maximum.<br />
Summarising at values between 1 and 0 stratified sampling estimation has more precision
than systematic, so method=&quot;strata&quot; should be set at <code><a href="#topic+syst.estimator">syst.estimator</a></code>.
The other way method=&quot;syst&quot; of interpenetrating samples method is better.
</p>


<h3>Value</h3>

<p>Correlation coefficient
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-c(1,3,5,2,4,6,2,7,3)
syst.intercorr(9,3,data)  #0.09022556
</code></pre>

<hr>
<h2 id='syst.intracorr'>Intraclass correlation coefficient</h2><span id='topic+syst.intracorr'></span>

<h3>Description</h3>

<p>Intraclass correlation coefficient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.intracorr(N, n, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.intracorr_+3A_n">N</code></td>
<td>
<p>Population size</p>
</td></tr>
<tr><td><code id="syst.intracorr_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="syst.intracorr_+3A_data">data</code></td>
<td>
<p>Population data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This value serves as a comparison between systematic and simple random sampling precision.<br />
At value=1 the systematic precision is minimum. At value=0 both sampling methods precision
are equal. At value= <code class="reqn">\frac{-1}{n-1}</code> systematic precision is maximum.<br />
Summarising at values between 1 and 0 simple random sampling estimation has more precision
than systematic, so method=&quot;srs&quot; should be set at <code><a href="#topic+syst.estimator">syst.estimator</a></code>.
The other way method=&quot;syst&quot; of interpenetrating samples method is better.
</p>


<h3>Value</h3>

<p>Intraclass correlation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-c(1,3,5,2,4,6,2,7,3)
syst.intracorr(9, 3, data)  #0.34375 example 1
</code></pre>

<hr>
<h2 id='syst.sample'>Systematic sampling sample</h2><span id='topic+syst.sample'></span>

<h3>Description</h3>

<p>Retrieves a <code class="reqn">\frac{N}{n}</code> systematic sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syst.sample(N, n, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="syst.sample_+3A_n">N</code></td>
<td>
<p>Population size.</p>
</td></tr>
<tr><td><code id="syst.sample_+3A_n">n</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="syst.sample_+3A_data">data</code></td>
<td>
<p>Optional data of the population.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code class="reqn">\frac{N}{n}</code> is not an even number a 1 in floor(<code class="reqn">\frac{N}{n}</code>) sample will be taken.
</p>


<h3>Value</h3>

<p>Vector of size n with numbers from 1 to N indicating the index samples to be taken.
If data is provided then the instances will be returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data&lt;-runif(40)
syst.sample(40,8, data)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
