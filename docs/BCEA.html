<!DOCTYPE html><html lang="en"><head><title>Help for package BCEA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BCEA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BCEA-package'><p>BCEA: Bayesian Cost Effectiveness Analysis</p></a></li>
<li><a href='#add_contour_quadrants'><p>Add Contour Quadrants</p></a></li>
<li><a href='#add_contours'><p>Add Contours to Base R Plot</p></a></li>
<li><a href='#bcea'><p>Create Bayesian Cost-Effectiveness Analysis Object</p></a></li>
<li><a href='#BCEA-deprecated'><p>Deprecated functions in package <span class="pkg">BCEA</span>.</p></a></li>
<li><a href='#best_interv_given_k'><p>Optimal intervention</p></a></li>
<li><a href='#ce_table'><p>Cost-effectiveness summary statistics table</p></a></li>
<li><a href='#ceac_matplot'><p>CEAC Matrix Plot</p></a></li>
<li><a href='#ceac_plot_graph'><p>Cost-Effectiveness Acceptability Curve (CEAC) Plot By Graph Device</p></a></li>
<li><a href='#ceac.plot.bcea'><p>Cost-Effectiveness Acceptability Curve (CEAC) Plot</p></a></li>
<li><a href='#ceaf.plot.pairwise'><p>Cost-Effectiveness Acceptability Frontier (CEAF) plot</p></a></li>
<li><a href='#ceef_plot_graph'><p>Cost-effectiveness Efficiency Frontier Plot By Graph Device</p></a></li>
<li><a href='#ceef.plot.bcea'><p>Cost-Effectiveness Efficiency Frontier (CEEF) Plot</p></a></li>
<li><a href='#ceef.summary'><p>Summary table for CEEF</p></a></li>
<li><a href='#ceplane_geom_params'><p>Extract Separate Parameter Sets</p></a></li>
<li><a href='#ceplane_ggplot_params'><p>CE-plane ggplot Parameters</p></a></li>
<li><a href='#ceplane_plot_graph'><p>Cost-Effectiveness Plane Plot By Graph Device</p></a></li>
<li><a href='#ceplane.plot.bcea'><p>Cost-effectiveness Plane Plot</p></a></li>
<li><a href='#CEriskav_assign'><p>Cost-effectiveness Analysis Including a Parameter of Risk Aversion</p></a></li>
<li><a href='#CEriskav_plot_graph'><p>Cost-effectiveness Plot Including a Parameter of Risk Aversion</p></a></li>
<li><a href='#comp_names_from_'><p>Comparison Names From</p></a></li>
<li><a href='#compute_CEAC'><p>Compute Cost-Effectiveness Acceptability Curve</p></a></li>
<li><a href='#compute_ceaf'><p>Compute Cost-Effectiveness Acceptability Frontier</p></a></li>
<li><a href='#compute_EIB'><p>Compute Expected Incremental Benefit</p></a></li>
<li><a href='#compute_eib_cri'><p>Calculate Credible Intervals</p></a></li>
<li><a href='#compute_EVI'><p>Compute Expected Value of Information</p></a></li>
<li><a href='#compute_IB'><p>Compute Incremental Benefit</p></a></li>
<li><a href='#compute_ICER'><p>Compute Incremental Cost-Effectiveness Ratio</p></a></li>
<li><a href='#compute_kstar'><p>Compute k^*</p></a></li>
<li><a href='#compute_ol'><p>Compute Opportunity Loss</p></a></li>
<li><a href='#compute_p_best_interv'><p>Compute Probability Best Intervention</p></a></li>
<li><a href='#compute_U'><p>Compute U Statistic</p></a></li>
<li><a href='#compute_Ubar'><p>Compute NB for mixture of interventions</p></a></li>
<li><a href='#compute_Ustar'><p>Compute Ustar Statistic</p></a></li>
<li><a href='#compute_vi'><p>Compute Value of Information</p></a></li>
<li><a href='#contour_ggplot_params'><p>Contour ggplot Parameters</p></a></li>
<li><a href='#contour_graph'><p>Contour Cost-Effectiveness Plane</p></a></li>
<li><a href='#contour.bcea'><p>Contour Plots for the Cost-Effectiveness Plane</p></a></li>
<li><a href='#contour2.bcea'><p>Specialised CE-plane Contour Plot</p></a></li>
<li><a href='#convert_pts_to_mm'><p>Use from Base  R to ggplot</p></a></li>
<li><a href='#createInputs.default'><p>Create Inputs for EVPI Calculation</p></a></li>
<li><a href='#diag.evppi'><p>Diagnostic Plots For The Results Of The EVPPI</p></a></li>
<li><a href='#eib_params_base'><p>EIB parameters specific to base R plot</p></a></li>
<li><a href='#eib_params_cri'><p>EIB Parameters CrI</p></a></li>
<li><a href='#eib_plot_graph'><p>Expected Incremental Benefit Plot By Graph Device</p></a></li>
<li><a href='#eib.plot.bcea'><p>Expected Incremental Benefit (EIB) Plot</p></a></li>
<li><a href='#evi_plot_graph'><p>Expected Value of Information Plot By Graph Device</p></a></li>
<li><a href='#evi.plot.bcea'><p>Expected Value of Information (EVI) Plot</p></a></li>
<li><a href='#evi.plot.mixedAn'><p>EVI Plot of the Health Economic Analysis For Mixed Analysis</p></a></li>
<li><a href='#evppi'><p>Expected Value of Perfect Partial Information (EVPPI) for Selected</p>
Parameters</a></li>
<li><a href='#evppi_plot_graph'><p>Plot Expected Value of Partial Information With Respect to a</p>
Set of Parameters</a></li>
<li><a href='#evppi_qq_plot'><p>Q-Q Plot</p></a></li>
<li><a href='#evppi_residual_plot'><p>Residual Plot</p></a></li>
<li><a href='#geom_cri'><p>Credible interval ggplot geom</p></a></li>
<li><a href='#geom_quad_txt'><p>Geom Quadrant Text</p></a></li>
<li><a href='#get_fitted_'><p>Get fitted values from evppi object</p></a></li>
<li><a href='#GrassmannOptim'><p>GrassmannOptim</p></a></li>
<li><a href='#ib_plot_base'><p>IB plot base R version</p></a></li>
<li><a href='#ib.plot.bcea'><p>Incremental Benefit (IB) Distribution Plot</p></a></li>
<li><a href='#info_rank_graph'><p>Info Rank Plot By Graph Device</p></a></li>
<li><a href='#info.rank.bcea'><p>Information-Rank Plot for bcea Class</p></a></li>
<li><a href='#inforank_params'><p>Prepare Info Rank plot parameters</p></a></li>
<li><a href='#is.bcea'><p>Check bcea Class</p></a></li>
<li><a href='#is.rel'><p>Reports whether x is a rel object</p>
Copied from ggplot2</a></li>
<li><a href='#kstar_vlines'><p>Prepare K-star vertical lines</p></a></li>
<li><a href='#line_labels'><p>Create Labels for Plot</p></a></li>
<li><a href='#loo_rank'><p>Leave-one-out ranking</p></a></li>
<li><a href='#make_legend_plotly'><p>Legend Positioning</p></a></li>
<li><a href='#make.report'><p>Make Report</p></a></li>
<li><a href='#mce.plot'><p>Plots the probability that each intervention is the most cost-effective</p></a></li>
<li><a href='#mixedAn+26lt+3B-'><p>Cost-Effectiveness Analysis When Multiple (Possibly Non-Cost-Effective)</p>
Interventions are Present on the Market</a></li>
<li><a href='#multi.ce'><p>Cost-effectiveness Analysis With Multiple Comparison</p></a></li>
<li><a href='#multiplot'><p>Plot Multiple bcea Graphs</p></a></li>
<li><a href='#new_bcea'><p>Constructor for bcea</p></a></li>
<li><a href='#num_lines'><p>Get number of lines</p></a></li>
<li><a href='#openPDF'><p>Automatically open pdf output using default pdf viewer</p></a></li>
<li><a href='#plot_eib_cri'><p>Plot Credible Intervals</p></a></li>
<li><a href='#plot.bcea'><p>Summary Plot of the Health Economic Analysis</p></a></li>
<li><a href='#plot.CEriskav'><p>Plots EIB and EVPI for the Risk Aversion Case</p></a></li>
<li><a href='#plot.evppi'><p>Plot Expected Value of Partial Information With Respect to a</p>
Set of Parameters</a></li>
<li><a href='#prep_ceplane_params'><p>Prepare CE-plane Parameters</p></a></li>
<li><a href='#prep_contour_params'><p>Prepare contour plot parameters</p>
Additional to ceplane parameters</a></li>
<li><a href='#prep_eib_params'><p>Prepare EIB plot parameters</p></a></li>
<li><a href='#prep_frontier_data'><p>Prepare frontier data</p></a></li>
<li><a href='#print.bcea'><p>bcea Print Method</p></a></li>
<li><a href='#quadrant_params'><p>Quadrant Parameters</p>
requires just a single comparison group</a></li>
<li><a href='#quiet'><p>Allow disabling of the cat messages</p></a></li>
<li><a href='#select_plot_type'><p>Choose Graphical Engine</p></a></li>
<li><a href='#setComparisons'><p>Set Comparisons Group</p></a></li>
<li><a href='#setComparisons_assign'><p>Set Comparison Group</p></a></li>
<li><a href='#setKmax_assign'><p>Set Maximum Willingness to Pay</p></a></li>
<li><a href='#setReferenceGroup_assign'><p>Set Reference Group</p></a></li>
<li><a href='#sim_table'><p>Table of Simulation Statistics for the Health Economic Model</p></a></li>
<li><a href='#Smoking'><p>Data set for the Bayesian model for the cost-effectiveness of smoking</p>
cessation interventions</a></li>
<li><a href='#struct.psa'><p>Structural Probability Sensitivity Analysis</p></a></li>
<li><a href='#summary.bcea'><p>Summary Method for Objects of Class <code>bcea</code></p></a></li>
<li><a href='#summary.mixedAn'><p>Summary Methods For Objects in the Class <code>mixedAn</code> (Mixed Analysis)</p></a></li>
<li><a href='#summary.pairwise'><p>Summary Method for Objects of Class <code>pairwise</code></p></a></li>
<li><a href='#tabulate_means'><p>Calculate Dataset For ICERs From bcea Object</p></a></li>
<li><a href='#theme_bcea'><p>bcea theme ggplot2</p></a></li>
<li><a href='#Vaccine'><p>Data set for the Bayesian model for the cost-effectiveness of influenza</p>
vaccination</a></li>
<li><a href='#validate_bcea'><p>Validate bcea</p></a></li>
<li><a href='#validate_eib_params'><p>Validate EIB parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Cost Effectiveness Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.4.7</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli (&ge; 3.3.0), dplyr, ggplot2 (&ge; 3.5.0), graphics,
gridExtra, MASS, Matrix, MCMCvis, purrr, Rdpack, reshape2,
rlang, rstan, scales, voi (&ge; 1.0.1)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>coda, grid, knitr, markdown, mgcv, plotly, plotrix,
RColorBrewer, rjags, rmarkdown, splancs, testthat (&ge; 2.1.0),
vdiffr, withr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Produces an economic evaluation of a sample of suitable variables of
             cost and effectiveness / utility for two or more interventions,
             e.g. from a Bayesian model in the form of MCMC simulations.
             This package computes the most cost-effective alternative and
             produces graphical summaries and probabilistic sensitivity analysis,
             see Baio et al (2017) &lt;<a href="https://doi.org/10.1007%2F978-3-319-55718-2">doi:10.1007/978-3-319-55718-2</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://gianluca.statistica.it/software/bcea/">https://gianluca.statistica.it/software/bcea/</a>,
<a href="https://gianluca.statistica.it/">https://gianluca.statistica.it/</a>,
<a href="https://github.com/giabaio/BCEA/">https://github.com/giabaio/BCEA/</a>,
<a href="https://n8thangreen.github.io/BCEA/">https://n8thangreen.github.io/BCEA/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/n8thangreen/BCEA/issues/">https://github.com/n8thangreen/BCEA/issues/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-14 11:10:58 UTC; Nathan</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianluca Baio <a href="https://orcid.org/0000-0003-4314-2570"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Andrea Berardi <a href="https://orcid.org/0000-0002-2906-496X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Anna Heath <a href="https://orcid.org/0000-0002-7263-4251"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Nathan Green <a href="https://orcid.org/0000-0003-2745-1736"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianluca Baio &lt;g.baio@ucl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-14 12:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='BCEA-package'>BCEA: Bayesian Cost Effectiveness Analysis</h2><span id='topic+BCEA'></span><span id='topic+BCEA-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Produces an economic evaluation of a sample of suitable variables of cost and effectiveness / utility for two or more interventions, e.g. from a Bayesian model in the form of MCMC simulations. This package computes the most cost-effective alternative and produces graphical summaries and probabilistic sensitivity analysis, see Baio et al (2017) <a href="https://doi.org/10.1007/978-3-319-55718-2">doi:10.1007/978-3-319-55718-2</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gianluca Baio <a href="mailto:g.baio@ucl.ac.uk">g.baio@ucl.ac.uk</a> (<a href="https://orcid.org/0000-0003-4314-2570">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Andrea Berardi <a href="mailto:a.berardi@ucl.ac.uk">a.berardi@ucl.ac.uk</a> (<a href="https://orcid.org/0000-0002-2906-496X">ORCID</a>)
</p>
</li>
<li><p> Anna Heath <a href="mailto:anna.heath@sickkids.ca">anna.heath@sickkids.ca</a> (<a href="https://orcid.org/0000-0002-7263-4251">ORCID</a>)
</p>
</li>
<li><p> Nathan Green <a href="mailto:n.green@ucl.ac.uk">n.green@ucl.ac.uk</a> (<a href="https://orcid.org/0000-0003-2745-1736">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://gianluca.statistica.it/software/bcea/">https://gianluca.statistica.it/software/bcea/</a>
</p>
</li>
<li> <p><a href="https://gianluca.statistica.it/">https://gianluca.statistica.it/</a>
</p>
</li>
<li> <p><a href="https://github.com/giabaio/BCEA/">https://github.com/giabaio/BCEA/</a>
</p>
</li>
<li> <p><a href="https://n8thangreen.github.io/BCEA/">https://n8thangreen.github.io/BCEA/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/n8thangreen/BCEA/issues/">https://github.com/n8thangreen/BCEA/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='add_contour_quadrants'>Add Contour Quadrants</h2><span id='topic+add_contour_quadrants'></span>

<h3>Description</h3>

<p>Add Contour Quadrants
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_contour_quadrants(he, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_contour_quadrants_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="add_contour_quadrants_+3A_params">params</code></td>
<td>
<p>List</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot side effect
</p>

<hr>
<h2 id='add_contours'>Add Contours to Base R Plot</h2><span id='topic+add_contours'></span>

<h3>Description</h3>

<p>Add Contours to Base R Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_contours(he, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_contours_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="add_contours_+3A_params">params</code></td>
<td>
<p>List</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot side effect
</p>

<hr>
<h2 id='bcea'>Create Bayesian Cost-Effectiveness Analysis Object</h2><span id='topic+bcea'></span><span id='topic+bcea.default'></span><span id='topic+bcea.rjags'></span><span id='topic+bcea.rstan'></span><span id='topic+bcea.bugs'></span>

<h3>Description</h3>

<p>Cost-effectiveness analysis based on the results of a simulation model for a
variable of clinical benefits (e) and of costs (c). Produces results to be
post-processed to give the health economic analysis. The output is stored in
an object of the class &quot;bcea&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcea(
  eff,
  cost,
  ref = 1,
  interventions = NULL,
  .comparison = NULL,
  Kmax = 50000,
  k = NULL,
  plot = FALSE,
  ...
)

## Default S3 method:
bcea(
  eff,
  cost,
  ref = NULL,
  interventions = NULL,
  .comparison = NULL,
  Kmax = 50000,
  k = NULL,
  plot = FALSE,
  ...
)

## S3 method for class 'rjags'
bcea(eff, ...)

## S3 method for class 'rstan'
bcea(eff, ...)

## S3 method for class 'bugs'
bcea(eff, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bcea_+3A_eff">eff</code></td>
<td>
<p>An object containing <code>nsim</code> simulations for the variable of
clinical effectiveness for each intervention being considered. In general it
is a matrix with <code>nsim</code> rows and <code>nint</code> columns.
This are partially matched with <code style="white-space: pre;">&#8288;e' from previous version of &#8288;</code>BCEA' for back-compatibility.</p>
</td></tr>
<tr><td><code id="bcea_+3A_cost">cost</code></td>
<td>
<p>An object containing <code>nsim</code> simulations for the variable of
cost for each intervention being considered. In general it is a matrix with
<code>nsim</code> rows and <code>nint</code> columns.
This are partially matched with <code style="white-space: pre;">&#8288;c' from previous version of &#8288;</code>BCEA' for back-compatibility.</p>
</td></tr>
<tr><td><code id="bcea_+3A_ref">ref</code></td>
<td>
<p>Defines which intervention (columns of <code>eff</code> or <code>cost</code>) is
considered to be the reference strategy. The default value <code>ref = 1</code>
means that the intervention associated with the first column of <code>eff</code> or
<code>cost</code> is the reference and the one(s) associated with the other column(s)
is(are) the comparators.</p>
</td></tr>
<tr><td><code id="bcea_+3A_interventions">interventions</code></td>
<td>
<p>Defines the labels to be associated with each
intervention. By default and if <code>NULL</code>, assigns labels in the form
&quot;Intervention1&quot;, ... , &quot;InterventionT&quot;.</p>
</td></tr>
<tr><td><code id="bcea_+3A_.comparison">.comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison = 2</code>).</p>
</td></tr>
<tr><td><code id="bcea_+3A_kmax">Kmax</code></td>
<td>
<p>Maximum value of the willingness to pay to be considered.
Default value is <code>k = 50000</code>. The willingness to pay is then approximated
on a discrete grid in the interval <code style="white-space: pre;">&#8288;[0, Kmax]&#8288;</code>. The grid is equal to
<code>k</code> if the parameter is given, or composed of <code>501</code> elements if
<code>k = NULL</code> (the default).</p>
</td></tr>
<tr><td><code id="bcea_+3A_k">k</code></td>
<td>
<p>A(n optional) vector for the values of the willingness
to pay grid. Should be of length &gt; 1 otherwise plots will be empty.
If not specified then BCEA will construct a grid of 501 values
from 0 to <code>Kmax</code>. This option is useful when performing intensive
computations (e.g. for the EVPPI). This was changed from <code>wtp</code> in previous versions
for consistency with other functions and so will be deprecated in the future.</p>
</td></tr>
<tr><td><code id="bcea_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether the function should produce
the summary plot or not.</p>
</td></tr>
<tr><td><code id="bcea_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class <code>bcea</code> containing the following elements:
</p>

<ul>
<li> <p><strong>n_sim</strong>: Number of simulations produced by the Bayesian model.
</p>
</li>
<li> <p><strong>n_comparators</strong>: Number of interventions being analyzed.
</p>
</li>
<li> <p><strong>n_comparisons</strong>: Number of possible pairwise comparisons.
</p>
</li>
<li> <p><strong>delta.e</strong>: For each possible comparison, the differential in the effectiveness measure.
</p>
</li>
<li> <p><strong>delta.c</strong>: For each possible comparison, the differential in the cost measure.
</p>
</li>
<li> <p><strong>ICER</strong>: The value of the Incremental Cost-Effectiveness Ratio.
</p>
</li>
<li> <p><strong>Kmax</strong>: The maximum value assumed for the willingness to pay threshold.
</p>
</li>
<li> <p><strong>k</strong>: The vector of values for the grid approximation of the willingness to pay.
</p>
</li>
<li> <p><strong>ceac</strong>: The value for the Cost-Effectiveness Acceptability Curve, as a function of the willingness to pay.
</p>
</li>
<li> <p><strong>ib</strong>: The distribution of the Incremental Benefit, for a given willingness to pay.
</p>
</li>
<li> <p><strong>eib</strong>: The value for the Expected Incremental Benefit, as a function of the willingness to pay.
</p>
</li>
<li> <p><strong>kstar</strong>: The grid approximation of the break-even point(s).
</p>
</li>
<li> <p><strong>best</strong>: A vector containing the numeric label of the intervention that is the most cost-effective for each value of the willingness to pay in the selected grid approximation.
</p>
</li>
<li> <p><strong>U</strong>: An array including the value of the expected utility for each simulation from the Bayesian model, for each value of the grid approximation of the willingness to pay, and for each intervention being considered.
</p>
</li>
<li> <p><strong>vi</strong>: An array including the value of information for each simulation from the Bayesian model and for each value of the grid approximation of the willingness to pay.
</p>
</li>
<li> <p><strong>Ustar</strong>: An array including the maximum &quot;known-distribution&quot; utility for each simulation from the Bayesian model and for each value of the grid approximation of the willingness to pay.
</p>
</li>
<li> <p><strong>ol</strong>: An array including the opportunity loss for each simulation from the Bayesian model and for each value of the grid approximation of the willingness to pay.
</p>
</li>
<li> <p><strong>evi</strong>: The vector of values for the Expected Value of Information, as a function of the willingness to pay.
</p>
</li>
<li> <p><strong>interventions</strong>: A vector of labels for all the interventions considered.
</p>
</li>
<li> <p><strong>ref</strong>: The numeric index associated with the intervention used as reference in the analysis.
</p>
</li>
<li> <p><strong>comp</strong>: The numeric index(es) associated with the intervention(s) used as comparator(s) in the analysis.
</p>
</li>
<li> <p><strong>step</strong>: The step size used to form the grid approximation to the willingness to pay.
</p>
</li>
<li> <p><strong>e</strong>: The <code>eff</code> matrix used to generate the object (see Arguments).
</p>
</li>
<li> <p><strong>c</strong>: The <code>cost</code> matrix used to generate the object (see Arguments).
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi, Nathan Green
</p>


<h3>References</h3>

<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>
<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio (2013), Baio (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(
      e=eff,
      c=cost,               # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
      plot=TRUE             # plots the results
)

# Creates a summary table
summary(
      m,         # uses the results of the economic evaluation 
                 #  (a "bcea" object)
      wtp=25000	# selects the particular value for k 
)



# Plots the cost-effectiveness plane using base graphics
ceplane.plot(
      m,             # plots the Cost-Effectiveness plane
      comparison=1,  # if more than 2 interventions, selects the
                     #  pairwise comparison 
      wtp=25000,     # selects the relevant willingness to pay 
                     #  (default: 25,000) 
      graph="base"   # selects base graphics (default)
)

# Plots the cost-effectiveness plane using ggplot2
if (requireNamespace("ggplot2")) {
ceplane.plot(
      m,             # plots the Cost-Effectiveness plane
      comparison=1,  # if more than 2 interventions, selects the
                     #  pairwise comparison 
      wtp=25000,     # selects the relevant willingness to pay 
                     #  (default: 25,000) 
      graph="ggplot2"# selects ggplot2 as the graphical engine
)

# Some more options
ceplane.plot(
      m,
      graph="ggplot2",
      pos="top",
      size=5,
      ICER_size=1.5,
      label.pos=FALSE,
      opt.theme=ggplot2::theme(text=ggplot2::element_text(size=8))
)
}

# Plots the contour and scatterplot of the bivariate 
# distribution of (Delta_e,Delta_c)
contour(
      m,            # uses the results of the economic evaluation 
                    #  (a "bcea" object)
      comparison=1, # if more than 2 interventions, selects the 
                    #  pairwise comparison 
      nlevels=4,    # selects the number of levels to be 
                    #  plotted (default=4)
      levels=NULL,  # specifies the actual levels to be plotted 
                    #  (default=NULL, so that R will decide)
      scale=0.5,    # scales the bandwidths for both x- and 
                    #  y-axis (default=0.5)
      graph="base"  # uses base graphics to produce the plot
)

# Plots the contour and scatterplot of the bivariate 
#   distribution of (Delta_e,Delta_c)
contour2(
      m,          # uses the results of the economic evaluation 
                  #  (a "bcea" object)
      wtp=25000,  # selects the willingness-to-pay threshold
)

# Using ggplot2
if (requireNamespace("ggplot2")) {
contour2(
      m,              # uses the results of the economic evaluation 
                      #  (a "bcea" object)
      graph="ggplot2",# selects the graphical engine
      wtp=25000,      # selects the willingness-to-pay threshold
      label.pos=FALSE # alternative position for the wtp label
)
}

# Plots the Expected Incremental Benefit for the "bcea" object m
eib.plot(m)

# Plots the distribution of the Incremental Benefit
ib.plot(
    m,            # uses the results of the economic evaluation 
                  #  (a "bcea" object)
    comparison=1, # if more than 2 interventions, selects the 
                  #  pairwise comparison 
    wtp=25000,    # selects the relevant willingness 
                  #  to pay (default: 25,000)
    graph="base"  # uses base graphics
)

# Produces a plot of the CEAC against a grid of values for the 
# willingness to pay threshold
ceac.plot(m)

# Plots the Expected Value of Information for the "bcea" object m
evi.plot(m)


</code></pre>

<hr>
<h2 id='BCEA-deprecated'>Deprecated functions in package <span class="pkg">BCEA</span>.</h2><span id='topic+BCEA-deprecated'></span><span id='topic+plot.mixedAn'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot.mixedAn(x, y.limits=NULL, pos=c(0,1), graph=c("base","ggplot2"),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BCEA-deprecated_+3A_x">x</code></td>
<td>
<p>An object of class <code>mixedAn</code>, given as output of the call to
the function <code><a href="#topic+mixedAn">mixedAn()</a></code>.</p>
</td></tr>
<tr><td><code id="BCEA-deprecated_+3A_y.limits">y.limits</code></td>
<td>
<p>Range of the y-axis for the graph. The default value is
<code>NULL</code>, in which case the maximum range between the optimal and the
mixed analysis scenarios is considered.</p>
</td></tr>
<tr><td><code id="BCEA-deprecated_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend. Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot. Default value is <code>c(0,1)</code>, that is in the topleft
corner inside the plot area.</p>
</td></tr>
<tr><td><code id="BCEA-deprecated_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="BCEA-deprecated_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters
(see <code><a href="graphics.html#topic+par">par()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>evi</code></td>
<td>
<p> A ggplot object containing the plot. Returned only if
<code>graph="ggplot2"</code>. </p>
</td></tr></table>
<p> The function produces a graph showing the
difference between the &rdquo;optimal&rdquo; version of the EVPI (when only the most
cost-effective intervention is included in the market) and the mixed
strategy one (when more than one intervention is considered in the market).
</p>


<h3><code>plot.mixedAn</code></h3>

<p>For <code>plot.mixedAn</code>, use <code><a href="#topic+evi.plot">evi.plot()</a></code>.
</p>
<p>Summary plot of the health economic analysis when the mixed analysis is
considered
</p>
<p>Compares the optimal scenario to the mixed case in terms of the EVPI.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>

<hr>
<h2 id='best_interv_given_k'>Optimal intervention</h2><span id='topic+best_interv_given_k'></span>

<h3>Description</h3>

<p>Select the best option for each value of willingness to pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>best_interv_given_k(eib, ref, comp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="best_interv_given_k_+3A_eib">eib</code></td>
<td>
<p>Expected incremental benefit</p>
</td></tr>
<tr><td><code id="best_interv_given_k_+3A_ref">ref</code></td>
<td>
<p>Reference group number</p>
</td></tr>
<tr><td><code id="best_interv_given_k_+3A_comp">comp</code></td>
<td>
<p>Comparison group number(s)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Group index
</p>

<hr>
<h2 id='ce_table'>Cost-effectiveness summary statistics table</h2><span id='topic+ce_table'></span>

<h3>Description</h3>

<p>As is commonly shown in a journal paper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ce_table(he, wtp = 25000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ce_table_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ce_table_+3A_wtp">wtp</code></td>
<td>
<p>Willingness to pay</p>
</td></tr>
<tr><td><code id="ce_table_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(
      e=eff,
      c=cost,               # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
)
ce_table(m)
</code></pre>

<hr>
<h2 id='ceac_matplot'>CEAC Matrix Plot</h2><span id='topic+ceac_matplot'></span>

<h3>Description</h3>

<p>CEAC plot using <code>matplot</code> in Base R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceac_matplot(he, pos_legend, graph_params, ceac)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceac_matplot_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceac_matplot_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Legend position</p>
</td></tr>
<tr><td><code id="ceac_matplot_+3A_graph_params">graph_params</code></td>
<td>
<p>Aesthetic ggplot parameters</p>
</td></tr>
<tr><td><code id="ceac_matplot_+3A_ceac">ceac</code></td>
<td>
<p><code>ceac</code> index in <code>he</code></p>
</td></tr>
</table>

<hr>
<h2 id='ceac_plot_graph'>Cost-Effectiveness Acceptability Curve (CEAC) Plot By Graph Device</h2><span id='topic+ceac_plot_graph'></span><span id='topic+ceac_plot_base'></span><span id='topic+ceac_plot_base.pairwise'></span><span id='topic+ceac_plot_base.bcea'></span><span id='topic+ceac_plot_ggplot'></span><span id='topic+ceac_plot_ggplot.pairwise'></span><span id='topic+ceac_plot_ggplot.bcea'></span><span id='topic+ceac_ggplot'></span><span id='topic+ceac_plot_plotly'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span> or <span class="pkg">plotly</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceac_plot_base(he, pos_legend, graph_params, ...)

## S3 method for class 'pairwise'
ceac_plot_base(he, pos_legend, graph_params, ...)

## S3 method for class 'bcea'
ceac_plot_base(he, pos_legend, graph_params, ...)

ceac_plot_ggplot(he, pos_legend, graph_params, ...)

## S3 method for class 'pairwise'
ceac_plot_ggplot(he, pos_legend, graph_params, ...)

## S3 method for class 'bcea'
ceac_plot_ggplot(he, pos_legend, graph_params, ...)

ceac_ggplot(he, pos_legend, graph_params, ceac, ...)

ceac_plot_plotly(he, pos_legend = "left", graph_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceac_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceac_plot_graph_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Legend position</p>
</td></tr>
<tr><td><code id="ceac_plot_graph_+3A_graph_params">graph_params</code></td>
<td>
<p>Aesthetic ggplot parameters</p>
</td></tr>
<tr><td><code id="ceac_plot_graph_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="ceac_plot_graph_+3A_ceac">ceac</code></td>
<td>
<p>ceac index in <code>he</code></p>
</td></tr>
</table>

<hr>
<h2 id='ceac.plot.bcea'>Cost-Effectiveness Acceptability Curve (CEAC) Plot</h2><span id='topic+ceac.plot.bcea'></span><span id='topic+ceac.plot'></span>

<h3>Description</h3>

<p>Produces a plot of the Cost-Effectiveness Acceptability Curve (CEAC) against
the willingness to pay threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
ceac.plot(
  he,
  comparison = NULL,
  pos = c(1, 0),
  graph = c("base", "ggplot2", "plotly"),
  ...
)

ceac.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceac.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceac.plot.bcea_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison=2</code>).</p>
</td></tr>
<tr><td><code id="ceac.plot.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="ceac.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the three options <code>"base"</code>,
<code>"ggplot2"</code> or <code>"plotly"</code>. Default value is <code>"base"</code>.
Not all plotting functions have a <code>"plotly"</code> implementation yet.</p>
</td></tr>
<tr><td><code id="ceac.plot.bcea_+3A_...">...</code></td>
<td>
<p>If <code>graph = "ggplot2"</code> and a named theme object is supplied,
it will be passed to the ggplot2 object. The usual ggplot2 syntax is used.
Additional arguments:
</p>

<ul>
<li> <p><code>line = list(color)</code>: specifies the line colour(s) - all graph types.
</p>
</li>
<li> <p><code>line = list(type)</code>: specifies the line type(s) as <code>lty</code> numeric values - all graph types.
</p>
</li>
<li> <p><code>line = list(size)</code>: specifies the line width(s) as numeric values - all graph types.
</p>
</li>
<li> <p><code>currency</code>: Currency prefix to willingness to pay values - ggplot2 only.
</p>
</li>
<li> <p><code>area_include</code>: logical, include area under the CEAC curves - plotly only.
</p>
</li>
<li> <p><code>area_color</code>: specifies the AUC colour - plotly only.</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>The CEAC estimates the probability of cost-effectiveness, with respect to a
given willingness to pay threshold. The CEAC is used mainly to evaluate the
uncertainty associated with the decision-making process, since it enables the
quantification of the preference of the compared interventions, defined in terms
of difference in utilities.
Formally, the CEAC is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{CEAC} = P(\textrm{IB}(\theta) &gt; 0)</code>
</p>

<p>If the net benefit function is used as utility function, the definition can be
re-written as
</p>
<p style="text-align: center;"><code class="reqn">\textrm{CEAC} = P(k \cdot \Delta_e - \Delta_c &gt; 0)</code>
</p>

<p>effectively depending on the willingness to pay value <code class="reqn">k</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ceac</code></td>
<td>
<p>If <code>graph = "ggplot2"</code> a ggplot object, or if <code>graph = "plotly"</code>
a plotly object containing the requested plot. Nothing is returned when <code>graph = "base"</code>,
the default.</p>
</td></tr></table>
<p> The function produces a plot of the
cost-effectiveness acceptability curve against the discrete grid of possible
values for the willingness to pay parameter. Values of the CEAC closer to 1
indicate that uncertainty in the cost-effectiveness of the reference
intervention is very low. Similarly, values of the CEAC closer to 0 indicate
that uncertainty in the cost-effectiveness of the comparator is very low.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+plot.bcea">plot.bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Vaccine")
he &lt;- BCEA::bcea(eff, cost)
ceac.plot(he)

ceac.plot(he, graph = "base")
ceac.plot(he, graph = "ggplot2")
ceac.plot(he, graph = "plotly")

ceac.plot(he, graph = "ggplot2",
          title = "my title",
          line = list(color = "green"),
          theme = ggplot2::theme_dark())

## more interventions
he2 &lt;- BCEA::bcea(cbind(eff, eff - 0.0002), cbind(cost, cost + 5))
mypalette &lt;- RColorBrewer::brewer.pal(3, "Accent")
ceac.plot(he2, graph = "ggplot2",
          title = "my title",
          theme = ggplot2::theme_dark(),
          pos = TRUE,
          line = list(color = mypalette))
ceac.plot(he, graph = "base", title = "my title", line = list(color = "green"))
ceac.plot(he2, graph = "base")

ceac.plot(he2, graph = "plotly", pos = "bottom")

</code></pre>

<hr>
<h2 id='ceaf.plot.pairwise'>Cost-Effectiveness Acceptability Frontier (CEAF) plot</h2><span id='topic+ceaf.plot.pairwise'></span><span id='topic+ceaf.plot'></span>

<h3>Description</h3>

<p>Produces a plot the Cost-Effectiveness Acceptability Frontier (CEAF)
against the willingness to pay threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pairwise'
ceaf.plot(mce, graph = c("base", "ggplot2"), ...)

ceaf.plot(mce, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceaf.plot.pairwise_+3A_mce">mce</code></td>
<td>
<p>The output of the call to the function <code><a href="#topic+multi.ce">multi.ce()</a></code></p>
</td></tr>
<tr><td><code id="ceaf.plot.pairwise_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-) match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="ceaf.plot.pairwise_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ceaf</code></td>
<td>
<p>A ggplot object containing the plot. Returned only if
<code>graph="ggplot2"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+multi.ce">multi.ce()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(
      e=eff,
      c=cost,               # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
      plot=FALSE            # inhibits graphical output
)


mce &lt;- multi.ce(m)          # uses the results of the economic analysis 



ceaf.plot(mce)              # plots the CEAF 



ceaf.plot(mce, graph = "g") # uses ggplot2 



# Use the smoking cessation dataset
data(Smoking)
m &lt;- bcea(eff, cost, ref = 4, intervention = treats, Kmax = 500, plot = FALSE)
mce &lt;- multi.ce(m)
ceaf.plot(mce)

 
</code></pre>

<hr>
<h2 id='ceef_plot_graph'>Cost-effectiveness Efficiency Frontier Plot By Graph Device</h2><span id='topic+ceef_plot_graph'></span><span id='topic+ceef_plot_ggplot'></span><span id='topic+ceef_plot_base'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceef_plot_ggplot(he, frontier_data, frontier_params, ...)

ceef_plot_base(he, frontier_data, frontier_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceef_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceef_plot_graph_+3A_frontier_data">frontier_data</code></td>
<td>
<p>Frontier data</p>
</td></tr>
<tr><td><code id="ceef_plot_graph_+3A_frontier_params">frontier_params</code></td>
<td>
<p>Frontier parameters</p>
</td></tr>
<tr><td><code id="ceef_plot_graph_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='ceef.plot.bcea'>Cost-Effectiveness Efficiency Frontier (CEEF) Plot</h2><span id='topic+ceef.plot.bcea'></span><span id='topic+ceef.plot'></span>

<h3>Description</h3>

<p>The line connecting successive points on a cost-effectiveness plane which each
represent the effect and cost associated with different treatment alternatives.
The gradient of a line segment represents the ICER of the treatment comparison
between the two alternatives represented by that segment.
The cost-effectiveness frontier consists of the set of points corresponding to
treatment alternatives that are considered to be cost-effective at different values
of the cost-effectiveness threshold. The steeper the gradient between successive
points on the frontier, the higher is the ICER between these treatment alternatives
and the more expensive alternative would be considered cost-effective only when a
high value of the cost-effectiveness threshold is assumed.
Points not lying on the cost-effectiveness frontier represent treatment alternatives
that are not considered cost-effective at any value of the cost-effectiveness threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
ceef.plot(
  he,
  comparators = NULL,
  pos = c(1, 1),
  start.from.origins = TRUE,
  threshold = NULL,
  flip = FALSE,
  dominance = TRUE,
  relative = FALSE,
  print.summary = TRUE,
  graph = c("base", "ggplot2"),
  print.plot = TRUE,
  ...
)

ceef.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceef.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_comparators">comparators</code></td>
<td>
<p>Vector specifying the comparators to be included in the
frontier analysis. It must have a length &gt; 1. Default as <code>NULL</code> includes
all the available comparators.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_start.from.origins">start.from.origins</code></td>
<td>
<p>Logical. Should the frontier start from the
origins of the axes? The argument is reset to <code>FALSE</code> if the average
effectiveness and/or costs of at least one comparator are negative.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_threshold">threshold</code></td>
<td>
<p>Specifies if the efficiency should be defined based on a
willingness-to-pay threshold value. If set to <code>NULL</code> (the default), no
conditions are included on the slope increase. If a positive value is passed
as argument, to be efficient an intervention also requires to have an ICER
for the comparison versus the last efficient strategy not greater than the
specified threshold value. A negative value will be ignored with a warning.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_flip">flip</code></td>
<td>
<p>Logical. Should the axes of the plane be inverted?</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_dominance">dominance</code></td>
<td>
<p>Logical. Should the dominance regions be included in the
plot?</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_relative">relative</code></td>
<td>
<p>Logical. Should the plot display the absolute measures (the
default as <code>FALSE</code>) or the differential outcomes versus the reference
comparator?</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_print.summary">print.summary</code></td>
<td>
<p>Logical. Should the efficiency frontier summary be
printed along with the graph?  See Details for additional information.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_print.plot">print.plot</code></td>
<td>
<p>Logical. Should the efficiency frontier be plotted?</p>
</td></tr>
<tr><td><code id="ceef.plot.bcea_+3A_...">...</code></td>
<td>
<p>If <code>graph_type="ggplot2"</code> and a named theme object is supplied,
it will be added to the ggplot object. Ignored if <code>graph_type="base"</code>.
Setting the optional argument <code>include.ICER</code> to <code>TRUE</code> will print
the ICERs in the summary tables, if produced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Back compatibility with BCEA previous versions:
The <code>bcea</code> objects did not include the generating <code>e</code> and <code>c</code>
matrices in BCEA versions &lt;2.1-0. This function is not compatible with
objects created with previous versions. The matrices can be appended to
<code>bcea</code> objects obtained using previous versions, making sure that the
class of the object remains unaltered.
</p>
<p>The argument <code>print.summary</code> allows for printing a brief summary of the
efficiency frontier, with default to <code>TRUE</code>. Two tables are plotted,
one for the interventions included in the frontier and one for the dominated
interventions. The average costs and clinical benefits are included for each
intervention. The frontier table includes the slope for the increase in the
frontier and the non-frontier table displays the dominance type of each
dominated intervention. Please note that the slopes are defined as the
increment in the costs for a unit increment in the benefits even if
<code>flip = TRUE</code> for consistency with the ICER definition. The angle of
increase is in radians and depends on the definition of the axes, i.e. on
the value given to the <code>flip</code> argument.
</p>
<p>If the argument <code>relative</code> is set to <code>TRUE</code>, the graph will not
display the absolute measures of costs and benefits. Instead the axes will
represent differential costs and benefits compared to the reference
intervention (indexed by <code>ref</code> in the <code><a href="#topic+bcea">bcea()</a></code> function).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ceplane</code></td>
<td>
<p> A ggplot object containing the plot. Returned only
if <code>graph_type="ggplot2"</code>. </p>
</td></tr></table>
<p> The function produces a plot of the
cost-effectiveness efficiency frontier. The dots show the simulated values
for the intervention-specific distributions of the effectiveness and costs.
The circles indicate the average of each bivariate distribution, with the
numbers referring to each included intervention. The numbers inside the
circles are black if the intervention is included in the frontier and grey
otherwise. If the option <code>dominance</code> is set to <code>TRUE</code>, the
dominance regions are plotted, indicating the areas of dominance.
Interventions in the areas between the dominance region and the frontier are
in a situation of extended dominance.
</p>


<h3>Author(s)</h3>

<p>Andrea Berardi, Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>
<p>IQWIG (2009).
&ldquo;General Methods for the Assessment of the Relation of Benefits to Cost, Version 1.0.&rdquo;
Institute for Quality and Efficiency in Health Care (IQWIG).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## create the bcea object m for the smoking cessation example
data(Smoking)
m &lt;- bcea(eff, cost, ref = 4, Kmax = 500, interventions = treats)

## produce plot
ceef.plot(m, graph = "base")


## tweak the options
## flip axis
ceef.plot(m,
          flip = TRUE,
          dominance = FALSE,
          start.from.origins = FALSE,
          print.summary = FALSE,
          graph = "base")
          
## or use ggplot2 instead
if(require(ggplot2)){
ceef.plot(m,
          dominance = TRUE,
          start.from.origins = FALSE,
          pos = TRUE,
          print.summary = FALSE,
          graph = "ggplot2")
 }


</code></pre>

<hr>
<h2 id='ceef.summary'>Summary table for CEEF</h2><span id='topic+ceef.summary'></span>

<h3>Description</h3>

<p>Summary table for CEEF
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceef.summary(he, frontier_data, frontier_params, include.ICER = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceef.summary_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceef.summary_+3A_frontier_data">frontier_data</code></td>
<td>
<p>Frontier data</p>
</td></tr>
<tr><td><code id="ceef.summary_+3A_frontier_params">frontier_params</code></td>
<td>
<p>Frontier parameters</p>
</td></tr>
<tr><td><code id="ceef.summary_+3A_include.icer">include.ICER</code></td>
<td>
<p>Should we include the ICER? default: FALSE</p>
</td></tr>
<tr><td><code id="ceef.summary_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary printed to console
</p>

<hr>
<h2 id='ceplane_geom_params'>Extract Separate Parameter Sets</h2><span id='topic+ceplane_geom_params'></span>

<h3>Description</h3>

<p>Extract Separate Parameter Sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceplane_geom_params(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceplane_geom_params_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='ceplane_ggplot_params'>CE-plane ggplot Parameters</h2><span id='topic+ceplane_ggplot_params'></span>

<h3>Description</h3>

<p>CE-plane ggplot Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ceplane_ggplot_params(he, pos_legend, graph_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceplane_ggplot_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceplane_ggplot_params_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Position of legend</p>
</td></tr>
<tr><td><code id="ceplane_ggplot_params_+3A_graph_params">graph_params</code></td>
<td>
<p>Other graphical parameters</p>
</td></tr>
<tr><td><code id="ceplane_ggplot_params_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='ceplane_plot_graph'>Cost-Effectiveness Plane Plot By Graph Device</h2><span id='topic+ceplane_plot_graph'></span><span id='topic+ceplane_plot_base.bcea'></span><span id='topic+ceplane_plot_base'></span><span id='topic+ceplane_plot_ggplot.bcea'></span><span id='topic+ceplane_plot_ggplot'></span><span id='topic+ceplane_plot_plotly.bcea'></span><span id='topic+ceplane_plot_plotly'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span> or <span class="pkg">plotly</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
ceplane_plot_base(he, wtp = 25000, pos_legend, graph_params, ...)

ceplane_plot_base(he, ...)

## S3 method for class 'bcea'
ceplane_plot_ggplot(he, pos_legend, graph_params, ...)

ceplane_plot_ggplot(he, ...)

## S3 method for class 'bcea'
ceplane_plot_plotly(he, wtp = 25000, pos_legend, graph_params, ...)

ceplane_plot_plotly(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceplane_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceplane_plot_graph_+3A_wtp">wtp</code></td>
<td>
<p>Willingness to pay threshold; default 25,000</p>
</td></tr>
<tr><td><code id="ceplane_plot_graph_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Legend position</p>
</td></tr>
<tr><td><code id="ceplane_plot_graph_+3A_graph_params">graph_params</code></td>
<td>
<p>Graph parameters in <span class="pkg">ggplot2</span> format</p>
</td></tr>
<tr><td><code id="ceplane_plot_graph_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For base R returns a plot
</p>
<p>For <span class="pkg">ggplot2</span> returns <span class="pkg">ggplot2</span> object
</p>
<p>For <span class="pkg">plotly</span> returns a plot in the Viewer
</p>


<h3>Examples</h3>

<pre><code class='language-R'># single comparator
data(Vaccine, package = "BCEA")

he &lt;- bcea(eff, cost)
ceplane.plot(he, graph = "base")

## Not run: 
# need to provide all the defaults because thats what
# ceplane.plot() does

graph_params &lt;-  list(xlab = "x-axis label",
                      ylab = "y-axis label",
                      title = "my title",
                      xlim = c(-0.002, 0.001),
                      ylim = c(-13, 5),
                      point = list(sizes = 1,
                                   colors = "darkgrey"),
                      area = list(color = "lightgrey"))
                      
he$delta_e &lt;- as.matrix(he$delta_e)
he$delta_c &lt;- as.matrix(he$delta_c)

BCEA::ceplane_plot_base(he, graph_params = graph_params)

## single non-default comparator


## multiple comparators
data(Smoking)

graph_params &lt;-  list(xlab = "x-axis label",
                      ylab = "y-axis label",
                      title = "my title",
                      xlim = c(-1, 2.5),
                      ylim = c(-1, 160),
                      point = list(sizes = 0.5,
                                   colors = grey.colors(3, start = 0.1, end = 0.7)),
                      area = list(color = "lightgrey"))
                                   
he &lt;- bcea(eff, cost, ref = 4, Kmax = 500, interventions = treats)

BCEA::ceplane_plot_base(he,
                        wtp = 200,
                        pos_legend = FALSE,
                        graph_params = graph_params)

## End(Not run)


data(Vaccine)
he &lt;- bcea(eff, cost)

ceplane.plot(he, graph = "ggplot2")
ceplane.plot(he, wtp=10000, graph = "ggplot2",
             point = list(colors = "blue", sizes = 2),
             area = list(col = "springgreen3"))

data(Smoking)
he &lt;- bcea(eff, cost, ref = 4, Kmax = 500, interventions = treats)

ceplane.plot(he, graph = "ggplot2")

ceplane.plot(he,
             wtp = 200,
             pos = "right",
             ICER_size = 2,
             graph = "ggplot2")
   
ceplane.plot(he,
             wtp = 200,
             pos = TRUE,
             graph = "ggplot2")

ceplane.plot(he,
             graph = "ggplot2",
             wtp=200,
             theme = ggplot2::theme_linedraw())
             
</code></pre>

<hr>
<h2 id='ceplane.plot.bcea'>Cost-effectiveness Plane Plot</h2><span id='topic+ceplane.plot.bcea'></span><span id='topic+ceplane.plot'></span>

<h3>Description</h3>

<p>Produces a scatter plot of the cost-effectiveness plane,
together with the sustainability area, as a function of
the selected willingness to pay threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
ceplane.plot(
  he,
  comparison = NULL,
  wtp = 25000,
  pos = c(0, 1),
  graph = c("base", "ggplot2", "plotly"),
  ...
)

ceplane.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ceplane.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ceplane.plot.bcea_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as <code>NULL</code> plots all the
comparisons together. Any subset of the possible comparisons can be selected
(e.g., <code>comparison = c(1,3)</code> or <code>comparison = 2</code>).</p>
</td></tr>
<tr><td><code id="ceplane.plot.bcea_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay parameter. Not used if
<code>graph = "base"</code> for multiple comparisons. For <span class="pkg">ggplot2</span> can also provide
a list of arguments for more options (see below).</p>
</td></tr>
<tr><td><code id="ceplane.plot.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend; for a single
comparison plot, the ICER legend position. Can be given in form of a string
<code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for <span class="pkg">ggplot2</span>. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot. Default value is <code>c(1,1)</code>, that is the topright
corner inside the plot area.</p>
</td></tr>
<tr><td><code id="ceplane.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-) match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="ceplane.plot.bcea_+3A_...">...</code></td>
<td>
<p>If <code>graph = "ggplot2"</code> and a named theme object is supplied,
it will be passed to the <span class="pkg">ggplot2</span> object. The usual ggplot2 syntax is used.
Additional graphical arguments:
</p>

<ul>
<li> <p><code>label.pos = FALSE</code>: Places the willingness-to-pay label in a
different position at the bottom of the graph. Applies to base and
<span class="pkg">ggplot2</span> only (no label in <span class="pkg">plotly</span>).
</p>
</li>
<li> <p><code>line = list(color)</code>: A colour specifying the colour of the
willingness-to-pay line.
</p>
</li>
<li> <p><code>point = list(color)</code>: A vector of colours specifying the colour(s)
associated with the cloud of points. Should be of length 1 or equal
to the number of comparisons.
</p>
</li>
<li> <p><code>point = list(size)</code>: A vector specifying the size(s) of the points.
Should be of length 1 or equal to the number of comparisons.
</p>
</li>
<li> <p><code>point = list(shape)</code>: A vector specifying the shape(s) of the points.
Should be of length 1 or equal to the number of comparisons.
</p>
</li>
<li> <p><code>icer = list(color)</code>: A vector of colours specifying the colour(s) of
the ICER points. Should be of length 1 or equal to the number of comparisons.
</p>
</li>
<li> <p><code>icer = list(size)</code>: A vector specifying the size(s) of the ICER points.
Should be of length 1 or equal to the number of comparisons.
</p>
</li>
<li> <p><code>area_include</code>: Logical. Include or exclude the cost-effectiveness
acceptability area (default is <code>TRUE</code>).
</p>
</li>
<li> <p><code>wtp = list(value)</code>: Equivalent to using <code>wtp = value</code> but for when
multiple arguments are passed in list form.
</p>
</li>
<li> <p><code>area = list(color)</code>: A colour specifying the colour of the
cost-effectiveness acceptability area.
</p>
</li>
<li> <p><code>wtp = list(color)</code>: A colour specifying the colour of the
willingness-to-pay text.
</p>
</li>
<li> <p><code>wtp = list(size)</code>: A value specifying the size of the
willingness-to-pay text.
</p>
</li>
<li> <p><code>wtp = list(x=..., y=...)</code>: Values specifying the x and y coordinates
of the willingness-to-pay text.
</p>
</li>
<li> <p><code>currency</code>: Currency prefix to cost differential values. Applies to
<span class="pkg">ggplot2</span> only.
</p>
</li>
<li> <p><code>icer_annot</code>: Annotates each ICER point with a text label. Applies to
<span class="pkg">ggplot2</span> only.
</p>
</li></ul>
</td></tr>
</table>


<h3>Details</h3>

<p>In the <span class="pkg">plotly</span> version, <code>point_colors</code>, <code>ICER_colors</code> and <code>area_color</code> can also
be specified as rgba colours using either the <code style="white-space: pre;">&#8288;[plotly]toRGB&#8288;</code>
function or a rgba colour string, e.g. <code>'rgba(1, 1, 1, 1)'</code>.
</p>


<h3>Value</h3>

<p>If <code>graph = "ggplot2"</code> a ggplot object, or if <code>graph = "plotly"</code>
a plotly object containing the requested plot. Nothing is returned when
<code>graph = "base"</code>, the default.
</p>
<p>Grey dots show the simulated values for the joint
distribution of the effectiveness and cost differentials. The larger red
dot shows the ICER and the grey area identifies the sustainability area,
i.e. the part of the plan for which the simulated values are below the
willingness to pay threshold. The proportion of points in the sustainability
area effectively represents the CEAC for a given value of the willingness to
pay. If the comparators are more than 2 and no pairwise comparison is
specified, all scatterplots are graphed using different colours.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceplane_plot_graph">ceplane_plot_graph()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create the bcea object for the smoking cessation example
data(Smoking)

m &lt;- bcea(eff, cost, ref = 4, Kmax = 500, interventions = treats)

## produce the base plot
ceplane.plot(m, wtp = 200, graph = "base")

## select only one comparator
ceplane.plot(m, wtp = 200, graph = "base", comparison = 3)

## use ggplot2
if (requireNamespace("ggplot2")) {
   ceplane.plot(m, wtp = 200, pos = "right", icer = list(size = 2), graph = "ggplot2")
}

## plotly
ceplane.plot(m, wtp = 200, graph = "plotly")
ceplane.plot(m, wtp = 200, comparison = 1, graph = "plotly")
 
</code></pre>

<hr>
<h2 id='CEriskav_assign'>Cost-effectiveness Analysis Including a Parameter of Risk Aversion</h2><span id='topic+CEriskav_assign'></span><span id='topic+CEriskav+3C-'></span><span id='topic+CEriskav'></span><span id='topic+CEriskav.default'></span><span id='topic+CEriskav+3C-.bcea'></span><span id='topic+CEriskav+3C-.default'></span>

<h3>Description</h3>

<p>Extends the standard cost-effectiveness analysis to modify the utility
function so that risk aversion of the decision maker is explicitly accounted for.
</p>
<p>Default vector of risk aversion parameters:
1e-11, 2.5e-6, 5e-6
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEriskav(he) &lt;- value

## S3 replacement method for class 'bcea'
CEriskav(he) &lt;- value

## Default S3 replacement method:
CEriskav(he) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CEriskav_assign_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="CEriskav_assign_+3A_value">value</code></td>
<td>
<p>A vector of values for the risk aversion parameter. If <code>NULL</code>,
default values are assigned by R. The first (smallest) value (<code>r</code> -&gt; 0)
produces the standard analysis with no risk aversion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the class <code>CEriskav</code> containing the following elements:
</p>

<ul>
<li> <p><strong>Ur</strong>: An array containing the simulated values for all the
&quot;known-distribution&quot; utilities for all interventions, all the values of
the willingness to pay parameter, and for all the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>Urstar</strong>: An array containing the simulated values for the
maximum &quot;known-distribution&quot; expected utility for all the values of the
willingness to pay parameter and for all the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>IBr</strong>: An array containing the simulated values for the distribution of
the Incremental Benefit for all the values of the willingness to pay
parameter and for all the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>eibr</strong>: An array containing the Expected Incremental Benefit for each
value of the willingness to pay parameter and for all the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>vir</strong>: An array containing all the simulations for the Value of
Information for each value of the willingness to pay parameter and for all
the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>evir</strong>: An array containing the Expected Value of Information for each
value of the willingness to pay parameter and for all the possible values of <code>r</code>.
</p>
</li>
<li> <p><strong>R</strong>: The number of possible values for the parameter of risk aversion <code>r</code>.
</p>
</li>
<li> <p><strong>r</strong>: A vector containing all the possible values for the parameter of
risk aversion <code>r</code>.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff,c=cost,     # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000            # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
)

# Define the vector of values for the risk aversion parameter, r, eg:
r &lt;- c(1e-10, 0.005, 0.020, 0.035) 

# Run the cost-effectiveness analysis accounting for risk aversion

# uses the results of the economic evaluation 
# if more than 2 interventions, selects the 
#  pairwise comparison

CEriskav(m) &lt;- r


</code></pre>

<hr>
<h2 id='CEriskav_plot_graph'>Cost-effectiveness Plot Including a Parameter of Risk Aversion</h2><span id='topic+CEriskav_plot_graph'></span><span id='topic+CEriskav_plot_base'></span><span id='topic+CEriskav_plot_ggplot'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CEriskav_plot_base(he, pos_legend)

CEriskav_plot_ggplot(he, pos_legend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CEriskav_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="CEriskav_plot_graph_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Legend position</p>
</td></tr>
</table>

<hr>
<h2 id='comp_names_from_'>Comparison Names From</h2><span id='topic+comp_names_from_'></span>

<h3>Description</h3>

<p>Comparison Names From
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comp_names_from_(df_ce)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="comp_names_from__+3A_df_ce">df_ce</code></td>
<td>
<p>Cost-effectiveness dataframe</p>
</td></tr>
</table>

<hr>
<h2 id='compute_CEAC'>Compute Cost-Effectiveness Acceptability Curve</h2><span id='topic+compute_CEAC'></span>

<h3>Description</h3>

<p>Compute Cost-Effectiveness Acceptability Curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_CEAC(ib)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_CEAC_+3A_ib">ib</code></td>
<td>
<p>Incremental benefit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array with dimensions (interv x k)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ceac.plot">ceac.plot()</a></code>
</p>

<hr>
<h2 id='compute_ceaf'>Compute Cost-Effectiveness Acceptability Frontier</h2><span id='topic+compute_ceaf'></span>

<h3>Description</h3>

<p>Compute Cost-Effectiveness Acceptability Frontier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ceaf(p_best_interv)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ceaf_+3A_p_best_interv">p_best_interv</code></td>
<td>
<p>Probability of being best intervention</p>
</td></tr>
</table>

<hr>
<h2 id='compute_EIB'>Compute Expected Incremental Benefit</h2><span id='topic+compute_EIB'></span>

<h3>Description</h3>

<p>A summary measure useful to assess the potential changes in the decision
under different scenarios.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_EIB(ib)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_EIB_+3A_ib">ib</code></td>
<td>
<p>Incremental benefit</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When considering a pairwise comparison
(e.g. in the simple case of a reference intervention <code class="reqn">t = 1</code> and a comparator,
such as the status quo, <code class="reqn">t = 0</code>), it is defined as the difference between the
expected utilities of the two alternatives:
</p>
<p style="text-align: center;"><code class="reqn">eib := \mbox{E}[u(e,c;1)] - \mbox{E}[u(e,c;0)] = \mathcal{U}^1 - \mathcal{U}^0.</code>
</p>

<p>Analysis of the expected incremental benefit describes how the decision changes
for different values of the threshold. The EIB marginalises out the uncertainty,
and does not incorporate and describe explicitly the uncertainty in the outcomes.
To overcome this problem the tool of choice is the CEAC.
</p>


<h3>Value</h3>

<p>Array with dimensions (interv x k)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ceac.plot">ceac.plot()</a></code>, <code><a href="#topic+compute_CEAC">compute_CEAC()</a></code>, <code><a href="#topic+compute_IB">compute_IB()</a></code>
</p>

<hr>
<h2 id='compute_eib_cri'>Calculate Credible Intervals</h2><span id='topic+compute_eib_cri'></span>

<h3>Description</h3>

<p>For expected incremental benefit plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_eib_cri(he, alpha_cri = 0.05, cri.quantile = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_eib_cri_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="compute_eib_cri_+3A_alpha_cri">alpha_cri</code></td>
<td>
<p>Significance level, 0 - 1</p>
</td></tr>
<tr><td><code id="compute_eib_cri_+3A_cri.quantile">cri.quantile</code></td>
<td>
<p>Credible interval quantile?; logical</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cri
</p>

<hr>
<h2 id='compute_EVI'>Compute Expected Value of Information</h2><span id='topic+compute_EVI'></span>

<h3>Description</h3>

<p>Compute Expected Value of Information
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_EVI(ol)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_EVI_+3A_ol">ol</code></td>
<td>
<p>Opportunity loss</p>
</td></tr>
</table>


<h3>Value</h3>

<p>EVI
</p>

<hr>
<h2 id='compute_IB'>Compute Incremental Benefit</h2><span id='topic+compute_IB'></span>

<h3>Description</h3>

<p>Sample of incremental net monetary benefit for each
willingness-to-pay threshold, <code class="reqn">k</code>, and comparator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_IB(df_ce, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_IB_+3A_df_ce">df_ce</code></td>
<td>
<p>Dataframe of cost and effectiveness deltas</p>
</td></tr>
<tr><td><code id="compute_IB_+3A_k">k</code></td>
<td>
<p>Vector of willingness to pay values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Defined as:
</p>
<p style="text-align: center;"><code class="reqn">IB = u(e,c; 1) - u(e,c; 0).</code>
</p>

<p>If the net benefit function is used as utility function,
the definition can be re-written as
</p>
<p style="text-align: center;"><code class="reqn">IB = k\cdot\Delta_e - \Delta_c.</code>
</p>



<h3>Value</h3>

<p>Array with dimensions (k x sim x ints)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_EIB">compute_EIB()</a></code>
</p>

<hr>
<h2 id='compute_ICER'>Compute Incremental Cost-Effectiveness Ratio</h2><span id='topic+compute_ICER'></span>

<h3>Description</h3>

<p>Defined as
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ICER(df_ce)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ICER_+3A_df_ce">df_ce</code></td>
<td>
<p>Cost-effectiveness dataframe</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">ICER = \Delta_c/\Delta_e</code>
</p>



<h3>Value</h3>

<p>ICER for all comparisons
</p>

<hr>
<h2 id='compute_kstar'>Compute k^*</h2><span id='topic+compute_kstar'></span>

<h3>Description</h3>

<p>Find willingness-to-pay threshold when optimal decision changes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_kstar(k, best, ref)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_kstar_+3A_k">k</code></td>
<td>
<p>Willingness-to-pay grid approximation of the budget willing to invest (vector)</p>
</td></tr>
<tr><td><code id="compute_kstar_+3A_best">best</code></td>
<td>
<p>Best intervention for each <code>k</code> (int)</p>
</td></tr>
<tr><td><code id="compute_kstar_+3A_ref">ref</code></td>
<td>
<p>Reference intervention (int)</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">k^* := \min\{k : IB &lt; 0 \}</code>
</p>

<p>The value of the break-even point corresponds to the ICER and quantifies
the point at which the decision-maker is indifferent between the two options.
</p>


<h3>Value</h3>

<p>integer representing intervention
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ceac.plot">ceac.plot()</a></code>
</p>

<hr>
<h2 id='compute_ol'>Compute Opportunity Loss</h2><span id='topic+compute_ol'></span>

<h3>Description</h3>

<p>The difference between the maximum utility computed for the current
parameter configuration (e.g. at the current simulation) <code class="reqn">U^*</code> and the current
utility of the intervention associated with the maximum utility overall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ol(Ustar, U, best)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_ol_+3A_ustar">Ustar</code></td>
<td>
<p>Maximum utility value (sim x k)</p>
</td></tr>
<tr><td><code id="compute_ol_+3A_u">U</code></td>
<td>
<p>Net monetary benefit (sim x k x interv)</p>
</td></tr>
<tr><td><code id="compute_ol_+3A_best">best</code></td>
<td>
<p>Best intervention for given willingness-to-pay (k)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In mathematical notation,
</p>
<p style="text-align: center;"><code class="reqn">\textrm{OL}(\theta) := U^*(\theta) - U(\theta^\tau)</code>
</p>

<p>where <code class="reqn">\tau</code> is the intervention associated with the overall maximum utility
and <code class="reqn">U^*(\theta)</code> is the maximum utility value among the comparators in the given simulation.
The opportunity loss is a non-negative quantity, since <code class="reqn">U(\theta^\tau)\leq U^*(\theta)</code>.
</p>
<p>In all simulations where the intervention is more
cost-effective (i.e. when incremental benefit is positive), then <code class="reqn">\textrm{OL}(\theta) = 0</code>
as there would be no opportunity loss, if the parameter configuration were the
one obtained in the current simulation.
</p>


<h3>Value</h3>

<p>Array with dimensions (sim x k)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_vi">compute_vi()</a></code>
</p>

<hr>
<h2 id='compute_p_best_interv'>Compute Probability Best Intervention</h2><span id='topic+compute_p_best_interv'></span>

<h3>Description</h3>

<p>Compute Probability Best Intervention
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_p_best_interv(he)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_p_best_interv_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
</table>

<hr>
<h2 id='compute_U'>Compute U Statistic</h2><span id='topic+compute_U'></span>

<h3>Description</h3>

<p>Sample of net (monetary) benefit for each
willingness-to-pay threshold and intervention.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_U(df_ce, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_U_+3A_df_ce">df_ce</code></td>
<td>
<p>Cost-effectiveness dataframe</p>
</td></tr>
<tr><td><code id="compute_U_+3A_k">k</code></td>
<td>
<p>Willingness to pay vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array with dimensions (sim x k x ints)
</p>

<hr>
<h2 id='compute_Ubar'>Compute NB for mixture of interventions</h2><span id='topic+compute_Ubar'></span>

<h3>Description</h3>

<p>Compute NB for mixture of interventions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_Ubar(he, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_Ubar_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="compute_Ubar_+3A_value">value</code></td>
<td>
<p>Mixture weights</p>
</td></tr>
</table>

<hr>
<h2 id='compute_Ustar'>Compute Ustar Statistic</h2><span id='topic+compute_Ustar'></span>

<h3>Description</h3>

<p>The maximum utility value among the comparators, indicating which
intervention produced the most benefits at each simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_Ustar(U)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_Ustar_+3A_u">U</code></td>
<td>
<p>Net monetary benefit (sim x k x intervs)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array with dimensions (sim x k)
</p>

<hr>
<h2 id='compute_vi'>Compute Value of Information</h2><span id='topic+compute_vi'></span>

<h3>Description</h3>

<p>The difference between the maximum utility computed for the current
parameter configuration <code class="reqn">U^*</code> and the utility of the intervention which
is associated with the maximum utility overall.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_vi(Ustar, U)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute_vi_+3A_ustar">Ustar</code></td>
<td>
<p>Maximum utility value (sim x k)</p>
</td></tr>
<tr><td><code id="compute_vi_+3A_u">U</code></td>
<td>
<p>Net monetary benefit (sim x k x interv)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of obtaining additional information on the parameter <code class="reqn">\theta</code>
to reduce the uncertainty in the decisional process.
It is defined as:
</p>
<p style="text-align: center;"><code class="reqn">\textrm{VI}(\theta) := U^*(\theta) - \mathcal{U}^*</code>
</p>

<p>with <code class="reqn">U^*(\theta)</code> the maximum utility value for the given simulation
among all comparators and <code class="reqn">\mathcal{U}^*(\theta)</code> the expected utility
gained by the adoption of the cost-effective intervention.
</p>


<h3>Value</h3>

<p>Array with dimensions (sim x k)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_ol">compute_ol()</a></code>
</p>

<hr>
<h2 id='contour_ggplot_params'>Contour ggplot Parameters</h2><span id='topic+contour_ggplot_params'></span>

<h3>Description</h3>

<p>Contour ggplot Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contour_ggplot_params(he, graph_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contour_ggplot_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="contour_ggplot_params_+3A_graph_params">graph_params</code></td>
<td>
<p>Other graphical parameters</p>
</td></tr>
<tr><td><code id="contour_ggplot_params_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='contour_graph'>Contour Cost-Effectiveness Plane</h2><span id='topic+contour_graph'></span><span id='topic+contour_base'></span><span id='topic+contour_ggplot'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contour_base(he, pos_legend, graph_params, ...)

contour_ggplot(he, pos_legend, graph_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contour_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="contour_graph_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Legend position</p>
</td></tr>
<tr><td><code id="contour_graph_+3A_graph_params">graph_params</code></td>
<td>
<p>Plot parameters; list</p>
</td></tr>
<tr><td><code id="contour_graph_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+contour">contour()</a></code>
</p>

<hr>
<h2 id='contour.bcea'>Contour Plots for the Cost-Effectiveness Plane</h2><span id='topic+contour.bcea'></span><span id='topic+contour'></span>

<h3>Description</h3>

<p>Contour method for objects in the class <code>bcea</code>.
Produces a scatterplot of the cost-effectiveness plane, with a contour-plot
of the bivariate density of the differentials of cost (y-axis) and
effectiveness (x-axis).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
contour(
  he,
  pos = c(0, 1),
  graph = c("base", "ggplot2"),
  comparison = NULL,
  ...
)

contour(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contour.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="contour.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="contour.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the three options <code>"base"</code>,
<code>"ggplot2"</code> or <code>"plotly"</code>. Default value is <code>"base"</code>.
Not all plotting functions have a <code>"plotly"</code> implementation yet.</p>
</td></tr>
<tr><td><code id="contour.bcea_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison=2</code>).</p>
</td></tr>
<tr><td><code id="contour.bcea_+3A_...">...</code></td>
<td>
<p>Additional graphical arguments. The usual ggplot2 syntax is used regardless of graph type.
</p>

<ul>
<li> <p><code>xlim</code>: The range of the plot along the x-axis. If NULL (default) it is
determined by the range of the simulated values for <code>delta_e</code>
</p>
</li>
<li> <p><code>ylim</code>: The range of the plot along the y-axis. If NULL (default) it is
determined by the range of the simulated values for <code>delta_c</code>
</p>
</li>
<li> <p><code>scale</code>: Scales the plot as a function of the observed standard deviation.
</p>
</li>
<li> <p><code>levels</code>: Numeric vector of levels at which to draw contour lines. Quantiles 0&lt;p&lt;1.
</p>
</li>
<li> <p><code>nlevels</code>: Number of levels to be plotted in the contour.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ceplane</code></td>
<td>
<p> A ggplot object containing the plot. Returned only
if <code>graph="ggplot2"</code>. </p>
</td></tr></table>
<p> Plots the cost-effectiveness plane with a
scatterplot of all the simulated values from the (posterior) bivariate
distribution of (<code class="reqn">\Delta_e, \Delta_c</code>), the differentials of effectiveness and
costs; superimposes a contour of the distribution and prints the estimated
value of the probability of each quadrant (combination of positive/negative
values for both <code class="reqn">\Delta_e</code> and <code class="reqn">\Delta_c</code>)
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>,
<code><a href="#topic+contour2">contour2()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)

# run the health economic evaluation using BCEA
m &lt;- bcea(e=eff,
          c=cost,           # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
      plot=TRUE             # plots the results
)

contour(m)
contour(m, graph = "ggplot2")

contour(m,          # uses the results of the economic evaluation 
                    #  (a "bcea" object)
      comparison=1, # if more than 2 interventions, selects the 
                    #  pairwise comparison 
      nlevels=10,   # selects the number of levels to be 
                    #  plotted (default=4)
      levels=NULL,  # specifies the actual levels to be plotted 
                    #  (default=NULL, so that R will decide)
      scale=1,      # scales the bandwidths for both x- and 
                    #  y-axis (default=0.5)
      graph="base"  # uses base graphics to produce the plot
)

# use the smoking cessation dataset
data(Smoking)
m &lt;- bcea(eff, cost, ref = 4, intervention = treats, Kmax = 500, plot = FALSE)
contour(m)
contour(m, graph = "ggplot2")

</code></pre>

<hr>
<h2 id='contour2.bcea'>Specialised CE-plane Contour Plot</h2><span id='topic+contour2.bcea'></span><span id='topic+contour2'></span>

<h3>Description</h3>

<p>Produces a scatterplot of the cost-effectiveness plane, with a contour-plot
of the bivariate density of the differentials of cost (y-axis) and
effectiveness (x-axis).  Also adds the sustainability area (i.e. below the
selected value of the willingness-to-pay threshold).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
contour2(
  he,
  comparison = NULL,
  wtp = 25000,
  graph = c("base", "ggplot2"),
  pos = c(0, 1),
  ...
)

contour2(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contour2.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="contour2.bcea_+3A_comparison">comparison</code></td>
<td>
<p>The comparison being plotted. Default to <code>NULL</code>
If <code>graph_type="ggplot2"</code> the default value will choose all the possible
comparisons. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code>).</p>
</td></tr>
<tr><td><code id="contour2.bcea_+3A_wtp">wtp</code></td>
<td>
<p>The selected value of the willingness-to-pay. Default is
<code>25000</code>.</p>
</td></tr>
<tr><td><code id="contour2.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the three options <code>"base"</code>,
<code>"ggplot2"</code> or <code>"plotly"</code>. Default value is <code>"base"</code>.
Not all plotting functions have a <code>"plotly"</code> implementation yet.</p>
</td></tr>
<tr><td><code id="contour2.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="contour2.bcea_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>. See the
relative manual page for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>contour</code></td>
<td>
<p> A ggplot item containing the requested plot.
Returned only if <code>graph_type="ggplot2"</code>. </p>
</td></tr></table>
<p> Plots the cost-effectiveness
plane with a scatterplot of all the simulated values from the (posterior)
bivariate distribution of (<code class="reqn">\Delta_e, \Delta_c</code>), the differentials of
effectiveness and costs; superimposes a contour of the distribution and
prints the value of the ICER, together with the sustainability area.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>,
<code><a href="#topic+contour">contour()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## create the bcea object m for the smoking cessation example
data(Smoking)
m &lt;- bcea(eff, cost, ref = 4, interventions = treats, Kmax = 500)

## produce the plot
contour2(m,
         wtp = 200,
         graph_type = "base")


## or use ggplot2 to plot multiple comparisons
contour2(m,
         wtp = 200,
         ICER_size = 2,
         graph_type = "ggplot2")


## vaccination example
data(Vaccine)
treats = c("Status quo", "Vaccination")
m &lt;- bcea(eff, cost, ref = 2, interventions = treats, Kmax = 50000)
contour2(m)
contour2(m, wtp = 100)

</code></pre>

<hr>
<h2 id='convert_pts_to_mm'>Use from Base  R to ggplot</h2><span id='topic+convert_pts_to_mm'></span>

<h3>Description</h3>

<p>Use from Base  R to ggplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_pts_to_mm(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_pts_to_mm_+3A_x">x</code></td>
<td>
<p>points</p>
</td></tr>
</table>

<hr>
<h2 id='createInputs.default'>Create Inputs for EVPI Calculation</h2><span id='topic+createInputs.default'></span><span id='topic+createInputs'></span><span id='topic+createInputs.rjags'></span><span id='topic+createInputs.bugs'></span><span id='topic+createInputs.stanfit'></span><span id='topic+createInputs.data.frame'></span><span id='topic+createInputs.numeric'></span>

<h3>Description</h3>

<p>Creates an object containing the matrix with the parameters simulated using
the MCMC procedure (using JAGS, BUGS or Stan) and a vector of parameters
(strings) that can be used to perform the expected value of partial
information analysis. In the process, <code>createInputs</code> also checks for
linear dependency among columns of the PSA samples or columns having
constant values and removes them to only leave the fundamental parameters
(to run VoI analysis). This also deals with simulations stored in a
<code>.csv</code> or <code>.txt</code> file (e.g. as obtained using bootstrapping from a
non-Bayesian model).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
createInputs(inputs, print_is_linear_comb = TRUE)

createInputs(inputs, print_is_linear_comb = TRUE)

## S3 method for class 'rjags'
createInputs(inputs, print_is_linear_comb = TRUE)

## S3 method for class 'bugs'
createInputs(inputs, print_is_linear_comb = TRUE)

## S3 method for class 'stanfit'
createInputs(inputs, print_is_linear_comb = TRUE)

## S3 method for class 'data.frame'
createInputs(inputs, print_is_linear_comb = TRUE)

## S3 method for class 'numeric'
createInputs(inputs, print_is_linear_comb = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="createInputs.default_+3A_inputs">inputs</code></td>
<td>
<p>A <code>rjags</code>, <code>bugs</code> or <code>stanfit</code> object, containing
the results of a call to either JAGS, (using <code>R2jags</code>), BUGS
(using <code>R2WinBUGS</code>, or Stan (using <code>rstan</code>).</p>
</td></tr>
<tr><td><code id="createInputs.default_+3A_print_is_linear_comb">print_is_linear_comb</code></td>
<td>
<p>Logical indicator. If set to <code>TRUE</code> (default)
then prints the output of the procedure trying to assess whether there are
some parameters that are a linear combination of others (in which case
they are removed).</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mat</code></td>
<td>
<p>Data.frame containing all the simulations
for all the monitored parameters</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>Character vectors of the names
of all the monitored parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio, Anna Heath and Mark Strong
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+evppi">evppi()</a></code>
</p>

<hr>
<h2 id='diag.evppi'>Diagnostic Plots For The Results Of The EVPPI</h2><span id='topic+diag.evppi'></span>

<h3>Description</h3>

<p>The function produces either a residual plot comparing the fitted
values from the INLA-SPDE Gaussian Process regression to the residuals.
This is a scatter plot of residuals on the y axis and fitted values (estimated
responses) on the x axis. The plot is used to detect non-linearity, unequal
error variances, and outliers. A well-behaved residual plot supporting the
appropriateness of the simple linear regression model has the following
characteristics:
</p>

<ol>
<li><p> The residuals bounce randomly around the 0 line. This suggests that
the assumption that the relationship is linear is reasonable.
</p>
</li>
<li><p> The residuals roughly form a horizontal band around the 0 line. This
suggests that the variances of the error terms are equal.
</p>
</li>
<li><p> None of the residual stands out from the basic random pattern of residuals.
This suggests that there are no outliers.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>diag.evppi(evppi, he, plot_type = c("residuals", "qqplot"), interv = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diag.evppi_+3A_evppi">evppi</code></td>
<td>
<p>A <code>evppi</code> object obtained by running the function <code>evppi</code>
on a <code>bcea</code> model.</p>
</td></tr>
<tr><td><code id="diag.evppi_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="diag.evppi_+3A_plot_type">plot_type</code></td>
<td>
<p>The type of diagnostics to be performed. It can be the 'residual
plot' (<code>residuals</code>) or the Q-Q (quantile-quantile) plot (<code>qqplot</code>).</p>
</td></tr>
<tr><td><code id="diag.evppi_+3A_interv">interv</code></td>
<td>
<p>Specifies the interventions for which diagnostic tests should be
performed (if there are many options being compared)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The second possible diagnostic is the Q-Q plot for the fitted value. This is a
graphical method for comparing the fitted values distributions with the
assumed underlying normal distribution by plotting their quantiles against
each other. First, the set of intervals for the quantiles is chosen. A point
(x,y) on the plot corresponds to one of the quantiles of the second
distribution (y-coordinate) plotted against the same quantile of the first
distribution (x-coordinate). If the two distributions being compared are
identical, the Q-Q plot follows the 45 degrees line.
</p>


<h3>Value</h3>

<p>Plot
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Anna Heath
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>, <code><a href="#topic+evppi">evppi()</a></code>
</p>

<hr>
<h2 id='eib_params_base'>EIB parameters specific to base R plot</h2><span id='topic+eib_params_base'></span>

<h3>Description</h3>

<p>EIB parameters specific to base R plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eib_params_base(he, graph_params, cri_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eib_params_base_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="eib_params_base_+3A_graph_params">graph_params</code></td>
<td>
<p>Type of plot device</p>
</td></tr>
<tr><td><code id="eib_params_base_+3A_cri_params">cri_params</code></td>
<td>
<p>Credible interval parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>

<hr>
<h2 id='eib_params_cri'>EIB Parameters CrI</h2><span id='topic+eib_params_cri'></span>

<h3>Description</h3>

<p>EIB Parameters CrI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eib_params_cri(he, graph_params)
</code></pre>

<hr>
<h2 id='eib_plot_graph'>Expected Incremental Benefit Plot By Graph Device</h2><span id='topic+eib_plot_graph'></span><span id='topic+eib_plot_base'></span><span id='topic+eib_plot_ggplot'></span><span id='topic+eib_plot_plotly'></span>

<h3>Description</h3>

<p>Choice of base R, ggplot2 or plotly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eib_plot_base(he, graph_params, ...)

eib_plot_ggplot(he, graph_params, ...)

eib_plot_plotly(he, graph_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eib_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="eib_plot_graph_+3A_graph_params">graph_params</code></td>
<td>
<p>Graph parameters</p>
</td></tr>
<tr><td><code id="eib_plot_graph_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>

<hr>
<h2 id='eib.plot.bcea'>Expected Incremental Benefit (EIB) Plot</h2><span id='topic+eib.plot.bcea'></span><span id='topic+eib.plot'></span>

<h3>Description</h3>

<p>Produces a plot of the Expected Incremental Benefit (EIB) as a function of
the willingness to pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
eib.plot(
  he,
  comparison = NULL,
  pos = c(1, 0),
  size = NULL,
  plot.cri = NULL,
  graph = c("base", "ggplot2", "plotly"),
  ...
)

eib.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eib.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison=2</code>).</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_size">size</code></td>
<td>
<p>Value (in millimetres) of the size of the willingness to pay
label. Used only if <code>graph="ggplot2"</code>, otherwise it will be ignored
with a message. If set to <code>NA</code>, the break-even point line(s) and
label(s) are suppressed, with both base graphics and ggplot2.</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_plot.cri">plot.cri</code></td>
<td>
<p>Logical value. Should the credible intervals be plotted
along with the expected incremental benefit? Default as <code>NULL</code> draws
the 95\
include them for multiple comparisons.  Setting <code>plot.cri=TRUE</code> or
<code>plot.cri=FALSE</code> forces the function to add the intervals or not. The
level of the intervals can be also set, see ... for more details.</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the three options <code>"base"</code>,
<code>"ggplot2"</code> or <code>"plotly"</code>. Default value is <code>"base"</code>.
Not all plotting functions have a <code>"plotly"</code> implementation yet.</p>
</td></tr>
<tr><td><code id="eib.plot.bcea_+3A_...">...</code></td>
<td>
<p>If <code>graph="ggplot2"</code> and a named theme object is supplied,
it will be added to the ggplot object. Additional arguments:
</p>

<ul>
<li> <p><code>alpha</code> can be used to set the CrI level when <code>plot.cri=TRUE</code>,
with a default value of <code>alpha=0.05</code>.
</p>
</li>
<li> <p><code>cri.quantile</code> controls the the method of calculation of the credible
intervals. The default value <code>cri.quantile=TRUE</code> defines the CrI as the
interval between the <code>alpha/2</code>-th and <code>1-alpha/2</code>-th quantiles of
the IB distribution. Setting <code>cri.quantile=FALSE</code> will use a normal
approximation on the IB distribution to calculate the intervals.
</p>
</li>
<li> <p><code>line = list(color)</code>: specifies the line colour(s) - all graph types.
</p>
</li>
<li> <p><code>line = list(type)</code>: specifies the line type(s) as lty numeric values - all graph types.
</p>
</li>
<li> <p><code>area_include</code>: include area under the EIB curve - plotly only.
</p>
</li>
<li> <p><code>area_color</code>: specifies the AUC curve - plotly only.</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>eib</code></td>
<td>
<p> If <code>graph="ggplot2"</code> a ggplot object, or if <code>graph="plotly"</code>
a plotly object containing the requested plot. Nothing is returned when <code>graph="base"</code>,
the default.</p>
</td></tr></table>
<p> The function produces a plot of the
Expected Incremental Benefit as a function of the discrete grid
approximation of the willingness to pay parameter. The break even point
(i.e. the point in which the EIB = 0, i.e. when the optimal decision changes
from one intervention to another) is also showed by default. The value <code style="white-space: pre;">&#8288;k*&#8288;</code> is
the discrete grid approximation of the ICER.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ib.plot">ib.plot()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)
 
# Runs the health economic evaluation using BCEA
m &lt;- bcea(
      e=eff,
      c=cost,               # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
      plot=FALSE            # plots the results
)
eib.plot(m)
eib.plot(m, graph = "ggplot2") + ggplot2::theme_linedraw()

data(Smoking)
treats &lt;- c("No intervention", "Self-help",
            "Individual counselling", "Group counselling")
m &lt;- bcea(eff, cost, ref = 4, interventions = treats, Kmax = 500)
eib.plot(m)

</code></pre>

<hr>
<h2 id='evi_plot_graph'>Expected Value of Information Plot By Graph Device</h2><span id='topic+evi_plot_graph'></span><span id='topic+evi_plot_base'></span><span id='topic+evi_plot_ggplot'></span><span id='topic+evi_plot_plotly'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span> or <span class="pkg">plotly</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evi_plot_base(he, data.psa, plot_aes, plot_annotations)

evi_plot_ggplot(he, data.psa, plot_aes, plot_annotations)

evi_plot_plotly(data.psa, plot_aes, plot_annotations)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evi_plot_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="evi_plot_graph_+3A_data.psa">data.psa</code></td>
<td>
<p>Data</p>
</td></tr>
<tr><td><code id="evi_plot_graph_+3A_plot_aes">plot_aes</code></td>
<td>
<p>Aesthetic parameters</p>
</td></tr>
<tr><td><code id="evi_plot_graph_+3A_plot_annotations">plot_annotations</code></td>
<td>
<p>Plot parameters</p>
</td></tr>
</table>

<hr>
<h2 id='evi.plot.bcea'>Expected Value of Information (EVI) Plot</h2><span id='topic+evi.plot.bcea'></span><span id='topic+evi.plot'></span>

<h3>Description</h3>

<p>Plots the Expected Value of Information (EVI) against the willingness to pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
evi.plot(he, graph = c("base", "ggplot2", "plotly"), ...)

evi.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evi.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="evi.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the three options <code>"base"</code>,
<code>"ggplot2"</code> or <code>"plotly"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="evi.plot.bcea_+3A_...">...</code></td>
<td>
<p>Additional graphical arguments:
</p>

<ul>
<li> <p><code>line_colors</code> to specify the EVPI line colour - all graph types.
</p>
</li>
<li> <p><code>line_types</code> to specify the line type (lty) - all graph types.
</p>
</li>
<li> <p><code>area_include</code> to specify whether to include the area under the
EVPI curve - plotly only.
</p>
</li>
<li> <p><code>area_color</code> to specify the area under the colour curve - plotly only.</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>eib</code></td>
<td>
<p> If <code>graph="ggplot2"</code> a ggplot object, or if <code>graph="plotly"</code>
a plotly object containing the requested plot. Nothing is returned when <code>graph="base"</code>,
the default.</p>
</td></tr></table>
<p> The function produces a plot of the
Expected Value of Information as a function of the discrete grid
approximation of the willingness to pay parameter. The break even point(s)
(i.e. the point in which the EIB=0, ie when the optimal decision changes
from one intervention to another) is(are) also showed.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceac.plot">ceac.plot()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)
m &lt;- bcea(
      e=eff,
      c=cost,               # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
      plot=FALSE            # plots the results
)
evi.plot(m)

data(Smoking)
treats &lt;- c("No intervention", "Self-help",
            "Individual counselling", "Group counselling")
m &lt;- bcea(eff, cost, ref = 4, interventions = treats, Kmax = 500)
evi.plot(m)

</code></pre>

<hr>
<h2 id='evi.plot.mixedAn'>EVI Plot of the Health Economic Analysis For Mixed Analysis</h2><span id='topic+evi.plot.mixedAn'></span>

<h3>Description</h3>

<p>Compares the optimal scenario to the mixed case in terms of the EVPI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedAn'
evi.plot(he, y.limits = NULL, pos = c(0, 1), graph = c("base", "ggplot2"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evi.plot.mixedAn_+3A_he">he</code></td>
<td>
<p>An object of class <code>mixedAn</code>, a subclass of <code>bcea</code>,
given as output of the call to the function <code><a href="#topic+mixedAn">mixedAn()</a></code>.</p>
</td></tr>
<tr><td><code id="evi.plot.mixedAn_+3A_y.limits">y.limits</code></td>
<td>
<p>Range of the y-axis for the graph. The default value is
<code>NULL</code>, in which case the maximum range between the optimal and the
mixed analysis scenarios is considered.</p>
</td></tr>
<tr><td><code id="evi.plot.mixedAn_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="evi.plot.mixedAn_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="evi.plot.mixedAn_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters
(see <code><a href="graphics.html#topic+par">par()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>evi</code></td>
<td>
<p> A ggplot object containing the plot. Returned only if
<code>graph="ggplot2"</code>. </p>
</td></tr></table>
<p> The function produces a graph showing the
difference between the &rdquo;optimal&rdquo; version of the EVPI (when only the most
cost-effective intervention is included in the market) and the mixed
strategy one (when more than one intervention is considered in the market).
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Russo P (2009).
&ldquo;A decision-theoretic framework for the application of cost-effectiveness analysis in regulatory processes.&rdquo;
<em>Pharmacoeconomics</em>, <b>27</b>(8), 5&ndash;16.
ISSN 20356137, <a href="https://doi.org/10.1007/bf03320526">doi:10.1007/bf03320526</a>.
</p>
<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+mixedAn">mixedAn()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem
#
# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
      plot=FALSE            # inhibits graphical output
)

mixedAn(m) &lt;- NULL      # uses the results of the mixed strategy 
                        #  analysis (a "mixedAn" object)
                        # the vector of market shares can be defined 
                        #  externally. If NULL, then each of the T 
                        #  interventions will have 1/T market share
                        # produces the plots
evi.plot(m)

evi.plot(m, graph="base")

# Or with ggplot2
if (require(ggplot2)) {
   evi.plot(m, graph="ggplot2")
}

</code></pre>

<hr>
<h2 id='evppi'>Expected Value of Perfect Partial Information (EVPPI) for Selected
Parameters</h2><span id='topic+evppi'></span><span id='topic+evppi.default'></span><span id='topic+evppi.bcea'></span>

<h3>Description</h3>

<p>Calculates the Expected Value of Perfect Partial Information (EVPPI) for
subsets of parameters. Uses GAM non-parametric regression for single
parameter EVPPI and the SPDE-INLA method for larger parameter subsets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evppi(he, param_idx, input, N = NULL, plot = FALSE, residuals = TRUE, ...)

## Default S3 method:
evppi(he, ...)

## S3 method for class 'bcea'
evppi(
  he,
  param_idx = NULL,
  input,
  N = NULL,
  plot = FALSE,
  residuals = TRUE,
  method = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evppi_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="evppi_+3A_param_idx">param_idx</code></td>
<td>
<p>A vector of parameters for which the EVPPI should be
calculated. This can be given as a string (or vector of strings) of names or
a numeric vector, corresponding to the column numbers of important
parameters.</p>
</td></tr>
<tr><td><code id="evppi_+3A_input">input</code></td>
<td>
<p>A matrix containing the simulations for all the parameters
monitored by the call to JAGS or BUGS. The matrix should have column names
matching the names of the parameters and the values in the vector parameter
should match at least one of those values.</p>
</td></tr>
<tr><td><code id="evppi_+3A_n">N</code></td>
<td>
<p>The number of PSA simulations used to calculate the EVPPI. The
default uses all the available samples.</p>
</td></tr>
<tr><td><code id="evppi_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether the triangular mesh for
SPDE-INLA should be plotted. Default set to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="evppi_+3A_residuals">residuals</code></td>
<td>
<p>A logical value indicating whether the fitted values for
the SPDE-INLA method should be outputted. Default set to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="evppi_+3A_...">...</code></td>
<td>
<p>Additional arguments. Details of the methods to compute the EVPPI and their additional arguments are:
</p>

<ul>
<li><p> For single-parameter:
</p>

<ul>
<li><p> Generalized additive model (GAM) (default).
</p>
</li>
<li><p> The method of Strong &amp; Oakley use <code>method</code> as string <code>so</code>.
The user <em>needs</em> to also specify the number of &quot;blocks&quot; (e.g. <code>n.blocks=20</code>).
Note that the multi-parameter version for this method has been deprecated.
</p>
</li>
<li><p> The method of Sadatsafavi <em>et al.</em> where <code>method</code> takes as value a string of either <code>sad</code> or <code>sal</code>.
It is then possible to also specify the number of &quot;separators&quot; (e.g. <code>n.seps=3</code>).
If none is specified, the default value <code>n.seps=1</code> is used.
Note that the multi-parameter version for this method has been deprecated.
</p>
</li></ul>

</li>
<li><p> For multi-parameter:
</p>

<ul>
<li><p> INLA/SPDE (default).
</p>
</li>
<li><p> Gaussian process regression with <code>method</code> of <code>gp</code>.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="evppi_+3A_method">method</code></td>
<td>
<p>Character string to select which method to use. The default methods are recommended.
However, it is possible (mainly for backward compatibility) to use different methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The single parameter EVPPI has been calculated using the non-parametric GAM
regression developed by Strong <em>et al.</em> (2014). The multi-parameter EVPPI is
calculated using the SPDE-INLA regression method for Gaussian Process
regression developed by Heath <em>et al.</em> (2015).
</p>
<p>This function has been completely changed and restructured to make it possible
to change regression method.
The method argument can now be given as a list. The first element element in the
list is a vector giving the regression method for the effects. The second gives
the regression method for the costs. The <code style="white-space: pre;">&#8288;method' argument can also be given as before which then uses the same regression method for all curves. All other &#8288;</code>extra_args<code style="white-space: pre;">&#8288;can be given as before.&#8288;</code>int.ord<code style="white-space: pre;">&#8288;can be updated using the list formulation above to give the interactions for each different curve. The formula argument for GAM can only be given once, either&#8288;</code>te()<code>or</code>s() + s()'
as this is for computational reasons rather than to aid fit.
You can still plot the INLA mesh elements but not output the meshes.
</p>


<h3>Value</h3>

<p>An object of class <code>evppi</code>, containing the following components:
</p>

<ul>
<li> <p><strong>evppi</strong>: The computed values of <code>evppi</code> for all values of the parameter of willingness to pay.
</p>
</li>
<li> <p><strong>index</strong>: A numerical vector with the indices of the parameters for which the EVPPI was calculated.
</p>
</li>
<li> <p><strong>k</strong>: A vector of values for the willingness to pay.
</p>
</li>
<li> <p><strong>evi</strong>: A vector of values for the overall EVPPI.
</p>
</li>
<li> <p><strong>fitted.costs</strong>: The fitted values for the costs.
</p>
</li>
<li> <p><strong>fitted.effects</strong>: The fitted values for the effects.
</p>
</li>
<li> <p><strong>parameters</strong>: A single string containing the names of the parameters for which the EVPPI was calculated (used for plotting).
</p>
</li>
<li> <p><strong>time</strong>: The computational time (in seconds).
</p>
</li>
<li> <p><strong>fit.c</strong>: The object produced by the model fit for the costs.
</p>
</li>
<li> <p><strong>fit.e</strong>: The object produced by the model fit for the effects.
</p>
</li>
<li> <p><strong>formula</strong>: The formula used to fit the model.
</p>
</li>
<li> <p><strong>method</strong>: A string indicating the method used to estimate the EVPPI.
</p>
</li></ul>



<h3>GAM regression</h3>

<p>For multi-parameter, the user can select 3 possible methods. If
<code>method = "GAM"</code> (BCEA will accept also <code>"gam"</code>, <code>"G"</code> or
<code>"g"</code>), then the computations are based on GAM regression. The user can
also specify the formula for the regression. The default option is to use a
tensor product (e.g. if there are two main parameters, <code>p1</code> and
<code>p2</code>, this amounts to setting <code>formula = "te(p1,p2)"</code>, which
indicates that the two parameters interact). Alternatively, it is possible
to specify a model in which the parameters are independent using the
notation <code>formula = "s(p1) + s(p2)"</code>. This may lead to worse accuracy in
the estimates.
</p>


<h3>Strong <em>et al.</em> GP regression</h3>

<p>This is used if <code>method="GP"</code> (BCEA will also accept the specification
<code>method="gp"</code>). In this case, the user can also specify the number of
PSA runs that should be used to estimate the hyperparameters of the model
(e.g. <code>n.sim=100</code>). This value is set by default to 500.
</p>


<h3>INLA-related options</h3>

<p>These are all rather technical and are described in detail in Baio <em>et al.</em> (2017).
The optional parameter vector <code>int.ord</code> can take integer values (c(1,1) is
default) and will force the predictor to include interactions: if
<code>int.ord = c(k, h)</code>, then all k-way interactions will be used for the
effects and all h-way interactions will be used for the costs. Also, the
user can specify the feature of the mesh for the &quot;spatial&quot; part of the
model. The optional parameter <code>cutoff</code> (default 0.3) controls the
density of the points inside the mesh. Acceptable values are typically in
the interval (0.1, 0.5), with lower values implying more points (and thus
better approximation and greater computational time). The construction of the
boundaries for the mesh can be controlled by the optional inputs
<code>convex.inner</code> (default = -0.4) and <code>convex.outer</code> (default =
-0.7). These should be negative values and can be decreased (say to -0.7 and
-1, respectively) to increase the distance between the points and the outer
boundary, which also increases precision and computational time. The
optional argument<code>robust</code> can be set to TRUE, in which case INLA will
use a t prior distribution for the coefficients of the linear predictor.
Finally, the user can control the accuracy of the INLA grid-search for the
estimation of the hyperparameters. This is done by setting a value
<code>h.value</code> (default = 0.00005). Lower values imply a more refined search
(and hence better accuracy), at the expense of computational speed. The
method argument can also be given as a list allowing different regression
methods for the effects and costs, and the different incremental decisions.
The first list element should contain a vector of methods for the
incremental effects and the second for the costs, for example
<code>method = list(c("GAM"), c("INLA"))</code>. The <code>int.ord</code> argument can also
be given as a list to give different interaction levels for each regression
curve.
</p>
<p>By default, when no method is specified by the user, <code>evppi</code> will
use GAM if the number of parameters is &lt;5 and INLA otherwise.
</p>


<h3>Author(s)</h3>

<p>Anna Heath, Gianluca Baio
</p>


<h3>References</h3>

<p>Strong M, Oakley JE, Brennan A (2014).
&ldquo;Estimating Multiparameter Partial Expected Value of Perfect Information from a Probabilistic Sensitivity Analysis Sample : A Nonparametric Regression Approach.&rdquo;
<em>Medical Decision Making</em>, 311&ndash;326.
<a href="https://doi.org/10.1177/0272989X13505910">doi:10.1177/0272989X13505910</a>.
</p>
<p>Sadatsafavi M, Bansback N, Zafari Z, Najafzadeh M, Marra C (2013).
&ldquo;Need for speed: An efficient algorithm for calculation of single-parameter expected value of partial perfect information.&rdquo;
<em>Value Heal.</em>, <b>16</b>(2), 438&ndash;448.
ISSN 10983015, <a href="https://doi.org/10.1016/j.jval.2012.10.018">doi:10.1016/j.jval.2012.10.018</a>, <a href="http://dx.doi.org/10.1016/j.jval.2012.10.018">http://dx.doi.org/10.1016/j.jval.2012.10.018</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>
<p>Baio, Gianluca, Berardi, Andrea, Heath A (2017).
<em>Bayesian Cost-Effectiveness Analysis with the R package BCEA</em>.
Springer International Publishing.
<a href="https://link.springer.com/book/10.1007/978-3-319-55718-2">https://link.springer.com/book/10.1007/978-3-319-55718-2</a>.
</p>
<p>Heath A, Manolopoulou I, Baio G (2016).
&ldquo;Estimating the expected value of partial perfect information in health economic evaluations using integrated nested Laplace approximation.&rdquo;
<em>Stat. Med.</em>, <b>35</b>(23), 4264&ndash;4280.
ISSN 0277-6715, <a href="https://doi.org/10.1002/sim.6983">doi:10.1002/sim.6983</a>, 1504.05436, <a href="https://pubmed.ncbi.nlm.nih.gov/27189534/">https://pubmed.ncbi.nlm.nih.gov/27189534/</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+plot.evppi">plot.evppi()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

## Not run: 
# Load the post-processed results of the MCMC simulation model
# original JAGS output is can be downloaded from here
# https://gianluca.statistica.it/book/bcea/code/vaccine.RData

data(Vaccine, package = "BCEA")
treats &lt;- c("Status quo", "Vaccination")

# Run the health economic evaluation using BCEA
m &lt;- bcea(e.pts, c.pts, ref = 2, interventions = treats)

# Compute the EVPPI for a bunch of parameters
inp &lt;- createInputs(vaccine_mat)

# explicitly use BCEA package namespace to avoid voi package conflict
EVPPI &lt;- BCEA::evppi(m, c("beta.1." , "beta.2."), inp$mat)

plot(EVPPI)

# deprecated (single parameter) methods
EVPPI.so &lt;- BCEA::evppi(m, c("beta.1.", "beta.2."), inp$mat, method = "so", n.blocks = 50)
EVPPI.sad &lt;- BCEA::evppi(m, c("beta.1.", "beta.2."), inp$mat, method = "sad", n.seps = 1)

plot(EVPPI.so)
plot(EVPPI.sad)
 
# Compute the EVPPI using INLA/SPDE
if (require("INLA"))
  x_inla &lt;- BCEA::evppi(he = m, 39:40, input = inp$mat)

# using GAM regression
x_gam &lt;- BCEA::evppi(he = m, 39:40, input = inp$mat, method = "GAM")

# using Strong et al GP regression
x_gp &lt;- BCEA::evppi(he = m, 39:40, input = inp$mat, method = "GP")

# plot results
if (require("INLA")) plot(x_inla)
points(x_inla$k, x_inla$evppi, type = "l", lwd = 2, lty = 2)
points(x_gam$k, x_gam$evppi, type = "l", col = "red")
points(x_gp$k, x_gp$evppi, type = "l", col = "blue")

if (require("INLA")) {
  plot(x_inla$k, x_inla$evppi, type = "l", lwd = 2, lty = 2)
  points(x_gam$k, x_gam$evppi, type = "l", col = "red")
  points(x_gp$k, x_gp$evppi, type = "l", col = "blue")
}

data(Smoking)
treats &lt;- c("No intervention", "Self-help",
"Individual counselling", "Group counselling")
m &lt;- bcea(eff, cost, ref = 4, interventions = treats, Kmax = 500)
inp &lt;- createInputs(smoking_output)
EVPPI &lt;- BCEA::evppi(m, c(2,3), inp$mat, h.value = 0.0000005)
plot(EVPPI)

## End(Not run)

data(Vaccine, package = "BCEA")
treats &lt;- c("Status quo", "Vaccination")
bcea_vacc &lt;- bcea(e.pts, c.pts, ref = 2, interventions = treats)
inp &lt;- createInputs(vaccine_mat)
BCEA::evppi(bcea_vacc, c("beta.1.", "beta.2."), inp$mat)

</code></pre>

<hr>
<h2 id='evppi_plot_graph'>Plot Expected Value of Partial Information With Respect to a
Set of Parameters</h2><span id='topic+evppi_plot_graph'></span><span id='topic+evppi_plot_base'></span><span id='topic+evppi_plot_ggplot'></span>

<h3>Description</h3>

<p>Base R and <span class="pkg">ggplot2</span> versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evppi_plot_base(evppi_obj, pos_legend, col = NULL, annot = FALSE)

evppi_plot_ggplot(evppi_obj, pos_legend = c(0, 0.8), col = c(1, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evppi_plot_graph_+3A_evppi_obj">evppi_obj</code></td>
<td>
<p>Object of class evppi</p>
</td></tr>
<tr><td><code id="evppi_plot_graph_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Position of legend</p>
</td></tr>
<tr><td><code id="evppi_plot_graph_+3A_col">col</code></td>
<td>
<p>Colour</p>
</td></tr>
<tr><td><code id="evppi_plot_graph_+3A_annot">annot</code></td>
<td>
<p>Annotate EVPPI curve with parameter names</p>
</td></tr>
<tr><td><code id="evppi_plot_graph_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='evppi_qq_plot'>Q-Q Plot</h2><span id='topic+evppi_qq_plot'></span>

<h3>Description</h3>

<p>Q-Q Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evppi_qq_plot(evppi, he, interv)
</code></pre>

<hr>
<h2 id='evppi_residual_plot'>Residual Plot</h2><span id='topic+evppi_residual_plot'></span>

<h3>Description</h3>

<p>Residual Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evppi_residual_plot(evppi, he, interv)
</code></pre>

<hr>
<h2 id='geom_cri'>Credible interval ggplot geom</h2><span id='topic+geom_cri'></span>

<h3>Description</h3>

<p>Credible interval ggplot geom
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_cri(plot.cri = TRUE, params = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_cri_+3A_plot.cri">plot.cri</code></td>
<td>
<p>Should we plot CrI? Logical</p>
</td></tr>
<tr><td><code id="geom_cri_+3A_params">params</code></td>
<td>
<p>Plot parameters including data</p>
</td></tr>
</table>

<hr>
<h2 id='geom_quad_txt'>Geom Quadrant Text</h2><span id='topic+geom_quad_txt'></span>

<h3>Description</h3>

<p>Geom Quadrant Text
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_quad_txt(he, graph_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_quad_txt_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="geom_quad_txt_+3A_graph_params">graph_params</code></td>
<td>
<p>Plot parameters; list</p>
</td></tr>
</table>

<hr>
<h2 id='get_fitted_'>Get fitted values from evppi object</h2><span id='topic+get_fitted_'></span>

<h3>Description</h3>

<p>Get fitted values from evppi object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_fitted_(val, voi_methods, voi_models)
</code></pre>


<h3>Value</h3>

<p>matrix
</p>

<hr>
<h2 id='GrassmannOptim'>GrassmannOptim</h2><span id='topic+GrassmannOptim'></span>

<h3>Description</h3>

<p>This function is taken from the GrassmannOptim package
by Kofi Placid Adragni and Seongho Wu
https://cran.r-project.org/web/packages/GrassmannOptim/index.html
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GrassmannOptim(
  objfun,
  W,
  sim_anneal = FALSE,
  temp_init = 20,
  cooling_rate = 2,
  max_iter_sa = 100,
  eps_conv = 1e-05,
  max_iter = 100,
  eps_grad = 1e-05,
  eps_f = .Machine$double.eps,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GrassmannOptim_+3A_objfun">objfun</code></td>
<td>
<p>objfun</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_w">W</code></td>
<td>
<p>W</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_sim_anneal">sim_anneal</code></td>
<td>
<p>sim_anneal</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_temp_init">temp_init</code></td>
<td>
<p>temp_init</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_cooling_rate">cooling_rate</code></td>
<td>
<p>cooling_rate</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_max_iter_sa">max_iter_sa</code></td>
<td>
<p>max_iter_sa</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_eps_conv">eps_conv</code></td>
<td>
<p>eps_conv</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_max_iter">max_iter</code></td>
<td>
<p>max_iter</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_eps_grad">eps_grad</code></td>
<td>
<p>eps_grad</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_eps_f">eps_f</code></td>
<td>
<p>eps_f</p>
</td></tr>
<tr><td><code id="GrassmannOptim_+3A_verbose">verbose</code></td>
<td>
<p>verbose</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List
</p>

<hr>
<h2 id='ib_plot_base'>IB plot base R version</h2><span id='topic+ib_plot_base'></span><span id='topic+ib_plot_graph'></span><span id='topic+ib_plot_ggplot'></span>

<h3>Description</h3>

<p>Choice of base R, ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ib_plot_base(he, comparison, wtp, bw, n, xlim)

ib_plot_ggplot(he, comparison, wtp, bw, n, xlim)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ib_plot_base_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ib_plot_base_+3A_comparison">comparison</code></td>
<td>
<p>Comparison intervention</p>
</td></tr>
<tr><td><code id="ib_plot_base_+3A_wtp">wtp</code></td>
<td>
<p>Willingness to pay</p>
</td></tr>
<tr><td><code id="ib_plot_base_+3A_bw">bw</code></td>
<td>
<p>band width</p>
</td></tr>
<tr><td><code id="ib_plot_base_+3A_n">n</code></td>
<td>
<p>Number</p>
</td></tr>
<tr><td><code id="ib_plot_base_+3A_xlim">xlim</code></td>
<td>
<p>x-axis limits</p>
</td></tr>
</table>

<hr>
<h2 id='ib.plot.bcea'>Incremental Benefit (IB) Distribution Plot</h2><span id='topic+ib.plot.bcea'></span><span id='topic+ib.plot'></span>

<h3>Description</h3>

<p>Plots the distribution of the Incremental Benefit (IB) for a given value of
the willingness to pay threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
ib.plot(
  he,
  comparison = NULL,
  wtp = 25000,
  bw = "bcv",
  n = 512,
  xlim = NULL,
  graph = c("base", "ggplot2"),
  ...
)

ib.plot(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ib.plot.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_comparison">comparison</code></td>
<td>
<p>In the case of multiple interventions, specifies the one
to be used in comparison with the reference. Default value of <code>NULL</code>
forces R to consider the first non-reference intervention as the comparator.
Controls which comparator is used when more than 2 interventions are present</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay threshold. Default value at
<code>25000</code>.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_bw">bw</code></td>
<td>
<p>Identifies the smoothing bandwidth used to construct the kernel
estimation of the IB density.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_n">n</code></td>
<td>
<p>The number of equally spaced points at which the density is to be
estimated.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_xlim">xlim</code></td>
<td>
<p>The limits of the plot on the x-axis.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-) match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="ib.plot.bcea_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>ib</code></td>
<td>
<p> A ggplot object containing the requested plot. Returned
only if <code>graph="ggplot2"</code>. </p>
</td></tr></table>
<p> The function produces a plot of the
distribution of the Incremental Benefit for a given value of the willingness
to pay parameter. The dashed area indicates the positive part of the
distribution (i.e. when the reference is more cost-effective than the
comparator).
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Vaccine")
he &lt;- BCEA::bcea(eff, cost)
ib.plot(he)

</code></pre>

<hr>
<h2 id='info_rank_graph'>Info Rank Plot By Graph Device</h2><span id='topic+info_rank_graph'></span><span id='topic+info_rank_base'></span><span id='topic+info_rank_ggplot'></span><span id='topic+info_rank_plotly'></span>

<h3>Description</h3>

<p>Choice of base R, <span class="pkg">ggplot2</span> and <span class="pkg">plotly</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>info_rank_base(he, params)

info_rank_ggplot(he, params)

info_rank_plotly(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="info_rank_graph_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="info_rank_graph_+3A_params">params</code></td>
<td>
<p>Graph Parameters including data</p>
</td></tr>
</table>

<hr>
<h2 id='info.rank.bcea'>Information-Rank Plot for bcea Class</h2><span id='topic+info.rank.bcea'></span><span id='topic+info.rank'></span>

<h3>Description</h3>

<p>Produces a plot similar to a tornado plot, but based on the analysis of the
EVPPI. For each parameter and value of the willingness-to-pay threshold, a
barchart is plotted to describe the ratio of EVPPI (specific to that
parameter) to EVPI. This represents the relative &lsquo;importance&rsquo; of each
parameter in terms of the expected value of information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
info.rank(
  he,
  inp,
  wtp = NULL,
  howManyPars = NA,
  graph = c("base", "ggplot2", "plotly"),
  rel = TRUE,
  ...
)

info.rank(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="info.rank.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_inp">inp</code></td>
<td>
<p>Named list from running <code>createInputs()</code> containing:
</p>

<ul>
<li> <p><code>parameter</code> = A vector of parameters for which the individual EVPPI
should be calculated. This can be given as a string (or vector of strings)
of names or a numeric vector, corresponding to the column numbers of
important parameters.
</p>
</li>
<li> <p><code>mat</code> = A matrix containing the simulations for all the parameters
monitored by the call to JAGS or BUGS. The matrix should have column names
matching the names of the parameters and the values in the vector parameter
should match at least one of those values.
</p>
</li></ul>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_wtp">wtp</code></td>
<td>
<p>A value of the wtp for which the analysis should be performed. If
not specified then the break-even point for the current model will be used.</p>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_howmanypars">howManyPars</code></td>
<td>
<p>Optional maximum number of parameters to be included in the bar plot.
Includes all parameters by default.</p>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for plotting.
Should (partial-)match one of the two options &quot;base&quot; or &quot;plotly&quot;. Default value is &quot;base&quot;</p>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_rel">rel</code></td>
<td>
<p>Logical argument that specifies whether the ratio of
EVPPI to EVPI (<code>rel = TRUE</code>, default) or the absolute value of the EVPPI
should be used for the analysis.</p>
</td></tr>
<tr><td><code id="info.rank.bcea_+3A_...">...</code></td>
<td>
<p>Additional options. These include graphical parameters that the
user can specify:
</p>

<ul>
<li> <p><code>xlim</code> = limits of the x-axis; ca = font size for the axis
label (default = 0.7 of full size).
</p>
</li>
<li> <p><code>cn</code> = font size for the parameter names
vector (default = 0.7 of full size) - base graphics only.
</p>
</li>
<li> <p><code>mai</code> = margins of the graph (default = c(1.36, 1.5, 1,1)) - base graphics only.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>With base graphics: A data.frame containing the ranking of the parameters
with the value of the selected summary, for the chosen wtp; with plotly: a plotly object,
incorporating in the $rank element the data.frame as above.
The function produces a 'Info-rank' plot. This is an extension of standard 'Tornado
plots' and presents a ranking of the model parameters in terms of their
impact on the expected value of information. For each parameter, the
specific individual EVPPI is computed and used to measure the impact of
uncertainty in that parameter over the decision-making process, in terms of
how large the expected value of gaining more information is.
</p>


<h3>Author(s)</h3>

<p>Anna Heath, Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+evppi">evppi()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load the post-processed results of the MCMC simulation model
# original JAGS output is can be downloaded from here
# https://gianluca.statistica.it/book/bcea/code/vaccine.RData

data("Vaccine")
m &lt;- bcea(eff, cost)
inp &lt;- createInputs(vaccine_mat)
info.rank(m, inp)

info.rank(m, inp, graph = "base")
info.rank(m, inp, graph = "plotly")
info.rank(m, inp, graph = "ggplot2")

## End(Not run)

</code></pre>

<hr>
<h2 id='inforank_params'>Prepare Info Rank plot parameters</h2><span id='topic+inforank_params'></span>

<h3>Description</h3>

<p>Prepare Info Rank plot parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inforank_params(he, inp, wtp = NULL, rel, howManyPars, extra_args)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inforank_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="inforank_params_+3A_inp">inp</code></td>
<td>
<p>Inputs</p>
</td></tr>
<tr><td><code id="inforank_params_+3A_wtp">wtp</code></td>
<td>
<p>Willingness to pay</p>
</td></tr>
<tr><td><code id="inforank_params_+3A_rel">rel</code></td>
<td>
<p>Relative size</p>
</td></tr>
<tr><td><code id="inforank_params_+3A_howmanypars">howManyPars</code></td>
<td>
<p>How mnay parameters to use?</p>
</td></tr>
<tr><td><code id="inforank_params_+3A_extra_args">extra_args</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='is.bcea'>Check bcea Class</h2><span id='topic+is.bcea'></span>

<h3>Description</h3>

<p>Check bcea Class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.bcea(he)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.bcea_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>is.bcea</code> returns TRUE or FALSE depending on whether its argument
is a bcea class object.
</p>

<hr>
<h2 id='is.rel'>Reports whether x is a rel object
Copied from ggplot2</h2><span id='topic+is.rel'></span>

<h3>Description</h3>

<p>Reports whether x is a rel object
Copied from ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.rel(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.rel_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>

<hr>
<h2 id='kstar_vlines'>Prepare K-star vertical lines</h2><span id='topic+kstar_vlines'></span>

<h3>Description</h3>

<p>Prepare K-star vertical lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kstar_vlines(he, plot_params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kstar_vlines_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="kstar_vlines_+3A_plot_params">plot_params</code></td>
<td>
<p>Plots parameters</p>
</td></tr>
</table>

<hr>
<h2 id='line_labels'>Create Labels for Plot</h2><span id='topic+line_labels'></span><span id='topic+line_labels.default'></span><span id='topic+line_labels.pairwise'></span>

<h3>Description</h3>

<p>Create Labels for Plot
</p>
<p>Swapped labels so that reference is second
</p>


<h3>Usage</h3>

<pre><code class='language-R'>line_labels(he, ...)

## Default S3 method:
line_labels(he, ref_first = TRUE, ...)

## S3 method for class 'pairwise'
line_labels(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="line_labels_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="line_labels_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>

<hr>
<h2 id='loo_rank'>Leave-one-out ranking</h2><span id='topic+loo_rank'></span>

<h3>Description</h3>

<p>Leave-one-out ranking
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loo_rank(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loo_rank_+3A_params">params</code></td>
<td>
<p>Parameters</p>
</td></tr>
</table>

<hr>
<h2 id='make_legend_plotly'>Legend Positioning</h2><span id='topic+make_legend_plotly'></span>

<h3>Description</h3>

<p>Legend Positioning
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_legend_plotly(pos_legend)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_legend_plotly_+3A_pos_legend">pos_legend</code></td>
<td>
<p>Position of legend</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String
</p>

<hr>
<h2 id='make.report'>Make Report</h2><span id='topic+make.report'></span>

<h3>Description</h3>

<p>Constructs the automated report from the output of the BCEA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make.report(he, evppi = NULL, ext = "pdf", echo = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make.report_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="make.report_+3A_evppi">evppi</code></td>
<td>
<p>An object obtained as output to a call to <code>evppi</code>
(default is NULL, so not essential to producing the report).</p>
</td></tr>
<tr><td><code id="make.report_+3A_ext">ext</code></td>
<td>
<p>A string of text to indicate the extension of the
resulting output file. Possible options are <code>"pdf"</code>, <code>"docx"</code>.
This requires the use of pandoc, knitr and rmarkdown.</p>
</td></tr>
<tr><td><code id="make.report_+3A_echo">echo</code></td>
<td>
<p>A string (default to <code>FALSE</code>) to instruct whether
the report should also include the <code>BCEA</code> commands used to
produce the analyses. If the optional argument <code>echo</code> is set
to <code>TRUE</code> (default = <code>FALSE</code>), then the commands are also
printed.</p>
</td></tr>
<tr><td><code id="make.report_+3A_...">...</code></td>
<td>
<p>Additional parameters. For example, the user can specify the
value of the willingness to pay <code>wtp</code>, which is used in some of
the resulting analyses (default at the break even point).
Another additional parameter that the user can specify is the name
of the file to which the report should be written. This can be done
by simply passing the optional argument <code>filename="NAME"</code>.
The user can also specify an object including the PSA simulations
for all the relevant model parameters. If this is passed to the
function (in the object <code>psa_sims</code>),
then <code>make.report</code> will automatically construct an &quot;Info-rank
plot&quot;, which is a probabilistic form of tornado plot, based on the
Expected Value of Partial Information.  The user can also specify
the optional argument <code>show.tab</code> (default=FALSE); if set to
<code>TRUE</code>, then a table with the values of the Info-rank is also
shown.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
  data(Vaccine, package = "BCEA")
  m &lt;- bcea(eff, cost, ref = 2)
  make.report(m)

## End(Not run)

</code></pre>

<hr>
<h2 id='mce.plot'>Plots the probability that each intervention is the most cost-effective</h2><span id='topic+mce.plot'></span>

<h3>Description</h3>

<p>This function is deprecated. Use <code><a href="#topic+ceac.plot">ceac.plot()</a></code> instead.
Plots the probability that each of the n_int interventions being analysed is
the most cost-effective.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mce.plot(mce, pos = c(1, 0.5), graph = c("base", "ggplot2"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mce.plot_+3A_mce">mce</code></td>
<td>
<p>The output of the call to the function <code><a href="#topic+multi.ce">multi.ce()</a></code>.</p>
</td></tr>
<tr><td><code id="mce.plot_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend. Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>TRUE</code>
indicating to use the first standard and <code>FALSE</code> to use the second one.
Default value is <code>c(1,0.5)</code>, that is on the right inside the plot area.</p>
</td></tr>
<tr><td><code id="mce.plot_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="mce.plot_+3A_...">...</code></td>
<td>
<p>Optional arguments. For example, it is possible to specify the
colours to be used in the plot. This is done in a vector
<code>color=c(...)</code>. The length of the vector colors needs to be the same as
the number of comparators included in the analysis, otherwise <code>BCEA</code>
will fall back to the default values (all black, or shades of grey)</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>mceplot</code></td>
<td>
<p> A ggplot object containing the plot. Returned only
if <code>graph="ggplot2"</code>. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BCEA-deprecated">BCEA-deprecated()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

## Not run: 
# Load the processed results of the MCMC simulation model
data(Vaccine)
# 
# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
      plot=FALSE            # inhibits graphical output
)
#
mce &lt;- multi.ce(m)          # uses the results of the economic analysis 
#
mce.plot(mce,               # plots the probability of being most cost-effective
      graph="base")         #  using base graphics
#
if(require(ggplot2)){
mce.plot(mce,               # the same plot
      graph="ggplot2")      #  using ggplot2 instead
}

## End(Not run)

</code></pre>

<hr>
<h2 id='mixedAn+26lt+3B-'>Cost-Effectiveness Analysis When Multiple (Possibly Non-Cost-Effective)
Interventions are Present on the Market</h2><span id='topic+mixedAn+3C-'></span><span id='topic+mixedAn'></span><span id='topic+mixedAn.default'></span>

<h3>Description</h3>

<p>Runs the cost-effectiveness analysis, but accounts for the fact that more
than one intervention is present on the market.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixedAn(he) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mixedAn+2B26lt+2B3B-_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="mixedAn+2B26lt+2B3B-_+3A_value">value</code></td>
<td>
<p>A vector of market shares associated with the interventions.
Its size is the same as the number of possible comparators.
By default, assumes uniform distribution for each intervention.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Creates an object in the class <code>mixedAn</code>, a subclass of <code>bcea</code>
which contains the results of the health economic evaluation in the mixed analysis case:
</p>
<table role = "presentation">
<tr><td><code>Ubar</code></td>
<td>
<p>An array with the simulations of the &rdquo;known-distribution&rdquo;
mixed utilities, for each value of the discrete grid approximation of the
willingness to pay parameter</p>
</td></tr>
<tr><td><code>OL.star</code></td>
<td>
<p>An array with the simulations of the distribution of the
Opportunity Loss for the mixed strategy, for each value of the discrete grid
approximation of the willingness to pay parameter</p>
</td></tr>
<tr><td><code>evi.star</code></td>
<td>
<p>The Expected Value of Information for the mixed strategy,
for each value of the discrete grid approximation of the willingness to pay
parameter</p>
</td></tr>
<tr><td><code>mkt.shares</code></td>
<td>
<p>The vector of market shares associated with each available
intervention</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Russo P (2009).
&ldquo;A decision-theoretic framework for the application of cost-effectiveness analysis in regulatory processes.&rdquo;
<em>Pharmacoeconomics</em>, <b>27</b>(8), 5&ndash;16.
ISSN 20356137, <a href="https://doi.org/10.1007/bf03320526">doi:10.1007/bf03320526</a>.
</p>
<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e, c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0, Kmax)
      plot=FALSE)           # inhibits graphical output

mixedAn(m) &lt;- NULL      # uses the results of the mixed strategy 
                        #  analysis (a "mixedAn" object)
                        # the vector of market shares can be defined 
                        #  externally. If NULL, then each of the T 
                        #  interventions will have 1/T market share
                        # produces the plots
evi.plot(m)

</code></pre>

<hr>
<h2 id='multi.ce'>Cost-effectiveness Analysis With Multiple Comparison</h2><span id='topic+multi.ce'></span><span id='topic+multi.ce.bcea'></span>

<h3>Description</h3>

<p>Computes and plots the probability that each of the <code>n_int</code> interventions
being analysed is the most cost-effective and the cost-effectiveness
acceptability frontier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
multi.ce(he)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi.ce_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Original <code>bcea</code> object (list) of class &quot;pairwise&quot; with additional:
</p>
<table role = "presentation">
<tr><td><code>p_best_interv</code></td>
<td>
<p>A matrix including the probability that each
intervention is the most cost-effective for all values of the willingness to
pay parameter</p>
</td></tr>
<tr><td><code>ceaf</code></td>
<td>
<p>A vector containing the cost-effectiveness acceptability frontier</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceaf.plot">ceaf.plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)
 
# Runs the health economic evaluation using BCEA

m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
      plot=FALSE            # inhibits graphical output
)

mce &lt;- multi.ce(m)          # uses the results of the economic analysis

ceac.plot(mce)
ceaf.plot(mce)

</code></pre>

<hr>
<h2 id='multiplot'>Plot Multiple bcea Graphs</h2><span id='topic+multiplot'></span>

<h3>Description</h3>

<p>Arrange plots in grid. Sourced from R graphics cookbook.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiplot(plotlist = NULL, cols = 1, layout_config = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiplot_+3A_plotlist">plotlist</code></td>
<td>
<p>List of ggplot objects</p>
</td></tr>
<tr><td><code id="multiplot_+3A_cols">cols</code></td>
<td>
<p>Number of columns</p>
</td></tr>
<tr><td><code id="multiplot_+3A_layout_config">layout_config</code></td>
<td>
<p>Matrix of plot configuration</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot TableGrob object
</p>

<hr>
<h2 id='new_bcea'>Constructor for bcea</h2><span id='topic+new_bcea'></span>

<h3>Description</h3>

<p>Constructor for bcea
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_bcea(df_ce, k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="new_bcea_+3A_df_ce">df_ce</code></td>
<td>
<p>Dataframe of all simulation eff and cost</p>
</td></tr>
<tr><td><code id="new_bcea_+3A_k">k</code></td>
<td>
<p>Vector of willingness to pay values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object of class bcea.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>

<hr>
<h2 id='num_lines'>Get number of lines</h2><span id='topic+num_lines'></span><span id='topic+num_lines.pairwise'></span><span id='topic+num_lines.bcea'></span><span id='topic+num_lines.evppi'></span><span id='topic+num_lines.default'></span>

<h3>Description</h3>

<p>Get number of lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>num_lines(dat)

## S3 method for class 'pairwise'
num_lines(dat)

## S3 method for class 'bcea'
num_lines(dat)

## S3 method for class 'evppi'
num_lines(dat)

## Default S3 method:
num_lines(dat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="num_lines_+3A_dat">dat</code></td>
<td>
<p>Data</p>
</td></tr>
</table>

<hr>
<h2 id='openPDF'>Automatically open pdf output using default pdf viewer</h2><span id='topic+openPDF'></span>

<h3>Description</h3>

<p>Automatically open pdf output using default pdf viewer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openPDF(file_name)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="openPDF_+3A_file_name">file_name</code></td>
<td>
<p>String file names for pdf</p>
</td></tr>
</table>

<hr>
<h2 id='plot_eib_cri'>Plot Credible Intervals</h2><span id='topic+plot_eib_cri'></span>

<h3>Description</h3>

<p>Bayesian posterior credible intervals against willingness to pay.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_eib_cri(he, params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_eib_cri_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="plot_eib_cri_+3A_params">params</code></td>
<td>
<p>Graph parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plot.bcea'>Summary Plot of the Health Economic Analysis</h2><span id='topic+plot.bcea'></span>

<h3>Description</h3>

<p>Plots in a single graph the Cost-Effectiveness plane, the Expected
Incremental Benefit, the CEAC and the EVPI.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
plot(
  x,
  comparison = NULL,
  wtp = 25000,
  pos = FALSE,
  graph = c("base", "ggplot2"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.bcea_+3A_x">x</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="plot.bcea_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison=2</code>).</p>
</td></tr>
<tr><td><code id="plot.bcea_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay parameter. It is passed to
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.bcea_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="plot.bcea_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="plot.bcea_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the methods <code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>
and <code><a href="#topic+eib.plot">eib.plot()</a></code>. Please see the manual pages for the individual
functions.  Arguments like <code>size</code>, <code>ICER.size</code> and <code>plot.cri</code>
can be supplied to the functions in this way. In addition if
<code>graph="ggplot2"</code> and the arguments are named theme objects they will
be added to each plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default position of the legend for the cost-effectiveness plane
(produced by <code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>) is set to <code>c(1, 1.025)</code>
overriding its default for <code>pos=FALSE</code>, since multiple ggplot2 plots
are rendered in a slightly different way than single plots.
</p>


<h3>Value</h3>

<p>A plot with four graphical summaries of the health economic evaluation.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+ceplane.plot">ceplane.plot()</a></code>,
<code><a href="#topic+eib.plot">eib.plot()</a></code>,
<code><a href="#topic+ceac.plot">ceac.plot()</a></code>,
<code><a href="#topic+evi.plot">evi.plot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
he &lt;- bcea(
       e=eff, c=cost,        # defines the variables of 
                             #  effectiveness and cost
       ref=2,                # selects the 2nd row of (e,c) 
                             #  as containing the reference intervention
       interventions=treats, # defines the labels to be associated 
                             #  with each intervention
       Kmax=50000,           # maximum value possible for the willingness 
                             #  to pay threshold; implies that k is chosen 
                             #  in a grid from the interval (0,Kmax)
       plot=FALSE            # does not produce graphical outputs
      )

# Plots the summary plots for the "bcea" object m using base graphics
plot(he, graph = "base")

# Plots the same summary plots using ggplot2
if(require(ggplot2)){
plot(he, graph = "ggplot2")

# Example of a customized plot.bcea with ggplot2
plot(he,
  graph = "ggplot2",          # use ggplot2
  ICER_size = 1.5,            # extra options modifies the mean point size
  text = list(size=rel(1.25)) # modifies the text size
  )                                                       
}

</code></pre>

<hr>
<h2 id='plot.CEriskav'>Plots EIB and EVPI for the Risk Aversion Case</h2><span id='topic+plot.CEriskav'></span>

<h3>Description</h3>

<p>Summary plot of the health economic analysis when risk aversion is included.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CEriskav'
plot(x, pos = c(0, 1), graph = c("base", "ggplot2"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.CEriskav_+3A_x">x</code></td>
<td>
<p>An object of the class <code>CEriskav</code>, a subclass of <code>bcea</code>,
containing the results of the economic analysis performed accounting for a
risk aversion parameter (obtained as output of the function <code><a href="#topic+CEriskav">CEriskav()</a></code>).</p>
</td></tr>
<tr><td><code id="plot.CEriskav_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="plot.CEriskav_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-)match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="plot.CEriskav_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters
(see <code><a href="graphics.html#topic+par">par()</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the Expected Incremental Benefit and the Expected Value of Perfect Information
when risk aversion is included in the utility function.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>list(eib</code>, <code>evi)</code></td>
<td>
<p>A two-elements named list of the ggplot objects
containing the requested plots. Returned only if <code>graph="ggplot2"</code>.</p>
</td></tr>
</table>
<p>The function produces two plots for the risk aversion analysis. The first
one is the EIB as a function of the discrete grid approximation of the
willingness parameter for each of the possible values of the risk aversion
parameter, <code>r</code>. The second one is a similar plot for the EVPI.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>, <code><a href="#topic+CEriskav">CEriskav()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem
#
# Load the processed results of the MCMC simulation model
data(Vaccine)
# 
# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000,           # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
      plot=FALSE            # inhibits graphical output
)
#
# Define the vector of values for the risk aversion parameter, r, eg:
r &lt;- c(1e-10, 0.005, 0.020, 0.035) 
#
# Run the cost-effectiveness analysis accounting for risk aversion

   CEriskav(m) &lt;- r

#
# produce the plots

   plot(m)

## Alternative options, using ggplot2

   plot(m, graph = "ggplot2")


</code></pre>

<hr>
<h2 id='plot.evppi'>Plot Expected Value of Partial Information With Respect to a
Set of Parameters</h2><span id='topic+plot.evppi'></span>

<h3>Description</h3>

<p>Plot Expected Value of Partial Information With Respect to a
Set of Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'evppi'
plot(x, pos = c(0, 0.8), graph = c("base", "ggplot2"), col = c(1, 1), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.evppi_+3A_x">x</code></td>
<td>
<p>An object in the class <code>evppi</code>,
obtained by the call to the function <code><a href="#topic+evppi">evppi()</a></code>.</p>
</td></tr>
<tr><td><code id="plot.evppi_+3A_pos">pos</code></td>
<td>
<p>Parameter to set the position of the legend (only relevant for
multiple interventions, ie more than 2 interventions being compared).
Can be given in form
of a string <code>(bottom|top)(right|left)</code> for base graphics and
<code>bottom|top|left|right</code> for ggplot2. It can be a two-elements vector,
which specifies the relative position on the x and y axis respectively, or
alternatively it can be in form of a logical variable, with <code>FALSE</code>
indicating to use the default position and <code>TRUE</code> to place it on the
bottom of the plot.</p>
</td></tr>
<tr><td><code id="plot.evppi_+3A_graph">graph</code></td>
<td>
<p>A string used to select the graphical engine to use for
plotting. Should (partial-) match the two options <code>"base"</code> or
<code>"ggplot2"</code>. Default value is <code>"base"</code>.</p>
</td></tr>
<tr><td><code id="plot.evppi_+3A_col">col</code></td>
<td>
<p>Sets the colour for the lines depicted in the graph.</p>
</td></tr>
<tr><td><code id="plot.evppi_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to methods, such as graphical parameters
(see <code><a href="graphics.html#topic+par">par()</a></code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot with base R or <span class="pkg">ggplot2</span>.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio, Andrea Berardi
</p>


<h3>References</h3>

<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>, <code><a href="#topic+evppi">evppi()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
data(Vaccine, package = "BCEA")
treats &lt;- c("Status quo", "Vaccination")

# Run the health economic evaluation using BCEA
m &lt;- bcea(e.pts, c.pts, ref = 2, interventions = treats)

# Compute the EVPPI for a bunch of parameters
inp &lt;- createInputs(vaccine_mat)

# Compute the EVPPI using INLA/SPDE
if (require("INLA")) {
  x0 &lt;- BCEA::evppi(m, c("beta.1." , "beta.2."), input = inp$mat)
  
  plot(x0, pos = c(0,1))

  x1 &lt;- BCEA::evppi(m, c(32,48,49), input = inp$mat)
  plot(x1, pos = "topright")

  plot(x0, col = c("black", "red"), pos = "topright")
  plot(x0, col = c(2,3), pos = "bottomright")

  plot(x0, pos = c(0,1), graph = "ggplot2")
  plot(x1, pos = "top", graph = "ggplot2")

  plot(x0, col = c("black", "red"), pos = "right", graph = "ggplot2")
  plot(x0, col = c(2,3), size = c(1,2), pos = "bottom", graph = "ggplot2")

  plot(x0, graph = "ggplot2", theme = ggplot2::theme_linedraw())
}

if (FALSE)
 plot(x0, col = 3, pos = "topright")
# The vector 'col' must have the number of elements for an EVPI
# colour and each of the EVPPI parameters. Forced to black

## End(Not run)

</code></pre>

<hr>
<h2 id='prep_ceplane_params'>Prepare CE-plane Parameters</h2><span id='topic+prep_ceplane_params'></span>

<h3>Description</h3>

<p>In ggplot format, combine user-supplied
parameters with defaults.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_ceplane_params(he, wtp_params, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_ceplane_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="prep_ceplane_params_+3A_wtp_params">wtp_params</code></td>
<td>
<p>Willingness-to-pay parameters. This can be a single value or a list.</p>
</td></tr>
<tr><td><code id="prep_ceplane_params_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List pf graph parameters
</p>

<hr>
<h2 id='prep_contour_params'>Prepare contour plot parameters
Additional to ceplane parameters</h2><span id='topic+prep_contour_params'></span>

<h3>Description</h3>

<p>Prepare contour plot parameters
Additional to ceplane parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_contour_params(he, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_contour_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="prep_contour_params_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parameters
</p>

<hr>
<h2 id='prep_eib_params'>Prepare EIB plot parameters</h2><span id='topic+prep_eib_params'></span>

<h3>Description</h3>

<p>Parameters general to all plotting devices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_eib_params(he, plot.cri, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_eib_params_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="prep_eib_params_+3A_plot.cri">plot.cri</code></td>
<td>
<p>Make title including credible interval? Logical</p>
</td></tr>
<tr><td><code id="prep_eib_params_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of graph parameters
</p>

<hr>
<h2 id='prep_frontier_data'>Prepare frontier data</h2><span id='topic+prep_frontier_data'></span>

<h3>Description</h3>

<p>Prepare frontier data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prep_frontier_data(he, threshold = NULL, start.origin = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prep_frontier_data_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="prep_frontier_data_+3A_threshold">threshold</code></td>
<td>
<p>Cost-effectiveness threshold i.e angle of line. Must be &gt;=0 or NULL.</p>
</td></tr>
<tr><td><code id="prep_frontier_data_+3A_start.origin">start.origin</code></td>
<td>
<p>Where should the frontier start from?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with scatter.data, ceef.points, orig.avg
</p>


<h3>See Also</h3>

<p>ceef.plot
</p>

<hr>
<h2 id='print.bcea'>bcea Print Method</h2><span id='topic+print.bcea'></span>

<h3>Description</h3>

<p>bcea Print Method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
print(x, digits = getOption("digits"), give.attr = FALSE, no.list = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.bcea_+3A_x">x</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="print.bcea_+3A_digits">digits</code></td>
<td>
<p>Minimal number of significant digits, see <code><a href="base.html#topic+print.default">print.default()</a></code>.</p>
</td></tr>
<tr><td><code id="print.bcea_+3A_give.attr">give.attr</code></td>
<td>
<p>Logical; if TRUE (default), show attributes as sub structures.</p>
</td></tr>
<tr><td><code id="print.bcea_+3A_no.list">no.list</code></td>
<td>
<p>Logical; if TRUE, no list of ... nor the class are printed.</p>
</td></tr>
<tr><td><code id="print.bcea_+3A_...">...</code></td>
<td>
<p>Potential further arguments.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("Vaccine")
he &lt;- BCEA::bcea(eff, cost)

</code></pre>

<hr>
<h2 id='quadrant_params'>Quadrant Parameters
requires just a single comparison group</h2><span id='topic+quadrant_params'></span>

<h3>Description</h3>

<p>Quadrant Parameters
requires just a single comparison group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quadrant_params(he, params)
</code></pre>

<hr>
<h2 id='quiet'>Allow disabling of the cat messages</h2><span id='topic+quiet'></span>

<h3>Description</h3>

<p>Allow disabling of the cat messages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quiet(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quiet_+3A_x">x</code></td>
<td>
<p>Object to quietly return</p>
</td></tr>
</table>

<hr>
<h2 id='select_plot_type'>Choose Graphical Engine</h2><span id='topic+select_plot_type'></span>

<h3>Description</h3>

<p>From base R, ggplot2 or plotly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_plot_type(graph)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="select_plot_type_+3A_graph">graph</code></td>
<td>
<p>Type names; string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot ID integer 1:base R; 2:ggplot2; 3:plotly
</p>

<hr>
<h2 id='setComparisons'>Set Comparisons Group</h2><span id='topic+setComparisons'></span>

<h3>Description</h3>

<p>One of the alternative way to set (e,c) comparison group.
Simply recompute all comparisons and drop unwanted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setComparisons(he, comparison)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setComparisons_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="setComparisons_+3A_comparison">comparison</code></td>
<td>
<p>Selects the comparator, in case of more than two
interventions being analysed. Default as NULL plots all the comparisons
together. Any subset of the possible comparisons can be selected (e.g.,
<code>comparison=c(1,3)</code> or <code>comparison=2</code>).</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+setComparisons+3C-">setComparisons&lt;-()</a></code>
</p>

<hr>
<h2 id='setComparisons_assign'>Set Comparison Group</h2><span id='topic+setComparisons_assign'></span><span id='topic+setComparisons+3C-'></span><span id='topic+setComparisons+3C-.bcea'></span><span id='topic+setComparisons+3C-.default'></span>

<h3>Description</h3>

<p>One of the alternative way to set (e,c) comparison group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setComparisons(he) &lt;- value

## S3 replacement method for class 'bcea'
setComparisons(he) &lt;- value

## Default S3 replacement method:
setComparisons(he) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setComparisons_assign_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="setComparisons_assign_+3A_value">value</code></td>
<td>
<p>Comparison</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bcea-type object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setComparisons">setComparisons()</a></code>
</p>

<hr>
<h2 id='setKmax_assign'>Set Maximum Willingness to Pay</h2><span id='topic+setKmax_assign'></span><span id='topic+setKmax+3C-'></span><span id='topic+setKmax+3C-.bcea'></span><span id='topic+setKmax+3C-.default'></span>

<h3>Description</h3>

<p>Alternative way to define <code>K</code> statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setKmax(he) &lt;- value

## S3 replacement method for class 'bcea'
setKmax(he) &lt;- value

## Default S3 replacement method:
setKmax(he) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setKmax_assign_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="setKmax_assign_+3A_value">value</code></td>
<td>
<p>Maximum willingness to pay</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bcea-type object
</p>

<hr>
<h2 id='setReferenceGroup_assign'>Set Reference Group</h2><span id='topic+setReferenceGroup_assign'></span><span id='topic+setReferenceGroup+3C-'></span><span id='topic+setReferenceGroup+3C-.bcea'></span><span id='topic+setReferenceGroup+3C-.default'></span>

<h3>Description</h3>

<p>Alternative way to define (e,c) reference group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setReferenceGroup(he) &lt;- value

## S3 replacement method for class 'bcea'
setReferenceGroup(he) &lt;- value

## Default S3 replacement method:
setReferenceGroup(he) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setReferenceGroup_assign_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="setReferenceGroup_assign_+3A_value">value</code></td>
<td>
<p>Reference group number</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bcea-type object
</p>

<hr>
<h2 id='sim_table'>Table of Simulation Statistics for the Health Economic Model</h2><span id='topic+sim_table'></span><span id='topic+sim_table.bcea'></span>

<h3>Description</h3>

<p>Using the input in the form of MCMC simulations and after having run the
health economic model, produces a summary table of the simulations from the
cost-effectiveness analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_table(he, ...)

## S3 method for class 'bcea'
sim_table(he, wtp = 25000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_table_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="sim_table_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="sim_table_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay threshold to be used in the
summary table.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces the following elements:
</p>
<table role = "presentation">
<tr><td><code>table</code></td>
<td>
<p>A table with simulation statistics from the economic model</p>
</td></tr>
<tr><td><code>names.cols</code></td>
<td>
<p>A vector of labels to be associated with each column of the table</p>
</td></tr>
<tr><td><code>wtp</code></td>
<td>
<p>The selected value of the willingness to pay</p>
</td></tr>
<tr><td><code>idx_wtp</code></td>
<td>
<p>The index associated with the selected value of the willingness
to pay threshold in the grid used to run the analysis</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff,                # defines the variables of 
          c=cost,               # effectiveness and cost
          ref=2,                # selects the 2nd row of (e, c) 
                                # as containing the reference intervention
          interventions=treats, # defines the labels to be associated 
                                # with each intervention
          Kmax=50000)           # maximum value possible for the willingness 
                                # to pay threshold; implies that k is chosen 
                                # in a grid from the interval (0, Kmax)

# Now can save the simulation exercise in an object using sim_table()
sim_table(m,         # uses the results of the economic evaluation 
          wtp=25000) # selects the particular value for k
               
</code></pre>

<hr>
<h2 id='Smoking'>Data set for the Bayesian model for the cost-effectiveness of smoking
cessation interventions</h2><span id='topic+Smoking'></span><span id='topic+cost'></span><span id='topic+data'></span><span id='topic+eff'></span><span id='topic+life.years'></span><span id='topic+pi_post'></span><span id='topic+smoking'></span><span id='topic+smoking_output'></span><span id='topic+treats'></span>

<h3>Description</h3>

<p>This data set contains the results of the Bayesian analysis used to model
the clinical output and the costs associated with the health economic
evaluation of four different smoking cessation interventions.
</p>


<h3>Format</h3>

<p>A data list including the variables needed for the smoking cessation
cost-effectiveness analysis. The variables are as follows:
</p>

<dl>
<dt>list(&quot;cost&quot;)</dt><dd><p>a matrix of 500 simulations from the posterior distribution
of the overall costs associated with the four strategies</p>
</dd>
<dt>list(&quot;data&quot;)</dt><dd><p>a dataset containing the characteristics of the smokers
in the UK population</p>
</dd>
<dt>list(&quot;eff&quot;)</dt><dd><p>a matrix of 500 simulations from the
posterior distribution of the clinical benefits associated with the four
strategies</p>
</dd>
<dt>list(&quot;life.years&quot;)</dt><dd><p>a matrix of 500 simulations from the
posterior distribution of the life years gained with each strategy</p>
</dd>
<dt>list(&quot;pi_post&quot;)</dt><dd><p>a matrix of 500 simulations from the posterior
distribution of the event of smoking cessation with each strategy</p>
</dd>
<dt>list(&quot;smoking&quot;)</dt><dd><p>a data frame containing the inputs needed for the
network meta-analysis model. The <code>data.frame</code> object contains:
<code>nobs</code>: the record ID number, <code>s</code>: the study ID number, <code>i</code>:
the intervention ID number, <code>r_i</code>: the number of patients who quit
smoking, <code>n_i</code>: the total number of patients for the row-specific arm
and <code>b_i</code>: the reference intervention for each study</p>
</dd>
<dt>list(&quot;smoking_mat&quot;)</dt><dd><p>a matrix obtained by running the network
meta-analysis model based on the data contained in the <code>smoking</code> object</p>
</dd>
<dt>list(&quot;treats&quot;)</dt><dd><p>a vector of labels associated with the four strategies</p>
</dd>
</dl>



<h3>Source</h3>

<p>Effectiveness data adapted from Hasselblad V. (1998). Meta-analysis
of Multitreatment Studies. Medical Decision Making 1998;18:37-43.
Cost and population characteristics data adapted from various sources:
</p>

<ul>
<li><p> Taylor, D.H. Jr, et al. (2002). Benefits of smoking
cessation on longevity. American Journal of Public Health 2002;92(6)
</p>
</li>
<li><p> ASH: Action on Smoking and Health (2013). ASH fact sheet on smoking
statistics, <br /> <code style="white-space: pre;">&#8288;https://ash.org.uk/files/documents/ASH_106.pdf&#8288;</code>
</p>
</li>
<li><p> Flack, S., et al. (2007). Cost-effectiveness of interventions for smoking
cessation. York Health Economics Consortium, January 2007
</p>
</li>
<li><p> McGhan, W.F.D., and Smith, M. (1996). Pharmacoeconomic analysis of
smoking-cessation interventions. American Journal of Health-System Pharmacy
1996;53:45-52</p>
</li></ul>



<h3>References</h3>

<p>Baio G. (2012). Bayesian Methods in Health Economics. CRC/Chapman Hall, London
</p>

<hr>
<h2 id='struct.psa'>Structural Probability Sensitivity Analysis</h2><span id='topic+struct.psa'></span>

<h3>Description</h3>

<p>Computes the weights to be associated with a set of competing models in
order to perform structural PSA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>struct.psa(
  models,
  effect,
  cost,
  ref = NULL,
  interventions = NULL,
  Kmax = 50000,
  plot = FALSE,
  w = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="struct.psa_+3A_models">models</code></td>
<td>
<p>A list containing the output from either R2jags or
R2WinBUGS for all the models that need to be combined in the model average</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_effect">effect</code></td>
<td>
<p>A list containing the measure of effectiveness computed from
the various models (one matrix with n.sim x n.ints simulations for each
model)</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_cost">cost</code></td>
<td>
<p>A list containing the measure of costs computed from the various
models (one matrix with n.sim x n.ints simulations for each model)</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_ref">ref</code></td>
<td>
<p>Which intervention is considered to be the reference
strategy. The default value <code>ref=1</code> means that the intervention
appearing first is the reference and the other(s) is(are) the comparator(s)</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_interventions">interventions</code></td>
<td>
<p>Defines the labels to be associated with each
intervention. By default and if <code>NULL</code>, assigns labels in the form
&quot;Intervention1&quot;, ... , &quot;InterventionT&quot;</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_kmax">Kmax</code></td>
<td>
<p>Maximum value of the willingness to pay to be considered.
Default value is <code>50000</code>. The willingness to pay is then approximated
on a discrete grid in the interval <code style="white-space: pre;">&#8288;[0, Kmax]&#8288;</code>. The grid is equal to
<code>k</code> if the parameter is given, or composed of <code>501</code> elements if
<code>k=NULL</code> (the default)</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether the function should produce
the summary plot or not</p>
</td></tr>
<tr><td><code id="struct.psa_+3A_w">w</code></td>
<td>
<p>A vector of weights. By default it's NULL to indicate that the
function will calculate the model weights based on DIC and the individual
model fit. This behaviour can be overridden by passing a vector <code>w</code>,
for instance based on expert opinion</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The model is a list containing the output from either R2jags or
R2WinBUGS for all the models that need to be combined in the model average
effect is a list containing the measure of effectiveness computed from the
various models (one matrix with n_sim x n_ints simulations for each model)
cost is a list containing the measure of costs computed from the various
models (one matrix with n_sim x n_ints simulations for each model).
</p>


<h3>Value</h3>

<p>List object of bcea object, model weights and DIC
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# load sample jags output
load(system.file("extdata", "statins_base.RData", package = "BCEA"))
load(system.file("extdata", "statins_HC.RData", package = "BCEA"))

interventions &lt;- c("Atorvastatin", "Fluvastatin",
                   "Lovastatin", "Pravastatin",
                   "Rosuvastatin", "Simvastatin")

m1 &lt;- bcea(eff = statins_base$sims.list$effect,
           cost = statins_base$sims.list$cost.tot,
           ref = 1, interventions = interventions)

m2 &lt;- bcea(eff = statins_HC$sims.list$effect,
           cost = statins_HC$sims.list$cost.tot,
           ref = 1, interventions = interventions)

models &lt;- list(statins_base, statins_HC)

effects &lt;- list(statins_base$sims.list$effect,
                statins_HC$sims.list$effect)
costs &lt;- list(statins_base$sims.list$cost.tot,
              statins_HC$sims.list$cost.tot)

m3 &lt;- struct.psa(models, effects, costs,
                 ref = 1, interventions = interventions)

## End(Not run)

</code></pre>

<hr>
<h2 id='summary.bcea'>Summary Method for Objects of Class <code>bcea</code></h2><span id='topic+summary.bcea'></span>

<h3>Description</h3>

<p>Produces a table printout with some summary results of the health economic
evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bcea'
summary(object, wtp = 25000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bcea_+3A_object">object</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="summary.bcea_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay threshold used in the summary table.</p>
</td></tr>
<tr><td><code id="summary.bcea_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a summary table with some information on the health economic
output and synthetic information on the economic measures (EIB, CEAC, EVPI).
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)

he &lt;- bcea(eff, cost, interventions = treats, ref = 2)
summary(he)

</code></pre>

<hr>
<h2 id='summary.mixedAn'>Summary Methods For Objects in the Class <code>mixedAn</code> (Mixed Analysis)</h2><span id='topic+summary.mixedAn'></span>

<h3>Description</h3>

<p>Prints a summary table for the results of the mixed analysis for the
economic evaluation of a given model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mixedAn'
summary(object, wtp = 25000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mixedAn_+3A_object">object</code></td>
<td>
<p>An object of the class <code>mixedAn</code>, which is the results of
the function <code><a href="#topic+mixedAn">mixedAn()</a></code>, generating the economic evaluation of a
set of interventions, considering given market shares for each option.</p>
</td></tr>
<tr><td><code id="summary.mixedAn_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay chosen to present the analysis.</p>
</td></tr>
<tr><td><code id="summary.mixedAn_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a table with summary information on the loss in expected
value of information generated by the inclusion of non cost-effective
interventions in the market.
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Russo P (2009).
&ldquo;A decision-theoretic framework for the application of cost-effectiveness analysis in regulatory processes.&rdquo;
<em>Pharmacoeconomics</em>, <b>27</b>(8), 5&ndash;16.
ISSN 20356137, <a href="https://doi.org/10.1007/bf03320526">doi:10.1007/bf03320526</a>.
</p>
<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code>,
<code><a href="#topic+mixedAn">mixedAn()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# See Baio G., Dawid A.P. (2011) for a detailed description of the 
# Bayesian model and economic problem

# Load the processed results of the MCMC simulation model
data(Vaccine)

# Runs the health economic evaluation using BCEA
m &lt;- bcea(e=eff, c=cost,    # defines the variables of 
                            #  effectiveness and cost
      ref=2,                # selects the 2nd row of (e,c) 
                            #  as containing the reference intervention
      interventions=treats, # defines the labels to be associated 
                            #  with each intervention
      Kmax=50000            # maximum value possible for the willingness 
                            #  to pay threshold; implies that k is chosen 
                            #  in a grid from the interval (0,Kmax)
)

mixedAn(m) &lt;- NULL      # uses the results of the mixed strategy 
                        #  analysis (a "mixedAn" object)
                        # the vector of market shares can be defined 
                        #  externally. If NULL, then each of the T 
                        #  interventions will have 1/T market share

# Prints a summary of the results
summary(m,         # uses the results of the mixed strategy analysis 
        wtp=25000) #  (a "mixedAn" object)
                   # selects the relevant willingness to pay 
                   #  (default: 25,000)

</code></pre>

<hr>
<h2 id='summary.pairwise'>Summary Method for Objects of Class <code>pairwise</code></h2><span id='topic+summary.pairwise'></span>

<h3>Description</h3>

<p>Produces a table printout with some summary results of the health economic
evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pairwise'
summary(object, wtp = 25000, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.pairwise_+3A_object">object</code></td>
<td>
<p>A <code>pairwise</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="summary.pairwise_+3A_wtp">wtp</code></td>
<td>
<p>The value of the willingness to pay threshold used in the
summary table.</p>
</td></tr>
<tr><td><code id="summary.pairwise_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints a summary table with some information on the health economic
output and synthetic information on the economic measures (EIB, CEAC, EVPI).
</p>


<h3>Author(s)</h3>

<p>Gianluca Baio
</p>


<h3>References</h3>

<p>Baio G, Dawid aP (2011).
&ldquo;Probabilistic sensitivity analysis in health economics.&rdquo;
<em>Stat. Methods Med. Res.</em>, 1&ndash;20.
ISSN 1477-0334, <a href="https://doi.org/10.1177/0962280211419832">doi:10.1177/0962280211419832</a>, <a href="https://pubmed.ncbi.nlm.nih.gov/21930515/">https://pubmed.ncbi.nlm.nih.gov/21930515/</a>.
</p>
<p>Baio G (2013).
<em>Bayesian Methods in Health Economics</em>.
CRC.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bcea">bcea()</a></code> <code><a href="#topic+multi.ce">multi.ce()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vaccine)
he &lt;- bcea(eff, cost, interventions = treats, ref = 2)
he_multi &lt;- multi.ce(he)
summary(he_multi)

</code></pre>

<hr>
<h2 id='tabulate_means'>Calculate Dataset For ICERs From bcea Object</h2><span id='topic+tabulate_means'></span>

<h3>Description</h3>

<p>Calculate Dataset For ICERs From bcea Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tabulate_means(he, comp_label = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tabulate_means_+3A_he">he</code></td>
<td>
<p>A <code>bcea</code> object containing the results of the Bayesian
modelling and the economic evaluation.</p>
</td></tr>
<tr><td><code id="tabulate_means_+3A_comp_label">comp_label</code></td>
<td>
<p>Optional vector of strings with comparison labels</p>
</td></tr>
<tr><td><code id="tabulate_means_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame object including mean outcomes, comparison identifier,
comparison label and associated ICER
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("Smoking")
he &lt;- BCEA::bcea(eff, cost)
tabulate_means(he)

</code></pre>

<hr>
<h2 id='theme_bcea'>bcea theme ggplot2</h2><span id='topic+theme_bcea'></span><span id='topic+theme_default'></span><span id='topic+theme_ceac'></span><span id='topic+theme_ceplane'></span><span id='topic+theme_eib'></span><span id='topic+theme_contour'></span>

<h3>Description</h3>

<p>bcea theme ggplot2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_default()

theme_ceac()

theme_ceplane()

theme_eib()

theme_contour()
</code></pre>

<hr>
<h2 id='Vaccine'>Data set for the Bayesian model for the cost-effectiveness of influenza
vaccination</h2><span id='topic+Vaccine'></span><span id='topic+c.pts'></span><span id='topic+cost.GP'></span><span id='topic+cost.hosp'></span><span id='topic+cost.otc'></span><span id='topic+cost.time.off'></span><span id='topic+cost.time.vac'></span><span id='topic+cost.travel'></span><span id='topic+cost.trt1'></span><span id='topic+cost.trt2'></span><span id='topic+cost.vac'></span><span id='topic+e.pts'></span><span id='topic+N'></span><span id='topic+N.outcomes'></span><span id='topic+N.resources'></span><span id='topic+QALYs.adv'></span><span id='topic+QALYs.death'></span><span id='topic+QALYs.hosp'></span><span id='topic+QALYs.inf'></span><span id='topic+QALYs.pne'></span><span id='topic+vaccine'></span><span id='topic+vaccine_mat'></span>

<h3>Description</h3>

<p>This data set contains the results of the Bayesian analysis used to model
the clinical output and the costs associated with an influenza vaccination.
</p>


<h3>Format</h3>

<p>A data list including the variables needed for the influenza
vaccination. The variables are as follows:
</p>

<dl>
<dt>list(&quot;cost&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the overall costs associated with the two treatments</p>
</dd>
<dt>list(&quot;c.pts&quot;)</dt><dd></dd>
<dt>list(&quot;cost.GP&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for GP visits associated with the two treatments</p>
</dd>
<dt>list(&quot;cost.hosp&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for hospitalisations associated with the two
treatments</p>
</dd>
<dt>list(&quot;cost.otc&quot;)</dt><dd><p>a matrix of simulations from the posterior distribution
of the costs for over-the-counter medications associated with the two treatments</p>
</dd>
<dt>list(&quot;cost.time.off&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for time off work associated with the two treatments</p>
</dd>
<dt>list(&quot;cost.time.vac&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for time needed to get the vaccination associated
with the two treatments</p>
</dd>
<dt>list(&quot;cost.travel&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for travel to get vaccination associated with the
two treatments</p>
</dd>
<dt>list(&quot;cost.trt1&quot;)</dt><dd><p>a matrix of simulations from the
posterior distribution of the overall costs for first line of treatment
associated with the two interventions</p>
</dd>
<dt>list(&quot;cost.trt2&quot;)</dt><dd><p>a matrix of simulations from the posterior distribution
of the overall costs for second line of treatment associated with the two
interventions</p>
</dd>
<dt>list(&quot;cost.vac&quot;)</dt><dd><p>a matrix of simulations from the posterior
distribution of the costs for vaccination</p>
</dd>
<dt>list(&quot;eff&quot;)</dt><dd><p>a matrix of simulations from the posterior distribution of
the clinical benefits associated with the two treatments</p>
</dd>
<dt>list(&quot;e.pts&quot;)</dt><dd></dd>
<dt>list(&quot;N&quot;)</dt><dd><p>the number of subjects in the reference population</p>
</dd>
<dt>list(&quot;N.outcomes&quot;)</dt><dd><p>the number of clinical outcomes analysed</p>
</dd>
<dt>list(&quot;N.resources&quot;)</dt><dd><p>the number of health-care resources under study</p>
</dd>
<dt>list(&quot;QALYs.adv&quot;)</dt><dd><p>a vector from the posterior distribution of the
QALYs associated with advert events</p>
</dd>
<dt>list(&quot;QALYs.death&quot;)</dt><dd><p>a vector from the posterior distribution of the
QALYs associated with death</p>
</dd>
<dt>list(&quot;QALYs.hosp&quot;)</dt><dd><p>a vector from the posterior distribution of the
QALYs associated with hospitalisation</p>
</dd>
<dt>list(&quot;QALYs.inf&quot;)</dt><dd><p>a vector from the posterior distribution of the
QALYs associated with influenza infection</p>
</dd>
<dt>list(&quot;QALYs.pne&quot;)</dt><dd><p>a vector from the posterior distribution of the
QALYs associated with pneumonia</p>
</dd>
<dt>list(&quot;treats&quot;)</dt><dd><p>a vector of labels associated with the two treatments</p>
</dd>
<dt>list(&quot;vaccine_mat&quot;)</dt><dd><p>a matrix containing the simulations for the
parameters used in the original model</p>
</dd>
</dl>



<h3>Source</h3>

<p>Adapted from Turner D, Wailoo A, Cooper N, Sutton A, Abrams K,
Nicholson K. The cost-effectiveness of influenza vaccination of healthy
adults 50-64 years of age. Vaccine. 2006;24:1035-1043.
</p>


<h3>References</h3>

<p>Baio, G., Dawid, A. P. (2011). Probabilistic Sensitivity
Analysis in Health Economics. Statistical Methods in Medical Research
doi:10.1177/0962280211419832.
</p>

<hr>
<h2 id='validate_bcea'>Validate bcea</h2><span id='topic+validate_bcea'></span>

<h3>Description</h3>

<p>Validate bcea
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_bcea(eff, cost, ref, interventions)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_bcea_+3A_eff">eff</code></td>
<td>
<p>Effectiveness matrix</p>
</td></tr>
<tr><td><code id="validate_bcea_+3A_cost">cost</code></td>
<td>
<p>Cost matrix</p>
</td></tr>
<tr><td><code id="validate_bcea_+3A_ref">ref</code></td>
<td>
<p>Reference intervention</p>
</td></tr>
<tr><td><code id="validate_bcea_+3A_interventions">interventions</code></td>
<td>
<p>All interventions</p>
</td></tr>
</table>

<hr>
<h2 id='validate_eib_params'>Validate EIB parameters</h2><span id='topic+validate_eib_params'></span>

<h3>Description</h3>

<p>Validate EIB parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_eib_params(params)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="validate_eib_params_+3A_params">params</code></td>
<td>
<p>Graph parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of graph parameters
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prep_eib_params">prep_eib_params()</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
