<!DOCTYPE html><html><head><title>Help for package PoisNonNor</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PoisNonNor}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PoisNonNor-package'>
<p>Simultaneous generation of count and continuous data with Poisson and continuous marginals</p></a></li>
<li><a href='#bounds.corr.GSC.NN'>
<p>Computes the approximate lower and upper bounds of the correlation matrix entries for the continuous pairs</p></a></li>
<li><a href='#bounds.corr.GSC.NNP'>
<p>Computes the approximate lower and upper bounds of the correlation matrix entries for the continuous-count pairs</p></a></li>
<li><a href='#bounds.corr.GSC.PP'>
<p>Computes the approximate lower and upper bounds of the correlation matrix entries for the count pairs</p></a></li>
<li><a href='#fleishman.roots'>
<p>An auxiliary function that is called by Param.fleishman function</p></a></li>
<li><a href='#intercor.all'>
<p>Computes the intermediate correlation matrix</p></a></li>
<li><a href='#intercor.NN'>
<p>Computes the subset of the intermediate correlation matrix that is pertinent to the continuous pairs</p></a></li>
<li><a href='#intercor.NNP'>
<p>Computes the subset of the intermediate correlation matrix that is pertinent to the count-continuous pairs</p></a></li>
<li><a href='#intercor.PP'>
<p>Computes the subset of the intermediate correlation matrix that is pertinent to the count pairs</p></a></li>
<li><a href='#Param.fleishman'>
<p>Calculates the Fleishman coefficients</p></a></li>
<li><a href='#RNG.P.NN'>
<p>Simultaneously generates count and continuous data</p></a></li>
<li><a href='#Validate.correlation'>
<p>Checks the validity of the specified correlation matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simultaneous Generation of Count and Continuous Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Hakan Demirtas, Yaru Shi, Rawan Allozi, Ran Gao</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ran Gao &lt;rgao8@uic.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generation of count (assuming Poisson distribution) and continuous data (using Fleishman polynomials) simultaneously. The details of the method are explained in Demirtas et al. (2012) &lt;<a href="https://doi.org/10.1002%2Fsim.5362">doi:10.1002/sim.5362</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>BB, corpcor, MASS, Matrix</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-21 22:22:21 UTC; rangao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-21 22:50:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='PoisNonNor-package'>
Simultaneous generation of count and continuous data with Poisson and continuous marginals
</h2><span id='topic+PoisNonNor-package'></span><span id='topic+PoisNonNor'></span>

<h3>Description</h3>

<p>A package for simulating multivariate data with count and continuous variables with a pre-specified correlation matrix and marginal distributions. The count variables are assumed to have Poisson distribution, and continuous variables can take any shape that is allowed by the Fleishman polynomials. This mixed data generation scheme is a combination of the normal to anything principle for the count part, and multivariate continuous data generation mechanism via the Fleishman polynomials.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PoisNonNor</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.6.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-03-21</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>This package consists of eleven functions. 
</p>
<p>The functions <code><a href="#topic+bounds.corr.GSC.NN">bounds.corr.GSC.NN</a></code>, <code><a href="#topic+bounds.corr.GSC.NNP">bounds.corr.GSC.NNP</a></code>, and <code><a href="#topic+bounds.corr.GSC.PP">bounds.corr.GSC.PP</a></code> return the lower and upper bounds of the pairwise correlation of continuous-continuous, continuous-count, and count-count pairs, respectively. The function <code><a href="#topic+Validate.correlation">Validate.correlation</a></code> validates the specified quantities to avoid obvious correlation matrix specification errors in regarding to the correlation matrix. The functions <code><a href="#topic+intercor.NN">intercor.NN</a></code>, <code><a href="#topic+intercor.NNP">intercor.NNP</a></code>, and <code><a href="#topic+intercor.PP">intercor.PP</a></code> give the intermediate normal correlation matrix for continuous-continuous, continuous-count, and count-count combinations, respectively. The function <code><a href="#topic+intercor.all">intercor.all</a></code> returns the final intermediate correlation matrix by combining the three parts of correlation together. The function <code><a href="#topic+Param.fleishman">Param.fleishman</a></code> calculates the Fleishman coefficient. The engine function <code><a href="#topic+RNG.P.NN">RNG.P.NN</a></code> generates mixed data in accordance with the specified marginal and correlation matrix. 
</p>
<p>n1, n2, and n=n1+n2 stand for the number of count, continuous, and the total number of the variables, respectively. By design, the first n1 variables are count, and the last n2 variables are continuous in the generated data matrix.
</p>


<h3>Author(s)</h3>

<p>Hakan Demirtas, Yaru Shi, Rawan Allozi, Ran Gao
</p>
<p>Maintainer: Ran Gao &lt;rgao8@uic.edu&gt;
</p>


<h3>References</h3>

<p>Amatya, A. and Demirtas, H. (2017). PoisNor: An R package for generation of multivariate data with Poisson and normal marginals. Communications in Statistics&ndash;Simulation and Computation, 46(3), 2241-2253.
</p>
<p>Demirtas, H., Hedeker, D. and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.  
</p>
<p>Fleishman A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>
<p>Vale, C.D. and Maurelli, V.A. (1983). Simulating multivariate nonnormal distributions. Psychometrika, 48(3), 465-471. 
</p>

<hr>
<h2 id='bounds.corr.GSC.NN'>
Computes the approximate lower and upper bounds of the correlation matrix entries for the continuous pairs
</h2><span id='topic+bounds.corr.GSC.NN'></span>

<h3>Description</h3>

<p>This function calculates the approximate lower and upper bounds for all continuous pairs by the method in Demirtas and Hedeker (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bounds.corr.GSC.NN(pmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bounds.corr.GSC.NN_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate correlation bounds are computed via the 'Generate, Sort, and Correlate' (GSC) technique, proposed by Demirtas and Hedeker (2011).
</p>


<h3>Value</h3>

<p>Returns a list with two components
</p>
<table>
<tr><td><code>min</code></td>
<td>
<p>lower correlation bound matrix</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>upper correlation bound matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bounds.corr.GSC.NNP">bounds.corr.GSC.NNP</a></code>, <code><a href="#topic+bounds.corr.GSC.PP">bounds.corr.GSC.PP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
   0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)

bounds.corr.GSC.NN (pmat) 

## End(Not run)
</code></pre>

<hr>
<h2 id='bounds.corr.GSC.NNP'>
Computes the approximate lower and upper bounds of the correlation matrix entries for the continuous-count pairs
</h2><span id='topic+bounds.corr.GSC.NNP'></span>

<h3>Description</h3>

<p>This function calculates the approximate lower and upper bounds for all continuous-count pairs by the method in Demirtas and Hedeker (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bounds.corr.GSC.NNP(lamvec, pmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bounds.corr.GSC.NNP_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1.
</p>
</td></tr>
<tr><td><code id="bounds.corr.GSC.NNP_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate correlation bounds are computed via the 'Generate, Sort, and Correlate' (GSC) technique, proposed by Demirtas and Hedeker (2011).
</p>


<h3>Value</h3>

<p>Returns a list with two components, both are matrices of size n1xn2 where n1 and n2 are the number of count and continuous variables, respectively.
</p>
<table>
<tr><td><code>min</code></td>
<td>
<p>lower correlation bound matrix</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>upper correlation bound matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bounds.corr.GSC.NN">bounds.corr.GSC.NN</a></code>, <code><a href="#topic+bounds.corr.GSC.PP">bounds.corr.GSC.PP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
   0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)

lamvec = c(0.5,0.7,0.9)

bounds.corr.GSC.NNP(lamvec,pmat) 

## End(Not run)
</code></pre>

<hr>
<h2 id='bounds.corr.GSC.PP'>
Computes the approximate lower and upper bounds of the correlation matrix entries for the count pairs
</h2><span id='topic+bounds.corr.GSC.PP'></span>

<h3>Description</h3>

<p>This function calculates the approximate lower and upper bounds for all count pairs by the method in Demirtas and Hedeker (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bounds.corr.GSC.PP(lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bounds.corr.GSC.PP_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approximate correlation bounds are computed via the 'Generate, Sort, and Correlate' (GSC) technique, proposed by Demirtas and Hedeker (2011).
</p>


<h3>Value</h3>

<p>Returns a list with two components, both are matrices of size n1xn1. 
</p>
<table>
<tr><td><code>min</code></td>
<td>
<p>lower correlation bound matrix</p>
</td></tr>
<tr><td><code>max</code></td>
<td>
<p>upper correlation bound matrix</p>
</td></tr>
</table>


<h3>References</h3>

<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2), 104-109.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bounds.corr.GSC.NNP">bounds.corr.GSC.NNP</a></code>, <code><a href="#topic+bounds.corr.GSC.PP">bounds.corr.GSC.PP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lamvec = c(0.5,0.7,0.9)

bounds.corr.GSC.PP(lamvec) 

## End(Not run)
</code></pre>

<hr>
<h2 id='fleishman.roots'>
An auxiliary function that is called by Param.fleishman function
</h2><span id='topic+fleishman.roots'></span>

<h3>Description</h3>

<p>This function sets up formulae that are needed at the subsequent stages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fleishman.roots(p, r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fleishman.roots_+3A_p">p</code></td>
<td>

<p>a vector of length three that contains the Fleishman coefficients.
</p>
</td></tr>
<tr><td><code id="fleishman.roots_+3A_r">r</code></td>
<td>

<p>a vector of length two that contains skewness and kurtosis values. 
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Fleishman A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Param.fleishman">Param.fleishman</a></code>
</p>

<hr>
<h2 id='intercor.all'>
Computes the intermediate correlation matrix</h2><span id='topic+intercor.all'></span>

<h3>Description</h3>

<p>This function computes the intermediate correlation matrix of the multivariate normal distribution that provides a basis for subsequent tranformations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intercor.all(cmat, pmat, lamvec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intercor.all_+3A_cmat">cmat</code></td>
<td>

<p>a (n1+n2)x(n1+n2) matrix of specified correlations.
</p>
</td></tr>
<tr><td><code id="intercor.all_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system.
</p>
</td></tr>
<tr><td><code id="intercor.all_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assembles all three submatrices that are pertinent to all continuous-continuous, count-count, and count-continuous pairs. 
</p>


<h3>Value</h3>

<p>Returns an intermediate matrix of size (n1+n2)x(n1+n2).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+intercor.NN">intercor.NN</a></code>,  <code><a href="#topic+intercor.NNP">intercor.NNP</a></code>,  <code><a href="#topic+intercor.PP">intercor.PP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
   0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)

lamvec = c(0.5,0.7,0.9)

cmat = matrix(c(
  1.000,  0.352,  0.265, 0.342,  0.090, 0.141,
  0.352,  1.000,  0.121, 0.297, -0.022, 0.177,
  0.265,  0.121,  1.000, 0.294, -0.044, 0.129,
  0.342,  0.297,  0.294, 1.000,  0.100, 0.354,
  0.090, -0.022, -0.044, 0.100,  1.000, 0.386,
  0.141,  0.177,  0.129, 0.354,  0.386, 1.000), nrow=6, byrow=TRUE)

intercor.all(cmat,pmat,lamvec)

## End(Not run)
</code></pre>

<hr>
<h2 id='intercor.NN'>
Computes the subset of the intermediate correlation matrix that is pertinent to the continuous pairs
</h2><span id='topic+intercor.NN'></span>

<h3>Description</h3>

<p>This function computes the submatrix of the intermediate correlation matrix of the multivariate normal distribution. It is relevant to the continuous part of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intercor.NN(pmat, cmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intercor.NN_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system.
</p>
</td></tr>
<tr><td><code id="intercor.NN_+3A_cmat">cmat</code></td>
<td>

<p>a n2xn2 matrix of specified correlations for the continuous part.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fleishman polynomials is a method to generate real-life non-normal distributions of variables by using their first four moments. It is based on the polynomial transformation, <code class="reqn">Y = a + bZ + cZ^2 + dZ^3</code>, where Z follows a standard normal distribution and Y is standardized (zero mean and unit variance).
</p>
<p>Normal-Normal correlation for a given continuous pair can be calculated by solving the following equation.
</p>
<p><code class="reqn">r_{Y_1Y_2} = r_{Z_1Z_2}(b_1b_2+3b_1d_2+3d_1b_2+9d_1d_2) + r_{Z_1Z_2}^2(2c_1c_2)+r_{Z_1Z_2}^3(6d_1d_2)</code>
</p>


<h3>Value</h3>

<p>Returns an intermediate matrix of size n2xn2
</p>


<h3>References</h3>

<p>Yahav, I. and Shmueli, G. (2012). On generating multivariate poisson data in management science applications. Applied Stochastic Models in Business and Industry, 28(1), 91-102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
  0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)
cmat = matrix(c(
  1.000,  0.100, 0.354,
  0.100,  1.000, 0.386,
  0.354,  0.386, 1.000),nrow=3,byrow=TRUE)

intercor.NN(pmat,cmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='intercor.NNP'>
Computes the subset of the intermediate correlation matrix that is pertinent to the count-continuous pairs
</h2><span id='topic+intercor.NNP'></span>

<h3>Description</h3>

<p>This function computes the submatrix of the intermediate correlation matrix of the multivariate normal distribution. It is relevant to the count-continuous part of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intercor.NNP(lamvec, cmat, pmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intercor.NNP_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1.
</p>
</td></tr>
<tr><td><code id="intercor.NNP_+3A_cmat">cmat</code></td>
<td>

<p>a (n1+n2)x(n1+n2) matrix of specified correlations.
</p>
</td></tr>
<tr><td><code id="intercor.NNP_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculations are done by combining the methods described in Demirtas, Hedeker and Mermelstein (2012) and Amatya and Demirtas (2017).
</p>


<h3>Value</h3>

<p>Returns an intermediate correlation matrix of size n1 x n2
</p>


<h3>References</h3>

<p>Amatya, A. and Demirtas, H. (2017). PoisNor: An R package for generation of multivariate data with Poisson and normal marginals. Communications in Statistics&ndash;Simulation and Computation, 46(3), 2241-2253.
</p>
<p>Demirtas, H., Hedeker, D. and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
   0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)

lamvec = c(0.5,0.7,0.9)

cmat = matrix(c(
  0.342,  0.090, 0.141,
  0.297, -0.022, 0.177,
 0.294, -0.044, 0.129), nrow=3, byrow=TRUE)

intercor.NNP(lamvec, cmat, pmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='intercor.PP'>
Computes the subset of the intermediate correlation matrix that is pertinent to the count pairs
</h2><span id='topic+intercor.PP'></span>

<h3>Description</h3>

<p>This function computes the submatrix of the intermediate correlation matrix of the multivariate normal distribution. It is relevant to the count part of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intercor.PP(lamvec, cmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intercor.PP_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1.
</p>
</td></tr>
<tr><td><code id="intercor.PP_+3A_cmat">cmat</code></td>
<td>

<p>a n1xn1 matrix of specified correlations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculations are done by combining the methods described in Yahav and Shumeli (2012) and Amatya and Demirtas (2017). 
</p>


<h3>Value</h3>

<p>Returns an intermediate matrix of size n1xn1.
</p>


<h3>References</h3>

<p>Amatya, A. and Demirtas, H. (2017). PoisNor: An R package for generation of multivariate data with Poisson and normal marginals. Communications in Statistics&ndash;Simulation and Computation, 46(3), 2241-2253.
</p>
<p>Yahav, I. and Shmueli, G. (2012). On generating multivariate poisson data in management science applications. Applied Stochastic Models in Business and Industry, 28(1), 91-102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lamvec = c(0.5,0.7,0.9)
cmat = matrix(c(
  1.000,  0.352,  0.265, 
  0.352,  1.000,  0.121, 
  0.265,  0.121,  1.000), nrow=3, byrow=TRUE)
intercor.PP(lamvec, cmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='Param.fleishman'>
Calculates the Fleishman coefficients
</h2><span id='topic+Param.fleishman'></span>

<h3>Description</h3>

<p>This function calculates the four coefficients in the Fleishman system given skewness and kurtosis values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Param.fleishman(rmat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Param.fleishman_+3A_rmat">rmat</code></td>
<td>

<p>a n2x2 matrix that includes skewness and kurtosis values for each continuous variable, where the first and second columns represent skewness and kurtosis, respectively. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix of size n2x4 where rows and columns represent variables and coefficients, respectively. 
</p>


<h3>References</h3>

<p>Fleishman A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
rmat = matrix(c(-0.5486,-0.2103, 0.3386, 0.9035, 1.0283, 0.9272), byrow=TRUE, ncol=2)
Param.fleishman(rmat)

## End(Not run)
</code></pre>

<hr>
<h2 id='RNG.P.NN'>
Simultaneously generates count and continuous data
</h2><span id='topic+RNG.P.NN'></span><span id='topic+RNG_P_NN'></span>

<h3>Description</h3>

<p>This function simulates count and continuous data, where the count part is assumed to follow a multivariate Poisson distribution and the continuous part can take any shape allowed by the Fleishman polynomials. A correlation matrix and marginal features (rate parameter for the count variables, and skewness and kurtosis parameters for the continuous variables must be supplied by users).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RNG.P.NN(lamvec, cmat, rmat, norow, mean.vec, variance.vec) 
RNG_P_NN(lamvec, cmat, rmat, norow, mean.vec, variance.vec) #Deprecated
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RNG.P.NN_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1
</p>
</td></tr>
<tr><td><code id="RNG.P.NN_+3A_cmat">cmat</code></td>
<td>

<p>specified correlation matrix 
</p>
</td></tr>
<tr><td><code id="RNG.P.NN_+3A_rmat">rmat</code></td>
<td>

<p>a n2x2 matrix that includes skewness and kurtosis values for each continuous variable
</p>
</td></tr>
<tr><td><code id="RNG.P.NN_+3A_norow">norow</code></td>
<td>

<p>number of rows in the multivariate mixed data
</p>
</td></tr>
<tr><td><code id="RNG.P.NN_+3A_mean.vec">mean.vec</code></td>
<td>

<p>mean vector for continuous variables of length n2
</p>
</td></tr>
<tr><td><code id="RNG.P.NN_+3A_variance.vec">variance.vec</code></td>
<td>

<p>variance vector for continuous variables of length n2
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data matrix of size norowx(n1+n2). By design, the first n1 variables are count, and the last n2 variables are continuous. 
</p>


<h3>References</h3>

<p>Amatya, A. and Demirtas, H. (2017). PoisNor: An R package for generation of multivariate data with Poisson and normal marginals. Communications in Statistics&ndash;Simulation and Computation, 46(3), 2241-2253.
</p>
<p>Demirtas, H. and Hedeker, D. (2011). A practical way for computing approximate lower and upper correlation bounds. The American Statistician, 65(2):104-109.
</p>
<p>Demirtas, H., Hedeker, D. and Mermelstein, R.J. (2012). Simulation of massive public health data by power polynomials. Statistics in Medicine, 31(27), 3337-3346.  
</p>
<p>Fleishman A.I. (1978). A method for simulating non-normal distributions. Psychometrika, 43(4), 521-532.
</p>
<p>Vale, C.D. and Maurelli, V.A. (1983). Simulating multivariate nonnormal distributions. Psychometrika, 48(3), 465-471. 
</p>
<p>Yahav, I. and Shmueli, G. (2012). On generating multivariate poisson data in management science applications. Applied Stochastic Models in Business and Industry, 28(1), 91-102.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
lamvec = c(0.5,0.7,0.9)

cmat = matrix(c(
  1.000,  0.352,  0.265, 0.342,  0.090, 0.141,
  0.352,  1.000,  0.121, 0.297, -0.022, 0.177,
  0.265,  0.121,  1.000, 0.294, -0.044, 0.129,
  0.342,  0.297,  0.294, 1.000,  0.100, 0.354,
  0.090, -0.022, -0.044, 0.100,  1.000, 0.386,
  0.141,  0.177,  0.129, 0.354,  0.386, 1.000), nrow=6, byrow=TRUE)

rmat = matrix(c(-0.5486,-0.2103, 0.3386, 0.9035, 1.0283, 0.9272), byrow=TRUE, ncol=2)

norow=10e+5

mean.vec=c(1,0.5,100)
variance.vec=c(1,0.02777778,1000)

P_NN_data = RNG.P.NN(lamvec, cmat, rmat, norow, mean.vec, variance.vec)

## End(Not run)
</code></pre>

<hr>
<h2 id='Validate.correlation'>
Checks the validity of the specified correlation matrix
</h2><span id='topic+Validate.correlation'></span>

<h3>Description</h3>

<p>The function checks the validity of pairwise correlations. Additionally, it checks positive definiteness, symmetry, and correctness of the dimensions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Validate.correlation(cmat, pmat = NULL, lamvec = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Validate.correlation_+3A_cmat">cmat</code></td>
<td>

<p>a nxn matrix of specified correlations for the n-variate distribution.
</p>
</td></tr>
<tr><td><code id="Validate.correlation_+3A_pmat">pmat</code></td>
<td>

<p>a n2x4 matrix where each row includes the four coefficients (a,b,c,d) of the Fleishman's system.
</p>
</td></tr>
<tr><td><code id="Validate.correlation_+3A_lamvec">lamvec</code></td>
<td>

<p>a vector of lambda values of length n1.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In addition to being positive definite and symmetric, the values of pairwise correlations in the target correlation matrix must also fall within the limits imposed by the marginal distributions in the system. The function ensures that the supplied correlation matrix is valid for simulation. If a violation occurs, an error message is displayed that identifies the violation. The function returns a logical value TRUE when no such violation occurs.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bounds.corr.GSC.PP">bounds.corr.GSC.PP</a></code>, <code><a href="#topic+bounds.corr.GSC.NN">bounds.corr.GSC.NN</a></code>, <code><a href="#topic+bounds.corr.GSC.NNP">bounds.corr.GSC.NNP</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pmat = matrix(c(
   0.1148643, 1.0899150, -0.1148643, -0.0356926,
  -0.0488138, 0.9203374,  0.0488138,  0.0251256,
  -0.2107427, 1.0398224,  0.2107427, -0.0293247), nrow=3, byrow=TRUE)

lamvec = c(0.5,0.7,0.9)

cmat = matrix(c(
  1.000,  0.352,  0.265, 0.342,  0.090, 0.141,
  0.352,  1.000,  0.121, 0.297, -0.022, 0.177,
  0.265,  0.121,  1.000, 0.294, -0.044, 0.129,
  0.342,  0.297,  0.294, 1.000,  0.100, 0.354,
  0.090, -0.022, -0.044, 0.100,  1.000, 0.386,
  0.141,  0.177,  0.129, 0.354,  0.386, 1.000), nrow=6, byrow=TRUE)

Validate.correlation (cmat,pmat,lamvec)

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
