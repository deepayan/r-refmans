<!DOCTYPE html><html lang="en"><head><title>Help for package FARDEEP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FARDEEP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alts'><p>Using the basic idea of least trimmed square to detect and remove outliers before estimating the coefficients.</p>
Adaptive least trimmed square.</a></li>
<li><a href='#fardeep'><p>Using the idea of least trimmed square to detect and remove outliers before estimating the coefficients.</p>
A robust method for gene-expression deconvolution.</a></li>
<li><a href='#LM22'><p>Siganature matrix</p></a></li>
<li><a href='#mixture'><p>Gene-expression data from 14 follicular lymphoma patients</p></a></li>
<li><a href='#sample.sim'><p>Generate random sample with different proportion of outliers and leverage points</p></a></li>
<li><a href='#tuningBIC'><p>Tuning parameter k in function alts using Bayesian Information Criterion (BIC) with some adjustment.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fast and Robust Deconvolution of Tumor Infiltrating Lymphocyte
from Expression Profiles using Least Trimmed Squares</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Using the idea of least trimmed square, it could automatically detects and removes outliers from data before estimating the coefficients. It is a robust machine learning tool which can be applied to gene-expression deconvolution technique. Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie (2019) &lt;<a href="https://doi.org/10.1101%2F358366">doi:10.1101/358366</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>nnls(&ge; 1.4), stats, preprocessCore</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-18 06:51:24 UTC; yuning</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuning Hao [aut],
  Ming Yan [aut],
  Blake R. Heath [aut],
  Yu L. Lei [aut],
  Yuying Xie [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuying Xie &lt;xyy@egr.msu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-24 15:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='alts'>Using the basic idea of least trimmed square to detect and remove outliers before estimating the coefficients.
Adaptive least trimmed square.</h2><span id='topic+alts'></span>

<h3>Description</h3>

<p>Using the basic idea of least trimmed square to detect and remove outliers before estimating the coefficients.
Adaptive least trimmed square.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alts(x, y, alpha1 = 0.1, alpha2 = 1.5, k = 6, nn = TRUE,
  intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alts_+3A_x">x</code></td>
<td>
<p>input matrix of predictors with n rows and p columns.</p>
</td></tr>
<tr><td><code id="alts_+3A_y">y</code></td>
<td>
<p>input vector of dependent variable with length n.</p>
</td></tr>
<tr><td><code id="alts_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter used to adjust the upper bound of outliers. Take value from 0 to 1, default 0.1.</p>
</td></tr>
<tr><td><code id="alts_+3A_alpha2">alpha2</code></td>
<td>
<p>parameter used to adjust the lower bound of outliers. Take value larger than 1, default 1.5.</p>
</td></tr>
<tr><td><code id="alts_+3A_k">k</code></td>
<td>
<p>parameter used to determine the boundary of outliers in the following step of algorithm. Take value from 1 to 10, default 6.</p>
</td></tr>
<tr><td><code id="alts_+3A_nn">nn</code></td>
<td>
<p>whether coefficients are non-negative,default TRUE.</p>
</td></tr>
<tr><td><code id="alts_+3A_intercept">intercept</code></td>
<td>
<p>whether intercept is included in model, default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>beta:  estimation of coefficients.
</p>
<p>number_outlier: number of outliers.
</p>
<p>outlier_detect:  index of detected outliers.
</p>
<p>X.new:  good observed points for independent variables.
</p>
<p>Y.new:  good observed points for dependent variables.
</p>
<p>k:  modified k (if the input value is not appropriate).
</p>


<h3>Author(s)</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie
</p>


<h3>References</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie. Fast and Robust Deconvolution of Tumor Infiltrating Lymphocyte from Expression Profiles using Least Trimmed Squares. &lt;doi:10.1101/358366&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FARDEEP)
samp = sample.sim(n = 500, p = 20, sig = 1, a1 = 0.1, a2 = 0.2, nn = TRUE, intercept = TRUE)
result = alts(samp$x, samp$y, alpha1 = 0.1, alpha2 = 1.5, k = 6, nn = TRUE, intercept = TRUE)
coef = result$beta
</code></pre>

<hr>
<h2 id='fardeep'>Using the idea of least trimmed square to detect and remove outliers before estimating the coefficients.
A robust method for gene-expression deconvolution.</h2><span id='topic+fardeep'></span>

<h3>Description</h3>

<p>Using the idea of least trimmed square to detect and remove outliers before estimating the coefficients.
A robust method for gene-expression deconvolution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fardeep(X, Y, alpha1 = 0.1, alpha2 = 1.5, up = 10, low = 1,
  nn = TRUE, intercept = TRUE, lognorm = TRUE, permn = 100,
  QN = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fardeep_+3A_x">X</code></td>
<td>
<p>input matrix of predictors with n rows and p columns.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_y">Y</code></td>
<td>
<p>input vector of dependent variable.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter used to adjust the upper bound of outliers. Take value from 0 to 1, default 0.1.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_alpha2">alpha2</code></td>
<td>
<p>parameter used to adjust the lower bound of outliers. Take value larger than 1, default 1.5.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_up">up</code></td>
<td>
<p>upper bound of parameter k in function alts, default 10.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_low">low</code></td>
<td>
<p>lower bound of parameter k in function alts, default 1.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_nn">nn</code></td>
<td>
<p>whether coefficients are non-negative,default TRUE.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_intercept">intercept</code></td>
<td>
<p>whether intercept is included in model, default TRUE.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_lognorm">lognorm</code></td>
<td>
<p>whether noise is log-normal distributed, default TRUE.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_permn">permn</code></td>
<td>
<p>the number of permutation to get the p-values, default TRUE.</p>
</td></tr>
<tr><td><code id="fardeep_+3A_qn">QN</code></td>
<td>
<p>whether perform quantile normalization, default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>abs.beta:  estimation of abosulute abundance of cells (TIL subset scores).
</p>
<p>relative.beta:  estimation of relative proportions by normalizing abs.beta to 1.
</p>
<p>pval:  statistical significance for the deconvolution result.
</p>
<p>k.value:  tuned paprameter by modified BIC.
</p>


<h3>Author(s)</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie
</p>


<h3>References</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie. Fast and Robust Deconvolution of Tumor Infiltrating Lymphocyte from Expression Profiles using Least Trimmed Squares. &lt;doi:10.1101/358366&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FARDEEP)
data(LM22)
data(mixture)
# toy examples
result = fardeep(LM22, mixture[, 1:2], permn = 0)

result = fardeep(LM22, mixture)
coef = result$abs.beta

</code></pre>

<hr>
<h2 id='LM22'>Siganature matrix</h2><span id='topic+LM22'></span>

<h3>Description</h3>

<p>A dataset containing 547 genes and 22 TILs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LM22
</code></pre>


<h3>Format</h3>

<p>A data frame with 547 rows and 22 variables:
</p>

<dl>
<dt>B.cells.naive</dt><dd><p>naive B cells</p>
</dd>
<dt>B.cells.memory</dt><dd><p>memory B cells</p>
</dd>
<dt>Plasma.cells</dt><dd><p>Plasma cells</p>
</dd>
<dt>T.cells.CD8</dt><dd><p>CD8 T cells</p>
</dd>
<dt>T.cells.CD4.naive</dt><dd><p>naive CD4 T cells</p>
</dd>
<dt>T.cells.CD4.memory.resting</dt><dd><p>resting memory CD4 T cells</p>
</dd>
<dt>T.cells.CD4.memory.activated</dt><dd><p>activated memory CD4 T cells</p>
</dd>
<dt>T.cells.follicular.helper</dt><dd><p>follicular helper T cells </p>
</dd>
<dt>T.cells.regulatory.Tregs.</dt><dd><p>regulatory T cells</p>
</dd>
<dt>T.cells.gamma.delta</dt><dd><p>gamma delta T cells</p>
</dd>
<dt>NK.cells.resting</dt><dd><p>resting natural killer cells</p>
</dd>
<dt>NK.cells.activated</dt><dd><p>activated natural killer cells</p>
</dd>
<dt>Monocytes</dt><dd><p>monocytes</p>
</dd>
<dt>Macrophages.M0</dt><dd><p>M0 macrophages</p>
</dd>
<dt>Macrophages.M1</dt><dd><p>M1 macrophages</p>
</dd>
<dt>Macrophages.M2</dt><dd><p>M2 macrophages</p>
</dd>
<dt>Dendritic.cells.resting</dt><dd><p>resting dendritic cells</p>
</dd>
<dt>Dendritic.cells.activated</dt><dd><p>activated dendritic cells</p>
</dd>
<dt>Mast.cells.resting</dt><dd><p>resting mast cells</p>
</dd>
<dt>Mast.cells.activated</dt><dd><p>activated mast cells</p>
</dd>
<dt>Eosinophils</dt><dd><p>eosinophils</p>
</dd>
<dt>Neutrophils</dt><dd><p>neutrophils</p>
</dd>
</dl>


<h3>References</h3>

<p>Aaron M. Newman, Chih Long Liu, Michael R. Green, Andrew J. Gentles, Weiguo Feng, Yue Xu, Chuong D. Hoang, Maximilian Diehn and Ash A. Alizadeh. Robust enumeration of cell subsets from tissue expression profiles.
</p>

<hr>
<h2 id='mixture'>Gene-expression data from 14 follicular lymphoma patients</h2><span id='topic+mixture'></span>

<h3>Description</h3>

<p>This gene-expression dataset consists of surgical lymph node biopsies of 14 
follicular lymphoma patients with 19416 genes. It is available on Gene 
Expression Omnibus (GEO) with accession number GSE65135.
<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65135">https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE65135</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mixture
</code></pre>


<h3>Format</h3>

<p>A data frame with 19416 rows and 14 variables:
</p>

<dl>
<dt>GSM1587831</dt><dd><p>FL lymph node biopsy, untreated, 1063</p>
</dd>
<dt>GSM1587832</dt><dd><p>FL lymph node biopsy, untreated, 1080</p>
</dd>
<dt>GSM1587833</dt><dd><p>FL lymph node biopsy, untreated, 575</p>
</dd>
<dt>GSM1587834</dt><dd><p>FL lymph node biopsy, untreated, 581</p>
</dd>
<dt>GSM1587835</dt><dd><p>FL lymph node biopsy, untreated, 598</p>
</dd>
<dt>GSM1587836</dt><dd><p>FL lymph node biopsy, untreated, 639</p>
</dd>
<dt>GSM1587837</dt><dd><p>FL lymph node biopsy, untreated, 664</p>
</dd>
<dt>GSM1587838</dt><dd><p>FL lymph node biopsy, untreated, 666</p>
</dd>
<dt>GSM1587839</dt><dd><p>FL lymph node biopsy, untreated, 695</p>
</dd>
<dt>GSM1587840</dt><dd><p>FL lymph node biopsy, untreated, 706</p>
</dd>
<dt>GSM1587841</dt><dd><p>FL lymph node biopsy, untreated, 726</p>
</dd>
<dt>GSM1587842</dt><dd><p>FL lymph node biopsy, untreated, 731</p>
</dd>
<dt>GSM1587843</dt><dd><p>FL lymph node biopsy, untreated, 944</p>
</dd>
<dt>GSM1587844</dt><dd><p>FL lymph node biopsy, untreated, 959</p>
</dd>
</dl>


<h3>References</h3>

<p>Aaron M. Newman, Chih Long Liu, Michael R. Green, Andrew J. Gentles, Weiguo Feng, Yue Xu, Chuong D. Hoang, Maximilian Diehn and Ash A. Alizadeh. Robust enumeration of cell subsets from tissue expression profiles.
</p>

<hr>
<h2 id='sample.sim'>Generate random sample with different proportion of outliers and leverage points</h2><span id='topic+sample.sim'></span>

<h3>Description</h3>

<p>Generate random sample with different proportion of outliers and leverage points
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample.sim(n, p, sig, a1, a2, nn = TRUE, intercept = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sample.sim_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_p">p</code></td>
<td>
<p>number of independent variables (predictors).</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_sig">sig</code></td>
<td>
<p>variance of dependent variable.</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_a1">a1</code></td>
<td>
<p>proportion of outliers.</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_a2">a2</code></td>
<td>
<p>proportion of leverage points in outliers.</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_nn">nn</code></td>
<td>
<p>whether coefficients are non-negative, default TRUE.</p>
</td></tr>
<tr><td><code id="sample.sim_+3A_intercept">intercept</code></td>
<td>
<p>whether intercept is included in model, default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>y:  vector of dependent variable.
</p>
<p>x:  matrix of predictors with n rows and p columns.
</p>
<p>loc:  index of added outliers.
</p>
<p>beta: vector of coefficients.
</p>


<h3>Author(s)</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie
</p>


<h3>References</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie. Fast and Robust Deconvolution of Tumor Infiltrating Lymphocyte from Expression Profiles using Least Trimmed Squares. &lt;doi:10.1101/358366&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FARDEEP)
samp = sample.sim(n = 500, p = 20, sig = 1, a1 = 0.1, a2 = 0.2, nn = TRUE, intercept = TRUE)
</code></pre>

<hr>
<h2 id='tuningBIC'>Tuning parameter k in function alts using Bayesian Information Criterion (BIC) with some adjustment.</h2><span id='topic+tuningBIC'></span>

<h3>Description</h3>

<p>Tuning parameter k in function alts using Bayesian Information Criterion (BIC) with some adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tuningBIC(x, y, alpha1 = 0.1, alpha2 = 1.5, up = 10, low = 1,
  nn = TRUE, intercept = TRUE, lognorm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tuningBIC_+3A_x">x</code></td>
<td>
<p>input matrix of predictors with n rows and p columns.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_y">y</code></td>
<td>
<p>input vector of dependent variable with length n.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_alpha1">alpha1</code></td>
<td>
<p>parameter used to adjust the upper bound of outliers. Take value from 0 to 1, default 0.1.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_alpha2">alpha2</code></td>
<td>
<p>parameter used to adjust the lower bound of outliers. Take value larger than 1, default 1.5.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_up">up</code></td>
<td>
<p>upper bound of parameter k in function alts, default 10.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_low">low</code></td>
<td>
<p>lower bound of parameter k in function alts, default 1.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_nn">nn</code></td>
<td>
<p>whether coefficients are non-negative, default TRUE.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_intercept">intercept</code></td>
<td>
<p>whether intercept is included in model, default TRUE.</p>
</td></tr>
<tr><td><code id="tuningBIC_+3A_lognorm">lognorm</code></td>
<td>
<p>whether noise is log-normal distributed, default TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>k:   tuning result of parameter k for function alts.
</p>


<h3>Author(s)</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie
</p>


<h3>References</h3>

<p>Yuning Hao, Ming Yan, Blake R. Heath, Yu L. Lei and Yuying Xie. Fast and Robust Deconvolution of Tumor Infiltrating Lymphocyte from Expression Profiles using Least Trimmed Squares. &lt;doi:10.1101/358366&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(FARDEEP)
samp = sample.sim(n = 500, p = 20, sig = 1, a1 = 0.1, a2 = 0.2, nn = TRUE, intercept = TRUE)
k = tuningBIC(samp$x, samp$y, lognorm = FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
