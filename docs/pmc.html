<!DOCTYPE html><html><head><title>Help for package pmc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pmc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anoles'><p>The anoles data set</p></a></li>
<li><a href='#pmc'><p>pmc</p></a></li>
<li><a href='#pmc_fit'><p>Fit any model used in PMC</p></a></li>
<li><a href='#pmc-package'><p>pmc: Phylogenetic Monte Carlo</p></a></li>
<li><a href='#simulate.gfit'><p>simulate gfit</p></a></li>
<li><a href='#tree'><p>The phylogeny for the anoles data set</p></a></li>
<li><a href='#update.gfit'><p>update gfit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Title:</td>
<td>Phylogenetic Monte Carlo</td>
</tr>
<tr>
<td>Description:</td>
<td>Monte Carlo based model choice for applied phylogenetics of
    continuous traits. Method described in  Carl Boettiger, Graham Coop,
    Peter Ralph (2012) Is your phylogeny informative? Measuring
    the power of comparative methods, Evolution 66 (7)
    2240-51. &lt;<a href="https://doi.org/10.1111%2Fj.1558-5646.2011.01574.x">doi:10.1111/j.1558-5646.2011.01574.x</a>&gt;.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/cboettig/pmc">https://github.com/cboettig/pmc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/cboettig/pmc/issues">https://github.com/cboettig/pmc/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, gridExtra, knitr, testthat, rmarkdown</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, geiger (&ge; 2.0.11), ggplot2, parallel, ouch, tidyr,
phytools (&ge; 1.5-1)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-02 22:38:10 UTC; cboettig</td>
</tr>
<tr>
<td>Author:</td>
<td>Carl Boettiger [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Carl Boettiger &lt;cboettig@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-03 01:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anoles'>The anoles data set</h2><span id='topic+anoles'></span>

<h3>Description</h3>

<p>as from ouch with additional regimes added and minor formatting changes
</p>

<hr>
<h2 id='pmc'>pmc</h2><span id='topic+pmc'></span>

<h3>Description</h3>

<p>Performs a phylogenetic monte carlo between modelA and modelB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc(
  tree,
  data,
  modelA,
  modelB,
  nboot = 500,
  optionsA = list(),
  optionsB = list(),
  ...,
  mc.cores = parallel::detectCores()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_+3A_tree">tree</code></td>
<td>
<p>A phylogenetic tree.  Can be phylo (ape) or ouch tree</p>
</td></tr>
<tr><td><code id="pmc_+3A_data">data</code></td>
<td>
<p>The data matrix</p>
</td></tr>
<tr><td><code id="pmc_+3A_modela">modelA</code></td>
<td>
<p>a model from the list, or a custom model, see details</p>
</td></tr>
<tr><td><code id="pmc_+3A_modelb">modelB</code></td>
<td>
<p>any other model from the list, or custom model, see details</p>
</td></tr>
<tr><td><code id="pmc_+3A_nboot">nboot</code></td>
<td>
<p>number of bootstrap replicates to use</p>
</td></tr>
<tr><td><code id="pmc_+3A_optionsa">optionsA</code></td>
<td>
<p>additional arguments to modelA</p>
</td></tr>
<tr><td><code id="pmc_+3A_optionsb">optionsB</code></td>
<td>
<p>additional arguments to modelB</p>
</td></tr>
<tr><td><code id="pmc_+3A_...">...</code></td>
<td>
<p>additional arguments to both fitting methods</p>
</td></tr>
<tr><td><code id="pmc_+3A_mc.cores">mc.cores</code></td>
<td>
<p>number of parallel cores to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulates data under each model and returns the distribution of 
likelihood ratio, L(B)/L(A), under for both simulated datasets.
</p>


<h3>Value</h3>

<p>list with the nboot likelihood ratios obtained from fitting both models
to data simulated by model A, and the nboot likelihood ratios obtained
by fitting both models to simulations from model B, and the likelihood 
ratio between the original MLE estimated models from the data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("geiger")
geo=get(data(geospiza))
tmp=treedata(geo$phy, geo$dat)
phy=tmp$phy
dat=tmp$data[,1]
 
pmc(phy, dat, "BM", "lambda", nboot = 20, mc.cores=1)

</code></pre>

<hr>
<h2 id='pmc_fit'>Fit any model used in PMC</h2><span id='topic+pmc_fit'></span>

<h3>Description</h3>

<p>The fitting function used by pmc to generalize fitting to both geiger and ouch models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmc_fit(tree, data, model, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pmc_fit_+3A_tree">tree</code></td>
<td>
<p>a phylogenetic tree. can be ouch or ape format</p>
</td></tr>
<tr><td><code id="pmc_fit_+3A_data">data</code></td>
<td>
<p>trait data in ape or ouch format</p>
</td></tr>
<tr><td><code id="pmc_fit_+3A_model">model</code></td>
<td>
<p>the name of the model to fit,</p>
</td></tr>
<tr><td><code id="pmc_fit_+3A_...">...</code></td>
<td>
<p>whatever additional options would be provided 
to the model fit</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the object returned by the model fitting routine (gfit for geiger, hansen/brown for ouch)
</p>

<hr>
<h2 id='pmc-package'>pmc: Phylogenetic Monte Carlo</h2><span id='topic+pmc-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>Monte Carlo based model choice for applied phylogenetics of continuous traits. Method described in Carl Boettiger, Graham Coop, Peter Ralph (2012) Is your phylogeny informative? Measuring the power of comparative methods, Evolution 66 (7) 2240-51. <a href="https://doi.org/10.1111/j.1558-5646.2011.01574.x">doi:10.1111/j.1558-5646.2011.01574.x</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Carl Boettiger <a href="mailto:cboettig@gmail.com">cboettig@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/cboettig/pmc">https://github.com/cboettig/pmc</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/cboettig/pmc/issues">https://github.com/cboettig/pmc/issues</a>
</p>
</li></ul>


<hr>
<h2 id='simulate.gfit'>simulate gfit</h2><span id='topic+simulate.gfit'></span>

<h3>Description</h3>

<p>simulate method for gfit objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate.gfit(object, nsim = 1, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.gfit_+3A_object">object</code></td>
<td>
<p>a gfit object</p>
</td></tr>
<tr><td><code id="simulate.gfit_+3A_nsim">nsim</code></td>
<td>
<p>number of sims</p>
</td></tr>
<tr><td><code id="simulate.gfit_+3A_seed">seed</code></td>
<td>
<p>an optional seed for the simulations (not implemented)</p>
</td></tr>
<tr><td><code id="simulate.gfit_+3A_...">...</code></td>
<td>
<p>additional arguments, not implemented for gfit simulations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>simulated dataset
</p>

<hr>
<h2 id='tree'>The phylogeny for the anoles data set</h2><span id='topic+tree'></span>

<h3>Description</h3>

<p>The bimaculus phylogeny, as from the ouch package
</p>

<hr>
<h2 id='update.gfit'>update gfit</h2><span id='topic+update.gfit'></span>

<h3>Description</h3>

<p>update method for gfit objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update.gfit(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update.gfit_+3A_object">object</code></td>
<td>
<p>a gfit object</p>
</td></tr>
<tr><td><code id="update.gfit_+3A_...">...</code></td>
<td>
<p>additional arguments, such as the data to use to update</p>
</td></tr>
</table>


<h3>Value</h3>

<p>updated gfit object
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
