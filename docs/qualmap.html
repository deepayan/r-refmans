<!DOCTYPE html><html lang="en"><head><title>Help for package qualmap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qualmap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#qualmap-package'><p>qualmap: Opinionated Approach for Digitizing Semi-Structured Qualitative GIS Data</p></a></li>
<li><a href='#qm_combine'><p>Combine objects</p></a></li>
<li><a href='#qm_create'><p>Create cluster object</p></a></li>
<li><a href='#qm_define'><p>Define input values</p></a></li>
<li><a href='#qm_is_cluster'><p>Validate cluster object</p></a></li>
<li><a href='#qm_preview'><p>Preview Input</p></a></li>
<li><a href='#qm_summarize'><p>Summarize Clusters</p></a></li>
<li><a href='#qm_validate'><p>Validate input vector</p></a></li>
<li><a href='#qm_verify'><p>Verify Previously Saved Cluster Data</p></a></li>
<li><a href='#stLouis'><p>St. Louis Census Tracts, 2016</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Opinionated Approach for Digitizing Semi-Structured Qualitative
GIS Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of functions for taking qualitative GIS data, hand drawn on a map, and 
   converting it to a simple features object. These tools are focused on data that are drawn on a map
   that contains some type of polygon features. For each area identified on the map, the id numbers
   of these polygons can be entered as vectors and transformed using qualmap.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://chris-prener.github.io/qualmap/">https://chris-prener.github.io/qualmap/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chris-prener/qualmap/issues">https://github.com/chris-prener/qualmap/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, glue, leaflet, purrr, rlang, sf</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, ggplot2, testthat, tigris, tidycensus, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 17:38:49 UTC; chris</td>
</tr>
<tr>
<td>Author:</td>
<td>Christopher Prener
    <a href="https://orcid.org/0000-0002-4310-9888"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christopher Prener &lt;chris.prener@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-09 00:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='qualmap-package'>qualmap: Opinionated Approach for Digitizing Semi-Structured Qualitative GIS Data</h2><span id='topic+qualmap'></span><span id='topic+qualmap-package'></span>

<h3>Description</h3>

<p>Provides a set of functions for taking qualitative GIS data, hand drawn on a map, and converting it to a simple features object. These tools are focused on data that are drawn on a map that contains some type of polygon features. For each area identified on the map, the id numbers of these polygons can be entered as vectors and transformed using qualmap.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Christopher Prener <a href="mailto:chris.prener@gmail.com">chris.prener@gmail.com</a> (<a href="https://orcid.org/0000-0002-4310-9888">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://chris-prener.github.io/qualmap/">https://chris-prener.github.io/qualmap/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/chris-prener/qualmap/issues">https://github.com/chris-prener/qualmap/issues</a>
</p>
</li></ul>


<hr>
<h2 id='qm_combine'>Combine objects</h2><span id='topic+qm_combine'></span>

<h3>Description</h3>

<p>A wrapper around <code>dplyr::bind_rows</code> for combining cluster objects created with
<code>qm_create</code> into a single tibble. Input data for <code>qm_combine</code> are validated using
<code>qm_is_cluster</code> as part of the cluster object creation process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_combine(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_combine_+3A_...">...</code></td>
<td>
<p>A list of cluster objects to be combined.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single tibble with all observations from the listed cluster objects. This tibble is
stored with a custom class of <code>qm_cluster</code> to facilitate data validation.
</p>


<h3>See Also</h3>

<p><code>qm_create</code>, <code>qm_is_cluster</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create clusters
cluster1 &lt;- qm_define(118600, 119101, 119300)
cluster2 &lt;- qm_define(119300, 121200, 121100)

# create cluster objects
cluster_obj1 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster1,
    rid = 1, cid = 1, category = "positive")
cluster_obj2 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster2,
    rid = 1, cid = 2, category = "positive")

# combine cluster objects
clusters &lt;- qm_combine(cluster_obj1, cluster_obj2)

</code></pre>

<hr>
<h2 id='qm_create'>Create cluster object</h2><span id='topic+qm_create'></span>

<h3>Description</h3>

<p>Each vector of input values is converted to a tibble organized in a &quot;tidy&quot; fashion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_create(ref, key, value, rid, cid, category, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_create_+3A_ref">ref</code></td>
<td>
<p>An <code>sf</code> object that serves as a master list of features</p>
</td></tr>
<tr><td><code id="qm_create_+3A_key">key</code></td>
<td>
<p>Name of geographic id variable in the <code>ref</code> object to match input values to</p>
</td></tr>
<tr><td><code id="qm_create_+3A_value">value</code></td>
<td>
<p>A vector of input values created with <code>qm_define</code></p>
</td></tr>
<tr><td><code id="qm_create_+3A_rid">rid</code></td>
<td>
<p>Respondent identification number; a user defined integer value that uniquely identifies respondents
in the project</p>
</td></tr>
<tr><td><code id="qm_create_+3A_cid">cid</code></td>
<td>
<p>Cluster identification number; a user defined integer value that uniquely identifies clusters</p>
</td></tr>
<tr><td><code id="qm_create_+3A_category">category</code></td>
<td>
<p>Category type; a user defined value that describes what the cluster represents</p>
</td></tr>
<tr><td><code id="qm_create_+3A_...">...</code></td>
<td>
<p>An unquoted list of variables from the sf object to include in the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A cluster object contains a row for each feature in the reference data set. The <code>key</code> variable
values are included in a variable named identically to the <code>key</code>. Three pieces of metadata are also included
as arguments to provide data for subsetting later: a respondent identification number (<code>rid</code>), a
cluster identification number (<code>cid</code>), and a category for the cluster type (<code>category</code>). These
arguments are converted into values for the output variables <code>RID</code>, <code>CID</code>, and <code>CAT</code> respectively.
Input data for <code>qm_create</code> are validated using <code>qm_validate</code> as part of the cluster object
creation process.
</p>


<h3>Value</h3>

<p>A tibble with the cluster values merged with elements of the reference data. This tibble is stored with
a custom class of <code>qm_cluster</code> to facilitate data validation.
</p>


<h3>See Also</h3>

<p><code>qm_define</code>, <code>qm_validate</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create cluster
cluster &lt;- qm_define(118600, 119101, 119300)

# create simple cluster object
cluster_obj1 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster,
    rid = 1, cid = 1, category = "positive")

# create cluster object with additional variables added from reference data
cluster_obj2 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster,
    rid = 1, cid = 1, category = "positive", NAME, NAMELSAD)

</code></pre>

<hr>
<h2 id='qm_define'>Define input values</h2><span id='topic+qm_define'></span>

<h3>Description</h3>

<p>A wrapper around <code>base::c</code> that is used for constructing vectors of individual feature values.
Each output should correspond to a single cluster on the respondent's map.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_define(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_define_+3A_...">...</code></td>
<td>
<p>A comma separated list of individual features</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector list each feature.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cluster &lt;- qm_define(118600, 119101, 119300)

</code></pre>

<hr>
<h2 id='qm_is_cluster'>Validate cluster object</h2><span id='topic+qm_is_cluster'></span>

<h3>Description</h3>

<p>This function tests to see whether an object contains the characteristics of an object
created by <code>qm_cluster</code>. It is used as part of the <code>qm_combine</code> and <code>qm_summarize</code>
functions, and is exported so that it can be used interactively as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_is_cluster(obj, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_is_cluster_+3A_obj">obj</code></td>
<td>
<p>Object to test</p>
</td></tr>
<tr><td><code id="qm_is_cluster_+3A_verbose">verbose</code></td>
<td>
<p>A logical scalar; if <code>TRUE</code>, a tibble with test results is returned</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical scalar that is <code>TRUE</code> if the given object contains the approprite
characteristics; if it does not, <code>FALSE</code> is returned.
</p>


<h3>See Also</h3>

<p><code>qm_combine</code>, <code>qm_summarize</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create cluster
cluster &lt;- qm_define(118600, 119101, 119300)

# create simple cluster object
cluster_obj &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster,
    rid = 1, cid = 1, category = "positive")

# test cluster object
qm_is_cluster(cluster_obj)
qm_is_cluster(cluster_obj, verbose = TRUE)

</code></pre>

<hr>
<h2 id='qm_preview'>Preview Input</h2><span id='topic+qm_preview'></span>

<h3>Description</h3>

<p>This function renders the input vector as a polygon shapefile using the leaflet package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_preview(ref, key, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_preview_+3A_ref">ref</code></td>
<td>
<p>An <code>sf</code> object that serves as a master list of features</p>
</td></tr>
<tr><td><code id="qm_preview_+3A_key">key</code></td>
<td>
<p>Name of geographic id variable in the <code>ref</code> object to match input values to</p>
</td></tr>
<tr><td><code id="qm_preview_+3A_value">value</code></td>
<td>
<p>A vector of input values created with <code>qm_define</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An interactive leaflet map with the features from the defined vector specified in <code>value</code>
highlighted in red.
</p>


<h3>See Also</h3>

<p><code>qm_define</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create cluster
cluster &lt;- qm_define(118600, 119101, 119300)

# preview cluster
qm_preview(ref = stl, key = TRACTCE, value = cluster)

## End(Not run)

</code></pre>

<hr>
<h2 id='qm_summarize'>Summarize Clusters</h2><span id='topic+qm_summarize'></span>

<h3>Description</h3>

<p>This function creates a column that contains a single observation for each unique value
in the key variable. For each feature, a count corresponding to the number of times that feature is
identified in a cluster for the give category is also provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_summarize(ref, key, clusters, category, count, geometry = TRUE, use.na = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_summarize_+3A_ref">ref</code></td>
<td>
<p>An <code>sf</code> object that serves as a master list of features</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_key">key</code></td>
<td>
<p>Name of geographic id variable in the <code>ref</code> object to match input values to</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_clusters">clusters</code></td>
<td>
<p>A tibble created by <code>qm_combine</code> with two or more clusters worth of data</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_category">category</code></td>
<td>
<p>Value of the <code>CAT</code> variable to be analyzed</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_count">count</code></td>
<td>
<p>How should clusters be summarized: by counting each time a feature is included
in a cluster (<code>"clusters"</code>) or by counting the number of respondents
(<code>"respondents"</code>) who associated a feature with the given category.</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_geometry">geometry</code></td>
<td>
<p>A logical scalar that returns the full geometry and attributes of <code>ref</code>
when <code>TRUE</code> (default). If <code>FALSE</code>, only the <code>key</code> and count of features is
returned after validation.</p>
</td></tr>
<tr><td><code id="qm_summarize_+3A_use.na">use.na</code></td>
<td>
<p>A logical scalar that returns <code>NA</code> values in the count variable if a feature
is not included in any clusters when <code>TRUE</code>. If <code>FALSE</code> (default), a <code>0</code> value
is returned in the count variable for each feature that is not included in any clusters. This
parameter only impacts output if the <code>geometry</code> argument is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble or a <code>sf</code> object (if geometry = <code>TRUE</code>) that contains a count of the number
of clusters a given feature is included in. The tibble option (when <code>geometry = FALSE</code>) will only
return valid features. The <code>sf</code> option (default; when <code>geometry = TRUE</code>) will return all
features with either zeros (when <code>use.na = FALSE</code>) or <code>NA</code> values (when <code>use.na = TRUE</code>)
for features not included in any clusters.
</p>


<h3>See Also</h3>

<p><code>qm_combine</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create clusters
cluster1 &lt;- qm_define(118600, 119101, 119300)
cluster2 &lt;- qm_define(119300, 121200, 121100)

# create cluster objects
cluster_obj1 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster1,
    rid = 1, cid = 1, category = "positive")
cluster_obj2 &lt;- qm_create(ref = stl, key = TRACTCE, value = cluster2,
    rid = 1, cid = 2, category = "positive")

# combine cluster objects
clusters &lt;- qm_combine(cluster_obj1, cluster_obj2)

# summarize cluster objects
positive1 &lt;- qm_summarize(ref = stl, key = TRACTCE, clusters = clusters, category = "positive",
    count = "clusters")
class(positive1)
mean(positive1$positive)

# summarize cluster objects with NA's instead of 0's
positive2 &lt;- qm_summarize(ref = stl, key = TRACTCE, clusters = clusters, category = "positive",
    count = "clusters", use.na = TRUE)
class(positive2)
mean(positive2$positive, na.rm = TRUE)

# return tibble of valid features only
positive3 &lt;- qm_summarize(ref = stl, key = TRACTCE, clusters = clusters, category = "positive",
    count = "clusters", geometry = FALSE)
class(positive3)
mean(positive3$positive)

# count respondents instead of clusters
positive4 &lt;- qm_summarize(ref = stl, key = TRACTCE, clusters = clusters, category = "positive",
    count = "respondents")
mean(positive4$positive)

</code></pre>

<hr>
<h2 id='qm_validate'>Validate input vector</h2><span id='topic+qm_validate'></span>

<h3>Description</h3>

<p>This function ensures that the input vector values match valid values in a source shapefile.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_validate(ref, key, value)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_validate_+3A_ref">ref</code></td>
<td>
<p>An <code>sf</code> object that serves as a master list of features</p>
</td></tr>
<tr><td><code id="qm_validate_+3A_key">key</code></td>
<td>
<p>Name of geographic id variable in the <code>ref</code> object to match input values to</p>
</td></tr>
<tr><td><code id="qm_validate_+3A_value">value</code></td>
<td>
<p>A vector of input values created with <code>qm_define</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical scalar that is <code>TRUE</code> is all input values match values in the key variable.
</p>


<h3>See Also</h3>

<p><code>qm_define</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and format reference data
stl &lt;- stLouis
stl &lt;- dplyr::mutate(stl, TRACTCE = as.numeric(TRACTCE))

# create clusters
clusterValid &lt;- qm_define(118600, 119101, 119300)
clusterError &lt;- qm_define(118600, 119101, 800000)

# validate clusters
qm_validate(ref = stl, key = TRACTCE, value = clusterValid)

qm_validate(ref = stl, key = TRACTCE, value = clusterError)

</code></pre>

<hr>
<h2 id='qm_verify'>Verify Previously Saved Cluster Data</h2><span id='topic+qm_verify'></span>

<h3>Description</h3>

<p>Users may wish to save long-form combined cluster data as a <code>.csv</code> file
or similar after combining individual clusters with <code><a href="#topic+qm_combine">qm_combine</a></code>. The <code>qm_verify</code>
function allows users to import data from any file type readable by <code>R</code>, and verify that it
has the column names needed for <code><a href="#topic+qm_summarize">qm_summarize</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qm_verify(clusters)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qm_verify_+3A_clusters">clusters</code></td>
<td>
<p>An object created by <code>qm_combine</code> with two or more clusters worth of data
that has been previously saved and requires verification before summarization.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble stored with a custom class of <code>qm_cluster</code> to facilitate data validation.
</p>

<hr>
<h2 id='stLouis'>St. Louis Census Tracts, 2016</h2><span id='topic+stLouis'></span>

<h3>Description</h3>

<p>A simple features data set containing the geometry and associated attributes for the 2016 City of St. Louis
census tracts.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(stLouis)
</code></pre>


<h3>Format</h3>

<p>A data frame with 106 rows and 7 variables:
</p>

<dl>
<dt>STATEFP</dt><dd><p>state FIPS code</p>
</dd>
<dt>COUNTYFP</dt><dd><p>county FIPS code</p>
</dd>
<dt>TRACTCE</dt><dd><p>tract FIPS code</p>
</dd>
<dt>GEOID</dt><dd><p>full GEOID string</p>
</dd>
<dt>NAME</dt><dd><p>tract FIPS code, decimal</p>
</dd>
<dt>NAMELSAD</dt><dd><p>tract name</p>
</dd>
<dt>geometry</dt><dd><p>simple features geometry</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data have been modified from the full version available from the Census Bureau - some
variables related to geometry and geography type have been removed.
</p>


<h3>Source</h3>

<p><a href="https://www.census.gov">U.S. Census Bureau</a>
</p>
<p>#' @examples
str(stLouis)
head(stLouis)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
