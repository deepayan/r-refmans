<!DOCTYPE html><html><head><title>Help for package readODS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {readODS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#list_ods_sheets'><p>Get information in an (F)ODS File</p></a></li>
<li><a href='#read_ods'><p>Read Data From (F)ODS File</p></a></li>
<li><a href='#readODS-package'><p>readODS: Read and Write ODS Files</p></a></li>
<li><a href='#write_ods'><p>Write Data to (F)ODS File</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read and Write ODS Files</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Read ODS (OpenDocument Spreadsheet) into R as data frame. Also support writing data frame into ODS file.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ropensci/readODS">https://github.com/ropensci/readODS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/readODS/issues">https://github.com/ropensci/readODS/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>cellranger, readr (&ge; 1.2.1), stringi, tibble, vctrs (&ge;
0.4.2), zip, tools</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>cpp11 (&ge; 0.4.6)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>spelling, testthat, datasets, covr, knitr, rmarkdown, withr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-01 16:18:36 UTC; chainsawriot</td>
</tr>
<tr>
<td>Author:</td>
<td>Gerrit-Jan Schutten [aut],
  Chung-hong Chan <a href="https://orcid.org/0000-0002-6232-7530"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Peter Brohan [aut],
  Detlef Steuer <a href="https://orcid.org/0000-0003-2676-5290"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas J. Leeper <a href="https://orcid.org/0000-0003-4097-6326"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  John Foster [ctb],
  Sergio Oller [ctb],
  Jim Hester <a href="https://orcid.org/0000-0002-2739-7082"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Stephen Watts [ctb],
  Arthur Katossky [ctb],
  Stas Malavin [ctb],
  Duncan Garmonsway [ctb],
  Mehrad Mahmoudian [ctb],
  Matt Kerlogue [ctb],
  Michal Lauer [ctb],
  Till Straube [ctb],
  Marcin Kalicinski [ctb, cph] (Author of included RapidXML code)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chung-hong Chan &lt;chainsawtiney@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-01 16:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='list_ods_sheets'>Get information in an (F)ODS File</h2><span id='topic+list_ods_sheets'></span><span id='topic+list_fods_sheets'></span><span id='topic+ods_sheets'></span>

<h3>Description</h3>

<p><code>list_ods_sheets</code> lists all sheets in an (f)ods file. The function can be used for listing sheets in both ods and flat ods files. (<code>list_fods_sheets</code>) is also available, which can only list sheets in flat ods files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_ods_sheets(
  path,
  include_external_data = FALSE,
  ods_format = c("auto", "ods", "fods"),
  guess = FALSE
)

list_fods_sheets(path, include_external_data = FALSE)

ods_sheets(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list_ods_sheets_+3A_path">path</code></td>
<td>
<p>Path to the (f)ods file</p>
</td></tr>
<tr><td><code id="list_ods_sheets_+3A_include_external_data">include_external_data</code></td>
<td>
<p>A boolean value to show or hide sheets containing archived linked data (default false)</p>
</td></tr>
<tr><td><code id="list_ods_sheets_+3A_ods_format">ods_format</code></td>
<td>
<p>character, must be &quot;auto&quot;, &quot;ods&quot; or &quot;fods&quot;. The default &quot;auto&quot; is to determine the format automatically. By default, the format is determined by file extension, unless <code>guess</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="list_ods_sheets_+3A_guess">guess</code></td>
<td>
<p>logical, If the file extension is absent or not recognized, this
controls whether we attempt to guess format based on the file signature or
&quot;magic number&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default &quot;include_external_data&quot; for <code>ods_sheets</code> is TRUE to maintain compatibility with version 1 of readODS. It will change to <code>TRUE</code> in version 3.
</p>


<h3>Value</h3>

<p>A character vector of sheet names
</p>


<h3>Author(s)</h3>

<p>Peter Brohan <a href="mailto:peter.brohan+cran@gmail.com">peter.brohan+cran@gmail.com</a>, Chung-hong Chan <a href="mailto:chainsawtiney@gmail.com">chainsawtiney@gmail.com</a>, Gerrit-Jan Schutten <a href="mailto:phonixor@gmail.com">phonixor@gmail.com</a>
</p>


<h3>See Also</h3>

<p>use <code><a href="#topic+read_ods">read_ods</a></code> to read the data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get the list of names of sheets
list_ods_sheets("starwars.ods")
list_ods_sheets("starwars.fods")
# Using list_fods_sheets, although you don't have to
list_fods_sheets("starwars.fods")

## End(Not run)
</code></pre>

<hr>
<h2 id='read_ods'>Read Data From (F)ODS File</h2><span id='topic+read_ods'></span><span id='topic+read_fods'></span>

<h3>Description</h3>

<p>read_ods is a function to read a single sheet from an (f)ods file and return a data frame. The function can be used for reading both ods and flat ods files.
(<code>read_fods</code>) is also available, which can only read flat ods files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ods(
  path,
  sheet = 1,
  col_names = TRUE,
  col_types = NULL,
  na = "",
  skip = 0,
  formula_as_formula = FALSE,
  range = NULL,
  row_names = FALSE,
  strings_as_factors = FALSE,
  verbose = FALSE,
  as_tibble = TRUE,
  .name_repair = "unique",
  ods_format = c("auto", "ods", "fods"),
  guess = FALSE,
  trim_ws = TRUE,
  n_max = Inf
)

read_fods(
  path,
  sheet = 1,
  col_names = TRUE,
  col_types = NULL,
  na = "",
  skip = 0,
  formula_as_formula = FALSE,
  range = NULL,
  row_names = FALSE,
  strings_as_factors = FALSE,
  verbose = FALSE,
  as_tibble = TRUE,
  .name_repair = "unique",
  trim_ws = TRUE,
  n_max = Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ods_+3A_path">path</code></td>
<td>
<p>path to the (f)ods file.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_sheet">sheet</code></td>
<td>
<p>sheet to read. Either a string (the sheet name), or an integer sheet number. The default is 1.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_col_names">col_names</code></td>
<td>
<p>logical, indicating whether the file contains the names of the variables as its first line. Default is TRUE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_col_types">col_types</code></td>
<td>
<p>Either NULL to guess from the spreadsheet or refer to <code><a href="readr.html#topic+type_convert">readr::type_convert()</a></code> to specify cols specification. It can also be a shorthand such as &quot;ccf&quot; (&quot;character&quot;, &quot;character&quot;, &quot;factor&quot;), a list, or an object created by <code><a href="readr.html#topic+cols">readr::cols()</a></code>. NA will return a data frame with all columns being &quot;characters&quot;. Please note that it will not speed up the reading by a lot by specifying this parameter explicitly. It is more for accuracy.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_na">na</code></td>
<td>
<p>Character vector of strings to use for missing values. By default read_ods converts blank cells to missing data. It can also be set to
NULL, so that empty cells are treated as NA.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_skip">skip</code></td>
<td>
<p>the number of lines of the data file to skip before beginning to read data. If this parameter is larger than the total number of lines in the ods file, an empty data frame is returned.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_formula_as_formula">formula_as_formula</code></td>
<td>
<p>logical, a switch to display formulas as formulas &quot;SUM(A1:A3)&quot; or as the resulting value &quot;3&quot;... or &quot;8&quot;.. . Default is FALSE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_range">range</code></td>
<td>
<p>selection of rectangle using Excel-like cell range, such as <code>range = "D12:F15"</code> or <code>range = "R1C12:R6C15"</code>. Cell range processing is handled by the <code><a href="cellranger.html#topic+cellranger">cellranger</a></code> package. If sheet name is in the range, such as <code>range = "Sheet2!A2:B7"</code>, this sheet name is used instead of the provided <code>sheet</code>. If <code>sheet</code> is not the default value (1), a warning is given.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_row_names">row_names</code></td>
<td>
<p>logical, indicating whether the file contains the names of the rows as its first column. Default is FALSE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_strings_as_factors">strings_as_factors</code></td>
<td>
<p>logical, if character columns to be converted to factors. Default is FALSE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_verbose">verbose</code></td>
<td>
<p>logical, if messages should be displayed. Default is FALSE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_as_tibble">as_tibble</code></td>
<td>
<p>logical, if the output should be a tibble (as opposed to a data.frame). Default is TRUE.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_.name_repair">.name_repair</code></td>
<td>
<p>A string or function passed on as <code>.name_repair</code> to <code><a href="tibble.html#topic+as_tibble">tibble::as_tibble()</a></code>
</p>

<ul>
<li> <p><code>"minimal"</code>: No name repair
</p>
</li>
<li> <p><code>"unique"</code> : Make sure names are unique and not empty
</p>
</li>
<li> <p><code>"check_unique"</code>: Check names are unique, but do not repair
</p>
</li>
<li> <p><code>"universal"</code> : Checks names are unique and valid R variables names in scope
</p>
</li>
<li><p> A function to apply custom name repair.
</p>
</li></ul>

<p>Default is <code>"unique"</code>.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_ods_format">ods_format</code></td>
<td>
<p>character, must be &quot;auto&quot;, &quot;ods&quot; or &quot;fods&quot;. The default &quot;auto&quot; is to determine the format automatically. By default, the format is determined by file extension, unless <code>guess</code> is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_guess">guess</code></td>
<td>
<p>logical, If the file extension is absent or not recognized, this
controls whether we attempt to guess format based on the file signature or
&quot;magic number&quot;.</p>
</td></tr>
<tr><td><code id="read_ods_+3A_trim_ws">trim_ws</code></td>
<td>
<p>logical, should leading and trailing whitespace be trimmed?</p>
</td></tr>
<tr><td><code id="read_ods_+3A_n_max">n_max</code></td>
<td>
<p>numeric, Maximum number of data rows to read. Ignored if <code>range</code> is given.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble (<code>tibble</code>) or data frame (<code>data.frame</code>) containing a representation of data in the (f)ods file.
</p>


<h3>Author(s)</h3>

<p>Peter Brohan <a href="mailto:peter.brohan+cran@gmail.com">peter.brohan+cran@gmail.com</a>, Chung-hong Chan <a href="mailto:chainsawtiney@gmail.com">chainsawtiney@gmail.com</a>, Gerrit-Jan Schutten <a href="mailto:phonixor@gmail.com">phonixor@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Read an ODS file
read_ods("starwars.ods")
# Read a specific sheet, e.g. the 2nd sheet
read_ods("starwars.ods", sheet = 2)
# Read a specific range, e.g. A1:C11
read_ods("starwars.ods", sheet = 2, range = "A1:C11")
# Read an FODS file
read_ods("starwars.fods")
# Read a specific sheet, e.g. the 2nd sheet
read_ods("starwars.fods", sheet = 2)
# Read a specific range, e.g. A1:C11
read_ods("starwars.fods", sheet = 2, range = "A1:C11")
# Give a warning and read from Sheet1 (not 2)
read_ods("starwars.fods", sheet = 2, range = "Sheet1!A1:C11")
# Specifying col_types as shorthand, the third column as factor; other by guessing
read_ods("starwars.ods", col_types = "??f")
# Specifying col_types as list
read_ods("starwars.ods", col_types = list(species = "f"))
# Using read_fods, although you don't have to
read_ods("starwars.fods")

## End(Not run)
</code></pre>

<hr>
<h2 id='readODS-package'>readODS: Read and Write ODS Files</h2><span id='topic+readODS'></span><span id='topic+readODS-package'></span>

<h3>Description</h3>

<p>Read ODS (OpenDocument Spreadsheet) into R as data frame. Also support writing data frame into ODS file.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Chung-hong Chan <a href="mailto:chainsawtiney@gmail.com">chainsawtiney@gmail.com</a> (<a href="https://orcid.org/0000-0002-6232-7530">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Gerrit-Jan Schutten <a href="mailto:phonixor@gmail.com">phonixor@gmail.com</a>
</p>
</li>
<li><p> Peter Brohan <a href="mailto:peter.brohan@gmail.com">peter.brohan@gmail.com</a>
</p>
</li>
<li><p> Detlef Steuer <a href="mailto:steuer@hsu-hh.de">steuer@hsu-hh.de</a> (<a href="https://orcid.org/0000-0003-2676-5290">ORCID</a>)
</p>
</li>
<li><p> Thomas J. Leeper <a href="mailto:thosjleeper@gmail.com">thosjleeper@gmail.com</a> (<a href="https://orcid.org/0000-0003-4097-6326">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> John Foster <a href="mailto:john.x.foster@nab.com.au">john.x.foster@nab.com.au</a> [contributor]
</p>
</li>
<li><p> Sergio Oller [contributor]
</p>
</li>
<li><p> Jim Hester <a href="mailto:jim.hester@rstudio.com">jim.hester@rstudio.com</a> (<a href="https://orcid.org/0000-0002-2739-7082">ORCID</a>) [contributor]
</p>
</li>
<li><p> Stephen Watts [contributor]
</p>
</li>
<li><p> Arthur Katossky [contributor]
</p>
</li>
<li><p> Stas Malavin [contributor]
</p>
</li>
<li><p> Duncan Garmonsway [contributor]
</p>
</li>
<li><p> Mehrad Mahmoudian [contributor]
</p>
</li>
<li><p> Matt Kerlogue [contributor]
</p>
</li>
<li><p> Michal Lauer <a href="mailto:michal.lauer.25@gmail.com">michal.lauer.25@gmail.com</a> [contributor]
</p>
</li>
<li><p> Till Straube <a href="mailto:straube@geo.uni-frankfurt.de">straube@geo.uni-frankfurt.de</a> [contributor]
</p>
</li>
<li><p> Marcin Kalicinski (Author of included RapidXML code) [contributor, copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ropensci/readODS">https://github.com/ropensci/readODS</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/readODS/issues">https://github.com/ropensci/readODS/issues</a>
</p>
</li></ul>


<hr>
<h2 id='write_ods'>Write Data to (F)ODS File</h2><span id='topic+write_ods'></span><span id='topic+write_fods'></span>

<h3>Description</h3>

<p>Function to write a single data frame or a list of data frames to a (f)ods file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_ods(
  x,
  path = tempfile(fileext = ".ods"),
  sheet = "Sheet1",
  append = FALSE,
  update = FALSE,
  row_names = FALSE,
  col_names = TRUE,
  na_as_string = FALSE,
  padding = FALSE
)

write_fods(
  x,
  path = tempfile(fileext = ".fods"),
  sheet = "Sheet1",
  append = FALSE,
  update = FALSE,
  row_names = FALSE,
  col_names = TRUE,
  na_as_string = FALSE,
  padding = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write_ods_+3A_x">x</code></td>
<td>
<p>data frame or list of data frames that will be sheets in the (f)ods. If the list is named, the names are used as sheet names</p>
</td></tr>
<tr><td><code id="write_ods_+3A_path">path</code></td>
<td>
<p>Path to the (f)ods file to write</p>
</td></tr>
<tr><td><code id="write_ods_+3A_sheet">sheet</code></td>
<td>
<p>Name of the sheet; ignore if <code>x</code> is a list of data frames</p>
</td></tr>
<tr><td><code id="write_ods_+3A_append">append</code></td>
<td>
<p>logical, TRUE indicates that x should be appended to the existing file (path) as a new sheet. If a sheet with the same sheet_name exists, an exception is thrown. See update. Please also note that writing is slightly slower if TRUE. Default is FALSE. Ignore if <code>x</code> is a list of data frames</p>
</td></tr>
<tr><td><code id="write_ods_+3A_update">update</code></td>
<td>
<p>logical, TRUE indicates that the sheet with sheet_name in the existing file (path) should be updated with the content of x. If a sheet with sheet_name does not exist, an exception is thrown. Please also note that writing is slightly slower if TRUE. Default is FALSE. Ignore if <code>x</code> is a list of data frames</p>
</td></tr>
<tr><td><code id="write_ods_+3A_row_names">row_names</code></td>
<td>
<p>logical, TRUE indicates that row names of x are to be included in the sheet. Default is FALSE</p>
</td></tr>
<tr><td><code id="write_ods_+3A_col_names">col_names</code></td>
<td>
<p>logical, TRUE indicates that column names of x are to be included in the sheet. Default is TRUE</p>
</td></tr>
<tr><td><code id="write_ods_+3A_na_as_string">na_as_string</code></td>
<td>
<p>logical, TRUE indicates that NAs are written as string; FALSE indicates that NAs are written as empty cells</p>
</td></tr>
<tr><td><code id="write_ods_+3A_padding">padding</code></td>
<td>
<p>logical, TRUE indicates that the sheet is padded with repeated empty cells to the maximum size, either 2^20 x 1024 (if the number of columns of <code>x</code> is less than or equal 1024) or 2^20 x 16,384 (otherwise). This is the default behaviour of Microsoft Excel. Default is FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function emulates <code><a href="writexl.html#topic+write_xlsx">writexl::write_xlsx()</a></code> and <code><a href="openxlsx.html#topic+write.xlsx">openxlsx::write.xlsx()</a></code> except in the handling of list columns. The expected behaviour for this is undefined and the two functions behave differently. This function handles list columns by converting them to character vectors of R code (similar to the output of <code><a href="base.html#topic+dput">dput()</a></code>), which is probably not ideal.
</p>


<h3>Value</h3>

<p>A (F)ODS file written to the file path location specified by the user. The value of <code>path</code> is also returned invisibly
</p>


<h3>Author(s)</h3>

<p>Detlef Steuer <a href="mailto:steuer@hsu-hh.de">steuer@hsu-hh.de</a>, Thomas J. Leeper <a href="mailto:thosjleeper@gmail.com">thosjleeper@gmail.com</a>, John Foster <a href="mailto:john.x.foster@nab.com.au">john.x.foster@nab.com.au</a>, Chung-hong Chan <a href="mailto:chainsawtiney@gmail.com">chainsawtiney@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# preserve the row names
write_ods(mtcars, "mtcars.ods", row_names = TRUE)
# append a sheet to an existing file
write_ods(PlantGrowth, "mtcars.ods", append = TRUE, sheet = "plant")
# This is however faster
write_ods(list("Sheet1" = mtcars, "plant" = PlantGrowth), "mtcars.ods", row_names = TRUE)
# write flat ODS file
write_fods(mtcars, "mtcars.fods", sheet = "mtcars")

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
