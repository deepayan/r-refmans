<!DOCTYPE html><html><head><title>Help for package climetrics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {climetrics}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aaClimate'><p>Changes in the Area of Analogous Climate</p></a></li>
<li><a href='#apply.months'><p>Apply a function on rasters of each month over years</p></a></li>
<li><a href='#ccm'><p>Climate Change Metrics</p></a></li>
<li><a href='#daClimate'><p>Changes in distance to Analogous Climates</p></a></li>
<li><a href='#dVelocity'><p>Distant-based Velocity of Climate Change</p></a></li>
<li><a href='#gVelocity'><p>Gradient-based Velocity of Climate Change</p></a></li>
<li><a href='#kgc'><p>Koggen Geiger climate classification</p></a></li>
<li><a href='#localExtreme'><p>Changes in probability of local extremes</p></a></li>
<li><a href='#novelClimate'><p>Novel Climates</p></a></li>
<li><a href='#sed'><p>Standardized Local Anomalies</p></a></li>
<li><a href='#temporalTrend'><p>Temporal Trend (Slope) of a climate variable</p></a></li>
<li><a href='#velocity'><p>Velocity of Climate Change</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Climate Change Metrics</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-12</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-02</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, R (&ge; 3.5.0), rts</td>
</tr>
<tr>
<td>Imports:</td>
<td>raster, terra, zoo, yaImpute, xts</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Description:</td>
<td>A framework that facilitates spatio-temporal analysis of climate dynamics through exploring and measuring different dimensions of climate change in space and time.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-gis.net/">https://r-gis.net/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/shirintaheri/climetrics/issues/">https://github.com/shirintaheri/climetrics/issues/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-02 21:53:43 UTC; babak</td>
</tr>
<tr>
<td>Author:</td>
<td>Shirin Taheri <a href="https://orcid.org/0000-0002-0303-3145"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Babak Naimi <a href="https://orcid.org/0000-0001-5431-2729"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Miguel Araujo [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Shirin Taheri &lt;taheri.shi@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-04 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aaClimate'>Changes in the Area of Analogous Climate</h2><span id='topic+aaClimate'></span><span id='topic+aaClimateC'></span><span id='topic+aaClimate+2CRasterStackBrick-method'></span><span id='topic+aaClimate+2CSpatRaster-method'></span><span id='topic+aaClimateC+2CRasterStackBrick-method'></span><span id='topic+aaClimateC+2CSpatRaster-method'></span><span id='topic+aaClimate+2CRasterStackBrickTS-method'></span><span id='topic+aaClimate+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>To quantify the change in area of analogous climates (classes),the change in area occupied by a given class between time 1 (t1) and time 2 (t2) periods is quantified. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  aaClimate(precip,tmin, tmax, tmean,t1,t2)
  aaClimateC(c1,c2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aaClimate_+3A_precip">precip</code></td>
<td>
<p>A time series of precipitation as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_tmin">tmin</code></td>
<td>
<p>A time series of minimum temperature as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_tmax">tmax</code></td>
<td>
<p>A time series of maximum temperature as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_tmean">tmean</code></td>
<td>
<p>A time series of mean temperature as a Raster or Raster Time Series object; if not provided, it will be calculated from tmin and tmax</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_c1">c1</code></td>
<td>
<p>A single layer Raster layer contains Climate classes (e.g., Koppen Geiger climate classification) for time 1</p>
</td></tr>
<tr><td><code id="aaClimate_+3A_c2">c2</code></td>
<td>
<p>A single layer Raster layer contains Climate classes (e.g., Koppen Geiger climate classification) for time 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given cell with a given climate class, the change in area of analogous climates represented the ratio (in percentage) of the difference between time 2 and time 1 area of that class to the time 1 area of the same class. Positive values indicated gains in area, negative values indicated losses, and null values reflect no change.
</p>
<p>The aaClimate first uses <code>apply.months</code> function to generate the monthly mean of climate parameter (results a Raster object with 12 layers correspond to 12 months) over each time period (t1 and t2); then uses the <code>kgc</code> function to generate the Koppen Geiger climate classification for each time period. Then the changes in the area of each class is calculated between time 1 and time 2. If the climate classification (regions) are available for time 1 and time 2, then the <code>aaClimateC</code> can be used instead.
</p>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#-------
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmin &lt;- rast(paste0(filePath,'/tmin.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

class(n)
length(n)

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmin.t &lt;- rts(tmin,n)
tmax.t &lt;- rts(tmax,n)
tmean.t &lt;- rts(tmean,n)
#------

pr.t # see the summary report of the raster time series object


###########################
# test of the metric:
#---------
#---------
# t1 (time1) = '1991/1990' takes all layers correspond to years between 1991-01-01 to 2000-12-31
# t2 (time2) = '2010/2020' takes all layers correspond to years between 2010-01-01 to 2020-12-31

aa &lt;- aaClimate(precip=pr.t,tmin=tmin.t,tmax=tmax.t,tmean=tmean.t,t1='1991/2000',t2='2010/2020')

plot(aa,main="Changes in the area of Analogous Climates")


########
# Alternatively, if the climate in both times are available as climate classes
# (e.g., Koppen Geiger climate classification), changes in the area of analogous 
# climate can be quantified using the aaClimateC function:

# Here, we first generate Koppen Geiger climate classification for time 1 and time 2, separately,
# To do so, we need the monthly average of climate variables (over years for each month):

# take the average of climate variables for each month over different years:

p12.1 &lt;- apply.months(pr.t[['1991/2000']],'mean')
p12.2 &lt;- apply.months(pr.t[['2010/2020']],'mean')

p12.1 # has 12 layers corresponding to 12 months

plot(p12.1)
#--
tmin12.1 &lt;- apply.months(tmin.t[['1991/2000']],'mean')
tmin12.2 &lt;- apply.months(tmin.t[['2010/2020']],'mean')
#--
tmax12.1 &lt;- apply.months(tmax.t[['1991/2000']],'mean')
tmax12.2 &lt;- apply.months(tmax.t[['2010/2020']],'mean')
#--
tmean12.1 &lt;- apply.months(tmean.t[['1991/2000']],'mean')
tmean12.2 &lt;- apply.months(tmean.t[['2010/2020']],'mean')
#--


##-------- now, the kgc function can be used to generate the climate classification map:
k1 &lt;- kgc(p=p12.1,tmin = tmin12.1,tmax=tmax12.1, tmean = tmean12.1)
k2 &lt;- kgc(p=p12.2,tmin = tmin12.2,tmax=tmax12.2, tmean = tmean12.2)

plot(k1, main= "Koppen Geiger climate classification - 1995")
plot(k2, main= "Koppen Geiger climate classification - 2015")

# Now, given the k1 and k2 climate classes, the changes in area of each class between two times
# are calculated using the aaClimateC function:

aa &lt;- aaClimateC(k1,k2)

plot(aa)





</code></pre>

<hr>
<h2 id='apply.months'>Apply a function on rasters of each month over years</h2><span id='topic+apply.months'></span><span id='topic+apply.months+2CRasterStackBrickTS-method'></span><span id='topic+apply.months+2CRasterStackBrick-method'></span><span id='topic+apply.months+2CSpatRaster-method'></span><span id='topic+apply.months+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Apply a user specified function over raster time series for each month separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  apply.months(x,FUN,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apply.months_+3A_x">x</code></td>
<td>
<p>A Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="apply.months_+3A_fun">FUN</code></td>
<td>
<p>A function to apply on rasters of each month over different years; The defaults if <code>mean</code></p>
</td></tr>
<tr><td><code id="apply.months_+3A_...">...</code></td>
<td>
<p>additional argument: if x is a Raster or SpatRaster object, corresponding dates should be specified in the <code>dates</code> argument</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output contains 12 raster layers corresponding to the 12 months (Jan-Dec.). For each of the available 12 months (from January to December), the corresponding rasters are selected and the <code>FUN</code> is applied. For example if the <code>FUN</code> is <code>mean</code>, the first layer in the output would be the mean of the rasters in January over different years, and the last later (12th layer) would be the mean of the rasters in December over different years.
</p>


<h3>Value</h3>

<p>A Raster object (RasterStackBrick or SpatRaster depending on the input) contains 12 layers correspond to 12 months (From Jan to Dec)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder


pr &lt;- rast(paste0(filePath,'/precip.tif'))

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresoinding dates

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 


###########################

p12 &lt;- apply.months(pr.t,'mean')


p12

plot(p12)


</code></pre>

<hr>
<h2 id='ccm'>Climate Change Metrics</h2><span id='topic+ccm'></span><span id='topic+ccm+2CSpatRasterTS-method'></span><span id='topic+ccm+2CSpatRaster-method'></span><span id='topic+ccm+2CRasterStackBrickTS-method'></span><span id='topic+ccm+2CRasterStackBrick-method'></span>

<h3>Description</h3>

<p>A function to quantify a single or multiple climate change metrics between two time periods given the climatic raster time series variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ccm(x,...,stat,t1,t2,extreme,longlat,ny,names,verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ccm_+3A_x">x</code></td>
<td>
<p>a Raster object or a Raster Time Series of a climate variable</p>
</td></tr>
<tr><td><code id="ccm_+3A_...">...</code></td>
<td>
<p>additional climate variables can be included as a Raster object or a Raster Time Series</p>
</td></tr>
<tr><td><code id="ccm_+3A_stat">stat</code></td>
<td>
<p>a character specifying the metric used to generate climate change metrics, can be one or multiple metrics including 'sed','novelClimate' ,'localExtreme', 'aaClimate', 'daClimate', 'velocity', 'gVelocity', 'dVelocity' (or their abbreviations)</p>
</td></tr>
<tr><td><code id="ccm_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="ccm_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="ccm_+3A_extreme">extreme</code></td>
<td>
<p>the percentile used for stat='lce', local climate extreme event change</p>
</td></tr>
<tr><td><code id="ccm_+3A_longlat">longlat</code></td>
<td>
<p>TRUE or FALSE, specifies whether the input data is geographic or projected</p>
</td></tr>
<tr><td><code id="ccm_+3A_ny">ny</code></td>
<td>
<p>integer; specifies the number of years between time 1 and time2, if the input is Raster time series, it will be identified by the function</p>
</td></tr>
<tr><td><code id="ccm_+3A_names">names</code></td>
<td>
<p>character with a length equal to the number of input climate variables; specifies the names of the input climate variables; for some metrics the names (precipitation, tmin, tmax, tmean) is required</p>
</td></tr>
<tr><td><code id="ccm_+3A_verbose">verbose</code></td>
<td>
<p>logical (default=TRUE), specifies whether the function print messages as a text output on the screen</p>
</td></tr>
</table>


<h3>Details</h3>

<p>multiple climate change metrics are available to quantify multiple dimensions of climate change between two times.
</p>
<p>The metrics include:
</p>
<p>- sed: Standardized Local Anomalies
</p>
<p>- localExtreme (lce): Changes in probability of local extremes
</p>
<p>- aaClimate (aac): Changes in areas of analogous climates
</p>
<p>- novelClimate (nc): Novel climates
</p>
<p>- daClimate (dac): Changes in distance to analogous climates
</p>
<p>- velocity (ve): Climate change velocity (based on the method represented in the paper Hamnan et al. (2015))
</p>
<p>- dVelocity (dVe): Distance-based climate change velocity (based on the method used in Garcia et al. (2014))
</p>
<p>- gVelocity (gVe): Gradiant-based climate change velocity (based on the method represented in Burrow et al. (2011))
</p>
<p>References:
</p>
<p>- Burrows MT, Schoeman DS, Buckley LB, Moore P, Poloczanska ES, Brander KM, Brown C, Bruno JF, Duarte CM, Halpern BS, Holding J. (2011) The pace of shifting climate in marine and terrestrial ecosystems. Science. Nov 4;334(6056):652-5.
</p>
<p>- Garcia, R.A., Cabeza, M., Rahbek, C. and Araújo, M.B. (2014). Multiple dimensions of climate change and their implications for biodiversity. Science, 344(6183).
</p>
<p>- Hamann, A., Roberts, D.R., Barber, Q.E., Carroll, C. and Nielsen, S.E. (2015). Velocity of climate change algorithms for guiding conservation and management. Global Change Biology, 21(2), pp.997-1004.
</p>


<h3>Value</h3>

<p>A Raster object (RasterLayer or RasterStackBrick or SpatRaster depending on the input) with single or multiple layers correspond to the selected metrics (stat)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>
<p><a href="https://r-gis.net/">https://r-gis.net/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
#-------
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmin &lt;- rast(paste0(filePath,'/tmin.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020


# n &lt;- names(pr)
# n &lt;- substring(n,2,11)
# head(n)
# n &lt;- as.Date(n,format = '%Y.%m.%d')


n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

class(n)
length(n)

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmin.t &lt;- rts(tmin,n)
tmax.t &lt;- rts(tmax,n)
tmean.t &lt;- rts(tmean,n)
#------

pr.t # see the summary report of the raster time series object

###########################
# test of the metric:
#---------
#---------
# t1 (time1) = '1991/1990' takes all layers correspond to years between 1991-01-01 to 2000-12-31
# t2 (time2) = '2010/2020' takes all layers correspond to years between 2010-01-01 to 2020-12-31


sed &lt;- ccm(pr.t,tmin.t,tmean.t,tmax.t,t1='1991/2000',t2='2010/2020',stat='sed')

plot(sed, main='Standardized Local Anomalies')


s2 &lt;- ccm(pr.t,tmin.t,tmean.t,tmax.t,t1='1991/2000',t2='2010/2020',stat=c('nc','sed'))

plot(s2)



#ve &lt;- ccm(pr.t,tmin.t,tmean.t,tmax.t,t1='1991/2000',t2='2010/2020',stat=c('gve','dve'))

#plot(ve)

# following, the extreme argument is needed for localExtreme (lce) metric:
s3 &lt;- ccm(pr.t,tmin.t,t1='1991/2000',t2='2010/2020',stat=c('localExtreme','sed')
          ,extreme = c(0.05,0.95))

plot(s3)






</code></pre>

<hr>
<h2 id='daClimate'>Changes in distance to Analogous Climates</h2><span id='topic+daClimate'></span><span id='topic+daClimateC'></span><span id='topic+daClimate+2CRasterStackBrick-method'></span><span id='topic+daClimate+2CSpatRaster-method'></span><span id='topic+daClimateC+2CRasterStackBrick-method'></span><span id='topic+daClimateC+2CSpatRaster-method'></span><span id='topic+daClimate+2CRasterStackBrickTS-method'></span><span id='topic+daClimate+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>Quantifies the changes in distances to analogous climates between two time periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  daClimate(precip,tmin, tmax, tmean,t1,t2)
  daClimateC(c1,c2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daClimate_+3A_precip">precip</code></td>
<td>
<p>A time series of precipitation as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="daClimate_+3A_tmin">tmin</code></td>
<td>
<p>A time series of minimum temperature as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="daClimate_+3A_tmax">tmax</code></td>
<td>
<p>A time series of maximum temperature as a Raster or Raster Time Series object</p>
</td></tr>
<tr><td><code id="daClimate_+3A_tmean">tmean</code></td>
<td>
<p>A time series of mean temperature as a Raster or Raster Time Series object; if not provided, it will be calculated from tmin and tmax</p>
</td></tr>
<tr><td><code id="daClimate_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="daClimate_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="daClimate_+3A_c1">c1</code></td>
<td>
<p>A single layer Raster layer contains Climate classes (e.g., Koggen Geiger climate classification) for time 1</p>
</td></tr>
<tr><td><code id="daClimate_+3A_c2">c2</code></td>
<td>
<p>A single layer Raster layer contains Climate classes (e.g., Koggen Geiger climate classification) for time 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a given cell, the function quantifies the distances to all cells with analogous climates in the time 1 period, i.e., belonging to the same climate class of the given cell. It also quantifies the distances to all cells that experience analogous climates in the time 2. Then, for each cell, it calculates the median of the great-circle distances (in km) below the 10th percentile of the distribution of all values, for both time 1 and time 2 periods, and maps the change over time. Negative values indicated a temporal decrease in distance, whereas positive values indicated an increase.
</p>
<p>The daClimate first uses <code>apply.months</code> function to generate the monthly mean of climate parameter (results a Raster object with 12 layers correspond to 12 months) over each time period (t1 and t2); then uses the <code>kgc</code> function to generate the Koppen Geiger climate classification for each time period. Then the changes in the area of each class is calculated between time 1 and time 2. If the climate classification (regions) are available for time 1 and time 2, then the <code>daClimateC</code> can be used instead.
</p>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

#-------
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmin &lt;- rast(paste0(filePath,'/tmin.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

class(n)
length(n)

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmin.t &lt;- rts(tmin,n)
tmax.t &lt;- rts(tmax,n)
tmean.t &lt;- rts(tmean,n)
#------

pr.t # see the summary report of the raster time series object


###########################
# test of the metric:
#---------
#---------
# t1 (time1) = '1991/1990' takes all layers correspond to years between 1991-01-01 to 2000-12-31
# t2 (time2) = '2010/2020' takes all layers correspond to years between 2010-01-01 to 2020-12-31

da &lt;- daClimate(precip=pr.t,tmin=tmin.t,tmax=tmax.t,tmean=tmean.t,t1='1991/2000',t2='2010/2020')

plot(da,main="Changes in distance to Analogous Climates")


########
# Alternatively, if the climate in both times are available as climate classes
# (e.g., Koppen Geiger climate classification), changes in distance to analogous 
# climate can be quantified using the daClimateC function:

# Here, we first generate Koppen Geiger climate classification for time 1 and time 2, separately,
# To do so, we need the monthly average of climate variables (over years for each month):

# take the average of climate variables for each month over different years:

p12.1 &lt;- apply.months(pr.t[['1991/2000']],'mean')
p12.2 &lt;- apply.months(pr.t[['2010/2020']],'mean')

p12.1 # has 12 layers corresponding to 12 months

plot(p12.1)
#--
tmin12.1 &lt;- apply.months(tmin.t[['1991/2000']],'mean')
tmin12.2 &lt;- apply.months(tmin.t[['2010/2020']],'mean')
#--
tmax12.1 &lt;- apply.months(tmax.t[['1991/2000']],'mean')
tmax12.2 &lt;- apply.months(tmax.t[['2010/2020']],'mean')
#--
tmean12.1 &lt;- apply.months(tmean.t[['1991/2000']],'mean')
tmean12.2 &lt;- apply.months(tmean.t[['2010/2020']],'mean')
#--

##-------- now, the kgc function can be used to generate the climate classification map:
k1 &lt;- kgc(p=p12.1,tmin = tmin12.1,tmax=tmax12.1, tmean = tmean12.1)
k2 &lt;- kgc(p=p12.2,tmin = tmin12.2,tmax=tmax12.2, tmean = tmean12.2)

plot(k1, main= "Koppen Geiger climate classification - 1995")
plot(k2, main= "Koppen Geiger climate classification - 2015")

# Now, given the k1 and k2 climate classes, the changes in distance to Analogous climate classes 
# between two times is calculated using the daClimateC function:

da &lt;- daClimateC(k1,k2)

plot(da)





</code></pre>

<hr>
<h2 id='dVelocity'>Distant-based Velocity of Climate Change</h2><span id='topic+dVelocity'></span><span id='topic+dVelocity+2CRasterStackBrickTS-method'></span><span id='topic+dVelocity+2CRasterStackBrick-method'></span><span id='topic+dVelocity+2CSpatRaster-method'></span><span id='topic+dVelocity+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>The method is developed based on the approach used in Garcia et al. (2014)
Gradiant-based velocity is also implemented in the package and is available through the <code>gVelocity</code> function.
</p>
<p>Garcia, R.A., Cabeza, M., Rahbek, C. and Araújo, M.B. (2014). Multiple dimensions of climate change and their implications for biodiversity. Science, 344(6183).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dVelocity(x,...,t1, t2, ny)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dVelocity_+3A_x">x</code></td>
<td>
<p>The first input climate variable that can be a RasterStack or RasterBrick, or a raster time series</p>
</td></tr>
<tr><td><code id="dVelocity_+3A_...">...</code></td>
<td>
<p>additional input climate variables in case of using multiple climate variables that can be entered as <code>v1, v2, ...</code></p>
</td></tr>
<tr><td><code id="dVelocity_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="dVelocity_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="dVelocity_+3A_ny">ny</code></td>
<td>
<p>integer; specifies the number of years between time 1 and time2, if the input is Raster time series, it is not needed as it will be identified by the function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # corresoinding dates

head(n) # Dates corresponds to the layers in climate variables

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmean.t &lt;- rts(tmean,n)
###########################


dv &lt;- dVelocity(pr.t,tmean.t,t1='1991/2000',t2='2010/2020')

plot(dv)


</code></pre>

<hr>
<h2 id='gVelocity'>Gradient-based Velocity of Climate Change</h2><span id='topic+gVelocity'></span><span id='topic+gVelocity+2CRasterStackBrickTS-method'></span><span id='topic+gVelocity+2CRasterStackBrick-method'></span><span id='topic+gVelocity+2CSpatRasterTS-method'></span><span id='topic+gVelocity+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>The method is developed based on Burrow et al. (2011) which is a gradient-based velocity of climate change. Climate velocity can inform conservation planning and action in a warming world.
</p>
<p>Distance-based velocity is also implemented in the package and is available through the ccm function.
</p>
<p>Burrows MT, Schoeman DS, Buckley LB, Moore P, Poloczanska ES, Brander KM, Brown C, Bruno JF, Duarte CM, Halpern BS, Holding J. The pace of shifting climate in marine and terrestrial ecosystems. Science. 2011 Nov 4;334(6056):652-5..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  gVelocity(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gVelocity_+3A_x">x</code></td>
<td>
<p>a Raster object or a Raster Time Series of climate variable</p>
</td></tr>
<tr><td><code id="gVelocity_+3A_...">...</code></td>
<td>
<p>additional arguments; not implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))

#gv &lt;- gVelocity(pr)

#plot(gv, main='Gradiant-based Velocity for Precipitation')



</code></pre>

<hr>
<h2 id='kgc'>Koggen Geiger climate classification</h2><span id='topic+kgc'></span><span id='topic+kgc+2CRasterStackBrick+2CRasterStackBrick+2CRasterStackBrick-method'></span><span id='topic+kgc+2CSpatRaster+2CSpatRaster+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>Given the monthly mean (12 months) of Precipitation, minimum, maximum, and mean temperature datasets, this function identify climate zones following Koppen Geiger climate classification rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  kgc(p,tmin, tmax, tmean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kgc_+3A_p">p</code></td>
<td>
<p>A Raster object contains 12 months precipitation</p>
</td></tr>
<tr><td><code id="kgc_+3A_tmin">tmin</code></td>
<td>
<p>A Raster object contains 12 months minimum temperature</p>
</td></tr>
<tr><td><code id="kgc_+3A_tmax">tmax</code></td>
<td>
<p>A Raster object contains 12 months maximum temperature</p>
</td></tr>
<tr><td><code id="kgc_+3A_tmean">tmean</code></td>
<td>
<p>A Raster object contains 12 months mean temperature</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the input object is not a 12 month Raster object but a time series, the function first calls the <code>apply.months</code> to get the 12 month raster object.
</p>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmin &lt;- rast(paste0(filePath,'/tmin.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

class(n)
length(n)

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmin.t &lt;- rts(tmin,n)
tmax.t &lt;- rts(tmax,n)
tmean.t &lt;- rts(tmean,n)
#------

pr.t # see the summary report of the raster time series object


###########################

# To generate Koppen Geiger climate classification, we need the monthly average of 
# climate variables (over years for each month):

# you can use apply.months function to take the average of climate variables for each month
# over different years that generates 12 layers corresponds to 12 months:

p12 &lt;- apply.months(pr.t[['1991/2000']],'mean')


p12

# plot(p12)

#--
tmin12 &lt;- apply.months(tmin.t[['1991/2000']],'mean')

tmax12 &lt;- apply.months(tmax.t[['1991/2000']],'mean')

tmean12 &lt;- apply.months(tmean.t[['1991/2000']],'mean')


##-------- now, the kgc function can be used to generate the climate classification map:
k1 &lt;- kgc(p=p12,tmin = tmin12,tmax=tmax12, tmean = tmean12)

k1

plot(k1)




</code></pre>

<hr>
<h2 id='localExtreme'>Changes in probability of local extremes</h2><span id='topic+localExtreme'></span><span id='topic+localExtreme+2CSpatRasterTS-method'></span><span id='topic+localExtreme+2CSpatRaster-method'></span><span id='topic+localExtreme+2CRasterStackBrickTS-method'></span><span id='topic+localExtreme+2CRasterStackBrick-method'></span><span id='topic+localExtreme+2Clist+2Clist-method'></span><span id='topic+localExtreme+2Cmissing+2Cmissing+2Clist+2Clist-method'></span><span id='topic+localExtreme+2CSpatRasterTS+2CANY+2CANY+2CANY-method'></span><span id='topic+localExtreme+2CSpatRaster+2CANY+2CANY+2CANY-method'></span><span id='topic+localExtreme+2CRasterStackBrickTS+2CANY+2CANY+2CANY-method'></span><span id='topic+localExtreme+2CRasterStackBrick+2CANY+2CANY+2CANY-method'></span><span id='topic+localExtreme+2Clist+2Clist+2CANY+2CANY-method'></span>

<h3>Description</h3>

<p>Probability of changes in local extremes is calculated at each cell based on either one or two climate variables (e.g., precipitation and temperature). For each climate variable, the extreme value (percentile of the extreme in the variable distribution) should be specified by user in the extreme parameter. For instance, if temperature and precipitation are specified as the first and second inputs (x1 and x2), extreme=c(0.95,0.05) may be used that considered 95th and 5th percentiles of the distribution of the temperature and precipitation time series, respectively over the first time period, and then it calculates the probability that the time1 percentile will be exceeded in time2. 
If two climate variables are used (e.g., temperature and precipitation), for each cell, the two probabilities are summed from which the product of the two probabilities are subtracted to obtain a measure of the probability of occurrence of either of the two extreme events (to avoid counting probabilities twice). The  probability of time_1 extreme climates in time_2, is then subtracted from the probability of time_1 extreme climates to obtain the changes in the probability of extreme climate variables. Positive values indicated increased probability in time 2, whereas negative values indicated a decrease. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  localExtreme(x1,x2,t1,t2,extreme)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="localExtreme_+3A_x1">x1</code></td>
<td>
<p>Time Series of the first climate variable as a Raster or Raster Time Series Object</p>
</td></tr>
<tr><td><code id="localExtreme_+3A_x2">x2</code></td>
<td>
<p>Time Series of the second climate variable as a Raster or Raster Time Series Object; <code>x1</code> and <code>x2</code> can be lists of time series of climate variables in time 1 and time 2, respectively</p>
</td></tr>
<tr><td><code id="localExtreme_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="localExtreme_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="localExtreme_+3A_extreme">extreme</code></td>
<td>
<p>a numeric vector with a length of one or two (depends on whether one or two climate variables are used as input), specifying the percentile of extreme value in the input (first value corresponds to x1 and second corresponds to x2 climate variables) </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmax.t &lt;- rts(tmax,n)

###########################
# test of the metric:

# The extreme argument corresponds to the first and second climate variables
# (i.e., x1 and x2; precipitation and temperature) that specify the percentile of the extreme 
# condition in climate variable; here, 0.05 is used for precipitation; and 0.95 for temperature

le &lt;- localExtreme(x1=pr.t,x2=tmax.t,t1='1991/2000',t2='2010/2020', extreme = c(0.05, 0.95))

plot(le, main='Probability of Changes in Local Climate Extreme')






</code></pre>

<hr>
<h2 id='novelClimate'>Novel Climates</h2><span id='topic+novelClimate'></span><span id='topic+novelClimate+2CSpatRasterTS-method'></span><span id='topic+novelClimate+2CSpatRaster-method'></span><span id='topic+novelClimate+2CRasterStackBrickTS-method'></span><span id='topic+novelClimate+2CRasterStackBrick-method'></span><span id='topic+novelClimate+2Cmissing-method'></span>

<h3>Description</h3>

<p>Novel climate is one of the climate change metrics to quantify the dissimilarities between climate parameters between two time periods. This metric uses standard euclidean distance between each cell in Time 2 and all cells in Time 1 and  retains the minimum of those distances. The inter-annual standard deviation for each parameter is used for the standardization. The larger the score, the more dissimilar the climate in Time 2 is in relation to the global pool of potential climatic analogues.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  novelClimate(x,...,t1,t2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="novelClimate_+3A_x">x</code></td>
<td>
<p>a Raster object or a Raster Time Series of a climate variable</p>
</td></tr>
<tr><td><code id="novelClimate_+3A_...">...</code></td>
<td>
<p>additional climate variables can be included as a Raster object or a Raster Time Series</p>
</td></tr>
<tr><td><code id="novelClimate_+3A_t1">t1</code></td>
<td>
<p>a character or a numeric vector, specifying the index of raster layers for time 1; if <code>x</code> is missing, <code>t1</code> and <code>t2</code> can be list of climate variables in time 1 and time 2, respectively.</p>
</td></tr>
<tr><td><code id="novelClimate_+3A_t2">t2</code></td>
<td>
<p>a character or a numeric vector, specifying the index of raster layers for time 2;  if <code>x</code> is missing, <code>t1</code> and <code>t2</code> can be list of climate variables in time 1 and time 2, respectively.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmean &lt;- rast(paste0(filePath,'/tmean.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmean.t &lt;- rts(tmean,n)

###########################
# test of the metric:

n1 &lt;- novelClimate(pr.t,tmean.t,t1='1991/2000',t2='2010/2020') 

plot(n1, main='Novel Climate')

######
# if the input object is SpatRaster (or RasterStack or RasterBrick) object:
# t1 and t2 would be the numbers specifying which layers correspond to time1 and time2:

n2 &lt;- novelClimate(pr,tmean,t1=1:120,t2=229:360)  

plot(n2)




</code></pre>

<hr>
<h2 id='sed'>Standardized Local Anomalies</h2><span id='topic+sed'></span><span id='topic+sed+2CSpatRasterTS-method'></span><span id='topic+sed+2CSpatRaster-method'></span><span id='topic+sed+2CRasterStackBrickTS-method'></span><span id='topic+sed+2CRasterStackBrick-method'></span><span id='topic+sed+2Cmissing-method'></span>

<h3>Description</h3>

<p>Standardized Local Anomalies is one of the climate change metrics to quantify the change between two time periods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  sed(x,...,t1,t2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sed_+3A_x">x</code></td>
<td>
<p>a Raster object or a Raster Time Series of a climate variable</p>
</td></tr>
<tr><td><code id="sed_+3A_...">...</code></td>
<td>
<p>additional climate variables can be included as a Raster object or a Raster Time Series</p>
</td></tr>
<tr><td><code id="sed_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="sed_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmin &lt;- rast(paste0(filePath,'/tmin.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresponding dates

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmin.t &lt;- rts(tmin,n)
tmax.t &lt;- rts(tmax,n)

###########################
# test of the metric:

s &lt;- sed(pr.t,tmin.t,tmax.t,t1='1991/2000',t2='2010/2020') 

plot(s, main='Standardized Local Anomalies')

######
# if the input object is SpatRaster (or RasterStack or RasterBrick) object:
# t1 and t2 would be the numbers specifying which layers correspond to time1 and time2:

s &lt;- sed(pr,tmin,tmax,t1=1:120,t2=229:360)  

plot(s)






</code></pre>

<hr>
<h2 id='temporalTrend'>Temporal Trend (Slope) of a climate variable</h2><span id='topic+temporalTrend'></span><span id='topic+temporalTrend+2CRasterStackBrickTS-method'></span><span id='topic+temporalTrend+2CRasterStackBrick-method'></span><span id='topic+temporalTrend+2CSpatRasterTS-method'></span><span id='topic+temporalTrend+2CSpatRaster-method'></span>

<h3>Description</h3>

<p>The method calculates the trend of a climate variable changes over time. The function use a Raster time series as input and returns a Raster object that represent the trend at the pixel level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  temporalTrend(x,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temporalTrend_+3A_x">x</code></td>
<td>
<p>a Raster object or a Raster Time Series of climate variable</p>
</td></tr>
<tr><td><code id="temporalTrend_+3A_...">...</code></td>
<td>
<p>additional arguments; not implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))

tr &lt;- temporalTrend(pr)

# plot(tr, main='Trend (slope) of Precipitation time series')

</code></pre>

<hr>
<h2 id='velocity'>Velocity of Climate Change</h2><span id='topic+velocity'></span><span id='topic+velocity+2CRasterStackBrickTS+2CRasterStackBrickTS-method'></span><span id='topic+velocity+2CRasterStackBrick+2CRasterStackBrick-method'></span><span id='topic+velocity+2CSpatRaster+2CSpatRaster-method'></span><span id='topic+velocity+2CSpatRasterTS+2CSpatRasterTS-method'></span>

<h3>Description</h3>

<p>The method is developed based on the method represented in the paper Hamnan et al. (2015). Two additional functions including Distance-based (<code>dVelocity</code>) and Gradiant-based velocity  (<code>gVelocity</code>) are also implemented and available in the package.
</p>
<p>- Hamann, A., Roberts, D.R., Barber, Q.E., Carroll, C. and Nielsen, S.E. (2015). Velocity of climate change algorithms for guiding conservation and management. Global Change Biology, 21(2), pp.997-1004.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  velocity(x1,x2,t1, t2,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="velocity_+3A_x1">x1</code></td>
<td>
<p>The first input climate variable that can be a RasterStack or RasterBrick, or a raster time series</p>
</td></tr>
<tr><td><code id="velocity_+3A_x2">x2</code></td>
<td>
<p>The second input climate variable that can be a RasterStack or RasterBrick, or a raster time series</p>
</td></tr>
<tr><td><code id="velocity_+3A_t1">t1</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 1</p>
</td></tr>
<tr><td><code id="velocity_+3A_t2">t2</code></td>
<td>
<p>a chanracter or a numeric vector, specifying the index of raster layers for time 2</p>
</td></tr>
<tr><td><code id="velocity_+3A_...">...</code></td>
<td>
<p>not implemented</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single Raster layer (RasterLayer or SpatRaster depending on the input)
</p>


<h3>Author(s)</h3>

<p>Shirin Taheri; Babak Naimi
</p>
<p><a href="mailto:taheri.shi@gmail.com">taheri.shi@gmail.com</a>; <a href="mailto:naimi.b@gmail.com">naimi.b@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

filePath &lt;- system.file("external/", package="climetrics") # path to the dataset folder

# read the climate variables using the terra package (you can use the raster package as well):

pr &lt;- rast(paste0(filePath,'/precip.tif'))
tmax &lt;- rast(paste0(filePath,'/tmax.tif'))

pr # has 360 layers corresponds to months of the years 1991-2020

n &lt;- readRDS(paste0(filePath,'/dates.rds')) # read corresoinding dates

head(n) # Dates corresponds to the layers in climate variables (pr, tmin, tmax, tmean)

####################

# use rts function in the rts package to make a raster time series:

pr.t &lt;- rts(pr,n) 
tmax.t &lt;- rts(tmax,n)

###########################
# test of the metric:

# The extreme argument corresponds to the first and second climate variables
# (i.e., x1 and x2; precipitation and temperature) that specify the percentile of the extreme 
# condition in climate variable; here, 0.05 is used for precipitation; and 0.95 for temperature

ve &lt;- velocity(x1=pr.t,x2=tmax.t,t1='1991/2000',t2='2010/2020')

# plot(ve, main='Velocity of Climate Change')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
