<!DOCTYPE html><html><head><title>Help for package ANOPA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ANOPA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ANOPA-package'><p>ANOPA: Analyses of Proportions using Anscombe Transform</p></a></li>
<li><a href='#A'><p>transformation functions</p></a></li>
<li><a href='#anopa'><p>ANOPA: analysis of proportions using Anscombe transform.</p></a></li>
<li><a href='#anopa_asn_trans1'><p>anopaPlot: Easy plotting of proportions.</p></a></li>
<li><a href='#anopaN2Power'><p>Computing power within the ANOPA.</p></a></li>
<li><a href='#ArringtonEtAl2002'><p>Arrington et al. (2002) dataset</p></a></li>
<li><a href='#ArticleExample1'><p>ArticleExample1</p></a></li>
<li><a href='#ArticleExample2'><p>ArticleExample2</p></a></li>
<li><a href='#ArticleExample3'><p>ArticleExample3</p></a></li>
<li><a href='#contrastProportions'><p>contrastProportion: analysis of contrasts between proportions using Anscombe transform.</p></a></li>
<li><a href='#conversion'><p>Converting between formats</p></a></li>
<li><a href='#corrected'><p>corrected</p></a></li>
<li><a href='#emProportions'><p>emProportions: simple effect analysis of proportions.</p></a></li>
<li><a href='#explain'><p>explain</p></a></li>
<li><a href='#minimalExamples'><p>A collection of minimal Examples from various designs with one or two factors.</p></a></li>
<li><a href='#posthocProportions'><p>posthocProportions: post-hoc analysis of proportions.</p></a></li>
<li><a href='#rBernoulli'><p>Generating random proportions with GRP</p></a></li>
<li><a href='#summarize'><p>summarize</p></a></li>
<li><a href='#uncorrected'><p>uncorrected</p></a></li>
<li><a href='#unitaryAlpha'><p>unitary alpha</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analyses of Proportions using Anscombe Transform</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Denis Cousineau [aut, ctb, cre],
  Louis Laurencelle [aut, ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Denis Cousineau &lt;denis.cousineau@uottawa.ca&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/dcousin3/ANOPA/issues/">https://github.com/dcousin3/ANOPA/issues/</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dcousin3.github.io/ANOPA/">https://dcousin3.github.io/ANOPA/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>
    Analyses of Proportions can be performed on the Anscombe (arcsine-related) transformed  
    data. The 'ANOPA' package can analyze proportions obtained from up to 
    four factors. The factors can be within-subject or between-subject or a mix 
    of within- and between-subject. The main, omnibus analysis can be followed by
    additive decompositions into interaction effects, main effects, simple 
    effects, contrast effects, etc., mimicking precisely the logic of ANOVA. For
    that reason, we call this set of tools 'ANOPA' (Analysis of Proportion
    using Anscombe transform) to highlight its similarities with ANOVA. 
    The 'ANOPA' framework also allows plots of proportions easy to obtain 
    along with confidence intervals. Finally, effect sizes and planning statistical 
    power are easily done under this framework. Only particularity, the 'ANOPA' computes  
    F statistics which have an infinite degree of freedom on the denominator. 
    See Laurencelle and Cousineau (2023) &lt;<a href="https://doi.org/10.3389%2Ffpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>superb (&ge; 0.95.0), Rdpack (&ge; 0.7), ggplot2 (&ge; 3.1.0),
scales (&ge; 1.2.1), stats, rrapply, utils, plyr (&ge; 1.8.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat, knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 17:29:39 UTC; Utlisateur</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-22 19:40:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ANOPA-package'>ANOPA: Analyses of Proportions using Anscombe Transform</h2><span id='topic+ANOPA'></span><span id='topic+ANOPA-package'></span>

<h3>Description</h3>

<p>'ANOPA' is a library to perform proportion analyses.
It is based on the F statistics (first developed by Fisher).
This statistics is fully additive and can be decomposed in
main effects and interaction effects, in simple effects in the
decomposition of a significant interaction, in contrasts, etc.
The present library performs these analyses and also can be used
to plan statistical power for the analysis of proportions, obtain
plots of the various effects, etc. It aims at replicating the most
commonly-used ANOVA commands so that using this package should be
easy.
</p>
<p>The data supplied to an ANOPA can be in three formats: (i) long format,
(ii) wide format, (iii) compiled format, or (iv) raw format. Check
the 'anopa' commands for more precision (in what follow, we assume
the compiled format where the proportions are given in a column name 'Freq')
</p>
<p>The main function is
</p>
<p><code>w &lt;- anopa(formula, data)</code>
</p>
<p>where <code>formula</code> is a formula giving the factors, e.g., &quot;Freq ~ A * B&quot;.
</p>
<p>For more details on the underlying math, see Laurencelle and Cousineau (2023).
</p>
<p>An omnibus analysis may be followed by simple effects or contrasts analyses:
<code>emProportions(w, formula)</code>
<code>contrast(w, listOfContrasts)</code>
</p>
<p>As usual, the output can be obtained with
<code>print(w) #implicite</code>
<code>summary(w) # or summarize(w) for the G statistics table</code>
<code>explain(w) # for human-readable output</code>
</p>
<p>Data format can be converted to other format with
<code>toLong(w)</code>
<code>toWide(w)</code>
<code>toCompiled(w) # the only format that cannot be used as input to anopa</code>
</p>
<p>The package includes additional, helper, functions: </p>

<ul>
<li><p><code>anopaPower2N()</code> to compute sample size given effect size;
</p>
</li>
<li><p><code>anopaN2Power()</code> to compute statistical power given a sample size;
</p>
</li>
<li><p><code>anopaPropTofsq()</code> to compute the effect size;
</p>
</li>
<li><p><code>anopaPlot()</code> to obtain a plot of the proportions with error bars;
</p>
</li>
<li><p><code>GRP()</code> to generate random proportions from a given design.
</p>
</li></ul>

<p>and example datasets, some described in the article:  </p>

<ul>
<li><p><code>ArringtonEtAl2002</code> illustrates a 3 x 2 x 4 design;
</p>
</li>
<li><p><code>ArticleExample1</code> illustrates a 4-way design;
</p>
</li>
<li><p><code>ArticleExample2</code> illustrates a 2 x 3  design;
</p>
</li>
<li><p><code>ArticleExample3</code> illustrates a (4) within-subject design;
</p>
</li></ul>

<p>The functions uses the following options: </p>

<ul>
<li><p><code>ANOPA.feedback</code> 'design', 'warnings', 'summary', 'all' or 'none';
</p>
</li>
<li><p><code>ANOPA.zeros</code>    how are handled the zero trials to avoid 0 divided by 0 error;
</p>
</li>
<li><p><code>ANOPA.digits</code>   for the number of digits displayed in the summary table.
</p>
</li></ul>



<h3>Details</h3>

<p>ANOPA library for analyses of proportions using Anscombe transform
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Denis Cousineau <a href="mailto:denis.cousineau@uottawa.ca">denis.cousineau@uottawa.ca</a> [contributor]
</p>
<p>Authors:
</p>

<ul>
<li><p> Louis Laurencelle <a href="mailto:louis.laurencelle@gmail.com">louis.laurencelle@gmail.com</a> [contributor]
</p>
</li></ul>



<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://dcousin3.github.io/ANOPA/">https://dcousin3.github.io/ANOPA/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/dcousin3/ANOPA/issues/">https://github.com/dcousin3/ANOPA/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='A'>transformation functions</h2><span id='topic+A'></span><span id='topic+varA'></span><span id='topic+Atrans'></span><span id='topic+SE.Atrans'></span><span id='topic+var.Atrans'></span><span id='topic+CI.Atrans'></span><span id='topic+prop'></span><span id='topic+CI.prop'></span>

<h3>Description</h3>

<p>The transformation functions 'A()' performs the
Anscombe transformation on a pair {number of success; number
of trials} = {s; n} (where the symbol &quot;;&quot; is to be read &quot;over&quot;.
The function 'varA()' returns the theoretical variance from
the pair {s; n}. Both functions are central to the ANOPA
(Laurencelle and Cousineau 2023). It was originally proposed by
(Zubin 1935) and formalized by (Anscombe 1948).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>A(s, n)

varA(s, n)

Atrans(v)

SE.Atrans(v)

var.Atrans(v)

CI.Atrans(v, gamma)

prop(v)

CI.prop(v, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="A_+3A_s">s</code></td>
<td>
<p>a number of success;</p>
</td></tr>
<tr><td><code id="A_+3A_n">n</code></td>
<td>
<p>a number of trials.</p>
</td></tr>
<tr><td><code id="A_+3A_v">v</code></td>
<td>
<p>a vector of 0s and 1s.</p>
</td></tr>
<tr><td><code id="A_+3A_gamma">gamma</code></td>
<td>
<p>a confidence level, default to .95 when omitted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functions <code>A()</code> and <code>varA()</code> take as input two integers, <code>s</code>
the number of success and <code>n</code> the number of observations.
The functions <code>Atrans()</code>, <code>SE.Atrans()</code>, <code>var.Atrans()</code>, <code>CI.Atrans()</code>, <code>prop()</code> and <code>CI.prop()</code>
take as input a single vector <code>v</code> of 0s and 1s from which the number of
success and the number of observations are derived.
</p>


<h3>Value</h3>

<p><code>A()</code> returns a score between 0 and 1.57 where a <code>s</code> of zero results in
<code>A(0,n)</code> tending to zero when the number of trials is large,
and where the maximum occurs when <code>s</code> equals <code>n</code> and
are both very large, so that for example <code>A(1000,1000) = 1.55</code>. The
midpoint is always 0.786 irrespective of the number of trials
<code>A(0.5 * n, n) = 0.786</code>.
The function <code>varA()</code> returns the theoretical variance of an Anscombe
transformed score. It is exact as <code>n</code> gets large, and overestimate variance
when <code>n</code> is small. Therefore, a test based on this transform is either exact
or conservative.
</p>


<h3>References</h3>

<p>Anscombe FJ (1948).
&ldquo;The transformatin of poisson, binormial and negative-binomial data.&rdquo;
<em>Biometrika</em>, <b>35</b>, 246–254.
<a href="https://doi.org/10.1093/biomet/35.3-4.246">doi:10.1093/biomet/35.3-4.246</a>.<br /><br /> Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.<br /><br /> Zubin J (1935).
&ldquo;Note on a transformation function for proportions and percentages.&rdquo;
<em>Journal of Applied Psychology</em>, <b>19</b>, 213–220.
<a href="https://doi.org/10.1037/h0057566">doi:10.1037/h0057566</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The transformations from number of 1s and total number of observations:
A(5, 10)
 
varA(5, 10)
 
# Same with a vector of observations:
Atrans( c(1,1,1,1,1,0,0,0,0,0) )
 
var.Atrans( c(1,1,1,1,1,0,0,0,0,0) )
 


</code></pre>

<hr>
<h2 id='anopa'>ANOPA: analysis of proportions using Anscombe transform.</h2><span id='topic+anopa'></span>

<h3>Description</h3>

<p>The function 'anopa()' performs an ANOPA for designs with up to 4 factors
according to the 'ANOPA' framework. See Laurencelle and Cousineau (2023) for more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anopa(formula = NULL, data = NULL, WSFactors = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anopa_+3A_formula">formula</code></td>
<td>
<p>A formula with the factors on the left-hand side. See below for writing the
formula to match the data format.</p>
</td></tr>
<tr><td><code id="anopa_+3A_data">data</code></td>
<td>
<p>Dataframe in one of wide, long, or compiled format;</p>
</td></tr>
<tr><td><code id="anopa_+3A_wsfactors">WSFactors</code></td>
<td>
<p>For within-subjet designs, provide the factor names and their number of levels.
This is expressed as a vector of strings such as &quot;Moment(2)&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note the following limitations:
</p>

<ol>
<li><p> The main analysis performed by <code>anopa()</code> is currently restricted to four
factors in total (between and/or within). Contact the author if you plan to analyse
more complex designs.
</p>
</li>
<li><p> If you have repeated-measure design, the data <em>must</em> be provided in wide or
long format. The correlation between successes cannot be assessed once the data are
in a compiled format.
</p>
</li>
<li><p> The data can be given in three formats:
</p>

<ul>
<li> <p><code>wide</code>: In the wide format, there is one line for each participant, and
one column for each between-subject factors in the design. In the column(s), the level
of the factor is given (as a number, a string, or a factor). For within-subject
factors, the columns contains 0 or 1 based on the status of the measurement.
</p>
</li>
<li> <p><code>long</code>: In the long format, there is an identifier column for each participant,
a factor column and a level number for that factor. If there are n participants
and m factors, there will be in total n x m lines.
</p>
</li>
<li> <p><code>compiled</code>: In the compiled format, there are as many lines as there are cells in the
design. If there are two factors, with two levels each, there will be 4 lines.
</p>
</li></ul>

</li></ol>

<p>See the vignette <a href="../articles/B-DataFormatsForProportions.html"><code>DataFormatsForProportions</code></a>
for more on data format and how to write their formula.
</p>


<h3>Value</h3>

<p>An omnibus analyses of the given proportions. Each factor's significance is
assessed, as well as their interactions when there is more than one factor. For
decomposition of the main analyses, follow the analysis with <code>emProportions()</code>,
<code>contrastProportions()</code>, or <code>posthocProportions()</code>)
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># -- FIRST EXAMPLE --
# Basic example using a single between-subject factor design with the data in compiled format. 
# Ficticious data present success (1) or failure (0) of the observation according
# to the state of residency (three levels: Florida, Kentucky or Montana) for 
# 3 possible cells. There are 175 observations (with unequal n, Montana having only)
# 45 observations). 
minimalBSExample
# The data are in compiled format, consequently the data frame has only three lines.
# The complete data frame in wide format would be composed of 175 lines, one per participant.

# The following formula using curly braces is describing this data format
# (note the semicolon to separate the number of successes from the number of observations):
formula &lt;- {s; n} ~ state

# The analysis is performed using the function `anopa()` with a formula and data:
w &lt;- anopa(formula, minimalBSExample) 
summary(w)
# As seen, the proportions of success do not differ across states.

# To see the proportions when the data is in compiled format, simply divide the 
# number of success (s) by the total number of observations (n):
minimalBSExample$s / minimalBSExample$n

# A plot of the proportions with error bars (default 95% confidence intervals) is
# easily obtained with
anopaPlot(w)

# The data can be re-formated into different formats with, 
# e.g., `toRaw()`, `toLong()`, `toWide()`
head(toWide(w))
# In this format, only 1s and 0s are shown, one participant per line.
# See the vignette `DataFormatsForFrequencies` for more.

# -- SECOND EXAMPLE --
# Real-data example using a three-factor design with the data in compiled format:
ArringtonEtAl2002

#  This dataset, shown in compiled format, has three cells missing 
# (e.g., fishes whose location is African, are Detrivore, feeding Nocturnally)
w &lt;- anopa( {s;n} ~ Location * Trophism * Diel, ArringtonEtAl2002 )

# The function `anopa()` generates the missing cells with 0 success over 0 observations.
# Afterwards, cells with missing values are imputed  based on the option:
getOption("ANOPA.zeros")
# where 0.05 is 1/20 of a success over one observations (arcsine transforms allows 
# fractions of success; it remains to be studied what imputation strategy is best...)

# The analysis suggests a main effect of Trophism (type of food ingested)
# but the interaction Trophism by Diel (moment of feeding) is not to be neglected...
summary(w) # or summarize(w)

# The above presents both the uncorrected statistics as well as the corrected
# ones for small samples [@w76]. You can obtain only the uncorrected...
uncorrected(w)

#... or the corrected ones
corrected(w)


# You can also ask easier outputs with:
explain(w)   # human-readable ouptut NOT YET DONE


</code></pre>

<hr>
<h2 id='anopa_asn_trans1'>anopaPlot: Easy plotting of proportions.</h2><span id='topic+anopa_asn_trans1'></span><span id='topic+anopaPlot'></span>

<h3>Description</h3>

<p>The function 'anopaPlot()' performs a plot of proportions for designs
with up to 4 factors according to the
'ANOPA' framework. See Laurencelle and Cousineau (2023) for more. The plot is
realized using the 'suberb' library; see Cousineau et al. (2021).
It uses the arc-sine transformation 'A()'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anopaPlot(w, formula, confidenceLevel = .95, allowImputing = FALSE,
		showPlotOnly = TRUE, plotStyle = "line", 
     errorbarParams  = list( width =0.5, linewidth=0.75 ), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anopa_asn_trans1_+3A_w">w</code></td>
<td>
<p>An ANOPA object obtained with <code>anopa()</code>;</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_formula">formula</code></td>
<td>
<p>(optional) Use formula to plot just specific terms of the omnibus test.
For example, if your analysis stored in <code>w</code> has factors A, B and C, then
<code>anopaPlot(w, ~ A * B)</code> will only plot the factors A and B.</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_confidencelevel">confidenceLevel</code></td>
<td>
<p>Provide the confidence level for the confidence intervals
(default is 0.95, i.e., 95%).</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_allowimputing">allowImputing</code></td>
<td>
<p>(default FALSE) if there are cells with no observations, can they be
imputed? If imputed, the option &quot;ANOPA.zeros&quot; will be used to determine
how many additional observations to add, and with how many successes.
If for example, the option is (by default) <code>c(0.05, 1)</code>, then
20 cases will be added, only one being a success (respecting the .05 target).
<em>Keep in mind that imputations has never been studies with regards to proportions
so be mindfull that the default optin has never been tested nor validated.</em></p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_showplotonly">showPlotOnly</code></td>
<td>
<p>(optional, default True) shows only the plot or else
shows the numbers needed to make the plot yourself.</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_plotstyle">plotStyle</code></td>
<td>
<p>(optional; default &quot;line&quot;) How to plot the proportions;
see superb for other layouts (e.g., &quot;line&quot;).</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_errorbarparams">errorbarParams</code></td>
<td>
<p>(optional; default list( width =0.5, linewidth=0.75 ) ) is
a list of attributes used to plot the error bars. See superb for more.</p>
</td></tr>
<tr><td><code id="anopa_asn_trans1_+3A_...">...</code></td>
<td>
<p>Other directives sent to superb(), typically 'plotStyle',
'errorbarParams', etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot shows the proportions on the vertical axis as a
function of the factors (the first on the horizontal axis, the second
if any in a legend; and if a third or even a fourth factors are present,
as distinct rows and columns). It also shows 95% confidence intervals of
the proportions, adjusted for between-cells comparisons.
The confidence intervals are based on a z distribution, which is adequate
for large samples (Chen 1990; Lehman and Loh 1990). This &quot;stand-alone&quot; confidence
interval is then adjusted for between-cell comparisons using the <em>superb</em>
framework (Cousineau et al. 2021).
</p>
<p>See the vignette <a href="../articles/B-DataFormatsForProportions.html"><code>DataFormatsForProportions</code></a>
for more on data formats and how to write their formula.
See the vignette <a href="../articles/C-ConfidenceIntervals.html"><code>ConfidenceIntervals</code></a> for
details on the adjustment and its purpose.
</p>


<h3>Value</h3>

<p>a ggplot2 object of the given proportions.
</p>


<h3>References</h3>

<p>Chen H (1990).
&ldquo;The accuracy of approximate intervals for a binomial parameter.&rdquo;
<em>Journal of the American Statistical Associtation</em>, <b>85</b>, 514–518.
<a href="https://doi.org/10.1080/01621459.1990.10476229">doi:10.1080/01621459.1990.10476229</a>.<br /><br /> Cousineau D, Goulet M, Harding B (2021).
&ldquo;Summary plots with adjusted error bars: The superb framework with an implementation in R.&rdquo;
<em>Advances in Methods and Practices in Psychological Science</em>, <b>4</b>, 1&ndash;18.
<a href="https://doi.org/10.1177/25152459211035109">doi:10.1177/25152459211035109</a>.<br /><br /> Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.<br /><br /> Lehman EL, Loh W (1990).
&ldquo;Pointwise versus uniform robustness of some large-sample tests and confidence intervals.&rdquo;
<em>Scandinavian Journal of Statistics</em>, <b>17</b>, 177–187.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 
# The Arrington Et Al., 2002, data on fishes' stomach
ArringtonEtAl2002

# This examine the omnibus analysis, that is, a 3 x 2 x 4 ANOPA:
w &lt;- anopa( {s;n} ~ Location * Trophism * Diel, ArringtonEtAl2002) 

# Once processed into w, we can ask for a standard plot
anopaPlot(w)

# As you may notice, there are points missing because the data have
# three missing cells. The litterature is not clear what should be 
# done with missing cells. In this package, we propose to impute
# the missing cells based on the option `getOption("ANOPA.zeros")`.
# Consider this option with care.  
anopaPlot(w, allowImputing = TRUE)

# We can place the factor `Diel` on the x-axis (first):
anopaPlot(w, ~ Diel * Trophism * Location )

# Change the style for a plot with bars instead of lines
anopaPlot(w, plotStyle = "bar")

# Changing the error bar style
anopaPlot(w, plotStyle = "bar", errorbarParams = list( width =0.1, linewidth=0.1 ) )

# Illustrating the main effect of Location (not interacting with other factors)
# and the interaction Diel * Trophism separately
anopaPlot(w, ~ Location ) 
anopaPlot(w, ~ Diel * Trophism ) 

# All these plots are ggplot2 so they can be followed with additional directives, e.g.
library(ggplot2)
anopaPlot(w, ~ Location) + ylim(0.0, 1.0) + theme_classic()
anopaPlot(w, ~ Diel * Trophism) + ylim(0.0, 1.0) + theme_classic()

# etc. Any ggplot2 directive can be added to customize the plot to your liking.
# See the vignette `ArringtonExample`.


</code></pre>

<hr>
<h2 id='anopaN2Power'>Computing power within the ANOPA.</h2><span id='topic+anopaN2Power'></span><span id='topic+anopaPower2N'></span><span id='topic+anopaProp2fsq'></span>

<h3>Description</h3>

<p>The function 'anopaN2Power()' performs an analysis of statistical power
according to the 'ANOPA' framework. See Laurencelle and Cousineau (2023) for more.
'anopaPower2N()' computes the sample size to reach a given power.
Finally, 'anopaProp2fsq()' computes the f^2 effect size from a set of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anopaPower2N(power, P, f2, alpha)

anopaN2Power(N, P, f2, alpha)

anopaProp2fsq(props, ns, unitaryAlpha, method="approximation")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anopaN2Power_+3A_n">N</code></td>
<td>
<p>sample size;</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_p">P</code></td>
<td>
<p>number of groups;</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_f2">f2</code></td>
<td>
<p>effect size Cohen's $f^2$;</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_alpha">alpha</code></td>
<td>
<p>(default if omitted .05) the decision threshold.</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_power">power</code></td>
<td>
<p>target power to attain;</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_ns">ns</code></td>
<td>
<p>sample size per group;</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_props">props</code></td>
<td>
<p>a set of expected proportions (if all between 0 and 1) or number of success per group.</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_method">method</code></td>
<td>
<p>for computing effect size $f^2$ is 'approximation' or 'exact' only.</p>
</td></tr>
<tr><td><code id="anopaN2Power_+3A_unitaryalpha">unitaryAlpha</code></td>
<td>
<p>for within-subject design, the measure of correlation
across measurements.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that for <code>anopaProp2fsq()</code>, the expected effect size $f^2$
depends weakly on the sample sizes. Indeed, the Anscombe transform
can reach more extreme scores when the sample sizes are larger, influencing
the expected effect size.
</p>


<h3>Value</h3>

<p><code>anopaPower2N()</code> returns a sample size to reach a given power level.
<code>anopaN2Power()</code> returns statistical power from a given sample size.
<code>anopaProp2fsq()</code> returns $f^2$ the effect size from a set of proportions
and sample sizes.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of frequency tables: The ANOFA framework.&rdquo;
<em>The Quantitative Methods for Psychology</em>, <b>19</b>, 173&ndash;193.
<a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1- Example of the article:
# with expected frequences .34 to .16, assuming as a first guess groups of 25 observations:
f2 &lt;- anopaProp2fsq( c( 0.32, 0.64, 0.40, 0.16), c(25,25,25,25) );
f2
# f-square is 0.128.

# f-square can be converted to eta-square with
eta2 &lt;- f2 / (1 + f2)


# With a total sample of 97 observations over four groups,
# statistical power is quite satisfactory (85%).
anopaN2Power(97, 4, f2)

# 2- Power planning.
# Suppose we plan a four-classification design with expected proportions of:
pred &lt;- c(.35, .25, .25, .15)
# P is the number of classes (here 4)
P &lt;- length(pred)
# We compute the predicted f2 as per Eq. 5
f2 &lt;- 2 * sum(pred * log(P * pred) )
# the result, 0.0822, is a moderate effect size.

# Finally, aiming for a power of 80%, we run
anopaPower2N(0.80, P, f2)
# to find that a little more than 132 participants are enough.


</code></pre>

<hr>
<h2 id='ArringtonEtAl2002'>Arrington et al. (2002) dataset</h2><span id='topic+ArringtonEtAl2002'></span>

<h3>Description</h3>

<p>The data, taken from Arrington et al. (2002), is a dataset examining
the distribution of fishes with empty stomachs, classified over
three factors:
'Collection location' (3 levels: Africa, Central/South America, North America),
'Diel feeding behavior' (2 levels: diurnal, nocturnal),
'Trophic category' (4 levels: Detritivore, Invertivore, Omnivore, Piscivore).
It is therefore a 3 × 2 × 4 design with 24 cells.
The original data set also contains Order, Family and Species of the observed
fishes and can be obtained from
https://figshare.com/collections/HOW_OFTEN_DO_FISHES_RUN_ON_EMPTY_/3297635
It was commented in Warton and Hui (2011).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArringtonEtAl2002
</code></pre>


<h3>Format</h3>

<p>A data frame.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.1890/0012-9658%282002%29083%5B2145%3AHODFRO%5D2.0.CO%3B2">doi:10.1890/0012-9658(2002)083[2145:HODFRO]2.0.CO;2</a>
</p>


<h3>References</h3>

<p>Arrington DA, Winemiller KO, Loftus WF, Akin S (2002).
&ldquo;How often do fishes “run on empty”?&rdquo;
<em>Ecology</em>, <b>83</b>(8), 2145&ndash;2151.
<a href="https://doi.org/10.1890/0012-9658%282002%29083%5B2145%3AHODFRO%5D2.0.CO%3B2">doi:10.1890/0012-9658(2002)083[2145:HODFRO]2.0.CO;2</a>.<br /><br /> Warton DI, Hui FK (2011).
&ldquo;The arcsine is asinine: The analysis of proportions in ecology.&rdquo;
<em>Ecology</em>, <b>92</b>, 3&ndash;10.
<a href="https://doi.org/10.1890/10-0340.1%20%20%20">doi:10.1890/10-0340.1   </a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# see the dataset
ArringtonEtAl2002

# The columns s and n indicate the number of fishes with
# empty stomachs (the "success") and the total number
# of fishes observed, respectively. Thus s/n is the proportion.

# run the ANOPA analysis
w &lt;- anopa( {s; n} ~  Location * Diel * Trophism, ArringtonEtAl2002)

# make a plot with all the factors
anopaPlot(w)

# ... or with a subset of factors, with
anopaPlot(w, ~ Location * Trophism)

# Because of the three-way interaction, extract simple effects for each Diel
e &lt;- emProportions( w, {s;n} ~ Location * Trophism | Diel  ) 

# As the two-way simple interaction for Nocturnal * Diel is close to significant, 
# we extract the second-order simple effects for each Diel and each Location
e &lt;- emProportions(w, {s;n} ~ Trophism | Location * Diel  ) 
# As seen, the Trophism is significant for Noctural fishes of 
# Central/South America.


</code></pre>

<hr>
<h2 id='ArticleExample1'>ArticleExample1</h2><span id='topic+ArticleExample1'></span>

<h3>Description</h3>

<p>These are the data from the first example reported in
(Laurencelle and Cousineau 2023). It shows ficticious data with regards to
the proportion of incubation as a function of the distracting task.
The design is a between-subject design with 4 groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArticleExample1
</code></pre>


<h3>Format</h3>

<p>An object of class data.frame.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ANOPA)

# the ArticleExample1 data shows an effect of the type of distracting task 
ArticleExample1

# We perform an anopa on this dataset
w &lt;- anopa( {nSuccess; nParticipants} ~ DistractingTask, ArticleExample1)

# We finish with post-hoc Tukey test
e &lt;- posthocProportions( w )

# a small plot is *always* a good idea
anopaPlot(w)


</code></pre>

<hr>
<h2 id='ArticleExample2'>ArticleExample2</h2><span id='topic+ArticleExample2'></span>

<h3>Description</h3>

<p>These are the data from the second example reported in
(Laurencelle and Cousineau 2023). It shows ficticious data with regards to
the proportion of graduation for persons with dyslexai as a function
of the moment of diagnostic (early or late) and the socoi-economic status (SES).
The design is a between-subject design with 2 x 3 = 6 groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArticleExample2
</code></pre>


<h3>Format</h3>

<p>An object of class data.frame.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ANOPA)

# the ArticleExample2 data shows an effect on the success to graduate as a function of
# socioeconomic status and moment of diagnostic:
ArticleExample2

# perform an anopa on this dataset
w &lt;- anopa( {s;n} ~ MofDiagnostic * SES, ArticleExample2)

# a small plot is *always* a good idea
anopaPlot(w)
# here the plot is only for the main effect of SES.
anopaPlot(w, ~ SES)

</code></pre>

<hr>
<h2 id='ArticleExample3'>ArticleExample3</h2><span id='topic+ArticleExample3'></span>

<h3>Description</h3>

<p>These are the data from the third example reported in
(Laurencelle and Cousineau 2023). It shows ficticious data with regards to
the proportion of patients suffering delirium tremens as a function
of the drug adminstered (cBau, eaPoe, R&amp;V, Placebo).
The design is a within-subject design with 4 measurements (order of
adminstration randomized).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ArticleExample3
</code></pre>


<h3>Format</h3>

<p>An object of class data.frame.
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ANOPA)

# the ArticleExample3 data shows an effect of the drug administered on the 
# proportion of participants who had an episode of delirium tremens 
ArticleExample3

# perform an anopa on this dataset
w &lt;- anopa( cbind(cBau,eaPoe,RnV,Placebo) ~ ., ArticleExample3, WSFactors = "Drug(4)")

# We finish with post-hoc Tukey test
e &lt;- posthocProportions( w )

# a small plot is *always* a good idea
anopaPlot(w)


</code></pre>

<hr>
<h2 id='contrastProportions'>contrastProportion: analysis of contrasts between proportions using Anscombe transform.</h2><span id='topic+contrastProportions'></span>

<h3>Description</h3>

<p>The function 'contrastProportions()' performs contrasts analyses
on proportion data after an omnibus analysis has been obtained with 'anopa()'
according to the ANOPA framework. See Laurencelle and Cousineau (2023) for more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrastProportions(w = NULL, contrasts = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contrastProportions_+3A_w">w</code></td>
<td>
<p>An ANOPA object obtained from <code>anopa()</code> or <code>emProportions()</code>;</p>
</td></tr>
<tr><td><code id="contrastProportions_+3A_contrasts">contrasts</code></td>
<td>
<p>A list that gives the weights for the contrasts to analyze.
The contrasts within the list can be given names to distinguish them.
The contrast weights must sum to zero and their cross-products must equal 0
as well.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>contrastProportions()</code> computes the _F_s for the contrasts,
testing the hypothesis that it equals zero.
The contrasts are each 1 degree of freedom, and the sum of the contrasts'
degrees of freedom totalize the effect-being-decomposed's degree of freedom.
</p>


<h3>Value</h3>

<p>A table of significance of the different contrasts.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Basic example using a one between-subject factor design with the data in compiled format. 
# Ficticious data present success or failure of observation classified according
# to the state of residency (three levels); 175 participants have been observed in total.

# The cells are unequal:
minimalBSExample

# First, perform the omnibus analysis :
w &lt;- anopa( {s;n} ~ state, minimalBSExample) 
summary(w)

# Compare the first two states jointly to the third, and
# compare the first to the second state:
cw &lt;- contrastProportions( w, list(
         contrast1 = c(1,  1, -2)/2,
         contrast2 = c(1, -1,  0) )
      )
summary(cw)




</code></pre>

<hr>
<h2 id='conversion'>Converting between formats</h2><span id='topic+conversion'></span><span id='topic+toWide'></span><span id='topic+toLong'></span><span id='topic+toCompiled'></span>

<h3>Description</h3>

<p>The functions 'toWide()', 'toLong()', and 'toCompiled()'
converts the data into various formats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toWide(w)

toLong(w)

toCompiled(w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conversion_+3A_w">w</code></td>
<td>
<p>An instance of an ANOPA object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The proportions of success of a set of <em>n</em> participants can be
given using many formats. In what follows, <em>n</em> is the number of
participants, <em>p</em> is the number of between-subject factor(s),
$q$ is the number of repeated-measure factor(s).
</p>

<ul>
<li><p> One basic format, called <code>wide</code>, has one line per
participants, with a 1 if a &quot;success&quot; is observed
or a 0 if no success is observed. What a succes is
is entirely arbitrary. The proportion of success is then
the number of 1s divided by the number of participants in each group.
The data frame has $n$ lines and $p+q$ columns.
</p>
</li>
<li><p> A second format, called <code>long</code>, has, on a line, the
factor name(s) and 1s or 0s to indicate success or not.
The data fame has $n x q$ lines and
4 columns (a Id column to identify the particpant; $p$ columns
to identify the groups, one column to identify which whitin-subject
measure is given and finally, a 1 or 0 for the score of that measurement.
</p>
</li>
<li><p> A third format, called <code>compiled</code>, is to have a list of all
the between-subject factors and the number of
success and the total number of participants.
This format is more compact  as if there are 6 groups,
the data are all contained in six lines (one line per group).
This format however is only valid for between-subject design as
we cannot infer the correlation between successes/failure.
</p>
</li></ul>

<p>See the vignette <a href="../articles/B-DataFormatsForProportions.html">DataFormatsForProportions</a>
for more.
</p>


<h3>Value</h3>

<p>A data frame in the requested format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The minimalBSExample contains $n$ of 175 participants categorized according
# to one factor $f = 1$, namely `State of residency` (with three levels) 
# for 3 possible cells.
minimalBSExample

# Lets incorporate the data in an ANOPA data structure
w &lt;- anopa( {s;n} ~ state, minimalBSExample )

# The data presented using various formats looks like
toWide(w)
# ... has 175 lines, one per participants ($n$) and 2 columns (state, success or failure)

toLong(w)
# ... has 175 lines ($n x f$) and 4 columns (participant's `Id`, state name, measure name, 
# and success or failure)

toCompiled(w)
# ... has 3 lines and 3 columns ($f$ + 2: number of succes and number of participants).


# This second example is from a mixed-design. It indicates the 
# state of a machine, grouped in three categories (the sole between-subject
# factor) and at four different moments. 
# The four measurements times are before treatment, post-treatment, 
# 1 week later, and finally, 5 weeks later.
minimalMxExample

# Lets incorporate the data in an ANOPA data structure
w &lt;- anopa( cbind(bpre,bpost,b1week,b5week) ~ Status, 
            minimalMxExample,
            WSFactors = "Moment(4)" )

# -- Wide format --
# Wide format is actually the format of minimalMxExample
# (27 lines with 8 subjects in the first group and 9 in the second)
toWide(w)

# -- Long format --
# (27 times 4 lines = 108 lines, 4 columns, that is Id, group, measurement, success or failure)
toLong(w)

# -- Compiled format --
# (three lines as there are three groups, 7 columns, that is, 
# the group, the 4 measurements, the number of particpants, and the
# correlation between measurements for each group measured by unitary alphas)
toCompiled(w)



</code></pre>

<hr>
<h2 id='corrected'>corrected</h2><span id='topic+corrected'></span>

<h3>Description</h3>

<p>'corrected()' provides an ANOPA table with only the corrected
statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrected(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrected_+3A_object">object</code></td>
<td>
<p>an object to explain</p>
</td></tr>
<tr><td><code id="corrected_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An ANOPA table with the corrected test statistics.
</p>

<hr>
<h2 id='emProportions'>emProportions: simple effect analysis of proportions.</h2><span id='topic+emProportions'></span>

<h3>Description</h3>

<p>The function 'emProportions()' performs a <em>simple effect</em> analyses
of proportions after an omnibus analysis has been obtained with 'anopa()'
according to the ANOPA framework. Alternatively, it is also called an
<em>expected marginal</em> analysis of proportions. See Laurencelle and Cousineau (2023) for more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emProportions(w, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emProportions_+3A_w">w</code></td>
<td>
<p>An ANOPA object obtained from <code>anopa()</code>;</p>
</td></tr>
<tr><td><code id="emProportions_+3A_formula">formula</code></td>
<td>
<p>A formula which indicates what simple effect to analyze.
Only one simple effect formula at a time can be analyzed. The formula
is given using a vertical bar, e.g., &quot; ~ factorA | factorB &quot; to obtain
the effect of Factor A within every level of the Factor B.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>emProportions()</code> computes expected marginal proportions and
analyzes the hypothesis of equal proportion.
The sum of the _F_s of the simple effects are equal to the
interaction and main effect _F_s, as this is an additive decomposition
of the effects.
</p>


<h3>Value</h3>

<p>An ANOPA table of the various simple main effets and if relevant,
of the simple interaction effets.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of frequency tables: The ANOFA framework.&rdquo;
<em>The Quantitative Methods for Psychology</em>, <b>19</b>, 173&ndash;193.
<a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# -- FIRST EXAMPLE --
# This is a basic example using a two-factors design with the factors between 
# subjects. Ficticious data present the number of success according
# to Class (three levels) and Difficulty (two levels) for 6 possible cells
# and 72 observations in total (equal cell sizes of 12 participants in each group).
twoWayExample

# As seen the data are provided in a compiled format (one line per group).
# Performs the omnibus analysis first (mandatory):
w &lt;- anopa( {success;total} ~ Difficulty * Class, twoWayExample) 
summary(w)

# The results shows an important interaction. You can visualize the data
# using anopaPlot:
anopaPlot(w)
# The interaction is overadditive, with a small differences between Difficulty
# levels in the first class, but important differences between Difficulty for 
# the last class.

# Let's execute the simple effect of Difficulty for every levels of Class
e &lt;- emProportions(w, ~ Difficulty | Class )
summary(e)


# -- SECOND EXAMPLE --
# Example using the Arrington et al. (2002) data, a 3 x 4 x 2 design involving 
# Location (3 levels), Trophism (4 levels) and Diel (2 levels), all between subject.
ArringtonEtAl2002

# first, we perform the omnibus analysis (mandatory):
w &lt;- anopa( {s;n} ~ Location * Trophism * Diel, ArringtonEtAl2002) 
summary(w)

# There is a near-significant interaction of Trophism * Diel (if we consider
# the unadjusted p value, but you really should consider the adjusted p value...).
# If you generate the plot of the four factors, we don't see much:
anopaPlot(w)

#... but a plot specifically of the interaction helps:
anopaPlot(w, ~ Trophism * Diel )
# it seems that the most important difference is for omnivorous fishes
# (keep in mind that there were missing cells that were imputed but there does not
# exist to our knowledge agreed-upon common practices on how to impute proportions...
# Are you looking for a thesis topic?).

# Let's analyse the simple effect of Trophism for every levels of Diel and Location
e &lt;- emProportions(w, ~ Trophism | Diel )
summary(e)


# You can ask easier outputs with
corrected(w) # or summary(w) for the ANOPA table only
explain(w)   # human-readable ouptut ((pending))


</code></pre>

<hr>
<h2 id='explain'>explain</h2><span id='topic+explain'></span>

<h3>Description</h3>

<p>'explain()' provides a human-readable, exhaustive, description of
the results. It also provides references to the key results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explain(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explain_+3A_object">object</code></td>
<td>
<p>an object to explain</p>
</td></tr>
<tr><td><code id="explain_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a human-readable output with details of computations.
</p>

<hr>
<h2 id='minimalExamples'>A collection of minimal Examples from various designs with one or two factors.</h2><span id='topic+minimalExamples'></span><span id='topic+minimalBSExample'></span><span id='topic+twoWayExample'></span><span id='topic+minimalWSExample'></span><span id='topic+twoWayWithinExample'></span><span id='topic+minimalMxExample'></span>

<h3>Description</h3>

<p>The datasets present minimal examples that are analyzed with an
Analysis of Frequency Data method (described in Laurencelle and Cousineau (2023).
The five datasets are
</p>

<ul>
<li><p> 'minimalBSExample': an example with a single factor (state of residency)
</p>
</li>
<li><p> 'twoWayExample': an example with two factors, Class and Difficulty
</p>
</li>
<li><p> 'minimalWSExample': an example with a within-subject design (three measurements)
</p>
</li>
<li><p> 'twoWayWithinExample': an example with two within-subject factors
</p>
</li>
<li><p> 'minimalMxExample': a mixed design having one within and one between-subject factors
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>minimalBSExample

twoWayExample

minimalWSExample

twoWayWithinExample

minimalMxExample
</code></pre>


<h3>Format</h3>

<p>Objects of class data.frame:
</p>
<p>An object of class <code>data.frame</code> with 6 rows and 4 columns.
</p>
<p>An object of class <code>data.frame</code> with 19 rows and 3 columns.
</p>
<p>An object of class <code>data.frame</code> with 30 rows and 6 columns.
</p>
<p>An object of class <code>data.frame</code> with 27 rows and 5 columns.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ANOPA)

# the twoWayExample data with proportions per Classes and Difficulty levels 
twoWayExample

# perform an anopa on this dataset
w &lt;- anopa( {success;total} ~ Difficulty * Class, twoWayExample) 

# We analyse the proportions by Difficulty for each Class
e &lt;- emProportions(w, ~ Difficulty | Class)

</code></pre>

<hr>
<h2 id='posthocProportions'>posthocProportions: post-hoc analysis of proportions.</h2><span id='topic+posthocProportions'></span>

<h3>Description</h3>

<p>The function 'posthocProportions()' performs post-hoc analyses
of proportions after an omnibus analysis has been obtained with 'anopa()'
according to the ANOPA framework. It is based on the tukey HSD test.
See Laurencelle and Cousineau (2023) for more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posthocProportions(w, formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posthocProportions_+3A_w">w</code></td>
<td>
<p>An ANOPA object obtained from <code>anopa()</code>;</p>
</td></tr>
<tr><td><code id="posthocProportions_+3A_formula">formula</code></td>
<td>
<p>A formula which indicates what post-hocs to analyze.
only one simple effect formula at a time can be analyzed. The formula
is given using a vertical bar, e.g., &quot; ~ factorA | factorB &quot; to obtain
the effect of Factor A within every level of the Factor B.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>posthocProportions()</code> computes expected marginal proportions and
analyzes the hypothesis of equal proportion.
The sum of the $F$s of the simple effects are equal to the
interaction and main effect $F$s, as this is an additive decomposition
of the effects.
</p>


<h3>Value</h3>

<p>a model fit of the simple effect.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of frequency tables: The ANOFA framework.&rdquo;
<em>The Quantitative Methods for Psychology</em>, <b>19</b>, 173&ndash;193.
<a href="https://doi.org/10.20982/tqmp.19.2.p173">doi:10.20982/tqmp.19.2.p173</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# -- FIRST EXAMPLE --
# This is a basic example using a two-factors design with the factors between 
# subjects. Ficticious data present the number of success according
# to Class (three levels) and Difficulty (two levels) for 6 possible cells
# and 72 observations in total (equal cell sizes of 12 participants in each group).
twoWayExample

# As seen the data are provided in a compiled format (one line per group).
# Performs the omnibus analysis first (mandatory):
w &lt;- anopa( {success;total} ~ Class * Difficulty, twoWayExample) 
summary(w)

# The results shows an important interaction. You can visualize the data
# using anopaPlot:
anopaPlot(w)
# The interaction is overadditive, with a small differences between Difficulty
# levels in the first class, but important differences between Difficulty for 
# the last class.

# Let's execute the post-hoc tests
e &lt;- posthocProportions(w, ~ Difficulty | Class )
summary(e)


# -- SECOND EXAMPLE --
# Example using the Arrington et al. (2002) data, a 3 x 4 x 2 design involving 
# Location (3 levels), Trophism (4 levels) and Diel (2 levels), all between subject.
ArringtonEtAl2002

# first, we perform the omnibus analysis (mandatory):
w &lt;- anopa( {s;n} ~ Location * Trophism * Diel, ArringtonEtAl2002) 
summary(w)

# There is a near-significant interaction of Trophism * Diel (if we consider
# the unadjusted p value, but you really should consider the adjusted p value...).
# If you generate the plot of the four factors, we don't see much:
# anopaPlot(w)
#... but with a plot specifically of the interaction helps:
anopaPlot(w, ~ Trophism * Diel )
# it seems that the most important difference is for omnivorous fishes
# (keep in mind that there were missing cells that were imputed but there does not
# exist to our knowledge agreed-upon common practices on how to impute proportions...
# Are you looking for a thesis topic?).

# Let's analyse the simple effect of Tropism for every levels of Diel and Location
e &lt;- posthocProportions(w, ~ Tropism | Diel )
summary(e)


# You can ask easier outputs with
summarize(w) # or summary(w) for the ANOPA table only
corrected(w)   # or uncorrected(w) for an abbreviated ANOPA table
explain(w)   # for a human-readable ouptut ((pending))


</code></pre>

<hr>
<h2 id='rBernoulli'>Generating random proportions with GRP</h2><span id='topic+rBernoulli'></span><span id='topic+GRP'></span><span id='topic+gSwitch'></span>

<h3>Description</h3>

<p>The function 'GRP()'
generates random proportions based on a design, i.e.,
a list giving the factors and the categories with each factor.
The data are returned in the 'wide' format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GRP( props, n, BSDesign=NULL, WSDesign=NULL, sname = "s" )

rBernoulli(n, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rBernoulli_+3A_n">n</code></td>
<td>
<p>How many simulated participants are in each between-subject group (can be a vector, one per group);</p>
</td></tr>
<tr><td><code id="rBernoulli_+3A_p">p</code></td>
<td>
<p>a proportion of success;</p>
</td></tr>
<tr><td><code id="rBernoulli_+3A_bsdesign">BSDesign</code></td>
<td>
<p>A list with the between-subject factor(s) and the categories within each;</p>
</td></tr>
<tr><td><code id="rBernoulli_+3A_wsdesign">WSDesign</code></td>
<td>
<p>A list with the within-subject factor(s) and the categories within each;</p>
</td></tr>
<tr><td><code id="rBernoulli_+3A_props">props</code></td>
<td>
<p>(optional) the proportion of succes in each cell of the design. Default 0.50;</p>
</td></tr>
<tr><td><code id="rBernoulli_+3A_sname">sname</code></td>
<td>
<p>(optional) the column name that will contain the success/failure;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The name of the function <code>GRP()</code> is derived from <code>GRD()</code>,
a general-purpose tool to generate random data (Calderini and Harding 2019)
now bundled in the <code>superb</code> package (Cousineau et al. 2021).
<code>GRP()</code> is actually a proxy for <code>GRD()</code>.
</p>


<h3>Value</h3>

<p><code>GRP()</code> returns a data frame containing success (coded as 1) or failure (coded as 0)
for n participants per cells of the design. Note that correlated
scores cannot be generated by <code>GRP()</code>; see (Lunn and Davies 1998).
<code>rBernoulli()</code> returns a sequence of n success (1) or failures (0)
</p>


<h3>References</h3>

<p>Calderini M, Harding B (2019).
&ldquo;GRD for R: An intuitive tool for generating random data in R.&rdquo;
<em>The Quantitative Methods for Psychology</em>, <b>15</b>(1), 1&ndash;11.
<a href="https://doi.org/10.20982/tqmp.15.1.p001">doi:10.20982/tqmp.15.1.p001</a>.<br /><br /> Cousineau D, Goulet M, Harding B (2021).
&ldquo;Summary plots with adjusted error bars: The superb framework with an implementation in R.&rdquo;
<em>Advances in Methods and Practices in Psychological Science</em>, <b>4</b>, 1&ndash;18.
<a href="https://doi.org/10.1177/25152459211035109">doi:10.1177/25152459211035109</a>.<br /><br /> Lunn AD, Davies SJ (1998).
&ldquo;A note on generating correlated binary variables.&rdquo;
<em>Biometrika</em>, <b>85</b>(2), 487&ndash;490.
<a href="https://doi.org/10.1093/biomet/85.2.487">doi:10.1093/biomet/85.2.487</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The first example generate scorse for 20 particants in one factor having
# two categories (low and high):
design &lt;- list( A=c("low","high"))
GRP( design, props = c(0.1,  0.9), n = 20 )

# This example has two factors, with factor A having levels a, b, c
# and factor B having 2 levels, for a total of 6 conditions;
# with 40 participants per group, it represents 240 observations:
design &lt;- list( A=letters[1:3], B = c("low","high"))
GRP( design, props = c(0.1, 0.15, 0.20, 0.80, 0.85, 0.90), n = 40 )

# groups can be unequal:
design &lt;- list( A=c("low","high"))
GRP( design, props = c(0.1,  0.9), n = c(5, 35) )

# Finally, repeated-measures can be generated
# but note that correlated scores cannot be generated with `GRP()`
wsDesign = list( Moment = c("pre", "post") )
GRP( WSDesign=wsDesign, props = c(0.1,  0.9), n = 10 )

# This last one has three factors, for a total of 3 x 2 x 2 = 12 cells
design &lt;- list( A=letters[1:3], B = c("low","high"), C = c("cat","dog"))
GRP( design, n = 30, props = rep(0.5,12) )

# To specify unequal probabilities, use
design  &lt;- list( A=letters[1:3], B = c("low","high"))
expProp &lt;- c(.05, .05, .35, .35, .10, .10 )
GRP( design, n = 30, props=expProp )

# The name of the column containing the proportions can be changed
GRP( design, n=30, props=expProp, sname="patate")

# Examples of use of rBernoulli
t &lt;- rBernoulli(50, 0.1)
mean(t)




</code></pre>

<hr>
<h2 id='summarize'>summarize</h2><span id='topic+summarize'></span>

<h3>Description</h3>

<p>'summarize()' provides the statistics table an ANOPAobject.
It is synonym of 'summary()' (but as actions are verbs, I used a verb).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarize(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarize_+3A_object">object</code></td>
<td>
<p>an object to summarize</p>
</td></tr>
<tr><td><code id="summarize_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an ANOPA table as per articles.
</p>

<hr>
<h2 id='uncorrected'>uncorrected</h2><span id='topic+uncorrected'></span>

<h3>Description</h3>

<p>'uncorrected()' provides an ANOPA table with only the uncorrected
statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uncorrected(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="uncorrected_+3A_object">object</code></td>
<td>
<p>an object to explain</p>
</td></tr>
<tr><td><code id="uncorrected_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An ANOPA table with the un-corrected test statistics.
That should be avoided, more so if your sample is rather small.
</p>

<hr>
<h2 id='unitaryAlpha'>unitary alpha</h2><span id='topic+unitaryAlpha'></span>

<h3>Description</h3>

<p>The function 'unitaryAlpha()' computes
the unitary alpha ((Laurencelle and Cousineau 2023)). This
quantity is a novel way to compute correlation in a matrix
where each column is a measure and each line, a subject.
This measure is based on Cronbach's alpha (which could be
labeled a 'global alpha').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unitaryAlpha( m )
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unitaryAlpha_+3A_m">m</code></td>
<td>
<p>A data matrix for a group of observations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This measure is derived from Cronbach' measure of
reliability as shown by Laurencelle and Cousineau (2023).
</p>


<h3>Value</h3>

<p>A measure of correlation between -1 and +1.
</p>


<h3>References</h3>

<p>Laurencelle L, Cousineau D (2023).
&ldquo;Analysis of proportions using arcsine transform with any experimental design.&rdquo;
<em>Frontiers in Psychology</em>, <b>13</b>, 1045436.
<a href="https://doi.org/10.3389/fpsyg.2022.1045436">doi:10.3389/fpsyg.2022.1045436</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate a random matrix (here binary entries)
set.seed(42)
N &lt;- M &lt;- 10
m &lt;- matrix( runif(N*M), N, M)

# compute the unitary alpha from that random matrix
unitaryAlpha(m)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
