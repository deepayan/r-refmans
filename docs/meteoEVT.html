<!DOCTYPE html><html lang="en"><head><title>Help for package meteoEVT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {meteoEVT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#meteoEVT-package'><p>Introduction</p></a></li>
<li><a href='#calc_bernoulli'><p>Bernoulli function</p></a></li>
<li><a href='#calc_density'><p>Density</p></a></li>
<li><a href='#calc_dsi'><p>Dynamic State Index (DSI)</p></a></li>
<li><a href='#calc_enstrophy'><p>Enstrophy density</p></a></li>
<li><a href='#calc_fdiag'><p>F diagnostic</p></a></li>
<li><a href='#calc_frontogenesis'><p>Petterssen Frontogenesis Function</p></a></li>
<li><a href='#calc_helicity'><p>Helicity density</p></a></li>
<li><a href='#calc_lamb'><p>Lamb vector (sometimes called vortex energy)</p></a></li>
<li><a href='#calc_pv'><p>Potential Vorticity (PV)</p></a></li>
<li><a href='#calc_tfp'><p>Thermic Front Parameter (TFP)</p></a></li>
<li><a href='#calc_theta'><p>Potential temperature</p></a></li>
<li><a href='#calc_vorticity'><p>Vorticity</p></a></li>
<li><a href='#cp'><p>cp</p></a></li>
<li><a href='#crossprod'><p>cross product</p></a></li>
<li><a href='#df_dp'><p>df_dp</p></a></li>
<li><a href='#df_dx'><p>df_dx</p></a></li>
<li><a href='#df_dy'><p>df_dy</p></a></li>
<li><a href='#df_dz'><p>df_dz</p></a></li>
<li><a href='#div'><p>divergence</p></a></li>
<li><a href='#fill_horiz'><p>Plotting a xy domain with custom boundaries, colour paletts and optional world map</p></a></li>
<li><a href='#frontid'><p>Front Identification und Statistics</p></a></li>
<li><a href='#g'><p>g</p></a></li>
<li><a href='#grad'><p>gradient of a scalar field</p></a></li>
<li><a href='#jacobian'><p>Jacobian matrix and determinant</p></a></li>
<li><a href='#omega'><p>omega</p></a></li>
<li><a href='#R'><p>R</p></a></li>
<li><a href='#Rd'><p>Rd</p></a></li>
<li><a href='#re'><p>re</p></a></li>
<li><a href='#readin_dim'><p>read in dimensions</p></a></li>
<li><a href='#readin_era5'><p>read in ERA5 data</p></a></li>
<li><a href='#rot'><p>rotation</p></a></li>
<li><a href='#Rv'><p>Rv</p></a></li>
<li><a href='#scalarprod'><p>scalar product</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computation and Visualization of Energetic and Vortical
Atmospheric Quantities</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-02</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Laura Mack &lt;laum52@zedat.fu-berlin.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Energy-Vorticity theory (EVT) is the fundamental theory to describe processes in the atmosphere by combining conserved quantities from hydrodynamics and thermodynamics. The package 'meteoEVT' provides functions to calculate many energetic and vortical quantities, like potential vorticity, Bernoulli function and dynamic state index (DSI) [e.g. Weber and Nevir, 2008, &lt;<a href="https://doi.org/10.1111%2Fj.1600-0870.2007.00272.x">doi:10.1111/j.1600-0870.2007.00272.x</a>&gt;], for given gridded data, like ERA5 reanalyses. These quantities can be studied directly or can be used for many applications in meteorology, e.g., the objective identification of atmospheric fronts. For this purpose, separate function are provided that allow the detection of fronts based on the thermic front parameter [Hewson, 1998, &lt;<a href="https://doi.org/10.1017%2FS1350482798000553">doi:10.1017/S1350482798000553</a>&gt;], the F diagnostic [Parfitt et al., 2017, &lt;<a href="https://doi.org/10.1002%2F2017GL073662">doi:10.1002/2017GL073662</a>&gt;] and the DSI [Mack et al., 2022, &lt;<a href="https://doi.org/10.48550/arXiv.2208.11438">doi:10.48550/arXiv.2208.11438</a>&gt;].</td>
</tr>
<tr>
<td>Author:</td>
<td>Laura Mack [aut, cre]</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, purrr, ncdf4</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/noctiluc3nt/meteoEVT">https://github.com/noctiluc3nt/meteoEVT</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-02 19:21:57 UTC; polarfuchs</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-05 08:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='meteoEVT-package'>Introduction</h2><span id='topic+meteoEVT-package'></span>

<h3>Description</h3>

<p>Energy-Vorticity theory (EVT) is the fundamental theory to describe processes in the atmosphere by combining conserved quantities from hydrodynamics and thermodynamics. The package 'meteoEVT' provides functions to calculate many energetic and vortical quantities, like potential vorticity, Bernoulli function and dynamic state index (DSI) (Weber and Nevir, 2008), for given gridded data, like ERA5 reanalyses. These quantities can be studied directly or can be used for many applications in meteorology, e.g., the objective identification of atmospheric fronts. For this purpose, separate function are provided that allow the detection of fronts based on the thermic front parameter (Hewson, 1998), the F diagnostic (Parfitt et al., 2017) and the DSI (Mack et al., 2022).
</p>


<h3>Details</h3>

<p>Phenomenons in the Earth's atmosphere, like tropical hurricanes or extratropical cyclones, can adequately be chararcterized by a combination of energetic and vortical quantities. These quantities can also be used for a consistent theoretical description of these phenomenons. This package provides functions to calculate Bernoulli function, vorticity, enstrophy, helicity, Lamb vector and potential vorticity based on given gridded data sets. Addiotionally, by using energy-vortex theory an adiabatic, stationary and invisicid basic state of the Earth's atmosphere can be derived, which is itself a solution of the primitive equations. The derivation from this basic state is given by the dynamic state index (DSI), which can be used for the study of, e.g., cyclones and fronts. Recently, the DSI was used to identify atmospheric fronts objectively from reanalysis data and thereby provides an alternative way for front detection. For this purpose, this package provides funtions to calculate the DSI and use it to identify atmospheric fronts. This method can be compared with state-of-the-art front identification methods based on the thermic front parameter or the F diagnostic.
</p>


<h3>References</h3>


<ul>
<li><p> Weber, T. and Névir, P. (2008). Storm tracks and cyclone development using the theoretical concept of the Dynamic State Index (DSI). Tellus A, 60(1):1–10, doi:10.1111/j.1600-0870.2007.00272.x.
</p>
</li>
<li><p> Parfitt, R., Czaja, A., and Seo, H. (2017). A simple diagnostic for the detection of atmospheric fronts. Geophys. Res. Lett., 44:4351–4358, doi:10.1002/2017GL073662.
</p>
</li>
<li><p> Hewson, T. D. (1998). Objective fronts. Meteorol. Appl., 5:37–65, doi:10.1017/S1350482798000553.
</p>
</li>
<li><p> Mack, L., Rudolph, A. and Névir, P. (2022). Identifying atmospheric fronts based on diabatic processes using the dynamic state index (DSI), arXiv:2208.11438.
</p>
</li></ul>


<hr>
<h2 id='calc_bernoulli'>Bernoulli function</h2><span id='topic+calc_bernoulli'></span>

<h3>Description</h3>

<p>Calculates the Bernoulli function, i.e. total energy density, as sum of potential, kinetic and thermal energy density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_bernoulli(t_fld, u_fld, v_fld, w_fld, phi_fld)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_bernoulli_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_bernoulli_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_bernoulli_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_bernoulli_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_bernoulli_+3A_phi_fld">phi_fld</code></td>
<td>
<p>geopotential height [gpm]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Bernoulli function field [m^2/s^2]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
bernoulli=calc_bernoulli(data$temp,data$u,data$v,data$w,data$z)
</code></pre>

<hr>
<h2 id='calc_density'>Density</h2><span id='topic+calc_density'></span>

<h3>Description</h3>

<p>Calculates the density of an ideal fluid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_density(t_fld, lev_p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_density_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_density_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density [kg/m^3]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
density=calc_density(data$temp,data$lev)
</code></pre>

<hr>
<h2 id='calc_dsi'>Dynamic State Index (DSI)</h2><span id='topic+calc_dsi'></span>

<h3>Description</h3>

<p>Calculates the dynamic state index DSI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_dsi(
  t_fld,
  u_fld,
  v_fld,
  w_fld,
  phi_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  zvort_only = FALSE,
  relative = FALSE,
  pv_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_dsi_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_phi_fld">phi_fld</code></td>
<td>
<p>geopotential height [gpm]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_zvort_only">zvort_only</code></td>
<td>
<p>logical, TRUE: if only the vertical vorticity (zvort) should be calculated, FALSE: for the whole vorticity vector, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_pv_fld">pv_fld</code></td>
<td>
<p>optional pv field (if e.g., PV is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_dsi_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>dynamic state index [K^2*m^4/(kg^2*s^3)]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
dsi=calc_dsi(data$temp,data$u,data$v,data$w,data$z,lev_p=data$lev,lat=data$lat)
</code></pre>

<hr>
<h2 id='calc_enstrophy'>Enstrophy density</h2><span id='topic+calc_enstrophy'></span>

<h3>Description</h3>

<p>Calculates the enstrophy density (vorticity squared) either in 2d or 3d
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_enstrophy(
  u_fld,
  v_fld,
  w_fld = NULL,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  zvort_only = TRUE,
  relative = TRUE,
  zvort_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_enstrophy_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_zvort_only">zvort_only</code></td>
<td>
<p>logical, TRUE: if only 2d enstrophy (based on z-vorticity) should be calculated, FALSE: for 3d enstrophy (based on 3d vorticity), default: TRUE</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity should be used for calculation of enstrophy, default: TRUE</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_zvort_fld">zvort_fld</code></td>
<td>
<p>optional zvort field (if e.g., zvort is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_enstrophy_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>enstrophy density field [1/s^2]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
#3d enstropy
ens3d=calc_enstrophy(data$u,data$v,data$w,data$lev,lat=data$lat)
#2d enstropy as scalar
ens2d=calc_enstrophy(data$u,data$v,lev_p=data$lev,lat=data$lat,zvort_only=TRUE)
</code></pre>

<hr>
<h2 id='calc_fdiag'>F diagnostic</h2><span id='topic+calc_fdiag'></span>

<h3>Description</h3>

<p>Calculates the F diagnostic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_fdiag(
  t_fld,
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_fdiag_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_lat">lat</code></td>
<td>
<p>only for lonlat mode: vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_fdiag_+3A_mode">mode</code></td>
<td>
<p>the horizontal coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>F diagnostic (dimensionless)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
fdiag=calc_fdiag(data$temp,data$u,data$v,data$w,data$lev,data$lat)
</code></pre>

<hr>
<h2 id='calc_frontogenesis'>Petterssen Frontogenesis Function</h2><span id='topic+calc_frontogenesis'></span>

<h3>Description</h3>

<p>Calculates the Petterssen frontogenesis function based on the potential temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_frontogenesis(
  t_fld,
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  mode = "lonlat",
  lat = NULL,
  dx = 0.25,
  dy = 0.25
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_frontogenesis_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_lat">lat</code></td>
<td>
<p>only for lonlat mode: vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_frontogenesis_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Petterssen Frontogenesis Function
</p>

<hr>
<h2 id='calc_helicity'>Helicity density</h2><span id='topic+calc_helicity'></span>

<h3>Description</h3>

<p>Calculates the helicity density (scalar product of wind vector and vorticity vector) either for the whole vector (3d) or only for the vertical component (updraft helicity)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_helicity(
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  vert_only = FALSE,
  relative = TRUE,
  zvort_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_helicity_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_vert_only">vert_only</code></td>
<td>
<p>logical, TRUE: if only the updraft helicity w*zeta (based on z-vorticity) should be calculated, FALSE: for 3d helicity (based on 3d vorticity), default: FALSE</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity should be used for calculation of enstrophy, default: TRUE</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_zvort_fld">zvort_fld</code></td>
<td>
<p>optional zvort field (if e.g., zvort is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_helicity_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>helicity density field [m/s^2]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
#3d helicity
hel=calc_helicity(data$u,data$v,data$w,data$lev,lat=data$lat)
#updraft helicity
up_hel=calc_helicity(data$u,data$v,data$w,data$lev,lat=data$lat,vert_only=TRUE)
</code></pre>

<hr>
<h2 id='calc_lamb'>Lamb vector (sometimes called vortex energy)</h2><span id='topic+calc_lamb'></span>

<h3>Description</h3>

<p>Calculates the Lamb vector (cross product of wind vector and vorticity vector)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_lamb(
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  relative = TRUE,
  zvort_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_lamb_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity should be used for calculation of enstrophy, default: TRUE</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_zvort_fld">zvort_fld</code></td>
<td>
<p>optional zvort field (if e.g., zvort is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_lamb_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>lamb vector [m/s^2]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
lamb=calc_lamb(data$u,data$v,data$w,data$lev,lat=data$lat)
</code></pre>

<hr>
<h2 id='calc_pv'>Potential Vorticity (PV)</h2><span id='topic+calc_pv'></span>

<h3>Description</h3>

<p>Calculates the potential vorticity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_pv(
  t_fld,
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  zvort_only = FALSE,
  relative = FALSE,
  zvort_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_pv_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_zvort_only">zvort_only</code></td>
<td>
<p>logical, TRUE: if only the vertical vorticity (zvort) should be calculated, FALSE: for the whole vorticity vector, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_zvort_fld">zvort_fld</code></td>
<td>
<p>optional zvort field (if e.g., zvort is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_pv_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>potential vorticity field [K*m^2/(kg*s)]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
#PV based on all three components
pv=calc_pv(data$temp,data$u,data$v,data$w,data$lev,lat=data$lat)
#PV only based on vertical component
pv_vert=calc_pv(data$temp,data$u,data$v,data$w,lev_p=data$lev,lat=data$lat,zvort_only=TRUE)
</code></pre>

<hr>
<h2 id='calc_tfp'>Thermic Front Parameter (TFP)</h2><span id='topic+calc_tfp'></span>

<h3>Description</h3>

<p>Calculates the thermic front parameter based on the potential temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_tfp(t_fld, lev_p, lat = NULL, dx = 0.25, dy = 0.25, mode = "lonlat")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_tfp_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_tfp_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_tfp_+3A_lat">lat</code></td>
<td>
<p>only for lonlat mode: vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_tfp_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_tfp_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_tfp_+3A_mode">mode</code></td>
<td>
<p>the horizontal coordinate system, options are 'lonlat' for a longitude-latitude-grid (default), or 'cartesian' for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>thermic front parameter [K/m^2]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
tfp=calc_tfp(data$temp,data$lev,data$lat)
</code></pre>

<hr>
<h2 id='calc_theta'>Potential temperature</h2><span id='topic+calc_theta'></span>

<h3>Description</h3>

<p>Calculates the potential temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_theta(t_fld, lev_p)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_theta_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="calc_theta_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>density [kg/m^3]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
theta=calc_theta(data$temp,data$lev)
</code></pre>

<hr>
<h2 id='calc_vorticity'>Vorticity</h2><span id='topic+calc_vorticity'></span>

<h3>Description</h3>

<p>Calculates the vorticity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_vorticity(
  u_fld,
  v_fld,
  w_fld,
  lev_p,
  lat = NULL,
  dx = 0.25,
  dy = 0.25,
  zvort_only = FALSE,
  relative = FALSE,
  zvort_fld = NULL,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_vorticity_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_zvort_only">zvort_only</code></td>
<td>
<p>logical, TRUE: if only the vertical vorticity (zvort) should be calculated, FALSE: for the whole vorticity vector, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_relative">relative</code></td>
<td>
<p>logical, TRUE: only relative vorticity, FALSE: whole (absolute) vorticity, default: FALSE</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_zvort_fld">zvort_fld</code></td>
<td>
<p>optional zvort field (if e.g., zvort is directly taken from ERA5 and not calculated separately)</p>
</td></tr>
<tr><td><code id="calc_vorticity_+3A_mode">mode</code></td>
<td>
<p>use 'lonlat' if the data is given on a lon-lat-grid or 'cartesian' if the data is given on an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vorticity field [1/s]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
#3d vorticity
xi=calc_vorticity(data$u,data$v,data$w,data$lev,lat=data$lat)
#z-vorticity as scalar
zeta=calc_vorticity(data$u,data$v,data$w,data$lev,lat=data$lat,zvort_only=TRUE)
</code></pre>

<hr>
<h2 id='cp'>cp</h2><span id='topic+cp'></span>

<h3>Description</h3>

<p>heat capacity for constant pressure [J/(kg*K)]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cp()
</code></pre>

<hr>
<h2 id='crossprod'>cross product</h2><span id='topic+crossprod'></span>

<h3>Description</h3>

<p>Calculates the cross product of two given 3d vector fields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crossprod(fld1, fld2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="crossprod_+3A_fld1">fld1</code></td>
<td>
<p>field 1 with dimensions (lon,lat,p,3)</p>
</td></tr>
<tr><td><code id="crossprod_+3A_fld2">fld2</code></td>
<td>
<p>field 2 with dimensions (lon,lat,p,3)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the cross product
</p>

<hr>
<h2 id='df_dp'>df_dp</h2><span id='topic+df_dp'></span>

<h3>Description</h3>

<p>Calculates the p derivative (pressure system) using central differences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_dp(fld, plev = 5000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_dp_+3A_fld">fld</code></td>
<td>
<p>field with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="df_dp_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the partial derivative w.r.t. p
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
theta=calc_theta(data$temp,data$lev)
dtheta_dp=df_dp(theta)
</code></pre>

<hr>
<h2 id='df_dx'>df_dx</h2><span id='topic+df_dx'></span>

<h3>Description</h3>

<p>Calculates the x derivative using central differences (for lonlat-grid or cartesian grid)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_dx(fld, lat = NULL, dx = 0.25, mode = "lonlat")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_dx_+3A_fld">fld</code></td>
<td>
<p>field with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="df_dx_+3A_lat">lat</code></td>
<td>
<p>only for lonlat mode: vector containing latitude</p>
</td></tr>
<tr><td><code id="df_dx_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="df_dx_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the partial derivative w.r.t. x
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
theta=calc_theta(data$temp,data$lev)
dtheta_dx=df_dx(theta,data$lat)
</code></pre>

<hr>
<h2 id='df_dy'>df_dy</h2><span id='topic+df_dy'></span>

<h3>Description</h3>

<p>Calculates the y derivative using central differences
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_dy(fld, dy = 0.25, mode = "lonlat")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_dy_+3A_fld">fld</code></td>
<td>
<p>with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="df_dy_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="df_dy_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the partial derivative w.r.t. y
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
theta=calc_theta(data$temp,data$lev)
dtheta_dy=df_dy(theta,dy=0.25)
</code></pre>

<hr>
<h2 id='df_dz'>df_dz</h2><span id='topic+df_dz'></span>

<h3>Description</h3>

<p>Calculates the z derivative
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_dz(fld, rho, plev = 5000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="df_dz_+3A_fld">fld</code></td>
<td>
<p>field with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="df_dz_+3A_rho">rho</code></td>
<td>
<p>field with dimensions (lon,lat,p) for density or a scalar rho (for constant density)</p>
</td></tr>
<tr><td><code id="df_dz_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the partial derivative w.r.t. z
</p>

<hr>
<h2 id='div'>divergence</h2><span id='topic+div'></span>

<h3>Description</h3>

<p>Calculates the divergence of a vector field
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div(
  fld,
  lat = NULL,
  d = 3,
  system = "p",
  rho = NULL,
  dx = 0.25,
  dy = 0.25,
  plev = 5000,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_+3A_fld">fld</code></td>
<td>
<p>field with dimensions (lon,lat,p,d)</p>
</td></tr>
<tr><td><code id="div_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude (only for <code>mode='lonlat'</code>)</p>
</td></tr>
<tr><td><code id="div_+3A_d">d</code></td>
<td>
<p>scalar for dimension (use d=2 for horizontal gradient and d=3 for 3d-gradient)</p>
</td></tr>
<tr><td><code id="div_+3A_system">system</code></td>
<td>
<p>for type of coordinate system (use 'p' for pressure system and 'z' for height system)</p>
</td></tr>
<tr><td><code id="div_+3A_rho">rho</code></td>
<td>
<p>field with dimensions (lon,lat,p) for density or a scalar rho (for constant density)</p>
</td></tr>
<tr><td><code id="div_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="div_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="div_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
<tr><td><code id="div_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the divergence of fld
</p>

<hr>
<h2 id='fill_horiz'>Plotting a xy domain with custom boundaries, colour paletts and optional world map</h2><span id='topic+fill_horiz'></span>

<h3>Description</h3>

<p>Plotting a xy domain with custom boundaries, colour paletts and optional world map
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_horiz(
  x,
  y,
  fld,
  levels = 1:100,
  main = "",
  worldmap = TRUE,
  legend_loc = "topright",
  legend_title = "",
  legend_only = FALSE,
  Lab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fill_horiz_+3A_x">x</code></td>
<td>
<p>array containing x-axis values (e.g. longitude)</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_y">y</code></td>
<td>
<p>array containing y-axis values (e.g. latitude)</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_fld">fld</code></td>
<td>
<p>field (which should be plotted) with dimensions (x,y)</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_levels">levels</code></td>
<td>
<p>levels for colour bar</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_main">main</code></td>
<td>
<p>character containing main title of the plot</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_worldmap">worldmap</code></td>
<td>
<p>should the world map contours be plotted (default TRUE)</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_legend_loc">legend_loc</code></td>
<td>
<p>location of legend</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_legend_title">legend_title</code></td>
<td>
<p>character containing legend title</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_legend_only">legend_only</code></td>
<td>
<p>logical TRUE only legend should be pltted, or FALSE everything should be plotted (default)</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_lab">Lab</code></td>
<td>
<p>lab palette from type colorRampPalette</p>
</td></tr>
<tr><td><code id="fill_horiz_+3A_...">...</code></td>
<td>
<p>additional graphic parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return
</p>

<hr>
<h2 id='frontid'>Front Identification und Statistics</h2><span id='topic+frontid'></span>

<h3>Description</h3>

<p>Calculates frontal zones based on a chosen method (TFP, F diagnostic, DSI) and provides statistics of the distribution of meteorological quantities inside the determined frontak zones.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frontid(
  t_fld,
  u_fld = NULL,
  v_fld = NULL,
  w_fld = NULL,
  phi_fld = NULL,
  lev_p,
  lat = NULL,
  method = "tfp",
  threshold = 2 * 10^-10,
  dx = 0.25,
  dy = 0.25,
  fronts_only = FALSE,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frontid_+3A_t_fld">t_fld</code></td>
<td>
<p>temperature field [K]</p>
</td></tr>
<tr><td><code id="frontid_+3A_u_fld">u_fld</code></td>
<td>
<p>zonal velocity field [m/s]</p>
</td></tr>
<tr><td><code id="frontid_+3A_v_fld">v_fld</code></td>
<td>
<p>meridional velocity field [m/s]</p>
</td></tr>
<tr><td><code id="frontid_+3A_w_fld">w_fld</code></td>
<td>
<p>vertical velocity field [m/s]</p>
</td></tr>
<tr><td><code id="frontid_+3A_phi_fld">phi_fld</code></td>
<td>
<p>geopotential height [gpm]</p>
</td></tr>
<tr><td><code id="frontid_+3A_lev_p">lev_p</code></td>
<td>
<p>vector containing pressure levels [Pa]</p>
</td></tr>
<tr><td><code id="frontid_+3A_lat">lat</code></td>
<td>
<p>only for lonlat mode: vector containing latitude</p>
</td></tr>
<tr><td><code id="frontid_+3A_method">method</code></td>
<td>
<p>character containing the method, use <code>'tfp'</code> for TFP method, <code>'f'</code> for F diagnostic and <code>'dsi'</code> for DSI method</p>
</td></tr>
<tr><td><code id="frontid_+3A_threshold">threshold</code></td>
<td>
<p>scalar containing a suitable threshold (e.g., 2*10^-10 for TFP method, 1 or for F diagnostic, 10^-16 for DSI method)</p>
</td></tr>
<tr><td><code id="frontid_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="frontid_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="frontid_+3A_fronts_only">fronts_only</code></td>
<td>
<p>if you only want to calculate the frontal regions and not their properties (default FALSE)</p>
</td></tr>
<tr><td><code id="frontid_+3A_mode">mode</code></td>
<td>
<p>the horizontal coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing the used method and used threshold, field with logicals containing the detected frontal zones and numerics of temperature, u-wind, v-wind, w-wind, geopotential, vorticity, PV and DSI inside the determined frontal zones
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)

#front identification using the thermic front parameter (example without front statistic)
tfp_fronts=frontid(data$temp,lev_p=data$lev,lat=data$lat,fronts_only=TRUE)

#front identification using F diagnostic (example with front statistic)
f_fronts=frontid(data$temp,data$u,data$v,data$w,data$z,lev_p=data$lev,lat=data$lat,
method='f',threshold=2,fronts_only=FALSE)

#front identification using the dynamic state index (example with statistic)
dsi_fronts=frontid(data$temp,data$u,data$v,data$w,data$z,lev_p=data$lev,lat=data$lat,
method='dsi',threshold=4*10^-16,fronts_only=FALSE)
</code></pre>

<hr>
<h2 id='g'>g</h2><span id='topic+g'></span>

<h3>Description</h3>

<p>gravitional accelaration [m/s^2]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g()
</code></pre>

<hr>
<h2 id='grad'>gradient of a scalar field</h2><span id='topic+grad'></span>

<h3>Description</h3>

<p>Calculates the gradient
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grad(
  fld,
  lat = NULL,
  d = 3,
  system = "p",
  rho = NULL,
  dx = 0.25,
  dy = 0.25,
  plev = 5000,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="grad_+3A_fld">fld</code></td>
<td>
<p>field with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="grad_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="grad_+3A_d">d</code></td>
<td>
<p>scalar for dimension (use d=2 for horizontal gradient and d=3 for 3d-gradient)</p>
</td></tr>
<tr><td><code id="grad_+3A_system">system</code></td>
<td>
<p>for type of coordinate system (use 'p' for pressure system and 'z' for height system)</p>
</td></tr>
<tr><td><code id="grad_+3A_rho">rho</code></td>
<td>
<p>field with dimensions (lon,lat,p) for density or a scalar rho (for constant density)</p>
</td></tr>
<tr><td><code id="grad_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="grad_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="grad_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
<tr><td><code id="grad_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the gradient with dimension (lon,lat,p,d)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
theta=calc_theta(data$temp,data$lev)
theta_grad=grad(theta,data$lat)
</code></pre>

<hr>
<h2 id='jacobian'>Jacobian matrix and determinant</h2><span id='topic+jacobian'></span>

<h3>Description</h3>

<p>Calculates the Jacobian matrix and Jacobian determinant for 2 or 3 given scalar fields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jacobian(
  fld1,
  fld2,
  fld3 = NULL,
  lat = NULL,
  d = 3,
  system = "p",
  rho = NULL,
  dx = 0.25,
  dy = 0.25,
  plev = 5000,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jacobian_+3A_fld1">fld1</code></td>
<td>
<p>field 1 with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_fld2">fld2</code></td>
<td>
<p>field 2 with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_fld3">fld3</code></td>
<td>
<p>field 3 with dimensions (lon,lat,p)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="jacobian_+3A_d">d</code></td>
<td>
<p>scalar for dimension (use d=2 for 2 input fields and d=3 for 3 inpt fields)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_system">system</code></td>
<td>
<p>for type of coordinate system (use 'p' for pressure system and 'z' for height system)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_rho">rho</code></td>
<td>
<p>field with dimensions (lon,lat,p) for density or a scalar rho (for constant density)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
<tr><td><code id="jacobian_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing Jacobian matrix and determinant
</p>

<hr>
<h2 id='omega'>omega</h2><span id='topic+omega'></span>

<h3>Description</h3>

<p>Earth's rotation frequency [1/s]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>omega()
</code></pre>

<hr>
<h2 id='R'>R</h2><span id='topic+R'></span>

<h3>Description</h3>

<p>ideal gas constant [J/(mol*K)]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R()
</code></pre>

<hr>
<h2 id='Rd'>Rd</h2><span id='topic+Rd'></span>

<h3>Description</h3>

<p>specific gas constant for dry air [J/(kg*K)]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rd()
</code></pre>

<hr>
<h2 id='re'>re</h2><span id='topic+re'></span>

<h3>Description</h3>

<p>Earth's radius [m]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>re()
</code></pre>

<hr>
<h2 id='readin_dim'>read in dimensions</h2><span id='topic+readin_dim'></span>

<h3>Description</h3>

<p>: reads dimensions of ERA5 data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readin_dim(filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readin_dim_+3A_filename">filename</code></td>
<td>
<p>name of file to read in</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data_dims = readin_dim(myfile)
</code></pre>

<hr>
<h2 id='readin_era5'>read in ERA5 data</h2><span id='topic+readin_era5'></span>

<h3>Description</h3>

<p>: reads ERA5 data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readin_era5(filename)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="readin_era5_+3A_filename">filename</code></td>
<td>
<p>name of file to read in</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myfile=system.file("extdata", "era5_storm-zeynep.nc", package = "meteoEVT")
data = readin_era5(myfile)
</code></pre>

<hr>
<h2 id='rot'>rotation</h2><span id='topic+rot'></span>

<h3>Description</h3>

<p>Calculates the rotation of a vector field
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rot(
  fld,
  lat = NULL,
  d = 3,
  system = "p",
  rho = NULL,
  dx = 0.25,
  dy = 0.25,
  plev = 5000,
  mode = "lonlat"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rot_+3A_fld">fld</code></td>
<td>
<p>with dimensions (lon,lat,p,d)</p>
</td></tr>
<tr><td><code id="rot_+3A_lat">lat</code></td>
<td>
<p>vector containing latitude</p>
</td></tr>
<tr><td><code id="rot_+3A_d">d</code></td>
<td>
<p>scalar for dimension (use d=2 for horizontal gradient and d=3 for 3d-gradient)</p>
</td></tr>
<tr><td><code id="rot_+3A_system">system</code></td>
<td>
<p>for type of coordinate system (use 'p' for pressure system and 'z' for height system)</p>
</td></tr>
<tr><td><code id="rot_+3A_rho">rho</code></td>
<td>
<p>field with dimensions (lon,lat,p) for density or a scalar rho (for constant density)</p>
</td></tr>
<tr><td><code id="rot_+3A_dx">dx</code></td>
<td>
<p>x resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="rot_+3A_dy">dy</code></td>
<td>
<p>y resolution in the corresponding unit (e.g. 0.25 degree for ERA5 with <code>mode='lonlat'</code> or e.g. 1000 m in cartesian coordinates with <code>mode='cartesian'</code>)</p>
</td></tr>
<tr><td><code id="rot_+3A_plev">plev</code></td>
<td>
<p>a scalar containing the p resolution (if equidistant) or a vector containing pressure levels in Pa (for non-equidistant)</p>
</td></tr>
<tr><td><code id="rot_+3A_mode">mode</code></td>
<td>
<p>the coordinate system, options are lonlat for a longitude-latitude-grid (default), or cartesian for an equidistant cartesian grid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field containing the divergence of fld
</p>

<hr>
<h2 id='Rv'>Rv</h2><span id='topic+Rv'></span>

<h3>Description</h3>

<p>specific gas constant for water vapor [J/(kg*K)]
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rv()
</code></pre>

<hr>
<h2 id='scalarprod'>scalar product</h2><span id='topic+scalarprod'></span>

<h3>Description</h3>

<p>Calculates the scalar product of two given fields
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scalarprod(fld1, fld2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scalarprod_+3A_fld1">fld1</code></td>
<td>
<p>field 1 with dimensions (lon,lat,p,d)</p>
</td></tr>
<tr><td><code id="scalarprod_+3A_fld2">fld2</code></td>
<td>
<p>field 2 with dimensions (lon,lat,p,d)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>field of the scalar product with dimensions (lon,lat,p)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
