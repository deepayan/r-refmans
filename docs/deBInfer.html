<!DOCTYPE html><html><head><title>Help for package deBInfer</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {deBInfer}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#chytrid'><p>Chytrid fungus data set</p></a></li>
<li><a href='#de_mcmc'><p>de_mcmc</p></a></li>
<li><a href='#debinfer_cov'><p>debinfer_cov</p></a></li>
<li><a href='#debinfer_par'><p>debinfer_par</p></a></li>
<li><a href='#deinits'><p>Get starting/fixed values of DE initial values</p></a></li>
<li><a href='#depars'><p>Get starting/fixed values of DE parameters</p></a></li>
<li><a href='#is.debinfer_parlist'><p>is.debinfer_parlist</p></a></li>
<li><a href='#is.debinfer_result'><p>is.debinfer_result</p></a></li>
<li><a href='#log_post_params'><p>log_post_params</p></a></li>
<li><a href='#log_prior_params'><p>log_prior_params</p></a></li>
<li><a href='#logd_prior'><p>logd_prior</p></a></li>
<li><a href='#logistic'><p>Logistic growth data set</p></a></li>
<li><a href='#pairs.debinfer_result'><p>Pairwise posterior marginals</p></a></li>
<li><a href='#plot.debinfer_result'><p>Plot inference outputs</p></a></li>
<li><a href='#plot.post_sim_list'><p>Plot posterior trajectory</p></a></li>
<li><a href='#post_prior_densplot'><p>Plot posterior marginals and corresponding priors</p></a></li>
<li><a href='#post_sim'><p>post_sim</p></a></li>
<li><a href='#prior_draw_rev'><p>prior_draw_rev</p></a></li>
<li><a href='#propose_joint_rev'><p>propose_joint</p></a></li>
<li><a href='#propose_single_rev'><p>propose_single_rev</p></a></li>
<li><a href='#reshape_post_sim'><p>Reshape posterior model solutions</p></a></li>
<li><a href='#setup_debinfer'><p>setup_debinfer</p></a></li>
<li><a href='#solve_de'><p>solve_de</p></a></li>
<li><a href='#summary.debinfer_result'><p>Summary of the inference results</p></a></li>
<li><a href='#update_sample_rev'><p>update_sample_rev</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Inference for Differential Equations</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-14</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pboesu/debinfer/issues">https://github.com/pboesu/debinfer/issues</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/pboesu/debinfer">https://github.com/pboesu/debinfer</a></td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian framework for parameter inference in differential equations.
    This approach offers a rigorous methodology for parameter inference as well as
    modeling the link between unobservable model states and parameters, and
    observable quantities. Provides templates for the DE model, the
    observation model and data likelihood, and the model parameters and their prior
    distributions. A Markov chain Monte Carlo (MCMC) procedure processes these inputs
    to estimate the posterior distributions of the parameters and any derived
    quantities, including the model trajectories. Further functionality is provided
    to facilitate MCMC diagnostics and the visualisation of the posterior distributions
    of model parameters and trajectories.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), deSolve</td>
</tr>
<tr>
<td>Imports:</td>
<td>truncdist, coda, RColorBrewer, MASS, stats, mvtnorm, graphics,
grDevices, plyr, PBSddesolve, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, devtools, R.rsp, beanplot</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-16 17:09:32 UTC; philipp.boerschsupan</td>
</tr>
<tr>
<td>Author:</td>
<td>Philipp H Boersch-Supan
    <a href="https://orcid.org/0000-0001-6723-6833"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Leah R Johnson <a href="https://orcid.org/0000-0002-9922-579X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sadie J Ryan <a href="https://orcid.org/0000-0002-4308-6321"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philipp H Boersch-Supan &lt;pboesu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-17 12:00:24 UTC</td>
</tr>
</table>
<hr>
<h2 id='chytrid'>Chytrid fungus data set</h2><span id='topic+chytrid'></span>

<h3>Description</h3>

<p>Replicated spore counts of an experimental culture of the chytrid fungus <em>Batrachochytrium dendrobatidis</em>.
This dataset is a subset of the observations from the experimental study conducted by Voyles et al. (2012).
</p>


<h3>Format</h3>

<p>A data.frame with 76 rows and two columns
</p>

<dl>
<dt>time</dt><dd><p>days since the start of the experiment</p>
</dd>
<dt>count</dt><dd><p>count of zoospores (x 1e4)</p>
</dd>
</dl>



<h3>References</h3>

<p>Voyles et al. 2012, Ecol Evol 9:2241-2249 <a href="https://doi.org/10.1002/ece3.334">doi:10.1002/ece3.334</a>
</p>

<hr>
<h2 id='de_mcmc'>de_mcmc</h2><span id='topic+de_mcmc'></span>

<h3>Description</h3>

<p>Bayesian inference for a deterministic DE model (with models
solved via an DE solver) with an observation model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>de_mcmc(
  N,
  data,
  de.model,
  obs.model,
  all.params,
  ref.params = NULL,
  ref.inits = NULL,
  Tmax,
  data.times,
  cnt = 10,
  plot = TRUE,
  sizestep = 0.01,
  solver = "ode",
  verbose.mcmc = TRUE,
  verbose = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="de_mcmc_+3A_n">N</code></td>
<td>
<p>integer, number of MCMC iterations</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_data">data</code></td>
<td>
<p>data.frame of time course observations to fit the model to. The observations must be ordered ascending by time.</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_de.model">de.model</code></td>
<td>
<p>a function defining a DE model, compliant with the solvers in deSolve or PBSddesolve</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_obs.model">obs.model</code></td>
<td>
<p>a function defining an observation model. Must be a function with arguments 'data', 'sim.data', 'samp'.</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_all.params">all.params</code></td>
<td>
<p>debinfer_parlist containing all model, MCMC, and observation</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_ref.params">ref.params</code></td>
<td>
<p>an optional named vector containing a set of reference parameters, e.g. the true parameters underlying a simulated data set</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_ref.inits">ref.inits</code></td>
<td>
<p>an optional named vector containing a set of reference initial values, e.g. the true initial values underlying a simulated data set</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_tmax">Tmax</code></td>
<td>
<p>maximum timestep for solver</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_data.times">data.times</code></td>
<td>
<p>time points for which observations are available</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_cnt">cnt</code></td>
<td>
<p>integer interval at which to print and possibly plot information on the current state of the MCMC chain</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_plot">plot</code></td>
<td>
<p>logical, plot traces for all parameters at the interval defined by <code>cnt</code></p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_sizestep">sizestep</code></td>
<td>
<p>timestep for solver to return values at, only used if data.times is missing</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_solver">solver</code></td>
<td>
<p>the solver to use. 1 or &quot;ode&quot; = deSolve::ode; 2 or &quot;dde&quot; = PBSddesolve::dde; 3 or &quot;dede&quot; = deSolve::dde</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_verbose.mcmc">verbose.mcmc</code></td>
<td>
<p>logical display MCMC progress messages</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_verbose">verbose</code></td>
<td>
<p>logical display verbose solver output</p>
</td></tr>
<tr><td><code id="de_mcmc_+3A_...">...</code></td>
<td>
<p>further arguments to the solver</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a debinfer_result object containing input parameters, data and MCMC samples
</p>

<hr>
<h2 id='debinfer_cov'>debinfer_cov</h2><span id='topic+debinfer_cov'></span>

<h3>Description</h3>

<p>debinfer_cov
</p>


<h3>Usage</h3>

<pre><code class='language-R'>debinfer_cov(var.names, sigma = diag(length(names)), name, samp.type = "rw")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="debinfer_cov_+3A_var.names">var.names</code></td>
<td>
<p>names of the parameters that are to be proposed together</p>
</td></tr>
<tr><td><code id="debinfer_cov_+3A_sigma">sigma</code></td>
<td>
<p>covariance matrix</p>
</td></tr>
<tr><td><code id="debinfer_cov_+3A_name">name</code></td>
<td>
<p>name of the joint block</p>
</td></tr>
<tr><td><code id="debinfer_cov_+3A_samp.type">samp.type</code></td>
<td>
<p>character; type of sampler. currently only &quot;rw&quot; = Normal random walk is implemented for multivariate proposals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a debinfer_cov object
</p>

<hr>
<h2 id='debinfer_par'>debinfer_par</h2><span id='topic+debinfer_par'></span>

<h3>Description</h3>

<p>Creates an object containing all the necessary bits for a parameter i.e. initial values, prior distributions,
hyper-parameters, tuning parameters, etc. to set up a debinfer analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>debinfer_par(
  name,
  var.type,
  fixed,
  value,
  joint = NULL,
  prior = NULL,
  hypers = NULL,
  prop.var = NULL,
  samp.type = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="debinfer_par_+3A_name">name</code></td>
<td>
<p>character vector; name of the variable</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_var.type">var.type</code></td>
<td>
<p>character vector; type of the variable &quot;de&quot; = parameter for the differential equation, &quot;obs&quot; = parameter of the observation model, &quot;init&quot; = initial condition for a state variable in the differential equation</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_fixed">fixed</code></td>
<td>
<p>boolean; TRUE = parameter is taken to be fixed, FALSE = parameter is to be estimated by MCMC</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_value">value</code></td>
<td>
<p>numeric; parameter value. For fixed parameters this is the value used in the analysis for free parameters this is the starting value used when setting up the MCMC chain</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_joint">joint</code></td>
<td>
<p>integer; number of block for joint proposal; NULL means the parameter is not to be jointly proposed</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_prior">prior</code></td>
<td>
<p>character; name of the probability distribution for the prior on the parameter. Must conform to standard R naming of d/r function pairs, e.g. beta ( foo = beta), binomial binom, Cauchy cauchy, chi-squared chisq, exponential exp, Fisher F f, gamma gamma, geometric geom, hypergeometric hyper, logistic logis, lognormal lnorm, negative binomial nbinom, normal norm, Poisson pois, Student t t, uniform unif, Weibull weibull. Priors from the truncdist package are available by default. User priors can be provided but must be available in the environment from which de_mcmc is called.</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_hypers">hypers</code></td>
<td>
<p>list of numeric vectors, hyperparameters for the prior; mean only for mvnorm. Can include trunc for truncated pdfs from package truncdist.</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_prop.var">prop.var</code></td>
<td>
<p>numeric; tuning parameters. For Normal proposals ('samp.type=&quot;rw&quot;' or 'samp.type=&quot;rw-ref&quot;'), this must be a positive number representing the standard deviation of the proposal distribution for each parameter. For the asymmetric uniform proposal distribution ('samp.type=&quot;rw-unif&quot;') two positive numeric values are required and the proposal will then have the bounds 'prop.var[1]/prop.var[2]*current_proposal' and 'prop.var[2]/prop.var[1]*current_proposal'. See Boersch-Supan et al. (2016).</p>
</td></tr>
<tr><td><code id="debinfer_par_+3A_samp.type">samp.type</code></td>
<td>
<p>character; type of sampler: &quot;rw&quot; = Normal random walk, &quot;ind&quot; = independence, &quot;rw-unif&quot; = asymmetric uniform distribution, &quot;rw-ref&quot; = reflecting random walk sampler on the bounds of the prior support (cf. Hoff 2009, Chapter 10.5.1; Yang and Rodriguez 2013)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class debinfer_par to be fed to the mcmc setup function
</p>


<h3>References</h3>

<p>Boersch-Supan et al. 2016, MEE 8:511-518 <a href="https://doi.org/10.1111/2041-210X.12679">doi:10.1111/2041-210X.12679</a>
</p>
<p>Hoff 2009, A First Course in Bayesian Statistical Methods, Springer
</p>
<p>Yang and Rodriguez 2013, PNAS 110:19307-19312 <a href="https://doi.org/10.1073/pnas.1311790110">doi:10.1073/pnas.1311790110</a>
</p>

<hr>
<h2 id='deinits'>Get starting/fixed values of DE initial values</h2><span id='topic+deinits'></span>

<h3>Description</h3>

<p>Accessor function for initial values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deinits(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deinits_+3A_x">x</code></td>
<td>
<p>a debinfer_result or debinfer_parlist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named numeric vector
</p>

<hr>
<h2 id='depars'>Get starting/fixed values of DE parameters</h2><span id='topic+depars'></span>

<h3>Description</h3>

<p>Accessor function for parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>depars(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="depars_+3A_x">x</code></td>
<td>
<p>a debinfer_result or debinfer_parlist object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a named numeric vector
</p>

<hr>
<h2 id='is.debinfer_parlist'>is.debinfer_parlist</h2><span id='topic+is.debinfer_parlist'></span>

<h3>Description</h3>

<p>Check debinfer_parlist class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.debinfer_parlist(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.debinfer_parlist_+3A_x">x</code></td>
<td>
<p>an object</p>
</td></tr>
</table>

<hr>
<h2 id='is.debinfer_result'>is.debinfer_result</h2><span id='topic+is.debinfer_result'></span>

<h3>Description</h3>

<p>Check debinfer_result class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.debinfer_result(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.debinfer_result_+3A_x">x</code></td>
<td>
<p>an object</p>
</td></tr>
</table>

<hr>
<h2 id='log_post_params'>log_post_params</h2><span id='topic+log_post_params'></span>

<h3>Description</h3>

<p>evaluate the likelihood given the data, the current deterministic model solution and the observation model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_post_params(samp, w.p, data, pdfs, hyper, sim.data, obs.model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_post_params_+3A_samp">samp</code></td>
<td>
<p>named numeric; current sample</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_w.p">w.p</code></td>
<td>
<p>character; parameter names</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_data">data</code></td>
<td>
<p>data</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_pdfs">pdfs</code></td>
<td>
<p>character, prior pdf names</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_hyper">hyper</code></td>
<td>
<p>list, hyper parameters for the priors</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_sim.data">sim.data</code></td>
<td>
<p>solver output</p>
</td></tr>
<tr><td><code id="log_post_params_+3A_obs.model">obs.model</code></td>
<td>
<p>function containing the observation model</p>
</td></tr>
</table>

<hr>
<h2 id='log_prior_params'>log_prior_params</h2><span id='topic+log_prior_params'></span>

<h3>Description</h3>

<p>evaluate prior density at current parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_prior_params(samp, pdfs, w.p, hyper)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_prior_params_+3A_samp">samp</code></td>
<td>
<p>named numeric; current sample</p>
</td></tr>
<tr><td><code id="log_prior_params_+3A_pdfs">pdfs</code></td>
<td>
<p>character, prior pdf names</p>
</td></tr>
<tr><td><code id="log_prior_params_+3A_w.p">w.p</code></td>
<td>
<p>character; parameter names</p>
</td></tr>
<tr><td><code id="log_prior_params_+3A_hyper">hyper</code></td>
<td>
<p>list of named hyper parameters for the priors</p>
</td></tr>
</table>

<hr>
<h2 id='logd_prior'>logd_prior</h2><span id='topic+logd_prior'></span>

<h3>Description</h3>

<p>Evaluates the log probability density of value given a name of a prior pdf and the corresponding hyperparameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logd_prior(x, pdf, hypers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logd_prior_+3A_x">x</code></td>
<td>
<p>numeric; vector of values.</p>
</td></tr>
<tr><td><code id="logd_prior_+3A_pdf">pdf</code></td>
<td>
<p>character; name of a probability function. Must conform to base R nomenclature of d/r function pairs. Can include trunc for truncated pdfs from package truncdist.</p>
</td></tr>
<tr><td><code id="logd_prior_+3A_hypers">hypers</code></td>
<td>
<p>list; a list of parameters to be passed to the density function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value of the log density function evaluated at <code>x</code>
</p>

<hr>
<h2 id='logistic'>Logistic growth data set</h2><span id='topic+logistic'></span>

<h3>Description</h3>

<p>Simulated data from the logistic growth model with N_0=0.1, r=0.1 and K=10
</p>


<h3>Format</h3>

<p>A data.frame with 36 rows and 3 columns
</p>

<dl>
<dt>time</dt><dd><p>time since start of the model</p>
</dd>
<dt>N_true</dt><dd><p>Numerical solution of N_t </p>
</dd>
<dt>N_noisy</dt><dd><p>N_t with the addition of log-normal noise, where sdlog = 0.05</p>
</dd>
</dl>


<hr>
<h2 id='pairs.debinfer_result'>Pairwise posterior marginals</h2><span id='topic+pairs.debinfer_result'></span>

<h3>Description</h3>

<p>Plots pairwise correlations of posterior marginals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'debinfer_result'
pairs(x, trend = FALSE, scatter = FALSE, burnin = NULL, medians = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairs.debinfer_result_+3A_x">x</code></td>
<td>
<p>a deBInfer_result object</p>
</td></tr>
<tr><td><code id="pairs.debinfer_result_+3A_trend">trend</code></td>
<td>
<p>logical, add loess smooth</p>
</td></tr>
<tr><td><code id="pairs.debinfer_result_+3A_scatter">scatter</code></td>
<td>
<p>logical, add scatterplot of posterior samples</p>
</td></tr>
<tr><td><code id="pairs.debinfer_result_+3A_burnin">burnin</code></td>
<td>
<p>integer, number of samples to discard from start of chain before plotting</p>
</td></tr>
<tr><td><code id="pairs.debinfer_result_+3A_medians">medians</code></td>
<td>
<p>logical, plot marginal medians on contour plot</p>
</td></tr>
<tr><td><code id="pairs.debinfer_result_+3A_...">...</code></td>
<td>
<p>further arguments to plot.default (the call that draws the scatter/contour plot)</p>
</td></tr>
</table>

<hr>
<h2 id='plot.debinfer_result'>Plot inference outputs</h2><span id='topic+plot.debinfer_result'></span>

<h3>Description</h3>

<p>Plots the inference results from a debinfer_result object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'debinfer_result'
plot(x, plot.type = "coda", burnin = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.debinfer_result_+3A_x">x</code></td>
<td>
<p>a deBInfer_result object</p>
</td></tr>
<tr><td><code id="plot.debinfer_result_+3A_plot.type">plot.type</code></td>
<td>
<p>character, which type of plot. Options are &quot;coda&quot; for coda::plot.mcmc, &quot;post_prior&quot; for deBInfer::post_prior_densplot.</p>
</td></tr>
<tr><td><code id="plot.debinfer_result_+3A_burnin">burnin</code></td>
<td>
<p>numeric, number of samples to discard before plotting</p>
</td></tr>
<tr><td><code id="plot.debinfer_result_+3A_...">...</code></td>
<td>
<p>further arguments to methods</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+post_prior_densplot">post_prior_densplot</a></code>, <code><a href="coda.html#topic+plot.mcmc">plot.mcmc</a></code>, <code><a href="#topic+pairs.debinfer_result">pairs.debinfer_result</a></code>
</p>

<hr>
<h2 id='plot.post_sim_list'>Plot posterior trajectory</h2><span id='topic+plot.post_sim_list'></span>

<h3>Description</h3>

<p>Plots the inference results from a debinfer_result object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'post_sim_list'
plot(
  x,
  plot.type = "medianHDI",
  col = c("red", "darkgrey"),
  lty = c(1, 2),
  auto.layout = TRUE,
  panel.first = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.post_sim_list_+3A_x">x</code></td>
<td>
<p>a post_sim or post_sim_list object</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_plot.type">plot.type</code></td>
<td>
<p>character, which type of plot. Options are &quot;ensemble&quot; and &quot;medianHDI&quot;.</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_col">col</code></td>
<td>
<p>color, for plot.type = &quot;medianHDI&quot; the first element is used for the median, the second for the HDI</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_lty">lty</code></td>
<td>
<p>line type, for plot.type = &quot;medianHDI&quot; the first element is used for the median, the second for the HDI</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_auto.layout">auto.layout</code></td>
<td>
<p>logical, should the layout for plot.type = &quot;medianHDI&quot; be determined automatically?</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_panel.first">panel.first</code></td>
<td>
<p>an expression to be evaluated after the plot axes are set up but before any plotting takes place. This can be useful for adding data points.</p>
</td></tr>
<tr><td><code id="plot.post_sim_list_+3A_...">...</code></td>
<td>
<p>further arguments to methods</p>
</td></tr>
</table>

<hr>
<h2 id='post_prior_densplot'>Plot posterior marginals and corresponding priors</h2><span id='topic+post_prior_densplot'></span>

<h3>Description</h3>

<p>Plots posterior densities and the densities of the corresponding priors. The prior density is automatically evaluated for the range given by the x-axis limits of the plot (which defaults to the posterior support).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_prior_densplot(
  result,
  param = "all",
  burnin = NULL,
  prior.col = "red",
  n = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_prior_densplot_+3A_result">result</code></td>
<td>
<p>a deBInfer_result object</p>
</td></tr>
<tr><td><code id="post_prior_densplot_+3A_param">param</code></td>
<td>
<p>character, name of parameter to plot. &quot;all&quot; (default) plots all parameters</p>
</td></tr>
<tr><td><code id="post_prior_densplot_+3A_burnin">burnin</code></td>
<td>
<p>numeric, number of samples to discard before plotting</p>
</td></tr>
<tr><td><code id="post_prior_densplot_+3A_prior.col">prior.col</code></td>
<td>
<p>character color for prior density</p>
</td></tr>
<tr><td><code id="post_prior_densplot_+3A_n">n</code></td>
<td>
<p>integer, number of points at which to evaluate the prior density.</p>
</td></tr>
<tr><td><code id="post_prior_densplot_+3A_...">...</code></td>
<td>
<p>further arguments to coda::densplot</p>
</td></tr>
</table>

<hr>
<h2 id='post_sim'>post_sim</h2><span id='topic+post_sim'></span>

<h3>Description</h3>

<p>post_sim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>post_sim(x, n = 100, times, output = "all", burnin = NULL, prob = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="post_sim_+3A_x">x</code></td>
<td>
<p>debinfer_result object</p>
</td></tr>
<tr><td><code id="post_sim_+3A_n">n</code></td>
<td>
<p>number of simulations</p>
</td></tr>
<tr><td><code id="post_sim_+3A_times">times</code></td>
<td>
<p>numeric a vector of times at which the ODE is to be evaluated. Defaults to NULL.</p>
</td></tr>
<tr><td><code id="post_sim_+3A_output">output</code></td>
<td>
<p>character, &quot;sims&quot;, &quot;all&quot;, &quot;HDI&quot;</p>
</td></tr>
<tr><td><code id="post_sim_+3A_burnin">burnin</code></td>
<td>
<p>integer, number of samples to discard from the start of the mcmc chain</p>
</td></tr>
<tr><td><code id="post_sim_+3A_prob">prob</code></td>
<td>
<p>A numeric scalar in the interval (0,1) giving the target probability content of the intervals. The nominal probability content of the intervals is the multiple of 1/nrow(obj) nearest to prob.</p>
</td></tr>
<tr><td><code id="post_sim_+3A_...">...</code></td>
<td>
<p>additional arguments to solver</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a post_sim object containing a list of de solutions or summaries thereof
</p>

<hr>
<h2 id='prior_draw_rev'>prior_draw_rev</h2><span id='topic+prior_draw_rev'></span>

<h3>Description</h3>

<p>draw from prior
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_draw_rev(b, hypers, prior.pdf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="prior_draw_rev_+3A_b">b</code></td>
<td>
<p>current value of a parameter</p>
</td></tr>
<tr><td><code id="prior_draw_rev_+3A_hypers">hypers</code></td>
<td>
<p>list of hyper parameters, named appropriately for the corresponding prior.pdf</p>
</td></tr>
<tr><td><code id="prior_draw_rev_+3A_prior.pdf">prior.pdf</code></td>
<td>
<p>string name of probability distribution following base R conventions, or those of additionally loaded packages</p>
</td></tr>
</table>

<hr>
<h2 id='propose_joint_rev'>propose_joint</h2><span id='topic+propose_joint_rev'></span>

<h3>Description</h3>

<p>joint proposal function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propose_joint_rev(samps, s.ps, cov.mat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propose_joint_rev_+3A_samps">samps</code></td>
<td>
<p>current sample of the MCMC chain</p>
</td></tr>
<tr><td><code id="propose_joint_rev_+3A_s.ps">s.ps</code></td>
<td>
<p>debinfer_parlist object representing the parameters that are to be proposed</p>
</td></tr>
<tr><td><code id="propose_joint_rev_+3A_cov.mat">cov.mat</code></td>
<td>
<p>debinfer_cov object; covariance matrix for the proposal</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to jointly propose parameters using a multivariate normal proposal distribution
</p>

<hr>
<h2 id='propose_single_rev'>propose_single_rev</h2><span id='topic+propose_single_rev'></span>

<h3>Description</h3>

<p>propose a parameter individually
</p>


<h3>Usage</h3>

<pre><code class='language-R'>propose_single_rev(samps, s.p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="propose_single_rev_+3A_samps">samps</code></td>
<td>
<p>current sample of the MCMC chain</p>
</td></tr>
<tr><td><code id="propose_single_rev_+3A_s.p">s.p</code></td>
<td>
<p>debinfer_par object representing the parameter that is to be proposed</p>
</td></tr>
</table>

<hr>
<h2 id='reshape_post_sim'>Reshape posterior model solutions</h2><span id='topic+reshape_post_sim'></span>

<h3>Description</h3>

<p>Take a list of DE model solutions and transform into a list of of matrices, one for each state variable, where each row is an iteration, and each column is a time point
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_post_sim(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reshape_post_sim_+3A_x">x</code></td>
<td>
<p>a post_sim object</p>
</td></tr>
</table>

<hr>
<h2 id='setup_debinfer'>setup_debinfer</h2><span id='topic+setup_debinfer'></span>

<h3>Description</h3>

<p>Creates an object of class debinfer_parlist containing initial values, parameters, prior distributions, hyperparameters
tuning parameters etc. to set up a debinfer analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_debinfer(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setup_debinfer_+3A_...">...</code></td>
<td>
<p>debinfer_par objects to be combined into a debinfer_parlist</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an S3 object of class debinfer_parlist to be fed to the mcmc function
</p>

<hr>
<h2 id='solve_de'>solve_de</h2><span id='topic+solve_de'></span>

<h3>Description</h3>

<p>solve_de
</p>


<h3>Usage</h3>

<pre><code class='language-R'>solve_de(
  sim,
  params,
  inits,
  Tmax,
  numsteps = 10000,
  solver = "ode",
  sizestep = NULL,
  verbose = FALSE,
  data.times = NULL,
  method = "lsoda",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="solve_de_+3A_sim">sim</code></td>
<td>
<p>function; solver compatible specification of the DE</p>
</td></tr>
<tr><td><code id="solve_de_+3A_params">params</code></td>
<td>
<p>numeric; named vector of parameter values</p>
</td></tr>
<tr><td><code id="solve_de_+3A_inits">inits</code></td>
<td>
<p>numeric; initial values. Must be in the same order as specified within sim!</p>
</td></tr>
<tr><td><code id="solve_de_+3A_tmax">Tmax</code></td>
<td>
<p>numeric; maximum timestep</p>
</td></tr>
<tr><td><code id="solve_de_+3A_numsteps">numsteps</code></td>
<td>
<p>numeric</p>
</td></tr>
<tr><td><code id="solve_de_+3A_solver">solver</code></td>
<td>
<p>Choice of solver to use 1 or &quot;ode&quot; = deSolve::ode, 2 or &quot;dde&quot; = PBSddesolve::dde, 3 or &quot;dede&quot; = deSolve::dede</p>
</td></tr>
<tr><td><code id="solve_de_+3A_sizestep">sizestep</code></td>
<td>
<p>for solver</p>
</td></tr>
<tr><td><code id="solve_de_+3A_verbose">verbose</code></td>
<td>
<p>passed to deSolve::ode</p>
</td></tr>
<tr><td><code id="solve_de_+3A_data.times">data.times</code></td>
<td>
<p>numeric a vector of times at which the ODE is to be evaluated. Defaults to NULL. If value is supplied it takes precedence over any value supplied to <code>numsteps</code> or <code>sizesteps</code>.</p>
</td></tr>
<tr><td><code id="solve_de_+3A_method">method</code></td>
<td>
<p>solver method</p>
</td></tr>
<tr><td><code id="solve_de_+3A_...">...</code></td>
<td>
<p>additional arguments to solver</p>
</td></tr>
</table>


<h3>Value</h3>

<p>integrated ode object. Data structure depends on the employed solver.
</p>

<hr>
<h2 id='summary.debinfer_result'>Summary of the inference results</h2><span id='topic+summary.debinfer_result'></span>

<h3>Description</h3>

<p>A wrapper for coda::summary.mcmc
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'debinfer_result'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.debinfer_result_+3A_object">object</code></td>
<td>
<p>a deBInfer_result object</p>
</td></tr>
<tr><td><code id="summary.debinfer_result_+3A_...">...</code></td>
<td>
<p>further arguments to summary.mcmc</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="coda.html#topic+summary.mcmc">summary.mcmc</a></code>
</p>

<hr>
<h2 id='update_sample_rev'>update_sample_rev</h2><span id='topic+update_sample_rev'></span>

<h3>Description</h3>

<p>This is the workhorse of the MCMC algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_sample_rev(
  samps,
  samp.p,
  cov.mats,
  data,
  sim,
  out,
  Tmax,
  sizestep,
  data.times,
  l,
  solver,
  i,
  cnt,
  obs.model,
  pdfs,
  hyper,
  w.p,
  verbose.mcmc,
  verbose,
  is.de,
  is.single,
  joint.blocks,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_sample_rev_+3A_samps">samps</code></td>
<td>
<p>row vector of samples from the previous mcmc iteration</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_samp.p">samp.p</code></td>
<td>
<p>the parlist created by setup_debinfer</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_cov.mats">cov.mats</code></td>
<td>
<p>the covariance matrices</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_data">data</code></td>
<td>
<p>the observation</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_sim">sim</code></td>
<td>
<p>the de.model</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_out">out</code></td>
<td>
<p>list containing the initial or previous update i.e. list(s=samps[i-1,], inits=inits, p=params, sim.old=sim.start)</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_tmax">Tmax</code></td>
<td>
<p>maximum timestep for solver</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_sizestep">sizestep</code></td>
<td>
<p>sizestep for solver when not using data.times</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_data.times">data.times</code></td>
<td>
<p>times with observations</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_l">l</code></td>
<td>
<p>number of parameters to be proposed</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_solver">solver</code></td>
<td>
<p>solver choice</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_i">i</code></td>
<td>
<p>current MCMC iteration</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_cnt">cnt</code></td>
<td>
<p>interval for printing/plotting information on chains</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_obs.model">obs.model</code></td>
<td>
<p>function containing obs model</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_pdfs">pdfs</code></td>
<td>
<p>names of prior pdfs</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_hyper">hyper</code></td>
<td>
<p>list of hyperparameters</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_w.p">w.p</code></td>
<td>
<p>names of free parameters</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_verbose.mcmc">verbose.mcmc</code></td>
<td>
<p>logical print MCMC progress messages</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_verbose">verbose</code></td>
<td>
<p>logical, print additional information from solver</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_is.de">is.de</code></td>
<td>
<p>logical, parameter is an input for the solver</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_is.single">is.single</code></td>
<td>
<p>parameter is to be proposed individually</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_joint.blocks">joint.blocks</code></td>
<td>
<p>names of joint blocks</p>
</td></tr>
<tr><td><code id="update_sample_rev_+3A_...">...</code></td>
<td>
<p>further arguments to solver</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
