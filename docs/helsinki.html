<!DOCTYPE html><html><head><title>Help for package helsinki</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {helsinki}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#helsinki-package'><p>Helsinki open data R tools</p></a></li>
<li><a href='#get_city_map'><p>Get city administrative regions</p></a></li>
<li><a href='#get_feature'><p>Produce an SF object</p></a></li>
<li><a href='#get_feature_list'><p>Print all available Features</p></a></li>
<li><a href='#get_hri_dataset_list'><p>List HRI datasets</p></a></li>
<li><a href='#get_hri_dataset_metadata'><p>Get HRI dataset metadata</p></a></li>
<li><a href='#get_hri_stats'><p>Helsinki Region Infoshare statistics API</p></a></li>
<li><a href='#get_linkedevents'><p>Access Helsinki Linked Events API</p></a></li>
<li><a href='#get_rakennustietoruudukko'><p>Produce an SF object: Rakennustietoruudukko</p></a></li>
<li><a href='#get_servicemap'><p>Access Helsinki region Service Map API</p></a></li>
<li><a href='#get_vaestotietoruudukko'><p>Produce an SF object: Vaestotietoruudukko</p></a></li>
<li><a href='#gracefully_fail'><p>Gracefully fail internet resources</p></a></li>
<li><a href='#helsinki-deprecated'><p>Deprecated functions in package <span class="pkg">helsinki</span>.</p></a></li>
<li><a href='#select_feature'><p>Interactively browse and select features</p></a></li>
<li><a href='#to_sf'><p>Transform to sf-object</p></a></li>
<li><a href='#wfs_api'><p>WFS API</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Tools for Helsinki Open Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.6</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-30</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for accessing various open data APIs in the Helsinki
    region in Finland. Current data sources include the Service Map API,
    Linked Events API, and Helsinki Region Infoshare statistics API.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>jsonlite, httr, purrr, xml2, methods, dplyr, sf, curl,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, remotes, ggplot2, covr, testthat (&ge;
3.0.0),</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://ropengov.github.io/helsinki/">http://ropengov.github.io/helsinki/</a>,
<a href="https://github.com/rOpenGov/helsinki">https://github.com/rOpenGov/helsinki</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropengov/helsinki/issues">https://github.com/ropengov/helsinki/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>X-schema.org-isPartOf:</td>
<td>http://ropengov.org/</td>
</tr>
<tr>
<td>X-schema.org-keywords:</td>
<td>ropengov</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-02 07:52:31 UTC; juusoparkkinen</td>
</tr>
<tr>
<td>Author:</td>
<td>Juuso Parkkinen [aut, cre],
  Joona Lehtomaki [aut],
  Pyry Kantanen <a href="https://orcid.org/0000-0003-2853-2765"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Leo Lahti <a href="https://orcid.org/0000-0001-5537-637X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Juuso Parkkinen &lt;juuso.parkkinen@iki.fi&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-02 09:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='helsinki-package'>Helsinki open data R tools</h2><span id='topic+helsinki-package'></span><span id='topic+helsinki'></span>

<h3>Description</h3>

<p>Brief summary of the helsinki package
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> helsinki</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> See sessionInfo() or DESCRIPTION file</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2013-2022</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> BSD-2-Clause</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Tools for accessing various open data sources in the Helsinki region in Finland.
</p>


<h3>Author(s)</h3>

<p>Juuso Parkkinen, Leo Lahti, Joona Lehtomaki and
Pyry Kantanen <a href="mailto:louhos@googlegroups.com">louhos@googlegroups.com</a>
</p>


<h3>References</h3>

<p>See citation(&quot;helsinki&quot;)
<a href="https://github.com/rOpenGov/helsinki">https://github.com/rOpenGov/helsinki</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># library(helsinki)
</code></pre>

<hr>
<h2 id='get_city_map'>Get city administrative regions</h2><span id='topic+get_city_map'></span>

<h3>Description</h3>

<p>Sf object of city districts in the Helsinki Capital Region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_city_map(city = NULL, level = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_city_map_+3A_city">city</code></td>
<td>
<p>The desired city. Valid options: <em>Helsinki</em>, <em>Espoo</em>, <em>Vantaa</em>,
<em>Kauniainen</em></p>
</td></tr>
<tr><td><code id="get_city_map_+3A_level">level</code></td>
<td>
<p>The desired administrative level. Valid options: <em>suurpiiri</em>,
<em>tilastoalue</em>, <em>pienalue</em> and <em>aanestysalue</em></p>
</td></tr>
<tr><td><code id="get_city_map_+3A_...">...</code></td>
<td>
<p>For passing parameters to embedded functions, for example
<em>timeout.s</em> (timeout in seconds) in the case of <strong>gracefully_fail()</strong>
internal function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+get_feature_list">get_feature_list()</a></code> for a list of all available features
</p>


<h3>Value</h3>

<p>sf object
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>Source</h3>

<p>Metropolitan area in districts: <a href="https://hri.fi/data/en_GB/dataset/seutukartta">https://hri.fi/data/en_GB/dataset/seutukartta</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
map &lt;- get_city_map(city = "helsinki", level = "suuralue")

## End(Not run)

</code></pre>

<hr>
<h2 id='get_feature'>Produce an SF object</h2><span id='topic+get_feature'></span>

<h3>Description</h3>

<p>Produces an sf object for easy visualization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_feature(
  base.url = "https://kartta.hsy.fi/geoserver/wfs",
  typename = "asuminen_ja_maankaytto:Vaestotietoruudukko_2015",
  CRS = 3879
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_feature_+3A_base.url">base.url</code></td>
<td>
<p>WFS url, for example &quot;https://kartta.hsy.fi/geoserver/wfs&quot;</p>
</td></tr>
<tr><td><code id="get_feature_+3A_typename">typename</code></td>
<td>
<p>accepts feature names, e.g. &quot;asuminen_ja_maankaytto:1000m_verkostobufferi&quot;
No short form titles here, e.g. &quot;1000m_verkostobufferi&quot;!</p>
</td></tr>
<tr><td><code id="get_feature_+3A_crs">CRS</code></td>
<td>
<p>Default CRS is 3879 (or EPSG:3879), see ?sf::st_crs for other input options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf object
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Use <code><a href="#topic+get_feature_list">get_feature_list</a></code> to list all available features
for a given WFS, <code><a href="#topic+select_feature">select_feature</a></code> for listing and selecting a
feature
</p>

<hr>
<h2 id='get_feature_list'>Print all available Features</h2><span id='topic+get_feature_list'></span>

<h3>Description</h3>

<p>Basically a neat wrapper for &quot;request=GetCapabilities&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_feature_list(base.url = NULL, queries = c(request = "GetCapabilities"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_feature_list_+3A_base.url">base.url</code></td>
<td>
<p>WFS url, for example &quot;https://kartta.hsy.fi/geoserver/wfs&quot;</p>
</td></tr>
<tr><td><code id="get_feature_list_+3A_queries">queries</code></td>
<td>
<p>desired query for acquiring the list of features, default
is &quot;request=GetCapabilities&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Lists all <code style="white-space: pre;">&#8288;&lt;FeatureType&gt;&#8288;</code> nodes.
</p>


<h3>Value</h3>

<p>data frame
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Use <code><a href="#topic+get_feature">get_feature()</a></code> to download feature,
<code><a href="#topic+select_feature">select_feature()</a></code> for menu-driven listing and downloading
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
dat &lt;- get_feature_list(base.url = "https://kartta.hsy.fi/geoserver/wfs")

## End(Not run)

</code></pre>

<hr>
<h2 id='get_hri_dataset_list'>List HRI datasets</h2><span id='topic+get_hri_dataset_list'></span>

<h3>Description</h3>

<p>List HRI datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hri_dataset_list()
</code></pre>


<h3>Details</h3>

<p>This function lists all available HRI datasets.
</p>

<hr>
<h2 id='get_hri_dataset_metadata'>Get HRI dataset metadata</h2><span id='topic+get_hri_dataset_metadata'></span>

<h3>Description</h3>

<p>Get HRI dataset metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hri_dataset_metadata(id)
</code></pre>


<h3>Details</h3>

<p>This function fetches metadata for HRI datasets.
</p>

<hr>
<h2 id='get_hri_stats'>Helsinki Region Infoshare statistics API</h2><span id='topic+get_hri_stats'></span>

<h3>Description</h3>

<p>Retrieves data from the Helsinki Region Infoshare (HRI)
statistics API: <a href="http://dev.hel.fi/stats/">http://dev.hel.fi/stats/</a>.
Currently provides access to the <em>aluesarjat</em> data:
<a href="https://stat.hel.fi/pxweb/fi/Aluesarjat/">https://stat.hel.fi/pxweb/fi/Aluesarjat/</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_hri_stats(query = "", verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_hri_stats_+3A_query">query</code></td>
<td>
<p>A string, specifying the dataset to query</p>
</td></tr>
<tr><td><code id="get_hri_stats_+3A_verbose">verbose</code></td>
<td>
<p>logical. Should R report extra information on progress?
Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Current implementation is very simple.
You can either get the list of resources with query=&quot;&quot;,
or query for a specific resources and retrieve it in a
three-dimensional array form.
</p>


<h3>Value</h3>

<p>multi-dimensional array
</p>


<h3>Author(s)</h3>

<p>Juuso Parkkinen <a href="mailto:louhos@googlegroups.com">louhos@googlegroups.com</a>
</p>


<h3>References</h3>

<p>See citation(&quot;helsinki&quot;)
</p>


<h3>See Also</h3>

<p>See <a href="https://dev.hel.fi/apis/statistics/">https://dev.hel.fi/apis/statistics/</a>dev.hel.fi website and
<a href="http://dev.hel.fi/stats/">http://dev.hel.fi/stats/</a>API documentation (in Finnish)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
stats_array &lt;- get_hri_stats("aluesarjat_a03s_hki_vakiluku_aidinkieli")

## End(Not run)

</code></pre>

<hr>
<h2 id='get_linkedevents'>Access Helsinki Linked Events API</h2><span id='topic+get_linkedevents'></span>

<h3>Description</h3>

<p>Easy access to Helsinki Linked Events API
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_linkedevents(query, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_linkedevents_+3A_query">query</code></td>
<td>
<p>The API query as a string, for example &quot;event&quot;, &quot;category&quot;,
&quot;language&quot;, &quot;place&quot; or &quot;keyword&quot;.</p>
</td></tr>
<tr><td><code id="get_linkedevents_+3A_...">...</code></td>
<td>
<p>Additional parameters that narrow down the output (optional).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Complete list of possible query input: &quot;keyword&quot;, &quot;keyword_set&quot;, &quot;place&quot;,
&quot;language&quot;, &quot;organization&quot;, &quot;image&quot;, &quot;event&quot;, &quot;search&quot;, &quot;user&quot;.
</p>
<p>With &quot;...&quot; the user can pass on additional parameters that depend on the
chosen query input. For example, when performing a search (query = &quot;search&quot;),
the search can be narrowed down with parameters such as:
</p>

<ul>
<li><p>q=&quot;konsertti&quot; complete search, returns events that have the word &quot;konsertti&quot;
</p>
</li>
<li><p>input=&quot;konse&quot; partial search, returns events with words that contain &quot;konse&quot;
</p>
</li>
<li><p>type=&quot;event&quot; returns only &quot;events&quot;
</p>
</li>
<li><p>start=&quot;2017-01-01&quot; events starting on 2017-01-01 or after
</p>
</li>
<li><p>end=&quot;2017-01-10&quot; events ending on 2017-01-10 or before
</p>
</li></ul>

<p>For more detailed explanation, see <a href="http://api.hel.fi/linkedevents/v1/">http://api.hel.fi/linkedevents/v1/</a>.
</p>


<h3>Value</h3>

<p>Data frame or a list
</p>


<h3>Author(s)</h3>

<p>Juuso Parkkinen <a href="mailto:louhos@googlegroups.com">louhos@googlegroups.com</a>, Pyry Kantanen
</p>


<h3>Source</h3>

<p>Helsinki Linked Events API v1. Developed by the City of Helsinki
Open Software Development team. Event data from Helsinki Marketing, Helsinki
Cultural Centres, Helmet metropolitan area public libraries and City of
Helsinki registry of service unit.
CC BY 4.0. <a href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a>
</p>
<p>For more API documentation and license information see the API link:
<a href="http://api.hel.fi/linkedevents/v1/">http://api.hel.fi/linkedevents/v1/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
events &lt;- get_linkedevents(query="search", q="teatteri", start="2020-01-01")

## End(Not run)

</code></pre>

<hr>
<h2 id='get_rakennustietoruudukko'>Produce an SF object: Rakennustietoruudukko</h2><span id='topic+get_rakennustietoruudukko'></span>

<h3>Description</h3>

<p>Produces an sf object for Rakennustietoruudukko (building
information grid).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_rakennustietoruudukko(year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_rakennustietoruudukko_+3A_year">year</code></td>
<td>
<p>year as numeric between 1997-1998 and 2009-2021.
If NULL (default), the function will return the latest available dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional data not available here can be manually downloaded from
HRI website: <a href="https://hri.fi/data/fi/dataset/rakennustietoruudukko">https://hri.fi/data/fi/dataset/rakennustietoruudukko</a>
</p>
<p>Years 2015-2021 are tested to work at the time of development.
Additional years may be added in the future and older datasets may be removed
from the API. Datasets from years 2015-2021 are downloaded from HSY WFS API and datasets
for other years are downloaded as zip files from HRI website. The format of
the output might be a bit different between datasets downloaded from the WFS
API and datasets downloaded from HRI website.
</p>
<p>Additional years may be added in the future and older datasets may be removed
from the API. See package NEWS for more information.
</p>
<p>The current datasets can be listed with <code><a href="#topic+get_feature_list">get_feature_list()</a></code>
or <code><a href="#topic+select_feature">select_feature()</a></code>.
</p>


<h3>Value</h3>

<p>sf object
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
building_grid &lt;- get_rakennustietoruudukko(year = 2021)

## End(Not run)

</code></pre>

<hr>
<h2 id='get_servicemap'>Access Helsinki region Service Map API</h2><span id='topic+get_servicemap'></span>

<h3>Description</h3>

<p>Access the new Helsinki region Service Map (Paakaupunkiseudun
Palvelukartta, <a href="https://palvelukartta.hel.fi/fi/">https://palvelukartta.hel.fi/fi/</a>) data through the API:
<a href="http://api.hel.fi/servicemap/v2/">http://api.hel.fi/servicemap/v2/</a>. For more API documentation and license
information see the API link.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_servicemap(query, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_servicemap_+3A_query">query</code></td>
<td>
<p>The API query as a string, for example <em>search</em>, <em>service</em>,
or <em>unit</em>. For full list of available options and details, see
<a href="https://dev.hel.fi/apis/service-map-backend-api/">https://dev.hel.fi/apis/service-map-backend-api/</a>.</p>
</td></tr>
<tr><td><code id="get_servicemap_+3A_...">...</code></td>
<td>
<p>Additional parameters to the API (optional).
For additional details, see
<a href="https://dev.hel.fi/apis/service-map-backend-api/">https://dev.hel.fi/apis/service-map-backend-api/</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Complete list of possible query input:
</p>

<ul>
<li><p>&quot;unit&quot; unit, or service point
</p>
</li>
<li><p>&quot;service&quot; category of service provided by a unit
</p>
</li>
<li><p>&quot;organization&quot; organization providing services
</p>
</li>
<li><p>&quot;search&quot; full text search for units, services and street addresses
</p>
</li>
<li><p>&quot;accessibility&quot; rule database for calculating accessibility scores
</p>
</li>
<li><p>&quot;geography&quot; spatial information, where services are located
</p>
</li></ul>

<p>With &quot;...&quot; the user can pass on additional parameters that depend on the
chosen query input. For example, when performing a search (query = &quot;search&quot;),
the search can be narrowed down with parameters such as:
</p>

<ul>
<li><p>&quot;q&quot; complete search
</p>
</li>
<li><p>&quot;input&quot; partial search
</p>
</li>
<li><p>&quot;type&quot; valid types: service_node, service, unit, address
</p>
</li>
<li><p>&quot;language&quot; as two-character ISO-639-1 code: fi, sv, en
</p>
</li>
<li><p>&quot;municipality&quot; comma-separated list of municipalities, lower-case, in Finnish
</p>
</li>
<li><p>&quot;service&quot; comma-separated list of service IDs
</p>
</li>
<li><p>&quot;include&quot; include the complete content from certain fields with a comma-separated list of field names  with a valid type prefix
</p>
</li>
<li><p>&quot;only&quot; restricts the results with a comma-separated list of field names with a valid type prefix
</p>
</li>
<li><p>&quot;page&quot; request a certain page number
</p>
</li>
<li><p>&quot;page_size&quot; determine number of entries in one page
</p>
</li></ul>

<p>For more detailed explanation, see <a href="https://dev.hel.fi/apis/service-map-backend-api/">https://dev.hel.fi/apis/service-map-backend-api/</a>.
</p>


<h3>Value</h3>

<p>Data frame or a list
</p>


<h3>Author(s)</h3>

<p>Juuso Parkkinen <a href="mailto:louhos@googlegroups.com">louhos@googlegroups.com</a>, Pyry Kantanen
</p>


<h3>Source</h3>

<p>API contents: All content is available under CC BY 4.0,
except where otherwise stated. The City of Helsinki logo is a registered
trademark. The Helsinki Grotesk Typeface is a proprietary typeface licensed
by Camelot Typefaces. <a href="https://creativecommons.org/licenses/by/4.0/">https://creativecommons.org/licenses/by/4.0/</a>
</p>
<p>API Location: <a href="https://api.hel.fi/servicemap/v2/">https://api.hel.fi/servicemap/v2/</a>
</p>
<p>API documentation: <a href="https://dev.hel.fi/apis/service-map-backend-api/">https://dev.hel.fi/apis/service-map-backend-api/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# A data.frame with 47 variables
search_puisto &lt;- get_servicemap(query="search", q="puisto")
# A data.frame with 7 variables
search_padel &lt;- get_servicemap(query="search", input="padel", 
only="unit.name, unit.location.coordinates, unit.street_address", 
municipality="helsinki")

## End(Not run)

</code></pre>

<hr>
<h2 id='get_vaestotietoruudukko'>Produce an SF object: Vaestotietoruudukko</h2><span id='topic+get_vaestotietoruudukko'></span>

<h3>Description</h3>

<p>Produces an sf object for Väestötietoruudukko (population grid).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_vaestotietoruudukko(year = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_vaestotietoruudukko_+3A_year">year</code></td>
<td>
<p>a single year as numeric between 1997-2003 and 2008:2021.
If NULL (default), the function will return the latest available dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional data not available here can be manually downloaded from
HRI website: <a href="https://hri.fi/data/fi/dataset/vaestotietoruudukko">https://hri.fi/data/fi/dataset/vaestotietoruudukko</a>
</p>
<p>Years 1997-2003 and 2008-2021 are tested to work at the time of development.
Datasets from years 2015-2021 are downloaded from HSY WFS API and datasets
for other years are downloaded as zip files from HRI website. The format of
the output might be a bit different between datasets downloaded from the WFS
API and datasets downloaded from HRI website.
</p>
<p>Additional years may be added in the future and older datasets may be removed
from the API. See package NEWS for more information.
</p>
<p>The current datasets can be listed with <code><a href="#topic+get_feature_list">get_feature_list()</a></code>
or <code><a href="#topic+select_feature">select_feature()</a></code>.
</p>


<h3>Value</h3>

<p>sf object
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
pop_grid &lt;- get_vaestotietoruudukko(year = 2021)

## End(Not run)

</code></pre>

<hr>
<h2 id='gracefully_fail'>Gracefully fail internet resources</h2><span id='topic+gracefully_fail'></span>

<h3>Description</h3>

<p>Function for gracefully failing internet resources
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gracefully_fail(remote.file, timeout.s = NULL)
</code></pre>


<h3>Author(s)</h3>

<p>Kostas Vasilopoulos
</p>


<h3>Source</h3>

<p>Gracefully failing HTTP request code (slightly adapted by Pyry
Kantanen) from RStudio community member kvasilopoulos. Many thanks!
</p>
<p>Source of the original RStudio community discussion:
<a href="https://community.rstudio.com/t/internet-resources-should-fail-gracefully/49199">https://community.rstudio.com/t/internet-resources-should-fail-gracefully/49199</a>
</p>

<hr>
<h2 id='helsinki-deprecated'>Deprecated functions in package <span class="pkg">helsinki</span>.</h2><span id='topic+helsinki-deprecated'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>

<hr>
<h2 id='select_feature'>Interactively browse and select features</h2><span id='topic+select_feature'></span>

<h3>Description</h3>

<p>Use an interactive menu to select and download a feature
for use in other functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>select_feature(base.url = NULL, get = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select_feature_+3A_base.url">base.url</code></td>
<td>
<p>WFS url, for example &quot;https://kartta.hsy.fi/geoserver/wfs&quot;</p>
</td></tr>
<tr><td><code id="select_feature_+3A_get">get</code></td>
<td>
<p>Should the selected feature be downloaded? Default is <code>FALSE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>feature Title (character) or feature object (sf), if <code>get</code> parameter is TRUE
</p>


<h3>Author(s)</h3>

<p>Pyry Kantanen <a href="mailto:pyry.kantanen@gmail.com">pyry.kantanen@gmail.com</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_feature">get_feature</a></code>, <code><a href="#topic+get_feature_list">get_feature_list</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
selection &lt;- select_feature(base.url = "https://kartta.hsy.fi/geoserver/wfs")
feature &lt;- get_feature(base.url = "https://kartta.hsy.fi/geoserver/wfs", type_name = selected)
ggplot(feature) +
  geom_sf()

## End(Not run)

</code></pre>

<hr>
<h2 id='to_sf'>Transform to sf-object</h2><span id='topic+to_sf'></span>

<h3>Description</h3>

<p>Transform a wfs_api object into a sf object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_sf(api_obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="to_sf_+3A_api_obj">api_obj</code></td>
<td>
<p>wfs api object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>FMI API response object's XML (GML) content is temporarily wrtitten on disk
and then immediately read back in into a sf object.
</p>


<h3>Value</h3>

<p>sf object
</p>


<h3>Note</h3>

<p>For internal use, not exported.
</p>


<h3>Author(s)</h3>

<p>Joona Lehtomäki <a href="mailto:joona.lehtomaki@iki.fi">joona.lehtomaki@iki.fi</a>
</p>

<hr>
<h2 id='wfs_api'>WFS API</h2><span id='topic+wfs_api'></span>

<h3>Description</h3>

<p>Requests to various WFS API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wfs_api(base.url = NULL, queries, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wfs_api_+3A_base.url">base.url</code></td>
<td>
<p>WFS url, for example &quot;https://kartta.hsy.fi/geoserver/wfs&quot;</p>
</td></tr>
<tr><td><code id="wfs_api_+3A_queries">queries</code></td>
<td>
<p>List of query parameters</p>
</td></tr>
<tr><td><code id="wfs_api_+3A_...">...</code></td>
<td>
<p>For passing parameters to embedded functions, for example
<em>timeout.s</em> (timeout in seconds) in the case of <strong>gracefully_fail()</strong>
internal function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Make a request to the spesific WFS API. The base url is
https://kartta.hsy.fi/geoserver/wfs to which other
components defined by the arguments are appended.
</p>
<p>This is a low-level function intended to be used by other higher level
functions in the package.
</p>


<h3>Value</h3>

<p>wfs_api (S3) object with the following attributes:
</p>

<dl>
<dt>content</dt><dd><p>XML payload.</p>
</dd>
<dt>path</dt><dd><p>path provided to get the resonse.</p>
</dd>
<dt>response</dt><dd><p>the original response object.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Joona Lehtomäki <a href="mailto:joona.lehtomaki@iki.fi">joona.lehtomaki@iki.fi</a>, Kostas Vasilopoulos,
Pyry Kantanen
</p>


<h3>Source</h3>

<p>Gracefully failing HTTP request code (slightly adapted by Pyry
Kantanen) from RStudio community member kvasilopoulos. Many thanks!
</p>
<p>Source of the original RStudio community discussion:
<a href="https://community.rstudio.com/t/internet-resources-should-fail-gracefully/49199">https://community.rstudio.com/t/internet-resources-should-fail-gracefully/49199</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  wfs_api(base.url = "https://kartta.hsy.fi/geoserver/wfs", 
          queries = c("service" = "WFS", 
          "version" = "1.0.0", 
          "request" = "getFeature", 
          "typeName" = "ilmanlaatu:Ilmanlaatu_nyt")
          )

## End(Not run)
                     
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
