<!DOCTYPE html><html lang="en"><head><title>Help for package pubh</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pubh}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#axis_labs'><p>Apply labels from variables to axis-labels in plots.</p></a></li>
<li><a href='#bar_error'><p>Bar charts with error bars.</p></a></li>
<li><a href='#Bernard'><p>Survival of patients with sepsis.</p></a></li>
<li><a href='#bland_altman'><p>Bland-Altman agreement plots.</p></a></li>
<li><a href='#box_plot'><p>Construct box plots.</p></a></li>
<li><a href='#Brenner'><p>Prevalence of Helicobacter pylori infection in preschool children.</p></a></li>
<li><a href='#bst'><p>Bootstrap Confidence Intervals.</p></a></li>
<li><a href='#coef_det'><p>Coefficient of determination.</p></a></li>
<li><a href='#estat'><p>Descriptive statistics for continuous variables.</p></a></li>
<li><a href='#expand_df'><p>Expand a data frame.</p></a></li>
<li><a href='#Fentress'><p>Migraine pain reduction.</p></a></li>
<li><a href='#freq_cont'><p>Relative and Cumulative Frequency.</p></a></li>
<li><a href='#gen_bst_df'><p>Generate a data frame with estimate and bootstrap CIs.</p></a></li>
<li><a href='#geo_mean'><p>Geometric mean.</p></a></li>
<li><a href='#get_r2'><p>Estimate R2 or Pseudo-R2 from regression models</p></a></li>
<li><a href='#gf_star'><p>Annotating a plot to display differences between groups.</p></a></li>
<li><a href='#glm_coef'><p>Table of coefficients from generalised linear models.</p></a></li>
<li><a href='#harm_mean'><p>Harmonic mean.</p></a></li>
<li><a href='#hist_norm'><p>Histogram with Normal density curve.</p></a></li>
<li><a href='#Hodgkin'><p>T-cell counts from Hodgkin's disease patients.</p></a></li>
<li><a href='#inv_logit'><p>Inverse of the logit</p></a></li>
<li><a href='#jack_knife'><p>Ranks leverage observations from Jackknife method.</p></a></li>
<li><a href='#Kirkwood'><p>Body weight and plasma volume.</p></a></li>
<li><a href='#knife_mean'><p>Jackknife for means.</p></a></li>
<li><a href='#leverage'><p>Leverage.</p></a></li>
<li><a href='#logistic_gof'><p>Goodness of fit for Logistic Regression.</p></a></li>
<li><a href='#Macmahon'><p>Breast cancer and age of childbirth.</p></a></li>
<li><a href='#mhor'><p>Mantel-Haenszel odds ratio.</p></a></li>
<li><a href='#model_labels'><p>Using labels as coefficient names in tables of coefficients.</p></a></li>
<li><a href='#multiple'><p>Multiple comparisons with plot.</p></a></li>
<li><a href='#odds_trend'><p>Function to calculate OR using Wald CI, and plot trend.</p></a></li>
<li><a href='#Oncho'><p>Onchocerciasis in Sierra Leone.</p></a></li>
<li><a href='#predict_inv'><p>Given y solve for x in a simple linear model.</p></a></li>
<li><a href='#prop_or'><p>Proportion, p1 from proportion p2 and OR.</p></a></li>
<li><a href='#pseudo_r2'><p>Pseudo R2 (logistic regression)</p>
<code>pseudo_r2</code> Calculates R2 analogues (pseudo R2) of logistic regression.</a></li>
<li><a href='#qq_plot'><p>Quantile-quantile plots against the standard Normal distribution.</p></a></li>
<li><a href='#rank_influence'><p>Ranks observations based upon influence measures on models.</p></a></li>
<li><a href='#rank_leverage'><p>Ranks observations by leverage.</p></a></li>
<li><a href='#reference_range'><p>Reference range (reference interval).</p></a></li>
<li><a href='#rel_dis'><p>Relative Dispersion.</p></a></li>
<li><a href='#Roberts'><p>Extracorporeal membrane oxygenation in neonates.</p></a></li>
<li><a href='#Rothman'><p>Oral contraceptives and stroke.</p></a></li>
<li><a href='#round_pval'><p>Rounding p-values.</p></a></li>
<li><a href='#Sandler'><p>Passive smoking in adulthood and cancer risk.</p></a></li>
<li><a href='#Sharples'><p>Measured and self-reported weight in New Zealand.</p></a></li>
<li><a href='#ss_jk'><p>Sum of squares for Jackknife.</p></a></li>
<li><a href='#stats_quotes'><p>Internal function to calculate descriptive statistics.</p></a></li>
<li><a href='#strip_error'><p>Strip plots with error bars.</p></a></li>
<li><a href='#Thall'><p>RCT on the treatment of epilepsy.</p></a></li>
<li><a href='#Tuzson'><p>Peak knee velocity in walking at flexion and extension.</p></a></li>
<li><a href='#Vanderpump'><p>Smoking and mortality in Whickham, England.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Toolbox for Public Health and Epidemiology</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Josie Athens &lt;josie.athens@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A toolbox for making R functions and capabilities more
    accessible to students and professionals from Epidemiology and
    Public Health related disciplines. Includes a function to report 
    coefficients and confidence intervals from models using robust
    standard errors (when available), functions that expand 'ggplot2'
    plots and functions relevant for introductory papers in Epidemiology 
    or Public Health. Please note that use of the 
    provided data sets is for educational purposes only.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4.0), emmeans, ggformula, stats</td>
</tr>
<tr>
<td>Imports:</td>
<td>car, dplyr, Epi, epitools, ggplot2, jtools, lmtest,
performance, sandwich, sjlabelled, sjmisc, survival, tibble,
tidyselect</td>
</tr>
<tr>
<td>Suggests:</td>
<td>broom, broom.helpers, cardx, crosstable, easystats,
effectsize, ggeffects, ISwR, knitr, MASS, nlme, rstatix</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/josie-athens/pubh/issues">https://github.com/josie-athens/pubh/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-08 04:46:38 UTC; josie</td>
</tr>
<tr>
<td>Author:</td>
<td>Josie Athens [aut, cre],
  Frank Harell [ctb],
  John Fox [ctb],
  R-Core [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-08 05:00:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='axis_labs'>Apply labels from variables to axis-labels in plots.</h2><span id='topic+axis_labs'></span>

<h3>Description</h3>

<p><code>axis_labs</code> takes labels from labelled data to use them as axis-labels for plots generated by <code>gformula</code> or <code>ggplot2</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axis_labs(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="axis_labs_+3A_object">object</code></td>
<td>
<p>ggplot2 object (see examples).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This functions is helpful when data has been already labelled by <code>sjlabelled</code>. It retrives variable labels and use them for plotting.
</p>


<h3>Value</h3>

<p>A ggplot2 object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  gf_point(weight ~ dl.milk) |&gt;
  gf_lm(col = 2, interval = "confidence", col = 2) |&gt;
  axis_labs()

kfm |&gt;
  box_plot(dl.milk ~ sex, fill = "thistle", alpha = 0.8) |&gt;
  axis_labs() |&gt;
  gf_star(x1 = 1, y1 = 10.9, x2 = 2, y2 = 11, y3 = 11.2)
</code></pre>

<hr>
<h2 id='bar_error'>Bar charts with error bars.</h2><span id='topic+bar_error'></span>

<h3>Description</h3>

<p><code>bar_error</code> constructs bar charts in with error bars showing 95
confidence intervals around mean values. High of bars represent mean values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bar_error(
  object = NULL,
  formula = NULL,
  data = NULL,
  fill = "indianred3",
  col = "black",
  alpha = 0.7,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bar_error_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="bar_error_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code>y ~ x</code> or <code>y ~ x|z</code> where <code>y</code> is a
numerical variable and both <code>x</code> and <code>z</code> are factors.</p>
</td></tr>
<tr><td><code id="bar_error_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="bar_error_+3A_fill">fill</code></td>
<td>
<p>Colour used to fill the bars.</p>
</td></tr>
<tr><td><code id="bar_error_+3A_col">col</code></td>
<td>
<p>Colour used for the borders of the bars.</p>
</td></tr>
<tr><td><code id="bar_error_+3A_alpha">alpha</code></td>
<td>
<p>Opacity of the colour fill (0 = invisible, 1 = opaque).</p>
</td></tr>
<tr><td><code id="bar_error_+3A_...">...</code></td>
<td>
<p>Additional information passed to <code><a href="ggformula.html#topic+gf_summary">gf_summary</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)
data(birthwt, package = "MASS")

birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    Race = factor(race &gt; 1, labels = c("White", "Non-white"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status"
  )

birthwt |&gt;
  bar_error(bwt ~ smoke, fill = "plum3")

birthwt |&gt;
  bar_error(bwt ~ smoke | Race, fill = "plum3")

birthwt |&gt;
  bar_error(bwt ~ smoke, fill = ~Race)
</code></pre>

<hr>
<h2 id='Bernard'>Survival of patients with sepsis.</h2><span id='topic+Bernard'></span>

<h3>Description</h3>

<p>A randomised, double-blind, placebo-controlled trial of intravenous ibuprofen in 455 patients who
had sepsis, defined as fever, tachycardia, tachypnea, and acute failure of at least one organ system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bernard
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 455 rows and 9 variables:
</p>

<dl>
<dt>id</dt><dd><p>Patient ID</p>
</dd>
<dt>treat</dt><dd><p>Treatment, factor with levels &quot;Placebo&quot; and &quot;Ibuprofen&quot;.</p>
</dd>
<dt>race</dt><dd><p>Race/ethnicity, factor with levels &quot;White&quot;, &quot;African American&quot; and &quot;Other&quot;.</p>
</dd>
<dt>fate</dt><dd><p>Mortality status at 30 days, factor with levels &quot;Alive&quot; and &quot;Dead&quot;.</p>
</dd>
<dt>apache</dt><dd><p>Baseline APACHE score.</p>
</dd>
<dt>o2del</dt><dd><p>Oxygen delivery at baseline.</p>
</dd>
<dt>followup</dt><dd><p>Follow-up time in hours.</p>
</dd>
<dt>temp0</dt><dd><p>Baseline temperature in centigrades.</p>
</dd>
<dt>temp10</dt><dd><p>Temperature after 36 hr in centigrades.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bernard, GR, et al. (1997) The effects of ibuprofen on the physiology and survival of patients
with sepsis, N Engl J Med 336: 912–918.
</p>

<hr>
<h2 id='bland_altman'>Bland-Altman agreement plots.</h2><span id='topic+bland_altman'></span>

<h3>Description</h3>

<p>Bland-Altman agreement plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bland_altman(
  object = NULL,
  formula = NULL,
  data = NULL,
  pch = 20,
  size = 1,
  col = "black",
  transform = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bland_altman_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: y ~ x (see details).</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_pch">pch</code></td>
<td>
<p>Symbol for plotting data.</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_size">size</code></td>
<td>
<p>Size of the symbol using to plot data.</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_col">col</code></td>
<td>
<p>Colour used for the symbol to plot data.</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_transform">transform</code></td>
<td>
<p>Logical, should ratios instead of difference be used to construct the plot?</p>
</td></tr>
<tr><td><code id="bland_altman_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="ggformula.html#topic+gf_point">gf_point</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bland_altman</code> constructs Bland-Altman agreement plots.
</p>
<p>Variables in <code>formula</code> are continuous paired observations. When the distribution of the outcome
is not normal, but becomes normal with a log-transformation, <code>bland_altman</code> can plot the ratio between
outcomes (difference in the log scale) by using option <code>transform = TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wright, package = "ISwR")

wright |&gt;
  bland_altman(mini.wright ~ std.wright,
    pch = 16,
    ylab = "Large-mini expiratory flow rate (l/min)",
    xlab = "Mean expiratory flow rate (l/min)"
  ) |&gt;
  gf_labs(
    y = "Large-mini expiratory flow rate (l/min)",
    x = "Mean expiratory flow rate (l/min)"
  )

data(Sharples)

Sharples |&gt;
  bland_altman(srweight ~ weight, transform = TRUE) |&gt;
  gf_labs(x = "Mean of weights (kg)", y = "Measured weight / Self-reported weight")
</code></pre>

<hr>
<h2 id='box_plot'>Construct box plots.</h2><span id='topic+box_plot'></span>

<h3>Description</h3>

<p><code>box_plot</code> is a wrap function that calls <code>gf_boxplot</code> to construct more aesthetic box plots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>box_plot(
  object = NULL,
  formula = NULL,
  data = NULL,
  fill = "indianred3",
  alpha = 0.7,
  outlier.shape = 20,
  outlier.size = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="box_plot_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code>y ~ x</code> where <code>y</code> is a numerical variable and <code>x</code> is a factor.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_fill">fill</code></td>
<td>
<p>Colour used for the box passed to <code><a href="ggformula.html#topic+gf_boxplot">gf_boxplot</a></code>.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_alpha">alpha</code></td>
<td>
<p>Opacity (0 = invisible, 1 = opaque).</p>
</td></tr>
<tr><td><code id="box_plot_+3A_outlier.shape">outlier.shape</code></td>
<td>
<p>Shape (<code>pch</code>) used as symbol for the outliers.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_outlier.size">outlier.size</code></td>
<td>
<p>Size of the outlier symbol.</p>
</td></tr>
<tr><td><code id="box_plot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="ggformula.html#topic+gf_boxplot">gf_boxplot</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  box_plot(dl.milk ~ sex, fill = "thistle", alpha = 0.8)

t.test(dl.milk ~ sex, data = kfm)

kfm |&gt;
  box_plot(dl.milk ~ sex, fill = "thistle", alpha = 0.8) |&gt;
  gf_star(1, 10.9, 2, 11, 11.4, legend = "p = 0.035", size = 2.5)
</code></pre>

<hr>
<h2 id='Brenner'>Prevalence of Helicobacter pylori infection in preschool children.</h2><span id='topic+Brenner'></span>

<h3>Description</h3>

<p>A data set containing the prevalence of Helicobacter pylori infection in preschool children
according to parental history of duodenal or gastric ulcer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Brenner
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 863 rows and 2 variables:
</p>

<dl>
<dt>ulcer</dt><dd><p>History of duodenal or gastric ulcer, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>infected</dt><dd><p>Infected with Helicobacter pylori, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Brenner H, Rothenbacher D, Bode G, Adler G (1998) Parental history of gastric or duodenal ulcer
and prevalence of Helicobacter pylori infection in preschool children: population based study.
BMJ 316:665.
</p>

<hr>
<h2 id='bst'>Bootstrap Confidence Intervals.</h2><span id='topic+bst'></span>

<h3>Description</h3>

<p><code>bst</code> estimates confidence intervals around the <code><a href="base.html#topic+mean">mean</a></code>, <code><a href="stats.html#topic+median">median</a></code> or <code><a href="#topic+geo_mean">geo_mean</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bst(x, stat = "mean", n = 1000, CI = 95, digits = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bst_+3A_x">x</code></td>
<td>
<p>A numerical variable. Missing observations are removed by default.</p>
</td></tr>
<tr><td><code id="bst_+3A_stat">stat</code></td>
<td>
<p>Statistic, either &quot;mean&quot; (default), &quot;median&quot; or &quot;gmean&quot; (geometric mean).</p>
</td></tr>
<tr><td><code id="bst_+3A_n">n</code></td>
<td>
<p>Number of replicates for the bootstrap (n=1000 by default).</p>
</td></tr>
<tr><td><code id="bst_+3A_ci">CI</code></td>
<td>
<p>Confidence intervals (CI=95 by default).</p>
</td></tr>
<tr><td><code id="bst_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding (default = 2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the estimate and confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IgM, package = "ISwR")
bst(IgM, "median")

bst(IgM, "gmean")
</code></pre>

<hr>
<h2 id='coef_det'>Coefficient of determination.</h2><span id='topic+coef_det'></span>

<h3>Description</h3>

<p><code>coef_det</code> estimates the coefficient of determination (r-squared) from fitted (predicted) and
observed values. Outcome from the model is assumed to be numerical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coef_det(obs, fit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef_det_+3A_obs">obs</code></td>
<td>
<p>Vector with observed values (numerical outcome).</p>
</td></tr>
<tr><td><code id="coef_det_+3A_fit">fit</code></td>
<td>
<p>Vector with fitted (predicted) values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar, the coefficient of determination (r-squared).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Linear regression:
Riboflavin &lt;- seq(0, 80, 10)
OD &lt;- 0.0125 * Riboflavin + rnorm(9, 0.6, 0.03)
titration &lt;- data.frame(Riboflavin, OD)
model1 &lt;- lm(OD ~ Riboflavin, data = titration)
summary(model1)
coef_det(titration$OD, fitted(model1))

## Non-linear regression:
library(nlme, quietly = TRUE)
data(Puromycin)
mm.tx &lt;- gnls(rate ~ SSmicmen(conc, Vm, K),
  data = Puromycin,
  subset = state == "treated"
)
summary(mm.tx)
coef_det(Puromycin$rate[1:12], mm.tx$fitted)
</code></pre>

<hr>
<h2 id='estat'>Descriptive statistics for continuous variables.</h2><span id='topic+estat'></span>

<h3>Description</h3>

<p><code>estat</code> calculates descriptives of numerical variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estat(object = NULL, formula = NULL, data = NULL, digits = 2, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estat_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="estat_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: ~ x or ~ x|z (for groups).</p>
</td></tr>
<tr><td><code id="estat_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="estat_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding (default = 2).</p>
</td></tr>
<tr><td><code id="estat_+3A_label">label</code></td>
<td>
<p>Label used to display the name of the variable (see examples).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with descriptive statistics.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  estat(~dl.milk)

estat(~ dl.milk | sex, data = kfm)

kfm |&gt;
  estat(~ weight | sex)
</code></pre>

<hr>
<h2 id='expand_df'>Expand a data frame.</h2><span id='topic+expand_df'></span>

<h3>Description</h3>

<p><code>expand_df</code> expands a data frame by a vector of frequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expand_df(aggregate.data, index.var = "Freq", retain.freq = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="expand_df_+3A_aggregate.data">aggregate.data</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="expand_df_+3A_index.var">index.var</code></td>
<td>
<p>A numerical variable with the frequencies (counts).</p>
</td></tr>
<tr><td><code id="expand_df_+3A_retain.freq">retain.freq</code></td>
<td>
<p>Logical expression indicating if frequencies should be kept.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a generic function that resembles weighted frequencies in other statistical packages
(for example, Stata). <code>expand.df</code> was adapted from a function developed by deprecated package
<code>epicalc</code> (now package <code>epiDisplay</code>).
</p>


<h3>Value</h3>

<p>An expanded data frame with replicates given by the frequencies.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Freq &lt;- c(5032, 5095, 41, 204)
Mortality &lt;- gl(2, 2, labels = c("No", "Yes"))
Calcium &lt;- gl(2, 1, 4, labels = c("No", "Yes"))
anyca &lt;- data.frame(Freq, Mortality, Calcium)
anyca
anyca.exp &lt;- expand_df(anyca)
with(anyca.exp, table(Calcium, Mortality))
</code></pre>

<hr>
<h2 id='Fentress'>Migraine pain reduction.</h2><span id='topic+Fentress'></span>

<h3>Description</h3>

<p>Randomised control trial on children suffering from frequent and severe migraine. Control group represents
untreated children. The active treatments were either relaxation alone or relaxation with biofeedback.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fentress
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 18 rows and 2 variables:
</p>

<dl>
<dt>pain</dt><dd><p>Reduction in weekly headache activity expressed as percentage of baseline data.</p>
</dd>
<dt>group</dt><dd><p>Group, a factor with levels &quot;Untreated&quot;, &quot;Relaxation&quot; (alone) and &quot;Biofeedback&quot; (relaxation
and biofeedback).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fentress, DW, et al. (1986) Biofeedback and relaxation-response in the treatment of pediatric
migraine. Dev Med Child Neurol 28:1 39-46.
</p>
<p>Altman, DA (1991) Practical statistics for medical research. Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Fentress)

Fentress |&gt;
  strip_error(pain ~ group)
</code></pre>

<hr>
<h2 id='freq_cont'>Relative and Cumulative Frequency.</h2><span id='topic+freq_cont'></span>

<h3>Description</h3>

<p><code>freq_cont</code> tabulates a continuous variable by given classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freq_cont(x, bks, dg = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="freq_cont_+3A_x">x</code></td>
<td>
<p>A numerical (continuous) variable. Ideally, relatively long (greater than 100 observations).</p>
</td></tr>
<tr><td><code id="freq_cont_+3A_bks">bks</code></td>
<td>
<p>Breaks defining the classes (see example).</p>
</td></tr>
<tr><td><code id="freq_cont_+3A_dg">dg</code></td>
<td>
<p>Number of digits for rounding (default = 2).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the classes, the mid-point, the frequencies, the relative and cumulative frequencies.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IgM, package = "ISwR")
Ab &lt;- data.frame(IgM)
estat(~IgM, data = Ab)
freq_cont(IgM, seq(0, 4.5, 0.5))
</code></pre>

<hr>
<h2 id='gen_bst_df'>Generate a data frame with estimate and bootstrap CIs.</h2><span id='topic+gen_bst_df'></span>

<h3>Description</h3>

<p><code>gen_bst_df</code> is a function called that generates a data frame with
confidence intervals of a continuous variable by levels of one or two categorical ones (factors).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_bst_df(object = NULL, formula = NULL, data = NULL, stat = "mean", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_bst_df_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="gen_bst_df_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code>y ~ x</code> or <code>y ~ x|z</code> where <code>y</code> is a
numerical variable and both <code>x</code> and <code>z</code> are factors.</p>
</td></tr>
<tr><td><code id="gen_bst_df_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="gen_bst_df_+3A_stat">stat</code></td>
<td>
<p>Statistic used for <a href="#topic+bst">bst</a>.</p>
</td></tr>
<tr><td><code id="gen_bst_df_+3A_...">...</code></td>
<td>
<p>Passes optional arguments to <a href="#topic+bst">bst</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the confidence intervals by level.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  gen_bst_df(dl.milk ~ sex)

data(birthwt, package = "MASS")
require(dplyr, quietly = TRUE)
birthwt &lt;- mutate(birthwt,
  smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
  Race = factor(race &gt; 1, labels = c("White", "Non-white"))
)

birthwt &lt;- birthwt |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status"
  )

gen_bst_df(bwt ~ smoke | Race, data = birthwt)
</code></pre>

<hr>
<h2 id='geo_mean'>Geometric mean.</h2><span id='topic+geo_mean'></span>

<h3>Description</h3>

<p>Geometric mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geo_mean(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geo_mean_+3A_x">x</code></td>
<td>
<p>A numeric variable with no negative values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar, the calculated geometric mean.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IgM, package = "ISwR")
Ab &lt;- data.frame(IgM)
estat(~IgM, data = Ab)
geo_mean(IgM)
</code></pre>

<hr>
<h2 id='get_r2'>Estimate R2 or Pseudo-R2 from regression models</h2><span id='topic+get_r2'></span>

<h3>Description</h3>

<p><code>get_r2</code> is a is a wrap function that calls <code>r2</code> from package <code>performance</code>.
Calculates the R2 or pseudo-R2 value for different regression model objects, returning a character object for easy printing in tables of coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_r2(model, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_r2_+3A_model">model</code></td>
<td>
<p>A statistical regression model.</p>
</td></tr>
<tr><td><code id="get_r2_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>r2</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main purpose of <code>get_r2</code> is to allow easy printing of R2 value in tables of coefficients (see examples).
</p>


<h3>See Also</h3>

<p><code><a href="performance.html#topic+r2">r2</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)

data(birthwt, package = "MASS")
birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    race = factor(race, labels = c("White", "African American", "Other"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status",
    race = "Race"
  )

model_norm &lt;- lm(bwt ~ smoke + race, data = birthwt)

get_r2(model_norm)
</code></pre>

<hr>
<h2 id='gf_star'>Annotating a plot to display differences between groups.</h2><span id='topic+gf_star'></span>

<h3>Description</h3>

<p><code>gf_star</code> Is a function used to display differences between groups (see details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gf_star(fig, x1, y1, x2, y2, y3, legend = "*", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gf_star_+3A_fig">fig</code></td>
<td>
<p>A gformula object.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_x1">x1</code></td>
<td>
<p>Position in <code>x</code> for the start of the horizontal line.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_y1">y1</code></td>
<td>
<p>Position in <code>y</code> for the start of the vertical line, below to the horizontal line.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_x2">x2</code></td>
<td>
<p>Position in <code>x</code> for the end of the horizontal line.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_y2">y2</code></td>
<td>
<p>Position in <code>y</code> where the horizontal line is drawn.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_y3">y3</code></td>
<td>
<p>Position in <code>y</code> where the text is added.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_legend">legend</code></td>
<td>
<p>Character text used for annotating the plot.</p>
</td></tr>
<tr><td><code id="gf_star_+3A_...">...</code></td>
<td>
<p>Additional information passed to <code><a href="ggformula.html#topic+gf_text">gf_text</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function draws an horizontal line from coordinate (<code>x1</code>, <code>y2</code>)
to coordinate (<code>x2</code>, <code>y2</code>). Draws vertical lines below the horizontal line,
towards data, from (<code>x1</code>, <code>y1</code>) to (<code>x1</code>, <code>y2</code>) and from
(<code>x2</code>, <code>y1</code>) to (<code>x2</code>, <code>y2</code>). Finally, adds
text above the horizontal line, at the mid point between <code>x1</code> and <code>x2</code>.
See examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  box_plot(dl.milk ~ sex, fill = "thistle", alpha = 0.8) |&gt;
  gf_star(x1 = 1, y1 = 10.9, x2 = 2, y2 = 11, y3 = 11.2)

kfm |&gt;
  box_plot(dl.milk ~ sex, fill = "thistle", alpha = 0.8) |&gt;
  gf_star(1, 10.9, 2, 11, 11.4, legend = "p = 0.035", size = 2.5)

data(energy, package = "ISwR")
energy &lt;- energy |&gt;
  var_labels(
    expend = "Energy expenditure (MJ/day)",
    stature = "Stature"
  )

energy |&gt;
  strip_error(expend ~ stature, col = "red") |&gt;
  gf_star(1, 13, 2, 13.2, 13.4, "**")
</code></pre>

<hr>
<h2 id='glm_coef'>Table of coefficients from generalised linear models.</h2><span id='topic+glm_coef'></span>

<h3>Description</h3>

<p><code>glm_coef</code> displays estimates with confidence intervals and p-values from generalised linear models (see Details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm_coef(
  model,
  digits = 2,
  alpha = 0.05,
  labels = NULL,
  se_rob = FALSE,
  type = "cond",
  exp_norm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="glm_coef_+3A_model">model</code></td>
<td>
<p>A model from any of the classes listed in the details section.</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_digits">digits</code></td>
<td>
<p>A scalar, number of digits for rounding the results (default = 2).</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_alpha">alpha</code></td>
<td>
<p>Significant level (default = 0.05) used to calculate confidence intervals.</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_labels">labels</code></td>
<td>
<p>An optional character vector with the names of the coefficients (including intercept).</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_se_rob">se_rob</code></td>
<td>
<p>Logical, should robust errors be used to calculate confidence intervals? (default = FALSE).</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_type">type</code></td>
<td>
<p>Character, either &quot;cond&quot; (condensed) or &quot;ext&quot; (extended). See details.</p>
</td></tr>
<tr><td><code id="glm_coef_+3A_exp_norm">exp_norm</code></td>
<td>
<p>Logical, should estimates and confidence intervals should be exponentiated? (for family == &quot;gaussian&quot;).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>glm_coef</code> recognises objects (models) from the following classes: <code>clm</code>, <code>clogit</code>,
<code>coxph</code>, <code>gee</code>, <code>glm</code>, <code>glmerMod</code>, <code>lm</code>, <code>lme</code>, <code>lmerMod</code>, <code>multinom</code>, <code>negbin</code>,
<code>polr</code> and <code>surveg</code>
</p>
<p>For models from logistic regression (including conditional logistic, ordinal and multinomial),
Poisson or survival analysis, coefficient estimates and corresponding confidence intervals are
automatically exponentiated (back-transformed).
</p>
<p>By default, <code>glm_coef</code> uses naive standard errors for calculating confidence intervals but has the option of using robust standard errors instead.
</p>
<p><code>glm_coef</code> can display two different data frames depending on the option of <code>type</code>,
for type <code>type = "cond"</code> (the default), <code>glm_coef</code> displays the standard table of coefficients
with confidence intervals and p-values; for <code>type = "ext"</code>, <code>glm_coef</code> displays additional statistics including standard errors.
</p>
<p>Please read the Vignette on Regression for more details.
</p>


<h3>Value</h3>

<p>A data frame with estimates, confidence intervals and p-values from <code>glm</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)

## Continuous outcome.
data(birthwt, package = "MASS")
birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    race = factor(race, labels = c("White", "African American", "Other"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status",
    race = "Race"
  )

model_norm &lt;- lm(bwt ~ smoke + race, data = birthwt)

glm_coef(model_norm, labels = model_labels(model_norm))

## Logistic regression.
data(diet, package = "Epi")
model_binom &lt;- glm(chd ~ fibre, data = diet, family = binomial)
model_binom |&gt;
  glm_coef(labels = c("Constant", "Fibre intake (g/day)"))

model_binom |&gt;
  glm_coef(labels = c("Constant", "Fibre intake (g/day)"), type = "ext")
</code></pre>

<hr>
<h2 id='harm_mean'>Harmonic mean.</h2><span id='topic+harm_mean'></span>

<h3>Description</h3>

<p>Harmonic mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harm_mean(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="harm_mean_+3A_x">x</code></td>
<td>
<p>A numeric variable with no zero values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A scalar, the calculated harmonic mean.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IgM, package = "ISwR")
Ab &lt;- data.frame(IgM)
estat(~IgM, data = Ab)
harm_mean(IgM)
</code></pre>

<hr>
<h2 id='hist_norm'>Histogram with Normal density curve.</h2><span id='topic+hist_norm'></span>

<h3>Description</h3>

<p><code>hist_norm</code> constructs histograms and adds corresponding Normal density curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hist_norm(
  object = NULL,
  formula = NULL,
  data = NULL,
  bins = 20,
  fill = "indianred3",
  color = "black",
  alpha = 0.4,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hist_norm_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code> ~ y</code> or <code>~ y|x</code> where <code>y</code> is a numerical variable and <code>x</code> is a factor.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_bins">bins</code></td>
<td>
<p>Number of bins of the histogram.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_fill">fill</code></td>
<td>
<p>Colour to fill the bars of the histogram.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_color">color</code></td>
<td>
<p>Colour used for the border of the bars.</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_alpha">alpha</code></td>
<td>
<p>Opacity (0 = invisible, 1 = opaque).</p>
</td></tr>
<tr><td><code id="hist_norm_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="ggformula.html#topic+gf_dhistogram">gf_dhistogram</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)
data(birthwt, package = "MASS")
birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    Race = factor(race &gt; 1, labels = c("White", "Non-white"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status"
  )

birthwt |&gt;
  hist_norm(~bwt, alpha = 0.7, bins = 20, fill = "cadetblue")

birthwt |&gt;
  hist_norm(~ bwt | smoke, alpha = 0.7, bins = 20, fill = "cadetblue")
</code></pre>

<hr>
<h2 id='Hodgkin'>T-cell counts from Hodgkin's disease patients.</h2><span id='topic+Hodgkin'></span>

<h3>Description</h3>

<p>Number of CD4+ T-cells and CD8+ T-cells in blood samples from patients in remission from Hodgkin's disease or
in remission from disseminated malignancies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hodgkin
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 40 rows and 3 variables:
</p>

<dl>
<dt>CD4</dt><dd><p>Concentration of CD4+ T-cells (cells / mm^3).</p>
</dd>
<dt>CD8</dt><dd><p>Concentration of CD8+ T-cells (cells / mm^3).</p>
</dd>
<dt>Group</dt><dd><p>Group, factor with levels &quot;Non-Hodgkin&quot; and &quot;Hodgkin&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Shapiro, CM, et al (1986) Immunologic status of patients in remission from Hodgkin's disease and
disseminated malignancies. Am J Med Sci 293:366-370.
</p>
<p>Altman, DA (1991) Practical statistics for medical research. Chapman &amp; Hall/CRC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Hodgkin)
require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)

Hodgkin &lt;- Hodgkin |&gt;
  mutate(
    Ratio = CD4 / CD8
  ) |&gt;
  var_labels(
    Ratio = "CD4+ / CD8+ T-cells"
  )

estat(~ Ratio | Group, data = Hodgkin)

Hodgkin |&gt;
  qq_plot(~ Ratio | Group)

Hodgkin$Ratio &lt;- Hodgkin$CD4 / Hodgkin$CD8
estat(~ Ratio | Group, data = Hodgkin)

qq_plot(~ Ratio | Group, data = Hodgkin)
</code></pre>

<hr>
<h2 id='inv_logit'>Inverse of the logit</h2><span id='topic+inv_logit'></span>

<h3>Description</h3>

<p><code>inv_logit</code> Calculates the inverse of the logit (probability in logistic regression)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inv_logit(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="inv_logit_+3A_x">x</code></td>
<td>
<p>Numerical value used to compute the inverse of the logit.</p>
</td></tr>
</table>

<hr>
<h2 id='jack_knife'>Ranks leverage observations from Jackknife method.</h2><span id='topic+jack_knife'></span>

<h3>Description</h3>

<p><code>jack_knife</code> Ranks the squared differences between mean values from Jackknife analysis
(arithmetic mean estimated by removing one observation at a time) and the original mean value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jack_knife(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jack_knife_+3A_x">x</code></td>
<td>
<p>A numeric variable. Missing values are removed by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with the ranked squared differences.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rank_leverage">rank_leverage</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(10, 170, 8)
x
mean(x)
jack_knife(x)

x &lt;- rnorm(100, 170, 8)
mean(x)
head(jack_knife(x))
</code></pre>

<hr>
<h2 id='Kirkwood'>Body weight and plasma volume.</h2><span id='topic+Kirkwood'></span>

<h3>Description</h3>

<p>Body weight and plasma volume in eight healthy men.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Kirkwood
</code></pre>


<h3>Format</h3>

<p>A labelled data frame with 8 rows and 3 variables:
</p>

<dl>
<dt>subject</dt><dd><p>Subject ID.</p>
</dd>
<dt>weight</dt><dd><p>Body weight in kg.</p>
</dd>
<dt>volume</dt><dd><p>Plasma volume in litres.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kirkwood, BR and Sterne, JAC (2003) Essential Medical Statistics. Second Edition. Blackwell.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Kirkwood)

Kirkwood |&gt;
  gf_point(volume ~ weight) |&gt;
  gf_lm(col = "indianred3", interval = "confidence", fill = "indianred3")
</code></pre>

<hr>
<h2 id='knife_mean'>Jackknife for means.</h2><span id='topic+knife_mean'></span>

<h3>Description</h3>

<p><code>knife_mean</code> is an internal function. Calculates arithmetic means by removing one observation
at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>knife_mean(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="knife_mean_+3A_x">x</code></td>
<td>
<p>A numerical variable. Missing values are removed for the mean calculation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the mean calculations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(10, 170, 8)
x
mean(x)
knife_mean(x)
</code></pre>

<hr>
<h2 id='leverage'>Leverage.</h2><span id='topic+leverage'></span>

<h3>Description</h3>

<p><code>leverage</code> is an internal function called by <code><a href="#topic+rank_leverage">rank_leverage</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leverage(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leverage_+3A_x">x</code></td>
<td>
<p>A numeric variable. Missing values are removed by default.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimates the leverage of each observation around the arithmetic mean.
</p>


<h3>Value</h3>

<p>Variable with corresponding leverage estimations
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(10, 170, 8)
x
mean(x)
leverage(x)
rank_leverage(x)
</code></pre>

<hr>
<h2 id='logistic_gof'>Goodness of fit for Logistic Regression.</h2><span id='topic+logistic_gof'></span>

<h3>Description</h3>

<p><code>logistic_gof</code> performs the Hosmer and Lemeshow test to test the goodness of fit of a logistic
regression model. This function is part of <code>residuals.lrm</code> from package <code>rms</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logistic_gof(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logistic_gof_+3A_model">model</code></td>
<td>
<p>A logistic regression model object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Frank Harell, Vanderbilt University &lt;f.harrell@vanderbilt.edu&gt;
</p>


<h3>References</h3>

<p>Hosmer DW, Hosmer T, Lemeshow S, le Cessie S, Lemeshow S. A comparison of goodness-of-fit
tests for the logistic regression model. Stat in Med 16:965–980, 1997.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diet, package = "Epi")
model &lt;- glm(chd ~ fibre, data = diet, family = binomial)
glm_coef(model, labels = c("Constant", "Fibre intake (g/day)"))
logistic_gof(model)
</code></pre>

<hr>
<h2 id='Macmahon'>Breast cancer and age of childbirth.</h2><span id='topic+Macmahon'></span>

<h3>Description</h3>

<p>An international case-control study to test the hypothesis that breast
cancer is related to the age that a woman gives childbirth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Macmahon
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 185 rows and 2 variables:
</p>

<dl>
<dt>cancer</dt><dd><p>Diagnosed with breast cancer, a factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>age</dt><dd><p>Age mother gives childbirth, factor with levels &quot;&lt;20&quot;, &quot;20-24&quot;,
&quot;25-29&quot;, &quot;30-34&quot; and &quot;&gt;34&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Macmahon, B. et al. (1970). Age at first birth and breast cancer risk. Bull WHO 43, 209-221.
</p>

<hr>
<h2 id='mhor'>Mantel-Haenszel odds ratio.</h2><span id='topic+mhor'></span>

<h3>Description</h3>

<p><code>mhor</code> computes odds ratios by levels of the stratum variable as well as the Mantel-Haenszel
pooled odds ratio. The test for effect modification (test for interaction) is also displayed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mhor(object = NULL, formula = NULL, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mhor_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="mhor_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: outcome ~ stratum/exposure.</p>
</td></tr>
<tr><td><code id="mhor_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables used in <code>formula</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Odds ratios with 95
<code>outcome</code> by levels of <code>stratum</code>. The Mantel-Haenszel pooled OR and the test
for effect modification is also reported.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oswego, package = "epitools")
require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)
oswego &lt;- oswego |&gt;
  mutate(
    ill = factor(ill, labels = c("No", "Yes")),
    sex = factor(sex, labels = c("Female", "Male")),
    chocolate.ice.cream = factor(chocolate.ice.cream, labels = c("No", "Yes"))
  ) |&gt;
  var_labels(
    ill = "Developed illness",
    sex = "Sex",
    chocolate.ice.cream = "Consumed chocolate ice cream"
  )

oswego |&gt;
  mhor(ill ~ sex / chocolate.ice.cream)
</code></pre>

<hr>
<h2 id='model_labels'>Using labels as coefficient names in tables of coefficients.</h2><span id='topic+model_labels'></span>

<h3>Description</h3>

<p><code>model_labels</code> replaces row names in <code>glm_coef</code> with labels from the original data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_labels(model, intercept = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="model_labels_+3A_model">model</code></td>
<td>
<p>A generalised linear model.</p>
</td></tr>
<tr><td><code id="model_labels_+3A_intercept">intercept</code></td>
<td>
<p>Logical, should the intercept be added to the list of coefficients?</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>model_labels</code> does not handle yet interaction terms, see examples.
</p>
<p>Please read the Vignette on Regression for more examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(dplyr, quietly = TRUE)
require(sjlabelled, quietly = TRUE)

data(birthwt, package = "MASS")
birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    race = factor(race, labels = c("White", "African American", "Other"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status",
    race = "Race"
  )

model_norm &lt;- lm(bwt ~ smoke + race, data = birthwt)

glm_coef(model_norm, labels = model_labels(model_norm))

model_int &lt;- lm(formula = bwt ~ smoke * race, data = birthwt)

model_int |&gt;
  glm_coef(labels = c(
    model_labels(model_int),
    "Smoker: African American",
    "Smoker: Other"
  ))
</code></pre>

<hr>
<h2 id='multiple'>Multiple comparisons with plot.</h2><span id='topic+multiple'></span>

<h3>Description</h3>

<p><code>multiple</code> displays results from post-doc analysis and constructs corresponding plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multiple(
  model,
  formula,
  adjust = "mvt",
  type = "response",
  reverse = TRUE,
  level = 0.95,
  digits = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multiple_+3A_model">model</code></td>
<td>
<p>A fitted model supported by <code>emmeans</code>, such as the result of a call to <code>aov</code>, <code>lm</code>, <code>glm</code>, etc.</p>
</td></tr>
<tr><td><code id="multiple_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code>~ y</code> or <code>~ y|x</code> (for interactions). Where <code>y</code> is the term of the model on which comparisons are made and <code>x</code> is a term interacting with <code>y</code>.</p>
</td></tr>
<tr><td><code id="multiple_+3A_adjust">adjust</code></td>
<td>
<p>Method to adjust CIs and p-values (see details).</p>
</td></tr>
<tr><td><code id="multiple_+3A_type">type</code></td>
<td>
<p>Type of prediction  (matching &quot;linear.predictor&quot;, &quot;link&quot;, or &quot;response&quot;).</p>
</td></tr>
<tr><td><code id="multiple_+3A_reverse">reverse</code></td>
<td>
<p>Logical argument. Determines the direction of comparisons.</p>
</td></tr>
<tr><td><code id="multiple_+3A_level">level</code></td>
<td>
<p>Confidence interval significance level.</p>
</td></tr>
<tr><td><code id="multiple_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding (default = 2).</p>
</td></tr>
<tr><td><code id="multiple_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="emmeans.html#topic+emmeans">emmeans</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default adjusting method is &quot;mvt&quot; which uses the multivariate t distribution.
Other options are: &quot;bonferroni&quot;, &quot;holm&quot;, &quot;hochberg&quot;, &quot;tukey&quot; and &quot;none&quot;. The default option for argument <code>reverse</code> is to make reverse comparisons, i.e., against the reference level matching comparisons from <code>lm</code> and <code>glm</code>.
</p>


<h3>Value</h3>

<p>A list with objects: <code>df</code> A data frame with adjusted p-values, <code>fig_ci</code> a plot with estimates and adjusted confidence intervals and <code>fig_pval</code> a plot comparing adjusted p-values.
</p>


<h3>See Also</h3>

<p><code><a href="emmeans.html#topic+emmeans">emmeans</a></code>, <code><a href="emmeans.html#topic+pwpp">pwpp</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(birthwt, package = "MASS")
birthwt$race &lt;- factor(birthwt$race, labels = c("White", "African American", "Other"))

model_1 &lt;- aov(bwt ~ race, data = birthwt)
multiple(model_1, ~race)$df

multiple(model_1, ~race)$fig_ci |&gt;
  gf_labs(y = "Race", x = "Difference in birth weights (g)")

multiple(model_1, ~race)$fig_pval |&gt;
  gf_labs(y = "Race")
</code></pre>

<hr>
<h2 id='odds_trend'>Function to calculate OR using Wald CI, and plot trend.</h2><span id='topic+odds_trend'></span>

<h3>Description</h3>

<p><code>odds_trend</code> calculates the odds ratio with confidence intervals (Wald) for different levels
(three or more) of the exposure variable, constructs the corresponding plot and calculates if the trend is
significant or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>odds_trend(formula, data, angle = 45, hjust = 1, method = "wald", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="odds_trend_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: outcome ~ exposure.</p>
</td></tr>
<tr><td><code id="odds_trend_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="odds_trend_+3A_angle">angle</code></td>
<td>
<p>Angle of for the x labels (default = 45).</p>
</td></tr>
<tr><td><code id="odds_trend_+3A_hjust">hjust</code></td>
<td>
<p>Horizontal adjustment for x labels (default = 1).</p>
</td></tr>
<tr><td><code id="odds_trend_+3A_method">method</code></td>
<td>
<p>Method for calculating confidence interval around odds ratio.</p>
</td></tr>
<tr><td><code id="odds_trend_+3A_...">...</code></td>
<td>
<p>Passes optional arguments to <code>oddsratio</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>odds_trend</code> is a wrap function that calls <code>oddsratio</code> from package <code>epitools</code>.
</p>
<p>Additional methods for confidence intervals include: <code>"midp"</code>, <code>"fisher"</code>, and <code>"small"</code>.
</p>


<h3>Value</h3>

<p>A list with components <code>df</code> a data frame with the results and <code>fig</code> corresponding plot.
</p>


<h3>See Also</h3>

<p><code><a href="epitools.html#topic+oddsratio">oddsratio</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## A cross-sectional study looked at the association between obesity and a biopsy resulting
## from mammography screening.

Freq &lt;- c(3441, 34, 39137, 519, 20509, 280, 12149, 196, 11882, 199)
Biopsy &lt;- gl(2, 1, 10, labels = c("No", "Yes"))
Weight &lt;- gl(5, 2, 10, labels = c(
  "Underweight", "Normal", "Over (11-24%)",
  "Over (25-39%)", "Over (&gt; 39%)"
))
breast &lt;- data.frame(Freq, Biopsy, Weight)
breast

breast &lt;- expand_df(breast)
require(sjlabelled, quietly = TRUE)

breast &lt;- var_labels(breast,
  Weight = "Weight group"
)

odds_trend(Biopsy ~ Weight, data = breast)$df
odds_trend(Biopsy ~ Weight, data = breast)$fig
</code></pre>

<hr>
<h2 id='Oncho'>Onchocerciasis in Sierra Leone.</h2><span id='topic+Oncho'></span>

<h3>Description</h3>

<p>Study of onchocerciasis (&quot;river blindness&quot;) in Sierra Leone, in which subjects were classified according
to whether they lived in villages in savannah or rainforest area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Oncho
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 1302 rows and 7 variables:
</p>

<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>mf</dt><dd><p>Infected with Onchocerciasis volvulus, factor with levels &quot;Not-infected&quot; and &quot;Infected&quot;.</p>
</dd>
<dt>area</dt><dd><p>Area of residence, factor with levels &quot;Savannah&quot; and &quot;Rainforest&quot;.</p>
</dd>
<dt>agegrp</dt><dd><p>Age group in years, factor with levels &quot;5-9&quot;, &quot;10-19&quot;, &quot;20-39&quot; and &quot;40+&quot;.</p>
</dd>
<dt>sex</dt><dd><p>Subject sex, factor with levels &quot;Male&quot; and &quot;Female&quot;.</p>
</dd>
<dt>mfload</dt><dd><p>Microfiliariae load.</p>
</dd>
<dt>lesions</dt><dd><p>Severe eye lesions, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>McMahon, JE, Sowa, SIC, Maude, GH and Kirkwood BR (1988) Onchocerciasis in Sierra Leone 2:
a comparison of forest and savannah villages. Trans Roy Soc Trop Med Hyg 82: 595-600.
</p>
<p>Kirkwood, BR and Sterne, JAC (2003) Essential Medical Statistics. Second Edition. Blackwell.
</p>

<hr>
<h2 id='predict_inv'>Given y solve for x in a simple linear model.</h2><span id='topic+predict_inv'></span>

<h3>Description</h3>

<p><code>predict_inv</code> Calculates the value the predictor x that generates value y with a simple linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_inv(model, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict_inv_+3A_model">model</code></td>
<td>
<p>A simple linear model object (class lm).</p>
</td></tr>
<tr><td><code id="predict_inv_+3A_y">y</code></td>
<td>
<p>A numerical scalar, the value of the outcome for which we want to calculate the predictor x.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The estimated value of the predictor.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Spectrophotometry example. Titration curve for riboflavin (nmol/ml). The sample has an absorbance
## of 1.15. Aim is to estimate the concentration of riboflavin in the sample.

Riboflavin &lt;- seq(0, 80, 10)
OD &lt;- 0.0125 * Riboflavin + rnorm(9, 0.6, 0.03)
titration &lt;- data.frame(Riboflavin, OD)

require(sjlabelled, quietly = TRUE)
titration &lt;- titration |&gt;
  var_labels(
    Riboflavin = "Riboflavin (nmol/ml)",
    OD = "Optical density"
  )

titration |&gt;
  gf_point(OD ~ Riboflavin) |&gt;
  gf_smooth(col = "indianred3", se = TRUE, lwd = 0.5, method = "loess")

## Model with intercept different from zero:
model &lt;- lm(OD ~ Riboflavin, data = titration)
glm_coef(model)

predict_inv(model, 1.15)
</code></pre>

<hr>
<h2 id='prop_or'>Proportion, p1 from proportion p2 and OR.</h2><span id='topic+prop_or'></span>

<h3>Description</h3>

<p><code>prop_or</code> is a simple function to calculate a proportion, from another proportion and the odds
ratio between them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prop_or(p2, or)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prop_or_+3A_p2">p2</code></td>
<td>
<p>The value of a proportion in the unexposed group (p2).</p>
</td></tr>
<tr><td><code id="prop_or_+3A_or">or</code></td>
<td>
<p>The odds ratio of p1/p2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>p1</code>, the proportion in the exposed group (p1).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>flu &lt;- matrix(c(20, 80, 220, 140), nrow = 2)
colnames(flu) &lt;- c("Yes", "No")
rownames(flu) &lt;- c("Vaccine", "Placebo")
flu

or &lt;- (20 * 140) / (80 * 220)
p2 &lt;- 80 / 220
prop_or(p2 = p2, or = or)
20 / 240
</code></pre>

<hr>
<h2 id='pseudo_r2'>Pseudo R2 (logistic regression)
<code>pseudo_r2</code> Calculates R2 analogues (pseudo R2) of logistic regression.</h2><span id='topic+pseudo_r2'></span>

<h3>Description</h3>

<p>Pseudo R2 (logistic regression)
<code>pseudo_r2</code> Calculates R2 analogues (pseudo R2) of logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo_r2(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo_r2_+3A_model">model</code></td>
<td>
<p>A logistic regression model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>pseudo_r2</code> calculates three pseudo R2 of logistic regression models: 1) Nagelkerke, @0 Cox and Snell, 3) Hosmer and Lemeshow.
</p>


<h3>Value</h3>

<p>A data frame with the calculated pseudo R2 values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Oncho)
model_oncho &lt;- glm(mf ~ area, data = Oncho, binomial)
glm_coef(model_oncho, labels = c("Constant", "Area (rainforest/savannah)"))
pseudo_r2(model_oncho)
</code></pre>

<hr>
<h2 id='qq_plot'>Quantile-quantile plots against the standard Normal distribution.</h2><span id='topic+qq_plot'></span>

<h3>Description</h3>

<p><code>qq_plot</code> constructs quantile-quantile plots against the standard normal distribution
(also known as quantile-normal plots).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qq_plot(
  object = NULL,
  formula = NULL,
  data = NULL,
  pch = 20,
  col = "indianred3",
  ylab = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qq_plot_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code> ~ x</code> or <code> ~ x|z</code> where <code>x</code> is a numerical variable and <code>z</code> is a factor.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_pch">pch</code></td>
<td>
<p>Point character passed to <code><a href="ggformula.html#topic+gf_qq">gf_qq</a></code>.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_col">col</code></td>
<td>
<p>Colour of the reference line, passed to <code><a href="ggformula.html#topic+gf_line">gf_line</a></code>.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_ylab">ylab</code></td>
<td>
<p>Optional character passed as label for the y-axis.</p>
</td></tr>
<tr><td><code id="qq_plot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="ggformula.html#topic+gf_qq">gf_qq</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(kfm, package = "ISwR")
require(sjlabelled, quietly = TRUE)
kfm &lt;- kfm |&gt;
  var_labels(
    dl.milk = "Breast-milk intake (dl/day)",
    sex = "Sex",
    weight = "Child weight (kg)",
    ml.suppl = "Milk substitute (ml/day)",
    mat.weight = "Maternal weight (kg)",
    mat.height = "Maternal height (cm)"
  )

kfm |&gt;
  qq_plot(~dl.milk)

qq_plot(~ dl.milk | sex, data = kfm)
</code></pre>

<hr>
<h2 id='rank_influence'>Ranks observations based upon influence measures on models.</h2><span id='topic+rank_influence'></span>

<h3>Description</h3>

<p><code>rank_influence</code> calculates influence measures of each data observation on models and then ranks them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_influence(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rank_influence_+3A_model">model</code></td>
<td>
<p>A generalised linear model object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>rank_influence</code> is a wrap function that calls <code><a href="stats.html#topic+influence.measures">influence.measures</a></code>, ranks observations on
their significance influence on the model and displays the 10 most influential observations
(if they are significant).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+influence.measures">influence.measures</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(diet, package = "Epi")
model &lt;- glm(chd ~ fibre, data = diet, family = binomial)
rank_influence(model)
</code></pre>

<hr>
<h2 id='rank_leverage'>Ranks observations by leverage.</h2><span id='topic+rank_leverage'></span>

<h3>Description</h3>

<p><code>rank_leverage</code> ranks observations by their leverage (influence) on the arithmetic mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rank_leverage(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rank_leverage_+3A_x">x</code></td>
<td>
<p>A numeric variable. Missing values are removed by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame ranking observations by their leverage around the mean.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jack_knife">jack_knife</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(10, 170, 8)
x
mean(x)
rank_leverage(x)

x &lt;- rnorm(100, 170, 8)
mean(x)
head(rank_leverage(x))
</code></pre>

<hr>
<h2 id='reference_range'>Reference range (reference interval).</h2><span id='topic+reference_range'></span>

<h3>Description</h3>

<p><code>reference_range</code> estimates the reference range (reference interval) of a numerical variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reference_range(avg, std)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reference_range_+3A_avg">avg</code></td>
<td>
<p>The arithmetic mean (a scalar numerical value).</p>
</td></tr>
<tr><td><code id="reference_range_+3A_std">std</code></td>
<td>
<p>The standard deviation (a scalar numerical value).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The reference range assumes normality and represents the limits that would include 95
observations.
</p>


<h3>Value</h3>

<p>A data frame with the reference range limits.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(100, 170, 8)
round(mean(x), 2)
round(sd(x), 2)

round(reference_range(mean(x), sd(x)), 2)
</code></pre>

<hr>
<h2 id='rel_dis'>Relative Dispersion.</h2><span id='topic+rel_dis'></span>

<h3>Description</h3>

<p>Calculates the coefficient of variation (relative dispersion) of a variable. The relative dispersion
is defined as the standard deviation over the arithmetic mean.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rel_dis(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rel_dis_+3A_x">x</code></td>
<td>
<p>A numerical variable. NA's observations are removed by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The coefficient of variation (relative dispersion).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>height &lt;- rnorm(100, 170, 8)
rel_dis(height)
</code></pre>

<hr>
<h2 id='Roberts'>Extracorporeal membrane oxygenation in neonates.</h2><span id='topic+Roberts'></span>

<h3>Description</h3>

<p>A clinical trial on the value of extracorporeal membrane oxygenation for term neonates with severe
respiratory failure. RCT compares active treatment against conventional management.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Roberts
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 185 rows and 2 variables:
</p>

<dl>
<dt>emo</dt><dd><p>Extracorporeal membrane oxygenation treatment, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>survived</dt><dd><p>One year survival, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Roberts, TE (1998) Extracorporeal Membrane Oxygenation Economics Working Group. Economic
evaluation and randomised controlled trial of extracorporeal membrane oxygenation: UK collaborative
trial. Brit Med J 317:911-16.
</p>

<hr>
<h2 id='Rothman'>Oral contraceptives and stroke.</h2><span id='topic+Rothman'></span>

<h3>Description</h3>

<p>A case-control study of oral contraceptives and stroke in young women with presence or absence of hypertension.
Cases represent thrombotic stroke and controls are hospital controls. The group of no hypertension includes
normal blood pressure (&lt;140/90 mm Hg) and borderline hypertension (140-159/90-94 mm Hg). Hypertension group
includes moderate hypertension (160-179/95-109 mm Hg) and severe hypertension (180+/110+ mm Hg). This data has
been used as an example of join exposure by Rothman for measuring interactions (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Rothman
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 477 rows and 3 variables:
</p>

<dl>
<dt>stroke</dt><dd><p>Thrombotic stroke, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>oc</dt><dd><p>Current user of oral contraceptives, factor with levels &quot;Non-user&quot; and &quot;User&quot;.</p>
</dd>
<dt>ht</dt><dd><p>Hypertension, factor with levels &quot;No&quot; (&lt;160/95 mm Hg) and &quot;Yes&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Collaborative Group for the Study of Stroke in Young Women (1975) Oral contraceptives and stroke in
young women. JAMA 231:718-722.
</p>
<p>Rothman, KJ (2002) Epidemiology. An Introduction. Oxford University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Rothman)

mhor(stroke ~ ht / oc, data = Rothman)

## Model with standard interaction term:
model1 &lt;- glm(stroke ~ ht * oc, data = Rothman, family = binomial)
glm_coef(model1)

## Model considering join exposure:
Rothman$join &lt;- 0
Rothman$join[Rothman$oc == "Non-user" &amp; Rothman$ht == "Yes"] &lt;- 1
Rothman$join[Rothman$oc == "User" &amp; Rothman$ht == "No"] &lt;- 2
Rothman$join[Rothman$oc == "User" &amp; Rothman$ht == "Yes"] &lt;- 3
Rothman$join &lt;- factor(Rothman$join, labels = c(
  "Unexposed", "Hypertension", "OC user",
  "OC and hypertension"
))

require(sjlabelled, quietly = TRUE)
Rothman$join &lt;- set_label(Rothman$join, label = "Exposure")

model2 &lt;- glm(stroke ~ join, data = Rothman, family = binomial)
glm_coef(model2)
</code></pre>

<hr>
<h2 id='round_pval'>Rounding p-values.</h2><span id='topic+round_pval'></span>

<h3>Description</h3>

<p><code>round_pval</code> is an internal function called by <code>glm_coef</code> to round p-values from model coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round_pval(pval)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="round_pval_+3A_pval">pval</code></td>
<td>
<p>vector of p-values, numeric.</p>
</td></tr>
</table>

<hr>
<h2 id='Sandler'>Passive smoking in adulthood and cancer risk.</h2><span id='topic+Sandler'></span>

<h3>Description</h3>

<p>A case-control study to investigate the effects of passive smoking
on cancer. Passive smoking was defined as exposure to the cigarette smoke
of a spouse who smoked at least one cigarette per day for at least 6 months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sandler
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 998 rows and 3 variables:
</p>

<dl>
<dt>passive</dt><dd><p>Passive smoker, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>cancer</dt><dd><p>Diagnosed with cancer, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
<dt>smoke</dt><dd><p>Active smoker, factor with levels &quot;No&quot; and &quot;Yes&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sandler, DP, Everson, RB, Wilcox, AJ (1985). Passive smoking in adulthood and cancer risk. Amer J Epidem, 121: 37-48.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sandler)

mhor(cancer ~ smoke / passive, data = Sandler)
</code></pre>

<hr>
<h2 id='Sharples'>Measured and self-reported weight in New Zealand.</h2><span id='topic+Sharples'></span>

<h3>Description</h3>

<p>Data on measured and self-reported weight from 40–50 year old participants in the 1989/1990
Life In New Zealand Survey.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sharples
</code></pre>


<h3>Format</h3>

<p>A tibble with 343 rows and 4 variables:
</p>

<dl>
<dt>srweight</dt><dd><p>Self-reported weight in kg.</p>
</dd>
<dt>weight</dt><dd><p>Measured weight in kg.</p>
</dd>
<dt>srbmi</dt><dd><p>Body mass index calculated from self-reported weight and self-reported height in kg/m^2.</p>
</dd>
<dt>mbmi</dt><dd><p>Body mass index calculated from measured weight and measured height in kg/m^2.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Sharples, H, et al. (2012) Agreement between measured and self-reported height, weight and BMI
in predominantly European middle-aged New Zealanders: findings from a nationwide 1989 survey. New Zealand
Med J 125: 60-69.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sharples |&gt;
  bland_altman(srweight ~ weight, transform = TRUE) |&gt;
  gf_labs(x = "Mean of weights (kg)", y = "Measured weight / Self-reported weight")
</code></pre>

<hr>
<h2 id='ss_jk'>Sum of squares for Jackknife.</h2><span id='topic+ss_jk'></span>

<h3>Description</h3>

<p><code>ss_jk</code> is an internal function called by <code><a href="#topic+jack_knife">jack_knife</a></code>. It calculates the squared
difference of a numerical variable around a given value (for example, the mean).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss_jk(obs, stat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ss_jk_+3A_obs">obs</code></td>
<td>
<p>A numerical vector with no missing values (NA's).</p>
</td></tr>
<tr><td><code id="ss_jk_+3A_stat">stat</code></td>
<td>
<p>The value of the statistic that is used as a reference.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The squared difference between a variable and a given value.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(10, 170, 8)
x
mean(x)
ss_jk(x, mean(x))
jack_knife(x)
</code></pre>

<hr>
<h2 id='stats_quotes'>Internal function to calculate descriptive statistics.</h2><span id='topic+stats_quotes'></span>

<h3>Description</h3>

<p><code>stats_quotes</code> is an internal function called by <code>estat</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stats_quotes(x, data2, digits = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stats_quotes_+3A_x">x</code></td>
<td>
<p>a numeric variable</p>
</td></tr>
<tr><td><code id="stats_quotes_+3A_data2">data2</code></td>
<td>
<p>A data frame where <code>x</code> can be found.</p>
</td></tr>
<tr><td><code id="stats_quotes_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding.</p>
</td></tr>
</table>

<hr>
<h2 id='strip_error'>Strip plots with error bars.</h2><span id='topic+strip_error'></span>

<h3>Description</h3>

<p><code>strip_error</code> constructs strip plots with error bars showing 95
confidence intervals around mean values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strip_error(
  object = NULL,
  formula = NULL,
  data = NULL,
  pch = 20,
  size = 1,
  alpha = 0.7,
  col = "indianred3",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="strip_error_+3A_object">object</code></td>
<td>
<p>When chaining, this holds an object produced in the earlier portions of the chain. Most users can safely ignore this argument. See details and examples.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_formula">formula</code></td>
<td>
<p>A formula with shape: <code>y ~ x</code> or <code>y ~ x|z</code> where <code>y</code> is a
numerical variable and both <code>x</code> and <code>z</code> are factors.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_data">data</code></td>
<td>
<p>A data frame where the variables in the <code>formula</code> can be found.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_pch">pch</code></td>
<td>
<p>Point character passed to <code><a href="ggformula.html#topic+gf_point">gf_point</a></code> or <code><a href="ggformula.html#topic+gf_jitter">gf_jitter</a></code>.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_size">size</code></td>
<td>
<p>Size of the symbol (<code>pch</code>) for representing data values.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_alpha">alpha</code></td>
<td>
<p>Opacity of the symbol (0 = invisible, 1 = opaque).</p>
</td></tr>
<tr><td><code id="strip_error_+3A_col">col</code></td>
<td>
<p>A colour or formula used for mapping colour.</p>
</td></tr>
<tr><td><code id="strip_error_+3A_...">...</code></td>
<td>
<p>Additional information passed to <code><a href="ggformula.html#topic+gf_jitter">gf_jitter</a></code> or <code><a href="ggformula.html#topic+gf_point">gf_point</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(energy, package = "ISwR")
require(sjlabelled, quietly = TRUE)
energy &lt;- energy |&gt;
  var_labels(
    expend = "Energy expenditure (MJ/day)",
    stature = "Stature"
  )

energy |&gt;
  strip_error(expend ~ stature, col = "red")

t.test(expend ~ stature, data = energy)

## Adding an horizontal line to show significant difference:
energy |&gt;
  strip_error(expend ~ stature, col = "red") |&gt;
  gf_star(1, 13, 2, 13.2, 13.4, "**")

data(birthwt, package = "MASS")
require(dplyr, quietly = TRUE)
birthwt &lt;- birthwt |&gt;
  mutate(
    smoke = factor(smoke, labels = c("Non-smoker", "Smoker")),
    Race = factor(race &gt; 1, labels = c("White", "Non-white"))
  ) |&gt;
  var_labels(
    bwt = "Birth weight (g)",
    smoke = "Smoking status"
  )

birthwt |&gt;
  strip_error(bwt ~ smoke | Race, col = "darksalmon")

birthwt |&gt;
  strip_error(bwt ~ smoke, col = ~Race)

birthwt |&gt;
  strip_error(bwt ~ smoke, pch = ~Race, col = ~Race)

birthwt |&gt;
  strip_error(bwt ~ smoke | Race)
</code></pre>

<hr>
<h2 id='Thall'>RCT on the treatment of epilepsy.</h2><span id='topic+Thall'></span>

<h3>Description</h3>

<p>Randomised control trial of an antiepilectic drug (prograbide), in which the number of seizures of 59 patients
at baseline and other four follow-up visits were recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Thall
</code></pre>


<h3>Format</h3>

<p>A tibble with 59 rows and 8 variables:
</p>

<dl>
<dt>id</dt><dd><p>Subject ID.</p>
</dd>
<dt>treat</dt><dd><p>Treatment, factor with levels &quot;Control&quot; and &quot;Prograbide&quot;.</p>
</dd>
<dt>base</dt><dd><p>Number of seizures at baseline.</p>
</dd>
<dt>age</dt><dd><p>Age in years at baseline.</p>
</dd>
<dt>y1</dt><dd><p>Number of seizures at year one follow-up.</p>
</dd>
<dt>y2</dt><dd><p>Number of seizures at year two follow-up.</p>
</dd>
<dt>y3</dt><dd><p>Number of seizures at year three follow-up.</p>
</dd>
<dt>y4</dt><dd><p>Number of seizures at year four follow-up.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thall, PF and Vail, SC (1990) Some covariance models for longitudinal count data with over-dispersion.
Biometrics, 46: 657-671.
</p>
<p>Stukel, TA (1993) Comparison of methods for the analysis of longitudinal data. Statistics Med 12:
1339-1351.
</p>
<p>Shoukri, MM and Chaudhary, MA (2007) Analysis of correlated data with SAS and R. Third Edition.
Chapman &amp; Hall/CRC.
</p>

<hr>
<h2 id='Tuzson'>Peak knee velocity in walking at flexion and extension.</h2><span id='topic+Tuzson'></span>

<h3>Description</h3>

<p>Data of peak knee velocity in walking at flexion and extension in studies about functional performance
in cerebral palsy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tuzson
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 18 rows and 2 variables:
</p>

<dl>
<dt>flexion</dt><dd><p>Peak knee velocity in gait: flexion (degree/s).</p>
</dd>
<dt>extension</dt><dd><p>Peak knee velocity in gait: extension (degree/s).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Tuzson, AE, Granata, KP, and Abel, MF (2003) Spastic velocity threshold constrains functional
performance in cerebral palsy. Arch Phys Med Rehabil 84: 1363-1368.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Tuzson)

Tuzson |&gt;
  gf_point(flexion ~ extension)

cor.test(~ flexion + extension, data = Tuzson)
</code></pre>

<hr>
<h2 id='Vanderpump'>Smoking and mortality in Whickham, England.</h2><span id='topic+Vanderpump'></span>

<h3>Description</h3>

<p>Data represents women participating in a health survey in Whickham, England in 1972-1974.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Vanderpump
</code></pre>


<h3>Format</h3>

<p>A labelled tibble with 1314 rows and 3 variables:
</p>

<dl>
<dt>vstatus</dt><dd><p>Vitality status, factor with levels &quot;Alive&quot; and &quot;Death&quot;.</p>
</dd>
<dt>smoker</dt><dd><p>Smoking status, factor with levels &quot;Non-smoker&quot; and &quot;Smoker&quot;.</p>
</dd>
<dt>agegrp</dt><dd><p>Age group, factor with levels &quot;18-44&quot;, &quot;45-64&quot; and &quot;64+&quot;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Vanderpump, MP, et al (1996) Thyroid, 6:155-160.
</p>
<p>Appleton, DR, French, JM and Vanderpump, PJ (1996) Ignoring a covariate:
An example of Simpson's paradox. The American Statistician 50:340-341.
</p>
<p>Vittinghoff, E, Glidden, DV, Shiboski, SC and McCulloh, CE (2005) Regression methods in
Biostatistics. Springer.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Vanderpump)

mhor(vstatus ~ agegrp / smoker, data = Vanderpump)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
