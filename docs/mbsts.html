<!DOCTYPE html><html><head><title>Help for package mbsts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mbsts}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mbsts_function'><p>Main function for the multivariate Bayesian structural time series (MBSTS) model</p></a></li>
<li><a href='#mbsts-class'><p>Constructor for the MBSTS model</p></a></li>
<li><a href='#mbsts-package'><p>Multivariate Bayesian Structural Time Series</p></a></li>
<li><a href='#mbsts.forecast'><p>Specification of time series components</p></a></li>
<li><a href='#para.est'><p>Regression parameter estimation by the MBSTS Model</p></a></li>
<li><a href='#plot_comp'><p>Plot Posterior State Components</p></a></li>
<li><a href='#plot_cvg'><p>Plot for Convergence Diagnosis</p></a></li>
<li><a href='#plot_prob'><p>Plot Inclusion Probabilities</p></a></li>
<li><a href='#sim_data'><p>Simulate data</p></a></li>
<li><a href='#tsc.setting'><p>Specification of time series components</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Bayesian Structural Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Jinwen Qiu &lt;qjwsnow_ctw@hotmail.com&gt;, Ning Ning &lt;patricianing@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ning Ning &lt;patricianing@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for data analysis with multivariate Bayesian structural time series (MBSTS) models.  Specifically, the package provides facilities for implementing general structural time series models, flexibly adding on different time series components (trend, season, cycle, and regression), simulating them, fitting them to multivariate correlated time series data, conducting feature selection on the regression component.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>KFAS, Matrix, pscl, MCMCpack, MASS, ggplot2, reshape2, BBmisc,
matrixStats, methods</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Collate:</td>
<td>'mbsts.forecast.R' 'mbsts_class.R' 'mbsts_function.R'
'package.R' 'para.est.R' 'plot_comp.R' 'plot_cvg.R'
'plot_prob.R' 'sim_data.R' 'tsc.setting.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-06 21:59:44 UTC; patricianing</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-07 01:10:02 UTC</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
</table>
<hr>
<h2 id='mbsts_function'>Main function for the multivariate Bayesian structural time series (MBSTS) model</h2><span id='topic+mbsts_function'></span><span id='topic+mbsts_function+2Carray-method'></span>

<h3>Description</h3>

<p>The MBSTS model uses MCMC to sample from the posterior distribution of a MBSTS model. The model is given by
</p>
<p style="text-align: center;"><code class="reqn">y=\mu+\tau+\omega+\beta X+\epsilon,</code>
</p>

<p>where <code class="reqn">\mu</code>, <code class="reqn">\tau</code>, <code class="reqn">\omega</code>, <code class="reqn">\beta X</code>, and <code class="reqn">\epsilon</code> denote the trend component, the seasonal component, the cycle component, the regression component, and the error term, respectively. Note that, without a regression component, the MBSTS model is an ordinary state space time series model. The predictors and response variables in the MBSTS model are designed to be contemporaneous. Lags and differences can be generated by manipulating the predictor matrix. The &quot;spike-and-slab&quot; prior is used for the regression component of models, which enables feature selection among a large number of features.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbsts_function(
  Y,
  Xtrain,
  STmodel,
  ki,
  pii,
  b = NULL,
  v0,
  kapp = 0.01,
  R2 = 0.8,
  v = 0.01,
  ss = 0.01,
  mc = 500,
  burn = 50
)

## S4 method for signature 'array'
mbsts_function(
  Y,
  Xtrain,
  STmodel,
  ki,
  pii,
  b = NULL,
  v0,
  kapp = 0.01,
  R2 = 0.8,
  v = 0.01,
  ss = 0.01,
  mc = 500,
  burn = 50
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbsts_function_+3A_y">Y</code></td>
<td>
<p>A (<code class="reqn">n*m</code>)-dimensional matrix containing multiple target series, where <code class="reqn">n</code> is the number of observations and <code class="reqn">m</code> is the number of target series.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_xtrain">Xtrain</code></td>
<td>
<p>A (<code class="reqn">n*K</code>)-dimensional matrix containing all candidate predictor series for each target series. <code class="reqn">K=\sum k_i</code> is the number of all candidate predictors for all target series. The first <code class="reqn">k_1</code> variables are the set of candidate predictors for the first target series, and the next <code class="reqn">k_2</code> variables are the set of candidate predictors for the second target series, etc. Note that, one variable can appear in the X.star several times, since different target series can contain the same candidate predictors.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_stmodel">STmodel</code></td>
<td>
<p>A state space model of SSmodel class returned by tsc.setting.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_ki">ki</code></td>
<td>
<p>A vector of integer values denoting the acumulated number of predictors for target series. For example, if there are three target series where the first has <code class="reqn">8</code> predictors, the second has <code class="reqn">6</code> predictors, and the third has <code class="reqn">10</code> predictors, then the vector is c(<code class="reqn">8,14,24</code>).</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_pii">pii</code></td>
<td>
<p>A vector describing the prior inclusion probability of each candidate predictor.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_b">b</code></td>
<td>
<p>NULL or a vector describing the prior means of regression coefficients. The default value is NULL.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_v0">v0</code></td>
<td>
<p>A numerical value describing the prior degree of freedom of the inverse Wishart distribution for <code class="reqn">\Sigma_\epsilon</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_kapp">kapp</code></td>
<td>
<p>A scalar value describing the number of observations worth of weight on the prior mean vector. The default value is <code class="reqn">0.01</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_r2">R2</code></td>
<td>
<p>A numerical value taking value in <code class="reqn">[0,1]</code>, describing the expected percentage of variation of <code class="reqn">Y</code> to be explained by the model. The default value is <code class="reqn">0.8</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_v">v</code></td>
<td>
<p>A numerical value describing the prior degree of freedom of the inverse Wishart distribution for (<code class="reqn">\Sigma_\mu,\Sigma_\delta,\Sigma_\tau,\Sigma_\omega</code>). The default value is <code class="reqn">0.01</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_ss">ss</code></td>
<td>
<p>A numerical value describing the prior scale matrix of the inverse Wishart distribution for (<code class="reqn">\Sigma_\mu,\Sigma_\delta,\Sigma_\tau,\Sigma_\omega</code>). The default value is <code class="reqn">0.01</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_mc">mc</code></td>
<td>
<p>A positive integer giving the desired number of MCMC draws. The default value is <code class="reqn">500</code>.</p>
</td></tr>
<tr><td><code id="mbsts_function_+3A_burn">burn</code></td>
<td>
<p>A positive integer giving the number of initial MCMC draws to be discarded. The default value is <code class="reqn">50</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of mbsts class
</p>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='mbsts-class'>Constructor for the MBSTS model</h2><span id='topic+mbsts-class'></span>

<h3>Description</h3>

<p>This class constructor build an object of MBSTS class, encoding a state space model together with a uni- or multi-variate time series, which is central to all the package's functionality. One implements the MBSTS model by specifying some or all of its basic components.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Xtrain</code></dt><dd><p>A (<code class="reqn">n*K</code>)-dimensional matrix containing all candidate predictor series for each target series. <code class="reqn">K=\sum k_i</code> is the number of all candidate predictors for all target series. The first <code class="reqn">k_1</code> variables are the set of candidate predictors for the first target series, and the next <code class="reqn">k_2</code> variables are the set of candidate predictors for the second target series, etc. Note that, one variable can appear in the X.star several times, since different target series can contain the same candidate predictors.</p>
</dd>
<dt><code>Ind</code></dt><dd><p>A (<code class="reqn">K*</code>(mc-burn))-dimensional matrix containing MCMC draws of the indicator variable. If X.star is null, it will not be returned.</p>
</dd>
<dt><code>beta.hat</code></dt><dd><p>A (<code class="reqn">K*</code>(mc-burn))-dimensional matrix containing MCMC draws of regression coefficients. If X.star is null, it will not be returned.</p>
</dd>
<dt><code>B.hat</code></dt><dd><p>A (<code class="reqn">K*m*</code>(mc-burn))-dimensional array generated by combining beta.hat for all target series. If X.star is null, it will not be returned.</p>
</dd>
<dt><code>ob.sig2</code></dt><dd><p>A (<code class="reqn">m*m*</code>(mc-burn))-dimensional array containing MCMC draws of variance-covariance matrix for residuals.</p>
</dd>
<dt><code>States</code></dt><dd><p>A (<code class="reqn">n*m1*</code>(mc-burn))-dimensional array containing MCMC draws of all time series components, where <code class="reqn">m1</code> is the number of all time series components. If the STmodel is null, it will not be returned.</p>
</dd>
<dt><code>st.sig2</code></dt><dd><p>A (<code class="reqn">K*</code>(mc-burn))-dimensional matrix containing MCMC draws of variances for time series components. If the STmodel is null, it will not be returned.</p>
</dd>
<dt><code>ki</code></dt><dd><p>A vector of integer values denoting the acumulated number of predictors for target series. For example, if there are three target series where the first has <code class="reqn">8</code> predictors, the second has <code class="reqn">6</code> predictors, and the third has <code class="reqn">10</code> predictors, then the vector is c(<code class="reqn">8,14,24</code>).</p>
</dd>
<dt><code>ntrain</code></dt><dd><p>A numerical value for number of observations.</p>
</dd>
<dt><code>mtrain</code></dt><dd><p>A numerical value for number of response variables.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>

<hr>
<h2 id='mbsts-package'>Multivariate Bayesian Structural Time Series</h2><span id='topic+mbsts-package'></span>

<h3>Description</h3>

<p>Tools for data analysis with multivariate Bayesian structural time series (MBSTS) models.  Specifically, the package provides facilities for implementing general structural time series models, flexibly adding on different time series components (trend, season, cycle, and regression), simulating them, fitting them to multivariate correlated time series data, conducting feature selection on the regression component.
</p>


<h3>Documentation</h3>

<p><span class="pkg">mbsts</span> is described in Ning and Qiu (2021).
</p>


<h3>License</h3>

<p><span class="pkg">mbsts</span> is provided under the <abbr><span class="acronym">LGPL-2.1</span></abbr> License.
</p>


<h3>Author(s)</h3>

<p>Jinwen Qiu, Ning Ning
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>

<hr>
<h2 id='mbsts.forecast'>Specification of time series components</h2><span id='topic+mbsts.forecast'></span>

<h3>Description</h3>

<p>Generate draws from the posterior predictive distribution of a mbsts object. Samples from the posterior predictive distribution of the MBSTS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mbsts.forecast(object, STmodel, newdata, steps = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mbsts.forecast_+3A_object">object</code></td>
<td>
<p>An object of the mbsts class created by a call to the mbsts_function function.</p>
</td></tr>
<tr><td><code id="mbsts.forecast_+3A_stmodel">STmodel</code></td>
<td>
<p>An object of the SSModel class created by a call to the tsc.setting function.</p>
</td></tr>
<tr><td><code id="mbsts.forecast_+3A_newdata">newdata</code></td>
<td>
<p>A vector or matrix containing the predictor variables to use in making the prediction. This is only required if the mbsts model has a regression component.</p>
</td></tr>
<tr><td><code id="mbsts.forecast_+3A_steps">steps</code></td>
<td>
<p>An integer value describing the number of time steps ahead to be forecasted. If it is greater than the number of new observations in the newdata, zero values will fill in missing new observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of predicted values which is a list containing the following:
</p>
<table>
<tr><td><code>pred.dist</code></td>
<td>
<p>An array of draws from the posterior predictive distribution. The first dimension in the array represents time, the second dimension denotes each target series, and the third dimension indicates each MCMC draw.</p>
</td></tr>
<tr><td><code>pred.mean</code></td>
<td>
<p>A matrix giving the posterior mean of the prediction for each target series.</p>
</td></tr>
<tr><td><code>pred.sd</code></td>
<td>
<p>A matrix giving the posterior standard deviation of the prediction for each target series.</p>
</td></tr>
<tr><td><code>pred.se</code></td>
<td>
<p>A matrix giving the posterior standard error of the prediction for each target series, calculated by pred.sd divided by the square root of the numer of MCMC iterations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='para.est'>Regression parameter estimation by the MBSTS Model</h2><span id='topic+para.est'></span><span id='topic+para.est+2Cmbsts-method'></span>

<h3>Description</h3>

<p>Generate feature selection and parameter estimation results of a mbsts object. Provide means and standard deviations of parameter estimation results for selected features.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>para.est(object, prob.threshold = 0.2)

## S4 method for signature 'mbsts'
para.est(object, prob.threshold = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="para.est_+3A_object">object</code></td>
<td>
<p>An object of the mbsts class created by a call to the mbsts_function function.</p>
</td></tr>
<tr><td><code id="para.est_+3A_prob.threshold">prob.threshold</code></td>
<td>
<p>A numerical value used as the threshold to only include predictors whose inclusion probabilities are higher than it in the plot. The default is <code class="reqn">0.2</code>.#' @param prob.threshold A numerical value used as the threshold to only include predictors whose inclusion probabilities are higher than it in the plot. The default value is <code class="reqn">0.2</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components
</p>
<table>
<tr><td><code>index</code></td>
<td>
<p>An array of feature selection results.</p>
</td></tr>
<tr><td><code>para.est.mean</code></td>
<td>
<p>An array of means of parameter estimation values of selected features.</p>
</td></tr>
<tr><td><code>para.est.sd</code></td>
<td>
<p>An array of standard deviations of parameter estimation values of selected features.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='plot_comp'>Plot Posterior State Components</h2><span id='topic+plot_comp'></span><span id='topic+plot_comp+2Cmbsts-method'></span>

<h3>Description</h3>

<p>Plots of the mean of posterior state components of each target series, which is generated by the model training procedure of the MBSTS model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_comp(
  object,
  slope,
  local,
  season,
  cyc,
  time = NULL,
  title = NULL,
  component_selection = "All"
)

## S4 method for signature 'mbsts'
plot_comp(
  object,
  slope,
  local,
  season,
  cyc,
  time = NULL,
  title = NULL,
  component_selection = "All"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_comp_+3A_object">object</code></td>
<td>
<p>An object of the mbsts class created by a call to the mbsts_function function.</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_slope">slope</code></td>
<td>
<p>A logical vector indicating whether there is trend for each target series, such as c(T,T).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_local">local</code></td>
<td>
<p>A logical vector indicating whether there is local level for each target series, such as c(T,T).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_season">season</code></td>
<td>
<p>A numerical vector indicating the seasonality for each target series, such as c(12,0).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_cyc">cyc</code></td>
<td>
<p>A logical vector indicating whether there is a cycle component for each target series, such as c(F,T).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_time">time</code></td>
<td>
<p>Null or a data frame for time index of the time series. The default value is data.frame(seq(1,n)).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_title">title</code></td>
<td>
<p>NULL or a character vector whose entries are titles for the plots of target series' posterior state components, such as c(&quot;Posterior State Components of y1&quot;, &quot;Posterior State Components of y2&quot;). The default is c(&quot;y1&quot;,&quot;y2&quot;,...).</p>
</td></tr>
<tr><td><code id="plot_comp_+3A_component_selection">component_selection</code></td>
<td>
<p>A character variable whose value must be one of &quot;All&quot;, &quot;Trend&quot;, &quot;Seasonal&quot;, &quot;Cycle&quot;, and &quot;Regression&quot;. Here, &quot;Trend&quot; means the trend component only and &quot;All&quot; means all the components.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='plot_cvg'>Plot for Convergence Diagnosis</h2><span id='topic+plot_cvg'></span><span id='topic+plot_cvg+2Cmbsts-method'></span>

<h3>Description</h3>

<p>Plot of the parameter draw for MCMC iterations after burn-in.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_cvg(
  object,
  index,
  type = "o",
  col = "blue",
  pch = 16,
  lty = 1,
  xlab = "Number of iterations",
  ylab = "Estimation",
  main = "Predictor",
  cex.axis = 1.15
)

## S4 method for signature 'mbsts'
plot_cvg(
  object,
  index,
  type = "o",
  col = "blue",
  pch = 16,
  lty = 1,
  xlab = "Number of iterations",
  ylab = "Estimation",
  main = "Predictor",
  cex.axis = 1.15
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_cvg_+3A_object">object</code></td>
<td>
<p>An object of the mbsts class created by a call to the mbsts_function function.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_index">index</code></td>
<td>
<p>A numerical value indicating which predictor to analyze. The index can be generated by a call to the para.est function</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_type">type</code></td>
<td>
<p>NULL or a character vector whose entries are titles for the plots of target series' posterior state components, such as c(&quot;Posterior State Components of y1&quot;, &quot;Posterior State Components of y2&quot;). The default is c(&quot;y1&quot;,&quot;y2&quot;,...).</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_col">col</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_pch">pch</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_lty">lty</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_xlab">xlab</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_ylab">ylab</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_main">main</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
<tr><td><code id="plot_cvg_+3A_cex.axis">cex.axis</code></td>
<td>
<p>The same setting as that of the plot function in the base package.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='plot_prob'>Plot Inclusion Probabilities</h2><span id='topic+plot_prob'></span><span id='topic+plot_prob+2Cmbsts-method'></span>

<h3>Description</h3>

<p>Plots of the empirical inclusion probabilities for predictors of each target series, based on a user-defined threshold probability. For example, one predictor is selected <code class="reqn">100</code> times in <code class="reqn">200</code> MCMC draws (after discard burn-in draws), the empirical inclusion probability for that predictor is <code class="reqn">0.5</code>. If the user-defined threshold probability less than or equal to <code class="reqn">0.5</code>, then this predictor will show in the plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_prob(object, title = NULL, prob.threshold = 0.2, varnames = NULL)

## S4 method for signature 'mbsts'
plot_prob(object, title = NULL, prob.threshold = 0.2, varnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_prob_+3A_object">object</code></td>
<td>
<p>An object of the mbsts class created by a call to the mbsts_function function.</p>
</td></tr>
<tr><td><code id="plot_prob_+3A_title">title</code></td>
<td>
<p>NULL or A character vector whose entries are titles for the inclusion probability plots generated for each target series, such as c(&quot;Inclusion Probabilities for y1&quot;, &quot;Inclusion Probabilities for y2&quot;). If Null, the output is c(&quot;y1&quot;,&quot;y2&quot;,...).</p>
</td></tr>
<tr><td><code id="plot_prob_+3A_prob.threshold">prob.threshold</code></td>
<td>
<p>A numerical value used as the threshold to only include predictors whose inclusion probabilities are higher than it in the plot. The default value is <code class="reqn">0.2</code>.</p>
</td></tr>
<tr><td><code id="plot_prob_+3A_varnames">varnames</code></td>
<td>
<p>NULL or A character vector whose entries are the variable names for predictors, such as c(&quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;, &quot;x4&quot;, &quot;x5&quot;, &quot;x6&quot;, &quot;x7&quot;, &quot;x8&quot;, &quot;x1&quot;, &quot;x2&quot;, &quot;x3&quot;, &quot;x4&quot;, &quot;x5&quot;, &quot;x6&quot;, &quot;x7&quot;, &quot;x8&quot;). If Null, the output is c(&quot;x11&quot;,&quot;x12&quot;,...,&quot;x21&quot;,&quot;x22&quot;,...).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

<hr>
<h2 id='sim_data'>Simulate data</h2><span id='topic+sim_data'></span><span id='topic+sim_data+2Carray-method'></span>

<h3>Description</h3>

<p>Generate simulated data in the form of structural time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_data(
  X,
  beta,
  cov,
  k,
  mu,
  rho,
  mean_trend = 1,
  sd_trend = 0.5,
  mean_season = 20,
  sd_season = 0.5,
  mean_cycle = 20,
  sd_cycle = 0.5,
  Dtilde,
  Season,
  vrho,
  lambda
)

## S4 method for signature 'array'
sim_data(
  X,
  beta,
  cov,
  k,
  mu,
  rho,
  mean_trend = 1,
  sd_trend = 0.5,
  mean_season = 20,
  sd_season = 0.5,
  mean_cycle = 20,
  sd_cycle = 0.5,
  Dtilde,
  Season,
  vrho,
  lambda
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_data_+3A_x">X</code></td>
<td>
<p>A (<code class="reqn">n*K</code>)-dimensional matrix containing predictors, where <code class="reqn">n</code> is the number of observations. <code class="reqn">K=\sum k_i</code> is the number of all candidate predictors for all target series. The first <code class="reqn">k_1</code> variables are the set of candidate predictors for the first target series, and the next <code class="reqn">k_2</code> variables are the set of candidate predictors for the second target series, etc.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_beta">beta</code></td>
<td>
<p>A (<code class="reqn">K*m</code>)-dimensional matrix containing all candidate predictor series for each target series.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_cov">cov</code></td>
<td>
<p>A (<code class="reqn">m*m</code>)-dimensional matrix containing covariances</p>
</td></tr>
<tr><td><code id="sim_data_+3A_k">k</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array containing the number of candidate predictors for each of the <code class="reqn">m</code> target series.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_mu">mu</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array with <code class="reqn">1</code> representing modeling with trend for this target time series.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_rho">rho</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array representing the learning rates at which the local trend is updated.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_mean_trend">mean_trend</code></td>
<td>
<p>A numerical value standing for the mean of the error term of the trend component. The default value is <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_sd_trend">sd_trend</code></td>
<td>
<p>A numerical value standing for the standard deviation of the error term of the trend component. The default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_mean_season">mean_season</code></td>
<td>
<p>A numerical value standing for the mean of the error term of the seasonal component. The default value is <code class="reqn">20</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_sd_season">sd_season</code></td>
<td>
<p>A numerical value standing for the standard deviation of the error term of the seasonal component. The default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_mean_cycle">mean_cycle</code></td>
<td>
<p>A numerical value standing for the mean of the error term of the cycle component. The default value is <code class="reqn">20</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_sd_cycle">sd_cycle</code></td>
<td>
<p>A numerical value standing for the standard deviation of the error term of the cycle component. The default value is <code class="reqn">0.5</code>.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_dtilde">Dtilde</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array with <code class="reqn">1</code> representing level in the trend component.</p>
</td></tr>
<tr><td><code id="sim_data_+3A_season">Season</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array  indicating the seasonality for each target series, such as c(12,0).</p>
</td></tr>
<tr><td><code id="sim_data_+3A_vrho">vrho</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array of the decay value parameter of the cycle component for each target series, such as c(0,0.99).</p>
</td></tr>
<tr><td><code id="sim_data_+3A_lambda">lambda</code></td>
<td>
<p>A <code class="reqn">m</code>-dimensional array of the frequence parameter of the cycle component for each target series, such as c(0,pi/100).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###############Setup###########
n&lt;-505 #n: sample size
m&lt;-2 #m: dimension of target series

cov&lt;-matrix(c(1.1,0.7,0.7,0.9), nrow=2, ncol=2) #covariance matrix of target series 

###############Regression component###########
#coefficients for predictors
beta&lt;-t(matrix(c(2,-1.5,0,4,2.5,0,0,2.5,1.5,-1,-2,0,0,-3,3.5,0.5),nrow=2,ncol=8)) 

set.seed(100)
X1&lt;-rnorm(n,5,5^2)
X4&lt;-rnorm(n,-2,5)
X5&lt;-rnorm(n,-5,5^2)
X8&lt;-rnorm(n,0,100)
X2&lt;-rpois(n, 10)
X6&lt;-rpois(n, 15)
X7&lt;-rpois(n, 20)
X3&lt;-rpois(n, 5)
X&lt;-cbind(X1,X2,X3,X4,X5,X6,X7,X8) 

###############Simulated data################
set.seed(100)
data=sim_data(X=X, beta=beta, cov, k=c(8,8), mu=c(1,1), rho=c(0.6,0.8), 
              Dtilde=c(-1,3), Season=c(100,0), vrho=c(0,0.99), lambda=c(0,pi/100))



</code></pre>

<hr>
<h2 id='tsc.setting'>Specification of time series components</h2><span id='topic+tsc.setting'></span>

<h3>Description</h3>

<p>Specify three time series components for the MBSTS model: the generalized linear trend component, the seasonal component, and the cycle component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tsc.setting(Ytrain, mu, rho, S, vrho, lambda)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tsc.setting_+3A_ytrain">Ytrain</code></td>
<td>
<p>The multivariate time series to be modeled.</p>
</td></tr>
<tr><td><code id="tsc.setting_+3A_mu">mu</code></td>
<td>
<p>A vector of logic values indicating whether to include a local trend for each target series.</p>
</td></tr>
<tr><td><code id="tsc.setting_+3A_rho">rho</code></td>
<td>
<p>A vector of numerical values taking values in <code class="reqn">[0,1]</code>, describing the learning rates at which the local trend is updated for each target series. The value <code class="reqn">0</code> in the <code class="reqn">j</code>-th entry indicates that the <code class="reqn">j</code>-th target series does not include slope of trend.</p>
</td></tr>
<tr><td><code id="tsc.setting_+3A_s">S</code></td>
<td>
<p>A vector of integer values representing the number of seasons to be modeled for each target series. The value <code class="reqn">0</code> in the <code class="reqn">j</code>-th entry indicates that the <code class="reqn">j</code>-th target series does not include the seasonal component.</p>
</td></tr>
<tr><td><code id="tsc.setting_+3A_vrho">vrho</code></td>
<td>
<p>A vector of numerical values taking values in <code class="reqn">[0,1]</code>, describing a damping factor for each target series. The value <code class="reqn">0</code> in the <code class="reqn">j</code>-th entry indicates that the <code class="reqn">j</code>-th target series does not include the cycle component.</p>
</td></tr>
<tr><td><code id="tsc.setting_+3A_lambda">lambda</code></td>
<td>
<p>A vector of numerical values, whose entries equal to <code class="reqn">2\pi/q</code> with <code class="reqn">q</code> being a period such that <code class="reqn">0&lt;\lambda&lt;\pi</code>, describing the frequency.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the SSModel class.
</p>


<h3>Author(s)</h3>

<p>Jinwen Qiu <a href="mailto:qjwsnow_ctw@hotmail.com">qjwsnow_ctw@hotmail.com</a> Ning Ning <a href="mailto:patricianing@gmail.com">patricianing@gmail.com</a>
</p>


<h3>References</h3>

<p>Qiu, Jammalamadaka and Ning (2018), Multivariate Bayesian Structural Time Series Model, <em>Journal of Machine Learning Research</em> 19.68: 1-33.
</p>
<p>Ning and Qiu (2021), The mbsts package: Multivariate Bayesian Structural Time Series Models in R.
</p>
<p>Jammalamadaka, Qiu and Ning (2019), Predicting a Stock Portfolio with the Multivariate Bayesian Structural Time Series Model: Do News or Emotions Matter?, <em>International Journal of Artificial Intelligence</em>, Vol. 17, Number 2.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
