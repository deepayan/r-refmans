<!DOCTYPE html><html><head><title>Help for package ELCIC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ELCIC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cond.prob'><p>Calculate conditional probabilities for observing records at each time point</p></a></li>
<li><a href='#ee.gee'><p>Estimating equation for GEE without missingness or with data missing completely at random.</p></a></li>
<li><a href='#ee.gee.mean'><p>Estimating equation of marginal mean for GEE without missingness or missing completely at random</p></a></li>
<li><a href='#ee.glm'><p>Estimating equation for ELCIC under GLM</p></a></li>
<li><a href='#ee.wgee'><p>Estimating equation for weighted GEE (WGEE) for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#ee.wgee.mean'><p>Estimating equation for marginal mean under WGEE for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#ELCIC.gee'><p>The whole procedure for joint selection of mean structure and correlation structure in longitudinal data without missingness or missing completely at random</p></a></li>
<li><a href='#ELCIC.gee.single'><p>Calculate ELCIC value for a given candidate model under GEE framework with complete longitudinal data or data missing completely at random.</p></a></li>
<li><a href='#ELCIC.glm'><p>The whole variable selection procedure for mean structure in GLM</p></a></li>
<li><a href='#ELCIC.glm.single'><p>Variable selection in generalized linear models (GLM)</p></a></li>
<li><a href='#ELCIC.wgee'><p>The whole procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#ELCIC.wgee.single'><p>Calculate ELCIC value for a given candidate model under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#ELCICgee'><p>Model selection based on ELCIC under the syntax of GEE (Main function).</p></a></li>
<li><a href='#ELCICglm'><p>Variable selection based on ELCIC under the syntax of GLM (Main function).</p></a></li>
<li><a href='#ELCICwgee'><p>Model selection based on ELCIC under the syntax of WGEE (Main function).</p></a></li>
<li><a href='#gee.generator'><p>Generate longitudinal data without missingness</p></a></li>
<li><a href='#geesimdata'><p>Data simulated for model selection under GEE framework without missingness</p></a></li>
<li><a href='#glm.generator'><p>Cross-sectional data generation under GLM</p></a></li>
<li><a href='#glmsimdata'><p>Data simulated for variable selection under GLM framework</p></a></li>
<li><a href='#impsdata'><p>Inpatient Multidimensional Psychiatric Scale (IMPS)</p></a></li>
<li><a href='#lambda.find.gee'><p>Calculate the tuning parameters involved in ELCIC under GEE</p></a></li>
<li><a href='#lambda.find.gee.mean'><p>Calculate the tuning parameters under marginal mean selection in GEE</p></a></li>
<li><a href='#lambda.find.glm'><p>To calculate tuning parameter involved in ELCIC under GLM</p></a></li>
<li><a href='#lambda.find.wgee'><p>Calculate the tuning parameters involved in ELCIC under WGEE with data missing at random</p></a></li>
<li><a href='#lambda.find.wgee.mean'><p>Calculate the tuning parameters involved in marginal mean selection under WGEE with data missing at random</p></a></li>
<li><a href='#marg.prob'><p>Calculate the inverse of marginal probability for observing records at each time point</p></a></li>
<li><a href='#MLIC.wgee'><p>The whole MLIC procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#MLICwgee'><p>Model selection based on MLIC under the syntax of WGEE (Main function).</p></a></li>
<li><a href='#QICc.gee'><p>Joint selection procedure of marginal mean and correlation structures in longitudinal data based on QIC</p></a></li>
<li><a href='#QICW.wgee'><p>The whole QICW procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</p></a></li>
<li><a href='#QICWwgee'><p>Model selection based on QICW under the syntax of WGEE (Main function).</p></a></li>
<li><a href='#respiratorydata'><p>Data from a clinical trial comparing two treatments for a respiratory illness</p></a></li>
<li><a href='#wgeesimdata'><p>Data simulated for model selection under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Empirical Likelihood-Based Consistent Information Criterion</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.1</td>
</tr>
<tr>
<td>Description:</td>
<td>We developed a consistent and robust information criterion to conduct model selection for semiparametric models. It is free of distribution specification and powerful to locate the true model given large sample size. This package provides several usage of ELCIC with applications in generalized linear model (GLM), generalized estimating equation (GEE) for longitudinal data, and weighted GEE (WGEE) for missing longitudinal data under the mechanism of missing at random and drop-out. Chixaing Chen, Ming Wang, Rongling Wu, Runze Li (2020) &lt;<a href="https://doi.org/10.5705%2Fss.202020.0254">doi:10.5705/ss.202020.0254</a>&gt;.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/chencxxy28/ELCIC">https://github.com/chencxxy28/ELCIC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/chencxxy28/ELCIC/issues">https://github.com/chencxxy28/ELCIC/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, markdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, mvtnorm, PoisNor,bindata,geepack,wgeesel</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-13 14:03:20 UTC; chixiang.chen</td>
</tr>
<tr>
<td>Author:</td>
<td>Chixiang Chen [cre],
  Biyi Shen [aut],
  Ming Wang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chixiang Chen &lt;chencxxy@hotmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-13 16:40:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='cond.prob'>Calculate conditional probabilities for observing records at each time point</h2><span id='topic+cond.prob'></span>

<h3>Description</h3>

<p>A function calculates conditional probabilities for longitudinal missing data. The observing probability is at observation-level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cond.prob(x_mis,gamma,id,time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cond.prob_+3A_x_mis">x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="cond.prob_+3A_gamma">gamma</code></td>
<td>
<p>coefficients calculated from missing data model</p>
</td></tr>
<tr><td><code id="cond.prob_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="cond.prob_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector containing conditional probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,scale = NULL,
         mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)

</code></pre>

<hr>
<h2 id='ee.gee'>Estimating equation for GEE without missingness or with data missing completely at random.</h2><span id='topic+ee.gee'></span>

<h3>Description</h3>

<p>Calculate estimating equation from GEE in ELCIC without missingness or missing completely at random. This estimating equation is used for joint selection of marginal mean and working correlation structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ee.gee(y,x,r,id,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ee.gee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones the represents the intercept.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records. The default setup is that all data are observed. See more in details section.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ee.gee_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the element in argument &quot;r&quot; equals zero, the corresponding rows of &quot;x&quot; and &quot;y&quot; should be all zeros.
</p>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
corstr&lt;-"exchangeable"
dist&lt;-"poisson"
# obtain the estimates
library(geepack)
# x matrix already include the intercept column.
fit&lt;-geeglm(y~x-1,data=geesimdata,family =dist,id=id,corstr = "ar1")
beta&lt;-fit$coefficients
rho&lt;-unlist(summary(fit)$corr[1])
phi&lt;-unlist(summary(fit)$dispersion[1])
r&lt;-rep(1,nrow(x))
ee.matrix&lt;-ee.gee(y,x,r,id,beta,rho,phi,dist,corstr)
apply(ee.matrix,1,mean)

</code></pre>

<hr>
<h2 id='ee.gee.mean'>Estimating equation of marginal mean for GEE without missingness or missing completely at random</h2><span id='topic+ee.gee.mean'></span>

<h3>Description</h3>

<p>Calculate estimating equation from GEE in ELCIC. This estimating equation is used for marginal mean selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ee.gee.mean(y,x,r,id,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ee.gee.mean_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records. The default setup is that all data are observed. See more in details section.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ee.gee.mean_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the element in argument &quot;r&quot; equals zero, the corresponding rows of &quot;x&quot; and &quot;y&quot; should be all zeros.
</p>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Note</h3>

<p>corstr should be prespecified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
corstr&lt;-"exchangeable"
dist&lt;-"poisson"
# obtain the estimates
library(geepack)
fit&lt;-geeglm(y~x-1,data=geesimdata,family =dist,id=id,corstr = corstr)
beta&lt;-fit$coefficients
rho&lt;-unlist(summary(fit)$corr[1])
phi&lt;-unlist(summary(fit)$dispersion[1])
r&lt;-rep(1,nrow(x))
ee.matrix&lt;-ee.gee.mean(y,x,r,id,beta,rho,phi,dist,corstr)
apply(ee.matrix,1,mean)

</code></pre>

<hr>
<h2 id='ee.glm'>Estimating equation for ELCIC under GLM</h2><span id='topic+ee.glm'></span>

<h3>Description</h3>

<p>A specified estimating equation for ELCIC under GLM. This estimating equation is used for marginal mean selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ee.glm(x, y, beta, dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ee.glm_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept. See more details in</p>
</td></tr>
<tr><td><code id="ee.glm_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="ee.glm_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimating procedure.</p>
</td></tr>
<tr><td><code id="ee.glm_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Note</h3>

<p>&quot;x&quot; and &quot;y&quot; should be all observed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(glmsimdata)
x&lt;-glmsimdata$x
y&lt;-glmsimdata$y
# obtain the estimates. Note that x matrix already contains intercept.
fit&lt;-glm(y~x-1,family="poisson")
beta&lt;-fit$coefficients
ee.matrix&lt;-ee.glm(x, y, beta, dist="poisson")
apply(ee.matrix,1,mean)

</code></pre>

<hr>
<h2 id='ee.wgee'>Estimating equation for weighted GEE (WGEE) for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+ee.wgee'></span>

<h3>Description</h3>

<p>Calculate estimating equation from WGEE for missing longitudinal data under the mechanism of missing at random and drop-out. This estimating equation is used for joint selection of marginal mean and &quot;working&quot; correlation structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ee.wgee(y,x,r,pi,id,time,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ee.wgee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_pi">pi</code></td>
<td>
<p>A vector containing observing probabilities across all observations.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_time">time</code></td>
<td>
<p>The number of observations for each subject.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ee.wgee_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates.
# Note that "obs_ind" is an indicator of observations in the missing data model.
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,
     scale = NULL,mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
wgee.matrix&lt;-ee.wgee(y=wgeesimdata$y,x=wgeesimdata$x,r=wgeesimdata$obs_ind,
pi=pi,id=wgeesimdata$id,time=3,beta=beta,rho=rho,phi=phi,dist=dist,corstr=corstr)
apply(wgee.matrix,1,mean)

</code></pre>

<hr>
<h2 id='ee.wgee.mean'>Estimating equation for marginal mean under WGEE for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+ee.wgee.mean'></span>

<h3>Description</h3>

<p>Calculate estimating function from WGEE. This estimating function is used for marginal mean selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ee.wgee.mean(y,x,r,pi,id,time,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ee.wgee.mean_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_pi">pi</code></td>
<td>
<p>A vector containing observing probabilities across all observations.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_time">time</code></td>
<td>
<p>The number of observations for each subject</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ee.wgee.mean_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Note</h3>

<p>corstr should be prespecified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates.
# Note that "obs_ind" is an indicator of observations in the missing data model.
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,
     scale = NULL,mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
wgee.matrix&lt;-ee.wgee.mean(y=wgeesimdata$y,x=wgeesimdata$x,r=wgeesimdata$obs_ind,
pi=pi,id=wgeesimdata$id,time=3,beta=beta,rho=rho,phi=phi,dist=dist,corstr=corstr)
apply(wgee.matrix,1,mean)
</code></pre>

<hr>
<h2 id='ELCIC.gee'>The whole procedure for joint selection of mean structure and correlation structure in longitudinal data without missingness or missing completely at random</h2><span id='topic+ELCIC.gee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.gee">ELCIC.gee</a></code> provides the overall procedure for joint selection of mean structure and correlation structure in longitudinal data without missingness or missing completely at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.gee(x,y,r,id,time,candidate.sets=NULL,name.var.sets=NULL,dist,
      candidate.cor.sets=c("independence","exchangeable", "ar1"), joints=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.gee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is expected in the marginal mean. Covariate matrix should be complete. NA values will be replaced by 0 if missingness is detected in x.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. If y is missing completely at random, use NA to indicate missing outcomes and specify argument &quot;r&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject), and 0 for unobserved records. The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. When joints=TRUE, it can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). The default is c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). When joints=FALSE, it should be either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.gee_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either arguments &quot;candidate.sets&quot; or &quot;name.var.sets&quot; is used to identify the set of candidate mean model. If both arguments are provided, only the argument &quot;name.var.sets&quot; will be used.
</p>
<p>When joints=TRUE, the argument &quot;candidate.cor.sets&quot; can contain multiple correlation structures; however, when joints=FALSE, it should contain either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. If multiple correlation structures are provided, only the first one will be used.
</p>


<h3>Value</h3>

<p>A matrix with each element containing ELCIC value for each candidate model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
r&lt;-rep(1,nrow(x))
time&lt;-3
candidate.sets&lt;-list(c(1,2,3))
candidate.cor.sets&lt;-c("exchangeable")
dist&lt;-"poisson"
criterion.elcic&lt;-ELCIC.gee(x=x,y=y,r=r,id=id,time=time,candidate.sets=candidate.sets,
                name.var.sets=NULL,dist=dist,candidate.cor.sets=candidate.cor.sets)
criterion.elcic

</code></pre>

<hr>
<h2 id='ELCIC.gee.single'>Calculate ELCIC value for a given candidate model under GEE framework with complete longitudinal data or data missing completely at random.</h2><span id='topic+ELCIC.gee.single'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.gee.single">ELCIC.gee.single</a></code> calculates ELCIC value for a given marginal mean candidate model with a specified working correlation structure. It is able to simultaneously evaluate mean model and working correlation structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.gee.single(x, y, r, id, time, index.var=NULL, name.var = NULL,
                     dist, corstr, joints=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.gee.single_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept. If y and x are missing completely at random, use NA to indicate missingness and specify argument &quot;r&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. If y and x are missing completely at random, use NA to indicate missing outcomes and specify argument &quot;r&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject), and 0 for unobserved records. The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_index.var">index.var</code></td>
<td>
<p>A vector containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_name.var">name.var</code></td>
<td>
<p>A vector containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be either of &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.gee.single_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either arguments &quot;index.var&quot; or &quot;name.var&quot; is used to identify the candidate mean model. If both arguments are provided, only the argument &quot;name.var&quot; will be used.
</p>
<p>When the argument &quot;joints&quot; is TRUE, <code><a href="#topic+ELCIC.gee.single">ELCIC.gee.single</a></code> will calculate ELCIC value based on the function <code><a href="#topic+lambda.find.gee">lambda.find.gee</a></code> and <code><a href="#topic+ee.gee">ee.gee</a></code>, which involve estimating equations for both marginal mean and correlation coefficient. When the argument &quot;joints&quot; is FALSE, <code><a href="#topic+ELCIC.gee.single">ELCIC.gee.single</a></code> will calculate ELCIC value based on the function <code><a href="#topic+lambda.find.gee.mean">lambda.find.gee.mean</a></code> and <code><a href="#topic+ee.gee.mean">ee.gee.mean</a></code>, which only involve estimating equations for marginal mean.
</p>


<h3>Value</h3>

<p>A ELCIC value for a given candidate model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
r&lt;-rep(1,nrow(x))
time&lt;-3
corstr&lt;-"exchangeable"
dist&lt;-"poisson"
criteria&lt;-ELCIC.gee.single(x=x,y=y,r=r,id=id,time=time,index.var=c(1,2,3),
           name.var=NULL,dist=dist,corstr=corstr)
criteria

</code></pre>

<hr>
<h2 id='ELCIC.glm'>The whole variable selection procedure for mean structure in GLM</h2><span id='topic+ELCIC.glm'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.glm">ELCIC.glm</a></code> provides the overall procedure for variable selection in GLM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.glm(x,y,candidate.sets,name.var.sets=NULL,dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.glm_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should contain all ones corresponding to the intercept if the intercept is expected in the mean structure.</p>
</td></tr>
<tr><td><code id="ELCIC.glm_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="ELCIC.glm_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates in each candidate model. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.glm_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates corresponding to each candidate model. The names should be subset of column names of the x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.glm_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&quot;x&quot; and &quot;y&quot; should be all observed. The corresponding individual data will be deleted if any missingness is detected.
</p>
<p>Either arguments &quot;candidate.sets&quot; or &quot;name.var.sets&quot; is used to identify the set of candidate mean model. If both arguments are provided, only the argument &quot;name.var.sets&quot; will be used.
</p>


<h3>Value</h3>

<p>A matrix with each element containing ELCIC value for each candidate model (in columns) and (in rows)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(glmsimdata)
x&lt;-glmsimdata$x
y&lt;-glmsimdata$y
#candidate model index
candidate.sets&lt;-list(c(1,2),c(1,2,3),c(1,2,3,4))
criteria&lt;-ELCIC.glm(x, y, candidate.sets, name.var.sets = NULL, dist="poisson")
criteria

</code></pre>

<hr>
<h2 id='ELCIC.glm.single'>Variable selection in generalized linear models (GLM)</h2><span id='topic+ELCIC.glm.single'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.glm.single">ELCIC.glm.single</a></code> provides values of several model selection criteria including AIC, BIC, GIC, and ELCIC, given a candidate mean model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.glm.single(x, y, index.var=NULL, name.var = NULL, dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.glm.single_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should contain all ones corresponding to the intercept if intercept is considered in your mean model.</p>
</td></tr>
<tr><td><code id="ELCIC.glm.single_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="ELCIC.glm.single_+3A_index.var">index.var</code></td>
<td>
<p>A vector containing index corresponding to candidate covariates (including the intercept). See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.glm.single_+3A_name.var">name.var</code></td>
<td>
<p>A vector containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.glm.single_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>&quot;x&quot; and &quot;y&quot; should be all observed. The corresponding individual data will be omitted in analysis if any missingness is detected.
</p>
<p>Either arguments &quot;index.var&quot; or &quot;name.var&quot; is used to identify the candidate mean model. If both arguments are provided, only the argument &quot;name.var&quot; will be used.
</p>


<h3>Value</h3>

<p>A vector containing information criteria including ELCIC, AIC, BIC, and GIC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(glmsimdata)
x&lt;-glmsimdata$x
y&lt;-glmsimdata$y
#candidate model index
name.var&lt;-c("intercept","x1","x2")
index.var&lt;-c(1,2,3)
criteria&lt;-ELCIC.glm.single(x, y, index.var =index.var, name.var = NULL, dist="poisson")
criteria

</code></pre>

<hr>
<h2 id='ELCIC.wgee'>The whole procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+ELCIC.wgee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.wgee">ELCIC.wgee</a></code> provides the overall procedure for joint selection of mean structure and correlation structure in longitudinal data under missing at random. It is also able to implement marginal mean structure selection given a prespecified working correlation structure. The data is dropout missing and missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.wgee(x,y,x_mis,r,id,time,candidate.sets=NULL,name.var.sets=NULL,
     dist,candidate.cor.sets=c("independence","exchangeable", "ar1"), joints=TRUE,lag=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.wgee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is considered in the marginal mean. Covariate matrix should be complete.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. Use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_x_mis">x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept. This covariate matrix should be complete and all observed. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. When joints=TRUE, it can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). The default is c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). When joints=FALSE, it should be either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee_+3A_lag">lag</code></td>
<td>
<p>A numeric value indicating lag-response involved in the missing data model. It can be either 1 or 2. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariate matrix &quot;x&quot; should be complete. If missing data are present in &quot;x&quot;, the elements in covariate vector will be replaced by zeros for individuals who have missing covariates.
</p>
<p>The argument &quot;x_mis&quot; includes all covariates to fit the missing data model. It does not contains a lag variable based on the outcome y. The argument &quot;lag&quot; in this function will automatically add lag-response variables to indicate the data missing at random.
</p>
<p>Either arguments &quot;candidate.sets&quot; or &quot;name.var.sets&quot; is used to identify the set of candidate mean model. If both arguments are provided, only the argument &quot;name.var.sets&quot; will be used.
</p>
<p>When joints=TRUE, the argument &quot;candidate.cor.sets&quot; can contain multiple correlation structures; however, when joints=FALSE, it should contain either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. If multiple correlation structures are provided, only the first one will be used.
</p>


<h3>Value</h3>

<p>A matrix with each element containing ELCIC value for each candidate model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
dist&lt;-"binomial"
x&lt;-wgeesimdata$x
y&lt;-wgeesimdata$y
x_mis&lt;-wgeesimdata$x_mis
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
candidate.sets&lt;-list(c(1,2,3))
candidate.cor.sets&lt;-c("exchangeable")
criterion.elcic&lt;-ELCIC.wgee(x,y,x_mis,r,id,time,candidate.sets,name.var.sets=NULL,
                                    dist,candidate.cor.sets,joints=TRUE)
criterion.elcic

</code></pre>

<hr>
<h2 id='ELCIC.wgee.single'>Calculate ELCIC value for a given candidate model under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+ELCIC.wgee.single'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCIC.wgee.single">ELCIC.wgee.single</a></code> to calculate ELCIC value for a given candidate mean model with specified working correlation structure. It is able to simultaneously evaluate mean model and working correlation structure. The data is dropout missing and missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCIC.wgee.single(x,y,x_mis,r,id,time,index.var=NULL,
      name.var=NULL,dist,corstr,joints=TRUE,lag=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCIC.wgee.single_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is considered in the marginal mean. Covariate matrix should be complete. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. Use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_x_mis">x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept. This covariate matrix should be complete and all observed. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_index.var">index.var</code></td>
<td>
<p>A vector containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_name.var">name.var</code></td>
<td>
<p>A vector containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
<tr><td><code id="ELCIC.wgee.single_+3A_lag">lag</code></td>
<td>
<p>A numeric value indicating lag-response involved in the missing data model. It can be one of 0, 1, and 2. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariate matrix &quot;x&quot; should be complete. If missing data are present in &quot;x&quot;, the elements in covariate vector will be replaced by zeros for individuals who have missing covariates.
</p>
<p>The argument &quot;x_mis&quot; includes all covariates to fit the missing data model. It does not contains a lag variable based on the outcome y. The argument &quot;lag&quot; in this function will automatically add lag-response variables to indicate the data missing at random.
</p>
<p>Either arguments &quot;index.var&quot; or &quot;name.var&quot; is used to identify the candidate mean model. If both arguments are provided, only the argument &quot;name.var&quot; will be used.
</p>
<p>When the argument &quot;joints&quot; is TRUE, <code><a href="#topic+ELCIC.wgee.single">ELCIC.wgee.single</a></code> will calculate ELCIC value based on the function <code><a href="#topic+lambda.find.wgee">lambda.find.wgee</a></code> and <code><a href="#topic+ee.wgee">ee.wgee</a></code>, which involve estimating equations for both marginal mean and correlation coefficient. When the argument &quot;joints&quot; is FALSE, <code><a href="#topic+ELCIC.wgee.single">ELCIC.wgee.single</a></code> will calculate ELCIC value based on the function <code><a href="#topic+lambda.find.wgee.mean">lambda.find.wgee.mean</a></code> and <code><a href="#topic+ee.wgee.mean">ee.wgee.mean</a></code>, which only involve estimating equations for marginal mean.
</p>


<h3>Value</h3>

<p>A matrix containing values of calculated estimating equations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
x&lt;-wgeesimdata$x
y&lt;-wgeesimdata$y
x_mis&lt;-wgeesimdata$x_mis
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
index.var&lt;-c(1,2,3)
ELCIC_value&lt;-ELCIC.wgee.single(x,y,x_mis,r,id,time,index.var,name.var=NULL,
                     dist,corstr,joints=TRUE)
ELCIC_value
</code></pre>

<hr>
<h2 id='ELCICgee'>Model selection based on ELCIC under the syntax of GEE (Main function).</h2><span id='topic+ELCICgee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCICgee">ELCICgee</a></code> provides the model selection under the syntax of the geepack package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCICgee(models, candidate.cor.sets,data, family,r,id,time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCICgee_+3A_models">models</code></td>
<td>
<p>A list of formulas. See the corresponding documentation to geeglm.</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. It can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;).</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model.
The details are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject), and 0 for unobserved records.
The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCICgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three commonly used distributions are considered: &quot;gaussian&quot;, &quot;poisson&quot;, &quot;binomial&quot;.
For the current package, the identity link is considered for a &quot;gaussian&quot; distribution;
the log link is considered for a &quot;poisson&quot; distribution; the logit link is considered for a &quot;binomial&quot; distribution;
</p>


<h3>Value</h3>

<p>A list with two items: model selection result based on ELCIC;
An object of &quot;geeglm&quot; based on the selected model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
id&lt;-geesimdata$id
r&lt;-rep(1,length(id))
time&lt;-3
dat &lt;- data.frame(y=geesimdata$y, geesimdata$x,id=id)
models &lt;- list(y~x1+x2)
candidate.cor.sets&lt;-c("exchangeable")
family&lt;-poisson()
output&lt;-ELCICgee(models, candidate.cor.sets,data=dat,family,r,id,time)
output$model.selection
output$gee.output
</code></pre>

<hr>
<h2 id='ELCICglm'>Variable selection based on ELCIC under the syntax of GLM (Main function).</h2><span id='topic+ELCICglm'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCICglm">ELCICglm</a></code> provides the variable selection under the syntax of the GLM package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCICglm(models, data, family)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCICglm_+3A_models">models</code></td>
<td>
<p>A list of formulas. See the corresponding documentation to glm.</p>
</td></tr>
<tr><td><code id="ELCICglm_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="ELCICglm_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model.
The details are given under &quot;Details&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three commonly used distributions are considered: &quot;gaussian&quot;, &quot;poisson&quot;, &quot;binomial&quot;.
For the current package, the identity link is considered for a &quot;gaussian&quot; distribution;
the log link is considered for a &quot;poisson&quot; distribution; the logit link is considered for a &quot;binomial&quot; distribution;
</p>


<h3>Value</h3>

<p>A list with two items: model selection results based on ELCIC, AIC, BIC, and GIC;
An object of &quot;glm&quot; based on the selected model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(glmsimdata)
dat &lt;- data.frame(y=glmsimdata$y, glmsimdata$x) ####x is a covariate matrix.
models &lt;- list(y~x1, y~x1+x2, y~x1+x2+x3)
output&lt;-ELCICglm(models, dat, poisson())
output$model.selection
output$glm.output

</code></pre>

<hr>
<h2 id='ELCICwgee'>Model selection based on ELCIC under the syntax of WGEE (Main function).</h2><span id='topic+ELCICwgee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+ELCICwgee">ELCICwgee</a></code> provides the model selection under the syntax of the wgeesel package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELCICwgee(models, candidate.cor.sets, data, model_mis, family,r,id,time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ELCICwgee_+3A_models">models</code></td>
<td>
<p>A list of formulas. See corresponding documentation to wgeesel.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. It can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;).</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in both the main model and the missing model.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_model_mis">model_mis</code></td>
<td>
<p>A formula used in the missing data model.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model.
The details are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject),
and 0 for unobserved records.
The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="ELCICwgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three commonly used distributions are considered: &quot;gaussian&quot;, &quot;poisson&quot;, &quot;binomial&quot;.
For the current package, the identity link is considered for a &quot;gaussian&quot; distribution;
the log link is considered for a &quot;poisson&quot; distribution; the logit link is considered for a &quot;binomial&quot; distribution;n;
</p>


<h3>Value</h3>

<p>A list with two items: model selection result based on ELCIC;
An object of &quot;wgee&quot; based on the selected model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
family&lt;-binomial()
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
dat &lt;- data.frame(y=wgeesimdata$y, wgeesimdata$x,x_mis1=wgeesimdata$x_mis[,2])
models &lt;- list(y~x1+x2)
model_mis&lt;-r~x_mis1
candidate.cor.sets&lt;-c("exchangeable")
output&lt;-ELCICwgee(models, candidate.cor.sets,data=dat,model_mis,family,r,id,time)
output$model.selection
output$wgee.output


</code></pre>

<hr>
<h2 id='gee.generator'>Generate longitudinal data without missingness</h2><span id='topic+gee.generator'></span>

<h3>Description</h3>

<p>A function for generating longitudinal data without missingness. All covariates (except for intercept) are normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gee.generator(beta,samplesize,time,num.time.dep,num.time.indep,
     rho,x.rho,dist,cor.str,x.cor.str)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gee.generator_+3A_beta">beta</code></td>
<td>
<p>A vector containing underlying true coefficients for each covariate in the model (including the intercept).</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_samplesize">samplesize</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_time">time</code></td>
<td>
<p>The number of observations per subject.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_num.time.dep">num.time.dep</code></td>
<td>
<p>The number of time-dependent covariates.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_num.time.indep">num.time.indep</code></td>
<td>
<p>The number of time-independent covariates (not include intercept).</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_rho">rho</code></td>
<td>
<p>The correlation coefficient for residuals across time.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_x.rho">x.rho</code></td>
<td>
<p>The correlation coefficient for time-dependent covariates across time.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_cor.str">cor.str</code></td>
<td>
<p>The correlation structure for residuals across time. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
<tr><td><code id="gee.generator_+3A_x.cor.str">x.cor.str</code></td>
<td>
<p>The correlation structure for time-dependent covariates across time. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x: a matrix containing continuous covariates. The first column should contain all ones corresponding to the intercept.
</p>
<p>y: a vector containing outcomes.
</p>
<p>id: a vector indicating subject id.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>beta&lt;-c(-1,1,0.5,0)
samplesize&lt;-100
geesimdata&lt;-gee.generator(beta=beta,samplesize=samplesize,time=3,num.time.dep=2,
num.time.indep=1,rho=0.4,x.rho=0.2,dist="poisson",cor.str="exchangeable",
x.cor.str="exchangeable")
geesimdata$y

</code></pre>

<hr>
<h2 id='geesimdata'>Data simulated for model selection under GEE framework without missingness</h2><span id='topic+geesimdata'></span>

<h3>Description</h3>

<p>Data simulated for model selection under GEE framework without missingness
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(geesimdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"list"</code>
</p>

<dl>
<dt>y</dt><dd><p>The outcomes generated from Poisson distribution with three repeated measurements from each subject</p>
</dd>
<dt>x</dt><dd><p>A covariate matrix, of which the first column are all ones and rest columns contain normally distributed. Two are time-dependent variables, and one is time-independent variable.</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the ELCIC package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geesimdata)
geesimdata$y

</code></pre>

<hr>
<h2 id='glm.generator'>Cross-sectional data generation under GLM</h2><span id='topic+glm.generator'></span>

<h3>Description</h3>

<p>A function provides simulated outcomes as well as covariates under the framework of GLM. All covariates (except for intercept) are normally distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm.generator(beta, samplesize, rho = 0, dist, sd.gaussian = NULL, ov = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm.generator_+3A_beta">beta</code></td>
<td>
<p>The underlying true coefficient for each covariates in the model (including the intercept).</p>
</td></tr>
<tr><td><code id="glm.generator_+3A_samplesize">samplesize</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="glm.generator_+3A_rho">rho</code></td>
<td>
<p>The correlation coefficient among covariates.</p>
</td></tr>
<tr><td><code id="glm.generator_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="glm.generator_+3A_sd.gaussian">sd.gaussian</code></td>
<td>
<p>The standard deviation for the outcome from Gaussian distribution.</p>
</td></tr>
<tr><td><code id="glm.generator_+3A_ov">ov</code></td>
<td>
<p>The dispersion parameter for the outcome from Negative Binomial distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>x: a matrix containing continuous covariates. The first column should contain all ones corresponding to the intercept.
</p>
<p>y: a vector containing outcomes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>beta&lt;-c(0.5,0.5,0.5,0)
samplesize&lt;-100
data&lt;-glm.generator(beta=beta,samplesize=samplesize,rho=0.5,dist="poisson")

</code></pre>

<hr>
<h2 id='glmsimdata'>Data simulated for variable selection under GLM framework</h2><span id='topic+glmsimdata'></span>

<h3>Description</h3>

<p>Data simulated for variable selection under GLM framework
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(glmsimdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"list"</code>
</p>

<dl>
<dt>y</dt><dd><p>The outcome generated from Negative Binomial distribution with the dispersion parameter parameter=2</p>
</dd>
<dt>x</dt><dd><p>A covariate matrix, of which the first column are all ones and rest columns contain normally distributed
values</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the ELCIC package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(glmsimdata)
glmsimdata$y

</code></pre>

<hr>
<h2 id='impsdata'>Inpatient Multidimensional Psychiatric Scale (IMPS)</h2><span id='topic+impsdata'></span>

<h3>Description</h3>

<p>The imps data frame has 1544 rows and 8 columns. The data is from National Institute of the Mental Health Schizophrenia Collaborative Study, where the effect of chlorpromazine, fluphenazine, or thioridazine treatment on the overall severity of the schizophrenia disorder is of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(impsdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"list"</code>
</p>

<dl>
<dt>y</dt><dd><p>The binary outcomes indicating whether IMPS &gt;=4, which is longitudinal dropout and missing at random. IMPS describes severity of the schizophrenia disorder (ranges from 0 to 7)</p>
</dd>
<dt>x</dt><dd><p>A full covariate matrix. It contains intercept, sex (1:male,0:female), drug (1: chlorphromazine, fluphenazine, or thioridazine treatment; 0: placebo), time: square root of the week covariate, and their two-way interactions.</p>
</dd>
<dt>x_mis</dt><dd><p>A covariate matrix for missing data model. It contains intercept, drug, time, and sex.</p>
</dd>
<dt>id</dt><dd><p>Patient ID</p>
</dd>
<dt>r</dt><dd><p>An indicator of the missingness (1: observed; 0: missing).</p>
</dd>
</dl>



<h3>References</h3>

<p>add here
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(impsdata)
id&lt;-impsdata$id
r&lt;-impsdata$r
data.real &lt;- data.frame(id=id,y=impsdata$y, impsdata$x)
head(data.real,n=10)
# each participant has three records
time&lt;-4
# the outcome is binary
family=binomial()
models &lt;- list(y~Time, y~Drug,y~Time+Drug,
               y~Time*Drug,y~Time+Sex+Drug,
               y~Time+Sex+Drug+Time:Sex+Sex:Drug+Drug:Time)

model_mis&lt;-r~Drug+Time+Sex

candidate.cor.sets&lt;-c("exchangeable","independence","ar1")
#not run
#output_ELCIC&lt;-ELCICwgee(models, candidate.cor.sets,data=data.real,model_mis,family,r,id,time)
#output_MLIC&lt;-MLICwgee(models, candidate.cor.sets,data=data.real,model_mis,family,r,id,time)
#output_QICW&lt;-QICWwgee(models, candidate.cor.sets,data=data.real,model_mis,family,r,id,time)

</code></pre>

<hr>
<h2 id='lambda.find.gee'>Calculate the tuning parameters involved in ELCIC under GEE</h2><span id='topic+lambda.find.gee'></span>

<h3>Description</h3>

<p>This function provides an efficient algorithm to calculate the tuning parameters involved in ELCIC under GEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.find.gee(x, y, id, beta, r, dist, rho, phi, corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.find.gee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records. The default setup is that all data are observed. See more in details section.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the element in argument &quot;r&quot; equals zero, the corresponding rows of &quot;x&quot; and &quot;y&quot; should be all zeros.
</p>


<h3>Value</h3>

<p>Tuning parameter values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
corstr&lt;-"exchangeable"
dist&lt;-"poisson"
# obtain the estimates
library(geepack)
fit&lt;-geeglm(y~x-1,data=geesimdata,family =dist,id=id,corstr = corstr)
beta&lt;-fit$coefficients
rho&lt;-unlist(summary(fit)$corr[1])
phi&lt;-unlist(summary(fit)$dispersion[1])
r=rep(1,nrow(x))
lambda&lt;-lambda.find.gee(x,y,id,beta,r,dist,rho,phi,corstr)
lambda

</code></pre>

<hr>
<h2 id='lambda.find.gee.mean'>Calculate the tuning parameters under marginal mean selection in GEE</h2><span id='topic+lambda.find.gee.mean'></span>

<h3>Description</h3>

<p>This function provides an efficient algorithm to calculate the tuning parameters involved in marginal mean selection in GEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.find.gee.mean(x, y, id, beta, r, dist, rho, phi, corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.find.gee.mean_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records. The default setup is that all data are observed. See more in details section.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.gee.mean_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the element in argument &quot;r&quot; equals zero, the corresponding rows of &quot;x&quot; and &quot;y&quot; should be all zeros.
</p>


<h3>Value</h3>

<p>Tuning parameter values.
</p>


<h3>Note</h3>

<p>corstr should be prespecified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
corstr&lt;-"exchangeable"
dist&lt;-"poisson"
# obtain the estimates
library(geepack)
fit&lt;-geeglm(y~x-1,data=geesimdata,family =dist,id=id,corstr = corstr)
beta&lt;-fit$coefficients
rho&lt;-unlist(summary(fit)$corr[1])
phi&lt;-unlist(summary(fit)$dispersion[1])
r&lt;-rep(1,nrow(x))
lambda&lt;-lambda.find.gee.mean(x,y,id,beta,r,dist,rho,phi,corstr)
lambda

</code></pre>

<hr>
<h2 id='lambda.find.glm'>To calculate tuning parameter involved in ELCIC under GLM</h2><span id='topic+lambda.find.glm'></span>

<h3>Description</h3>

<p>This function aims to efficiently calculate the tuning parameter lambda in ELCIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.find.glm(x, y, beta, dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.find.glm_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should contain all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="lambda.find.glm_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="lambda.find.glm_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimating procedure.</p>
</td></tr>
<tr><td><code id="lambda.find.glm_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A value of lambda (tuning parameter) vector involved in the empirical likelihood.
</p>


<h3>Note</h3>

<p>All &quot;x&quot; and &quot;y&quot; should be observed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(glmsimdata)
x&lt;-glmsimdata$x
y&lt;-glmsimdata$y
# obtain the estimates
fit&lt;-glm(y~x-1,family="poisson")
beta&lt;-fit$coefficients
lambda&lt;-lambda.find.glm(x, y, beta, dist="poisson")
lambda

</code></pre>

<hr>
<h2 id='lambda.find.wgee'>Calculate the tuning parameters involved in ELCIC under WGEE with data missing at random</h2><span id='topic+lambda.find.wgee'></span>

<h3>Description</h3>

<p>This function provides an efficient algorithm to calculate the tuning parameters involved in ELCIC under WGEE with data missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.find.wgee(y,x,r,pi,id,time,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.find.wgee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_pi">pi</code></td>
<td>
<p>A vector containing observing probabilities across all observations.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_time">time</code></td>
<td>
<p>The number of observations for each subject</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Tuning parameter values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,scale = NULL,
         mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
lambda&lt;-lambda.find.wgee(y=wgeesimdata$y,x=wgeesimdata$x,r=wgeesimdata$obs_ind,
pi=pi,id=wgeesimdata$id,time=3,beta=beta,rho=rho,phi=phi,dist=dist,corstr=corstr)
lambda

</code></pre>

<hr>
<h2 id='lambda.find.wgee.mean'>Calculate the tuning parameters involved in marginal mean selection under WGEE with data missing at random</h2><span id='topic+lambda.find.wgee.mean'></span>

<h3>Description</h3>

<p>This function provides an efficient algorithm to calculate the tuning parameters involved in marginal mean selection under WGEE with data missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda.find.wgee.mean(y,x,r,pi,id,time,beta,rho,phi,dist,corstr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lambda.find.wgee.mean_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_pi">pi</code></td>
<td>
<p>A vector containing observing probabilities across all observations.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_time">time</code></td>
<td>
<p>The number of observations for each subject</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_beta">beta</code></td>
<td>
<p>A plug-in estimator solved by an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_rho">rho</code></td>
<td>
<p>A correlation coefficients obtained from an external estimation procedure, such as WGEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_phi">phi</code></td>
<td>
<p>An over-dispersion parameter obtained from an external estimation procedure, such as GEE.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="lambda.find.wgee.mean_+3A_corstr">corstr</code></td>
<td>
<p>A candidate correlation structure. It can be &quot;independence&quot;,&quot;exchangeable&quot;, and &quot;ar1&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Tuning parameter values.
</p>


<h3>Note</h3>

<p>corstr should be prespecified.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,scale = NULL,
         mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
lambda&lt;-lambda.find.wgee.mean(y=wgeesimdata$y,x=wgeesimdata$x,r=wgeesimdata$obs_ind,
pi=pi,id=wgeesimdata$id,time=3,beta=beta,rho=rho,phi=phi,dist=dist,corstr=corstr)
lambda

</code></pre>

<hr>
<h2 id='marg.prob'>Calculate the inverse of marginal probability for observing records at each time point</h2><span id='topic+marg.prob'></span>

<h3>Description</h3>

<p>A function calculates the inverse of joint probabilities for weight calculation involved in WGEE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marg.prob(pi)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marg.prob_+3A_pi">pi</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector containing the inverse of joint probabilities.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
library(wgeesel)
data_wgee&lt;-data.frame(do.call(cbind,wgeesimdata))
corstr&lt;-"exchangeable"
dist&lt;-"binomial"
id&lt;-data_wgee$id
# obtain the estimates
fit&lt;-wgee(y~x1+x2+x3,data_wgee,id,family=dist,corstr =corstr,scale = NULL,
         mismodel =obs_ind~x_mis1)
beta&lt;-as.vector(summary(fit)$beta)
rho&lt;-summary(fit)$corr
phi&lt;-summary(fit)$phi
#calculate observing probabilies for all observations
gamma&lt;-as.vector(summary(fit$mis_fit)$coefficients[,1])
x_mis&lt;-wgeesimdata$x_mis
pi&lt;-cond.prob(x_mis,gamma,id,time=3)
joint_prob&lt;-marg.prob(pi)
</code></pre>

<hr>
<h2 id='MLIC.wgee'>The whole MLIC procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+MLIC.wgee'></span>

<h3>Description</h3>

<p>This function provides the overall MLIC procedure for joint selection of mean structure and correlation structure in longitudinal data missing at random. It is also able to implement marginal mean structure selection given a prespecified working correlation structure. The data is dropout missing and missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLIC.wgee(x,y,x_mis,r,id,time,candidate.sets=NULL, name.var.sets=NULL,dist,
      candidate.cor.sets=c("independence","exchangeable", "ar1"), joints=TRUE,lag=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLIC.wgee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is expected in the marginal mean model. Covariate matrix should be complete.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. Use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_x_mis">x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept. This covariate matrix should be complete and all observed. See more in details section.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. When joints=TRUE, it is c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;) as default. When joints=FALSE, it should be either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. See more in details section.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
<tr><td><code id="MLIC.wgee_+3A_lag">lag</code></td>
<td>
<p>A numeric value indicating lag-response involved in the missing data model. It can be either 1 or 2. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariate matrix &quot;x&quot; should be complete. If missing data are present in &quot;x&quot;, the elements in covariate vector will be replaced by zeros for individuals who have missing covariates.
</p>
<p>The argument &quot;x_mis&quot; includes all covariates to fit the missing data model. It does not contains a lag variable based on the outcome y. The argument &quot;lag&quot; in this function will automatically add lag-response variables to indicate the data missing at random.
</p>
<p>Either arguments &quot;candidate.sets&quot; or &quot;name.var.sets&quot; is used to identify the set of candidate mean model. If both arguments are provided, only the argument &quot;name.var.sets&quot; will be used.
</p>
<p>When joints=TRUE, the argument &quot;candidate.cor.sets&quot; can contain multiple correlation structures; however, when joints=FALSE, it should contain either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. If multiple correlation structures are provided, only the first one will be used.
</p>


<h3>Value</h3>

<p>A vector with each element containing MLIC value for each candidate model. The row name of this vector is the selected correlation structure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
dist&lt;-"binomial"
x&lt;-wgeesimdata$x
y&lt;-wgeesimdata$y
x_mis&lt;-wgeesimdata$x_mis
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time=3
candidate.sets&lt;-list(c(1,2))
candidate.cor.sets&lt;-c("independence")
criterion.mlic&lt;-MLIC.wgee(x,y,x_mis,r,id,time,candidate.sets,
            name.var.sets=NULL,dist,candidate.cor.sets,joints=FALSE)
criterion.mlic
</code></pre>

<hr>
<h2 id='MLICwgee'>Model selection based on MLIC under the syntax of WGEE (Main function).</h2><span id='topic+MLICwgee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+MLICwgee">MLICwgee</a></code> provides the model selection under the syntax of the wgeesel package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLICwgee(models, candidate.cor.sets, data, model_mis, family,r,id,time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MLICwgee_+3A_models">models</code></td>
<td>
<p>A list of formulas. See corresponding documentation to wgeesel.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. It can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;).</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in both the main model and the missing model.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_model_mis">model_mis</code></td>
<td>
<p>A formula used in the missing data model.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model.
The details are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject),
and 0 for unobserved records.
The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="MLICwgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three commonly used distributions are considered: &quot;gaussian&quot;, &quot;poisson&quot;, &quot;binomial&quot;.
For the current package, the identity link is considered for a &quot;gaussian&quot; distribution;
the log link is considered for a &quot;poisson&quot; distribution; the logit link is considered for a &quot;binomial&quot; distribution;n;
</p>


<h3>Value</h3>

<p>A list with two items: model selection result based on ELCIC;
An object of &quot;wgee&quot; based on the selected model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
family&lt;-binomial()
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
dat &lt;- data.frame(y=wgeesimdata$y, wgeesimdata$x,x_mis1=wgeesimdata$x_mis[,2])
models &lt;- list(y~x1+x2)
model_mis&lt;-r~x_mis1
candidate.cor.sets&lt;-c("exchangeable")
##not run
#output&lt;-MLICwgee(models, candidate.cor.sets,data=dat,model_mis,family,r,id,time)
#output$model.selection
#output$wgee.output


</code></pre>

<hr>
<h2 id='QICc.gee'>Joint selection procedure of marginal mean and correlation structures in longitudinal data based on QIC</h2><span id='topic+QICc.gee'></span>

<h3>Description</h3>

<p>This function provides the Joint selection of marginal mean and correlation structures in longitudinal data based on QIC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QICc.gee(x,y,id,dist,candidate.sets=NULL, name.var.sets=NULL,
   candidate.cor.sets=c("independence","exchangeable", "ar1"), joints=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QICc.gee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept. Covariate matrix should be complete.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates. The names should be subset of column names of x matrix.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. When joints=TRUE, it can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). The default is c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;). When joints=FALSE, it should be either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. See more in details section.</p>
</td></tr>
<tr><td><code id="QICc.gee_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either arguments &quot;index.var&quot; or &quot;name.var&quot; is used to identify the candidate mean model. If both arguments are provided, only the argument &quot;name.var&quot; will be used.
</p>
<p>When joints=TRUE, the argument &quot;candidate.cor.sets&quot; can contain multiple correlation structures; however, when joints=FALSE, it should contain either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. If multiple correlation structures are provided, only the first one will be used.
</p>


<h3>Value</h3>

<p>A vector with each element containing QIC value for each candidate model. The row name of this vector is the selected correlation structure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(geesimdata)
x&lt;-geesimdata$x
y&lt;-geesimdata$y
id&lt;-geesimdata$id
r&lt;-rep(1,nrow(x))
time&lt;-3
candidate.sets&lt;-list(c(1,2),c(1,2,3))
candidate.cor.sets&lt;-c("exchangeable")
dist="poisson"
criterion.qic&lt;-QICc.gee(x=x,y=y,id=id,dist=dist,candidate.sets=candidate.sets,
                    name.var.sets=NULL,candidate.cor.sets=candidate.cor.sets)
criterion.qic

</code></pre>

<hr>
<h2 id='QICW.wgee'>The whole QICW procedure for joint selection of mean structure and correlation structure for missing longitudinal data under the mechanism of missing at random and drop-out</h2><span id='topic+QICW.wgee'></span>

<h3>Description</h3>

<p>This function provides the overall QICW procedure for joint selection of mean structure and correlation structure in longitudinal data missing at random. It is also able to implement marginal mean structure selection given a prespecified working correlation structure. The data is dropout missing and missing at random.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QICW.wgee(x,y,x_mis,r,id,time,candidate.sets,name.var.sets=NULL,
     dist,candidate.cor.sets=c("independence","exchangeable", "ar1"), joints=TRUE,lag=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QICW.wgee_+3A_x">x</code></td>
<td>
<p>A matrix containing covariates. The first column should be all ones corresponding to the intercept if the intercept is expected in the marginal mean model. Covariate matrix should be complete.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_y">y</code></td>
<td>
<p>A vector containing outcomes. Use NA to indicate missing outcomes.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_x_mis">x_mis</code></td>
<td>
<p>A matrix containing covariates for the missing data model. The first column should be all ones corresponding to the intercept. This covariate matrix should be complete and all observed. See more in details section.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of outcomes: 1 for observed records, and 0 for unobserved records.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_candidate.sets">candidate.sets</code></td>
<td>
<p>A list containing index corresponding to candidate covariates. See more in details section.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_name.var.sets">name.var.sets</code></td>
<td>
<p>A list containing names of candidate covariates. The names should be subset of column names of x matrix. See more in details section.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_dist">dist</code></td>
<td>
<p>A specified distribution. It can be &quot;gaussian&quot;, &quot;poisson&quot;,and &quot;binomial&quot;.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. When joints=TRUE, it is c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;) as default. When joints=FALSE, it should be either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. See more in details section.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_joints">joints</code></td>
<td>
<p>A logic value for joint selection of marginal mean and working correlation structure. The default is TRUE. See more in details section.</p>
</td></tr>
<tr><td><code id="QICW.wgee_+3A_lag">lag</code></td>
<td>
<p>A numeric value indicating lag-response involved in the missing data model. It can be either 1 or 2. The default is 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Covariate matrix &quot;x&quot; should be complete. If missing data are present in &quot;x&quot;, the elements in covariate vector will be replaced by zeros for individuals who have missing covariates.
</p>
<p>The argument &quot;x_mis&quot; includes all covariates to fit the missing data model. It does not contains a lag variable based on the outcome y. The argument &quot;lag&quot; in this function will automatically add lag-response variables to indicate the data missing at random.
</p>
<p>Either arguments &quot;candidate.sets&quot; or &quot;name.var.sets&quot; is used to identify the set of candidate mean model. If both arguments are provided, only the argument &quot;name.var.sets&quot; will be used.
</p>
<p>When joints=TRUE, the argument &quot;candidate.cor.sets&quot; can contain multiple correlation structures; however, when joints=FALSE, it should contain either of &quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;. If multiple correlation structures are provided, only the first one will be used.
</p>


<h3>Value</h3>

<p>A vector with each element containing QICW value for each candidate model. The row name of this vector is the selected correlation structure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
dist="binomial"
x&lt;-wgeesimdata$x
y&lt;-wgeesimdata$y
x_mis&lt;-wgeesimdata$x_mis
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time=3
candidate.sets&lt;-list(c(1,2))
candidate.cor.sets&lt;-c("independence")
criterion.qicw&lt;-QICW.wgee(x,y,x_mis,r,id,time,candidate.sets,
         name.var.sets=NULL,dist,candidate.cor.sets,joints=FALSE)
criterion.qicw

</code></pre>

<hr>
<h2 id='QICWwgee'>Model selection based on QICW under the syntax of WGEE (Main function).</h2><span id='topic+QICWwgee'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+QICWwgee">QICWwgee</a></code> provides the model selection under the syntax of the wgeesel package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QICWwgee(models, candidate.cor.sets, data, model_mis, family,r,id,time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QICWwgee_+3A_models">models</code></td>
<td>
<p>A list of formulas. See corresponding documentation to wgeesel.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_candidate.cor.sets">candidate.cor.sets</code></td>
<td>
<p>A vector containing candidate correlation structures. It can be any subset of c(&quot;independence&quot;,&quot;exchangeable&quot;, &quot;ar1&quot;).</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_data">data</code></td>
<td>
<p>A data frame containing the variables in both the main model and the missing model.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_model_mis">model_mis</code></td>
<td>
<p>A formula used in the missing data model.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_family">family</code></td>
<td>
<p>A description of the error distribution and link function to be used in the model.
The details are given under &quot;Details&quot;.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_r">r</code></td>
<td>
<p>A vector indicating the observation of data: 1 for observed records (both outcome and covariates are observed for a given subject),
and 0 for unobserved records.
The default setup is that all data are observed.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_id">id</code></td>
<td>
<p>A vector indicating subject id.</p>
</td></tr>
<tr><td><code id="QICWwgee_+3A_time">time</code></td>
<td>
<p>The number of observations in total for each subject.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three commonly used distributions are considered: &quot;gaussian&quot;, &quot;poisson&quot;, &quot;binomial&quot;.
For the current package, the identity link is considered for a &quot;gaussian&quot; distribution;
the log link is considered for a &quot;poisson&quot; distribution; the logit link is considered for a &quot;binomial&quot; distribution;n;
</p>


<h3>Value</h3>

<p>A list with two items: model selection result based on ELCIC;
An object of &quot;wgee&quot; based on the selected model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## tests
# load data
data(wgeesimdata)
family&lt;-binomial()
r&lt;-wgeesimdata$obs_ind
id&lt;-wgeesimdata$id
time&lt;-3
dat &lt;- data.frame(y=wgeesimdata$y, wgeesimdata$x,x_mis1=wgeesimdata$x_mis[,2])
models &lt;- list(y~x1+x2)
model_mis&lt;-r~x_mis1
candidate.cor.sets&lt;-c("exchangeable")
##not run
#output&lt;-QICWwgee(models, candidate.cor.sets,data=dat,model_mis,family,r,id,time)
#output$model.selection
#output$wgee.output


</code></pre>

<hr>
<h2 id='respiratorydata'>Data from a clinical trial comparing two treatments for a respiratory illness</h2><span id='topic+respiratorydata'></span>

<h3>Description</h3>

<p>The data are from a clinical trial of patients with respiratory illness, where 111 patients from two different clinics were randomized to receive either placebo or an active treatment. Patients were examined at baseline and at four visits during treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(respiratorydata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"list"</code>
</p>

<dl>
<dt>y</dt><dd><p>Respiratory status at each visit, categorized as 1 = good, 0 = poor.</p>
</dd>
<dt>x</dt><dd><p>A full covariate matrix. It contains intercept, center(1: center 2, 0: center 1), sex (1: male,0: female), treat (1: treatment, 0: placebo), visit: id of each of four visits, baseline: respiratory status at baseline, age: in years at baseline.</p>
</dd>
<dt>id</dt><dd><p>Patient ID</p>
</dd>
<dt>r</dt><dd><p>A vector indicating the observation of data (1: observed; 0: missing). All data are observed.</p>
</dd>
</dl>



<h3>References</h3>

<p>add here
</p>

<hr>
<h2 id='wgeesimdata'>Data simulated for model selection under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out.</h2><span id='topic+wgeesimdata'></span>

<h3>Description</h3>

<p>Data simulated for model selection under WGEE framework for missing longitudinal data under the mechanism of missing at random and drop-out.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wgeesimdata)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>"list"</code>
</p>

<dl>
<dt>y</dt><dd><p>The outcomes generated from Bernoulli distribution with three repeated measurements from each subject. The data is longitudinal dropout and missing at random.</p>
</dd>
<dt>x</dt><dd><p>A full covariate matrix. The first column corresponds to the intercept; the second column contains time-independent continuous-scale variable x1; the third column contains a doctor-visit variable x2; the third column contains time-independent binary-scale variable x3.</p>
</dd>
<dt>x_mis</dt><dd><p>A covariate matrix for missing data model. The first column corresponds to the intercept; the second column contains continuous variable x_mis1.</p>
</dd>
<dt>id</dt><dd><p>A vector indicating subject id.</p>
</dd>
<dt>obs_ind</dt><dd><p>A vector indicating observations for each record: 1 for observed records, and 0 for unobserved records.</p>
</dd>
</dl>



<h3>References</h3>

<p>This data set was artificially created for the ELCIC package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(wgeesimdata)
wgeesimdata$y

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
