<!DOCTYPE html><html><head><title>Help for package medExtractR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {medExtractR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#medExtractR-package'><p>Medication Extraction With R</p></a></li>
<li><a href='#addl_expr'><p>Additional expressions for <code>drug_list</code></p></a></li>
<li><a href='#dosechange_vals'><p>Keywords Specifying Dose Change</p></a></li>
<li><a href='#doseschedule_vals'><p>Keywords Specifying Dose Schedule</p></a></li>
<li><a href='#duration_vals'><p>Keywords Specifying Duration</p></a></li>
<li><a href='#entity_metadata'><p>Grab Entity Metadata</p></a></li>
<li><a href='#extract_entities'><p>Extract Medication Entities From Phrase</p></a></li>
<li><a href='#extract_entities_tapering'><p>Extract Medication Entities From Phrase - Extension of <code>extract_entities</code> for Tapering application</p></a></li>
<li><a href='#extract_generic'><p>Extract Generic Entities From Phrase</p></a></li>
<li><a href='#extract_lastdose'><p>Extract Last Dose Time From Phrase</p></a></li>
<li><a href='#extract_type'><p>Internal handler for generic entity extraction</p></a></li>
<li><a href='#frequency_vals'><p>Keywords Specifying Frequency</p></a></li>
<li><a href='#intaketime_vals'><p>Keywords Specifying Intake Time</p></a></li>
<li><a href='#internal_censor_dates'><p>Preprocess Phrase for Date-times</p></a></li>
<li><a href='#internal_find_numbers'><p>Preprocess Phrase for Numbers</p></a></li>
<li><a href='#medExtractR'><p>Extract Medication Entities From Clinical Note</p></a></li>
<li><a href='#medExtractR_tapering'><p>Extract Medication Entities From Clinical Note - Extension of <code>medExtractR</code> for Tapering applications</p></a></li>
<li><a href='#preposition_vals'><p>Keywords Specifying Preposition</p></a></li>
<li><a href='#replace_tab'><p>String Replace Tablet With Tabs</p></a></li>
<li><a href='#route_vals'><p>Keywords Specifying Route</p></a></li>
<li><a href='#rxnorm_druglist'><p>List of Medications</p></a></li>
<li><a href='#string_counts'><p>Counts Strings in Text</p></a></li>
<li><a href='#string_occurs'><p>Find Strings in Text</p></a></li>
<li><a href='#string_suggestions'><p>Find Strings and Suggest Misspellings</p></a></li>
<li><a href='#strings-internal'><p>Internal String Functions</p></a></li>
<li><a href='#time_regex'><p>Keywords Specifying Time Expressions</p></a></li>
<li><a href='#timekeyword_vals'><p>Keywords Specifying Time Keyword</p></a></li>
<li><a href='#transition_vals'><p>Keywords/Symbols Specifying Transition</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-06</td>
</tr>
<tr>
<td>Title:</td>
<td>Extraction of Medication Information from Clinical Text</td>
</tr>
<tr>
<td>Description:</td>
<td>Function and support for medication and dosing information extraction from free-text clinical notes. Medication entities for the basic medExtractR implementation that can be extracted include drug name, strength, dose amount, dose, frequency, intake time, dose change, and time of last dose. The basic medExtractR is outlined in Weeks, Beck, McNeer, Williams, Bejan, Denny, Choi (2020) &lt;<a href="https://doi.org/10.1093%2Fjamia%2Focz207">doi:10.1093/jamia/ocz207</a>&gt;. The extended medExtractR_tapering implementation is intended to extract dosing information for more tapering schedules, which are far more complex. The tapering extension allows for the extraction of additional entities including dispense amount, refills, dose schedule, time keyword, transition, and preposition.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>stringi, stringr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, ggplot2, rmarkdown, markdown, parallel</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-06 22:10:29 UTC; beckca</td>
</tr>
<tr>
<td>Author:</td>
<td>Leena Choi <a href="https://orcid.org/0000-0002-2544-7090"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Cole Beck <a href="https://orcid.org/0000-0002-6849-6255"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Hannah Weeks <a href="https://orcid.org/0000-0002-0262-6790"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Leena Choi &lt;leena.choi@vanderbilt.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-06 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='medExtractR-package'>Medication Extraction With R</h2><span id='topic+medExtractR-package'></span><span id='topic+_PACKAGE'></span>

<h3>Description</h3>

<p>Provides a function <code><a href="#topic+medExtractR">medExtractR</a></code> for extracting
dose attributes for medications within a given electronic health record (EHR) note.
</p>


<h3>Author(s)</h3>

<p>Hannah Weeks <a href="mailto:hannah.l.weeks@vanderbilt.edu">hannah.l.weeks@vanderbilt.edu</a>,<br />
Cole Beck <a href="mailto:cole.beck@vumc.org">cole.beck@vumc.org</a>,<br />
Leena Choi <a href="mailto:leena.choi@vumc.org">leena.choi@vumc.org</a>
</p>
<p>Maintainer: Leena Choi <a href="mailto:leena.choi@vumc.org">leena.choi@vumc.org</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
note1 &lt;- "Progrf Oral Capsule 1 mg 3 capsules by mouth twice a day - last
dose at 10pm"
note2 &lt;- "Currently on lamotrigine 150-200, but will increase to lamotrigine 200mg bid"
medExtractR(note1, c("prograf", "tacrolimus"), 60, "mg", 2, lastdose=TRUE)
medExtractR(note2, c("lamotrigine", "ltg"), 130, "mg", 1, strength_sep = "-")

</code></pre>

<hr>
<h2 id='addl_expr'>Additional expressions for <code>drug_list</code></h2><span id='topic+addl_expr'></span>

<h3>Description</h3>

<p>A dictionary with additional expressions that can be used to supplement the <code>drug_list</code>
argument of <code><a href="#topic+medExtractR">medExtractR</a></code> and <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addl_expr
</code></pre>


<h3>Format</h3>

<p>A data frame with the following variables:
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, additional optional expressions for the <code>drug_list</code> argument.</p>
</dd>
<dt>type</dt><dd><p>A character vector, what category the expression belongs to (e.g., symptom, lab name, medication abbreviation, or drug class).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(addl_expr)
</code></pre>

<hr>
<h2 id='dosechange_vals'>Keywords Specifying Dose Change</h2><span id='topic+dosechange_vals'></span>

<h3>Description</h3>

<p>A dictionary of words indicating a dose change, meaning that the associated
drug regimen may not be current. This includes phrases such as increase,
reduce, or switch. In the following example of clinical text, the word
&lsquo;increase&rsquo; represents a dose change keyword: &ldquo;Increase prograf to 5mg bid.&rdquo;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dosechange_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with dose change expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as dose change.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(dosechange_vals)
</code></pre>

<hr>
<h2 id='doseschedule_vals'>Keywords Specifying Dose Schedule</h2><span id='topic+doseschedule_vals'></span>

<h3>Description</h3>

<p>A dictionary with words for indicating a tapering dosing schedule. These can explicitly
refer to such a schedule with phrases like &quot;tapering&quot; or &quot;wean&quot;. It also includes words indicating
an alternating dose schedule (e.g., &quot;alternate&quot;, &quot;alt.&quot;, &quot;even days&quot;, or &quot;odd days&quot;) as well as
stopping keywords indicating the patient is going completely off the medication (e.g., &quot;done&quot;, &quot;gone&quot;,
&quot;stop&quot;, &quot;discontinue&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>doseschedule_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with dose schedule expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as dose schedule.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(doseschedule_vals)
</code></pre>

<hr>
<h2 id='duration_vals'>Keywords Specifying Duration</h2><span id='topic+duration_vals'></span>

<h3>Description</h3>

<p>A dictionary with phrases indicating how long the patient should take a particular
dose of the drug. Examples of duration expressions include &quot;2 weeks&quot;, &quot;14 days&quot;,
&quot;another 3 days&quot;, &quot;through mid-April&quot;, or a specific date. The form of each duration is
given as a regular expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duration_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with duration expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as duration.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(duration_vals)
</code></pre>

<hr>
<h2 id='entity_metadata'>Grab Entity Metadata</h2><span id='topic+entity_metadata'></span>

<h3>Description</h3>

<p>This function builds the metadata based on position.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>entity_metadata(phrase, p_offset, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="entity_metadata_+3A_phrase">phrase</code></td>
<td>
<p>Text of interest.</p>
</td></tr>
<tr><td><code id="entity_metadata_+3A_p_offset">p_offset</code></td>
<td>
<p>Start position of text within greater document.</p>
</td></tr>
<tr><td><code id="entity_metadata_+3A_df">df</code></td>
<td>
<p>data.frame with position and length of found medication entities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with found medication entities and accompanying metadata.
</p>

<hr>
<h2 id='extract_entities'>Extract Medication Entities From Phrase</h2><span id='topic+extract_entities'></span>

<h3>Description</h3>

<p>This function searches a phrase for medication dosing entities of interest. It
is called within <code><a href="#topic+medExtractR">medExtractR</a></code> and generally not intended for use outside
that function. The <code>phrase</code> argument containing text to search corresponds to an
individual mention of the drug of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_entities(
  phrase,
  p_start,
  p_stop,
  unit,
  frequency_fun = NULL,
  intaketime_fun = NULL,
  duration_fun = NULL,
  route_fun = NULL,
  strength_sep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_entities_+3A_phrase">phrase</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_p_start">p_start</code></td>
<td>
<p>Start position of phrase within original text.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_p_stop">p_stop</code></td>
<td>
<p>End position of phrase within original text.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement for medication strength, e.g. &lsquo;mg&rsquo;.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_frequency_fun">frequency_fun</code></td>
<td>
<p>Function used to extract frequency.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_intaketime_fun">intaketime_fun</code></td>
<td>
<p>Function used to extract intake time.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_duration_fun">duration_fun</code></td>
<td>
<p>Function used to extract duration.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_route_fun">route_fun</code></td>
<td>
<p>Function used to extract route.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_strength_sep">strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths.</p>
</td></tr>
<tr><td><code id="extract_entities_+3A_...">...</code></td>
<td>
<p>Parameter settings used in extracting frequency and intake time,
including additional arguments to the <code>&lt;entity&gt;_fun</code> arguments. Use <code>frequency_dict</code>,
<code>intaketime_dict</code>, <code>duration_dict</code>, and <code>route_dict</code> to identify
custom frequency, intake time, duration, and route dictionaries, respectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Various medication dosing entities are extracted within this function
including the following:
</p>
<p><em>strength</em>: The amount of drug in a given dosage form (i.e., tablet, capsule).<br />
<em>dose amount</em>: The number of tablets, capsules, etc. taken at a given intake time.<br />
<em>dose strength</em>: The total amount of drug given intake. This quantity would be
equivalent to strength x dose amount, and appears similar to strength when
dose amount is absent.<br />
<em>frequency</em>: The number of times per day a dose is taken, e.g.,
&ldquo;once daily&rdquo; or &lsquo;2x/day&rsquo;.<br />
<em>intaketime</em>: The time period of the day during which a dose is taken,
e.g., &lsquo;morning&rsquo;, &lsquo;lunch&rsquo;, &lsquo;in the pm&rsquo;.<br />
<em>duration</em>: How long a patient is on a drug regimen, e.g., &lsquo;2 weeks&rsquo;,
&lsquo;mid-April&rsquo;, &lsquo;another 3 days&rsquo;.<br />
<em>route</em>: The administration route of the drug, e.g., &lsquo;by mouth&rsquo;,
&lsquo;IV&rsquo;, &lsquo;topical&rsquo;.<br />
</p>
<p>Note that extraction of the entities drug name, dose change, and time of last dose are not
handled by the <code>extract_entities</code> function. Those entities are extracted separately
and appended to the <code>extract_entities</code> output within the main <code>medExtractR</code> function.
Strength, dose amount, and dose strength are primarily numeric quantities, and are identified
using a combination of regular expressions and rule-based approaches. Frequency, intake time,
route, and duration, on the other hand, use dictionaries for identification.
</p>
<p>By default and when an argument <code>&lt;entity&gt;_fun</code> is <code>NULL</code>, the
<code><a href="#topic+extract_generic">extract_generic</a></code> function will be used to extract that entity. This function
can also inherit user-defined entity dictionaries, supplied as arguments <code>&lt;entity&gt;_dict</code>
to <code><a href="#topic+medExtractR">medExtractR</a></code> or <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code> (see documentation files for main function(s) for details).
</p>
<p>The <code>stength_sep</code> argument is <code>NULL</code> by default, but can be used to
identify shorthand for morning and evening doses. For example, consider the
phrase &ldquo;Lamotrigine 300-200&rdquo; (meaning 300 mg in the morning and 200 mg
in the evening). The argument <code>strength_sep = '-'</code> identifies
the full expression <em>300-200</em> as <em>dose strength</em> in this phrase.
</p>


<h3>Value</h3>

<p>data.frame with entities information. At least one row per entity is returned,
using <code>NA</code> when no expression was found for a given entity.<br />
The &ldquo;entity&rdquo; column of the output contains the formatted label for that entity, according to
the following mapping.<br />
strength: &ldquo;Strength&rdquo;<br />
dose amount: &ldquo;DoseAmt&rdquo;<br />
dose strength: &ldquo;DoseStrength&rdquo;<br />
frequency: &ldquo;Frequency&rdquo;<br />
intake time: &ldquo;IntakeTime&rdquo;<br />
duration: &ldquo;Duration&rdquo;<br />
route: &ldquo;Route&rdquo;<br />
Sample output for the phrase &ldquo;Lamotrigine 200mg bid&rdquo; would look like:<br />
</p>

<table>
<tr>
 <td style="text-align: right;">
 entity   </td><td style="text-align: right;">  expr</td>
</tr>
<tr>
 <td style="text-align: right;">
 IntakeTime  </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Strength  </td><td style="text-align: right;">   &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseAmt   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Route   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Duration   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Frequency </td><td style="text-align: right;">  bid;19:22</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseStrength  </td><td style="text-align: right;">  200mg;13:18
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>note &lt;- "Lamotrigine 25 mg tablet - 3 tablets oral twice daily"
extract_entities(note, 1, nchar(note), "mg")
# A user-defined dictionary can be used instead of the default
my_dictionary &lt;- data.frame(c("daily", "twice daily"))
extract_entities(note, 1, 53, "mg", frequency_dict = my_dictionary)
</code></pre>

<hr>
<h2 id='extract_entities_tapering'>Extract Medication Entities From Phrase - Extension of <code><a href="#topic+extract_entities">extract_entities</a></code> for Tapering application</h2><span id='topic+extract_entities_tapering'></span>

<h3>Description</h3>

<p>This function searches a phrase for medication dosing entities of interest. It
is called within <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code> and generally not intended for use outside
that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_entities_tapering(
  phrase,
  p_start,
  d_stop,
  unit,
  frequency_fun = NULL,
  intaketime_fun = NULL,
  duration_fun = NULL,
  route_fun = NULL,
  doseschedule_fun = NULL,
  preposition_fun = NULL,
  timekeyword_fun = NULL,
  transition_fun = NULL,
  dosechange_fun = NULL,
  strength_sep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_entities_tapering_+3A_phrase">phrase</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_p_start">p_start</code></td>
<td>
<p>Start position of phrase within original text.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_d_stop">d_stop</code></td>
<td>
<p>End position of drug name within original text.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_unit">unit</code></td>
<td>
<p>Unit of measurement for medication strength, e.g., &lsquo;mg&rsquo;.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_frequency_fun">frequency_fun</code></td>
<td>
<p>Function used to extract frequency.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_intaketime_fun">intaketime_fun</code></td>
<td>
<p>Function used to extract intake time.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_duration_fun">duration_fun</code></td>
<td>
<p>Function used to extract duration.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_route_fun">route_fun</code></td>
<td>
<p>Function used to extract route.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_doseschedule_fun">doseschedule_fun</code></td>
<td>
<p>Function used to extract dose schedule.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_preposition_fun">preposition_fun</code></td>
<td>
<p>Function used to extract preposition.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_timekeyword_fun">timekeyword_fun</code></td>
<td>
<p>Function used to extract time keyword.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_transition_fun">transition_fun</code></td>
<td>
<p>Function used to extract transition.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_dosechange_fun">dosechange_fun</code></td>
<td>
<p>Function used to extract dose change.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_strength_sep">strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths.</p>
</td></tr>
<tr><td><code id="extract_entities_tapering_+3A_...">...</code></td>
<td>
<p>Parameter settings used in extracting frequency and intake time,
including additional arguments to <code>frequency_fun</code> and
<code>intaketime_fun</code>. Use <code>frequency_dict</code> to identify custom frequency
dictionaries and <code>intaketime_dict </code> to identify custom intake time
dictionaries. Similarly, for all other entities with a corresponding <code>&lt;entity&gt;_fun</code>,
a custom dictionary can be supplied with the argument <code>&lt;entity&gt;_dict</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Various medication dosing entities are extracted within this function
including the following:
</p>
<p><em>strength</em>: The amount of drug in a given dosage form (i.e., tablet, capsule).<br />
<em>dose amount</em>: The number of tablets, capsules, etc. taken at a given intake time.<br />
<em>dose strength</em>: The total amount of drug given intake. This quantity would be
equivalent to strength x dose amount, and appears similar to strength when
dose amount is absent.<br />
<em>frequency</em>: The number of times per day a dose is taken, e.g.,
&ldquo;once daily&rdquo; or &lsquo;2x/day&rsquo;.<br />
<em>intaketime</em>: The time period of the day during which a dose is taken,
e.g., &lsquo;morning&rsquo;, &lsquo;lunch&rsquo;, &lsquo;in the pm&rsquo;.<br />
<em>duration</em>: How long a patient is on a drug regimen, e.g., &lsquo;2 weeks&rsquo;,
&lsquo;mid-April&rsquo;, &lsquo;another 3 days&rsquo;.<br />
<em>route</em>: The administration route of the drug, e.g., &lsquo;by mouth&rsquo;,
&lsquo;IV&rsquo;, &lsquo;topical&rsquo;.<br />
<em>dose change</em>: Whether the dosage of the drug was changed, e.g.,
&lsquo;increase&rsquo;, &lsquo;adjust&rsquo;, &lsquo;reduce&rsquo;.<br />
<em>dose schedule</em>: Keywords which represent special dosing regimens, such as tapering
schedules, alternating doses, or stopping keywords, e.g., &lsquo;weaning&rsquo;,
&lsquo;even days&rsquo; or &lsquo;odd_days&rsquo;, &lsquo;discontinue&rsquo;.<br />
<em>time keyword</em>: Whether the dosing regimen is a past dose, current dose,
or future dose, e.g., &lsquo;currently&rsquo;, &lsquo;remain&rsquo;, &lsquo;yesterday&rsquo;.<br />
<em>transition</em>: Words or symbols that link consecutive doses of a tapering
regimen, e.g., &lsquo;then&rsquo;, &lsquo;followed by&rsquo;, or a comma &lsquo;,&rsquo;.<br />
<em>preposition</em>: Prepositions that occur immediately next to another
identified entity, e.g., &lsquo;to&rsquo;, &lsquo;until&rsquo;, &lsquo;for&rsquo;.<br />
<em>dispense amount</em>: The number of pills prescribed to the patient.<br />
<em>refill</em>: The number of refills allowed for the patient's prescription.<br />
</p>
<p>Similar to the basic implementation, drug name and and time of last dose are not
handled by the <code>extract_entities_tapering</code> function. Those entities are extracted separately
and appended to the <code>extract_entities_tapering</code> output within the main <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code>
function. In the tapering extension, however, dose change is treated the same as other dictionary-based
entities and extracted within <code>extract_entities_tapering</code>. Strength, dose amount, dose strength, dispense amount,
and refill are primarily numeric quantities, and are identified using a combination of
regular expressions and rule-based approaches. All other entities use dictionaries for
identification. For more information about the default dictionary for a specific entity,
view the documentation file for the object <code>&lt;entity&gt;_vals</code>.
</p>
<p>By default and when an argument <code>&lt;entity&gt;_fun</code> is <code>NULL</code>, the
<code><a href="#topic+extract_generic">extract_generic</a></code> function will be used to extract that entity. This function
can also inherit user-defined entity dictionaries for each entity, supplied as arguments <code>&lt;entity&gt;_dict</code>
to <code><a href="#topic+medExtractR">medExtractR</a></code> or <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code> (see documentation files for main function(s) for details).
</p>
<p>Note that <code>extract_entities_tapering</code> has the argument <code>d_stop</code>. This differs
from <code><a href="#topic+extract_entities">extract_entities</a></code>, which uses the end position of the full search window. This
is a consequence of <code><a href="#topic+medExtractR">medExtractR</a></code> using a fixed search window length and <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code>
dynamically constructing a search window.
</p>


<h3>Value</h3>

<p>data.frame with entities information. At least one row per entity is returned,
using <code>NA</code> when no expression was found for a given entity.<br />
The &ldquo;entity&rdquo; column of the output contains the formatted label for that entity, according to
the following mapping.<br />
strength: &ldquo;Strength&rdquo;<br />
dose amount: &ldquo;DoseAmt&rdquo;<br />
dose strength: &ldquo;DoseStrength&rdquo;<br />
frequency: &ldquo;Frequency&rdquo;<br />
intake time: &ldquo;IntakeTime&rdquo;<br />
duration: &ldquo;Duration&rdquo;<br />
route: &ldquo;Route&rdquo;<br />
dose change: &ldquo;DoseChange&rdquo;<br />
dose schedule: &ldquo;DoseScheule&rdquo;<br />
time keyword: &ldquo;TimeKeyword&rdquo;<br />
transition: &ldquo;Transition&rdquo;<br />
preposition: &ldquo;Preposition&rdquo;<br />
dispense amount: &ldquo;DispenseAmt&rdquo;<br />
refill: &ldquo;Refill&rdquo;<br />
Sample output for the phrase &ldquo;Lamotrigine 200mg bid for 14 days&rdquo; would look like:<br />
</p>

<table>
<tr>
 <td style="text-align: right;">
 entity   </td><td style="text-align: right;">  expr</td>
</tr>
<tr>
 <td style="text-align: right;">
 IntakeTime  </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Strength  </td><td style="text-align: right;">   &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseAmt   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseChange   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseSchedule   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 TimeKeyword   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Transition   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Preposition   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 DispenseAmt   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Refill   </td><td style="text-align: right;">  &lt;NA&gt;</td>
</tr>
<tr>
 <td style="text-align: right;">
 Frequency </td><td style="text-align: right;">  bid;19:22</td>
</tr>
<tr>
 <td style="text-align: right;">
 DoseStrength  </td><td style="text-align: right;">  200mg;13:18</td>
</tr>
<tr>
 <td style="text-align: right;">
 Preposition </td><td style="text-align: right;"> for;23:26</td>
</tr>
<tr>
 <td style="text-align: right;">
 Duration </td><td style="text-align: right;"> 14 days;27:34
</td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>note &lt;- "prednisone 20mg daily tapering to 5mg daily over 2 weeks"
extract_entities_tapering(note, 1, 11, "mg")
# A user-defined dictionary can be used instead of the default
my_dictionary &lt;- data.frame(c("daily", "twice daily"))
extract_entities(note, 1, 11, "mg", frequency_dict = my_dictionary)
</code></pre>

<hr>
<h2 id='extract_generic'>Extract Generic Entities From Phrase</h2><span id='topic+extract_generic'></span>

<h3>Description</h3>

<p>This function searches a phrase for the position and length
of expressions specified in a dictionary. This is called within other main functions of
the package and generally not intended for use on its own.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_generic(phrase, dict)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_generic_+3A_phrase">phrase</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="extract_generic_+3A_dict">dict</code></td>
<td>
<p>data.frame, the first column should contain expressions to find.
These can be regular expressions or exact phrases.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>extract_generic</code> is used to extract entities that are
identified with an associated dictionary of phrases or regular expressions,
such as dose change, frequency, intake time, route, or duration in
<code><a href="#topic+medExtractR">medExtractR</a></code> and <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code>, as well as
dose schedule, time keyword, transition, and preposition in <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code>. This function
is called within <code><a href="#topic+extract_entities">extract_entities</a></code>.
</p>


<h3>Value</h3>

<p>A numeric matrix with position and expression length.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(frequency_vals)
extract_generic("take two every day", dict = frequency_vals)
extract_generic("take two every morning",
                  dict = data.frame(c("morning", "every morning")))
</code></pre>

<hr>
<h2 id='extract_lastdose'>Extract Last Dose Time From Phrase</h2><span id='topic+extract_lastdose'></span>

<h3>Description</h3>

<p>This function searches a phrase for the expression and postion
of the time at which the last dose of a drug was taken. It
is called within <code><a href="#topic+medExtractR">medExtractR</a></code> and generally not intended for use outside
that function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_lastdose(phrase, p_start, d_start, d_stop, time_exp = "default")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_lastdose_+3A_phrase">phrase</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="extract_lastdose_+3A_p_start">p_start</code></td>
<td>
<p>Start position of phrase in the overall text (e.g., the full clinical note).</p>
</td></tr>
<tr><td><code id="extract_lastdose_+3A_d_start">d_start</code></td>
<td>
<p>Start position of drug name in larger text.</p>
</td></tr>
<tr><td><code id="extract_lastdose_+3A_d_stop">d_stop</code></td>
<td>
<p>End position of drug name in larger text.</p>
</td></tr>
<tr><td><code id="extract_lastdose_+3A_time_exp">time_exp</code></td>
<td>
<p>Vector of regular expressions to identify time expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function identifies the time at which the last dose of a drug of interest was taken.
The arguments <code>p_start</code>, <code>d_start</code>, and <code>d_stop</code> represent global start or stop
positions for the phrase or drug. These arguments are used to determine the position of any found
last dose time expressions relative to the overall clinical note, not just within <code>phrase</code>.
</p>
<p>The <code>time_exp</code> argument contains regular expressions for numeric or text representations of
last dose time. See <code><a href="#topic+time_regex">time_regex</a></code> for more information about the default regular
expressions used in <code><a href="#topic+medExtractR">medExtractR</a></code>.
</p>


<h3>Value</h3>

<p>data.frame with last dose time entity information. This output format is consistent with
the output of <code><a href="#topic+extract_entities">extract_entities</a></code>, and the formatted label for the time of last dose entity
is &quot;LastDose.&quot; <br />
Sample output for the phrase &ldquo;Last prograf at 5pm&rdquo; would look like:<br />
</p>

<table>
<tr>
 <td style="text-align: right;">
 entity    </td><td style="text-align: right;">    expr</td>
</tr>
<tr>
 <td style="text-align: right;">
 LastDose  </td><td style="text-align: right;">    5pm;17:20
 </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'># Suppose this phrase begins at character 120 in the overall clinical note
extract_lastdose("took aspirin last night at 8pm", p_start = 120,
                  d_start = 125, d_stop = 131)
</code></pre>

<hr>
<h2 id='extract_type'>Internal handler for generic entity extraction</h2><span id='topic+extract_type'></span>

<h3>Description</h3>

<p>Internal handler for generic entity extraction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_type(phrase, type, fun = NULL, ...)
</code></pre>

<hr>
<h2 id='frequency_vals'>Keywords Specifying Frequency</h2><span id='topic+frequency_vals'></span>

<h3>Description</h3>

<p>A dictionary mapping frequency expressions to numeric values representing
the corresponding number of doses per day. Example expressions include
&quot;q12 hours&quot;, &quot;bid&quot;, &quot;daily&quot;, and &quot;three times a day&quot;. The form of each frequency is
given as a regular expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frequency_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with frequency expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as frequency.</p>
</dd>
<dt>value</dt><dd><p>A numeric vector, numeric value of frequency represented as number of doses
taken per day. For example, &ldquo;bid&rdquo; and &ldquo;twice a day&rdquo; would both have a numeric value of 2.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(frequency_vals)
</code></pre>

<hr>
<h2 id='intaketime_vals'>Keywords Specifying Intake Time</h2><span id='topic+intaketime_vals'></span>

<h3>Description</h3>

<p>A dictionary with intake time expressions representing the approximate time of
day when a dose should be taken. Example expressions include &quot;in the morning&quot;,
&quot;with lunch&quot;, &quot;at bedtime&quot;, and &quot;qpm&quot;. The form of each intake time is
given as a regular expression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intaketime_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with intake time expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as intake time.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(intaketime_vals)
</code></pre>

<hr>
<h2 id='internal_censor_dates'>Preprocess Phrase for Date-times</h2><span id='topic+internal_censor_dates'></span>

<h3>Description</h3>

<p>Preprocess Phrase for Date-times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_censor_dates(phrase)
</code></pre>

<hr>
<h2 id='internal_find_numbers'>Preprocess Phrase for Numbers</h2><span id='topic+internal_find_numbers'></span>

<h3>Description</h3>

<p>Preprocess Phrase for Numbers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>internal_find_numbers(phrase, num_patt, num_then_ds, num_as_str)
</code></pre>

<hr>
<h2 id='medExtractR'>Extract Medication Entities From Clinical Note</h2><span id='topic+medExtractR'></span>

<h3>Description</h3>

<p>This function identifies medication entities of interest and returns found
expressions with start and stop positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medExtractR(
  note,
  drug_names,
  window_length,
  unit,
  max_dist = 0,
  drug_list = "rxnorm",
  lastdose = FALSE,
  lastdose_window_ext = 1.5,
  strength_sep = NULL,
  flag_window = 30,
  dosechange_dict = "default",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="medExtractR_+3A_note">note</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_drug_names">drug_names</code></td>
<td>
<p>Vector of drug names of interest to locate.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_window_length">window_length</code></td>
<td>
<p>Length (in number of characters) of window after drug
in which to look.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_unit">unit</code></td>
<td>
<p>Strength unit to look for (e.g., &lsquo;mg&rsquo;).</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_max_dist">max_dist</code></td>
<td>
<p>Numeric - edit distance to use when searching for <code>drug_names</code>.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_drug_list">drug_list</code></td>
<td>
<p>Vector of known drugs that may end search window. By default calls
<code><a href="#topic+rxnorm_druglist">rxnorm_druglist</a></code>.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_lastdose">lastdose</code></td>
<td>
<p>Logical - whether or not last dose time entity should be
extracted.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_lastdose_window_ext">lastdose_window_ext</code></td>
<td>
<p>Numeric - multiplicative factor by which
<code>window_length</code> should be extended when identifying last dose time.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_strength_sep">strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths (e.g., &lsquo;-&rsquo; for &ldquo;LTG 200-300&rdquo;).</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_flag_window">flag_window</code></td>
<td>
<p>How far around drug (in number of characters) to look for
dose change keyword - default fixed to 30. See &lsquo;Details&rsquo; section below for further explanation.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_dosechange_dict">dosechange_dict</code></td>
<td>
<p>List of keywords used to determine if a dose change entity is present.</p>
</td></tr>
<tr><td><code id="medExtractR_+3A_...">...</code></td>
<td>
<p>Parameter settings used in extracting frequency, intake time, route, and duration. Potentially useful
parameters include <code>freq_dict</code>, <code>intaketime_dict</code>, <code>route_dict</code>, and <code>duration_dict</code>
(see <code>...</code> argument in <code><a href="#topic+extract_entities">extract_entities</a></code>) to specify frequency or intake time
dictionaries, as well as &lsquo;freq_fun&rsquo;, &lsquo;intaketime_fun&rsquo;, &lsquo;route_fun&rsquo;, and
&lsquo;duration_fun&rsquo; for user-specified extraction functions. If no additional arguments are provided,
<code>medExtractR_tapering</code> will use <code><a href="#topic+extract_generic">extract_generic</a></code> and the default dictionary for each entity.
See <code><a href="#topic+extract_entities">extract_entities</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a combination of regular expressions, rule-based
approaches, and dictionaries to identify various drug entities of interest.
Specific medications to be found are specified with <code>drug_names</code>, which
is not case-sensitive or space-sensitive (e.g., &lsquo;lamotrigine XR&rsquo; is treated
the same as &lsquo;lamotrigineXR&rsquo;). Entities to be extracted include drug name, strength,
dose amount, dose, frequency, intake time, route, duration, and time of last dose. See
<code><a href="#topic+extract_entities">extract_entities</a></code> and <code><a href="#topic+extract_lastdose">extract_lastdose</a></code> for more details.
</p>
<p>When searching for medication names of interest, fuzzy matching may be used.
The <code>max_dist</code> argument determines the maximum edit distance allowed for
such matches. If using fuzzy matching, any drug name with less than 5
characters will only allow an edit distance of 1, regardless of the value of
<code>max_dist</code>.
</p>
<p>The purpose of the <code>drug_list</code> argument is to reduce false positives by removing information that is
likely to be related to a competing drug, not our drug of interest, By default, this is &ldquo;rxnorm&rdquo; which
calls <code>data(rxnorm_druglist)</code>. A custom drug list in the form of a character string can be supplied instead,
or can be appended to <code>rxnorm_druglist</code> by specifying <code>drug_list = c("rxnorm", custom_drug_list)</code>.
<code>medExtractR</code> then uses this list to truncate the search window at the first appearance of an unrelated drug name.
This uses publicly available data courtesy of the U.S. National Library of Medicine (NLM), National
Institutes of Health, Department of Health and Human Services; NLM is not responsible for the product and
does not endorse or recommend this or any other product. See <code>rxnorm_druglist</code> documentation for details.
</p>
<p>Most medication entities are searched for in a window after the drug. The
dose change entity, or presence of a keyword to indicate a non-current drug
regimen, may occur before the drug name. The <code>flag_window</code> argument
adjusts the width of the pre-drug window. Both <code>flag_window</code> and <code>dosechange_dict</code>
are not default arguments to the extended function <code><a href="#topic+medExtractR_tapering">medExtractR_tapering</a></code> since that
extension uses a more flexible search window and extraction procedure. In the tapering extension,
entity extraction is more flexible, and any entity can be extracted either before
or after the drug mention. Thus functionality for dose change identification is identical to all
other dictionary-based entities.
</p>
<p>The <code>stength_sep</code> argument is <code>NULL</code> by default, but can be used to
identify shorthand for morning and evening doses. For example, consider the
phrase &lsquo;Lamotrigine 300-200&rsquo; (meaning 300 mg in the morning and 200 mg
in the evening). The argument <code>strength_sep = '-'</code> identifies
the full expression <em>300-200</em> as <em>dose strength</em> in this phrase.
</p>


<h3>Value</h3>

<p>data.frame with entity information. Only extractions from found entities are returned. If no dosing
information for the drug of interest is found, the following output will be returned: <br />
</p>

<table>
<tr>
 <td style="text-align: right;">
entity    </td><td style="text-align: right;">  expr   </td><td style="text-align: right;">    pos</td>
</tr>
<tr>
 <td style="text-align: right;">
NA </td><td style="text-align: right;">  NA </td><td style="text-align: right;">  NA
</td>
</tr>

</table>

<p>The &ldquo;entity&rdquo; column of the output contains the formatted label for that entity, according to
the following mapping.<br />
drug name: &ldquo;DrugName&rdquo;<br />
strength: &ldquo;Strength&rdquo;<br />
dose amount: &ldquo;DoseAmt&rdquo;<br />
dose strength: &ldquo;DoseStrength&rdquo;<br />
frequency: &ldquo;Frequency&rdquo;<br />
intake time: &ldquo;IntakeTime&rdquo;<br />
duration: &ldquo;Duration&rdquo;<br />
route: &ldquo;Route&rdquo;<br />
dose change: &ldquo;DoseChange&rdquo;<br />
time of last dose: &ldquo;LastDose&rdquo;<br />
Sample output:<br />
</p>

<table>
<tr>
 <td style="text-align: right;">
entity    </td><td style="text-align: right;">  expr   </td><td style="text-align: right;">    pos</td>
</tr>
<tr>
 <td style="text-align: right;">
DoseChange</td><td style="text-align: right;">  decrease </td><td style="text-align: right;">  66:74</td>
</tr>
<tr>
 <td style="text-align: right;">
DrugName   </td><td style="text-align: right;"> Prograf </td><td style="text-align: right;">   78:85</td>
</tr>
<tr>
 <td style="text-align: right;">
Strength  </td><td style="text-align: right;">  2 mg   </td><td style="text-align: right;">    86:90</td>
</tr>
<tr>
 <td style="text-align: right;">
DoseAmt   </td><td style="text-align: right;">  1     </td><td style="text-align: right;">     91:92</td>
</tr>
<tr>
 <td style="text-align: right;">
Route   </td><td style="text-align: right;">  by mouth     </td><td style="text-align: right;">     100:108</td>
</tr>
<tr>
 <td style="text-align: right;">
Frequency </td><td style="text-align: right;">  bid    </td><td style="text-align: right;">    109:112</td>
</tr>
<tr>
 <td style="text-align: right;">
LastDose  </td><td style="text-align: right;">  2100    </td><td style="text-align: right;">   129:133
</td>
</tr>

</table>



<h3>References</h3>

<p>Nelson SJ, Zeng K, Kilbourne J, Powell T, Moore R. Normalized names for clinical drugs: RxNorm at 6 years.
J Am Med Inform Assoc. 2011 Jul-Aug;18(4)441-8. doi: 10.1136/amiajnl-2011-000116. Epub 2011 Apr 21.
PubMed PMID: 21515544; PubMed Central PMCID: PMC3128404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
note1 &lt;- "Progrf Oral Capsule 1 mg 3 capsules by mouth twice a day - last
dose at 10pm"
medExtractR(note1, c("prograf", "tacrolimus"), 60, "mg", 2, lastdose=TRUE)
note2 &lt;- "Currently on lamotrigine 150-200, but will increase to lamotrigine 200mg bid"
medExtractR(note2, c("lamotrigine", "ltg"), 130, "mg", 1, strength_sep = "-")

</code></pre>

<hr>
<h2 id='medExtractR_tapering'>Extract Medication Entities From Clinical Note - Extension of <code><a href="#topic+medExtractR">medExtractR</a></code> for Tapering applications</h2><span id='topic+medExtractR_tapering'></span>

<h3>Description</h3>

<p>This function identifies medication entities of interest and returns found
expressions with start and stop positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>medExtractR_tapering(
  note,
  drug_names,
  unit,
  max_dist = 0,
  drug_list = "rxnorm",
  lastdose = FALSE,
  strength_sep = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="medExtractR_tapering_+3A_note">note</code></td>
<td>
<p>Text to search.</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_drug_names">drug_names</code></td>
<td>
<p>Vector of drug names of interest to locate.</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_unit">unit</code></td>
<td>
<p>Strength unit to look for (e.g., &lsquo;mg&rsquo;).</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_max_dist">max_dist</code></td>
<td>
<p>Numeric - edit distance to use when searching for <code>drug_names</code>.</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_drug_list">drug_list</code></td>
<td>
<p>Vector of known drugs that may end search window. By default calls
<code><a href="#topic+rxnorm_druglist">rxnorm_druglist</a></code>. Can be supplemented with expressions in <code><a href="#topic+addl_expr">addl_expr</a></code>.</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_lastdose">lastdose</code></td>
<td>
<p>Logical - whether or not last dose time entity should be extracted. See &lsquo;Details&rsquo;
section below for more information.</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_strength_sep">strength_sep</code></td>
<td>
<p>Delimiter for contiguous medication strengths (e.g., &lsquo;-&rsquo; for &ldquo;LTG 200-300&rdquo;).</p>
</td></tr>
<tr><td><code id="medExtractR_tapering_+3A_...">...</code></td>
<td>
<p>Parameter settings used in dictionary-based entities. For each dictionary-based
entity, the user can supply the optional arguments <code>&lt;entity&gt;_fun</code> and <code>&lt;entity&gt;_dict</code>
to provide custom extraction functions and dictionaries, respectively. If no additional arguments are provided,
<code>medExtractR_tapering</code> will use <code><a href="#topic+extract_generic">extract_generic</a></code> and the default dictionary for each entity.
See <code><a href="#topic+extract_entities_tapering">extract_entities_tapering</a></code> documentation for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses a combination of regular expressions, rule-based
approaches, and dictionaries to identify various drug entities of interest, with a
particular focus on drugs administered with a tapering schedule.
Specific medications to be found are specified with <code>drug_names</code>, which
is not case-sensitive or space-sensitive (e.g., &lsquo;lamotrigine XR&rsquo; is treated
the same as &lsquo;lamotrigineXR&rsquo;). Entities to be extracted include drug name, strength,
dose amount, dose strength, frequency, intake time, route, duration, dose schedule,
time keyword, preposition, transition, dispense amount, refill, and time of last dose.
While it is still an optional entity in <code>medExtractR_tapering</code>, if <code>lastdose=TRUE</code>
then <code>medExtractR_tapering</code> will search for time of last dose in the same search window used for all
other entities. As a result, there is no need for the <code>lastdose_window_ext</code> argument. See
<code><a href="#topic+extract_entities_tapering">extract_entities_tapering</a></code> and <code><a href="#topic+extract_lastdose">extract_lastdose</a></code> for more details.
</p>
<p>When searching for medication names of interest, fuzzy matching may be used.
The <code>max_dist</code> argument determines the maximum edit distance allowed for
such matches. If using fuzzy matching, any drug name with less than 7 characters
will force an exact match, regardless of the value of <code>max_dist</code>. The default value of 7 was
selected based on a set of training notes for the drug prednisone, and differs slightly from the default
values of 5 for <code><a href="#topic+medExtractR">medExtractR</a></code>. The tapering extension does not use the <code>window_length</code> argument
to define the search window, since tapering schedules can be much longer than a static regimens.
Instead, <code>medExtractR_tapering</code> dynamically generates the search window based on competing drug names or
phrases, and the distance between consecutive entities. The <code>stength_sep</code> argument is <code>NULL</code> by
default, and operates in the same manner as it does in <code>medExtractR</code>.
</p>
<p>By default, the <code>drug_list</code> argument is &ldquo;rxnorm&rdquo; which calls <code>data(rxnorm_druglist)</code>.
A custom drug list in the form of a character string can be supplied instead, or can be appended
to <code>rxnorm_druglist</code> by specifying <code>drug_list = c("rxnorm", custom_drug_list)</code>. This uses
publicly available data courtesy of the U.S. National Library of Medicine (NLM), National
Institutes of Health, Department of Health and Human Services; NLM is not responsible for the product and
does not endorse or recommend this or any other product. See <code>rxnorm_druglist</code> documentation for details.
</p>


<h3>Value</h3>

<p>data.frame with entity information. If no dosing
information for the drug of interest is found, the following output will be returned: <br />
</p>

<table>
<tr>
 <td style="text-align: right;">
entity    </td><td style="text-align: right;">  expr   </td><td style="text-align: right;">    pos</td>
</tr>
<tr>
 <td style="text-align: right;">
NA </td><td style="text-align: right;">  NA </td><td style="text-align: right;">  NA
</td>
</tr>

</table>

<p>The &ldquo;entity&rdquo; column of the output contains the formatted label for that entity, according to
the following mapping.<br />
drug name: &ldquo;DrugName&rdquo;<br />
strength: &ldquo;Strength&rdquo;<br />
dose amount: &ldquo;DoseAmt&rdquo;<br />
dose strength: &ldquo;DoseStrength&rdquo;<br />
frequency: &ldquo;Frequency&rdquo;<br />
intake time: &ldquo;IntakeTime&rdquo;<br />
duration: &ldquo;Duration&rdquo;<br />
route: &ldquo;Route&rdquo;<br />
dose change: &ldquo;DoseChange&rdquo;<br />
dose schedule: &ldquo;DoseScheule&rdquo;<br />
time keyword: &ldquo;TimeKeyword&rdquo;<br />
transition: &ldquo;Transition&rdquo;<br />
preposition: &ldquo;Preposition&rdquo;<br />
dispense amount: &ldquo;DispenseAmt&rdquo;<br />
refill: &ldquo;Refill&rdquo;<br />
time of last dose: &ldquo;LastDose&rdquo;<br />
Sample output:<br />
</p>

<table>
<tr>
 <td style="text-align: right;">
entity    </td><td style="text-align: right;">  expr   </td><td style="text-align: right;">    pos</td>
</tr>
<tr>
 <td style="text-align: right;">
DoseChange</td><td style="text-align: right;">  decrease </td><td style="text-align: right;">  66:74</td>
</tr>
<tr>
 <td style="text-align: right;">
DrugName   </td><td style="text-align: right;"> Prograf </td><td style="text-align: right;">   78:85</td>
</tr>
<tr>
 <td style="text-align: right;">
Strength  </td><td style="text-align: right;">  2 mg   </td><td style="text-align: right;">    86:90</td>
</tr>
<tr>
 <td style="text-align: right;">
DoseAmt   </td><td style="text-align: right;">  1     </td><td style="text-align: right;">     91:92</td>
</tr>
<tr>
 <td style="text-align: right;">
Frequency </td><td style="text-align: right;">  bid    </td><td style="text-align: right;">    101:104</td>
</tr>
<tr>
 <td style="text-align: right;">
LastDose  </td><td style="text-align: right;">  2100    </td><td style="text-align: right;">   121:125
</td>
</tr>

</table>



<h3>References</h3>

<p>Nelson SJ, Zeng K, Kilbourne J, Powell T, Moore R. Normalized names for clinical drugs: RxNorm at 6 years.
J Am Med Inform Assoc. 2011 Jul-Aug;18(4)441-8. doi: 10.1136/amiajnl-2011-000116. Epub 2011 Apr 21.
PubMed PMID: 21515544; PubMed Central PMCID: PMC3128404.
</p>

<hr>
<h2 id='preposition_vals'>Keywords Specifying Preposition</h2><span id='topic+preposition_vals'></span>

<h3>Description</h3>

<p>A dictionary with preposition expressions. Such expressions often represent
a relationship with an adjacent entity. Since most expressions in this
dictionary are very short, we require word boundaries (any character other
than a letter or number) to appear on either side of the expression. Example
expressions include &quot;for&quot;, &quot;to&quot;, &quot;until&quot;, and &quot;in&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preposition_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with preposition expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as preposition.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(preposition_vals)
</code></pre>

<hr>
<h2 id='replace_tab'>String Replace Tablet With Tabs</h2><span id='topic+replace_tab'></span>

<h3>Description</h3>

<p>This function standardizes various forms of &ldquo;tablet&rdquo; or
&ldquo;capsule&rdquo; with the string &ldquo;tabs&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>replace_tab(phrase)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="replace_tab_+3A_phrase">phrase</code></td>
<td>
<p>Text to search.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some entities use a keyword such as tablet, capsule, or pill to
identify the entities, e.g. dose amount. This standardizes possible
expressions of similar keywords.
</p>


<h3>Value</h3>

<p>Updated phrase.
</p>

<hr>
<h2 id='route_vals'>Keywords Specifying Route</h2><span id='topic+route_vals'></span>

<h3>Description</h3>

<p>A dictionary mapping route expressions to standardized forms, specifying the
way in which a medication is administered. Example expressions include &quot;oral&quot;,
&quot;topical&quot;, &quot;IV&quot;, and &quot;intravenous&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>route_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with route expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as route.</p>
</dd>
<dt>value</dt><dd><p>A standardized version of the raw expression. For example,
&quot;orally&quot; and &quot;by mouth&quot; both have the standardized form &quot;orally&quot;.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(route_vals)
</code></pre>

<hr>
<h2 id='rxnorm_druglist'>List of Medications</h2><span id='topic+rxnorm_druglist'></span>

<h3>Description</h3>

<p>A dictionary that contains a vector of medication names, primarily derived from RxNorm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rxnorm_druglist
</code></pre>


<h3>Format</h3>

<p>A vector with character strings for competing drug names.
</p>


<h3>Details</h3>

<p>RxNorm is provided by the U.S. National Library of Medicine. This dictionary
uses the February 1, 2021 RxNorm files directly downloaded from
<a href="https://www.nlm.nih.gov/research/umls/rxnorm/docs/rxnormfiles.html">https://www.nlm.nih.gov/research/umls/rxnorm/docs/rxnormfiles.html</a>.
</p>
<p>This list contains ingredient and brand names, cleaned to remove expressions that likely
are ambiguous (e.g., &lsquo;today&rsquo; or &lsquo;date&rsquo;). This product uses publicly available data courtesy of the U.S.
National Library of Medicine (NLM), National Institutes of Health, Department of Health and Human
Services; NLM is not responsible for the product and does not endorse or recommend this or any other product.
</p>


<h3>References</h3>

<p>Nelson SJ, Zeng K, Kilbourne J, Powell T, Moore R. Normalized names for clinical drugs: RxNorm at 6 years.
J Am Med Inform Assoc. 2011 Jul-Aug;18(4)441-8. doi: 10.1136/amiajnl-2011-000116. Epub 2011 Apr 21.
PubMed PMID: 21515544; PubMed Central PMCID: PMC3128404.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rxnorm_druglist)
</code></pre>

<hr>
<h2 id='string_counts'>Counts Strings in Text</h2><span id='topic+string_counts'></span>

<h3>Description</h3>

<p>This function counts occurrences of text within one or more phrases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>string_counts(strings, search_data, ignore.case = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string_counts_+3A_strings">strings</code></td>
<td>
<p>character vector; value(s) to find</p>
</td></tr>
<tr><td><code id="string_counts_+3A_search_data">search_data</code></td>
<td>
<p>character vector; phrase(s) where values may exist</p>
</td></tr>
<tr><td><code id="string_counts_+3A_ignore.case">ignore.case</code></td>
<td>
<p>logical; indicates if spelling case matters, defaulting to &lsquo;TRUE&rsquo;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two elements; &lsquo;cntByTotal&rsquo; contains total occurrences
and &lsquo;cntByData&rsquo; contains occurrences for each element in &lsquo;search_data&rsquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>note1 &lt;- "I am the very model of a modern major general
I've information vegetable, animal, and mineral
I know the kings of England, and I quote the fights historical
From marathon to Waterloo in order categorical;
I'm very well acquainted, too, with matters mathematical,
I understand equations both the simple and quadratical
About binomial theorem I'm teeming with a lot o' news,
With many cheerful facts about the square of the hypotenuse"
note2 &lt;- "The quick brown fox jumps over the lazy dog"
string_counts(c('I','the','couth'), c(note1, note2))
</code></pre>

<hr>
<h2 id='string_occurs'>Find Strings in Text</h2><span id='topic+string_occurs'></span>

<h3>Description</h3>

<p>This function searches for text within one or more phrases. Text to look for will be grouped
into values that are found and not found.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>string_occurs(dict_list, haystack, ignore.case = TRUE, nClust = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string_occurs_+3A_dict_list">dict_list</code></td>
<td>
<p>character vector; value(s) to find</p>
</td></tr>
<tr><td><code id="string_occurs_+3A_haystack">haystack</code></td>
<td>
<p>character vector; phrase(s) where values may exist</p>
</td></tr>
<tr><td><code id="string_occurs_+3A_ignore.case">ignore.case</code></td>
<td>
<p>logical; indicates if spelling case matters, defaulting to &lsquo;TRUE&rsquo;</p>
</td></tr>
<tr><td><code id="string_occurs_+3A_nclust">nClust</code></td>
<td>
<p>Number of CPU cores to use, if available. This requires the &lsquo;parallel&rsquo;
package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with two elements, &lsquo;TRUE&rsquo; and &lsquo;FALSE&rsquo;, representing values
that are found or not found within the phrase to search.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>note1 &lt;- "I am the very model of a modern major general
I've information vegetable, animal, and mineral
I know the kings of England, and I quote the fights historical
From marathon to Waterloo in order categorical;
I'm very well acquainted, too, with matters mathematical,
I understand equations both the simple and quadratical
About binomial theorem I'm teeming with a lot o' news,
With many cheerful facts about the square of the hypotenuse"
note2 &lt;- "The quick brown fox jumps over the lazy dog"
string_occurs(c('kings','quick','couth','brown'), c(note1, note2))
</code></pre>

<hr>
<h2 id='string_suggestions'>Find Strings and Suggest Misspellings</h2><span id='topic+string_suggestions'></span>

<h3>Description</h3>

<p>This function searches for text within one or more phrases, and looks
for partial matches. An exact match of the text should be found in order
for a suggestion to made.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>string_suggestions(strings, search_data, max_dist = 2, ignore.case = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="string_suggestions_+3A_strings">strings</code></td>
<td>
<p>character vector; value(s) to find</p>
</td></tr>
<tr><td><code id="string_suggestions_+3A_search_data">search_data</code></td>
<td>
<p>character vector; phrase(s) where values may exist</p>
</td></tr>
<tr><td><code id="string_suggestions_+3A_max_dist">max_dist</code></td>
<td>
<p>numeric; edit distance to use for partial matches. The default value is 2.</p>
</td></tr>
<tr><td><code id="string_suggestions_+3A_ignore.case">ignore.case</code></td>
<td>
<p>logical; indicates if spelling case matters, defaulting to &lsquo;TRUE&rsquo;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with two columns, &lsquo;suggestion&rsquo; and &lsquo;match&rsquo;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>string_suggestions('penicillin', 'penicillan, penicillin, or penicilin?')
</code></pre>

<hr>
<h2 id='strings-internal'>Internal String Functions</h2><span id='topic+strings-internal'></span><span id='topic+stringPlaceExact'></span><span id='topic+stringPlaceFuzzy'></span><span id='topic+stringPlace'></span><span id='topic+checkFuzzy'></span>

<h3>Description</h3>

<p>codestringPlaceExact: find location of string, using exact match
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stringPlaceExact(needle, haystack, ignore.case = TRUE)
</code></pre>


<h3>Details</h3>

<p>codestringPlaceFuzzy: find location of string, using partial match
</p>
<p>codestringPlace: find location of string, generic
</p>
<p>codecheckFuzzy: check for &quot;close&quot; string matches
</p>

<hr>
<h2 id='time_regex'>Keywords Specifying Time Expressions</h2><span id='topic+time_regex'></span>

<h3>Description</h3>

<p>A vector of regular expressions to identify different forms of time
expressions for last dose time. These are the default values used in <code>link{extract_lastdose}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_regex
</code></pre>


<h3>Format</h3>

<p>A vector with 5 regular expressions for the following categories.
</p>

<dl>
<dt>am/pm</dt><dd><p>Time is indicated by the presence of &lsquo;am&rsquo; or
&lsquo;pm&rsquo; following a numeric expression.</p>
</dd>
<dt>military</dt><dd><p>Time is given in military time, for unambiguous times of
13:00-23:59.</p>
</dd>
<dt>qualifier_after</dt><dd><p>Am/pm indication is implicit through a qualifying
term like &lsquo;last night&rsquo; or &lsquo;this morning&rsquo;. The qualifier
occurs after the time, e.g., &lsquo;10 last night.&rsquo;</p>
</dd>
<dt>qualifier_before</dt><dd><p>Am/pm indication is implicit through a qualifying
term like &lsquo;last night&rsquo; or &lsquo;this morning&rsquo;. The qualifier
occurs before the time, e.g., &lsquo;last night at 10.&rsquo;</p>
</dd>
<dt>duration</dt><dd><p>Time (in hours) between the last dose and most recent lab
value</p>
</dd>
</dl>



<h3>Details</h3>

<p>Certain expressions which might be considered ambiguous are excluded from
the regular expressions presented here. For instance, expressions such as
&lsquo;600&rsquo; could refer to either 6am or 6pm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(time_regex)
</code></pre>

<hr>
<h2 id='timekeyword_vals'>Keywords Specifying Time Keyword</h2><span id='topic+timekeyword_vals'></span>

<h3>Description</h3>

<p>A dictionary with time keyword expressions representing whether the dosing regimen is
past, current, or future. Example expressions include &quot;currently&quot;, &quot;remain&quot;,&quot;not taking&quot;,
&quot;yesterday&quot;, and &quot;past&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timekeyword_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with time keyword expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as time keyword.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(timekeyword_vals)
</code></pre>

<hr>
<h2 id='transition_vals'>Keywords/Symbols Specifying Transition</h2><span id='topic+transition_vals'></span>

<h3>Description</h3>

<p>A dictionary with transition symbols and expressions representing a break between consecutive
doses within a tapering regimen. This dictionary includes the expressions &quot;then&quot; and
&quot;followed by&quot;, as well as the punctuation &quot;,(?!\\s?then)&quot; or &quot;;(?!\\s?then)&quot; (i.e., a
comma or semicolon not followed by the word &quot;then&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transition_vals
</code></pre>


<h3>Format</h3>

<p>A data frame with transition expressions (exact and/or regular expressions).
</p>

<dl>
<dt>expr</dt><dd><p>A character vector, expressions to consider as transitions.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(transition_vals)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
