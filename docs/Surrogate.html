<!DOCTYPE html><html><head><title>Help for package Surrogate</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Surrogate}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AA.MultS'><p>Compute the multiple-surrogate adjusted association</p></a></li>
<li><a href='#ARMD'>
<p>Data of the Age-Related Macular Degeneration Study</p></a></li>
<li><a href='#ARMD.MultS'>
<p>Data of the Age-Related Macular Degeneration Study with multiple candidate surrogates</p></a></li>
<li><a href='#BifixedContCont'><p>Fits a bivariate fixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case)</p></a></li>
<li><a href='#BimixedCbCContCont'>
<p>Fits a bivariate mixed-effects model using the cluster-by-cluster (CbC) estimator to assess surrogacy in the meta-analytic multiple-trial setting  (Continuous-continuous case)</p></a></li>
<li><a href='#BimixedContCont'>
<p>Fits a bivariate mixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting</p>
(Continuous-continuous case)</a></li>
<li><a href='#binary_continuous_loglik'><p>Loglikelihood function for binary-continuous copula model</p></a></li>
<li><a href='#Bootstrap.MEP.BinBin'>
<p>Bootstrap 95% CI around the maximum-entropy ICA and SPF (surrogate predictive function)</p></a></li>
<li><a href='#CausalDiagramBinBin'>
<p>Draws a causal diagram depicting the median informational coefficients of correlation (or odds ratios) between the counterfactuals for a specified range of values of the ICA in the binary-binary setting.</p></a></li>
<li><a href='#CausalDiagramContCont'>
<p>Draws a causal diagram depicting the median correlations between the counterfactuals for a specified range of values of ICA or MICA in the continuous-continuous setting</p></a></li>
<li><a href='#cdf_fun'><p>Function factory for distribution functions</p></a></li>
<li><a href='#clayton_loglik_copula_scale'><p>Loglikelihood on the Copula Scale for the Clayton Copula</p></a></li>
<li><a href='#colorectal'><p>The Colorectal dataset with a binary surrogate.</p></a></li>
<li><a href='#colorectal4'><p>The Colorectal dataset with an ordinal surrogate.</p></a></li>
<li><a href='#comb27.BinBin'><p>Assesses the surrogate predictive value of each of the 27 prediction functions in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#compute_ICA_BinCont'><p>Compute Individual Causal Association for a given D-vine copula model in the</p>
Binary-Continuous Setting</a></li>
<li><a href='#compute_ICA_SurvSurv'><p>Compute Individual Causal Association for a given D-vine copula model in the</p>
Survival-Survival Setting</a></li>
<li><a href='#delta_method_log_mutinfo'><p>Variance of log-mutual information based on the delta method</p></a></li>
<li><a href='#Dvine_ICA_confint'><p>Confidence interval for the ICA given the unidentifiable parameters</p></a></li>
<li><a href='#ECT'><p>Apply the Entropy Concentration Theorem</p></a></li>
<li><a href='#estimate_ICA_BinCont'><p>Estimate ICA in Binary-Continuous Setting</p></a></li>
<li><a href='#estimate_mutual_information_SurvSurv'><p>Estimate the Mutual Information in the Survival-Survival Setting</p></a></li>
<li><a href='#Fano.BinBin'><p>Evaluate the possibility of finding a good surrogate in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#fit_copula_model_BinCont'><p>Fit copula model for binary true endpoint and continuous surrogate endpoint</p></a></li>
<li><a href='#fit_copula_submodel_BinCont'><p>Fit binary-continuous copula submodel</p></a></li>
<li><a href='#fit_model_SurvSurv'><p>Fit Survival-Survival model</p></a></li>
<li><a href='#FixedBinBinIT'><p>Fits (univariate) fixed-effect models to assess surrogacy in the binary-binary case based on the Information-Theoretic framework</p></a></li>
<li><a href='#FixedBinContIT'><p>Fits (univariate) fixed-effect models to assess surrogacy in the case where the true endpoint is binary and the surrogate endpoint is continuous (based on the Information-Theoretic framework)</p></a></li>
<li><a href='#FixedContBinIT'><p>Fits (univariate) fixed-effect models to assess surrogacy in the case where the true endpoint is continuous and the surrogate endpoint is binary (based on the Information-Theoretic framework)</p></a></li>
<li><a href='#FixedContContIT'><p>Fits (univariate) fixed-effect models to assess surrogacy in the continuous-continuous case based on the Information-Theoretic framework</p></a></li>
<li><a href='#FixedDiscrDiscrIT'><p>Investigates surrogacy for binary or ordinal outcomes using the Information Theoretic framework</p></a></li>
<li><a href='#frank_loglik_copula_scale'><p>Loglikelihood on the Copula Scale for the Frank Copula</p></a></li>
<li><a href='#gaussian_loglik_copula_scale'><p>Loglikelihood on the Copula Scale for the Gaussian Copula</p></a></li>
<li><a href='#gumbel_loglik_copula_scale'><p>Loglikelihood on the Copula Scale for the Gumbel Copula</p></a></li>
<li><a href='#ICA_given_model_constructor'><p>Constructor for the function that returns that ICA as a function of the</p>
identifiable parameters</a></li>
<li><a href='#ICA.BinBin'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case</p></a></li>
<li><a href='#ICA.BinBin.CounterAssum'><p>ICA (binary-binary setting) that is obtaied when the counterfactual correlations are assumed to fall within some prespecified ranges.</p></a></li>
<li><a href='#ICA.BinBin.Grid.Full'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the full grid-based approach</p></a></li>
<li><a href='#ICA.BinBin.Grid.Sample'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the grid-based sample approach</p></a></li>
<li><a href='#ICA.BinBin.Grid.Sample.Uncert'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the grid-based sample approach, accounting for sampling variability in the marginal <code class="reqn">\pi</code>.</p></a></li>
<li><a href='#ICA.BinCont'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-continuous case</p></a></li>
<li><a href='#ICA.BinCont.BS'><p>Assess surrogacy in the causal-inference single-trial setting in the binary-continuous case with an additional bootstrap procedure before the assessment</p></a></li>
<li><a href='#ICA.ContCont'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) in the Continuous-continuous case</p></a></li>
<li><a href='#ICA.ContCont.MultS'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S</p></a></li>
<li><a href='#ICA.ContCont.MultS_alt'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, alternative approach</p></a></li>
<li><a href='#ICA.ContCont.MultS.MPC'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, by simulating correlation matrices using a modified algorithm based on partial correlations</p></a></li>
<li><a href='#ICA.ContCont.MultS.PC'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, by simulating correlation matrices using an algorithm based on partial correlations</p></a></li>
<li><a href='#ICA.Sample.ContCont'><p>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) in the Continuous-continuous case using the grid-based sample approach</p></a></li>
<li><a href='#ISTE.ContCont'><p>Individual-level surrogate threshold effect for continuous normally distributed surrogate and true endpoints.</p></a></li>
<li><a href='#log_likelihood_copula_model'><p>Computes loglikelihood for a given copula model</p></a></li>
<li><a href='#loglik_copula_scale'><p>Loglikelihood on the Copula Scale</p></a></li>
<li><a href='#LongToWide'>
<p>Reshapes a dataset from the 'long' format (i.e., multiple lines per patient) into the 'wide' format (i.e., one line per patient)</p></a></li>
<li><a href='#marginal_distribution'><p>Fit marginal distribution</p></a></li>
<li><a href='#marginal_gof_plots_scr'><p>Marginal survival function goodness of fit</p></a></li>
<li><a href='#marginal_gof_scr_S_plot'><p>Goodness-of-fit plot for the marginal survival functions</p></a></li>
<li><a href='#MarginalProbs'><p>Computes marginal probabilities for a dataset where the surrogate and true endpoints are binary</p></a></li>
<li><a href='#MaxEntContCont'>
<p>Use the maximum-entropy approach to compute ICA in the continuous-continuous sinlge-trial setting</p></a></li>
<li><a href='#MaxEntICABinBin'>
<p>Use the maximum-entropy approach to compute ICA in the binary-binary setting</p></a></li>
<li><a href='#MaxEntSPFBinBin'>
<p>Use the maximum-entropy approach to compute SPF (surrogate predictive function) in the binary-binary setting</p></a></li>
<li><a href='#mean_S_before_T_plot_scr'><p>Goodness of fit plot for the fitted copula</p></a></li>
<li><a href='#MICA.ContCont'><p>Assess surrogacy in the causal-inference multiple-trial setting (Meta-analytic Individual Causal Association; MICA) in the continuous-continuous case</p></a></li>
<li><a href='#MICA.Sample.ContCont'><p>Assess surrogacy in the causal-inference multiple-trial setting (Meta-analytic Individual Causal Association; MICA) in the continuous-continuous case using the grid-based sample approach</p></a></li>
<li><a href='#MinSurrContCont'><p>Examine the plausibility of finding a good surrogate endpoint in the Continuous-continuous case</p></a></li>
<li><a href='#MixedContContIT'><p>Fits (univariate) mixed-effect models to assess surrogacy in the continuous-continuous case based on the Information-Theoretic framework</p></a></li>
<li><a href='#model_fit_measures'><p>Goodness of fit information for survival-survival model</p></a></li>
<li><a href='#MufixedContCont.MultS'><p>Fits a multivariate fixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case with multiple surrogates)</p></a></li>
<li><a href='#MumixedContCont.MultS'><p>Fits a multivariate mixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case with multiple surrogates)</p></a></li>
<li><a href='#new_vine_copula_ss_fit'><p>Constructor for vine copula model</p></a></li>
<li><a href='#Ovarian'><p>The Ovarian dataset</p></a></li>
<li><a href='#PANSS'>
<p>PANSS subscales and total score based on the data of five clinical trials in schizophrenia</p></a></li>
<li><a href='#pdf_fun'><p>Function factory for density functions</p></a></li>
<li><a href='#plot Causal-Inference BinBin'>
<p>Plots the (Meta-Analytic) Individual Causal Association and related metrics when S and T are binary outcomes</p></a></li>
<li><a href='#plot Causal-Inference BinCont'><p>Plots the (Meta-Analytic) Individual Causal Association and related metrics when S is continuous and T is binary</p></a></li>
<li><a href='#plot Causal-Inference ContCont'>
<p>Plots the (Meta-Analytic) Individual Causal Association when S and T are continuous outcomes</p></a></li>
<li><a href='#plot FixedDiscrDiscrIT'><p>Provides plots of trial-level surrogacy in the Information-Theoretic framework</p></a></li>
<li><a href='#plot ICA.ContCont.MultS'>
<p>Plots the Individual Causal Association in the setting where there are multiple continuous S and a continuous T</p></a></li>
<li><a href='#plot Information-Theoretic'><p>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework</p></a></li>
<li><a href='#plot Information-Theoretic BinCombn'><p>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework when both S and T are binary, or when S is binary and T is continuous (or vice versa)</p></a></li>
<li><a href='#plot ISTE.ContCont'>
<p>Plots the individual-level surrogate threshold effect (STE) values and related metrics</p></a></li>
<li><a href='#plot MaxEnt ContCont'>
<p>Plots the sensitivity-based and maximum entropy based Individual Causal Association when S and T are continuous outcomes in the single-trial setting</p></a></li>
<li><a href='#plot MaxEntICA BinBin'>
<p>Plots the sensitivity-based and maximum entropy based Individual Causal Association when S and T are binary outcomes</p></a></li>
<li><a href='#plot MaxEntSPF BinBin'>
<p>Plots the sensitivity-based and maximum entropy based surrogate predictive function (SPF) when S and T are binary outcomes.</p></a></li>
<li><a href='#plot Meta-Analytic'><p>Provides plots of trial- and individual-level surrogacy in the meta-analytic framework</p></a></li>
<li><a href='#plot MinSurrContCont'>
<p>Graphically illustrates the theoretical plausibility of finding a good surrogate endpoint in the continuous-continuous case</p></a></li>
<li><a href='#plot PredTrialTContCont'>
<p>Plots the expected treatment effect on the true endpoint in a new trial (when both S and T are normally distributed continuous endpoints)</p></a></li>
<li><a href='#plot SPF BinBin'>
<p>Plots the surrogate predictive function (SPF) in the binary-binary settinf.</p></a></li>
<li><a href='#plot SPF BinCont'>
<p>Plots the surrogate predictive function (SPF) in the binary-continuous setting.</p></a></li>
<li><a href='#plot TrialLevelIT'><p>Provides a plots of trial-level surrogacy in the information-theoretic framework based on the output of the <code>TrialLevelIT()</code> function</p></a></li>
<li><a href='#plot TrialLevelMA'><p>Provides a plots of trial-level surrogacy in the meta-analytic framework based on the output of the <code>TrialLevelMA()</code> function</p></a></li>
<li><a href='#plot TwoStageSurvSurv'><p>Plots trial-level surrogacy in the meta-analytic framework when two survival endpoints are considered.</p></a></li>
<li><a href='#plot.comb27.BinBin'><p>Plots the distribution of prediction error functions in decreasing order of appearance.</p></a></li>
<li><a href='#plot.Fano.BinBin'><p>Plots the distribution of <code class="reqn">R^2_{HL}</code> either as a density or as function of <code class="reqn">\pi_{10}</code> in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#plot.PPE.BinBin'><p>Plots the distribution of either <code class="reqn">PPE</code>, <code class="reqn">RPE</code> or <code class="reqn">R^2_{H}</code> either as a density or as a histogram in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#plot.survbin'><p>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survbin()' function.</p></a></li>
<li><a href='#plot.survcat'><p>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survcat()' function.</p></a></li>
<li><a href='#plot.SurvSurv'><p>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework when both S and T are time-to-event endpoints</p></a></li>
<li><a href='#Pos.Def.Matrices'><p>Generate 4 by 4 correlation matrices and flag the positive definite ones</p></a></li>
<li><a href='#PPE.BinBin'><p>Evaluate a surrogate predictive value based on the minimum probability of a prediction error in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#Pred.TrialT.ContCont'>
<p>Compute the expected treatment effect on the true endpoint in a new trial (when both S and T are normally distributed continuous endpoints)</p></a></li>
<li><a href='#Prentice'><p>Evaluates surrogacy based on the Prentice criteria for continuous endpoints (single-trial setting)</p></a></li>
<li><a href='#print.survbin'><p>Prints all the elements of an object fitted with the 'survbin()' function.</p></a></li>
<li><a href='#print.survcat'><p>Prints all the elements of an object fitted with the 'survcat()' function.</p></a></li>
<li><a href='#PROC.BinBin'><p>Evaluate the individual causal association (ICA) and reduction in probability of a prediction error (RPE) in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</p></a></li>
<li><a href='#RandVec'>
<p>Generate random vectors with a fixed sum</p></a></li>
<li><a href='#Restrictions.BinBin'><p>Examine restrictions in <code class="reqn">\bold{\pi}_{f}</code> under different montonicity assumptions for binary <code class="reqn">S</code> and <code class="reqn">T</code></p></a></li>
<li><a href='#sample_copula_parameters'><p>Sample Unidentifiable Copula Parameters</p></a></li>
<li><a href='#sample_deltas_BinCont'><p>Sample individual casual treatment effects from given D-vine copula model in</p>
binary continuous setting</a></li>
<li><a href='#sample_dvine'><p>Sample copula data from a given four-dimensional D-vine copula</p></a></li>
<li><a href='#Schizo'>
<p>Data of five clinical trials in schizophrenia</p></a></li>
<li><a href='#Schizo_Bin'>
<p>Data of a clinical trial in Schizophrenia (with binary outcomes).</p></a></li>
<li><a href='#Schizo_BinCont'>
<p>Data of a clinical trial in schizophrenia, with binary and continuous endpoints</p></a></li>
<li><a href='#Schizo_PANSS'>
<p>Longitudinal PANSS data of five clinical trials in schizophrenia</p></a></li>
<li><a href='#sensitivity_analysis_BinCont_copula'><p>Perform Sensitivity Analysis for the Individual Causal Association with a</p>
Continuous Surrogate and Binary True Endpoint</a></li>
<li><a href='#sensitivity_analysis_SurvSurv_copula'><p>Sensitivity analysis for individual causal association</p></a></li>
<li><a href='#sensitivity_intervals_Dvine'><p>Compute Sensitivity Intervals</p></a></li>
<li><a href='#Sim.Data.Counterfactuals'><p>Simulate a dataset that contains counterfactuals</p></a></li>
<li><a href='#Sim.Data.CounterfactualsBinBin'><p>Simulate a dataset that contains counterfactuals for binary endpoints</p></a></li>
<li><a href='#Sim.Data.MTS'><p>Simulates a dataset that can be used to assess surrogacy in the multiple-trial setting</p></a></li>
<li><a href='#Sim.Data.STS'><p>Simulates a dataset that can be used to assess surrogacy in the single-trial setting</p></a></li>
<li><a href='#Sim.Data.STSBinBin'><p>Simulates a dataset that can be used to assess surrogacy in the single trial setting when S and T are binary endpoints</p></a></li>
<li><a href='#Single.Trial.RE.AA'><p>Conducts a surrogacy analysis based on the single-trial meta-analytic framework</p></a></li>
<li><a href='#SPF.BinBin'>
<p>Evaluate the surrogate predictive function (SPF) in the binary-binary setting (sensitivity-analysis based approach)</p></a></li>
<li><a href='#SPF.BinCont'>
<p>Evaluate the surrogate predictive function (SPF) in the binary-continuous setting (sensitivity-analysis based approach)</p></a></li>
<li><a href='#summary'><p>Summary</p></a></li>
<li><a href='#summary_level_bootstrap_ICA'><p>Bootstrap based on the multivariate normal sampling distribution</p></a></li>
<li><a href='#summary.survbin'><p>Provides a summary of the surrogacy measures for an object fitted with the 'survbin()' function.</p></a></li>
<li><a href='#summary.survcat'><p>Provides a summary of the surrogacy measures for an object fitted with the 'survcat()' function.</p></a></li>
<li><a href='#survbin'><p>Compute surrogacy measures for a binary surrogate and a time-to-event true endpoint in the meta-analytic multiple-trial setting.</p></a></li>
<li><a href='#survcat'><p>Compute surrogacy measures for a categorical (ordinal) surrogate and a time-to-event true endpoint in the meta-analytic multiple-trial setting.</p></a></li>
<li><a href='#SurvSurv'><p>Assess surrogacy for two survival endpoints based on information theory and a two-stage approach</p></a></li>
<li><a href='#Test.Mono'>
<p>Test whether the data are compatible with monotonicity for S and/or T (binary endpoints)</p></a></li>
<li><a href='#TrialLevelIT'><p>Estimates trial-level surrogacy in the information-theoretic framework</p></a></li>
<li><a href='#TrialLevelMA'><p>Estimates trial-level surrogacy in the meta-analytic framework</p></a></li>
<li><a href='#TwoStageSurvSurv'><p>Assess trial-level surrogacy for two survival endpoints using a two-stage approach</p></a></li>
<li><a href='#twostep_BinCont'><p>Fit binary-continuous copula submodel with two-step estimator</p></a></li>
<li><a href='#twostep_SurvSurv'><p>Fit survival-survival copula submodel with two-step estimator</p></a></li>
<li><a href='#UnifixedContCont'><p>Fits univariate fixed-effect models to assess surrogacy in the meta-analytic multiple-trial setting (continuous-continuous case)</p></a></li>
<li><a href='#UnimixedContCont'>
<p>Fits univariate mixed-effect models to assess surrogacy in the meta-analytic multiple-trial setting</p>
(continuous-continuous case)</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Evaluation of Surrogate Endpoints in Clinical Trials</td>
</tr>
<tr>
<td>Version:</td>
<td>3.2.5</td>
</tr>
<tr>
<td>Description:</td>
<td>In a clinical trial, it frequently occurs that the most credible 
  outcome to evaluate the effectiveness of a new therapy (the true endpoint) is 
  difficult to measure. In such a situation, it can be an effective strategy to 
  replace the true endpoint by a (bio)marker that is easier to measure and that 
  allows for a prediction of the treatment effect on the true endpoint (a 
  surrogate endpoint). The package 'Surrogate' allows for an evaluation of the 
  appropriateness of a candidate surrogate endpoint based on the meta-analytic, 
  information-theoretic, and causal-inference frameworks. Part of this software
  has been developed using funding provided from the European Union's Seventh 
  Framework Programme for research, technological development and demonstration 
  (Grant Agreement no 602552), the Special Research Fund (BOF) of Hasselt 
  University (BOF-number: BOF2OCPO3), GlaxoSmithKline Biologicals, Baekeland 
  Mandaat (HBC.2022.0145), and Johnson &amp; Johnson Innovative Medicine. </td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, lattice, latticeExtra, survival, nlme, lme4, msm,
logistf, rms, ks, extraDistr, pbapply, flexsurv, rvinecopulib,
maxLik, purrr, MBESS, tidyr,dplyr, numDeriv, optimx, tibble</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>copula, FNN, mgcv, testthat (&ge; 3.0.0), vdiffr, parallel,
fitdistrplus, kdecopula, cubature, mvtnorm, withr, stringr,
ggplot2</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/florianstijven/Surrogate-development">https://github.com/florianstijven/Surrogate-development</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/florianstijven/Surrogate-development/issues">https://github.com/florianstijven/Surrogate-development/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-19 13:37:01 UTC; u0157247</td>
</tr>
<tr>
<td>Author:</td>
<td>Wim Van Der Elst [cre, aut],
  Florian Stijven [aut],
  Fenny Ong [aut],
  Paul Meyvisch [aut],
  Alvaro Poveda [aut],
  Ariel Alonso [aut],
  Hannah Ensor [aut],
  Christoper Weir [aut],
  Geert Molenberghs [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wim Van Der Elst &lt;wim.vanderelst@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-19 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AA.MultS'>Compute the multiple-surrogate adjusted association</h2><span id='topic+AA.MultS'></span>

<h3>Description</h3>

<p>The function <code>AA.MultS</code> computes the multiple-surrogate adjusted correlation. This is a generalisation of the adjusted association proposed by Buyse &amp; Molenberghs (1998) (see <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>) to the setting where there are multiple endpoints. See <b>Details</b> below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AA.MultS(Sigma_gamma, N, Alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AA.MultS_+3A_sigma_gamma">Sigma_gamma</code></td>
<td>
<p>The variance covariance matrix of the residuals of regression models in which the true endpoint (<code class="reqn">T</code>) is regressed on the treatment (<code class="reqn">Z</code>), the first surrogate (<code class="reqn">S1</code>) is regressed on <code class="reqn">Z</code>, ..., and the <code class="reqn">k</code>-th surrogate (<code class="reqn">Sk</code>) is regressed on <code class="reqn">Z</code>. See <b>Details</b> below.</p>
</td></tr>
<tr><td><code id="AA.MultS_+3A_n">N</code></td>
<td>
<p>The sample size (needed to compute a CI around the multiple adjusted association; <code class="reqn">\gamma_M</code>)</p>
</td></tr>
<tr><td><code id="AA.MultS_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence interval around <code class="reqn">\gamma_M</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The multiple-surrogate adjusted association (<code class="reqn">\gamma_M</code>) is obtained by regressing <code class="reqn">T</code>, <code class="reqn">S1</code>, <code class="reqn">S2</code>, ..., <code class="reqn">Sk</code> on the treatment (<code class="reqn">Z</code>):
</p>
<p style="text-align: center;"><code class="reqn">T_{j}=\mu_{T}+\beta Z_{j}+\varepsilon_{Tj},</code>
</p>

<p style="text-align: center;"><code class="reqn">S1_{j}=\mu_{S1}+\alpha_{1}Z_{j}+\varepsilon_{S1j},</code>
</p>

<p style="text-align: center;"><code class="reqn">\ldots,</code>
</p>

<p style="text-align: center;"><code class="reqn">Sk_{j}=\mu_{Sk}+\alpha_{k}Z_{j}+\varepsilon_{Skj},</code>
</p>

<p>where the error terms have a joint zero-mean normal distribution with variance-covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">{\boldsymbol{\Sigma}=\left(\begin{array}{cc}
\sigma_{TT} &amp; \Sigma_{\boldsymbol{S}T}\\
\Sigma^{'}_{\boldsymbol{S}T} &amp; \Sigma_{\boldsymbol{SS}} \\
\end{array}\right).}</code>
</p>

<p>The multiple adjusted association is then computed as
</p>
<p style="text-align: center;"><code class="reqn">\gamma_M = \sqrt(\frac{\left(\Sigma^{'}_{ST} \Sigma^{-1}_{SS} \Sigma_{ST}\right)}{\sigma_{TT}})</code>
</p>



<h3>Value</h3>

<p>An object of class <code>AA.MultS</code> with components,
</p>
<table>
<tr><td><code>Gamma.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the multiple-surrogate adjusted association (i.e., <code class="reqn">\gamma_M</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td></tr> 
<tr><td><code>Corr.Gamma.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the bias-corrected multiple-surrogate adjusted association (i.e., corrected <code class="reqn">\gamma_M</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td></tr> 
<tr><td><code>Sigma_gamma</code></td>
<td>
<p>The variance covariance matrix of the residuals of regression models in which <code class="reqn">T</code> is regressed on <code class="reqn">Z</code>, <code class="reqn">S1</code> is regressed on <code class="reqn">Z</code>, ..., and <code class="reqn">Sk</code> is regressed on <code class="reqn">Z</code>.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>The sample size (used to compute a CI around the multiple adjusted association; <code class="reqn">\gamma_M</code>)</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence interval around <code class="reqn">\gamma_M</code>.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., &amp; Molenberghs, G. (1998). The validation of surrogate endpoints in randomized experiments. <em>Biometrics, 54,</em> 1014-1029.
</p>
<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). A causal inference-based approach to evaluate surrogacy using multiple surrogates.</p>


<h3>See Also</h3>

<p><code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ARMD.MultS)

# Regress T on Z, S1 on Z, ..., Sk on Z 
# (to compute the covariance matrix of the residuals)
Res_T &lt;- residuals(lm(Diff52~Treat, data=ARMD.MultS))
Res_S1 &lt;- residuals(lm(Diff4~Treat, data=ARMD.MultS))
Res_S2 &lt;- residuals(lm(Diff12~Treat, data=ARMD.MultS))
Res_S3 &lt;- residuals(lm(Diff24~Treat, data=ARMD.MultS))
Residuals &lt;- cbind(Res_T, Res_S1, Res_S2, Res_S3)

# Make covariance matrix of residuals, Sigma_gamma
Sigma_gamma &lt;- cov(Residuals)

# Conduct analysis
Result &lt;- AA.MultS(Sigma_gamma = Sigma_gamma, N = 188, Alpha = .05)

# Explore results
summary(Result)
</code></pre>

<hr>
<h2 id='ARMD'>
Data of the Age-Related Macular Degeneration Study
</h2><span id='topic+ARMD'></span>

<h3>Description</h3>

<p>These are the data of a clinical trial involving patients suffering from age-related macular degeneration (ARMD), a condition that involves a progressive loss of vision. A total of <code class="reqn">181</code> patients from <code class="reqn">36</code> centers participated in the trial. Patients' visual acuity was assessed using standardized vision charts. There were two treatment conditions (placebo and interferon-<code class="reqn">\alpha</code>). The potential surrogate endpoint is the change in the visual acuity at <code class="reqn">24</code> weeks (<code class="reqn">6</code> months) after starting treatment. The true endpoint is the change in the visual acuity at <code class="reqn">52</code> weeks.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ARMD)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">181</code> observations on <code class="reqn">5</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The Patient ID.</p>
</dd>
<dt><code>Center</code></dt><dd><p>The center in which the patient was treated.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = placebo and <code class="reqn">1</code> = interferon-<code class="reqn">\alpha</code>.</p>
</dd>
<dt><code>Diff24</code></dt><dd><p>The change in the visual acuity at <code class="reqn">24</code> weeks after starting treatment. This endpoint is a potential surrogate for <code>Diff52</code>.</p>
</dd>
<dt><code>Diff52</code></dt><dd><p>The change in the visual acuity at <code class="reqn">52</code> weeks after starting treatment. This outcome serves as the true endpoint.</p>
</dd>
</dl>


<hr>
<h2 id='ARMD.MultS'>
Data of the Age-Related Macular Degeneration Study with multiple candidate surrogates
</h2><span id='topic+ARMD.MultS'></span>

<h3>Description</h3>

<p>These are the data of a clinical trial involving patients suffering from age-related macular degeneration (ARMD), a condition that involves a progressive loss of vision. A total of <code class="reqn">181</code> patients participated in the trial. Patients' visual acuity was assessed using standardized vision charts. There were two treatment conditions (placebo and interferon-<code class="reqn">\alpha</code>). The potential surrogate endpoints are the changes in the visual acuity at <code class="reqn">4</code>, <code class="reqn">12</code>, and <code class="reqn">24</code> weeks after starting treatment. The true endpoint is the change in the visual acuity at <code class="reqn">52</code> weeks.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ARMD.MultS)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">181</code> observations on <code class="reqn">6</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The Patient ID.</p>
</dd>
<dt><code>Diff4</code></dt><dd><p>The change in the visual acuity at <code class="reqn">4</code> weeks after starting treatment. This endpoint is a potential surrogate for <code>Diff52</code>.</p>
</dd>
<dt><code>Diff12</code></dt><dd><p>The change in the visual acuity at <code class="reqn">12</code> weeks after starting treatment. This endpoint is a potential surrogate for <code>Diff52</code>.</p>
</dd>
<dt><code>Diff24</code></dt><dd><p>The change in the visual acuity at <code class="reqn">24</code> weeks after starting treatment. This endpoint is a potential surrogate for <code>Diff52</code>.</p>
</dd>
<dt><code>Diff52</code></dt><dd><p>The change in the visual acuity at <code class="reqn">52</code> weeks after starting treatment. This outcome serves as the true endpoint.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = placebo and <code class="reqn">1</code> = interferon-<code class="reqn">\alpha</code>.</p>
</dd>
</dl>


<hr>
<h2 id='BifixedContCont'>Fits a bivariate fixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case)</h2><span id='topic+BifixedContCont'></span>

<h3>Description</h3>

<p>The function <code>BifixedContCont</code> uses the bivariate fixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below. Further, the Individual Causal Association (ICA) is computed.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BifixedContCont(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, Model=c("Full"), 
Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, T0T1=seq(-1, 1, by=.2), 
T0S1=seq(-1, 1, by=.2), T1S0=seq(-1, 1, by=.2), S0S1=seq(-1, 1, by=.2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BifixedContCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. 
Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain in order to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code>, <code class="reqn">R_{trial}</code>, <code class="reqn">R^2_{indiv}</code> and <code class="reqn">R_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code> (ICA). For details, see function <code>ICA.ContCont</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BifixedContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the full bivariate mixed-effects model is fitted to assess surrogacy in the meta-analytic framework (for details, Buyse &amp; Molenberghs, 2000), computational issues often occur. In that situation, the use of simplified model-fitting strategies may be warranted (for details, see Burzykowski et al., 2005; Tibaldi et al., 2003).   
</p>
<p>The function <code>BifixedContCont</code> implements one such strategy, i.e., it uses a two-stage bivariate fixed-effects modelling approach to assess surrogacy. 
In the first stage of the analysis, a bivariate linear regression model is fitted. When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), the following bivariate model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific treatment effects on S and T, respectively. When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the following bivariate model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T (i.e., it is assumed that the intercepts for the surrogate and the true endpoints are identical in all trials). The other parameters are the same as defined above. 
</p>
<p>In the above models, the error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>: 
</p>
<p style="text-align: center;"><code class="reqn">\bold{\Sigma}=\left(\begin{array}{cc}\sigma_{SS}\\\sigma_{ST} &amp; \sigma_{TT}\end{array}\right).</code>
</p>
 
<p>Based on <code class="reqn">\bold{\Sigma}</code>, individual-level surrogacy is quantified as: 
</p>
<p style="text-align: center;"><code class="reqn">R_{indiv}^{2}=\frac{\sigma_{ST}^{2}}{\sigma_{SS}\sigma_{TT}}.</code>
</p>
 
<p>Next, the second stage of the analysis is conducted. When a full model is requested by the user (by using the argument  <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha_{i}}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on the full model that was fitted in stage 1. 
</p>
<p>When a reduced or semi-reduced model is requested by the user (by using the arguments <code>Model=c("Reduced")</code> or <code>Model=c("SemiReduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_{i}}+\varepsilon_{i}.</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on the semi-reduced or reduced model that was fitted in stage 1. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>BifixedContCont</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>Residuals.Stage.1</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained in stage 1 of the analysis (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level correlation coefficient (<code class="reqn">R_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>D.Equiv</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercept and treatment effects for the surrogate and true endpoints (when a full or semi-reduced model is fitted, i.e., when <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogate and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).  The variance-covariance matrix <code>D.Equiv</code> is equivalent to the <code class="reqn">\bold{D}</code> matrix that would be obtained when a (full or reduced) bivariate mixed-effect approach is used; see function <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The <code class="reqn">2</code> by <code class="reqn">2</code> variance-covariance matrix of the residuals (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.ContCont</code>.</p>
</td></tr>
<tr><td><code>T0T0</code></td>
<td>
<p>The variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>T1T1</code></td>
<td>
<p>The variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code>S0S0</code></td>
<td>
<p>The variance of the surrogate endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>S1S1</code></td>
<td>
<p>The variance of the surrogate endpoint in the experimental treatment condition.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+plot+20Meta-Analytic">plot Meta-Analytic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
# Example 1, based on the ARMD data
data(ARMD)

# Fit a full bivariate fixed-effects model with weighting according to the  
# number of patients in stage 2 of the two stage approach to assess surrogacy:
Sur &lt;- BifixedContCont(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center, 
Pat.ID=Id, Model="Full", Weighted=TRUE)

# Obtain a summary of the results
summary(Sur)

# Obtain a graphical representation of the trial- and individual-level surrogacy
plot(Sur)


# Example 2
# Conduct a surrogacy analysis based on a simulated dataset with 2000 patients, 
# 100 trials, and Rindiv=Rtrial=.8
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Reduced")

# Fit a reduced bivariate fixed-effects model with no weighting according to the 
# number of patients in stage 2 of the two stage approach to assess surrogacy:
\dontrun{ #time-consuming code parts
Sur2 &lt;- BifixedContCont(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat, 
Trial.ID=Trial.ID, Pat.ID=Pat.ID, , Model="Reduced", Weighted=FALSE)

# Show summary and plots of results:
summary(Sur2)
plot(Sur2, Weighted=FALSE)}

## End(Not run)
</code></pre>

<hr>
<h2 id='BimixedCbCContCont'>
Fits a bivariate mixed-effects model using the cluster-by-cluster (CbC) estimator to assess surrogacy in the meta-analytic multiple-trial setting  (Continuous-continuous case)</h2><span id='topic+BimixedCbCContCont'></span>

<h3>Description</h3>

<p>The function <code>BimixedCbCContCont</code> uses the cluster-by-cluster (CbC) estimator of the bivariate mixed-effects to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. See the <b>Details</b> section below.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BimixedCbCContCont(Dataset, Surr, True, Treat, Trial.ID,Min.Treat.Size=2,Alpha=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BimixedCbCContCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, and a trial ID.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_min.treat.size">Min.Treat.Size</code></td>
<td>
<p>The minimum number of patients in each group (control or experimental) that a trial should contain to be included in the analysis. If the number of patients in a group of a trial is smaller than the value specified by <code>Min.Treat.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="BimixedCbCContCont_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>BimixedContCont</code> fits a bivariate mixed-effects model using the CbC estimator (for details, see Florez et al., 2019) to assess surrogacy (for details, see Buyse et al., 2000). In particular, the following mixed-effects model is fitted: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects for S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random treatment effects, respectively. 
</p>
<p>The vector of the random effects (i.e., <code class="reqn">m_{Si}</code>, <code class="reqn">m_{Ti}</code>, <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code>) is assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{D}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bold{D}=\left(\begin{array}{cccc}
d_{SS}\\
d_{ST} &amp; d_{TT}\\
d_{Sa} &amp; d_{Ta} &amp; d_{aa}\\
d_{Sb} &amp; d_{Tb} &amp; d_{ab} &amp; d_{bb}
\end{array}\right).</code>
</p>

<p>The trial-level coefficient of determination (i.e., <code class="reqn">R^2_{trial}</code>) is quantified as:
</p>
<p style="text-align: center;"><code class="reqn">R_{trial}^{2}=\frac{\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)^{'}\left(\begin{array}{cc}
d_{SS} &amp; d_{Sa}\\
d_{Sa} &amp; d_{aa}
\end{array}\right)^{-1}\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)}{d_{bb}}.</code>
</p>

<p>The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>: 
</p>
<p style="text-align: center;"><code class="reqn">\bold{\Sigma}=\left(\begin{array}{cc}\sigma_{SS}\\\sigma_{ST} &amp; \sigma_{TT}\end{array}\right).</code>
</p>
 
<p>Based on <code class="reqn">\bold{\Sigma}</code>, individual-level surrogacy is quantified as: 
</p>
<p style="text-align: center;"><code class="reqn">R_{indiv}^{2}=\frac{\sigma_{ST}^{2}}{\sigma_{SS}\sigma_{TT}}.</code>
</p>
 
<p><b><em>Note</em></b>
The CbC estimator for the full bivariate mixed-effects model is closed-form (for details, see Florez et al., 2019). Therefore, it is fast. Furthermore, it is recommended when computational issues occur with the full maximum likelihood estimator (implemented in function <code>BimixedContCont</code>). 
</p>
<p>The CbC estimator is performed in two stages: (1) a linear model is fitted in each trial. Evidently, it is require that the design matrix (<code class="reqn">X_i</code>) is full column rank within each trial, allowing estimation of the fixed effects. When <code class="reqn">X_i</code> is not full rank, trial i is excluded from the analysis. (2) a global estimator of the fixed effects (<code class="reqn">\beta</code>) is obtained by weighted averaging the sets of estimates of each trial, and <code class="reqn">\bold{D}</code> is estimated using a method-of-moments estimator. Optimal weights (for details, see Molenberghs et al., 2018) are used as a weighting scheme. 
</p>
<p>The estimator of <code class="reqn">\bold{D}</code> might lead to a non-positive-definite solution. Therefore, the eigenvalue method (for details, see Rousseeuw and Molenberghs, 1993) is used for non-positive-definiteness adjustment. 
</p>


<h3>Value</h3>

<p>An object of class <code>BimixedContCont</code> with components,
</p>
<table>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (after excluding clusters). Clusters are excluded for two reasons: (i) the number of patients is smaller than the value especified by <code>Min.Trial.Size</code>, and (ii) the design matrix (<code class="reqn">X_i</code>) is not full rank.</p>
</td></tr>
<tr><td><code>Trial.removed</code></td>
<td>
<p>Number of trials excluded from the analysis</p>
</td></tr>
<tr><td><code>Fixed.Effects</code></td>
<td>
<p>A <code>data.frame</code> that contains the fixed intercept and treatment effects for the true and the surrogate endpoints (i.e., <code class="reqn">\mu_{S}</code>, <code class="reqn">\mu_{T}</code>, <code class="reqn">\alpha</code>, and <code class="reqn">\beta</code>) and their corresponding standard error.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The variance-covariance matrix of the random effects (the <code class="reqn">\bold{D}</code> matrix), i.e., a <code class="reqn">4</code> by <code class="reqn">4</code> variance-covariance matrix of the random intercept and treatment effects.</p>
</td></tr>
<tr><td><code>DH.pd</code></td>
<td>
 <p><code>DH.pd=TRUE</code> if an adjustment for non-positive definiteness was not needed to estimate <code class="reqn">\bold{D}</code>. <code>DH.pd=FALSE</code> if this adjustment was required.</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The <code class="reqn">2</code> by <code class="reqn">2</code> variance-covariance matrix of the residuals (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alvaro J. Florez, Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Florez, A. J., Molenberghs G, Verbeke G, Alonso, A. (2019). A closed-form estimator for meta-analysis
and surrogate markers evaluation. <em>Journal of Biopharmaceutical Statistics, 29(2)</em> 318-332.
</p>
<p>Molenberghs, G., Hermans, L., Nassiri, V., Kenward, M., Van der Elst, W., Aerts, M. and Verbeke, G. (2018). Clusters with random size: maximum likelihood versus weighted estimation. <em>Statistica Sinica,
28</em>, 1107-1132.
</p>
<p>Rousseeuw, P. J. and Molenberghs, G. (1993) Transformation of non positive semidefinite correlation
matrices. <em>Communications in Statistics, Theory and Methods, 22</em>, 965-984.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, 
<code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the Schizo dataset (clinial trial in schizophrenic patients)
data(Schizo)

# Fit a full bivariate random-effects model by the cluster-by-cluster (CbC) estimator
# a minimum of 2 subjects per group are allowed in each trial
  fit &lt;- BimixedCbCContCont(Dataset=Schizo, Surr=BPRS, True=PANSS, Treat=Treat,Trial.ID=InvestId,
                              Alpha=0.05, Min.Treat.Size = 10)
# Note that an adjustment for non-positive definiteness was requiered and 113 trials were removed.

# Obtain a summary of the results
summary(fit)
                         
</code></pre>

<hr>
<h2 id='BimixedContCont'>
Fits a bivariate mixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting 
(Continuous-continuous case)</h2><span id='topic+BimixedContCont'></span>

<h3>Description</h3>

<p>The function <code>BimixedContCont</code> uses the bivariate mixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. The user can specify whether a full or reduced model should be fitted. See the <b>Details</b> section below.  Further, the Individual Causal Association (ICA) is computed.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BimixedContCont(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, Model=c("Full"), 
Min.Trial.Size=2, Alpha=.05, T0T1=seq(-1, 1, by=.2), T0S1=seq(-1, 1, by=.2), 
T1S0=seq(-1, 1, by=.2), S0S1=seq(-1, 1, by=.2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BimixedContCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code> or <code>Model=c("Reduced")</code>. See the <b>Details</b> section below. 
Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code>, <code class="reqn">R_{trial}</code>, <code class="reqn">R^2_{indiv}</code> and <code class="reqn">R_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code> (ICA). For details, see function <code>ICA.ContCont</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="BimixedContCont_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function <code>lmer</code> (of the R package <code>lme4</code>) that is used to fit the geralized linear mixed-effect models in the function <code>BimixedContCont</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>BimixedContCont</code> fits a bivariate mixed-effects model to assess surrogacy (for details, see Buyse et al., 2000). In particular, the following mixed-effects model is fitted: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects for S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random treatment effects, respectively. 
</p>
<p>The vector of the random effects (i.e., <code class="reqn">m_{Si}</code>, <code class="reqn">m_{Ti}</code>, <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code>) is assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{D}</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bold{D}=\left(\begin{array}{cccc}
d_{SS}\\
d_{ST} &amp; d_{TT}\\
d_{Sa} &amp; d_{Ta} &amp; d_{aa}\\
d_{Sb} &amp; d_{Tb} &amp; d_{ab} &amp; d_{bb}
\end{array}\right).</code>
</p>

<p>The trial-level coefficient of determination (i.e., <code class="reqn">R^2_{trial}</code>) is quantified as:
</p>
<p style="text-align: center;"><code class="reqn">R_{trial}^{2}=\frac{\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)^{'}\left(\begin{array}{cc}
d_{SS} &amp; d_{Sa}\\
d_{Sa} &amp; d_{aa}
\end{array}\right)^{-1}\left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)}{d_{bb}}.</code>
</p>

<p>The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>: 
</p>
<p style="text-align: center;"><code class="reqn">\bold{\Sigma}=\left(\begin{array}{cc}\sigma_{SS}\\\sigma_{ST} &amp; \sigma_{TT}\end{array}\right).</code>
</p>
 
<p>Based on <code class="reqn">\bold{\Sigma}</code>, individual-level surrogacy is quantified as: 
</p>
<p style="text-align: center;"><code class="reqn">R_{indiv}^{2}=\frac{\sigma_{ST}^{2}}{\sigma_{SS}\sigma_{TT}}.</code>
</p>
 
<p><b><em>Note</em></b>
</p>
<p>When the full bivariate mixed-effects approach is used to assess surrogacy in the meta-analytic framework (for details, see Buyse &amp; Molenberghs, 2000), computational issues often occur. Such problems mainly occur when the number of trials is low, the number of patients in the different trials is low, and/or when the trial-level heterogeneity is small (Burzykowski et al., 2000). 
</p>
<p>In that situation, the use of a simplified model-fitting strategy may be warranted (for details, see Burzykowski et al., 2000; Tibaldi et al., 2003).
</p>
<p>For example, a reduced bivariate-mixed effect model can be fitted instead of a full model (by using the <code>Model=c("Reduced")</code> argument in the function call). In the reduced model, the random-effects structure is simplified (i) by assuming that there is no heterogeneity in the random intercepts, or (ii) by assuming that the covariance between the random intercepts and random treatment effects is zero. Note that under this assumption, the computation of the trial-level coefficient of determination (i.e., <code class="reqn">R^2_{trial}</code>) simplifies to: 
</p>
<p style="text-align: center;"><code class="reqn">R_{trial}^{2}=\frac{d_{ab}^{2}}{d_{aa}d_{bb}}.</code>
</p>

<p>Alternatively, the bivariate mixed-effects model may be abandonned and the user may fit a univariate fixed-effects model, a bivariate fixed-effects model, or a univariate mixed-effects model (for details, see Tibaldi et al., 2003). These models are implemented in the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, and <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>).
</p>


<h3>Value</h3>

<p>An object of class <code>BimixedContCont</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects on the surrogate and the true endpoints when a full model is requested (i.e., <code class="reqn">\mu_{S}+m_{Si}</code>, <code class="reqn">\mu_{T}+m_{Ti}</code>, <code class="reqn">\alpha+a_{i}</code>, and <code class="reqn">\beta+b_{i}</code>), or the trial-specific treatment effects on the surrogate and the true endpoints  when a reduced model is requested (i.e., <code class="reqn">\alpha+a_{i}</code>, and <code class="reqn">\beta+b_{i}</code>). Note that the results that are contained in <code>Trial.Spec.Results</code> are equivalent to the results in <code>Results.Stage.1</code> that are obtained when the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, or <code><a href="#topic+BifixedContCont">BifixedContCont</a></code> are used.</p>
</td></tr>
<tr><td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>Fixed.Effect.Pars</code></td>
<td>
<p>A <code>data.frame</code> that contains the fixed intercept and treatment effects for the surrogate and the true endpoints (i.e., <code class="reqn">\mu_{S}</code>, <code class="reqn">\mu_{T}</code>, <code class="reqn">\alpha</code>, and <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code>Random.Effect.Pars</code></td>
<td>
<p>A <code>data.frame</code> that contains the random intercept and treatment effects for the surrogate and the true endpoints (i.e., <code class="reqn">m_{Si}</code>, <code class="reqn">m_{Ti}</code>, <code class="reqn">a_{i}</code>, and <code class="reqn">b_{i}</code>) when a full model is fitted (i.e., when <code>Model=c("Full")</code> is used in the function call), or that contains the random treatment effects for the surrogate and the true endpoints (i.e., <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code>) when a reduced model is fitted (i.e., when <code>Model=c("Reduced")</code> is used in the function call).</p>
</td></tr>  
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level correlation coefficient (<code class="reqn">R_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The variance-covariance matrix of the random effects (the <code class="reqn">\bold{D}</code> matrix), i.e., a <code class="reqn">4</code> by <code class="reqn">4</code> variance-covariance matrix of the random intercept and treatment effects when a full model is fitted (i.e., when <code>Model=c("Full")</code> is used in the function call), or a <code class="reqn">2</code> by <code class="reqn">2</code> variance-covariance matrix of the random treatment effects when a reduced model is fitted (i.e., when <code>Model=c("Reduced")</code> is used in the function call).</p>
</td></tr>
<tr><td><code>Sigma</code></td>
<td>
<p>The <code class="reqn">2</code> by <code class="reqn">2</code> variance-covariance matrix of the residuals (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.ContCont</code>.</p>
</td></tr>
<tr><td><code>T0T0</code></td>
<td>
<p>The variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>T1T1</code></td>
<td>
<p>The variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code>S0S0</code></td>
<td>
<p>The variance of the surrogate endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>S1S1</code></td>
<td>
<p>The variance of the surrogate endpoint in the experimental treatment condition.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+plot+20Meta-Analytic">plot Meta-Analytic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the Schizo dataset (clinial trial in schizophrenic patients)
data(Schizo)

## Not run:  #Time consuming (&gt;5 sec) code part
# When a reduced bivariate mixed-effect model is used to assess surrogacy, 
# the conditioning number for the D matrix is very high: 
Sur &lt;- BimixedContCont(Dataset=Schizo, Surr=BPRS, True=PANSS, Treat=Treat, Model="Reduced", 
Trial.ID=InvestId, Pat.ID=Id)

# Such problems often occur when the total number of patients, the total number 
# of trials and/or the trial-level heterogeneity
# of the treatment effects is relatively small

# As an alternative approach to assess surrogacy, consider using the functions
# BifixedContCont, UnifixedContCont or UnimixedContCont in the meta-analytic framework,
# or use the information-theoretic approach

## End(Not run)
</code></pre>

<hr>
<h2 id='binary_continuous_loglik'>Loglikelihood function for binary-continuous copula model</h2><span id='topic+binary_continuous_loglik'></span>

<h3>Description</h3>

<p>Loglikelihood function for binary-continuous copula model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_continuous_loglik(para, X, Y, copula_family, marginal_surrogate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binary_continuous_loglik_+3A_para">para</code></td>
<td>
<p>Parameter vector. The parameters are ordered as follows:
</p>

<ul>
<li> <p><code>para[1]</code>: mean parameter for latent true endpoint distribution
</p>
</li>
<li> <p><code>para[2:p]</code>: Parameters for surrogate distribution, more details in
<code>?Surrogate::cdf_fun</code> for the specific implementations.
</p>
</li>
<li> <p><code>para[p + 1]</code>: copula parameter
</p>
</li></ul>
</td></tr>
<tr><td><code id="binary_continuous_loglik_+3A_x">X</code></td>
<td>
<p>First variable (continuous)</p>
</td></tr>
<tr><td><code id="binary_continuous_loglik_+3A_y">Y</code></td>
<td>
<p>Second variable (binary, $0$ or $1$)</p>
</td></tr>
<tr><td><code id="binary_continuous_loglik_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="binary_continuous_loglik_+3A_marginal_surrogate">marginal_surrogate</code></td>
<td>
<p>Marginal distribution for the surrogate. For all
available options, see <code>?Surrogate::cdf_fun</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) loglikelihood value evaluated in <code>para</code>.
</p>

<hr>
<h2 id='Bootstrap.MEP.BinBin'>
Bootstrap 95% CI around the maximum-entropy ICA and SPF (surrogate predictive function)</h2><span id='topic+Bootstrap.MEP.BinBin'></span>

<h3>Description</h3>

<p>Computes a 95% bootstrap-based CI around the maximum-entropy ICA and SPF (surrogate predictive function) in the binary-binary setting</p>


<h3>Usage</h3>

<pre><code class='language-R'>Bootstrap.MEP.BinBin(Data, Surr, True, Treat, M=100, Seed=123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_data">Data</code></td>
<td>
<p>The dataset to be used.</p>
</td></tr>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_surr">Surr</code></td>
<td>
<p>The name of the surrogate variable.</p>
</td></tr>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_true">True</code></td>
<td>
<p>The name of the true endpoint.</p>
</td></tr>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_treat">Treat</code></td>
<td>
<p>The name of the treatment indicator.</p>
</td></tr>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_m">M</code></td>
<td>
<p>The number of bootstrap samples taken. Default <code>M=1000</code>.</p>
</td></tr>
<tr><td><code id="Bootstrap.MEP.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used. Default <code>Seed=123</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>R2H</code></td>
<td>
<p>The vector the bootstrapped MEP ICA values.</p>
</td></tr>
<tr><td><code>r_1_1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(1, 1)</code> values.</p>
</td></tr>
<tr><td><code>r_min1_1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(-1, 1)</code>.</p>
</td></tr>
<tr><td><code>r_0_1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(0, 1)</code>.</p>
</td></tr>
<tr><td><code>r_1_0</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_min1_0</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(-1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_0_0</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(0, 0)</code>.</p>
</td></tr>
<tr><td><code>r_1_min1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_min1_min1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(-1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_0_min1</code></td>
<td>
<p>The vector of the bootstrapped bootstrapped MEP <code class="reqn">r(0, -1)</code>.</p>
</td></tr>
<tr><td><code>vector_p</code></td>
<td>
<p>The matrix that contains all bootstrapped maximum entropy distributions of the vector of the potential outcomes.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., &amp; Van der Elst, W. (2015). A maximum-entropy approach for the evluation of surrogate endpoints based on causal inference.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code>, <code><a href="#topic+plot+20MaxEntSPF+20BinBin">plot MaxEntSPF BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
MEP_CI &lt;- Bootstrap.MEP.BinBin(Data = Schizo_Bin, Surr = "BPRS_Bin", True = "PANSS_Bin",
                     Treat = "Treat", M = 500, Seed=123)
summary(MEP_CI)

## End(Not run)
</code></pre>

<hr>
<h2 id='CausalDiagramBinBin'>
Draws a causal diagram depicting the median informational coefficients of correlation (or odds ratios) between the counterfactuals for a specified range of values of the ICA in the binary-binary setting.
</h2><span id='topic+CausalDiagramBinBin'></span>

<h3>Description</h3>

<p>This function provides a diagram that depicts the medians of the informational coefficients of correlation (or odds ratios) between the counterfactuals for a specified range of values of the individual causal association in the binary-binary setting (<code class="reqn">R_{H}^{2}</code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CausalDiagramBinBin(x, Values="Corrs", Theta_T0S0, Theta_T1S1, 
Min=0, Max=1, Cex.Letters=3, Cex.Corrs=2, Lines.Rel.Width=TRUE, 
Col.Pos.Neg=TRUE, Monotonicity, Histograms.Correlations=FALSE, 
Densities.Correlations=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CausalDiagramBinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.BinBin</code>. See <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_values">Values</code></td>
<td>
<p>Specifies whether the median informational coefficients of correlation or median odds ratios between the counterfactuals should be depicted, i.e., <code>Values="Corrs"</code> or <code>Values="ORs"</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_theta_t0s0">Theta_T0S0</code></td>
<td>
<p>The odds ratio between <code class="reqn">T</code> and <code class="reqn">S</code> in the control group. This quantity is estimable based on the observed data. Only has to be provided when <code>Values="ORs"</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_theta_t1s1">Theta_T1S1</code></td>
<td>
<p>The odds ratio between <code class="reqn">T</code> and <code class="reqn">S</code> in the experimental treatment group. This quantity is estimable based on the observed data. Only has to be provided when <code>Values="ORs"</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_min">Min</code></td>
<td>
<p>The minimum value of <code class="reqn">R_{H}^{2}</code> that should be considered. Default=<code class="reqn">-1</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_max">Max</code></td>
<td>
<p>The maximum value of <code class="reqn">R_{H}^{2}</code> that should be considered. Default=<code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_cex.letters">Cex.Letters</code></td>
<td>
<p>The size of the symbols for the counterfactuals (<code class="reqn">S_0</code>, <code class="reqn">S_1</code>), <code class="reqn">T_0</code>, <code class="reqn">T_1</code>). Default=<code class="reqn">3</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_cex.corrs">Cex.Corrs</code></td>
<td>
<p>The size of the text depicting the median odds ratios between the counterfactuals. Default=<code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_lines.rel.width">Lines.Rel.Width</code></td>
<td>
<p>Logical. When <code>Lines.Rel.Width=TRUE</code>, the widths of the lines that represent the odds ratios between the counterfactuals are relative to the size of the odds ratios (i.e., a smaller/thicker line is used for smaller/higher odds ratios. When <code>Lines.Rel.Width=FALSE</code>, the width of all lines representing the odds ratios between the counterfactuals is identical. Default=<code>TRUE</code>.  Only considered when <code>Values="ORs"</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_col.pos.neg">Col.Pos.Neg</code></td>
<td>
<p>Logical. When <code>Col.Pos.Neg=TRUE</code>, the color of the lines that represent the odds ratios between the counterfactuals is red for odds ratios below <code class="reqn">1</code> and black for the ones above <code class="reqn">1</code>. When <code>Col.Pos.Neg=FALSE</code>, all lines are in black. Default=<code>TRUE</code>. Only considered when <code>Values="ORs"</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies the monotonicity scenario that should be considered (i.e., <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>).</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_histograms.correlations">Histograms.Correlations</code></td>
<td>
<p>Should histograms of the informational coefficients of association <code class="reqn">R_{H}^{2}</code> be provided? Default <code>Histograms.Correlations=FALSE</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramBinBin_+3A_densities.correlations">Densities.Correlations</code></td>
<td>
<p>Should densities of the informational coefficients of association <code class="reqn">R_{H}^{2}</code> be provided? Default <code>Densities.Correlations=FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The following components are stored in the fitted object if histograms of the informational correlations are requested in the function call (i.e., if <code>Histograms.Correlations=TRUE</code> and <code>Values="Corrs"</code> in the function call):
</p>
<table>
<tr><td><code>R2_H_T0T1</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">T_0</code> and <code class="reqn">T_1</code>.</p>
</td></tr>
<tr><td><code>R2_H_S1T0</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">S_1</code> and <code class="reqn">T_0</code>.</p>
</td></tr>
<tr><td><code>R2_H_S0T1</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">S_0</code> and <code class="reqn">T_1</code>.</p>
</td></tr>
<tr><td><code>R2_H_S0S1</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">S_0</code> and <code class="reqn">S_1</code>.</p>
</td></tr>
<tr><td><code>R2_H_S0T0</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">S_0</code> and <code class="reqn">T_0</code>.</p>
</td></tr>
<tr><td><code>R2_H_S1T1</code></td>
<td>
<p>The informational coefficients of association <code class="reqn">R_{H}^{2}</code> between <code class="reqn">S_1</code> and <code class="reqn">T_1</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>
<p>Van der Elst, W., Alonso, A., &amp; Molenberghs, G. (submitted). An exploration of the relationship between causal inference and meta-analytic measures of surrogacy.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.BinBin">ICA.BinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute R2_H given the marginals specified as the pi's
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.2619048, pi1_0_=0.2857143, 
pi_1_1=0.6372549, pi_1_0=0.07843137, pi0_1_=0.1349206, pi_0_1=0.127451,
Seed=1, Monotonicity=c("General"), M=1000)

# Obtain a causal diagram that provides the medians of the 
# correlations between the counterfactuals for the range
# of R2_H values between 0.1 and 1
   # Assume no monotonicty 
CausalDiagramBinBin(x=ICA, Min=0.1, Max=1, Monotonicity="No") 

   # Assume monotonicty for S 
CausalDiagramBinBin(x=ICA, Min=0.1, Max=1, Monotonicity="Surr.Endp") 

# Now only consider the results that were obtained when 
# monotonicity was assumed for the true endpoint
CausalDiagramBinBin(x=ICA, Values="ORs", Theta_T0S0=2.156, Theta_T1S1=10, 
Min=0, Max=1,  Monotonicity="True.Endp") 
</code></pre>

<hr>
<h2 id='CausalDiagramContCont'>
Draws a causal diagram depicting the median correlations between the counterfactuals for a specified range of values of ICA or MICA in the continuous-continuous setting
</h2><span id='topic+CausalDiagramContCont'></span>

<h3>Description</h3>

<p>This function provides a diagram that depicts the medians of the correlations between the counterfactuals for a specified range of values of the individual causal association (ICA; <code class="reqn">\rho_{\Delta}</code>) or the meta-analytic individual causal association (MICA; <code class="reqn">\rho_{M}</code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CausalDiagramContCont(x, Min=-1, Max=1, Cex.Letters=3, Cex.Corrs=2, 
Lines.Rel.Width=TRUE, Col.Pos.Neg=TRUE, Histograms.Counterfactuals=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CausalDiagramContCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.ContCont</code> or <code>MICA.ContCont</code>. See <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code> or <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_min">Min</code></td>
<td>
<p>The minimum values of (M)ICA that should be considered. Default=<code class="reqn">-1</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_max">Max</code></td>
<td>
<p>The maximum values of (M)ICA that should be considered. Default=<code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_cex.letters">Cex.Letters</code></td>
<td>
<p>The size of the symbols for the counterfactuals (<code class="reqn">S_0</code>, <code class="reqn">S_1</code>), <code class="reqn">T_0</code>, <code class="reqn">T_1</code>). Default=<code class="reqn">3</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_cex.corrs">Cex.Corrs</code></td>
<td>
<p>The size of the text depicting the median correlations between the counterfactuals. Default=<code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_lines.rel.width">Lines.Rel.Width</code></td>
<td>
<p>Logical. When <code>Lines.Rel.Width=TRUE</code>, the widths of the lines that represent the correlations between the counterfactuals are relative to the size of the correlations (i.e., a smaller line is used for correlations closer to zero whereas a thicker line is used for (absolute) correlations closer to <code class="reqn">1</code>). When <code>Lines.Rel.Width=FALSE</code>, the width of all lines representing the correlations between the counterfactuals is identical. Default=<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_col.pos.neg">Col.Pos.Neg</code></td>
<td>
<p>Logical. When <code>Col.Pos.Neg=TRUE</code>, the color of the lines that represent the correlations between the counterfactuals is red for negative correlations and black for positive ones. When <code>Col.Pos.Neg=FALSE</code>, all lines are in black. Default=<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="CausalDiagramContCont_+3A_histograms.counterfactuals">Histograms.Counterfactuals</code></td>
<td>
<p>Should plots that shows the densities for the inidentifiable correlations be shown? Default =<code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>
<p>Van der Elst, W., Alonso, A., &amp; Molenberghs, G. (submitted). An exploration of the relationship between causal inference and meta-analytic measures of surrogacy.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.ContCont">ICA.ContCont</a>, <a href="#topic+MICA.ContCont">MICA.ContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #Time consuming (&gt;5 sec) code parts
# Generate the vector of ICA values when rho_T0S0=.91, rho_T1S1=.91, and when the
# grid of values {0, .1, ..., 1} is considered for the correlations
# between the counterfactuals:
SurICA &lt;- ICA.ContCont(T0S0=.95, T1S1=.91, T0T1=seq(0, 1, by=.1), T0S1=seq(0, 1, by=.1), 
T1S0=seq(0, 1, by=.1), S0S1=seq(0, 1, by=.1))

#obtain a plot of ICA

# Obtain a causal diagram that provides the medians of the 
# correlations between the counterfactuals for the range
# of ICA values between .9 and 1 (i.e., which assumed 
# correlations between the counterfactuals lead to a 
# high ICA?)
CausalDiagramContCont(SurICA, Min=.9, Max=1)

# Same, for low values of ICA
CausalDiagramContCont(SurICA, Min=0, Max=.5)
## End(Not run)
</code></pre>

<hr>
<h2 id='cdf_fun'>Function factory for distribution functions</h2><span id='topic+cdf_fun'></span>

<h3>Description</h3>

<p>Function factory for distribution functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdf_fun(para, family)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cdf_fun_+3A_para">para</code></td>
<td>
<p>Parameter vector.</p>
</td></tr>
<tr><td><code id="cdf_fun_+3A_family">family</code></td>
<td>
<p>Distributional family, one of the following:
</p>

<ul>
<li> <p><code>"normal"</code>: normal distribution where <code>para[1]</code> is the mean and <code>para[2]</code> is
the standard deviation.
</p>
</li>
<li> <p><code>"logistic"</code>: logistic distribution as parameterized in <code>stats::plogis()</code> where
<code>para[1]</code> and <code>para[2]</code> correspond to <code>location</code> and <code>scale</code>, respectively.
</p>
</li>
<li> <p><code>"t"</code>: t distribution as parameterized in <code>stats::pt()</code> where <code>para[1]</code> and
<code>para[2]</code> correspond to <code>ncp</code> and <code>df</code>, respectively.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A distribution function that has a single argument. This is the
vector of values in which the distribution function is evaluated.
</p>

<hr>
<h2 id='clayton_loglik_copula_scale'>Loglikelihood on the Copula Scale for the Clayton Copula</h2><span id='topic+clayton_loglik_copula_scale'></span>

<h3>Description</h3>

<p><code>clayton_loglik_copula_scale()</code> computes the loglikelihood on the copula
scale for the Clayton copula which is parameterized by <code>theta</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn">C(u, v) = (u^{-\theta} + v^{-\theta} - 1)^{-\frac{1}{\theta}}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>clayton_loglik_copula_scale(theta, u, v, d1, d2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clayton_loglik_copula_scale_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="clayton_loglik_copula_scale_+3A_u">u</code></td>
<td>
<p>A numeric vector. Corresponds to first variable on the copula scale.</p>
</td></tr>
<tr><td><code id="clayton_loglik_copula_scale_+3A_v">v</code></td>
<td>
<p>A numeric vector. Corresponds to second variable on the copula
scale.</p>
</td></tr>
<tr><td><code id="clayton_loglik_copula_scale_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="clayton_loglik_copula_scale_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the copula loglikelihood evaluated in <code>theta</code>.
</p>

<hr>
<h2 id='colorectal'>The Colorectal dataset with a binary surrogate.</h2><span id='topic+colorectal'></span>

<h3>Description</h3>

<p>This dataset combines the data that were collected in 26 double-blind randomized clinical trials in advanced colorectal cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colorectal")</code></pre>


<h3>Format</h3>

<p>A data frame with 3943 observations on the following 7 variables.
</p>

<dl>
<dt><code>TRIAL</code></dt><dd><p>The ID number of a trial.</p>
</dd>
<dt><code>responder</code></dt><dd><p>Binary tumor response (the candidate surrogate), coded as 1=complete response (CR) or partial response (PR) and 0=stabled disease (SD) or progressive disease (PD).</p>
</dd>
<dt><code>SURVIND</code></dt><dd><p>Censoring indicator for survival time.</p>
</dd>
<dt><code>TREAT</code></dt><dd><p>The treatment indicator, coded as 0=active control and 1=experimental treatment.</p>
</dd>
<dt><code>CENTER</code></dt><dd><p>The center in which a patient was treated. In this dataset, there was only one center per trial, hence TRIAL=CENTER.</p>
</dd>
<dt><code>patientid</code></dt><dd><p>The ID number of a patient.</p>
</dd>
<dt><code>surv</code></dt><dd><p>Survival time (the true endpoint).</p>
</dd>
</dl>



<h3>References</h3>

<p>Alonso, A., Bigirumurame, T., Burzykowski, T., Buyse, M., Molenberghs, G., Muchene, L., ... &amp; Van der Elst, W. (2016). Applied surrogate endpoint evaluation methods with SAS and R. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colorectal)
str(colorectal)
head(colorectal)
</code></pre>

<hr>
<h2 id='colorectal4'>The Colorectal dataset with an ordinal surrogate.</h2><span id='topic+colorectal4'></span>

<h3>Description</h3>

<p>This dataset combines the data that were collected in 19 double-blind randomized clinical trials in advanced colorectal cancer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colorectal4")</code></pre>


<h3>Format</h3>

<p>A data frame with 3192 observations on the following 7 variables.
</p>

<dl>
<dt><code>trialend</code></dt><dd><p>The ID number of a trial.</p>
</dd>
<dt><code>treatn</code></dt><dd><p>The treatment indicator, coded as 0=active control and 1=experimental treatment.</p>
</dd>
<dt><code>trueind</code></dt><dd><p>Censoring indicator for survival time.</p>
</dd>
<dt><code>surrogend</code></dt><dd><p>Categorical ordered tumor response (the candidate surrogate), coded as 1=complete response (CR), 2=partial response (PR), 3=stabled disease (SD) and 4=progressive disease (PD).</p>
</dd>
<dt><code>patid</code></dt><dd><p>The ID number of a patient.</p>
</dd>
<dt><code>center</code></dt><dd><p>The center in which a patient was treated. In this dataset, there was only one center per trial, hence TRIAL=CENTER.</p>
</dd>
<dt><code>truend</code></dt><dd><p>Survival time (the true endpoint).</p>
</dd>
</dl>



<h3>References</h3>

<p>Alonso, A., Bigirumurame, T., Burzykowski, T., Buyse, M., Molenberghs, G., Muchene, L., ... &amp; Van der Elst, W. (2016). Applied surrogate endpoint evaluation methods with SAS and R. CRC Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colorectal4)
str(colorectal4)
head(colorectal4)
</code></pre>

<hr>
<h2 id='comb27.BinBin'>Assesses the surrogate predictive value of each of the 27 prediction functions in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+comb27.BinBin'></span>

<h3>Description</h3>

<p>The function <code>comb27.BinBin</code> assesses a surrogate predictive value of each of the 27 possible prediction functions in the single-trial causal-inference framework when both the surrogate and the true endpoints are binary outcomes. The distribution of frequencies at which each of the 27 possible predicton functions are selected provides additional insights regarding the association between <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>).  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>comb27.BinBin(pi1_1_, pi1_0_, pi_1_1, pi_1_0, 
pi0_1_, pi_0_1, Monotonicity=c("No"),M=1000, Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comb27.BinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made, only one assumption can be made at the time:  <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>.  Default <code>Monotonicity=c("No")</code>.</p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_m">M</code></td>
<td>
<p>The number of random samples that have to be drawn for the freely varying parameters. Default <code>M=100000</code>. </p>
</td></tr>
<tr><td><code id="comb27.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>Seed=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2016) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles. 
</p>
<p>The function <code>comb27.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed to vary freely are considered. It computes the probability of a prediction error for each of the 27 possible prediction functions.The frequency at which each prediction function is selected provides additional insight about the minimal probability of a prediction error PPE which can be obtained with <code>PPE.BinBin</code>.  
</p>


<h3>Value</h3>

<p>An object of class <code>comb27.BinBin</code> with components,
</p>
<table>
<tr><td><code>index</code></td>
<td>
<p>count variable</p>
</td></tr>
<tr><td><code>Monotonicity</code></td>
<td>
<p>The vector of Monotonicity assumptions</p>
</td></tr>
<tr><td><code>Pe</code></td>
<td>
<p>The vector of the prediction error values.</p>
</td></tr>
<tr><td><code>combo</code></td>
<td>
<p>The vector containing the codes for the each of the 27 prediction functions.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>H_Delta_S</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_S</code>.</p>
</td></tr>
<tr><td><code>I_Delta_T_Delta_S</code></td>
<td>
<p>The vector of the mutual information of <code class="reqn">\Delta_S</code> and <code class="reqn">\Delta_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso, Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso A,  Van der Elst W, Molenberghs G, Buyse M and Burzykowski T. (2016). An information-theoretic approach for the evaluation of surrogate endpoints based on causal inference. 
</p>
<p>Alonso A, Van der Elst W and Meyvisch P (2016). Assessing a surrogate predictive value: A causal inference approach. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PPE.BinBin">PPE.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Conduct the analysis assuming no montonicity
 
## Not run:  # time consuming code part
comb27.BinBin(pi1_1_ = 0.3412, pi1_0_ = 0.2539, pi0_1_ = 0.119, 
              pi_1_1 = 0.6863, pi_1_0 = 0.0882, pi_0_1 = 0.0784,  
              Seed=1,Monotonicity=c("No"), M=500000) 

## End(Not run)
</code></pre>

<hr>
<h2 id='compute_ICA_BinCont'>Compute Individual Causal Association for a given D-vine copula model in the
Binary-Continuous Setting</h2><span id='topic+compute_ICA_BinCont'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+compute_ICA_BinCont">compute_ICA_BinCont()</a></code> function computes the individual causal
association for a fully identified D-vine copula model in the setting with a
continuous surrogate endpoint and a binary true endpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ICA_BinCont(
  copula_par,
  rotation_par,
  copula_family1,
  copula_family2 = copula_family1,
  n_prec,
  q_S0,
  q_S1,
  marginal_sp_rho = TRUE,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_ICA_BinCont_+3A_copula_par">copula_par</code></td>
<td>
<p>Parameter vector for the sequence of bivariate copulas that
define the D-vine copula. The elements of <code>copula_par</code> correspond to
<code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_rotation_par">rotation_par</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_copula_family1">copula_family1</code></td>
<td>
<p>Copula family of <code class="reqn">c_{12}</code> and <code class="reqn">c_{34}</code>. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family</code> correspond to <code class="reqn">(c_{12}, c_{34})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_q_s0">q_S0</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_0</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_q_s1">q_S1</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_1</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_marginal_sp_rho">marginal_sp_rho</code></td>
<td>
<p>(boolean) Compute the sample Spearman correlation
matrix? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_BinCont_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) A Named vector with the following elements:
</p>

<ul>
<li><p> ICA
</p>
</li>
<li><p> Spearman's rho, <code class="reqn">\rho_s (\Delta S, \Delta T)</code> (if asked)
</p>
</li>
<li><p> Kendall's tau, <code class="reqn">\tau (\Delta S, \Delta T)</code> (if asked)
</p>
</li>
<li><p> Marginal association parameters in terms of Spearman's rho:
</p>
<p style="text-align: center;"><code class="reqn">(\rho_s(S_0, S_1), \rho_s(S_0, T_0), \rho_s(S_0, T_1),
 \rho_s(S_1, T_0), \rho_s(S_0, S_1),
 \rho_s(T_0, T_1)</code>
</p>

</li></ul>


<hr>
<h2 id='compute_ICA_SurvSurv'>Compute Individual Causal Association for a given D-vine copula model in the
Survival-Survival Setting</h2><span id='topic+compute_ICA_SurvSurv'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+compute_ICA_SurvSurv">compute_ICA_SurvSurv()</a></code> function computes the individual causal
association (and associated quantities) for a fully identified D-vine copula
model in the survival-survival setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_ICA_SurvSurv(
  copula_par,
  rotation_par,
  copula_family1,
  copula_family2,
  n_prec,
  q_S0,
  q_T0,
  q_S1,
  q_T1,
  composite,
  marginal_sp_rho = TRUE,
  seed = 1,
  mutinfo_estimator = NULL,
  plot_deltas = FALSE,
  restr_time = +Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_ICA_SurvSurv_+3A_copula_par">copula_par</code></td>
<td>
<p>Parameter vector for the sequence of bivariate copulas that
define the D-vine copula. The elements of <code>copula_par</code> correspond to
<code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_rotation_par">rotation_par</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_copula_family1">copula_family1</code></td>
<td>
<p>Copula family of <code class="reqn">c_{12}</code> and <code class="reqn">c_{34}</code>. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family</code> correspond to <code class="reqn">(c_{12}, c_{34})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_q_s0">q_S0</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_0</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_q_t0">q_T0</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">T_0</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_q_s1">q_S1</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_1</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_q_t1">q_T1</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">T_1</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_marginal_sp_rho">marginal_sp_rho</code></td>
<td>
<p>(boolean) Compute the sample Spearman correlation
matrix? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_plot_deltas">plot_deltas</code></td>
<td>
<p>Plot the sampled individual causal effects? Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="compute_ICA_SurvSurv_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) A Named vector with the following elements:
</p>

<ul>
<li><p> ICA
</p>
</li>
<li><p> Spearman's rho, <code class="reqn">\rho_s (\Delta S, \Delta T)</code> (if asked)
</p>
</li>
<li><p> Marginal association parameters in terms of Spearman's rho (if asked):
</p>
<p style="text-align: center;"><code class="reqn">\rho_{s}(T_0, S_0), \rho_{s}(T_0, S_1), \rho_{s}(T_0, T_1),
 \rho_{s}(S_0, S_1), \rho_{s}(S_0, T_1),
 \rho_{s}(S_1, T_1)</code>
</p>

</li>
<li><p> Survival classification proportions (if asked):
</p>
<p style="text-align: center;"><code class="reqn">\pi_{harmed}, \pi_{protected}, \pi_{always}, \pi_{never}</code>
</p>

</li></ul>


<hr>
<h2 id='delta_method_log_mutinfo'>Variance of log-mutual information based on the delta method</h2><span id='topic+delta_method_log_mutinfo'></span>

<h3>Description</h3>

<p><code><a href="#topic+delta_method_log_mutinfo">delta_method_log_mutinfo()</a></code> computes the variance of the estimated log
mutual information, given the unidentifiable parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delta_method_log_mutinfo(
  fitted_model,
  copula_par_unid,
  copula_family2,
  rotation_par_unid,
  n_prec,
  mutinfo_estimator = NULL,
  composite,
  seed,
  eps = 0.001
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delta_method_log_mutinfo_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_copula_par_unid">copula_par_unid</code></td>
<td>
<p>Parameter vector for the sequence of <em>unidentifiable</em>
bivariate copulas that define the D-vine copula. The elements of
<code>copula_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_rotation_par_unid">rotation_par_unid</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
<em>unidentifiable</em> bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
<tr><td><code id="delta_method_log_mutinfo_+3A_eps">eps</code></td>
<td>
<p>(numeric) Step size for finite difference in numeric
differentiation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should not be used. The ICA is computed through numerical
methods with a considerable error. This error is negligible in individual estimates
of the ICA; however, this error easily breaks the numeric differentiation because
finite differences are inflated by this error.
</p>


<h3>Value</h3>

<p>(numeric) Variance for the estimated ICA based on the delta method,
holding the unidentifiable parameters fixed at the user supplied values.
</p>

<hr>
<h2 id='Dvine_ICA_confint'>Confidence interval for the ICA given the unidentifiable parameters</h2><span id='topic+Dvine_ICA_confint'></span>

<h3>Description</h3>

<p><code><a href="#topic+Dvine_ICA_confint">Dvine_ICA_confint()</a></code> computes the confidence interval for the ICA
in the D-vine copula model. The unidentifiable parameters are fixed at the user
supplied values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Dvine_ICA_confint(
  fitted_model,
  alpha,
  copula_par_unid,
  copula_family2,
  rotation_par_unid,
  n_prec,
  mutinfo_estimator = NULL,
  composite,
  B,
  seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Dvine_ICA_confint_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_alpha">alpha</code></td>
<td>
<p>(numeric) <code>1 - alpha</code> is the level of the confidence interval</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_copula_par_unid">copula_par_unid</code></td>
<td>
<p>Parameter vector for the sequence of <em>unidentifiable</em>
bivariate copulas that define the D-vine copula. The elements of
<code>copula_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_rotation_par_unid">rotation_par_unid</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
<em>unidentifiable</em> bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_b">B</code></td>
<td>
<p>Number of bootstrap replications</p>
</td></tr>
<tr><td><code id="Dvine_ICA_confint_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) Vector with the limits of the two-sided <code>1 - alpha</code>
confidence interval.
</p>

<hr>
<h2 id='ECT'>Apply the Entropy Concentration Theorem</h2><span id='topic+ECT'></span>

<h3>Description</h3>

<p>The Entropy Concentration Theorem (ECT; Edwin, 1982) states that if <code class="reqn">N</code> is large enough, then <code class="reqn">100(1-F)</code>% of all <code class="reqn">\bold{p*}</code> and <code class="reqn">\Delta H</code> is determined by the upper tail are <code class="reqn">1-F</code> of a <code class="reqn">\chi^2</code> distribution, with <code class="reqn">DF = q - m - 1</code> (which equals <code class="reqn">8</code> in a surrogate evaluation context).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ECT(Perc=.95, H_Max, N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ECT_+3A_perc">Perc</code></td>
<td>
<p>The desired interval. E.g., <code>Perc=.05</code> will generate the lower and upper bounds for <code class="reqn">H(\bold{p})</code> that contain <code class="reqn">95\%</code> of the cases (as determined by the ECT).</p>
</td></tr>
<tr><td><code id="ECT_+3A_h_max">H_Max</code></td>
<td>
<p>The maximum entropy value. In the binary-binary setting, this can be computed using the function <code><a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></code>.</p>
</td></tr>
<tr><td><code id="ECT_+3A_n">N</code></td>
<td>
<p>The sample size.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ECT</code> with components,
</p>
<table>
<tr><td><code>Lower_H</code></td>
<td>
<p>The lower bound of the requested interval.</p>
</td></tr>
<tr><td><code>Upper_H</code></td>
<td>
<p>The upper bound of the requested interval, which equals <code class="reqn">H_Max</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, &amp; Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2016). Surrogate markers validation: the continuous-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></code>, <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ECT_fit &lt;- ECT(Perc = .05, H_Max = 1.981811, N=454)
summary(ECT_fit)
</code></pre>

<hr>
<h2 id='estimate_ICA_BinCont'>Estimate ICA in Binary-Continuous Setting</h2><span id='topic+estimate_ICA_BinCont'></span>

<h3>Description</h3>

<p><code>estimate_ICA_BinCont()</code> estimates the individual causal association (ICA)
for a sample of individual causal treatment effects with a continuous
surrogate and a binary true endpoint. The ICA in this setting is defined as
follows, </p>
<p style="text-align: center;"><code class="reqn">R^2_H = \frac{I(\Delta S; \Delta T)}{H(\Delta T)}</code>
</p>
<p> where
<code class="reqn">I(\Delta S; \Delta T)</code> is the mutual information and <code class="reqn">H(\Delta T)</code>
the entropy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_ICA_BinCont(delta_S, delta_T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_ICA_BinCont_+3A_delta_s">delta_S</code></td>
<td>
<p>(numeric) Vector of individual causal treatment effects on the
surrogate.</p>
</td></tr>
<tr><td><code id="estimate_ICA_BinCont_+3A_delta_t">delta_T</code></td>
<td>
<p>(integer) Vector of individual causal treatment effects on the true
endpoint. Should take on one of the following values: <code>-1L</code>, <code>0L</code>, or <code>1L</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) Estimated ICA
</p>

<hr>
<h2 id='estimate_mutual_information_SurvSurv'>Estimate the Mutual Information in the Survival-Survival Setting</h2><span id='topic+estimate_mutual_information_SurvSurv'></span>

<h3>Description</h3>

<p><code><a href="#topic+estimate_mutual_information_SurvSurv">estimate_mutual_information_SurvSurv()</a></code> estimates the mutual information for
a sample of individual causal treatment effects with a time-to-event
surrogate and a time-to-event true endpoint. The mutual information is
estimated by first estimating the bivariate density and then computing the
mutual information for the estimated density.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_mutual_information_SurvSurv(delta_S, delta_T, minfo_prec)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_mutual_information_SurvSurv_+3A_delta_s">delta_S</code></td>
<td>
<p>(numeric) Vector of individual causal treatment effects on the
surrogate.</p>
</td></tr>
<tr><td><code id="estimate_mutual_information_SurvSurv_+3A_delta_t">delta_T</code></td>
<td>
<p>(numeric) Vector of individual causal treatment effects on the
true endpoint.</p>
</td></tr>
<tr><td><code id="estimate_mutual_information_SurvSurv_+3A_minfo_prec">minfo_prec</code></td>
<td>
<p>Number of quasi Monte-Carlo samples for the numerical
integration to obtain the mutual information. If this value is 0 (default),
the mutual information is not computed and <code>NA</code> is returned for the mutual
information and derived quantities.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(numeric) estimated mutual information.
</p>

<hr>
<h2 id='Fano.BinBin'>Evaluate the possibility of finding a good surrogate in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+Fano.BinBin'></span>

<h3>Description</h3>

<p>The function <code>Fano.BinBin</code> evaluates the existence of a good surrogate in the single-trial causal-inference framework when both the surrogate and the true endpoints are binary outcomes. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fano.BinBin(pi1_,  pi_1, rangepi10=c(0,min(pi1_,1-pi_1)), 
fano_delta=c(0.1), M=100, Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Fano.BinBin_+3A_pi1_">pi1_</code></td>
<td>
<p>A scalar or a vector of plausibel values that represents the proportion of responders under treatment.</p>
</td></tr>
<tr><td><code id="Fano.BinBin_+3A_pi_1">pi_1</code></td>
<td>
<p>A scalar or a vector of plausibel values that represents the proportion of responders under control.</p>
</td></tr>
<tr><td><code id="Fano.BinBin_+3A_rangepi10">rangepi10</code></td>
<td>
<p>Represents the range from which <code class="reqn">\pi_{10}</code> is sampled. By default, Monte Carlo simulation will be constrained to the interval <code class="reqn">[0,\min(\pi_{1\cdot},\pi_{\cdot0})]</code> but this allows the user to specify a more narrow range. <code>rangepi10=c(0,0)</code> is equivalent to the assumption of monotonicity for the true endpoint.</p>
</td></tr>
<tr><td><code id="Fano.BinBin_+3A_fano_delta">fano_delta</code></td>
<td>
<p>A scalar or a vector that specifies the values for the upper bound of the prediction error <code class="reqn">\delta</code>. Default <code>fano_delta=c(0.2)</code>.</p>
</td></tr>
<tr><td><code id="Fano.BinBin_+3A_m">M</code></td>
<td>
<p>The number of random samples that have to be drawn for the freely varying parameter <code class="reqn">\pi_{10}</code>. Default <code>M=1000</code>. The number of random samples should be sufficiently large in relation to the length of the interval <code>rangepi10</code>. Typically <code>M=1000</code> yields a sufficiently fine grid. In case <code>rangepi10</code> is a single value: <code>M=1</code> </p>
</td></tr>
<tr><td><code id="Fano.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to sample the freely varying parameter <code class="reqn">\pi_{10}</code>. Default <code>Seed=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values for <code class="reqn">\pi_{10}</code> have to be uniformly sampled from the interval <code class="reqn">[0,\min(\pi_{1\cdot},\pi_{\cdot0})]</code>. Any sampled value for <code class="reqn">\pi_{10}</code> will fully determine the bivariate distribution of potential outcomes for the true endpoint. The treatment effect should be positive.
</p>
<p>The vector <code class="reqn">\bold{\pi_{km}}</code> fully determines <code class="reqn">R^2_{HL}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>Fano.BinBin</code> with components,
</p>
<table>
<tr><td><code>R2_HL</code></td>
<td>
<p>The sampled values for <code class="reqn">R^2_{HL}</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The sampled values for <code class="reqn">H{\Delta T}</code>.</p>
</td></tr>
<tr><td><code>PPE_T</code></td>
<td>
<p>The sampled values for <code class="reqn">PPE_{T}</code>.</p>
</td></tr>
<tr><td><code>minpi10</code></td>
<td>
<p>The minimum value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>maxpi10</code></td>
<td>
<p>The maximum value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>samplepi10</code></td>
<td>
<p>The sampled value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>The specified vector of upper bounds for the prediction errors.</p>
</td></tr>
<tr><td><code>uncertainty</code></td>
<td>
<p>Indexes the sampling of <code class="reqn">pi1\_</code>.</p>
</td></tr>
<tr><td><code>pi_00</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{00}</code>.</p>
</td></tr>
<tr><td><code>pi_11</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{11}</code>.</p>
</td></tr>
<tr><td><code>pi_01</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{01}</code>.</p>
</td></tr>
<tr><td><code>pi_10</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.Fano.BinBin">plot.Fano.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Conduct the analysis assuming no montonicity
# for the true endpoint, using a range of
# upper bounds for prediction errors 
Fano.BinBin(pi1_ = 0.5951 ,  pi_1 = 0.7745, 
fano_delta=c(0.05, 0.1, 0.2), M=1000)


# Conduct the same analysis now sampling from
# a range of values to allow for uncertainty

Fano.BinBin(pi1_ = runif(n=20,min=0.504,max=0.681), 
pi_1 = runif(n=20,min=0.679,max=0.849), 
fano_delta=c(0.05, 0.1, 0.2), M=10, Seed=2)
</code></pre>

<hr>
<h2 id='fit_copula_model_BinCont'>Fit copula model for binary true endpoint and continuous surrogate endpoint</h2><span id='topic+fit_copula_model_BinCont'></span>

<h3>Description</h3>

<p>The function <code><a href="#topic+fit_copula_model_BinCont">fit_copula_model_BinCont()</a></code> fits the copula model for a
continuous surrogate endpoint and binary true endpoint. Because the bivariate
distributions of the surrogate-true endpoint pairs are functionally
independent across treatment groups, a bivariate distribution is fitted in
each treatment group separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_copula_model_BinCont(
  data,
  copula_family,
  marginal_surrogate,
  marginal_surrogate_estimator = NULL,
  twostep = FALSE,
  fitted_model = NULL,
  maxit = 500,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_copula_model_BinCont_+3A_data">data</code></td>
<td>
<p>A data frame in the correct format (See details).</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_copula_family">copula_family</code></td>
<td>
<p>One of the following parametric copula families:
<code>"clayton"</code>, <code>"frank"</code>, <code>"gaussian"</code>, or <code>"gumbel"</code>. The first element in
<code>copula_family</code> corresponds to the control group, the second to the
experimental group.</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_marginal_surrogate">marginal_surrogate</code></td>
<td>
<p>Marginal distribution for the surrogate. For all
available options, see <code>?Surrogate::cdf_fun</code>.</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_marginal_surrogate_estimator">marginal_surrogate_estimator</code></td>
<td>
<p>Not yet implemented</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_twostep">twostep</code></td>
<td>
<p>(boolean) if <code>TRUE</code>, the two step estimator implemented in
<code><a href="#topic+twostep_BinCont">twostep_BinCont()</a></code> is used for estimation.</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Fitted model from which initial values are extracted. If
<code>NULL</code> (default), standard initial values are used. This option intended
for when a model is repeatedly fitted, e.g., in a bootstrap.</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations for the numeric optimization,
defaults to 500.</p>
</td></tr>
<tr><td><code id="fit_copula_model_BinCont_+3A_method">method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>WIP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load Schizophrenia data set.
data("Schizo_BinCont")
# Perform listwise deletion.
na = is.na(Schizo_BinCont$CGI_Bin) | is.na(Schizo_BinCont$PANSS)
X = Schizo_BinCont$PANSS[!na]
Y = Schizo_BinCont$CGI_Bin[!na]
Treat = Schizo_BinCont$Treat[!na]
# Ensure that the treatment variable is binary.
Treat = ifelse(Treat == 1, 1, 0)
data = data.frame(X,
                  Y,
                  Treat)
# Fit copula model.
fitted_model = fit_copula_model_BinCont(data, "clayton", "normal", twostep = FALSE)
# Perform sensitivity analysis with a very low number of replications.
sens_results = sensitivity_analysis_BinCont_copula(
  fitted_model,
  10,
  lower = c(-1,-1,-1,-1),
  upper = c(1, 1, 1, 1),
  n_prec = 1e3
)

</code></pre>

<hr>
<h2 id='fit_copula_submodel_BinCont'>Fit binary-continuous copula submodel</h2><span id='topic+fit_copula_submodel_BinCont'></span>

<h3>Description</h3>

<p>The <code>fit_copula_submodel_BinCont()</code> function fits the copula (sub)model fir a
continuous surrogate and binary true endpoint with maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_copula_submodel_BinCont(
  X,
  Y,
  copula_family,
  marginal_surrogate,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_copula_submodel_BinCont_+3A_x">X</code></td>
<td>
<p>(numeric) Continuous surrogate variable</p>
</td></tr>
<tr><td><code id="fit_copula_submodel_BinCont_+3A_y">Y</code></td>
<td>
<p>(integer) Binary true endpoint variable (<code class="reqn">T_k \, \in \, \{0, 1\}</code>)</p>
</td></tr>
<tr><td><code id="fit_copula_submodel_BinCont_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="fit_copula_submodel_BinCont_+3A_marginal_surrogate">marginal_surrogate</code></td>
<td>
<p>Marginal distribution for the surrogate. For all
available options, see <code>?Surrogate::cdf_fun</code>.</p>
</td></tr>
<tr><td><code id="fit_copula_submodel_BinCont_+3A_method">method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements:
</p>

<ul>
<li><p> ml_fit: object of class <code>maxLik::maxLik</code> that contains the estimated copula
model.
</p>
</li>
<li><p> marginal_S_dist: object of class <code>fitdistrplus::fitdist</code> that represents the
marginal surrogate distribution.
</p>
</li>
<li><p> copula_family: string that indicates the copula family
</p>
</li></ul>


<hr>
<h2 id='fit_model_SurvSurv'>Fit Survival-Survival model</h2><span id='topic+fit_model_SurvSurv'></span>

<h3>Description</h3>

<p>The function <code>fit_model_SurvSurv()</code> fits the copula model for time-to-event
surrogate and true endpoints (Stijven et al., 2022). Because the bivariate
distributions of the surrogate-true endpoint pairs are functionally
independent across treatment groups, a bivariate distribution is fitted in
each treatment group separately. The marginal distributions are based on the
Royston-Parmar survival model (Royston and Parmar, 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_model_SurvSurv(
  data,
  copula_family,
  n_knots = 2,
  fitted_model = NULL,
  method = "BFGS",
  maxit = 500
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_model_SurvSurv_+3A_data">data</code></td>
<td>
<p>A data frame in the correct format (See details).</p>
</td></tr>
<tr><td><code id="fit_model_SurvSurv_+3A_copula_family">copula_family</code></td>
<td>
<p>One of the following parametric copula families:
<code>"clayton"</code>, <code>"frank"</code>, <code>"gaussian"</code>, or <code>"gumbel"</code>. The first element in
<code>copula_family</code> corresponds to the control group, the second to the
experimental group.</p>
</td></tr>
<tr><td><code id="fit_model_SurvSurv_+3A_n_knots">n_knots</code></td>
<td>
<p>Number of internal knots for the Royston-Parmar survival
models for <code class="reqn">\tilde{S}_0</code>, <code class="reqn">T_0</code>, <code class="reqn">\tilde{S}_1</code>, and <code class="reqn">T_1</code>.
If <code>length(n_knots) == 1</code>, the same number of knots are assumed for the
four marginal distributions.</p>
</td></tr>
<tr><td><code id="fit_model_SurvSurv_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Fitted model from which initial values are extracted. If
<code>NULL</code> (default), standard initial values are used. This option intended
for when a model is repeatedly fitted, e.g., in a bootstrap.</p>
</td></tr>
<tr><td><code id="fit_model_SurvSurv_+3A_method">method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td></tr>
<tr><td><code id="fit_model_SurvSurv_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations for the numeric optimization,
defaults to 500.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an S3 object that can be used to perform the sensitivity
analysis with <code><a href="#topic+sensitivity_analysis_SurvSurv_copula">sensitivity_analysis_SurvSurv_copula()</a></code>.
</p>


<h3>Model</h3>

<p>In the causal-inference approach to evaluating surrogate endpoints, the first
step is to estimate the joint distribution of the relevant potential
outcomes. Let <code class="reqn">(T_0, S_0, S_1, T_1)'</code>.  denote the vector of potential
outcomes where <code class="reqn">(S_k, T_k)'</code> is the pair of potential outcomes under
treatment <code class="reqn">Z = k</code>. <code class="reqn">T</code> refers to the true endpoint, e.g., overall
survival. <code class="reqn">S</code> refers to the composite surrogate endpoint, e.g.,
progression-free-survival. Because <code class="reqn">S</code> is usually a composite endpoint
with death as possible event, modeling difficulties arise because <code class="reqn">Pr(S_k
= T_k) &gt; 0</code>.
</p>
<p>Due to difficulties in modeling the composite surrogate and the true endpoint
jointly, the time-to-surrogate event (<code class="reqn">\tilde{S}</code>) is modeled instead of
the time-to-composite surrogate event (<code class="reqn">S</code>). Using this new variable,
<code class="reqn">\tilde{S}</code>, a D-vine copula model is proposed for <code class="reqn">(T_0,
\tilde{S}_0, \tilde{S}_1, T_1)'</code> in Stijven et al. (2022). However, only the
following bivariate distributions are identifiable <code class="reqn">(T_k, \tilde{S}_k)'</code>
for <code class="reqn">k=0,1</code>. The margins in these bivariate distributions are based on
the Royston-Parmar survival model (Roystona and Parmar, 2002). The
association is modeled through two copulas of the same parametric form, but
with unique copula parameters.
</p>
<p>Two modelling choices are made before estimating the two bivariate
distributions described in the previous paragraph:
</p>

<ul>
<li><p> The number of internal knots for the Royston-Parmar survival models. This
is specified through the <code>n_knots</code> argument. The number of knots is assumed
to be equal across the four margins.
</p>
</li>
<li><p> The parametric family of the bivariate copulas. The parametric family is
assumed to be equal across treatment groups. This choice is specified through
the <code>copula_family</code> argument.
</p>
</li></ul>



<h3>Data Format</h3>

<p>The data frame should have the semi-competing risks format. The columns must
be ordered as follows:
</p>

<ul>
<li><p> time to surrogate event, true event, or independent censoring; whichever
comes first
</p>
</li>
<li><p> time to true event, or independent censoring; whichever comes first
</p>
</li>
<li><p> treatment indicator: 0 or 1
</p>
</li>
<li><p> surrogate event indicator: 1 if surrogate event is observed, 0 otherwise
</p>
</li>
<li><p> true event indicator: 1 if true event is observed, 0 otherwise
</p>
</li></ul>

<p>Note that according to the methodology in Stijven et al. (2022), the
surrogate event must not be the composite event. For example, when the
surrogacy of progression-free survival for overall survival is evaluated. The
surrogate event is progression, but not the composite event of progression or
death.
</p>


<h3>Author(s)</h3>

<p>Florian Stijven
</p>


<h3>References</h3>

<p>Stijven, F., Alonso, a., Molenberghs, G., Van Der Elst, W., Van
Keilegom, I. (2024). An information-theoretic approach to the evaluation of
time-to-event surrogates for time-to-event true endpoints based on causal
inference.
</p>
<p>Royston, P., &amp; Parmar, M. K. (2002). Flexible parametric
proportional-hazards and proportional-odds models for censored survival
data, with application to prognostic modelling and estimation of treatment
effects. Statistics in medicine, 21(15), 2175-2197.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sensitivity_analysis_SurvSurv_copula">sensitivity_analysis_SurvSurv_copula()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(require(Surrogate)) {
  data("Ovarian")
  #For simplicity, data is not recoded to semi-competing risks format, but is
  #left in the composite event format.
  data = data.frame(Ovarian$Pfs,
                    Ovarian$Surv,
                    Ovarian$Treat,
                    Ovarian$PfsInd,
                    Ovarian$SurvInd)
  Surrogate::fit_model_SurvSurv(data = data,
                                copula_family = "clayton",
                                n_knots = 1)
}

</code></pre>

<hr>
<h2 id='FixedBinBinIT'>Fits (univariate) fixed-effect models to assess surrogacy in the binary-binary case based on the Information-Theoretic framework</h2><span id='topic+FixedBinBinIT'></span>

<h3>Description</h3>

<p>The function <code>FixedBinBinIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on fixed-effect models when both S and T are binary variables. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedBinBinIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, 
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, 
Number.Bootstraps=50, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedBinBinIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The standard errors and confidence intervals for <code class="reqn">R^2_{h}</code>, <code class="reqn">R^2_{b.ind}</code> and <code class="reqn">R^2_{h.ind}</code> are determined based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are used. Default <code class="reqn">50</code>.</p>
</td></tr>
<tr><td><code id="FixedBinBinIT_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following univariate generalised linear models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{Ti}+\beta_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\gamma_{0i}+\gamma_{1i}Z_{ij}+\gamma_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., a logit link when binary endpoints are considered), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{Ti}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code>. <code class="reqn">\gamma_{0i}</code> and <code class="reqn">\gamma_{1i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code> after accounting for the effect of the surrogate endpoint. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models in each of the <code class="reqn">i</code> trials (i.e., <code class="reqn">L_{1i}</code> and <code class="reqn">L_{2i}</code>, respectively) are subsequently used to compute individual-level surrogacy based on the  so-called Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h}= 1 - \frac{1}{N} \sum_{i} exp \left(-\frac{L_{2i}-L_{1i}}{n_{i}} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials and <code class="reqn">n_{i}</code> is the number of patients within trial <code class="reqn">i</code>.
</p>
<p>When it can be assumed (i) that the treatment-corrected association between the surrogate and the true endpoint is constant across trials, or (ii) when all data come from a single clinical trial (i.e., when <code class="reqn">N=1</code>), the previous expression simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right).</code>
</p>

<p>The upper bound does not reach to 1 when <code class="reqn">T</code> is binary, i.e., its maximum is 0.75. Kent (1983) claims that 0.75 is a reasonable upper bound and thus <code class="reqn">R^2_{h.ind}</code> can usually be interpreted without paying special consideration to the discreteness of <code class="reqn">T</code>. Alternatively, to address the upper bound problem, a scaled version of the mutual information can be used when both <code class="reqn">S</code> and <code class="reqn">T</code> are binary (Joe, 1989):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{b.ind}= \frac{I(T,S)}{min[H(T), H(S)]},</code>
</p>

<p>where the entropy of <code class="reqn">T</code> and <code class="reqn">S</code> in the previous expression can be estimated using the log likelihood functions of the GLMs shown above. 
</p>
<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following univariate models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested a full model approach (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) model (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based based on the Variance Reduction Factor (for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (1) when a semi-reduced model is fitted or on models (2) when a reduced model is fitted. The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>FixedBinBinIT</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h.ind}</code> (single-trial based estimate) and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h}</code> (cluster-based estimate) and its confidence interval (based on a bootsrtrap).</p>
</td></tr>
<tr><td><code>R2b.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{b.ind}</code> (single-trial based estimate accounting for upper bound) and its confidence interval (based on a bootstrap).</p>
</td></tr>
<tr><td><code>R2h.Ind.By.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains individual-level surrogacy estimates <code class="reqn">R^2_{hInd}</code> (cluster-based estimates) and their confidence interval for each of the trials seperately.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>
<p>Joe, H. (1989). Relative entropy measures of multivariate dependence. <em>Journal of the American Statistical Association, 84,</em> 157-164.
</p>
<p>Kent, T. J. (1983). Information gain as a general measure of correlation. <em>Biometrica, 70,</em> 163-173.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FixedBinContIT">FixedBinContIT</a></code>, <code><a href="#topic+FixedContBinIT">FixedContBinIT</a></code>, <code><a href="#topic+plot+20Information-Theoretic+20BinCombn">plot Information-Theoretic BinCombn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Generate data with continuous Surr and True
Sim.Data.MTS(N.Total=5000, N.Trial=50, R.Trial.Target=.9, R.Indiv.Target=.9,
             Fixed.Effects=c(0, 0, 0, 0), D.aa=10, D.bb=10, Seed=1,
             Model=c("Full"))
# Dichtomize Surr and True
Surr_Bin &lt;- Data.Observed.MTS$Surr
Surr_Bin[Data.Observed.MTS$Surr&gt;.5] &lt;- 1
Surr_Bin[Data.Observed.MTS$Surr&lt;=.5] &lt;- 0
True_Bin &lt;- Data.Observed.MTS$True
True_Bin[Data.Observed.MTS$True&gt;.15] &lt;- 1
True_Bin[Data.Observed.MTS$True&lt;=.15] &lt;- 0
Data.Observed.MTS$Surr &lt;- Surr_Bin
Data.Observed.MTS$True &lt;- True_Bin

# Assess surrogacy using info-theoretic framework
Fit &lt;- FixedBinBinIT(Dataset = Data.Observed.MTS, Surr = Surr, 
True = True, Treat = Treat, Trial.ID = Trial.ID, 
Pat.ID = Pat.ID, Number.Bootstraps=100)

# Examine results
summary(Fit)
plot(Fit, Trial.Level = FALSE, Indiv.Level.By.Trial=TRUE)
plot(Fit, Trial.Level = TRUE, Indiv.Level.By.Trial=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='FixedBinContIT'>Fits (univariate) fixed-effect models to assess surrogacy in the case where the true endpoint is binary and the surrogate endpoint is continuous (based on the Information-Theoretic framework)</h2><span id='topic+FixedBinContIT'></span>

<h3>Description</h3>

<p>The function <code>FixedBinContIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on fixed-effect models when T is binary and S is continuous. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedBinContIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, 
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, 
Number.Bootstraps=50,Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedBinContIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The standard errors and confidence intervals for <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{h.ind}</code> are determined based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are used. Default <code class="reqn">50</code>.</p>
</td></tr>
<tr><td><code id="FixedBinContIT_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following univariate generalised linear models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{Ti}+\beta_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\gamma_{0i}+\gamma_{1i}Z_{ij}+\gamma_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., a logit link for binary endpoints and an identity link for normally distributed continuous endpoints), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{Ti}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code>. <code class="reqn">\gamma_{0i}</code> and <code class="reqn">\gamma_{1i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code> after accounting for the effect of the surrogate endpoint. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models in each of the <code class="reqn">i</code> trials (i.e., <code class="reqn">L_{1i}</code> and <code class="reqn">L_{2i}</code>, respectively) are subsequently used to compute individual-level surrogacy based on the  so-called Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h}= 1 - \frac{1}{N} \sum_{i} exp \left(-\frac{L_{2i}-L_{1i}}{n_{i}} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials and <code class="reqn">n_{i}</code> is the number of patients within trial <code class="reqn">i</code>.
</p>
<p>When it can be assumed (i) that the treatment-corrected association between the surrogate and the true endpoint is constant across trials, or (ii) when all data come from a single clinical trial (i.e., when <code class="reqn">N=1</code>), the previous expression simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right).</code>
</p>

<p>The upper bound does not reach to 1 when <code class="reqn">T</code> is binary, i.e., its maximum is 0.75. Kent (1983) claims that 0.75 is a reasonable upper bound and thus <code class="reqn">R^2_{h.ind}</code> can usually be interpreted without paying special consideration to the discreteness of <code class="reqn">T</code>. Alternatively, to address the upper bound problem, a scaled version of the mutual information can be used when both <code class="reqn">S</code> and <code class="reqn">T</code> are binary (Joe, 1989):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{b.ind}= \frac{I(T,S)}{min[H(T), H(S)]},</code>
</p>

<p>where the entropy of <code class="reqn">T</code> and <code class="reqn">S</code> in the previous expression can be estimated using the log likelihood functions of the GLMs shown above. 
</p>
<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following univariate models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested a full model approach (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) model (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based based on the Variance Reduction Factor (for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (1) when a semi-reduced model is fitted or on models (2) when a reduced model is fitted. The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>FixedBinContIT</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h.ind}</code> (single-trial based estimate) and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h}</code> (cluster-based estimate) and its confidence interval (bootstrap-based).</p>
</td></tr>
<tr><td><code>R2b.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{b.ind}</code> (single-trial based estimate accounting for upper bound) and its confidence interval (based on a bootstrap).</p>
</td></tr>
<tr><td><code>R2h.Ind.By.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains individual-level surrogacy estimates <code class="reqn">R^2_{h}</code> (cluster-based estimate) and their confidence interval for each of the trials seperately.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>
<p>Joe, H. (1989). Relative entropy measures of multivariate dependence. <em>Journal of the American Statistical Association, 84,</em> 157-164.
</p>
<p>Kent, T. J. (1983). Information gain as a general measure of correlation. <em>Biometrica, 70,</em> 163-173.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FixedBinBinIT">FixedBinBinIT</a></code>, <a href="#topic+FixedContBinIT">FixedContBinIT</a>, <code><a href="#topic+plot+20Information-Theoretic+20BinCombn">plot Information-Theoretic BinCombn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Generate data with continuous Surr and True
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, 
R.Indiv.Target=.8, Seed=123, Model="Full")

# Make T binary
Data.Observed.MTS$True_Bin &lt;- Data.Observed.MTS$True
Data.Observed.MTS$True_Bin[Data.Observed.MTS$True&gt;=0] &lt;- 1
Data.Observed.MTS$True_Bin[Data.Observed.MTS$True&lt;0] &lt;- 0

# Analyze data
Fit &lt;- FixedBinContIT(Dataset = Data.Observed.MTS, Surr = Surr, 
True = True_Bin, Treat = Treat, Trial.ID = Trial.ID, Pat.ID = Pat.ID, 
Model = "Full", Number.Bootstraps=50)

# Examine results
summary(Fit)
plot(Fit, Trial.Level = FALSE, Indiv.Level.By.Trial=TRUE)
plot(Fit, Trial.Level = TRUE, Indiv.Level.By.Trial=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='FixedContBinIT'>Fits (univariate) fixed-effect models to assess surrogacy in the case where the true endpoint is continuous and the surrogate endpoint is binary (based on the Information-Theoretic framework)</h2><span id='topic+FixedContBinIT'></span>

<h3>Description</h3>

<p>The function <code>FixedContBinIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on fixed-effect models when T is continuous normally distributed and S is binary. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedContBinIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, 
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, 
Number.Bootstraps=50,Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedContBinIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The standard error and confidence interval for <code class="reqn">R^2_{h.ind}</code> is determined based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are used. Default <code class="reqn">50</code>.</p>
</td></tr>
<tr><td><code id="FixedContBinIT_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following univariate generalised linear models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{Ti}+\beta_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\gamma_{0i}+\gamma_{1i}Z_{ij}+\gamma_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., a logit link for binary endpoints and an identity link for normally distributed continuous endpoints), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{Ti}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code>. <code class="reqn">\gamma_{0i}</code> and <code class="reqn">\gamma_{1i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code> after accounting for the effect of the surrogate endpoint. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models in each of the <code class="reqn">i</code> trials (i.e., <code class="reqn">L_{1i}</code> and <code class="reqn">L_{2i}</code>, respectively) are subsequently used to compute individual-level surrogacy based on the  so-called Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h}= 1 - \frac{1}{N} \sum_{i} exp \left(-\frac{L_{2i}-L_{1i}}{n_{i}} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials and <code class="reqn">n_{i}</code> is the number of patients within trial <code class="reqn">i</code>.
</p>
<p>When it can be assumed (i) that the treatment-corrected association between the surrogate and the true endpoint is constant across trials, or (ii) when all data come from a single clinical trial (i.e., when <code class="reqn">N=1</code>), the previous expression simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right).</code>
</p>

<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following univariate models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested a full model approach (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) model (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based based on the Variance Reduction Factor (for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (1) when a semi-reduced model is fitted or on models (2) when a reduced model is fitted. The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>FixedContBinIT</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>

<tr><td><code>R2h</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h}</code> (cluster-based estimate) and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate <code class="reqn">R^2_{h.ind}</code> (single-trial based estimate) and its confidence interval based on a bootstrap. The <code class="reqn">R^2_{h.ind}</code> shown is the mean of the bootstrapped values.</p>
</td></tr>
<tr><td><code>R2h.Ind.By.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains individual-level surrogacy estimates <code class="reqn">R^2_{h}</code> (cluster-based estimate) and their confidence interval for each of the trials seperately.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FixedBinBinIT">FixedBinBinIT</a></code>, <a href="#topic+FixedBinContIT">FixedBinContIT</a>, <code><a href="#topic+plot+20Information-Theoretic+20BinCombn">plot Information-Theoretic BinCombn</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Generate data with continuous Surr and True
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, 
R.Indiv.Target=.8, Seed=123, Model="Full")

# Make S binary
Data.Observed.MTS$Surr_Bin &lt;- Data.Observed.MTS$Surr
Data.Observed.MTS$Surr_Bin[Data.Observed.MTS$Surr&gt;=0] &lt;- 1
Data.Observed.MTS$Surr_Bin[Data.Observed.MTS$Surr&lt;0] &lt;- 0

# Analyze data
Fit &lt;- FixedContBinIT(Dataset = Data.Observed.MTS, Surr = Surr_Bin, 
True = True, Treat = Treat, Trial.ID = Trial.ID, Pat.ID = Pat.ID, 
Model = "Full", Number.Bootstraps=50)

# Examine results
summary(Fit)
plot(Fit, Trial.Level = FALSE, Indiv.Level.By.Trial=TRUE)
plot(Fit, Trial.Level = TRUE, Indiv.Level.By.Trial=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='FixedContContIT'>Fits (univariate) fixed-effect models to assess surrogacy in the continuous-continuous case based on the Information-Theoretic framework</h2><span id='topic+FixedContContIT'></span>

<h3>Description</h3>

<p>The function <code>FixedContContIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on fixed-effect models when both S and T are continuous variables. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedContContIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, 
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, 
Alpha=.05, Number.Bootstraps=500, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedContContIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The standard error and confidence interval for <code class="reqn">R^2_{h}</code> is determined based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are used. Default <code class="reqn">500</code>.</p>
</td></tr>
<tr><td><code id="FixedContContIT_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following univariate generalised linear models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{Ti}+\beta_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\gamma_{0i}+\gamma_{1i}Z_{ij}+\gamma_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., an identity link when a continuous true endpoint is considered), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{Ti}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code>. <code class="reqn">\gamma_{0i}</code> and <code class="reqn">\gamma_{1i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code> after accounting for the effect of the surrogate endpoint. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models in each of the <code class="reqn">i</code> trials (i.e., <code class="reqn">L_{1i}</code> and <code class="reqn">L_{2i}</code>, respectively) are subsequently used to compute individual-level surrogacy based on the  so-called Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind}= 1 - \frac{1}{N} \sum_{i} exp \left(-\frac{L_{2i}-L_{1i}}{n_{i}} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials and <code class="reqn">n_{i}</code> is the number of patients within trial <code class="reqn">i</code>.
</p>
<p>When it can be assumed (i) that the treatment-corrected association between the surrogate and the true endpoint is constant across trials, or (ii) when all data come from a single clinical trial (i.e., when <code class="reqn">N=1</code>), the previous expression simplifies to:
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind.clust}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right).</code>
</p>

<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following univariate models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested a full model approach (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) model (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based based on the Variance Reduction Factor (for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (1) when a semi-reduced model is fitted or on models (2) when a reduced model is fitted. The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>FixedContContIT</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind.clust</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate and its confidence interval under the assumption that the treatment-corrected association between the surrogate and the true endpoints is constant across trials or when all data come from a single clinical trial.</p>
</td></tr>
<tr><td><code>Boot.CI</code></td>
<td>
<p>A <code>data.frame</code> that contains the bootstrapped <code>R2h.Single</code> values.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>) that are obtained when models (1) or models (2) are fitted (see the <b>Details</b> section above).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MixedContContIT">MixedContContIT</a></code>, <code><a href="#topic+FixedContBinIT">FixedContBinIT</a></code>,  <code><a href="#topic+FixedBinContIT">FixedBinContIT</a></code>,
<code><a href="#topic+FixedBinBinIT">FixedBinBinIT</a></code>, <code><a href="#topic+plot+20Information-Theoretic">plot Information-Theoretic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
# Based on the ARMD data

data(ARMD)
# Assess surrogacy based on a full fixed-effect model
# in the information-theoretic framework:
Sur &lt;- FixedContContIT(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center,
Pat.ID=Id, Model="Full", Number.Bootstraps=50)
# Obtain a summary of the results:
summary(Sur)

## Not run:  #time consuming code
# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients, 100 trials,
# and Rindiv=Rtrial=.8

# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
             Seed=123, Model="Full")
# Assess surrogacy based on a full fixed-effect model
# in the information-theoretic framework:
Sur2 &lt;- FixedContContIT(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat,
Trial.ID=Trial.ID, Pat.ID=Pat.ID, Model="Full", Number.Bootstraps=50)

# Show a summary of the results:
summary(Sur2)
## End(Not run)
</code></pre>

<hr>
<h2 id='FixedDiscrDiscrIT'>Investigates surrogacy for binary or ordinal outcomes using the Information Theoretic framework</h2><span id='topic+FixedDiscrDiscrIT'></span>

<h3>Description</h3>

<p>The function <code>FixedDiscrDiscrIT</code> uses the information theoretic
approach (Alonso and Molenberghs 2007) to estimate trial and individual level
surrogacy based on fixed-effects models when the surrogate is binary and the 
true outcome is ordinal, the converse case or when both outcomes are ordinal 
(the user must specify which form the data is in). The user can specify whether
a weighted or unweighted analysis is required at the trial level. The penalized
likelihood approach of Firth (1993) is applied to resolve issues of separation in discrete outcomes for particular trials. Requires packages <code>OrdinalLogisticBiplot</code> and <code>logistf</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FixedDiscrDiscrIT(Dataset, Surr, True, Treat, Trial.ID, 
Weighted = TRUE, Setting = c("binord"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FixedDiscrDiscrIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true outcome value, a treatment indicator and a trial ID.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate outcome values.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true outcome values.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the  in <code>Dataset</code> that contains the treatment group values, 0/1 or -1/+1 are recommended.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="FixedDiscrDiscrIT_+3A_setting">Setting</code></td>
<td>
<p>Specifies whether an ordinal or binary surrogate or true outcome are present in <code>Dataset</code>. <code>Setting=c("binord")</code> for a binary surrogate and ordinal true outcome, <code>Setting=c("ordbin")</code> for an ordinal surrogate and binary true outcome and <code>Setting=c("ordord")</code> where both outcomes are ordinal.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual level surrogacy</em>
</p>
<p>The following univariate logistic regression models are fitted when <code>Setting=c("ordbin")</code>:
</p>
<p style="text-align: center;"><code class="reqn">logit(P(T_{ij}=1))=\mu_{Ti}+\beta_{i}Z_{ij},    (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">logit(P(T_{ij}=1|S_{ij}=s))=\gamma_{0i}+\gamma_{1i}Z_{ij}+\gamma_{2i}S_{ij},    (1)</code>
</p>

<p>where: <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators; <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true outcome values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>; and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>; <code class="reqn">\mu_{Ti}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code>; and <code class="reqn">\gamma_{0i}</code> and <code class="reqn">\gamma_{1i}</code> are the trial-specific intercepts and treatment-effects on the true endpoint in trial <code class="reqn">i</code> after accounting for the effect of the surrogate endpoint.
The <code class="reqn">-2</code> log likelihood values of the previous models in each of the <code class="reqn">i</code> trials (i.e., <code class="reqn">L_{1i}</code> and <code class="reqn">L_{2i}</code>, respectively) are subsequently used to compute individual-level surrogacy based on the  so-called Likelihood Reduction Factor (LRF; for details, see Alonso &amp; Molenberghs, 2006):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h}= 1 - \frac{1}{N} \sum_{i} exp \left(-\frac{L_{2i}-L_{1i}}{n_{i}} \right),      </code>
</p>

<p>where <code class="reqn">N</code> is the number of trials and <code class="reqn">n_{i}</code> is the number of patients within trial <code class="reqn">i</code>.
</p>
<p>At the individual level in the discrete case <code class="reqn">R^2_{h}</code> is bounded above by a number strictly less than one and is re-scaled (see Alonso &amp; Molenberghs (2007)):
</p>
<p style="text-align: center;"><code class="reqn">\widehat{R^2_{h}}= \frac{R^2_{h}}{1-e^{-2L_{0}}},</code>
</p>

<p>where <code class="reqn">L_{0}</code> is the log-likelihood of the intercept only model of the true outcome (<code class="reqn">logit(P(T_{ij}=1)=\gamma_{3}</code>).
</p>
<p>In the case of <code>Setting=c("binord")</code> or <code>Setting=c("ordord")</code> proportional odds models in (1) are used to accommodate the ordinal true response outcome, in all other respects the calculation of <code class="reqn">R^2_{h}</code> would proceed in the same manner.
</p>
<p><em>Trial-level surrogacy</em>
</p>
<p>When  <code>Setting=c("ordbin")</code> trial-level surrogacy is assessed by fitting the following univariate logistic regression and proportional odds models for the ordinal surrogate and binary true response variables regressed on treatment for each trial <code class="reqn">i</code>: 
</p>
<p style="text-align: center;"><code class="reqn">logit(P(S_{ij} \leq W))=\mu_{S_{wi}}+\alpha_{i}Z_{ij},   (2)</code>
</p>
 
<p style="text-align: center;"><code class="reqn">logit(P(T_{ij}=1))=\mu_{Ti}+\beta_{i}Z_{ij},   (2)</code>
</p>
 
<p>where: <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators; <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true outcome values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>; <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>; <code class="reqn">\mu_{S_{wi}}</code> are the trial-specific intercept values for each cut point <code class="reqn">w</code>, where <code class="reqn">w=1,..,W-1</code>, of the ordinal surrogate outcome; <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for T; and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The mean trial-specific intercepts for the surrogate are calculated, <code class="reqn">\overline{\mu}_{S_{wi}}</code>.The following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\overline{\mu}}_{S_{wi}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\overline{\mu}_{S_{wi}}</code>, and <code class="reqn">\alpha_i</code> are based on models (2) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (2) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) model (2) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the Likelihood Reduction Factor (for details, see Alonso &amp; Molenberghs, 2006):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When separation (the presence of zero cells) occurs in the cross tabs of treatment and the true or surrogate outcome for a particular trial in models (2) extreme bias can occur in <code class="reqn">R^2_{ht}</code>. Under separation there are no unique maximum likelihood for parameters <code class="reqn">\beta_i</code>, <code class="reqn">\overline{\mu}_{S_{wi}}</code> and <code class="reqn">\alpha_i</code>, in (2), for the affected trial <code class="reqn">i</code>. This typically leads to extreme bias in the estimation of these parameters and hence outlying influential points in model (3), bias in <code class="reqn">R^2_{ht}</code> inevitably follows. 
</p>
<p>To resolve the issue of separation the penalized likelihood approach of Firth (1993) is applied. This approach adds an asymptotically negligible component to the score function to allow unbiased estimation of <code class="reqn">\beta_i</code>, <code class="reqn">\overline{\mu}_{S_{wi}}</code>, and <code class="reqn">\alpha_i</code> and in turn <code class="reqn">R^2_{ht}</code>. The penalized likelihood R function <code>logitf</code> from the package of the same name is applied in the case of binary separation (Heinze and Schemper, 2002). The function <code>pordlogistf</code> from the package <code>OrdinalLogisticBioplot</code> is applied in the case of ordinal separation (Hern'andez, 2013). All instances of separation are reported.
</p>
<p>In the case of <code>Setting=c("binord")</code> or <code>Setting=c("ordord")</code> the appropriate models (either logistic regression or a proportional odds models) are fitted in (2) to accommodate the form (either binary or ordinal) of the true or surrogate response variable. The rest of the analysis would proceed in a similar manner as that described above.
</p>


<h3>Value</h3>

<p>An object of class <code>FixedDiscrDiscrIT</code> with components, 
</p>
<table>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints. Also, the number of observations per trial; whether the trial was able to be included in the analysis for both <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>; whether separation occurred and hence the penalized likelihood approach used for the surrogate or true outcome.</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate and its confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hannah M. Ensor &amp; Christopher J. Weir
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>
<p>Alonso, A, &amp; Molenberghs, G., Geys, H., Buyse, M. &amp; Vangeneugden, T. (2006). A unifying approach for surrogate marker validation based on Prentice's criteria. <em>Statistics in medicine, 25,</em> 205-221.
</p>
<p>Firth, D. (1993). Bias reduction of maximum likelihood estimates. <em>Biometrika, 80,</em> 27-38.
</p>
<p>Heinze, G. &amp; Schemper, M. 2002. A solution to the problem of separation in logistic regression.  <em>Statistics in medicine, 21,</em> 2409-2419.
</p>
<p>Hern'andez, J. C. V.-V. O., J. L. 2013. OrdinalLogisticBiplot: Biplot representations of ordinal variables. R.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FixedContContIT">FixedContContIT</a></code>, <code><a href="#topic+plot+20Information-Theoretic">plot Information-Theoretic</a></code>, <code><a href="logistf.html#topic+logistf">logistf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  # Time consuming (&gt;5sec) code part
# Example 1
# Conduct an analysis based on a simulated dataset with 2000 patients, 100 trials,
# and Rindiv=Rtrial=.8

# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Full")

# create a binary true and ordinal surrogate outcome
Data.Observed.MTS$True&lt;-findInterval(Data.Observed.MTS$True, 
c(quantile(Data.Observed.MTS$True,0.5)))
Data.Observed.MTS$Surr&lt;-findInterval(Data.Observed.MTS$Surr, 
c(quantile(Data.Observed.MTS$Surr,0.333),quantile(Data.Observed.MTS$Surr,0.666)))

# Assess surrogacy based on a full fixed-effect model
# in the information-theoretic framework for a binary surrogate and ordinal true outcome:
SurEval &lt;- FixedDiscrDiscrIT(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat,
Trial.ID=Trial.ID, Setting="ordbin")

# Show a summary of the results:
summary(SurEval)
SurEval$Trial.Spec.Results
SurEval$R2h
SurEval$R2ht

## End(Not run)
</code></pre>

<hr>
<h2 id='frank_loglik_copula_scale'>Loglikelihood on the Copula Scale for the Frank Copula</h2><span id='topic+frank_loglik_copula_scale'></span>

<h3>Description</h3>

<p><code>frank_loglik_copula_scale()</code> computes the loglikelihood on the copula
scale for the Frank copula which is parameterized by <code>theta</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn"> C(u, v) = - \frac{1}{\theta} \log \left[ 1 - \frac{(1 - e^{-\theta u})(1 - e^{-\theta v})}{1 - e^{-\theta}} \right]</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>frank_loglik_copula_scale(theta, u, v, d1, d2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="frank_loglik_copula_scale_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="frank_loglik_copula_scale_+3A_u">u</code></td>
<td>
<p>A numeric vector. Corresponds to first variable on the copula scale.</p>
</td></tr>
<tr><td><code id="frank_loglik_copula_scale_+3A_v">v</code></td>
<td>
<p>A numeric vector. Corresponds to second variable on the copula
scale.</p>
</td></tr>
<tr><td><code id="frank_loglik_copula_scale_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="frank_loglik_copula_scale_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the copula loglikelihood evaluated in <code>theta</code>.
</p>

<hr>
<h2 id='gaussian_loglik_copula_scale'>Loglikelihood on the Copula Scale for the Gaussian Copula</h2><span id='topic+gaussian_loglik_copula_scale'></span>

<h3>Description</h3>

<p><code>gaussian_loglik_copula_scale()</code> computes the loglikelihood on the copula
scale for the Gaussian copula which is parameterized by <code>theta</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn">C(u, v) = \Psi \left[ \Phi^{-1} (u), \Phi^{-1} (v) | \rho \right]</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>gaussian_loglik_copula_scale(theta, u, v, d1, d2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gaussian_loglik_copula_scale_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="gaussian_loglik_copula_scale_+3A_u">u</code></td>
<td>
<p>A numeric vector. Corresponds to first variable on the copula scale.</p>
</td></tr>
<tr><td><code id="gaussian_loglik_copula_scale_+3A_v">v</code></td>
<td>
<p>A numeric vector. Corresponds to second variable on the copula
scale.</p>
</td></tr>
<tr><td><code id="gaussian_loglik_copula_scale_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="gaussian_loglik_copula_scale_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the copula loglikelihood evaluated in <code>theta</code>.
</p>

<hr>
<h2 id='gumbel_loglik_copula_scale'>Loglikelihood on the Copula Scale for the Gumbel Copula</h2><span id='topic+gumbel_loglik_copula_scale'></span>

<h3>Description</h3>

<p><code>gumbel_loglik_copula_scale()</code> computes the loglikelihood on the copula
scale for the Gumbel copula which is parameterized by <code>theta</code> as follows:
</p>
<p style="text-align: center;"><code class="reqn">C(u, v) = \exp \left[ - \left\{ (-\log u)^{\theta} + (-\log v)^{\theta} \right\}^{\frac{1}{\theta}} \right]</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>gumbel_loglik_copula_scale(theta, u, v, d1, d2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gumbel_loglik_copula_scale_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="gumbel_loglik_copula_scale_+3A_u">u</code></td>
<td>
<p>A numeric vector. Corresponds to first variable on the copula scale.</p>
</td></tr>
<tr><td><code id="gumbel_loglik_copula_scale_+3A_v">v</code></td>
<td>
<p>A numeric vector. Corresponds to second variable on the copula
scale.</p>
</td></tr>
<tr><td><code id="gumbel_loglik_copula_scale_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="gumbel_loglik_copula_scale_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the copula loglikelihood evaluated in <code>theta</code>.
</p>

<hr>
<h2 id='ICA_given_model_constructor'>Constructor for the function that returns that ICA as a function of the
identifiable parameters</h2><span id='topic+ICA_given_model_constructor'></span>

<h3>Description</h3>

<p><code><a href="#topic+ICA_given_model_constructor">ICA_given_model_constructor()</a></code> returns a function fixes the unidentifiable
parameters at user-specified values and takes the identifiable parameters as
argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA_given_model_constructor(
  fitted_model,
  copula_par_unid,
  copula_family2,
  rotation_par_unid,
  n_prec,
  measure = "ICA",
  mutinfo_estimator,
  composite,
  seed,
  restr_time = +Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA_given_model_constructor_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_copula_par_unid">copula_par_unid</code></td>
<td>
<p>Parameter vector for the sequence of <em>unidentifiable</em>
bivariate copulas that define the D-vine copula. The elements of
<code>copula_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_rotation_par_unid">rotation_par_unid</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
<em>unidentifiable</em> bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_measure">measure</code></td>
<td>
<p>Compute intervals for which measure of surrogacy? Defaults to
<code>"ICA"</code>. See first column names of <code>sens_results</code> for other possibilities.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
<tr><td><code id="ICA_given_model_constructor_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A function that computes the ICA as a function of the identifiable
parameters. In this computation, the unidentifiable parameters are fixed at
the values supplied as arguments to <code><a href="#topic+ICA_given_model_constructor">ICA_given_model_constructor()</a></code>
</p>

<hr>
<h2 id='ICA.BinBin'>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case</h2><span id='topic+ICA.BinBin'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinBin</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinBin(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_, pi_0_1,
Monotonicity=c("General"), Sum_Pi_f = seq(from=0.01, to=0.99, by=.01),
M=10000, Volume.Perc=0, Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>. A vector is specified to account for uncertainty, i.e., rather than keeping <code class="reqn">P(T=1,S=1|Z=0)</code> fixed at one estimated value, a distribution can be specified (see <b>examples</b> below) from which a value is drawn in each run.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar or vector that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. See <b>Details</b> below. Default <code>Monotonicity=c("General")</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_sum_pi_f">Sum_Pi_f</code></td>
<td>
<p>A scalar or vector that specifies the grid of values <code class="reqn">G={g_{1},\: g_{2},\:...,\: g_{k}}</code> to be considered when the sensitivity analysis is conducted. See <b>Details</b> below. Default <code>Sum_Pi_f = seq(from=0.01, to=0.99, by=.01)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_m">M</code></td>
<td>
<p>The number of runs that are conducted for a given value of <code>Sum_Pi_f</code>. This argument is not used when <code>Volume.Perc=0</code>. Default <code>M=10000</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_volume.perc">Volume.Perc</code></td>
<td>
<p>Note that the marginals that are observable in the data set a number of restrictions on the unidentified correlations. For example, under montonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, it holds that <code class="reqn">\pi_{0111}&lt;=min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})</code> and <code class="reqn">\pi_{1100}&lt;=min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})</code>. For example, when <code class="reqn">min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})=0.10</code> and <code class="reqn">min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})=0.08</code>, then all valid  <code class="reqn">\pi_{0111}&lt;=0.10</code> and  all valid <code class="reqn">\pi_{1100}&lt;=0.08</code>. The argument <code>Volume.Perc</code> specifies the fraction  of the 'volume' of the paramater space that is explored. This volume is computed based on the grids G={0, 0.01, ..., maximum possible value for the counterfactual probability at hand}. E.g., in the previous example, the 'volume' of the parameter space would be <code class="reqn">11*9=99</code>, and when e.g., the argument <code>Volume.Perc=1</code> is used a total of <code class="reqn">99</code> runs will be conducted for each given value of <code>Sum_Pi_f</code>. Notice that when monotonicity is not assumed, relatively high values of <code>Volume.Perc</code> will lead to a large number of runs and consequently a long analysis time.</p>
</td></tr>
<tr><td><code id="ICA.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>Seed=sample(1:100000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles.
</p>
<p>The function <code>ICA.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> based on plausible values of the potential outcomes. Denote by <code class="reqn">\bold{Y}'=(T_0,T_1,S_0,S_1)</code> the vector of potential outcomes. The vector <code class="reqn">\bold{Y}</code> can take 16 values and the set of parameters <code class="reqn">\pi_{ijpq}=P(T_0=i,T_1=j,S_0=p,S_1=q)</code> (with <code class="reqn">i,j,p,q=0/1</code>) fully characterizes its distribution.
</p>
<p>However, the parameters in <code class="reqn">\pi_{ijpq}</code> are not all functionally independent, e.g., <code class="reqn">1=\pi_{\cdot\cdot\cdot\cdot}</code>. When no assumptions regarding monotonicity are made, the data impose a total of <code class="reqn">7</code> restrictions, and thus only <code class="reqn">9</code> proabilities in <code class="reqn">\pi_{ijpq}</code> are allowed to vary freely (for details, see Alonso et al., 2014). Based on the data and assuming SUTVA, the marginal probabilites <code class="reqn">\pi_{1 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{1 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 0}</code>, <code class="reqn">\pi_{0 \cdot 1 \cdot}</code>, and <code class="reqn">\pi_{\cdot 0 \cdot 1}</code> can be computed (by hand or using the function <code><a href="#topic+MarginalProbs">MarginalProbs</a></code>). Define the vector
</p>
<p style="text-align: center;"><code class="reqn">\bold{b}'=(1, \pi_{1 \cdot 1 \cdot}, \pi_{1 \cdot 0 \cdot}, \pi_{\cdot 1 \cdot 1}, \pi_{\cdot 1 \cdot 0}, \pi_{0 \cdot 1 \cdot}, \pi_{\cdot 0 \cdot 1})</code>
</p>
<p> and <code class="reqn">\bold{A}</code> is a contrast matrix such that the identified restrictions can be written as a system of linear equation
</p>
<p style="text-align: center;"><code class="reqn">\bold{A \pi} = \bold{b}.</code>
</p>

<p>The matrix <code class="reqn">\bold{A}</code> has rank <code class="reqn">7</code> and can be partitioned as <code class="reqn">\bold{A=(A_r | A_f)}</code>, and similarly the vector <code class="reqn">\bold{\pi}</code> can be partitioned as <code class="reqn">\bold{\pi^{'}=(\pi_r^{'} | \pi_f^{'})}</code> (where <code class="reqn">f</code> refers to the submatrix/vector given by the <code class="reqn">9</code> last columns/components of <code class="reqn">\bold{A/\pi}</code>). Using these partitions the previous system of linear equations can be rewritten as
</p>
<p style="text-align: center;"><code class="reqn">\bold{A_r \pi_r + A_f \pi_f = b}.</code>
</p>

<p>The following algorithm is used to generate plausible distributions for <code class="reqn">\bold{Y}</code>. First, select a value of the specified grid of values (specified using <code>Sum_Pi_f</code> in the function call).  For <code class="reqn">k=1</code> to <code class="reqn">M</code> (specified using <code>M</code> in the function call), generate a vector <code class="reqn">\pi_f</code> that contains <code class="reqn">9</code> components that are uniformly sampled from hyperplane subject to the restriction that the sum of the generated components equals <code>Sum_Pi_f</code> (the function <code><a href="#topic+RandVec">RandVec</a></code>, which uses the <code>randfixedsum</code> algorithm written by Roger Stafford, is used  to obtain these components). Next, <code class="reqn">\bold{\pi_r=A_r^{-1}(b - A_f \pi_f)}</code> is computed and the <code class="reqn">\pi_r</code> vectors where all components are in the <code class="reqn">[0;\:1]</code> range are retained. This procedure is repeated for each of the <code>Sum_Pi_f</code> values.  Based on these results, <code class="reqn">R_H^2</code> is estimated. The obtained values can be used to conduct a sensitivity analysis during the validation exercise.
</p>
<p>The previous developments hold when no monotonicity is assumed. When monotonicity for <code class="reqn">S</code>, <code class="reqn">T</code>, or for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed, some of the probabilities of <code class="reqn">\pi</code> are zero. For example, when montonicity is assumed for <code class="reqn">T</code>, then <code class="reqn">P(T_0 &lt;= T_1)=1</code>, or equivantly, <code class="reqn">\pi_{1000}=\pi_{1010}=\pi_{1001}=\pi_{1011}=0</code>. When monotonicity is assumed, the procedure described above is modified accordingly (for details, see Alonso et al., 2014). When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>.)
</p>
<p>To account for the uncertainty in the estimation of the marginal probabilities, a vector of values can be specified from which a random draw is made in each run (see <b>Examples</b> below).
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr><td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>Monotonicity</code></td>
<td>
<p>The assumption regarding monotonicity that was made.</p>
</td></tr>
<tr><td><code>Volume.No</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity is not assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used (i.e., when it is not equal to <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code>Volume.T</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">T</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td></tr>
<tr><td><code>Volume.S</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td></tr>
<tr><td><code>Volume.ST</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed. Is only provided when the argument <code class="reqn">Volume.Perc</code> is used.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Time consuming code part
# Compute R2_H given the marginals specified as the pi's, making no
# assumptions regarding monotonicity (general case)
ICA &lt;- ICA.BinBin(pi1_1_=0.2619048, pi1_0_=0.2857143, pi_1_1=0.6372549,
pi_1_0=0.07843137, pi0_1_=0.1349206, pi_0_1=0.127451, Seed=1,
Monotonicity=c("General"), Sum_Pi_f = seq(from=0.01, to=.99, by=.01), M=10000)

# obtain plot of the results
plot(ICA, R2_H=TRUE)

# Example 2 where the uncertainty in the estimation
# of the marginals is taken into account
ICA_BINBIN2 &lt;- ICA.BinBin(pi1_1_=runif(10000, 0.2573, 0.4252),
pi1_0_=runif(10000, 0.1769, 0.3310),
pi_1_1=runif(10000, 0.5947, 0.7779),
pi_1_0=runif(10000, 0.0322, 0.1442),
pi0_1_=runif(10000, 0.0617, 0.1764),
pi_0_1=runif(10000, 0.0254, 0.1315),
Monotonicity=c("General"),
Sum_Pi_f = seq(from=0.01, to=0.99, by=.01),
M=50000, Seed=1)

# Plot results
plot(ICA_BINBIN2)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.BinBin.CounterAssum'>ICA (binary-binary setting) that is obtaied when the counterfactual correlations are assumed to fall within some prespecified ranges.</h2><span id='topic+ICA.BinBin.CounterAssum'></span>

<h3>Description</h3>

<p>Shows the results of ICA (binary-binary setting) in the subgroup of results where the counterfactual correlations are assumed to fall within some prespecified ranges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinBin.CounterAssum(x, r2_h_S0S1_min, r2_h_S0S1_max, r2_h_S0T1_min, 
r2_h_S0T1_max, r2_h_T0T1_min, r2_h_T0T1_max, r2_h_T0S1_min, r2_h_T0S1_max, 
Monotonicity="General", Type="Freq", MainPlot=" ", Cex.Legend=1, 
Cex.Position="topright", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.BinBin</code>. See <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_s0s1_min">r2_h_S0S1_min</code></td>
<td>
<p>The minimum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(S_0,S_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_s0s1_max">r2_h_S0S1_max</code></td>
<td>
<p>The maximum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(S_0,S_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_s0t1_min">r2_h_S0T1_min</code></td>
<td>
<p>The minimum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(S_0,T_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_s0t1_max">r2_h_S0T1_max</code></td>
<td>
<p>The maximum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(S_0,T_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_t0t1_min">r2_h_T0T1_min</code></td>
<td>
<p>The minimum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(T_0,T_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_t0t1_max">r2_h_T0T1_max</code></td>
<td>
<p>The maximum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(T_0,T_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_t0s1_min">r2_h_T0S1_min</code></td>
<td>
<p>The minimum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(T_0,S_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_r2_h_t0s1_max">r2_h_T0S1_max</code></td>
<td>
<p>The maximum value to be considered for the counterfactual correlation <code class="reqn">r^2_h(T_0,S_1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies whether the all results in the fitted object <code>ICA.BinBin</code> should be shown (i.e., <code>Monotonicity=c("General")</code>), or a subset of the results arising under specific assumptions (i.e., <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>). Default <code>Monotonicity=c("General")</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code> or <code>Type="Density"</code>, the Y-axis shows frequencies or densities of <code class="reqn">R^2_{H}</code>.  When <code>Type="All.Densities"</code> and the fitted object of class <code>ICA.BinBin</code> was obtained using a general analysis (i.e., conducting the analyses assuming no monotonicity, monotonicity for <code class="reqn">S</code> alone, monotonicity for <code class="reqn">T</code> alone, and for both <code class="reqn">S</code> and <code class="reqn">T</code>, so using <code>Monotonicity=c("General")</code> in the function call of <code>ICA.BinBin</code>), the density plots are shown for the four scenarios where different assumptions regarding monotonicity are made. Default <code>"Freq"</code>.</p>
</td></tr>  
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_mainplot">MainPlot</code></td>
<td>
<p>The title of the plot. Default <code>" "</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_cex.legend">Cex.Legend</code></td>
<td>
<p>The size of the legend when <code>Type="All.Densities"</code> is used. Default <code>Cex.Legend=1</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_cex.position">Cex.Position</code></td>
<td>
<p>The position of the legend, <code>Cex.Position="topright"</code> or <code>Cex.Position="topleft"</code>. Default <code>Cex.Position="topright"</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.CounterAssum_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>
<p>Van der Elst, W., Alonso, A., &amp; Molenberghs, G. (submitted). An exploration of the relationship between causal inference and meta-analytic measures of surrogacy.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.BinBin">ICA.BinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #Time consuming (&gt;5 sec) code part
# Compute R2_H given the marginals specified as the pi's, making no 
# assumptions regarding monotonicity (general case)
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.261, pi1_0_=0.285, 
pi_1_1=0.637, pi_1_0=0.078, pi0_1_=0.134, pi_0_1=0.127,  
Monotonicity=c("General"), M=5000, Seed=1)

# Obtain a density plot of R2_H, assuming that 
# r2_h_S0S1&gt;=.2, r2_h_S0T1&gt;=0, r2_h_T0T1&gt;=.2, and r2_h_T0S1&gt;=0
ICA.BinBin.CounterAssum(ICA, r2_h_S0S1_min=.2, r2_h_S0S1_max=1, 
r2_h_S0T1_min=0, r2_h_S0T1_max=1, r2_h_T0T1_min=0.2, r2_h_T0T1_max=1, 
r2_h_T0S1_min=0, r2_h_T0S1_max=1, Monotonicity="General",
Type="Density") 

# Now show the densities of R2_H under the different 
# monotonicity assumptions 
ICA.BinBin.CounterAssum(ICA, r2_h_S0S1_min=.2, r2_h_S0S1_max=1, 
r2_h_S0T1_min=0, r2_h_S0T1_max=1, r2_h_T0T1_min=0.2, r2_h_T0T1_max=1, 
r2_h_T0S1_min=0, r2_h_T0S1_max=1, Monotonicity="General",
Type="All.Densities", MainPlot=" ", Cex.Legend=1, 
Cex.Position="topright", ylim=c(0, 20)) 

## End(Not run)</code></pre>

<hr>
<h2 id='ICA.BinBin.Grid.Full'>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the full grid-based approach</h2><span id='topic+ICA.BinBin.Grid.Full'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinBin.Grid.Full</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. This method provides an alternative for <code>ICA.BinBin</code> and <code>ICA.BinBin.Grid.Sample</code>. It  uses an alternative strategy to identify plausible values for <code class="reqn">\pi</code>.  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinBin.Grid.Full(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_, pi_0_1, 
Monotonicity=c("General"), pi_1001=seq(0, 1, by=.02), 
pi_1110=seq(0, 1, by=.02), pi_1101=seq(0, 1, by=.02),
pi_1011=seq(0, 1, by=.02), pi_1111=seq(0, 1, by=.02), 
pi_0110=seq(0, 1, by=.02), pi_0011=seq(0, 1, by=.02), 
pi_0111=seq(0, 1, by=.02), pi_1100=seq(0, 1, by=.02), 
Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the proability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>. Default <code>Monotonicity=c("General")</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1001">pi_1001</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1001}</code>. Default <code>pi_1001=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1110">pi_1110</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1110}</code>. Default <code>pi_1110=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1101">pi_1101</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1101}</code>. Default <code>pi_1101=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1011">pi_1011</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1011}</code>. Default <code>pi_1011=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1111">pi_1111</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1111}</code>. Default <code>pi_1111=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_0110">pi_0110</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_0110}</code>. Default <code>pi_0110=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_0011">pi_0011</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_0011}</code>. Default <code>pi_0011=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_0111">pi_0111</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_0111}</code>. Default <code>pi_0111=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_pi_1100">pi_1100</code></td>
<td>
<p>A vector that specifies the grid of values that should be considered for <code class="reqn">\pi_{pi_1100}</code>. Default <code>pi_1100=seq(0, 1, by=.02)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Full_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>Seed=sample(1:100000, size=1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles. 
</p>
<p>The function <code>ICA.BinBin.Grid.Full</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed that are allowed to vary freely are considered.  When it is not assumed that monotonicity holds for both <code class="reqn">S</code> and <code class="reqn">T</code>, the computationally less demanding algorithm <code>ICA.BinBin.Grid.Sample</code> may be preferred. 
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr><td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>
<p>Buyse, M., Burzykowski, T., Aloso, A., &amp; Molenberghs, G. (2014). Direct estimation of joint counterfactual probabilities, with application to surrogate marker validation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
# Compute R2_H given the marginals, 
# assuming monotonicity for S and T and grids
# pi_0111=seq(0, 1, by=.001) and 
# pi_1100=seq(0, 1, by=.001)
ICA &lt;- ICA.BinBin.Grid.Full(pi1_1_=0.2619048, pi1_0_=0.2857143, pi_1_1=0.6372549, 
pi_1_0=0.07843137, pi0_1_=0.1349206, pi_0_1=0.127451,  
pi_0111=seq(0, 1, by=.01), pi_1100=seq(0, 1, by=.01), Seed=1)

# obtain plot of R2_H
plot(ICA, R2_H=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.BinBin.Grid.Sample'>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the grid-based sample approach</h2><span id='topic+ICA.BinBin.Grid.Sample'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinBin.Grid.Sample</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. This method provides an alternative for <code>ICA.BinBin</code> and <code>ICA.BinBin.Grid.Full</code>. It  uses an alternative strategy to identify plausible values for <code class="reqn">\pi</code>.  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinBin.Grid.Sample(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_,
pi_0_1, Monotonicity=c("General"), M=100000,
Volume.Perc=0, Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>. Default <code>Monotonicity=c("General")</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_m">M</code></td>
<td>
<p>The number of random samples that have to be drawn for the freely varying parameters. Default <code>M=100000</code>. This argument is not used when <code>Volume.Perc=0</code>. Default <code>M=10000</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_volume.perc">Volume.Perc</code></td>
<td>
<p>Note that the marginals that are observable in the data set a number of restrictions on the unidentified correlations. For example, under montonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, it holds that <code class="reqn">\pi_{0111}&lt;=min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})</code> and <code class="reqn">\pi_{1100}&lt;=min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})</code>. For example, when <code class="reqn">min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})=0.10</code> and <code class="reqn">min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})=0.08</code>, then all valid  <code class="reqn">\pi_{0111}&lt;=0.10</code> and  all valid <code class="reqn">\pi_{1100}&lt;=0.08</code>. The argument <code>Volume.Perc</code> specifies the fraction  of the 'volume' of the paramater space that is explored. This volume is computed based on the grids G={0, 0.01, ..., maximum possible value for the counterfactual probability at hand}. E.g., in the previous example, the 'volume' of the parameter space would be <code class="reqn">11*9=99</code>, and when e.g., the argument <code>Volume.Perc=1</code> is used a total of <code class="reqn">99</code> runs will be conducted. Notice that when monotonicity is not assumed, relatively high values of <code>Volume.Perc</code> will lead to a large number of runs and consequently a long analysis time.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>M=100000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles.
</p>
<p>The function <code>ICA.BinBin.Grid.Full</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed that are allowed to vary freely are considered.  When it is not assumed that monotonicity holds for both <code class="reqn">S</code> and <code class="reqn">T</code>, the number of possible combinations become very high. The function <code>ICA.BinBin.Grid.Sample</code> considers a random sample of all possible combinations.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr><td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>Volume.No</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity is not assumed.</p>
</td></tr>
<tr><td><code>Volume.T</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">T</code> is assumed.</p>
</td></tr>
<tr><td><code>Volume.S</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> is assumed.</p>
</td></tr>
<tr><td><code>Volume.ST</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>
<p>Buyse, M., Burzykowski, T., Aloso, A., &amp; Molenberghs, G. (2014). Direct estimation of joint counterfactual probabilities, with application to surrogate marker validation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Compute R2_H given the marginals,
# assuming monotonicity for S and T and grids
# pi_0111=seq(0, 1, by=.001) and
# pi_1100=seq(0, 1, by=.001)
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.261, pi1_0_=0.285,
pi_1_1=0.637, pi_1_0=0.078, pi0_1_=0.134, pi_0_1=0.127,
Monotonicity=c("Surr.True.Endp"), M=2500, Seed=1)

# obtain plot of R2_H
plot(ICA, R2_H=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.BinBin.Grid.Sample.Uncert'>Assess surrogacy in the causal-inference single-trial setting in the binary-binary case when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed using the grid-based sample approach, accounting for sampling variability in the marginal <code class="reqn">\pi</code>.</h2><span id='topic+ICA.BinBin.Grid.Sample.Uncert'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinBin.Grid.Sample.Uncert</code> quantifies surrogacy in the single-trial causal-inference framework (individual causal association and causal concordance) when both the surrogate and the true endpoints are binary outcomes. This method provides an alternative for <code>ICA.BinBin</code> and <code>ICA.BinBin.Grid.Full</code>. It  uses an alternative strategy to identify plausible values for <code class="reqn">\pi</code>. The function allows to account for sampling variability in the marginal <code class="reqn">\pi</code>. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinBin.Grid.Sample.Uncert(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_,
pi_0_1, Monotonicity=c("General"), M=100000,
Volume.Perc=0, Seed=sample(1:100000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>. A vector is specified to account for uncertainty, i.e., rather than keeping <code class="reqn">P(T=1,S=1|Z=0)</code> fixed at one estimated value, a distribution can be specified (see <b>examples</b> below) from which a value is drawn in each run.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A vector that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Specifies which assumptions regarding monotonicity should be made: <code>Monotonicity=c("General")</code>, <code>Monotonicity=c("No")</code>, <code>Monotonicity=c("True.Endp")</code>, <code>Monotonicity=c("Surr.Endp")</code>, or <code>Monotonicity=c("Surr.True.Endp")</code>. When a general analysis is requested (using <code>Monotonicity=c("General")</code> in the function call), all settings are considered (no monotonicity, monotonicity for <code class="reqn">S</code> alone, for <code class="reqn">T</code> alone, and for both for <code class="reqn">S</code> and <code class="reqn">T</code>. Default <code>Monotonicity=c("General")</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_m">M</code></td>
<td>
<p>The number of random samples that have to be drawn for the freely varying parameters. Default <code>M=100000</code>. This argument is not used when <code>Volume.Perc=0</code>. Default <code>M=10000</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_volume.perc">Volume.Perc</code></td>
<td>
<p>Note that the marginals that are observable in the data set a number of restrictions on the unidentified correlations. For example, under montonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, it holds that <code class="reqn">\pi_{0111}&lt;=min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})</code> and <code class="reqn">\pi_{1100}&lt;=min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})</code>. For example, when <code class="reqn">min(\pi_{0\cdot1\cdot}, \pi_{\cdot1\cdot1})=0.10</code> and <code class="reqn">min(\pi_{1\cdot0\cdot}, \pi_{\cdot1\cdot0})=0.08</code>, then all valid  <code class="reqn">\pi_{0111}&lt;=0.10</code> and  all valid <code class="reqn">\pi_{1100}&lt;=0.08</code>. The argument <code>Volume.Perc</code> specifies the fraction  of the 'volume' of the paramater space that is explored. This volume is computed based on the grids G={0, 0.01, ..., maximum possible value for the counterfactual probability at hand}. E.g., in the previous example, the 'volume' of the parameter space would be <code class="reqn">11*9=99</code>, and when e.g., the argument <code>Volume.Perc=1</code> is used a total of <code class="reqn">99</code> runs will be conducted. Notice that when monotonicity is not assumed, relatively high values of <code>Volume.Perc</code> will lead to a large number of runs and consequently a long analysis time.</p>
</td></tr>
<tr><td><code id="ICA.BinBin.Grid.Sample.Uncert_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>M=100000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2014) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles.
</p>
<p>The function <code>ICA.BinBin.Grid.Full</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed that are allowed to vary freely are considered.  When it is not assumed that monotonicity holds for both <code class="reqn">S</code> and <code class="reqn">T</code>, the number of possible combinations become very high. The function <code>ICA.BinBin.Grid.Sample.Uncert</code> considers a random sample of all possible combinations.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.BinBin</code> with components,
</p>
<table>
<tr><td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>Theta_T</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>Theta_S</code></td>
<td>
<p>The vector of odds ratios for <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>Volume.No</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity is not assumed.</p>
</td></tr>
<tr><td><code>Volume.T</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">T</code> is assumed.</p>
</td></tr>
<tr><td><code>Volume.S</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> is assumed.</p>
</td></tr>
<tr><td><code>Volume.ST</code></td>
<td>
<p>The 'volume' of the parameter space when monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> is assumed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>
<p>Buyse, M., Burzykowski, T., Aloso, A., &amp; Molenberghs, G. (2014). Direct estimation of joint counterfactual probabilities, with application to surrogate marker validation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample.Uncert">ICA.BinBin.Grid.Sample.Uncert</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute R2_H given the marginals (sample from uniform),
# assuming no monotonicity
ICA_No2 &lt;- ICA.BinBin.Grid.Sample.Uncert(pi1_1_=runif(10000, 0.3562, 0.4868),
pi0_1_=runif(10000, 0.0240, 0.0837), pi1_0_=runif(10000, 0.0240, 0.0837),
pi_1_1=runif(10000, 0.4434, 0.5742), pi_1_0=runif(10000, 0.0081, 0.0533),
pi_0_1=runif(10000, 0.0202, 0.0763), Seed=1, Monotonicity=c("No"), M=1000)

summary(ICA_No2)

# obtain plot of R2_H
plot(ICA_No2)
</code></pre>

<hr>
<h2 id='ICA.BinCont'>Assess surrogacy in the causal-inference single-trial setting in the binary-continuous case</h2><span id='topic+ICA.BinCont'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinCont</code> quantifies surrogacy in the single-trial setting within the causal-inference framework (individual causal association) when the surrogate endpoint is continuous (normally distributed) and the true endpoint is a binary outcome. For details, see Alonso Abad <em>et al.</em> (2023). </p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinCont(Dataset, Surr, True, Treat, 
  BS=FALSE,
  G_pi_10=c(0,1), 
  G_rho_01_00=c(-1,1), 
  G_rho_01_01=c(-1,1), 
  G_rho_01_10=c(-1,1), 
  G_rho_01_11=c(-1,1), 
  Theta.S_0, 
  Theta.S_1, 
  M=1000, Seed=123, 
  Monotonicity=FALSE,
  Independence=FALSE,
  HAA=FALSE,
  Cond_ind=FALSE,
  Plots=TRUE, Save.Plots="No", Show.Details=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, and a treatment indicator.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_bs">BS</code></td>
<td>
<p>Logical. If <code>BS=TRUE</code>, the sampling variability is accounted for in the analysis by using a bootstrap procedure. Default <code>BS=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_g_pi_10">G_pi_10</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the probability parameter <code class="reqn">\pi_{10}</code> is sampled. Default <code>c(0,1)</code>. When <code>Monotonicity=TRUE</code> the values of these limits are set as <code>c(0,0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_g_rho_01_00">G_rho_01_00</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{00}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_g_rho_01_01">G_rho_01_01</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{01}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_g_rho_01_10">G_rho_01_10</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{10}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_g_rho_01_11">G_rho_01_11</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{11}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_theta.s_0">Theta.S_0</code></td>
<td>
<p>The starting values of the means and standard deviations for the mixture distribution of the surrogate endpoint in the control group. The argument should contain eight values, where the first four values represent the starting values for the means and the last four values represent the starting values for the standard deviations. These starting values should be approximated based on the data on hand. Example: <code>Theta.S_0=c(-10,-5,5,10,10,10,10,10)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_theta.s_1">Theta.S_1</code></td>
<td>
<p>The starting values of the means and standard deviations for the mixture distribution of the surrogate endpoint in the treatment group. The argument should contain eight values, where the first four values represent the starting values for the means and the last four values represent the starting values for the standard deviations. These starting values should be approximated based on the data on hand. Example: <code>Theta.S_1=c(-10,-5,5,10,10,10,10,10)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_m">M</code></td>
<td>
<p>The number of Monte Carlo iterations. Default <code>M=1000</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_seed">Seed</code></td>
<td>
<p>The random seed to be used in the analysis (for reproducibility). Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Logical. If <code>Monotonicity=TRUE</code>, the analysis is performed assuming monotonicity, i.e. <code class="reqn">P(T_1 &lt; T_0) = 0</code>. Default <code>Monotonicity=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_independence">Independence</code></td>
<td>
<p>Logical. If <code>Independence=TRUE</code>, the analysis is performed assuming independence between the treatment effect in both groups, i.e. <code class="reqn">\pi_{ij} = \pi_{i.} \times \pi_{.j}</code>. Default <code>Independence=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_haa">HAA</code></td>
<td>
<p>Logical. If <code>HAA=TRUE</code>, the analysis is performed assuming homogeneous association, i.e. <code class="reqn">\rho_{01}^{ij} = \rho_{01}</code>. Default <code>HAA=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_cond_ind">Cond_ind</code></td>
<td>
<p>Logical. If <code>Cond_ind=TRUE</code>, the analysis is performed assuming conditional independence, i.e. <code class="reqn">\rho_{01} = 0</code>. Default <code>Cond_ind=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_plots">Plots</code></td>
<td>
<p>Logical. Should histograms of <code class="reqn">S_0</code> (surrogate endpoint in control group) and <code class="reqn">S_1</code> (surrogate endpoint in experimental treatment group) be provided together with density of fitted mixtures? Default <code>Plots=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont_+3A_save.plots">Save.Plots</code></td>
<td>
<p>Should the plots (see previous item) be saved? If <code>Save.Plots="No"</code>, no plots are saved. If plots have to be saved, replace <code>"No"</code> by the desired location, e.g., <code>Save.Plots="C:/"</code>. Default <code>Save.Plots="No"</code>.</p>
</td></tr> 
<tr><td><code id="ICA.BinCont_+3A_show.details">Show.Details</code></td>
<td>
<p>Should some details regarding the availability of some output from the function be displayed in the console when the analysis is running? Setting <code>Show.Details=TRUE</code> could be useful for debugging procedure (if any). Default <code>Show.Details=FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ICA.BinCont</code> with components,
</p>
<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>pi_00</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{00}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_01</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{01}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_10</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{10}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_11</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{11}^T</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_00</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{00}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_01</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{01}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_10</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{10}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_11</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{11}</code> values.</p>
</td></tr>
<tr><td><code>pi_Delta_T_min1</code></td>
<td>
<p>The vector of the <code class="reqn">\pi_{-1}^{\Delta T}</code> values.</p>
</td></tr>
<tr><td><code>pi_Delta_T_0</code></td>
<td>
<p>The vector of the <code class="reqn">\pi_{0}^{\Delta T}</code> values.</p>
</td></tr>
<tr><td><code>pi_Delta_T_1</code></td>
<td>
<p>The vector of the <code class="reqn">\pi_{1}^{\Delta T}</code> values.</p>
</td></tr>
<tr><td><code>pi_0_00</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>pi_0_01</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{01}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>pi_0_10</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{10}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>pi_0_11</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{11}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_00</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_01</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{01}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_10</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{10}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_11</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{11}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>sigma2_00_00</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}^{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>sigma2_00_01</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}^{01}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>sigma2_00_10</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}^{10}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>sigma2_00_11</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}^{11}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>pi_1_00</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{00}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>pi_1_01</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{01}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>pi_1_10</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{10}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>pi_1_11</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_00</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{00}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_01</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{01}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_10</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{10}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_11</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>sigma2_11_00</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}^{00}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>sigma2_11_01</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}^{01}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>sigma2_11_10</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}^{10}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>sigma2_11_11</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}^{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mean_Y_S0</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mean_Y_S1</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>var_Y_S0</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>var_Y_S1</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>dev_S0</code></td>
<td>
<p>The vector of deviance values of the normal mixture for <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>dev_S1</code></td>
<td>
<p>The vector of deviance values of the normal mixture for <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>code_nlm_0</code></td>
<td>
<p>An integer indicating why the optimization process to estimate the mixture normal parameters of <code class="reqn">f(S_0)</code> terminated: 1) relative gradient is close to zero, current iterate is probably solution; 2) successive iterates within tolerance, current iterate is probably solution; 3) last global step failed to locate a point lower than the estimate, the estimate might be an approximate local minimum of the function.</p>
</td></tr>
<tr><td><code>code_nlm_1</code></td>
<td>
<p>An integer indicating why the optimization process to estimate the mixture normal parameters of <code class="reqn">f(S_1)</code> terminated: 1) relative gradient is close to zero, current iterate is probably solution; 2) successive iterates within tolerance, current iterate is probably solution; 3) last global step failed to locate a point lower than the estimate, the estimate might be an approximate local minimum of the function.</p>
</td></tr>
<tr><td><code>mean.S0</code></td>
<td>
<p>The mean of <code class="reqn">S_0</code>.</p>
</td></tr>
<tr><td><code>var.S0</code></td>
<td>
<p>The variance of <code class="reqn">S_0</code>.</p>
</td></tr>
<tr><td><code>mean.S1</code></td>
<td>
<p>The mean of <code class="reqn">S_1</code>.</p>
</td></tr>
<tr><td><code>var.S1</code></td>
<td>
<p>The variance of <code class="reqn">S_1</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Fenny Ong, Ariel Alonso, and Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso Abad, A., Ong, F., Stijven, F., Van der Elst, W., Molenberghs, G., Van Keilegom, I., Verbeke, G., &amp; Callegaro, A. (2023). An information-theoretic approach for the assessment of a continuous outcome as a surrogate for a binary true endpoint based on causal inference: Application to vaccine evaluation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Time consuming code part
data(Schizo)
Fit &lt;- ICA.BinCont(Dataset = Schizo, Surr = BPRS, True = PANSS_Bin, 
Theta.S_0=c(-10,-5,5,10,10,10,10,10), Theta.S_1=c(-10,-5,5,10,10,10,10,10), 
Treat=Treat, M=50, Seed=1)

summary(Fit)
plot(Fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.BinCont.BS'>Assess surrogacy in the causal-inference single-trial setting in the binary-continuous case with an additional bootstrap procedure before the assessment</h2><span id='topic+ICA.BinCont.BS'></span>

<h3>Description</h3>

<p>The function <code>ICA.BinCont.BS</code> quantifies surrogacy in the single-trial setting within the causal-inference framework (individual causal association) when the surrogate endpoint is continuous (normally distributed) and the true endpoint is a binary outcome. This function also allows for an additional bootstrap procedure before the assessment to take the imprecision due to finite sample size into account. For details, see Alonso Abad <em>et al.</em> (2023). </p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.BinCont.BS(Dataset, Surr, True, Treat, 
  BS=TRUE,
  nb=300,
  G_pi_10=c(0,1), 
  G_rho_01_00=c(-1,1), 
  G_rho_01_01=c(-1,1), 
  G_rho_01_10=c(-1,1), 
  G_rho_01_11=c(-1,1), 
  Theta.S_0, 
  Theta.S_1, 
  M=1000, Seed=123, 
  Monotonicity=FALSE,
  Independence=FALSE,
  HAA=FALSE,
  Cond_ind=FALSE,
  Plots=TRUE, Save.Plots="No", Show.Details=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.BinCont.BS_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, and a treatment indicator.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_bs">BS</code></td>
<td>
<p>Logical. If <code>BS=TRUE</code>, the additional bootstrap procedure is performed before the sensitivity analysis to account for the the imprecision due to finite sample size. Default <code>BS=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_nb">nb</code></td>
<td>
<p>The number of bootstrap. Default <code>nb=300</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_g_pi_10">G_pi_10</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the probability parameter <code class="reqn">\pi_{10}</code> is sampled. Default <code>c(0,1)</code>. Even though the default is <code>c(0,1)</code>, due to the restriction that all <code class="reqn">\pi_{ij}</code> should be between <code>(0,1)</code>, the value of <code class="reqn">\pi_{10}</code> will always be between <code class="reqn">(0,min(\pi_{1.}, \pi_{.0}))</code>. When <code>Monotonicity=TRUE</code> the values of these limits are set as <code>c(0,0)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_g_rho_01_00">G_rho_01_00</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{00}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_g_rho_01_01">G_rho_01_01</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{01}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_g_rho_01_10">G_rho_01_10</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{10}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_g_rho_01_11">G_rho_01_11</code></td>
<td>
<p>The lower and upper limits of the uniform distribution from which the association parameter <code class="reqn">\rho_{01}^{11}</code> is sampled. Default <code>c(-1,1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_theta.s_0">Theta.S_0</code></td>
<td>
<p>The starting values of the means and standard deviations for the mixture distribution of the surrogate endpoint in the control group. The argument should contain eight values, where the first four values represent the starting values for the means and the last four values represent the starting values for the standard deviations. These starting values should be approximated based on the data on hand. Example: <code>Theta.S_0=c(-10,-5,5,10,10,10,10,10)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_theta.s_1">Theta.S_1</code></td>
<td>
<p>The starting values of the means and standard deviations for the mixture distribution of the surrogate endpoint in the treatment group. The argument should contain eight values, where the first four values represent the starting values for the means and the last four values represent the starting values for the standard deviations. These starting values should be approximated based on the data on hand. Example: <code>Theta.S_1=c(-10,-5,5,10,10,10,10,10)</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_m">M</code></td>
<td>
<p>The number of Monte Carlo iterations. Default <code>M=1000</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_seed">Seed</code></td>
<td>
<p>The random seed to be used in the analysis (for reproducibility). Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>Logical. If <code>Monotonicity=TRUE</code>, the analysis is performed assuming monotonicity, i.e. <code class="reqn">P(T_1 &lt; T_0) = 0</code>. Default <code>Monotonicity=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_independence">Independence</code></td>
<td>
<p>Logical. If <code>Independence=TRUE</code>, the analysis is performed assuming independence between the treatment effect in both groups, i.e. <code class="reqn">\pi_{ij} = \pi_{i.} \times \pi_{.j}</code>. Default <code>Independence=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_haa">HAA</code></td>
<td>
<p>Logical. If <code>HAA=TRUE</code>, the analysis is performed assuming homogeneous association, i.e. <code class="reqn">\rho_{01}^{ij} = \rho_{01}</code>. Default <code>HAA=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_cond_ind">Cond_ind</code></td>
<td>
<p>Logical. If <code>Cond_ind=TRUE</code>, the analysis is performed assuming conditional independence, i.e. <code class="reqn">\rho_{01} = 0</code>. Default <code>Cond_ind=FALSE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_plots">Plots</code></td>
<td>
<p>Logical. Should histograms of <code class="reqn">S_0</code> (surrogate endpoint in control group) and <code class="reqn">S_1</code> (surrogate endpoint in experimental treatment group) be provided together with density of fitted mixtures? Default <code>Plots=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ICA.BinCont.BS_+3A_save.plots">Save.Plots</code></td>
<td>
<p>Should the plots (see previous item) be saved? If <code>Save.Plots="No"</code>, no plots are saved. If plots have to be saved, replace <code>"No"</code> by the desired location, e.g., <code>Save.Plots="C:/"</code>. Default <code>Save.Plots="No"</code>.</p>
</td></tr> 
<tr><td><code id="ICA.BinCont.BS_+3A_show.details">Show.Details</code></td>
<td>
<p>Should some details regarding the availability of some output from the function be displayed in the console when the analysis is running? Setting <code>Show.Details=TRUE</code> could be useful for debugging procedure (if any). Default <code>Show.Details=FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>ICA.BinCont</code> with components,
</p>
<table>
<tr><td><code>nboots</code></td>
<td>
<p>The identification number of bootstrap samples being analyzed in the sensitivity analysis.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>pi_00</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{00}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_01</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{01}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_10</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{10}^T</code> values.</p>
</td></tr>
<tr><td><code>pi_11</code></td>
<td>
<p>The vector of <code class="reqn">\pi_{11}^T</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_00</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{00}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_01</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{01}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_10</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{10}</code> values.</p>
</td></tr>
<tr><td><code>G_rho_01_11</code></td>
<td>
<p>The vector of the <code class="reqn">\rho_{01}^{11}</code> values.</p>
</td></tr>
<tr><td><code>mu_0_00</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_01</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{01}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_10</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{10}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_0_11</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{0}^{11}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>mu_1_00</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{00}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_01</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{01}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_10</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{10}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>mu_1_11</code></td>
<td>
<p>The vector of mean <code class="reqn">\mu_{1}^{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
<tr><td><code>sigma_00</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{00}</code> values of <code class="reqn">f(S_0)</code>.</p>
</td></tr>
<tr><td><code>sigma_11</code></td>
<td>
<p>The vector of variance <code class="reqn">\sigma_{11}</code> values of <code class="reqn">f(S_1)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Fenny Ong, Ariel Alonso, and Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso Abad, A., Ong, F., Stijven, F., Van der Elst, W., Molenberghs, G., Van Keilegom, I., Verbeke, G., &amp; Callegaro, A. (2023). An information-theoretic approach for the assessment of a continuous outcome as a surrogate for a binary true endpoint based on causal inference: Application to vaccine evaluation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinCont">ICA.BinCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Time consuming code part
data(Schizo)
Fit &lt;- ICA.BinCont.BS(Dataset = Schizo, Surr = BPRS, True = PANSS_Bin, nb = 10, 
Theta.S_0=c(-10,-5,5,10,10,10,10,10), Theta.S_1=c(-10,-5,5,10,10,10,10,10), 
Treat=Treat, M=50, Seed=1)

summary(Fit)
plot(Fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.ContCont'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) in the Continuous-continuous case</h2><span id='topic+ICA.ContCont'></span>

<h3>Description</h3>

<p>The function <code>ICA.ContCont</code> quantifies surrogacy in the single-trial causal-inference framework. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.ContCont(T0S0, T1S1, T0T0=1, T1T1=1, S0S0=1, S1S1=1, T0T1=seq(-1, 1, by=.1), 
T0S1=seq(-1, 1, by=.1), T1S0=seq(-1, 1, by=.1), S0S1=seq(-1, 1, by=.1))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.ContCont_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. </p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.1)</code>, i.e., the values <code class="reqn">-1</code>, <code class="reqn">-0.9</code>, <code class="reqn">-0.8</code>, ..., <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the causal-inference framework, it is assumed that each subject <em>j</em> has four counterfactuals (or potential outcomes), i.e., <code class="reqn">T_{0j}</code>, <code class="reqn">T_{1j}</code>, <code class="reqn">S_{0j}</code>, and <code class="reqn">S_{1j}</code>. Let <code class="reqn">T_{0j}</code> and <code class="reqn">T_{1j}</code> denote the counterfactuals for the true endpoint (<code class="reqn">T</code>) under the control (<code class="reqn">Z=0</code>) and the experimental (<code class="reqn">Z=1</code>) treatments of subject <em>j</em>, respectively. Similarly, <code class="reqn">S_{0j}</code> and <code class="reqn">S_{1j}</code> denote the corresponding counterfactuals for the surrogate endpoint (<code class="reqn">S</code>) under the control and experimental treatments, respectively. The individual causal effects of <code class="reqn">Z</code> on <code class="reqn">T</code> and <code class="reqn">S</code> for a given subject <em>j</em> are then defined as <code class="reqn">\Delta_{T_{j}}=T_{1j}-T_{0j}</code> and <code class="reqn">\Delta_{S_{j}}=S_{1j}-S_{0j}</code>, respectively.
</p>
<p>In the single-trial causal-inference framework, surrogacy can be quantified as the correlation between the individual causal effects of <code class="reqn">Z</code> on <code class="reqn">S</code> and <code class="reqn">T</code> (for details, see Alonso et al., submitted):
</p>
<p style="text-align: center;"><code class="reqn">\rho_{\Delta}=\rho(\Delta_{T_{j}},\:\Delta_{S_{j}})=\frac{\sqrt{\sigma_{S_{0}S_{0}}\sigma_{T_{0}T_{0}}}\rho_{S_{0}T_{0}}+\sqrt{\sigma_{S_{1}S_{1}}\sigma_{T_{1}T_{1}}}\rho_{S_{1}T_{1}}-\sqrt{\sigma_{S_{0}S_{0}}\sigma_{T_{1}T_{1}}}\rho_{S_{0}T_{1}}-\sqrt{\sigma_{S_{1}S_{1}}\sigma_{T_{0}T_{0}}}\rho_{S_{1}T_{0}}}{\sqrt{(\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}})(\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}})}},</code>
</p>
 
<p>where the correlations <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code> are not estimable. It is thus warranted to conduct a sensitivity analysis (by considering vectors of possible values for the correlations between the counterfactuals &ndash; rather than point estimates). 
</p>
<p>When the user specifies a vector of values that should be considered for one or more of the counterfactual correlations in the above expression, the function <code>ICA.ContCont</code> constructs all possible matrices that can be formed as based on these values, identifies the matrices that are positive definite (i.e., valid correlation matrices), and computes <code class="reqn">\rho_{\Delta}</code> for each of these matrices. The obtained vector of <code class="reqn">\rho_{\Delta}</code> values can subsequently be used to examine (i) the impact of different assumptions regarding the correlations between the counterfactuals on the results (see also <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>), and (ii) the extent to which proponents of the causal-inference and meta-analytic frameworks will reach the same conclusion with respect to the appropriateness of the candidate surrogate at hand.   
</p>
<p>The function <code>ICA.ContCont</code> also generates output that is useful to examine the plausibility of finding a good surrogate endpoint (see <code>GoodSurr</code> in the <b>Value</b> section below). For details, see Alonso et al. (submitted).
</p>
<p><b>Notes</b>
</p>
<p>A single <code class="reqn">\rho_{\Delta}</code> value is obtained when all correlations in the function call are scalars.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont</code> with components,
</p>
<table>
<tr><td><code>Total.Num.Matrices</code></td>
<td>
<p>An object of class <code>numeric</code> that contains the total number of matrices that can be formed as based on the user-specified correlations in the function call.</p>
</td></tr>
<tr><td><code>Pos.Def</code></td>
<td>
<p>A <code>data.frame</code> that contains the positive definite matrices that can be formed based on the user-specified correlations. These matrices are used to compute the vector of the <code class="reqn">\rho_{\Delta}</code> values.</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A scalar or vector that contains the individual causal association (ICA; <code class="reqn">\rho_{\Delta}</code>) value(s).</p>
</td></tr>
<tr><td><code>GoodSurr</code></td>
<td>
<p>A <code>data.frame</code> that contains the ICA (<code class="reqn">\rho_{\Delta}</code>), <code class="reqn">\sigma_{\Delta_{T}}</code>, and <code class="reqn">\delta</code>.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal-inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.Sample.ContCont">ICA.Sample.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Generate the vector of ICA.ContCont values when rho_T0S0=rho_T1S1=.95, 
# sigma_T0T0=90, sigma_T1T1=100,sigma_ S0S0=10, sigma_S1S1=15, and  
# the grid of values {0, .2, ..., 1} is considered for the correlations
# between the counterfactuals:
SurICA &lt;- ICA.ContCont(T0S0=.95, T1S1=.95, T0T0=90, T1T1=100, S0S0=10, S1S1=15,
T0T1=seq(0, 1, by=.2), T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), 
S0S1=seq(0, 1, by=.2))

# Examine and plot the vector of generated ICA values:
summary(SurICA)
plot(SurICA)

# Obtain the positive definite matrices than can be formed as based on the 
# specified (vectors) of the correlations (these matrices are used to 
# compute the ICA values)
SurICA$Pos.Def

# Same, but specify vectors for rho_T0S0 and rho_T1S1: Sample from
# normal with mean .95 and SD=.05 (to account for uncertainty 
# in estimation) 
SurICA2 &lt;- ICA.ContCont(T0S0=rnorm(n=10000000, mean=.95, sd=.05), 
T1S1=rnorm(n=10000000, mean=.95, sd=.05), 
T0T0=90, T1T1=100, S0S0=10, S1S1=15,
T0T1=seq(0, 1, by=.2), T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), 
S0S1=seq(0, 1, by=.2))

# Examine results
summary(SurICA2)
plot(SurICA2)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.ContCont.MultS'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S</h2><span id='topic+ICA.ContCont.MultS'></span>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS</code> quantifies surrogacy in the single-trial causal-inference framework  where T is continuous and there are multiple continuous S.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.ContCont.MultS(M = 500, N, Sigma, 
G = seq(from=-1, to=1, by = .00001),
Seed=c(123), Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.ContCont.MultS_+3A_m">M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=500</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_+3A_n">N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_+3A_sigma">Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code> (in this order, the <code class="reqn">T_0</code> and <code class="reqn">T_1</code> data should be in <code>Sigma[c(1,2), c(1,2)]</code>, the <code class="reqn">S_{10}</code> and <code class="reqn">S_{11}</code> data should be in <code>Sigma[c(3,4), c(3,4)]</code>, and so on). The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_+3A_g">G</code></td>
<td>
<p>A vector of the values that should be considered for the unidentified correlations. Default <code>G=seq(-1, 1, by=.00001)</code>, i.e., values with range <code class="reqn">-1</code> to <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_+3A_show.progress">Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
\sigma_{T_{0}T_{0}}\\
\sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
\sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
\sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
\sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
\sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
\sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
\sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
\end{array}\right)</code>
</p>

<p>The <code>ICA.ContCont.MultS</code> function requires the user to specify a distribution <code class="reqn">G</code> for the unidentified correlations. Next, the identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled from <code class="reqn">G</code>. In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). The algorithm generates a large number of 'completed' matrices, and only those that are positive definite are retained (the number of positive definite matrices that should be obtained is specified by the <code>M=</code> argument in the function call). Based on the identifiable variances, these positive definite correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated.
</p>
<p>An issue with this approach (i.e., substituting unidentified correlations by random and independent samples from <code class="reqn">G</code>) is that the probability of obtaining a positive definite matrix is very low when the dimensionality of the matrix increases. One approach to increase the efficiency of the algorithm is to build-up the correlation matrix in a gradual way. In particular, the property that a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite if and only if all principal minors are positive (i.e., Sylvester's criterion) can be used. In other words, a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite when the determinants of the upper-left <code class="reqn">\left(2 \times 2\right)</code>, <code class="reqn">\left(3 \times 3\right)</code>, ..., <code class="reqn">\left(k \times k\right)</code> submatrices all have a positive determinant. Thus, when a positive definite <code class="reqn">\left(k \times k\right)</code> matrix has to be generated, one can start with the upper-left <code class="reqn">\left(2 \times 2\right)</code> submatrix and randomly sample a value from the unidentified correlation (here: <code class="reqn">\rho_{T_0T_0}</code>) from <code class="reqn">G</code>. When the determinant is positive (which will always be the case for a <code class="reqn">\left(2 \times 2\right)</code> matrix), the same procedure is used for the upper-left <code class="reqn">\left(3 \times 3\right)</code> submatrix, and so on. When a particular draw from <code class="reqn">G</code> for a particular submatrix does not give a positive determinant, new values are sampled for the unidentified correlations until a positive determinant is obtained. In this way, it can be guaranteed that the final <code class="reqn">\left(k \times k\right)</code> submatrix will be positive definite. The latter approach is used in the current function. This procedure is used to generate many positive definite matrices. Based on these matrices, <code class="reqn">\boldsymbol{\Sigma_{\Delta}}</code> is generated and the multivariate ICA (<code class="reqn">R^2_{H}</code>) is computed (for details, see Van der Elst et al., 2017). 
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS</code> with components,
</p>
<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, 
<code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>, <code><a href="#topic+ICA.ContCont.MultS_alt">ICA.ContCont.MultS_alt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like (NA indicates unidentified covariances):
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS(M=100, N=200, Show.Progress = TRUE,
  Sigma=s, G = seq(from=-1, to=1, by = .00001), Seed=c(123))

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.ContCont.MultS_alt'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, alternative approach</h2><span id='topic+ICA.ContCont.MultS_alt'></span>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS_alt</code> quantifies surrogacy in the single-trial causal-inference framework  where T is continuous and there are multiple continuous S. This function provides an alternative for <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.ContCont.MultS_alt(M = 500, N, Sigma, 
G = seq(from=-1, to=1, by = .00001),
Seed=c(123), Model = "Delta_T ~ Delta_S1 + Delta_S2", 
Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_m">M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=500</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_n">N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_sigma">Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code>. The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_g">G</code></td>
<td>
<p>A vector of the values that should be considered for the unidentified correlations. Default <code>G=seq(-1, 1, by=.00001)</code>, i.e., values with range <code class="reqn">-1</code> to <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_model">Model</code></td>
<td>
<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is essentially the coefficient of determination of a regression model in which <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ... and so on. The <code>Model=</code> argument specifies the regression model to be used in the analysis. For example, for 2 surrogates, <code>Model = "Delta_T ~ Delta_S1 + Delta_S2")</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS_alt_+3A_show.progress">Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
\sigma_{T_{0}T_{0}}\\
\sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
\sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
\sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
\sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
\sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
\sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
\sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
\end{array}\right)</code>
</p>

<p>The <code>ICA.ContCont.MultS_alt</code> function requires the user to specify a distribution <code class="reqn">G</code> for the unidentified correlations. Next, the identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled from <code class="reqn">G</code>. In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). The algorithm generates a large number of 'completed' matrices, and only those that are positive definite are retained (the number of positive definite matrices that should be obtained is specified by the <code>M=</code> argument in the function call). Based on the identifiable variances, these positive definite correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated.
</p>
<p>An issue with this approach (i.e., substituting unidentified correlations by random and independent samples from <code class="reqn">G</code>) is that the probability of obtaining a positive definite matrix is very low when the dimensionality of the matrix increases. One approach to increase the efficiency of the algorithm is to build-up the correlation matrix in a gradual way. In particular, the property that a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite if and only if all principal minors are positive (i.e., Sylvester's criterion) can be used. In other words, a <code class="reqn">\left(k \times k\right)</code> matrix is positive definite when the determinants of the upper-left <code class="reqn">\left(2 \times 2\right)</code>, <code class="reqn">\left(3 \times 3\right)</code>, ..., <code class="reqn">\left(k \times k\right)</code> submatrices all have a positive determinant. Thus, when a positive definite <code class="reqn">\left(k \times k\right)</code> matrix has to be generated, one can start with the upper-left <code class="reqn">\left(2 \times 2\right)</code> submatrix and randomly sample a value from the unidentified correlation (here: <code class="reqn">\rho_{T_0T_0}</code>) from <code class="reqn">G</code>. When the determinant is positive (which will always be the case for a <code class="reqn">\left(2 \times 2\right)</code> matrix), the same procedure is used for the upper-left <code class="reqn">\left(3 \times 3\right)</code> submatrix, and so on. When a particular draw from <code class="reqn">G</code> for a particular submatrix does not give a positive determinant, new values are sampled for the unidentified correlations until a positive determinant is obtained. In this way, it can be guaranteed that the final <code class="reqn">\left(k \times k\right)</code> submatrix will be positive definite. The latter approach is used in the current function. This procedure is used to generate many positive definite matrices. These positive definite matrices are used to generate <code>M</code> datasets which contain <code class="reqn">\Delta T</code>, <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ..., <code class="reqn">\Delta S_k</code>.
Finally, the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated by regressing <code class="reqn">\Delta T</code> on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, ..., <code class="reqn">\Delta S_k</code> and computing the multiple coefficient of determination.</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS_alt</code> with components,
</p>
<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Res_Err_Delta_T</code></td>
<td>
<p>The residual errors (prediction errors) for intercept-only models of <code class="reqn">\Delta T</code> (i.e., models that do not include <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, etc as predictors).</p>
</td></tr>
<tr><td><code>Res_Err_Delta_T_Given_S</code></td>
<td>
<p>The residual errors (prediction errors) for models where <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S_1</code>, <code class="reqn">\Delta S_2</code>, etc.</p>
</td></tr>
<tr><td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, 
<code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like (NA indicates unidentified covariances):
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS_alt(M=100, N=200, Show.Progress = TRUE,
  Sigma=s, G = seq(from=-1, to=1, by = .00001), Seed=c(123), 
  Model = "Delta_T ~ Delta_S1 + Delta_S2 + Delta_S3")

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.ContCont.MultS.MPC'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, by simulating correlation matrices using a modified algorithm based on partial correlations</h2><span id='topic+ICA.ContCont.MultS.MPC'></span>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS.MPC</code> quantifies surragacy in the single-trial causal-inference framework in which the true endpoint (T) and multiple surrogates (S) are continuous. This function is a modification of the <code><a href="#topic+ICA.ContCont.MultS.PC">ICA.ContCont.MultS.PC</a></code> algorithm based on partial correlations. it mitigates the effect of non-informative surrogates and effectively explores the PD space to capture the ICA range (Florez, et al. 2021).</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.ContCont.MultS.MPC(M=1000,N,Sigma,prob = NULL,Seed=123,
Save.Corr=F, Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_m">M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=1000</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_n">N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_sigma">Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code> (in this order, the <code class="reqn">T_0</code> and <code class="reqn">T_1</code> data should be in <code>Sigma[c(1,2), c(1,2)]</code>, the <code class="reqn">S_{10}</code> and <code class="reqn">S_{11}</code> data should be in <code>Sigma[c(3,4), c(3,4)]</code>, and so on). The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_prob">prob</code></td>
<td>
<p>vector of probabilities to choose the number of surrogates (r) with their non-identifiable correlations equal to zero. The default (<code>prob=NULL</code>) vector of probabilities is:
</p>
<p style="text-align: center;"><code class="reqn">
\pi_{r} = \frac{{p \choose r}}{\sum_{i=1}^{p}{p \choose i}}, \mbox{ for }r=0,\ldots,p.
</code>
</p>

<p>In this way, each possible combination of $r$ surrogates has the same probability of being selected.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_save.corr">Save.Corr</code></td>
<td>
<p>If true, the lower diagonal elements of the correlation matrix (identifiable and unidientifiable elements) are stored. If false, these results are not saved.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.MPC_+3A_show.progress">Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
                                       \sigma_{T_{0}T_{0}}\\
                                       \sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
                                       \sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
                                       \sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
                                       \sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
                                       \sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
                                       ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
                                       \sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
                                       \sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
                                       \end{array}\right)</code>
</p>

<p>The identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled using a modification of an algorithm based on partial correlations (PC), called modified partial correlation (MPC) algorithm. In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). 
</p>
<p>The PC algorithm generate each correlation matrix progressively based on parameterization of terms of the correlations <code class="reqn">\rho_{i,i+1}</code>, for <code class="reqn">i=1,\ldots,d-1</code>, and the partial correlations <code class="reqn">\rho_{i,j|i+1,\ldots,j-1}</code>, for <code class="reqn">j-i&gt;2</code> (for details, see Joe, 2006 and Florez et al., 2018). The MPC algorithm randomly fixed some of the unidentifiable correlations to zero in order to explore the PD, which is coherent with the estimable entries of the correlation matrix, to capture the ICA range more efficiently.
</p>
<p>Based on the identifiable variances, these correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated (for details, see Van der Elst et al., 2017).
</p>
<p>This approach to simulate the unidentifiable parameters of <code class="reqn">\boldsymbol{\Sigma}</code> is computationally more efficient than the one used in the function <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS.PC</code> with components,
</p>
<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td></tr>
<tr><td><code>surr.eval.r</code></td>
<td>
<p>Matrix indicating the surrogates of which their unidentifiable correlations are fixed to zero in each simulation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, Geert Molenberghs &amp; Alvaro Florez
</p>


<h3>References</h3>

<p>Florez, A., Molenberghs, G., Van der Elst, W., Alonso, A. A. (2021). An efficient algorithm for causally assessing surrogacy in a multivariate setting.
</p>
<p>Florez, A., Alonso, A. A., Molenberghs, G. &amp; Van der Elst, W. (2020). Generating random correlation matrices with fixed values: An application to the evaluation of multivariate surrogate endpoints. <em>Computational Statistics &amp; Data Analysis 142</em>.
</p>
<p>Joe, H. (2006). Generating random correlation matrices based on partial correlations. <em>Journal of Multivariate Analysis, 97(10)</em>:2177-2189.
</p>
<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, 
<code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>, <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>, <code><a href="#topic+ICA.ContCont.MultS_alt">ICA.ContCont.MultS_alt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here we have 1 true endpoint and 10 surrogates (8 of these are non-informative)

Sigma = ks::invvech(
  c(25, NA, 17.8, NA, -10.6, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 
    4, NA, -0.32, NA, -1.32, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, 16, 
    NA, -4, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 1, NA, 0.48, NA, 
    0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, 16, NA, 0, NA, 0, NA, 0, NA, 0, 
    NA, 0, NA, 0, NA, 0, NA, 0, NA, 1, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, NA, 0, 
    NA, 0, 16, NA, 8, NA, 8, NA, 8, NA, 8, NA, 8, NA, 8, NA, 8, NA, 1, NA, 0.5, NA, 0.5, 
    NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, 16, NA, 8, NA, 8, NA, 8, NA, 8, NA, 8, 
    NA, 8, NA, 1, NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, 16, NA, 8, NA, 
    8, NA, 8, NA, 8, NA, 8, NA, 1,NA,0.5,NA,0.5,NA,0.5,NA,0.5,NA,0.5, 16, NA, 8, NA, 8, 
    NA, 8, NA, 8, NA, 1, NA, 0.5, NA, 0.5, NA, 0.5, NA, 0.5, 16, NA, 8, NA, 8, NA, 8, NA,
    1, NA, 0.5, NA, 0.5, NA, 0.5, 16, NA, 8, NA, 8, NA, 1, NA, 0.5, NA, 0.5, 16, NA, 8, NA,
    1, NA, 0.5, 16, NA, 1)) 

# Conduct analysis using the PC and MPC algorithm 
## first evaluating two surrogates
ICA.PC.2 = ICA.ContCont.MultS.PC(M = 30000, N=200, Sigma[1:6,1:6], Seed = 123) 
ICA.MPC.2 = ICA.ContCont.MultS.MPC(M = 30000, N=200, Sigma[1:6,1:6],prob=NULL, 
Seed = 123, Save.Corr=T, Show.Progress = TRUE) 

## later evaluating two surrogates
ICA.PC.10 = ICA.ContCont.MultS.PC(M = 150000, N=200, Sigma, Seed = 123) 
ICA.MPC.10 = ICA.ContCont.MultS.MPC(M = 150000, N=200, Sigma,prob=NULL, 
Seed = 123, Save.Corr=T, Show.Progress = TRUE) 

# Explore results
range(ICA.PC.2$R2_H)
range(ICA.PC.10$R2_H)

range(ICA.MPC.2$R2_H)
range(ICA.MPC.10$R2_H)
## as we observe, the MPC algorithm displays a wider interval of possible values for the ICA

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.ContCont.MultS.PC'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) using a continuous univariate T and multiple continuous S, by simulating correlation matrices using an algorithm based on partial correlations</h2><span id='topic+ICA.ContCont.MultS.PC'></span>

<h3>Description</h3>

<p>The function <code>ICA.ContCont.MultS</code> quantifies surrogacy in the single-trial causal-inference framework  where T is continuous and there are multiple continuous S. This function provides an alternative for <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.ContCont.MultS.PC(M=1000,N,Sigma,Seed=123,Show.Progress=FALSE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.ContCont.MultS.PC_+3A_m">M</code></td>
<td>
<p>The number of multivariate ICA values (<code class="reqn">R^2_{H}</code>) that should be sampled. Default <code>M=1000</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.PC_+3A_n">N</code></td>
<td>
<p>The sample size of the dataset.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.PC_+3A_sigma">Sigma</code></td>
<td>
<p>A matrix that specifies the variance-covariance matrix between <code class="reqn">T_0</code>, <code class="reqn">T_1</code>, <code class="reqn">S_{10}</code>, <code class="reqn">S_{11}</code>, <code class="reqn">S_{20}</code>, <code class="reqn">S_{21}</code>, ..., <code class="reqn">S_{k0}</code>, and <code class="reqn">S_{k1}</code> (in this order, the <code class="reqn">T_0</code> and <code class="reqn">T_1</code> data should be in <code>Sigma[c(1,2), c(1,2)]</code>, the <code class="reqn">S_{10}</code> and <code class="reqn">S_{11}</code> data should be in <code>Sigma[c(3,4), c(3,4)]</code>, and so on). The unidentifiable covariances should be defined as <code>NA</code> (see example below).</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.PC_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used. Default <code>Seed=123</code>.</p>
</td></tr>
<tr><td><code id="ICA.ContCont.MultS.PC_+3A_show.progress">Show.Progress</code></td>
<td>
<p>Should progress of runs be graphically shown? (i.e., 1% done..., 2% done..., etc). Mainly useful when a large number of S have to be considered (to follow progress and estimate total run time).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The multivariate ICA (<code class="reqn">R^2_{H}</code>) is not identifiable because the individual causal treatment effects on <code class="reqn">T</code>, <code class="reqn">S_1</code>, ..., <code class="reqn">S_k</code> cannot be observed. A simulation-based sensitivity analysis is therefore conducted in which the multivariate ICA (<code class="reqn">R^2_{H}</code>) is estimated across a set of plausible values for the unidentifiable correlations. To this end, consider the variance covariance matrix of the potential outcomes <code class="reqn">\boldsymbol{\Sigma}</code> (0 and 1 subscripts refer to the control and experimental treatments, respectively): 
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma} = \left(\begin{array}{ccccccccc}
                                       \sigma_{T_{0}T_{0}}\\
                                       \sigma_{T_{0}T_{1}} &amp; \sigma_{T_{1}T_{1}}\\
                                       \sigma_{T_{0}S1_{0}} &amp; \sigma_{T_{1}S1_{0}} &amp; \sigma_{S1_{0}S1_{0}}\\
                                       \sigma_{T_{0}S1_{1}} &amp; \sigma_{T_{1}S1_{1}} &amp; \sigma_{S1_{0}S1_{1}} &amp; \sigma_{S1_{1}S1_{1}}\\
                                       \sigma_{T_{0}S2_{0}} &amp; \sigma_{T_{1}S2_{0}} &amp; \sigma_{S1_{0}S2_{0}} &amp; \sigma_{S1_{1}S2_{0}} &amp; \sigma_{S2_{0}S2_{0}}\\
                                       \sigma_{T_{0}S2_{1}} &amp; \sigma_{T_{1}S2_{1}} &amp; \sigma_{S1_{0}S2_{1}} &amp; \sigma_{S1_{1}S2_{1}} &amp; \sigma_{S2_{0}S2_{1}} &amp; \sigma_{S2_{1}S2_{1}}\\
                                       ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; ... &amp; \ddots\\
                                       \sigma_{T_{0}Sk_{0}} &amp; \sigma_{T_{1}Sk_{0}} &amp; \sigma_{S1_{0}Sk_{0}} &amp; \sigma_{S1_{1}Sk_{0}} &amp; \sigma_{S2_{0}Sk_{0}} &amp; \sigma_{S2_{1}Sk_{0}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{0}}\\
                                       \sigma_{T_{0}Sk_{1}} &amp; \sigma_{T_{1}Sk_{1}} &amp; \sigma_{S1_{0}Sk_{1}} &amp; \sigma_{S1_{1}Sk_{1}} &amp; \sigma_{S2_{0}Sk_{1}} &amp; \sigma_{S2_{1}Sk_{1}} &amp; ... &amp; \sigma_{Sk_{0}Sk_{1}} &amp; \sigma_{Sk_{1}Sk_{1}}.
                                       \end{array}\right)</code>
</p>

<p>The identifiable correlations are fixed at their estimated values and the unidentifiable correlations are independently and randomly sampled using an algorithm based on partial correlations (PC). In the function call, the unidentifiable correlations are marked by specifying <code>NA</code> in the <code>Sigma</code> matrix (see example section below). The PC algorithm generate each correlation matrix progressively based on parameterization of terms of the correlations <code class="reqn">\rho_{i,i+1}</code>, for <code class="reqn">i=1,\ldots,d-1</code>, and the partial correlations <code class="reqn">\rho_{i,j|i+1,\ldots,j-1}</code>, for <code class="reqn">j-i&gt;2</code> (for details, see Joe, 2006 and Florez et al., 2018). Based on the identifiable variances, these correlation matrices are converted to covariance matrices <code class="reqn">\boldsymbol{\Sigma}</code> and the multiple-surrogate ICA are estimated (for details, see Van der Elst et al., 2017).
</p>
<p>This approach to simulate the unidentifiable parameters of <code class="reqn">\boldsymbol{\Sigma}</code> is computationally more efficient than the one used in the function <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont.MultS.PC</code> with components,
</p>
<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Corr.R2_H</code></td>
<td>
<p>The corrected multiple-surrogate individual causal association value(s).</p>
</td></tr>
<tr><td><code>Lower.Dig.Corrs.All</code></td>
<td>
<p>A <code>data.frame</code> that contains the matrix that contains the identifiable and unidentifiable correlations (lower diagonal elements) that were used to compute (<code class="reqn">R^2_{H}</code>) in the run.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Alvaro Florez
</p>


<h3>References</h3>

<p>Florez, A., Alonso, A. A., Molenberghs, G. &amp; Van der Elst, W. (2018). Simulation of random correlation matrices with fixed values: comparison of algorithms and application on multiple surrogates assessment.
</p>
<p>Joe, H. (2006). Generating random correlation matrices based on partial correlations. <em>Journal of Multivariate Analysis, 97(10)</em>:2177-2189.
</p>
<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, 
<code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>, <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code>, <code><a href="#topic+ICA.ContCont.MultS_alt">ICA.ContCont.MultS_alt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like (NA indicates unidentified covariances):
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS.PC(M=1000, N=200, Show.Progress = TRUE,
Sigma=s, Seed=c(123))

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>

<hr>
<h2 id='ICA.Sample.ContCont'>Assess surrogacy in the causal-inference single-trial setting (Individual Causal Association, ICA) in the Continuous-continuous case using the grid-based sample approach</h2><span id='topic+ICA.Sample.ContCont'></span>

<h3>Description</h3>

<p>The function <code>ICA.Sample.ContCont</code> quantifies surrogacy in the single-trial causal-inference framework. It provides a faster alternative for <code>ICA.ContCont</code>. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICA.Sample.ContCont(T0S0, T1S1, T0T0=1, T1T1=1, S0S0=1, S1S1=1, T0T1=seq(-1, 1, by=.001), 
T0S1=seq(-1, 1, by=.001), T1S0=seq(-1, 1, by=.001), S0S1=seq(-1, 1, by=.001), M=50000)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICA.Sample.ContCont_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ICA.Sample.ContCont_+3A_m">M</code></td>
<td>
<p>The number of runs that should be conducted. Default <code>50000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the causal-inference framework, it is assumed that each subject <em>j</em> has four counterfactuals (or potential outcomes), i.e., <code class="reqn">T_{0j}</code>, <code class="reqn">T_{1j}</code>, <code class="reqn">S_{0j}</code>, and <code class="reqn">S_{1j}</code>. Let <code class="reqn">T_{0j}</code> and <code class="reqn">T_{1j}</code> denote the counterfactuals for the true endpoint (<code class="reqn">T</code>) under the control (<code class="reqn">Z=0</code>) and the experimental (<code class="reqn">Z=1</code>) treatments of subject <em>j</em>, respectively. Similarly, <code class="reqn">S_{0j}</code> and <code class="reqn">S_{1j}</code> denote the corresponding counterfactuals for the surrogate endpoint (<code class="reqn">S</code>) under the control and experimental treatments, respectively. The individual causal effects of <code class="reqn">Z</code> on <code class="reqn">T</code> and <code class="reqn">S</code> for a given subject <em>j</em> are then defined as <code class="reqn">\Delta_{T_{j}}=T_{1j}-T_{0j}</code> and <code class="reqn">\Delta_{S_{j}}=S_{1j}-S_{0j}</code>, respectively.
</p>
<p>In the single-trial causal-inference framework, surrogacy can be quantified as the correlation between the individual causal effects of <code class="reqn">Z</code> on <code class="reqn">S</code> and <code class="reqn">T</code> (for details, see Alonso et al., submitted):
</p>
<p style="text-align: center;"><code class="reqn">\rho_{\Delta}=\rho(\Delta_{T_{j}},\:\Delta_{S_{j}})=\frac{\sqrt{\sigma_{S_{0}S_{0}}\sigma_{T_{0}T_{0}}}\rho_{S_{0}T_{0}}+\sqrt{\sigma_{S_{1}S_{1}}\sigma_{T_{1}T_{1}}}\rho_{S_{1}T_{1}}-\sqrt{\sigma_{S_{0}S_{0}}\sigma_{T_{1}T_{1}}}\rho_{S_{0}T_{1}}-\sqrt{\sigma_{S_{1}S_{1}}\sigma_{T_{0}T_{0}}}\rho_{S_{1}T_{0}}}{\sqrt{(\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}})(\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}})}},</code>
</p>
 
<p>where the correlations <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code> are not estimable. It is thus warranted to conduct a sensitivity analysis. 
</p>
<p>The function <code>ICA.ContCont</code> constructs all possible matrices that can be formed based on the specified vectors for <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code>, and retains the positive definite ones for the computation of <code class="reqn">\rho_{\Delta}</code>. 
</p>
<p>In contrast, the function <code>ICA.ContCont</code> samples random values for <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code> based on a uniform distribution with user-specified minimum and maximum values, and retains the positive definite ones for the computation of <code class="reqn">\rho_{\Delta}</code>.  
</p>
<p>The obtained vector of <code class="reqn">\rho_{\Delta}</code> values can subsequently be used to examine (i) the impact of different assumptions regarding the correlations between the counterfactuals on the results (see also <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>), and (ii) the extent to which proponents of the causal-inference and meta-analytic frameworks will reach the same conclusion with respect to the appropriateness of the candidate surrogate at hand.   
</p>
<p>The function <code>ICA.Sample.ContCont</code> also generates output that is useful to examine the plausibility of finding a good surrogate endpoint (see <code>GoodSurr</code> in the <b>Value</b> section below). For details, see Alonso et al. (submitted).
</p>
<p><b>Notes</b>
</p>
<p>A single <code class="reqn">\rho_{\Delta}</code> value is obtained when all correlations in the function call are scalars.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont</code> with components,
</p>
<table>
<tr><td><code>Total.Num.Matrices</code></td>
<td>
<p>An object of class <code>numeric</code> that contains the total number of matrices that can be formed as based on the user-specified correlations in the function call.</p>
</td></tr>
<tr><td><code>Pos.Def</code></td>
<td>
<p>A <code>data.frame</code> that contains the positive definite matrices that can be formed based on the user-specified correlations. These matrices are used to compute the vector of the <code class="reqn">\rho_{\Delta}</code> values.</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A scalar or vector that contains the individual causal association (ICA; <code class="reqn">\rho_{\Delta}</code>) value(s).</p>
</td></tr>
<tr><td><code>GoodSurr</code></td>
<td>
<p>A <code>data.frame</code> that contains the ICA (<code class="reqn">\rho_{\Delta}</code>), <code class="reqn">\sigma_{\Delta_{T}}</code>, and <code class="reqn">\delta</code>.</p>
</td></tr>  
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal-inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>, 
<code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate the vector of ICA values when rho_T0S0=rho_T1S1=.95, 
# sigma_T0T0=90, sigma_T1T1=100,sigma_ S0S0=10, sigma_S1S1=15, and  
# min=-1 max=1 is considered for the correlations
# between the counterfactuals:
SurICA2 &lt;- ICA.Sample.ContCont(T0S0=.95, T1S1=.95, T0T0=90, T1T1=100, S0S0=10, 
S1S1=15, M=5000)

# Examine and plot the vector of generated ICA values:
summary(SurICA2)
plot(SurICA2)
</code></pre>

<hr>
<h2 id='ISTE.ContCont'>Individual-level surrogate threshold effect for continuous normally distributed surrogate and true endpoints.</h2><span id='topic+ISTE.ContCont'></span>

<h3>Description</h3>

<p>Computes the individual-level surrogate threshold effect in the causal-inference single-trial setting where both the surrogate and the true endpoint are continuous normally distributed variables. For details, see paper in the references section.</p>


<h3>Usage</h3>

<pre><code class='language-R'>ISTE.ContCont(Mean_T1, Mean_T0, Mean_S1, Mean_S0, N, Delta_S=c(-10, 0, 10), 
zeta.PI=0.05, PI.Bound=0, PI.Lower=TRUE, Show.Prediction.Plots=TRUE, Save.Plots="No", 
T0S0, T1S1, T0T0=1, T1T1=1, S0S0=1, S1S1=1, T0T1=seq(-1, 1, by=.001), 
T0S1=seq(-1, 1, by=.001), T1S0=seq(-1, 1, by=.001),
S0S1=seq(-1, 1, by=.001), M.PosDef=500, Seed=123)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ISTE.ContCont_+3A_mean_t1">Mean_T1</code></td>
<td>
<p>A scalar or vector that specifies the mean of the true endpoint in the experimental treatment condition (a vector is used to account for estimation uncertainty).</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_mean_t0">Mean_T0</code></td>
<td>
<p>A scalar or vector that specifies the mean of the true endpoint in the control condition (a vector is used to account for estimation uncertainty).</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_mean_s1">Mean_S1</code></td>
<td>
<p>A scalar or vector that specifies the mean of the surrogate endpoint in the experimental treatment condition (a vector is used to account for estimation uncertainty).</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_mean_s0">Mean_S0</code></td>
<td>
<p>A scalar or vector that specifies the mean of the surrogate endpoint in the control condition (a vector is used to account for estimation uncertainty).</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_n">N</code></td>
<td>
<p>The sample size of the clinical trial.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_delta_s">Delta_S</code></td>
<td>
<p>The vector or scalar of <code class="reqn">\Delta S</code> values for which the expected <code class="reqn">\Delta T</code> and its prediction error has to be computed.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_zeta.pi">zeta.PI</code></td>
<td>
<p>The alpha-level to be used in the computation of the prediction interval around <code class="reqn">E(\Delta T)</code>. Default <code>zeta.PI=0.05</code>, i.e., the <code class="reqn">95\%</code> prediction interval.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_pi.bound">PI.Bound</code></td>
<td>
<p>The ISTE is defined as the value of <code class="reqn">\Delta S</code> for which the lower (or upper) bound of the <code class="reqn">(1-\alpha)\%</code> prediction interval around <code class="reqn">E(\Delta T)</code> is 0. If another threshold value than 0 is desired, this can be requested by using the <code>PI.Bound</code> argument. For example, the argument <code>PI.Bound=5</code> can be used in the function call to obtain the values of <code class="reqn">\Delta S</code> for which the lower (or upper) bound of the <code class="reqn">(1-\alpha)\%</code> prediction intervals (in the different runs of the algorithm)around <code class="reqn">\Delta T</code> equal 5.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_pi.lower">PI.Lower</code></td>
<td>
<p>Logical. Should a lower (<code>PI.Lower=TRUE</code>) or upper (<code>PI.Lower=FALSE</code>) prediction interval be used in the computation of ISTE? Default <code>PI.Lower=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_show.prediction.plots">Show.Prediction.Plots</code></td>
<td>
<p>Logical. Should plots that depict <code class="reqn">E(\Delta T)</code> against <code class="reqn">\Delta S</code> (prediction function), the prediction interval, and the ISTE for the different runs of the algorithm be shown? Default <code>Show.Prediction.Plots=TRUE</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_save.plots">Save.Plots</code></td>
<td>
<p>Should the prediction plots (see previous item) be saved? If <code>Save.Plots="No"</code> is used (the default argument), the plots are not saved. If the plots have to be saved, replace <code>"No"</code> by the desired location, e.g., <code>Save.Plots="C:/Analysis directory/"</code> on a windows computer or <code>Save.Plots="/Users/wim/Desktop/Analysis directory/"</code> on macOS or Linux.</p>
</td></tr> 
<tr><td><code id="ISTE.ContCont_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the control treatment condition that should be considered in the computation of ISTE.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the experimental treatment condition that should be considered in the computation of ISTE.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition that should be considered in the computation of ISTE. Default 1.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition that should be considered in the computation of ISTE. Default 1.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition that should be considered in the computation of ISTE. Default 1.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition that should be considered in the computation of ISTE. Default 1.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of ISTE. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of ISTE. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of ISTE. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of ISTE. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_m.posdef">M.PosDef</code></td>
<td>
<p>The number of positive definite <code class="reqn">\Sigma</code> matrices that should be identified. This will also determine the amount of ISTE values that are identified. Default <code>M.PosDef=500</code>.</p>
</td></tr>
<tr><td><code id="ISTE.ContCont_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the analysis (for reproducibility). Default <code>Seed=123</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See paper in the references section.
</p>


<h3>Value</h3>

<p>An object of class <code>ICA.ContCont</code> with components,
</p>
<table>
<tr><td><code>ISTE_Low_PI</code></td>
<td>
<p>The vector of individual surrogate threshold effect (ISTE) values, i.e., the values of <code class="reqn">\Delta S</code> for which the lower bound of the <code class="reqn">(1-\alpha)\%</code> prediction interval around <code class="reqn">\Delta T</code> is 0 (or another threshold value, which can be requested by using the <code>PI.Bound</code> argument in the function call).</p>
</td></tr> 
<tr><td><code>ISTE_Up_PI</code></td>
<td>
<p>Same as <code>ISTE_Low_PI</code>, but using the upper bound of the <code class="reqn">(1-\alpha)\%</code> prediction interval.</p>
</td></tr> 
<tr><td><code>MSE</code></td>
<td>
<p>The vector of mean squared error values that are obtained in the prediction of <code class="reqn">\Delta T</code> based on <code class="reqn">\Delta S</code>.</p>
</td></tr> 
<tr><td><code>gamma0</code></td>
<td>
<p>The vector of intercepts that are obtained in the prediction of <code class="reqn">\Delta T</code> based on <code class="reqn">\Delta S</code>.</p>
</td></tr>
<tr><td><code>gamma1</code></td>
<td>
<p>The vector of slope that are obtained in the prediction of <code class="reqn">\Delta T</code> based on <code class="reqn">\Delta S</code>.</p>
</td></tr>
<tr><td><code>Delta_S_For_Which_Delta_T_equal_0</code></td>
<td>
<p>The vector of <code class="reqn">\Delta S</code> values for which <code class="reqn">E(\Delta T = 0)</code>.</p>
</td></tr>
<tr><td><code>S_squared_pred</code></td>
<td>
<p>The vector of variances of the prediction errors for <code class="reqn">\Delta T</code>.</p>
</td></tr>
<tr><td><code>Predicted_Delta_T</code></td>
<td>
<p>The vector/matrix of predicted values of <code class="reqn">\Delta T</code> for the <code class="reqn">\Delta S</code> values that were requested in the function call (argument <code>Delta_S</code>).</p>
</td></tr>
<tr><td><code>PI_Interval_Low</code></td>
<td>
<p>The vector/matrix of lower bound values of the <code class="reqn">(1-\alpha)\%</code> prediction interval around <code class="reqn">\Delta T</code> for the <code class="reqn">\Delta S</code> values that were requested in the function call (argument <code>Delta_S</code>).</p>
</td></tr>
<tr><td><code>PI_Interval_Up</code></td>
<td>
<p>The vector/matrix of upper bound values of the <code class="reqn">(1-\alpha)\%</code> prediction interval around <code class="reqn">\Delta T</code> for the <code class="reqn">\Delta S</code> values that were requested in the function call (argument <code>Delta_S</code>).</p>
</td></tr>
<tr><td><code>T0T0</code></td>
<td>
<p>The vector of variances of T0 (true endpoint in the control treatment) that are used in the computation (this is a constant if the variance is fixed in the function call).</p>
</td></tr>
<tr><td><code>T1T1</code></td>
<td>
<p>The vector of variances of T1 (true endpoint in the experimental treatment) that are used in the computations (this is a constant if the variance is fixed in the function call).</p>
</td></tr>
<tr><td><code>S0S0</code></td>
<td>
<p>The vector of variances of S0 (surrogate endpoint in the control treatment) that are used in the computations (this is a constant if the variance is fixed in the function call).</p>
</td></tr>
<tr><td><code>S1S1</code></td>
<td>
<p>The vector of variances of S1 (surrogate endpoint in the experimental treatment) that are used in the computations (this is a constant if the variance is fixed in the function call).</p>
</td></tr>
<tr><td><code>Mean_DeltaT</code></td>
<td>
<p>The vector of treatment effect values on the true endpoint that are used in the computations (this is a constant if the means of T0 and T1 are fixed in the function call).</p>
</td></tr> 
<tr><td><code>Mean_DeltaS</code></td>
<td>
<p>The vector of treatment effect values on the surrogate endpoint that are used in the computations (this is a constant if the means of S0 and S1 are fixed in the function call).</p>
</td></tr> 
<tr><td><code>Total.Num.Matrices</code></td>
<td>
<p>An object of class <code>numeric</code> that contains the total number of matrices that can be formed as based on the user-specified correlations in the function call.</p>
</td></tr>
<tr><td><code>Pos.Def</code></td>
<td>
<p>A <code>data.frame</code> that contains the positive definite matrices that can be formed based on the user-specified correlations. These matrices are used to compute the vector of the ISTE values.</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>Apart from ISTE, ICA is also computed (the individual causal association). For details, see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>.</p>
</td></tr>
<tr><td><code>zeta.PI</code></td>
<td>
<p>The <code>zeta.PI</code> value specified in the function call.</p>
</td></tr>
<tr><td><code>PI.Bound</code></td>
<td>
<p>The <code>PI.Bound</code> value specified in the function call.</p>
</td></tr>
<tr><td><code>PI.Lower</code></td>
<td>
<p>The <code>PI.Lower</code> value specified in the function call.</p>
</td></tr>
<tr><td><code>Delta_S</code></td>
<td>
<p>The <code>Delta_S</code> value(s) specified in the function call.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., and Molenberghs, G. (submitted). The individual-level surrogate threshold effect in a causal-inference setting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define input for analysis using the Schizo dataset, 
# with S=BPRS and T = PANSS. 
# For each of the identifiable quantities,
# uncertainty is accounted for by specifying a uniform
# distribution with min, max values corresponding to
# the 95% confidence interval of the quantity.
T0S0 &lt;- runif(min = 0.9524, max = 0.9659, n = 1000)
T1S1 &lt;- runif(min = 0.9608, max = 0.9677, n = 1000)

S0S0 &lt;- runif(min=160.811, max=204.5009, n=1000)
S1S1 &lt;- runif(min=168.989, max = 194.219, n=1000)
T0T0 &lt;- runif(min=484.462, max = 616.082, n=1000)
T1T1 &lt;- runif(min=514.279, max = 591.062, n=1000)

Mean_T0 &lt;- runif(min=-13.455, max=-9.489, n=1000)
Mean_T1 &lt;- runif(min=-17.17, max=-14.86, n=1000)
Mean_S0 &lt;- runif(min=-7.789, max=-5.503, n=1000)
Mean_S1 &lt;- runif(min=-9.600, max=-8.276, n=1000)

# Do the ISTE analysis
## Not run: 
ISTE &lt;- ISTE.ContCont(Mean_T1=Mean_T1, Mean_T0=Mean_T0, 
 Mean_S1=Mean_S1, Mean_S0=Mean_S0, N=2128, Delta_S=c(-50:50), 
 zeta.PI=0.05, PI.Bound=0, Show.Prediction.Plots=TRUE,
 Save.Plots="No", T0S0=T0S0, T1S1=T1S1, T0T0=T0T0, T1T1=T1T1, 
 S0S0=S0S0, S1S1=S1S1)

# Examine results:
summary(ISTE)

# Plots of results. 
  # Plot ISTE
plot(ISTE)
  # Other plots, see plot.ISTE.ContCont for details
plot(ISTE, Outcome="MSE")
plot(ISTE, Outcome="gamma0")
plot(ISTE, Outcome="gamma1")
plot(ISTE, Outcome="Exp.DeltaT")
plot(ISTE, Outcome="Exp.DeltaT.Low.PI")
plot(ISTE, Outcome="Exp.DeltaT.Up.PI")

## End(Not run)
</code></pre>

<hr>
<h2 id='log_likelihood_copula_model'>Computes loglikelihood for a given copula model</h2><span id='topic+log_likelihood_copula_model'></span>

<h3>Description</h3>

<p><code>log_likelihood_copula_model()</code> computes the loglikelihood for a given
bivariate copula model and data set while allowin for right-censoring of both
outcome variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_likelihood_copula_model(
  theta,
  X,
  Y,
  d1,
  d2,
  copula_family,
  cdf_X,
  cdf_Y,
  pdf_X,
  pdf_Y
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_likelihood_copula_model_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_x">X</code></td>
<td>
<p>Numeric vector corresponding to first outcome variable.</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_y">Y</code></td>
<td>
<p>Numeric vector corresponding to second outcome variable.</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_cdf_x">cdf_X</code></td>
<td>
<p>Distribution function for the first outcome variable.</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_cdf_y">cdf_Y</code></td>
<td>
<p>Distribution function for the second outcome variable.</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_pdf_x">pdf_X</code></td>
<td>
<p>Density function for the first outcome variable.</p>
</td></tr>
<tr><td><code id="log_likelihood_copula_model_+3A_pdf_y">pdf_Y</code></td>
<td>
<p>Density function for the second outcome variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Loglikelihood of the bivariate copula model evaluated in the observed
data.
</p>

<hr>
<h2 id='loglik_copula_scale'>Loglikelihood on the Copula Scale</h2><span id='topic+loglik_copula_scale'></span>

<h3>Description</h3>

<p><code>loglik_copula_scale()</code> computes the loglikelihood on the copula scale for
possibly right-censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik_copula_scale(theta, u, v, d1, d2, copula_family, r = 0L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loglik_copula_scale_+3A_theta">theta</code></td>
<td>
<p>Copula parameter</p>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_u">u</code></td>
<td>
<p>A numeric vector. Corresponds to first variable on the copula scale.</p>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_v">v</code></td>
<td>
<p>A numeric vector. Corresponds to second variable on the copula
scale.</p>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_d1">d1</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d1[i] = 1</code> if <code>u[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d1[i] = 0</code> if <code>u[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d1[i] = -1</code> if <code>u[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_d2">d2</code></td>
<td>
<p>An integer vector. Indicates whether first variable is observed or
right-censored,
</p>

<ul>
<li> <p><code>d2[i] = 1</code> if <code>v[i]</code> corresponds to non-censored value
</p>
</li>
<li> <p><code>d2[i] = 0</code> if <code>v[i]</code> corresponds to right-censored value
</p>
</li>
<li> <p><code>d2[i] = -1</code> if <code>v[i]</code> corresponds to left-censored value
</p>
</li></ul>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="loglik_copula_scale_+3A_r">r</code></td>
<td>
<p>rotation parameter. Should be <code>0L</code>, <code>90L</code>, <code>180L</code>, or <code>270L</code>.
</p>
<p>The parameterization of the respective copula families can be found in the
help files of the dedicated functions named <code>copula_loglik_copula_scale()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the copula loglikelihood evaluated in <code>theta</code>.
</p>

<hr>
<h2 id='LongToWide'>
Reshapes a dataset from the 'long' format (i.e., multiple lines per patient) into the 'wide' format (i.e., one line per patient)
</h2><span id='topic+LongToWide'></span>

<h3>Description</h3>

<p>Reshapes a dataset that is in the 'long' format into the 'wide' format. The dataset should contain a single surrogate endpoint and a single true endpoint value per subject.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LongToWide(Dataset, OutcomeIndicator, IdIndicator, TreatIndicator, OutcomeValue)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LongToWide_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> in the 'long' format that contains (at least) five columns, i.e., one that contains the subject ID, one that contains the trial ID,  one that contains the endpoint indicator, one that contains the treatment indicator, and one that contains the endpoint values.</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_outcomeindicator">OutcomeIndicator</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the indicator that distinguishes between the surrogate and true endpoints.</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_idindicator">IdIndicator</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the subject ID.</p>
</td></tr>
<tr><td><code id="LongToWide_+3A_treatindicator">TreatIndicator</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicator. For the subsequent surrogacy analyses, the treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. The <code class="reqn">-1/1</code> coding is recommended. </p>
</td></tr>
<tr><td><code id="LongToWide_+3A_outcomevalue">OutcomeValue</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the endpoint values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> in the 'wide' format, i.e., a <code>data.frame</code> that contains one line per subject. Each line contains a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, and Geert Molenberghs</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a dataset in the 'long' format that contains 
# S and T values for 100 patients
Outcome &lt;- rep(x=c(0, 1), times=100)
ID &lt;- rep(seq(1:100), each=2)
Treat &lt;- rep(seq(c(0,1)), each=100)
Outcomes &lt;- as.numeric(matrix(rnorm(1*200, mean=100, sd=10), 
                                      ncol=200))
Data &lt;- data.frame(cbind(Outcome, ID, Treat, Outcomes))

# Reshapes the Data object 
LongToWide(Dataset=Data, OutcomeIndicator=Outcome, IdIndicator=ID, 
           TreatIndicator=Treat, OutcomeValue=Outcomes)
</code></pre>

<hr>
<h2 id='marginal_distribution'>Fit marginal distribution</h2><span id='topic+marginal_distribution'></span>

<h3>Description</h3>

<p>The <code>marginal_distribution()</code> function is a wrapper for
<code>fitdistrplus::fitdist()</code> that fits a univariate distribution to a data
vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_distribution(x, distribution, fix.arg = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_distribution_+3A_x">x</code></td>
<td>
<p>(numeric) data vector</p>
</td></tr>
<tr><td><code id="marginal_distribution_+3A_distribution">distribution</code></td>
<td>
<p>Distributional family. One of the follwing:
</p>

<ul>
<li> <p><code>"normal"</code>: normal distribution
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;"logistic&#8288;</code>: logistic distribution as parameterized in <code>dlogis()</code>
</p>
</li>
<li> <p><code>"t"</code>: student t distribution is parameterized in <code>dt()</code>
</p>
</li>
<li> <p><code>"lognormal"</code>: lognormal distribution as parameterized in <code>dlnorm()</code>
</p>
</li>
<li> <p><code>"gamma"</code>: gamma distribution as parameterized in <code>dgamma()</code>
</p>
</li>
<li> <p><code>"weibull"</code>: weibull distribution as parameterized in <code>dweibull()</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="marginal_distribution_+3A_fix.arg">fix.arg</code></td>
<td>
<p>An optional named list giving the values of fixed parameters
of the named distribution or a function of data computing (fixed) parameter
values and returning a named list. Parameters with fixed value are thus NOT
estimated by this maximum likelihood procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>fitdistrplus::fitdist</code> that represents the marginal
surrogate distribution.
</p>

<hr>
<h2 id='marginal_gof_plots_scr'>Marginal survival function goodness of fit</h2><span id='topic+marginal_gof_plots_scr'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+marginal_gof_plots_scr">marginal_gof_plots_scr()</a></code> function plots the estimated marginal survival
functions for the fitted model. This results in four plots of survival
functions, one for each of <code class="reqn">S_0</code>, <code class="reqn">S_1</code>, <code class="reqn">T_0</code>, <code class="reqn">T_1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_gof_plots_scr(fitted_model, grid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_gof_plots_scr_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
essentially contains the estimated identifiable part of the joint
distribution for the potential outcomes.</p>
</td></tr>
<tr><td><code id="marginal_gof_plots_scr_+3A_grid">grid</code></td>
<td>
<p>grid of time-points for which to compute the estimated survival
functions.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("Ovarian")
#For simplicity, data is not recoded to semi-competing risks format, but is
#left in the composite event format.
data = data.frame(
  Ovarian$Pfs,
  Ovarian$Surv,
  Ovarian$Treat,
  Ovarian$PfsInd,
  Ovarian$SurvInd
)
ovarian_fitted =
  fit_model_SurvSurv(data = data,
                     copula_family = "clayton",
                     n_knots = 1)
grid = seq(from = 0, to = 2, length.out = 50)
Surrogate:::marginal_gof_plots_scr(ovarian_fitted, grid)

</code></pre>

<hr>
<h2 id='marginal_gof_scr_S_plot'>Goodness-of-fit plot for the marginal survival functions</h2><span id='topic+marginal_gof_scr_S_plot'></span><span id='topic+marginal_gof_scr_T_plot'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+marginal_gof_scr_S_plot">marginal_gof_scr_S_plot()</a></code> and <code><a href="#topic+marginal_gof_scr_T_plot">marginal_gof_scr_T_plot()</a></code> functions
plot the estimated marginal survival functions for the surrogate and true
endpoints. In these plots, it is assumed that the copula model has been
fitted for <code class="reqn">(T_0, \tilde{S}_0, \tilde{S}_1, T_1)'</code> where </p>
<p style="text-align: center;"><code class="reqn">S_k =
\min(\tilde{S_k}, T_k)</code>
</p>
<p> is the (composite) surrogate of interest. In these
plots, the model-based survival functions for <code class="reqn">(T_0, S_0, S_1, T_1)'</code> are
plotted together with the corresponding Kaplan-Meier etimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_gof_scr_S_plot(fitted_model, grid, treated, ...)

marginal_gof_scr_T_plot(fitted_model, grid, treated, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_gof_scr_S_plot_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
essentially contains the estimated identifiable part of the joint
distribution for the potential outcomes.</p>
</td></tr>
<tr><td><code id="marginal_gof_scr_S_plot_+3A_grid">grid</code></td>
<td>
<p>Grid of time-points at which the model-based estimated regression
functions, survival functions, or probabilities are evaluated.</p>
</td></tr>
<tr><td><code id="marginal_gof_scr_S_plot_+3A_treated">treated</code></td>
<td>
<p>(numeric) Treatment group. Should be <code>0</code> or <code>1</code>.</p>
</td></tr>
<tr><td><code id="marginal_gof_scr_S_plot_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="base.html#topic+plot">plot()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>True Endpoint</h3>

<p>The marginal goodness-of-fit plots for the true endpoint, build by
<code><a href="#topic+marginal_gof_scr_T_plot">marginal_gof_scr_T_plot()</a></code>, is simply a comparison of the model-based
estimate of <code class="reqn">P(T_k &gt; t)</code> with the Kaplan-Meier (KM) estimate obtained
with <code><a href="survival.html#topic+survfit">survival::survfit()</a></code>. A pointwise 95% confidence interval for the KM
estimate is also plotted.
</p>


<h3>Surrogate Endpoint</h3>

<p>The model-based estimate of <code class="reqn">P(S_k &gt; s)</code> follows indirectly from the
fitted copula model because the copula model has been fitted for
<code class="reqn">\tilde{S}_k</code> instead of <code class="reqn">S_k</code>. However, the model-based estimate
still follows easily from the copula model as follows,
</p>
<p style="text-align: center;"><code class="reqn">P(S_k &gt; s) = P(\min(\tilde{S}_k, T_k)) = P(\tilde{S}_k &gt; s, T_k &gt; s).</code>
</p>

<p>The <code><a href="#topic+marginal_gof_scr_T_plot">marginal_gof_scr_T_plot()</a></code> function plots the model-based estimate for
<code class="reqn">P(\tilde{S}_k &gt; s, T_k &gt; s)</code> together with the KM estimate (see above).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Define grid for GoF plots.
grid = seq(from = 1e-3,
           to = 2.5,
           length.out = 30)
# Assess marginal goodness-of-fit in the control group.
marginal_gof_scr_S_plot(fitted_model, grid = grid, treated = 0)
marginal_gof_scr_T_plot(fitted_model, grid = grid, treated = 0)
# Assess goodness-of-fit of the association structure, i.e., the copula.
prob_dying_without_progression_plot(fitted_model, grid = grid, treated = 0)
mean_S_before_T_plot_scr(fitted_model, grid = grid, treated = 0)
</code></pre>

<hr>
<h2 id='MarginalProbs'>Computes marginal probabilities for a dataset where the surrogate and true endpoints are binary</h2><span id='topic+MarginalProbs'></span>

<h3>Description</h3>

<p>This function computes the marginal probabilities associated with the distribution of the potential outcomes for the true and surrogate endpoint.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MarginalProbs(Dataset=Dataset, Surr=Surr, True=True, Treat=Treat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MarginalProbs_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a binary surrogate value, a binary true endpoint value, and a treatment indicator. </p>
</td></tr>
<tr><td><code id="MarginalProbs_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the binary surrogate endpoint values. Should be coded as <code class="reqn">0</code> and <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="MarginalProbs_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the binary true endpoint values. Should be coded as <code class="reqn">0</code> and <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="MarginalProbs_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group. </p>
</td></tr>
</table>


<h3>Value</h3>

   
<table>
<tr><td><code>Theta_T0S0</code></td>
<td>
<p>The odds ratio for <code class="reqn">S</code> and <code class="reqn">T</code> in the control group.</p>
</td></tr>
<tr><td><code>Theta_T1S1</code></td>
<td>
<p>The odds ratio for <code class="reqn">S</code> and <code class="reqn">T</code> in the experimental group.</p>
</td></tr>
<tr><td><code>Freq.Cont</code></td>
<td>
<p>The frequencies for <code class="reqn">S</code> and <code class="reqn">T</code> in the control group.</p>
</td></tr>
<tr><td><code>Freq.Exp</code></td>
<td>
<p>The frequencies for <code class="reqn">S</code> and <code class="reqn">T</code> in the experimental group.</p>
</td></tr>
<tr><td><code>pi1_1_</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{1 \cdot 1 \cdot}</code></p>
</td></tr>
<tr><td><code>pi0_1_</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{0 \cdot 1 \cdot}</code></p>
</td></tr>
<tr><td><code>pi1_0_</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{1 \cdot 0 \cdot}</code></p>
</td></tr>
<tr><td><code>pi0_0_</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{0 \cdot 0 \cdot}</code></p>
</td></tr>
<tr><td><code>pi_1_1</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{\cdot 1 \cdot 1}</code></p>
</td></tr>
<tr><td><code>pi_1_0</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{\cdot 1 \cdot 0}</code></p>
</td></tr>
<tr><td><code>pi_0_1</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{\cdot 0 \cdot 1}</code></p>
</td></tr>
<tr><td><code>pi_0_0</code></td>
<td>
<p>The estimated <code class="reqn">\pi_{\cdot 0 \cdot 0}</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open the ARMD dataset and recode Diff24 and Diff52 as 1
# when the original value is above 0, and 0 otherwise
data(ARMD)
ARMD$Diff24_Dich &lt;- ifelse(ARMD$Diff24&gt;0, 1, 0)
ARMD$Diff52_Dich &lt;- ifelse(ARMD$Diff52&gt;0, 1, 0)

# Obtain marginal probabilities and ORs
MarginalProbs(Dataset=ARMD, Surr=Diff24_Dich, True=Diff52_Dich, 
Treat=Treat)



</code></pre>

<hr>
<h2 id='MaxEntContCont'>
Use the maximum-entropy approach to compute ICA in the continuous-continuous sinlge-trial setting
</h2><span id='topic+MaxEntContCont'></span>

<h3>Description</h3>

<p>In a surrogate evaluation setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are continuous
endpoints, a sensitivity-based approach where multiple 'plausible values' for ICA are retained can be used (see functions <code>ICA.ContCont</code>). The function <code>MaxEntContCont</code> identifies the estimate which has the maximuum entropy.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MaxEntContCont(x, T0T0, T1T1, S0S0, S1S1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MaxEntContCont_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>ICA.ContCont</code>.</p>
</td></tr>
<tr><td><code id="MaxEntContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code id="MaxEntContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code id="MaxEntContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code id="MaxEntContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ICA.Max.Ent</code></td>
<td>
<p>The ICA value with maximum entropy.</p>
</td></tr>
<tr><td><code>Max.Ent</code></td>
<td>
<p>The maximum entropy.</p>
</td></tr>
<tr><td><code>Entropy</code></td>
<td>
<p>The vector of entropies corresponding to the vector of 'plausible values' for ICA.</p>
</td></tr>
<tr><td><code>Table.ICA.Entropy</code></td>
<td>
<p>A <code>data.frame</code> that contains the vector of ICA, their entropies, and the correlations between the counterfactuals.</p>
</td></tr>
<tr><td><code>ICA.Fit</code></td>
<td>
<p>The fitted <code>ICA.ContCont</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, Paul Meyvisch, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Add
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Compute ICA for ARMD dataset, using the grid  
# G={-1, -.80, ..., 1} for the undidentifiable correlations

ICA &lt;- ICA.ContCont(T0S0 = 0.769, T1S1 = 0.712, S0S0 = 188.926, 
S1S1 = 132.638, T0T0 = 264.797, T1T1 = 231.771, 
T0T1 = seq(-1, 1, by = 0.2), T0S1 = seq(-1, 1, by = 0.2), 
T1S0 = seq(-1, 1, by = 0.2), S0S1 = seq(-1, 1, by = 0.2))

# Identify the maximum entropy ICA
MaxEnt_ARMD &lt;- MaxEntContCont(x = ICA, S0S0 = 188.926, 
S1S1 = 132.638, T0T0 = 264.797, T1T1 = 231.771)

  # Explore results using summary() and plot() functions
summary(MaxEnt_ARMD)
plot(MaxEnt_ARMD)
plot(MaxEnt_ARMD, Entropy.By.ICA = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='MaxEntICABinBin'>
Use the maximum-entropy approach to compute ICA in the binary-binary setting
</h2><span id='topic+MaxEntICABinBin'></span>

<h3>Description</h3>

<p>In a surrogate evaluation setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary
endpoints, a sensitivity-based approach where multiple 'plausible values' for ICA are retained can be used (see functions <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code>). Alternatively, the maximum entropy distribution of the vector of potential outcomes
can be considered, based upon which ICA is subsequently computed.
The use of the distribution that maximizes the entropy can be justified
based on the fact that any other distribution would necessarily 
(i) assume information that we do not have, or (ii) contradict information
that we do have. The function <code>MaxEntICABinBin</code> implements the latter approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MaxEntICABinBin(pi1_1_, pi1_0_, pi_1_1,
pi_1_0, pi0_1_, pi_0_1, Method="BFGS", 
Fitted.ICA=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MaxEntICABinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_method">Method</code></td>
<td>
<p>The maximum entropy frequency vector <code class="reqn">p^{*}</code> is calculated based on the optimal solution to an unconstrained dual convex programming problem (for details, see Alonso et al., 2015). Two different optimization methods can be specified, i.e., <code>Method="BFGS"</code> and <code>Method="CG"</code>, which implement the quasi-Newton BFGS (Broyden, Fletcher, Goldfarb, and Shanno) and the conjugent gradient (CG) methods (for details on these methods, see the help files of the <code>optim()</code> function and the references theirin). 
Alternatively, the <code class="reqn">\pi</code> vector (obtained when the functions <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code> are executed) that is 'closest' to the vector <code class="reqn">\pi</code> can be retained. Here, the 'closest' vector is defined as the vector where the sum of the squared differences between
the components in the vectors <code class="reqn">\pi</code> and <code class="reqn">\pi</code> is smallest. The latter 'Minimum Difference' method can re requested by specifying the argument <code>Method="MD"</code> in the function call. Default <code>Method="BFGS"</code>.</p>
</td></tr>
<tr><td><code id="MaxEntICABinBin_+3A_fitted.ica">Fitted.ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code>. Only required when <code>Method="MD"</code> is used. </p>
</td></tr> 
</table>


<h3>Value</h3>

<table>
<tr><td><code>R2_H</code></td>
<td>
<p>The R2_H value.</p>
</td></tr>
<tr><td><code>Vector_p</code></td>
<td>
<p>The maximum entropy frequency vector <code class="reqn">p^{*}</code></p>
</td></tr>
<tr><td><code>H_max</code></td>
<td>
<p>The entropy of <code class="reqn">p^{*}</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., &amp; Van der Elst, W. (2015). A maximum-entropy approach for the evluation of surrogate endpoints based on causal inference.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code>, <code><a href="#topic+plot+20MaxEntICA+20BinBin">plot MaxEntICA BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sensitivity-based ICA results using ICA.BinBin.Grid.Sample
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1, 
Monotonicity=c("No"), M=5000)

# Maximum-entropy based ICA
MaxEnt &lt;- MaxEntICABinBin(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078)

# Explore maximum-entropy results
summary(MaxEnt)

# Plot results
plot(x=MaxEnt, ICA.Fit=ICA)
</code></pre>

<hr>
<h2 id='MaxEntSPFBinBin'>
Use the maximum-entropy approach to compute SPF (surrogate predictive function) in the binary-binary setting
</h2><span id='topic+MaxEntSPFBinBin'></span>

<h3>Description</h3>

<p>In a surrogate evaluation setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary
endpoints, a sensitivity-based approach where multiple 'plausible values' for vector <code class="reqn">\pi</code> (i.e., vectors <code class="reqn">\pi</code> that are compatible with the observable data at hand) can be used (for details, see <code><a href="#topic+SPF.BinBin">SPF.BinBin</a></code>). Alternatively, the maximum entropy distribution for vector <code class="reqn">\pi</code>
can be considered (Alonso et al., 2015). The use of the distribution that maximizes the entropy can be justified
based on the fact that any other distribution would necessarily 
(i) assume information that we do not have, or (ii) contradict information
that we do have. The function <code>MaxEntSPFBinBin</code> implements the latter approach.
</p>
<p>Based on vector <code class="reqn">\pi</code>, the surrogate predictive function (SPF) is computed, i.e., <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code>. For example, <code class="reqn">r(-1,1)</code> quantifies the probability that the treatment has a negative effect on the true endpoint (<code class="reqn">\Delta T=-1</code>) given that it has a positive effect on the surrogate (<code class="reqn">\Delta S=1</code>). </p>


<h3>Usage</h3>

<pre><code class='language-R'>MaxEntSPFBinBin(pi1_1_, pi1_0_, pi_1_1,
pi_1_0, pi0_1_, pi_0_1, Method="BFGS", 
Fitted.ICA=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains the estimated value for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_method">Method</code></td>
<td>
<p>The maximum entropy frequency vector <code class="reqn">p^{*}</code> is calculated based on the optimal solution to an unconstrained dual convex programming problem (for details, see Alonso et al., 2015). Two different optimization methods can be specified, i.e., <code>Method="BFGS"</code> and <code>Method="CG"</code>, which implement the quasi-Newton BFGS (Broyden, Fletcher, Goldfarb, and Shanno) and the conjugent gradient (CG) methods (for details on these methods, see the help files of the <code>optim()</code> function and the references theirin). 
Alternatively, the <code class="reqn">\pi</code> vector (obtained when the functions <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code> are executed) that is 'closest' to the vector <code class="reqn">\pi</code> can be retained. Here, the 'closest' vector is defined as the vector where the sum of the squared differences between
the components in the vectors <code class="reqn">\pi</code> and <code class="reqn">\pi</code> is smallest. The latter 'Minimum Difference' method can re requested by specifying the argument <code>Method="MD"</code> in the function call. Default <code>Method="BFGS"</code>.</p>
</td></tr>
<tr><td><code id="MaxEntSPFBinBin_+3A_fitted.ica">Fitted.ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code>. Only required when <code>Method="MD"</code> is used. </p>
</td></tr> 
</table>


<h3>Value</h3>

<table>
<tr><td><code>Vector_p</code></td>
<td>
<p>The maximum entropy frequency vector <code class="reqn">p^{*}</code></p>
</td></tr>
<tr><td><code>r_1_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, 1)</code>, i.e., <code class="reqn">P(\Delta T=1|\Delta S=1</code>).</p>
</td></tr>
<tr><td><code>r_min1_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, 1)</code>.</p>
</td></tr>
<tr><td><code>r_0_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, 1)</code>.</p>
</td></tr>
<tr><td><code>r_1_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_min1_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_0_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, 0)</code>.</p>
</td></tr>
<tr><td><code>r_1_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_min1_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_0_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, -1)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., &amp; Van der Elst, W. (2015). A maximum-entropy approach for the evluation of surrogate endpoints based on causal inference.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code>, <code><a href="#topic+plot+20MaxEntSPF+20BinBin">plot MaxEntSPF BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Sensitivity-based ICA results using ICA.BinBin.Grid.Sample
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1, 
Monotonicity=c("No"), M=5000)

# Sensitivity-based SPF
SPFSens &lt;- SPF.BinBin(ICA)

# Maximum-entropy based SPF
SPFMaxEnt &lt;- MaxEntSPFBinBin(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078)

# Explore maximum-entropy results
summary(SPFMaxEnt)

# Plot results
plot(x=SPFMaxEnt, SPF.Fit=SPFSens)
</code></pre>

<hr>
<h2 id='mean_S_before_T_plot_scr'>Goodness of fit plot for the fitted copula</h2><span id='topic+mean_S_before_T_plot_scr'></span><span id='topic+prob_dying_without_progression_plot'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+mean_S_before_T_plot_scr">mean_S_before_T_plot_scr()</a></code> and <code><a href="#topic+prob_dying_without_progression_plot">prob_dying_without_progression_plot()</a></code>
functions build plots to assess the goodness-of-fit of the copula model
fitted by <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. Specifically, these two functions focus on
the appropriateness of the copula. Note that to assess the appropriateness of
the marginal functions, two other functions are available:
<code><a href="#topic+marginal_gof_scr_S_plot">marginal_gof_scr_S_plot()</a></code> and <code><a href="#topic+marginal_gof_scr_T_plot">marginal_gof_scr_T_plot()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mean_S_before_T_plot_scr(fitted_model, plot_method = NULL, grid, treated, ...)

prob_dying_without_progression_plot(
  fitted_model,
  plot_method = NULL,
  grid,
  treated,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_S_before_T_plot_scr_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
essentially contains the estimated identifiable part of the joint
distribution for the potential outcomes.</p>
</td></tr>
<tr><td><code id="mean_S_before_T_plot_scr_+3A_plot_method">plot_method</code></td>
<td>
<p>Defaults to <code>NULL</code>. Should not be modified.</p>
</td></tr>
<tr><td><code id="mean_S_before_T_plot_scr_+3A_grid">grid</code></td>
<td>
<p>Grid of time-points at which the model-based estimated regression
functions, survival functions, or probabilities are evaluated.</p>
</td></tr>
<tr><td><code id="mean_S_before_T_plot_scr_+3A_treated">treated</code></td>
<td>
<p>(numeric) Treatment group. Should be <code>0</code> or <code>1</code>.</p>
</td></tr>
<tr><td><code id="mean_S_before_T_plot_scr_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="base.html#topic+plot">plot()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>
</p>


<h3>Progression Before Death</h3>

<p>If a patient progresses before death, this means that <code class="reqn">S_k &lt; T_k</code>. For
these patients, we can look at the expected progression time given that the
patient has died at <code class="reqn">T_k = t</code>: </p>
<p style="text-align: center;"><code class="reqn">E(S_k | T_k = t, S_k &lt; T_k).</code>
</p>
<p> The
<code><a href="#topic+mean_S_before_T_plot_scr">mean_S_before_T_plot_scr()</a></code> function plots the model-based estimate of this
regression function together with a non-parametric estimate.
</p>
<p>This regression function can also be estimated non-parametrically by
regressing <code class="reqn">S_k</code> onto <code class="reqn">T_k</code> in the subset of uncensored patients.
This non-parametric estimate is obtained via <code>mgcv::gam(y~s(x))</code> with
additionally <code>family = stats::quasi(link = "log", variance = "mu")</code> because
this tends to describe survival data better. The 95% confidence intervals are
added for this non-parametric estimate; although, they should be interpreted
with caution because the Poisson mean-variance relation may be wrong.
</p>


<h3>Death Before Progression</h3>

<p>If a patient dies before progressing, this means that <code class="reqn">S_k = T_k</code>. This
probability can be modeled as a function of time, i.e., </p>
<p style="text-align: center;"><code class="reqn">	\pi_k(t) =
P(S_k = t  \, | \, T_k = t).</code>
</p>
<p> The <code><a href="#topic+prob_dying_without_progression_plot">prob_dying_without_progression_plot()</a></code>
function plots the model-based estimate of this regression function together
with a non-parametric estimate.
</p>
<p>This regression function can also be estimated non-parametrically by
regressing the censoring indicator for <code class="reqn">S_k</code>, <code class="reqn">\delta_{S_k}</code>,
onto <code class="reqn">T_k</code> in the subset of patients with uncensored <code class="reqn">T_k</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Define grid for GoF plots.
grid = seq(from = 1e-3,
           to = 2.5,
           length.out = 30)
# Assess marginal goodness-of-fit in the control group.
marginal_gof_scr_S_plot(fitted_model, grid = grid, treated = 0)
marginal_gof_scr_T_plot(fitted_model, grid = grid, treated = 0)
# Assess goodness-of-fit of the association structure, i.e., the copula.
prob_dying_without_progression_plot(fitted_model, grid = grid, treated = 0)
mean_S_before_T_plot_scr(fitted_model, grid = grid, treated = 0)
</code></pre>

<hr>
<h2 id='MICA.ContCont'>Assess surrogacy in the causal-inference multiple-trial setting (Meta-analytic Individual Causal Association; MICA) in the continuous-continuous case</h2><span id='topic+MICA.ContCont'></span>

<h3>Description</h3>

<p>The function <code>MICA.ContCont</code> quantifies surrogacy in the multiple-trial causal-inference framework. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MICA.ContCont(Trial.R, D.aa, D.bb, T0S0, T1S1, T0T0=1, T1T1=1, S0S0=1, S1S1=1,
T0T1=seq(-1, 1, by=.1), T0S1=seq(-1, 1, by=.1), T1S0=seq(-1, 1, by=.1),
S0S1=seq(-1, 1, by=.1))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MICA.ContCont_+3A_trial.r">Trial.R</code></td>
<td>
<p>A scalar that specifies the trial-level correlation coefficient (i.e., <code class="reqn">R_{trial}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_d.aa">D.aa</code></td>
<td>
<p>A scalar that specifies the between-trial variance of the treatment effects on the surrogate endpoint (i.e., <code class="reqn">d_{aa}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_d.bb">D.bb</code></td>
<td>
<p>A scalar that specifies the between-trial variance of the treatment effects on the true endpoint (i.e., <code class="reqn">d_{bb}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.1)</code>, i.e., the values <code class="reqn">-1</code>, <code class="reqn">-0.9</code>, <code class="reqn">-0.8</code>, ..., <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
<tr><td><code id="MICA.ContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.1)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the causal-inference framework, it is assumed that each subject <em>j</em> in trial <em>i</em> has four counterfactuals (or potential outcomes), i.e., <code class="reqn">T_{0ij}</code>, <code class="reqn">T_{1ij}</code>, <code class="reqn">S_{0ij}</code>, and <code class="reqn">S_{1ij}</code>. Let <code class="reqn">T_{0ij}</code> and <code class="reqn">T_{1ij}</code> denote the counterfactuals for the true endpoint (<code class="reqn">T</code>) under the control (<code class="reqn">Z=0</code>) and the experimental (<code class="reqn">Z=1</code>) treatments of subject <em>j</em> in trial <em>i</em>, respectively. Similarly, <code class="reqn">S_{0ij}</code> and <code class="reqn">S_{1ij}</code> denote the corresponding counterfactuals for the surrogate endpoint (<code class="reqn">S</code>) under the control and experimental treatments of subject <em>j</em> in trial <em>i</em>, respectively. The individual causal effects of <code class="reqn">Z</code> on <code class="reqn">T</code> and <code class="reqn">S</code> for a given subject <em>j</em> in trial <em>i</em> are then defined as <code class="reqn">\Delta_{T_{ij}}=T_{1ij}-T_{0ij}</code> and <code class="reqn">\Delta_{S_{ij}}=S_{1ij}-S_{0ij}</code>, respectively.
</p>
<p>In the multiple-trial causal-inference framework, surrogacy can be quantified as the correlation between the individual causal effects of <code class="reqn">Z</code> on <code class="reqn">S</code> and <code class="reqn">T</code> (for details, see Alonso et al., submitted):
</p>
<p style="text-align: center;"><code class="reqn">\rho_{M}=\rho(\Delta_{Tij},\:\Delta_{Sij})=\frac{\sqrt{d_{bb}d_{aa}}R_{trial}+\sqrt{V(\varepsilon_{\Delta Tij})V(\varepsilon_{\Delta Sij})}\rho_{\Delta}}{\sqrt{V(\Delta_{Tij})V(\Delta_{Sij})}},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">V(\varepsilon_{\Delta Tij})=\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\varepsilon_{\Delta Sij})=\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\Delta_{Tij})=d_{bb}+\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\Delta_{Sij})=d_{aa}+\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}}.</code>
</p>

<p>The correlations between the counterfactuals (i.e., <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code>) are not identifiable from the data. It is thus warranted to conduct a sensitivity analysis (by considering vectors of possible values for the correlations between the counterfactuals &ndash; rather than point estimates).
</p>
<p>When the user specifies a vector of values that should be considered for one or more of the correlations that are involved in the computation of <code class="reqn">\rho_{M}</code>, the function <code>MICA.ContCont</code> constructs all possible matrices that can be formed as based on the specified values, identifies the matrices that are positive definite (i.e., valid correlation matrices), and computes <code class="reqn">\rho_{M}</code> for each of these matrices. An examination of the vector of the obtained <code class="reqn">\rho_{M}</code> values allows for a straightforward examination of the impact of different assumptions regarding the correlations between the counterfactuals on the results (see also <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>), and the extent to which proponents of the causal-inference and meta-analytic frameworks will reach the same conclusion with respect to the appropriateness of the candidate surrogate at hand.
</p>
<p><b>Notes</b>
A single <code class="reqn">\rho_{M}</code> value is obtained when all correlations in the function call are scalars.
</p>


<h3>Value</h3>

<p>An object of class <code>MICA.ContCont</code> with components,
</p>
<table>
<tr><td><code>Total.Num.Matrices</code></td>
<td>
<p>An object of class <code>numeric</code> which contains the total number of matrices that can be formed as based on the user-specified correlations.</p>
</td></tr>
<tr><td><code>Pos.Def</code></td>
<td>
<p>A <code>data.frame</code> that contains the positive definite matrices that can be formed based on the user-specified correlations. These matrices are used to compute the vector of the <code class="reqn">\rho_{M}</code> values.</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A scalar or vector of the <code class="reqn">\rho_{\Delta}</code> values.</p>
</td></tr>
<tr><td><code>MICA</code></td>
<td>
<p>A scalar or vector of the <code class="reqn">\rho_{M}</code> values.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>The theory that relates the causal-inference and the meta-analytic frameworks in the multiple-trial setting (as developped in Alonso et al., submitted) assumes that a reduced or semi-reduced modelling approach is used in the meta-analytic framework. Thus <code class="reqn">R_{trial}</code>,  <code class="reqn">d_{aa}</code> and <code class="reqn">d_{bb}</code> should be estimated based on a reduced model (i.e., using the <code>Model=c("Reduced")</code> argument in the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, or <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>) or based on a semi-reduced model (i.e., using the <code>Model=c("SemiReduced")</code> argument in the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, or <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>). </p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal-inference and meta-analytic paradigms for the validation of surrogate markers.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>,  <code><a href="#topic+MICA.Sample.ContCont">MICA.Sample.ContCont</a></code>, <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>, <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Generate the vector of MICA values when R_trial=.8, rho_T0S0=rho_T1S1=.8,
# sigma_T0T0=90, sigma_T1T1=100,sigma_ S0S0=10, sigma_S1S1=15, D.aa=5, D.bb=10,
# and when the grid of values {0, .2, ..., 1} is considered for the
# correlations between the counterfactuals:
SurMICA &lt;- MICA.ContCont(Trial.R=.80, D.aa=5, D.bb=10, T0S0=.8, T1S1=.8,
T0T0=90, T1T1=100, S0S0=10, S1S1=15, T0T1=seq(0, 1, by=.2),
T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), S0S1=seq(0, 1, by=.2))

# Examine and plot the vector of the generated MICA values:
summary(SurMICA)
plot(SurMICA)


# Same analysis, but now assume that D.aa=.5 and D.bb=.1:
SurMICA &lt;- MICA.ContCont(Trial.R=.80, D.aa=.5, D.bb=.1, T0S0=.8, T1S1=.8,
T0T0=90, T1T1=100, S0S0=10, S1S1=15, T0T1=seq(0, 1, by=.2),
T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), S0S1=seq(0, 1, by=.2))

# Examine and plot the vector of the generated MICA values:
summary(SurMICA)
plot(SurMICA)


# Same as first analysis, but specify vectors for rho_T0S0 and rho_T1S1:
# Sample from normal with mean .8 and SD=.1 (to account for uncertainty
# in estimation)
SurMICA &lt;- MICA.ContCont(Trial.R=.80, D.aa=5, D.bb=10,
T0S0=rnorm(n=10000000, mean=.8, sd=.1),
T1S1=rnorm(n=10000000, mean=.8, sd=.1),
T0T0=90, T1T1=100, S0S0=10, S1S1=15, T0T1=seq(0, 1, by=.2),
T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), S0S1=seq(0, 1, by=.2))

## End(Not run)
</code></pre>

<hr>
<h2 id='MICA.Sample.ContCont'>Assess surrogacy in the causal-inference multiple-trial setting (Meta-analytic Individual Causal Association; MICA) in the continuous-continuous case using the grid-based sample approach</h2><span id='topic+MICA.Sample.ContCont'></span>

<h3>Description</h3>

<p>The function <code>MICA.Sample.ContCont</code> quantifies surrogacy in the multiple-trial causal-inference framework. It provides a faster alternative for <code>MICA.ContCont</code>. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MICA.Sample.ContCont(Trial.R, D.aa, D.bb, T0S0, T1S1, T0T0=1, T1T1=1, S0S0=1, S1S1=1,
T0T1=seq(-1, 1, by=.001), T0S1=seq(-1, 1, by=.001), T1S0=seq(-1, 1, by=.001),
S0S1=seq(-1, 1, by=.001), M=50000)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MICA.Sample.ContCont_+3A_trial.r">Trial.R</code></td>
<td>
<p>A scalar that specifies the trial-level correlation coefficient (i.e., <code class="reqn">R_{trial}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_d.aa">D.aa</code></td>
<td>
<p>A scalar that specifies the between-trial variance of the treatment effects on the surrogate endpoint (i.e., <code class="reqn">d_{aa}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_d.bb">D.bb</code></td>
<td>
<p>A scalar that specifies the between-trial variance of the treatment effects on the true endpoint (i.e., <code class="reqn">d_{bb}</code>) that should be used in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar or vector that specifies the correlation(s) between the surrogate and the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_s0s0">S0S0</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the control treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_s1s1">S1S1</code></td>
<td>
<p>A scalar that specifies the variance of the surrogate endpoint in the experimental treatment condition that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default 1.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{M}</code>. Default <code>seq(-1, 1, by=.001)</code>.</p>
</td></tr>
<tr><td><code id="MICA.Sample.ContCont_+3A_m">M</code></td>
<td>
<p>The number of runs that should be conducted. Default <code>50000</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Based on the causal-inference framework, it is assumed that each subject <em>j</em> in trial <em>i</em> has four counterfactuals (or potential outcomes), i.e., <code class="reqn">T_{0ij}</code>, <code class="reqn">T_{1ij}</code>, <code class="reqn">S_{0ij}</code>, and <code class="reqn">S_{1ij}</code>. Let <code class="reqn">T_{0ij}</code> and <code class="reqn">T_{1ij}</code> denote the counterfactuals for the true endpoint (<code class="reqn">T</code>) under the control (<code class="reqn">Z=0</code>) and the experimental (<code class="reqn">Z=1</code>) treatments of subject <em>j</em> in trial <em>i</em>, respectively. Similarly, <code class="reqn">S_{0ij}</code> and <code class="reqn">S_{1ij}</code> denote the corresponding counterfactuals for the surrogate endpoint (<code class="reqn">S</code>) under the control and experimental treatments of subject <em>j</em> in trial <em>i</em>, respectively. The individual causal effects of <code class="reqn">Z</code> on <code class="reqn">T</code> and <code class="reqn">S</code> for a given subject <em>j</em> in trial <em>i</em> are then defined as <code class="reqn">\Delta_{T_{ij}}=T_{1ij}-T_{0ij}</code> and <code class="reqn">\Delta_{S_{ij}}=S_{1ij}-S_{0ij}</code>, respectively.
</p>
<p>In the multiple-trial causal-inference framework, surrogacy can be quantified as the correlation between the individual causal effects of <code class="reqn">Z</code> on <code class="reqn">S</code> and <code class="reqn">T</code> (for details, see Alonso et al., submitted):
</p>
<p style="text-align: center;"><code class="reqn">\rho_{M}=\rho(\Delta_{Tij},\:\Delta_{Sij})=\frac{\sqrt{d_{bb}d_{aa}}R_{trial}+\sqrt{V(\varepsilon_{\Delta Tij})V(\varepsilon_{\Delta Sij})}\rho_{\Delta}}{\sqrt{V(\Delta_{Tij})V(\Delta_{Sij})}},</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">V(\varepsilon_{\Delta Tij})=\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\varepsilon_{\Delta Sij})=\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\Delta_{Tij})=d_{bb}+\sigma_{T_{0}T_{0}}+\sigma_{T_{1}T_{1}}-2\sqrt{\sigma_{T_{0}T_{0}}\sigma_{T_{1}T_{1}}}\rho_{T_{0}T_{1}},</code>
</p>

<p style="text-align: center;"><code class="reqn">V(\Delta_{Sij})=d_{aa}+\sigma_{S_{0}S_{0}}+\sigma_{S_{1}S_{1}}-2\sqrt{\sigma_{S_{0}S_{0}}\sigma_{S_{1}S_{1}}}\rho_{S_{0}S_{1}}.</code>
</p>

<p>The correlations between the counterfactuals (i.e., <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code>) are not identifiable from the data. It is thus warranted to conduct a sensitivity analysis (by considering vectors of possible values for the correlations between the counterfactuals &ndash; rather than point estimates).
</p>
<p>When the user specifies a vector of values that should be considered for one or more of the correlations that are involved in the computation of <code class="reqn">\rho_{M}</code>, the function <code>MICA.ContCont</code> constructs all possible matrices that can be formed as based on the specified values, and retains the positive definite ones for the computation of <code class="reqn">\rho_{M}</code>.
</p>
<p>In contrast, the function <code>MICA.Sample.ContCont</code> samples random values for <code class="reqn">\rho_{S_{0}T_{1}}</code>, <code class="reqn">\rho_{S_{1}T_{0}}</code>, <code class="reqn">\rho_{T_{0}T_{1}}</code>, and <code class="reqn">\rho_{S_{0}S_{1}}</code> based on a uniform distribution with user-specified minimum and maximum values, and retains the positive definite ones for the computation of <code class="reqn">\rho_{M}</code>.
</p>
<p>An examination of the vector of the obtained <code class="reqn">\rho_{M}</code> values allows for a straightforward examination of the impact of different assumptions regarding the correlations between the counterfactuals on the results (see also <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>), and the extent to which proponents of the causal-inference and meta-analytic frameworks will reach the same conclusion with respect to the appropriateness of the candidate surrogate at hand.
</p>
<p><b>Notes</b>
A single <code class="reqn">\rho_{M}</code> value is obtained when all correlations in the function call are scalars.
</p>


<h3>Value</h3>

<p>An object of class <code>MICA.ContCont</code> with components,
</p>
<table>
<tr><td><code>Total.Num.Matrices</code></td>
<td>
<p>An object of class <code>numeric</code> which contains the total number of matrices that can be formed as based on the user-specified correlations.</p>
</td></tr>
<tr><td><code>Pos.Def</code></td>
<td>
<p>A <code>data.frame</code> that contains the positive definite matrices that can be formed based on the user-specified correlations. These matrices are used to compute the vector of the <code class="reqn">\rho_{M}</code> values.</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A scalar or vector of the <code class="reqn">\rho_{\Delta}</code> values.</p>
</td></tr>
<tr><td><code>MICA</code></td>
<td>
<p>A scalar or vector of the <code class="reqn">\rho_{M}</code> values.</p>
</td></tr>
</table>


<h3>Warning</h3>

<p>The theory that relates the causal-inference and the meta-analytic frameworks in the multiple-trial setting (as developped in Alonso et al., submitted) assumes that a reduced or semi-reduced modelling approach is used in the meta-analytic framework. Thus <code class="reqn">R_{trial}</code>,  <code class="reqn">d_{aa}</code> and <code class="reqn">d_{bb}</code> should be estimated based on a reduced model (i.e., using the <code>Model=c("Reduced")</code> argument in the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, or <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>) or based on a semi-reduced model (i.e., using the <code>Model=c("SemiReduced")</code> argument in the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, or <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>). </p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal-inference and meta-analytic paradigms for the validation of surrogate markers.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>, <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a></code>, <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #Time consuming (&gt;5 sec) code part
# Generate the vector of MICA values when R_trial=.8, rho_T0S0=rho_T1S1=.8,
# sigma_T0T0=90, sigma_T1T1=100,sigma_ S0S0=10, sigma_S1S1=15, D.aa=5, D.bb=10,
# and when the grid of values {-1, -0.999, ..., 1} is considered for the
# correlations between the counterfactuals:
SurMICA &lt;- MICA.Sample.ContCont(Trial.R=.80, D.aa=5, D.bb=10, T0S0=.8, T1S1=.8,
T0T0=90, T1T1=100, S0S0=10, S1S1=15, T0T1=seq(-1, 1, by=.001),
T0S1=seq(-1, 1, by=.001), T1S0=seq(-1, 1, by=.001),
S0S1=seq(-1, 1, by=.001), M=10000)

# Examine and plot the vector of the generated MICA values:
summary(SurMICA)
plot(SurMICA, ICA=FALSE, MICA=TRUE)


# Same analysis, but now assume that D.aa=.5 and D.bb=.1:
SurMICA &lt;- MICA.Sample.ContCont(Trial.R=.80, D.aa=.5, D.bb=.1, T0S0=.8, T1S1=.8,
T0T0=90, T1T1=100, S0S0=10, S1S1=15, T0T1=seq(-1, 1, by=.001),
T0S1=seq(-1, 1, by=.001), T1S0=seq(-1, 1, by=.001),
S0S1=seq(-1, 1, by=.001), M=10000)

# Examine and plot the vector of the generated MICA values:
summary(SurMICA)
plot(SurMICA)

## End(Not run)
</code></pre>

<hr>
<h2 id='MinSurrContCont'>Examine the plausibility of finding a good surrogate endpoint in the Continuous-continuous case</h2><span id='topic+MinSurrContCont'></span>

<h3>Description</h3>

<p>The function <code>MinSurrContCont</code> examines the plausibility of finding a good surrogate endpoint in the continuous-continuous setting. For details, see Alonso et al. (submitted).</p>


<h3>Usage</h3>

<pre><code class='language-R'>MinSurrContCont(T0T0, T1T1, Delta, T0T1=seq(from=0, to=1, by=.01))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MinSurrContCont_+3A_t0t0">T0T0</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code id="MinSurrContCont_+3A_t1t1">T1T1</code></td>
<td>
<p>A scalar that specifies the variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code id="MinSurrContCont_+3A_delta">Delta</code></td>
<td>
<p>A scalar that specifies an upper bound for the prediction mean squared error when predicting the individual causal effect of the treatment on the true endpoint based on the individual causal effect of the treatment on the surrogate.</p>
</td></tr>
<tr><td><code id="MinSurrContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of     <code class="reqn">\rho_{min}^{2}</code>. Default <code>seq(0, 1, by=.1)</code>, i.e., the values <code class="reqn">0</code>, <code class="reqn">0.10</code>, <code class="reqn">0.20</code>, ..., <code class="reqn">1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>MinSurrContCont</code> with components, 
</p>
<table>
<tr><td><code>T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that were considered (i.e., <code class="reqn">\rho_{T_{0}T_{1}}</code>).</p>
</td></tr>
<tr><td><code>Sigma.Delta.T</code></td>
<td>
<p>A scalar or vector that contains the standard deviations of the individual causal treatment effects on the true endpoint as a function of <code class="reqn">\rho_{T_{0}T_{1}}</code>.</p>
</td></tr>
<tr><td><code>Rho2.Min</code></td>
<td>
<p>A scalar or vector that contains the <code class="reqn">\rho_{min}^{2}</code> values as a function of <code class="reqn">\rho_{T_{0}T_{1}}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal-inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>, <code><a href="#topic+plot+20Causal-Inference+20ContCont">plot Causal-Inference ContCont</a>, <a href="#topic+plot+20MinSurrContCont">plot MinSurrContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Assess the plausibility of finding a good surrogate when
# sigma_T0T0 = sigma_T1T1 = 8 and Delta = 1
## Not run: 
MinSurr &lt;- MinSurrContCont(T0T0 = 8, T1T1 = 8, Delta = 1)
summary(MinSurr)
plot(MinSurr)
## End(Not run)
</code></pre>

<hr>
<h2 id='MixedContContIT'>Fits (univariate) mixed-effect models to assess surrogacy in the continuous-continuous case based on the Information-Theoretic framework</h2><span id='topic+MixedContContIT'></span>

<h3>Description</h3>

<p>The function <code>MixedContContIT</code> uses the information-theoretic approach (Alonso &amp; Molenberghs, 2007) to estimate trial- and individual-level surrogacy based on mixed-effect models when both S and T are continuous endpoints. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MixedContContIT(Dataset, Surr, True, Treat, Trial.ID, Pat.ID,
Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MixedContContIT_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. In practice it is often the case that different trials (or other clustering units) have different sample sizes. Univariate models are used to assess surrogacy in the information-theoretic approach, so it can be useful to adjust for heterogeneity in information content between the trial-specific contributions (particularly when trial-level surrogacy measures are of primary interest and when the heterogeneity in sample sizes is large). If <code>Weighted=TRUE</code>, weighted regression models are fitted. If <code>Weighted=FALSE</code>, unweighted regression analyses are conducted. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{h}</code> and <code class="reqn">R^2_{ht}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="MixedContContIT_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function <code>lmer</code> (of the R package <code>lme4</code>) that is used to fit the geralized linear mixed-effect models in the function <code>BimixedContCont</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>The following generalised linear mixed-effect models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}))=\mu_{T}+m_{Ti}+\beta Z_{ij}+b_{i}Z_{ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">g_{T}(E(T_{ij}|S_{ij}))=\theta_{0}+c_{Ti}+\theta_{1}Z_{ij}+a_{i}Z_{ij}+\theta_{2i}S_{ij},</code>
</p>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">g_{T}</code> is an appropriate link function (i.e., an identity link when a continuous true endpoint is considered), <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>. <code class="reqn">\mu_{T}</code> and <code class="reqn">\beta</code> are a fixed intercept and a fixed treatment-effect on the true endpoint, while <code class="reqn">m_{Ti}</code> and <code class="reqn">b_{i}</code> are the corresponding random effects. <code class="reqn">\theta_{0}</code> and <code class="reqn">\theta_{1}</code> are the fixed intercept and the fixed treatment effect on the true endpoint after accounting for the effect of the surrogate endpoint, and <code class="reqn">c_{Ti}</code> and <code class="reqn">a_i</code> are the corresponding random effects. 
</p>
<p>The <code class="reqn">-2</code> log likelihood values of the previous models (i.e., <code class="reqn">L_{1}</code> and <code class="reqn">L_{2}</code>, respectively) are subsequently used to compute individual-level surrogacy (based on the so-called Variance Reduction Factor, VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{hind}= 1 - exp \left(-\frac{L_{2}-L_{1}}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials.
</p>
<p><em>Trial-level surrogacy</em>
</p>
<p>When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), trial-level surrogacy is assessed by fitting the following mixed models: 
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},   (1)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},   (1)</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts,  <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects on S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random effects. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent.
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},   (2)</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},   (2)</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T. The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent.
</p>
<p>When the user requested that a full model approach is used (by using the argument <code>Model=c("Full")</code> in the function call, i.e., when models (1) were fitted), the following model is subsequently fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha_i}+\varepsilon_{i},   (3)</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on models (1) (see above).  When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), model (3) is a weighted regression model (with weights based on the number of observations in trial <code class="reqn">i</code>). The <code class="reqn">-2</code> log likelihood value of the (weighted or unweighted) models (3) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the Variance Reduction Factor (VFR; for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on models (2). The <code class="reqn">-2</code> log likelihood value of this (weighted or unweighted) model (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">\widehat{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>MixedContContIT</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Trial.Spec.Results</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>R2ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level surrogacy estimate and its confidence interval.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>) that are obtained when models (1) or models (2) are fitted (see the <b>Details</b> section above).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+FixedContContIT">FixedContContIT</a></code>, <code><a href="#topic+plot+20Information-Theoretic">plot Information-Theoretic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Example 1
# Based on the ARMD data:
data(ARMD)
# Assess surrogacy based on a full mixed-effect model
# in the information-theoretic framework:
Sur &lt;- MixedContContIT(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center,
Pat.ID=Id, Model="Full")
# Obtain a summary of the results:
summary(Sur)

# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients, 200 trials,
# and Rindiv=Rtrial=.8
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=200, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Full")
# Assess surrogacy based on a full mixed-effect model
# in the information-theoretic framework:
Sur2 &lt;- MixedContContIT(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat,
Trial.ID=Trial.ID, Pat.ID=Pat.ID, Model="Full")

# Show a summary of the results:
summary(Sur2)
## End(Not run)
</code></pre>

<hr>
<h2 id='model_fit_measures'>Goodness of fit information for survival-survival model</h2><span id='topic+model_fit_measures'></span>

<h3>Description</h3>

<p>This function returns several goodness-of-fit measures for a model fitted by
<code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. These are primarily intended for model selection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>model_fit_measures(fitted_model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="model_fit_measures_+3A_fitted_model">fitted_model</code></td>
<td>
<p>returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following goodness-of-fit measures are returned in a named vector:
</p>

<ul>
<li> <p><code>tau_0</code> and <code>tau_1</code>: (latent) value for Kendall's tau in the estimated
model.
</p>
</li>
<li> <p><code>log_lik</code>: the maximized log-likelihood value.
</p>
</li>
<li> <p><code>AIC</code>: the Aikaike information criterion of the fitted model.
</p>
</li></ul>



<h3>Value</h3>

<p>a named vector containing the goodness-of-fit measures
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(Surrogate)
data("Ovarian")
#For simplicity, data is not recoded to semi-competing risks format, but is
#left in the composite event format.
data = data.frame(
  Ovarian$Pfs,
  Ovarian$Surv,
  Ovarian$Treat,
  Ovarian$PfsInd,
  Ovarian$SurvInd
)
ovarian_fitted =
    fit_model_SurvSurv(data = data,
                       copula_family = "clayton",
                       n_knots = 1)
model_fit_measures(ovarian_fitted)
</code></pre>

<hr>
<h2 id='MufixedContCont.MultS'>Fits a multivariate fixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case with multiple surrogates)</h2><span id='topic+MufixedContCont.MultS'></span>

<h3>Description</h3>

<p>The function <code>MufixedContCont.MultS</code> uses the multivariate fixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available and multiple surrogates are considered for a single true endpoint. The user can specify whether a (weighted or unweighted) full or reduced model should be fitted. See the <b>Details</b> section below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MufixedContCont.MultS(Dataset, Endpoints=True~Surr.1+Surr.2, 
 Treat="Treat", Trial.ID="Trial.ID", Pat.ID="Pat.ID", 
 Model=c("Full"), Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, 
 Number.Bootstraps=0, Seed=123)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MufixedContCont.MultS_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains one or more  surrogate value(s), a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_endpoints">Endpoints</code></td>
<td>
<p>An equation in the form <code>True~Surr.1+Surr.2</code> that specifies the true endpoint followed by the surrogate endpoint(s).</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code> or <code>Model=c("Reduced")</code>. For details, see below or Van der Elst <em>et al.</em> (2023). 
Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain in order to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>Lee's (Lee, 1971) approach is done by default to obtain confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code>. Alternatively, a non-parametric bootstrap can be done. By default, <code>Number.Bootstraps=0</code> and thus no bootstrap is conducted. If a bootstrap is desired, specify the number of bootstrap samples used this argument. For example, <code>Number.Bootstraps=100</code> conducts a bootstrap with 100 bootstrap samples.</p>
</td></tr>
<tr><td><code id="MufixedContCont.MultS_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used in the bootstrap. Default <code>Seed=123</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the full multivariate mixed-effects model is fitted to assess surrogacy in the meta-analytic framework (for details, see Van der Elst <em>et al.</em>, 2023), computational issues often occur. In that situation, the use of simplified model-fitting strategies may be warranted (for details, see Burzykowski et al., 2005; Tibaldi et al., 2003).   
</p>
<p>The function <code>MufixedContCont.MultS</code> implements one such strategy, i.e., it uses a two-stage multivariate fixed-effects modelling approach to assess surrogacy. 
In the first stage of the analysis, a multivariate linear regression model is fitted. When a full model is requested (by using the argument <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S1_{ij}=\mu_{S1i}+\alpha_{S1i}Z_{ij}+\varepsilon_{S1ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">S2_{ij}=\mu_{S2i}+\alpha_{S2i}Z_{ij}+\varepsilon_{S2ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">SK_{ij}=\mu_{SKi}+\alpha_{SKi}Z_{ij}+\varepsilon_{SKij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{Ti}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S1i}</code>, <code class="reqn">\mu_{S2i}</code>, ..., <code class="reqn">\mu_{SKi}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for <code class="reqn">S1</code>, <code class="reqn">S2</code>, ... <code class="reqn">SK</code> and <code class="reqn">T</code>, and <code class="reqn">\alpha_{S1i}</code>, <code class="reqn">\alpha_{S2i}</code>, ..., <code class="reqn">\alpha_{SKi}</code> and <code class="reqn">\beta_{Ti}</code> are the trial-specific treatment effects on the surrogates and the true endpoint, respectively. When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S1_{ij}=\mu_{S1}+\alpha_{S1i}Z_{ij}+\varepsilon_{S1ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">S2_{ij}=\mu_{S2}+\alpha_{S2i}Z_{ij}+\varepsilon_{S2ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">SK_{ij}=\mu_{SK}+\alpha_{SKi}Z_{ij}+\varepsilon_{SKij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{Ti}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">\mu_{S1}</code>, <code class="reqn">\mu_{S2}</code>, ..., <code class="reqn">\mu_{SK}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for the surrogates and the true endpoint (i.e., it is assumed that the intercepts for the surrogates and the true endpoints are identical in all trials). The other parameters are the same as defined above. 
</p>
<p>In the above models, the error terms <code class="reqn">\varepsilon_{S1ij}</code>, <code class="reqn">\varepsilon_{S2ij}</code>, ..., <code class="reqn">\varepsilon_{SKij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with variance-covariance matrix <code class="reqn">\bold{\Sigma}</code>. 
</p>
<p>Next, the second stage of the analysis is conducted. When a full model is requested by the user (by using the argument  <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{Ti}=\lambda_{0}+\lambda_{1}\widehat{\mu}_{S1i}+
\lambda_{2}\widehat{\alpha}_{S1i}+\lambda_{3}\widehat{\mu}_{S2i}+\lambda_{4}\widehat{\alpha}_{S2i}+...+
\lambda_{2K-1}\widehat{\mu}_{SKi}+\lambda_{2K}\widehat{\alpha}_{SKi}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates are based on the full model that was fitted in stage 1. 
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code>), the <code class="reqn">\lambda_{1} \widehat{\mu}_{S1i}</code>, <code class="reqn">\lambda_{3} \widehat{\mu}_{S2i}</code>, ... and <code class="reqn">\lambda_{2K} \widehat{\mu}_{SKi}</code> components are dropped from the above expression. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>MufixedContCont.MultS</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate(s) and the true endpoints (when a full model is requested), or the trial-specific treatment effects for the surrogates and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>Residuals.Stage.1</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained in stage 1 of the analysis (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>Trial.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td></tr>
<tr><td><code>Trial.R2.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td></tr>
<tr><td><code>Trial.R2.Adj.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the adjusted trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td></tr>
<tr><td><code>Trial.R2.Adj.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the adjusted trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td></tr>
<tr><td><code>Indiv.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td></tr>
<tr><td><code>Indiv.R2.Boot</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval based on the non-parametric bootstrap.</p>
</td></tr>
<tr><td><code>Fitted.Model.Stage.1</code></td>
<td>
<p>The fitted Stage 1 model.</p>
</td></tr>
<tr><td><code>Model.R2.Indiv</code></td>
<td>
<p>A linear model that regresses the residuals of T on the residuals of the different surrogates.</p>
</td></tr>
<tr><td><code>D.Equiv</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercept and treatment effects for the surrogates and true endpoints (when a full model is fitted, i.e., when <code>Model=c("Full")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogates and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).  The variance-covariance matrix <code>D.Equiv</code> is equivalent to the <code class="reqn">\bold{D}</code> matrix that would be obtained when a (full or reduced) mixed-effect approach is used; see function <code><a href="#topic+MumixedContCont.MultS">MumixedContCont.MultS</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Lee, Y. S. (1971). Tables of the upper percentage points of the multiple correlation. <em>Biometrika, 59,</em> 175-189.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>
<p>Van der Elst <em>et al.</em> (2024). Multivariate surrogate endpoints for normally distributed continuous endpoints in the meta-analytic setting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MumixedContCont.MultS">MumixedContCont.MultS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
data(PANSS)

# Do a surrogacy analysis with T=Total PANSS score, S1=Negative symptoms
# and S2=Positive symptoms
# Fit a full multivariate fixed-effects model with weighting according to the  
# number of patients in stage 2 of the two stage approach to assess surrogacy:
Fit.Neg.Pos &lt;- MufixedContCont.MultS(Dataset = PANSS, 
  Endpoints = Total ~ Neg+Pos, Model = "Full", 
  Treat = "Treat", Trial.ID = "Invest", Pat.ID = "Pat.ID")
  
# Obtain a summary of the results
summary(Fit.Neg.Pos)

## End(Not run)
</code></pre>

<hr>
<h2 id='MumixedContCont.MultS'>Fits a multivariate mixed-effects model to assess surrogacy in the meta-analytic multiple-trial setting (Continuous-continuous case with multiple surrogates)</h2><span id='topic+MumixedContCont.MultS'></span>

<h3>Description</h3>

<p>The function <code>MumixedContCont.MultS</code> uses the multivariate mixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available and multiple surrogates are considered for a single true endpoint. See the <b>Details</b> section below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MumixedContCont.MultS(Dataset, Endpoints=True~Surr.1+Surr.2, 
Treat="Treat", Trial.ID="Trial.ID", Pat.ID="Pat.ID", 
Model=c("Full"), Min.Trial.Size=2, Alpha=.05, Opt="nlminb")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MumixedContCont.MultS_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains one or more  surrogate value(s), a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_endpoints">Endpoints</code></td>
<td>
<p>An equation in the form <code>True~Surr.1+Surr.2</code> that specifies the true endpoint followed by the surrogate endpoint(s).</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code> or <code>Model=c("Reduced")</code>. For details, see below or Van der Elst <em>et al.</em> (2023). 
Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain in order to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code> (based on the approach of Lee, 1971). Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="MumixedContCont.MultS_+3A_opt">Opt</code></td>
<td>
<p>The optimizer to be used by the <code>lme</code> function (the fits the mixed-effects model), with options <code>nlminb</code> or <code>optim</code>. For  details, see <code>?lmeControl</code>. Default <code>Opt="nlminb"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a full model is requested (by using the argument <code>Model=c("Full")</code> in the function call), the following mixed-effects model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">S1_{ij}=\mu_{S1}+m_{S1i}(\alpha_{S1}+a_{S1i})Z_{ij}+\varepsilon_{S1ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">S2_{ij}=\mu_{S2}+m_{S2i}(\alpha_{S2}+a_{S2i})Z_{ij}+\varepsilon_{S2ij},</code>
</p>

<p style="text-align: center;"><code class="reqn">SK_{ij}=\mu_{SK}+m_{SKi}(\alpha_{SK}+a_{SKi})Z_{ij}+\varepsilon_{SKij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}(\beta_{T}+b_{Ti})Z_{ij}+\varepsilon_{Tij},</code>
</p>

<p>where <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, 
<code class="reqn">\mu_{S1}</code>, <code class="reqn">\mu_{S2}</code>, ... <code class="reqn">\mu_{SK}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for <code class="reqn">S1</code>, <code class="reqn">S2</code>, ... <code class="reqn">SK</code> and <code class="reqn">T</code>, <code class="reqn">m_{S1i}</code>, <code class="reqn">m_{S2i}</code>, ... <code class="reqn">m_{SKi}</code>, and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts, <code class="reqn">\alpha_{S1}</code>, <code class="reqn">\alpha_{S2}</code>, ..., <code class="reqn">\alpha_{SK}</code> and <code class="reqn">\beta_T</code> are the fixed treatment effects for <code class="reqn">S1</code>, <code class="reqn">S2</code>, ... <code class="reqn">SK</code> and <code class="reqn">T</code>, and <code class="reqn">a_{S1i}</code>, <code class="reqn">a_{S2i}</code>, ... <code class="reqn">a_{SKi}</code> and <code class="reqn">b_{Ti}</code> are the corresponding random treatment effects. The vector of the random effects <code class="reqn">\left(m_{S1i},\:m_{S2i}, \: ... , \: m_{SKi},\: m_{Ti},\: a_{S1i},\: a_{S2i},\: ... , \: a_{SKi},\: b_{Ti}\right)</code> is assumed to be mean-zero normally distributed with unstructured variance-covariance matrix <code class="reqn">\mathbf{D}</code>. Similarly, the residuals <code class="reqn">\varepsilon_{S1ij}</code>, <code class="reqn">\varepsilon_{S2ij}</code>, ... <code class="reqn">\varepsilon_{SKij}</code>,  <code class="reqn">\varepsilon_{Tij}</code> are assumed to be mean-zero normally distributed with unstructured variance-covariance matrix <code class="reqn">\mathbf{\Sigma}</code>.
</p>
<p>When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the trial-specific intercepts for the surrogate endpoints and the true endpoint in the above model are replaced by common intercepts.
</p>
<p>For the full model, <code class="reqn">R^2_{trial}</code> and <code class="reqn">R^2_{indiv}</code> are estimated based on <code class="reqn">\mathbf{D}</code> and <code class="reqn">\mathbf{\Sigma}</code>, respectively:
</p>
<p style="text-align: center;"><code class="reqn">R_{trial}^{2}=R^2_{b_{Ti}|m_{S1i},\: m_{S2i},\: ..., \:m_{SKi}, \:  a_{S1i},\: a_{S2i}, \: ... \: a_{SKi}}=
\dfrac{\boldsymbol{D}_{ST}^T \: \boldsymbol{D}^{-1}_{SS} \: \boldsymbol{D}_{ST}}{\boldsymbol{D}_{TT}},</code>
</p>

<p style="text-align: center;"><code class="reqn">R_{indiv}^{2}=R_{\varepsilon_{Tij}|\varepsilon_{S1ij}, \: \varepsilon_{S2ij}, \: ..., \: \varepsilon_{SKij}}^{2}=
\dfrac{\boldsymbol{\Sigma}_{ST}^T \: \boldsymbol{\Sigma}^{-1}_{SS} \: \boldsymbol{\Sigma}_{ST}}{\boldsymbol{\Sigma}_{TT}}.</code>
</p>

<p>For the reduced model, the reduced <code class="reqn">\mathbf{D}</code> and <code class="reqn">\mathbf{\Sigma}</code> are used. 
</p>


<h3>Value</h3>

<p>An object of class <code>MumixedContCont.MultS</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Fixed.Effects</code></td>
<td>
<p>A <code>data.frame</code> that contains the fixed intercepts and treatment effects for the true and the surrogate endpoints.</p>
</td></tr>
<tr><td><code>Random.Effects</code></td>
<td>
<p>A <code>data.frame</code> that contains the random intercepts and treatment effects for the true and the surrogate endpoints.</p>
</td></tr>
<tr><td><code>Trial.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td></tr>
<tr><td><code>Indiv.R2.Lee</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval based on the approach of Lee (1971).</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercepts and treatment effects for the surrogates and true endpoints (when a full model is fitted, i.e., when <code>Model=c("Full")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogates and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).</p>
</td></tr>
<tr><td><code>Cond.Number.D.Matrix</code></td>
<td>
<p>The condition number of the <code class="reqn">\mathbf{D}</code> matrix.</p>
</td></tr>  
<tr><td><code>Cond.Number.Sigma.Matrix</code></td>
<td>
<p>The condition number of the <code class="reqn">\mathbf{\Sigma}</code> matrix.</p>
</td></tr>  
<tr><td><code>Fitted.Model</code></td>
<td>
<p>The fitted mixed-effects model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Lee, Y. S. (1971). Tables of the upper percentage points of the multiple correlation. <em>Biometrika, 59,</em> 175-189.
</p>
<p>Van der Elst <em>et al.</em> (2024). Multivariate surrogate endpoints for normally distributed continuous endpoints in the meta-analytic setting.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MufixedContCont.MultS">MufixedContCont.MultS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
data(PANSS)

# Do a surrogacy analysis with T=Total PANSS score, 
# S1=Negative symptoms and S2=Positive symptoms
# Fit a full mixed-effects model:
Fit.Neg.Pos &lt;- MumixedContCont.MultS(Dataset = PANSS, 
  Endpoints = Total ~ Neg+Pos, Model = "Full", 
  Treat = "Treat", Trial.ID = "Invest", Pat.ID = "Pat.ID")
  
# Model does not converge, as often happens with the 
# mixed-effects approach. Instead, fit a full multivariate 
# fixed-effects model with weighting according to the  
# number of patients in stage 2 of the two stage approach to assess surrogacy:
Fit.Neg.Pos &lt;- MufixedContCont.MultS(Dataset = PANSS, 
  Endpoints = Total ~ Neg+Pos, Model = "Full", 
  Treat = "Treat", Trial.ID = "Invest", Pat.ID = "Pat.ID")
  
# Obtain a summary of the results
summary(Fit.Neg.Pos)
# 

## End(Not run)
</code></pre>

<hr>
<h2 id='new_vine_copula_ss_fit'>Constructor for vine copula model</h2><span id='topic+new_vine_copula_ss_fit'></span>

<h3>Description</h3>

<p>Constructor for vine copula model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_vine_copula_ss_fit(
  fit_0,
  fit_1,
  copula_family,
  knots0,
  knots1,
  knott0,
  knott1,
  copula_rotations,
  data
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_vine_copula_ss_fit_+3A_fit_0">fit_0</code></td>
<td>
<p>Estimated parameters in the control group.</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_fit_1">fit_1</code></td>
<td>
<p>Estimated parameters in the experimental group</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_copula_family">copula_family</code></td>
<td>
<p>Parametric copula family</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_knots0">knots0</code></td>
<td>
<p>placement of knots for Royston-Parmar model</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_knots1">knots1</code></td>
<td>
<p>placement of knots for Royston-Parmar model</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_knott0">knott0</code></td>
<td>
<p>placement of knots for Royston-Parmar model</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_knott1">knott1</code></td>
<td>
<p>placement of knots for Royston-Parmar model</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_copula_rotations">copula_rotations</code></td>
<td>
<p>vector of copula rotation parameters</p>
</td></tr>
<tr><td><code id="new_vine_copula_ss_fit_+3A_data">data</code></td>
<td>
<p>Original data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>S3 object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#should not be used be the user
</code></pre>

<hr>
<h2 id='Ovarian'>The Ovarian dataset</h2><span id='topic+Ovarian'></span>

<h3>Description</h3>

<p>This dataset combines the data that were collected in four double-blind randomized clinical trials in advanced ovarian cancer (Ovarian Cancer Meta-Analysis Project, 1991). In these trials, the objective was to examine the efficacy of cyclophosphamide plus cisplatin (CP) versus  cyclophosphamide plus adriamycin plus cisplatin (CAP) to treat advanced ovarian cancer.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Ovarian")</code></pre>


<h3>Format</h3>

<p>A data frame with 1192 observations on the following 7 variables.
</p>

<dl>
<dt><code>Patient</code></dt><dd><p>The ID number of a patient.</p>
</dd>
<dt><code>Center</code></dt><dd><p>The center in which a patient was treated.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as 0=CP (active control) and 1=CAP (experimental treatment).</p>
</dd>
<dt><code>Pfs</code></dt><dd><p>Progression-free survival (the candidate surrogate).</p>
</dd>
<dt><code>PfsInd</code></dt><dd><p>Censoring indicator for progression-free survival.</p>
</dd>
<dt><code>Surv</code></dt><dd><p>Survival time (the true endpoint).</p>
</dd>
<dt><code>SurvInd</code></dt><dd><p>Censoring indicator for survival time.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ovarian Cancer Meta-Analysis Project (1991). Cclophosphamide plus cisplatin plus adriamycin versus cyclophosphamide, doxorubicin, and cisplatin chemotherapy of ovarian carcinoma: a meta-analysis. <em>Classic papers and current comments, 3,</em> 237-234.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Ovarian)
str(Ovarian)
head(Ovarian)
</code></pre>

<hr>
<h2 id='PANSS'>
PANSS subscales and total score based on the data of five clinical trials in schizophrenia
</h2><span id='topic+PANSS'></span>

<h3>Description</h3>

<p>These are the PANSS subscale and total scale scores of five clinical trial in schizophrenia. A total of <code class="reqn">1941</code> patients were treated by <code class="reqn">126</code> investiagators (psychiatrists). There were two treatment conditions (risperidone and control). Patients' schizophrenic symptoms were measured using the PANSS (Kay et al., 1988).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(PANSS)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">1941</code> observations on <code class="reqn">9</code> variables.
</p>

<dl>
<dt><code>Pat.Id</code></dt><dd><p>The patient ID.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = active control and <code class="reqn">1</code> = Risperidone.</p>
</dd>
<dt><code>Invest</code></dt><dd><p>The ID of the investigator (psychiatrist) who treated the patient.</p>
</dd>
<dt><code>Neg</code></dt><dd><p>The Negative symptoms scale score.</p>
</dd>
<dt><code>Exc</code></dt><dd><p>The Excitement scale score.</p>
</dd>
<dt><code>Cog</code></dt><dd><p>The Cognition scale score.</p>
</dd>
<dt><code>Pos</code></dt><dd><p>The Positive symptoms scale score.</p>
</dd>
<dt><code>Dep</code></dt><dd><p>The Depression scale score.</p>
</dd>
<dt><code>Total</code></dt><dd><p>The Total PANSS score.</p>
</dd>
</dl>



<h3>References</h3>

<p>Kay, S.R., Opler, L.A., &amp; Lindenmayer, J.P. (1988). Reliability and validity of the Positive and Negative Syndrome Scale for schizophrenics. Psychiatric Research, 23, 99-110.
</p>

<hr>
<h2 id='pdf_fun'>Function factory for density functions</h2><span id='topic+pdf_fun'></span>

<h3>Description</h3>

<p>Function factory for density functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdf_fun(para, family)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdf_fun_+3A_para">para</code></td>
<td>
<p>Parameter vector.</p>
</td></tr>
<tr><td><code id="pdf_fun_+3A_family">family</code></td>
<td>
<p>Distributional family, one of the following:
</p>

<ul>
<li> <p><code>"normal"</code>: normal distribution where <code>para[1]</code> is the mean and <code>para[2]</code> is
the standard deviation.
</p>
</li>
<li> <p><code>"logistic"</code>: logistic distribution as parameterized in <code>stats::plogis()</code> where
<code>para[1]</code> and <code>para[2]</code> correspond to <code>location</code> and <code>scale</code>, respectively.
</p>
</li>
<li> <p><code>"t"</code>: t distribution as parameterized in <code>stats::pt()</code> where <code>para[1]</code> and
<code>para[2]</code> correspond to <code>ncp</code> and <code>df</code>, respectively.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A density function that has a single argument. This is the vector of
values in which the density function is evaluated.
</p>

<hr>
<h2 id='plot+20Causal-Inference+20BinBin'>
Plots the (Meta-Analytic) Individual Causal Association and related metrics when S and T are binary outcomes
</h2><span id='topic+plot+20Causal-Inference+20BinBin'></span><span id='topic+plot.ICA.BinBin'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies, percentages, cumulative percentages or densities of the individual causal association (ICA; <code class="reqn">R^2_{H}</code> or <code class="reqn">R_{H}</code>), and/or the odds ratios for <code class="reqn">S</code> and <code class="reqn">T</code> (<code class="reqn">\theta_{S}</code> and <code class="reqn">\theta_{T}</code>). </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ICA.BinBin'
plot(x, R2_H=TRUE, R_H=FALSE, Theta_T=FALSE, 
Theta_S=FALSE, Type="Density", Labels=FALSE, Xlab.R2_H, 
Main.R2_H, Xlab.R_H, Main.R_H, Xlab.Theta_S, Main.Theta_S, Xlab.Theta_T, 
Main.Theta_T, Cex.Legend=1, Cex.Position="topright",  
col, Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ylim, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.BinBin</code>. See <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_r2_h">R2_H</code></td>
<td>
<p>Logical. When <code>R2_H=TRUE</code>, a plot of the <code class="reqn">R^2_{H}</code> is provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_r_h">R_H</code></td>
<td>
<p>Logical. When <code>R_H=TRUE</code>, a plot of the <code class="reqn">R_{H}</code> is provided. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_theta_t">Theta_T</code></td>
<td>
<p>Logical. When <code>Theta_T=TRUE</code>, a plot of the <code class="reqn">\theta_{T}</code> is provided. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_theta_s">Theta_S</code></td>
<td>
<p>Logical. When <code>Theta_S=TRUE</code>, a plot of the <code class="reqn">\theta_{S}</code> is provided. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code> or <code>Type="Percent"</code>, the Y-axis shows frequencies or percentages of <code class="reqn">R^2_{H}</code>, <code class="reqn">R_{H}</code>, <code class="reqn">\theta_{T}</code>, or <code class="reqn">\theta_{S}</code>. When <code>Type="CumPerc"</code>, the Y-axis shows cumulative percentages.  When <code>Type="Density"</code>, the density is shown. 
When the fitted object of class <code>ICA.BinBin</code> was obtained using a general analysis (i.e., using the <code>Monotonicity=c("General")</code> argument in the function call), sperate plots are provided for the different monotonicity scenarios. Default <code>"Density"</code>.</p>
</td></tr>  
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_labels">Labels</code></td>
<td>
<p>Logical. When <code>Labels=TRUE</code>, the percentage of <code class="reqn">R^2_{H}</code>, <code class="reqn">R_{H}</code>, <code class="reqn">\theta_{T}</code>, or <code class="reqn">\theta_{S}</code> values that are equal to or larger than the midpoint value of each of the bins are displayed (on top of each bin). Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_xlab.r2_h">Xlab.R2_H</code></td>
<td>
<p>The legend of the X-axis of the <code class="reqn">R^2_{H}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_main.r2_h">Main.R2_H</code></td>
<td>
<p>The title of the <code class="reqn">R^2_{H}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_xlab.r_h">Xlab.R_H</code></td>
<td>
<p>The legend of the X-axis of the <code class="reqn">R_{H}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_main.r_h">Main.R_H</code></td>
<td>
<p>The title of the <code class="reqn">R_{H}</code> plot.</p>
</td></tr> 
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_xlab.theta_s">Xlab.Theta_S</code></td>
<td>
<p>The legend of the X-axis of the <code class="reqn">\theta_{S}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_main.theta_s">Main.Theta_S</code></td>
<td>
<p>The title of the <code class="reqn">\theta_{S}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_xlab.theta_t">Xlab.Theta_T</code></td>
<td>
<p>The legend of the X-axis of the <code class="reqn">\theta_{T}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_main.theta_t">Main.Theta_T</code></td>
<td>
<p>The title of the <code class="reqn">\theta_{T}</code> plot.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_cex.legend">Cex.Legend</code></td>
<td>
<p>The size of the legend when <code>Type="All.Densities"</code> is used. Default <code>Cex.Legend=1</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_cex.position">Cex.Position</code></td>
<td>
<p>The position of the legend, <code>Cex.Position="topright"</code> or <code>Cex.Position="topleft"</code>. Default <code>Cex.Position="topright"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_col">col</code></td>
<td>
<p>The color of the bins. Default <code>col &lt;- c(8)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_ylim">ylim</code></td>
<td>
<p>The (min, max) values for the Y-axis</p>
</td></tr></table>
<p>. 
</p>
<table>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinBin_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). A causal-inference approach for the validation of surrogate endpoints based on information theory and sensitivity analysis.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.BinBin">ICA.BinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute R2_H given the marginals, 
# assuming monotonicity for S and T and grids
# pi_0111=seq(0, 1, by=.001) and 
# pi_1100=seq(0, 1, by=.001)
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.261, pi1_0_=0.285, 
pi_1_1=0.637, pi_1_0=0.078, pi0_1_=0.134, pi_0_1=0.127,  
Monotonicity=c("General"), M=2500, Seed=1)
           
# Plot the results (density of R2_H):
plot(ICA, Type="Density", R2_H=TRUE, R_H=FALSE, 
Theta_T=FALSE, Theta_S=FALSE)
</code></pre>

<hr>
<h2 id='plot+20Causal-Inference+20BinCont'>Plots the (Meta-Analytic) Individual Causal Association and related metrics when S is continuous and T is binary</h2><span id='topic+plot+20Causal-Inference+20BinCont'></span><span id='topic+plot.ICA.BinCont'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies, percentages, cumulative percentages or densities of the individual causal association (ICA; <code class="reqn">R^2_{H}</code>) in the setting where S is continuous and T is binary. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ICA.BinCont'
plot(x, Histogram.ICA=TRUE, Mixmean=TRUE,
Mixvar=TRUE, Deviance=TRUE, 
Type="Percent", Labels=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.BinCont</code>. See <code><a href="#topic+ICA.BinCont">ICA.BinCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_histogram.ica">Histogram.ICA</code></td>
<td>
<p>Logical. Should a histogram of ICA be provided? Default <code>Histogram.ICA=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_mixmean">Mixmean</code></td>
<td>
<p>Logical. Should a plot of the calculated means of the fitted mixtures for <code class="reqn">S[0]</code> and <code class="reqn">S[1]</code> across the different runs be provided? Default <code>Mixmean=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_mixvar">Mixvar</code></td>
<td>
<p>Logical. Should a plot of the calculated variances of the fitted mixtures for <code class="reqn">S[0]</code> and <code class="reqn">S[1]</code> across the different runs be provided? Default <code>Mixvar=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_deviance">Deviance</code></td>
<td>
<p>Logical. Should a box plot of the deviances for the fitted mixtures of <code class="reqn">S[0]</code> and <code class="reqn">S[1]</code> be provided? Default <code>Deviance=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced for the histogram of ICA. When <code>Type="Freq"</code> or <code>Type="Percent"</code>, the Y-axis shows frequencies or percentages of <code class="reqn">R^2_{H}</code>. When <code>Type="CumPerc"</code>, the Y-axis shows cumulative percentages.  When <code>Type="Density"</code>, the density is shown</p>
</td></tr></table>
<p>. 
</p>
<table>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_labels">Labels</code></td>
<td>
<p>Logical. When <code>Labels=TRUE</code>, the percentage of <code class="reqn">R^2_{H}</code> values that are equal to or larger than the midpoint value of each of the bins are added in the histogram of ICA (on top of each bin). Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20BinCont_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, &amp; Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Meyvisch, P. (2016). Surrogate markers validation: the continuous-binary setting from a causal inference perspective.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.BinCont">ICA.BinCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Time consuming code part
Fit &lt;- ICA.BinCont(Dataset = Schizo, Surr = BPRS, True = PANSS_Bin, 
Treat=Treat, M=50, Seed=1)

summary(Fit)
plot(Fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20Causal-Inference+20ContCont'>
Plots the (Meta-Analytic) Individual Causal Association when S and T are continuous outcomes
</h2><span id='topic+plot+20Causal-Inference+20ContCont'></span><span id='topic+plot.ICA.ContCont'></span><span id='topic+plot.MICA.ContCont'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies, percentages, or cumulative percentages of the individual causal association (ICA; <code class="reqn">\rho_{\Delta}</code>) and/or the meta-analytic individual causal association (MICA; <code class="reqn">\rho_{M}</code>) values. These figures are useful to examine the sensitivity of the obtained results with respect to the assumptions regarding the correlations between the counterfactuals (for details, see Alonso et al., submitted; Van der Elst et al., submitted). Optionally, it is also possible to obtain plots that are useful in the examination of the plausibility of finding a good surrogate endpoint when an object of class <code>ICA.ContCont</code> is considered.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ICA.ContCont'
plot(x, Xlab.ICA, Main.ICA, Type="Percent", 
Labels=FALSE, ICA=TRUE, Good.Surr=FALSE, Main.Good.Surr, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), col, ...)

## S3 method for class 'MICA.ContCont'
plot(x, ICA=TRUE, MICA=TRUE, Type="Percent", 
Labels=FALSE, Xlab.ICA, Main.ICA, Xlab.MICA, Main.MICA,
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), col, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.ContCont</code> or <code>MICA.ContCont</code>. See <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code> or <code><a href="#topic+MICA.ContCont">MICA.ContCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_ica">ICA</code></td>
<td>
<p>Logical. When <code>ICA=TRUE</code>, a plot of the ICA is provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_mica">MICA</code></td>
<td>
<p>Logical. This argument only has effect when the <code>plot()</code> function is applied to an object of class <code>MICA.ContCont</code>. When <code>MICA=TRUE</code>, a plot of the MICA is provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type=Freq</code> or <code>Type=Percent</code>, the Y-axis shows frequencies or percentages of <code class="reqn">\rho_{\Delta}</code>, <code class="reqn">\rho_{M}</code>, and/or <code class="reqn">\delta</code>. When <code>Type=CumPerc</code>, the Y-axis shows cumulative percentages of <code class="reqn">\rho_{\Delta}</code>, <code class="reqn">\rho_{M}</code>, and/or <code class="reqn">\delta</code>.  Default &quot;Percent&quot;.</p>
</td></tr>  
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_labels">Labels</code></td>
<td>
<p>Logical. When <code>Labels=TRUE</code>, the percentage of <code class="reqn">\rho_{\Delta}</code>, <code class="reqn">\rho_{M}</code>, and/or <code class="reqn">\delta</code> values that are equal to or larger than the midpoint value of each of the bins are displayed (on top of each bin). Default <code>FALSE</code>.</p>
</td></tr>  
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_xlab.ica">Xlab.ICA</code></td>
<td>
<p>The legend of the X-axis of the ICA plot. Default &quot;<code class="reqn">\rho_{\Delta}</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_main.ica">Main.ICA</code></td>
<td>
<p>The title of the ICA plot. Default &quot;ICA&quot;.</p>
</td></tr>  
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_xlab.mica">Xlab.MICA</code></td>
<td>
<p>The legend of the X-axis of the MICA plot. Default &quot;<code class="reqn">\rho_{M}</code>&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_main.mica">Main.MICA</code></td>
<td>
<p>The title of the MICA plot. Default &quot;MICA&quot;.</p>
</td></tr>    
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_good.surr">Good.Surr</code></td>
<td>
<p>Logical. When <code>Good.Surr=TRUE</code>, a plot of <code class="reqn">\delta</code> is provided. This plot is useful in the context of examinating the plausibility of finding a good surrogate endpoint. Only applies when an object of class <code>ICA.ContCont</code> is considered. For details, see Alonso et al. (submitted). Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_main.good.surr">Main.Good.Surr</code></td>
<td>
<p>The title of the plot of <code class="reqn">\delta</code>. Only applies when an object of class <code>ICA.ContCont</code> is considered. For details, see Alonso et al. (submitted).</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_col">col</code></td>
<td>
<p>The color of the bins. Default <code>col &lt;- c(8)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Causal-Inference+2B20ContCont_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>
<p>Van der Elst, W., Alonso, A., &amp; Molenberghs, G. (submitted). An exploration of the relationship between causal inference and meta-analytic measures of surrogacy.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.ContCont">ICA.ContCont</a>, <a href="#topic+MICA.ContCont">MICA.ContCont</a>, <a href="#topic+plot+20MinSurrContCont">plot MinSurrContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot of ICA

# Generate the vector of ICA values when rho_T0S0=rho_T1S1=.95, and when the
# grid of values {0, .2, ..., 1} is considered for the correlations
# between the counterfactuals:
SurICA &lt;- ICA.ContCont(T0S0=.95, T1S1=.95, T0T1=seq(0, 1, by=.2), T0S1=seq(0, 1, by=.2), 
T1S0=seq(0, 1, by=.2), S0S1=seq(0, 1, by=.2))

# Plot the results:
plot(SurICA)

# Same plot but add the percentages of ICA values that are equal to or larger 
# than the midpoint values of the bins
plot(SurICA, Labels=TRUE)

# Plot of both ICA and MICA

# Generate the vector of ICA and MICA values when R_trial=.8, rho_T0S0=rho_T1S1=.8, 
# D.aa=5, D.bb=10, and when the grid of values {0, .2, ..., 1} is considered 
# for the correlations between the counterfactuals:
SurMICA &lt;- MICA.ContCont(Trial.R=.80, D.aa=5, D.bb=10, T0S0=.8, T1S1=.8, 
T0T1=seq(0, 1, by=.2), T0S1=seq(0, 1, by=.2), T1S0=seq(0, 1, by=.2), 
S0S1=seq(0, 1, by=.2))

# Plot the vector of generated ICA and MICA values
plot(SurMICA, ICA=TRUE, MICA=TRUE)
</code></pre>

<hr>
<h2 id='plot+20FixedDiscrDiscrIT'>Provides plots of trial-level surrogacy in the Information-Theoretic framework</h2><span id='topic+plot+20FixedDiscrDiscrIT'></span><span id='topic+plot.FixedDiscrDiscrIT'></span>

<h3>Description</h3>

<p>Produces plots that provide a graphical representation of trial level surrogacy <code class="reqn">R^2_{ht}</code> based on the Information-Theoretic approach of Alonso &amp; Molenberghs (2007).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'FixedDiscrDiscrIT'
plot(x, Weighted=TRUE, Xlab.Trial, Ylab.Trial, Main.Trial,
	 Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_x">x</code></td>
<td>
<p>An object of class <code>FixedDiscrDiscrIT</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. This argument only has effect when the user requests a trial-level surrogacy plot (i.e., when <code>Trial.Level=TRUE</code> in the function call). If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20FixedDiscrDiscrIT_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hannah M. Ensor &amp; Christopher J. Weir
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><a href="#topic+FixedDiscrDiscrIT">FixedDiscrDiscrIT</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
             Seed=123, Model="Full")
             
# create a binary true and ordinal surrogate outcome
Data.Observed.MTS$True&lt;-findInterval(Data.Observed.MTS$True, 
        c(quantile(Data.Observed.MTS$True,0.5)))
Data.Observed.MTS$Surr&lt;-findInterval(Data.Observed.MTS$Surr, 
        c(quantile(Data.Observed.MTS$Surr,0.333),quantile(Data.Observed.MTS$Surr,0.666)))

# Assess surrogacy based on a full fixed-effect model
# in the information-theoretic framework for a binary surrogate and ordinal true outcome:
SurEval &lt;- FixedDiscrDiscrIT(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat,
Trial.ID=Trial.ID, Setting="ordbin")

## Request trial-level surrogacy plot. In the trial-level plot,
## make the size of the circles proportional to the number of patients in a trial:
plot(SurEval, Weighted=FALSE)


## End(Not run)</code></pre>

<hr>
<h2 id='plot+20ICA.ContCont.MultS'>
Plots the Individual Causal Association in the setting where there are multiple continuous S and a continuous T</h2><span id='topic+plot.ICA.ContCont.MultS'></span><span id='topic+plot.ICA.ContCont.MultS_alt'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies, percentages, or cumulative percentages of the multivariate individual causal association (<code class="reqn">R^2_{H}</code>). These figures are useful to examine the sensitivity of the obtained results with respect to the assumptions regarding the correlations between the counterfactuals.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'ICA.ContCont.MultS'
plot(x, R2_H=FALSE, Corr.R2_H=TRUE, 
   Type="Percent", Labels=FALSE,  
   Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), col, 
   Prediction.Error.Reduction=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_x">x</code></td>
<td>
<p>An object of class <code>ICA.ContCont.MultS</code>. See <code><a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a></code> or <code><a href="#topic+ICA.ContCont.MultS_alt">ICA.ContCont.MultS_alt</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_r2_h">R2_H</code></td>
<td>
<p>Should a plot of the <code class="reqn">R^2_{H}</code> be provided? Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_corr.r2_h">Corr.R2_H</code></td>
<td>
<p>Should a plot of the corrected <code class="reqn">R^2_{H}</code> be provided? Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type=Freq</code> or <code>Type=Percent</code>, the Y-axis shows frequencies or percentages of <code class="reqn">R^2_{H}</code>. When <code>Type=CumPerc</code>, the Y-axis shows cumulative percentages of <code class="reqn">R^2_{H}</code>.  Default &quot;Percent&quot;.</p>
</td></tr>  
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_labels">Labels</code></td>
<td>
<p>Logical. When <code>Labels=TRUE</code>, the percentage of <code class="reqn">R^2_{H}</code> values that are equal to or larger than the midpoint value of each of the bins are displayed (on top of each bin). Default <code>FALSE</code>.</p>
</td></tr>  
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_col">col</code></td>
<td>
<p>The color of the bins. Default <code>col &lt;- c(8)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_prediction.error.reduction">Prediction.Error.Reduction</code></td>
<td>
<p>Should a plot be shown that shows the prediction error (reisdual error) in predicting <code class="reqn">Delta</code>T using an intercept only model, and that shows the prediction error (reisdual error) in predicting <code class="reqn">Delta</code>T using <code class="reqn">Delta S_1</code>, <code class="reqn">Delta S_2</code>, ...? Default <code>Prediction.Error.Reduction=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ICA.ContCont.MultS_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., &amp; Molenberghs, G. (2017). Univariate versus multivariate surrogate endpoints.
</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.ContCont">ICA.ContCont</a>, <a href="#topic+ICA.ContCont.MultS">ICA.ContCont.MultS</a>, <a href="#topic+ICA.ContCont.MultS_alt">ICA.ContCont.MultS_alt</a>, <a href="#topic+MICA.ContCont">MICA.ContCont</a>, <a href="#topic+plot+20MinSurrContCont">plot MinSurrContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Specify matrix Sigma (var-cavar matrix T_0, T_1, S1_0, S1_1, ...)
# here for 1 true endpoint and 3 surrogates

s&lt;-matrix(rep(NA, times=64),8)
s[1,1] &lt;- 450; s[2,2] &lt;- 413.5; s[3,3] &lt;- 174.2; s[4,4] &lt;- 157.5; 
s[5,5] &lt;- 244.0; s[6,6] &lt;- 229.99; s[7,7] &lt;- 294.2; s[8,8] &lt;- 302.5
s[3,1] &lt;- 160.8; s[5,1] &lt;- 208.5; s[7,1] &lt;- 268.4 
s[4,2] &lt;- 124.6; s[6,2] &lt;- 212.3; s[8,2] &lt;- 287.1
s[5,3] &lt;- 160.3; s[7,3] &lt;- 142.8 
s[6,4] &lt;- 134.3; s[8,4] &lt;- 130.4 
s[7,5] &lt;- 209.3; 
s[8,6] &lt;- 214.7 
s[upper.tri(s)] = t(s)[upper.tri(s)]

# Marix looks like:
#            T_0    T_1  S1_0  S1_1  S2_0   S2_1  S2_0  S2_1
#            [,1]  [,2]  [,3]  [,4]  [,5]   [,6]  [,7]  [,8]
# T_0  [1,] 450.0    NA 160.8    NA 208.5     NA 268.4    NA
# T_1  [2,]    NA 413.5    NA 124.6    NA 212.30    NA 287.1
# S1_0 [3,] 160.8    NA 174.2    NA 160.3     NA 142.8    NA
# S1_1 [4,]    NA 124.6    NA 157.5    NA 134.30    NA 130.4
# S2_0 [5,] 208.5    NA 160.3    NA 244.0     NA 209.3    NA
# S2_1 [6,]    NA 212.3    NA 134.3    NA 229.99    NA 214.7
# S3_0 [7,] 268.4    NA 142.8    NA 209.3     NA 294.2    NA
# S3_1 [8,]    NA 287.1    NA 130.4    NA 214.70    NA 302.5

# Conduct analysis
ICA &lt;- ICA.ContCont.MultS(M=100, N=200, Show.Progress = TRUE,
  Sigma=s, G = seq(from=-1, to=1, by = .00001), Seed=c(123), 
  Model = "Delta_T ~ Delta_S1 + Delta_S2 + Delta_S3")

# Explore results
summary(ICA)
plot(ICA)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20Information-Theoretic'>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework</h2><span id='topic+plot+20Information-Theoretic'></span><span id='topic+plot.FixedContContIT'></span><span id='topic+plot.MixedContContIT'></span>

<h3>Description</h3>

<p>Produces plots that provide a graphical representation of trial- and/or individual-level surrogacy (R2_ht and R2_h) based on the Information-Theoretic approach of Alonso &amp; Molenberghs (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FixedContContIT'
plot(x, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level=TRUE,
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv,
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'MixedContContIT'
plot(x, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level=TRUE,
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv,
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_x">x</code></td>
<td>
<p>An object of class <code>MixedContContIT</code> or <code>FixedContContIT</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_trial.level">Trial.Level</code></td>
<td>
<p>Logical. If <code>Trial.Level=TRUE</code>, a plot of the trial-specific treatment effects on the true endpoint against the trial-specific treatment effect on the surrogate endpoints is provided (as a graphical representation of <code class="reqn">R_{ht}</code>). Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. This argument only has effect when the user requests a trial-level surrogacy plot (i.e., when <code>Trial.Level=TRUE</code> in the function call). If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_indiv.level">Indiv.Level</code></td>
<td>
<p>Logical. If <code>Indiv.Level=TRUE</code>, a plot of the trial- and treatment-corrected residuals of the true and surrogate endpoints is provided. This plot provides a graphical representation of <code class="reqn">R_{h}</code>. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_xlab.indiv">Xlab.Indiv</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts individual-level surrogacy. Default &quot;Residuals for the surrogate endpoint (<code class="reqn">\varepsilon_{Sij}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_ylab.indiv">Ylab.Indiv</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts individual-level surrogacy. Default &quot;Residuals for the true endpoint (<code class="reqn">\varepsilon_{Tij}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_main.indiv">Main.Indiv</code></td>
<td>
<p>The title of the plot that depicts individual-level surrogacy. Default &quot;Individual-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><a href="#topic+MixedContContIT">MixedContContIT</a>, <a href="#topic+FixedContContIT">FixedContContIT</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Load ARMD dataset
data(ARMD)

## Conduct a surrogacy analysis, using a weighted reduced univariate fixed effect model:
Sur &lt;- MixedContContIT(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center,
Pat.ID=Id, Model=c("Full"))

## Request both trial- and individual-level surrogacy plots. In the trial-level plot,
## make the size of the circles proportional to the number of patients in a trial:
plot(Sur, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level=TRUE)

## Make a trial-level surrogacy plot using filled blue circles that
## are transparent (to make sure that the results of overlapping trials remain
## visible), and modify the title and the axes labels of the plot:
plot(Sur, pch=16, col=rgb(.3, .2, 1, 0.3), Indiv.Level=FALSE, Trial.Level=TRUE,
Weighted=TRUE, Main.Trial=c("Trial-level surrogacy (ARMD dataset)"),
Xlab.Trial=c("Difference in vision after 6 months (Surrogate)"),
Ylab.Trial=c("Difference in vision after 12 months (True enpoint)"))

## Add the estimated R2_ht value in the previous plot at position (X=-2.2, Y=0)
## (the previous plot should not have been closed):
R2ht &lt;- format(round(as.numeric(Sur$R2ht[1]), 3))
text(x=-2.2, y=0, cex=1.4, labels=(bquote(paste("R"[ht]^{2}, "="~.(R2ht)))))

## Make an Individual-level surrogacy plot with red squares to depict individuals
## (rather than black circles):
plot(Sur, pch=15, col="red", Indiv.Level=TRUE, Trial.Level=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20Information-Theoretic+20BinCombn'>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework when both S and T are binary, or when S is binary and T is continuous (or vice versa)</h2><span id='topic+plot+20Information-Theoretic+20BinCombn'></span><span id='topic+plot.FixedBinBinIT'></span><span id='topic+plot.FixedBinContIT'></span><span id='topic+plot.FixedContBinIT'></span>

<h3>Description</h3>

<p>Produces plots that provide a graphical representation of trial- and/or individual-level surrogacy (R2_ht and R2_hInd per cluster) based on the Information-Theoretic approach of Alonso &amp; Molenberghs (2007).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'FixedBinBinIT'
plot(x, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level.By.Trial=TRUE, 
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'FixedBinContIT'
plot(x, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level.By.Trial=TRUE, 
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'FixedContBinIT'
plot(x, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level.By.Trial=TRUE, 
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_x">x</code></td>
<td>
<p>An object of class <code>FixedBinBinIT</code>, <code>FixedBinContIT</code>, or <code>FixedContBinIT</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_trial.level">Trial.Level</code></td>
<td>
<p>Logical. If <code>Trial.Level=TRUE</code>, a plot of the trial-specific treatment effects on the true endpoint against the trial-specific treatment effect on the surrogate endpoints is provided (as a graphical representation of <code class="reqn">R_{ht}</code>). Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. This argument only has effect when the user requests a trial-level surrogacy plot (i.e., when <code>Trial.Level=TRUE</code> in the function call). If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_indiv.level.by.trial">Indiv.Level.By.Trial</code></td>
<td>
<p>Logical. If <code>Indiv.Level.By.Trial=TRUE</code>, a plot that shows the estimated <code class="reqn">R^2_{h.ind}</code> for each trial (and confidence intervals) is provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_xlab.indiv">Xlab.Indiv</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts the estimated <code class="reqn">R^2_{h.ind}</code> per trial. Default &quot;<code class="reqn">R[h.ind]^{2}</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_ylab.indiv">Ylab.Indiv</code></td>
<td>
<p>The legend of the Y-axis of the plot that shows the estimated <code class="reqn">R^2_{h.ind}</code> per trial. Default &quot;Trial&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_main.indiv">Main.Indiv</code></td>
<td>
<p>The title of the plot that depicts individual-level surrogacy. Default &quot;Individual-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Information-Theoretic+2B20BinCombn_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><a href="#topic+FixedBinBinIT">FixedBinBinIT</a>, <a href="#topic+FixedBinContIT">FixedBinContIT</a>, <a href="#topic+FixedContBinIT">FixedContBinIT</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Time consuming (&gt;5sec) code part
# Generate data with continuous Surr and True
Sim.Data.MTS(N.Total=5000, N.Trial=50, R.Trial.Target=.9, R.Indiv.Target=.9,
             Fixed.Effects=c(0, 0, 0, 0), D.aa=10, D.bb=10, Seed=1,
             Model=c("Full"))
# Dichtomize Surr and True
Surr_Bin &lt;- Data.Observed.MTS$Surr
Surr_Bin[Data.Observed.MTS$Surr&gt;.5] &lt;- 1
Surr_Bin[Data.Observed.MTS$Surr&lt;=.5] &lt;- 0
True_Bin &lt;- Data.Observed.MTS$True
True_Bin[Data.Observed.MTS$True&gt;.15] &lt;- 1
True_Bin[Data.Observed.MTS$True&lt;=.15] &lt;- 0
Data.Observed.MTS$Surr &lt;- Surr_Bin
Data.Observed.MTS$True &lt;- True_Bin

# Assess surrogacy using info-theoretic framework
Fit &lt;- FixedBinBinIT(Dataset = Data.Observed.MTS, Surr = Surr, 
True = True, Treat = Treat, Trial.ID = Trial.ID, 
Pat.ID = Pat.ID, Number.Bootstraps=100)

# Examine results
summary(Fit)
plot(Fit, Trial.Level = FALSE, Indiv.Level.By.Trial=TRUE)
plot(Fit, Trial.Level = TRUE, Indiv.Level.By.Trial=FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20ISTE.ContCont'>
Plots the individual-level surrogate threshold effect (STE) values and related metrics
</h2><span id='topic+plot+20ISTE.ContCont'></span><span id='topic+plot.ISTE.ContCont'></span>

<h3>Description</h3>

<p>This function plots the individual-level surrogate threshold effect (STE) values and related metrics, e.g., the expected <code class="reqn">\Delta T</code> values for a vector of <code class="reqn">\Delta S</code> values.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ISTE.ContCont'
plot(x, Outcome="ISTE", breaks=50, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20ISTE.ContCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>ISTE.ContCont</code>. See <code><a href="#topic+ISTE.ContCont">ISTE.ContCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20ISTE.ContCont_+3A_outcome">Outcome</code></td>
<td>
<p>The outcome for which a histogram has to be produced. When <code>Outcome="ISTE"</code>, 
a histogram of the ISTE is produced. When <code>Outcome="MSE"</code>, a histogram of the MSE values (of regression models in which <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S</code>) is given. When <code>Outcome="gamma0"</code>, a histogram of <code class="reqn">\gamma[0]</code> values (of regression models in which <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S</code>) is given. When <code>Outcome="gamma1"</code>, a histogram of <code class="reqn">\gamma[1]</code> values (of regression models in which <code class="reqn">\Delta T</code> is regressed on <code class="reqn">\Delta S</code>) is given. When <code>Outcome="Exp.DeltaT"</code>, a histogram of the expected <code class="reqn">\Delta T</code> values for a vector of <code class="reqn">\Delta S</code> values (specified in the call of the <code>ISTE.ContCont</code> function) values is given. When <code>Outcome="Exp.DeltaT.Low.PI"</code>, a histogram of the lower prediction intervals of the expected <code class="reqn">\Delta T</code> values for a vector of <code class="reqn">\Delta S</code> values (specified in the call of the <code>ISTE.ContCont</code> function) values is given. When <code>Outcome="Exp.DeltaT.Up.PI"</code>, a histogram of the upper prediction intervals of the expected <code class="reqn">\Delta T</code> values for a vector of <code class="reqn">\Delta S</code> values (specified in the call of the <code>ISTE.ContCont</code> function) values is given. Dafault <code>Outcome="ISTE"</code>. When <code>Outcome="Delta_S_For_Which_Delta_T_equal_0"</code>, a histogram of <code class="reqn">omega</code> is shown with <code class="reqn">E(Delta T | Delta S &gt; omega)&gt;0</code>. 
</p>
</td></tr>
<tr><td><code id="plot+2B20ISTE.ContCont_+3A_breaks">breaks</code></td>
<td>
<p>The number of breaks used in the histogram(s). Default <code>breaks=50</code>.</p>
</td></tr> 
<tr><td><code id="plot+2B20ISTE.ContCont_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Van der Elst, W., Alonso, A. A., and Molenberghs, G. (submitted). The individual-level surrogate threshold effect in a causal-inference setting.</p>


<h3>See Also</h3>

<p><a href="#topic+ISTE.ContCont">ISTE.ContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Define input for analysis using the Schizo dataset, 
# with S=BPRS and T = PANSS. 
# For each of the identifiable quantities,
# uncertainty is accounted for by specifying a uniform
# distribution with min, max values corresponding to
# the 95% confidence interval of the quantity.
T0S0 &lt;- runif(min = 0.9524, max = 0.9659, n = 1000)
T1S1 &lt;- runif(min = 0.9608, max = 0.9677, n = 1000)

S0S0 &lt;- runif(min=160.811, max=204.5009, n=1000)
S1S1 &lt;- runif(min=168.989, max = 194.219, n=1000)
T0T0 &lt;- runif(min=484.462, max = 616.082, n=1000)
T1T1 &lt;- runif(min=514.279, max = 591.062, n=1000)

Mean_T0 &lt;- runif(min=-13.455, max=-9.489, n=1000)
Mean_T1 &lt;- runif(min=-17.17, max=-14.86, n=1000)
Mean_S0 &lt;- runif(min=-7.789, max=-5.503, n=1000)
Mean_S1 &lt;- runif(min=-9.600, max=-8.276, n=1000)

# Do the ISTE analysis
## Not run: 
ISTE &lt;- ISTE.ContCont(Mean_T1=Mean_T1, Mean_T0=Mean_T0, 
 Mean_S1=Mean_S1, Mean_S0=Mean_S0, N=2128, Delta_S=c(-50:50), 
 alpha.PI=0.05, PI.Bound=0, Show.Prediction.Plots=TRUE,
 Save.Plots="No", T0S0=T0S0, T1S1=T1S1, T0T0=T0T0, T1T1=T1T1, 
 S0S0=S0S0, S1S1=S1S1)

# Examine results:
summary(ISTE)

# Plots of results. 
  # Plot main ISTE results
plot(ISTE)
  # Other plots
plot(ISTE, Outcome="MSE")
plot(ISTE, Outcome="gamma0")
plot(ISTE, Outcome="gamma1")
plot(ISTE, Outcome="Exp.DeltaT")
plot(ISTE, Outcome="Exp.DeltaT.Low.PI")
plot(ISTE, Outcome="Exp.DeltaT.Up.PI")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20MaxEnt+20ContCont'>
Plots the sensitivity-based and maximum entropy based Individual Causal Association when S and T are continuous outcomes in the single-trial setting
</h2><span id='topic+plot+20MaxEnt+20ContCont'></span><span id='topic+plot.MaxEntContCont'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies or densities of the individual causal association (ICA; <code class="reqn">rho[Delta]</code>) as identified based on the sensitivity- (using the functions <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>) and maximum entropy-based (using the function <code><a href="#topic+MaxEntContCont">MaxEntContCont</a></code>) approaches. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MaxEntContCont'
plot(x, Type="Freq", Xlab, col, 
Main, Entropy.By.ICA=FALSE, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>MaxEntContCont</code>. See <code><a href="#topic+MaxEntContCont">MaxEntContCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code>, the Y-axis shows frequencies of ICA.  When <code>Type="Density"</code>, the density is shown. Default <code>Type="Freq"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_xlab">Xlab</code></td>
<td>
<p>The legend of the X-axis of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_col">col</code></td>
<td>
<p>The color of the bins (frequeny plot) or line (density plot). Default <code>col &lt;- c(8)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_main">Main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_entropy.by.ica">Entropy.By.ICA</code></td>
<td>
<p>Plot with ICA on Y-axis and entropy on X-axis.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEnt+2B20ContCont_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to <code>plot()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, Paul Meyvisch, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Add
</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.ContCont">ICA.ContCont</a>, <a href="#topic+MaxEntContCont">MaxEntContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Compute ICA for ARMD dataset, using the grid  
# G={-1, -.80, ..., 1} for the undidentifiable correlations

ICA &lt;- ICA.ContCont(T0S0 = 0.769, T1S1 = 0.712, S0S0 = 188.926, 
S1S1 = 132.638, T0T0 = 264.797, T1T1 = 231.771, 
T0T1 = seq(-1, 1, by = 0.2), T0S1 = seq(-1, 1, by = 0.2), 
T1S0 = seq(-1, 1, by = 0.2), S0S1 = seq(-1, 1, by = 0.2))

# Identify the maximum entropy ICA
MaxEnt_ARMD &lt;- MaxEntContCont(x = ICA, S0S0 = 188.926, 
S1S1 = 132.638, T0T0 = 264.797, T1T1 = 231.771)

  # Explore results using summary() and plot() functions
summary(MaxEnt_ARMD)
plot(MaxEnt_ARMD)
plot(MaxEnt_ARMD, Entropy.By.ICA = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20MaxEntICA+20BinBin'>
Plots the sensitivity-based and maximum entropy based Individual Causal Association when S and T are binary outcomes
</h2><span id='topic+plot+20MaxEntICA+20BinBin'></span><span id='topic+plot.MaxEntICA.BinBin'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies or densities of the individual causal association (ICA; <code class="reqn">R^2_{H}</code>) as identified based on the sensitivity- (using the functions <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, or <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code>) and maximum entropy-based (using the function <code><a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></code>) approaches. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MaxEntICA.BinBin'
plot(x, ICA.Fit, 
Type="Density", Xlab, col, Main, ...)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>MaxEntICABinBin</code>. See <code><a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_ica.fit">ICA.Fit</code></td>
<td>
<p>An object of class <code>ICA.BinBin</code>. See <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code>, the Y-axis shows frequencies of <code class="reqn">R^2_{H}</code>.  When <code>Type="Density"</code>, the density is shown.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_xlab">Xlab</code></td>
<td>
<p>The legend of the X-axis of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_col">col</code></td>
<td>
<p>The color of the bins (frequeny plot) or line (density plot). Default <code>col &lt;- c(8)</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_main">Main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntICA+2B20BinBin_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to <code>plot()</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., &amp; Van der Elst, W. (2015). A maximum-entropy approach for the evluation of surrogate endpoints based on causal inference.</p>


<h3>See Also</h3>

<p><a href="#topic+ICA.BinBin">ICA.BinBin</a>, <a href="#topic+MaxEntICABinBin">MaxEntICABinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Sensitivity-based ICA results using ICA.BinBin.Grid.Sample
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1, 
Monotonicity=c("No"), M=5000)

# Maximum-entropy based ICA
MaxEnt &lt;- MaxEntICABinBin(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078)

# Plot results
plot(x=MaxEnt, ICA.Fit=ICA)
</code></pre>

<hr>
<h2 id='plot+20MaxEntSPF+20BinBin'>
Plots the sensitivity-based and maximum entropy based surrogate predictive function (SPF) when S and T are binary outcomes.
</h2><span id='topic+plot+20MaxEntSPF+20BinBin'></span><span id='topic+plot.MaxEntSPF.BinBin'></span>

<h3>Description</h3>

<p>Plots the sensitivity-based (Alonso et al., 2015a) and maximum entropy based (Alonso et al., 2015b) surrogate predictive function (SPF), i.e., <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code>, in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints. For example, <code class="reqn">r(-1,1)</code> quantifies the probability that the treatment has a negative effect on the true endpoint (<code class="reqn">\Delta T=-1</code>) given that it has a positive effect on the surrogate (<code class="reqn">\Delta S=1</code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MaxEntSPF.BinBin'
plot(x, SPF.Fit, Type="All.Histograms", Col="grey", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20MaxEntSPF+2B20BinBin_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>MaxEntSPF.BinBin</code>. See <code><a href="#topic+MaxEntSPFBinBin">MaxEntSPFBinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntSPF+2B20BinBin_+3A_spf.fit">SPF.Fit</code></td>
<td>
<p>A fitted object of class <code>SPF.BinBin</code>. See <code><a href="#topic+SPF.BinBin">SPF.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntSPF+2B20BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is requested. Possible choices are: <code>Type="All.Histograms"</code>, the histograms of all <code class="reqn">9</code> <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors arranged in a <code class="reqn">3</code> by <code class="reqn">3</code> grid; <code>Type="All.Densities"</code>, plots of densities of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors. Default <code>Type="All.Densities"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntSPF+2B20BinBin_+3A_col">Col</code></td>
<td>
<p>The color of the bins or lines when histograms or density plots are requested. Default <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MaxEntSPF+2B20BinBin_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015a). Assessing a surrogate effect predictive value in a causal inference framework.
</p>
<p>Alonso, A., &amp; Van der Elst, W. (2015b). A maximum-entropy approach for the evluation of surrogate endpoints based on causal inference.
</p>


<h3>See Also</h3>

<p><a href="#topic+SPF.BinBin">SPF.BinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Sensitivity-based ICA results using ICA.BinBin.Grid.Sample
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1, 
Monotonicity=c("No"), M=5000)

# Sensitivity-based SPF
SPFSens &lt;- SPF.BinBin(ICA)

# Maximum-entropy based SPF
SPFMaxEnt &lt;- MaxEntSPFBinBin(pi1_1_=0.341, pi0_1_=0.119, pi1_0_=0.254,
pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078)

# Plot results
plot(x=SPFMaxEnt, SPF.Fit=SPFSens)
</code></pre>

<hr>
<h2 id='plot+20Meta-Analytic'>Provides plots of trial- and individual-level surrogacy in the meta-analytic framework
</h2><span id='topic+plot+20Meta-Analytic'></span><span id='topic+plot.BifixedContCont'></span><span id='topic+plot.BimixedContCont'></span><span id='topic+plot.UnifixedContCont'></span><span id='topic+plot.UnimixedContCont'></span>

<h3>Description</h3>

<p>Produces plots that provide a graphical representation of trial- and/or individual-level surrogacy based on the meta-analytic approach of Buyse &amp; Molenberghs (2000) in the single- and multiple-trial settings.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BifixedContCont'
plot(x, Trial.Level=TRUE, Weighted=TRUE, 
Indiv.Level=TRUE, ICA=TRUE, Entropy.By.ICA=FALSE, Xlab.Indiv, Ylab.Indiv, 
Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'BimixedContCont'
plot(x, Trial.Level=TRUE, Weighted=TRUE, 
Indiv.Level=TRUE, ICA=TRUE, Entropy.By.ICA=FALSE, Xlab.Indiv, Ylab.Indiv, 
Xlab.Trial, Ylab.Trial, Main.Trial, Main.Indiv, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'UnifixedContCont'
plot(x, Trial.Level=TRUE, Weighted=TRUE, 
Indiv.Level=TRUE, ICA=TRUE, Entropy.By.ICA=FALSE, 
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, 
Main.Trial, Main.Indiv, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)

## S3 method for class 'UnimixedContCont'
plot(x, Trial.Level=TRUE, Weighted=TRUE, 
Indiv.Level=TRUE, ICA=TRUE, Entropy.By.ICA=FALSE, 
Xlab.Indiv, Ylab.Indiv, Xlab.Trial, Ylab.Trial, 
Main.Trial, Main.Indiv, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_x">x</code></td>
<td>
<p>An object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, <code>BimixedContCont</code>, or <code>Single.Trial.RE.AA</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_trial.level">Trial.Level</code></td>
<td>
<p>Logical. If <code>Trial.Level=TRUE</code> and an object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>,  or <code>BimixedContCont</code> is considered, a plot of the trial-specific treatment effects on the true endpoint against the trial-specific treatment effect on the surrogate endpoints is provided (as a graphical representation of <code class="reqn">R_{trial}</code>). If <code>Trial.Level=TRUE</code> and an object of class <code>Single.Trial.RE.AA</code> is considered, a plot of the treatment effect on the true endpoint against the treatment effect on the surrogate endpoint is provided, and a regression line that goes through the origin with slope RE is added to the plot (to depict the constant RE assumption, see <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code> for details).  If <code>Trial.Level=FALSE</code>, this plot is not provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. This argument only has effect when the user requests a trial-level surrogacy plot (i.e., when <code>Trial.Level=TRUE</code> in the function call) and when an object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, or <code>BimixedContCont</code> is considered (not when an object of class <code>Single.Trial.RE.AA</code> is considered). If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_indiv.level">Indiv.Level</code></td>
<td>
<p>Logical. If <code>Indiv.Level=TRUE</code>, a plot of the trial- and treatment-corrected residuals of the true and surrogate endpoints is provided (when an object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, or <code>BimixedContCont</code> is considered), or a plot of the treatment-corrected residuals (when an object of class <code>Single.Trial.RE.AA</code> is considered). This plot provides a graphical representation of <code class="reqn">R_{indiv}</code>. If <code>Indiv.Level=FALSE</code>, this plot is not provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_ica">ICA</code></td>
<td>
<p>Logical. Should a plot of the individual level causal association be shown? Default <code>ICA=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_entropy.by.ica">Entropy.By.ICA</code></td>
<td>
<p>Logical. Should a plot that shows ICA against the entropy be shown? Default <code>Entropy.By.ICA=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_xlab.indiv">Xlab.Indiv</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts individual-level surrogacy. Default &quot;Residuals for the surrogate endpoint (<code class="reqn">\varepsilon_{Sij}</code>)&quot; (without the <code class="reqn">i</code> subscript when an object of class <code>Single.Trial.RE.AA</code> is considered).</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_ylab.indiv">Ylab.Indiv</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts individual-level surrogacy. Default &quot;Residuals for the true endpoint (<code class="reqn">\varepsilon_{Tij}</code>)&quot; (without the <code class="reqn">i</code> subscript when an object of class <code>Single.Trial.RE.AA</code> is considered).</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot; (without the <code class="reqn">i</code> subscript when an object of class <code>Single.Trial.RE.AA</code> is considered).</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot; (without the <code class="reqn">i</code> subscript when an object of class <code>Single.Trial.RE.AA</code> is considered).</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_main.indiv">Main.Indiv</code></td>
<td>
<p>The title of the plot that depicts individual-level surrogacy. Default &quot;Individual-level surrogacy&quot; when an object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>, or <code>BimixedContCont</code> is considered, and &quot;Adjusted Association (<code class="reqn">rho_{Z}</code>) when an object of class <code>Single.Trial.RE.AA</code> is considered.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot; (when an object of class <code>UnifixedContCont</code>, <code>BifixedContCont</code>, <code>UnimixedContCont</code>,  or <code>BimixedContCont</code> is considered) or &quot;Relative Effect (RE)&quot; (when an object of class <code>Single.Trial.RE.AA</code> is considered).</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20Meta-Analytic_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>


<h3>See Also</h3>

<p><a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BifixedContCont">BifixedContCont</a>, <a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BimixedContCont">BimixedContCont</a>, <a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
##### Multiple-trial setting

## Load ARMD dataset
data(ARMD)

## Conduct a surrogacy analysis, using a weighted reduced univariate fixed effect model:
Sur &lt;- UnifixedContCont(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center, 
Pat.ID=Id, Number.Bootstraps=100, Model=c("Reduced"), Weighted=TRUE)

## Request both trial- and individual-level surrogacy plots. In the trial-level plot,
## make the size of the circles proportional to the number of patients in a trial:
plot(Sur, Trial.Level=TRUE, Weighted=TRUE, Indiv.Level=TRUE)

## Make a trial-level surrogacy plot using filled blue circles that 
## are transparent (to make sure that the results of overlapping trials remain
## visible), and modify the title and the axes labels of the plot: 
plot(Sur, pch=16, col=rgb(.3, .2, 1, 0.3), Indiv.Level=FALSE, Trial.Level=TRUE, 
Weighted=TRUE, Main.Trial=c("Trial-level surrogacy (ARMD dataset)"), 
Xlab.Trial=c("Difference in vision after 6 months (Surrogate)"),
Ylab.Trial=c("Difference in vision after 12 months (True enpoint)"))

## Add the estimated R2_trial value in the previous plot at position (X=-7, Y=11)  
## (the previous plot should not have been closed):
R2trial &lt;- format(round(as.numeric(Sur$Trial.R2[1]), 3))
text(x=-7, y=11, cex=1.4, labels=(bquote(paste("R"[trial]^{2}, "="~.(R2trial)))))

## Make an Individual-level surrogacy plot with red squares to depict individuals
## (rather than black circles):
plot(Sur, pch=15, col="red", Indiv.Level=TRUE, Trial.Level=FALSE)

## Same plot as before, but now with smaller squares, a y-axis with range [-40; 40], 
## and the estimated R2_indiv value in the title of the plot:
R2ind &lt;- format(round(as.numeric(Sur$Indiv.R2[1]), 3))
plot(Sur, pch=15, col="red", Indiv.Level=TRUE, Trial.Level=FALSE, cex=.5, 
ylim=c(-40, 40), Main.Indiv=bquote(paste("R"[indiv]^{2}, "="~.(R2ind))))


##### Single-trial setting

## Conduct a surrogacy analysis in the single-trial meta-analytic setting:
SurSTS &lt;- Single.Trial.RE.AA(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Pat.ID=Id)

# Request a plot of individual-level surrogacy and a plot that depicts the Relative effect 
# and the constant RE assumption:
plot(SurSTS, Trial.Level=TRUE, Indiv.Level=TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20MinSurrContCont'>
Graphically illustrates the theoretical plausibility of finding a good surrogate endpoint in the continuous-continuous case</h2><span id='topic+plot+20MinSurrContCont'></span><span id='topic+plot.MinSurrContCont'></span>

<h3>Description</h3>

<p>This function provides a plot that displays the frequencies, percentages, or cumulative percentages of <code class="reqn">\rho_{min}^{2}</code> for a fixed value of <code class="reqn">\delta</code> (given the observed variances of the true endpoint in the control and experimental treatment conditions and a specified grid of values for the unidentified parameter <code class="reqn">\rho_{T_{0}T_{1}}</code>; see <code><a href="#topic+MinSurrContCont">MinSurrContCont</a></code>). For details, see the online appendix of Alonso et al., submitted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'MinSurrContCont'
plot(x, main, col, Type="Percent", Labels=FALSE, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_x">x</code></td>
<td>
<p>An object of class <code>MinSurrContCont</code>. See <code><a href="#topic+MinSurrContCont">MinSurrContCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_main">main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_col">col</code></td>
<td>
<p>The color of the bins.</p>
</td></tr>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type=Freq</code> or <code>Type=Percent</code>, the Y-axis shows frequencies or percentages of <code class="reqn">\rho_{min}^{2}</code>. When <code>Type=CumPerc</code>, the Y-axis shows cumulative percentages of <code class="reqn">\rho_{min}^{2}</code>.  Default &quot;Percent&quot;.</p>
</td></tr>  
<tr><td><code id="plot+2B20MinSurrContCont_+3A_labels">Labels</code></td>
<td>
<p>Logical. When <code>Labels=TRUE</code>, the percentage of <code class="reqn">\rho_{min}^{2}</code> values that are equal to or larger than the midpoint value of each of the bins are displayed (on top of each bin). Only applies when <code>Type=Freq</code> or <code>Type=Percent</code>. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20MinSurrContCont_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>hist()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>


<h3>See Also</h3>

<p><a href="#topic+MinSurrContCont">MinSurrContCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># compute rho^2_min in the setting where the variances of T in the control
# and experimental treatments equal 100 and 120, delta is fixed at 50,
# and the grid G={0, .01, ..., 1} is considered for the counterfactual 
# correlation rho_T0T1:
MinSurr &lt;- MinSurrContCont(T0T0 = 100, T1T1 = 120, Delta = 50,
T0T1 = seq(0, 1, by = 0.01))

# Plot the results (use percentages on Y-axis)
plot(MinSurr, Type="Percent")

# Same plot, but add the percentages of ICA values that are equal to or 
# larger than the midpoint values of the bins
plot(MinSurr, Labels=TRUE)
</code></pre>

<hr>
<h2 id='plot+20PredTrialTContCont'>
Plots the expected treatment effect on the true endpoint in a new trial (when both S and T are normally distributed continuous endpoints)
</h2><span id='topic+plot+20PredTrialTContCont'></span><span id='topic+plot.PredTrialTContCont'></span>

<h3>Description</h3>

<p>The key motivation to evaluate a surrogate endpoint is to be able to predict the  treatment effect on the true endpoint <code class="reqn">T</code> based on the treatment effect on <code class="reqn">S</code> in a new trial <code class="reqn">i=0</code>. The function <code>Pred.TrialT.ContCont</code> allows for making such predictions. The present plot function shows the results graphically.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PredTrialTContCont'
plot(x, Size.New.Trial=5, CI.Segment=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20PredTrialTContCont_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>Pred.TrialT.ContCont</code>, for details see <code><a href="#topic+Pred.TrialT.ContCont">Pred.TrialT.ContCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PredTrialTContCont_+3A_size.new.trial">Size.New.Trial</code></td>
<td>
<p>The expected treatment effect on <code class="reqn">T</code> is drawn as a black circle with size specified by <code>Size.New.Trial</code>. Default <code>Size.New.Trial=5</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PredTrialTContCont_+3A_ci.segment">CI.Segment</code></td>
<td>
<p>The confidence interval around the expected treatment effect on <code class="reqn">T</code> is depicted by a dashed horizontal line. By default, the width of the horizontal line of the horizontal section of the confidence interval indicator is <code class="reqn">2</code> times the values specified by <code>CI.Segment</code>. Default <code class="reqn">CI.Segment=1</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20PredTrialTContCont_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>See Also</h3>

<p><a href="#topic+Pred.TrialT.ContCont">Pred.TrialT.ContCont</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
# Generate dataset
Sim.Data.MTS(N.Total=2000, N.Trial=15, R.Trial.Target=.95, 
R.Indiv.Target=.8, D.aa=10, D.bb=50, 
Fixed.Effects=c(1, 2, 30, 90), Seed=1)

# Evaluate surrogacy using a reduced bivariate mixed-effects model
BimixedFit &lt;- BimixedContCont(Dataset = Data.Observed.MTS, 
Surr = Surr, True = True, Treat = Treat, Trial.ID = Trial.ID, 
Pat.ID = Pat.ID, Model="Reduced")

# Suppose that in a new trial, it was estimated alpha_0 = 30
# predict beta_0 in this trial
Pred_Beta &lt;- Pred.TrialT.ContCont(Object = BimixedFit, 
alpha_0 = 30)

# Examine the results
summary(Pred_Beta)

# Plot the results
plot(Pred_Beta)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20SPF+20BinBin'>
Plots the surrogate predictive function (SPF) in the binary-binary settinf.
</h2><span id='topic+plot+20SPF+20BinBin'></span><span id='topic+plot.SPF.BinBin'></span>

<h3>Description</h3>

<p>Plots the surrogate predictive function (SPF), i.e., <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code>, in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints. For example, <code class="reqn">r(-1,1)</code> quantifies the probability that the treatment has a negative effect on the true endpoint (<code class="reqn">\Delta T=-1</code>) given that it has a positive effect on the surrogate (<code class="reqn">\Delta S=1</code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SPF.BinBin'
plot(x, Type="All.Histograms", Specific.Pi="r_0_0", Col="grey", 
Box.Plot.Outliers=FALSE, Legend.Pos="topleft", Legend.Cex=1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>SPF.BinBin</code>. See <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is requested. Possible choices are: <code>Type="All.Histograms"</code>, the histograms of all <code class="reqn">9</code>  <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors arranged in a <code class="reqn">3</code> by <code class="reqn">3</code> grid; <code>Type="All.Densities"</code>, plots of densities of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="Histogram"</code>, the histogram of a particular <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vector (the <code>Specific.Pi=</code> argument has to be used to specify the desired <code class="reqn">r(i,j)</code>); <code>Type="Density"</code>, the density of a particular <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vector (the <code>Specific.Pi=</code> argument has to be used to specify the desired <code class="reqn">r(i,j)</code>); <code>Type="Box.Plot"</code>, a box plot of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="Lines.Mean"</code>, a line plot the depicts the means of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="Lines.Median"</code>, a line plot the depicts the medians of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="Lines.Mode"</code>, a line plot the depicts the modes of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="3D.Mean"</code>, a 3D bar plot the depicts the means of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="3D.Median"</code>, a 3D bar plot the depicts the medians of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors; <code>Type="3D.Mode"</code>, a 3D bar plot the depicts the modes of all <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vectors.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_specific.pi">Specific.Pi</code></td>
<td>
<p>When <code>Type="Histogram"</code> or <code>Type="Density"</code> , the histogram/density of a particular <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> vector is shown. The <code>Specific.Pi=</code> argument is used to specify the desired <code class="reqn">r(i,j)</code>). Default <code>r_0_0</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_col">Col</code></td>
<td>
<p>The color of the bins or lines when histograms or density plots are requested. Default <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_box.plot.outliers">Box.Plot.Outliers</code></td>
<td>
<p>Logical. Should outliers be depicted in the box plots?. Default <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_legend.pos">Legend.Pos</code></td>
<td>
<p>Position of the legend when a <code>type="Box.Plot"</code>, <code>type="Lines.Mean"</code>, <code>type="Lines.Median"</code>, or <code>type="Lines.Mode"</code> is requested. Default <code>"topleft"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_legend.cex">Legend.Cex</code></td>
<td>
<p>Size of the legend when a <code>type="Box.Plot"</code>, <code>type="Lines.Mean"</code>, <code>type="Lines.Median"</code>, or <code>type="Lines.Mode"</code> is requested. Default <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinBin_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the plot, histogram, ... functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015). Assessing a surrogate effect predictive value in a causal inference framework.</p>


<h3>See Also</h3>

<p><a href="#topic+SPF.BinBin">SPF.BinBin</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Generate plausible values for Pi  
ICA &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119,
pi1_0_=0.254, pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1,
Monotonicity=c("General"), M=2500)
           
# Compute the surrogate predictive function (SPF)
SPF &lt;- SPF.BinBin(ICA)

# Explore the results
summary(SPF)

# Examples of plots 
plot(SPF, Type="All.Histograms")
plot(SPF, Type="All.Densities")
plot(SPF, Type="Histogram", Specific.Pi="r_0_0")
plot(SPF, Type="Box.Plot", Legend.Pos="topleft", Legend.Cex=.7)
plot(SPF, Type="Lines.Mean")
plot(SPF, Type="Lines.Median")
plot(SPF, Type="3D.Mean")
plot(SPF, Type="3D.Median")
plot(SPF, Type="3D.Spinning.Mean")
plot(SPF, Type="3D.Spinning.Median")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20SPF+20BinCont'>
Plots the surrogate predictive function (SPF) in the binary-continuous setting.
</h2><span id='topic+plot+20SPF+20BinCont'></span><span id='topic+plot.SPF.BinCont'></span>

<h3>Description</h3>

<p>Plots the surrogate predictive function (SPF) based on sensitivity-analyis, i.e., <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>, in the setting where <code class="reqn">S</code> is continuous and <code class="reqn">T</code> is a binary endpoint. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SPF.BinCont'
plot(x, Type="Frequency", Col="grey", Main, Xlab=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>SPF.BinCont</code>. See <code><a href="#topic+ICA.BinCont">ICA.BinCont</a></code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_type">Type</code></td>
<td>
<p>The type of plot that is requested. The argument <code>Type="Frequency"</code> requests histograms for <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>. The argument <code>Type="Percentage"</code> requests relative frequenties  for <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>. The argument <code>Type="Most.Likely.DeltaT"</code> requests a histogram of the most likely <code class="reqn">\Delta T</code> values. For example, when in one run of the sensitivity analysis, <code class="reqn">P(\Delta T =-1| \Delta S \in I[ab])=.6</code>, <code class="reqn">P(\Delta T =0| \Delta S \in I[ab])=.3</code>, and <code class="reqn">P(\Delta T =-1| \Delta S \in I[ab])=.1</code>, the most likely outcome in this run would be <code class="reqn">P(\Delta T =-1</code>. The argument <code>Type="Most.Likely.DeltaT"</code> generates a plot with percentages for the most likely <code class="reqn">P(\Delta T)</code> value across all obtained values in the sensitivity analysis.</p>
</td></tr> 
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_col">Col</code></td>
<td>
<p>The color of the bins or lines when histograms or density plots are requested. Default <code>"grey"</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_main">Main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_xlab">Xlab</code></td>
<td>
<p>Logical. Should labels on the X-axis be shown? Default <code>Xlab=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20SPF+2B20BinCont_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to the plot, histogram, ... functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst &amp; Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., &amp; Verbeke, G. (2017). Assessing the predictive value of a continuous surogate for a binary true endpoint based on causal inference.
</p>


<h3>See Also</h3>

<p><a href="#topic+SPF.BinCont">SPF.BinCont</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
data(Schizo_BinCont)
# Use ICA.BinCont to examine surrogacy
Result_BinCont &lt;- ICA.BinCont(M = 1000, Dataset = Schizo_BinCont,
Surr = PANSS, True = CGI_Bin, Treat=Treat, Diff.Sigma=TRUE)

# Obtain SPF
Fit &lt;- SPF.BinCont(x=Result_BinCont, a = -30, b = -3)

# examine results
summary(Fit1)
plot(Fit1)

plot(Fit1, Type="Most.Likely.DeltaT")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot+20TrialLevelIT'>Provides a plots of trial-level surrogacy in the information-theoretic framework based on the output of the <code>TrialLevelIT()</code> function
</h2><span id='topic+plot.TrialLevelIT'></span>

<h3>Description</h3>

<p>Produces a plot that provides a graphical representation of trial-level surrogacy based on the output of the <code>TrialLevelIT()</code> function (information-theoretic framework).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TrialLevelIT'
plot(x, Xlab.Trial, 
Ylab.Trial, Main.Trial, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_x">x</code></td>
<td>
<p>An object of class <code>TrialLevelIT</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelIT_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>


<h3>See Also</h3>

<p><a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BifixedContCont">BifixedContCont</a>, <a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BimixedContCont">BimixedContCont</a>, <a href="#topic+TrialLevelIT">TrialLevelIT</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate vector treatment effects on S
set.seed(seed = 1)
Alpha.Vector &lt;- seq(from = 5, to = 10, by=.1) + runif(min = -.5, max = .5, n = 51)

# Generate vector treatment effects on T
set.seed(seed=2)
Beta.Vector &lt;- (Alpha.Vector * 3) + runif(min = -5, max = 5, n = 51)

# Apply the function to estimate R^2_{h.t}
Fit &lt;- TrialLevelIT(Alpha.Vector=Alpha.Vector,
Beta.Vector=Beta.Vector, N.Trial=50, Model="Reduced")

# Plot the results
plot(Fit)
</code></pre>

<hr>
<h2 id='plot+20TrialLevelMA'>Provides a plots of trial-level surrogacy in the meta-analytic framework based on the output of the <code>TrialLevelMA()</code> function
</h2><span id='topic+plot.TrialLevelMA'></span>

<h3>Description</h3>

<p>Produces a plot that provides a graphical representation of trial-level surrogacy based on the output of the <code>TrialLevel()</code> function (meta-analytic framework).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TrialLevelMA'
plot(x, Weighted=TRUE, Xlab.Trial, 
Ylab.Trial, Main.Trial, Par=par(oma=c(0, 0, 0, 0), 
mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_x">x</code></td>
<td>
<p>An object of class <code>TrialLevelMA</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TrialLevelMA_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>


<h3>See Also</h3>

<p><a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BifixedContCont">BifixedContCont</a>, <a href="#topic+UnifixedContCont">UnifixedContCont</a>, <a href="#topic+BimixedContCont">BimixedContCont</a>, <a href="#topic+TrialLevelMA">TrialLevelMA</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate vector treatment effects on S
set.seed(seed = 1)
Alpha.Vector &lt;- seq(from = 5, to = 10, by=.1) + runif(min = -.5, max = .5, n = 51)
# Generate vector treatment effects on T
set.seed(seed=2)
Beta.Vector &lt;- (Alpha.Vector * 3) + runif(min = -5, max = 5, n = 51)
# Vector of sample sizes of the trials (here, all n_i=10)
N.Vector &lt;- rep(10, times=51)

# Apply the function to estimate R^2_{trial}
Fit &lt;- TrialLevelMA(Alpha.Vector=Alpha.Vector,
Beta.Vector=Beta.Vector, N.Vector=N.Vector)

# Plot the results and obtain summary
plot(Fit)
summary(Fit)
</code></pre>

<hr>
<h2 id='plot+20TwoStageSurvSurv'>Plots trial-level surrogacy in the meta-analytic framework when two survival endpoints are considered.
</h2><span id='topic+plot.TwoStageSurvSurv'></span>

<h3>Description</h3>

<p>Produces a plot that graphically depicts trial-level surrogacy when the surrogate and true endpoints are survival endpoints.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TwoStageSurvSurv'
plot(x, Weighted=TRUE, xlab, ylab, main,
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_x">x</code></td>
<td>
<p>An object of class <code>TwoStageContCont</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_xlab">xlab</code></td>
<td>
<p>The legend of the X-axis, default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_ylab">ylab</code></td>
<td>
<p>The legend of the Y-axis, default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_main">main</code></td>
<td>
<p>The title of the plot, default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot+2B20TwoStageSurvSurv_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>See Also</h3>

<p><a href="#topic+TwoStageSurvSurv">TwoStageSurvSurv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open Ovarian dataset
data(Ovarian)
# Conduct analysis
Results &lt;- TwoStageSurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd,
True = Surv, TrueCens = SurvInd, Treat = Treat, Trial.ID = Center)
# Examine results of analysis
summary(Results)
plot(Results)
</code></pre>

<hr>
<h2 id='plot.comb27.BinBin'>Plots the distribution of prediction error functions in decreasing order of appearance.</h2><span id='topic+plot.comb27.BinBin'></span>

<h3>Description</h3>

<p>The function <code>plot.comb27.BinBin</code> plots each of the selected prediction functions in decreasing order in the single-trial causal-inference framework when both the surrogate and the true endpoints are binary outcomes. The distribution of frequencies at which each of the 27 possible predicton functions are selected provides additional insights regarding the association between <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>)..  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'comb27.BinBin'
plot(x,lab,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.comb27.BinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>comb27.BinBin</code>. See <code><a href="#topic+comb27.BinBin">comb27.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot.comb27.BinBin_+3A_lab">lab</code></td>
<td>
<p>a supplementary label to the graph.</p>
</td></tr>
<tr><td><code id="plot.comb27.BinBin_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each of the 27 prediction functions is coded as x/y/z with x, y and z taking values in <code class="reqn">{-1,0,1}</code>. As an example, the combination 0/0/0 represents the prediction function that projects every value of <code class="reqn">\Delta_S</code> to 0. Similarly, the combination -1/0/1 is the identity function projecting every value of <code class="reqn">\Delta_S</code> to the same value for <code class="reqn">\Delta_T</code>.  
</p>


<h3>Value</h3>

<p>An object of class <code>comb27.BinBin</code> with components,
</p>
<table>
<tr><td><code>index</code></td>
<td>
<p>count variable</p>
</td></tr>
<tr><td><code>Monotonicity</code></td>
<td>
<p>The vector of Monotonicity assumptions</p>
</td></tr>
<tr><td><code>Pe</code></td>
<td>
<p>The vector of the prediction error values.</p>
</td></tr>
<tr><td><code>combo</code></td>
<td>
<p>The vector containing the codes for the each of the 27 prediction functions.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>H_Delta_S</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_S</code>.</p>
</td></tr>
<tr><td><code>I_Delta_T_Delta_S</code></td>
<td>
<p>The vector of the mutual information of <code class="reqn">\Delta_S</code> and <code class="reqn">\Delta_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso A,  Van der Elst W, Molenberghs G, Buyse M and Burzykowski T. (2016). An information-theoretic approach for the evaluation of surrogate endpoints based on causal inference. 
</p>
<p>Alonso A, Van der Elst W and Meyvisch P (2016). Assessing a surrogate predictive value: A causal inference approach. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+comb27.BinBin">comb27.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
CIGTS_27 &lt;- comb27.BinBin(pi1_1_ = 0.3412, pi1_0_ = 0.2539, pi0_1_ = 0.119, 
                       pi_1_1 = 0.6863, pi_1_0 = 0.0882, pi_0_1 = 0.0784,  
                       Seed=1,Monotonicity=c("No"), M=500000) 
plot.comb27.BinBin(CIGTS_27,lab="CIGTS")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.Fano.BinBin'>Plots the distribution of <code class="reqn">R^2_{HL}</code> either as a density or as function of <code class="reqn">\pi_{10}</code> in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+plot.Fano.BinBin'></span>

<h3>Description</h3>

<p>The function <code>plot.Fano.BinBin</code> plots the distribution of <code class="reqn">R^2_{HL}</code> which is fully identifiable for given values of <code class="reqn">\pi_{10}</code>.  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'Fano.BinBin'
plot(x,Type="Density",Xlab.R2_HL,main.R2_HL,
ylab="density",Par=par(mfrow=c(1,1),oma=c(0,0,0,0),mar=c(5.1,4.1,4.1,2.1)),
Cex.Legend=1,Cex.Position="top", lwd=3,linety=c(5,6,7),color=c(8,9,3),...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.Fano.BinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>Fano.BinBin</code>. See <code><a href="#topic+Fano.BinBin">Fano.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code>, a histogram of <code class="reqn">R^2_{HL}</code> is produced. When <code>Type="Density"</code>, the density of <code class="reqn">R^2_{HL}</code> is produced. When <code>Type="Scatter"</code>, a scatter plot of <code class="reqn">R^2_{HL}</code> is produced as a function of <code class="reqn">\pi_{10}</code>. Default <code>Type="Scatter"</code>.</p>
</td></tr> 
<tr><td><code id="plot.Fano.BinBin_+3A_xlab.r2_hl">Xlab.R2_HL</code></td>
<td>
<p>The label of the X-axis when density plots or histograms are produced.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_main.r2_hl">main.R2_HL</code></td>
<td>
<p>Title of the density plot or histogram.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_ylab">ylab</code></td>
<td>
<p>The label of the Y-axis when density plots or histograms are produced. Default <code>ylab="density"</code>. </p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(mfrow=c(1,1),oma=c(0,0,0,0),mar=c(5.1,4.1,4.1,2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_cex.legend">Cex.Legend</code></td>
<td>
<p>The size of the legend. Default <code>Cex.Legend=1</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_cex.position">Cex.Position</code></td>
<td>
<p>The position of the legend.  Default <code>Cex.Position="top"</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_lwd">lwd</code></td>
<td>
<p>The line width for the density plot . Default <code>lwd=3</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_linety">linety</code></td>
<td>
<p>The line types corresponding to each level of <code>fano_delta</code> . Default <code>linety=c(5,6,7)</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_color">color</code></td>
<td>
<p>The color corresponding to each level of <code>fano_delta</code> . Default <code>color=c(8,9,3)</code>.</p>
</td></tr>
<tr><td><code id="plot.Fano.BinBin_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Values for <code class="reqn">\pi_{10}</code> have to be uniformly sampled from the interval <code class="reqn">[0,\min(\pi_{1\cdot},\pi_{\cdot0})]</code>. Any sampled value for <code class="reqn">\pi_{10}</code> will fully determine the bivariate distribution of potential outcomes for the true endpoint.
</p>
<p>The vector <code class="reqn">\bold{\pi_{km}}</code> fully determines <code class="reqn">R^2_{HL}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>Fano.BinBin</code> with components,
</p>
<table>
<tr><td><code>R2_HL</code></td>
<td>
<p>The sampled values for <code class="reqn">R^2_{HL}</code>.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The sampled values for <code class="reqn">H{\Delta T}</code>.</p>
</td></tr>
<tr><td><code>minpi10</code></td>
<td>
<p>The minimum value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>maxpi10</code></td>
<td>
<p>The maximum value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>samplepi10</code></td>
<td>
<p>The sampled value for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>The specified vector of upper bounds for the prediction errors.</p>
</td></tr>
<tr><td><code>uncertainty</code></td>
<td>
<p>Indexes the sampling of <code class="reqn">pi1\_</code>.</p>
</td></tr>
<tr><td><code>pi_00</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{00}</code>.</p>
</td></tr>
<tr><td><code>pi_11</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{11}</code>.</p>
</td></tr>
<tr><td><code>pi_01</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{01}</code>.</p>
</td></tr>
<tr><td><code>pi_10</code></td>
<td>
<p>The sampled values for <code class="reqn">\pi_{10}</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Fano.BinBin">Fano.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Conduct the analysis assuming no montonicity
# for the true endpoint, using a range of
# upper bounds for prediction errors 
FANO&lt;-Fano.BinBin(pi1_ = 0.5951 ,  pi_1 = 0.7745, 
fano_delta=c(0.05, 0.1, 0.2), M=1000)

plot(FANO, Type="Scatter",color=c(3,4,5),Cex.Position="bottom")
</code></pre>

<hr>
<h2 id='plot.PPE.BinBin'>Plots the distribution of either <code class="reqn">PPE</code>, <code class="reqn">RPE</code> or <code class="reqn">R^2_{H}</code> either as a density or as a histogram in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+plot.PPE.BinBin'></span>

<h3>Description</h3>

<p>The function <code>plot.PPE.BinBin</code> plots the distribution of <code class="reqn">PPE</code>, <code class="reqn">RPE</code> or <code class="reqn">R^2_{H}</code> in the setting where both surrogate and true endpoints are binary in the single-trial causal-inference framework.  See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PPE.BinBin'
plot(x,Type="Density",Param="PPE",Xlab.PE,main.PE,
ylab="density",Cex.Legend=1,Cex.Position="bottomright", lwd=3,linety=1,color=1,
Breaks=0.05, xlimits=c(0,1), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.PPE.BinBin_+3A_x">x</code></td>
<td>
<p>An object of class <code>PPE.BinBin</code>. See <code><a href="#topic+PPE.BinBin">PPE.BinBin</a></code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_type">Type</code></td>
<td>
<p>The type of plot that is produced. When <code>Type="Freq"</code>, a histogram is produced. When <code>Type="Density"</code>, a density is produced.  Default <code>Type="Density"</code>.</p>
</td></tr> 
<tr><td><code id="plot.PPE.BinBin_+3A_param">Param</code></td>
<td>
<p>Parameter to be plotted: is either &quot;PPE&quot;, &quot;RPE&quot; or &quot;ICA&quot;</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_xlab.pe">Xlab.PE</code></td>
<td>
<p>The label of the X-axis when density plots or histograms are produced.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_main.pe">main.PE</code></td>
<td>
<p>Title of the density plot or histogram.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_ylab">ylab</code></td>
<td>
<p>The label of the Y-axis for the density plots. Default <code>ylab="density"</code>. </p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_cex.legend">Cex.Legend</code></td>
<td>
<p>The size of the legend. Default <code>Cex.Legend=1</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_cex.position">Cex.Position</code></td>
<td>
<p>The position of the legend.  Default <code>Cex.Position="bottomright"</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_lwd">lwd</code></td>
<td>
<p>The line width for the density plot. Default <code>lwd=3</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_linety">linety</code></td>
<td>
<p>The line types for the density. Default <code>linety=1</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_color">color</code></td>
<td>
<p>The color of the density or histogram. Default <code>color=1</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_breaks">Breaks</code></td>
<td>
<p>The breaks for the histogram. Default <code>Breaks=0.05</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_xlimits">xlimits</code></td>
<td>
<p>The limits for the X-axis. Default <code>xlimits=c(0,1)</code>.</p>
</td></tr>
<tr><td><code id="plot.PPE.BinBin_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2016) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles. 
</p>
<p>The function <code>PPE.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed that are allowed to vary freely are considered. It additionally computes the minimal probability of a prediction error (PPE) and the reduction on the PPE using information that <code class="reqn">S</code> conveys on <code class="reqn">T</code>. Both measures provide complementary information over the <code class="reqn">R_{H}^{2}</code> and facilitate more straightforward clinical interpretation. 
</p>


<h3>Value</h3>

<p>An object of class <code>PPE.BinBin</code> with components,
</p>
<table>
<tr><td><code>index</code></td>
<td>
<p>count variable</p>
</td></tr>
<tr><td><code>PPE</code></td>
<td>
<p>The vector of the PPE values.</p>
</td></tr>
<tr><td><code>RPE</code></td>
<td>
<p>The vector of the RPE values.</p>
</td></tr>
<tr><td><code>PPE_T</code></td>
<td>
<p>The vector of the <code class="reqn">PPE_T</code> values indicating the probability on a prediction error without using information on <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>H_Delta_S</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_S</code>.</p>
</td></tr>
<tr><td><code>I_Delta_T_Delta_S</code></td>
<td>
<p>The vector of the mutual information of <code class="reqn">\Delta_S</code> and <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>Pi.Vectors</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the valid <code class="reqn">\pi</code> vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso, Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso A,  Van der Elst W, Molenberghs G, Buyse M and Burzykowski T. (2016). An information-theoretic approach for the evaluation of surrogate endpoints based on causal inference. 
</p>
<p>Meyvisch P., Alonso A.,Van der Elst W, Molenberghs G. (2018). Assessing the predictive value of a binary surrogate for a binary true endpoint, based on the minimum probability of a prediction error.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PPE.BinBin">PPE.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: # Time consuming part
PANSS &lt;- PPE.BinBin(pi1_1_=0.4215, pi0_1_=0.0538, pi1_0_=0.0538,
                   pi_1_1=0.5088, pi_1_0=0.0307,pi_0_1=0.0482, 
                   Seed=1, M=2500) 
                   
plot(PANSS,Type="Freq",Param="RPE",color="grey",Breaks=0.05,xlimits=c(0,1),main="PANSS")

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.survbin'>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survbin()' function.</h2><span id='topic+plot.survbin'></span>

<h3>Description</h3>

<p>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survbin()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survbin'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.survbin_+3A_x">x</code></td>
<td>
<p>An object of class 'survbin' fitted with the 'survbin()' function.</p>
</td></tr>
<tr><td><code id="plot.survbin_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the type ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal")
fit_bin &lt;- survbin(data = colorectal, true = surv, trueind = SURVIND, surrog = responder,
                   trt = TREAT, center = CENTER, trial = TRIAL, patientid = patientid)
plot(fit_bin)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.survcat'>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survcat()' function.</h2><span id='topic+plot.survcat'></span>

<h3>Description</h3>

<p>Generates a plot of the estimated treatment effects for the surrogate endpoint versus the estimated treatment effects for the true endpoint for an object fitted with the 'survcat()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survcat'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.survcat_+3A_x">x</code></td>
<td>
<p>An object of class 'survcat' fitted with the 'survcat()' function.</p>
</td></tr>
<tr><td><code id="plot.survcat_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the type ggplot
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal4")
fit &lt;- survcat(data = colorectal4, true = truend, trueind = trueind, surrog = surrogend,
               trt = treatn, center = center, trial = trialend, patientid = patid)
plot(fit)

## End(Not run)

</code></pre>

<hr>
<h2 id='plot.SurvSurv'>Provides plots of trial- and individual-level surrogacy in the Information-Theoretic framework when both S and T are time-to-event endpoints</h2><span id='topic+plot.SurvSurv'></span>

<h3>Description</h3>

<p>Produces plots that provide a graphical representation of trial- and/or individual-level surrogacy (R2_ht and R2_hInd per cluster) based on the Information-Theoretic approach of Alonso &amp; Molenberghs (2007).   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'SurvSurv'
plot(x, Trial.Level=TRUE, Weighted=TRUE, 
Indiv.Level.By.Trial=TRUE, Xlab.Indiv, Ylab.Indiv, Xlab.Trial, 
Ylab.Trial, Main.Trial, Main.Indiv, 
Par=par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1)), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.SurvSurv_+3A_x">x</code></td>
<td>
<p>An object of class <code>FixedBinBinIT</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_trial.level">Trial.Level</code></td>
<td>
<p>Logical. If <code>Trial.Level=TRUE</code>, a plot of the trial-specific treatment effects on the true endpoint against the trial-specific treatment effect on the surrogate endpoints is provided (as a graphical representation of <code class="reqn">R_{ht}</code>). Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. This argument only has effect when the user requests a trial-level surrogacy plot (i.e., when <code>Trial.Level=TRUE</code> in the function call). If <code>Weighted=TRUE</code>, the circles that depict the trial-specific treatment effects on the true endpoint against the surrogate endpoint are proportional to the number of patients in the trial. If <code>Weighted=FALSE</code>, all circles have the same size. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_indiv.level.by.trial">Indiv.Level.By.Trial</code></td>
<td>
<p>Logical. If <code>Indiv.Level.By.Trial=TRUE</code>, a plot that shows the estimated <code class="reqn">R^2_{h.ind}</code> for each trial (and confidence intervals) is provided. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_xlab.indiv">Xlab.Indiv</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts the estimated <code class="reqn">R^2_{h.ind}</code> per trial. Default &quot;<code class="reqn">R[h.ind]^{2}</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_ylab.indiv">Ylab.Indiv</code></td>
<td>
<p>The legend of the Y-axis of the plot that shows the estimated <code class="reqn">R^2_{h.ind}</code> per trial. Default &quot;Trial&quot;.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_xlab.trial">Xlab.Trial</code></td>
<td>
<p>The legend of the X-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the surrogate endpoint (<code class="reqn">\alpha_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_ylab.trial">Ylab.Trial</code></td>
<td>
<p>The legend of the Y-axis of the plot that depicts trial-level surrogacy. Default &quot;Treatment effect on the true endpoint (<code class="reqn">\beta_{i}</code>)&quot;.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_main.indiv">Main.Indiv</code></td>
<td>
<p>The title of the plot that depicts individual-level surrogacy. Default &quot;Individual-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_main.trial">Main.Trial</code></td>
<td>
<p>The title of the plot that depicts trial-level surrogacy. Default &quot;Trial-level surrogacy&quot;.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_par">Par</code></td>
<td>
<p>Graphical parameters for the plot. Default <code>par(oma=c(0, 0, 0, 0), mar=c(5.1, 4.1, 4.1, 2.1))</code>.</p>
</td></tr>
<tr><td><code id="plot.SurvSurv_+3A_...">...</code></td>
<td>
<p>Extra graphical parameters to be passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A, &amp; Molenberghs, G. (2007). Surrogate marker evaluation from an information theory perspective. <em>Biometrics, 63,</em> 180-186.
</p>


<h3>See Also</h3>

<p><a href="#topic+SurvSurv">SurvSurv</a></p>


<h3>Examples</h3>

<pre><code class='language-R'># Open Ovarian dataset
data(Ovarian)

# Conduct analysis
Fit &lt;- SurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd,
True = Surv, TrueCens = SurvInd, Treat = Treat, 
Trial.ID = Center, Alpha=.05)

# Examine results 
summary(Fit)
plot(Fit, Trial.Level = FALSE, Indiv.Level.By.Trial=TRUE)
plot(Fit, Trial.Level = TRUE, Indiv.Level.By.Trial=FALSE)
</code></pre>

<hr>
<h2 id='Pos.Def.Matrices'>Generate 4 by 4 correlation matrices and flag the positive definite ones</h2><span id='topic+Pos.Def.Matrices'></span>

<h3>Description</h3>

<p>Based on vectors (or scalars) for the six off-diagonal correlations of a <code class="reqn">4</code> by <code class="reqn">4</code> matrix, the function <code>Pos.Def.Matrices</code> constructs all possible matrices that can be formed by combining the specified values, computes the minimum eigenvalues for each of these matrices, and flags the positive definite ones (i.e., valid correlation matrices). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pos.Def.Matrices(T0T1=seq(0, 1, by=.2), T0S0=seq(0, 1, by=.2), T0S1=seq(0, 1, 
by=.2), T1S0=seq(0, 1, by=.2), T1S1=seq(0, 1, by=.2), S0S1=seq(0, 1, by=.2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pos.Def.Matrices_+3A_t0t1">T0T1</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between T0 and T1 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>, i.e., the values <code class="reqn">0</code>, <code class="reqn">0.20</code>, ..., <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="Pos.Def.Matrices_+3A_t0s0">T0S0</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between T0 and S0 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="Pos.Def.Matrices_+3A_t0s1">T0S1</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between T0 and S1 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="Pos.Def.Matrices_+3A_t1s0">T1S0</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between T1 and S0 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="Pos.Def.Matrices_+3A_t1s1">T1S1</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between T1 and S1 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="Pos.Def.Matrices_+3A_s0s1">S0S1</code></td>
<td>
<p>A vector or scalar that specifies the correlation(s) between S0 and S1 that should be considered to construct all possible <code class="reqn">4</code> by <code class="reqn">4</code> matrices. Default <code>seq(0, 1, by=.2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated object <code>Generated.Matrices</code> (of class <code>data.frame</code>) is placed in the workspace (for easy access).</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.Data.Counterfactuals">Sim.Data.Counterfactuals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate all 4x4 matrices that can be formed using rho(T0,S0)=rho(T1,S1)=.5
## and the grid of values 0, .2, ..., 1 for the other off-diagonal correlations: 
Pos.Def.Matrices(T0T1=seq(0, 1, by=.2), T0S0=.5, T0S1=seq(0, 1, by=.2), 
T1S0=seq(0, 1, by=.2), T1S1=.5, S0S1=seq(0, 1, by=.2))

## Examine the first 10 rows of the the object Generated.Matrices:
Generated.Matrices[1:10,]

## Check how many of the generated matrices are positive definite
## (counts and percentages):
table(Generated.Matrices$Pos.Def.Status)
table(Generated.Matrices$Pos.Def.Status)/nrow(Generated.Matrices)

## Make an object PosDef which contains the positive definite matrices:
PosDef &lt;- Generated.Matrices[Generated.Matrices$Pos.Def.Status==1,]

## Shows the 10 first matrices that are positive definite:
PosDef[1:10,]
</code></pre>

<hr>
<h2 id='PPE.BinBin'>Evaluate a surrogate predictive value based on the minimum probability of a prediction error in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+PPE.BinBin'></span>

<h3>Description</h3>

<p>The function <code>PPE.BinBin</code> assesses a surrogate predictive value using the probability of a prediction error in the single-trial causal-inference framework when both the surrogate and the true endpoints are binary outcomes. It additionally assesses the indivdiual causal association (ICA). See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PPE.BinBin(pi1_1_, pi1_0_, pi_1_1, pi_1_0, 
pi0_1_, pi_0_1, M=10000, Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PPE.BinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the probability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains values for <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_m">M</code></td>
<td>
<p>The number of valid vectors that have to be obtained. Default <code>M=10000</code>. </p>
</td></tr>
<tr><td><code id="PPE.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used to generate <code class="reqn">\pi_r</code>. Default <code>Seed=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2016) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles. 
</p>
<p>The function <code>PPE.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed to vary freely are considered. It additionally computes the minimal probability of a prediction error (PPE) and the reduction on the PPE using information that <code class="reqn">S</code> conveys on <code class="reqn">T</code>. Both measures provide complementary information over the <code class="reqn">R_{H}^{2}</code> and facilitate more straightforward clinical interpretation. No assumption about monotonicity can be made. 
</p>


<h3>Value</h3>

<p>An object of class <code>PPE.BinBin</code> with components,
</p>
<table>
<tr><td><code>index</code></td>
<td>
<p>count variable</p>
</td></tr>
<tr><td><code>PPE</code></td>
<td>
<p>The vector of the PPE values.</p>
</td></tr>
<tr><td><code>RPE</code></td>
<td>
<p>The vector of the RPE values.</p>
</td></tr>
<tr><td><code>PPE_T</code></td>
<td>
<p>The vector of the <code class="reqn">PPE_T</code> values indicating the probability on a prediction error without using information on <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
<tr><td><code>H_Delta_T</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_T</code>.</p>
</td></tr>
<tr><td><code>H_Delta_S</code></td>
<td>
<p>The vector of the entropies of <code class="reqn">\Delta_S</code>.</p>
</td></tr>
<tr><td><code>I_Delta_T_Delta_S</code></td>
<td>
<p>The vector of the mutual information of <code class="reqn">\Delta_S</code> and <code class="reqn">\Delta_T</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso, Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso A,  Van der Elst W, Molenberghs G, Buyse M and Burzykowski T. (2016). An information-theoretic approach for the evaluation of surrogate endpoints based on causal inference. 
</p>
<p>Meyvisch P., Alonso A.,Van der Elst W, Molenberghs G. (2018). Assessing the predictive value of a binary surrogate for a binary true endpoint, based on the minimum probability of a prediction error.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Conduct the analysis 
 
## Not run:  # time consuming code part
PPE.BinBin(pi1_1_=0.4215, pi0_1_=0.0538, pi1_0_=0.0538,
           pi_1_1=0.5088, pi_1_0=0.0307,pi_0_1=0.0482, 
           Seed=1, M=10000) 

## End(Not run)

</code></pre>

<hr>
<h2 id='Pred.TrialT.ContCont'>
Compute the expected treatment effect on the true endpoint in a new trial (when both S and T are normally distributed continuous endpoints)
</h2><span id='topic+Pred.TrialT.ContCont'></span>

<h3>Description</h3>

<p>The key motivation to evaluate a surrogate endpoint is to be able to predict the  treatment effect on the true endpoint <code class="reqn">T</code> based on the treatment effect on <code class="reqn">S</code> in a new trial <code class="reqn">i=0</code>. The function <code>Pred.TrialT.ContCont</code> allows for making such predictions based on fitted models of class <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code> and <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pred.TrialT.ContCont(Object, mu_S0, alpha_0, alpha.CI=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pred.TrialT.ContCont_+3A_object">Object</code></td>
<td>
<p>A fitted object of class <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code> and <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>. Some of the components in these fitted objects are needed to estimate <code class="reqn">E(\beta + b_0)</code> and its variance.</p>
</td></tr>
<tr><td><code id="Pred.TrialT.ContCont_+3A_mu_s0">mu_S0</code></td>
<td>
<p>The intercept of a regression model in the new trial <code class="reqn">i=0</code> where the surrogate endpoint is regressed on the true endpoint, i.e., <code class="reqn">S_{0j}=\mu_{S0} + \alpha_0 Z_{0j} + \varepsilon_{S0j}</code>, where <code class="reqn">S</code> is the surrogate endpoint, <code class="reqn">j</code> is the patient indicator, and <code class="reqn">Z</code> is the treatment. This argument only needs to be specified when a full model was used to examine surroacy.</p>
</td></tr>
<tr><td><code id="Pred.TrialT.ContCont_+3A_alpha_0">alpha_0</code></td>
<td>
<p>The regression weight of the treatment in the regression model specified under argument <code>mu_S0</code>.</p>
</td></tr>
<tr><td><code id="Pred.TrialT.ContCont_+3A_alpha.ci">alpha.CI</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level to be used to determine the confidence interval around <code class="reqn">E(\beta + b_0)</code>. Default <code>alpha.CI=0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The key motivation to evaluate a surrogate endpoint is to be able to predict the  treatment effect on the true endpoint <code class="reqn">T</code> based on the treatment effect on <code class="reqn">S</code> in a new trial <code class="reqn">i=0</code>.
</p>
<p>When a so-called full (fixed or mixed) bi- or univariate model was fitted in the surrogate evaluation phase (for details, see <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code> and <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>), this prediction is made as:
</p>
<p style="text-align: center;"><code class="reqn">E(\beta + b_0 | m_{S0}, a_0) = \beta + \left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)^T \left(\begin{array}{cc}
d_{SS} &amp; D_{Sa}\\
d_{Sa} &amp; d_{aa}
\end{array}\right)^{-1} \left(\begin{array}{c}
\mu_{S0} - \mu_S\\
\alpha_0 - \alpha
\end{array}\right) </code>
</p>

<p style="text-align: center;"><code class="reqn">Var(\beta + b_0 | m_{S0}, a_0) = d_{bb} + \left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right)^T \left(\begin{array}{cc}
d_{SS} &amp; D_{Sa}\\
d_{Sa} &amp; d_{aa}
\end{array}\right)^{-1} \left(\begin{array}{c}
d_{Sb}\\
d_{ab}
\end{array}\right),</code>
</p>

<p>where all components are defined as in <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>. When the univariate mixed-effects models are used or the (univariate or bivariate) fixed effects models, the fitted components contained in <code>D.Equiv</code> are used instead of those in <code>D</code>.
</p>
<p>When a reduced-model approach was used in the surrogate evaluation phase, the prediction is made as:
</p>
<p style="text-align: center;"><code class="reqn">E(\beta + b_0 | a_0) = \beta + \frac{d_{ab}}{d_{aa}} + (\alpha_0 - \alpha),</code>
</p>

<p style="text-align: center;"><code class="reqn">Var(\beta + b_0 | a_0) = d_{bb} - \frac{d_{ab}^2}{d_{aa}},</code>
</p>

<p>where all components are defined as in <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>. When the univariate mixed-effects models are used or the (univariate or bivariate) fixed effects models, the fitted components contained in <code>D.Equiv</code> are used instead of those in <code>D</code>.
</p>
<p>A <code class="reqn">(1-\gamma)100\%</code> prediction interval for <code class="reqn">E(\beta + b_0 | m_{S0}, a_0)</code> can be obtained as <code class="reqn">E(\beta + b_0 | m_{S0}, a_0) \pm z_{1-\gamma/2}  \sqrt{Var(\beta + b_0 | m_{S0}, a_0)}</code> (and similarly for <code class="reqn">E(\beta + b_0 | a_0)</code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>Beta_0</code></td>
<td>
<p>The predicted <code class="reqn">\beta_0</code>.</p>
</td></tr>
<tr><td><code>Variance</code></td>
<td>
<p>The variance of the prediction.</p>
</td></tr>
<tr><td><code>Lower</code></td>
<td>
<p>The lower bound of the confidence interval around the expected <code class="reqn">\beta_0</code>, see Details above.</p>
</td></tr>
<tr><td><code>Upper</code></td>
<td>
<p>The upper bound of the confidence interval around the expected <code class="reqn">\beta_0</code>.</p>
</td></tr>
<tr><td><code>alpha.CI</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level used to establish the confidence interval.</p>
</td></tr>
<tr><td><code>Surr.Model</code></td>
<td>
<p>The model that was used to compute <code class="reqn">\beta_0</code>.</p>
</td></tr>
<tr><td><code>alpha_0</code></td>
<td>
<p>The slope of the regression model specified in the <code>Arguments</code> section.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #time-consuming code parts
# Generate dataset
Sim.Data.MTS(N.Total=2000, N.Trial=15, R.Trial.Target=.8, 
R.Indiv.Target=.8, D.aa=10, D.bb=50, Fixed.Effects=c(1, 2, 30, 90), 
Seed=1)

# Evaluate surrogacy using a reduced bivariate mixed-effects model
BimixedFit &lt;- BimixedContCont(Dataset = Data.Observed.MTS, Surr = Surr, 
True = True, Treat = Treat, Trial.ID = Trial.ID, Pat.ID = Pat.ID, 
Model="Reduced")

# Suppose that in a new trial, it was estimated alpha_0 = 30
# predict beta_0 in this trial
Pred_Beta &lt;- Pred.TrialT.ContCont(Object = BimixedFit, 
alpha_0 = 30)

# Examine the results
summary(Pred_Beta)

# Plot the results
plot(Pred_Beta)

## End(Not run)
</code></pre>

<hr>
<h2 id='Prentice'>Evaluates surrogacy based on the Prentice criteria for continuous endpoints (single-trial setting)</h2><span id='topic+Prentice'></span>

<h3>Description</h3>

<p>The function <code>Prentice</code> evaluates the validity of a potential surrogate based on the Prentice criteria (Prentice, 1989) in the setting where the candidate surrogate and the true endpoint are normally distributed endpoints.
</p>
<p><b>Warning</b> The Prentice approach is included in the <em>Surrogate</em> package for illustrative purposes (as it was the first formal approach to assess surrogacy), but this method has some severe problems that renders its use problematic (see <b>Details</b> below). It is recommended to replace the Prentice approach by a more statistically-sound approach to evaluate a surrogate (e.g., the meta-analytic methods; see the functions <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Prentice(Dataset, Surr, True, Treat, Pat.ID, Alpha=.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Prentice_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="Prentice_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate values.</p>
</td></tr>
<tr><td><code id="Prentice_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="Prentice_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td></tr>
<tr><td><code id="Prentice_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="Prentice_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to examine whether the Prentice criteria are fulfilled. Default <code class="reqn">0.05</code>.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The Prentice criteria are examined by fitting the following regression models (when the surrogate and true endpoints are continuous variables):
</p>
<p style="text-align: center;"><code class="reqn">S_{j}=\mu_{S}+\alpha Z_{j}+\varepsilon_{Sj}, (1)</code>
</p>
 
<p style="text-align: center;"><code class="reqn">T_{j}=\mu_{T}+\beta Z_{j}+\varepsilon_{Tj}, (2)</code>
</p>
 
<p style="text-align: center;"><code class="reqn">T_{j}=\mu+\gamma Z_{j}+\varepsilon_{j}, (3)</code>
</p>
 
<p style="text-align: center;"><code class="reqn">T_{j}=\tilde{\mu}_{T}+\beta_{S} Z_{j}+\gamma_{Z} S_{j}+\tilde{\varepsilon}_{Tj}, (4)</code>
</p>
 
<p>where the error terms of (1) and (2) have a joint zero-mean normal distribution with variance-covariance matrix
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma}=\left(\begin{array}{cc}
\sigma_{SS}\\
\sigma_{ST} &amp; \sigma_{TT}
\end{array}\right)</code>
</p>
<p>,
</p>
<p>and where <code class="reqn">j</code> is the subject indicator, <code class="reqn">S_{j}</code> and <code class="reqn">T_{j}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code>, and <code class="reqn">Z_{j}</code> is the treatment indicator for subject <code class="reqn">j</code>. 
</p>
<p>To be in line with the Prentice criteria, Z should have a significant effect on S in model 1 (Prentice criterion 1), Z should have a significant effect on T in model 2 (Prentice criterion 2), S should have a significant effect on T in model 3 (Prentice criterion criterion 3), and the effect of Z on T should be fully captured by S in model 4 (Prentice criterion 4).  
</p>
<p>The Prentice approach to assess surrogavy has some fundamental limitations. For example, the fourth Prentice criterion requires that the statistical test for the  <code class="reqn">\beta_S</code> in model 4 is non-significant. This criterion is useful to reject a poor surrogate, but it is not suitable to validate a good surrogate (i.e., a non-significant result may always be attributable to a lack of statistical power). Even when lack of power would not be an issue, the result of the statistical test to evaluate the fourth Prentice criterion cannot prove that the effect of the treatment on the true endpoint is fully captured by the surrogate. 
</p>
<p>The use of the Prentice approach to evaluate a surrogate is not recommended. Instead, consider using the single-trial meta-anlytic method (if no multiple clinical trials are available or if there is no other clustering unit in the data; see function <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>) or the multiple-trial meta-analytic methods (see <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, and <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>). 
</p>


<h3>Value</h3>

<table>
<tr><td><code>Prentice.Model.1</code></td>
<td>
<p>An object of class <code>lm</code> that contains the fitted model 1 (using the Prentice approach).</p>
</td></tr>
<tr><td><code>Prentice.Model.2</code></td>
<td>
<p>An object of class <code>lm</code> that contains the fitted model 2 (using the Prentice approach).</p>
</td></tr>
<tr><td><code>Prentice.Model.3</code></td>
<td>
<p>An object of class <code>lm</code> that contains the fitted model 3 (using the Prentice approach).</p>
</td></tr>
<tr><td><code>Prentice.Model.4</code></td>
<td>
<p>An object of class <code>lm</code> that contains the fitted model 4 (using the Prentice approach).</p>
</td></tr>
<tr><td><code>Prentice.Passed</code></td>
<td>
<p><code>Logical</code>. If all four Prentice criteria are fulfilled, <code>Prentice.Passed=TRUE</code>. If at least one criterion is not fulfilled, <code>Prentice.Passed=FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Prentice, R. L. (1989). Surrogate endpoints in clinical trials: definitions and
operational criteria. <em>Statistics in Medicine, 8,</em> 431-440.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the ARMD dataset
data(ARMD)

## Evaluate the Prentice criteria in the ARMD dataset 
Prent &lt;- Prentice(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Pat.ID=Id)

# Summary of results
summary(Prent)
</code></pre>

<hr>
<h2 id='print.survbin'>Prints all the elements of an object fitted with the 'survbin()' function.</h2><span id='topic+print.survbin'></span>

<h3>Description</h3>

<p>Prints all the elements of an object fitted with the 'survbin()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survbin'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.survbin_+3A_x">x</code></td>
<td>
<p>An object of class 'survbin' fitted with the 'survbin()' function.</p>
</td></tr>
<tr><td><code id="print.survbin_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The surrogacy measures with their 95% confidence intervals and the estimated treament effect on the surrogate and true endpoint.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal")
fit_bin &lt;- survbin(data = colorectal, true = surv, trueind = SURVIND, surrog = responder,
                   trt = TREAT, center = CENTER, trial = TRIAL, patientid = patientid)
print(fit_bin)

## End(Not run)
</code></pre>

<hr>
<h2 id='print.survcat'>Prints all the elements of an object fitted with the 'survcat()' function.</h2><span id='topic+print.survcat'></span>

<h3>Description</h3>

<p>Prints all the elements of an object fitted with the 'survcat()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survcat'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.survcat_+3A_x">x</code></td>
<td>
<p>An object of class 'survcat' fitted with the 'survcat()' function.</p>
</td></tr>
<tr><td><code id="print.survcat_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The surrogacy measures with their 95% confidence intervals and the estimated treament effect on the surrogate and true endpoint.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal4")
fit &lt;- survcat(data = colorectal4, true = truend, trueind = trueind, surrog = surrogend,
               trt = treatn, center = center, trial = trialend, patientid = patid)
print(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='PROC.BinBin'>Evaluate the individual causal association (ICA) and reduction in probability of a prediction error (RPE) in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints</h2><span id='topic+PROC.BinBin'></span>

<h3>Description</h3>

<p>The function <code>PROC.BinBin</code> assesses the ICA and RPE in the single-trial causal-inference framework when both the surrogate and the true endpoints are binary outcomes. It additionally allows to account for sampling variability by means of bootstrap. See <b>Details</b> below.</p>


<h3>Usage</h3>

<pre><code class='language-R'>PROC.BinBin(Dataset=Dataset, Surr=Surr, True=True, Treat=Treat, 
BS=FALSE, seqs=250, MC_samples=1000, Seed=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PROC.BinBin_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a binary surrogate value, a binary true endpoint value, and a treatment indicator. </p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the binary surrogate endpoint values. Should be coded as <code class="reqn">0</code> and <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the binary true endpoint values. Should be coded as <code class="reqn">0</code> and <code class="reqn">1</code>.</p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group. </p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_bs">BS</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then Dataset will be bootstrapped to account for sampling variability. If <code>FALSE</code>, then no bootstrap is performed. See the <b>Details</b> section below. Default <code>FALSE</code>. </p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_seqs">seqs</code></td>
<td>
<p>The number of copies of the dataset that are produced or alternatively the number of bootstrap datasets that are produced. Default <code>seqs=250</code>. </p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_mc_samples">MC_samples</code></td>
<td>
<p>The number of Monte Carlo samples that need to be obtained per copy of the data set. Default <code>MC_samples=1000</code>. </p>
</td></tr>
<tr><td><code id="PROC.BinBin_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used. Default <code>Seed=1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the continuous normal setting, surroagacy can be assessed by studying the association between the individual causal effects on <code class="reqn">S</code> and <code class="reqn">T</code> (see <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code>). In that setting, the Pearson correlation is the obvious measure of association.
</p>
<p>When <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints, multiple alternatives exist. Alonso et al. (2016) proposed the individual causal association (ICA; <code class="reqn">R_{H}^{2}</code>), which captures the association between the individual causal effects of the treatment on <code class="reqn">S</code> (<code class="reqn">\Delta_S</code>) and <code class="reqn">T</code> (<code class="reqn">\Delta_T</code>) using information-theoretic principles. 
</p>
<p>The function <code>PPE.BinBin</code> computes <code class="reqn">R_{H}^{2}</code> using a grid-based approach where all possible combinations of the specified grids for the parameters that are allowed to vary freely are considered. It additionally computes the minimal probability of a prediction error (PPE) and the reduction on the PPE using information that <code class="reqn">S</code> conveys on <code class="reqn">T</code> (RPE). Both measures provide complementary information over the <code class="reqn">R_{H}^{2}</code> and facilitate more straightforward clinical interpretation. No assumption about monotonicity can be made. The function <code>PROC.BinBin</code> makes direct use of the function <code>PPE.BinBin</code>. However, it is computationally much faster thanks to equally dividing the number of Monte Carlo samples over copies of the input data. In addition, it allows to account for sampling variability using a bootstrap procedure. Finally, the function <code>PROC.BinBin</code> computes the marginal probabilities directly from the input data set. 
</p>


<h3>Value</h3>

<p>An object of class <code>PPE.BinBin</code> with components,
</p>
<table>
<tr><td><code>PPE</code></td>
<td>
<p>The vector of the PPE values.</p>
</td></tr>
<tr><td><code>RPE</code></td>
<td>
<p>The vector of the RPE values.</p>
</td></tr>
<tr><td><code>PPE_T</code></td>
<td>
<p>The vector of the <code class="reqn">PPE_T</code> values indicating the probability on a prediction error without using information on <code class="reqn">S</code>.</p>
</td></tr>
<tr><td><code>R2_H</code></td>
<td>
<p>The vector of the <code class="reqn">R_H^2</code> values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Paul Meyvisch, Wim Van der Elst, Ariel Alonso, Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso A,  Van der Elst W, Molenberghs G, Buyse M and Burzykowski T. (2016). An information-theoretic approach for the evaluation of surrogate endpoints based on causal inference. 
</p>
<p>Meyvisch P., Alonso A.,Van der Elst W, Molenberghs G.. Assessing the predictive value of a binary surrogate for a binary true endpoint, based on the minimum probability of a prediction error.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PPE.BinBin">PPE.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Conduct the analysis 
 
## Not run:  # time consuming code part
library(Surrogate)
# load the CIGTS data 
data(CIGTS)
CIGTS_25000&lt;-PROC.BinBin(Dataset=CIGTS, Surr=IOP_12, True=IOP_96, 
Treat=Treat, BS=FALSE,seqs=250, MC_samples=100, Seed=1)

## End(Not run)

</code></pre>

<hr>
<h2 id='RandVec'>
Generate random vectors with a fixed sum
</h2><span id='topic+RandVec'></span>

<h3>Description</h3>

<p>This function generates an n by m array x, each of whose m columns contains n random values lying in the interval [a,b], subject to the condition that their sum be equal to s. The distribution of values is uniform in the sense that it has the conditional probability distribution of a uniform distribution over the whole n-cube, given that the sum of the x's is s.
The function uses the <code>randfixedsum</code> algorithm, written by Roger Stafford and implemented in MatLab. For details, see http://www.mathworks.com/matlabcentral/fileexchange/9700-random-vectors-with-fixed-sum/content/randfixedsum.m 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RandVec(a=0, b=1, s=1, n=9, m=1, Seed=sample(1:1000, size = 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RandVec_+3A_a">a</code></td>
<td>
<p>The function <code>RandVec</code> generates an <code>n</code> by <code>m</code> matrix x. Each of the <code>m</code> columns contain <code>n</code> random values lying in the interval [a,b]. The argument <code>a</code> specifies the lower limit of the interval. Default <code>0</code>.</p>
</td></tr>
<tr><td><code id="RandVec_+3A_b">b</code></td>
<td>
<p>The argument <code>b</code> specifies the upper limit of the interval. Default <code>1</code>.</p>
</td></tr>
<tr><td><code id="RandVec_+3A_s">s</code></td>
<td>
<p>The argument <code>s</code> specifies the value to which each of the <code>m</code> generated columns should sum to. Default <code>1</code>.</p>
</td></tr>
<tr><td><code id="RandVec_+3A_n">n</code></td>
<td>
<p>The number of requested elements per column. Default <code>9</code>.</p>
</td></tr>
<tr><td><code id="RandVec_+3A_m">m</code></td>
<td>
<p>The number of requested columns. Default <code>1</code>.</p>
</td></tr>
<tr><td><code id="RandVec_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used. Default <code>sample(1:1000, size = 1)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>RandVec</code> with components,
</p>
<table>
<tr><td><code>RandVecOutput</code></td>
<td>
<p>The randomly generated vectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>The function is an R adaptation of a matlab program written by Roger Stafford. For details on the original Matlab algorithm, see: 
http://www.mathworks.com/matlabcentral/fileexchange/9700-random-vectors-with-fixed-sum/content/randfixedsum.m
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate two vectors with 10 values ranging between 0 and 1
# where each vector sums to 1
# (uniform distribution over the whole n-cube)
Vectors &lt;- RandVec(a=0, b=1, s=1, n=10, m=2)
sum(Vectors$RandVecOutput[,1])
sum(Vectors$RandVecOutput[,2])
</code></pre>

<hr>
<h2 id='Restrictions.BinBin'>Examine restrictions in <code class="reqn">\bold{\pi}_{f}</code> under different montonicity assumptions for binary <code class="reqn">S</code> and <code class="reqn">T</code></h2><span id='topic+Restrictions.BinBin'></span>

<h3>Description</h3>

<p>The function <code>Restrictions.BinBin</code> gives an overview of the restrictions in <code class="reqn">\bold{\pi}_{f}</code>
under different assumptions regarding montonicity when both <code class="reqn">S</code> and <code class="reqn">T</code> are binary.</p>


<h3>Usage</h3>

<pre><code class='language-R'>Restrictions.BinBin(pi1_1_, pi1_0_, pi_1_1, pi_1_0, pi0_1_, pi_0_1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Restrictions.BinBin_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=0)</code>, i.e., the proability that <code class="reqn">S=T=1</code> when under treatment <code class="reqn">Z=0</code>.</p>
</td></tr>
<tr><td><code id="Restrictions.BinBin_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="Restrictions.BinBin_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="Restrictions.BinBin_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="Restrictions.BinBin_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="Restrictions.BinBin_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An overview of the restrictions for the freely varying parameters imposed by the data is provided</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2014). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MarginalProbs">MarginalProbs</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Restrictions.BinBin(pi1_1_=0.262, pi0_1_=0.135, pi1_0_=0.286, 
pi_1_1=0.637, pi_1_0=0.078, pi_0_1=0.127)
</code></pre>

<hr>
<h2 id='sample_copula_parameters'>Sample Unidentifiable Copula Parameters</h2><span id='topic+sample_copula_parameters'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+sample_copula_parameters">sample_copula_parameters()</a></code> function samples the unidentifiable copula
parameters for the partly identifiable D-vine copula model, see for example
<code><a href="#topic+fit_copula_model_BinCont">fit_copula_model_BinCont()</a></code> and <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code> for more information
regarding the D-vine copula model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_copula_parameters(
  copula_family2,
  n_sim,
  eq_cond_association = FALSE,
  lower = c(-1, -1, -1, -1),
  upper = c(1, 1, 1, 1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_copula_parameters_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_copula_parameters_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of copula parameter vectors to be sampled.</p>
</td></tr>
<tr><td><code id="sample_copula_parameters_+3A_eq_cond_association">eq_cond_association</code></td>
<td>
<p>(boolean) Indicates whether <code class="reqn">\rho_{13;2}</code> and
<code class="reqn">\rho_{24;3}</code> are set equal.</p>
</td></tr>
<tr><td><code id="sample_copula_parameters_+3A_lower">lower</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the lower limit,
<code class="reqn">\boldsymbol{a} = (a_{23}, a_{13;2}, a_{24;3},
  a_{14;23})'</code>. Defaults to <code>c(-1, -1, -1, -1)</code>. If the provided lower limit
is smaller than what is allowed for a particular copula family, then the
copula family's lowest possible value is used instead.</p>
</td></tr>
<tr><td><code id="sample_copula_parameters_+3A_upper">upper</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the upper limit,
<code class="reqn">\boldsymbol{b} = (b_{23}, b_{13;2}, b_{24;3},
  b_{14;23})'</code>. Defaults to <code>c(1, 1, 1, 1)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>n_sim</code> by <code>4</code> numeric matrix where each row corresponds to a
sample for <code class="reqn">\boldsymbol{\theta}_{unid}</code>.
</p>


<h3>Sampling</h3>

<p>In the D-vine copula model in the Information-Theoretic Causal Inference
(ITCI) framework, the following copulas are not identifiable: <code class="reqn">c_{23}</code>,
<code class="reqn">c_{13;2}</code>, <code class="reqn">c_{24;3}</code>, <code class="reqn">c_{14;23}</code>. Let the corresponding
copula
parameters be </p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\theta}_{unid} = (\theta_{23}, \theta_{13;2},
\theta_{24;3}, \theta_{14;23})'.</code>
</p>

<p>The allowable range for this parameter vector depends on the corresponding
copula families. For parsimony and comparability across different copula
families, the sampling procedure consists of two steps:
</p>

<ol>
<li><p> Sample Spearman's rho parameters from a uniform distribution,
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\rho}_{unid} = (\rho_{23}, \rho_{13;2}, \rho_{24;3},
  \rho_{14;23})' \sim U(\boldsymbol{a}, \boldsymbol{b}).</code>
</p>

</li>
<li><p> Transform the sampled Spearman's rho parameters to the copula parameter
scale, <code class="reqn">\boldsymbol{\theta}_{unid}</code>.
</p>
</li></ol>

<p>These two steps are repeated <code>n_sim</code> times.
</p>


<h3>Conditional Independence</h3>

<p>In addition to range restrictions through the <code>lower</code> and <code>upper</code> arguments,
we allow for so-called conditional independence assumptions.
These assumptions entail that <code class="reqn">\rho_{13;2} = 0</code> and <code class="reqn">\rho_{24;3} =
0</code>. Or in other words, <code class="reqn">U_1 \perp U_3 \, | \, U_2</code> and <code class="reqn">U_2 \perp U_4 \, | \, U_3</code>.
In the context of a surrogate evaluation trial (where <code class="reqn">(U_1, U_2, U_3,
U_4)'</code> corresponds to the probability integral transformation of <code class="reqn">(T_0,
S_0, S_1, T_1)'</code>) this assumption could be justified by subject-matter knowledge.
</p>

<hr>
<h2 id='sample_deltas_BinCont'>Sample individual casual treatment effects from given D-vine copula model in
binary continuous setting</h2><span id='topic+sample_deltas_BinCont'></span>

<h3>Description</h3>

<p>Sample individual casual treatment effects from given D-vine copula model in
binary continuous setting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_deltas_BinCont(
  copula_par,
  rotation_par,
  copula_family1,
  copula_family2 = copula_family1,
  n,
  q_S0 = NULL,
  q_S1 = NULL,
  q_T0 = NULL,
  q_T1 = NULL,
  marginal_sp_rho = TRUE,
  setting = "BinCont",
  composite = FALSE,
  plot_deltas = FALSE,
  restr_time = +Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_deltas_BinCont_+3A_copula_par">copula_par</code></td>
<td>
<p>Parameter vector for the sequence of bivariate copulas that
define the D-vine copula. The elements of <code>copula_par</code> correspond to
<code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_rotation_par">rotation_par</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_copula_family1">copula_family1</code></td>
<td>
<p>Copula family of <code class="reqn">c_{12}</code> and <code class="reqn">c_{34}</code>. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family</code> correspond to <code class="reqn">(c_{12}, c_{34})</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_n">n</code></td>
<td>
<p>Number of samples to be taken from the D-vine copula.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_q_s0">q_S0</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_0</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_q_s1">q_S1</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">S_1</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_q_t0">q_T0</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">T_0</code>. This should be
<code>NULL</code> if <code class="reqn">T_0</code> is binary.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_q_t1">q_T1</code></td>
<td>
<p>Quantile function for the distribution of <code class="reqn">T_1</code>. This should be
<code>NULL</code> if <code class="reqn">T_1</code> is binary.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_marginal_sp_rho">marginal_sp_rho</code></td>
<td>
<p>(boolean) Compute the sample Spearman correlation
matrix? Defaults to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_setting">setting</code></td>
<td>
<p>Should be one of the following two:
</p>

<ul>
<li> <p><code>"BinCont"</code>: for when <code class="reqn">S</code> is continuous and <code class="reqn">T</code> is binary.
</p>
</li>
<li> <p><code>"SurvSurv"</code>: for when both <code class="reqn">S</code> and <code class="reqn">T</code> are time-to-event variables.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_plot_deltas">plot_deltas</code></td>
<td>
<p>Plot the sampled individual causal effects? Defaults to
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="sample_deltas_BinCont_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements:
</p>

<ul>
<li> <p><code>Delta_dataframe</code>: a dataframe containing the sampled individual causal
treatment effects
</p>
</li>
<li> <p><code>marginal_sp_rho_matrix</code>: a matrix containing the marginal pairwise Spearman's rho
parameters estimated from the sample. If <code>marginal_sp_rho = FALSE</code>, this
matrix is not computed and <code>NULL</code> is returned for this element of the list.
</p>
</li></ul>


<hr>
<h2 id='sample_dvine'>Sample copula data from a given four-dimensional D-vine copula</h2><span id='topic+sample_dvine'></span>

<h3>Description</h3>

<p><code>sample_dvine()</code> is a helper function that samples copula data from a given
D-vine copula. See details for more information on the parameterization of
the D-vine copula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_dvine(
  copula_par,
  rotation_par,
  copula_family1,
  copula_family2 = copula_family1,
  n
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_dvine_+3A_copula_par">copula_par</code></td>
<td>
<p>Parameter vector for the sequence of bivariate copulas that
define the D-vine copula. The elements of <code>copula_par</code> correspond to
<code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_dvine_+3A_rotation_par">rotation_par</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{12}, c_{23}, c_{34}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_dvine_+3A_copula_family1">copula_family1</code></td>
<td>
<p>Copula family of <code class="reqn">c_{12}</code> and <code class="reqn">c_{34}</code>. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family</code> correspond to <code class="reqn">(c_{12}, c_{34})</code>.</p>
</td></tr>
<tr><td><code id="sample_dvine_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sample_dvine_+3A_n">n</code></td>
<td>
<p>Number of samples to be taken from the D-vine copula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code class="reqn">n \times 4</code> matrix where each row corresponds to one sampled
vector and the columns correspond to <code class="reqn">U_1</code>, <code class="reqn">U_2</code>, <code class="reqn">U_3</code>, and
<code class="reqn">U_4</code>.
</p>


<h3>D-vine Copula</h3>

<p>Let <code class="reqn">\boldsymbol{U} = (U_1, U_2, U_3, U_4)'</code> be a random vector with
uniform margins. The corresponding distribution function is then a
4-dimensional copula. A D-vine copula as a family of <code class="reqn">k</code>-dimensional
copulas. Indeed, a D-vine copula is a <code class="reqn">k</code>-dimensional copula that is
constructed from a particular product of bivariate copula densities. In this
function, only 4-dimensional copula densities are considered. Under the
simplifying assumption, the 4-dimensional D-vine copula density is the
product of the following bivariate copula densities:
</p>

<ul>
<li> <p><code class="reqn">c_{12}</code>, <code class="reqn">c_{23}</code>, and <code class="reqn">c_{34}</code>
</p>
</li>
<li> <p><code class="reqn">c_{13;2}</code> and <code class="reqn">c_{24;3}</code>
</p>
</li>
<li> <p><code class="reqn">c_{14;23}</code>
</p>
</li></ul>


<hr>
<h2 id='Schizo'>
Data of five clinical trials in schizophrenia
</h2><span id='topic+Schizo'></span>

<h3>Description</h3>

<p>These are the data of five clinical trials in schizophrenia. A total of <code class="reqn">2128</code> patients were treated by <code class="reqn">198</code> investiagators (psychiatrists). Patients' schizophrenic symptoms were measured using the PANSS, BPRS, and CGI. There were two treatment conditions (risperidone and control).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Schizo)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">2128</code> observations on <code class="reqn">9</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The patient ID.</p>
</dd>
<dt><code>InvestID</code></dt><dd><p>The ID of the investigator (psychiatrist) who treated the patient.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = control and <code class="reqn">1</code> = Risperidone.</p>
</dd>
<dt><code>CGI</code></dt><dd><p>The change in the CGI score (= score at the start of the treatment - score at the end of the treatment).</p>
</dd>
<dt><code>PANSS</code></dt><dd><p>The change in the PANSS score.</p>
</dd>
<dt><code>BPRS</code></dt><dd><p>The change in the PANSS score.</p>
</dd>
<dt><code>PANSS_Bin</code></dt><dd><p>The dichotomized PANSS change score, coded as <code class="reqn">1</code> = a reduction of 
20% or more in the PANSS score (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
<dt><code>BPRS_Bin</code></dt><dd><p>The dichotomized BPRS change score, coded as <code class="reqn">1</code> = a reduction of 20% or more in the BPRS score (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
<dt><code>CGI_Bin</code></dt><dd><p>The sichtomized change in the CGI score, coded as <code class="reqn">1</code> = a change of more than <code class="reqn">3</code> points on the original scale (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
</dl>


<hr>
<h2 id='Schizo_Bin'>
Data of a clinical trial in Schizophrenia (with binary outcomes).
</h2><span id='topic+Schizo_Bin'></span>

<h3>Description</h3>

<p>These are the data of a clinical trial in Schizophrenia (a subset of the dataset <code>Schizo_Bin</code>, study <code class="reqn">1</code> where the patients were administered <code class="reqn">10</code> mg. of haloperidol or <code class="reqn">8</code> mg. of risperidone). A total of <code class="reqn">454</code> patients were treated by <code class="reqn">117</code> investigators (psychiatrists). Patients' schizophrenia symptoms at baseline and at the end of the study (after <code class="reqn">8</code> weeks) were measured using the PANSS and BPRS. 
The variables BPRS_Bin and PANSS_Bin are binary outcomes that indicate whether clinically meaningful change had occurred (1 = a reduction of <code class="reqn">20</code>% or higher in the PANSS/BPRS scores at the last measurement compared to baseline; 0 = no such reduction; Leucht et al., 2005; Kay et al., 1988).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Schizo_Bin)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">454</code> observations on <code class="reqn">5</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The patient ID.</p>
</dd>
<dt><code>InvestI</code></dt><dd><p>The ID of the investigator (psychiatrist) who treated the patient.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = control treatment (10 mg. haloperidol) and <code class="reqn">1</code> = experimental treatment (8 mg. risperidone).</p>
</dd>
<dt><code>PANSS_Bin</code></dt><dd><p>The dichotomized change in the PANSS score (1 = a
reduction of <code class="reqn">20</code>% or more in the PANSS score, 0=otherwise)</p>
</dd>
<dt><code>BPRS_Bin</code></dt><dd><p>The dichotomized change in the BPRS score (1 = a
reduction of <code class="reqn">20</code>% or more in the BPRS score, 0=otherwise)</p>
</dd>
<dt><code>CGI_Bin</code></dt><dd><p>The sichtomized change in the CGI score, coded as <code class="reqn">1</code> = a change of more than <code class="reqn">3</code> points on the original scale (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
</dl>



<h3>References</h3>

<p>Kay, S.R., Opler, L.A., &amp; Lindenmayer, J.P. (1988). Reliability and validity of the Positive and Negative Syndrome Scale for schizophrenics. Psychiatric Research, 23, 99-110.
</p>
<p>Leucht, S., et al. (2005). Clinical implications of Brief Psychiatric Rating Scale scores. The British Journal of Psychiarty, 187, 366-371.
</p>

<hr>
<h2 id='Schizo_BinCont'>
Data of a clinical trial in schizophrenia, with binary and continuous endpoints
</h2><span id='topic+Schizo_BinCont'></span>

<h3>Description</h3>

<p>These are the data of a clinical trial in schizophrenia. Patients' schizophrenic symptoms were measured using the PANSS, BPRS, and CGI. There were two treatment conditions (risperidone and control).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Schizo)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">446</code> observations on <code class="reqn">9</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The patient ID.</p>
</dd>
<dt><code>InvestID</code></dt><dd><p>The ID of the investigator (psychiatrist) who treated the patient.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = control and <code class="reqn">1</code> = Risperidone.</p>
</dd>
<dt><code>CGI</code></dt><dd><p>The change in the CGI score (= score at the start of the treatment - score at the end of the treatment).</p>
</dd>
<dt><code>PANSS</code></dt><dd><p>The change in the PANSS score.</p>
</dd>
<dt><code>BPRS</code></dt><dd><p>The change in the PANSS score.</p>
</dd>
<dt><code>PANSS_Bin</code></dt><dd><p>The dichotomized PANSS change score, coded as <code class="reqn">1</code> = a reduction of 20% or more in the PANSS score (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
<dt><code>BPRS_Bin</code></dt><dd><p>The dichotomized BPRS change score, coded as <code class="reqn">1</code> = a reduction of 
20% or more in the BPRS score (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
<dt><code>CGI_Bin</code></dt><dd><p>The sichtomized change in the CGI score, coded as <code class="reqn">1</code> = a change of more than <code class="reqn">3</code> points on the original scale (score at the end of the treatment relative to score at the beginning of the treatment), <code class="reqn">0</code> = otherwise.</p>
</dd>
</dl>


<hr>
<h2 id='Schizo_PANSS'>
Longitudinal PANSS data of five clinical trials in schizophrenia
</h2><span id='topic+Schizo_PANSS'></span>

<h3>Description</h3>

<p>These are the longitudinal PANSS data of five clinical trial in schizophrenia. A total of <code class="reqn">2151</code> patients were treated by <code class="reqn">198</code> investiagators (psychiatrists). There were two treatment conditions (risperidone and control). Patients' schizophrenic symptoms were measured using the PANSS at different time moments following start of the treatment. The variables Week1-Week8 express the change scores over time using the raw (semi-continuous) PANSS scores. The variables Week1_bin - Week8_bin are binary indicators of a <code class="reqn">20</code>% or higher reduction in PANSS score versus baseline. The latter corresponds to a commonly accepted criterion for defining a clinically meaningful response (Kay et al., 1988).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Schizo_PANSS)</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with <code class="reqn">2151</code> observations on <code class="reqn">6</code> variables.
</p>

<dl>
<dt><code>Id</code></dt><dd><p>The patient ID.</p>
</dd>
<dt><code>InvestID</code></dt><dd><p>The ID of the investigator (psychiatrist) who treated the patient.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>The treatment indicator, coded as <code class="reqn">-1</code> = placebo and <code class="reqn">1</code> = Risperidone.</p>
</dd>
<dt><code>Week1</code></dt><dd><p>The change in the PANSS score <code class="reqn">1</code> week after starting the treatment (= score at the end of the treatment - score at <code class="reqn">1</code> week after starting the treatment).</p>
</dd>
<dt><code>Week2</code></dt><dd><p>The change in the PANSS score <code class="reqn">2</code> weeks after starting the treatment.</p>
</dd>
<dt><code>Week4</code></dt><dd><p>The change in the PANSS score <code class="reqn">4</code> weeks after starting the treatment.</p>
</dd>
<dt><code>Week6</code></dt><dd><p>The change in the PANSS score <code class="reqn">6</code> weeks after starting the treatment.</p>
</dd>
<dt><code>Week8</code></dt><dd><p>The change in the PANSS score <code class="reqn">8</code> weeks after starting the treatment.</p>
</dd>
<dt><code>Week1_bin</code></dt><dd><p>The dichotomized change in the PANSS score <code class="reqn">1</code> week after starting the treatment (<code class="reqn">1</code>=a <code class="reqn">20</code>% or higher reduction in PANSS score versus baseline, <code class="reqn">0</code>=otherwise).</p>
</dd>
<dt><code>Week2_bin</code></dt><dd><p>The dichotomized change in the PANSS score <code class="reqn">2</code> weeks after starting the treatment.</p>
</dd> 
<dt><code>Week4_bin</code></dt><dd><p>The dichotomized change in the PANSS score <code class="reqn">4</code> weeks after starting the treatment.</p>
</dd> 
<dt><code>Week6_bin</code></dt><dd><p>The dichotomized change in the PANSS score <code class="reqn">6</code> weeks after starting the treatment.</p>
</dd> 
<dt><code>Week8_bin</code></dt><dd><p>The dichotomized change in the PANSS score <code class="reqn">8</code> weeks after starting the treatment.</p>
</dd> 
</dl>



<h3>References</h3>

<p>Kay, S.R., Opler, L.A., &amp; Lindenmayer, J.P. (1988). Reliability and validity of the Positive and Negative Syndrome Scale for schizophrenics. Psychiatric Research, 23, 99-110.
</p>

<hr>
<h2 id='sensitivity_analysis_BinCont_copula'>Perform Sensitivity Analysis for the Individual Causal Association with a
Continuous Surrogate and Binary True Endpoint</h2><span id='topic+sensitivity_analysis_BinCont_copula'></span>

<h3>Description</h3>

<p>Perform Sensitivity Analysis for the Individual Causal Association with a
Continuous Surrogate and Binary True Endpoint
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_analysis_BinCont_copula(
  fitted_model,
  n_sim,
  eq_cond_association = TRUE,
  lower = c(-1, -1, -1, -1),
  upper = c(1, 1, 1, 1),
  marg_association = TRUE,
  n_prec = 10000,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_copula_model_BinCont">fit_copula_model_BinCont()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of replications in the <em>sensitivity analysis</em>. This value
should be large enough to sufficiently explore all possible values of the
ICA. The minimally sufficient number depends to a large extent on which
inequality assumptions are subsequently imposed (see Additional
Assumptions).</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_eq_cond_association">eq_cond_association</code></td>
<td>
<p>Boolean.
</p>

<ul>
<li> <p><code>TRUE</code> (default): Assume that the association in <code class="reqn">(\tilde{S}_1, T_0)' | \tilde{S}_0</code>
and <code class="reqn">(\tilde{S}_0, T_1)' | \tilde{S}_1</code> are the same.
</p>
</li>
<li> <p><code>FALSE</code>: There is not specific a priori relationship between the
above two associations.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_lower">lower</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the lower limit,
<code class="reqn">\boldsymbol{a} = (a_{23}, a_{13;2}, a_{24;3},
  a_{14;23})'</code>. Defaults to <code>c(-1, -1, -1, -1)</code>. If the provided lower limit
is smaller than what is allowed for a particular copula family, then the
copula family's lowest possible value is used instead.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_upper">upper</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the upper limit,
<code class="reqn">\boldsymbol{b} = (b_{23}, b_{13;2}, b_{24;3},
  b_{14;23})'</code>. Defaults to <code>c(1, 1, 1, 1)</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_marg_association">marg_association</code></td>
<td>
<p>Boolean.
</p>

<ul>
<li> <p><code>TRUE</code>: Return marginal association measures
in each replication in terms of Spearman's rho. The proportion of harmed,
protected, never diseased, and always diseased is also returned. See also
Value.
</p>
</li>
<li> <p><code>FALSE</code> (default): No additional measures are returned.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte-Carlo samples for the <em>numerical approximation</em>
of the ICA in each replication of the sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_BinCont_copula_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used in the sensitivity analysis. The
computations are computationally heavy, and this option can speed things up
considerably.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame is returned. Each row represents one replication in the
sensitivity analysis. The returned data frame always contains the following
columns:
</p>

<ul>
<li> <p><code>R2H</code>, <code>sp_rho</code>, <code>minfo</code>: ICA as quantified by <code class="reqn">R^2_H</code>, Spearman's rho, and
Kendall's tau, respectively.
</p>
</li>
<li> <p><code>c12</code>, <code>c34</code>: estimated copula parameters.
</p>
</li>
<li> <p><code>c23</code>, <code>c13_2</code>, <code>c24_3</code>, <code>c14_23</code>: sampled copula parameters of the
unidentifiable copulas in the D-vine copula. The parameters correspond to
the parameterization of the <code>copula_family2</code> copula as in the <code>copula</code>
R-package.
</p>
</li>
<li> <p><code>r12</code>, <code>r34</code>: Fixed rotation parameters for the two identifiable copulas.
</p>
</li>
<li> <p><code>r23</code>, <code>r13_2</code>, <code>r24_3</code>, <code>r14_23</code>: Sampled rotation parameters of the
unidentifiable copulas in the D-vine copula. These values are constant for
the Gaussian copula family since that copula is invariant to rotations.
</p>
</li></ul>

<p>The returned data frame also contains the following columns when
<code>marg_association</code> is <code>TRUE</code>:
</p>

<ul>
<li> <p><code>sp_s0s1</code>, <code>sp_s0t0</code>, <code>sp_s0t1</code>, <code>sp_s1t0</code>, <code>sp_s1t1</code>, <code>sp_t0t1</code>:
Spearman's rho between the corresponding potential outcomes. Note that these
associations refer to the observable potential outcomes. In contrary, the
estimated association parameters from <code><a href="#topic+fit_copula_model_BinCont">fit_copula_model_BinCont()</a></code> refer to
associations on a latent scale.
</p>
</li></ul>



<h3>Information-Theoretic Causal Inference Framework</h3>

<p>The information-theoretic causal inference (ITCI) is a general framework to
evaluate surrogate endpoints in the single-trial setting (Alonso et al.,
2015). In this framework, we focus on the individual causal effects,
<code class="reqn">\Delta S = S_1 - S_0</code> and <code class="reqn">\Delta T = T_1 - T_0</code> where <code class="reqn">S_z</code>
and <code class="reqn">T_z</code> are the potential surrogate end true endpoint under treatment
<code class="reqn">Z = z</code>.
</p>
<p>In the ITCI framework, we say that <code class="reqn">S</code> is a good surrogate for <code class="reqn">T</code>
if
<em><code class="reqn">\Delta S</code> conveys a substantial amount of information on <code class="reqn">\Delta T</code></em>
(Alonso, 2018). This amount of shared information can generally be quantified
by the mutual information between <code class="reqn">\Delta S</code> and <code class="reqn">\Delta T</code>,
denoted by <code class="reqn">I(\Delta S; \Delta T)</code>. However, the mutual information lies
in <code class="reqn">[0, + \infty]</code> which complicates the interpretation. In addition,
the mutual information may not be defined in specific scenarios where
absolute continuity of certain probability measures fails. Therefore, the
mutual information is transformed, and possibly modified, to enable a simple
interpretation in light of the definition of surrogacy. The resulting measure
is termed the individual causal association (ICA). This is explained in
the next sections.
</p>
<p>While the definition of surrogacy in the ITCI framework rests on information
theory, shared information is closely related to statistical association. Hence,
we can also define the ICA in terms of statistical association measures, like
Spearman's rho and Kendall's tau. The advantage of the latter are that they
are well-known, simple and rank-based measures of association.
</p>


<h3>Quantifying Surrogacy</h3>

<p>Alonso et al. (na) proposed to the following measure for the ICA: </p>
<p style="text-align: center;"><code class="reqn">R^2_H
= \frac{I(\Delta S; \Delta T)}{H(\Delta T)}</code>
</p>
<p> where <code class="reqn">H(\Delta T)</code> is the
entropy of <code class="reqn">\Delta T</code>. By token of that transformation of the mutual
information, <code class="reqn">R^2_H</code> is restricted to the unit interval where 0 indicates
independence, and 1 a functional relationship between <code class="reqn">\Delta S</code> and
<code class="reqn">\Delta T</code>.
</p>
<p>The association between <code class="reqn">\Delta S</code> and <code class="reqn">\Delta T</code> can also be
quantified by Spearman's <code class="reqn">\rho</code> (or Kendall's <code class="reqn">\tau</code>). This quantity
requires appreciably less computing time than the mutual information. This
quantity is therefore always returned for every replication of the
sensitivity analysis.
</p>


<h3>Sensitivity Analysis</h3>



<h4>Monte Carlo Approach</h4>

<p>Because <code class="reqn">S_0</code> and <code class="reqn">S_1</code> are never simultaneously observed in the same
patient, <code class="reqn">\Delta S</code> is not observable, and analogously for <code class="reqn">\Delta
T</code>. Consequently, the ICA is unidentifiable. This is solved by considering a
(partly identifiable) model for the full vector of potential outcomes,
<code class="reqn">(T_0, S_0, S_1, T_1)'</code>. The identifiable parameters are estimated. The
unidentifiable parameters are sampled from their parameters space in each
replication of a sensitivity analysis. If the number of replications
(<code>n_sim</code>) is sufficiently large, the entire parameter space for the
unidentifiable parameters will be explored/sampled. In each replication, all
model parameters are &quot;known&quot; (either estimated or sampled). Consequently, the
ICA can be computed in each replication of the sensitivity analysis.
</p>
<p>The sensitivity analysis thus results in a set of values for the ICA. This
set can be interpreted as <em>all values for the ICA that are compatible with
the observed data</em>. However, the range of this set is often quite broad; this
means there remains too much uncertainty to make judgements regarding the
worth of the surrogate. To address this unwieldy uncertainty, additional
assumptions can be used that restrict the parameter space of the
unidentifiable parameters. This in turn reduces the uncertainty regarding the
ICA.
</p>



<h4>Intervals of Ignorance and Uncertainty</h4>

<p>The results of the sensitivity analysis can be formalized (and summarized) in
intervals of ignorance and uncertainty using <code><a href="#topic+sensitivity_intervals_Dvine">sensitivity_intervals_Dvine()</a></code>.
</p>



<h3>Additional Assumptions</h3>

<p>There are two possible types of assumptions that restrict the parameter space
of the unidentifiable parameters: (i) <em>equality</em> type of assumptions, and
(ii) <em>inequality</em> type of assumptions. These are discussed in turn in the
next two paragraphs.
</p>
<p>The equality assumptions have to be incorporated into the sensitivity
analysis itself. Only one type of equality assumption has been implemented;
this is the conditional independence assumption:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{S}_0 \perp T_1 | \tilde{S}_1 \; \text{and} \;
\tilde{S}_1 \perp T_0 | \tilde{S}_0 .</code>
</p>
<p> This can informally be
interpreted as &ldquo;what the control treatment does to the surrogate does not
provide information on the true endpoint under experimental treatment if we
already know what the experimental treatment does to the surrogate&quot;, and
analogously when control and experimental treatment are interchanged. Note
that <code class="reqn">\tilde{S}_z</code> refers to either the actual potential surrogate
outcome, or a latent version. This depends on the content of <code>fitted_model</code>.
</p>
<p>The inequality type of assumptions have to be imposed on the data frame that
is returned by the current function; those assumptions are thus imposed
<em>after</em> running the sensitivity analysis. If <code>marginal_association</code> is set to
<code>TRUE</code>, the returned data frame contains additional unverifiable quantities
that differ across replications of the sensitivity analysis: (i) the
unconditional Spearman's <code class="reqn">\rho</code> for all pairs of (observable/non-latent)
potential outcomes, and (ii) the proportions of the population strata as
defined by Nevo and Gorfine (2022) if semi-competing risks are present. More
details on the interpretation and use of these assumptions can be found in
Stijven et al. (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load Schizophrenia data set.
data("Schizo_BinCont")
# Perform listwise deletion.
na = is.na(Schizo_BinCont$CGI_Bin) | is.na(Schizo_BinCont$PANSS)
X = Schizo_BinCont$PANSS[!na]
Y = Schizo_BinCont$CGI_Bin[!na]
Treat = Schizo_BinCont$Treat[!na]
# Ensure that the treatment variable is binary.
Treat = ifelse(Treat == 1, 1, 0)
data = data.frame(X,
                  Y,
                  Treat)
# Fit copula model.
fitted_model = fit_copula_model_BinCont(data, "clayton", "normal", twostep = FALSE)
# Perform sensitivity analysis with a very low number of replications.
sens_results = sensitivity_analysis_BinCont_copula(
  fitted_model,
  10,
  lower = c(-1,-1,-1,-1),
  upper = c(1, 1, 1, 1),
  n_prec = 1e3
)

</code></pre>

<hr>
<h2 id='sensitivity_analysis_SurvSurv_copula'>Sensitivity analysis for individual causal association</h2><span id='topic+sensitivity_analysis_SurvSurv_copula'></span>

<h3>Description</h3>

<p>The <code><a href="#topic+sensitivity_analysis_SurvSurv_copula">sensitivity_analysis_SurvSurv_copula()</a></code> function performs the
sensitivity analysis for the individual causal association (ICA) as described
by Stijven et al. (2024).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_analysis_SurvSurv_copula(
  fitted_model,
  composite = TRUE,
  n_sim,
  eq_cond_association = TRUE,
  lower = c(-1, -1, -1, -1),
  upper = c(1, 1, 1, 1),
  degrees = c(0, 90, 180, 270),
  marg_association = TRUE,
  copula_family2 = fitted_model$copula_family[1],
  n_prec = 5000,
  ncores = 1,
  sample_plots = NULL,
  mutinfo_estimator = NULL,
  restr_time = +Inf
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_n_sim">n_sim</code></td>
<td>
<p>Number of replications in the <em>sensitivity analysis</em>. This value
should be large enough to sufficiently explore all possible values of the
ICA. The minimally sufficient number depends to a large extent on which
inequality assumptions are subsequently imposed (see Additional
Assumptions).</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_eq_cond_association">eq_cond_association</code></td>
<td>
<p>Boolean.
</p>

<ul>
<li> <p><code>TRUE</code> (default): Assume that the association in <code class="reqn">(\tilde{S}_1, T_0)' | \tilde{S}_0</code>
and <code class="reqn">(\tilde{S}_0, T_1)' | \tilde{S}_1</code> are the same.
</p>
</li>
<li> <p><code>FALSE</code>: There is not specific a priori relationship between the
above two associations.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_lower">lower</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the lower limit,
<code class="reqn">\boldsymbol{a} = (a_{23}, a_{13;2}, a_{24;3},
  a_{14;23})'</code>. Defaults to <code>c(-1, -1, -1, -1)</code>. If the provided lower limit
is smaller than what is allowed for a particular copula family, then the
copula family's lowest possible value is used instead.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_upper">upper</code></td>
<td>
<p>(numeric) Vector of length 4 that provides the upper limit,
<code class="reqn">\boldsymbol{b} = (b_{23}, b_{13;2}, b_{24;3},
  b_{14;23})'</code>. Defaults to <code>c(1, 1, 1, 1)</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_degrees">degrees</code></td>
<td>
<p>(numeric) vector with copula rotation degrees. Defaults to
<code>c(0, 90, 180, 270)</code>. This argument is not used for the Gaussian and Frank
copulas since they already allow for positive and negative associations.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_marg_association">marg_association</code></td>
<td>
<p>Boolean.
</p>

<ul>
<li> <p><code>TRUE</code>: Return marginal association measures
in each replication in terms of Spearman's rho. The proportion of harmed,
protected, never diseased, and always diseased is also returned. See also
Value.
</p>
</li>
<li> <p><code>FALSE</code> (default): No additional measures are returned.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte-Carlo samples for the <em>numerical approximation</em>
of the ICA in each replication of the sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used in the sensitivity analysis. The
computations are computationally heavy, and this option can speed things up
considerably.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_sample_plots">sample_plots</code></td>
<td>
<p>Indices for replicates in the sensitivity analysis for
which the sampled individual treatment effects are plotted. Defaults to
<code>NULL</code>: no plots are displayed.</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="sensitivity_analysis_SurvSurv_copula_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame is returned. Each row represents one replication in the
sensitivity analysis. The returned data frame always contains the following
columns:
</p>

<ul>
<li> <p><code>ICA</code>, <code>sp_rho</code>: ICA as quantified by <code class="reqn">R^2_h(\Delta S^*, \Delta T^*)</code> and
<code class="reqn">\rho_s(\Delta S, \Delta T)</code>.
</p>
</li>
<li> <p><code>c23</code>, <code>c13_2</code>, <code>c24_3</code>, <code>c14_23</code>: sampled copula parameters of the
unidentifiable copulas in the D-vine copula. The parameters correspond to
the parameterization of the <code>copula_family2</code> copula as in the <code>copula</code>
R-package.
</p>
</li>
<li> <p><code>r23</code>, <code>r13_2</code>, <code>r24_3</code>, <code>r14_23</code>: sampled rotation parameters of the
unidentifiable copulas in the D-vine copula. These values are constant for
the Gaussian copula family since that copula is invariant to rotations.
</p>
<p>The returned data frame also contains the following columns when
<code>get_marg_tau</code> is <code>TRUE</code>:
</p>
</li>
<li> <p><code>sp_s0s1</code>, <code>sp_s0t0</code>, <code>sp_s0t1</code>, <code>sp_s1t0</code>, <code>sp_s1t1</code>, <code>sp_t0t1</code>:
Spearman's <code class="reqn">\rho</code> between the corresponding potential outcomes. Note
that these associations refer to the potential time-to-composite events
and/or time-to-true endpoint event. In contrary, the estimated association
parameters from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code> refer to associations between the
time-to-surrogate event and time-to true endpoint event. Also note that
<code>sp_s1t1</code> is constant whereas <code>sp_s0t0</code> is not. This is a particularity of
the MC procedure to calculate both measures and thus not a bug.
</p>
</li>
<li> <p><code>prop_harmed</code>, <code>prop_protected</code>, <code>prop_always</code>, <code>prop_never</code>: proportions
of the corresponding population strata in each replication. These are
defined in Nevo and Gorfine (2022).
</p>
</li></ul>



<h3>Information-Theoretic Causal Inference Framework</h3>

<p>The information-theoretic causal inference (ITCI) is a general framework to
evaluate surrogate endpoints in the single-trial setting (Alonso et al.,
2015). In this framework, we focus on the individual causal effects,
<code class="reqn">\Delta S = S_1 - S_0</code> and <code class="reqn">\Delta T = T_1 - T_0</code> where <code class="reqn">S_z</code>
and <code class="reqn">T_z</code> are the potential surrogate end true endpoint under treatment
<code class="reqn">Z = z</code>.
</p>
<p>In the ITCI framework, we say that <code class="reqn">S</code> is a good surrogate for <code class="reqn">T</code>
if
<em><code class="reqn">\Delta S</code> conveys a substantial amount of information on <code class="reqn">\Delta T</code></em>
(Alonso, 2018). This amount of shared information can generally be quantified
by the mutual information between <code class="reqn">\Delta S</code> and <code class="reqn">\Delta T</code>,
denoted by <code class="reqn">I(\Delta S; \Delta T)</code>. However, the mutual information lies
in <code class="reqn">[0, + \infty]</code> which complicates the interpretation. In addition,
the mutual information may not be defined in specific scenarios where
absolute continuity of certain probability measures fails. Therefore, the
mutual information is transformed, and possibly modified, to enable a simple
interpretation in light of the definition of surrogacy. The resulting measure
is termed the individual causal association (ICA). This is explained in
the next sections.
</p>
<p>While the definition of surrogacy in the ITCI framework rests on information
theory, shared information is closely related to statistical association. Hence,
we can also define the ICA in terms of statistical association measures, like
Spearman's rho and Kendall's tau. The advantage of the latter are that they
are well-known, simple and rank-based measures of association.
</p>


<h3>Surrogacy in The Survival-Survival Setting</h3>



<h4>General Introduction</h4>

<p>Stijven et al. (2024) proposed to quantify the ICA through the squared
informational coefficient of correlation (SICC or <code class="reqn">R^2_H</code>), which is a
transformation of the mutaul information to the unit interval: </p>
<p style="text-align: center;"><code class="reqn">R^2_H =
1 - e^{-2 \cdot I(\Delta S; \Delta T)}</code>
</p>
<p> where 0 indicates independence, and 1
a functional relationship between <code class="reqn">\Delta S</code> and <code class="reqn">\Delta T</code>. The ICA
(or a modified version, see next) is returned by
<code><a href="#topic+sensitivity_analysis_SurvSurv_copula">sensitivity_analysis_SurvSurv_copula()</a></code>. Concurrently, the Spearman's
correlation between <code class="reqn">\Delta S</code> and <code class="reqn">\Delta T</code> is also returned.
</p>



<h4>Issues with Composite Endpoints</h4>

<p>In the survival-survival setting where the surrogate is a composite endpoint,
care should be taken when defining the mutual information. Indeed, when
<code class="reqn">S_z</code> is progression-free survival and <code class="reqn">T_z</code> is overall survival,
there is a probability atom in the joint distribution of <code class="reqn">(S_z, T_z)'</code>
because <code class="reqn">P(S_z = T_z) &gt; 0</code>. In other words, there are patient that die
before progressing. While this probability atom is correctly taken into
account in the models fitted by <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>, this probability atom
reappears when considering the distribution of <code class="reqn">(\Delta S, \Delta T)'</code>
because <code class="reqn">P(\Delta S = \Delta T) &gt; 0</code> if we are considering PFS and OS.
</p>
<p>Because of the atom in the distribution of <code class="reqn">(\Delta S, \Delta T)'</code>, the
corresponding mutual information is not defined. To solve this, the mutual
information is computed excluding the patients for which <code class="reqn">\Delta S =
\Delta T</code> when <code>composite = TRUE</code>. The proportion of excluded patients is, among
other things, returned when <code>marginal_association = TRUE</code>. This is the proportion
of &quot;never&quot; patients following the classification of Nevo and Gorfine (2022).
See also Additional Assumptions.
</p>
<p>This modified version of the ICA quantifies the surrogacy of <code class="reqn">S</code> when
&quot;adjusted for the composite nature of <code class="reqn">S</code>&quot;. Indeed, we exclude patients
where <code class="reqn">\Delta S</code> perfectly predicts <code class="reqn">\Delta T</code> *just because <code class="reqn">S</code>
is a composite of <code class="reqn">T</code> (and other variables).
</p>
<p>Other (rank-based) statistical measures of association, however,
remain well-defined and are thus computed without excluding any patients.
</p>



<h3>Sensitivity Analysis</h3>



<h4>Monte Carlo Approach</h4>

<p>Because <code class="reqn">S_0</code> and <code class="reqn">S_1</code> are never simultaneously observed in the same
patient, <code class="reqn">\Delta S</code> is not observable, and analogously for <code class="reqn">\Delta
T</code>. Consequently, the ICA is unidentifiable. This is solved by considering a
(partly identifiable) model for the full vector of potential outcomes,
<code class="reqn">(T_0, S_0, S_1, T_1)'</code>. The identifiable parameters are estimated. The
unidentifiable parameters are sampled from their parameters space in each
replication of a sensitivity analysis. If the number of replications
(<code>n_sim</code>) is sufficiently large, the entire parameter space for the
unidentifiable parameters will be explored/sampled. In each replication, all
model parameters are &quot;known&quot; (either estimated or sampled). Consequently, the
ICA can be computed in each replication of the sensitivity analysis.
</p>
<p>The sensitivity analysis thus results in a set of values for the ICA. This
set can be interpreted as <em>all values for the ICA that are compatible with
the observed data</em>. However, the range of this set is often quite broad; this
means there remains too much uncertainty to make judgements regarding the
worth of the surrogate. To address this unwieldy uncertainty, additional
assumptions can be used that restrict the parameter space of the
unidentifiable parameters. This in turn reduces the uncertainty regarding the
ICA.
</p>



<h4>Intervals of Ignorance and Uncertainty</h4>

<p>The results of the sensitivity analysis can be formalized (and summarized) in
intervals of ignorance and uncertainty using <code><a href="#topic+sensitivity_intervals_Dvine">sensitivity_intervals_Dvine()</a></code>.
</p>



<h3>Additional Assumptions</h3>

<p>There are two possible types of assumptions that restrict the parameter space
of the unidentifiable parameters: (i) <em>equality</em> type of assumptions, and
(ii) <em>inequality</em> type of assumptions. These are discussed in turn in the
next two paragraphs.
</p>
<p>The equality assumptions have to be incorporated into the sensitivity
analysis itself. Only one type of equality assumption has been implemented;
this is the conditional independence assumption:
</p>
<p style="text-align: center;"><code class="reqn">\tilde{S}_0 \perp T_1 | \tilde{S}_1 \; \text{and} \;
\tilde{S}_1 \perp T_0 | \tilde{S}_0 .</code>
</p>
<p> This can informally be
interpreted as &ldquo;what the control treatment does to the surrogate does not
provide information on the true endpoint under experimental treatment if we
already know what the experimental treatment does to the surrogate&quot;, and
analogously when control and experimental treatment are interchanged. Note
that <code class="reqn">\tilde{S}_z</code> refers to either the actual potential surrogate
outcome, or a latent version. This depends on the content of <code>fitted_model</code>.
</p>
<p>The inequality type of assumptions have to be imposed on the data frame that
is returned by the current function; those assumptions are thus imposed
<em>after</em> running the sensitivity analysis. If <code>marginal_association</code> is set to
<code>TRUE</code>, the returned data frame contains additional unverifiable quantities
that differ across replications of the sensitivity analysis: (i) the
unconditional Spearman's <code class="reqn">\rho</code> for all pairs of (observable/non-latent)
potential outcomes, and (ii) the proportions of the population strata as
defined by Nevo and Gorfine (2022) if semi-competing risks are present. More
details on the interpretation and use of these assumptions can be found in
Stijven et al. (2024).
</p>


<h3>References</h3>

<p>Alonso, A. (2018). An information-theoretic approach for the evaluation of
surrogate endpoints. In Wiley StatsRef: Statistics Reference Online. John
Wiley &amp; Sons, Ltd.
</p>
<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., and Burzykowski, T.
(2015). On the relationship between the causal-inference and meta-analytic
paradigms for the validation of surrogate endpoints. Biometrics 71, 1524.
</p>
<p>Stijven, F., Alonso, a., Molenberghs, G., Van Der Elst, W., Van Keilegom, I.
(2024). An information-theoretic approach to the evaluation of time-to-event
surrogates for time-to-event true endpoints based on causal inference.
</p>
<p>Nevo, D., &amp; Gorfine, M. (2022). Causal inference for semi-competing risks
data. Biostatistics, 23 (4), 1115-1132
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Illustration with small number of replications and low precision
sens_results = sensitivity_analysis_SurvSurv_copula(fitted_model,
                  n_sim = 5,
                  n_prec = 2000,
                  copula_family2 = "clayton",
                  eq_cond_association = TRUE)
# Compute intervals of ignorance and uncertainty. Again, the number of
# bootstrap replications should be larger in practice.
sensitivity_intervals_Dvine(fitted_model, sens_results, B = 10)

</code></pre>

<hr>
<h2 id='sensitivity_intervals_Dvine'>Compute Sensitivity Intervals</h2><span id='topic+sensitivity_intervals_Dvine'></span>

<h3>Description</h3>

<p><code><a href="#topic+sensitivity_intervals_Dvine">sensitivity_intervals_Dvine()</a></code> computes the estimated intervals of ignorance
and uncertainty within the information-theoretic causal inference framework
when the data are modeled with a D-vine copula model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity_intervals_Dvine(
  fitted_model,
  sens_results,
  measure = "ICA",
  B = 200,
  alpha = 0.05,
  n_prec = 5000,
  mutinfo_estimator = NULL,
  restr_time = +Inf,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_sens_results">sens_results</code></td>
<td>
<p>Dataframe returned by
<code><a href="#topic+sensitivity_analysis_SurvSurv_copula">sensitivity_analysis_SurvSurv_copula()</a></code>. If additional assumptions need to
be incorporated, this dataframe can first be filtered.</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_measure">measure</code></td>
<td>
<p>Compute intervals for which measure of surrogacy? Defaults to
<code>"ICA"</code>. See first column names of <code>sens_results</code> for other possibilities.</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_b">B</code></td>
<td>
<p>Number of bootstrap replications</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_alpha">alpha</code></td>
<td>
<p>(numeric) <code>1 - alpha</code> is the level of the confidence interval</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte-Carlo samples for the <em>numerical approximation</em>
of the ICA in each replication of the sensitivity analysis.</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
<tr><td><code id="sensitivity_intervals_Dvine_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used in the sensitivity analysis. The
computations are computationally heavy, and this option can speed things up
considerably.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 object of the class <code>sensitivity_intervals_Dvine</code> which can be
printed.
</p>


<h3>Intervals of Ignorance and Uncertainty</h3>

<p>Vansteelandt et al. (2006) formalized sensitivity analysis for partly
identifiable parameters in the context of missing data and MNAR. These
concepts can be applied to the estimation of the ICA. Indeed, the ICA is also
partly identifiable because 50% if the potential outcomes are missing.
</p>
<p>Vansteelandt et al. (2006) replace a point estimate with a interval estimate:
the estimated interval of ignorance. In addition, they proposed several
extension of the classic confidence interval together with appropriate
definitions of coverage; these are termed intervals of uncertainty.
</p>
<p><code><a href="#topic+sensitivity_intervals_Dvine">sensitivity_intervals_Dvine()</a></code> implements the estimated interval of
ignorance and the pointwise and strong intervals of uncertainty. Let <code class="reqn">\boldsymbol{\nu}_l</code>
and <code class="reqn">\boldsymbol{\nu}_u</code> be the values for the sensitivity parameter that
lead to the lowest and largest ICA, respectively, while fixing the identifiable
parameter at its estimated value <code class="reqn">\hat{\boldsymbol{\beta}}</code>. See also
<code><a href="#topic+summary_level_bootstrap_ICA">summary_level_bootstrap_ICA()</a></code>. The following intervals are implemented:
</p>

<ol>
<li> <p><em>Estimated interval of ignorance</em>. This interval is defined as
<code class="reqn">[ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}_l), ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}_u)]</code>.
</p>
</li>
<li> <p><em>Pointiwse interval of uncertainty</em>. Let <code class="reqn">C_l</code> (and <code class="reqn">C_u</code>) be the
lower (and upper) limit of a one-sided <code class="reqn">1 - \alpha</code> CI for
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code> (and
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code>). This interval is then
defined as <code class="reqn">[C_l, C_u]</code> when the ignorance is much larger than the
statistical imprecision.
</p>
</li>
<li> <p><em>Strong interval of uncertainty</em>. Let <code class="reqn">C_l</code> (and <code class="reqn">C_u</code>) be the
lower (and upper) limit of a two-sided <code class="reqn">1 - \alpha</code> CI for
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code> (and
<code class="reqn">ICA(\boldsymbol{\beta_0}, \boldsymbol{\nu}_l)</code>). This interval is then
defined as <code class="reqn">[C_l, C_u]</code>.
</p>
</li></ol>

<p>The CIs, which are need for the intervals of uncertainty, are based on
percentile bootstrap confidence intervals, as documented in
<code><a href="#topic+summary_level_bootstrap_ICA">summary_level_bootstrap_ICA()</a></code>. In addition, <code class="reqn">\boldsymbol{\nu}_l</code> is not
known. Therefore, it is estimated as
</p>
<p style="text-align: center;"><code class="reqn">\arg \min_{\boldsymbol{\nu} \in \Gamma} ICA(\hat{\boldsymbol{\beta}}, \boldsymbol{\nu}),</code>
</p>

<p>and similarly for <code class="reqn">\boldsymbol{\nu}_u</code>.
</p>


<h3>References</h3>

<p>Vansteelandt, Stijn, et al. &quot;Ignorance and uncertainty regions as inferential
tools in a sensitivity analysis.&quot; Statistica Sinica (2006): 953-979.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load Ovarian data
data("Ovarian")
# Recode the Ovarian data in the semi-competing risks format.
data_scr = data.frame(
  ttp = Ovarian$Pfs,
  os = Ovarian$Surv,
  treat = Ovarian$Treat,
  ttp_ind = ifelse(
    Ovarian$Pfs == Ovarian$Surv &amp;
      Ovarian$SurvInd == 1,
    0,
    Ovarian$PfsInd
  ),
  os_ind = Ovarian$SurvInd
)
# Fit copula model.
fitted_model = fit_model_SurvSurv(data = data_scr,
                                  copula_family = "clayton",
                                  n_knots = 1)
# Illustration with small number of replications and low precision
sens_results = sensitivity_analysis_SurvSurv_copula(fitted_model,
                  n_sim = 5,
                  n_prec = 2000,
                  copula_family2 = "clayton",
                  eq_cond_association = TRUE)
# Compute intervals of ignorance and uncertainty. Again, the number of
# bootstrap replications should be larger in practice.
sensitivity_intervals_Dvine(fitted_model, sens_results, B = 10)

</code></pre>

<hr>
<h2 id='Sim.Data.Counterfactuals'>Simulate a dataset that contains counterfactuals</h2><span id='topic+Sim.Data.Counterfactuals'></span>

<h3>Description</h3>

<p>The function <code>Sim.Data.Counterfactuals</code> simulates a dataset that contains four (continuous) counterfactuals (i.e., potential outcomes) and a (binary) treatment indicator. The counterfactuals <code class="reqn">T_0</code> and <code class="reqn">T_1</code> denote the true endpoints of a patient under the control and the experimental treatments, respectively, and the counterfactuals <code class="reqn">S_0</code> and <code class="reqn">S_1</code> denote the surrogate endpoints of the patient under the control and the experimental treatments, respectively. The user can specify the number of patients, the desired mean values for the counterfactuals (i.e., <code class="reqn">\bold{\mu}_c</code>), and the desired correlations between the counterfactuals (i.e., the off-diagonal values in the standardized <code class="reqn">\bold{\Sigma}_c</code> matrix). For details, see the papers of Alonso et al. (submitted) and Van der Elst et al. (submitted).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.Data.Counterfactuals(N.Total=2000, 
mu_c=c(0, 0, 0, 0), T0S0=0, T1S1=0, T0T1=0, T0S1=0, 
T1S0=0, S0S1=0, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_n.total">N.Total</code></td>
<td>
<p>The total number of patients in the simulated dataset. Default <code class="reqn">2000</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_mu_c">mu_c</code></td>
<td>
<p>A vector that specifies the desired means for the counterfactuals <code class="reqn">S_0</code>, <code class="reqn">S_1</code>, <code class="reqn">T_0</code>, and <code class="reqn">T_1</code>, respectively. Default <code>c(0, 0, 0, 0)</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_t0s0">T0S0</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T0 and S0 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_t1s1">T1S1</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T1 and S1 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T0 and T1 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T0 and S1 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T1 and S0 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar that specifies the desired correlation between the counterfactuals T0 and T1 that should be used in the generation of the data. Default <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.Counterfactuals_+3A_seed">Seed</code></td>
<td>
<p>A seed that is used to generate the dataset. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated object <code>Data.Counterfactuals</code> (of class <code>data.frame</code>) is placed in the workspace.
</p>
<p>The specified values for T0S0, T1S1, T0T1, T0S1, T1S0, and S0S1 in the function call should form a matrix that is positive definite (i.e., they should form a valid correlation matrix). When the user specifies values that form a matrix that is not positive definite, an error message is given and the object  <code>Data.Counterfactuals</code> is not generated. The function <code><a href="#topic+Pos.Def.Matrices">Pos.Def.Matrices</a></code> can be used to examine beforehand whether a <code class="reqn">4</code> by <code class="reqn">4</code> matrix is positive definite. 
</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., Buyse, M., &amp; Burzykowski, T. (submitted). On the relationship between the causal inference and meta-analytic paradigms for the validation of surrogate markers. 
</p>
<p>Van der Elst, W., Alonso, A., &amp; Molenberghs, G. (submitted). An exploration of the relationship between causal inference and meta-analytic measures of surrogacy. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.Data.MTS">Sim.Data.MTS</a></code>, <code><a href="#topic+Sim.Data.STS">Sim.Data.STS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate a dataset with 2000 patients, cor(S0,T0)=cor(S1,T1)=.5, 
## cor(T0,T1)=cor(T0,S1)=cor(T1,S0)=cor(S0,S1)=0, with means 
## 5, 9, 12, and 15 for S0, S1, T0, and T1, respectively:
Sim.Data.Counterfactuals(N=2000, T0S0=.5, T1S1=.5, T0T1=0, T0S1=0, T1S0=0, S0S1=0, 
mu_c=c(5, 9, 12, 15), Seed=1)
</code></pre>

<hr>
<h2 id='Sim.Data.CounterfactualsBinBin'>Simulate a dataset that contains counterfactuals for binary endpoints</h2><span id='topic+Sim.Data.CounterfactualsBinBin'></span>

<h3>Description</h3>

<p>The function <code>Sim.Data.CounterfactualsBinBin</code> simulates a dataset that contains four (binary) counterfactuals (i.e., potential outcomes) and a (binary) treatment indicator. The counterfactuals <code class="reqn">T_0</code> and <code class="reqn">T_1</code> denote the true endpoints of a patient under the control and the experimental treatments, respectively, and the counterfactuals <code class="reqn">S_0</code> and <code class="reqn">S_1</code> denote the surrogate endpoints of the patient under the control and the experimental treatments, respectively. The user can specify the number of patients and the desired probabilities of the vector of potential outcomes (i.e., <code class="reqn">\bold{{Y'}_c}</code>=(T_0, T_1, S_0, S_1)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.Data.CounterfactualsBinBin(Pi_s=rep(1/16, 16), 
N.Total=2000, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.Data.CounterfactualsBinBin_+3A_pi_s">Pi_s</code></td>
<td>
<p>The vector of probabilities of the potential outcomes, i.e., <code class="reqn">pi_{0000}</code>, <code class="reqn">pi_{0100}</code>, <code class="reqn">pi_{0010}</code>, <code class="reqn">pi_{0001}</code>, <code class="reqn">pi_{0101}</code>, <code class="reqn">pi_{1000}</code>, <code class="reqn">pi_{1010}</code>, <code class="reqn">pi_{1001}</code>, <code class="reqn">pi_{1110}</code>, <code class="reqn">pi_{1101}</code>, <code class="reqn">pi_{1011}</code>, <code class="reqn">pi_{1111}</code>, <code class="reqn">pi_{0110}</code>, <code class="reqn">pi_{0011}</code>, <code class="reqn">pi_{0111}</code>, <code class="reqn">pi_{1100}</code>. Default <code>rep(1/16, 16)</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.CounterfactualsBinBin_+3A_n.total">N.Total</code></td>
<td>
<p>The desired number of patients in the simulated dataset. Default <code class="reqn">2000</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.CounterfactualsBinBin_+3A_seed">Seed</code></td>
<td>
<p>A seed that is used to generate the dataset. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated object <code>Data.STSBinBin.Counter</code> (which contains the counterfactuals) and <code>Data.STSBinBin.Obs</code> (the &quot;observable data&quot;) (of class <code>data.frame</code>) is placed in the workspace.
</p>


<h3>Value</h3>

<p>An object of class <code>Sim.Data.CounterfactualsBinBin</code> with components,
</p>
<table>
<tr><td><code>Data.STSBinBin.Obs</code></td>
<td>
<p>The generated dataset that contains the &quot;observed&quot; surrogate endrpoint, true endpoint, and assigned treatment.</p>
</td></tr>
<tr><td><code>Data.STSBinBin.Counter</code></td>
<td>
<p>The generated dataset that contains the counterfactuals.</p>
</td></tr>
<tr><td><code>Vector_Pi</code></td>
<td>
<p>The vector of probabilities of the potential outcomes, i.e., <code class="reqn">pi_{0000}</code>, <code class="reqn">pi_{0100}</code>, <code class="reqn">pi_{0010}</code>, <code class="reqn">pi_{0001}</code>, <code class="reqn">pi_{0101}</code>, <code class="reqn">pi_{1000}</code>, <code class="reqn">pi_{1010}</code>, <code class="reqn">pi_{1001}</code>, <code class="reqn">pi_{1110}</code>, <code class="reqn">pi_{1101}</code>, <code class="reqn">pi_{1011}</code>, <code class="reqn">pi_{1111}</code>, <code class="reqn">pi_{0110}</code>, <code class="reqn">pi_{0011}</code>, <code class="reqn">pi_{0111}</code>, <code class="reqn">pi_{1100}</code>.</p>
</td></tr>
<tr><td><code>Pi_Marginals</code></td>
<td>
<p>The vector of marginal probabilities <code class="reqn">\pi_{1 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{0 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{1 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{0 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 0}</code>, <code class="reqn">\pi_{\cdot 0 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 0 \cdot 0}</code>.</p>
</td></tr>
<tr><td><code>True.R2_H</code></td>
<td>
<p>The true <code class="reqn">R_H^2</code> value.</p>
</td></tr>
<tr><td><code>True.Theta_T</code></td>
<td>
<p>The true odds ratio for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>True.Theta_S</code></td>
<td>
<p>The true odds ratio for <code class="reqn">S</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate a dataset with 2000 patients, and values 1/16
## for all proabilities between the counterfactuals:
Sim.Data.CounterfactualsBinBin(N.Total=2000)
</code></pre>

<hr>
<h2 id='Sim.Data.MTS'>Simulates a dataset that can be used to assess surrogacy in the multiple-trial setting</h2><span id='topic+Sim.Data.MTS'></span>

<h3>Description</h3>

<p>The function <code>Sim.Data.MTS</code> simulates a dataset that contains the variables Treat, Trial.ID, Surr, True, and Pat.ID. The user can specify the number of patients and the number of trials that should be included in the simulated dataset, the desired <code class="reqn">R_{trial}</code> and <code class="reqn">R_{indiv}</code> values, the desired variability of the trial-specific treatment effects for the surrogate and the true endpoints (i.e., <code class="reqn">d_{aa}</code> and <code class="reqn">d_{bb}</code>, respectively), and the desired fixed-effect parameters of the intercepts and treatment effects for the surrogate and the true endpoints. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.Data.MTS(N.Total=2000, N.Trial=50, R.Trial.Target=.8, R.Indiv.Target=.8, 
Fixed.Effects=c(0, 0, 0, 0), D.aa=10, D.bb=10, Seed=sample(1:1000, size=1), 
Model=c("Full"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.Data.MTS_+3A_n.total">N.Total</code></td>
<td>
<p>The total number of patients in the simulated dataset. Default <code class="reqn">2000</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_n.trial">N.Trial</code></td>
<td>
<p>The number of trials. Default <code class="reqn">50</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_r.trial.target">R.Trial.Target</code></td>
<td>
<p>The desired <code class="reqn">R_{trial}</code> value in the sumilated dataset. Default <code class="reqn">0.80</code></p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_r.indiv.target">R.Indiv.Target</code></td>
<td>
<p>The desired <code class="reqn">R_{indiv}</code> value in the simulated dataset. Default <code class="reqn">0.80</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_fixed.effects">Fixed.Effects</code></td>
<td>
<p>A vector that specifies the desired fixed-effect intercept for the surrogate, fixed-effect intercept for the true endpoint, fixed treatment effect for the surrogate, and fixed treatment effect for the true endpoint, respectively. Default <code>c(0, 0, 0, 0)</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_d.aa">D.aa</code></td>
<td>
<p>The desired variability of the trial-specific treatment effects on the surrogate endpoint. Default <code class="reqn">10</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_d.bb">D.bb</code></td>
<td>
<p>The desired variability of the trial-specific treatment effects on the true endpoint. Default <code class="reqn">10</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_model">Model</code></td>
<td>
<p>The type of model that will be fitted on the data when surrogacy is assessed, i.e., a full, semireduced, or reduced model (for details, see <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).</p>
</td></tr>
<tr><td><code id="Sim.Data.MTS_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used to generate the dataset. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated object <code>Data.Observed.MTS</code> (of class <code>data.frame</code>) is placed in the workspace (for easy access).
</p>
<p>The number of patients per trial in the simulated dataset is identical in each trial, and equals the requested total number of patients divided by the requested number of trials (=<code>N.Total/N.Trial</code>). If this is not a whole number, a warning is given and the number of patients per trial is automatically rounded up to the nearest whole number. See <b>Examples</b> below.
</p>
<p>Treatment allocation is balanced when the number of patients per trial is an odd number. If this is not the case, treatment allocation is balanced up to one patient (the remaining patient is randomly allocated to the exprimental or the control treatment groups in each of the trials).     
</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+Sim.Data.STS">Sim.Data.STS</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a dataset with 2000 patients, 50 trials, Rindiv=Rtrial=.8, D.aa=10,
# D.bb=50, and fixed effect values 1, 2, 30, and 90:
Sim.Data.MTS(N.Total=2000, N.Trial=50, R.Trial.Target=.8, R.Indiv.Target=.8, D.aa=10, 
D.bb=50, Fixed.Effects=c(1, 2, 30, 90), Seed=1)  

# Sample output, the first 10 rows of Data.Observed.MTS:
Data.Observed.MTS[1:10,]

# Note: When the following code is used to generate a dataset:
Sim.Data.MTS(N.Total=2000, N.Trial=99, R.Trial.Target=.5, R.Indiv.Target=.8, 
D.aa=10, D.bb=50, Fixed.Effects=c(1, 2, 30, 90), Seed=1)  

# R gives the following warning: 

# &gt; NOTE: The number of patients per trial requested in the function call 
# &gt; equals 20.20202 (=N.Total/N.Trial), which is not a whole number.  
# &gt; To obtain a dataset where the number of patients per trial is balanced for 
# &gt; all trials, the number of patients per trial was rounded to 21 to generate 
# &gt; the dataset. Data.Observed.MTS thus contains a total of 2079 patients rather 
# &gt; than the requested 2000 in the function call.
</code></pre>

<hr>
<h2 id='Sim.Data.STS'>Simulates a dataset that can be used to assess surrogacy in the single-trial setting</h2><span id='topic+Sim.Data.STS'></span>

<h3>Description</h3>

<p>The function <code>Sim.Data.STS</code> simulates a dataset that contains the variables Treat, Surr, True, and Pat.ID. The user can specify the total number of patients, the desired <code class="reqn">R_{indiv}</code> value (also referred to as the adjusted association (<code class="reqn">\gamma</code>) in the single-trial meta-analytic setting), and the desired means of the surrogate and the true endpoints in the experimental and control treatment groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.Data.STS(N.Total=2000, R.Indiv.Target=.8, Means=c(0, 0, 0, 0), Seed=
sample(1:1000, size=1))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.Data.STS_+3A_n.total">N.Total</code></td>
<td>
<p>The total number of patients in the simulated dataset. Default <code class="reqn">2000</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.STS_+3A_r.indiv.target">R.Indiv.Target</code></td>
<td>
<p>The desired <code class="reqn">R_{indiv}</code> (or <code class="reqn">\gamma</code>) value in the simulated dataset. Default <code class="reqn">0.80</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.STS_+3A_means">Means</code></td>
<td>
<p>A vector that specifies the desired mean for the surrogate in the control treatment group, mean for the surrogate in the experimental treatment group, mean for the true endpoint in the control treatment group, and mean for the true endpoint in the experimental treatment group, respectively. Default <code>c(0, 0, 0, 0)</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.STS_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used to generate the dataset. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated object <code>Data.Observed.STS</code> (of class <code>data.frame</code>) is placed in the workspace (for easy access).</p>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Sim.Data.MTS">Sim.Data.MTS</a></code>, <code><a href="#topic+Single.Trial.RE.AA">Single.Trial.RE.AA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a dataset: 
Sim.Data.STS(N.Total=2000, R.Indiv.Target=.8, Means=c(1, 5, 20, 37), Seed=1) 
</code></pre>

<hr>
<h2 id='Sim.Data.STSBinBin'>Simulates a dataset that can be used to assess surrogacy in the single trial setting when S and T are binary endpoints</h2><span id='topic+Sim.Data.STSBinBin'></span>

<h3>Description</h3>

<p>The function <code>Sim.Data.STSBinBin</code> simulates a dataset that contains four (binary) counterfactuals (i.e., potential outcomes) and a (binary) treatment indicator. The counterfactuals <code class="reqn">T_0</code> and <code class="reqn">T_1</code> denote the true endpoints of a patient under the control and the experimental treatments, respectively, and the counterfactuals <code class="reqn">S_0</code> and <code class="reqn">S_1</code> denote the surrogate endpoints of the patient under the control and the experimental treatments, respectively. 
In addition, the function provides the &quot;observable&quot; data based on the dataset of the counterfactuals, i.e., the <code class="reqn">S</code> and <code class="reqn">T</code> endpoints given the treatment that was allocated to a patient. 
The user can specify the assumption regarding monotonicity that should be made to generate the data (no monotonicity, monotonicity for <code class="reqn">S</code> alone, monotonicity for <code class="reqn">T</code> alone, or monotonicity for both <code class="reqn">S</code> and <code class="reqn">T</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sim.Data.STSBinBin(Monotonicity=c("No"), N.Total=2000, Seed)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Sim.Data.STSBinBin_+3A_monotonicity">Monotonicity</code></td>
<td>
<p>The assumption regarding monotonicity that should be made when the data are generated, i.e., <code>Monotonicity="No"</code> (no monotonicity assumed), <code>Monotonicity="True.Endp"</code> (monotonicity assumed for the true endpoint alone), <code>Monotonicity="Surr.Endp"</code> (monotonicity assumed for the surrogate endpoint alone), and <code>Monotonicity="Surr.True.Endp"</code> (monotonicity assumed for both endpoints). Default <code>Monotonicity="No"</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.STSBinBin_+3A_n.total">N.Total</code></td>
<td>
<p>The desired number of patients in the simulated dataset. Default <code class="reqn">2000</code>.</p>
</td></tr>
<tr><td><code id="Sim.Data.STSBinBin_+3A_seed">Seed</code></td>
<td>
<p>A seed that is used to generate the dataset. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The generated objects <code>Data.STSBinBin_Counterfactuals</code> (which contains the counterfactuals) and  <code>Data.STSBinBin_Obs</code> (which contains the observable data) of class <code>data.frame</code> are placed in the workspace. Other relevant output can be accessed based on the fitted object (see <code class="reqn">Value</code> below) 
</p>


<h3>Value</h3>

<p>An object of class <code>Sim.Data.STSBinBin</code> with components,
</p>
<table>
<tr><td><code>Data.STSBinBin.Obs</code></td>
<td>
<p>The generated dataset that contains the &quot;observed&quot; surrogate endrpoint, true endpoint, and assigned treatment.</p>
</td></tr>
<tr><td><code>Data.STSBinBin.Counter</code></td>
<td>
<p>The generated dataset that contains the counterfactuals.</p>
</td></tr>
<tr><td><code>Vector_Pi</code></td>
<td>
<p>The vector of probabilities of the potential outcomes, i.e., <code class="reqn">pi_{0000}</code>, <code class="reqn">pi_{0100}</code>, <code class="reqn">pi_{0010}</code>, <code class="reqn">pi_{0001}</code>, <code class="reqn">pi_{0101}</code>, <code class="reqn">pi_{1000}</code>, <code class="reqn">pi_{1010}</code>, <code class="reqn">pi_{1001}</code>, <code class="reqn">pi_{1110}</code>, <code class="reqn">pi_{1101}</code>, <code class="reqn">pi_{1011}</code>, <code class="reqn">pi_{1111}</code>, <code class="reqn">pi_{0110}</code>, <code class="reqn">pi_{0011}</code>, <code class="reqn">pi_{0111}</code>, <code class="reqn">pi_{1100}</code>.</p>
</td></tr>
<tr><td><code>Pi_Marginals</code></td>
<td>
<p>The vector of marginal probabilities <code class="reqn">\pi_{1 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{0 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{1 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{0 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 0}</code>, <code class="reqn">\pi_{\cdot 0 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 0 \cdot 0}</code>.</p>
</td></tr>
<tr><td><code>True.R2_H</code></td>
<td>
<p>The true <code class="reqn">R_H^2</code> value.</p>
</td></tr>
<tr><td><code>True.Theta_T</code></td>
<td>
<p>The true odds ratio for <code class="reqn">T</code>.</p>
</td></tr>
<tr><td><code>True.Theta_S</code></td>
<td>
<p>The true odds ratio for <code class="reqn">S</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Generate a dataset with 2000 patients, 
## assuming no monotonicity:
Sim.Data.STSBinBin(Monotonicity=c("No"), N.Total=200)
</code></pre>

<hr>
<h2 id='Single.Trial.RE.AA'>Conducts a surrogacy analysis based on the single-trial meta-analytic framework</h2><span id='topic+Single.Trial.RE.AA'></span><span id='topic+plot.Single.Trial.RE.AA'></span>

<h3>Description</h3>

<p>The function <code>Single.Trial.RE.AA</code> conducts a surrogacy analysis based on the single-trial meta-analytic framework of Buyse &amp; Molenberghs (1998). See <b>Details</b> below. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Single.Trial.RE.AA(Dataset, Surr, True, Treat, Pat.ID, Alpha=.05, 
Number.Bootstraps=500, Seed=sample(1:1000, size=1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Single.Trial.RE.AA_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, and a patient ID.</p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate values.</p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. The <code class="reqn">-1/1</code> coding is recommended. </p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around Alpha (which is a parameter estimate of a model where the surrogate is regressed on the treatment indicator, see <b>Details</b> below), Beta, RE, and <code class="reqn">\gamma</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>  
<tr><td><code id="Single.Trial.RE.AA_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The number of bootstrap samples that are used to obtain the bootstrapp-based confidence intervals for RE and the adjusted association (<code class="reqn">\gamma</code>). Default <code class="reqn">500</code>.</p>
</td></tr>
<tr><td><code id="Single.Trial.RE.AA_+3A_seed">Seed</code></td>
<td>
<p>The seed that is used to generate the bootstrap samples. Default <code>sample(x=1:1000, size=1)</code>, i.e., a random number between 1 and 1000.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Relative Effect (RE) and the adjusted association (<code class="reqn">\gamma</code>) are based on the following bivariate regression model (when the surrogate and the true endpoints are continuous variables):
</p>
<p style="text-align: center;"><code class="reqn">S_{j}=\mu_{S}+\alpha Z_{j}+\varepsilon_{Sj},</code>
</p>
 
<p style="text-align: center;"><code class="reqn">T_{j}=\mu_{T}+\beta Z_{j}+\varepsilon_{Tj},</code>
</p>
 
<p>where the error terms have a joint zero-mean normal distribution with variance-covariance matrix:
</p>
<p style="text-align: center;"><code class="reqn">\boldsymbol{\Sigma}=\left(\begin{array}{cc}
\sigma_{SS}\\
\sigma_{ST} &amp; \sigma_{TT}
\end{array}\right),</code>
</p>

<p>and where <code class="reqn">j</code> is the subject indicator, <code class="reqn">S_{j}</code> and <code class="reqn">T_{j}</code> are the surrogate and true endpoint values of patient <code class="reqn">j</code>, and <code class="reqn">Z_{j}</code> is the treatment indicator for patient <code class="reqn">j</code>. 
</p>
<p>The parameter estimates of the fitted regression model and the variance-covariance matrix of the residuals are used to compute RE and the adjusted association (<code class="reqn">\gamma</code>), respectively:
</p>
<p style="text-align: center;"><code class="reqn">RE=\frac{\beta}{\alpha},</code>
</p>

<p style="text-align: center;"><code class="reqn">\gamma=\frac{\sigma_{ST}}{\sqrt{\sigma_{SS}\sigma_{TT}}}.</code>
</p>

<p><b>Note</b>
</p>
<p>The single-trial meta-analytic framework is hampered by a number of issues (Burzykowski et al., 2005). For example, a key motivation to validate a surrogate endpoint is to be able to predict the effect of Z on T as based on the effect of Z on S in a new clinical trial where T is not (yet) observed. The RE allows for such a prediction, but this requires the assumption that the relation between <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> can be described by a linear regression model that goes through the origin. In other words, it has to be assumed that the RE remains constant across clinical trials. The constant RE assumption is unverifiable in a single-trial setting, but a way out of this problem is to combine the information of multiple clinical trials and generalize the RE concept to a multiple-trial setting (as is done in the multiple-trial meta-analytic approach, see <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, and <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).  
</p>


<h3>Value</h3>

<p>An object of class <code>Single.Trial.RE.AA</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Alpha</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the parameter estimate for <code class="reqn">\alpha</code>, its standard error, and its confidence interval. Note that <code>Alpha</code> is not to be confused with the <code>Alpha</code> argument in the function call, which specifies the <code class="reqn">\alpha</code>-level of the confidence intervals of the parameters. </p>
</td></tr>
<tr><td><code>Beta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the parameter estimate for <code class="reqn">\beta</code>, its standard error, and its confidence interval.</p>
</td></tr>
<tr><td><code>RE.Delta</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on the Delta method).</p>
</td></tr>
<tr><td><code>RE.Fieller</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on Fieller's theorem).</p>
</td></tr>
<tr><td><code>RE.Boot</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the estimated RE, its standard error, and its confidence interval (based on bootstrapping). Note that the occurence of outliers in the sample of bootstrapped RE values may lead to standard errors and/or confidence intervals that are not trustworthy. Such problems mainly occur when the parameter estimate for <code class="reqn">\alpha</code> is close to 0 (taking its standard error into account). To detect possible outliers, studentized deleted residuals are computed (by fitting an intercept-only model with the bootstrapped RE values as the outcome variable). Bootstrapped RE values with an absolute studentized residual larger than <code class="reqn">t(1-\alpha/2n;n-2)</code> are marked as outliers (where n = the number of bootstrapped RE values; Kutner et al., 2005). A warning is given when outliers are found, and the position of the outlier(s) in the bootstrap sample is identified. Inspection of the vector of bootstrapped RE values (see <code>RE.Boot.Samples</code> below) is recommended in this situation, and/or the use of the confidence intervals that are based on the Delta method or Fieller's theorem (rather than the bootstrap-based confidence interval).</p>
</td></tr>
<tr><td><code>AA</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the adjusted association (i.e., <code class="reqn">\gamma</code>), its standard error, and its confidence interval (based on the Fisher-Z transformation procedure).</p>
</td></tr>
<tr><td><code>AA.Boot</code></td>
<td>
<p>An object of class <code>data.frame</code> that contains the adjusted association (i.e., <code class="reqn">\gamma</code>), its standard error, and its confidence interval (based on a bootstrap procedure).</p>
</td></tr>
<tr><td><code>RE.Boot.Samples</code></td>
<td>
<p>A vector that contains the RE values that were generated during the bootstrap procedure.</p>
</td></tr>
<tr><td><code>AA.Boot.Samples</code></td>
<td>
<p>A vector that contains the adjusted association (i.e., <code class="reqn">\gamma</code>) values that were generated during the bootstrap procedure.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0T1}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>Residuals</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained when the surrogate and the true endpoint are regressed on the treatment indicator.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., &amp; Molenberghs, G. (1998). The validation of surrogate endpoints in randomized experiments. <em>Biometrics, 54,</em> 1014-1029.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Kutner, M. H., Nachtsheim, C. J., Neter, J., &amp; Li, W. (2005). <em>Applied linear statistical models (5th ed.)</em>. New York: McGraw Hill.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+ICA.ContCont">ICA.ContCont</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
# Example 1, based on the ARMD data:
data(ARMD)

# Assess surrogacy based on the single-trial meta-analytic approach:
Sur &lt;- Single.Trial.RE.AA(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Pat.ID=Id)

# Obtain a summary and plot of the results
summary(Sur)
plot(Sur)


# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients 
# and Rindiv=.8
# Simulate the data:
Sim.Data.STS(N.Total=2000, R.Indiv.Target=.8, Seed=123)

# Assess surrogacy:
Sur2 &lt;- Single.Trial.RE.AA(Dataset=Data.Observed.STS, Surr=Surr, True=True, Treat=Treat, 
Pat.ID=Pat.ID)

# Show a summary and plots of results
summary(Sur2)
plot(Sur2)

## End(Not run)
</code></pre>

<hr>
<h2 id='SPF.BinBin'>
Evaluate the surrogate predictive function (SPF) in the binary-binary setting (sensitivity-analysis based approach)
</h2><span id='topic+SPF.BinBin'></span>

<h3>Description</h3>

<p>Computes the surrogate predictive function (SPF) based on sensitivity-analyis, i.e., <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code>, in the setting where both <code class="reqn">S</code> and <code class="reqn">T</code> are binary endpoints. For example, <code class="reqn">r(-1,1)</code> quantifies the probability that the treatment has a negative effect on the true endpoint (<code class="reqn">\Delta T=-1</code>) given that it has a positive effect on the surrogate (<code class="reqn">\Delta S=1</code>). All quantities of interest are derived from the vectors of 'plausible values' for <code class="reqn">\pi</code> (i.e., vectors <code class="reqn">\pi</code> that are compatible with the observable data at hand). See <b>Details</b> below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPF.BinBin(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPF.BinBin_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>ICA.BinBin</code>, <code>ICA.BinBin.Grid.Full</code>, or <code>ICA.BinBin.Grid.Sample</code>.</p>
</td></tr> 
</table>


<h3>Details</h3>

<p>All <code class="reqn">r(i,j)=P(\Delta T=i|\Delta S=j)</code> are derived from <code class="reqn">\pi</code> (vector of potential outcomes). Denote by <code class="reqn">\bold{Y}'=(T_0,T_1,S_0,S_1)</code> the vector of potential outcomes. The vector <code class="reqn">\bold{Y}</code> can take 16 values and the set of parameters <code class="reqn">\pi_{ijpq}=P(T_0=i,T_1=j,S_0=p,S_1=q)</code> (with <code class="reqn">i,j,p,q=0/1</code>) fully characterizes its distribution.
</p>
<p>Based on the data and assuming SUTVA, the marginal probabilites <code class="reqn">\pi_{1 \cdot 1 \cdot}</code>, <code class="reqn">\pi_{1 \cdot 0 \cdot}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 1}</code>, <code class="reqn">\pi_{\cdot 1 \cdot 0}</code>, <code class="reqn">\pi_{0 \cdot 1 \cdot}</code>, and <code class="reqn">\pi_{\cdot 0 \cdot 1}</code> can be computed (by hand or using the function <code><a href="#topic+MarginalProbs">MarginalProbs</a></code>). Define the vector 
</p>
<p style="text-align: center;"><code class="reqn">\bold{b}'=(1, \pi_{1 \cdot 1 \cdot}, \pi_{1 \cdot 0 \cdot}, \pi_{\cdot 1 \cdot 1}, \pi_{\cdot 1 \cdot 0}, \pi_{0 \cdot 1 \cdot}, \pi_{\cdot 0 \cdot 1})</code>
</p>
<p> and <code class="reqn">\bold{A}</code> is a contrast matrix such that the identified restrictions can be written as a system of linear equation
</p>
<p style="text-align: center;"><code class="reqn">\bold{A \pi} = \bold{b}.</code>
</p>

<p>The matrix <code class="reqn">\bold{A}</code> has rank <code class="reqn">7</code> and can be partitioned as <code class="reqn">\bold{A=(A_r | A_f)}</code>, and similarly the vector <code class="reqn">\bold{\pi}</code> can be partitioned as <code class="reqn">\bold{\pi^{'}=(\pi_r^{'} | \pi_f^{'})}</code> (where <code class="reqn">f</code> refers to the submatrix/vector given by the <code class="reqn">9</code> last columns/components of <code class="reqn">\bold{A/\pi}</code>). Using these partitions the previous system of linear equations can be rewritten as </p>
<p style="text-align: center;"><code class="reqn">\bold{A_r \pi_r + A_f \pi_f = b}.</code>
</p>

<p>The functions <code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, and  <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code> contain algorithms that generate plausible distributions for <code class="reqn">\bold{Y}</code> (for details, see the documentation of these functions). Based on the output of these functions, <code>SPF.BinBin</code> computes the surrogate predictive function.
</p>


<h3>Value</h3>

<table>
<tr><td><code>r_1_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, 1)</code>, i.e., <code class="reqn">P(\Delta T=1|\Delta S=1</code>).</p>
</td></tr>
<tr><td><code>r_min1_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, 1)</code>.</p>
</td></tr>
<tr><td><code>r_0_1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, 1)</code>.</p>
</td></tr>
<tr><td><code>r_1_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_min1_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, 0)</code>.</p>
</td></tr>
<tr><td><code>r_0_0</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, 0)</code>.</p>
</td></tr>
<tr><td><code>r_1_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_min1_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(-1, -1)</code>.</p>
</td></tr>
<tr><td><code>r_0_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">r(0, -1)</code>.</p>
</td></tr>
<tr><td><code>Monotonicity</code></td>
<td>
<p>The assumption regarding monotonicity under which the result was obtained.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Paul Meyvisch, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015). Assessing a surrogate effect predictive value in a causal inference framework.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Sample">ICA.BinBin.Grid.Sample</a></code>, <code><a href="#topic+ICA.BinBin.Grid.Full">ICA.BinBin.Grid.Full</a></code>, <code><a href="#topic+plot.SPF.BinBin">plot.SPF.BinBin</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Use ICA.BinBin.Grid.Sample to obtain plausible values for pi
ICA_BINBIN_Grid_Sample &lt;- ICA.BinBin.Grid.Sample(pi1_1_=0.341, pi0_1_=0.119,
pi1_0_=0.254, pi_1_1=0.686, pi_1_0=0.088, pi_0_1=0.078, Seed=1,
Monotonicity=c("General"), M=2500)

# Obtain SPF
SPF &lt;- SPF.BinBin(ICA_BINBIN_Grid_Sample)

# examine results
summary(SPF)
plot(SPF)
</code></pre>

<hr>
<h2 id='SPF.BinCont'>
Evaluate the surrogate predictive function (SPF) in the binary-continuous setting (sensitivity-analysis based approach)
</h2><span id='topic+SPF.BinCont'></span>

<h3>Description</h3>

<p>Computes the surrogate predictive function (SPF) based on sensitivity-analyis, i.e., <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>, in the setting where <code class="reqn">S</code> is continuous and <code class="reqn">T</code> is a binary endpoint. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SPF.BinCont(x, a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SPF.BinCont_+3A_x">x</code></td>
<td>
<p>A fitted object of class <code>ICA.BinCont</code>.</p>
</td></tr> 
<tr><td><code id="SPF.BinCont_+3A_a">a</code></td>
<td>
<p>The lower interval <code class="reqn">a</code> in <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>.</p>
</td></tr>
<tr><td><code id="SPF.BinCont_+3A_b">b</code></td>
<td>
<p>The upper interval <code class="reqn">b</code> in <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>a</code></td>
<td>
<p>The lower interval <code class="reqn">a</code> in <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The upper interval <code class="reqn">b</code> in <code class="reqn">P(\Delta T | \Delta S \in I[ab])</code>.</p>
</td></tr>
<tr><td><code>P_Delta_T_min1</code></td>
<td>
<p>The vector of values for <code class="reqn">P(\Delta T = -1| \Delta S \in I[ab])</code>.</p>
</td></tr>
<tr><td><code>P_Delta_T_0</code></td>
<td>
<p>The vector of values for <code class="reqn">P(\Delta T = 0| \Delta S \in I[ab])</code>.</p>
</td></tr>
<tr><td><code>P_Delta_T_1</code></td>
<td>
<p>The vector of values for <code class="reqn">P(\Delta T = 1| \Delta S \in I[ab])</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst &amp; Ariel Alonso
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., Molenberghs, G., &amp; Verbeke, G. (2017). Assessing the predictive value of a continuous surogate for a binary true endpoint based on causal inference.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICA.BinBin">ICA.BinBin</a></code>, <code><a href="#topic+plot.SPF.BinCont">plot.SPF.BinCont</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # time consuming code part
# Use ICA.BinCont to examine surrogacy
data(Schizo_BinCont)
Result_BinCont &lt;- ICA.BinCont(M = 1000, Dataset = Schizo_BinCont,
Surr = PANSS, True = CGI_Bin, Treat=Treat, Diff.Sigma=TRUE)

# Obtain SPF
Fit &lt;- SPF.BinCont(x=Result_BinCont, a = -30, b = -3)

# examine results
summary(Fit1)
plot(Fit1)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary'>Summary</h2><span id='topic+summary'></span><span id='topic+summary.BifixedContCont'></span><span id='topic+summary.FixedContContIT'></span><span id='topic+summary.BimixedContCont'></span><span id='topic+summary.UnifixedContCont'></span><span id='topic+summary.UnimixedContCont'></span><span id='topic+summary.ICA.ContCont'></span><span id='topic+summary.MICA.ContCont'></span><span id='topic+summary.MinSurrContCont'></span><span id='topic+summary.MixedContContIT'></span><span id='topic+summary.Single.Trial.RE.AA'></span><span id='topic+summary.SPF.BinBin'></span><span id='topic+summary.ICA.BinBin'></span><span id='topic+summary.TrialLevelMA'></span><span id='topic+summary.TwoStageSurvSurv'></span><span id='topic+summary.Prentice'></span><span id='topic+summary.PredTrialTContCont'></span><span id='topic+summary.FixedBinBinIT'></span><span id='topic+summary.FixedBinContIT'></span><span id='topic+summary.FixedContBinIT'></span><span id='topic+summary.SurvSurv'></span><span id='topic+summary.TrialLevelIT'></span><span id='topic+summary.MaxEntICA.BinBin'></span><span id='topic+summary.MaxEntSPF.BinBin'></span><span id='topic+summary.ICA.BinCont'></span><span id='topic+summary.FixedDiscrDiscrIT'></span><span id='topic+summary.Fano.BinBin'></span><span id='topic+summary.MaxEntContCont'></span><span id='topic+summary.ICA.ContCont.MultS'></span><span id='topic+summary.AA.MultS'></span><span id='topic+summary.PPE.BinBin'></span><span id='topic+summary.ECT'></span><span id='topic+summary.SPF.BinCont'></span><span id='topic+summary.Bootstrap.MEP.BinBin'></span><span id='topic+summary.ISTE.ContCont'></span><span id='topic+summary.BimixedCbCContCont'></span><span id='topic+summary.MufixedContCont.MultS'></span><span id='topic+summary.MumixedContCont.MultS'></span>

<h3>Description</h3>

<p>summary</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BifixedContCont'
summary(object, ..., Object)
## S3 method for class 'BimixedContCont'
summary(object, ..., Object)
## S3 method for class 'UnifixedContCont'
summary(object, ..., Object)
## S3 method for class 'UnimixedContCont'
summary(object, ..., Object)
## S3 method for class 'FixedContContIT'
summary(object, ..., Object)
## S3 method for class 'ICA.ContCont'
summary(object, ..., Object)
## S3 method for class 'MICA.ContCont'
summary(object, ..., Object)
## S3 method for class 'MinSurrContCont'
summary(object, ..., Object)
## S3 method for class 'MixedContContIT'
summary(object, ..., Object)
## S3 method for class 'Single.Trial.RE.AA'
summary(object, ..., Object)
## S3 method for class 'SPF.BinBin'
summary(object, ..., Object)
## S3 method for class 'ICA.BinBin'
summary(object, ..., Object)
## S3 method for class 'TrialLevelMA'
summary(object, ..., Object)
## S3 method for class 'TwoStageSurvSurv'
summary(object, ..., Object)
## S3 method for class 'Prentice'
summary(object, ..., Object)
## S3 method for class 'PredTrialTContCont'
summary(object, ..., Object)
## S3 method for class 'FixedBinBinIT'
summary(object, ..., Object)
## S3 method for class 'FixedBinContIT'
summary(object, ..., Object)
## S3 method for class 'FixedContBinIT'
summary(object, ..., Object)
## S3 method for class 'SurvSurv'
summary(object, ..., Object)
## S3 method for class 'TrialLevelIT'
summary(object, ..., Object)
## S3 method for class 'MaxEntICA.BinBin'
summary(object, ..., Object)
## S3 method for class 'MaxEntSPF.BinBin'
summary(object, ..., Object)
## S3 method for class 'ICA.BinCont'
summary(object, ..., Object)
## S3 method for class 'FixedDiscrDiscrIT'
summary(object, ..., Object)
## S3 method for class 'Fano.BinBin'
summary(object, ..., Object, Type = "Overall")
## S3 method for class 'MaxEntContCont'
summary(object, ..., Object)
## S3 method for class 'ICA.ContCont.MultS'
summary(object, ..., Object)
## S3 method for class 'AA.MultS'
summary(object, ..., Object)
## S3 method for class 'PPE.BinBin'
summary(object, ..., Object)
## S3 method for class 'ECT'
summary(object, ..., Object)
## S3 method for class 'SPF.BinCont'
summary(object, ..., Object)
## S3 method for class 'Bootstrap.MEP.BinBin'
summary(object, ..., Object)
## S3 method for class 'ISTE.ContCont'
summary(object, ..., Object)
## S3 method for class 'BimixedCbCContCont'
summary(object, ..., Object)
## S3 method for class 'MufixedContCont.MultS'
summary(object, ..., Object)
## S3 method for class 'MumixedContCont.MultS'
summary(object, ..., Object)
</code></pre>

<hr>
<h2 id='summary_level_bootstrap_ICA'>Bootstrap based on the multivariate normal sampling distribution</h2><span id='topic+summary_level_bootstrap_ICA'></span>

<h3>Description</h3>

<p><code><a href="#topic+summary_level_bootstrap_ICA">summary_level_bootstrap_ICA()</a></code> performs a parametric type of bootstrap based
on the estimated multivariate normal sampling distribution of the maximum
likelihood estimator for the (observable) D-vine copula model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary_level_bootstrap_ICA(
  fitted_model,
  copula_par_unid,
  copula_family2,
  rotation_par_unid,
  n_prec,
  B,
  measure = "ICA",
  mutinfo_estimator = NULL,
  composite,
  seed,
  restr_time = +Inf,
  ncores = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_fitted_model">fitted_model</code></td>
<td>
<p>Returned value from <code><a href="#topic+fit_model_SurvSurv">fit_model_SurvSurv()</a></code>. This object
contains the estimated identifiable part of the joint distribution for the
potential outcomes.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_copula_par_unid">copula_par_unid</code></td>
<td>
<p>Parameter vector for the sequence of <em>unidentifiable</em>
bivariate copulas that define the D-vine copula. The elements of
<code>copula_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_copula_family2">copula_family2</code></td>
<td>
<p>Copula family of the other bivariate copulas. For the
possible options, see <code>loglik_copula_scale()</code>. The elements of
<code>copula_family2</code> correspond to <code class="reqn">(c_{23}, c_{13;2}, c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_rotation_par_unid">rotation_par_unid</code></td>
<td>
<p>Vector of rotation parameters for the sequence of
<em>unidentifiable</em> bivariate copulas that define the D-vine copula. The elements of
<code>rotation_par</code> correspond to <code class="reqn">(c_{23}, c_{13;2},
  c_{24;3}, c_{14;23})</code>.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_n_prec">n_prec</code></td>
<td>
<p>Number of Monte Carlo samples for the computation of the mutual
information.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_b">B</code></td>
<td>
<p>Number of bootstrap replications</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_measure">measure</code></td>
<td>
<p>Compute intervals for which measure of surrogacy? Defaults to
<code>"ICA"</code>. See first column names of <code>sens_results</code> for other possibilities.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_mutinfo_estimator">mutinfo_estimator</code></td>
<td>
<p>Function that estimates the mutual information
between the first two arguments which are numeric vectors. Defaults to
<code>FNN::mutinfo()</code> with default arguments.
@param plot_deltas (logical) Plot the sampled individual treatment effects?</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_composite">composite</code></td>
<td>
<p>(boolean)  If <code>composite</code> is <code>TRUE</code>, then the surrogate
endpoint is a composite of both a &quot;pure&quot; surrogate endpoint and the true
endpoint, e.g., progression-free survival is the minimum of time-to-progression
and time-to-death.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_seed">seed</code></td>
<td>
<p>Seed for Monte Carlo sampling. This seed does not affect the global
environment.</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_restr_time">restr_time</code></td>
<td>
<p>Restriction time for the potential outcomes. Defaults to
<code>+Inf</code> which means no restriction. Otherwise, the sampled potential outcomes
are replace by <code>pmin(S0, restr_time)</code> (and similarly for the other potential
outcomes).</p>
</td></tr>
<tr><td><code id="summary_level_bootstrap_ICA_+3A_ncores">ncores</code></td>
<td>
<p>Number of cores used in the sensitivity analysis. The
computations are computationally heavy, and this option can speed things up
considerably.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\hat{\boldsymbol{\beta}}</code> be the estimated identifiable parameter
vector, <code class="reqn">\hat{\Sigma}</code> the corresponding estimated covariance matrix, and
<code class="reqn">\boldsymbol{\nu}</code> a fixed value for the sensitivity parameter. The
bootstrap is then performed in the following steps
</p>

<ol>
<li><p> Resample the identifiable parameters from the estimated sampling distribution,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\boldsymbol{\beta}}^{(b)} \sim N(\hat{\boldsymbol{\beta}}, \hat{\Sigma}).</code>
</p>

</li>
<li><p> For each resampled parameter vector and the fixed sensitivty parameter,
compute the ICA as <code class="reqn">ICA(\hat{\boldsymbol{\beta}}^{(b)},
\boldsymbol{\nu})</code>.
</p>
</li></ol>



<h3>Value</h3>

<p>(numeric) Vector of bootstrap replications for the estimated ICA.
</p>

<hr>
<h2 id='summary.survbin'>Provides a summary of the surrogacy measures for an object fitted with the 'survbin()' function.</h2><span id='topic+summary.survbin'></span>

<h3>Description</h3>

<p>Provides a summary of the surrogacy measures for an object fitted with the 'survbin()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survbin'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.survbin_+3A_object">object</code></td>
<td>
<p>An object of class 'survbin' fitted with the 'survbin()' function.</p>
</td></tr>
<tr><td><code id="summary.survbin_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The surrogacy measures with their 95% confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal")
fit_bin &lt;- survbin(data = colorectal, true = surv, trueind = SURVIND, surrog = responder,
                   trt = TREAT, center = CENTER, trial = TRIAL, patientid = patientid)
summary(fit_bin)

## End(Not run)
</code></pre>

<hr>
<h2 id='summary.survcat'>Provides a summary of the surrogacy measures for an object fitted with the 'survcat()' function.</h2><span id='topic+summary.survcat'></span>

<h3>Description</h3>

<p>Provides a summary of the surrogacy measures for an object fitted with the 'survcat()' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'survcat'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.survcat_+3A_object">object</code></td>
<td>
<p>An object of class 'survcat' fitted with the 'survcat()' function.</p>
</td></tr>
<tr><td><code id="summary.survcat_+3A_...">...</code></td>
<td>
<p>...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The surrogacy measures with their 95% confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal4")
fit &lt;- survcat(data = colorectal4, true = truend, trueind = trueind, surrog = surrogend,
               trt = treatn, center = center, trial = trialend, patientid = patid)
summary(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='survbin'>Compute surrogacy measures for a binary surrogate and a time-to-event true endpoint in the meta-analytic multiple-trial setting.</h2><span id='topic+survbin'></span>

<h3>Description</h3>

<p>The function 'survbin()' fits the model for a binary surrogate and time-to-event true endpoint developed by Burzykowski et al. (2004) in the meta-analytic multiple-trial setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survbin(data, true, trueind, surrog, trt, center, trial, patientid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survbin_+3A_data">data</code></td>
<td>
<p>A data frame with the correct columns (See details).</p>
</td></tr>
<tr><td><code id="survbin_+3A_true">true</code></td>
<td>
<p>Observed time-to-event (true endpoint).</p>
</td></tr>
<tr><td><code id="survbin_+3A_trueind">trueind</code></td>
<td>
<p>Time-to-event indicator.</p>
</td></tr>
<tr><td><code id="survbin_+3A_surrog">surrog</code></td>
<td>
<p>Binary surrogate endpoint.</p>
</td></tr>
<tr><td><code id="survbin_+3A_trt">trt</code></td>
<td>
<p>Treatment indicator.</p>
</td></tr>
<tr><td><code id="survbin_+3A_center">center</code></td>
<td>
<p>Center indicator (equal to trial if there are no different centers).</p>
</td></tr>
<tr><td><code id="survbin_+3A_trial">trial</code></td>
<td>
<p>Trial indicator.</p>
</td></tr>
<tr><td><code id="survbin_+3A_patientid">patientid</code></td>
<td>
<p>Patient indicator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class &quot;survbin&quot; that can be used to evaluate surrogacy and contains the following elements:
</p>

<ul>
<li><p> Indiv.GlobalOdds: a data frame that contains the Global Odds and 95% confidence interval to evaluate surrogacy at the individual level.
</p>
</li>
<li><p> Trial.R2: a data frame that contains the correlation coefficient and 95% confidence interval to evaluate surrogacy at the trial level.
</p>
</li>
<li><p> EstTreatEffects: a data frame that contains the estimated treatment effects and sample size for each trial.
</p>
</li></ul>



<h3>Model</h3>

<p>In the model developed by Burzykowski et al. (2004), a copula-based model is used for the true endpoint and a latent continuous variable, underlying the surrogate endpoint.
More specifically, the Plackett copula is used. The marginal model for the surrogate endpoint is a logistic regression model. For the true endpoint, the proportional hazard model is used.
The quality of the surrogate at the individual level can be evaluated by using the copula parameter Theta, which takes the form of a global odds ratio.
The quality of the surrogate at the trial level can be evaluated by considering the correlation coefficient between the estimated treatment effects, while adjusting for the estimation error.
</p>


<h3>Data Format</h3>

<p>The data frame must contains the following columns:
</p>

<ul>
<li><p> a column with the observed time-to-event (true endpoint)
</p>
</li>
<li><p> a column with the time-to-event indicator: 1 if true event is observed, 0 otherwise
</p>
</li>
<li><p> a column with the binary surrogate endpoint: 1 or 2
</p>
</li>
<li><p> a column with the treatment indicator: 0 or 1
</p>
</li>
<li><p> a column with the trial indicator
</p>
</li>
<li><p> a column with the center indicator. If there are no different centers within each trial, the center indicator is equal to the trial indicator
</p>
</li>
<li><p> a column with the patient indicator
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Dries De Witte
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2004). The validation of surrogate end points by using data from randomized clinical trials: a case-study in advanced colorectal cancer. Journal of the Royal Statistical Society Series A: Statistics in Society, 167(1), 103-124.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal")
fit_bin &lt;- survbin(data = colorectal, true = surv, trueind = SURVIND, surrog = responder,
                   trt = TREAT, center = CENTER, trial = TRIAL, patientid = patientid)
print(fit_bin)
summary(fit_bin)
plot(fit_bin)

## End(Not run)

</code></pre>

<hr>
<h2 id='survcat'>Compute surrogacy measures for a categorical (ordinal) surrogate and a time-to-event true endpoint in the meta-analytic multiple-trial setting.</h2><span id='topic+survcat'></span>

<h3>Description</h3>

<p>The function 'survcat()' fits the model for a categorical (ordinal) surrogate and time-to-event true endpoint developed by Burzykowski et al. (2004) in the meta-analytic multiple-trial setting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survcat(data, true, trueind, surrog, trt, center, trial, patientid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survcat_+3A_data">data</code></td>
<td>
<p>A data frame with the correct columns (See details).</p>
</td></tr>
<tr><td><code id="survcat_+3A_true">true</code></td>
<td>
<p>Observed time-to-event (true endpoint).</p>
</td></tr>
<tr><td><code id="survcat_+3A_trueind">trueind</code></td>
<td>
<p>Time-to-event indicator.</p>
</td></tr>
<tr><td><code id="survcat_+3A_surrog">surrog</code></td>
<td>
<p>Ordinal surrogate endpoint.</p>
</td></tr>
<tr><td><code id="survcat_+3A_trt">trt</code></td>
<td>
<p>Treatment indicator.</p>
</td></tr>
<tr><td><code id="survcat_+3A_center">center</code></td>
<td>
<p>Center indicator (equal to trial if there are no different centers).</p>
</td></tr>
<tr><td><code id="survcat_+3A_trial">trial</code></td>
<td>
<p>Trial indicator.</p>
</td></tr>
<tr><td><code id="survcat_+3A_patientid">patientid</code></td>
<td>
<p>Patient indicator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class &quot;survcat&quot; that can be used to evaluate surrogacy and contains the following elements:
</p>

<ul>
<li><p> Indiv.GlobalOdds: a data frame that contains the Global Odds and 95% confidence interval to evaluate surrogacy at the individual level.
</p>
</li>
<li><p> Trial.R2: a data frame that contains the correlation coefficient and 95% confidence interval to evaluate surrogacy at the trial level.
</p>
</li>
<li><p> EstTreatEffects: a data frame that contains the estimated treatment effects and sample size for each trial.
</p>
</li></ul>



<h3>Model</h3>

<p>In the model developed by Burzykowski et al. (2004), a copula-based model is used for the true endpoint and a latent continuous variable, underlying the surrogate endpoint.
More specifically, the Plackett copula is used. The marginal model for the surrogate endpoint is a proportional odds model. For the true endpoint, the proportional hazards model is used.
The quality of the surrogate at the individual level can be evaluated by using the copula parameter Theta, which takes the form of a global odds ratio.
The quality of the surrogate at the trial level can be evaluated by considering the correlation coefficient between the estimated treatment effects, while adjusting for the estimation error.
</p>


<h3>Data Format</h3>

<p>The data frame must contains the following columns:
</p>

<ul>
<li><p> a column with the observed time-to-event (true endpoint)
</p>
</li>
<li><p> a column with the time-to-event indicator: 1 if true event is observed, 0 otherwise
</p>
</li>
<li><p> a column with the ordinal surrogate endpoint: 1 2 3 ... K
</p>
</li>
<li><p> a column with the treatment indicator: 0 or 1
</p>
</li>
<li><p> a column with the trial indicator
</p>
</li>
<li><p> a column with the center indicator. If there are no different centers within each trial, the center indicator is equal to the trial indicator
</p>
</li>
<li><p> a column with the patient indicator
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Dries De Witte
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2004). The validation of surrogate end points by using data from randomized clinical trials: a case-study in advanced colorectal cancer. Journal of the Royal Statistical Society Series A: Statistics in Society, 167(1), 103-124.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data("colorectal4")
fit &lt;- survcat(data = colorectal4, true = truend, trueind = trueind, surrog = surrogend,
               trt = treatn, center = center, trial = trialend, patientid = patid)
print(fit)
summary(fit)
plot(fit)

## End(Not run)
</code></pre>

<hr>
<h2 id='SurvSurv'>Assess surrogacy for two survival endpoints based on information theory and a two-stage approach</h2><span id='topic+SurvSurv'></span>

<h3>Description</h3>

<p>The function <code>SurvSurv</code> implements the information-theoretic approach to estimate individual-level surrogacy (i.e., <code class="reqn">R^2_{h.ind}</code>) and the two-stage approach to estimate trial-level surrogacy (<code class="reqn">R^2_{trial}</code>, <code class="reqn">R^2_{ht}</code>) when both endpoints are time-to-event variables (Alonso &amp; Molenberghs, 2008). See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurvSurv(Dataset, Surr, SurrCens, True, TrueCens, Treat,
Trial.ID, Weighted=TRUE, Alpha=.05) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurvSurv_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value and censoring indicator, a true endpoint value and censoring indicator, a treatment indicator, and a trial ID.</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_surrcens">SurrCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the surrogate endpoint values (1 = event, 0 = censored).</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_truecens">TrueCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the true endpoint values (1 = event, 0 = censored).</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. </p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="SurvSurv_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><em>Individual-level surrogacy</em>
</p>
<p>Alonso &amp; Molenbergs (2008) proposed to redefine the surrogate endpoint <code class="reqn">S</code> as a time-dependent covariate <code class="reqn">S(t)</code>, taking value <code class="reqn">0</code> until the surrogate endpoint occurs and <code class="reqn">1</code> thereafter. Furthermore, these author considered the models
</p>
<p style="text-align: center;"><code class="reqn">\lambda [t \mid x_{ij}, \beta] = K_{ij}(t) \lambda_{0i}(t) exp(\beta x_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">\lambda [t \mid x_{ij}, s_{ij}, \beta, \phi] = K_{ij}(t) \lambda_{0i}(t) exp(\beta x_{ij} + \phi S_{ij}),</code>
</p>

<p>where <code class="reqn">K_{ij}(t)</code> is the risk function for patient <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">x_{ij}</code> is a p-dimensional vector of (possibly) time-dependent covariates, <code class="reqn">\beta</code> is a p-dimensional vector of unknown coefficients, <code class="reqn">\lambda_{0i}(t)</code> is a trial-specific baseline hazard function, <code class="reqn">S_{ij}</code> is a time-dependent covariate version of the surrogate endpoint, and <code class="reqn">\phi</code> its associated effect.
</p>
<p>The mutual information between <code class="reqn">S</code> and <code class="reqn">T</code> is estimated as <code class="reqn">I(T,S)=\frac{1}{n}G^2</code>, where <code class="reqn">n</code> is the number of patients and <code class="reqn">G^2</code> is the log likelihood test comparing the previous two models. Individual-level surrogacy can then be estimated as 
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind} = 1 - exp \left(-\frac{1}{n}G^2 \right).</code>
</p>

<p>O'Quigley and Flandre (2006) pointed out that the previous estimator depends upon the censoring mechanism, even when the censoring mechanism is non-informative. For low levels of censoring this may not be an issue of much concern but for high levels it could lead to biased results. To properly cope with the censoring mechanism in time-to-event outcomes, these authors proposed to estimate the mutual information as <code class="reqn">{I}(T,S)=\frac{1}{k}G^2</code>, where <code class="reqn">k</code> is the total number of events experienced. Individual-level surrogacy is then estimated as
</p>
<p style="text-align: center;"><code class="reqn">R^2_{h.ind} = 1 - exp \left(-\frac{1}{k}G^2 \right).</code>
</p>

<p><em>Trial-level surrogacy</em>
</p>
<p>A two-stage approach is used to estimate trial-level surrogacy, following a procedure proposed by Buyse et al. (2011). In stage 1, the following trial-specific Cox proportional hazard models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}(t)=S_{i0}(t) exp(\alpha_{i}Z_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}(t)=T_{i0}(t) exp(\beta_{i}Z_{ij}),</code>
</p>
 
<p>where <code class="reqn">S_{i0}(t)</code> and <code class="reqn">T_{i0}(t)</code> are the trial-specific baseline hazard functions, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, and <code class="reqn">\alpha_{i}</code>, <code class="reqn">\beta_{i}</code> are the trial-specific treatment effects on S and T, respectively. 
</p>
<p>Next, the second stage of the analysis is conducted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_{i}}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on the full model that was fitted in stage 1. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>SurvSurv</code> with components,
</p>
<table>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific log hazard ratio estimates of the treatment effects for the surrogate and the true endpoints.</p>
</td></tr>
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>R2.ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{ht}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>R2.hind</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{hind}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>R2h.ind.QF</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination using the correction proposed by O'Quigley and Flandre (2006), its standard error and confidence interval.</p>
</td></tr> 
<tr><td><code>R2.hInd.By.Trial.QF</code></td>
<td>
<p>A <code>data.frame</code> that contains individual-level surrogacy estimates using the correction proposed by O'Quigley and Flandre (2006), (cluster-based estimates) and their confidence interval for each of the trials seperately.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A. A., &amp; Molenberghs, G. (2008). Evaluating time-to-cancer recurrence as a surrogate marker for survival from an information theory perspective. <em>Statistical Methods in Medical Research, 17,</em> 497-504. 
</p>
<p>Buyse, M., Michiels, S., Squifflet, P., Lucchesi, K. J., Hellstrand, K., Brune, M. L., Castaigne, S., Rowe, J. M. (2011). Leukemia-free survival as a surrogate end point for overall survival in the evaluation of maintenance therapy for patients with acute myeloid leukemia in complete remission. <em>Haematologica, 96,</em> 1106-1112.
</p>
<p>O'Quigly, J., &amp; Flandre, P. (2006). Quantification of the Prentice criteria for surrogate endpoints. <em>Biometrics, 62,</em> 297-300.
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.SurvSurv">plot.SurvSurv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open Ovarian dataset
data(Ovarian)

# Conduct analysis
Fit &lt;- SurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd,
True = Surv, TrueCens = SurvInd, Treat = Treat, 
Trial.ID = Center)

# Examine results 
plot(Fit)
summary(Fit)
</code></pre>

<hr>
<h2 id='Test.Mono'>
Test whether the data are compatible with monotonicity for S and/or T (binary endpoints)
</h2><span id='topic+Test.Mono'></span>

<h3>Description</h3>

<p>For some situations, the observable marginal probabilities contain sufficient information to exclude a particular monotonicity scenario. For example, under monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code>, one of the restrictions that the data impose is <code class="reqn">\pi_{0111}&lt;min(\pi_{0 \cdot 1 \cdot}, \pi_{\cdot 1 \cdot 1})</code>. If the latter condition does not hold in the dataset at hand, monotonicity for <code class="reqn">S</code> and <code class="reqn">T</code> can be excluded. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Test.Mono(pi1_1_, pi0_1_, pi1_0_, pi_1_1, pi_1_0, pi_0_1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Test.Mono_+3A_pi1_1_">pi1_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="Test.Mono_+3A_pi0_1_">pi0_1_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="Test.Mono_+3A_pi1_0_">pi1_0_</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=0)</code>.</p>
</td></tr>
<tr><td><code id="Test.Mono_+3A_pi_1_1">pi_1_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=1|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="Test.Mono_+3A_pi_1_0">pi_1_0</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=1,S=0|Z=1)</code>.</p>
</td></tr>
<tr><td><code id="Test.Mono_+3A_pi_0_1">pi_0_1</code></td>
<td>
<p>A scalar that contains <code class="reqn">P(T=0,S=1|Z=1)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, Marc Buyse, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Alonso, A., Van der Elst, W., &amp; Molenberghs, G. (2015). Validation of surrogate endpoints: the binary-binary setting from a causal inference perspective.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Test.Mono(pi1_1_=0.2619048, pi1_0_=0.2857143, pi_1_1=0.6372549, 
pi_1_0=0.07843137, pi0_1_=0.1349206, pi_0_1=0.127451)
</code></pre>

<hr>
<h2 id='TrialLevelIT'>Estimates trial-level surrogacy in the information-theoretic framework</h2><span id='topic+TrialLevelIT'></span>

<h3>Description</h3>

<p>The function <code>TrialLevelIT</code> estimates trial-level surrogacy based on the vectors of treatment effects on <code class="reqn">S</code> (i.e., <code class="reqn">\alpha_{i}</code>), intercepts on <code class="reqn">S</code> (i.e., <code class="reqn">\mu_{i}</code>) and <code class="reqn">T</code> (i.e., <code class="reqn">\beta_{i}</code>) in the different trials. See the <b>Details</b> section below.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TrialLevelIT(Alpha.Vector, Mu_S.Vector=NULL, 
Beta.Vector, N.Trial, Model="Reduced", Alpha=.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TrialLevelIT_+3A_alpha.vector">Alpha.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">S</code> in the different trials, i.e., <code class="reqn">\alpha_{i}</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelIT_+3A_mu_s.vector">Mu_S.Vector</code></td>
<td>
<p>The vector of intercepts for <code class="reqn">S</code> in the different trials, i.e., <code class="reqn">\mu_{Si}</code>. Only required when a full model is requested.</p>
</td></tr>
<tr><td><code id="TrialLevelIT_+3A_beta.vector">Beta.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">T</code> in the different trials, i.e., <code class="reqn">\beta_{i}</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelIT_+3A_n.trial">N.Trial</code></td>
<td>
<p>The total number of available trials.</p>
</td></tr>
<tr><td><code id="TrialLevelIT_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code> or <code>Model=c("Reduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Reduced")</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelIT_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When a full model is requested (by using the argument <code>Model=c("Full")</code> in the function call), trial-level surrogacy is assessed by fitting the following univariate model: 
</p>
<p style="text-align: center;"><code class="reqn">{\beta}_{i}=\lambda_{0}+\lambda_{1}{\mu_{Si}}+\lambda_{2}{\alpha}_{i}+ \varepsilon_{i},   (1)</code>
</p>

<p>where <code class="reqn">\beta_i</code> = the trial-specific treatment effects on <code class="reqn">T</code>, <code class="reqn">\mu_{Si}</code> =  the trial-specific intercepts for <code class="reqn">S</code>, and <code class="reqn">\alpha_i</code> =  the trial-specific treatment effects on <code class="reqn">S</code>. The <code class="reqn">-2</code> log likelihood value of model (1) (<code class="reqn">L_1</code>) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based based on the Variance Reduction Factor (for details, see Alonso &amp; Molenberghs, 2007):
</p>
<p style="text-align: center;"><code class="reqn">R^2_{ht}= 1 - exp \left(-\frac{L_1-L_0}{N} \right),</code>
</p>

<p>where <code class="reqn">N</code> is the number of trials. 
</p>
<p>When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">{\beta}_{i}=\lambda_{0}+\lambda_{1}{\alpha}_{i}+\varepsilon_{i}.</code>
</p>

<p>The <code class="reqn">-2</code> log likelihood value of this model (<code class="reqn">L_1</code> for the reduced model) is subsequently compared to the <code class="reqn">-2</code> log likelihood value of an intercept-only model (<code class="reqn">{\beta}_{i}=\lambda_{3}</code>; <code class="reqn">L_0</code>), and <code class="reqn">R^2_{ht}</code> is computed based on the reduction in the likelihood (as described above).
</p>


<h3>Value</h3>

<p>An object of class <code>TrialLevelIT</code> with components,
</p>
<table>
<tr><td><code>Alpha.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">S</code> in the different trials.</p>
</td></tr>
<tr><td><code>Beta.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">T</code> in the different trials.</p>
</td></tr>
<tr><td><code>N.Trial</code></td>
<td>
<p>The total number of trials.</p>
</td></tr>
<tr><td><code>R2.ht</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{ht}</code>), its standard error and confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+plot.TrialLevelIT">plot.TrialLevelIT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate vector treatment effects on S
set.seed(seed = 1)
Alpha.Vector &lt;- seq(from = 5, to = 10, by=.1) + runif(min = -.5, max = .5, n = 51)

# Generate vector treatment effects on T
set.seed(seed=2)
Beta.Vector &lt;- (Alpha.Vector * 3) + runif(min = -5, max = 5, n = 51)

# Apply the function to estimate R^2_{h.t}
Fit &lt;- TrialLevelIT(Alpha.Vector=Alpha.Vector,
Beta.Vector=Beta.Vector, N.Trial=50, Model="Reduced")

summary(Fit)
plot(Fit)
</code></pre>

<hr>
<h2 id='TrialLevelMA'>Estimates trial-level surrogacy in the meta-analytic framework</h2><span id='topic+TrialLevelMA'></span>

<h3>Description</h3>

<p>The function <code>TrialLevelMA</code> estimates trial-level surrogacy based on the vectors of treatment effects on <code class="reqn">S</code> (i.e., <code class="reqn">\alpha_{i}</code>) and <code class="reqn">T</code> (i.e., <code class="reqn">\beta_{i}</code>) in the different trials. In particular, <code class="reqn">\beta_{i}</code> is regressed on <code class="reqn">\alpha_{i}</code> and the classical coefficient of determination of the fitted model provides an estimate of <code class="reqn">R^2_{trial}</code>. In addition, the standard error and CI are provided.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TrialLevelMA(Alpha.Vector, Beta.Vector, 
N.Vector, Weighted=TRUE, Alpha=.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TrialLevelMA_+3A_alpha.vector">Alpha.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">S</code> in the different trials, i.e., <code class="reqn">\alpha_{i}</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelMA_+3A_beta.vector">Beta.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">T</code> in the different trials, i.e., <code class="reqn">\beta_{i}</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelMA_+3A_n.vector">N.Vector</code></td>
<td>
<p>The vector of trial sizes <code class="reqn">N_{i}</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelMA_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted. If <code>FALSE</code>, then an unweighted regression analysis is conducted. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TrialLevelMA_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>TrialLevelMA</code> with components,
</p>
<table>
<tr><td><code>Alpha.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">S</code> in the different trials.</p>
</td></tr>
<tr><td><code>Beta.Vector</code></td>
<td>
<p>The vector of treatment effects on <code class="reqn">T</code> in the different trials.</p>
</td></tr>
<tr><td><code>N.Vector</code></td>
<td>
<p>The vector of trial sizes <code class="reqn">N_{i}</code>.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Model.2.Fit</code></td>
<td>
<p>The fitted stage <code class="reqn">2</code> model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+plot+20Meta-Analytic">plot Meta-Analytic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate vector treatment effects on S
set.seed(seed = 1)
Alpha.Vector &lt;- seq(from = 5, to = 10, by=.1) + runif(min = -.5, max = .5, n = 51)
# Generate vector treatment effects on T
set.seed(seed=2)
Beta.Vector &lt;- (Alpha.Vector * 3) + runif(min = -5, max = 5, n = 51)
# Vector of sample sizes of the trials (here, all n_i=10)
N.Vector &lt;- rep(10, times=51)

# Apply the function to estimate R^2_{trial}
Fit &lt;- TrialLevelMA(Alpha.Vector=Alpha.Vector,
Beta.Vector=Beta.Vector, N.Vector=N.Vector)

# Plot the results and obtain summary
plot(Fit)
summary(Fit)
</code></pre>

<hr>
<h2 id='TwoStageSurvSurv'>Assess trial-level surrogacy for two survival endpoints using a two-stage approach</h2><span id='topic+TwoStageSurvSurv'></span>

<h3>Description</h3>

<p>The function <code>TwoStageSurvSurv</code> uses a two-stage approach to estimate <code class="reqn">R^2_{trial}</code>. In stage 1, trial-specific Cox proportional hazard models are fitted and in stage 2 the trial-specific estimated treatment effects on <code class="reqn">T</code> are regressed on the trial-specific estimated treatment effects on <code class="reqn">S</code> (measured on the log hazard ratio scale). The user can specify whether a weighted or unweighted model should be fitted at stage 2. See the <b>Details</b> section below.   
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TwoStageSurvSurv(Dataset, Surr, SurrCens, True, TrueCens, Treat,
Trial.ID, Weighted=TRUE, Alpha=.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TwoStageSurvSurv_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value and censoring indicator, a true endpoint value and censoring indicator, a treatment indicator, and a trial ID.</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_surrcens">SurrCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the surrogate endpoint values (1 = event, 0 = censored).</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_truecens">TrueCens</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the censoring indicator for the true endpoint values (1 = event, 0 = censored).</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. </p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="TwoStageSurvSurv_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code> and <code class="reqn">R_{trial}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A two-stage approach is used to estimate trial-level surrogacy, following a procedure proposed by Buyse et al. (2011). In stage 1, the following trial-specific Cox proportional hazard models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}(t)=S_{i0}(t) exp(\alpha_{i}Z_{ij}),</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}(t)=T_{i0}(t) exp(\beta_{i}Z_{ij}),</code>
</p>
 
<p>where <code class="reqn">S_{i0}(t)</code> and <code class="reqn">T_{i0}(t)</code> are the trial-specific baseline hazard functions, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the trial-specific treatment effects on S and T, respectively. 
</p>
<p>Next, the second stage of the analysis is conducted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta_{i}}=\lambda_{0}+\lambda_{1}\widehat{\alpha_{i}}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on the full model that was fitted in stage 1. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>TwoStageSurvSurv</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of trials that do not have at least three patients per treatment arm are excluded due to estimation constraints (Burzykowski et al., 2001). <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific log hazard ratio estimates of the treatment effects for the surrogate and the true endpoints.</p>
</td></tr>
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., Buyse, M., Geys, H., &amp; Renard, D. (2001). Validation of surrogate endpoints in multiple randomized clinical trials with failure-time endpoints. <em>Applied Statistics, 50,</em> 405-422. 
</p>
<p>Buyse, M., Michiels, S., Squifflet, P., Lucchesi, K. J., Hellstrand, K., Brune, M. L., Castaigne, S., Rowe, J. M. (2011). Leukemia-free survival as a surrogate end point for overall survival in the evaluation of maintenance therapy for patients with acute myeloid leukemia in complete remission. <em>Haematologica, 96,</em> 1106-1112.
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.TwoStageSurvSurv">plot.TwoStageSurvSurv</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Open Ovarian dataset
data(Ovarian)

# Conduct analysis
Results &lt;- TwoStageSurvSurv(Dataset = Ovarian, Surr = Pfs, SurrCens = PfsInd, 
True = Surv, TrueCens = SurvInd, Treat = Treat, Trial.ID = Center)

# Examine results of analysis
summary(Results)
plot(Results)
</code></pre>

<hr>
<h2 id='twostep_BinCont'>Fit binary-continuous copula submodel with two-step estimator</h2><span id='topic+twostep_BinCont'></span>

<h3>Description</h3>

<p>The <code>twostep_BinCont()</code> function fits the copula (sub)model fir a continuous
surrogate and binary true endpoint with a two-step estimator. In the first
step, the marginal distribution parameters are estimated through maximum
likelihood. In the second step, the copula parameter is estimate while
holding the marginal distribution parameters fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twostep_BinCont(
  X,
  Y,
  copula_family,
  marginal_surrogate,
  marginal_surrogate_estimator = NULL,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twostep_BinCont_+3A_x">X</code></td>
<td>
<p>(numeric) Continuous surrogate variable</p>
</td></tr>
<tr><td><code id="twostep_BinCont_+3A_y">Y</code></td>
<td>
<p>(integer) Binary true endpoint variable (<code class="reqn">T_k \, \in \, \{0, 1\}</code>)</p>
</td></tr>
<tr><td><code id="twostep_BinCont_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="twostep_BinCont_+3A_marginal_surrogate">marginal_surrogate</code></td>
<td>
<p>Marginal distribution for the surrogate. For all
available options, see <code>?Surrogate::cdf_fun</code>.</p>
</td></tr>
<tr><td><code id="twostep_BinCont_+3A_marginal_surrogate_estimator">marginal_surrogate_estimator</code></td>
<td>
<p>Not yet implemented</p>
</td></tr>
<tr><td><code id="twostep_BinCont_+3A_method">method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements:
</p>

<ul>
<li><p> ml_fit: object of class <code>maxLik::maxLik</code> that contains the estimated copula
model.
</p>
</li>
<li><p> marginal_S_dist: object of class <code>fitdistrplus::fitdist</code> that represents the
marginal surrogate distribution.
</p>
</li>
<li><p> copula_family: string that indicates the copula family
</p>
</li></ul>


<hr>
<h2 id='twostep_SurvSurv'>Fit survival-survival copula submodel with two-step estimator</h2><span id='topic+twostep_SurvSurv'></span>

<h3>Description</h3>

<p>The <code>twostep_SurvSurv()</code> function fits the copula (sub)model for a
time-to-event surrogate and true endpoint with a two-step estimator. In the
first step, the marginal distribution parameters are estimated through
maximum likelihood. In the second step, the copula parameter is estimate
while holding the marginal distribution parameters fixed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twostep_SurvSurv(
  X,
  delta_X,
  Y,
  delta_Y,
  copula_family,
  n_knots,
  method = "BFGS"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twostep_SurvSurv_+3A_x">X</code></td>
<td>
<p>(numeric) Possibly right-censored time-to-surrogate event</p>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_delta_x">delta_X</code></td>
<td>
<p>(integer) Surrogate event indicator:
</p>

<ul>
<li> <p><code>1L</code> if surrogate event ocurred.
</p>
</li>
<li> <p><code>0L</code> if censored.
</p>
</li></ul>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_y">Y</code></td>
<td>
<p>(numeric) Possibly right-censored time-to-true endpoint event</p>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_delta_y">delta_Y</code></td>
<td>
<p>(integer) True endpoint event indicator:
</p>

<ul>
<li> <p><code>1L</code> if true endpoint event ocurred.
</p>
</li>
<li> <p><code>0L</code> if censored.
</p>
</li></ul>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_copula_family">copula_family</code></td>
<td>
<p>Copula family, one of the following:
</p>

<ul>
<li> <p><code>"clayton"</code>
</p>
</li>
<li> <p><code>"frank"</code>
</p>
</li>
<li> <p><code>"gumbel"</code>
</p>
</li>
<li> <p><code>"gaussian"</code>
</p>
</li></ul>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_n_knots">n_knots</code></td>
<td>
<p>Number of internal knots for the Royston-Parmar survival
models for <code class="reqn">\tilde{S}_0</code>, <code class="reqn">T_0</code>, <code class="reqn">\tilde{S}_1</code>, and <code class="reqn">T_1</code>.
If <code>length(n_knots) == 1</code>, the same number of knots are assumed for the
four marginal distributions.</p>
</td></tr>
<tr><td><code id="twostep_SurvSurv_+3A_method">method</code></td>
<td>
<p>Optimization algorithm for maximizing the objective function.
For all options, see <code>?maxLik::maxLik</code>. Defaults to <code>"BFGRS"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with three elements:
</p>

<ul>
<li><p> ml_fit: object of class <code>maxLik::maxLik</code> that contains the estimated copula
model.
</p>
</li>
<li><p> marginal_S_dist: object of class <code>fitdistrplus::fitdist</code> that represents the
marginal surrogate distribution.
</p>
</li>
<li><p> copula_family: string that indicates the copula family
</p>
</li></ul>


<hr>
<h2 id='UnifixedContCont'>Fits univariate fixed-effect models to assess surrogacy in the meta-analytic multiple-trial setting (continuous-continuous case)
</h2><span id='topic+UnifixedContCont'></span>

<h3>Description</h3>

<p>The function <code>UnifixedContCont</code> uses the univariate fixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.  Further, the Individual Causal Association (ICA) is computed.     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UnifixedContCont(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, Model=c("Full"), 
Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, Number.Bootstraps=500, 
Seed=sample(1:1000, size=1), T0T1=seq(-1, 1, by=.2), T0S1=seq(-1, 1, by=.2), 
T1S0=seq(-1, 1, by=.2), S0S1=seq(-1, 1, by=.2))</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UnifixedContCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. 
Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code>, <code class="reqn">R_{trial}</code>, <code class="reqn">R^2_{indiv}</code>, and <code class="reqn">R_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The standard errors and confidence intervals for <code class="reqn">R^2_{indiv}</code> and <code class="reqn">R_{indiv}</code> are determined as based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are used. Default <code class="reqn">500</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code> (ICA). For details, see function <code>ICA.ContCont</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnifixedContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the full bivariate mixed-effects model is fitted to assess surrogacy in the meta-analytic framework (for details, Buyse &amp; Molenberghs, 2000), computational issues often occur. In that situation, the use of simplified model-fitting strategies may be warranted (for details, see see Burzykowski et al., 2005; Tibaldi et al., 2003). 
</p>
<p>The function <code>UnifixedContCont</code> implements one such strategy, i.e., it uses a two-stage univariate fixed-effects modelling approach to assess surrogacy. In the first stage of the analysis, two univariate linear regression models are fitted to the data of each of the <code class="reqn">i</code> trials. When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{Si}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{Ti}+\beta_{i}Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{Si}</code> and <code class="reqn">\mu_{Ti}</code> are the fixed trial-specific intercepts for S and T, and <code class="reqn">\alpha_{i}</code> and <code class="reqn">\beta_{i}</code> are the fixed trial-specific treatment effects on S and T, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent. 
</p>
<p>When a reduced model is requested by the user (by using the argument <code>Model=c("Reduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+\alpha_{i}Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+\beta_{i}Z_{ij}+\varepsilon_{Tij},</code>
</p>

<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T (i.e., it is assumed that the intercepts for the surrogate and the true endpoints are identical in each of the trials). The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent. 
</p>
<p>An estimate of <code class="reqn">R^2_{indiv}</code> is provided by <code class="reqn">r(\varepsilon_{Sij}, \varepsilon_{Tij})^2</code>. 
</p>
<p>Next, the second stage of the analysis is conducted. When a full model is requested (by using the argument <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on the full models that were fitted in stage 1. 
</p>
<p>When a semi-reduced or reduced model is requested (by using the argument <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i}.</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code> and <code class="reqn">\alpha_i</code> are based on the semi-reduced or reduced models that were fitted in stage 1.
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial. 
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>UnifixedContCont</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>Residuals.Stage.1</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained in stage 1 of the analysis (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level correlation coefficient (<code class="reqn">R_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>D.Equiv</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercept and treatment effects for the surrogate and true endpoints (when a full or semi-reduced model is fitted, i.e., when <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogate and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).  The variance-covariance matrix <code>D.Equiv</code> is equivalent to the <code class="reqn">\bold{D}</code> matrix that would be obtained when a (full or reduced) bivariate mixed-effect approach is used; see function <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.ContCont</code>.</p>
</td></tr>
<tr><td><code>T0T0</code></td>
<td>
<p>The variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>T1T1</code></td>
<td>
<p>The variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code>S0S0</code></td>
<td>
<p>The variance of the surrogate endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>S1S1</code></td>
<td>
<p>The variance of the surrogate endpoint in the experimental treatment condition.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnimixedContCont">UnimixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+plot+20Meta-Analytic">plot Meta-Analytic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  #Time consuming (&gt;5 sec) code parts
# Example 1, based on the ARMD data
data(ARMD)

# Fit a full univariate fixed-effects model with weighting according to the  
# number of patients in stage 2 of the two stage approach to assess surrogacy:
Sur &lt;- UnifixedContCont(Dataset=ARMD, Surr=Diff24, True=Diff52, Treat=Treat, Trial.ID=Center, 
Pat.ID=Id, Model="Full", Weighted=TRUE)

# Obtain a summary and plot of the results
summary(Sur)
plot(Sur)

# Example 2
# Conduct an analysis based on a simulated dataset with 2000 patients, 100 trials, 
# and Rindiv=Rtrial=.8
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Reduced")

# Fit a reduced univariate fixed-effects model without weighting to assess
# surrogacy:
Sur2 &lt;- UnifixedContCont(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat, 
Trial.ID=Trial.ID, Pat.ID=Pat.ID, Model="Reduced", Weighted=FALSE)

# Show a summary and plots of results:
summary(Sur2)
plot(Sur2, Weighted=FALSE)
## End(Not run)
</code></pre>

<hr>
<h2 id='UnimixedContCont'>
Fits univariate mixed-effect models to assess surrogacy in the meta-analytic multiple-trial setting
(continuous-continuous case)</h2><span id='topic+UnimixedContCont'></span>

<h3>Description</h3>

<p>The function <code>UnimixedContCont</code> uses the univariate mixed-effects approach to estimate trial- and individual-level surrogacy when the data of multiple clinical trials are available. The user can specify whether a (weighted or unweighted) full, semi-reduced, or reduced model should be fitted. See the <b>Details</b> section below.  Further, the Individual Causal Association (ICA) is computed.     
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UnimixedContCont(Dataset, Surr, True, Treat, Trial.ID, Pat.ID, Model=c("Full"), 
Weighted=TRUE, Min.Trial.Size=2, Alpha=.05, Number.Bootstraps=500,
Seed=sample(1:1000, size=1), T0T1=seq(-1, 1, by=.2), T0S1=seq(-1, 1, by=.2), 
T1S0=seq(-1, 1, by=.2), S0S1=seq(-1, 1, by=.2), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="UnimixedContCont_+3A_dataset">Dataset</code></td>
<td>
<p>A <code>data.frame</code> that should consist of one line per patient. Each line contains (at least) a surrogate value, a true endpoint value, a treatment indicator, a patient ID, and a trial ID.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_surr">Surr</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the surrogate endpoint values.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_true">True</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the true endpoint values.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_treat">Treat</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the treatment indicators. The treatment indicator should either be coded as <code class="reqn">1</code> for the experimental group and <code class="reqn">-1</code> for the control group, or as <code class="reqn">1</code> for the experimental group and <code class="reqn">0</code> for the control group. </p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_trial.id">Trial.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the trial ID to which the patient belongs.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_pat.id">Pat.ID</code></td>
<td>
<p>The name of the variable in <code>Dataset</code> that contains the patient's ID.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_model">Model</code></td>
<td>
<p>The type of model that should be fitted, i.e., <code>Model=c("Full")</code>, <code>Model=c("Reduced")</code>, or <code>Model=c("SemiReduced")</code>. See the <b>Details</b> section below. Default <code>Model=c("Full")</code>. </p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_weighted">Weighted</code></td>
<td>
<p>Logical. If <code>TRUE</code>, then a weighted regression analysis is conducted at stage 2 of the two-stage approach. If <code>FALSE</code>, then an unweighted regression analysis is conducted at stage 2 of the two-stage approach. See the <b>Details</b> section below. Default <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_min.trial.size">Min.Trial.Size</code></td>
<td>
<p>The minimum number of patients that a trial should contain to be included in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded from the analysis. Default <code class="reqn">2</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_alpha">Alpha</code></td>
<td>
<p>The <code class="reqn">\alpha</code>-level that is used to determine the confidence intervals around <code class="reqn">R^2_{trial}</code>, <code class="reqn">R_{trial}</code>, <code class="reqn">R^2_{indiv}</code>, and <code class="reqn">R_{indiv}</code>. Default <code class="reqn">0.05</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_number.bootstraps">Number.Bootstraps</code></td>
<td>
<p>The confidence intervals for <code class="reqn">R^2_{indiv}</code> and <code class="reqn">R_{indiv}</code> are determined as based on a bootstrap procedure. <code>Number.Bootstraps</code> specifies the number of bootstrap samples that are to be used. Default <code class="reqn">500</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_seed">Seed</code></td>
<td>
<p>The seed to be used in the bootstrap procedure. Default <code class="reqn">sample(1:1000, size=1)</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_t0t1">T0T1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and T1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code> (ICA). For details, see function <code>ICA.ContCont</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_t0s1">T0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_t1s0">T1S0</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals T1 and S0 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_s0s1">S0S1</code></td>
<td>
<p>A scalar or vector that contains the correlation(s) between the counterfactuals S0 and S1 that should be considered in the computation of <code class="reqn">\rho_{\Delta}</code>. Default <code>seq(-1, 1, by=.2)</code>.</p>
</td></tr>
<tr><td><code id="UnimixedContCont_+3A_...">...</code></td>
<td>
<p>Other arguments to be passed to the function <code>lmer</code> (of the R package <code>lme4</code>) that is used to fit the geralized linear mixed-effect models in the function <code>BimixedContCont</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When the full bivariate mixed-effects model is fitted to assess surrogacy in the meta-analytic framework (for details, Buyse &amp; Molenberghs, 2000), computational issues often occur. In that situation, the use of simplified model-fitting strategies may be warranted (for details, see Burzykowski et al., 2005; Tibaldi et al., 2003).   
</p>
<p>The function <code>UnimixedContCont</code> implements one such strategy, i.e., it uses a two-stage univariate mixed-effects modelling approach to assess surrogacy. In the first stage of the analysis, two univariate mixed-effects models are fitted to the data. When a full or semi-reduced model is requested (by using the argument <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> in the function call), the following univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+m_{Si}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+m_{Ti}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">i</code> and <code class="reqn">j</code> are the trial and subject indicators, <code class="reqn">S_{ij}</code> and <code class="reqn">T_{ij}</code> are the surrogate and true endpoint values of subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">Z_{ij}</code> is the treatment indicator for subject <code class="reqn">j</code> in trial <code class="reqn">i</code>, <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the fixed intercepts for S and T, <code class="reqn">m_{Si}</code> and <code class="reqn">m_{Ti}</code> are the corresponding random intercepts, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are the fixed treatment effects for S and T, and <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code> are the corresponding random treatment effects, respectively. The error terms <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are assumed to be independent. 
</p>
<p>When a reduced model is requested (by using the argument <code>Model=c("Reduced")</code> in the function call), the following two univariate models are fitted:
</p>
<p style="text-align: center;"><code class="reqn">S_{ij}=\mu_{S}+(\alpha+a_{i})Z_{ij}+\varepsilon_{Sij},</code>
</p>

<p style="text-align: center;"><code class="reqn">T_{ij}=\mu_{T}+(\beta+b_{i})Z_{ij}+\varepsilon_{Tij},</code>
</p>
 
<p>where <code class="reqn">\mu_{S}</code> and <code class="reqn">\mu_{T}</code> are the common intercepts for S and T (i.e., it is assumed that the intercepts for the surrogate and the true endpoints are identical in each of the trials). The other parameters are the same as defined above, and <code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code> are again assumed to be independent. 
</p>
<p>An estimate of <code class="reqn">R^2_{indiv}</code> is computed as <code class="reqn">r(\varepsilon_{Sij}, \varepsilon_{Tij})^2</code>. 
</p>
<p>Next, the second stage of the analysis is conducted. When a full model is requested by the user (by using the argument <code>Model=c("Full")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\mu_{Si}}+\lambda_{2}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameter estimates for <code class="reqn">\beta_i</code>, <code class="reqn">\mu_{Si}</code>, and <code class="reqn">\alpha_i</code> are based on the models that were fitted in stage 1, i.e., <code class="reqn">\beta_{i}=\beta+b_{i}</code>, <code class="reqn">\mu_{Si}=\mu_{S}+m_{Si}</code>, and <code class="reqn">\alpha_{i}=\alpha+a_{i}</code>. 
</p>
<p>When a reduced or semi-reduced model is requested by the user (by using the arguments <code>Model=c("SemiReduced")</code> or <code>Model=c("Reduced")</code> in the function call), the following model is fitted:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{\beta}_{i}=\lambda_{0}+\lambda_{1}\widehat{\alpha}_{i}+\varepsilon_{i},</code>
</p>

<p>where the parameters are the same as defined above. 
</p>
<p>When the argument <code>Weighted=FALSE</code> is used in the function call, the model that is fitted in stage 2 is an unweighted linear regression model. When a weighted model is requested (using the argument <code>Weighted=TRUE</code> in the function call), the information that is obtained in stage 1 is weighted according to the number of patients in a trial.  
</p>
<p>The classical coefficient of determination of the fitted stage 2 model provides an estimate of <code class="reqn">R^2_{trial}</code>. 
</p>


<h3>Value</h3>

<p>An object of class <code>UnimixedContCont</code> with components,
</p>
<table>
<tr><td><code>Data.Analyze</code></td>
<td>
<p>Prior to conducting the surrogacy analysis, data of patients who have a missing value for the surrogate and/or the true endpoint are excluded. In addition, the data of trials (i) in which only one type of the treatment was administered, and (ii) in which either the surrogate or the true endpoint was a constant (i.e., all patients within a trial had the same surrogate and/or true endpoint value) are excluded. In addition, the user can specify the minimum number of patients that a trial should contain in order to include the trial in the analysis. If the number of patients in a trial is smaller than the value specified by <code>Min.Trial.Size</code>, the data of the trial are excluded. <code>Data.Analyze</code> is the dataset on which the surrogacy analysis was conducted.</p>
</td></tr>
<tr><td><code>Obs.Per.Trial</code></td>
<td>
<p>A <code>data.frame</code> that contains the total number of patients per trial and the number of patients who were administered the control treatment and the experimental treatment in each of the trials (in <code>Data.Analyze</code>).</p>
</td></tr>
<tr><td><code>Results.Stage.1</code></td>
<td>
<p>The results of stage 1 of the two-stage model fitting approach: a <code>data.frame</code> that contains the trial-specific intercepts and treatment effects for the surrogate and the true endpoints (when a full or semi-reduced model is requested), or the trial-specific treatment effects for the surrogate and the true endpoints (when a reduced model is requested).</p>
</td></tr>
<tr><td><code>Residuals.Stage.1</code></td>
<td>
<p>A <code>data.frame</code> that contains the residuals for the surrogate and true endpoints that are obtained in stage 1 of the analysis (<code class="reqn">\varepsilon_{Sij}</code> and <code class="reqn">\varepsilon_{Tij}</code>).</p>
</td></tr>
<tr><td><code>Fixed.Effect.Pars</code></td>
<td>
<p>A <code>data.frame</code> that contains the fixed intercept and treatment effects for S and T (i.e., <code class="reqn">\mu_{S}</code>, <code class="reqn">\mu_{T}</code>, <code class="reqn">\alpha</code>, and <code class="reqn">\beta</code>) when a full, semi-reduced, or reduced model is fitted in stage 1.</p>
</td></tr>
<tr><td><code>Random.Effect.Pars</code></td>
<td>
<p>A <code>data.frame</code> that contains the random intercept and treatment effects for S and T (i.e., <code class="reqn">m_{Si}</code>, <code class="reqn">m_{Ti}</code>, <code class="reqn">a_{i}</code> and <code class="reqn">b_{i}</code>) when a full or semi-reduced model is fitted in stage 1, or that contains the random treatment effects for S and T (i.e., <code class="reqn">a_{i}</code>, and <code class="reqn">b_{i}</code>) when a reduced model is fitted in stage 1.</p>
</td></tr>  
<tr><td><code>Results.Stage.2</code></td>
<td>
<p>An object of class <code>lm</code> (linear model) that contains the parameter estimates of the regression model that is fitted in stage 2 of the analysis.</p>
</td></tr>
<tr><td><code>Trial.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level coefficient of determination (<code class="reqn">R^2_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R2</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level coefficient of determination (<code class="reqn">R^2_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Trial.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the trial-level correlation coefficient (<code class="reqn">R_{trial}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Indiv.R</code></td>
<td>
<p>A <code>data.frame</code> that contains the individual-level correlation coefficient (<code class="reqn">R_{indiv}</code>), its standard error and confidence interval.</p>
</td></tr>
<tr><td><code>Cor.Endpoints</code></td>
<td>
<p>A <code>data.frame</code> that contains the correlations between the surrogate and the true endpoint in the control treatment group (i.e., <code class="reqn">\rho_{T0S0}</code>) and in the experimental treatment group (i.e., <code class="reqn">\rho_{T1S1}</code>), their standard errors and their confidence intervals.</p>
</td></tr>
<tr><td><code>D.Equiv</code></td>
<td>
<p>The variance-covariance matrix of the trial-specific intercept and treatment effects for the surrogate and true endpoints (when a full or semi-reduced model is fitted, i.e., when <code>Model=c("Full")</code> or <code>Model=c("SemiReduced")</code> is used in the function call), or the variance-covariance matrix of the trial-specific treatment effects for the surrogate and true endpoints (when a reduced model is fitted, i.e., when <code>Model=c("Reduced")</code> is used in the function call).  The variance-covariance matrix <code>D.Equiv</code> is equivalent to the <code class="reqn">\bold{D}</code> matrix that would be obtained when a (full or reduced) bivariate mixed-effects approach is used; see function <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>).</p>
</td></tr>
<tr><td><code>ICA</code></td>
<td>
<p>A fitted object of class <code>ICA.ContCont</code>.</p>
</td></tr>
<tr><td><code>T0T0</code></td>
<td>
<p>The variance of the true endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>T1T1</code></td>
<td>
<p>The variance of the true endpoint in the experimental treatment condition.</p>
</td></tr>
<tr><td><code>S0S0</code></td>
<td>
<p>The variance of the surrogate endpoint in the control treatment condition.</p>
</td></tr>
<tr><td><code>S1S1</code></td>
<td>
<p>The variance of the surrogate endpoint in the experimental treatment condition.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wim Van der Elst, Ariel Alonso, &amp; Geert Molenberghs
</p>


<h3>References</h3>

<p>Burzykowski, T., Molenberghs, G., &amp; Buyse, M. (2005). <em>The evaluation of surrogate endpoints</em>. New York: Springer-Verlag.
</p>
<p>Buyse, M., Molenberghs, G., Burzykowski, T., Renard, D., &amp; Geys, H. (2000). The validation of surrogate endpoints in meta-analysis of randomized experiments. <em>Biostatistics, 1,</em> 49-67.
</p>
<p>Tibaldi, F., Abrahantes, J. C., Molenberghs, G., Renard, D., Burzykowski, T., Buyse, M., Parmar, M., et al., (2003). Simplified hierarchical linear models for the evaluation of surrogate endpoints. <em>Journal of Statistical Computation and Simulation, 73,</em> 643-658.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+UnifixedContCont">UnifixedContCont</a></code>, <code><a href="#topic+BifixedContCont">BifixedContCont</a></code>, <code><a href="#topic+BimixedContCont">BimixedContCont</a></code>, <code><a href="#topic+plot+20Meta-Analytic">plot Meta-Analytic</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  #Time consuming code part
# Conduct an analysis based on a simulated dataset with 2000 patients, 100 trials, 
# and Rindiv=Rtrial=.8
# Simulate the data:
Sim.Data.MTS(N.Total=2000, N.Trial=100, R.Trial.Target=.8, R.Indiv.Target=.8,
Seed=123, Model="Reduced")

# Fit a reduced univariate mixed-effects model without weighting to assess surrogacy:
Sur &lt;- UnimixedContCont(Dataset=Data.Observed.MTS, Surr=Surr, True=True, Treat=Treat, 
Trial.ID=Trial.ID, Pat.ID=Pat.ID, Model="Reduced", Weighted=FALSE)

# Show a summary and plots of the results:
summary(Sur)
plot(Sur, Weighted=FALSE)
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
