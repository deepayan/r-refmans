<!DOCTYPE html><html><head><title>Help for package lipidomeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lipidomeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cancerlipidome'><p>Levels of lipids in benign and malignant breast tumors in humans.</p></a></li>
<li><a href='#compute_F_test_with_limma'><p>Compute an F-test for a multi-level factor independent variable</p></a></li>
<li><a href='#compute_models_with_limma'><p>Compute lipid-specific regression models</p></a></li>
<li><a href='#compute_post_hoc_test_with_limma'><p>Compute pairwise post-hoc comparisons for a multi-level factor</p></a></li>
<li><a href='#heatmap_lipidome'><p>Create 'lipidomeR' heatmaps of arbitrary lipid-specific values.</p></a></li>
<li><a href='#heatmap_lipidome_from_limma'><p>Create 'lipidomeR' heatmaps of model statistics</p></a></li>
<li><a href='#humanlipidome'><p>Concentrations of lipids in a human plasma reference sample</p></a></li>
<li><a href='#install_Bioconductor_dependencies'><p>Install the Bioconductor dependencies for the 'lipidomeR'</p></a></li>
<li><a href='#liverlipidome'><p>Levels of lipids in the human liver with or without non-alcoholic liver</p>
disease (NAFLD).</a></li>
<li><a href='#map_lipid_names'><p>Enumerate lipid names into values about lipid class, size and saturation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Integrative Visualizations of the Lipidome</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Create lipidome-wide heatmaps of statistics with the 'lipidomeR'.
    The 'lipidomeR' provides a streamlined pipeline for the systematic 
    interpretation of the lipidome through publication-ready visualizations 
    of regression models fitted on lipidomics data. 
    With 'lipidomeR', associations between covariates and the lipidome 
    can be interpreted systematically and intuitively through heatmaps, where 
    lipids are categorized by the lipid class and are presented on 
    two-dimensional maps organized by the lipid size and level of saturation. 
    This way, the 'lipidomeR' helps you gain an immediate understanding of 
    the multivariate patterns in the lipidome already at first glance.
    You can create lipidome-wide heatmaps of statistical associations, changes, 
    differences, variation, or other lipid-specific values.  
    The heatmaps are provided with publication-ready quality and the results 
    behind the visualizations are based on rigorous statistical models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://tommi-s.github.io/">https://tommi-s.github.io/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>BiocManager, dplyr, ggplot2, knitr, limma, reshape2,
shadowtext, stringr, tableone, tidyr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-03-06 18:08:12 UTC; tomsuv</td>
</tr>
<tr>
<td>Author:</td>
<td>Tommi Suvitaival <a href="https://orcid.org/0000-0002-2583-4912"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tommi Suvitaival &lt;TSUV0001@RegionH.DK&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-03-15 10:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cancerlipidome'>Levels of lipids in benign and malignant breast tumors in humans.</h2><span id='topic+cancerlipidome'></span>

<h3>Description</h3>

<p>This data set contains levels of 409 named lipids in 118 human breast tumor
tissue samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data( cancerlipidome )
</code></pre>


<h3>Format</h3>

<p>A long-format data frame with 48262 rows and 7 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Participant number</p>
</dd>
<dt>Group</dt><dd><p>Diagnosis of the type tumor: benign, cancer, or metastasis</p>
</dd>
<dt>Race</dt><dd><p>Ethnic background of the participant</p>
</dd>
<dt>Stage</dt><dd><p>Diagnosis of the stage of the tumor</p>
</dd>
<dt>Type</dt><dd><p>Sub-type of the breast tumor. IDC: Invasive Ductal Carcinoma</p>
</dd>
<dt>Lipid_Name</dt><dd><p>Name of the lipid. The names are in
the format 'XY(C:D)', where 'XY' is the abbreviation of the lipid
class, 'C' is the total number of carbon atoms in the fatty-acid
chains, and 'D' is the total number of double-bonds in the fatty
acid chains.</p>
</dd>
<dt>Lipid_Level</dt><dd><p>Measured level of the lipid.</p>
</dd>
</dl>


<h3>Source</h3>

<p>This data is available at the NIH Common Fund's National
Metabolomics Data Repository (NMDR) website, the Metabolomics Workbench,
<a href="https://www.metabolomicsworkbench.org">https://www.metabolomicsworkbench.org</a>,
where it has been assigned Project ID PR000742.
The data can be accessed directly via its Project DOI:
<a href="http://dx.doi.org/10.21228/M8RX01">10.21228/M8RX01</a>.
This work was supported by NIH grant, U2C- DK119886.
</p>


<h3>References</h3>

<p>Purwaha, P., et al.
Unbiased lipidomic profiling of triple-negative breast cancer tissues
reveals the association of sphingomyelin levels with patient disease-free
survival.
Metabolites 8, 41 (2018)
(<a href="https://doi.org/10.3390/metabo8030041">doi: 10.3390/metabo8030041</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Import the data set.
data( cancerlipidome )

# Convert the data into wide format, where each lipid is one column and
# each sample is one row.
cancerlipidome.wide &lt;-
   tidyr::pivot_wider(
       data = cancerlipidome,
       names_from = Lipid_Name,
       values_from = Lipid_Level
   )
# Inspect the data frame.
# View( cancerlipidome.wide )
# Create a mapping of the lipid names.
names.mapping &lt;-
   map_lipid_names( x = unique( cancerlipidome$"Lipid_Name" ) )
# Compute the regression models.
result.limma &lt;-
   compute_models_with_limma(
       x = cancerlipidome.wide,
       dependent.variables = names.mapping$"Name",
       independent.variables = c( "Group" )
   )

# Create a figure of all lipids and factors.
figure.output &lt;-
  heatmap_lipidome_from_limma(
    x = result.limma$"model",
    names.mapping = names.mapping,
    axis.x.carbons = FALSE,
    class.facet = "row",
    plot.all = TRUE,
    plot.individual = FALSE,
    print.figure = TRUE,
    scales = "free",
    space = "free"
  )

# Create individual figures for each factor.
figure.output &lt;-
   heatmap_lipidome_from_limma(
       x = result.limma$"model",
       names.mapping = names.mapping,
       axis.x.carbons = FALSE,
       class.facet = "wrap",
       omit.class = "PA",
       plot.all = FALSE,
       plot.individual = TRUE,
       print.figure = FALSE,
       scales = "free",
       space = "free"
   )
# Print the figure of differences between cancer and benign tumors.
print( figure.output[[ "GroupCancer" ]] )

</code></pre>

<hr>
<h2 id='compute_F_test_with_limma'>Compute an F-test for a multi-level factor independent variable</h2><span id='topic+compute_F_test_with_limma'></span>

<h3>Description</h3>

<p>Use this to achieve analysis of variance (ANOVA) or analysis of covariance
(ANCOVA). The F-test is based on a model produced by the function
<code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code>.
To use this function, first call the function
<code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_F_test_with_limma(x, p.adj.threshold = 0.05, print.table = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_F_test_with_limma_+3A_x">x</code></td>
<td>
<p>(Required) list of models for which the test will be done.
The F-test will be computed for the first independent variable that was
specified in the <code>independent.variables</code> argument to the
function <code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code>.</p>
</td></tr>
<tr><td><code id="compute_F_test_with_limma_+3A_p.adj.threshold">p.adj.threshold</code></td>
<td>
<p>(Optional) numeric value specifying the threshold
for statistical significance of difference after correction for multiple
testing.</p>
</td></tr>
<tr><td><code id="compute_F_test_with_limma_+3A_print.table">print.table</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Print the results
of the test?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List <code>x</code> supplemented by the results of the F-test.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> for the model computation
step that is required prior to calling this function.
</p>
<p><code><a href="#topic+compute_post_hoc_test_with_limma">compute_post_hoc_test_with_limma</a></code> for the pairwise
post-hoc comparisons that may follow the F-test done with this function.
</p>

<hr>
<h2 id='compute_models_with_limma'>Compute lipid-specific regression models</h2><span id='topic+compute_models_with_limma'></span>

<h3>Description</h3>

<p>Use this function to computing multiple regression models that can be
directly supplied to the visualization functions of the 'lipidomeR'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_models_with_limma(
  x,
  dependent.variables,
  independent.variables,
  random.effect = NULL,
  formula = NULL,
  F.test = FALSE,
  print.table1 = FALSE,
  scale.dependent.variables = TRUE,
  scale.independent.variables = FALSE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_models_with_limma_+3A_x">x</code></td>
<td>
<p>(Required) data matrix.</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_dependent.variables">dependent.variables</code></td>
<td>
<p>(Required) vector of names of dependent variables.
These should be the names of the lipids.</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_independent.variables">independent.variables</code></td>
<td>
<p>(Required) vector of names of the independent variables.
These should be the names of the variables defining the experiment design.</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_random.effect">random.effect</code></td>
<td>
<p>(Optional) name of a single variable specifying
the random effect for a random-effects model.
For instance, <code>ID</code> specifies a random effect as in
<code>limma::duplicateCorrelation( ..., block = x$'ID' )</code>.</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_formula">formula</code></td>
<td>
<p>(Optional) character string of model formula in the format accepted by
the function <code><a href="stats.html#topic+model.matrix">model.matrix</a></code> and starting with <code>~</code>.
Variables mentioned in the formula should be included in
the <code>independent.variables</code> argument.
For instance, <code>Group * Treatment</code>.</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_f.test">F.test</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>:
Should an F-test for analysis of variance (ANOVA) or
analysis of covariance (ANCOVA) be computed?</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_print.table1">print.table1</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>:
Should a summary table of the independent variables be printed?</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_scale.dependent.variables">scale.dependent.variables</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>:
Should dependent variables be scaled to zero-mean and unit-variance
prior to model fitting?</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_scale.independent.variables">scale.independent.variables</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>:
Should independent variables be scaled to zero-mean and unit-variance
prior to model fitting?</p>
</td></tr>
<tr><td><code id="compute_models_with_limma_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Print messages from
the model fitting?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of regression results the that can be directly supplied as
an argument to the function <code><a href="#topic+heatmap_lipidome_from_limma">heatmap_lipidome_from_limma</a></code> and
other visualization functions of the lipidomeR.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heatmap_lipidome_from_limma">heatmap_lipidome_from_limma</a></code> for visualizing the
output of this function.
</p>

<hr>
<h2 id='compute_post_hoc_test_with_limma'>Compute pairwise post-hoc comparisons for a multi-level factor</h2><span id='topic+compute_post_hoc_test_with_limma'></span>

<h3>Description</h3>

<p>Use this function to achieve the post-hoc comparisons between the
multiple levels of an independent variable. These comparisons follow
analysis of variance (ANOVA) or analysis of covariance (ANCOVA).
The pairwise comparisons are based on a result of an F-test produced by
the function <code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code>.
To use this function, first call the functions
<code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> and
<code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code> consecutively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_post_hoc_test_with_limma(
  x,
  p.adj.threshold = NULL,
  remap.level.names = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_post_hoc_test_with_limma_+3A_x">x</code></td>
<td>
<p>(Required) list of models for which the test will be done.
The pairwise comparisons will be computed using the levels of the first
independent variable that was specified in
the <code>independent.variables</code> argument to the
function <code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code>. The comparisons will be
computed for the lipids that had an F-test result of statistical
significance from the function <code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code>.</p>
</td></tr>
<tr><td><code id="compute_post_hoc_test_with_limma_+3A_p.adj.threshold">p.adj.threshold</code></td>
<td>
<p>(Optional) numeric value specifying the threshold of
statistical significance in the pairwise comparisons after a correction
for multiple testing. We recommend to leave this argument unfilled,
leading to the same threshold to be used as in the preceding F-test.</p>
</td></tr>
<tr><td><code id="compute_post_hoc_test_with_limma_+3A_remap.level.names">remap.level.names</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should
the levels of the factor independent variable be re-mapped? This feature
can be used to solve a problem with the factor levels, which may occur
in some versions of the <code>limma</code> package. We recommend to keep this
argument unchanged from the default value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List <code>x</code> supplemented by the results of the pairwise
post-hoc comparisons.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> for the model computation
step that is required prior to calling this function.
</p>
<p><code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code> for the F-test step that is
required prior to calling this function.
</p>

<hr>
<h2 id='heatmap_lipidome'>Create 'lipidomeR' heatmaps of arbitrary lipid-specific values.</h2><span id='topic+heatmap_lipidome'></span>

<h3>Description</h3>

<p>Use this function to create a heatmap of any lipid-specific values.
Note: Use the function <code><a href="#topic+heatmap_lipidome_from_limma">heatmap_lipidome_from_limma</a></code> to create
heatmaps of model statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_lipidome(
  x,
  names.mapping,
  axis.x.carbons = TRUE,
  class.facet = "row",
  fill.direction = "increasing",
  fill.limits = c(0, 40),
  fill.midpoint = 20,
  melt.value.name = "CV",
  melt.variable.name = NULL,
  melt.x = TRUE,
  range.min.N.carbons = 5,
  range.min.N.double.bonds = 5,
  scale.fill.log = NULL,
  scales = "free_y",
  space = "free",
  x.names = "row.names",
  x.variables = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_lipidome_+3A_x">x</code></td>
<td>
<p>(Required) named vector of numeric values to create a figure of.
Names need to match to the argument names.mapping through
the function <code><a href="#topic+map_lipid_names">map_lipid_names</a></code>. Alternatively, a data frame
can be supplied. In that case, set <code>melt.x = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_names.mapping">names.mapping</code></td>
<td>
<p>(Required) mapping of lipid names from
the <code><a href="#topic+map_lipid_names">map_lipid_names</a></code> function.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_axis.x.carbons">axis.x.carbons</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should
the lipid size (i.e., number of carbon atoms in the fatty acid chain) be
presented on the x-axis or y-axis?</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_class.facet">class.facet</code></td>
<td>
<p>(Optional) character string with possible values
<code>'col'</code>, <code>'row'</code> or <code>'wrap'</code>:
Present lipid classes as panels organized into columns, rows or into a
wrapped layout spanning over multiple rows and columns. The alternative
<code>'wrap'</code> is only available with <code>plot.infividual = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_fill.direction">fill.direction</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should color
fill be in an increasing direction?</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_fill.limits">fill.limits</code></td>
<td>
<p>(Optional) numeric vector of length two, indicating
the limits of the fill scale.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_fill.midpoint">fill.midpoint</code></td>
<td>
<p>(Optional) numeric value specifying the midpoint of
the fill scale.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_melt.value.name">melt.value.name</code></td>
<td>
<p>(Optional) character string, specifying the name of
the variable that will be shown as fill in the heatmap.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_melt.variable.name">melt.variable.name</code></td>
<td>
<p>(Optional) character string, specifying the name of
of the variable that will be used to creating faceted sub-heatmaps.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_melt.x">melt.x</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should the argument
<code>x</code> be molten by the function <code><a href="reshape2.html#topic+melt">melt</a></code>
prior to plotting? Set <code>melt.x = TRUE</code>, if you want to plot a data
frame instead of a vector of values. In that case, each column of the
data frame will be plotted as an individual facet.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_range.min.n.carbons">range.min.N.carbons</code></td>
<td>
<p>(Optional) numeric value to specify the minimum
range of the axis showing the lipid size (number of carbon atoms in the
fatty acid chains). This value can be increased from the default value to
improve readability in situtions, where there are lipid classes with
little or no variation in the lipid size.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_range.min.n.double.bonds">range.min.N.double.bonds</code></td>
<td>
<p>(Optional) numeric value to specify
the minimum range of the axis showing the lipid saturation (number of
double bonds in the fatty acid chains). This value can be increased from
the default value to improve readability in situtions, where there are
lipid classes with little or no variation in the lipid saturation.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_scale.fill.log">scale.fill.log</code></td>
<td>
<p>(Optional) numeric value specifying the base of
the logarithm, which will be used to creating a logarithmic scale for
the fill scale of the plot.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_scales">scales</code></td>
<td>
<p>(Optional) character string with possible values
<code>'fixed'</code>, <code>'free'</code>, <code>'free_x'</code> or <code>'free_y'</code>. This
argument specifies, whether the axes in multiple sub-heatmaps will be in
the same scale (<code>'fixed'</code>) or in a scale specific to each sub-figure.
See the function <code><a href="ggplot2.html#topic+facet_grid">facet_grid</a></code> for details.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_space">space</code></td>
<td>
<p>(Optional) character string with possible values
<code>'fixed'</code>, <code>'free'</code>, <code>'free_x'</code> or <code>'free_y'</code>.
This argument specifies, whether the sub-heatmaps will be of identical
size (<code>'fixed'</code>) or not.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_x.names">x.names</code></td>
<td>
<p>(Optional) character string specifying the name of the
variable in the argument <code>x</code>, which will be used to matching
the values to the argument <code>names.mapping</code>.
Use this argument only together with <code>melt.x = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_+3A_x.variables">x.variables</code></td>
<td>
<p>(Optional) character vector specifying the names of
the variables, which will be included as individual facets in
the figure.
Use this argument only together with <code>melt.x = TRUE</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='heatmap_lipidome_from_limma'>Create 'lipidomeR' heatmaps of model statistics</h2><span id='topic+heatmap_lipidome_from_limma'></span>

<h3>Description</h3>

<p>Use this function to creating heatmaps of model statistics from
the output of the <code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> function or
related functions (<code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code> and
<code><a href="#topic+compute_post_hoc_test_with_limma">compute_post_hoc_test_with_limma</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>heatmap_lipidome_from_limma(
  x,
  names.mapping = NULL,
  axis.x.carbons = TRUE,
  baseline.adjusted = FALSE,
  class.facet = "row",
  class.subset = NULL,
  F.test = FALSE,
  omit.class = NULL,
  omit.factor = NULL,
  order.factor = FALSE,
  p.val.thresholds = c(0.01, 0.05, 0.1),
  p.val.labels = c(8, 4, 3),
  p.val.label.bg.size = 2,
  p.val.label.size = 1,
  p.adj.method = "BH",
  plot.individual = FALSE,
  plot.all = TRUE,
  print.figure = TRUE,
  print.formula = TRUE,
  formula.width = 110,
  legend.key.size.multiplier = 2,
  range.min.N.carbons = 5,
  range.min.N.double.bonds = 5,
  scales = "fixed",
  shadowtext = FALSE,
  space = "free",
  survival = FALSE,
  verbose = FALSE,
  wrap.contrast.name = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_x">x</code></td>
<td>
<p>(Required) list of output from
the <code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> function or related functions.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_names.mapping">names.mapping</code></td>
<td>
<p>(Optional) mapping of lipid names from
the <code><a href="#topic+map_lipid_names">map_lipid_names</a></code> function.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_axis.x.carbons">axis.x.carbons</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should
the lipid size (i.e., number of carbon atoms in the fatty acid chain) be
presented on the x-axis or y-axis?</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_baseline.adjusted">baseline.adjusted</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>: Is the model object
that is specified as argument <code>x</code> a baseline-adjusted regression
model? (Note: this model type is not yet provided in the package.)</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_class.facet">class.facet</code></td>
<td>
<p>(Optional) character string with possible values
<code>'col'</code>, <code>'row'</code> or <code>'wrap'</code>:
Present lipid classes as panels organized into columns, rows or into a
wrapped layout spanning over multiple rows and columns. The alternative
<code>'wrap'</code> is only available with <code>plot.infividual = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_class.subset">class.subset</code></td>
<td>
<p>(Optional) character vector specifying a subset of
the lipid classes (e.g., <code>c( 'PC', 'SM', 'TG' )</code>). Same outcome
can be achieved with the argument <code>omit.class</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_f.test">F.test</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should the result of
an F-test be visualized instead of individual model coefficients?
Result from the function <code><a href="#topic+compute_F_test_with_limma">compute_F_test_with_limma</a></code> needs
to be provided as argument <code>x</code> for the
<code><a href="#topic+heatmap_lipidome_from_limma">heatmap_lipidome_from_limma</a></code> function along with
the argument <code>F.test = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_omit.class">omit.class</code></td>
<td>
<p>(Optional) character vector of lipid classes omitted from
the visualization (e.g., <code>c( 'PC', 'SM', 'TG' )</code>).</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_omit.factor">omit.factor</code></td>
<td>
<p>(Optional) character vector of lipid classes omitted from
the visualization (e.g., <code>c( 'Time' )</code>).</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_order.factor">order.factor</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Sort the factor
panels alphabetically?</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_p.val.thresholds">p.val.thresholds</code></td>
<td>
<p>(Optional) numeric vector with increasing values of
highlighting thresholds for multiple-testing-corrected p-values.
For instance, <code>c( 0.01, 0.05, 0.1 )</code> gives distinct highlighting of
associations in the ranges <code class="reqn">p &lt; 0.01</code>, <code class="reqn">0.01 \geq p &lt; 0.05</code>, and
<code class="reqn">0.05 \geq p &lt; 0.1</code>. If the number of these categories is changed from
the default value, also the argument <code>p.val.labels</code> needs to be
modified to match it.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_p.val.labels">p.val.labels</code></td>
<td>
<p>(Optional) numeric vector of point characters for the
p-value highlighting categories specified in the argument
<code>p.val.thresholds</code>. The values need to be compatible with
the function <code><a href="ggplot2.html#topic+scale_shape_manual">scale_shape_manual</a></code>.
If the number of these labels is changed from the default value, also
the argument <code>p.val.thresholds</code> needs to be modified to match it.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_p.val.label.bg.size">p.val.label.bg.size</code></td>
<td>
<p>(Optional) numeric value to scale the size of
the colored background of the symbols that indicate values with
statistical significance. The background is used to ensure that
the white symbols are visible also when the color of a heatmap
rectangle is of a bleak color.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_p.val.label.size">p.val.label.size</code></td>
<td>
<p>(Optional) numeric value to scale the size of the
symbols that indicate values with statistical significance.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_p.adj.method">p.adj.method</code></td>
<td>
<p>(Optional) name of the method to correct p-values for
multiple testing. Accepted values are as in the function
<code>stats::p.adjust()</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_plot.individual">plot.individual</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Create
specific figures for each coefficient of the model? For models with many
independent variables, this may take some time to complete.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_plot.all">plot.all</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Create
a combined figure of all the coefficients of the model? For models with
many independent variables, this may lead to too busy a figure.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_print.figure">print.figure</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Print created
figure(s) to the standard output? Note that when
<code>plot.individual = TRUE</code>, multiple figures will be printed
consecutively.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_print.formula">print.formula</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Add
the model formula as a title to the figure? We recommend to use
<code>print.formula = TRUE</code> to make the result more understandable and
reproducible.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_formula.width">formula.width</code></td>
<td>
<p>(Optional) numeric value to specify the width of a line
in the model formula. Relevant only if <code>print.formula = TRUE</code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_legend.key.size.multiplier">legend.key.size.multiplier</code></td>
<td>
<p>(Optional) numeric value to scale the size
of the figure (key) legends.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_range.min.n.carbons">range.min.N.carbons</code></td>
<td>
<p>(Optional) numeric value to specify the minimum
range of the axis showing the lipid size (number of carbon atoms in the
fatty acid chains). This value can be increased from the default value to
improve readability in situations, where there are lipid classes with
little or no variation in the lipid size.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_range.min.n.double.bonds">range.min.N.double.bonds</code></td>
<td>
<p>(Optional) numeric value to specify
the minimum range of the axis showing the lipid saturation (number of
double bonds in the fatty acid chains). This value can be increased from
the default value to improve readability in situtions, where there are
lipid classes with little or no variation in the lipid saturation.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_scales">scales</code></td>
<td>
<p>(Optional) character string with possible values
<code>'fixed'</code>, <code>'free'</code>, <code>'free_x'</code> or <code>'free_y'</code>. This
argument specifies, whether the axes in multiple sub-heatmaps will be in
the same scale (<code>'fixed'</code>) or in a scale specific to each sub-figure.
See the function <code><a href="ggplot2.html#topic+facet_grid">facet_grid</a></code> for details.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_shadowtext">shadowtext</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Should an
alternative method of statistical significance highlighting be used in
the figure? If <code>TRUE</code>, highlighting will be based on the function
<code><a href="shadowtext.html#topic+geom_shadowtext">geom_shadowtext</a></code>.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_space">space</code></td>
<td>
<p>(Optional) character string with possible values
<code>'fixed'</code>, <code>'free'</code>, <code>'free_x'</code> or <code>'free_y'</code>.
This argument specifies, whether the sub-heatmaps will be of identical
size (<code>'fixed'</code>) or not.
See the function <code><a href="ggplot2.html#topic+facet_grid">facet_grid</a></code> for details.</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_survival">survival</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Is the model object
that is specified as argument <code>x</code> a survival model?
(Note: this model type is not yet provided in the package.)</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_verbose">verbose</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Print information
about the progress of the function call?</p>
</td></tr>
<tr><td><code id="heatmap_lipidome_from_limma_+3A_wrap.contrast.name">wrap.contrast.name</code></td>
<td>
<p>(Optional) <code>TRUE</code> or <code>FALSE</code>: Wrap
the name of a contrast to multiple lines to ensure readability?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of 'lipidomeR' heatmap figure(s).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compute_models_with_limma">compute_models_with_limma</a></code> for computing the argument
<code>x</code> for this function.
</p>

<hr>
<h2 id='humanlipidome'>Concentrations of lipids in a human plasma reference sample</h2><span id='topic+humanlipidome'></span>

<h3>Description</h3>

<p>This data set contains concentrations of 403 named lipids in the 'National
Institute of Standards and Technology Human Plasma Standard Reference
Material' (NIST SRM 1950).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data( humanlipidome )
</code></pre>


<h3>Format</h3>

<p>A data frame with 403 rows and 2 variables:
</p>

<dl>
<dt>Name</dt><dd><p>Name of the lipid. The names are in
the format 'XY(C:D)', where 'XY' is the abbreviation of the lipid
class, 'C' is the total number of carbon atoms in the fatty-acid
chains, and 'D' is the total number of double-bonds in the fatty
acid chains.</p>
</dd>
<dt>Concentration</dt><dd><p>Concentration of the lipid (umol/mL)</p>
</dd>
</dl>


<h3>Source</h3>

<p>This data is available at the NIH Common Fund's National
Metabolomics Data Repository (NMDR) website, the 'Metabolomics Workbench',
<a href="https://www.metabolomicsworkbench.org">https://www.metabolomicsworkbench.org</a>,
where it has been assigned Project ID PR000004.
The data can be accessed directly via its Project DOI:
<a href="http://dx.doi.org/10.21228/M8MW26">10.21228/M8MW26</a>.
This work was supported by NIH grant, U2C- DK119886.
</p>


<h3>References</h3>

<p>Quehenberger, O. et al.
Lipidomics reveals a remarkable diversity of lipids in human plasma.
J Lipid Res. 51, 3299-3305 (2010)
(<a href="https://doi.org/10.1194/jlr.M009449">doi: 10.1194/jlr.M009449</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data set.
data( humanlipidome )
# Transform the concentrations into log-10 scale.
humanlipidome$"Concentration_log10_umol_per_mL" &lt;-
   log10( humanlipidome$"Concentration" )
# Enumerate the lipid names into values.
names.mapping &lt;- map_lipid_names( x = humanlipidome$"Name" )
# Create the lipidomeR heatmap of lipid concentrations.
heatmap_lipidome(
   x = humanlipidome[ , c( "Name", "Concentration_log10_umol_per_mL" ) ],
   names.mapping = names.mapping,
   class.facet = "wrap",
   x.names = "Name",
   fill.limits =
       range(
           x = humanlipidome$"Concentration_log10_umol_per_mL",
           na.rm = TRUE
       ),
   fill.midpoint =
       sum(
           range(
               x = humanlipidome$"Concentration_log10_umol_per_mL",
               na.rm = TRUE
           )
       ) / 2,
   melt.value.name = "Concentration_umol_per_mL_log10",
   scales = "free"
)

</code></pre>

<hr>
<h2 id='install_Bioconductor_dependencies'>Install the Bioconductor dependencies for the 'lipidomeR'</h2><span id='topic+install_Bioconductor_dependencies'></span>

<h3>Description</h3>

<p>Run this function, if you encounter an error with missing packages,
such as, <a href="https://doi.org/doi:10.18129/B9.bioc.limma">limma</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>install_Bioconductor_dependencies(pkgs.bioconductor = c("limma"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="install_Bioconductor_dependencies_+3A_pkgs.bioconductor">pkgs.bioconductor</code></td>
<td>
<p>Character vector of Bioconductor packages to
install.</p>
</td></tr>
</table>

<hr>
<h2 id='liverlipidome'>Levels of lipids in the human liver with or without non-alcoholic liver
disease (NAFLD).</h2><span id='topic+liverlipidome'></span>

<h3>Description</h3>

<p>This data set contains levels of 383 named lipids in 88 liver tissue samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data( liverlipidome )
</code></pre>


<h3>Format</h3>

<p>A long-format data frame with 33704 rows and 13 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Participant number</p>
</dd>
<dt>Diagnosis</dt><dd><p>Diagnosis of the liver: normal, steatosis, non-alcoholic
steatohepatitis (NASH), or cirrhosis</p>
</dd>
<dt>Gender</dt><dd><p>Gender of the participant</p>
</dd>
<dt>BMI</dt><dd><p>Body-mass-index (BMI) of the participant</p>
</dd>
<dt>Ethnicity</dt><dd><p>Ethnicity of the participant</p>
</dd>
<dt>Age</dt><dd><p>Age of the participant</p>
</dd>
<dt>AST</dt><dd><p>Aspartate aminotransferase blood test (U/l)</p>
</dd>
<dt>ALT</dt><dd><p>Alanine aminotransferase blood test (U/l)</p>
</dd>
<dt>ALKP</dt><dd><p>Alkaline phosphatase blood test (U/l)</p>
</dd>
<dt>TBIL</dt><dd><p>Total bilirubin blood test (mg/dl)</p>
</dd>
<dt>Glucose</dt><dd><p>Glucose blood test (mg/dl)</p>
</dd>
<dt>Type</dt><dd><p>Sub-type of the breast tumor. IDC: Invasive Ductal Carcinoma</p>
</dd>
<dt>Lipid_Name</dt><dd><p>Name of the lipid. The names are in
the format 'XY(C:D)', where 'XY' is the abbreviation of the lipid
class, 'C' is the total number of carbon atoms in the fatty-acid
chains, and 'D' is the total number of double-bonds in the fatty
acid chains.</p>
</dd>
<dt>Lipid_Level</dt><dd><p>Measured level of the lipid.</p>
</dd>
</dl>


<h3>Source</h3>

<p>This data is available at the NIH Common Fund's National
Metabolomics Data Repository (NMDR) website, the 'Metabolomics Workbench',
<a href="https://www.metabolomicsworkbench.org">https://www.metabolomicsworkbench.org</a>,
where it has been assigned Project ID PR000633.
The data can be accessed directly via its Project DOI:
<a href="http://dx.doi.org/10.21228/M8MW26">10.21228/M8MW26</a>.
This work was supported by NIH grant, U2C- DK119886.
</p>


<h3>References</h3>

<p>Gorden, D. Lee, et al.
Biomarkers of NAFLD Progression: a Lipidomics Approach to an Epidemic.
J Lip Res. 56(3) 722-36 (2015)
(<a href="https://dx.doi.org/10.1194/jlr.P056002">doi: 10.1194/jlr.P056002</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load the data set.
data( liverlipidome )
# Convert the data into wide format, where each lipid is one column and
# each sample is one row.
liverlipidome.wide &lt;-
   tidyr::pivot_wider(
       data = liverlipidome,
       names_from = Lipid_Name,
       values_from = Lipid_Level
   )
# Create a mapping of the lipid names.
names.mapping &lt;-
   map_lipid_names( x = unique( liverlipidome$"Lipid_Name" ) )
# Compute the regression models.
result.limma &lt;-
   compute_models_with_limma(
       x = liverlipidome.wide,
       dependent.variables = names.mapping$"Name",
       independent.variables = c( "Diagnosis" ),
       F.test = TRUE # Compute an F-test for a factor variable.
   )
# Compute the F-test.
result.limma &lt;- compute_F_test_with_limma( x = result.limma )
# Print a figure of the F-test.

figure.output &lt;-
  heatmap_lipidome_from_limma(
      x = result.limma,
      names.mapping = names.mapping,
      F.test = TRUE,
      axis.x.carbons = FALSE,
      class.facet = "wrap",
      plot.all = FALSE,
      plot.individual = TRUE,
      scales = "free",
      space = "free"
  )

# Compute pairwise post-hoc comparisons between the factor levels for
# the dependent variables (i.e., lipids) with a significant F-test result.
result.limma &lt;-
   compute_post_hoc_test_with_limma(
       x = result.limma,
       remap.level.names = TRUE
   )
# Print a figure of all post-hoc comparisons.

figure.output &lt;-
    heatmap_lipidome_from_limma(
    x = result.limma$"result.post.hoc.test",
    names.mapping = names.mapping,
    axis.x.carbons = FALSE,
    plot.all = TRUE,
    plot.individual = FALSE,
    scales = "free",
    space = "free"
)

# Specify the contrasts of the post-hoc comparison that will be included
# in the figure.
contrasts.included &lt;-
   c( "DiagnosisSteatosis", "DiagnosisNASH", "DiagnosisCirrhosis" )
# Get the omitted contrasts based on the above definition.
contrasts.omitted &lt;-
   colnames( result.limma$"result.post.hoc.test"$"p.value" )[
       !(
           colnames( result.limma$"result.post.hoc.test"$"p.value" ) %in%
           contrasts.included
       )
   ]
# Find dependent variables (i.e., lipids) that have any significant
# difference.
has.any.significant &lt;-
   apply(
       X =
           result.limma$"result.post.hoc.test"$"p.value"[
               ,
               contrasts.included
           ],
       MAR = 2,
       FUN = p.adjust,
       method = "BH"
   )
has.any.significant &lt;-
   rownames(
       has.any.significant[
           apply(
               X = has.any.significant &lt; 0.05,
               MAR = 1,
               FUN = any
           ),
       ]
   )
# Include in the figure only lipid classes that have at least four
# significant differences.
classes.included &lt;-
   names(
       which(
           table(
               names.mapping[
                   make.names( has.any.significant ), "Class"
               ]
           ) &gt; 4
       )
   )
classes.omitted &lt;- unique( names.mapping$"Class" )
classes.omitted &lt;-
   classes.omitted[ !( classes.omitted ) %in% classes.included ]
# Print a figure of the selected post-hoc-comparisons.
figure.output &lt;-
   heatmap_lipidome_from_limma(
       x = result.limma$"result.post.hoc.test",
       names.mapping = names.mapping,
       axis.x.carbons = FALSE,
       omit.class = classes.omitted,
       omit.factor = contrasts.omitted,
       plot.all = TRUE,
       plot.individual = FALSE,
       scales = "free",
       space = "free"
   )

</code></pre>

<hr>
<h2 id='map_lipid_names'>Enumerate lipid names into values about lipid class, size and saturation</h2><span id='topic+map_lipid_names'></span>

<h3>Description</h3>

<p>Use this function to create a mapping of the lipids to values, which can be
used to creating 'lipidomeR' heatmaps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_lipid_names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_lipid_names_+3A_x">x</code></td>
<td>
<p>(Required) character vector of lipid names. The names are expected
in the format 'XY(C:D)', where 'XY' is the abbreviation of the lipid
class, 'C' is the total number of carbon atoms in the fatty-acid
chains, and 'D' is the total number of double-bonds in the fatty
acid chains.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with lipid names in various formats for R and
the enumerated values of lipid class (<code>Class</code>), lipid size
(<code>N.carbons</code>) and lipid unsaturation (<code>N.double.bonds</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+heatmap_lipidome_from_limma">heatmap_lipidome_from_limma</a></code> for creating 'lipidomeR'
heatmaps of regression model results based on the output of this function.
</p>
<p><code><a href="#topic+heatmap_lipidome">heatmap_lipidome</a></code> for creating 'lipidomeR' heatmaps
of any lipid-specific values based on the output of this function.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
