<!DOCTYPE html><html><head><title>Help for package PhaseTypeR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PhaseTypeR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#check_phase_type'><p>Checking the basic phase-type assumptions</p></a></li>
<li><a href='#check_reward'><p>Checking reward matrix</p></a></li>
<li><a href='#DPH_functions'><p>The Univariate Discrete Phase-Type Distribution</p></a></li>
<li><a href='#generator_functions'><p>The phase-type distribution</p></a></li>
<li><a href='#MDPH_functions'><p>The Multivariate Discrete Phase-Type Distribution</p></a></li>
<li><a href='#mean'><p>Mean of Phase-Type Distributions</p></a></li>
<li><a href='#moment_mph'><p>Moments of the multivariate continuous phase-type distribution</p></a></li>
<li><a href='#moment_ph'><p>Moments of the univariate continuous phase-type distribution</p></a></li>
<li><a href='#MPH_functions'><p>The Multivariate Continuous Phase-Type Distribution</p></a></li>
<li><a href='#perm'><p>Permutations</p></a></li>
<li><a href='#PH_functions'><p>The Univariate Continuous Phase-Type Distribution</p></a></li>
<li><a href='#phase_type_to_network'><p>Phase-type distribution to network</p></a></li>
<li><a href='#print.cont_phase_type'><p>Print method for phase-type objects</p></a></li>
<li><a href='#reward_phase_type'><p>Transformation of Phase-Type Distributions via Rewards</p></a></li>
<li><a href='#summary.cont_phase_type'><p>Pretty summary of the <code>cont_phase_type</code> class.</p></a></li>
<li><a href='#summary.disc_phase_type'><p>Pretty summary of the <code>disc_phase_type</code> class.</p></a></li>
<li><a href='#summary.mult_cont_phase_type'><p>Pretty summary of the <code>mult_cont_phase_type</code> class.</p></a></li>
<li><a href='#summary.mult_disc_phase_type'><p>Pretty summary of the <code>mult_dist_phase_type</code> class.</p></a></li>
<li><a href='#var'><p>Variance and Covariance of Phase-Type Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>General-Purpose Phase-Type Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Iker Rivas-González &lt;ikerrivas96@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>General implementation of core function from phase-type
    theory. 'PhaseTypeR' can be used to model continuous and discrete
    phase-type distributions, both univariate and multivariate. The
    package includes functions for outputting the mean and (co)variance of
    phase-type distributions; their density, probability and quantile
    functions; functions for random draws; functions for
    reward-transformation; and functions for plotting the distributions as
    networks. For more information on these functions please refer to
    Bladt and Nielsen (2017, ISBN: 978-1-4939-8377-3) and Campillo Navarro
    (2019)
    <a href="https://orbit.dtu.dk/en/publications/order-statistics-and-multivariate-discrete-phase-type-distributio">https://orbit.dtu.dk/en/publications/order-statistics-and-multivariate-discrete-phase-type-distributio</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://rivasiker.github.io/PhaseTypeR/">https://rivasiker.github.io/PhaseTypeR/</a>,
<a href="https://github.com/rivasiker/PhaseTypeR">https://github.com/rivasiker/PhaseTypeR</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/rivasiker/PhaseTypeR/issues">https://github.com/rivasiker/PhaseTypeR/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>expm, igraph, methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, partitions, rmarkdown, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-21 15:52:09 UTC; au595587</td>
</tr>
<tr>
<td>Author:</td>
<td>Iker Rivas-González
    <a href="https://orcid.org/0000-0002-0515-0628"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Asger Hobolth [aut],
  Lars Nørvang Andersen [aut],
  Colin Guetemme [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-21 16:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='check_phase_type'>Checking the basic phase-type assumptions</h2><span id='topic+check_phase_type'></span>

<h3>Description</h3>

<p>This function checks whether all the elements for
building a phase-type object have the right shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_phase_type(subint_mat, init_probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_phase_type_+3A_subint_mat">subint_mat</code></td>
<td>
<p>Sub-intensity rate matrix.</p>
</td></tr>
<tr><td><code id="check_phase_type_+3A_init_probs">init_probs</code></td>
<td>
<p>Initial probability vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements of a phase-type distribution.
</p>

<hr>
<h2 id='check_reward'>Checking reward matrix</h2><span id='topic+check_reward'></span>

<h3>Description</h3>

<p>This function checks whether the shape of the reward
matrix is correct.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_reward(reward_mat, init_probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_reward_+3A_reward_mat">reward_mat</code></td>
<td>
<p>Reward matrix</p>
</td></tr>
<tr><td><code id="check_reward_+3A_init_probs">init_probs</code></td>
<td>
<p>Initial probability vector.</p>
</td></tr>
</table>

<hr>
<h2 id='DPH_functions'>The Univariate Discrete Phase-Type Distribution</h2><span id='topic+DPH_functions'></span><span id='topic+dDPH'></span><span id='topic+qDPH'></span><span id='topic+pDPH'></span><span id='topic+rDPH'></span><span id='topic+rFullDPH'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for the univariate discrete phase-type distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dDPH(x, obj)

qDPH(p, obj)

pDPH(q, obj)

rDPH(n, obj)

rFullDPH(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DPH_functions_+3A_x">x</code>, <code id="DPH_functions_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="DPH_functions_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>disc_phase_type</code>.</p>
</td></tr>
<tr><td><code id="DPH_functions_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="DPH_functions_+3A_n">n</code></td>
<td>
<p>number of observations. If length(n) &gt; 1, the length is taken to be
the number required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dDPH</code> gives the density, <code>pDPH</code> gives the
distribution function, <code>qDPH</code> gives the quantile function,
and <code>rDPH</code> generates random deviates. <code>rFullDPH</code> returns
the full path of a random draw from the distribution.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rDPH</code>,
and is the maximum of the lengths of the numerical arguments for the other
functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the
result. Only the first elements of the logical arguments are used.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dDPH</code>: Density function for the univariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>qDPH</code>: Quantile function for the univariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>pDPH</code>: Distribution function for the univariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>rDPH</code>: Random number generator for the univariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>rFullDPH</code>: Simulation of the full path for the univariate discrete phase-type distribution.
</p>
</li></ul>


<h3>See Also</h3>

<p><a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

disc_phase_type &lt;- matrix(c(0.4, 0, 0.2,
                            0.5, 0.3, 0.2,
                            0, 0.7, 0.2), ncol = 3)
Y &lt;- DPH(disc_phase_type)

dDPH(3:4, Y)
pDPH(5, Y)
qDPH(0.5, Y)
set.seed(0)
rDPH(6, Y)
rFullDPH(Y)

</code></pre>

<hr>
<h2 id='generator_functions'>The phase-type distribution</h2><span id='topic+generator_functions'></span><span id='topic+PH'></span><span id='topic+DPH'></span><span id='topic+MPH'></span><span id='topic+MDPH'></span>

<h3>Description</h3>

<p>Generator functions for the S3 classes <code>cont_phase_type</code>, <code>disc_phase_type</code>,
<code>mult_cont_phase_type</code>, <code>mult_disc_phase_type</code>, which represent the
different phase-type distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PH(subint_mat = NULL, init_probs = NULL)

DPH(subint_mat = NULL, init_probs = NULL)

MPH(subint_mat = NULL, init_probs = NULL,
    reward_mat = NULL)

MDPH(subint_mat = NULL, init_probs = NULL,
     reward_mat = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="generator_functions_+3A_subint_mat">subint_mat</code></td>
<td>
<p>a square matrix containing the transition rates or
probabilities between transient states for continuous or discrete
phase-type respectively.
If the phase-type is continuous, the sub-intensity matrix diagonal should
only contain negative values and the row sums should be non-positive.
If the phase-type is discrete, the sub-intensity matrix should only contain
values between 0 and 1.</p>
</td></tr>
<tr><td><code id="generator_functions_+3A_init_probs">init_probs</code></td>
<td>
<p>a vector, a one-row matrix or <code>NULL</code> which gives the
probabilities to start in each state. If <code>init_probs</code> is <code>NULL</code>,
the probability to start on the first state will be 1 and 0 otherwise.</p>
</td></tr>
<tr><td><code id="generator_functions_+3A_reward_mat">reward_mat</code></td>
<td>
<p>a matrix <code>NULL</code>(default) where each row is a reward
vector, and each column corresponds to a state. It should have the same
number of columns as the length of the initial probabilities.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>PH</code>, <code>DPH</code>, <code>MPH</code> and <code>MDPH</code> are the generator functions
for the four types of phase-type distribution
classes, this is, the continuous univariate, the discrete univariate, the continuous multivariate
and the discrete multivariate respectively.
The class is generated by supplying a sub-intensity matrix and an optional
initial probability vector plus a reward matrix in the case of multivariate
phase-type.
If the initial probabilities are not specified, then the initial probability
will be <code>init_probs = c(1, 0, 0, ...)</code> with the same length as the
number of transient states.
</p>


<h3>Value</h3>

<p>A phase-type object of class <code>cont_phase_type</code> for <code>PH</code>, <code>disc_phase_type</code> for <code>DPH</code>,
<code>mult_cont_phase_type</code> for <code>MPH</code>, and <code>mult_disc_phase_type</code> for <code>MDPH</code>.
All these classes inherit from <code>list</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##===========================##
## For continuous univariate ##
##===========================##

subintensity_matrix &lt;- matrix(c(-1.5, 1.5, 0,
                                 0,  -1,   1,
                                 0,   0,  -0.5),
                              ncol = 3,
                              byrow = TRUE)
PH(subintensity_matrix)

#---

subintensity_matrix &lt;- matrix(c(-1.5, 1.5, 0,
                                 0,  -1,   1,
                                 0,   0,  -0.5),
                              ncol = 3,
                              byrow = TRUE)
initial_probabilities &lt;- c(0.9, 0.1, 0)
PH(subintensity_matrix, initial_probabilities)


##=========================##
## For discrete univariate ##
##=========================##

subintensity_matrix &lt;- matrix(c(0.4, 0.24, 0.12,
                                0,   0.4,  0.2,
                                0,   0,    0.5),
                              ncol = 3,
                              byrow = TRUE)
DPH(subintensity_matrix)

#---

subintensity_matrix &lt;- matrix(c(0.4, 0.24, 0.12,
                                0,   0.4,  0.2,
                                0,   0,    0.5),
                              ncol = 3,
                              byrow = TRUE)
initial_probabilities &lt;- c(0.9, 0.1, 0)
DPH(subintensity_matrix, initial_probabilities)



##=============================##
## For continuous multivariate ##
##=============================##

subintensity_matrix &lt;- matrix(c(-3,  2,  0,
                                 0, -2,  1,
                                 0,  0, -1),
                              nrow = 3,
                              byrow = TRUE)
reward_matrix = matrix(sample(seq(0, 10, 0.1), 6), nrow = 3, ncol = 2)
initial_probabilities = c(1, 0, 0)
MPH(subintensity_matrix,
    initial_probabilities,
    reward_matrix)


##===========================##
## For discrete multivariate ##
##===========================##

subintensity_matrix &lt;- matrix(c(0.4, 0.24, 0.12,
                                0,   0.4,  0.2,
                                0,   0,    0.5),
                              ncol = 3,
                              byrow = TRUE)
reward_matrix &lt;- matrix(sample(seq(0, 10), 6), nrow = 3, ncol = 2)
initial_probabilities = c(1, 0, 0)
MDPH(subintensity_matrix,
     initial_probabilities,
     reward_mat = reward_matrix)

</code></pre>

<hr>
<h2 id='MDPH_functions'>The Multivariate Discrete Phase-Type Distribution</h2><span id='topic+MDPH_functions'></span><span id='topic+dMDPH'></span><span id='topic+qMDPH'></span><span id='topic+pMDPH'></span><span id='topic+rMDPH'></span><span id='topic+rFullMDPH'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for the multivariate discrete phase-type distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMDPH(x, obj)

qMDPH(p, obj)

pMDPH(q, obj)

rMDPH(n, obj)

rFullMDPH(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MDPH_functions_+3A_x">x</code>, <code id="MDPH_functions_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="MDPH_functions_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>mult_disc_phase_type</code>.</p>
</td></tr>
<tr><td><code id="MDPH_functions_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="MDPH_functions_+3A_n">n</code></td>
<td>
<p>number of observations. If length(n) &gt; 1, the length is taken to be
the number required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dMDPH</code> gives the density, <code>pMDPH</code> gives the
distribution function, <code>qMDPH</code> gives the quantile function,
and <code>rMDPH</code> generates random deviates. <code>rFullMDPH</code> returns
the full path of a random draw from the distribution.
</p>
<p>Each row of the result of For <code>dMDPH</code>, <code>pMDPH</code>, <code>qMDPH</code>, and
<code>rMDPH</code> corresponds to each univariate reward transformation.
For <code>dMDPH</code>, <code>qMDPH</code> and <code>pMDPH</code>, the inputs <code>x</code>,
<code>p</code> and <code>q</code> can be matrices where in row i the i_th reward
transformation and in col j the j_th value of <code>x</code>, <code>p</code> or <code>q</code>
tested.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rMDPH</code>,
and is the maximum of the lengths of the numerical arguments for the other
functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the
result. Only the first elements of the logical arguments are used.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dMDPH</code>: Density function for the multivariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>qMDPH</code>: Quantile function for the multivariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>pMDPH</code>: Distribution function for the multivariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>rMDPH</code>: Random number generator for the multivariate discrete phase-type distribution.
</p>
</li>
<li> <p><code>rFullMDPH</code>: Simulation of the full path for the multivariate discrete phase-type distribution.
</p>
</li></ul>


<h3>See Also</h3>

<p><a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
disc_phase_type &lt;- matrix(c(0.4, 0, 0.2,
                            0.5, 0.3, 0.2,
                            0, 0.7, 0.2), ncol = 3)
R &lt;- matrix(c(0, 1, 1,
              2, 1, 5,
              0, 1, 10,
              1, 2, 3), nrow = 3)
Y &lt;- MDPH(disc_phase_type, reward_mat = R)

dMDPH(3:4, Y)
pMDPH(1.45, Y)
qMDPH(0.5, Y)
set.seed(0)
rMDPH(6, Y)
rFullMDPH(Y)

</code></pre>

<hr>
<h2 id='mean'>Mean of Phase-Type Distributions</h2><span id='topic+mean'></span><span id='topic+mean.cont_phase_type'></span><span id='topic+mean.disc_phase_type'></span><span id='topic+mean.mult_cont_phase_type'></span><span id='topic+mean.mult_disc_phase_type'></span>

<h3>Description</h3>

<p>Calculates the mean of continuous, discrete and multivariate phase-type
distributions, represented by the <code>cont_phase_type</code>,
<code>disc_phase_type</code> and <code>mult_cont_phase_type</code> classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cont_phase_type'
mean(x, ...)

## S3 method for class 'disc_phase_type'
mean(x, ...)

## S3 method for class 'mult_cont_phase_type'
mean(x, v = NULL, ...)

## S3 method for class 'mult_disc_phase_type'
mean(x, v = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mean_+3A_x">x</code></td>
<td>
<p>a <code>cont_phase_type</code>, <code>disc_phase_type</code>,
<code>mult_cont_phase_type</code> or <code>mult_disc_phase_type</code> object</p>
</td></tr>
<tr><td><code id="mean_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
<tr><td><code id="mean_+3A_v">v</code></td>
<td>
<p>NULL, integer or vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the univariate case (<code>cont_phase_type</code> and <code>disc_phase_type</code>),
the mean of the distribution is returned.
</p>
<p>In the case of multivariate phase-type distributions three
different usages can be distinguished:
</p>

<ul>
<li><p>If <code>v = NULL</code> (default), the means of all the variables defined by
the sub-intensity matrix are returned
</p>
</li>
<li><p>If <code>v</code> is an integer, then the mean of the variable with the specified index in the
reward matrix is returned.
</p>
</li>
<li><p>If <code>v</code> is a vector, then the means of the variables defined
by those indices will be returned.
</p>
</li></ul>



<h3>Value</h3>

<p>This function returns a single value for the mean of univariate phase-type
distributions, or a vector of means for each reward-transformed distribution
of the multivariate phase-type distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For univariate continuous phase-type distributions
ph1 &lt;- PH(matrix(c(-3, 0, 0, 1, -2, 0, 0, 1, -1), ncol = 3), c(0.25,0.25,0.5))
mean(ph1)

# For multivariate continuous phase-type distributions
subintensity_matrix &lt;- matrix(c(-3, 0, 0,
                               2, -2, 0,
                               0, 1, -1), nrow = 3, ncol = 3)
reward_matrix = matrix(sample(seq(0, 10), 6), nrow = 3, ncol = 2)
ph2 &lt;- MPH(subintensity_matrix, reward_mat = reward_matrix)
## Mean for both states in the reward matrix
mean(ph2)
## Mean for the first state in the reward matrix
mean(ph2, 1)
## Mean for the second state in the reward matrix
mean(ph2, 2)

</code></pre>

<hr>
<h2 id='moment_mph'>Moments of the multivariate continuous phase-type distribution</h2><span id='topic+moment_mph'></span>

<h3>Description</h3>

<p>This function calculates the moments for the multivariate phase-type
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moment_mph(obj, v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moment_mph_+3A_obj">obj</code></td>
<td>
<p>a mult_cont_phase_type.</p>
</td></tr>
<tr><td><code id="moment_mph_+3A_v">v</code></td>
<td>
<p>a vector or an integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variables for which the moments are calculated can be specified in
the <code>v</code> vector as indices in the reward matrix of the
<code>mult_cont_phase_type</code> object.
</p>


<h3>Value</h3>

<p>A number representing the moment of a multivariate continuous phase-type distribution.
</p>

<hr>
<h2 id='moment_ph'>Moments of the univariate continuous phase-type distribution</h2><span id='topic+moment_ph'></span>

<h3>Description</h3>

<p>This function calculates the moments for the phase-type
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moment_ph(obj, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moment_ph_+3A_obj">obj</code></td>
<td>
<p>a mult_cont_phase_type.</p>
</td></tr>
<tr><td><code id="moment_ph_+3A_m">m</code></td>
<td>
<p>an integer.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The order of the moment can be specified by <code>m</code> for a
<code>cont_phase_type</code> object.
</p>

<hr>
<h2 id='MPH_functions'>The Multivariate Continuous Phase-Type Distribution</h2><span id='topic+MPH_functions'></span><span id='topic+dMPH'></span><span id='topic+qMPH'></span><span id='topic+pMPH'></span><span id='topic+rMPH'></span><span id='topic+rFullMPH'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for the multivariate continuous phase-type distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dMPH(x, obj)

qMPH(p, obj)

pMPH(q, obj)

rMPH(n, obj)

rFullMPH(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MPH_functions_+3A_x">x</code>, <code id="MPH_functions_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="MPH_functions_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>mult_cont_phase_type</code>.</p>
</td></tr>
<tr><td><code id="MPH_functions_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="MPH_functions_+3A_n">n</code></td>
<td>
<p>number of observations. If length(n) &gt; 1, the length is taken to be
the number required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dMPH</code> gives the density, <code>pMPH</code> gives the
distribution function, <code>qMPH</code> gives the quantile function,
and <code>rMPH</code> generates random deviates. <code>rFullMPH</code> returns
the full path of a random draw from the distribution.
</p>
<p>Each row of the result of For <code>dMPH</code>, <code>pMPH</code>, <code>qMPH</code>, and
<code>rMPH</code> corresponds to each univariate reward transformation.
For <code>dMDPH</code>, <code>qMDPH</code> and <code>pMDPH</code>, the inputs <code>x</code>,
<code>p</code> and <code>q</code> can be matrices where in row i the i_th reward
transformation and in col j the j_th value of <code>x</code>, <code>p</code> or <code>q</code>
tested.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rMPH</code>,
and is the maximum of the lengths of the numerical arguments for the other
functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the
result. Only the first elements of the logical arguments are used.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dMPH</code>: Density function for the multivariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>qMPH</code>: Quantile function for the multivariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>pMPH</code>: Distribution function for the multivariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>rMPH</code>: Random number generator for the multivariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>rFullMPH</code>: Simulation of the full path for the multivariate continuous phase-type distribution.
</p>
</li></ul>


<h3>See Also</h3>

<p><a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cont_phase_type &lt;- matrix(c(-3, 0, 1,
                            2, -3, 1,
                            1, 1, -2), ncol = 3)
R &lt;- matrix(c(0, 1, 1,  2,
                 2, 1, 5,  2,
                 0, 1, 10, 2), nrow = 3, ncol=4, byrow=TRUE)
Y &lt;- MPH(cont_phase_type, reward_mat = R)

dMPH(3:4, Y)
pMPH(1.45, Y)
qMPH(0.5, Y)
set.seed(0)
rMPH(6, Y)
rFullMPH(Y)

</code></pre>

<hr>
<h2 id='perm'>Permutations</h2><span id='topic+perm'></span>

<h3>Description</h3>

<p>This function calculates all possible permutations given a
numeric vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm(v)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm_+3A_v">v</code></td>
<td>
<p>a numeric vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with all possible permutations.
</p>

<hr>
<h2 id='PH_functions'>The Univariate Continuous Phase-Type Distribution</h2><span id='topic+PH_functions'></span><span id='topic+dPH'></span><span id='topic+qPH'></span><span id='topic+pPH'></span><span id='topic+rPH'></span><span id='topic+rFullPH'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random generation
for the univariate continuous phase-type distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPH(x, obj)

qPH(p, obj)

pPH(q, obj)

rPH(n, obj)

rFullPH(obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PH_functions_+3A_x">x</code>, <code id="PH_functions_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="PH_functions_+3A_obj">obj</code></td>
<td>
<p>an object of class <code>cont_phase_type</code>.</p>
</td></tr>
<tr><td><code id="PH_functions_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="PH_functions_+3A_n">n</code></td>
<td>
<p>number of observations. If length(n) &gt; 1, the length is taken to be
the number required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dPH</code> gives the density, <code>pPH</code> gives the
distribution function, <code>qPH</code> gives the quantile function,
and <code>rPH</code> generates random deviates. <code>rFullPH</code> returns
the full path of a random draw from the distribution.
</p>
<p>The length of the result is determined by <code>n</code> for <code>rPH</code>,
and is the maximum of the lengths of the numerical arguments for the other
functions.
</p>
<p>The numerical arguments other than <code>n</code> are recycled to the length of the
result. Only the first elements of the logical arguments are used.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>dPH</code>: Density function for the univariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>qPH</code>: Quantile function for the univariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>pPH</code>: Distribution function for the univariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>rPH</code>: Random number generator for the univariate continuous phase-type distribution.
</p>
</li>
<li> <p><code>rFullPH</code>: Simulation of the full path for the univariate continuous phase-type distribution.
</p>
</li></ul>


<h3>See Also</h3>

<p><a href="stats.html#topic+Distributions">Distributions</a> for other standard distributions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cont_phase_type &lt;- matrix(c(-3, 0, 1,
                            2, -3, 1,
                            1, 1, -2), ncol = 3)
Y &lt;- PH(cont_phase_type)

dPH(3:4, Y)
pPH(1.45, Y)
qPH(0.5, Y)
set.seed(0)
rPH(6, Y)
rFullPH(Y)


</code></pre>

<hr>
<h2 id='phase_type_to_network'>Phase-type distribution to network</h2><span id='topic+phase_type_to_network'></span>

<h3>Description</h3>

<p>This function converts a phase-type distribution into an
igraph graph object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phase_type_to_network(phase_type, t = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phase_type_to_network_+3A_phase_type">phase_type</code></td>
<td>
<p>an object of class <code>disc_phase_type</code> or
<code>cont_phase_type</code></p>
</td></tr>
<tr><td><code id="phase_type_to_network_+3A_t">t</code></td>
<td>
<p>NULL or numeric. Sampling time for the continuous phase-type distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An igraph graph object of the phase-type distribution.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
cont_phase_type &lt;- matrix(c(-3, 0, 1,
                            2, -3, 1,
                            1, 1, -2), ncol = 3)
Y &lt;- PH(cont_phase_type)
Y_network &lt;- phase_type_to_network(Y)
set.seed(28)
plot(Y_network, layout = layout_with_fr(Y_network,  weights = rep(1, length(E(Y_network)))))

## End(Not run)

</code></pre>

<hr>
<h2 id='print.cont_phase_type'>Print method for phase-type objects</h2><span id='topic+print.cont_phase_type'></span><span id='topic+print.disc_phase_type'></span><span id='topic+print.mult_cont_phase_type'></span><span id='topic+print.mult_disc_phase_type'></span>

<h3>Description</h3>

<p>Print method for <code>cont_phase_type</code>, <code>disc_phase_type</code>,
<code>mult_cont_phase_type</code> and <code>mult_disc_phase_type</code> classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cont_phase_type'
print(x, ...)

## S3 method for class 'disc_phase_type'
print(x, ...)

## S3 method for class 'mult_cont_phase_type'
print(x, ...)

## S3 method for class 'mult_disc_phase_type'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cont_phase_type_+3A_x">x</code></td>
<td>
<p>phase-type object</p>
</td></tr>
<tr><td><code id="print.cont_phase_type_+3A_...">...</code></td>
<td>
<p>other arguments not used by this method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints the phase-type object as a list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>subintensity_matrix &lt;- matrix(c(-1.5, 1.5, 0,
                                 0,  -1,   1,
                                 0,   0,  -0.5),
                              ncol = 3,
                              byrow = TRUE)
ph1 &lt;- PH(subintensity_matrix)

print(ph1)

</code></pre>

<hr>
<h2 id='reward_phase_type'>Transformation of Phase-Type Distributions via Rewards</h2><span id='topic+reward_phase_type'></span>

<h3>Description</h3>

<p>Transform a variable following a phase-type distribution according to a
non-negative reward vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reward_phase_type(phase_type, reward)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reward_phase_type_+3A_phase_type">phase_type</code></td>
<td>
<p>an object of class <code>cont_phase_type</code> or
<code>disc_phase_type</code>.</p>
</td></tr>
<tr><td><code id="reward_phase_type_+3A_reward">reward</code></td>
<td>
<p>a vector of the same length as the number of
states. The vector should contain non-negative values. Rewards for the
discrete phase-type distribution can only be integers.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the reward transformation for continuous phase-type distribution, the
transformation will be performed as presented in the book of Bladt and
Nielsen (2017).
</p>
<p>For the discrete phase_type distribution is based on the PhD of Navarro (2018) and
Hobolth, Bladt and Andersen (2021).
</p>


<h3>Value</h3>

<p>An object of class <code>disc_phase_type</code> or <code>cont_phase_type</code>.
</p>


<h3>References</h3>

<p>Bladt, M., &amp; Nielsen, B. F. (2017). *Matrix-exponential distributions in applied probability* (Vol. 81). New York: Springer.
</p>
<p>Campillo Navarro, A. (2018). *Order statistics and multivariate discrete phase-type distributions*. DTU Compute. DTU Compute PHD-2018, Vol.. 492
</p>
<p>Hobolth, A., Bladt, M. &amp; Andersen, L.A. (2021). *Multivariate phase-type theory for the site frequency spectrum*. ArXiv.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PH">PH</a></code>, <code><a href="#topic+DPH">DPH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##===========================##
## For continuous phase-type ##
##===========================##

subint_mat &lt;- matrix(c(-3, 1, 1,
                      2, -3, 0,
                      1, 1, -3), ncol = 3)
init_probs &lt;- c(0.9, 0.1, 0)
ph &lt;- PH(subint_mat, init_probs)
reward &lt;- c(0.5, 0, 4)

reward_phase_type(ph, reward)

##=========================##
## For discrete phase-type ##
##=========================##

subint_mat &lt;- matrix(c(0.4, 0, 0,
                      0.24, 0.4, 0,
                      0.12, 0.2, 0.5), ncol = 3)
init_probs &lt;- c(0.9, 0.1, 0)
ph &lt;- DPH(subint_mat, init_probs)

reward &lt;- c(1, 0, 4)

reward_phase_type(ph, reward)


</code></pre>

<hr>
<h2 id='summary.cont_phase_type'>Pretty summary of the <code>cont_phase_type</code> class.</h2><span id='topic+summary.cont_phase_type'></span>

<h3>Description</h3>

<p>Pretty summary of the <code>cont_phase_type</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cont_phase_type'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.cont_phase_type_+3A_object">object</code></td>
<td>
<p>a cont_phase_type object</p>
</td></tr>
<tr><td><code id="summary.cont_phase_type_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function prints a nicely-formatted summary of
a <code>cont_phase_type</code> object. The summary includes the
sub-intensity matrix, the initial probabilities, the defect,
the mean and the variance of the phase-type object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ph &lt;- PH(matrix(c(-3, 0, 1,
               2, -3, 1,
               1, 1, -2), ncol = 3))

summary(ph)

</code></pre>

<hr>
<h2 id='summary.disc_phase_type'>Pretty summary of the <code>disc_phase_type</code> class.</h2><span id='topic+summary.disc_phase_type'></span>

<h3>Description</h3>

<p>Pretty summary of the <code>disc_phase_type</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'disc_phase_type'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.disc_phase_type_+3A_object">object</code></td>
<td>
<p>a disc_phase_type object</p>
</td></tr>
<tr><td><code id="summary.disc_phase_type_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function prints a nicely-formatted summary of
a <code>disc_phase_type</code> object. The summary includes the
sub-intensity matrix, the initial probabilities, the defect,
the mean and the variance of the phase-type object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dph &lt;- DPH(matrix(c(0.4, 0, 0.2,
                    0.5, 0.3, 0.2,
                    0, 0.7, 0.2), ncol = 3))

summary(dph)

</code></pre>

<hr>
<h2 id='summary.mult_cont_phase_type'>Pretty summary of the <code>mult_cont_phase_type</code> class.</h2><span id='topic+summary.mult_cont_phase_type'></span>

<h3>Description</h3>

<p>Pretty summary of the <code>mult_cont_phase_type</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mult_cont_phase_type'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mult_cont_phase_type_+3A_object">object</code></td>
<td>
<p>a mult_cont_phase_type object</p>
</td></tr>
<tr><td><code id="summary.mult_cont_phase_type_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function prints a nicely-formatted summary of
a <code>mult_cont_phase_type</code> object. The summary includes the
sub-intensity matrix, the initial probabilities, the defect,
the reward matrix,
the mean and the (co)variance of the phase-type object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
subint &lt;- matrix(c(-3, 0, 1,
                    2, -3, 1,
                    1, 1, -2), ncol = 3)
R &lt;- matrix(c(0, 1, 1,  2,
                 2, 1, 5,  2,
                 0, 1, 10, 2), nrow = 3, ncol=4, byrow=TRUE)
mph &lt;- MPH(subint, reward_mat = R)

summary(mph)

</code></pre>

<hr>
<h2 id='summary.mult_disc_phase_type'>Pretty summary of the <code>mult_dist_phase_type</code> class.</h2><span id='topic+summary.mult_disc_phase_type'></span>

<h3>Description</h3>

<p>Pretty summary of the <code>mult_dist_phase_type</code> class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mult_disc_phase_type'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.mult_disc_phase_type_+3A_object">object</code></td>
<td>
<p>a mult_dist_phase_type object</p>
</td></tr>
<tr><td><code id="summary.mult_disc_phase_type_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function prints a nicely-formatted summary of
a <code>mult_dist_phase_type</code> object. The summary includes the
sub-intensity matrix, the initial probabilities, the defect,
the reward matrix,
the mean and the (co)variance of the phase-type object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
subint &lt;- matrix(c(0.4, 0, 0.2,
                   0.5, 0.3, 0.2,
                   0, 0.7, 0.2), ncol = 3)
R &lt;- matrix(c(0, 1, 1,
              2, 1, 5,
              0, 1, 10,
              1, 2, 3), nrow = 3)
mdph &lt;- MDPH(subint, reward_mat = R)

summary(mdph)

</code></pre>

<hr>
<h2 id='var'>Variance and Covariance of Phase-Type Distributions</h2><span id='topic+var'></span><span id='topic+var.cont_phase_type'></span><span id='topic+var.disc_phase_type'></span><span id='topic+var.mult_cont_phase_type'></span><span id='topic+var.mult_disc_phase_type'></span>

<h3>Description</h3>

<p>Calculates the (co)variance of continuous, discrete and multivariate phase-type
distributions generated by <code>PH</code>, <code>DPH</code>, <code>MPH</code> and  <code>MDPH</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var(obj, ...)

## S3 method for class 'cont_phase_type'
var(obj, ...)

## S3 method for class 'disc_phase_type'
var(obj, ...)

## S3 method for class 'mult_cont_phase_type'
var(obj, v = NULL, ...)

## S3 method for class 'mult_disc_phase_type'
var(obj, v = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var_+3A_obj">obj</code></td>
<td>
<p>a <code>cont_phase_type</code>, <code>disc_phase_type</code>,
<code>mult_cont_phase_type</code> or <code>mult_disc_phase_type</code> object</p>
</td></tr>
<tr><td><code id="var_+3A_...">...</code></td>
<td>
<p>other arguments passed to methods</p>
</td></tr>
<tr><td><code id="var_+3A_v">v</code></td>
<td>
<p>NULL, integer or vector of length 2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For  the univariate case (<code>cont_phase_type</code> and <code>disc_phase_type</code>),
the variance of the distribution is returned.
</p>
<p>In the case of multivariate phase-type distributions three
different usages can be distinguished:
</p>

<ul>
<li><p>If <code>v = NULL</code> (default), then a variance-covariance matrix of all
the variables specified in the reward matrix are returned, where variances
are in the diagonal and covariances in the rest of the matrix element.
</p>
</li>
<li><p>If <code>v</code> is an integer, then the variance of the variable encoded
by the <code>v</code> index in the reward matrix is returned.
</p>
</li>
<li><p>If <code>v</code> is a vector of length 2, then the covariance between the
two variables encoded by the <code>v</code> indices in the reward matrix is
returned.
</p>
</li></ul>



<h3>Value</h3>

<p>The value returned is either the variance (for univariate
distributions) or the variance-covariance matrix (for multivariate distributions).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For univariate continuous phase-type distributions
ph1 &lt;- PH(matrix(c(-3, 0, 0, 1, -2, 0, 0, 1, -1), ncol = 3), c(0.25,0.25,0.5))
var(ph1)

# For multivariate continuous phase-type distributions
subintensity_matrix &lt;- matrix(c(-3, 0, 0,
                               2, -2, 0,
                               0, 1, -1), nrow = 3, ncol = 3)
reward_matrix = matrix(sample(seq(0, 10), 6), nrow = 3, ncol = 2)
ph2 &lt;- MPH(subintensity_matrix, reward_mat = reward_matrix)
## Variance-covariance matrix
var(ph2)
## Variance for the first state in the reward matrix
var(ph2, 1)
## Variance for the second state in the reward matrix
var(ph2, 2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
