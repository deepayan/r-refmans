<!DOCTYPE html><html lang="en"><head><title>Help for package ProbBreed</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ProbBreed}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ProbBreed-package'><p>The 'ProbBreed' package.</p></a></li>
<li><a href='#bayes_met'><p>Bayesian model for multi-environment trials</p></a></li>
<li><a href='#extr_outs'><p>Extract outputs from <code>stanfit</code> objects obtained from bayes_met</p></a></li>
<li><a href='#maize'><p>Maize real data set</p></a></li>
<li><a href='#plot.extr'><p>Plots for the <code>extr</code> object</p></a></li>
<li><a href='#plot.probsup'><p>Plots for the <code>probsup</code> object</p></a></li>
<li><a href='#print.extr'><p>Print an object of class <code>extr</code></p></a></li>
<li><a href='#print.probsup'><p>Print an object of class <code>probsup</code></p></a></li>
<li><a href='#prob_sup'><p>Probabilities of superior performance and stability</p></a></li>
<li><a href='#soy'><p>Soybean real data set</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Probability Theory for Selecting Candidates in Plant Breeding</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4.6</td>
</tr>
<tr>
<td>Description:</td>
<td>Use probability theory under the Bayesian framework for calculating the risk of selecting candidates in a multi-environment context. Contained are functions used to fit a Bayesian multi-environment model (based on the available presets), extract posterior values and maximum posterior values, compute the variance components, check the model’s convergence, and calculate the probabilities. For both across and within-environments scopes, the package computes the probability of superior performance and the pairwise probability of superior performance. Furthermore, the probability of superior stability and the pairwise probability of superior stability across environments is estimated. A joint probability of superior performance and stability is also provided. </td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/saulo-chaves/ProbBreed">https://github.com/saulo-chaves/ProbBreed</a>,
<a href="https://saulo-chaves.github.io/ProbBreed_site/">https://saulo-chaves.github.io/ProbBreed_site/</a>,
<a href="https://saulo-chaves.github.io/ProbBreed/">https://saulo-chaves.github.io/ProbBreed/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/saulo-chaves/ProbBreed/issues">https://github.com/saulo-chaves/ProbBreed/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, lifecycle, methods, Rcpp (&ge; 0.12.0), RcppParallel
(&ge; 5.0.1), rlang, rstan (&ge; 2.32.0), rstantools (&ge; 2.4.0),
stats, utils</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>StanHeaders (&ge; 2.32.0), rstan (&ge; 2.32.0), BH (&ge;
1.72.0-2), Rcpp (&ge; 0.12.0), RcppEigen (&ge; 0.3.3.3.0),
RcppParallel (&ge; 5.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>UseLTO:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Biarch:</td>
<td>true</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-17 21:18:52 UTC; Agroe</td>
</tr>
<tr>
<td>Author:</td>
<td>Saulo Chaves <a href="https://orcid.org/0000-0002-0694-1798"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Kaio Dias <a href="https://orcid.org/0000-0002-9171-1021"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph],
  Matheus Krause <a href="https://orcid.org/0000-0003-2411-9287"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Saulo Chaves &lt;saulo.chaves@ufv.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-17 22:10:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='ProbBreed-package'>The 'ProbBreed' package.</h2><span id='topic+ProbBreed-package'></span><span id='topic+ProbBreed'></span>

<h3>Description</h3>

<p>ProbBreed uses probability theory under the Bayesian framework for calculating
the risk of selecting candidates in a multi-environment context.
Contained are functions used to fit a Bayesian multi-environment model
(based on the available presets), extract posterior values and maximum posterior values,
compute the variance components, check the model’s convergence, and calculate the probabilities.
For both across and within-environments scopes, the package computes the probability of superior performance and the pairwise probability of superior performance.
Furthermore, the probability of superior stability and the pairwise probability of superior stability across environments is estimated.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Saulo Chaves <a href="mailto:saulo.chaves@ufv.br">saulo.chaves@ufv.br</a> (<a href="https://orcid.org/0000-0002-0694-1798">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Kaio Dias <a href="mailto:kaio.o.dias@ufv.br">kaio.o.dias@ufv.br</a> (<a href="https://orcid.org/0000-0002-9171-1021">ORCID</a>) [copyright holder]
</p>
</li>
<li><p> Matheus Krause <a href="mailto:mdkrause@iastate.edu">mdkrause@iastate.edu</a> (<a href="https://orcid.org/0000-0003-2411-9287">ORCID</a>)
</p>
</li></ul>



<h3>References</h3>

<p>Stan Development Team (NA). RStan: the R interface to Stan. R package version 2.32.6. https://mc-stan.org
</p>
<p>Dias, K. O. G, Santos J. P. R., Krause, M. D., Piepho H. -P., Guimarães, L. J. M.,
Pastina, M. M., and Garcia, A. A. F. (2022). Leveraging probability concepts
for cultivar recommendation in multi-environment trials. <em>Theoretical and
Applied Genetics</em>, 133(2):443-455. <a href="https://doi.org/10.1007/s00122-022-04041-y">doi:10.1007/s00122-022-04041-y</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/saulo-chaves/ProbBreed">https://github.com/saulo-chaves/ProbBreed</a>
</p>
</li>
<li> <p><a href="https://saulo-chaves.github.io/ProbBreed_site/">https://saulo-chaves.github.io/ProbBreed_site/</a>
</p>
</li>
<li> <p><a href="https://saulo-chaves.github.io/ProbBreed/">https://saulo-chaves.github.io/ProbBreed/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/saulo-chaves/ProbBreed/issues">https://github.com/saulo-chaves/ProbBreed/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bayes_met'>Bayesian model for multi-environment trials</h2><span id='topic+bayes_met'></span>

<h3>Description</h3>

<p>Fits a Bayesian multi-environment model using <code>rstan</code>, the <code>R</code> interface to <code>Stan</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bayes_met(
  data,
  gen,
  loc,
  repl,
  trait,
  reg = NULL,
  year = NULL,
  res.het = FALSE,
  iter = 2000,
  cores = 1,
  chains = 4,
  pars = NA,
  warmup = floor(iter/2),
  thin = 1,
  seed = sample.int(.Machine$integer.max, 1),
  init = "random",
  verbose = FALSE,
  algorithm = c("NUTS", "HMC", "Fixed_param"),
  control = NULL,
  include = TRUE,
  show_messages = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bayes_met_+3A_data">data</code></td>
<td>
<p>A data frame in which to interpret the variables declared in the other arguments.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_gen">gen</code>, <code id="bayes_met_+3A_loc">loc</code></td>
<td>
<p>A string. The name of the columns that contain the evaluated
candidates and locations (or environments, if you are working with factor combinations), respectively.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_repl">repl</code></td>
<td>
<p>A string, a vector, or <code>NULL</code>. If the trial is randomized in complete blocks design,
<code>repl</code> will be a string representing the name of the column that corresponds to the blocks.
If the trial is randomized in incomplete blocks design, <code>repl</code> will be a string vector
containing the name of the columns that correspond to the replicate and block effects on
the first and second positions, respectively (<code>c(replicate, block)</code>).
If the data does not have replicates, <code>repl</code> must be <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_trait">trait</code></td>
<td>
<p>A string. The analysed variable. Currently, only single-trait models are fitted.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_reg">reg</code></td>
<td>
<p>A string or NULL. The name of the column that contain information on
regions or mega-environments. <code>NULL</code> (default) if not applicable.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_year">year</code></td>
<td>
<p>A string or NULL. The name of the column that contain information on
years (or seasons). <code>NULL</code> (default) if not applicable.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_res.het">res.het</code></td>
<td>
<p>Should the model consider heterogeneous residual variances?
Defaults for <code>FALSE</code>. If <code>TRUE</code>, the model will estimate one
residual variance per location (or environmnet).</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_iter">iter</code></td>
<td>
<p>A positive integer specifying the number of iterations for each 
chain (including warmup). The default is 2000.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_cores">cores</code></td>
<td>
<p>Number of cores to use when executing the chains in parallel,
which defaults to 1 but we recommend setting the <code>mc.cores</code> option 
to be as many processors as the hardware and RAM allow (up to the 
number of chains).</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_chains">chains</code></td>
<td>
<p>A positive integer specifying the number of Markov chains. 
The default is 4.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_pars">pars</code></td>
<td>
<p>A vector of character strings specifying parameters of interest. 
The default is <code>NA</code> indicating all parameters in the model. 
If <code>include = TRUE</code>, only samples for parameters named in <code>pars</code> 
are stored in the fitted results. Conversely, if <code>include = FALSE</code>, 
samples for all parameters <em>except</em> those named in <code>pars</code> are 
stored in the fitted results.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_warmup">warmup</code></td>
<td>
<p>A positive integer specifying the number of warmup (aka burnin)
iterations per chain. If step-size adaptation is on (which it is by default), 
this also controls the number of iterations for which adaptation is run (and
hence these warmup samples should not be used for inference). The number of 
warmup iterations should be smaller than <code>iter</code> and the default is
<code>iter/2</code>.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_thin">thin</code></td>
<td>
<p>A positive integer specifying the period for saving samples. 
The default is 1, which is usually the recommended value.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_seed">seed</code></td>
<td>
<p>The seed for random number generation. The default is generated 
from 1 to the maximum integer supported by <span class="rlang"><b>R</b></span> on the machine. Even if 
multiple chains are used, only one seed is needed, with other chains having 
seeds derived from that of the first chain to avoid dependent samples.
When a seed is specified by a number, <code>as.integer</code> will be applied to it. 
If <code>as.integer</code> produces <code>NA</code>, the seed is generated randomly. 
The seed can also be specified as a character string of digits, such as
<code>"12345"</code>, which is converted to integer.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_init">init</code></td>
<td>
<p>Initial values specification. See the detailed documentation for 
the init argument in <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_verbose">verbose</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code>: flag indicating whether 
to print intermediate output from Stan on the console, which might
be helpful for model debugging.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_algorithm">algorithm</code></td>
<td>
<p>One of sampling algorithms that are implemented in Stan. 
Current options are <code>"NUTS"</code> (No-U-Turn sampler, Hoffman and Gelman 2011, Betancourt 2017), 
<code>"HMC"</code> (static HMC), or <code>"Fixed_param"</code>. The default and 
preferred algorithm is <code>"NUTS"</code>.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_control">control</code></td>
<td>
<p>A named <code>list</code> of parameters to control the sampler's
behavior. See the details in the documentation for the <code>control</code> argument
in <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_include">include</code></td>
<td>
<p>Logical scalar defaulting to <code>TRUE</code> indicating
whether to include or exclude the parameters given by the 
<code>pars</code> argument. If <code>FALSE</code>, only entire multidimensional
parameters can be excluded, rather than particular elements of them.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_show_messages">show_messages</code></td>
<td>
<p>Either a logical scalar (defaulting to <code>TRUE</code>)
indicating whether to print the summary of Informational Messages to
the screen after a chain is finished or a character string naming a path
where the summary is stored. Setting to <code>FALSE</code> is not recommended
unless you are very sure that the model is correct up to numerical 
error.</p>
</td></tr>
<tr><td><code id="bayes_met_+3A_...">...</code></td>
<td>
<p>Additional arguments can be <code>chain_id</code>, <code>init_r</code>, 
<code>test_grad</code>, <code>append_samples</code>, <code>refresh</code>,
<code>enable_random_init</code>. See the documentation in <code><a href="rstan.html#topic+stan">stan</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function has nine available models, which will be fitted according to the
options set in the arguments:
</p>

<ol>
<li><p>Entry-mean model : fitted when <code>repl = NULL</code>, <code>reg = NULL</code> and <code>year = NULL</code>:
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + l + \varepsilon</code>
</p>

<p>Where <code class="reqn">y</code> is the phenotype, <code class="reqn">\mu</code> is the intercept, <code class="reqn">g</code> is the genotypic
effect, <code class="reqn">l</code> is the location (or environment) effect, and <code class="reqn">\varepsilon</code> is
the error (which contains the genotype-by-location interaction, in this case).
</p>
</li>
<li><p>Randomized complete blocks design : fitted when <code>repl</code> is a single string.
It will fit different models depending if <code>reg</code> and <code>year</code> are <code>NULL</code>:
</p>

<ul>
<li><p><code>reg = NULL</code> and <code>year = NULL</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + l + gl + r + \varepsilon</code>
</p>

<p>where <code class="reqn">gl</code> is the genotype-by-location effect, and <code class="reqn">r</code> is the replicate effect.
</p>
</li>
<li><p><code>reg = "reg"</code> and <code>year = NULL</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + m + l + gl + gm + r + \varepsilon</code>
</p>

<p>where <code class="reqn">m</code> is the region effect, and <code class="reqn">gm</code> is the genotype-by-region effect.
</p>
</li>
<li><p><code>reg = NULL</code> and <code>year = "year"</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + t + l + gl + gt + r + \varepsilon</code>
</p>

<p>where <code class="reqn">t</code> is the year effect, and <code class="reqn">gt</code> is the genotype-by-year effect.
</p>
</li>
<li><p><code>reg = "reg"</code> and <code>year = "year"</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + m + t + l + gl + gm + gt + r + \varepsilon</code>
</p>

</li></ul>

</li>
<li><p>Incomplete blocks design : fitted when <code>repl</code> is a string vector of size 2.
It will fit different models depending if <code>reg</code> and <code>year</code> are <code>NULL</code>:
</p>

<ul>
<li><p><code>reg = NULL</code> and <code>year = NULL</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + l + gl + r + b + \varepsilon</code>
</p>

<p>where <code class="reqn">b</code> is the block within replicates effect.
</p>
</li>
<li><p><code>reg = "reg"</code> and <code>year = NULL</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + m + l + gl + gm + r + b + \varepsilon</code>
</p>

</li>
<li><p><code>reg = NULL</code> and <code>year = "year"</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + t + l + gl + gt + r + b + \varepsilon</code>
</p>

</li>
<li><p><code>reg = "reg"</code> and <code>year = "year"</code> :
</p>
<p style="text-align: center;"><code class="reqn">y = \mu + g + m + t + l + gl + gm + gt + r + b + \varepsilon</code>
</p>

</li></ul>

</li></ol>

<p>The models described above have predefined priors:
</p>
<p style="text-align: center;"><code class="reqn">x \sim \mathcal{N} \left( 0, S^{[x]} \right)</code>
</p>

<p style="text-align: center;"><code class="reqn">\sigma \sim \mathcal{HalfCauchy}\left( 0, S^{[\sigma]} \right)</code>
</p>

<p>where <code class="reqn">x</code> can be any effect but the error, and <code class="reqn">\sigma</code> is the standard
deviation of the likelihood. If <code>res.het = TRUE</code>, then <code class="reqn">\sigma_k \sim \mathcal{HalfCauchy}\left( 0, S^{\left[ \sigma_k \right]} \right)</code>.
The hyperpriors are set as follows:
</p>
<p style="text-align: center;"><code class="reqn">S^{[x]} \sim \mathcal{HalfCauchy}\left( 0, \phi \right)</code>
</p>

<p>where <code class="reqn">\phi</code> is the known global hyperparameter defined such as <code class="reqn">\phi = max(y) \times 10</code>.
</p>
<p>More details about the usage of <code>bayes_met</code> and other functions of
the <code>ProbBreed</code> package can be found at <a href="https://saulo-chaves.github.io/ProbBreed_site/">https://saulo-chaves.github.io/ProbBreed_site/</a>.
Solutions to convergence or mixing issues can be found at
<a href="https://mc-stan.org/misc/warnings.html">https://mc-stan.org/misc/warnings.html</a>.
</p>


<h3>Value</h3>

<p>An object of S4 class <code>stanfit</code> representing
the fitted results. Slot <code>mode</code> for this object
indicates if the sampling is done or not.
</p>


<h3>Methods</h3>


<dl>
<dt><code>sampling</code></dt><dd><p><code>signature(object = "stanmodel")</code>
Call a sampler (NUTS, HMC, or Fixed_param depending on parameters) 
to draw samples from the model defined by S4 class <code>stanmodel</code> 
given the data, initial values, etc. 
</p>
</dd>
</dl>



<h3>See Also</h3>

<p><a href="rstan.html#topic+stanmodel-method-sampling">rstan::sampling</a>, <a href="rstan.html#topic+stan">rstan::stan</a>, <a href="rstan.html#topic+stanfit-class">rstan::stanfit</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mod = bayes_met(data = maize,
                gen = "Hybrid",
                loc = "Location",
                repl = c("Rep","Block"),
                trait = "GY",
                reg = "Region",
                year = NULL,
                res.het = TRUE,
                iter = 2000, cores = 2, chain = 4)

</code></pre>

<hr>
<h2 id='extr_outs'>Extract outputs from <code>stanfit</code> objects obtained from <a href="#topic+bayes_met">bayes_met</a></h2><span id='topic+extr_outs'></span>

<h3>Description</h3>

<p>Extracts outputs of the Bayesian model fitted
using <code><a href="#topic+bayes_met">bayes_met()</a></code>, and provides some diagnostics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_outs(model, probs = c(0.025, 0.975), verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_outs_+3A_model">model</code></td>
<td>
<p>An object of class <code>stanfit</code>, obtained using <code><a href="#topic+bayes_met">bayes_met()</a></code></p>
</td></tr>
<tr><td><code id="extr_outs_+3A_probs">probs</code></td>
<td>
<p>A vector with two elements representing the probabilities
(in decimal scale) that will be considered for computing the quantiles.</p>
</td></tr>
<tr><td><code id="extr_outs_+3A_verbose">verbose</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will indicate the
completed steps. Defaults to <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>More details about the usage of <code>extr_outs</code> and other functions of
the <code>ProbBreed</code> package can be found at <a href="https://saulo-chaves.github.io/ProbBreed_site/">https://saulo-chaves.github.io/ProbBreed_site/</a>.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>extr</code>, which is a list with:
</p>

<ul>
<li> <p><code>variances</code> : a data frame containing the variance components of
the model effects, their standard deviation, naive standard error and highest
posterior density interval.
</p>
</li>
<li> <p><code>post</code> : a list with the posterior of the effects, and the data
generated by the model.
</p>
</li>
<li> <p><code>map</code> : a list with the maximum posterior values of each effect
</p>
</li>
<li> <p><code>ppcheck</code> : a matrix containing the p-values of maximum, minimum,
median, mean and standard deviation; effective number of parameters, WAIC2
value, Rhat and effective sample size.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="rstan.html#topic+stan_plot_diagnostics">rstan::stan_diag</a>, <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a>, <a href="rstan.html#topic+check_hmc_diagnostics">rstan::check_hmc_diagnostics</a>, <a href="#topic+plot.extr">plot.extr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mod = bayes_met(data = maize,
                gen = "Hybrid",
                loc = "Location",
                repl = c("Rep","Block"),
                trait = "GY",
                reg = "Region",
                year = NULL,
                res.het = TRUE,
                iter = 2000, cores = 2, chain = 4)

outs = extr_outs(model = mod,
                 probs = c(0.05, 0.95),
                 verbose = TRUE)

</code></pre>

<hr>
<h2 id='maize'>Maize real data set</h2><span id='topic+maize'></span>

<h3>Description</h3>

<p>This dataset belongs to value of cultivation and use maize trials of
Embrapa Maize and Sorghum, and was used by Dias et al. (2022).
It contains the grain yield of 32 single-cross hybrids and four commercial checks
(36 genotypes in total) evaluated in 16 locations across
five regions or mega-environments. These trials were laid out in incomplete blocks
design, using a block size of 6 and two replications per trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maize
</code></pre>


<h3>Format</h3>



<h4><code>maize</code></h4>

<p>A data frame with 823 rows and 6 columns:
</p>

<dl>
<dt>Location</dt><dd><p>16 locations</p>
</dd>
<dt>Region</dt><dd><p>5 regions</p>
</dd>
<dt>Rep</dt><dd><p>2 replicates</p>
</dd>
<dt>Block</dt><dd><p>6 blocks</p>
</dd>
<dt>Hybrid</dt><dd><p>36 genotypes</p>
</dd>
<dt>GY</dt><dd><p>Grain yield (phenotypes)</p>
</dd>
</dl>




<h3>Source</h3>


<p>Dias, K. O. G, Santos J. P. R., Krause, M. D., Piepho H. -P., Guimarães, L. J. M.,
Pastina, M. M., and Garcia, A. A. F. (2022). Leveraging probability concepts
for cultivar recommendation in multi-environment trials. <em>Theoretical and
Applied Genetics</em>, 133(2):443-455. <a href="https://doi.org/10.1007/s00122-022-04041-y">doi:10.1007/s00122-022-04041-y</a>

</p>

<hr>
<h2 id='plot.extr'>Plots for the <code>extr</code> object</h2><span id='topic+plot.extr'></span>

<h3>Description</h3>

<p>Build plots using the outputs stored in the <code>extr</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'extr'
plot(x, ..., category = "ppdensity")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.extr_+3A_x">x</code></td>
<td>
<p>An object of class <code>extr</code>.</p>
</td></tr>
<tr><td><code id="plot.extr_+3A_...">...</code></td>
<td>
<p>Passed to <a href="ggplot2.html#topic+geom_histogram">ggplot2::geom_histogram</a>, when <code>category = histogram</code>. Useful to change the
number of bins.</p>
</td></tr>
<tr><td><code id="plot.extr_+3A_category">category</code></td>
<td>
<p>A string indicating which plot to build. See options in the Details section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available options are:
</p>

<ul>
<li> <p><code>ppdensity</code> : Density plots of the empirical and sampled data, useful to assess the
model's convergence.
</p>
</li>
<li> <p><code>density</code> : Density plots of the model's effects.
</p>
</li>
<li> <p><code>histogram</code> : Histograms of the model's effects.
</p>
</li>
<li> <p><code>traceplot</code>: Trace plot showing the changes in the effects' values across iterations and chains.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+extr_outs">extr_outs</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mod = bayes_met(data = maize,
                gen = "Hybrid",
                loc = "Location",
                repl = c("Rep","Block"),
                trait = "GY",
                reg = "Region",
                year = NULL,
                res.het = TRUE,
                iter = 2000, cores = 2, chain = 4)

outs = extr_outs(model = mod,
                 probs = c(0.05, 0.95),
                 verbose = TRUE)
plot(outs, category = "ppdensity")
plot(outs, category = "density")
plot(outs, category = "histogram")
plot(outs, category = "traceplot")


</code></pre>

<hr>
<h2 id='plot.probsup'>Plots for the <code>probsup</code> object</h2><span id='topic+plot.probsup'></span>

<h3>Description</h3>

<p>Build plots using the outputs stored in the <code>probsup</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'probsup'
plot(x, ..., category = "perfo", level = "across")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.probsup_+3A_x">x</code></td>
<td>
<p>An object of class <code>probsup</code>.</p>
</td></tr>
<tr><td><code id="plot.probsup_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
<tr><td><code id="plot.probsup_+3A_category">category</code></td>
<td>
<p>A string indicating which plot to build. See options in the Details section.</p>
</td></tr>
<tr><td><code id="plot.probsup_+3A_level">level</code></td>
<td>
<p>A string indicating the information level to be used for building
the plots. Options are <code>"across"</code> for focusing on the probabilities across environments,
or <code>"within"</code> to focus on the within-environment effects. Defaults to <code>"across"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The available options are:
</p>

<ul>
<li> <p><code>hpd</code> : a caterpillar plot representing the marginal genotypic value of
each genotype, and their respective highest posterior density interval (95% represented by the
thick line, and 97.5% represented by the thin line). Available only if <code>level = "across"</code>.
</p>
</li>
<li> <p><code>perfo</code> : if <code>level = "across"</code>, a lollipop plot illustrating the probabilities of superior performance.
If <code>level = "within"</code>, a heatmap with the probabilities of superior performance within
environments. If a model with <code>reg</code> and/or <code>year</code> is fitted, multiple plots are produced.
</p>
</li>
<li> <p><code>stabi</code>: a lollipop plot with the probabilities of superior stability.
If a model with <code>reg</code> and/or <code>year</code> is fitted, multiple plots are produced.
Available only if <code>level = "across"</code>. Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li>
<li> <p><code>pair_perfo</code> : if <code>level = "across"</code>, a heatmap representing the pairwise probability of superior
performance (the probability of genotypes at the <em>x</em>-axis being superior.
to those on the <em>y</em>-axis). If <code>level = "within"</code>, a list of heatmaps representing the pairwise probability of superior
performance within environments.  If a model with <code>reg</code> and/or <code>year</code> is fitted, multiple plots (and multiple lists) are produced.
Should this option is set, it is mandatory to store the outputs in an object.
(e.g., <code>pl &lt;- plot(obj, category = "pair_perfo", level = "within")</code>) so they can be visualized one at a time.
The option <code>level = "within"</code> is unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li>
<li> <p><code>pair_stabi</code>: a heatmap with the pairwise probabilities of superior stability
(the probability of genotypes at the <em>x</em>-axis being more stable than those on the <em>y</em>-axis).
If a model with <code>reg</code> and/or <code>year</code> is fitted, multiple plots are produced. Available only if <code>level = "across"</code>.
Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li>
<li> <p><code>joint</code>: a lollipop plot with the joint probabilities of superior performance and stability. Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+prob_sup">prob_sup</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mod = bayes_met(data = maize,
                gen = "Hybrid",
                loc = "Location",
                repl = c("Rep","Block"),
                trait = "GY",
                reg = "Region",
                year = NULL,
                res.het = TRUE,
                iter = 2000, cores = 2, chain = 4)

outs = extr_outs(model = mod,
                 probs = c(0.05, 0.95),
                 verbose = TRUE)

results = prob_sup(extr = outs,
                   int = .2,
                   increase = TRUE,
                   save.df = FALSE,
                   verbose = FALSE)

plot(results, category = "hpd")
plot(results, category = "perfo", level = "across")
plot(results, category = "perfo", level = "within")
plot(results, category = "stabi")
plot(results, category = "pair_perfo", level = "across")
plwithin = plot(results, category = "pair_perfo", level = "within")
plot(results, category = "pair_stabi")
plot(results, category = "joint")


</code></pre>

<hr>
<h2 id='print.extr'>Print an object of class <code>extr</code></h2><span id='topic+print.extr'></span>

<h3>Description</h3>

<p>Print a <code>extr</code> object in R console
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'extr'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.extr_+3A_x">x</code></td>
<td>
<p>An object of class <code>extr</code></p>
</td></tr>
<tr><td><code id="print.extr_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+extr_outs">extr_outs</a>
</p>

<hr>
<h2 id='print.probsup'>Print an object of class <code>probsup</code></h2><span id='topic+print.probsup'></span>

<h3>Description</h3>

<p>Print a <code>probsup</code> object in R console
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'probsup'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.probsup_+3A_x">x</code></td>
<td>
<p>An object of class <code>probsup</code></p>
</td></tr>
<tr><td><code id="print.probsup_+3A_...">...</code></td>
<td>
<p>currently not used</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+prob_sup">prob_sup</a>
</p>

<hr>
<h2 id='prob_sup'>Probabilities of superior performance and stability</h2><span id='topic+prob_sup'></span>

<h3>Description</h3>

<p>This function estimates the probabilities of superior performance and stability
across environments, and probabilities of superior performance within environments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prob_sup(extr, int, increase = TRUE, save.df = FALSE, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prob_sup_+3A_extr">extr</code></td>
<td>
<p>An object of class <code>extr</code>, obtained from the <a href="#topic+extr_outs">extr_outs</a> function</p>
</td></tr>
<tr><td><code id="prob_sup_+3A_int">int</code></td>
<td>
<p>A numeric representing the selection intensity
(between 0 and 1)</p>
</td></tr>
<tr><td><code id="prob_sup_+3A_increase">increase</code></td>
<td>
<p>Logical.<code>TRUE</code> (default) if the selection is for increasing the trait value, <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code id="prob_sup_+3A_save.df">save.df</code></td>
<td>
<p>Logical. Should the data frames be saved in the work directory?
<code>TRUE</code> for saving, <code>FALSE</code> (default) otherwise.</p>
</td></tr>
<tr><td><code id="prob_sup_+3A_verbose">verbose</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the function will indicate the
completed steps. Defaults to <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Probabilities provide the risk of recommending a selection candidate for a target
population of environments or for a specific environment. <code>prob_sup</code>
computes the probabilities of superior performance and the probabilities of superior stability:
</p>
<ul>
<li><p> Probability of superior performance</p>
</li></ul>

<p>Let <code class="reqn">\Omega</code> represent the subset of selected genotypes based on their
performance across environments. A given genotype <code class="reqn">j</code> will belong to <code class="reqn">\Omega</code>
if its genotypic marginal value (<code class="reqn">\hat{g}_j</code>) is high or low enough compared to
its peers. <code>prob_sup</code> leverages the Monte Carlo discretized sampling
from the posterior distribution to emulate the occurrence of <code class="reqn">S</code> trials. Then,
the probability of the <code class="reqn">j^{th}</code> genotype belonging to <code class="reqn">\Omega</code> is the
ratio of success (<code class="reqn">\hat{g}_j \in \Omega</code>) events and the total number of sampled events,
as follows:
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(\hat{g}_j \in \Omega \vert y \right) = \frac{1}{S}\sum_{s=1}^S{I\left(\hat{g}_j^{(s)} \in \Omega \vert y\right)}</code>
</p>

<p>where <code class="reqn">S</code> is the total number of samples <code class="reqn">\left(s = 1, 2, ..., S \right)</code>,
and <code class="reqn">I\left(g_j^{(s)} \in \Omega \vert y\right)</code> is an indicator variable that can assume
two values: (1) if <code class="reqn">\hat{g}_j^{(s)} \in \Omega</code> in the <code class="reqn">s^{th}</code> sample,
and (0) otherwise. <code class="reqn">S</code> is conditioned to the number of iterations and chains
previously set at <a href="#topic+bayes_met">bayes_met</a>.
</p>
<p>Similarly, the within-environment probability of superior performance can be applied to
individual environments. Let <code class="reqn">\Omega_k</code> represent the subset of superior
genotypes in the <code class="reqn">k^{th}</code> environment, so that the probability of the
<code class="reqn">j^{th} \in \Omega_k</code> can calculated as follows:
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(\hat{g}_{jk} \in \Omega_k \vert y\right) = \frac{1}{S} \sum_{s=1}^S I\left(\hat{g}_{jk}^{(s)} \in \Omega_k \vert y\right)</code>
</p>

<p>where <code class="reqn">I\left(\hat{g}_{jk}^{(s)} \in \Omega_k \vert y\right)</code> is an indicator variable
mapping success (1) if <code class="reqn">\hat{g}_{jk}^{(s)}</code> exists in <code class="reqn">\Omega_k</code>, and
failure (0) otherwise, and <code class="reqn">\hat{g}_{jk}^{(s)} = \hat{g}_j^{(s)} + \widehat{ge}_{jk}^{(s)}</code>.
Note that when computing within-environment probabilities, we are accounting for
the interaction of the <code class="reqn">j^{th}</code> genotype with the <code class="reqn">k^{th}</code>
environment.
</p>
<p>The pairwise probabilities of superior performance can also be calculated across
or within environments. This metric assesses the probability of the <code class="reqn">j^{th}</code>
genotype being superior to another experimental genotype or a commercial check.
The calculations are as follows, across and within environments, respectively:
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(\hat{g}_{j} &gt; \hat{g}_{j^\prime} \vert y\right) = \frac{1}{S} \sum_{s=1}^S I\left(\hat{g}_{j}^{(s)} &gt; \hat{g}_{j^\prime}^{(s)} \vert y\right)</code>
</p>

<p>or
</p>
<p style="text-align: center;"><code class="reqn">Pr\left(\hat{g}_{jk} &gt; \hat{g}_{j^\prime k} \vert y\right) = \frac{1}{S} \sum_{s=1}^S I\left(\hat{g}_{jk}^{(s)} &gt; \hat{g}_{j^\prime k}^{(s)} \vert y\right)</code>
</p>

<p>These equations are set for when the selection direction is positive. If
<code>increase = FALSE</code>, <code class="reqn">&gt;</code> is simply switched by <code class="reqn">&lt;</code>.
</p>
<ul>
<li><p> Probability of superior stability</p>
</li></ul>

<p>This probability makes a direct analogy with the
method of Shukla (1972): a stable genotype is the one that has a low
genotype-by-environment interaction variance <code class="reqn">[var(\widehat{ge})]</code>.
Using the same probability principles previously described, the probability
of superior stability is given as follows:
</p>
<p style="text-align: center;"><code class="reqn">Pr \left[var \left(\widehat{ge}_{jk}\right) \in \Omega \vert y \right] = \frac{1}{S} \sum_{s=1}^S I\left[var \left(\widehat{ge}_{jk}^{(s)} \right) \in \Omega \vert y \right]</code>
</p>

<p>where <code class="reqn">I\left[var \left(\widehat{ge}_{jk}^{(s)} \right) \in \Omega \vert y \right]</code> indicates if
<code class="reqn">var\left(\widehat{ge}_{jk}^{(s)}\right)</code> exists in <code class="reqn">\Omega</code> (1) or not (0).
Pairwise probabilities of superior stability are also possible in this context:
</p>
<p style="text-align: center;"><code class="reqn">Pr \left[var \left(\widehat{ge}_{jk} \right) &lt; var\left(\widehat{ge}_{j^\prime k} \right) \vert y \right] = \frac{1}{S} \sum_{s=1}^S I \left[var \left(\widehat{ge}_{jk} \right)^{(s)} &lt; var \left(\widehat{ge}_{j^\prime k} \right)^{(s)} \vert y \right]</code>
</p>

<p>Note that <code class="reqn">j</code> will be superior to <code class="reqn">j^\prime</code> if it has a <strong>lower</strong>
variance of the genotype-by-environment interaction effect. This is true regardless
if <code>increase</code> is set to <code>TRUE</code> or <code>FALSE</code>.
</p>
<p>The joint probability independent events is the product of the individual probabilities.
The estimated genotypic main effects and the variances of GEI effects are independent
by design, thus the joint probability of superior performance and stability as follows:
</p>
<p style="text-align: center;"><code class="reqn">Pr \left[\hat{g}_j \in \Omega \cap var \left(\widehat{ge}_{jk} \right) \in \Omega \right] = Pr \left(\hat{g}_j \in \Omega \right) \times Pr \left[var \left(\widehat{ge}_{jk} \right) \in \Omega \right]</code>
</p>

<p>The estimation of these probabilities are strictly related to some key questions that
constantly arises in plant breeding:
</p>

<ul>
<li> <p><strong>What is the risk of recommending a selection candidate for a target population of environments?</strong>
</p>
</li>
<li> <p><strong>What is the probability of a given selection candidate having good performance if
recommended to a target population of environments? And for a specific environment?</strong>
</p>
</li>
<li> <p><strong>What is the probability of a given selection candidate having better performance
than a cultivar check in the target population of environments? And in specific environments?</strong>
</p>
</li>
<li> <p><strong>How probable is it that a given selection candidate performs similarly across environments?</strong>
</p>
</li>
<li> <p><strong>What are the chances that a given selection candidate is more stable
than a cultivar check in the target population of environments?</strong>
</p>
</li>
<li> <p><strong>What is the probability that a given selection candidate having a
superior and invariable performance across environments?</strong>
</p>
</li></ul>

<p>More details about the usage of <code>prob_sup</code>, as well as the other function of
the <code>ProbBreed</code> package can be found at <a href="https://saulo-chaves.github.io/ProbBreed_site/">https://saulo-chaves.github.io/ProbBreed_site/</a>.
</p>


<h3>Value</h3>

<p>The function returns an object of class <code>probsup</code>, which contains two lists,
one with the <code>across</code>-environments probabilities, and another with the <code>within</code>-environments probabilities.
If an entry-mean model was used in <code>ProbBreed::bayes_met</code>, only the <code>across</code> list will be available.
</p>
<p>The <code>across</code> list has the following elements:
</p>

<ul>
<li> <p><code>g_hpd</code>: Highest posterior density (HPD) of the posterior genotypic main effects.
</p>
</li>
<li> <p><code>perfo</code>: the probabilities of superior performance.
</p>
</li>
<li> <p><code>pair_perfo</code>: the pairwise probabilities of superior performance.
</p>
</li>
<li> <p><code>stabi</code>: a list with the probabilities of superior stability. It contains the data frames <code>gl</code>,
<code>gm</code> (when <code>reg</code> is not <code>NULL</code>) and <code>gt</code> (when <code>year</code> is not <code>NULL</code>). Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li>
<li> <p><code>pair_stabi</code>: a list with the pairwise probabilities of superior stability. It contains the data frames <code>gl</code>,
<code>gm</code> (when <code>reg</code> is not <code>NULL</code>) and <code>gt</code> (when <code>year</code> is not <code>NULL</code>). Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li>
<li> <p><code>joint_prob</code>: the joint probabilities of superior performance and stability. Unavailable if an entry-mean model was used in <code>bayes_met</code>.
</p>
</li></ul>

<p>The <code>within</code> list has the following elements:
</p>

<ul>
<li> <p><code>perfo</code>: a list of data frames containing the probabilities of superior performance
within locations (<code>gl</code>), regions (<code>gm</code>) and years (<code>gt</code>).
</p>
</li>
<li> <p><code>pair_perfo</code>: lists with the pairwise probabilities of superior performance
within locations (<code>gl</code>), regions (<code>gm</code>) and years (<code>gt</code>).
</p>
</li></ul>



<h3>References</h3>

<p>Dias, K. O. G, Santos J. P. R., Krause, M. D., Piepho H. -P., Guimarães, L. J. M.,
Pastina, M. M., and Garcia, A. A. F. (2022). Leveraging probability concepts
for cultivar recommendation in multi-environment trials. <em>Theoretical and
Applied Genetics</em>, 133(2):443-455. <a href="https://doi.org/10.1007/s00122-022-04041-y">doi:10.1007/s00122-022-04041-y</a>
</p>
<p>Shukla, G. K. (1972) Some statistical aspects of partioning genotype environmental
componentes of variability. <em>Heredity</em>, 29:237-245. <a href="https://doi.org/10.1038/hdy.1972.87">doi:10.1038/hdy.1972.87</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+plot.probsup">plot.probsup</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mod = bayes_met(data = maize,
                gen = "Hybrid",
                loc = "Location",
                repl = c("Rep","Block"),
                trait = "GY",
                reg = "Region",
                year = NULL,
                res.het = TRUE,
                iter = 2000, cores = 2, chain = 4)

outs = extr_outs(model = mod,
                 probs = c(0.05, 0.95),
                 verbose = TRUE)

results = prob_sup(extr = outs,
                   int = .2,
                   increase = TRUE,
                   save.df = FALSE,
                   verbose = FALSE)


</code></pre>

<hr>
<h2 id='soy'>Soybean real data set</h2><span id='topic+soy'></span>

<h3>Description</h3>

<p>This dataset belongs to the USDA Northern Region Uniform Soybean Tests,
and it is a subset of the data used by Krause et al. (2023). It contains the
empirical best linear unbiased estimates of genotypic means of the seed yield
from 39 experimental genotypes evaluated in 14 locations. The original data, available at the package
<code>SoyURT</code>, has 4,257 experimental genotypes evaluated at 63 locations and
31 years resulting in 591 location-year combinations (environments) with
39,006 yield values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soy
</code></pre>


<h3>Format</h3>



<h4><code>soy</code></h4>

<p>A data frame with 823 rows and 3 columns:
</p>

<dl>
<dt>Loc</dt><dd><p>14 locations</p>
</dd>
<dt>Gen</dt><dd><p>39 experimental genotypes</p>
</dd>
<dt>Y</dt><dd><p>435 EBLUEs (phenotypes)</p>
</dd>
</dl>




<h3>Source</h3>


<p>Krause MD, Dias KOG, Singh AK, Beavis WD. 2023. Using soybean
historical field trial data to study genotype by environment
variation and identify mega-environments with the integration
of genetic and non-genetic factors. bioRxiv : the preprint server for biology.
doi: https://doi.org/10.1101/2022.04.11.487885

</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
