<!DOCTYPE html><html><head><title>Help for package depend.truncation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {depend.truncation}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#depend.truncation-package'><p>Statistical Methods for the Analysis of Dependently Truncated Data</p></a></li>
<li><a href='#centenarian'>
<p>Japanese Centenarians Data</p></a></li>
<li><a href='#CHAIEB.Clayton'><p>Semi-parametric Inference under the Clayton Copula with Dependent Truncation</p></a></li>
<li><a href='#CHAIEB.Frank'><p>Semi-parametric Inference under the Frank Copula with Dependent Truncation</p></a></li>
<li><a href='#dependAFT.reg'>
<p>Semiparametric Inference for the AFT regression Model with Dependent Truncation</p></a></li>
<li><a href='#EMURA.Clayton'><p>Semi-parametric Inference under the Clayton Copula with Dependent Truncation</p></a></li>
<li><a href='#EMURA.Frank'><p>Semi-parametric Inference under the Frank Copula with Dependent Truncation</p></a></li>
<li><a href='#Logrank.stat'>
<p>The weighted log-rank statistics for testing quasi-independence (without ties in data)</p></a></li>
<li><a href='#Logrank.stat.tie'>
<p>The weighted log-rank statistics for testing quasi-independence (with ties in data)</p></a></li>
<li><a href='#NPMLE.Frank'><p>Semiparametric Inference under the Frank Copula with Dependent Truncation</p></a></li>
<li><a href='#NPMLE.Indep'><p>Semiparametric Inference under the Independence Copula with Dependent Truncation</p></a></li>
<li><a href='#NPMLE.Normal'><p>Semiparametric Inference under the Normal Copula with Dependent Truncation</p></a></li>
<li><a href='#NPMLE.Plackett'><p>Semiparametric Inference under the Plackett Copula with Dependent Truncation</p></a></li>
<li><a href='#PMLE.Clayton.Exponential'><p>Parametric Inference for Bivariate Exponential Models with Dependent Truncation</p></a></li>
<li><a href='#PMLE.Clayton.Weibull'><p>Parametric Inference for Bivariate Weibull Models with Dependent Truncation</p></a></li>
<li><a href='#PMLE.Normal'><p>Parametric Inference for Bivariate Normal Models with Dependent Truncation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Methods for the Analysis of Dependently Truncated
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-27</td>
</tr>
<tr>
<td>Author:</td>
<td>Takeshi Emura</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Takeshi Emura &lt;takeshiemura@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation and testing methods for dependently truncated data.
 Semi-parametric methods are based on Emura et al. (2011)&lt;Stat Sinica 21:349-67&gt;, Emura &amp; Wang (2012)&lt;<a href="https://doi.org/10.1016%2Fj.jmva.2012.03.012">doi:10.1016/j.jmva.2012.03.012</a>&gt;,
 and Emura &amp; Murotani (2015)&lt;<a href="https://doi.org/10.1007%2Fs11749-015-0432-8">doi:10.1007/s11749-015-0432-8</a>&gt;.
 Parametric approaches are based on Emura &amp; Konno (2012)&lt;<a href="https://doi.org/10.1007%2Fs00362-014-0626-2">doi:10.1007/s00362-014-0626-2</a>&gt; and Emura &amp; Pan (2017)&lt;<a href="https://doi.org/10.1007%2Fs00362-017-0947-z">doi:10.1007/s00362-017-0947-z</a>&gt;.
 A regression approach is based on Emura &amp; Wang (2016)&lt;<a href="https://doi.org/10.1007%2Fs10463-015-0526-9">doi:10.1007/s10463-015-0526-9</a>&gt;. Quasi-independence tests are based on Emura &amp; Wang (2010)&lt;<a href="https://doi.org/10.1016%2Fj.jmva.2009.07.006">doi:10.1016/j.jmva.2009.07.006</a>&gt;.
 Right-truncated data for Japanese male centenarians are given by Emura &amp; Murotani (2015)&lt;<a href="https://doi.org/10.1007%2Fs11749-015-0432-8">doi:10.1007/s11749-015-0432-8</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-27 09:46:18 UTC; user</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-27 12:43:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='depend.truncation-package'>Statistical Methods for the Analysis of Dependently Truncated Data</h2><span id='topic+depend.truncation-package'></span><span id='topic+depend.truncation'></span>

<h3>Description</h3>

<p>Estimation and testing methods for dependently truncated data.
Semi-parametric methods are based on Emura et al. (2011), Emura &amp; Wang (2012), and Emura &amp; Murotani (2015).
Parametric approaches are based on Emura &amp; Konno (2012) and Emura &amp; Pan (2017).
A regression approach is based on Emura &amp; Wang (2016). Quasi-independence tests are based on Emura &amp; Wang (2010).
Right-truncated data for Japanese male centenarians are given by Emura &amp; Murotani (2015).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> depend.truncation</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 3.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-02-27</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Takeshi Emura &lt;takeshiemura@gmail.com&gt;
</p>


<h3>References</h3>

<p>Emura T, Wang W (2010), Testing quasi-independence for truncation data. Journal of Multivariate Analysis 101, 223-239.
</p>
<p>Emura T, Wang W, Hung HN (2011), Semiparametric Inference for Copula Models for Truncated Data, Stat Sinica 21: 349-367.
</p>
<p>Emura T, Konno Y (2012), Multivariate Normal Distribution Approaches for Dependently Truncated Data.
Statistical Papers 53 (No.1), 133-149.
</p>
<p>Emura T, Wang W (2012), Nonparametric Maximum Likelihood Estimation for Dependent Truncation Data Based on Copulas, Journal of Multivariate Analysis 110: 171-88
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>
<p>Emura T, Wang W (2016), Semiparametric Inference for an Accelerated Failure Time Model with Dependent Truncation, Ann Inst Stat Math 68 (5): 1073-94.
</p>
<p>Emura T, Pan CH (2017), Parametric likelihood inference and goodness-of-fit for dependently left-truncated data, a copula-based approach, Statistical Papers, doi:10.1007/s00362-017-0947-z.
</p>

<hr>
<h2 id='centenarian'>
Japanese Centenarians Data
</h2><span id='topic+centenarian'></span>

<h3>Description</h3>

<p>The number of deaths at each year (1963-1980) for Japanese male centenarians (Table 2 of Emura and Murotani (2015)). 
See also the original reference Sibuya &amp; Hanayama (2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("centenarian")</code></pre>


<h3>Format</h3>

<p>A data frame with 21 observations on the following 19 variables.
</p>

<dl>
<dt><code>X</code></dt><dd><p>:the age at death</p>
</dd>
<dt><code>X1963</code></dt><dd><p>:the number of deaths between 1963 and 1964</p>
</dd>
<dt><code>X1964</code></dt><dd><p>:the number of deaths between 1964 and 1965</p>
</dd>
<dt><code>X1965</code></dt><dd><p>:the number of deaths between 1965 and 1966</p>
</dd>
<dt><code>X1966</code></dt><dd><p>:the number of deaths between 1966 and 1967</p>
</dd>
<dt><code>X1967</code></dt><dd><p>:the number of deaths between 1967 and 1968</p>
</dd>
<dt><code>X1968</code></dt><dd><p>:the number of deaths between 1968 and 1969</p>
</dd>
<dt><code>X1969</code></dt><dd><p>:the number of deaths between 1969 and 1970</p>
</dd>
<dt><code>X1970</code></dt><dd><p>:the number of deaths between 1970 and 1971</p>
</dd>
<dt><code>X1971</code></dt><dd><p>:the number of deaths between 1971 and 1972</p>
</dd>
<dt><code>X1972</code></dt><dd><p>:the number of deaths between 1972 and 1973</p>
</dd>
<dt><code>X1973</code></dt><dd><p>:the number of deaths between 1973 and 1974</p>
</dd>
<dt><code>X1974</code></dt><dd><p>:the number of deaths between 1974 and 1975</p>
</dd>
<dt><code>X1975</code></dt><dd><p>:the number of deaths between 1975 and 1976</p>
</dd>
<dt><code>X1976</code></dt><dd><p>:the number of deaths between 1976 and 1977</p>
</dd>
<dt><code>X1977</code></dt><dd><p>:the number of deaths between 1977 and 1978</p>
</dd>
<dt><code>X1978</code></dt><dd><p>:the number of deaths between 1978 and 1979</p>
</dd>
<dt><code>X1979</code></dt><dd><p>:the number of deaths between 1979 and 1980</p>
</dd>
<dt><code>X1980</code></dt><dd><p>:the number of deaths between 1980 and 1981</p>
</dd>
</dl>



<h3>References</h3>

<p>Sibuya M, Hanayama N (2004), Estimation of Human Longevity Distribution Based on Tabulated Statistics. Proceeding of ISM 52: 117-34
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Below is the centenarians data analysis of Emura &amp; Murotani (2015) ##
data(centenarian)
Death=centenarian[,1]
Year=1963:1980
data.mat=centenarian[,-1]

X=T=NULL
for(i in 1:length(Death)){
  for(j in 1:length(Year)){
    X=c( X,rep(Death[i],data.mat[i,j]) )
    T=c( T,rep(Year[j]-i+1,data.mat[i,j]) )  ### T= Year at age 100.5 ###    
  }
}

x.trunc=X
z.trunc=max(Year)+0.5-T+100

m=length(x.trunc)
d=rep(1,m)

set.seed(1)
x.trunc=x.trunc+runif(length(x.trunc),min=-0.01,max=0)
z.trunc=z.trunc+runif(length(z.trunc),min=0,max=0.01)

### Copula-based estimator ####
## CHAIEB.Frank(x.trunc, z.trunc, d, a = 1/10)
</code></pre>

<hr>
<h2 id='CHAIEB.Clayton'>Semi-parametric Inference under the Clayton Copula with Dependent Truncation</h2><span id='topic+CHAIEB.Clayton'></span>

<h3>Description</h3>

<p>A copula-based estimation based on dependent truncation data under 
the Clayton copula model(Lakhal-Chaieb, Rivest &amp; Abdous 2006; Emura &amp; Murotani 2015).
The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Clayton copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CHAIEB.Clayton(x.trunc, z.trunc, d, a = 1/10, plotX = TRUE, plotY = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CHAIEB.Clayton_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Clayton_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Clayton_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Clayton_+3A_a">a</code></td>
<td>
<p>tuning parameter adjusting for small the risk sets (pp.360-361: Emura, Wang &amp; Hung 2011 Sinica)</p>
</td></tr>
<tr><td><code id="CHAIEB.Clayton_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, plot the distribution function of X</p>
</td></tr>
<tr><td><code id="CHAIEB.Clayton_+3A_ploty">plotY</code></td>
<td>
<p>if TRUE, plot the survival function of Y</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the moment-based estimate for the marginal distributions
and the estimate of the association parameter under the Clayton copula model.
The method can handle right-censoring for Y in which Z=min(Y, C) and I(Y&lt;=C) are observed with
censoring variable C.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>association parameter</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Kendall's tau between X and Y</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>inclusion probability, defined by c=Pr(X&lt;=Z)</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>marginal distribution function of X at at (ordered) observed points of X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>margianl survival function of Y at (ordered) observed points of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Chaieb L, Rivest LP, Abdous B (2006), Estimating Survival Under a Dependent Truncation, Biometrika 93: 655-669.
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########  AIDS data of Kalbfleisch &amp; Lawless (1989, JASA) #############
inf1=c(23,38,38,36,27,45,23,48,25,42,33,45,33,39,34,48,50,35,26,43,3,53,40,53,
28,34,42,66,19,21,37,33,31,48,32,43,17,64,58,67,49,67,35,12,19,60,53,56,65,53)
inf2=c(36,12,50,45,33,55,37,46,62,57,34,56,57,64,57,42,54,28,36,66,19,45,53,67,
68,54,40,60,54,42,74,71,43,61,68,52,75,46,62,67,48,68,58,55,70,33,56,47,64,15)
inf3=c(41,35,67,35,71,67,36,69,45,76,66,22,74,49,42,15,29,62,65,75,65,69,62,56,
52,82,46,75,27,56,70,49,66,73,76,43,50,41,49,68,39,67,61,82,69,65,56,59,57,57)
inf4=c(46,68,76,64,50,59,80,46,78,26,62,19,22,26,76,27,62,75,76,57,58,59,8,41,
70,57,58,63,37,75,58,39,38,73,72,41,56,50,79,83,76,29,17,69,86,29,65,75,74,42)
inf5=c(65,61,84,41,83,58,45,83,80,84,59,85,59,65,47,64,73,81,79,36,67,87,85,29,
72,77,72,67,53,54,17,61,65,48,57,29,36,30,45,40,75,43,76,66,86,57,75,71,51)
inf6=c(60,41,53,48,36,72,60,36,48,55,58,60,89,37,82,41,68,71,63,49,37,60,78,52,
60,85,68,37,39,22,12,63,80,45,47,85,29,60,84,70,61,69,77,63)
x1=c(27,14,15,18,28,10,34,17,34,17,29,17,29,23,29,15,13,29,38,21,61,12,25,12,38,
32,24,0,48,46,30,34,37,21,37,26,53,6,13,4,22,4,37,60,53,13,20,17,8,20)
x2=c(38,62,24,29,41,19,37,28,13,18,41,19,18,11,18,33,21,48,40,10,58,32,24,11,10,
25,39,19,25,37,5,8,37,20,13,29,6,35,19,14,33,13,23,27,12,49,26,35,18,68)
x3=c(42,48,16,48,12,16,47,14,38,8,18,62,10,35,42,69,55,22,20,10,20,16,23,30,34,4,
40,11,59,30,16,37,20,13,10,43,36,46,38,19,48,20,26,5,18,23,32,29,31,31)
x4=c(42,20,12,24,38,29,8,43,11,63,27,70,67,63,13,62,27,15,14,33,32,32,83,50,21,
34,33,29,55,17,34,53,54,19,20,52,37,43,14,10,17,64,76,25,8,65,29,19,20,52)
x5=c(29,33,10,53,11,36,49,12,15,11,36,10,36,31,49,32,23,15,17,60,29,9,11,67,24,
19,24,29,43,43,80,36,32,49,40,68,61,68,53,58,23,55,22,32,12,41,23,27,47)
x6=c(38,57,46,51,63,27,39,63,51,44,41,39,10,63,18,59,32,29,37,51,63,40,22,48,40,
15,33,64,62,79,89,38,21,56,54,16,72,41,17,31,40,32,24,38)

t=c(inf1,inf2,inf3,inf4,inf5,inf6) #### the month of infection with 1=January 1978 ####
x=c(x1,x2,x3,x4,x5,x6) #### the duration of the incubation period (month) ####
y=102-t #### 102 is the study period (month) ####

######### Breaking ties by adding small noise to the data ########## 
set.seed(1)
x=x+runif(293,min=-0.4,max=0.4)
y=y+runif(293,min=-0.4,max=0.4)
x[x&lt;=0]=runif(1,0,0.4)

x.trunc=x
z.trunc=y
d=rep(1,length(x.trunc)) ### all data is not censored ###

CHAIEB.Clayton(x.trunc,z.trunc,d)[c(1,2,3)]
######### The same numerical results as Table 3 of Emura et al. (2011) ###########

### Below is the small data analysis in Section 3.2 of Emura and Murotani (2015)###
x.trunc=c(1,2,4)
z.trunc=c(3,5,6)
d=c(1,1,1)
CHAIEB.Clayton(x.trunc, z.trunc, d, a = 1/10)
</code></pre>

<hr>
<h2 id='CHAIEB.Frank'>Semi-parametric Inference under the Frank Copula with Dependent Truncation</h2><span id='topic+CHAIEB.Frank'></span>

<h3>Description</h3>

<p>A copula-based estimation based on dependent truncation data under 
the Frank copula model(Lakhal-Chaieb, Rivest &amp; Abdous 2006; Emura &amp; Murotani 2015).
The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Frank copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CHAIEB.Frank(x.trunc, z.trunc, d, a = 1/10, plotX = TRUE, plotY = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CHAIEB.Frank_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Frank_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Frank_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
<tr><td><code id="CHAIEB.Frank_+3A_a">a</code></td>
<td>
<p>tuning parameter adjusting for small the risk sets (pp.360-361: Emura, Wang &amp; Hung 2011 Sinica)</p>
</td></tr>
<tr><td><code id="CHAIEB.Frank_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, plot the distribution function of X</p>
</td></tr>
<tr><td><code id="CHAIEB.Frank_+3A_ploty">plotY</code></td>
<td>
<p>if TRUE, plot the survival function of Y</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the moment-based estimate for the marginal distributions
and the estimate of the association parameter under the Frank copula model.
The method can handle right-censoring for Y in which Z=min(Y, C) and I(Y&lt;=C) are observed with
censoring variable C.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>association parameter</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Kendall's tau between X and Y</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>inclusion probability, defined by c=Pr(X&lt;=Z)</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>marginal distribution function of X at at (ordered) observed points of X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>margianl survival function of Y at (ordered) observed points of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Chaieb L, Rivest LP, Abdous B (2006), Estimating Survival Under a Dependent Truncation, Biometrika 93: 655-669.
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########  AIDS data of Kalbfleisch &amp; Lawless (1989, JASA) #############
inf1=c(23,38,38,36,27,45,23,48,25,42,33,45,33,39,34,48,50,35,26,43,3,53,40,53,
28,34,42,66,19,21,37,33,31,48,32,43,17,64,58,67,49,67,35,12,19,60,53,56,65,53)
inf2=c(36,12,50,45,33,55,37,46,62,57,34,56,57,64,57,42,54,28,36,66,19,45,53,67,
68,54,40,60,54,42,74,71,43,61,68,52,75,46,62,67,48,68,58,55,70,33,56,47,64,15)
inf3=c(41,35,67,35,71,67,36,69,45,76,66,22,74,49,42,15,29,62,65,75,65,69,62,56,
52,82,46,75,27,56,70,49,66,73,76,43,50,41,49,68,39,67,61,82,69,65,56,59,57,57)
inf4=c(46,68,76,64,50,59,80,46,78,26,62,19,22,26,76,27,62,75,76,57,58,59,8,41,
70,57,58,63,37,75,58,39,38,73,72,41,56,50,79,83,76,29,17,69,86,29,65,75,74,42)
inf5=c(65,61,84,41,83,58,45,83,80,84,59,85,59,65,47,64,73,81,79,36,67,87,85,29,
72,77,72,67,53,54,17,61,65,48,57,29,36,30,45,40,75,43,76,66,86,57,75,71,51)
inf6=c(60,41,53,48,36,72,60,36,48,55,58,60,89,37,82,41,68,71,63,49,37,60,78,52,
60,85,68,37,39,22,12,63,80,45,47,85,29,60,84,70,61,69,77,63)
x1=c(27,14,15,18,28,10,34,17,34,17,29,17,29,23,29,15,13,29,38,21,61,12,25,12,38,
32,24,0,48,46,30,34,37,21,37,26,53,6,13,4,22,4,37,60,53,13,20,17,8,20)
x2=c(38,62,24,29,41,19,37,28,13,18,41,19,18,11,18,33,21,48,40,10,58,32,24,11,10,
25,39,19,25,37,5,8,37,20,13,29,6,35,19,14,33,13,23,27,12,49,26,35,18,68)
x3=c(42,48,16,48,12,16,47,14,38,8,18,62,10,35,42,69,55,22,20,10,20,16,23,30,34,4,
40,11,59,30,16,37,20,13,10,43,36,46,38,19,48,20,26,5,18,23,32,29,31,31)
x4=c(42,20,12,24,38,29,8,43,11,63,27,70,67,63,13,62,27,15,14,33,32,32,83,50,21,
34,33,29,55,17,34,53,54,19,20,52,37,43,14,10,17,64,76,25,8,65,29,19,20,52)
x5=c(29,33,10,53,11,36,49,12,15,11,36,10,36,31,49,32,23,15,17,60,29,9,11,67,24,
19,24,29,43,43,80,36,32,49,40,68,61,68,53,58,23,55,22,32,12,41,23,27,47)
x6=c(38,57,46,51,63,27,39,63,51,44,41,39,10,63,18,59,32,29,37,51,63,40,22,48,40,
15,33,64,62,79,89,38,21,56,54,16,72,41,17,31,40,32,24,38)

t=c(inf1,inf2,inf3,inf4,inf5,inf6) #### the month of infection with 1=January 1978 ####
x=c(x1,x2,x3,x4,x5,x6) #### the duration of the incubation period (month) ####
y=102-t #### 102 is the study period (month) ####

######### Breaking ties by adding small noise to the data ########## 
set.seed(1)
x=x+runif(293,min=-0.4,max=0.4)
y=y+runif(293,min=-0.4,max=0.4)
x[x&lt;=0]=runif(1,0,0.4)

x.trunc=x
z.trunc=y
d=rep(1,length(x.trunc)) ### all data is not censored ###

CHAIEB.Frank(x.trunc,z.trunc,d)[c(1,2,3)]
######### The same numerical results as Table 3 of Emura et al. (2011) ###########
</code></pre>

<hr>
<h2 id='dependAFT.reg'>
Semiparametric Inference for the AFT regression Model with Dependent Truncation
</h2><span id='topic+dependAFT.reg'></span>

<h3>Description</h3>

<p>Regression estimation for the AFT regression model based on left-truncated and right-censored data (Emura &amp; Wang 2016).
The dependency of truncation on lifetime is modeled through the AFT regression form.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dependAFT.reg(t.trunc, y.trunc, d, x1.trunc, initial = c(0, 0), LY = FALSE, 
beta1_low = -0.2, beta1_up = 0.2, alpha = 1, epsilon = 1/50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dependAFT.reg_+3A_t.trunc">t.trunc</code></td>
<td>
<p>vector of left-truncation variables satisfying t.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_y.trunc">y.trunc</code></td>
<td>
<p>vector of lifetime variables satisfying t.trunc&lt;=y.trunc</p>
</td></tr> 
<tr><td><code id="dependAFT.reg_+3A_d">d</code></td>
<td>
<p>vector of censoring indicators</p>
</td></tr> 
<tr><td><code id="dependAFT.reg_+3A_x1.trunc">x1.trunc</code></td>
<td>
<p>vector of 1-dimensional covariates</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_initial">initial</code></td>
<td>
<p>a pair of initial values for (beta, gamma)</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_ly">LY</code></td>
<td>
<p>Lai and Ying's estimator for initial values</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_beta1_low">beta1_low</code></td>
<td>
<p>lower bound for beta</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_beta1_up">beta1_up</code></td>
<td>
<p>upper bound for beta</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_alpha">alpha</code></td>
<td>
<p>some tuning parameter for optimization, alpha=1 is default</p>
</td></tr>
<tr><td><code id="dependAFT.reg_+3A_epsilon">epsilon</code></td>
<td>
<p>some tuning parameter for kernel methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only the univariate regression (only one covariate) is allowed.
</p>


<h3>Value</h3>

<table>
<tr><td><code>beta</code></td>
<td>
<p>inference results for beta</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>inference results for gamma</p>
</td></tr>
<tr><td><code>beta_LY</code></td>
<td>
<p>the estimator of Lai &amp; Ying (1991)</p>
</td></tr>
<tr><td><code>S2_Minimum</code></td>
<td>
<p>minimum of the objective function</p>
</td></tr>
<tr><td><code>detail</code></td>
<td>
<p>detailed results for minimizing the estimating objective function &quot;optim&quot;</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Wang W (2016), Semiparametric Inference for an Accelerated Failure Time Model with Dependent Truncation, Ann Inst Stat Math 68 (5): 1073-94.
</p>
<p>Lai TL, Ying Z (1991), Rank Regression Methods for Left-Truncated and Right-Censored Data. Annals of Statistics 19: 531-556.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y.trunc=c(
  -0.52,  0.22, -1.42,  0.05,  0.32, -1.02, -0.47,  0.10, -0.38, -0.18,  0.97,  0.04, -0.10,
   0.50,  0.57, -0.80, -0.24,  0.07, -0.04,  0.88, -0.52, -0.28, -0.55,  0.53,  0.99, -0.52,
  -0.59, -0.48, -0.07,  0.20, -0.34,  1.00, -0.52)
t.trunc=c(
  -2.05, -0.25, -2.43, -0.32, -0.27, -1.06, -0.95, -0.82, -0.66, -0.28, -1.14, -0.32, -1.19,
  -2.18, -0.45, -1.71, -0.84, -1.93, -1.04, -2.58, -1.97, -2.15, -0.59, -0.74, -1.26, -2.57,
  -2.40, -2.22, -1.52, -0.21, -1.50, -1.99, -1.79)

d=c(1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1,
    0, 1, 1,1)

x1.trunc=c(
  0.27, 0.66, 0.77, 0.21, 0.48, 0.11, 0.69, 0.32, 0.33, 0.43, 0.12, 0.60, 0.13, 0.43, 0.99,
  0.21, 0.93, 0.60, 0.45, 0.41, 0.86, 0.90, 0.76, 0.93, 0.27, 0.13, 0.82, 0.17, 0.63, 0.31,
  0.13, 0.48, 0.32)

### Data analysis in Emura &amp; Wang (2016) ###
# dependAFT.reg(t.trunc,y.trunc,d,x1.trunc,alpha=2,LY=TRUE,beta1_low=-5,beta1_up=5)
dependAFT.reg(t.trunc,y.trunc,d,x1.trunc,LY=FALSE,beta1_low=-5,beta1_up=5)

#### Channing hourse data analysis; Section 5 of Emura &amp; Wang (2016) ##### 
# library(KMsurv)
# data(channing)
# y.trunc=log(channing$age)
# t.trunc=log(channing$ageentry)
# d=channing$death
# x1.trunc=as.numeric(channing$gender==1)

# dependAFT.reg(t.trunc,y.trunc,d,x1.trunc,beta1_low=-0.2,beta1_up=0.2)
# dependAFT.reg(t.trunc,y.trunc,d,x1.trunc,LY=TRUE,alpha=2,beta1_low=-0.2,beta1_up=0.2)
</code></pre>

<hr>
<h2 id='EMURA.Clayton'>Semi-parametric Inference under the Clayton Copula with Dependent Truncation</h2><span id='topic+EMURA.Clayton'></span>

<h3>Description</h3>

<p>A copula-based estimation based on dependent truncation data under 
the Clayton copula model (Emura, Wang &amp; Hung 2011; Emura &amp; Murotani 2015).
The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Clayton copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMURA.Clayton(x.trunc, z.trunc, d, a = 1/10, plotX = TRUE, plotY = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMURA.Clayton_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Clayton_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Clayton_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Clayton_+3A_a">a</code></td>
<td>
<p>tuning parameter adjusting for small the risk sets (pp.360-361: Emura, Wang &amp; Hung 2011 Sinica)</p>
</td></tr>
<tr><td><code id="EMURA.Clayton_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, plot the distribution function of X</p>
</td></tr>
<tr><td><code id="EMURA.Clayton_+3A_ploty">plotY</code></td>
<td>
<p>if TRUE, plot the survival function of Y</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the moment-based estimate for the marginal distributions
and the estimate of the association parameter under the Clayton copula model.
The method can handle right-censoring for Y in which Z=min(Y, C) and I(Y&lt;=C) are observed with
censoring variable C.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>association parameter</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Kendall's tau between X and Y</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>association parameter</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>inclusion probability, defined by c=Pr(X&lt;=Z)</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>marginal distribution function of X at at (ordered) observed points of X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>margianl survival function of Y at (ordered) observed points of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Wang W, Hung HN (2011), Semiparametric Inference for Copula Models for Truncated Data, Stat Sinica 21: 349-367.
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########  AIDS data of Kalbfleisch &amp; Lawless (1989, JASA) #############
inf1=c(23,38,38,36,27,45,23,48,25,42,33,45,33,39,34,48,50,35,26,43,3,53,40,53,
28,34,42,66,19,21,37,33,31,48,32,43,17,64,58,67,49,67,35,12,19,60,53,56,65,53)
inf2=c(36,12,50,45,33,55,37,46,62,57,34,56,57,64,57,42,54,28,36,66,19,45,53,67,
68,54,40,60,54,42,74,71,43,61,68,52,75,46,62,67,48,68,58,55,70,33,56,47,64,15)
inf3=c(41,35,67,35,71,67,36,69,45,76,66,22,74,49,42,15,29,62,65,75,65,69,62,56,
52,82,46,75,27,56,70,49,66,73,76,43,50,41,49,68,39,67,61,82,69,65,56,59,57,57)
inf4=c(46,68,76,64,50,59,80,46,78,26,62,19,22,26,76,27,62,75,76,57,58,59,8,41,
70,57,58,63,37,75,58,39,38,73,72,41,56,50,79,83,76,29,17,69,86,29,65,75,74,42)
inf5=c(65,61,84,41,83,58,45,83,80,84,59,85,59,65,47,64,73,81,79,36,67,87,85,29,
72,77,72,67,53,54,17,61,65,48,57,29,36,30,45,40,75,43,76,66,86,57,75,71,51)
inf6=c(60,41,53,48,36,72,60,36,48,55,58,60,89,37,82,41,68,71,63,49,37,60,78,52,
60,85,68,37,39,22,12,63,80,45,47,85,29,60,84,70,61,69,77,63)
x1=c(27,14,15,18,28,10,34,17,34,17,29,17,29,23,29,15,13,29,38,21,61,12,25,12,38,
32,24,0,48,46,30,34,37,21,37,26,53,6,13,4,22,4,37,60,53,13,20,17,8,20)
x2=c(38,62,24,29,41,19,37,28,13,18,41,19,18,11,18,33,21,48,40,10,58,32,24,11,10,
25,39,19,25,37,5,8,37,20,13,29,6,35,19,14,33,13,23,27,12,49,26,35,18,68)
x3=c(42,48,16,48,12,16,47,14,38,8,18,62,10,35,42,69,55,22,20,10,20,16,23,30,34,4,
40,11,59,30,16,37,20,13,10,43,36,46,38,19,48,20,26,5,18,23,32,29,31,31)
x4=c(42,20,12,24,38,29,8,43,11,63,27,70,67,63,13,62,27,15,14,33,32,32,83,50,21,
34,33,29,55,17,34,53,54,19,20,52,37,43,14,10,17,64,76,25,8,65,29,19,20,52)
x5=c(29,33,10,53,11,36,49,12,15,11,36,10,36,31,49,32,23,15,17,60,29,9,11,67,24,
19,24,29,43,43,80,36,32,49,40,68,61,68,53,58,23,55,22,32,12,41,23,27,47)
x6=c(38,57,46,51,63,27,39,63,51,44,41,39,10,63,18,59,32,29,37,51,63,40,22,48,40,
15,33,64,62,79,89,38,21,56,54,16,72,41,17,31,40,32,24,38)

t=c(inf1,inf2,inf3,inf4,inf5,inf6) #### the month of infection with 1=January 1978 ####
x=c(x1,x2,x3,x4,x5,x6) #### the duration of the incubation period (month) ####
y=102-t #### 102 is the study period (month) ####

######### Breaking ties by adding small noise to the data ########## 
set.seed(1)
x=x+runif(293,min=-0.4,max=0.4)
y=y+runif(293,min=-0.4,max=0.4)
x[x&lt;=0]=runif(1,0,0.4)

x.trunc=x
z.trunc=y
d=rep(1,length(x.trunc)) ### all data is not censored ###

EMURA.Clayton(x.trunc,z.trunc,d)[c(1,2,3)]
######### The same numerical results as Table 3 of Emura et al. (2011) ###########
</code></pre>

<hr>
<h2 id='EMURA.Frank'>Semi-parametric Inference under the Frank Copula with Dependent Truncation</h2><span id='topic+EMURA.Frank'></span>

<h3>Description</h3>

<p>A copula-based estimation based on dependent truncation data under 
the Frank copula model (Emura, Wang &amp; Hung 2011; Emura &amp; Murotani 2015).
The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Frank copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EMURA.Frank(x.trunc, z.trunc, d, a = 1/10, plotX = TRUE, plotY = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EMURA.Frank_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Frank_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Frank_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
<tr><td><code id="EMURA.Frank_+3A_a">a</code></td>
<td>
<p>tuning parameter adjusting for small the risk sets (pp.360-361: Emura, Wang &amp; Hung 2011 Sinica)</p>
</td></tr>
<tr><td><code id="EMURA.Frank_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, plot the distribution function of X</p>
</td></tr>
<tr><td><code id="EMURA.Frank_+3A_ploty">plotY</code></td>
<td>
<p>if TRUE, plot the survival function of Y</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the moment-based estimate for the marginal distributions
and the estimate of the association parameter under the Frank copula model.
The method can handle right-censoring for Y in which Z=min(Y, C) and I(Y&lt;=C) are observed with
censoring variable C.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>association parameter</p>
</td></tr>
<tr><td><code>tau</code></td>
<td>
<p>Kendall's tau between X and Y</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p>inclusion probability, defined by c=Pr(X&lt;=Z)</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>marginal distribution function of X at at (ordered) observed points of X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>margianl survival function of Y at (ordered) observed points of Y</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Wang W, Hung HN (2011), Semiparametric Inference for Copula Models for Truncated Data, Stat Sinica 21: 349-367.
</p>
<p>Emura T, Murotani K (2015), An Algorithm for Estimating Survival Under a Copula-based Dependent Truncation Model, TEST 24 (No.4): 734-751.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>###########  AIDS data of Kalbfleisch &amp; Lawless (1989, JASA) #############
inf1=c(23,38,38,36,27,45,23,48,25,42,33,45,33,39,34,48,50,35,26,43,3,53,40,53,
28,34,42,66,19,21,37,33,31,48,32,43,17,64,58,67,49,67,35,12,19,60,53,56,65,53)
inf2=c(36,12,50,45,33,55,37,46,62,57,34,56,57,64,57,42,54,28,36,66,19,45,53,67,
68,54,40,60,54,42,74,71,43,61,68,52,75,46,62,67,48,68,58,55,70,33,56,47,64,15)
inf3=c(41,35,67,35,71,67,36,69,45,76,66,22,74,49,42,15,29,62,65,75,65,69,62,56,
52,82,46,75,27,56,70,49,66,73,76,43,50,41,49,68,39,67,61,82,69,65,56,59,57,57)
inf4=c(46,68,76,64,50,59,80,46,78,26,62,19,22,26,76,27,62,75,76,57,58,59,8,41,
70,57,58,63,37,75,58,39,38,73,72,41,56,50,79,83,76,29,17,69,86,29,65,75,74,42)
inf5=c(65,61,84,41,83,58,45,83,80,84,59,85,59,65,47,64,73,81,79,36,67,87,85,29,
72,77,72,67,53,54,17,61,65,48,57,29,36,30,45,40,75,43,76,66,86,57,75,71,51)
inf6=c(60,41,53,48,36,72,60,36,48,55,58,60,89,37,82,41,68,71,63,49,37,60,78,52,
60,85,68,37,39,22,12,63,80,45,47,85,29,60,84,70,61,69,77,63)
x1=c(27,14,15,18,28,10,34,17,34,17,29,17,29,23,29,15,13,29,38,21,61,12,25,12,38,
32,24,0,48,46,30,34,37,21,37,26,53,6,13,4,22,4,37,60,53,13,20,17,8,20)
x2=c(38,62,24,29,41,19,37,28,13,18,41,19,18,11,18,33,21,48,40,10,58,32,24,11,10,
25,39,19,25,37,5,8,37,20,13,29,6,35,19,14,33,13,23,27,12,49,26,35,18,68)
x3=c(42,48,16,48,12,16,47,14,38,8,18,62,10,35,42,69,55,22,20,10,20,16,23,30,34,4,
40,11,59,30,16,37,20,13,10,43,36,46,38,19,48,20,26,5,18,23,32,29,31,31)
x4=c(42,20,12,24,38,29,8,43,11,63,27,70,67,63,13,62,27,15,14,33,32,32,83,50,21,
34,33,29,55,17,34,53,54,19,20,52,37,43,14,10,17,64,76,25,8,65,29,19,20,52)
x5=c(29,33,10,53,11,36,49,12,15,11,36,10,36,31,49,32,23,15,17,60,29,9,11,67,24,
19,24,29,43,43,80,36,32,49,40,68,61,68,53,58,23,55,22,32,12,41,23,27,47)
x6=c(38,57,46,51,63,27,39,63,51,44,41,39,10,63,18,59,32,29,37,51,63,40,22,48,40,
15,33,64,62,79,89,38,21,56,54,16,72,41,17,31,40,32,24,38)

t=c(inf1,inf2,inf3,inf4,inf5,inf6) #### the month of infection with 1=January 1978 ####
x=c(x1,x2,x3,x4,x5,x6) #### the duration of the incubation period (month) ####
y=102-t #### 102 is the study period (month) ####

######### Breaking ties by adding small noise to the data ########## 
set.seed(1)
x=x+runif(293,min=-0.4,max=0.4)
y=y+runif(293,min=-0.4,max=0.4)
x[x&lt;=0]=runif(1,0,0.4)

x.trunc=x
z.trunc=y
d=rep(1,length(x.trunc)) ### all data is not censored ###

EMURA.Frank(x.trunc,z.trunc,d)[c(1,2,3)]
######### The same numerical results as Table 3 of Emura et al. (2011) ###########
</code></pre>

<hr>
<h2 id='Logrank.stat'>
The weighted log-rank statistics for testing quasi-independence (without ties in data)
</h2><span id='topic+Logrank.stat'></span>

<h3>Description</h3>

<p>The three log-rank statistics (L_0, L_1, and L_log) corresponding to 3 different weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Logrank.stat(x.trunc, z.trunc, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Logrank.stat_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="Logrank.stat_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="Logrank.stat_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there is no tie in the data, the function &quot;Logrank.stat.tie&quot; and &quot;Logrank.stat&quot; give identical results.
However, &quot;Logrank.stat&quot; is computationally more efficient. The simulations of Emura &amp; Wang (2010) are 
based on &quot;Logrank.stat&quot; since simulated data are generated from continuous distributions. The real data analyses 
of Emura &amp; Wang (2010) are based on &quot;Logrank.stat.tie&quot; since there are many ties in the data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>L0</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Clayton copula type dependence)</p>
</td></tr>
<tr><td><code>L1</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Frank copula type dependence)</p>
</td></tr>
<tr><td><code>Llog</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Gumbel copula type dependence)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Wang W (2010) Testing quasi-independence for truncation data. Journal of Multivariate Analysis 101, 223-239
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.trunc=c(10,5,7,1,3,9)
z.trunc=c(12,11,8,6,4,13)
d=c(1,1,1,1,0,1)
Logrank.stat(x.trunc,z.trunc,d)
</code></pre>

<hr>
<h2 id='Logrank.stat.tie'>
The weighted log-rank statistics for testing quasi-independence (with ties in data)
</h2><span id='topic+Logrank.stat.tie'></span>

<h3>Description</h3>

<p>The three log-rank statistics (L_0, L_1, and L_log) corresponding to 3 different weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Logrank.stat.tie(x.trunc, z.trunc, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Logrank.stat.tie_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="Logrank.stat.tie_+3A_z.trunc">z.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=z.trunc</p>
</td></tr>
<tr><td><code id="Logrank.stat.tie_+3A_d">d</code></td>
<td>
<p>censoring indicator(0=censoring,1=failure) for z.trunc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If there is no tie in the data, the function &quot;Logrank.stat.tie&quot; and &quot;Logrank.stat&quot; give identical results.
However, &quot;Logrank.stat&quot; is computationally more efficient. The simulations of Emura &amp; Wang (2010) are 
based on &quot;Logrank.stat&quot; since simulated data are generated from continuous distributions. The real data analyses 
of Emura &amp; Wang (2010) are based on &quot;Logrank.stat.tie&quot; since there are many ties in the data.
</p>


<h3>Value</h3>

<table>
<tr><td><code>L0</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Clayton copula type dependence)</p>
</td></tr>
<tr><td><code>L1</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Frank copula type dependence)</p>
</td></tr>
<tr><td><code>Llog</code></td>
<td>
<p>Logrank statistics (most powerfull to detect the Gumbel copula type dependence)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Wang W (2010) Testing quasi-independence for truncation data. Journal of Multivariate Analysis 101, 223-239
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.trunc=c(10,5,7,1,3,9)
z.trunc=c(12,11,8,6,4,13)
d=c(1,1,1,1,0,1)
Logrank.stat.tie(x.trunc,z.trunc,d)
Logrank.stat(x.trunc,z.trunc,d) ## since there is no tie, the results are the same.
</code></pre>

<hr>
<h2 id='NPMLE.Frank'>Semiparametric Inference under the Frank Copula with Dependent Truncation</h2><span id='topic+NPMLE.Frank'></span>

<h3>Description</h3>

<p>Nonparametric maximum likelihood estimation for dependent truncation data under 
the Frank copula models (Emura &amp; Wang, 2012). The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Frank copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPMLE.Frank(x.trunc, y.trunc,
x.fix = median(x.trunc), y.fix = median(y.trunc), plotX = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPMLE.Frank_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Frank_+3A_y.trunc">y.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Frank_+3A_x.fix">x.fix</code></td>
<td>
<p>vector of fixed points at which marginal distribution function of X is calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Frank_+3A_y.fix">y.fix</code></td>
<td>
<p>vector of fixed points at which marginal survival function of Y are calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Frank_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, the culumative distribution function for X is plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the nonparametric maximum likelihood estimate (NPMLE) for the marginal distributions
and the estimate of the association parameter under the Frank copula model. The method follows Emura &amp; Wang (2012).
The maximization of the likelihood (L) is conducted by minimizing -logL by &quot;nlm&quot;. Standard errors are calculated
from the diagonal elements in the observed Fisher information matrix, which is obtained from the output of the &quot;nlm&quot;.  
The method can handle ties but cannot handle right-censoring.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>estimate of association parameter</p>
</td></tr>
<tr><td><code>alpha_se</code></td>
<td>
<p>standard error of the estimate of association parameter</p>
</td></tr>
<tr><td><code>Hx</code></td>
<td>
<p>estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Hx_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Ay</code></td>
<td>
<p>estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Ay_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Fx_se</code></td>
<td>
<p>standard error of the estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>Sy_se</code></td>
<td>
<p>standard error of the estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>an integer indicating why the optimization process terminated in &quot;nlm&quot;: If conv=1,
the maximization of the likelihood function is properly done. Please refer R function &quot;nlm&quot;
for more details.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>the number of iterations until convergence</p>
</td></tr>
<tr><td><code>Grad</code></td>
<td>
<p>L_2 norm for the gradient vector at the solution (close to zero if the solution is proper)</p>
</td></tr>
<tr><td><code>MinEigen</code></td>
<td>
<p>Minimum eigenvalue of the Hessian matrix at the solution (positive if the solution is proper)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Wang W (2012)  Nonparametric maximum likelihood estimation for dependent truncation data based on copulas, Journal of Multivariate Analysis 110, 171-88
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.trunc=c(0.53, 0.43, 1.63, 0.98, 0.62)
y.trunc=c(1.20, 4.93, 2.09, 2.57, 1.52)
NPMLE.Frank(x.trunc, y.trunc, x.fix =1, y.fix = 2, plotX = TRUE)
</code></pre>

<hr>
<h2 id='NPMLE.Indep'>Semiparametric Inference under the Independence Copula with Dependent Truncation</h2><span id='topic+NPMLE.Indep'></span>

<h3>Description</h3>

<p>Nonparametric maximum likelihood estimation for dependent truncation data under 
the independence copula models (Emura &amp; Wang, 2012). The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the independence copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPMLE.Indep(x.trunc, y.trunc,
x.fix = median(x.trunc), y.fix = median(y.trunc), plotX = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPMLE.Indep_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Indep_+3A_y.trunc">y.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Indep_+3A_x.fix">x.fix</code></td>
<td>
<p>vector of fixed points at which marginal distribution function of X is calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Indep_+3A_y.fix">y.fix</code></td>
<td>
<p>vector of fixed points at which marginal survival function of Y are calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Indep_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, the culumative distribution function for X is plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the nonparametric maximum likelihood estimate (NPMLE) for the marginal distributions
and the estimate of the association parameter under the independence copula model. The method follows Emura &amp; Wang (2012).
The maximization of the likelihood (L) is conducted by minimizing -logL by &quot;nlm&quot;. Standard errors are calculated
from the diagonal elements in the observed Fisher information matrix, which is obtained from the output of the &quot;nlm&quot;.  
The method can handle ties but cannot handle right-censoring.
</p>


<h3>Value</h3>

<table>
<tr><td><code>Hx</code></td>
<td>
<p>estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Hx_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Ay</code></td>
<td>
<p>estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Ay_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Fx_se</code></td>
<td>
<p>standard error of the estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>Sy_se</code></td>
<td>
<p>standard error of the estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>an integer indicating why the optimization process terminated in &quot;nlm&quot;: If conv=1,
the maximization of the likelihood function is properly done. Please refer R function &quot;nlm&quot;
for more details.</p>
</td></tr>
<tr><td><code>Grad</code></td>
<td>
<p>L_2 norm for the gradient vector at the solution (close to zero if the solution is proper)</p>
</td></tr>
<tr><td><code>MinEigen</code></td>
<td>
<p>Minimum eigenvalue of the Hessian matrix at the solution (positive if the solution is proper)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Wang W (2012)  Nonparametric maximum likelihood estimation for dependent truncation data based on copulas, Journal of Multivariate Analysis 110, 171-88
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Generate independent truncated data with unit exponential marginals #####
set.seed(1)
m=35 #### sample size ####
x.trunc=y.trunc=numeric(m)
l=1
while(l&lt;=m){
  x=rexp(1,rate=1)
  y=rexp(1,rate=1)
  if((x&lt;y)){
  x.trunc[l]=x;y.trunc[l]=y
  l=l+1
  }
}

NPMLE.Indep(x.trunc, y.trunc, x.fix =1, y.fix = 1, plotX = TRUE)

#### compare the above estimate with the true value #####
c(Fx_true=1-exp(-1),Sy_true=exp(-1))
</code></pre>

<hr>
<h2 id='NPMLE.Normal'>Semiparametric Inference under the Normal Copula with Dependent Truncation</h2><span id='topic+NPMLE.Normal'></span>

<h3>Description</h3>

<p>Nonparametric maximum likelihood estimation for dependent truncation data under 
the normal(Gaussian) copula models (Emura &amp; Wang, 2012). The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the normal(Gaussian) copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPMLE.Normal(x.trunc, y.trunc,
x.fix = median(x.trunc), y.fix = median(y.trunc), plotX = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPMLE.Normal_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Normal_+3A_y.trunc">y.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Normal_+3A_x.fix">x.fix</code></td>
<td>
<p>vector of fixed points at which marginal distribution function of X is calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Normal_+3A_y.fix">y.fix</code></td>
<td>
<p>vector of fixed points at which marginal survival function of Y are calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Normal_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, the culumative distribution function for X is plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the nonparametric maximum likelihood estimate (NPMLE) for the marginal distributions
and the estimate of the association parameter under the normal(Gaussian) copula model. The method follows Emura &amp; Wang (2012).
The maximization of the likelihood (L) is conducted by minimizing -logL by &quot;nlm&quot;. Standard errors are calculated
from the diagonal elements in the observed Fisher information matrix, which is obtained from the output of the &quot;nlm&quot;.  
The method can handle ties but cannot handle right-censoring.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>estimate of association parameter</p>
</td></tr>
<tr><td><code>alpha_se</code></td>
<td>
<p>standard error of the estimate of association parameter</p>
</td></tr>
<tr><td><code>Hx</code></td>
<td>
<p>estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Hx_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Ay</code></td>
<td>
<p>estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Ay_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Fx_se</code></td>
<td>
<p>standard error of the estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>Sy_se</code></td>
<td>
<p>standard error of the estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>an integer indicating why the optimization process terminated in &quot;nlm&quot;: If conv=1,
the maximization of the likelihood function is properly done. Please refer R function &quot;nlm&quot;
for more details.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>the number of iterations until convergence</p>
</td></tr>
<tr><td><code>Grad</code></td>
<td>
<p>L_2 norm for the gradient vector at the solution (close to zero if the solution is proper)</p>
</td></tr>
<tr><td><code>MinEigen</code></td>
<td>
<p>Minimum eigenvalue of the Hessian matrix at the solution (positive if the solution is proper)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Wang W (2012)  Nonparametric maximum likelihood estimation for dependent truncation data based on copulas, Journal of Multivariate Analysis 110, 171-88
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x.trunc=c(0.53, 0.43, 1.63, 0.98, 0.62)
y.trunc=c(1.20, 4.93, 2.09, 2.57, 1.52)
# NPMLE.Normal(x.trunc, y.trunc, x.fix =1, y.fix = 2, plotX = TRUE)
</code></pre>

<hr>
<h2 id='NPMLE.Plackett'>Semiparametric Inference under the Plackett Copula with Dependent Truncation</h2><span id='topic+NPMLE.Plackett'></span>

<h3>Description</h3>

<p>Nonparametric maximum likelihood estimation for dependent truncation data under 
the Plackett copula models (Emura &amp; Wang, 2012). The forms of the marginal distributions for X and Y are completely unspecified, but
the parametric form of copula is specified as the Plackett copula. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NPMLE.Plackett(x.trunc, y.trunc,
x.fix = median(x.trunc), y.fix = median(y.trunc), plotX = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NPMLE.Plackett_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Plackett_+3A_y.trunc">y.trunc</code></td>
<td>
<p>vector of variables satisfying x.trunc&lt;=y.trunc</p>
</td></tr>
<tr><td><code id="NPMLE.Plackett_+3A_x.fix">x.fix</code></td>
<td>
<p>vector of fixed points at which marginal distribution function of X is calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Plackett_+3A_y.fix">y.fix</code></td>
<td>
<p>vector of fixed points at which marginal survival function of Y are calculated</p>
</td></tr>
<tr><td><code id="NPMLE.Plackett_+3A_plotx">plotX</code></td>
<td>
<p>if TRUE, the culumative distribution function for X is plotted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function produces the nonparametric maximum likelihood estimate (NPMLE) for the marginal distributions
and the estimate of the association parameter under the Plackett copula model. The method follows Emura &amp; Wang (2012).
The maximization of the likelihood (L) is conducted by minimizing -logL by &quot;nlm&quot;. Standard errors are calculated
from the diagonal elements in the observed Fisher information matrix, which is obtained from the output of the &quot;nlm&quot;.  
The method can handle ties but cannot handle right-censoring.
</p>


<h3>Value</h3>

<table>
<tr><td><code>alpha</code></td>
<td>
<p>estimate of association parameter</p>
</td></tr>
<tr><td><code>alpha_se</code></td>
<td>
<p>standard error of the estimate of association parameter</p>
</td></tr>
<tr><td><code>Hx</code></td>
<td>
<p>estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Hx_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative reverse-hazard function for X</p>
</td></tr>
<tr><td><code>Ay</code></td>
<td>
<p>estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Ay_se</code></td>
<td>
<p>standard error of the estimate of the marginal cumulative hazard function for Y</p>
</td></tr>
<tr><td><code>Fx</code></td>
<td>
<p>estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Fx_se</code></td>
<td>
<p>standard error of the estimate of the marginal distribution function for X</p>
</td></tr>
<tr><td><code>Sy</code></td>
<td>
<p>estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>Sy_se</code></td>
<td>
<p>standard error of the estimate of the marginal survival function for Y</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>an integer indicating why the optimization process terminated in &quot;nlm&quot;: If conv=1,
the maximization of the likelihood function is properly done. Please refer R function &quot;nlm&quot;
for more details.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>the number of iterations until convergence</p>
</td></tr>
<tr><td><code>Grad</code></td>
<td>
<p>L_2 norm for the gradient vector at the solution (close to zero if the solution is proper)</p>
</td></tr>
<tr><td><code>MinEigen</code></td>
<td>
<p>Minimum eigenvalue of the Hessian matrix at the solution (positive if the solution is proper)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Wang W (2012)  Nonparametric maximum likelihood estimation for dependent truncation data based on copulas, Journal of Multivariate Analysis 110, 171-88
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Generate truncated data from Plackett copula with unit exponential marginals #####
set.seed(1)
m=25 #### sample size ####
alpha_true=1/5.11 #### Kendall's tau on (X,Y) = 0.5 ####
x.trunc=y.trunc=numeric(m)
l=1
while(l&lt;=m){
  u=runif(1,min=0,max=1)
  v=runif(1,min=0,max=1)
  K=function(w){
    A=sqrt( (1+(alpha_true-1)*(u+w))^2-4*alpha_true*(alpha_true-1)*u*w )  
    2*v+(  1+(alpha_true-1)*u-(alpha_true+1)*w  )/A-1
  }
  low=0.00001*u
  up=1-0.00001*v
  for(j in 1:100){ #### Invert K(.) by the bisection method to ####
    mid=(low+up)/2;M&lt;-K(mid);U&lt;-K(up)
    if(M*U&gt;0){up&lt;-mid}else{low&lt;-mid}
  }
  w=mid
  x=-log(1-u);y=-log(w)
  if((x&lt;y)){
  x.trunc[l]=x;y.trunc[l]=y
  l=l+1
  }
}

NPMLE.Plackett(x.trunc, y.trunc, x.fix =1, y.fix = 1, plotX = TRUE)

#### compare the above estimate with the true value #####
c(alpha_true=alpha_true,Fx_true=1-exp(-1),Sy_true=exp(-1))
</code></pre>

<hr>
<h2 id='PMLE.Clayton.Exponential'>Parametric Inference for Bivariate Exponential Models with Dependent Truncation</h2><span id='topic+PMLE.Clayton.Exponential'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation (MLE) for dependent truncation data under 
the Clayton copula with Exponential margins for a bivariate lifetimes (L, X). The truncated data (L_j, X_j), subject to L_j&lt;=X_j for all j=1, ..., n,
are used to obtain the MLE for the population parameters of (L, X).</p>


<h3>Usage</h3>

<pre><code class='language-R'>PMLE.Clayton.Exponential(l.trunc, x.trunc, GOF = TRUE,
 Err=3, alpha_max=20,alpha_min=10^-4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_l.trunc">l.trunc</code></td>
<td>
<p>vector of truncation variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_gof">GOF</code></td>
<td>
<p>if TRUE, a goodness-of-fit test statistics is computed</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_err">Err</code></td>
<td>
<p>tuning parameter in the NR algorithm</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_alpha_max">alpha_max</code></td>
<td>
<p>upper bound for the copula parameter</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Exponential_+3A_alpha_min">alpha_min</code></td>
<td>
<p>lower bound for the copula parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Original paper is submitted for review</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>dependence parameter</p>
</td></tr>
<tr><td><code>lambda_L</code></td>
<td>
<p>scale parameter of L</p>
</td></tr>
<tr><td><code>lambda_X</code></td>
<td>
<p>scale parameter of X</p>
</td></tr>
<tr><td><code>mean_X</code></td>
<td>
<p>Mean lifetime of X, defined as E[X]</p>
</td></tr>
<tr><td><code>logL</code></td>
<td>
<p>Maximized log-likelihood</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p> inclusion probability, defined by c=Pr(L&lt;=X)</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p> Cramer-von Mises goodness-of-fit test statistics</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p> Kolmogorov-Smirnov goodness-of-fit test statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura, Chi-Hung Pan</p>


<h3>References</h3>

<p>Emura T, Pan CH (2017), Parametric likelihood inference and goodness-of-fit for dependently left-truncated data, a copula-based approach, Statistical Papers, doi:10.1007/s00362-017-0947-z.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l.trunc=c(22.207,23.002,23.982,28.551,21.789,17.042,25.997,23.220,18.854,21.857,
    27.321,13.767,23.982,20.110,15.779,26.821,27.934,15.292,28.843,15.985,
    23.580,53.770,21.731,28.844,17.046,16.506,15.696,27.959,13.272,16.482,
    24.210,17.626,27.770,
    18.264,17.694,20.014,13.152,16.886,14.894,15.531,6.951,15.841,14.974,
    38.292,11.204,38.156,26.652,17.101,28.953,18.325,18.391,18.220,15.896,
    16.447,23.642,19.170,23.257,20.428,20.947,28.462,23.210,17.900,46.134,
    39.300,11.768,17.717,
    30.863,22.350,44.976,18.169,30.164,21.822,18.201,22.895,27.189,10.915,
    25.503,12.350,39.869,17.698,26.296,14.091,21.011,11.201,10.757,25.692,
    32.372,13.592,19.102,16.112,53.281,57.298,36.450,19.651,20.755,30.788,20.0,39.62)

x.trunc = c(38.701,49.173,42.409,73.823,46.738,44.071,61.904,39.327,49.828,46.314,
    56.150,50.549,54.930,54.039,49.170,44.795,72.238,107.783,81.609,45.228,
    124.637,64.018,82.957,143.550,43.382,69.644,74.750,32.881,51.483,31.767,
    77.633,63.745,82.965,
    24.818,68.762,68.762,89.100,64.979,65.127,59.289,53.926,79.370,47.385,
    61.395,72.826,53.980,37.220,44.224,50.826,65.460,86.726,43.819,100.605,
    67.615,89.542,60.266,103.580,82.570,87.960,42.385,68.914,95.666,78.135,
    83.643,18.617,92.629, 
    42.415,34.346,106.569,20.758,52.003,77.179, 68.934,78.661,165.543,79.547,
    55.009,46.774,124.526,92.504,109.986,101.161,59.422,27.772,33.598,69.038,
    75.222,58.373,105.610,56.158,55.913,83.770,123.468,68.994,101.869,87.627,
    38.790,74.734)

u.min=10
l.trunc=l.trunc[-41]-u.min
x.trunc=x.trunc[-41]-u.min

PMLE.Clayton.Exponential(l.trunc,x.trunc)
</code></pre>

<hr>
<h2 id='PMLE.Clayton.Weibull'>Parametric Inference for Bivariate Weibull Models with Dependent Truncation</h2><span id='topic+PMLE.Clayton.Weibull'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation (MLE) for dependent truncation data under 
the Clayton copula with Weibull margins for a bivariate lifetimes (L, X). The truncated data (L_j, X_j), subject to L_j&lt;=X_j for all j=1, ..., n,
are used to obtain the MLE for the population parameters of (L, X).</p>


<h3>Usage</h3>

<pre><code class='language-R'>PMLE.Clayton.Weibull(l.trunc, x.trunc, GOF = TRUE,
 Err=2,alpha_max=20,alpha_min=10^-6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_l.trunc">l.trunc</code></td>
<td>
<p>vector of truncation variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_gof">GOF</code></td>
<td>
<p>if TRUE, a goodness-of-fit test statistics is computed</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_err">Err</code></td>
<td>
<p>tuning parameter in the NR algorithm</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_alpha_max">alpha_max</code></td>
<td>
<p>upper bound for the copula parameter</p>
</td></tr>
<tr><td><code id="PMLE.Clayton.Weibull_+3A_alpha_min">alpha_min</code></td>
<td>
<p>lower bound for the copula parameter</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Relevant paper is submitted for review</p>


<h3>Value</h3>

<table>
<tr><td><code>n</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>dependence parameter</p>
</td></tr>
<tr><td><code>lambda_L</code></td>
<td>
<p>scale parameter of L</p>
</td></tr>
<tr><td><code>lambda_X</code></td>
<td>
<p>scale parameter of X</p>
</td></tr>
<tr><td><code>nu_L</code></td>
<td>
<p>shape parameter of L</p>
</td></tr>
<tr><td><code>nu_X</code></td>
<td>
<p>shape parameter of X</p>
</td></tr>
<tr><td><code>mean_X</code></td>
<td>
<p>Mean lifetime of X, defined as E[X]</p>
</td></tr>
<tr><td><code>logL</code></td>
<td>
<p>Maximized log-likelihood</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p> inclusion probability, defined by c=Pr(L&lt;=X)</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p> Cramer-von Mises goodness-of-fit test statistics</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p> Kolmogorov-Smirnov goodness-of-fit test statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi Emura</p>


<h3>References</h3>

<p>Emura T, Pan CH (2017), Parametric likelihood inference and goodness-of-fit for dependently left-truncated data, a copula-based approach, Statistical Papers, doi:10.1007/s00362-017-0947-z.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l.trunc=c(22.207,23.002,23.982,28.551,21.789,17.042,25.997,23.220,18.854,21.857,
    27.321,13.767,23.982,20.110,15.779,26.821,27.934,15.292,28.843,15.985,
    23.580,53.770,21.731,28.844,17.046,16.506,15.696,27.959,13.272,16.482,
    24.210,17.626,27.770,
    18.264,17.694,20.014,13.152,16.886,14.894,15.531,6.951,15.841,14.974,
    38.292,11.204,38.156,26.652,17.101,28.953,18.325,18.391,18.220,15.896,
    16.447,23.642,19.170,23.257,20.428,20.947,28.462,23.210,17.900,46.134,
    39.300,11.768,17.717,
    30.863,22.350,44.976,18.169,30.164,21.822,18.201,22.895,27.189,10.915,
    25.503,12.350,39.869,17.698,26.296,14.091,21.011,11.201,10.757,25.692,
    32.372,13.592,19.102,16.112,53.281,57.298,36.450,19.651,20.755,30.788,20.0,39.62)

x.trunc = c(38.701,49.173,42.409,73.823,46.738,44.071,61.904,39.327,49.828,46.314,
    56.150,50.549,54.930,54.039,49.170,44.795,72.238,107.783,81.609,45.228,
    124.637,64.018,82.957,143.550,43.382,69.644,74.750,32.881,51.483,31.767,
    77.633,63.745,82.965,
    24.818,68.762,68.762,89.100,64.979,65.127,59.289,53.926,79.370,47.385,
    61.395,72.826,53.980,37.220,44.224,50.826,65.460,86.726,43.819,100.605,
    67.615,89.542,60.266,103.580,82.570,87.960,42.385,68.914,95.666,78.135,
    83.643,18.617,92.629, 
    42.415,34.346,106.569,20.758,52.003,77.179, 68.934,78.661,165.543,79.547,
    55.009,46.774,124.526,92.504,109.986,101.161,59.422,27.772,33.598,69.038,
    75.222,58.373,105.610,56.158,55.913,83.770,123.468,68.994,101.869,87.627,
    38.790,74.734)

u.min=10
l.trunc=l.trunc[-41]-u.min
x.trunc=x.trunc[-41]-u.min

PMLE.Clayton.Weibull(l.trunc,x.trunc)
</code></pre>

<hr>
<h2 id='PMLE.Normal'>Parametric Inference for Bivariate Normal Models with Dependent Truncation</h2><span id='topic+PMLE.Normal'></span>

<h3>Description</h3>

<p>Maximum likelihood estimation (MLE) for dependent truncation data under 
the bivariate normal distribution. A bivariate normal distribution is assumed for bivariate
random variables (L, X). The truncated data (L_j, X_j), subject to L_j&lt;=X_j for all j=1, ..., n,
are used to obtain the MLE for the population parameters of (L, X).</p>


<h3>Usage</h3>

<pre><code class='language-R'>PMLE.Normal(l.trunc, x.trunc, testimator = FALSE,GOF=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PMLE.Normal_+3A_l.trunc">l.trunc</code></td>
<td>
<p>vector of truncation variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Normal_+3A_x.trunc">x.trunc</code></td>
<td>
<p>vector of variables satisfying l.trunc&lt;=x.trunc</p>
</td></tr>
<tr><td><code id="PMLE.Normal_+3A_testimator">testimator</code></td>
<td>
<p>if TRUE, testimator is computed instead of MLE</p>
</td></tr>
<tr><td><code id="PMLE.Normal_+3A_gof">GOF</code></td>
<td>
<p>if TRUE, goodness-of-fit test is performed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>PMLE.Normal performs the maximum likelihood estimation for dependently left-truncated data under 
the bivariate normal distribution. &quot;PMLE.Normal&quot; implements the methodologies developed in 
Emura T. &amp; Konno Y. (2012, Statistical Papers 53, 133-149)and can produce the maximum likelihood estimates
and their standard errors. Furthermore, &quot;PMLE.Normal&quot; tests the independence assumption between truncation variable
and variable of interest via likelihood ratio test. The MLE is obtained by minimizing -logL using &quot;nlm&quot;, where L is the log-likelihood.
</p>


<h3>Value</h3>

<table>
<tr><td><code>mu_L</code></td>
<td>
<p>mean of L and its standard error</p>
</td></tr>
<tr><td><code>mu_X</code></td>
<td>
<p>mean of X and its standard error</p>
</td></tr>
<tr><td><code>var_L</code></td>
<td>
<p>variance of L and its standard error</p>
</td></tr>
<tr><td><code>var_X</code></td>
<td>
<p>variance of X and its standard error</p>
</td></tr>
<tr><td><code>cov_LX</code></td>
<td>
<p>covariance between L and X and its standard error</p>
</td></tr>
<tr><td><code>c</code></td>
<td>
<p> inclusion probability, defined by c=Pr(L&lt;=X), and its standard error</p>
</td></tr>
<tr><td><code>test</code></td>
<td>
<p> Likelihood ratio statistic and p-value</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p> Cramer-von Mises goodness-of-fit test statistics</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p> Kolmogorov-Smirnov goodness-of-fit test statistics</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Takeshi EMURA</p>


<h3>References</h3>

<p>Emura T, Konno Y (2012), Multivariate Normal Distribution Approaches for Dependently Truncated Data.
Statistical Papers 53 (No.1), 133-149.
</p>
<p>Emura T, Konno Y (2014), Erratum to: Multivariate Normal Distribution Approaches for Dependently Truncated Data, Statistical Papers 55 (No.4): 1233-36
</p>


<h3>Examples</h3>

<pre><code class='language-R'>l.trunc=c(1,2,3,4,5,6,7,8,8)
x.trunc=c(2,4,4,5,5,7,7,9,10)
PMLE.Normal(l.trunc,x.trunc,testimator=FALSE)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
