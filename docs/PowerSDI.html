<!DOCTYPE html><html><head><title>Help for package PowerSDI</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PowerSDI}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Accuracy'><p>Verify how well NASA-POWER Data Represent Observed Data</p></a></li>
<li><a href='#DistPar'><p>Parameters for Calculating the SDIs Provided by the ScientSDI Function</p></a></li>
<li><a href='#ObsEst'><p>Example Data of the Input Required by the Accuracy Function</p></a></li>
<li><a href='#OperatSDI'><p>Calculate Routine NASA-SPI and NASA-SPEI Estimates</p></a></li>
<li><a href='#plot.PowerSDI.Accuracy'><p>Plots PowerSDI.Accuracy Objects</p></a></li>
<li><a href='#PlotData'><p>Plot Rainfall and Potential Evapotranspiration Data</p></a></li>
<li><a href='#PowerSDI-package'><p>PowerSDI: Calculate Standardised Drought Indices Using NASA POWER Data</p></a></li>
<li><a href='#print.PowerSDI.Accuracy'><p>Prints PowerSDI.Accuracy Objects</p></a></li>
<li><a href='#Reference'><p>Calculate the SPI and SPEI Using a Reference Data Source</p></a></li>
<li><a href='#refHS'><p>Example of the Input Required by the Reference Function</p></a></li>
<li><a href='#refPM'><p>Example of the Input Required by the Reference Function</p></a></li>
<li><a href='#ScientSDI'><p>Estimate parameters of Gamma, Generalized Extreme Value, or Generalized Logistic Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate Standardised Drought Indices Using NASA POWER Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A set of functions designed to calculate the standardised
    precipitation and standardised precipitation evapotranspiration indices
    using NASA POWER data as described in Blain et al. (2023)
    &lt;<a href="https://doi.org/10.2139%2Fssrn.4442843">doi:10.2139/ssrn.4442843</a>&gt;.  These indices are calculated using a reference
    data source.  The functions verify if the indices' estimates meet the
    assumption of normality and how well NASA POWER estimates represent
    real-world data.  Indices are calculated in a routine mode.  Potential
    evapotranspiration amounts and the difference between rainfall and potential
    evapotranspiration are also calculated.  The functions adopt a basic time
    scale that splits each month into four periods.  Days 1 to 7, days 8 to 14,
    days 15 to 21, and days 22 to 28, 29, 30, or 31, where 'TS=4' corresponds to
    a 1-month length moving window (calculated 4 times per month) and 'TS=48'
    corresponds to a 12-month length moving window (calculated 4 times per
    month).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, lmom, lubridate, nasapower, stats</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/gabrielblain/PowerSDI">https://github.com/gabrielblain/PowerSDI</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/gabrielblain/PowerSDI/issues">https://github.com/gabrielblain/PowerSDI/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), vcr (&ge; 0.6.0), vdiffr
(&ge; 1.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-15 10:46:29 UTC; Gabriel</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriel Constantino Blain
    <a href="https://orcid.org/0000-0001-8832-7734"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Graciela R. Sobierajski
    <a href="https://orcid.org/0000-0002-7211-9268"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Leticia L. Martins
    <a href="https://orcid.org/0000-0002-0299-3005"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Adam H. Sparks <a href="https://orcid.org/0000-0002-0061-8359"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriel Constantino Blain &lt;gabriel.blain@sp.gov.br&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-15 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Accuracy'>Verify how well NASA-POWER Data Represent Observed Data</h2><span id='topic+Accuracy'></span>

<h3>Description</h3>

<p>Calculates scalar measures of accuracy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Accuracy(obs_est, conf.int = "Yes", sig.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Accuracy_+3A_obs_est">obs_est</code></td>
<td>
<p>A 2-column matrix. The reference or observed and the estimated or predicted
data. See <code>ObsEst</code> object as an example.</p>
</td></tr>
<tr><td><code id="Accuracy_+3A_conf.int">conf.int</code></td>
<td>
<p>A character variable (<code>Yes</code> or <code>No</code>) defining if the function must
calculate confidence intervals.  Default is &ldquo;Yes&rdquo;.</p>
</td></tr>
<tr><td><code id="Accuracy_+3A_sig.level">sig.level</code></td>
<td>
<p>A numeric variable (between 0.90 and 0.95) defining the significance level
for parameter the confidence intervals.  Default is 0.95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>PowerSDI.Accuracy</code>, a <code>list</code>, which contains:
</p>

<ul>
<li><p> Absolute mean error (AME),
</p>
</li>
<li><p> square root of the mean squared error (RMSE),
</p>
</li>
<li><p> Willmott's indices of agreement:
</p>

<ul>
<li><p> original (dorig),
</p>
</li>
<li><p> modified (dmod) and
</p>
</li>
<li><p> refined (dref)
</p>
</li></ul>

</li>
<li><p> Pearson determination coefficient (R2), and
</p>
</li>
<li><p> if <code>conf.int = "Yes"</code>, confidence intervals.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- Accuracy(obs_est = ObsEst, conf.int = "No")
a

# A generic plotting method is also supplied
plot(a)

</code></pre>

<hr>
<h2 id='DistPar'>Parameters for Calculating the SDIs Provided by the ScientSDI Function</h2><span id='topic+DistPar'></span>

<h3>Description</h3>

<p>Contains parameters of the gamma and GEV distributions and the
<code>Pr(Rain = 0)</code>, &quot;probzero.rain&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DistPar
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 13 variables and 48 rows.
</p>

<dl>
<dt>lon</dt><dd><p>longitude in decimal degrees</p>
</dd>
<dt>lat</dt><dd><p>latitude in decimal degrees</p>
</dd>
<dt>quart.month</dt><dd><p>The quartile of each month</p>
</dd>
<dt>alfa.rain</dt><dd><p>Shape parameter of the gamma distribution</p>
</dd>
<dt>beta.rain</dt><dd><p>Scale parameter of the gamma distribution</p>
</dd>
<dt>probzero.rain</dt><dd><p>Probability of rain=0</p>
</dd>
<dt>loc.harg</dt><dd><p>Location parameter of the GEV distribution, PE calculated by
HS method</p>
</dd>
<dt>sc.harg</dt><dd><p>Scale parameter of the GEV distribution, PE calculated by HS
method</p>
</dd>
<dt>sh.harg</dt><dd><p>Shape parameter of the GEV distribution, PE calculated by HS
method</p>
</dd>
<dt>loc.pm</dt><dd><p>Location parameter of the GEV distribution, PE calculated by PM
method</p>
</dd>
<dt>sc.pm</dt><dd><p>Scale parameter of the GEV distribution, PE calculated by PM
method</p>
</dd>
<dt>sh.pm</dt><dd><p>Shape parameter of the GEV distribution, PE calculated by PM
method</p>
</dd>
<dt>TS</dt><dd><p>Time scale at which the SDIs will be calculated</p>
</dd>
</dl>



<h3>Source</h3>

<p>Generated by the <code>ScientSDI()</code> function using <abbr><span class="acronym">NASA</span></abbr>
<abbr><span class="acronym">POWER</span></abbr> data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DistPar)
</code></pre>

<hr>
<h2 id='ObsEst'>Example Data of the Input Required by the Accuracy Function</h2><span id='topic+ObsEst'></span>

<h3>Description</h3>

<p>Contains pairs of reference and estimated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ObsEst
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 2 variables and 1434 rows.
</p>

<dl>
<dt>PE_obs</dt><dd><p>PE data from a reference weather station</p>
</dd>
<dt>PE_est</dt><dd><p>PE data from the <abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr> project</p>
</dd>
</dl>



<h3>Source</h3>

<p>Generated by the PowerSDI package using data from <abbr><span class="acronym">NASA</span></abbr>
<abbr><span class="acronym">POWER</span></abbr> and Agronomic Institute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ObsEst)
</code></pre>

<hr>
<h2 id='OperatSDI'>Calculate Routine NASA-SPI and NASA-SPEI Estimates</h2><span id='topic+OperatSDI'></span>

<h3>Description</h3>

<p>Calculates the <abbr><span class="acronym">SPI</span></abbr> (Standardized Precipitation Index) and
<abbr><span class="acronym">SPEI</span></abbr> (Standardized Precipitation-Evapotranspiration Index) using
<abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr> data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OperatSDI(
  lon,
  lat,
  start.date,
  end.date,
  PEMethod = "HS",
  distr = "GEV",
  parms,
  TS = 4L
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OperatSDI_+3A_lon">lon</code></td>
<td>
<p>longitude in decimal degrees.</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_lat">lat</code></td>
<td>
<p>latitude in decimal degrees.</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_start.date">start.date</code></td>
<td>
<p>Date at each time when the calculation must start
(&ldquo;YYYY-MM-DD&rdquo;).</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_end.date">end.date</code></td>
<td>
<p>Date at each time when the calculation must end
(&ldquo;YYYY-MM-DD&rdquo;).</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_pemethod">PEMethod</code></td>
<td>
<p>A character variable (&ldquo;HS&rdquo; (Hargreaves &amp; Samani) or
&ldquo;PM&rdquo; (Penman-Monteith) defining the potential evapotranspiration
method.  Default is &ldquo;HS&rdquo;.</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_distr">distr</code></td>
<td>
<p>A character variable (&ldquo;GEV&rdquo; or &ldquo;GLO&rdquo;) defining
which distribution is used to calculate the <abbr><span class="acronym">SPEI</span></abbr>. Default is
&ldquo;GEV&rdquo; (generalized extreme value) with &ldquo;GLO&rdquo; (generalized
logistic distributions) as an option.</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_parms">parms</code></td>
<td>
<p>Parameters required for calculating the <abbr><span class="acronym">SPI</span></abbr> and
<abbr><span class="acronym">SPEI</span></abbr>.  It is provided by the <code><a href="#topic+ScientSDI">ScientSDI</a></code> function's
<code>DistPar</code>.</p>
</td></tr>
<tr><td><code id="OperatSDI_+3A_ts">TS</code></td>
<td>
<p>Time scale on the &ldquo;quart.month&rdquo; basis (integer values
between 1 and 96).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with six columns
</p>

<ul>
<li><p> rainfall,
</p>
</li>
<li><p> potential evapotranspiration (PE),
</p>
</li>
<li><p> difference between rainfall and PE (in millimiters),
</p>
</li>
<li><p> the NASA-SPI,
</p>
</li>
<li><p> the NASA-SPEI and
</p>
</li>
<li><p> the SDI categories corresponding to each indices estimates.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

# This example is not run as it requires data to be downloaded from an API,
#  which may fail.  It also uses data included in this package, "DistPar" for
#  `parms` here

OperatSDI(
  lon = -47.3,
  lat = -22.67,
  start.date = "2023-06-01",
  end.date = "2023-06-30",
  PEMethod = "HS",
  distr = "GEV",
  parms = DistPar,
  TS = 4)

</code></pre>

<hr>
<h2 id='plot.PowerSDI.Accuracy'>Plots PowerSDI.Accuracy Objects</h2><span id='topic+plot.PowerSDI.Accuracy'></span>

<h3>Description</h3>

<p>Custom <code>plot()</code> method for <code>PowerSDI.Accuracy</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PowerSDI.Accuracy'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.PowerSDI.Accuracy_+3A_x">x</code></td>
<td>
<p>a 'PowerSDI.Accuracy' object</p>
</td></tr>
<tr><td><code id="plot.PowerSDI.Accuracy_+3A_...">...</code></td>
<td>
<p>Other parameters as passed to <code>plot()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. Using this will display a
scatter plot of reference ETP data (x-axis) and estimated ETP (y-axis) in
the active <span class="rlang"><b>R</b></span> session.
</p>

<hr>
<h2 id='PlotData'>Plot Rainfall and Potential Evapotranspiration Data</h2><span id='topic+PlotData'></span>

<h3>Description</h3>

<p>Plots rainfall and potential evapotranspiration, both Penman-Monteith and
Hargreaves and Samani, amounts using <abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr> data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotData(lon, lat, start.date, end.date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotData_+3A_lon">lon</code></td>
<td>
<p>longitude in decimal degrees: (+) Eastern Hemisphere (-) Western Hemisphere.</p>
</td></tr>
<tr><td><code id="PlotData_+3A_lat">lat</code></td>
<td>
<p>latitude in decimal degrees: (+) Northern Hemisphere (-) Southern Hemisphere.</p>
</td></tr>
<tr><td><code id="PlotData_+3A_start.date">start.date</code></td>
<td>
<p>date at which the indices estimates should start (&quot;YYYY-MM-DD&quot;).</p>
</td></tr>
<tr><td><code id="PlotData_+3A_end.date">end.date</code></td>
<td>
<p>date at which the indices estimates should end (&quot;YYYY-MM-DD&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects. Using this will display scatter
plots of rainfall and potential evapotranspiration accumulated at the
1-quart.month time scale in the active <span class="rlang"><b>R</b></span> session.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# This example requires an Internet connection to fetch data and so is only
# run in interactive sessions

PlotData(
  lon = -47.3,
  lat = -22.87,
  start.date = "2021-12-28",
  end.date = "2022-12-31"
)

</code></pre>

<hr>
<h2 id='PowerSDI-package'>PowerSDI: Calculate Standardised Drought Indices Using NASA POWER Data</h2><span id='topic+PowerSDI'></span><span id='topic+PowerSDI-package'></span>

<h3>Description</h3>

<p>A set of functions designed to calculate the standardised precipitation and standardised precipitation evapotranspiration indices using NASA POWER data as described in Blain et al. (2023) <a href="https://doi.org/10.2139/ssrn.4442843">doi:10.2139/ssrn.4442843</a>. These indices are calculated using a reference data source. The functions verify if the indices' estimates meet the assumption of normality and how well NASA POWER estimates represent real-world data. Indices are calculated in a routine mode. Potential evapotranspiration amounts and the difference between rainfall and potential evapotranspiration are also calculated. The functions adopt a basic time scale that splits each month into four periods. Days 1 to 7, days 8 to 14, days 15 to 21, and days 22 to 28, 29, 30, or 31, where 'TS=4' corresponds to a 1-month length moving window (calculated 4 times per month) and 'TS=48' corresponds to a 12-month length moving window (calculated 4 times per month).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Gabriel Constantino Blain <a href="mailto:gabriel.blain@sp.gov.br">gabriel.blain@sp.gov.br</a> (<a href="https://orcid.org/0000-0001-8832-7734">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Graciela R. Sobierajski (<a href="https://orcid.org/0000-0002-7211-9268">ORCID</a>)
</p>
</li>
<li><p> Leticia L. Martins (<a href="https://orcid.org/0000-0002-0299-3005">ORCID</a>)
</p>
</li>
<li><p> Adam H. Sparks <a href="mailto:adamhsparks@gmail.com">adamhsparks@gmail.com</a> (<a href="https://orcid.org/0000-0002-0061-8359">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/gabrielblain/PowerSDI">https://github.com/gabrielblain/PowerSDI</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/gabrielblain/PowerSDI/issues">https://github.com/gabrielblain/PowerSDI/issues</a>
</p>
</li></ul>


<hr>
<h2 id='print.PowerSDI.Accuracy'>Prints PowerSDI.Accuracy Objects</h2><span id='topic+print.PowerSDI.Accuracy'></span>

<h3>Description</h3>

<p>Custom <code>print()</code> method for <code>PowerSDI.Accuracy</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'PowerSDI.Accuracy'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.PowerSDI.Accuracy_+3A_x">x</code></td>
<td>
<p>a <code>PowerSDI.Accuracy</code> object</p>
</td></tr>
<tr><td><code id="print.PowerSDI.Accuracy_+3A_digits">digits</code></td>
<td>
<p>The number of digits to be used after the decimal when
displaying accuracy values.</p>
</td></tr>
<tr><td><code id="print.PowerSDI.Accuracy_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing. Side-effect: pretty prints a <code>PowerSDI.Accuracy</code> object
in the <span class="rlang"><b>R</b></span> console.
</p>

<hr>
<h2 id='Reference'>Calculate the SPI and SPEI Using a Reference Data Source</h2><span id='topic+Reference'></span>

<h3>Description</h3>

<p>Calculates the Standardised Precipitation Index (<abbr><span class="acronym">SPI</span></abbr>) and
Standardised Precipitation-Evapotranspiration Index (<abbr><span class="acronym">SPEI</span></abbr>) using
a reference data source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Reference(ref, distr = "GEV", PEMethod = "HS", TS = 4L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Reference_+3A_ref">ref</code></td>
<td>
<p>A data frame with the variables required for calculating the <abbr><span class="acronym">SDI</span></abbr>s.
See <code>refHS</code> or <code>refPM</code> as examples.</p>
</td></tr>
<tr><td><code id="Reference_+3A_distr">distr</code></td>
<td>
<p>A character variable (&ldquo;GEV&rdquo; or &ldquo;GLO&rdquo;) defining which
distribution is used to calculate the <abbr><span class="acronym">SPEI</span></abbr>. Default is
&ldquo;GEV&rdquo;.</p>
</td></tr>
<tr><td><code id="Reference_+3A_pemethod">PEMethod</code></td>
<td>
<p>A character variable (&ldquo;HS&rdquo; or &ldquo;PM&rdquo;) defining the potential
evapotranspiration method.  Default is &ldquo;HS&rdquo;.</p>
</td></tr>
<tr><td><code id="Reference_+3A_ts">TS</code></td>
<td>
<p>Time scale on the &ldquo;quart.month&rdquo; basis (whole values between 1 and
96).  Default is 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with five columns
</p>

<ul>
<li><p> rain,
</p>
</li>
<li><p> potential evapotranspiration,
</p>
</li>
<li><p> difference between rainfall and potential evapotranspiration,
</p>
</li>
<li> <p><abbr><span class="acronym">SPI</span></abbr> calculated at the time scale selected by the user, and
</p>
</li>
<li> <p><abbr><span class="acronym">SPIE</span></abbr> calculated at the time scale selected by the user
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
Reference(ref = refHS, distr = "GEV", PEMethod = "HS", TS = 4)

</code></pre>

<hr>
<h2 id='refHS'>Example of the Input Required by the Reference Function</h2><span id='topic+refHS'></span>

<h3>Description</h3>

<p>Contains data for calculating the <abbr><span class="acronym">SPI</span></abbr> and <abbr><span class="acronym">SPEI</span></abbr>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refHS
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 10950 rows and 8 variables.
</p>

<dl>
<dt>YEAR</dt><dd><p>Year</p>
</dd>
<dt>MM</dt><dd><p>Month</p>
</dd>
<dt>DD</dt><dd><p>Day</p>
</dd>
<dt>tavg</dt><dd><p>Daily average air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>tmax</dt><dd><p>Daily maximum air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>tmin</dt><dd><p>Daily minimum air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>Ra</dt><dd><p>Daily top of the atmosphere radiation (MJ/m^2/day)</p>
</dd>
<dt>Rain</dt><dd><p>Daily rainfall amounts (mm)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agronomic Institute and <abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(refHS)
</code></pre>

<hr>
<h2 id='refPM'>Example of the Input Required by the Reference Function</h2><span id='topic+refPM'></span>

<h3>Description</h3>

<p>Contains data for calculating the <abbr><span class="acronym">SPI</span></abbr> and <abbr><span class="acronym">SPEI</span></abbr>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refPM
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 10958 rows and 11 variables.
</p>

<dl>
<dt>YEAR</dt><dd><p>Year</p>
</dd>
<dt>MM</dt><dd><p>Month</p>
</dd>
<dt>DD</dt><dd><p>Day</p>
</dd>
<dt>tavg</dt><dd><p>Daily average air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>tmax</dt><dd><p>Daily maximum air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>tmin</dt><dd><p>Daily minimum air temperature at 2 metres above the ground
(degrees C)</p>
</dd>
<dt>Ra</dt><dd><p>Daily top of the atmosphere radiation (MJ/m^2/day)</p>
</dd>
<dt>Rs</dt><dd><p>Daily global horizontal irradiance (MJ/m^2/day)</p>
</dd>
<dt>W</dt><dd><p>Daily average wind speed at 2 metres above the ground (m/s)</p>
</dd>
<dt>RH</dt><dd><p>Daily average relative humidity at 2 metres above the ground
(in percentage)</p>
</dd>
<dt>Rain</dt><dd><p>Daily rainfall amounts (mm)</p>
</dd>
</dl>



<h3>Source</h3>

<p>Agronomic Institute and <abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(refPM)
</code></pre>

<hr>
<h2 id='ScientSDI'>Estimate parameters of Gamma, Generalized Extreme Value, or Generalized Logistic Distributions</h2><span id='topic+ScientSDI'></span>

<h3>Description</h3>

<p>Verifies concepts expected from SDI.  The first step of the <abbr><span class="acronym">SPI</span></abbr> and
<abbr><span class="acronym">SPEI</span></abbr> algorithms is to calculate the cumulative probabilities of
their input variables (Guttman 1999).  Function estimates the parameters of
the gamma, generalized extreme value (GEV), or generalized logistic
distributions (GLO) through the L-moments method are provided.  This
function also allows users to remove suspicious values from the data
sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ScientSDI(
  lon,
  lat,
  start.date,
  end.date,
  distr = "GEV",
  TS = 4L,
  Good = "No",
  sig.level = 0.95,
  RainUplim = NULL,
  RainLowlim = NULL,
  PEUplim = NULL,
  PELowlim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ScientSDI_+3A_lon">lon</code></td>
<td>
<p>longitude in decimal degrees: (+) Eastern Hemisphere, (-) Western Hemisphere.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_lat">lat</code></td>
<td>
<p>latitude in decimal degrees: (+) Northern hemisphere, (-) Southern
Hemisphere.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_start.date">start.date</code></td>
<td>
<p>date at which the indices estimates should start. Format:
&ldquo;YYYY-MM-DD&rdquo;.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_end.date">end.date</code></td>
<td>
<p>date at which the indices estimates should end. Format: &ldquo;YYYY-MM-DD&rdquo;.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_distr">distr</code></td>
<td>
<p>A character variable (&ldquo;GEV&rdquo; or &ldquo;GLO&rdquo;) defining the distribution
to calculate the <abbr><span class="acronym">SPEI</span></abbr>.  Default is <code>GEV</code>.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_ts">TS</code></td>
<td>
<p>Time scale on the quart.month basis (integer values between 1 and 96).
Default is 4.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_good">Good</code></td>
<td>
<p>A character variable (&quot;Yes&quot; or &quot;No&quot;) to calculate or not the goodness-of-fit
and normality tests. Default is &quot;No&quot;.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_sig.level">sig.level</code></td>
<td>
<p>A numeric variable (between 0.90 and 0.95) defining the significance level
for parameter Good. Default is &quot;0.95&quot;.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_rainuplim">RainUplim</code></td>
<td>
<p>Optional. Upper limit in millimetres from which rainfall values larger than
it will be removed.  Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_rainlowlim">RainLowlim</code></td>
<td>
<p>Optional. Lower limit in millimetres from which rainfall values smaller than
it will be removed.  Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_peuplim">PEUplim</code></td>
<td>
<p>Optional. Upper limit in millimetres from which evapotranspiration values
larger than it will be removed. Valid for Hargreaves and Samani method
Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="ScientSDI_+3A_pelowlim">PELowlim</code></td>
<td>
<p>Optional. Lower limit in millimetres from which evapotranspiration values
smaller than it will be removed. Valid for Hargreaves and Samani method
Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> object with data calculated at the time scale selected by the
user.  If <code>Good = "Yes"</code>, this <code>list</code> object includes:
</p>

<dl>
<dt>SDI</dt><dd><p>The &ldquo;NASA-SPI&rdquo;, &ldquo;NASA-SPEI.HS&rdquo; and
&ldquo;NASA-SPEI.PM.&rdquo;</p>
</dd>
<dt>DistPar</dt><dd><p>The parameters of the distributions (gamma and
<abbr><span class="acronym">GEV</span></abbr>) used to calculate the indices.</p>
</dd>
<dt>GoodFit</dt><dd><p>The Lilliefors and Anderson-Darling tests goodness-of-fit
tests.</p>
</dd>
<dt>Normality</dt><dd><p>The outcomes of the two normality checking procedures (Wu
<em>et al</em>., 2006 and Stagge <em>et al</em>., 2015).</p>
</dd>
</dl>

<p>If <code>Good = "No"</code>, this <code>list</code> object includes <abbr><span class="acronym">SDI</span></abbr> and
DistPar.
</p>
<p>This function also presents other data (in millimiters) calculated from the
<abbr><span class="acronym">NASA</span></abbr> <abbr><span class="acronym">POWER</span></abbr> project:
</p>

<ul>
<li><p> Rainfall amounts (Rain),
</p>
</li>
<li><p> potential evapotranspiration values estimated through the Hargreaves
and Samani method (<abbr><span class="acronym">PEHS</span></abbr>),
</p>
</li>
<li><p> potential evapotranspiration values estimated through the FAO-56
Penman-Monteith method (<abbr><span class="acronym">PEPM</span></abbr>), and
</p>
</li>
<li><p> the difference between rainfall and potential evapotranspiration
(<abbr><span class="acronym">PPEHS</span></abbr> and <abbr><span class="acronym">PPEPM</span></abbr>).
</p>
</li></ul>



<h3>References</h3>

<p>Guttman, N.B., 1999. Accepting the standardized precipitation
index: a calculation algorithm 1. JAWRA Journal of the American Water
Resources Association, 35(2), pp.311-322.
</p>
<p>Stagge, J.H., Tallaksen, L.M., Gudmundsson, L., Van Loon, A.F. and Stahl,
K., 2015. Candidate distributions for climatological drought indices (SPI
and SPEI). International Journal of Climatology, 35(13), pp.4027-4040.
</p>
<p>Wu, H., Svoboda, M.D., Hayes, M.J., Wilhite, D.A. and Wen, F., 2006.
Appropriate application of the standardized precipitation index in arid
locations and dry seasons. International Journal of Climatology: A Journal
of the Royal Meteorological Society, 27(1), pp.65-79.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# This example requires an Internet connection to fetch data and takes &gt;5s
#  to run, and so is only run in interactive sessions

ScientSDI(
  lon = -47.3,
  lat = -22.87,
  start.date = "1993-01-01",
  end.date = "2022-12-31",
  TS = 1,
  Good = "no"
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
