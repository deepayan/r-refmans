<!DOCTYPE html><html lang="en"><head><title>Help for package fluxible</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fluxible}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#fluxible-package'><p>fluxible: Ecosystem Gas Fluxes Calculations for Closed Loop Chamber Setup</p></a></li>
<li><a href='#co2_conc'><p>CO2 concentration</p></a></li>
<li><a href='#co2_conc_missing'><p>CO2 concentration</p></a></li>
<li><a href='#co2_df_missing'><p>CO2 concentration with missing data</p></a></li>
<li><a href='#co2_df_short'><p>CO2 concentration</p></a></li>
<li><a href='#co2_fluxes'><p>CO2 fluxes</p></a></li>
<li><a href='#co2_liahovden'><p>CO2 concentration at Liahovden</p></a></li>
<li><a href='#conc_poster'><p>CO2 concentration</p></a></li>
<li><a href='#flux_calc'><p>calculates ecosystem gas fluxes</p></a></li>
<li><a href='#flux_check_item'><p>check the items inside <code>flux_fun_check</code></p></a></li>
<li><a href='#flux_cut'><p>filter cut data before calculating fluxes</p></a></li>
<li><a href='#flux_fit_type'><p>to check the type of fit</p></a></li>
<li><a href='#flux_fitting'><p>Fitting a model to concentration data and estimating the slope</p></a></li>
<li><a href='#flux_fitting_exp'><p>Fitting a model to the gas concentration curve and estimating the slope</p>
over time, using the exponential model from Zhao et al (2018)</a></li>
<li><a href='#flux_fitting_lin'><p>linear fit to gas concentration over time</p></a></li>
<li><a href='#flux_fitting_quadratic'><p>quadratic fit to gas concentration over time</p></a></li>
<li><a href='#flux_flag_count'><p>counts quality flags</p></a></li>
<li><a href='#flux_fun_check'><p>checking that arguments and columns are in the correct class</p></a></li>
<li><a href='#flux_gep'><p>Calculates GEP</p></a></li>
<li><a href='#flux_match'><p>Matching continuously measured fluxes with measurement IDs and meta data</p></a></li>
<li><a href='#flux_param_exp'><p>prepares text to print for flux_plot function</p></a></li>
<li><a href='#flux_param_lm'><p>prepares text to print in flux_plot</p></a></li>
<li><a href='#flux_plot'><p>plotting fluxes for visual evaluation</p></a></li>
<li><a href='#flux_plot_exp'><p>plotting fluxes with exponential fit</p></a></li>
<li><a href='#flux_plot_flag'><p>creates the flag column to be used by flux_plot</p></a></li>
<li><a href='#flux_plot_lin'><p>plotting fluxes with linear fit</p></a></li>
<li><a href='#flux_plot_quadratic'><p>plotting fluxes with a quadratic fit</p></a></li>
<li><a href='#flux_quality'><p>assessing quality of slopes calculated with flux_fitting</p></a></li>
<li><a href='#flux_quality_exp'><p>quality assessment for the slopes estimated by flux_fitting</p></a></li>
<li><a href='#flux_quality_lm'><p>quality assessment for the slopes estimated by flux_fitting</p></a></li>
<li><a href='#raw_twogases'><p>CO2 and CH4 concentration</p></a></li>
<li><a href='#record_liahovden'><p>Measurements meta data at Liahovden</p></a></li>
<li><a href='#record_short'><p>Measurements meta data</p></a></li>
<li><a href='#slopes0'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes0_flag'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes0_temp'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes0_vol'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes0lin'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes0lin_flag'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30_flag'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30lin'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30lin_flag'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30qua'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes30qua_flag'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes60'><p>Slopes for each flux</p></a></li>
<li><a href='#slopes60lin'><p>Slopes for each flux</p></a></li>
<li><a href='#twogases_record'><p>Field record</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Ecosystem Gas Fluxes Calculations for Closed Loop Chamber Setup</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-07</td>
</tr>
<tr>
<td>Description:</td>
<td>Processes the raw data from closed loop flux chamber (or tent)
    setups into ecosystem gas fluxes usable for analysis. It goes from a
    data frame of gas concentration over time (which can contain several
    measurements) and a meta data file indicating which measurement was done
    when, to a data frame of ecosystem gas fluxes including quality diagnostics.
    Functions provided include different models (exponential as described in
    Zhao et al (2018) &lt;<a href="https://doi.org/10.1016%2Fj.agrformet.2018.08.022">doi:10.1016/j.agrformet.2018.08.022</a>&gt;, quadratic and
    linear) to estimate the fluxes from the raw data, quality assessment,
    plotting for visual check and calculation of fluxes based on the setup
    specific parameters (chamber size, plot area, ...).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), vdiffr, forcats,
tidyverse, fs</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>broom, dplyr, ggforce, ggplot2, haven, lubridate, rlang,
purrr, stats, stringr, tidyr, zoo, progress, purrrlyr,
tidyselect</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://plant-functional-trait-course.github.io/fluxible/">https://plant-functional-trait-course.github.io/fluxible/</a>,
<a href="https://github.com/Plant-Functional-Trait-Course/fluxible">https://github.com/Plant-Functional-Trait-Course/fluxible</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Plant-Functional-Trait-Course/fluxible/issues">https://github.com/Plant-Functional-Trait-Course/fluxible/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-13 16:16:40 UTC; jga051</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Gaudard <a href="https://orcid.org/0000-0002-6989-7624"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Paul Efren Santos-Andrade [aut],
  Richard James Telford
    <a href="https://orcid.org/0000-0001-9826-3076"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Gaudard &lt;joseph.gaudard@pm.me&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-13 16:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='fluxible-package'>fluxible: Ecosystem Gas Fluxes Calculations for Closed Loop Chamber Setup</h2><span id='topic+fluxible'></span><span id='topic+fluxible-package'></span>

<h3>Description</h3>

<p>Processes the raw data from closed loop flux chamber (or tent) setups into ecosystem gas fluxes usable for analysis. It goes from a data frame of gas concentration over time (which can contain several measurements) and a meta data file indicating which measurement was done when, to a data frame of ecosystem gas fluxes including quality diagnostics. Functions provided include different models (exponential as described in Zhao et al (2018) <a href="https://doi.org/10.1016/j.agrformet.2018.08.022">doi:10.1016/j.agrformet.2018.08.022</a>, quadratic and linear) to estimate the fluxes from the raw data, quality assessment, plotting for visual check and calculation of fluxes based on the setup specific parameters (chamber size, plot area, ...).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joseph Gaudard <a href="mailto:joseph.gaudard@pm.me">joseph.gaudard@pm.me</a> (<a href="https://orcid.org/0000-0002-6989-7624">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Paul Efren Santos-Andrade <a href="mailto:paulefrens@gmail.com">paulefrens@gmail.com</a>
</p>
</li>
<li><p> Richard James Telford <a href="mailto:richard.telford@uib.no">richard.telford@uib.no</a> (<a href="https://orcid.org/0000-0001-9826-3076">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://plant-functional-trait-course.github.io/fluxible/">https://plant-functional-trait-course.github.io/fluxible/</a>
</p>
</li>
<li> <p><a href="https://github.com/Plant-Functional-Trait-Course/fluxible">https://github.com/Plant-Functional-Trait-Course/fluxible</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Plant-Functional-Trait-Course/fluxible/issues">https://github.com/Plant-Functional-Trait-Course/fluxible/issues</a>
</p>
</li></ul>


<hr>
<h2 id='co2_conc'>CO2 concentration</h2><span id='topic+co2_conc'></span>

<h3>Description</h3>

<p>CO2 concentration with measurements meta data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_conc
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 13 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_n_conc</dt><dd><p>Number of data point per flux.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of n_conc over length of the measurement (in seconds).</p>
</dd>
<dt>f_flag_match</dt><dd><p>Data quality flags.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_conc
</code></pre>

<hr>
<h2 id='co2_conc_missing'>CO2 concentration</h2><span id='topic+co2_conc_missing'></span>

<h3>Description</h3>

<p>CO2 concentration with measurements meta data, with missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_conc_missing
</code></pre>


<h3>Format</h3>

<p>A tibble with 668 rows and 13 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_n_conc</dt><dd><p>Number of data point per flux.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of n_conc over length of the measurement (in seconds).</p>
</dd>
<dt>f_flag_match</dt><dd><p>Data quality flags.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_conc_missing
</code></pre>

<hr>
<h2 id='co2_df_missing'>CO2 concentration with missing data</h2><span id='topic+co2_df_missing'></span>

<h3>Description</h3>

<p>Continuous CO2 concentration as measured on the field, with missing data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_df_missing
</code></pre>


<h3>Format</h3>

<p>A tibble with 1148 rows and 5 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_df_missing
</code></pre>

<hr>
<h2 id='co2_df_short'>CO2 concentration</h2><span id='topic+co2_df_short'></span>

<h3>Description</h3>

<p>Continuous CO2 concentration as measured on the field
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_df_short
</code></pre>


<h3>Format</h3>

<p>A tibble with 1801 rows and 5 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_df_short
</code></pre>

<hr>
<h2 id='co2_fluxes'>CO2 fluxes</h2><span id='topic+co2_fluxes'></span>

<h3>Description</h3>

<p>Calculated CO2 fluxes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_fluxes
</code></pre>


<h3>Format</h3>

<p>A tibble with 6 rows and 11 variables
</p>

<dl>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_slope_tz</dt><dd><p>Slope of C(t) at t zero.</p>
</dd>
<dt>f_temp_air_ave</dt><dd><p>Air temperature inside the flux chamber in Celsius
averaged over the flux measurement.</p>
</dd>
<dt>f_flux</dt><dd><p>CO2 flux in mmol/sqm/hour.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm averaged over the flux measurement.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius
averaged over the flux measurement.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement started.</p>
</dd>
<dt>temp_fahr</dt><dd><p>Air temperature inside the flux chamber in Fahrenheit
averaged over the flux measurement.</p>
</dd>
<dt>temp_kelvin</dt><dd><p>Air temperature inside the flux chamber in Kelvin
averaged over the flux measurement.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_fluxes
</code></pre>

<hr>
<h2 id='co2_liahovden'>CO2 concentration at Liahovden</h2><span id='topic+co2_liahovden'></span>

<h3>Description</h3>

<p>CO2 concentration at Liahovden site, used in example in readme file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>co2_liahovden
</code></pre>


<h3>Format</h3>

<p>A tibble with 89692 rows and 5 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>co2_liahovden
</code></pre>

<hr>
<h2 id='conc_poster'>CO2 concentration</h2><span id='topic+conc_poster'></span>

<h3>Description</h3>

<p>CO2 concentration used to make the plot in the poster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conc_poster
</code></pre>


<h3>Format</h3>

<p>A tibble with 530 rows and 11 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be
replaced by 0 or NA</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_RMSE</dt><dd><p>RMSE of the exponential fit and the measured data</p>
</dd>
<dt>f_cor_coef</dt><dd><p>coefficient of correlation between gas concentration
and time</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>conc_poster
</code></pre>

<hr>
<h2 id='flux_calc'>calculates ecosystem gas fluxes</h2><span id='topic+flux_calc'></span>

<h3>Description</h3>

<p>calculates a flux based on the rate of change
of gas concentration over time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_calc(
  slopes_df,
  slope_col,
  datetime_col,
  temp_air_col,
  chamber_volume,
  atm_pressure,
  plot_area,
  f_fluxid = f_fluxid,
  conc_unit,
  flux_unit,
  cols_keep = c(),
  cols_ave = c(),
  tube_volume,
  temp_air_unit = "celsius",
  f_cut = f_cut,
  keep_arg = "keep",
  cut = TRUE,
  fit_type = c()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_calc_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataframe of flux slopes</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_slope_col">slope_col</code></td>
<td>
<p>column containing the slope to calculate the flux
(in ppm<em>s^(-1) or ppb</em>s^(-1))</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column containing the datetime of each gas concentration
measurements in slopes_df. The first one after cutting will be kept as
datetime of each flux in the output.</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_temp_air_col">temp_air_col</code></td>
<td>
<p>column containing the air temperature used
to calculate fluxes. Will be averaged with NA removed.</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_chamber_volume">chamber_volume</code></td>
<td>
<p>volume of the flux chamber in L,
can also be a column in case it is a variable</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_atm_pressure">atm_pressure</code></td>
<td>
<p>atmospheric pressure,
can be a constant (numerical) or a variable (column name)</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_plot_area">plot_area</code></td>
<td>
<p>area of the plot in m^2,
can also be a column in case it is a variable</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column containing the flux IDs</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_conc_unit">conc_unit</code></td>
<td>
<p>unit in which the concentration of gas was measured
<code>ppm</code> or <code>ppb</code></p>
</td></tr>
<tr><td><code id="flux_calc_+3A_flux_unit">flux_unit</code></td>
<td>
<p>unit in which the calculated flux will be
<code>mmol</code> outputs fluxes in mmol * m^(-2)*h^(-1);
<code>micromol</code> outputs fluxes in micromol * m^(-2)*h^(-1)</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_cols_keep">cols_keep</code></td>
<td>
<p>columns to keep from the input to the output.
Those columns need to have unique values for each flux,
as distinct() is applied.</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_cols_ave">cols_ave</code></td>
<td>
<p>columns with values that should be averaged
for each flux in the output. Note that NA are removed in mean calculation.</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_tube_volume">tube_volume</code></td>
<td>
<p>volume of the tubing in L,
can also be a column in case it is a variable</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_temp_air_unit">temp_air_unit</code></td>
<td>
<p>units in which air temperature was measured.
Has to be either <code>celsius</code> (default), <code>fahrenheit</code> or <code>kelvin.</code></p>
</td></tr>
<tr><td><code id="flux_calc_+3A_f_cut">f_cut</code></td>
<td>
<p>column containing cutting information</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_keep_arg">keep_arg</code></td>
<td>
<p>name in <code>f_cut</code> of data to keep</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_cut">cut</code></td>
<td>
<p>if 'TRUE' (default), the measurements will be cut according to
'f_cut' before calculating fluxes. This has no influence on the flux itself
since the slope is provided from <a href="#topic+flux_fitting">flux_fitting</a>,
but it will influence the values of the columns in <code>cols_ave</code>.</p>
</td></tr>
<tr><td><code id="flux_calc_+3A_fit_type">fit_type</code></td>
<td>
<p>(optional) model used in flux_fitting, exponential,
quadratic or linear.
Will be automatically filled if slopes_df was produced using
<a href="#topic+flux_quality">flux_quality</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe containing flux IDs, datetime of measurements' starts,
fluxes in mmol*m^(-2)<em>h^(-1) or micromol</em>m^(-2)*h^(-1) (<code>f_flux</code>) according
to <code>flux_unit</code>, temperature average for each flux in Kelvin (<code>f_temp_ave</code>),
the total volume of the setup for each measurement (<code>f_volume_setup</code>),
the model used in <a href="#topic+flux_fitting">flux_fitting</a>,
any column specified in <code>cols_keep</code>, any column specified in <code>cols_ave</code> with
their value averaged over the measurement after cuts and discarding NA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(slopes0)
flux_calc(slopes0,
f_slope,
datetime,
temp_air,
conc_unit = "ppm",
flux_unit = "mmol",
chamber_volume = 24.5,
tube_volume = 0.075,
atm_pressure = 1,
plot_area = 0.0625)
</code></pre>

<hr>
<h2 id='flux_check_item'>check the items inside <code>flux_fun_check</code></h2><span id='topic+flux_check_item'></span>

<h3>Description</h3>

<p>check the items inside <code>flux_fun_check</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_check_item(arg, fn, msg, narg, df_name = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_check_item_+3A_arg">arg</code></td>
<td>
<p>argument to be checked by <code>fn</code></p>
</td></tr>
<tr><td><code id="flux_check_item_+3A_fn">fn</code></td>
<td>
<p>function to check <code>arg</code></p>
</td></tr>
<tr><td><code id="flux_check_item_+3A_msg">msg</code></td>
<td>
<p>message to display in case <code>arg</code> is the wrong class</p>
</td></tr>
<tr><td><code id="flux_check_item_+3A_narg">narg</code></td>
<td>
<p>name of <code>arg</code></p>
</td></tr>
<tr><td><code id="flux_check_item_+3A_df_name">df_name</code></td>
<td>
<p>name of <code>arg</code> in case it is a data frame</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Klimes
</p>

<hr>
<h2 id='flux_cut'>filter cut data before calculating fluxes</h2><span id='topic+flux_cut'></span>

<h3>Description</h3>

<p>filter cut data before calculating fluxes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_cut(slopes_df, cut_col, keep_arg)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_cut_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes and cut column</p>
</td></tr>
<tr><td><code id="flux_cut_+3A_cut_col">cut_col</code></td>
<td>
<p>column containing cutting information</p>
</td></tr>
<tr><td><code id="flux_cut_+3A_keep_arg">keep_arg</code></td>
<td>
<p>name in cut_col of data to keep</p>
</td></tr>
</table>

<hr>
<h2 id='flux_fit_type'>to check the type of fit</h2><span id='topic+flux_fit_type'></span>

<h3>Description</h3>

<p>extracts the type of fit that was applied in flux_fitting
or checks that the fit_type provided by the user is compatible with Fluxible
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fit_type(
  df,
  fit_type = c(),
  fit_type_list = c("exponential", "linear", "quadratic")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fit_type_+3A_df">df</code></td>
<td>
<p>any dataframe</p>
</td></tr>
<tr><td><code id="flux_fit_type_+3A_fit_type">fit_type</code></td>
<td>
<p>type of fit that was applied in flux_fitting. Needs to be
filled only if the df was produced outside of the Fluxible workflow.</p>
</td></tr>
<tr><td><code id="flux_fit_type_+3A_fit_type_list">fit_type_list</code></td>
<td>
<p>list of fit types in use with Fluxible.</p>
</td></tr>
</table>

<hr>
<h2 id='flux_fitting'>Fitting a model to concentration data and estimating the slope</h2><span id='topic+flux_fitting'></span>

<h3>Description</h3>

<p>fits gas concentration over time data with a model
(exponential, quadratic or linear) and provides the slope later used
to calculate gas fluxes with flux_calc
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fitting(
  conc_df,
  conc_col,
  datetime_col,
  f_start = f_start,
  f_end = f_end,
  f_fluxid = f_fluxid,
  start_cut = 0,
  end_cut = 0,
  t_window = 20,
  cz_window = 15,
  b_window = 10,
  a_window = 10,
  roll_width = 15,
  t_zero = 0,
  fit_type
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fitting_+3A_conc_df">conc_df</code></td>
<td>
<p>dataframe of gas concentration over time</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration data</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each concentration measurement
Note that if there are duplicated datetime in the same f_fluxid only
the first row will be kept</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_f_start">f_start</code></td>
<td>
<p>column with datetime when the measurement started</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_f_end">f_end</code></td>
<td>
<p>column with datetime when the measurement ended</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column with ID of each flux</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_start_cut">start_cut</code></td>
<td>
<p>time to discard at the start of the measurements
(in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_end_cut">end_cut</code></td>
<td>
<p>time to discard at the end of the measurements (in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_t_window">t_window</code></td>
<td>
<p>enlarge focus window before and after tmin and tmax
(exponential fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_cz_window">cz_window</code></td>
<td>
<p>window used to calculate Cz, at the beginning of cut window
(exponential fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_b_window">b_window</code></td>
<td>
<p>window to estimate b. It is an interval after tz where
it is assumed that the model fits the data perfectly (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_a_window">a_window</code></td>
<td>
<p>window at the end of the flux to estimate a (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_roll_width">roll_width</code></td>
<td>
<p>width of the rolling mean for CO2 when looking for tz,
ideally same as cz_window (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_t_zero">t_zero</code></td>
<td>
<p>time at which the slope should be calculated
(for quadratic fit)</p>
</td></tr>
<tr><td><code id="flux_fitting_+3A_fit_type">fit_type</code></td>
<td>
<p><code>exponential</code>, <code>quadratic</code> or <code>linear.</code>
Exponential is using the exponential model from Zhao et al (2018)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with the slope at t zero (<code>f_slope</code>),
a datetime column of t zero (<code>f_start_z</code>), a factor column indicating the
cuts (<code>f_cut</code>), the time in seconds since the start of the measurement
(<code>f_time</code>), the modeled fit (<code>f_fit</code>), the modeled slope (<code>f_fit_slope</code>),
the parameters of the fit depending on the model used,
and any columns present in the input.
The type of fit is added as an attribute for use by the other functions.
</p>


<h3>References</h3>

<p>Zhao, P., Hammerle, A., Zeeman, M., Wohlfahrt, G., 2018.
On the calculation of daytime CO2 fluxes measured by automated closed
transparent chambers. Agricultural and Forest Meteorology 263, 267–275.
https://doi.org/10.1016/j.agrformet.2018.08.022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co2_conc)
flux_fitting(co2_conc, conc, datetime, fit_type = "exp")
flux_fitting(co2_conc, conc, datetime,  fit_type = "quadratic",
t_zero = 10, end_cut = 30)
</code></pre>

<hr>
<h2 id='flux_fitting_exp'>Fitting a model to the gas concentration curve and estimating the slope
over time, using the exponential model from Zhao et al (2018)</h2><span id='topic+flux_fitting_exp'></span>

<h3>Description</h3>

<p>Fits an exponential expression to the concentration evolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fitting_exp(
  conc_df,
  conc_col,
  datetime_col,
  f_start,
  f_end,
  f_fluxid,
  t_window,
  cz_window,
  b_window,
  a_window,
  roll_width,
  start_cut,
  end_cut
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fitting_exp_+3A_conc_df">conc_df</code></td>
<td>
<p>dataframe of gas concentration over time</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each concentration measurement
Note that if there are duplicated datetime in the same f_fluxid only
the first row will be kept</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_f_start">f_start</code></td>
<td>
<p>column with datetime when the measurement started</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_f_end">f_end</code></td>
<td>
<p>column with datetime when the measurement ended</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column with ID of each flux</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_t_window">t_window</code></td>
<td>
<p>enlarge focus window before and after tmin and tmax</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_cz_window">cz_window</code></td>
<td>
<p>window used to calculate Cz, at the beginning of cut window</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_b_window">b_window</code></td>
<td>
<p>window to estimate b. It is an interval after tz
where it is assumed that C fits the data perfectly</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_a_window">a_window</code></td>
<td>
<p>window at the end of the flux to estimate a</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_roll_width">roll_width</code></td>
<td>
<p>width of the rolling mean for CO2 when looking for tz,
ideally same as cz_window</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_start_cut">start_cut</code></td>
<td>
<p>time to discard at the start of the measurements
(in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_exp_+3A_end_cut">end_cut</code></td>
<td>
<p>time to discard at the end of the measurements (in seconds)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with the slope at t zero,
modeled concentration over time and exponential expression parameters
</p>


<h3>References</h3>

<p>Zhao, P., Hammerle, A., Zeeman, M., Wohlfahrt, G., 2018.
On the calculation of daytime CO2 fluxes measured by automated closed
transparent chambers. Agricultural and Forest Meteorology 263, 267–275.
https://doi.org/10.1016/j.agrformet.2018.08.022
</p>

<hr>
<h2 id='flux_fitting_lin'>linear fit to gas concentration over time</h2><span id='topic+flux_fitting_lin'></span>

<h3>Description</h3>

<p>fits a linear model to the gas concentration over time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fitting_lin(
  conc_df,
  conc_col,
  datetime_col,
  f_start,
  f_end,
  f_fluxid,
  start_cut,
  end_cut
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fitting_lin_+3A_conc_df">conc_df</code></td>
<td>
<p>dataframe of gas concentration over time</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each concentration measurement
Note that if there are duplicated datetime in the same f_fluxid only
the first row will be kept</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_f_start">f_start</code></td>
<td>
<p>column with datetime when the measurement started</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_f_end">f_end</code></td>
<td>
<p>column with datetime when the measurement ended</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column with ID of each flux</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_start_cut">start_cut</code></td>
<td>
<p>time to discard at the start of the measurements
(in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_lin_+3A_end_cut">end_cut</code></td>
<td>
<p>time to discard at the end of the measurements (in seconds)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a df with the modeled gas concentration, slope, intercept,
std error, r square and p value of the linear model
</p>

<hr>
<h2 id='flux_fitting_quadratic'>quadratic fit to gas concentration over time</h2><span id='topic+flux_fitting_quadratic'></span>

<h3>Description</h3>

<p>fits a quadratic model to the gas concentration over time
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fitting_quadratic(
  conc_df,
  conc_col,
  datetime_col,
  f_start,
  f_end,
  f_fluxid,
  start_cut,
  end_cut,
  t_zero
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fitting_quadratic_+3A_conc_df">conc_df</code></td>
<td>
<p>dataframe of gas concentration over time</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each concentration measurement
Note that if there are duplicated datetime in the same f_fluxid only
the first row will be kept</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_f_start">f_start</code></td>
<td>
<p>column with datetime when the measurement started</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_f_end">f_end</code></td>
<td>
<p>column with datetime when the measurement ended</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column with ID of each flux</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_start_cut">start_cut</code></td>
<td>
<p>time to discard at the start of the measurements
(in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_end_cut">end_cut</code></td>
<td>
<p>time to discard at the end of the measurements (in seconds)</p>
</td></tr>
<tr><td><code id="flux_fitting_quadratic_+3A_t_zero">t_zero</code></td>
<td>
<p>time at which the slope should be calculated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a df with the modeled gas concentration, slope, intercept,
std error, r square and p value of the quadratic model
</p>

<hr>
<h2 id='flux_flag_count'>counts quality flags</h2><span id='topic+flux_flag_count'></span>

<h3>Description</h3>

<p>provides a table of how many fluxes were attributed
which quality flag.
This function is incorporated in flux_quality (output as a message)
but can be used alone to extract a dataframe with the flag count.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_flag_count(
  slopes_df,
  f_fluxid = f_fluxid,
  f_quality_flag = f_quality_flag,
  f_cut = f_cut,
  f_flags = c("ok", "discard", "zero", "force_discard", "start_error", "no_data",
    "force_ok"),
  cut_arg = "cut"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_flag_count_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataframe of flux slopes</p>
</td></tr>
<tr><td><code id="flux_flag_count_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column containing fluxes unique ID</p>
</td></tr>
<tr><td><code id="flux_flag_count_+3A_f_quality_flag">f_quality_flag</code></td>
<td>
<p>column containing the quality flags</p>
</td></tr>
<tr><td><code id="flux_flag_count_+3A_f_cut">f_cut</code></td>
<td>
<p>column indicating which part of the flux is being cut</p>
</td></tr>
<tr><td><code id="flux_flag_count_+3A_f_flags">f_flags</code></td>
<td>
<p>list of flags used in the dataset
(if different from default from flux_quality).
If not provided, it will list only the flags that are
present in the dataset (no showing 0).</p>
</td></tr>
<tr><td><code id="flux_flag_count_+3A_cut_arg">cut_arg</code></td>
<td>
<p>argument defining that the data point should be cut out</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with the number of fluxes for each quality flags
and their proportion to the total
</p>


<h3>Author(s)</h3>

<p>Vincent Belde
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(slopes30qua_flag)
flux_flag_count(slopes30qua_flag)
</code></pre>

<hr>
<h2 id='flux_fun_check'>checking that arguments and columns are in the correct class</h2><span id='topic+flux_fun_check'></span>

<h3>Description</h3>

<p>checking that arguments and columns are in the correct class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_fun_check(args, fn, msg, name_df = NA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_fun_check_+3A_args">args</code></td>
<td>
<p>list of arguments or dataframe to check</p>
</td></tr>
<tr><td><code id="flux_fun_check_+3A_fn">fn</code></td>
<td>
<p>list of functions used to check (<code>is.numeric</code>, <code>is.character</code>, ...)</p>
</td></tr>
<tr><td><code id="flux_fun_check_+3A_msg">msg</code></td>
<td>
<p>list of messages to return in case of failed check</p>
</td></tr>
<tr><td><code id="flux_fun_check_+3A_name_df">name_df</code></td>
<td>
<p>in case args is a df with selected columns to check origdf
is the original df to take the name from for a more obvious error message</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adam Klimes
</p>

<hr>
<h2 id='flux_gep'>Calculates GEP</h2><span id='topic+flux_gep'></span>

<h3>Description</h3>

<p>to calculate gross ecosystem production (GEP) from net ecosystem
(NEE) exchange and ecosystem respiration (ER) as GEP = NEE - ER.
Datetime and other variables to keep will be taken from the NEE measurement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_gep(
  fluxes_df,
  type_col,
  datetime_col,
  f_flux = f_flux,
  id_cols,
  nee_arg = "NEE",
  er_arg = "ER",
  cols_keep = "none"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_gep_+3A_fluxes_df">fluxes_df</code></td>
<td>
<p>a dataframe containing NEE and ER</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_type_col">type_col</code></td>
<td>
<p>column containing type of flux (NEE or ER)</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column containing start of measurement as datetime</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_f_flux">f_flux</code></td>
<td>
<p>column containing flux values</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_id_cols">id_cols</code></td>
<td>
<p>columns used to identify each pair of ER and NEE</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_nee_arg">nee_arg</code></td>
<td>
<p>argument designating NEE fluxes in type column</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_er_arg">er_arg</code></td>
<td>
<p>argument designating ER fluxes in type column</p>
</td></tr>
<tr><td><code id="flux_gep_+3A_cols_keep">cols_keep</code></td>
<td>
<p>columns to keep from <code>fluxes_df</code>. Values from NEE row will
be filled in GEP row. <code>none</code> (default) keeps only the columns in <code>id_cols</code>,
flux, type and datetime columns; <code>all</code> keeps all the columns;
can also be a vector of column names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with GEP as <code>NEE - ER</code> in long format with GEP, NEE, and
ER as flux type, datetime, and any column specified in <code>cols_keep</code>.
Values of datetime and columns in <code>cols_keep</code> for GEP row are taken from
NEE measurements.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co2_fluxes)
flux_gep(co2_fluxes, type, f_start, id_cols = "turfID",
cols_keep = c("temp_soil"))
</code></pre>

<hr>
<h2 id='flux_match'>Matching continuously measured fluxes with measurement IDs and meta data</h2><span id='topic+flux_match'></span>

<h3>Description</h3>

<p>Matching a dataframe of continuously measured
gas concentration data with measurement metadata from another dataframe.
Measurements are paired with their metadata based on datetime.
Extra variables in both dataframes are kept in the output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_match(
  raw_conc,
  field_record,
  datetime_col,
  start_col,
  conc_col,
  startcrop,
  measurement_length,
  ratio_threshold = 0.5,
  time_diff = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_match_+3A_raw_conc">raw_conc</code></td>
<td>
<p>dataframe of CO2 concentration measured continuously.
Has to contain at least a datetime column in ymd_hms format and
a gas concentration column as double.</p>
</td></tr>
<tr><td><code id="flux_match_+3A_field_record">field_record</code></td>
<td>
<p>dataframe recording which measurement happened when.
Has to contain at least a column containing the start of each measurement,
and any other column identifying the measurements.</p>
</td></tr>
<tr><td><code id="flux_match_+3A_datetime_col">datetime_col</code></td>
<td>
<p>datetime column in raw_conc (dmy_hms format)</p>
</td></tr>
<tr><td><code id="flux_match_+3A_start_col">start_col</code></td>
<td>
<p>start column in field_record (dmy_hms format)</p>
</td></tr>
<tr><td><code id="flux_match_+3A_conc_col">conc_col</code></td>
<td>
<p>concentration column in raw_conc</p>
</td></tr>
<tr><td><code id="flux_match_+3A_startcrop">startcrop</code></td>
<td>
<p>how many seconds should be discarded at the beginning of
the measurement</p>
</td></tr>
<tr><td><code id="flux_match_+3A_measurement_length">measurement_length</code></td>
<td>
<p>length of the measurement (in seconds)
from the start specified in the field_record</p>
</td></tr>
<tr><td><code id="flux_match_+3A_ratio_threshold">ratio_threshold</code></td>
<td>
<p>ratio (number of concentration measurement compared to
length of measurement in seconds) below which the data should be flagged as
too little</p>
</td></tr>
<tr><td><code id="flux_match_+3A_time_diff">time_diff</code></td>
<td>
<p>time difference (in seconds) between the two datasets.
Will be added to the datetime column of the raw_conc dataset.
For situations where the time was not synchronized correctly.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with concentration measurements, corresponding datetime,
flux ID (<code>f_fluxid</code>), measurements start (<code>f_start</code>) and end (<code>f_end</code>),
flags in case of no data or low number of data (<code>f_flag_match</code>),
the number of datapoints per measurement (<code>f_n_conc</code>),
the ratio of number of datapoints over the length of each measurement
in seconds (<code>f_ratio</code>), and any variables present in one of the inputs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(co2_df_short, record_short)
flux_match(co2_df_short, record_short, datetime, start, conc, startcrop = 10,
measurement_length = 180)
</code></pre>

<hr>
<h2 id='flux_param_exp'>prepares text to print for flux_plot function</h2><span id='topic+flux_param_exp'></span>

<h3>Description</h3>

<p>creates a df with quality flags and quality diagnostics
to print on the plots produced by flux_plot.
flux_param_lm is for fit in the lm family (linear and quadratic)
flux_param_exp is for the exponential fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_param_exp(slopes_df, conc_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_param_exp_+3A_slopes_df">slopes_df</code></td>
<td>
<p>the slopes_df that is being provided to flux_plot</p>
</td></tr>
<tr><td><code id="flux_param_exp_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
</table>

<hr>
<h2 id='flux_param_lm'>prepares text to print in flux_plot</h2><span id='topic+flux_param_lm'></span>

<h3>Description</h3>

<p>creates a df with quality flags and quality diagnostics
to print on the plots produced by flux_plot.
flux_param_lm is for fit in the lm family (linear and quadratic)
flux_param_exp is for the exponential fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_param_lm(slopes_df, conc_col)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_param_lm_+3A_slopes_df">slopes_df</code></td>
<td>
<p>the slopes_df that is being provided to flux_plot</p>
</td></tr>
<tr><td><code id="flux_param_lm_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
</table>

<hr>
<h2 id='flux_plot'>plotting fluxes for visual evaluation</h2><span id='topic+flux_plot'></span>

<h3>Description</h3>

<p>plots the fluxes, fit and slope in facets
with color code indicating quality flags
This function takes time to run and is optional in the workflow,
but it is still highly recommended to use it to visually check
the measurements.
Note that 'flux_plot' is specific to the 'fluxible' package and
will work best with datasets produced following a fluxible workflow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_plot(
  slopes_df,
  conc_col,
  datetime_col,
  color_discard = "#D55E00",
  color_cut = "#D55E00",
  color_ok = "#009E73",
  color_zero = "#CC79A7",
  scale_x_datetime_args = list(date_breaks = "1 min", minor_breaks = "10 sec",
    date_labels = "%e/%m \n %H:%M"),
  f_ylim_upper = 800,
  f_ylim_lower = 400,
  f_plotname = "",
  facet_wrap_args = list(ncol = 4, nrow = 3, scales = "free"),
  y_text_position = 500,
  print_plot = "FALSE",
  output = "print_only",
  ggsave_args = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_plot_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes,
with flags produced by flux_quality</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each data point</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_color_discard">color_discard</code></td>
<td>
<p>color for fits with a discard quality flag</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_color_cut">color_cut</code></td>
<td>
<p>color for the part of the flux that is cut</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_color_ok">color_ok</code></td>
<td>
<p>color for fits with an ok quality flag</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_color_zero">color_zero</code></td>
<td>
<p>color for fits with a zero quality flag</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_scale_x_datetime_args">scale_x_datetime_args</code></td>
<td>
<p>list of arguments for
<a href="ggplot2.html#topic+scale_x_datetime">scale_x_datetime</a></p>
</td></tr>
<tr><td><code id="flux_plot_+3A_f_ylim_upper">f_ylim_upper</code></td>
<td>
<p>y axis upper limit</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_f_ylim_lower">f_ylim_lower</code></td>
<td>
<p>y axis lower limit</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_f_plotname">f_plotname</code></td>
<td>
<p>filename for the extracted pdf file;
if empty, the name of <code>slopes_df</code> will be used</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_facet_wrap_args">facet_wrap_args</code></td>
<td>
<p>list of arguments for
<a href="ggforce.html#topic+facet_wrap_paginate">facet_wrap_paginate</a></p>
</td></tr>
<tr><td><code id="flux_plot_+3A_y_text_position">y_text_position</code></td>
<td>
<p>position of the text box</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_print_plot">print_plot</code></td>
<td>
<p>logical, if TRUE it prints the plot as a ggplot object
but will take time depending on the size of the dataset</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_output">output</code></td>
<td>
<p><code>pdfpages</code>, the plots are saved as A4 landscape pdf pages;
<code>ggsave</code>, the plots can be saved with the ggsave function;
<code>print_only</code> (default) prints the plot without creating a file
(independently from 'print_plot' being TRUE or FALSE)</p>
</td></tr>
<tr><td><code id="flux_plot_+3A_ggsave_args">ggsave_args</code></td>
<td>
<p>list of arguments for <a href="ggplot2.html#topic+ggsave">ggsave</a>
(in case <code>output = "ggsave"</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plots of fluxes, with raw concentration data points, fit, slope,
and color code indicating quality flags and cuts. The plots are organized
in facets according to flux ID, and a text box display the quality flag and
diagnostics of each measurement.
The plots are returned as a ggplot object if <code>print_plot = TRUE</code>;
if <code>print_plot = FALSE</code> it will not return anything but will produce a file
according to the <code>output</code> argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(slopes0_flag)
flux_plot(slopes0_flag, conc, datetime)
data(slopes30lin_flag)
flux_plot(slopes30lin_flag, conc, datetime)
data(slopes30qua_flag)
flux_plot(slopes30qua_flag, conc, datetime)
</code></pre>

<hr>
<h2 id='flux_plot_exp'>plotting fluxes with exponential fit</h2><span id='topic+flux_plot_exp'></span>

<h3>Description</h3>

<p>plots the fluxes that were fitted with
an exponential model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_plot_exp(slopes_df, conc_col, datetime_col, y_text_position)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_plot_exp_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes</p>
</td></tr>
<tr><td><code id="flux_plot_exp_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_plot_exp_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each data point</p>
</td></tr>
<tr><td><code id="flux_plot_exp_+3A_y_text_position">y_text_position</code></td>
<td>
<p>position of the text box</p>
</td></tr>
</table>

<hr>
<h2 id='flux_plot_flag'>creates the flag column to be used by flux_plot</h2><span id='topic+flux_plot_flag'></span>

<h3>Description</h3>

<p>creates a column with quality flags (from flux_quality)
for the part of the rows to be kept, and cut flag for rows to be discarded
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_plot_flag(slopes_df, param_df)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_plot_flag_+3A_slopes_df">slopes_df</code></td>
<td>
<p>as provided in flux_plot</p>
</td></tr>
<tr><td><code id="flux_plot_flag_+3A_param_df">param_df</code></td>
<td>
<p>as provided by flux_param</p>
</td></tr>
</table>

<hr>
<h2 id='flux_plot_lin'>plotting fluxes with linear fit</h2><span id='topic+flux_plot_lin'></span>

<h3>Description</h3>

<p>plots the fluxes that were fitted
with a linear model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_plot_lin(slopes_df, conc_col, datetime_col, y_text_position)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_plot_lin_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes</p>
</td></tr>
<tr><td><code id="flux_plot_lin_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_plot_lin_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each data point</p>
</td></tr>
<tr><td><code id="flux_plot_lin_+3A_y_text_position">y_text_position</code></td>
<td>
<p>position of the text box</p>
</td></tr>
</table>

<hr>
<h2 id='flux_plot_quadratic'>plotting fluxes with a quadratic fit</h2><span id='topic+flux_plot_quadratic'></span>

<h3>Description</h3>

<p>specific part of flux_plot for
quadratic fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_plot_quadratic(slopes_df, conc_col, datetime_col, y_text_position)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_plot_quadratic_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes</p>
</td></tr>
<tr><td><code id="flux_plot_quadratic_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_plot_quadratic_+3A_datetime_col">datetime_col</code></td>
<td>
<p>column with datetime of each data point</p>
</td></tr>
<tr><td><code id="flux_plot_quadratic_+3A_y_text_position">y_text_position</code></td>
<td>
<p>position of the text box</p>
</td></tr>
</table>

<hr>
<h2 id='flux_quality'>assessing quality of slopes calculated with flux_fitting</h2><span id='topic+flux_quality'></span>

<h3>Description</h3>

<p>indicates if slopes should be discarded or replaced
by 0 according to quality thresholds set by user
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_quality(
  slopes_df,
  conc_col,
  f_fluxid = f_fluxid,
  f_slope = f_slope,
  f_time = f_time,
  f_start = f_start,
  f_end = f_end,
  f_fit = f_fit,
  f_cut = f_cut,
  f_pvalue = f_pvalue,
  f_rsquared = f_rsquared,
  f_b = f_b,
  force_discard = c(),
  force_ok = c(),
  ratio_threshold = 0,
  fit_type = c(),
  ambient_conc = 421,
  error = 100,
  pvalue_threshold = 0.3,
  rsquared_threshold = 0.7,
  rmse_threshold = 25,
  cor_threshold = 0.5,
  b_threshold = 1,
  cut_arg = "cut"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_quality_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_conc_col">conc_col</code></td>
<td>
<p>column containing the measured gas concentration
(exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column containing unique IDs for each flux</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_slope">f_slope</code></td>
<td>
<p>column containing the slope of each flux
(as calculated by the flux_fitting function)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_time">f_time</code></td>
<td>
<p>column containing the time of each measurement in seconds
(exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_start">f_start</code></td>
<td>
<p>column with datetime of the start of the measurement
(after cuts)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_end">f_end</code></td>
<td>
<p>column with datetime of the end of the measurement
(after cuts)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_fit">f_fit</code></td>
<td>
<p>column containing the modeled data (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_cut">f_cut</code></td>
<td>
<p>column containing the cutting information</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_pvalue">f_pvalue</code></td>
<td>
<p>column containing the p-value of each flux
(linear and quadratic fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_rsquared">f_rsquared</code></td>
<td>
<p>column containing the r squared of each flux
(linear and quadratic fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_f_b">f_b</code></td>
<td>
<p>column containing the b parameter of the exponential expression
(exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_force_discard">force_discard</code></td>
<td>
<p>vector of fluxIDs that should be discarded
by the user's decision</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_force_ok">force_ok</code></td>
<td>
<p>vector of fluxIDs for which the user wants to keep
the calculated slope despite a bad quality flag</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_ratio_threshold">ratio_threshold</code></td>
<td>
<p>ratio of gas concentration data points over length of
measurement (in seconds) below which the measurement will be considered as
not having enough data points to be considered for calculations</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_fit_type">fit_type</code></td>
<td>
<p>model fitted to the data, linear, quadratic or exponential.
Will be automatically filled if slopes_df was produced using flux_fitting()</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_ambient_conc">ambient_conc</code></td>
<td>
<p>ambient gas concentration in ppm at the site of
measurement (used to detect measurement that started with a polluted setup)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_error">error</code></td>
<td>
<p>error of the setup, defines a window outside of which
the starting values indicate a polluted setup</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_pvalue_threshold">pvalue_threshold</code></td>
<td>
<p>threshold of p-value below which the change of
gas concentration over time is considered not significant
(linear and quadratic fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_rsquared_threshold">rsquared_threshold</code></td>
<td>
<p>threshold of r squared value below which
the linear model is considered an unsatisfactory fit
(linear and quadratic fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_rmse_threshold">rmse_threshold</code></td>
<td>
<p>threshold for the RMSE of each flux above which
the fit is considered unsatisfactory (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_cor_threshold">cor_threshold</code></td>
<td>
<p>threshold for the correlation coefficient of
gas concentration with time below which the correlation
is considered not significant (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_b_threshold">b_threshold</code></td>
<td>
<p>threshold for the b parameter.
Defines a window with its opposite inside which the fit is
considered good enough (exponential fit)</p>
</td></tr>
<tr><td><code id="flux_quality_+3A_cut_arg">cut_arg</code></td>
<td>
<p>argument defining that the data point should be cut out</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with added columns of quality flags (<code>f_quality_flag</code>),
the slope corrected according to the quality flags (<code>f_slope_corr</code>),
some diagnostics depending on the fit, and any columns present in the input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(slopes0lin)
flux_quality(slopes0lin, conc, fit_type = "li")
data(slopes30)
flux_quality(slopes30, conc, fit_type = "expo")
</code></pre>

<hr>
<h2 id='flux_quality_exp'>quality assessment for the slopes estimated by flux_fitting</h2><span id='topic+flux_quality_exp'></span>

<h3>Description</h3>

<p>indicates if fluxes should be discarded or replaced by 0
according to parameters set by user.
flux_quality_lm is for the model of the lm family.
flux_quality_exp is for the exponential model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_quality_exp(
  slopes_df,
  conc_col,
  f_fluxid,
  f_slope,
  f_time,
  f_fit,
  f_cut,
  f_b,
  force_discard,
  force_ok,
  rmse_threshold,
  cor_threshold,
  b_threshold
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_quality_exp_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes, fluxID,
and parameters of the exponential expression</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column of ID for each measurement</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_slope">f_slope</code></td>
<td>
<p>column containing the slope of each flux
(as calculated by the flux_fitting function)</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_time">f_time</code></td>
<td>
<p>column containing the time of each measurement in seconds</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_fit">f_fit</code></td>
<td>
<p>column containing the modeled data</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_cut">f_cut</code></td>
<td>
<p>column containing the cutting information</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_f_b">f_b</code></td>
<td>
<p>column containing the b parameter of the exponential expression</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_force_discard">force_discard</code></td>
<td>
<p>vector of fluxIDs that should be discarded
by the user's decision</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_force_ok">force_ok</code></td>
<td>
<p>vector of fluxIDs for which the user wants to keep
the calculated slope despite a bad quality flag</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_rmse_threshold">rmse_threshold</code></td>
<td>
<p>threshold for the RMSE of each flux above
which the fit is considered unsatisfactory</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_cor_threshold">cor_threshold</code></td>
<td>
<p>threshold for the correlation coefficient
of gas concentration with time below which the correlation
is considered non significant</p>
</td></tr>
<tr><td><code id="flux_quality_exp_+3A_b_threshold">b_threshold</code></td>
<td>
<p>threshold for the b parameter. Defines a window
with its opposite inside which the fit is considered good enough.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same dataframe with added flag and corrected slopes columns
</p>

<hr>
<h2 id='flux_quality_lm'>quality assessment for the slopes estimated by flux_fitting</h2><span id='topic+flux_quality_lm'></span>

<h3>Description</h3>

<p>indicates if fluxes should be discarded or replaced by 0
according to parameters set by user.
flux_quality_lm is for the model of the lm family.
flux_quality_exp is for the exponential model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flux_quality_lm(
  slopes_df,
  conc_col,
  f_fluxid,
  f_slope,
  f_cut,
  f_pvalue,
  f_rsquared,
  force_discard,
  force_ok,
  pvalue_threshold,
  rsquared_threshold,
  name_df
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="flux_quality_lm_+3A_slopes_df">slopes_df</code></td>
<td>
<p>dataset containing slopes, fluxID, p.value and r.squared</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_conc_col">conc_col</code></td>
<td>
<p>column with gas concentration</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_f_fluxid">f_fluxid</code></td>
<td>
<p>column of ID for each measurement</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_f_slope">f_slope</code></td>
<td>
<p>column containing the slope of each flux
(as calculated by the flux_fitting function)</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_f_cut">f_cut</code></td>
<td>
<p>column containing the cutting information</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_f_pvalue">f_pvalue</code></td>
<td>
<p>column containing the p-value of each flux</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_f_rsquared">f_rsquared</code></td>
<td>
<p>column containing the r squared to be used for
the quality assessment</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_force_discard">force_discard</code></td>
<td>
<p>vector of fluxIDs that should be discarded
by the user's decision</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_force_ok">force_ok</code></td>
<td>
<p>vector of fluxIDs for which the user wants to keep
the calculated slope despite a bad quality flag</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_pvalue_threshold">pvalue_threshold</code></td>
<td>
<p>threshold of p-value below which the change
of gas concentration over time is considered not significant (user decided)</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_rsquared_threshold">rsquared_threshold</code></td>
<td>
<p>threshold of r squared value below which
the linear model is considered an unsatisfactory fit</p>
</td></tr>
<tr><td><code id="flux_quality_lm_+3A_name_df">name_df</code></td>
<td>
<p>name of slopes_df (used for error message)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>same dataframe with added flag and corrected slopes columns
</p>

<hr>
<h2 id='raw_twogases'>CO2 and CH4 concentration</h2><span id='topic+raw_twogases'></span>

<h3>Description</h3>

<p>CO2 and CH4 measured simultaneously
</p>


<h3>Usage</h3>

<pre><code class='language-R'>raw_twogases
</code></pre>


<h3>Format</h3>

<p>A tibble with 21681 rows and 4 variables
</p>

<dl>
<dt>co2_conc</dt><dd><p>CO2 concentration in ppm</p>
</dd>
<dt>ch4_conc</dt><dd><p>CH4 concentration in ppb</p>
</dd>
<dt>datetime</dt><dd><p>Datetime on the datapoint</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the chamber in Celsius</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>raw_twogases
</code></pre>

<hr>
<h2 id='record_liahovden'>Measurements meta data at Liahovden</h2><span id='topic+record_liahovden'></span>

<h3>Description</h3>

<p>Measurements meta data as recorded on the field at site Liahovden
</p>


<h3>Usage</h3>

<pre><code class='language-R'>record_liahovden
</code></pre>


<h3>Format</h3>

<p>A tibble with 138 rows and 3 variables
</p>

<dl>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>round</dt><dd><p>Round of measurement.</p>
</dd>
<dt>start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>record_liahovden
</code></pre>

<hr>
<h2 id='record_short'>Measurements meta data</h2><span id='topic+record_short'></span>

<h3>Description</h3>

<p>Measurements meta data as recorded on the field
</p>


<h3>Usage</h3>

<pre><code class='language-R'>record_short
</code></pre>


<h3>Format</h3>

<p>A tibble with 6 rows and 3 variables
</p>

<dl>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>record_short
</code></pre>

<hr>
<h2 id='slopes0'>Slopes for each flux</h2><span id='topic+slopes0'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux without cut.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 22 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0
</code></pre>

<hr>
<h2 id='slopes0_flag'>Slopes for each flux</h2><span id='topic+slopes0_flag'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux with 0 second cut, with quality flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0_flag
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 27 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of number of data points compared
to length of measurement in seconds.</p>
</dd>
<dt>f_cor_coef</dt><dd><p>coefficient of correlation between gas concentration
and time</p>
</dd>
<dt>f_RMSE</dt><dd><p>RMSE of the exponential fit and the measured data</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be
replaced by 0 or NA</p>
</dd>
<dt>f_slope_corr</dt><dd><p>slope corrected according to quality flag</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0_flag
</code></pre>

<hr>
<h2 id='slopes0_temp'>Slopes for each flux</h2><span id='topic+slopes0_temp'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux with air temperature in various units.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0_temp
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 24 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
<dt>temp_fahr</dt><dd><p>Air temperature inside the flux chamber in Fahrenheit
averaged over the flux measurement.</p>
</dd>
<dt>temp_kelvin</dt><dd><p>Air temperature inside the flux chamber in Kelvin
averaged over the flux measurement.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0_temp
</code></pre>

<hr>
<h2 id='slopes0_vol'>Slopes for each flux</h2><span id='topic+slopes0_vol'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux without cut.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0_vol
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 23 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
<dt>volume</dt><dd><p>volume of chamber in L</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0_vol
</code></pre>

<hr>
<h2 id='slopes0lin'>Slopes for each flux</h2><span id='topic+slopes0lin'></span>

<h3>Description</h3>

<p>Slopes of linear fit for each flux without cut.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0lin
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 19 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_pvalue</dt><dd><p>P-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0lin
</code></pre>

<hr>
<h2 id='slopes0lin_flag'>Slopes for each flux</h2><span id='topic+slopes0lin_flag'></span>

<h3>Description</h3>

<p>Slopes of linear fit for each flux without cut, with quality flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes0lin_flag
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 22 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_pvalue</dt><dd><p>P-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of number of data points compared
to length of measurement in seconds.</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be replaced
by 0 or NA</p>
</dd>
<dt>f_slope_corr</dt><dd><p>slope corrected according to quality flag</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes0lin_flag
</code></pre>

<hr>
<h2 id='slopes30'>Slopes for each flux</h2><span id='topic+slopes30'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux with a 30 seconds cut at the end of each flux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 22 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30
</code></pre>

<hr>
<h2 id='slopes30_flag'>Slopes for each flux</h2><span id='topic+slopes30_flag'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux with 30 seconds end cut, with quality flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30_flag
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 27 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of number of data points compared
to length of measurement in seconds.</p>
</dd>
<dt>f_cor_coef</dt><dd><p>coefficient of correlation between gas concentration
and time</p>
</dd>
<dt>f_RMSE</dt><dd><p>RMSE of the exponential fit and the measured data</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be
replaced by 0 or NA</p>
</dd>
<dt>f_slope_corr</dt><dd><p>slope corrected according to quality flag</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30_flag
</code></pre>

<hr>
<h2 id='slopes30lin'>Slopes for each flux</h2><span id='topic+slopes30lin'></span>

<h3>Description</h3>

<p>Slopes of linear fit for each flux with a 30 seconds cut at
the end of each flux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30lin
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 19 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_pvalue</dt><dd><p>P-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30lin
</code></pre>

<hr>
<h2 id='slopes30lin_flag'>Slopes for each flux</h2><span id='topic+slopes30lin_flag'></span>

<h3>Description</h3>

<p>Slopes of linear fit for each flux with 30 seconds end cut,
with quality flags.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30lin_flag
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 22 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_pvalue</dt><dd><p>P-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of number of data points compared
to length of measurement in seconds.</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be replaced
by 0 or NA</p>
</dd>
<dt>f_slope_corr</dt><dd><p>slope corrected according to quality flag</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30lin_flag
</code></pre>

<hr>
<h2 id='slopes30qua'>Slopes for each flux</h2><span id='topic+slopes30qua'></span>

<h3>Description</h3>

<p>Slopes of quadratic fit for each flux with 30 seconds end cut and
t_zero of 10 seconds, without quality flags.
C(t) = a + b<em>t + c</em>t^2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30qua
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 24 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of n_conc over length of the measurement (in seconds).</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_param1</dt><dd><p>b parameter of C(t)</p>
</dd>
<dt>f_param2</dt><dd><p>c parameter of C(t)</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_pvalue</dt><dd><p>p-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>output of linear expression describing
the slope at t_zero</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30qua
</code></pre>

<hr>
<h2 id='slopes30qua_flag'>Slopes for each flux</h2><span id='topic+slopes30qua_flag'></span>

<h3>Description</h3>

<p>Slopes of quadratic fit for each flux with 30 seconds end cut and
t_zero of 10 seconds, with quality flags.
C(t) = a + b<em>t + c</em>t^2
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes30qua_flag
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 26 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_ratio</dt><dd><p>Ratio of n_conc over length of the measurement (in seconds).</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_param1</dt><dd><p>b parameter of C(t)</p>
</dd>
<dt>f_param2</dt><dd><p>c parameter of C(t)</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_pvalue</dt><dd><p>p-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>output of linear expression describing
the slope at t_zero</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
<dt>f_quality_flag</dt><dd><p>quality flag advising if the slope has to be replaced
by 0 or NA</p>
</dd>
<dt>f_slope_corr</dt><dd><p>slope corrected according to quality flag</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes30qua_flag
</code></pre>

<hr>
<h2 id='slopes60'>Slopes for each flux</h2><span id='topic+slopes60'></span>

<h3>Description</h3>

<p>Slopes of C(t) for each flux with a cut of 60 seconds
at the end of each flux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes60
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 22 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber in
micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep) or
discarded (cut).</p>
</dd>
<dt>f_Cz</dt><dd><p>Cz parameter of the C(t) function.</p>
</dd>
<dt>f_Cm</dt><dd><p>Cm parameter of the C(t) function, calculated by optim() with
Cm_est as starting point.</p>
</dd>
<dt>f_a</dt><dd><p>a parameter of the C(t) function, calculated by optim() with
a_est as starting point.</p>
</dd>
<dt>f_b</dt><dd><p>b parameter of the C(t) function, calculated by optim() with
b_est as starting point.</p>
</dd>
<dt>f_tz</dt><dd><p>tz parameter of the C(t) function, calculated by optim() with
tz_est as starting point.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of C(t) at tz</p>
</dd>
<dt>f_fit</dt><dd><p>C(t), modeled CO2 concentration as a function of time.</p>
</dd>
<dt>f_fit_slope</dt><dd><p>Output of linear model of CO2 concentration passing by
C(tz) and a slope of slope_tz.</p>
</dd>
<dt>f_start_z</dt><dd><p>Datetime format of tz</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes60
</code></pre>

<hr>
<h2 id='slopes60lin'>Slopes for each flux</h2><span id='topic+slopes60lin'></span>

<h3>Description</h3>

<p>Slopes of linear fit for each flux with a 60 seconds cut at the end of each
flux.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slopes60lin
</code></pre>


<h3>Format</h3>

<p>A tibble with 1251 rows and 19 variables
</p>

<dl>
<dt>datetime</dt><dd><p>Datetime at which CO2 concentration was recorded.</p>
</dd>
<dt>temp_air</dt><dd><p>Air temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>temp_soil</dt><dd><p>Ground temperature inside the flux chamber in Celsius.</p>
</dd>
<dt>conc</dt><dd><p>CO2 concentration in ppm.</p>
</dd>
<dt>PAR</dt><dd><p>Photosynthetically active radiation inside the chamber
in micromol/s/sqm.</p>
</dd>
<dt>turfID</dt><dd><p>Unique ID of the turf in which the measurement took place.</p>
</dd>
<dt>type</dt><dd><p>Type of measurement: ecosystems respiration (ER)
or net ecosystem exchange (NEE).</p>
</dd>
<dt>f_start</dt><dd><p>Datetime at which the measurement was started.</p>
</dd>
<dt>f_end</dt><dd><p>Datetime at which the measurement ended.</p>
</dd>
<dt>f_fluxid</dt><dd><p>Unique ID for each flux.</p>
</dd>
<dt>f_flag_match</dt><dd><p>Flags from flux_match.</p>
</dd>
<dt>f_time</dt><dd><p>Time variable of the flux in seconds.</p>
</dd>
<dt>f_cut</dt><dd><p>Indicating if the measurement should be kept (keep)
or discarded (cut).</p>
</dd>
<dt>f_pvalue</dt><dd><p>P-value of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_rsquared</dt><dd><p>R squared of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_adj_rsquared</dt><dd><p>Adjusted R squared of the linear model of
CO2 concentration over time.</p>
</dd>
<dt>f_intercept</dt><dd><p>Intercept of the linear model of CO2 concentration
over time.</p>
</dd>
<dt>f_slope</dt><dd><p>Slope of the linear model of CO2 concentration over time.</p>
</dd>
<dt>f_fit</dt><dd><p>Output of the linear model of CO2 concentration over time.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>slopes60lin
</code></pre>

<hr>
<h2 id='twogases_record'>Field record</h2><span id='topic+twogases_record'></span>

<h3>Description</h3>

<p>Field record
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twogases_record
</code></pre>


<h3>Format</h3>

<p>A tibble with 12 rows and 1 variable
</p>

<dl>
<dt>start</dt><dd><p>Start datetime of each flux measurement</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>twogases_record
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
