<!DOCTYPE html><html lang="en"><head><title>Help for package peacots</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {peacots}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#peacots-package'>
<p>Periodogram peaks in correlated time series</p></a></li>
<li><a href='#evaluate.pm'>
<p>Evaluate the periodogram maximum of a time series</p></a></li>
<li><a href='#evaluate.pm.wn'>
<p>Statistical significance of periodogram peaks (classical)</p></a></li>
<li><a href='#generate_ouss'>
<p>Generate random time series of the OUSS process</p></a></li>
<li><a href='#plotReport'>
<p>Plot results of a <code>evaluate.pm</code> analysis</p></a></li>
<li><a href='#ps_ouss'>
<p>Expected periodogram of the OUSS process</p></a></li>
<li><a href='#ps_ouss_asymptotic'>
<p>Power spectrum of the OUSS process</p></a></li>
<li><a href='#runExample'>
<p>Run example <code>evaluate.pm</code> analyses</p></a></li>
<li><a href='#significanceOfLocalPeak'>
<p>Statistical significance of local periodogram peaks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Periodogram Peaks in Correlated Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-28</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates the periodogram of a time series, maximum-likelihood fits an Ornstein-Uhlenbeck state space (OUSS) null model and evaluates the statistical significance of periodogram peaks against the OUSS null hypothesis. The OUSS is a parsimonious model for stochastically fluctuating variables with linear stabilizing forces, subject to uncorrelated measurement errors. Contrary to the classical white noise null model for detecting cyclicity, the OUSS model can account for temporal correlations typically occurring in ecological and geological time series. Citation: Louca, Stilianos and Doebeli, Michael (2015) &lt;<a href="https://doi.org/10.1890%2F14-0126.1">doi:10.1890/14-0126.1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>stats,graphics</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-28 15:25:13 UTC; stilianoslouca</td>
</tr>
<tr>
<td>Author:</td>
<td>Stilianos Louca [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stilianos Louca &lt;louca.research@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-30 08:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='peacots-package'>
Periodogram peaks in correlated time series
</h2><span id='topic+peacots-package'></span><span id='topic+peacots'></span>

<h3>Description</h3>

<p>Calculate the periodogram of a time series, maximum-likelihood fit an Ornstein-Uhlenbeck state space (OUSS) null model to the periodogram and evaluate the statistical significance of periodogram peaks against the OUSS null hypothesis.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> peacots</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-06-13</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The OUSS is a parsimonious model for a stochastically fluctuating variable (e.g. population size) with linear stabilizing forces, subject to uncorrelated measurement errors. Periodogram peaks (putative periodicities) are evaluated against this null hypothesis. In contrast to the white noise null model (the classical null model against which cyclicity is often evaluated), the OUSS process accounts for non-zero correlations between measurements and corrects for the resulting increased power at low frequencies.
</p>
<p>Use <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> to calculate the periodogram of a time series, fit the OUSS null model and calculate the statistical significance of the periodogram maximum.
</p>
<p>Use <code><a href="#topic+plotReport">plotReport</a></code> to generate a simple plot of the results returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code>.
</p>
<p>Use <code><a href="#topic+significanceOfLocalPeak">significanceOfLocalPeak</a></code> to evaluate the statistical significance of a secondary peak (i.e. non-global maximum) in the periodogram.
</p>
<p>Use <code><a href="#topic+runExample">runExample</a></code> to run an example <code>peacots</code> analysis based on simulation data.
</p>
<p>Use <code><a href="#topic+evaluate.pm.wn">evaluate.pm.wn</a></code> to evaluate the statistical significance of the periodogram maximum against the white noise null hypothesis. This is the classical test, included for comparison.
</p>
<p>Use <code><a href="#topic+ps_ouss_asymptotic">ps_ouss_asymptotic</a></code> to calculate the power spectrum of a particular OUSS process.
</p>
<p>Use <code><a href="#topic+ps_ouss">ps_ouss</a></code> to calculate the expected periodogram from a finite time series of a particular OUSS process.
</p>
<p>Use <code><a href="#topic+generate_ouss">generate_ouss</a></code> to generate random time series of a particular OUSS process.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a cyclic time series and analyse using peacots

# Parameters
lambda         = 1;    # inverse correlation time of OU process
cyclePeriod    = 1;
cycleAmplitude = 0.6;
times          = seq(0,20,0.25);

# Example 1

# generate cyclic time series by adding a periodic signal to an OUSS process
signal 	= cycleAmplitude * cos(2*pi*times/cyclePeriod) +
          generate_ouss(times, mu=0, sigma=1, lambda=lambda, epsilon=0.5);

# Find periodogram peak and estimate statistical significance
# Ignore frequencies lower than a pre-defined threshold
# to avoid masking by low-frequency maximum
report 	= evaluate.pm(times=times, signal=signal, 
                      minPeakFreq=lambda/3, 
                      minFitFreq=lambda/3,
                      startRadius=2);

# plot overview of periodogram peak analysis
plotReport(sprintf("Cyclic at frequency %.2g",1/cyclePeriod), 
           times=times, signal=signal, report=report);


# Example 2 (using the same time series)
# In this example we don't use low-frequency trimming
# Instead, we will focus on a particular (local) periodogram peak
# and estimate its 'local' statistical significance

# calculate periodogram and fit OUSS model
report    = evaluate.pm(times=times, signal=signal, startRadius=2);

# find the periodogram mode approximately corresponding to the frequency we are interested in
cycleMode = which(report$frequencies&gt;=0.99/cyclePeriod)[1];

# calculate local P-value for this peak
Pvalue    = significanceOfLocalPeak(power_o     = report$power_o, 
                                    lambda      = report$lambda, 
                                    power_e     = report$power_e, 
                                    time_step   = report$time_step,
                                    series_size = length(times),
                                    Nfreq       = length(report$frequencies), 
                                    peakFreq    = report$frequencies[cycleMode], 
                                    peakPower   = report$periodogram[cycleMode]);

# print result
cat(sprintf("Local P-value = %.3g for peak at frequency=%.3g\n", 
    Pvalue, report$frequencies[cycleMode]));
</code></pre>

<hr>
<h2 id='evaluate.pm'>
Evaluate the periodogram maximum of a time series
</h2><span id='topic+evaluate.pm'></span>

<h3>Description</h3>

<p>Calculate the Lomb-Scargle periodogram of a time series and estimate the statistical significance of the  periodogram maximum based on the null hypothesis of an Ornstein-Uhlenbeck state space (OUSS) process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate.pm(times, signal, minPeakFreq = 0, minFitFreq = 0, 
            iterations = 100, accuracy = 0.005, startRadius = 5, 
            verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate.pm_+3A_times">times</code></td>
<td>

<p>Numerical vector. Time points of the time series.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_signal">signal</code></td>
<td>

<p>Numerical vector of same size as <code>times</code>. Values of the time series.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_minpeakfreq">minPeakFreq</code></td>
<td>

<p>Non-negative number. Minimum considered frequency when determining periodogram peak. Use this if you want to ignore low-frequency components in the spectrum when searching for the periodogram maximum.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_minfitfreq">minFitFreq</code></td>
<td>

<p>Non-negative number. Minimum considered frequency when fitting the OUSS model to the periodogram. Use this to ignore low-frequency components in the spectrum when estimating the OUSS parameters, e.g. if you suspect your time series to be trended. <code>minFitFreq</code> might differ from <code>minPeakFreq</code>.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_iterations">iterations</code></td>
<td>

<p>Number of iterations for the maximum-likelihood fitter. Increasing this will result in greater estimation accuracy but also reduced performance.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_startradius">startRadius</code></td>
<td>

<p>Single integer. The number of initial guesses for each OUSS parameter during optimization of the likelihood function, per direction (up and down). Increasing this will improve estimation accuracy. However, execution time scales with <code>startRadius^2</code>.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_accuracy">accuracy</code></td>
<td>

<p>An upper bound for the standard deviation of the P-value estimator using repeated Bernoulli trials. The number of trials scales as <code>1/accuracy^2</code>. If you are using <code>0.05</code> as a nominal significance threshold, then <code>accuracy=0.005</code> is probably good enough.
</p>
</td></tr>
<tr><td><code id="evaluate.pm_+3A_verbose">verbose</code></td>
<td>

<p>Single logical. If <code>TRUE</code>, the function prints out occasional progress reports.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OUSS model describes the measurement of an Ornstein-Uhlenbeck (OU) stochastic process at discrete times with additional uncorrelated Gaussian measurement errors of fixed variance. The OU process itself is a continuous-time random walk with linear stabilizing forces, described by the stochastic differential equation
</p>
<p style="text-align: center;"><code class="reqn">
  dX = \lambda(\mu-X) dt + s dW,
</code>
</p>

<p>where <code class="reqn">W</code> is the standard Wiener process. The OUSS process is a parsimonious model for describing stochastically fluctuating variables subject to linear stabilizing forces and uncorrelated measurement errors.
</p>
<p>Due to temporal correlations, the OUSS power spectrum increases gradually towards lower frequencies, as opposed to the white noise spectrum, which is flat. Using white noise as a null hypothesis for the evaluation of cyclicity in time series, particularly for systems with long correlation times, may result in increased false cycle detection rates because of the increased low-frequency power. The OUSS model is an attempt to account for these correlations.
</p>
<p>The OUSS model parameters are estimated using maximum-likelihood fitting to the periodogram. The likelihood function, and therefore the OUSS parameter estimates, are only approximations that become exact for long regular time series. The statistical significance of the periodogram peak (power <code class="reqn">S</code> at frequency <code class="reqn">F</code>) under the null-hypothesis of an OUSS process is defined as the probability that the same OUSS process would generate a periodogram whose maximum (power <code class="reqn">s</code> at frequency <code class="reqn">f</code>) satisfies 
</p>
<p style="text-align: center;"><code class="reqn">
    s^2/e\ge S^2/E,
</code>
</p>

<p>where <code class="reqn">e</code> and <code class="reqn">E</code> are the expected periodogram powers at the frequencies <code class="reqn">f</code> and <code class="reqn">F</code>, respectively.
The P-value is estimated via repeated Bernoulli trials in which random OUSS periodograms are emulated by exponentially distributed numbers.
</p>
<p>If you want to evaluate secondary peaks (i.e. non-global periodogram maxima), you will need to either (a) adjust the parameters <code>minPeakFreq</code> and <code>minFitFreq</code> to omit low-frequency modes or (b) use <code><a href="#topic+significanceOfLocalPeak">significanceOfLocalPeak</a></code> after using <code>evaluate.pm</code>.
</p>


<h3>Value</h3>

<p>A list with the following entries:
</p>
<table role = "presentation">
<tr><td><code>error</code></td>
<td>
<p>Will be <code>TRUE</code> if an error occured, <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code>errorMessage</code></td>
<td>
<p>A short error message if <code>error==TRUE</code>.</p>
</td></tr>
</table>
<p>If <code>error==FALSE</code>, the returned list also includes:
</p>
<table role = "presentation">
<tr><td><code>frequencies</code></td>
<td>
<p>Available periodogram frequencies as a numerical vector.</p>
</td></tr>
<tr><td><code>periodogram</code></td>
<td>
<p>Periodogram powers corresponding to the returned frequencies, as a numerical vector.</p>
</td></tr>
<tr><td><code>fittedPS</code></td>
<td>
<p>Maximum-likelihood fitted OUSS power spectrum corresponding to <code>frequencies</code>, as a numerical vector.</p>
</td></tr>
<tr><td><code>power_o</code></td>
<td>
<p>Estimated power spectrum at zero-frequency generated by the underlying OU process.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>Estimated resilience of the OU process (in inverse time units).</p>
</td></tr>
<tr><td><code>power_e</code></td>
<td>
<p>Estimated power spectrum at large frequencies due to the random measurement errors.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>Estimated stationary standard deviation of the underlying OU process.</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>Estimated standard deviation of measurement errors.</p>
</td></tr>
<tr><td><code>time_step</code></td>
<td>
<p>The average time step of the time series, as used to fit the OUSS power spectrum.</p>
</td></tr>
<tr><td><code>peakMode</code></td>
<td>
<p>An integer indicating the position of the periodogram maximum in the vector <code>frequencies</code>.</p>
</td></tr>
<tr><td><code>minPeakMode</code></td>
<td>
<p>The minimum periodogram mode considered for determining the periodogram maximum. This will be <code>1</code> if <code>minPeakFreq==0</code>.</p>
</td></tr>
<tr><td><code>minFitMode</code></td>
<td>
<p>The minimum periodogram mode considered for estimating the white noise power. This will be <code>1</code> if <code>minFitFreq==0</code>.</p>
</td></tr>
<tr><td><code>MLL</code></td>
<td>
<p>Log-likelihood value at calculated maximum.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Statistical significance of the periodogram peak against the null hypothesis of the estimated OUSS process. This is the probability that the estimated OUSS process would generate a periodogram with global maximum at least as &ldquo;extreme&rdquo; as the observed peak (among the considered frequencies). See details above.</p>
</td></tr>
<tr><td><code>Plocal</code></td>
<td>
<p>Statistical significance of the relative power of the periodogram peak. Mainly used for comparison to the statistical significance of secondary peaks. See <code><a href="#topic+significanceOfLocalPeak">significanceOfLocalPeak</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm.wn">evaluate.pm.wn</a></code>, <code><a href="#topic+significanceOfLocalPeak">significanceOfLocalPeak</a></code>, <code><a href="#topic+ps_ouss">ps_ouss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># In this example we generate a cyclic time series
# and analyse its periodogram using evaluate.pm

# Parameters
lambda         = 1;    # inverse correlation time of OU process
cyclePeriod    = 1;    # Cycle period
cycleAmplitude = 0.6;
times          = seq(0,20,0.25);

# generate cyclic time series by adding a periodic signal to an OUSS process
signal = cycleAmplitude * cos(2*pi*times/cyclePeriod) +
         generate_ouss(times, mu=0, sigma=1, lambda=lambda, epsilon=0.5);

# Find periodogram peak and estimate statistical significance
# Ignore frequencies lower than a pre-defined threshold
# to avoid masking by low-frequency maximum
report = evaluate.pm(times=times, signal=signal, 
                     minPeakFreq=lambda/3, 
                     minFitFreq=lambda/3,
                     startRadius=2);

# plot overview of periodogram peak analysis
plotReport(sprintf("Cyclic at frequency %.2g",1/cyclePeriod), 
           times=times, signal=signal, report=report);     
      
</code></pre>

<hr>
<h2 id='evaluate.pm.wn'>
Statistical significance of periodogram peaks (classical)
</h2><span id='topic+evaluate.pm.wn'></span>

<h3>Description</h3>

<p>Calculates the Lomb-Scargle periodogram for the given time series and estimates the statistical significance of the global periodogram maximum based on the null hypothesis of uncorrelated (white) noise. Available for historical reasons and for comparison purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluate.pm.wn(times, signal, minPeakFreq=0, minFitFreq=0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluate.pm.wn_+3A_times">times</code></td>
<td>

<p>Numerical vector. Time points of the time series.
</p>
</td></tr>
<tr><td><code id="evaluate.pm.wn_+3A_signal">signal</code></td>
<td>

<p>Numerical vector of same size as <code>times</code>. Values of the time series.
</p>
</td></tr>
<tr><td><code id="evaluate.pm.wn_+3A_minpeakfreq">minPeakFreq</code></td>
<td>

<p>Single non-negative number. Minimum considered frequency when determining periodogram peak. Use this to ignore low-frequency components from the spectrum.
</p>
</td></tr>
<tr><td><code id="evaluate.pm.wn_+3A_minfitfreq">minFitFreq</code></td>
<td>

<p>Single non-negative number. Minimum considered frequency when fitting the white noise null model to the periodogram. Use this to ignore low-frequency components from the spectrum.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the entries
</p>
<table role = "presentation">
<tr><td><code>error</code></td>
<td>
<p>Will be <code>TRUE</code> if an error occured, <code>FALSE</code> otherwise.</p>
</td></tr>
<tr><td><code>errorMessage</code></td>
<td>
<p>A short error message if <code>error==TRUE</code>.</p>
</td></tr>
</table>
<p>If <code>error==FALSE</code>, the returned list also includes:
</p>
<table role = "presentation">
<tr><td><code>frequencies</code></td>
<td>
<p>Available periodogram frequencies as a numerical vector.</p>
</td></tr>
<tr><td><code>periodogram</code></td>
<td>
<p>Periodogram powers corresponding to the returned frequencies, as a numerical vector.</p>
</td></tr>
<tr><td><code>peakMode</code></td>
<td>
<p>An integer indicating the position of the global periodogram maximum (starting at <code>minPeakFreq</code>) in the vector <code>frequencies</code>.</p>
</td></tr>
<tr><td><code>powerEstimate</code></td>
<td>
<p>The estimated white noise power. Estimated from the average periodogram power, which corresponds to using the total variance of the time series (if <code>minFitFreq==0</code>).</p>
</td></tr>
<tr><td><code>minPeakMode</code></td>
<td>
<p>The minimum periodogram mode considered for determining the periodogram peak. This will be <code>1</code> if <code>minPeakFreq==0</code>.</p>
</td></tr>
<tr><td><code>minFitMode</code></td>
<td>
<p>The minimum periodogram mode considered for estimating the white noise power. This will be <code>1</code> if <code>minFitFreq==0</code>.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>The sum of squared residuals of the periodogram from the estimated white noise power.</p>
</td></tr>
<tr><td><code>P</code></td>
<td>
<p>Statistical significance of periodogram peak. This is the probability that a white noise periodogram (of the estimated power) would generate a peak at least as strong as the observed peak (among the considered frequencies). The calculated P-value is only an approximation that becomes exact for long regular time series.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Scargle, J. D. (1982) - Studies in astronomical time series analysis. II Statistical aspects of spectral analysis of unevenly spaced data, The Astrophysical Journal 263, 835&ndash;853
</p>
<p>Horne, J. H., Baliunas, S. L. (1986) - A prescription for period analysis of unevenly sampled time series, The Astrophysical Journal 302, 757&ndash;763
</p>
<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate time series
times  = seq(0,20,0.25);
signal = rnorm(n=length(times));
report = evaluate.pm.wn(times=times, signal=signal);

# plot time series
old.par &lt;- par(mfrow=c(1, 2));
plot(ts(times), ts(signal), 
     xy.label=FALSE, type="l", 
     ylab="signal", xlab="time", main="OUSS time series");
     
# plot periodogram
title = sprintf("Periodogram OUSS analysis\n(peak freq=%.3g, P=%.2g)",
                report$frequencies[report$peakMode],report$P);
plot(ts(report$frequencies),
     ts(report$periodogram), 
     xy.label=FALSE, type="l", 
     ylab="power", xlab="frequency", 
     main=title, col="black");
	
# plot fitted flat WN power
lines(c(report$frequencies[1],tail(report$frequencies,1)), 
      c(report$powerEstimate, report$powerEstimate ), col="blue");
par(old.par)

</code></pre>

<hr>
<h2 id='generate_ouss'>
Generate random time series of the OUSS process
</h2><span id='topic+generate_ouss'></span>

<h3>Description</h3>

<p>Generate a random time series of the 1-dimensional stationary Ornstein-Uhlenbeck state space (OUSS) process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate_ouss(times, mu, power_o, sigma, 
              lambda, power_e, epsilon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="generate_ouss_+3A_times">times</code></td>
<td>

<p>Numeric vector of times for which to evaluate OUSS model. Times need to be strictly increasing.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_mu">mu</code></td>
<td>

<p>Single number. Deterministic equilibrium of OU process, i.e., the expected value of the time series at any particular time.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_sigma">sigma</code></td>
<td>

<p>Single number. Standard deviation of OU fluctuations around equilibrium.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_power_o">power_o</code></td>
<td>

<p>Single non-negative number. Power spectrum at zero-frequency generated by the OU process. Either <code>power_o</code> or <code>sigma</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_lambda">lambda</code></td>
<td>

<p>Single non-negative number. Resilience (also known as relaxation rate) of the OU process. This is the inverse of the OU correlation time.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_epsilon">epsilon</code></td>
<td>

<p>Single number. Standard deviation of Gaussian measurement error. Setting this to zero will yield a time series from the classical OU process.
</p>
</td></tr>
<tr><td><code id="generate_ouss_+3A_power_e">power_e</code></td>
<td>

<p>Single non-negative number. Asymptotic power spectrum at large frequencies due to the Gaussian measurement errors. Setting this to zero will yield a classical OU process. Either <code>power_e</code> or <code>epsilon</code> (but not both) must be provided.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OUSS model describes the measurement of an Ornstein-Uhlenbeck (OU) stochastic process at discrete times with additional uncorrelated Gaussian measurement errors. The OU process itself is a continuous-time random walk (Brownian motion) with linear stabilizing forces, described by the stochastic differential equation
</p>
<p style="text-align: center;"><code class="reqn">
	dX = \lambda(\mu-X) dt + s dW,
</code>
</p>

<p>where <code class="reqn">W</code> is the standard Wiener process and <code class="reqn">s^2=2\lambda\sigma^2.</code> The OUSS model is obtained by adding uncorrelated Gaussian numbers with zero mean and variance <code class="reqn">\epsilon^2</code> to the time series.
</p>


<h3>Value</h3>

<p>A numeric vector of same length as <code>times</code>, containing sampled values of the OUSS process. These values will all have the same expectation (<code>mu</code>) and variance (<code>sigma^2+epsilon^2</code>) but will be correlated.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>
<p>Dennis, B., Ponciano, J.M. - Density dependent state-space model for population abundance data with unequal time intervals, Ecology (in press as of June 2014)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ps_ouss">ps_ouss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># define times
times = seq(0,100,0.5);

# generate OUSS time series
signal 	= generate_ouss(times=times, mu=0, sigma=1, lambda=1, epsilon=0.5);

# plot time series
plot(ts(times), ts(signal), 
     xy.label=FALSE, type="l", 
     ylab="signal", xlab="time", main="OUSS time series");
</code></pre>

<hr>
<h2 id='plotReport'>
Plot results of a <code>evaluate.pm</code> analysis
</h2><span id='topic+plotReport'></span>

<h3>Description</h3>

<p>Create a simple plot of a time series and the results of a <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> analysis (including the periodogram and the fitted OUSS power spectrum).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotReport(name="", times=NULL, signal=NULL, 
           report=NULL, plotFile=NULL, dataFile=NULL, sep=" ")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plotReport_+3A_name">name</code></td>
<td>

<p>Character. A short name for the time series to be used for the plots (e.g. 'long-term study' or 'hare population').
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_times">times</code></td>
<td>

<p>Numeric vector. The time points of the time series used for the analysis. Set to <code>NULL</code> to not plot the time series.
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_signal">signal</code></td>
<td>

<p>Numeric vector. The time series values (signal) used for the analysis. Set to <code>NULL</code> to not plot the time series.
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_report">report</code></td>
<td>

<p>The value returned by <code>evaluate.pm</code>. This is a list with the periodogram analysis results. Set to <code>NULL</code> to not plot any analysis results.
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_plotfile">plotFile</code></td>
<td>

<p>An optional path to a PDF file to be generated with the plot.
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_datafile">dataFile</code></td>
<td>

<p>An optional path to a data file for storing the time series and the results of the analysis.
</p>
</td></tr>
<tr><td><code id="plotReport_+3A_sep">sep</code></td>
<td>

<p>Separator to be used for the data file. Only relevant if <code>dataFile</code> is not <code>NULL</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate cyclic time series by adding a periodic signal to an OUSS process
times  = seq(0,20,0.25);
signal = 0.6 * cos(2*pi*times) + generate_ouss(times, mu=0, sigma=1, lambda=1, epsilon=0.5);

# find periodogram peak and estimate statistical significance
report = evaluate.pm( times=times, 
                      signal=signal, 
                      minPeakFreq=0.3, 
                      minFitFreq=0.3,
                      startRadius=2);

# plot overview of periodogram peak analysis
plotReport(sprintf("Example"), times=times, signal=signal, report=report);
</code></pre>

<hr>
<h2 id='ps_ouss'>
Expected periodogram of the OUSS process
</h2><span id='topic+ps_ouss'></span>

<h3>Description</h3>

<p>Returns the expected periodogram power of the Ornstein-Uhlenbeck state space (OUSS) process at a particular frequency, when sampled at regular time intervals for a finite time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps_ouss(freq, power_o, sigma, 
        rho, lambda, 
        power_e, epsilon, 
        time_step, series_size)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ps_ouss_+3A_freq">freq</code></td>
<td>

<p>Single number or numeric vector. The frequency for which to the power spectrum is to be calculated.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_power_o">power_o</code></td>
<td>

<p>Single non-negative number. Power at zero-frequency generated by the underlying OU process, when sampled at the given <code>time_step</code>. Either <code>power_o</code> or <code>sigma</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_sigma">sigma</code></td>
<td>

<p>Single number. Standard deviation of OU fluctuations around equilibrium. Either <code>power_o</code> or <code>sigma</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_rho">rho</code></td>
<td>

<p>Single number between 0 (exclusive) and 1 (inclusive). Correlation of the OU process between two subsequent time points. Either <code>rho</code> or <code>lambda</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_lambda">lambda</code></td>
<td>

<p>Single non-negative number. Resilience (or relaxation rate) of the OU process. This is also the inverse correlation time of the OU process. Either <code>rho</code> or <code>lambda</code> (but not both) must be provided. 
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_power_e">power_e</code></td>
<td>

<p>Single non-negative number. Asymptotic power at large frequencies due to the random measurement errors. Setting this to zero corresponds to the classical OU process. Either <code>power_e</code> or <code>epsilon</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_epsilon">epsilon</code></td>
<td>

<p>Single number. Standard deviation of Gaussian measurement error. Setting this to zero corresponds to the classical OU process. Either <code>power_e</code> or <code>epsilon</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_time_step">time_step</code></td>
<td>

<p>Positive number. The time step of the time series that was (or will be) used for periodogram generation.
</p>
</td></tr>
<tr><td><code id="ps_ouss_+3A_series_size">series_size</code></td>
<td>

<p>Positive integer. The number of sampled time points.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OUSS parameters <code>power_o</code>, <code>lambda</code> and <code>power_e</code> will typically be maximum-likelihood fitted values returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code>. The value of <code>time_step</code> is also returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> and is inferred from the analysed time series. More generally, <code>power_o</code> and <code>power_e</code> are proportional to the OUSS parameters <code>sigma^2</code> and <code>epsilon^2</code> (see <code><a href="#topic+generate_ouss">generate_ouss</a></code>), respectively, but the exact scaling depends on the normalization used for the periodogram. 
</p>
<p>In the limit where <code>series_size</code> becomes very large, <code>ps_ouss</code> becomes the same as <code><a href="#topic+ps_ouss_asymptotic">ps_ouss_asymptotic</a></code>.
</p>


<h3>Value</h3>

<p>Returns a numeric vector of the same size as <code>freq</code>, containing the corresponding expected periodogram powers of the OUSS process.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>, <code><a href="#topic+generate_ouss">generate_ouss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate OUSS time series
times  = seq(0,20,0.25);
signal = generate_ouss(times, mu=0, sigma=1, lambda=1, epsilon=0.5);

# calculate periodogram and fit OUSS model
report = evaluate.pm(times=times, signal=signal, startRadius=2);

# plot periodogram
plot(report$frequencies, report$periodogram, 
     type="l", ylab="power", xlab="frequency", main="periodogram &amp; fitted OUSS power spectrum");

# plot expected OUSS periodogram
lines(report$frequencies, 
      ps_ouss(freq=report$frequencies, 
              power_o=report$power_o, 
              lambda=report$lambda, 
              power_e=report$power_e, 
              time_step=report$time_step,
              series_size=length(times)), 
      col="red");

</code></pre>

<hr>
<h2 id='ps_ouss_asymptotic'>
Power spectrum of the OUSS process
</h2><span id='topic+ps_ouss_asymptotic'></span>

<h3>Description</h3>

<p>Returns the power spectrum of the Ornstein-Uhlenbeck state space (OUSS) process at a particular frequency. This is the asymptotic expected periodogram power for long regular time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ps_ouss_asymptotic(freq, power_o, sigma, 
                   rho, lambda, 
                   power_e, epsilon, time_step)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ps_ouss_asymptotic_+3A_freq">freq</code></td>
<td>

<p>Single number or numeric vector. The frequency for which to the power spectrum is to be calculated.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_power_o">power_o</code></td>
<td>

<p>Single non-negative number. Power spectrum at zero-frequency generated by the underlying OU process, when sampled at the given <code>time_step</code>. Either <code>power_o</code> or <code>sigma</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_sigma">sigma</code></td>
<td>

<p>Single number. Standard deviation of OU fluctuations around equilibrium. Either <code>power_o</code> or <code>sigma</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_rho">rho</code></td>
<td>

<p>Single number between 0 (exclusive) and 1 (inclusive). Correlation of the OU process between two subsequent time points. Either <code>rho</code> or <code>lambda</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_lambda">lambda</code></td>
<td>

<p>Single non-negative number. Resilience (or relaxation rate) of the OU process. This is also the inverse correlation time of the OU process. Either <code>rho</code> or <code>lambda</code> (but not both) must be provided. 
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_power_e">power_e</code></td>
<td>

<p>Single non-negative number. Asymptotic power spectrum at large frequencies due to the random measurement errors. Setting this to zero corresponds to the classical OU process. Either <code>power_e</code> or <code>epsilon</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_epsilon">epsilon</code></td>
<td>

<p>Single number. Standard deviation of Gaussian measurement error. Setting this to zero corresponds to the classical OU process. Either <code>power_e</code> or <code>epsilon</code> (but not both) must be provided.
</p>
</td></tr>
<tr><td><code id="ps_ouss_asymptotic_+3A_time_step">time_step</code></td>
<td>

<p>Positive number. The time step of the time series that was (or will be) used for periodogram generation.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OUSS parameters <code>power_o</code>, <code>lambda</code> and <code>power_e</code> will typically be maximum-likelihood fitted values returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code>. <code>time_step</code> is also returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> and is inferred from the analysed time series. More generally, <code>power_o</code> and <code>power_e</code> are proportional to the OUSS parameters <code>sigma^2</code> and <code>epsilon^2</code> (see <code><a href="#topic+generate_ouss">generate_ouss</a></code>), respectively, but the exact scaling depends on the normalization used for the periodogram.
</p>


<h3>Value</h3>

<p>Returns a numeric vector of the same size as <code>freq</code>, containing the corresponding powers of the OUSS process.
</p>


<h3>Note</h3>

<p>This function is the asymptotic version of <code><a href="#topic+ps_ouss">ps_ouss</a></code> in the limit where <code>series_size</code> becomes very large. If you want to compare the expected periodogram to the periodogram of a short time series use <code><a href="#topic+ps_ouss">ps_ouss</a></code> instead.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>, <code><a href="#topic+generate_ouss">generate_ouss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate OUSS time series
times  = seq(0,20,0.25);
signal = generate_ouss(times, mu=0, sigma=1, lambda=1, epsilon=0.5);

# calculate periodogram and fit OUSS model
report = evaluate.pm(times=times, signal=signal, startRadius=2);

# plot periodogram
plot(report$frequencies, report$periodogram, 
     type="l", ylab="power", xlab="frequency", main="periodogram &amp; fitted OUSS power spectrum");

# plot OUSS power spectrum
lines(report$frequencies, 
      ps_ouss_asymptotic( freq=report$frequencies, 
                          power_o=report$power_o, 
                          lambda=report$lambda, 
                          power_e=report$power_e, 
                          time_step=report$time_step), 
      col="red");

</code></pre>

<hr>
<h2 id='runExample'>
Run example <code>evaluate.pm</code> analyses
</h2><span id='topic+runExample'></span>

<h3>Description</h3>

<p>Generate random cyclic time series, analyse them using <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> and plot the results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runExample(verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="runExample_+3A_verbose">verbose</code></td>
<td>

<p>Boolean, whether to print messages to the screen.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value.</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>, <code><a href="#topic+plotReport">plotReport</a></code>, <code><a href="#topic+generate_ouss">generate_ouss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # this might take a few seconds
  runExample();
</code></pre>

<hr>
<h2 id='significanceOfLocalPeak'>
Statistical significance of local periodogram peaks
</h2><span id='topic+significanceOfLocalPeak'></span>

<h3>Description</h3>

<p>Calculate statistical significance for a secondary periodogram peak (i.e. a non-global periodogram maximum), based on the null hypothesis of an OUSS process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>significanceOfLocalPeak(power_o, lambda, power_e, 
                        time_step, series_size,
                        Nfreq, peakFreq, peakPower)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="significanceOfLocalPeak_+3A_power_o">power_o</code></td>
<td>

<p>Positive number. Power at zero-frequency stemming from the underlying OU process.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_lambda">lambda</code></td>
<td>

<p>Positive number. Resilience (or relaxation rate) of the OU process, in inverse time units. This is also the inverse correlation time of the OU process. 
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_power_e">power_e</code></td>
<td>

<p>Non-negative number. Asymptotic power at large frequencies due to random measurement errors. Setting this to zero corresponds to the classical OU process.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_time_step">time_step</code></td>
<td>

<p>Positive number. The time step of the time series that was used to calculate the periodogram.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_series_size">series_size</code></td>
<td>

<p>Positive integer. The size of the time series for which the periodogram peak was calculated.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_nfreq">Nfreq</code></td>
<td>

<p>The number of frequencies from which the local periodogram peak was picked. Typically equal to the number of frequencies in the periodogram.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_peakfreq">peakFreq</code></td>
<td>

<p>Single number. The frequency of the focal peak.
</p>
</td></tr>
<tr><td><code id="significanceOfLocalPeak_+3A_peakpower">peakPower</code></td>
<td>

<p>Single number. The periodogram power calculated for the focal peak.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The OUSS parameters <code>power_o</code>, <code>lambda</code> and <code>power_e</code> will typically be maximum-likelihood fitted values returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code>. The <code>time_step</code> is also returned by <code>evaluate.pm</code> and is inferred from the analysed time series. The examined periodogram peak (as defined by <code>peakFreq</code>) will typically be a secondary peak of interest, masked by other stronger peaks or a low-frequency maximum. The significance of such a peak is not defined by standard tests.
</p>


<h3>Value</h3>

<p>The returned P-value (referred to as &ldquo;local P-value&rdquo;) is the probability that an OUSS process with the specified parameters would generate a periodogram with a power-to-expectation ratio greater than <code>peakPower/E</code>, where <code>E</code> is the power spectrum of the OUSS process at frequency <code>peakFreq</code>. Hence, the significance is a measure for how much the peak power deviates from its expectation. The calculated value is an approximation. It becomes exact for long regular time series.
</p>


<h3>Note</h3>

<p>This statistical significance is not equivalent to the one calculated by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> for the global periodogram maximum.
If the investigated periodogram peak is a global maximum, then the P-value returned by <code><a href="#topic+evaluate.pm">evaluate.pm</a></code> should be preferred, as it also takes into account the absolute magnitude of the peak.
</p>


<h3>Author(s)</h3>

<p>Stilianos Louca
</p>


<h3>References</h3>

<p>Louca, S., Doebeli, M. (2015) Detecting cyclicity in ecological time series, Ecology 96: 1724&ndash;1732
</p>


<h3>See Also</h3>

<p><code><a href="#topic+evaluate.pm">evaluate.pm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # In this example we generate a random cyclic time series, where the peak is (most likely)
  # masked by a strong low-frequency maximum.
  # We will use significanceOfLocalPeak() to evaluate its significance
  # based on its deviation from the expected power.
  
  # generate cyclic time series by adding a periodic signal to an OUSS process
  period    = 1;
  times     = seq(0,20,0.2);
  signal    = 0.5 * cos(2*pi*times/period) +
              generate_ouss(times, mu=0, sigma=1, lambda=1, epsilon=0.5);
  
  # calculate periodogram and fit OUSS model
  report    = evaluate.pm(times=times, signal=signal);
  print(report)
	
  # find which periodogram mode approximately corresponds to the frequency we are interested in
  cycleMode = which(report$frequencies&gt;=0.99/period)[1]; 
	
  # calculate P-value for local peak
  Pvalue    = significanceOfLocalPeak(power_o     = report$power_o, 
                                      lambda      = report$lambda, 
                                      power_e     = report$power_e, 
                                      time_step   = report$time_step, 
                                      series_size = length(times),
                                      Nfreq       = length(report$frequencies), 
                                      peakFreq    = report$frequencies[cycleMode], 
                                      peakPower   = report$periodogram[cycleMode]);

  # plot time series
  old.par &lt;- par(mfrow=c(1, 2));
  plot(ts(times), ts(signal), 
       xy.label=FALSE, type="l", 
       ylab="signal", xlab="time", main="Time series (cyclic)", 
       cex=0.8, cex.main=0.9);

  # plot periodogram
  title = sprintf("Periodogram OUSS analysis\nfocusing on local peak at freq=%.3g\nPlocal=%.2g",
                  report$frequencies[cycleMode],Pvalue);
  plot(ts(report$frequencies), ts(report$periodogram), 
       xy.label=FALSE, type="l", 
       ylab="power", xlab="frequency", main=title, 
       col="black", cex=0.8, cex.main=0.9);
	
  # plot fitted OUSS power spectrum
  lines(report$frequencies, report$fittedPS, col="red");
	par(old.par)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
