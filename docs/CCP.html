<!DOCTYPE html><html lang="en"><head><title>Help for package CCP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CCP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CCP-package'><p>Significance Tests for Canonical Correlation Analysis</p></a></li>
<li><a href='#CCP-internal'><p> Internal functions for CCP package</p></a></li>
<li><a href='#p.asym'><p> Asymptotic tests for the statistical significance of canonical correlation coefficients</p></a></li>
<li><a href='#p.perm'><p> Permutation test for the significance of canonical correlation coefficients</p></a></li>
<li><a href='#plt.asym'><p> Plot asymptotic distributions for test statistics</p></a></li>
<li><a href='#plt.perm'><p> Plot permutation distributions for test statistics</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Significance Tests for Canonical Correlation Analysis (CCA)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-04-20</td>
</tr>
<tr>
<td>Author:</td>
<td>Uwe Menzel</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Uwe Menzel &lt;uwemenzel@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Significance tests are provided for canonical correlation analysis, including asymptotic tests and a Monte Carlo method.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-04-21 16:09:16 UTC; uwe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-04-21 21:50:02 UTC</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
</table>
<hr>
<h2 id='CCP-package'>Significance Tests for Canonical Correlation Analysis</h2><span id='topic+CCP-package'></span><span id='topic+CCP'></span>

<h3>Description</h3>

<p>The package provides functions to test for statistical significance
of canonical correlation coefficients, including asymptotic methods
and a Monte Carlo approach. 
Additionally, functions are available to plot the asymptotic distributions
and the permutation distribution, respectively. 
The main user functions are <code>p.asym</code>, <code>p.perm</code>,
<code>plt.asym</code>, and <code>plt.perm</code>.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>

<hr>
<h2 id='CCP-internal'> Internal functions for CCP package </h2><span id='topic+Hotelling.stat'></span><span id='topic+HotellingLawleyTrace'></span><span id='topic+p.Roy'></span><span id='topic+Pillai.stat'></span><span id='topic+PillaiBartlettTrace'></span><span id='topic+RaoF.stat'></span><span id='topic+WilksLambda'></span>

<h3>Description</h3>

<p>Internal functions for CCP package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hotelling.stat(rho, N, p, q)
HotellingLawleyTrace(rho, p, q)
p.Roy(rho, N, p, q)
Pillai.stat(rho, N, p, q)
PillaiBartlettTrace(rho, p, q)
RaoF.stat(rho, N, p, q)
WilksLambda(rho, p, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCP-internal_+3A_rho">rho</code></td>
<td>
<p> vector containing the canonical correlation coefficients. </p>
</td></tr>
<tr><td><code id="CCP-internal_+3A_n">N</code></td>
<td>
<p> number of observations for each variable. </p>
</td></tr>
<tr><td><code id="CCP-internal_+3A_p">p</code></td>
<td>
<p> number of independent variables. </p>
</td></tr>
<tr><td><code id="CCP-internal_+3A_q">q</code></td>
<td>
<p> number of dependent variables. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions are not intended to be called by the user.
</p>

<hr>
<h2 id='p.asym'> Asymptotic tests for the statistical significance of canonical correlation coefficients </h2><span id='topic+p.asym'></span>

<h3>Description</h3>

<p>This function runs asymptotic tests to assign the statistical significance 
of canonical correlation coefficients.
F-approximations of Wilks' Lambda, the Hotelling-Lawley Trace,
the Pillai-Bartlett Trace, or of Roy's Largest Root can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.asym(rho, N, p, q, tstat = "Wilks")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.asym_+3A_rho">rho</code></td>
<td>
<p> vector containing the canonical correlation coefficients. </p>
</td></tr>
<tr><td><code id="p.asym_+3A_n">N</code></td>
<td>
<p> number of observations for each variable. </p>
</td></tr>
<tr><td><code id="p.asym_+3A_p">p</code></td>
<td>
<p> number of independent variables. </p>
</td></tr>
<tr><td><code id="p.asym_+3A_q">q</code></td>
<td>
<p> number of dependent variables. </p>
</td></tr>
<tr><td><code id="p.asym_+3A_tstat">tstat</code></td>
<td>
<p> test statistic to be used. One of &quot;Wilks&quot; (default), &quot;Hotelling&quot;, &quot;Pillai&quot;, or &quot;Roy&quot;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Canonical correlation analysis (CCA) measures the degree of linear relationship between two sets of variables.
The number of correlation coefficients calculated in CCA is equal to the number of variables in the smaller set: <code class="reqn">m = min(p,q)</code>.
The coefficients are arranged in descending order of magnitude: <code class="reqn">rho[1] &gt; rho[2] &gt; rho[3] &gt; ... &gt; rho[m]</code>.
Except for <code>tstat = "Roy"</code>, the function <code>p.asym</code> calculates <code class="reqn">m</code> p-values for each test statistic:
the first p-value is calculated including <em>all</em> canonical correlation coefficients,
the second p-value is calculated by excluding <code class="reqn">rho[1]</code>, 
the third p-value is calculated by excluding <code class="reqn">rho[1]</code> and <code class="reqn">rho[2]</code> etc., 
therewith allowing assessment of the statistical significance of each individual correlation coefficient. 
On principle, Roy's Largest Root takes only <code class="reqn">rho[1]</code> into account, hence one p-value is calculated only. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>value of the statistic, i.e. the value of either Wilks' Lambda, the Hotelling-Lawley Trace, the Pillai-Bartlett Trace, or Roy's Largest Root.</p>
</td></tr>
<tr><td><code>approx</code></td>
<td>
<p>value of the corresponding F-approximation for the statistic.</p>
</td></tr>
<tr><td><code>df1</code></td>
<td>
<p>numerator degrees of freedom for the F-approximation.</p>
</td></tr> 
<tr><td><code>df2</code></td>
<td>
<p>denominator degrees of freedom for the F-approximation.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value</p>
</td></tr>  
</table>


<h3>Note</h3>

<p> Usage of asymptotic approximations requires multivariate normality of the variables, 
or a large number of observations. Canonical correlation is sensitive to outliers.
The F-approximation for Roy's Largest Root is an upper bound, and the significance level is therefore 
optimistically small. The canonical correlation coefficients are statistically significant
if Wilks' Lambda is <em>smaller</em> than a critical value.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>References</h3>

<p>Wilks, S. S. (1935)
On the independence of <code class="reqn">k</code> sets of normally distributed statistical variables.
<em>Econometrica</em>, <b>3</b> 309&ndash;326.  
</p>
<p>Rao, C. R. (1973)
<em>Linear Statistical Inference and It's Applications (2nd ed.).</em>
John Wiley and Sons, New York, 533&ndash;543, 555&ndash;556.
</p>
<p>Pillai, K. C. W. (1956)
On the distribution of the largest or the smallest root of a matrix in multivariate analysis.
<em>Biometrika</em>, <b>43</b> 122&ndash;127.
</p>
<p>Muller, K. E. and Peterson B. L. (1984)
Practical Methods for computing power in testing the multivariate general linear hypothesis.
<em>Computational Statistics &amp; Data Analysis</em>, <b>2</b> 143&ndash;158.
</p>
<p>Anderson, T. W. (1984)
<em>An introduction to Multivariate Statistical Analysis.</em> 
John Wiley and Sons, New York.
</p>


<h3>See Also</h3>

<p> See the function <code><a href="stats.html#topic+cancor">cancor</a></code> or the <code>CCA</code> package for the calculation of canonical correlation coefficients. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the CCP package:
library(CCP)



## Simulate example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)


## Calculate canonical correlations:
rho &lt;- cancor(X,Y)$cor

## Define number of observations, 
## and number of dependent and independent variables:
N = dim(X)[1]       
p = dim(X)[2]   
q = dim(Y)[2]

## Calculate p-values using F-approximations of some test statistics:
p.asym(rho, N, p, q, tstat = "Wilks")
p.asym(rho, N, p, q, tstat = "Hotelling")
p.asym(rho, N, p, q, tstat = "Pillai")
p.asym(rho, N, p, q, tstat = "Roy")

## Plot the F-approximation for Wilks' Lambda, 
## considering 3, 2, or 1 canonical correlation(s):
res1 &lt;- p.asym(rho, N, p, q)
plt.asym(res1,rhostart=1)
plt.asym(res1,rhostart=2)
plt.asym(res1,rhostart=3)
</code></pre>

<hr>
<h2 id='p.perm'> Permutation test for the significance of canonical correlation coefficients </h2><span id='topic+p.perm'></span>

<h3>Description</h3>

<p>This function runs a permutation test to assign the statistical significance 
of canonical correlation coefficients.
Wilks' Lambda, the Hotelling-Lawley Trace, the Pillai-Bartlett Trace, 
or of Roy's Largest Root can be used as a test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.perm(X, Y, nboot = 999, rhostart = 1, type = "Wilks")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.perm_+3A_x">X</code></td>
<td>
<p> array containing the independent variables, with <code class="reqn">N</code> rows (number of observations) and <code class="reqn">p</code> columns (number of independent variables). </p>
</td></tr>
<tr><td><code id="p.perm_+3A_y">Y</code></td>
<td>
<p> array containing the dependent variables, with <code class="reqn">N</code> rows (number of observations) and <code class="reqn">q</code> columns (number of dependent variables). </p>
</td></tr>
<tr><td><code id="p.perm_+3A_nboot">nboot</code></td>
<td>
<p> number of permutation resamples calculated. </p>
</td></tr>
<tr><td><code id="p.perm_+3A_rhostart">rhostart</code></td>
<td>
<p> index of the largest canonical correlation coefficient included in the calculation of the test statistic (see <code class="reqn">Details</code>). </p>
</td></tr>
<tr><td><code id="p.perm_+3A_type">type</code></td>
<td>
<p> test statistic to be used. One of &quot;Wilks&quot; (default), &quot;Hotelling&quot;, &quot;Pillai&quot;, or &quot;Roy&quot;. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Permutation tests are based on resampling of the original data without replacement. To test the hypothesis of no correlation
between two sets (X, Y) of variables, the values of one variable (Y) are randomly reassigned. Permutation tests do not require
specific population distributions of the variables such as normal distribution. 
Canonical correlation analysis (CCA) calculates <code class="reqn">m = min(p,q)</code> correlation coefficients, see <code><a href="#topic+p.asym">p.asym</a></code>.
The coefficients are arranged in descending order of magnitude: <code class="reqn">rho[1] &gt; rho[2] &gt; rho[3] &gt; ... &gt; rho[m]</code>.
In <code>p.perm</code>, the parameter <code class="reqn">rhostart</code> determines how many correlation coefficients are included in the calculation
of the test statistic: 
choosing <code class="reqn">rhostart=1</code>, all canonical correlations are included, 
choosing <code class="reqn">rhostart=2</code>, the biggest canonical correlation (<code class="reqn">rho[1]</code>) is excluded,
choosing <code class="reqn">rhostart=3</code>, both <code class="reqn">rho[1]</code> and <code class="reqn">rho[2]</code> are excluded, etc.
On principle, Roy's Largest Root takes only <code class="reqn">rho[1]</code> into account, hence only <code class="reqn">rhostart=1</code> can be chosen. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>stat0</code></td>
<td>
<p>original value of the statistic (without resampling).</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p><code class="reqn">nboot</code> values of the statistic, one for each permutation resampling.</p>
</td></tr>
<tr><td><code>nexcess</code></td>
<td>
<p>number of permutation resamplings that resulted in a more extreme value of the statistic than <code class="reqn">stat0</code>.</p>
</td></tr> 
<tr><td><code>p.value</code></td>
<td>
<p>p-value, derived from <code class="reqn">nexcess</code>.</p>
</td></tr> 
</table>


<h3>Note</h3>

<p> Permutation tests do not require a specific distribution of the variables.  
Tests based on random resampling do generally not yield the same results when repeated.
The canonical correlation coefficients are statistically significant
if Wilks' Lambda is <em>smaller</em> than a critical value.
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>References</h3>

<p>Efron, B. and Tibshirani, R. J. (1994)
<em>An Introduction to the Bootstrap</em>,
Chapman &amp; Hall, New York.
</p>
<p>Moore, D. S. amd McCabe, G. P. (2006)
<em>Introduction to the Practice of Statistics, Chapter 14</em>, 
W. H. Freeman, New York.
</p>


<h3>See Also</h3>

<p> See the function <code><a href="stats.html#topic+cancor">cancor</a></code> or the <code>CCA</code> package for the calculation of canonical correlation coefficients. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the CCP package:
library(CCP)


## Simulate example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)



## Run permutation test using Wilks Lambda (default) as test statistic; 
## include different numbers of canonical correlations:
p.perm(X, Y, nboot = 999, rhostart = 1)
p.perm(X, Y, nboot = 999, rhostart = 2)
p.perm(X, Y, nboot = 999, rhostart = 3)


## Run permutation tests based on different test statistics:
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Wilks")        
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Hotelling")
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Pillai")
p.perm(X, Y, nboot = 999, rhostart = 1, type = "Roy")

## Plot the permutation distribution
## with the value of the original statistic marked:
out &lt;- p.perm(X, Y, nboot = 999, rhostart = 3, type = "Hotelling")
plt.perm(out)
</code></pre>

<hr>
<h2 id='plt.asym'> Plot asymptotic distributions for test statistics </h2><span id='topic+plt.asym'></span>

<h3>Description</h3>

<p>This function plots asymptotic distributions used to test the statistical significance 
of canonical correlation coefficients, see function <code><a href="#topic+p.asym">p.asym</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plt.asym(p.asym.out, rhostart = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plt.asym_+3A_p.asym.out">p.asym.out</code></td>
<td>
<p> output of <code>p.asym</code>, see example below. </p>
</td></tr>
<tr><td><code id="plt.asym_+3A_rhostart">rhostart</code></td>
<td>
<p> index of the largest canonical correlation coefficient included in the 
calculation of the test statistic, see function <code><a href="#topic+p.asym">p.asym</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on what type of statistic was chosen in <code>p.asym</code>, an F-approximation for this statistic is plotted. 
The statistic is one of: Wilks' Lambda, Hotelling-Lawley Trace, Pillai-Bartlett Trace, or Roy's Largest Root.
The value of the test statistic calculated from the canonical correlation coefficients is plotted as a vertical line;
thus the area located below the curve and to the right of the vertical line corresponds to the p-value. 
The vertical line is <em>not</em> visible if the value of the test statistic is in the far tail of the distribution, 
resulting in a p-value which is (close to) zero. The numerical value of the test statistic,
the numerator and denominator degrees of freedom of the F-distribution, and the p-value are plotted on the bottom 
of the figure.  
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>See Also</h3>

<p> See the function <code><a href="#topic+p.asym">p.asym</a></code> for the calculation of the p-values. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the CCP package:
library(CCP)



## Simulate  example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)



## Calculate canonical correlations, 
## using the function "cancor" from the "stats" package:
rho &lt;- cancor(X,Y)$cor

## Define number of observations, 
## and number of dependent and independent variables:
N = dim(X)[1]       
p = dim(X)[2]   
q = dim(Y)[2]


## Plot the F-approximation for Wilks' Lambda, 
## considering 3, 2, or 1 canonical correlation(s):
res1 &lt;- p.asym(rho, N, p, q)
plt.asym(res1,rhostart=1)
plt.asym(res1,rhostart=2)
plt.asym(res1,rhostart=3)


## Plot the F-approximation for the Hotelling-Lawley Trace, 
## considering 3, 2, or 1 canonical correlation(s):
res2 &lt;- p.asym(rho, N, p, q, tstat="Hotelling")
plt.asym(res2,rhostart=1)
plt.asym(res2,rhostart=2)
plt.asym(res2,rhostart=3)
</code></pre>

<hr>
<h2 id='plt.perm'> Plot permutation distributions for test statistics </h2><span id='topic+plt.perm'></span>

<h3>Description</h3>

<p>This function plots permutation distributions for test statistics that are used to assign the statistical significance 
of canonical correlation coefficients, see function <code><a href="#topic+p.perm">p.perm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plt.perm(p.perm.out)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plt.perm_+3A_p.perm.out">p.perm.out</code></td>
<td>
<p> output of <code>p.perm</code>, see example below. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Depending on what type of statistic was chosen in <code>p.perm</code>, 
a permutation distribution of this statistic is shown. 
The statistic is one of: Wilks' Lambda, Hotelling-Lawley Trace, Pillai-Bartlett Trace, or Roy's Largest Root.
These test statistics can be used to assign significance levels to canonical correlation coefficients, 
for details see <code><a href="#topic+p.perm">p.perm</a></code>.
The value corresponding to the &quot;original&quot; test statistic 
(calculated using the canonical correlation coefficients resulting from unpermuted data ) 
is plotted as a red, dotted vertical line;
thus the area of the histogram outside this line determines the approximate p-value. 
The vertical line is <em>not</em> visible if the value corresponding to the original test statistic 
is in the far tail of the histogram, yielding a p-value which is (close to) zero. 
The numerical value corresponding to the original test statistic is plotted in the subtitle of the graph, 
as well as the calculated p-value.
The grey vertical line represents the mean of the permutation distribution. 
</p>


<h3>Author(s)</h3>

<p> Uwe Menzel  &lt;uwemenzel@gmail.com&gt;</p>


<h3>See Also</h3>

<p> See the function <code>p.perm</code> for the calculation of the p-values. </p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Load the CCP package:
library(CCP)



## Simulate example data:
X &lt;- matrix(rnorm(150), 50, 3)
Y &lt;- matrix(rnorm(250), 50, 5)



## Calculate canonical correlations:
rho &lt;- cancor(X,Y)$cor

## Define number of observations, 
## and number of dependent and independent variables:
N = dim(X)[1]       
p = dim(X)[2]   
q = dim(Y)[2]


## Plot the permutation distribution of an F approximation 
## for Wilks Lambda, considering 3 and 2 canonical correlations:
out1 &lt;- p.perm(X, Y, nboot = 999, rhostart = 1)  
plt.perm(out1)    
out2 &lt;- p.perm(X, Y, nboot = 999, rhostart = 2)  
plt.perm(out2) 


## Plot the permutation distribution of an F approximation 
## for the Pillai-Bartlett Trace, 
## considering 3, 2, and 1 canonical correlation(s):
res1 &lt;- p.perm(X, Y, nboot = 999, rhostart = 1, type = "Pillai")  
plt.perm(res1)    
res2 &lt;- p.perm(X, Y, nboot = 999, rhostart = 2, type = "Pillai")  
plt.perm(res2) 
res3 &lt;- p.perm(X, Y, nboot = 999, rhostart = 3, type = "Pillai")  
plt.perm(res3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
