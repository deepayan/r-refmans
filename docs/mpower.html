<!DOCTYPE html><html><head><title>Help for package mpower</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mpower}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bkmr_wrapper'><p>Fits a BKMR model with significance criteria: PIP and group-wise PIP</p></a></li>
<li><a href='#bma_wrapper'><p>Fits a linear model with Bayesian model selection with significance criteria:</p>
PIP and posterior probability of nonzero coefficients being on one side of
zero.</a></li>
<li><a href='#bws_wrapper'><p>Fits a Bayesian weighted sums</p></a></li>
<li><a href='#cor2partial'><p>Convert a correlation matrix into a partial correlation matrix</p></a></li>
<li><a href='#cvine'><p>Citation:</p>
Daniel Lewandowski, Dorota Kurowicka, Harry Joe,
Generating random correlation matrices based on vines and extended onion method,
Journal of Multivariate Analysis, Volume 100, Issue 9, 2009, Pages 1989-2001,
ISSN 0047-259X, https://doi.org/10.1016/j.jmva.2009.04.008.</a></li>
<li><a href='#estimate_snr'><p>Monte Carlo approximation of the SNR</p></a></li>
<li><a href='#fin_wrapper'><p>Fits a Bayesian factor model with interactions</p></a></li>
<li><a href='#fit'><p>Fits the model to given data and gets a list of significance criteria</p></a></li>
<li><a href='#genx'><p>Generates a matrix of n observations of p predictors</p></a></li>
<li><a href='#geny'><p>Generates a vector of outcomes</p></a></li>
<li><a href='#glm_wrapper'><p>Fits a generalized linear model</p></a></li>
<li><a href='#InferenceModel'><p>Statistical model that returns significance criterion</p></a></li>
<li><a href='#MixtureModel'><p>Correlated predictors generator</p></a></li>
<li><a href='#mplot'><p>Visualize marginals and Gaussian copula correlations of simulated data</p></a></li>
<li><a href='#mpower'><p>mpower: Power analysis using Monte Carlo for correlated predictors.</p></a></li>
<li><a href='#nhanes1518'><p>NHANES data from 2015-2016 and 2017-2018 cycles</p></a></li>
<li><a href='#OutcomeModel'><p>Outcome generator</p></a></li>
<li><a href='#partial'><p>Partial correlations between elements in x and elements in y</p></a></li>
<li><a href='#plot_summary'><p>Plot summaries of power simulation</p></a></li>
<li><a href='#qgcomp_lin_wrapper'><p>Fits a linear Quantile G-Computation model with no interactions</p></a></li>
<li><a href='#qmultinom'><p>Quantile function for the multinomial distribution, size = 1</p></a></li>
<li><a href='#rsq2snr'><p>Convert R-squared value to the SNR</p></a></li>
<li><a href='#scale_f'><p>Rescale the mean function of an OutcomeModel to meet a given SNR</p></a></li>
<li><a href='#scale_sigma'><p>Rescale the noise variance of a Gaussian OutcomeModel to meet a given SNR</p></a></li>
<li><a href='#set_value'><p>This function updates values in an OutcomeModel object</p></a></li>
<li><a href='#sim_curve'><p>Power curve using Monte Carlo simulation</p></a></li>
<li><a href='#sim_power'><p>Power analysis using Monte Carlo simulation</p></a></li>
<li><a href='#summary'><p>Tabular summaries of power simulation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Power Analysis via Monte Carlo Simulation for Correlated Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A flexible framework for power analysis using Monte
    Carlo simulation for settings in which considerations of the correlations
    between predictors are important. Users can set up a data generative model
    that preserves dependence structures among predictors given existing data
    (continuous, binary, or ordinal). Users can also generate power curves to
    assess the trade-offs between sample size, effect size, and power of a design.
    This package includes several statistical models common in environmental
    mixtures studies. For more details and tutorials, see Nguyen et al. (2022) &lt;<a href="https://doi.org/10.48550/arXiv.2209.08036">doi:10.48550/arXiv.2209.08036</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2">LGPL-2</a> | <a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>abind, boot, dplyr, doSNOW, foreach, ggplot2, MASS, magrittr,
parallel, purrr, snow, sbgcop, rlang, reshape2, tibble, tidyr,
tidyselect</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BMA, bkmr, bws, infinitefactor, knitr, NHANES, qgcomp,
rmarkdown, rstan, testthat, openxlsx</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-20 18:32:25 UTC; phuc</td>
</tr>
<tr>
<td>Author:</td>
<td>Phuc H. Nguyen <a href="https://orcid.org/0000-0002-6206-0194"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Phuc H. Nguyen &lt;phuc.nguyen.rcran@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-21 08:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bkmr_wrapper'>Fits a BKMR model with significance criteria: PIP and group-wise PIP</h2><span id='topic+bkmr_wrapper'></span>

<h3>Description</h3>

<p>Fits a BKMR model with significance criteria: PIP and group-wise PIP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bkmr_wrapper(y, x, args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bkmr_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="bkmr_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="bkmr_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments, see R function 'bkmr::kmbayes()'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors whose values are between 0 and 1
</p>
<table>
<tr><td><code>pip</code></td>
<td>
<p>PIP for component-wise selection or conditional (with-in group)
PIP for hierarchical variable selection.</p>
</td></tr>
<tr><td><code>group_pip</code></td>
<td>
<p>PIP for group-specific selection.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>


<h3>Reference</h3>

<p>Bobb JF, Henn BC, Valeri L, Coull BA (2018). “Statistical software for
analyzing the health effects of multiple concurrent exposures via Bayesian
kernel machine regression.”Environ-mental
Health,17(67).doi:10.1186/s12940-018-0413-y.
</p>

<hr>
<h2 id='bma_wrapper'>Fits a linear model with Bayesian model selection with significance criteria:
PIP and posterior probability of nonzero coefficients being on one side of
zero.</h2><span id='topic+bma_wrapper'></span>

<h3>Description</h3>

<p>Fits a linear model with Bayesian model selection with significance criteria:
PIP and posterior probability of nonzero coefficients being on one side of
zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bma_wrapper(y, x, args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bma_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="bma_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="bma_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments see R function 'BMA::bic.glm()'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors whose values are between 0 and 1
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>The smaller posterior probability of the coefficients being to
one side of zero: min(Pr(beta &gt;0), Pr(beta&lt;0)).</p>
</td></tr>
<tr><td><code>pip</code></td>
<td>
<p>PIP of the
effect not being zero.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>


<h3>Reference</h3>

<p>Raftery A, Hoeting J, Volinsky C, Painter I, Yeung KY (2021).BMA: Bayesian
model averaging. R package version 3.18.15.
</p>

<hr>
<h2 id='bws_wrapper'>Fits a Bayesian weighted sums</h2><span id='topic+bws_wrapper'></span>

<h3>Description</h3>

<p>Fits a Bayesian weighted sums
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bws_wrapper(y, x, args = list(iter = 2000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bws_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="bws_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="bws_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments see R 'bws::bws()&ldquo; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>The smaller posterior probability of
the combined overall effect being to one side of zero: min(Pr(beta &gt;0),
Pr(beta&lt;0)). The same for all predictor.</p>
</td></tr>
<tr><td><code>weights</code></td>
<td>
<p>The 95% CI of the
contribution of each predictor to the overall effect. Between 0 and 1.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>


<h3>Reference</h3>

<p>Hamra GB, MacLehose RF, Croen L, Kauffman EM, Newschaffer C (2021).
“Bayesian weighted sums: a flexible approach to estimate summed mixture
effects.” International Journal of Environmental Research and Public
Health, 18(4), 1373.
</p>

<hr>
<h2 id='cor2partial'>Convert a correlation matrix into a partial correlation matrix</h2><span id='topic+cor2partial'></span>

<h3>Description</h3>

<p>Convert a correlation matrix into a partial correlation matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor2partial(r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor2partial_+3A_r">r</code></td>
<td>
<p>A correlation matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A partial correlation matrix
</p>

<hr>
<h2 id='cvine'>Citation:
Daniel Lewandowski, Dorota Kurowicka, Harry Joe,
Generating random correlation matrices based on vines and extended onion method,
Journal of Multivariate Analysis, Volume 100, Issue 9, 2009, Pages 1989-2001,
ISSN 0047-259X, https://doi.org/10.1016/j.jmva.2009.04.008.</h2><span id='topic+cvine'></span>

<h3>Description</h3>

<p>Citation:
Daniel Lewandowski, Dorota Kurowicka, Harry Joe,
Generating random correlation matrices based on vines and extended onion method,
Journal of Multivariate Analysis, Volume 100, Issue 9, 2009, Pages 1989-2001,
ISSN 0047-259X, https://doi.org/10.1016/j.jmva.2009.04.008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvine(d, alpha = 10, beta = 10, S = NULL, m = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cvine_+3A_d">d</code></td>
<td>
<p>Number of dimension</p>
</td></tr>
<tr><td><code id="cvine_+3A_alpha">alpha</code></td>
<td>
<p>Parameter for Beta distribution</p>
</td></tr>
<tr><td><code id="cvine_+3A_beta">beta</code></td>
<td>
<p>Parameter for Beta distribution</p>
</td></tr>
<tr><td><code id="cvine_+3A_s">S</code></td>
<td>
<p>A 'guess' of the correlation matrix</p>
</td></tr>
<tr><td><code id="cvine_+3A_m">m</code></td>
<td>
<p>A number that indicates how much the random matrices vary from S</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A random positive-definite correlation matrix
</p>

<hr>
<h2 id='estimate_snr'>Monte Carlo approximation of the SNR</h2><span id='topic+estimate_snr'></span>

<h3>Description</h3>

<p>Monte Carlo approximation of the SNR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_snr(ymod, xmod, m = 5000, R = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_snr_+3A_ymod">ymod</code></td>
<td>
<p>A OutcomeModel object</p>
</td></tr>
<tr><td><code id="estimate_snr_+3A_xmod">xmod</code></td>
<td>
<p>A MixtureModel object</p>
</td></tr>
<tr><td><code id="estimate_snr_+3A_m">m</code></td>
<td>
<p>Number of MC samples</p>
</td></tr>
<tr><td><code id="estimate_snr_+3A_r">R</code></td>
<td>
<p>Number of bootstrap replicates</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An estimate SNR and 95-percent CI.
</p>

<hr>
<h2 id='fin_wrapper'>Fits a Bayesian factor model with interactions</h2><span id='topic+fin_wrapper'></span>

<h3>Description</h3>

<p>Fits a Bayesian factor model with interactions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fin_wrapper(y, x, args = list(nrun = 2000))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fin_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="fin_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="fin_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments see R function
&lsquo;infinitefactor::interactionDL()' in &rsquo;infinitefactor' package.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of vectors whose values are between 0 and 1
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>The smallest posterior probability of the coefficients being to
one side of zero for either main effect or interaction: min(Pr(beta &gt;0),
Pr(beta&lt;0)).</p>
</td></tr>
<tr><td><code>linear_beta</code></td>
<td>
<p>The smaller of posterior probability of
the main effects being to one side of zero.</p>
</td></tr>
<tr><td><code>interact_beta</code></td>
<td>
<p>Same as
linear_beta but for pair-wise interactions.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>


<h3>Reference</h3>

<p>Ferrari F, Dunson DB (2020). “Bayesian factor analysis for inference on
interactions.”Journal of the American Statistical Association, 0(0), 1–12.
</p>

<hr>
<h2 id='fit'>Fits the model to given data and gets a list of significance criteria</h2><span id='topic+fit'></span>

<h3>Description</h3>

<p>Fits the model to given data and gets a list of significance criteria
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit(mod, x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_+3A_mod">mod</code></td>
<td>
<p>An InferenceModel object</p>
</td></tr>
<tr><td><code id="fit_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="fit_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of some of the following significance criteria:
</p>
<table>
<tr><td><code>beta</code></td>
<td>
<p>The smaller
posterior probability of being to one side of zero for linear term, given
either the main effect or interaction is non-zero. Applicable to 'bma',
'bws', 'fin', and 'mixselect' model.</p>
</td></tr>
<tr><td><code>interact_beta</code></td>
<td>
<p>Same as linear_beta but
for pair-wise interactions. Applicable to 'fin' model.</p>
</td></tr>
<tr><td><code>pip</code></td>
<td>
<p>Posterior inclusion probability (PIP) of either a linear or
non-linear effect. Applicable to 'bma', 'bkmr', and 'mixselect' model.</p>
</td></tr>
<tr><td><code>group_pip</code></td>
<td>
<p>PIP of either a linear or non-linear effect. Applicable to
'bkmr' model.</p>
</td></tr>
<tr><td><code>linear_pip</code></td>
<td>
<p>PIP of a linear effect. Applicable to 'mixselect' model.</p>
</td></tr>
<tr><td><code>gp_pip</code></td>
<td>
<p>PIP of a non-linear effect. Applicable to 'mixselect' model.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The p-value of the combined effect, the same for all
predictors. Applicable to 'glm', and 'qgc' model.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>

<hr>
<h2 id='genx'>Generates a matrix of n observations of p predictors</h2><span id='topic+genx'></span>

<h3>Description</h3>

<p>Generates a matrix of n observations of p predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genx(obj, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genx_+3A_obj">obj</code></td>
<td>
<p>A MixtureModel object.</p>
</td></tr>
<tr><td><code id="genx_+3A_n">n</code></td>
<td>
<p>An integer, number of observations to generate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (n x p) dataframe.
</p>

<hr>
<h2 id='geny'>Generates a vector of outcomes</h2><span id='topic+geny'></span>

<h3>Description</h3>

<p>Generates a vector of outcomes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geny(obj, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geny_+3A_obj">obj</code></td>
<td>
<p>An OutcomeModel object</p>
</td></tr>
<tr><td><code id="geny_+3A_x">x</code></td>
<td>
<p>An (n x p) matrix of predictors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An n-vector of outcomes
</p>

<hr>
<h2 id='glm_wrapper'>Fits a generalized linear model</h2><span id='topic+glm_wrapper'></span>

<h3>Description</h3>

<p>Fits a generalized linear model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>glm_wrapper(y, x, args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="glm_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="glm_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="glm_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments see R 'glm' function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr><td><code>pval</code></td>
<td>
<p>The p-value of the linear main effect.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>

<hr>
<h2 id='InferenceModel'>Statistical model that returns significance criterion</h2><span id='topic+InferenceModel'></span>

<h3>Description</h3>

<p>This function creates a wrapper function for a statistical model and its
applicable significance criterion. It finds relationships between a matrix
of predictors and a vector of outcomes using the statistical model, and
determines if the relationships are 'significant' according to pre-specified
criterion for that model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>InferenceModel(model, name = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="InferenceModel_+3A_model">model</code></td>
<td>
<p>A string of the name of a built-in statistical model or a function
implements a statistical model and returns a list of significance
criteria for each predictor. Built-in options include 'bma', 'bkmr', 'mixselect',
'bws', 'qgc', 'fin', 'glm'.</p>
</td></tr>
<tr><td><code id="InferenceModel_+3A_name">name</code></td>
<td>
<p>A string, name of the statistical model. Default to string input
of model.</p>
</td></tr>
<tr><td><code id="InferenceModel_+3A_...">...</code></td>
<td>
<p>Additional keyword arguments for the statistical model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An InferenceModel object.
</p>
<table>
<tr><td><code>model</code></td>
<td>
<p>a function that takes matrices of predictors and outcomes and
returns a list of significance criteria.</p>
</td></tr>
<tr><td><code>model_name</code></td>
<td>
<p>a string.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>imod &lt;- mpower::InferenceModel(model = 'glm', family = 'gaussian',
formula = y ~ Poverty*(poly(Age, 2) + HHIncome + HomeOwn + Education))
</code></pre>

<hr>
<h2 id='MixtureModel'>Correlated predictors generator</h2><span id='topic+MixtureModel'></span>

<h3>Description</h3>

<p>This function creates a generative model for the correlated, mixed-scale
predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MixtureModel(
  method = "estimation",
  data = NULL,
  G = NULL,
  m = 100,
  nudge = 1e-09,
  sbg_args = list(nsamp = 1000),
  cvine_marginals = list(),
  cvine_dtypes = list(),
  resamp_prob = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MixtureModel_+3A_method">method</code></td>
<td>
<p>A string, one of the three options &quot;resampling&quot;, &quot;estimation&quot;,
or &quot;cvine&quot;. Default is &quot;estimation&quot;. See Details.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_data">data</code></td>
<td>
<p>A dataframe or matrix, required for resampling&quot; and &quot;estimation&quot;
method.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_g">G</code></td>
<td>
<p>A guesstimate pairwise correlation matrix for &quot;cvine&quot; method. See
Details.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_m">m</code></td>
<td>
<p>A positive number indicating uncertainty in the guesstimate G,
larger means more uncertainty. Default is 100.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_nudge">nudge</code></td>
<td>
<p>A number, default 10e-10 to add to the diagonal of the covariance
matrix for numerical stability.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_sbg_args">sbg_args</code></td>
<td>
<p>A list of named arguments, except Y, for function 'sbgcop.mcmc()'.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_cvine_marginals">cvine_marginals</code></td>
<td>
<p>A named list describing the univariate distribution
of each predictor. See Details.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_cvine_dtypes">cvine_dtypes</code></td>
<td>
<p>A named list describing the data type of each variable.</p>
</td></tr>
<tr><td><code id="MixtureModel_+3A_resamp_prob">resamp_prob</code></td>
<td>
<p>A vector of sampling probability for each observation in data. Must sums to 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A MixtureModel object.
</p>


<h3>Details</h3>

<p>There are three methods to generate data:
</p>
<p>1. Resampling: if we have enough data of the predictors, we can
resample to get realistic joint distributions and dependence among them.
</p>
<p>2. Estimation: if we have a small sample from, for example, a pilot study,
we can sample from a semi-parametric copula model (Hoff 2007) after learning
the dependence and univariate marginals of the predictors.
</p>
<p>3. C-vine: if no pilot data exists, we can still set rough guesstimate of
the dependence and univariate marginals. The C-vine algorithm (Joe 2006)
generates positive semi-definite correlation matrix given the guesstimate G.
The guesstimate G is a symmetric p x p matrix whose ij-th item is between
-1 and 1 and is the guesstimate correlation between predictor ith and jth.
G doesn't need to be a valid correlation matrix. The method works well when
values in G are not extreme (i.e., 0.999, -0.999). Built-in functions for
univariate marginals include: 'qbeta' , 'qbinom', 'qcauchy', 'qchisq', 'qexp', 'qf',
'qgamma', 'qgeom', 'qhyper', 'qlogis', 'qlnorm', 'qmultinom', 'qnbinom',
'qnorm', 'qpois', 'qt', 'qunif', 'qweibull'.
</p>


<h3>References</h3>

<p>Hoff P (2007). 'Extending the rank likelihood for
semiparametric copula estimation.' Ann. Appl. Stat, 1(1), 265-283.
</p>
<p>Joe H (2006). “Generating random correlation matrices based on partial
correlations.”Journal of Multivariate Analysis, 97, 2177-2189.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("nhanes1518")
xmod &lt;- mpower::MixtureModel(nhanes1518, method = "resampling")

</code></pre>

<hr>
<h2 id='mplot'>Visualize marginals and Gaussian copula correlations of simulated data</h2><span id='topic+mplot'></span>

<h3>Description</h3>

<p>Visualize marginals and Gaussian copula correlations of simulated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mplot(obj, split = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mplot_+3A_obj">obj</code></td>
<td>
<p>A MixtureModel object.</p>
</td></tr>
<tr><td><code id="mplot_+3A_split">split</code></td>
<td>
<p>A logical, whether to display numbers on half of the covariance
matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggplot2' graphics.
</p>

<hr>
<h2 id='mpower'>mpower: Power analysis using Monte Carlo for correlated predictors.</h2><span id='topic+mpower'></span>

<h3>Description</h3>

<p>This package provides tools to set up simulations for power calculation
</p>

<hr>
<h2 id='nhanes1518'>NHANES data from 2015-2016 and 2017-2018 cycles</h2><span id='topic+nhanes1518'></span>

<h3>Description</h3>

<p>Combined NHANES data from the 2015-2016 and 2017-2018 cycles
The weights have been adjusted according to <a href="https://wwwn.cdc.gov/nchs/nhanes/tutorials/module3.aspx">https://wwwn.cdc.gov/nchs/nhanes/tutorials/module3.aspx</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nhanes1518
</code></pre>


<h3>Format</h3>

<p>Data with the following variables:
</p>

<dl>
<dt>SEQN</dt><dd><p>Respondent sequence number</p>
</dd>
<dt>WTINT4YR</dt><dd><p>Full sample 4 year interview weight</p>
</dd>
<dt>WTMEC4YR</dt><dd><p>Full sample 4 year MEC exam weight</p>
</dd>
<dt>WTSB4YR</dt><dd><p>Environmental B 4-year weights</p>
</dd>
<dt>RIDSTATR</dt><dd><p>Interview/Examination status</p>
</dd>
<dt>RIAGENDR</dt><dd><p>Gender of the participant</p>
</dd>
<dt>RIDAGEYR</dt><dd><p>Age in years of the participant at the time of screening. Individuals 80 and over are top-coded at 80 years of age</p>
</dd>
<dt>INDFMPIR</dt><dd><p>A ratio of family income to poverty guidelines</p>
</dd>
<dt>RIDRETH1</dt><dd><p>Race/Hispanic origin</p>
</dd>
<dt>INDHHIN2</dt><dd><p>Total household income (reported as a range value in dollars)</p>
</dd>
<dt>BMXBMI</dt><dd><p>Body Mass Index (kg/m**2)</p>
</dd>
<dt>BMXWAIST</dt><dd><p>Waist Circumference (cm)</p>
</dd>
<dt>BMXWT</dt><dd><p>Weight (kg)</p>
</dd>
<dt>BMXHT</dt><dd><p>Standing Height (cm)</p>
</dd>
<dt>URXUCR</dt><dd><p>Creatinine, urine (mg/dL)</p>
</dd>
<dt>URXCNP</dt><dd><p><strong>MCNP</strong> Mono(carboxyisononyl) phthalate (ng/mL), LLOD = 0.2</p>
</dd>
<dt>URXCOP</dt><dd><p><strong>MCOP</strong> Mono(carboxyisoctyl) phthalate (ng/mL), LLOD = 0.3</p>
</dd>
<dt>URXECP</dt><dd><p><strong>MECPP</strong> Mono-2-ethyl-5-carboxypentyl phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXHIBP</dt><dd><p><strong>MHIBP</strong> phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMBP</dt><dd><p><strong>MnBP</strong> Mono-n-butyl phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMC1</dt><dd><p><strong>MCPP</strong> Mono-(3-carboxypropyl) phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMCOH</dt><dd><p><strong>MCOCH</strong> phthalate (ng/mL), LLOD =	0.5</p>
</dd>
<dt>URXMEP</dt><dd><p><strong>MEP</strong> Mono-ethyl phthalate (ng/mL), LLOD =	1.2</p>
</dd>
<dt>URXMHBP</dt><dd><p>Mono-3-hydroxy-n-butyl phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMHH</dt><dd><p><strong>MEHHP</strong> Mono-(2-ethyl-5-hydroxyhexyl) phthalate (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMHNC</dt><dd><p>Cyclohexane 1,2-dicarboxylic acid monohydroxy isononyl ester (ng/mL), LLOD =	0.4</p>
</dd>
<dt>URXMHP</dt><dd><p><strong>MEHP</strong> Mono-(2-ethyl)-hexyl phthalate (ng/mL), LLOD =	0.8</p>
</dd>
<dt>URXMIB</dt><dd><p><strong>MiBP</strong> Mono-isobutyl phthalate (ng/mL), LLOD =	0.8</p>
</dd>
<dt>URXMNP</dt><dd><p><strong>MCNP</strong> Mono-isononyl phthalate (ng/mL), LLOD =	0.9</p>
</dd>
<dt>URXMOH</dt><dd><p><strong>MEOHP</strong> Mono-(2-ethyl-5-oxohexyl) phthalate (ng/mL), LLOD =	0.2</p>
</dd>
<dt>URXMZP</dt><dd><p><strong>MBzP</strong> Mono-benzyl phthalate (ng/mL), LLOD =	0.3</p>
</dd>
<dt>URDCNPLC, URDCOPLC, URDECPLC, URDHIBLC, URDMBPLC, URDMC1LC, URDMCOLC, URDMEPLC,
URDMHBLC, URDMHHLC, URDMCHLC, URDMHPLC, URDMIBLC, URDMNPLC, URDMOHLC, URDMZPLC</dt><dd><p>Phthalates comment code for whether the measurement is under the limit of detection</p>
</dd>
</dl>



<h3>Source</h3>

<p>Detailed documentation of the phthalates variables can be found here:
</p>

<ul>
<li> <p><a href="https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx">https://wwwn.cdc.gov/nchs/nhanes/search/default.aspx</a>
</p>
</li>
<li> <p><a href="https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/PHTHTE_I.htm">https://wwwn.cdc.gov/Nchs/Nhanes/2015-2016/PHTHTE_I.htm</a>
</p>
</li>
<li> <p><a href="https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/PHTHTE_J.htm">https://wwwn.cdc.gov/Nchs/Nhanes/2017-2018/PHTHTE_J.htm</a>
</p>
</li></ul>


<hr>
<h2 id='OutcomeModel'>Outcome generator</h2><span id='topic+OutcomeModel'></span>

<h3>Description</h3>

<p>This function creates a generative model of the outcome given a matrix of
predictors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>OutcomeModel(f, family = "gaussian", sigma = 1, f_args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="OutcomeModel_+3A_f">f</code></td>
<td>
<p>A string that describes the relationships between the predictors and
outcome or a function that takes an input matrix and returns a vector of
outcome: <code class="reqn">E(y|x) = g(f(x))</code> where g is a link function that depends on
the family argument.</p>
</td></tr>
<tr><td><code id="OutcomeModel_+3A_family">family</code></td>
<td>
<p>A string, 'gaussian', 'binomial', or 'poisson' for continuous,
binary, or count outcomes.</p>
</td></tr>
<tr><td><code id="OutcomeModel_+3A_sigma">sigma</code></td>
<td>
<p>A number, Gaussian noise standard deviation if applicable.</p>
</td></tr>
<tr><td><code id="OutcomeModel_+3A_f_args">f_args</code></td>
<td>
<p>A named list of additional arguments to f</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An OutcomeModel object. Attributes:
</p>
<table>
<tr><td><code>f</code></td>
<td>
<p>mean function.</p>
</td></tr>
<tr><td><code>sigma</code></td>
<td>
<p>a number for the Gaussian observation noise.</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p>a string 'gaussian' or 'binomial'.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Define BMI as a ratio of weight and height plus random Gaussian error with standard deviation 1.
bmi_model &lt;- mpower::OutcomeModel(f = 'weight/(height^2)', sigma = 1, family = 'gaussian')
</code></pre>

<hr>
<h2 id='partial'>Partial correlations between elements in x and elements in y</h2><span id='topic+partial'></span>

<h3>Description</h3>

<p>Partial correlations between elements in x and elements in y
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partial(r, x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="partial_+3A_r">r</code></td>
<td>
<p>A correlation matrix</p>
</td></tr>
<tr><td><code id="partial_+3A_x">x</code></td>
<td>
<p>A vector of indices</p>
</td></tr>
<tr><td><code id="partial_+3A_y">y</code></td>
<td>
<p>A vector of indices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A partial correlation matrix
</p>

<hr>
<h2 id='plot_summary'>Plot summaries of power simulation</h2><span id='topic+plot_summary'></span>

<h3>Description</h3>

<p>Plot summaries of power simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_summary(sim, crit, thres, digits = 3, how = "greater")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_summary_+3A_sim">sim</code></td>
<td>
<p>A Sim or a SimCurve object, output from 'sim_power()' or
'sim_curve()'.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_crit">crit</code></td>
<td>
<p>A string specifying the significance criteria.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_thres">thres</code></td>
<td>
<p>A number or vector of numbers specifying the thresholds of
&quot;significance&quot;.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_digits">digits</code></td>
<td>
<p>An integer for the number of decimal points to display.</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_how">how</code></td>
<td>
<p>A string, whether to compare the criterion 'greater' or 'lesser'
than the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggplot2' graphics.
</p>

<hr>
<h2 id='qgcomp_lin_wrapper'>Fits a linear Quantile G-Computation model with no interactions</h2><span id='topic+qgcomp_lin_wrapper'></span>

<h3>Description</h3>

<p>Fits a linear Quantile G-Computation model with no interactions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qgcomp_lin_wrapper(y, x, args = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qgcomp_lin_wrapper_+3A_y">y</code></td>
<td>
<p>A vector of outcome</p>
</td></tr>
<tr><td><code id="qgcomp_lin_wrapper_+3A_x">x</code></td>
<td>
<p>A matrix of predictors</p>
</td></tr>
<tr><td><code id="qgcomp_lin_wrapper_+3A_args">args</code></td>
<td>
<p>A list of arguments see R function 'qgcomp::qgcomp.noboot()'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list
</p>
<table>
<tr><td><code>pval</code></td>
<td>
<p>The p-value of the combined effect, the
same for all predictors.</p>
</td></tr>
<tr><td><code>pos_weights</code></td>
<td>
<p>Positive weights. See 'qgcomp' package.</p>
</td></tr>
<tr><td><code>neg_weights</code></td>
<td>
<p>Negative weights. See 'qgcomp' package.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>elapsed time to fit the model.</p>
</td></tr>
</table>


<h3>Reference</h3>

<p>Keil AP, Buckley JP, O’Brien KM, Ferguson KK, Zhao S, White AJ (2020). “A
Quantile-based g-computation  approach  to  addressing  the  effects of
exposure  mixtures.”Environmental Health Perspectives, 128(4).
</p>

<hr>
<h2 id='qmultinom'>Quantile function for the multinomial distribution, size = 1</h2><span id='topic+qmultinom'></span>

<h3>Description</h3>

<p>Quantile function for the multinomial distribution, size = 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qmultinom(p, probs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qmultinom_+3A_p">p</code></td>
<td>
<p>A quantile.</p>
</td></tr>
<tr><td><code id="qmultinom_+3A_probs">probs</code></td>
<td>
<p>A vector of probabilities for each level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Gives the quantile function
</p>

<hr>
<h2 id='rsq2snr'>Convert R-squared value to the SNR</h2><span id='topic+rsq2snr'></span>

<h3>Description</h3>

<p>Convert R-squared value to the SNR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsq2snr(r)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rsq2snr_+3A_r">r</code></td>
<td>
<p>R-squared value</p>
</td></tr>
</table>

<hr>
<h2 id='scale_f'>Rescale the mean function of an OutcomeModel to meet a given SNR</h2><span id='topic+scale_f'></span>

<h3>Description</h3>

<p>Rescale the mean function of an OutcomeModel to meet a given SNR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_f(snr, ymod, xmod, m = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_f_+3A_snr">snr</code></td>
<td>
<p>A SNR</p>
</td></tr>
<tr><td><code id="scale_f_+3A_ymod">ymod</code></td>
<td>
<p>A OutcomeModel object to modify</p>
</td></tr>
<tr><td><code id="scale_f_+3A_xmod">xmod</code></td>
<td>
<p>A MixtureModel object</p>
</td></tr>
<tr><td><code id="scale_f_+3A_m">m</code></td>
<td>
<p>Number of MC samples to estimate the SNR of a proposed noise variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new OutcomeModel object
</p>

<hr>
<h2 id='scale_sigma'>Rescale the noise variance of a Gaussian OutcomeModel to meet a given SNR</h2><span id='topic+scale_sigma'></span>

<h3>Description</h3>

<p>Rescale the noise variance of a Gaussian OutcomeModel to meet a given SNR
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_sigma(snr, ymod, xmod, m = 5000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_sigma_+3A_snr">snr</code></td>
<td>
<p>A SNR</p>
</td></tr>
<tr><td><code id="scale_sigma_+3A_ymod">ymod</code></td>
<td>
<p>A OutcomeModel object to modify</p>
</td></tr>
<tr><td><code id="scale_sigma_+3A_xmod">xmod</code></td>
<td>
<p>A MixtureModel object</p>
</td></tr>
<tr><td><code id="scale_sigma_+3A_m">m</code></td>
<td>
<p>Number of MC samples to estimate the SNR of a proposed noise variance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new OutcomeModel object
</p>

<hr>
<h2 id='set_value'>This function updates values in an OutcomeModel object</h2><span id='topic+set_value'></span>

<h3>Description</h3>

<p>This function updates values in an OutcomeModel object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_value(obj, name, value)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="set_value_+3A_obj">obj</code></td>
<td>
<p>An OutcomeModel object</p>
</td></tr>
<tr><td><code id="set_value_+3A_name">name</code></td>
<td>
<p>A string for name of the attribute to be changed</p>
</td></tr>
<tr><td><code id="set_value_+3A_value">value</code></td>
<td>
<p>An appropriate data type</p>
</td></tr>
</table>

<hr>
<h2 id='sim_curve'>Power curve using Monte Carlo simulation</h2><span id='topic+sim_curve'></span>

<h3>Description</h3>

<p>This function can be used to create power curves by calling sim_power() on
combinations of many sample sizes and signal-to-noise ratio (SNR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_curve(
  xmod,
  ymod,
  imod,
  s = 100,
  n = 100,
  cores = 1,
  file = NULL,
  errorhandling = "stop",
  snr_iter = 10000,
  cluster_export = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_curve_+3A_xmod">xmod</code></td>
<td>
<p>A MixtureModel object.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_ymod">ymod</code></td>
<td>
<p>One or a list of OutcomeModel object(s).</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_imod">imod</code></td>
<td>
<p>An InferenceModel object.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_s">s</code></td>
<td>
<p>An integer for the number of Monte Carlo simulations.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_n">n</code></td>
<td>
<p>An integer or a vector of sample sizes.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_cores">cores</code></td>
<td>
<p>An integer for the number of processing cores. When cores &gt; 1,
parallelism is automatically applied.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_file">file</code></td>
<td>
<p>A string, a file name with no extension to write samples to
periodically. By default write to an RDS file.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_errorhandling">errorhandling</code></td>
<td>
<p>A string &quot;remove&quot;, &quot;stop&quot;, or &quot;pass&quot;. If an error occurs
in any iteration, remove that iteration (remove), return the error message
verbatim in the output (pass), or terminate the loop (stop). Default is
&quot;remove&quot;. See R package 'foreach' for more details.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_snr_iter">snr_iter</code></td>
<td>
<p>An integer for number of Monte Carlo samples to estimate SNR.</p>
</td></tr>
<tr><td><code id="sim_curve_+3A_cluster_export">cluster_export</code></td>
<td>
<p>A vector of functions to pass to the
parallel-processing clusters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A SimCurve object with the following attributes:
</p>
<table>
<tr><td><code>s</code></td>
<td>
<p>a number of simulations.</p>
</td></tr>
<tr><td><code>snr</code></td>
<td>
<p>a real number or array of real numbers for SNR of each OutcomeModel.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a number or vector of sample sizes.</p>
</td></tr>
<tr><td><code>xmod</code></td>
<td>
<p>the MixtureModel used.</p>
</td></tr>
<tr><td><code>ymod</code></td>
<td>
<p>the OutcomeModel used.</p>
</td></tr>
<tr><td><code>imod</code></td>
<td>
<p>the InferenceModel used.</p>
</td></tr>
<tr><td><code>sims</code></td>
<td>
<p>a list of simulation output matrices.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("nhanes1518")
chems &lt;- c("URXCNP", "URXCOP", "URXECP", "URXHIBP", "URXMBP", "URXMC1",
"URXMCOH", "URXMEP","URXMHBP", "URXMHH", "URXMHNC", "URXMHP", "URXMIB",
"URXMNP", "URXMOH", "URXMZP")
chems_mod &lt;- mpower::MixtureModel(nhanes1518[, chems], method = "resampling")
bmi_mod &lt;- mpower::OutcomeModel(f = "0.2*URXCNP + 0.15*URXECP +
0.1*URXCOP*URXECP", family = "binomial")
logit_mod &lt;- mpower::InferenceModel(model = "glm", family = "binomial")
logit_out &lt;- mpower::sim_curve(xmod=chems_mod, ymod=bmi_mod, imod=logit_mod,
s=20, n=c(500, 1000), cores=2, snr_iter=1000)
logit_df &lt;- summary(logit_out, crit="pval", thres=0.05, how="lesser")
plot_summary(logit_out, crit="pval", thres=0.05, how="lesser")
</code></pre>

<hr>
<h2 id='sim_power'>Power analysis using Monte Carlo simulation</h2><span id='topic+sim_power'></span>

<h3>Description</h3>

<p>Power analysis using Monte Carlo simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_power(
  xmod,
  ymod,
  imod,
  s = 100,
  n = 100,
  cores = 1,
  file = NULL,
  errorhandling = "stop",
  snr_iter = 10000,
  cluster_export = c()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_power_+3A_xmod">xmod</code></td>
<td>
<p>A MixtureModel object.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_ymod">ymod</code></td>
<td>
<p>An OutcomeModel object.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_imod">imod</code></td>
<td>
<p>An InferenceModel object.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_s">s</code></td>
<td>
<p>An integer for number of Monte Carlo simulations.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_n">n</code></td>
<td>
<p>An integer for sample size in each simulation.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_cores">cores</code></td>
<td>
<p>An integer for number of processing cores. When cores &gt; 1,
parallelism is automatically applied.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_file">file</code></td>
<td>
<p>A string, a file name with no extension to write samples to
periodically. By default write to an RDS file.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_errorhandling">errorhandling</code></td>
<td>
<p>A string &quot;remove&quot;, &quot;stop&quot;, or &quot;pass&quot;. If an error occurs
in any iteration, remove that iteration (remove), return the error message
verbatim in the output (pass), or terminate the loop (stop). Default is
&quot;remove&quot;. See R package 'foreach' for more details.</p>
</td></tr>
<tr><td><code id="sim_power_+3A_snr_iter">snr_iter</code></td>
<td>
<p>An integer for number of Monte Carlo samples to estimate SNR</p>
</td></tr>
<tr><td><code id="sim_power_+3A_cluster_export">cluster_export</code></td>
<td>
<p>A vector of functions to pass to the parallel-processing clusters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A PowerSim object. Attributes:
</p>
<table>
<tr><td><code>s</code></td>
<td>
<p>a number of simulations.</p>
</td></tr>
<tr><td><code>snr</code></td>
<td>
<p>a real number for SNR of the OutcomeModel.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a number of sample sizes.</p>
</td></tr>
<tr><td><code>xmod</code></td>
<td>
<p>the MixtureModel used.</p>
</td></tr>
<tr><td><code>ymod</code></td>
<td>
<p>the OutcomeModel used.</p>
</td></tr>
<tr><td><code>imod</code></td>
<td>
<p>the InferenceModel used.</p>
</td></tr>
<tr><td><code>sims</code></td>
<td>
<p>an output matrices.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("nhanes1518")
chems &lt;- c("URXCNP", "URXCOP", "URXECP", "URXHIBP", "URXMBP", "URXMC1",
"URXMCOH", "URXMEP","URXMHBP", "URXMHH", "URXMHNC", "URXMHP", "URXMIB",
"URXMNP", "URXMOH", "URXMZP")
chems_mod &lt;- mpower::MixtureModel(nhanes1518[, chems], method = "resampling")
bmi_mod &lt;- mpower::OutcomeModel(f = "0.2*URXCNP + 0.15*URXECP +
0.1*URXCOP*URXECP", family = "binomial")
logit_mod &lt;- mpower::InferenceModel(model = "glm", family = "binomial")
logit_out &lt;- mpower::sim_power(xmod=chems_mod, ymod=bmi_mod, imod=logit_mod,
s=100, n=2000, cores=2, snr_iter=2000)
logit_df &lt;- summary(logit_out, crit="pval", thres=0.05, how="lesser")
plot_summary(logit_out, crit="pval", thres=0.05, how="lesser")
</code></pre>

<hr>
<h2 id='summary'>Tabular summaries of power simulation</h2><span id='topic+summary'></span>

<h3>Description</h3>

<p>Tabular summaries of power simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary(sim, crit, thres, digits = 3, how = "greater")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary_+3A_sim">sim</code></td>
<td>
<p>A Sim or a SimCurve object, output from 'sim_power()' or
'sim_curve()'.</p>
</td></tr>
<tr><td><code id="summary_+3A_crit">crit</code></td>
<td>
<p>A string specifying the significance criteria.</p>
</td></tr>
<tr><td><code id="summary_+3A_thres">thres</code></td>
<td>
<p>A number or vector of numbers specifying the thresholds of
&quot;significance&quot;.</p>
</td></tr>
<tr><td><code id="summary_+3A_digits">digits</code></td>
<td>
<p>An integer for the number of decimal points to display.</p>
</td></tr>
<tr><td><code id="summary_+3A_how">how</code></td>
<td>
<p>A string, whether to compare the criterion 'greater' or 'lesser'
than the threshold.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame summary of power for each predictor for each combination
of thresholds, sample size, signal-to-noise ratios.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
